<html>
<head>
<title>Transcribe audio files with OpenAI’s Whisper</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用OpenAI的耳语转录音频文件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/transcribe-audio-files-with-openais-whisper-e973ae348aa7#2022-09-26">https://towardsdatascience.com/transcribe-audio-files-with-openais-whisper-e973ae348aa7#2022-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3b2a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用OpenAI的耳语转录音频文件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ad6eac6919482f401318fdca36fdf64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QyvVmT-8k0zmCjzO"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">威尔·弗朗西斯在<a class="ae ky" href="https://unsplash.com/photos/ZDNyhmgkZlQ" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><p id="bc3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">penAI最近开源了一个名为Whisper的神经网络。它允许你离线转录(大)音频文件，如mp3。OpenAI声称Whisper在英语语音识别中接近人类水平的鲁棒性和准确性。</p><p id="b432" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于已经有现有的(开源)模型或包，如<a class="ae ky" rel="noopener" target="_blank" href="/transcribe-large-audio-files-offline-with-vosk-a77ee8f7aa28"> Vosk </a>或<a class="ae ky" href="https://catalog.ngc.nvidia.com/orgs/nvidia/models/nemospeechmodels" rel="noopener ugc nofollow" target="_blank"> NVIDIA NeMo </a>，我想知道Whisper能够转录音频文件的能力如何。</p><p id="4fdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文向您展示了如何使用Whisper，并将其性能与另一个离线开源语音识别工具包Vosk进行了比较。</p><h1 id="960b" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">TL；博士；医生</h1><ul class=""><li id="6d8f" class="mw mx it lb b lc my lf mz li na lm nb lq nc lu nd ne nf ng bi translated">Whisper是OpenAI的一个开源、多语言、通用的语音识别模型。</li><li id="47a7" class="mw mx it lb b lc nh lf ni li nj lm nk lq nl lu nd ne nf ng bi translated">转录一个(mp3)音频文件只需要三行代码。</li><li id="34e0" class="mw mx it lb b lc nh lf ni li nj lm nk lq nl lu nd ne nf ng bi translated">与Vosk(另一个开源工具包)的快速比较表明，Whisper转录播客摘录的音频稍好一些。主要区别在于Whisper提供了标点符号。这使得转录更容易理解。</li><li id="390e" class="mw mx it lb b lc nh lf ni li nj lm nk lq nl lu nd ne nf ng bi translated">如果您仅对代码感兴趣，向下滚动至“耳语”或点击此处的<a class="ae ky" href="https://gist.github.com/darinkist/71f27e248938d3f4b511acbfba5f0372" rel="noopener ugc nofollow" target="_blank"/>(要点)。</li></ul><h1 id="8c47" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">先决条件</h1><p id="af69" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在我们开始转录和比较这两个模型之前，我们必须确保满足一些先决条件。</p><h2 id="1bd1" class="np mf it bd mg nq nr dn mk ns nt dp mo li nu nv mq lm nw nx ms lq ny nz mu oa bi translated">安装ffmpeg</h2><p id="8bb1" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">为了能够<strong class="lb iu">读取音频文件</strong>，我们必须先安装一个名为<code class="fe ob oc od oe b">ffmpeg</code>的命令行工具。根据您的操作系统，您有以下选择:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="d4cd" class="np mf it oe b gy oj ok l ol om"># <strong class="oe iu">Ubuntu or Debian</strong><br/>sudo apt update &amp;&amp; sudo apt install ffmpeg<br/><br/># <strong class="oe iu">MacOS</strong> using <em class="on">Homebrew</em> (https://brew.sh/)<br/>brew install ffmpeg<br/><br/># <strong class="oe iu">Windows</strong> using <em class="on">Chocolatey</em> (https://chocolatey.org/)<br/>choco install ffmpeg<br/><br/># <strong class="oe iu">Windows</strong> using <em class="on">Scoop</em> (https://scoop.sh/)<br/>scoop install ffmpeg</span></pre><h2 id="26e2" class="np mf it bd mg nq nr dn mk ns nt dp mo li nu nv mq lm nw nx ms lq ny nz mu oa bi translated">安装耳语</h2><p id="6cc5" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">使用以下pip安装命令下载Whisper。</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="7895" class="np mf it oe b gy oj ok l ol om">pip install git+https://github.com/openai/whisper.git</span></pre><h2 id="ad18" class="np mf it bd mg nq nr dn mk ns nt dp mo li nu nv mq lm nw nx ms lq ny nz mu oa bi translated">安装Vosk(可选)</h2><p id="ce7d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">因为这篇文章比较了Whisper和Vosk，所以我也将向您展示如何安装和配置Vosk。<strong class="lb iu">如果你只对使用Whisper感兴趣，可以跳过这一部分。</strong>以下命令安装Vosk:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="b242" class="np mf it oe b gy oj ok l ol om">pip install vosk</span></pre><h2 id="9736" class="np mf it bd mg nq nr dn mk ns nt dp mo li nu nv mq lm nw nx ms lq ny nz mu oa bi translated">安装pydub(可选)</h2><p id="479f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">要使用Vosk，我们首先必须用<strong class="lb iu">一个通道</strong>(单声道)和<strong class="lb iu">16000hz采样率</strong>将<code class="fe ob oc od oe b">.wav</code>文件中的音频文件<strong class="lb iu">转换。Whisper <strong class="lb iu">也做这种转换，</strong>但是我们不需要额外编码。下面的命令安装<code class="fe ob oc od oe b">pydump</code>:</strong></p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="4e05" class="np mf it oe b gy oj ok l ol om">pip install pydump</span></pre><h2 id="5ba3" class="np mf it bd mg nq nr dn mk ns nt dp mo li nu nv mq lm nw nx ms lq ny nz mu oa bi translated">对于Mac用户:安装证书</h2><p id="d4d3" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">Whisper将加载特定的语言模型来转录音频。如果您是Mac用户，稍后您可能会收到以下消息:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="f44d" class="np mf it oe b gy oj ok l ol om">URLError: &lt;urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1123)&gt;</span></pre><p id="1b4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要解决此问题，请进入python应用程序的文件夹(通常是Applications&gt; Python 3.x)并运行“Install Certificates.command”文件。更多信息可在<a class="ae ky" href="https://stackoverflow.com/questions/68275857/urllib-error-urlerror-urlopen-error-ssl-certificate-verify-failed-certifica" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="fb97" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">音频文件</h1><p id="5807" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">为了比较这两种方法，我将使用我在关于<a class="ae ky" rel="noopener" target="_blank" href="/transcribe-large-audio-files-offline-with-vosk-a77ee8f7aa28"> Vosk </a>的文章中使用的相同音频源:随机播客片段。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“Opto Sessions -非凡投资者访谈”播客中的音频文件。spotify 上的第69集。</p></figure><blockquote class="oq or os"><p id="36cc" class="kz la on lb b lc ld ju le lf lg jx lh ot lj lk ll ou ln lo lp ov lr ls lt lu im bi translated">请注意:这是一个随机的选择，我与创作者没有任何联系，也没有因为命名他们而获得报酬。如果您在此处看到错误(例如，502坏网关)，请重新加载页面。</p></blockquote><p id="0c54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于68分钟播客会议的转录结果会很长，我决定<strong class="lb iu">切掉60秒</strong>(否则，这篇文章包含的转录文本会比解释更多)。这里的挑战是，前30秒主要是引子的一部分，包含来自不同音频源的引用。</p><blockquote class="oq or os"><p id="7e0c" class="kz la on lb b lc ld ju le lf lg jx lh ot lj lk ll ou ln lo lp ov lr ls lt lu im bi translated">如果你只是想看看如何用耳语转录音频文件，你不必应用下面的代码。可以直接用Whisper读取. mp3文件。</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow op l"/></div></figure><h1 id="4860" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">抄本</h1><p id="922f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">有了我们准备好的音频文件，我们可以使用Whisper和Vosk开始转录它。</p><h2 id="e4c0" class="np mf it bd mg nq nr dn mk ns nt dp mo li nu nv mq lm nw nx ms lq ny nz mu oa bi translated">低语</h2><p id="d145" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">在我们转录相应的音频文件之前，我们必须先下载一个预先训练好的模型。目前，提供五种型号尺寸(表1)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/1fedf3a9bdfd47dd6e2315f7446d38ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZbRle5p13PG6Q9MNzNMtQ@2x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表1。Whisper不同型号的概述(Whisper的<a class="ae ky" href="https://github.com/openai/whisper" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a>)。</p></figure><p id="1dad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作者在他们的<a class="ae ky" href="https://github.com/openai/whisper" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a>上提到，对于纯英文应用程序来说，<code class="fe ob oc od oe b">.en</code>模型往往表现更好，尤其是对于<code class="fe ob oc od oe b">tiny.en</code>和<code class="fe ob oc od oe b">base.en</code>模型，而对于<code class="fe ob oc od oe b">small.en</code>和<code class="fe ob oc od oe b">medium.en</code>模型来说，差异会变得不那么显著。</p><blockquote class="oq or os"><p id="ed74" class="kz la on lb b lc ld ju le lf lg jx lh ot lj lk ll ou ln lo lp ov lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/openai/whisper#available-models-and-languages" rel="noopener ugc nofollow" target="_blank"> Whisper的GitHub页面</a>包含了更多关于他们模型性能的信息。</p></blockquote><p id="9158" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码显示了如何下载语言模型并运行转录:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow op l"/></div></figure><p id="395d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只用3行代码，我们就能转录一个音频文件。转录花了65秒，可以在下面看到。</p><blockquote class="oq or os"><p id="e2f9" class="kz la on lb b lc ld ju le lf lg jx lh ot lj lk ll ou ln lo lp ov lr ls lt lu im bi translated">我使用的是2015年年中的旧Macbook Pro(2.2 GHz四核英特尔酷睿i7和16GB内存)。</p></blockquote><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="129e" class="np mf it oe b gy oj ok l ol om">Right, that's the number one technical indicator. You do best by investing for the warm return. If you can't explain what the business is doing, then that is a huge red flag. Some technological change is going to put you out of business. It really is a genuinely extraordinary situation. Hi everyone, I'm Ed Goffam and welcome to OptoSessions where we interview the top traders and investors from around the world uncovering the secrets to success. On today's show, I'm delighted to introduce Beth Kindig, a technology analyst with over a decade of experience in the private markets. She's now the co founder of I.O. Fund, which specialises in helping individuals gain a competitive advantage when investing in tech growth stocks. How does Beth do this? She's gained hands on experience over the years. Here's fast eye Organul..</span></pre><p id="0611" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转录的结果是非常好的和全面的。如上所述，播客的介绍包含来自不同来源的质量不同的音频片段(例如，引用)。然而，Whisper可以很好地转录音频，还可以处理标点符号(例如，逗号、句号和问号)。</p><h2 id="b8e2" class="np mf it bd mg nq nr dn mk ns nt dp mo li nu nv mq lm nw nx ms lq ny nz mu oa bi translated">沃斯克</h2><p id="782a" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">和Whisper类似，我们也要为Vosk下载一个预先训练好的模型。所有可用型号的列表可在<a class="ae ky" href="https://alphacephei.com/vosk/models" rel="noopener ugc nofollow" target="_blank">这里</a>找到。我决定用最大的一个(1.8GB): <code class="fe ob oc od oe b">vosk-model-en-us-0.22</code></p><p id="e212" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码显示了如何使用Vosk:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow op l"/></div></figure><p id="f43d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管Whisper也有类似的方法(滑动30秒窗口)，但我们必须在这里做更多的手工编码。</p><p id="9676" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们加载我们的音频文件(<code class="fe ob oc od oe b">line 5</code>)和我们的模型(<code class="fe ob oc od oe b">lines 10-11</code>)。然后我们读取前4000帧(<code class="fe ob oc od oe b">line 17</code>)并把它们交给我们加载的模型(<code class="fe ob oc od oe b">line 20</code>)。该模型返回(以JSON格式)结果，该结果作为dict存储在<em class="on"> result_dict </em>中。然后，我们只提取文本值，并将其附加到我们的转录列表中(<code class="fe ob oc od oe b">line 24</code>)。</p><p id="1ce9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有更多的帧需要读取(<code class="fe ob oc od oe b">line 18</code>)，循环就停止，我们通过调用<em class="on"> FinalResult() </em>方法(<code class="fe ob oc od oe b">line 27</code>)来捕捉最终结果。此方法还会刷新整个管道。</p><p id="53b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">35秒后，创建了以下结果:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="27ff" class="np mf it oe b gy oj ok l ol om">the price is the number one technical indicator you do best by investing for the longer term if you can't explain what the business is doing then that is a huge red flag some technological changes puts you out of business it really is a genuine be extraordinary situation hi everyone i am a gotham and welcome to opto sessions where we interview top traders and investors from around the world uncovering the secrets to success on today's show i'm delighted to introduce beth can dig a technology analyst with over a decade of experience in the private markets she's now the co-founder of iowa fund which specializes in helping individuals gain a competitive advantage when investing in tech growth stocks how does beth do this well she's gained hands-on experience over the years whilst i</span></pre><p id="d47a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更好地与Whiper的输出进行比较，我再次将它粘贴到这里:</p><pre class="kj kk kl km gt of oe og oh aw oi bi"><span id="4c56" class="np mf it oe b gy oj ok l ol om">Right, that's the number one technical indicator. You do best by investing for the warm return. If you can't explain what the business is doing, then that is a huge red flag. Some technological change is going to put you out of business. It really is a genuinely extraordinary situation. Hi everyone, I'm Ed Goffam and welcome to OptoSessions where we interview the top traders and investors from around the world uncovering the secrets to success. On today's show, I'm delighted to introduce Beth Kindig, a technology analyst with over a decade of experience in the private markets. She's now the co founder of I.O. Fund, which specialises in helping individuals gain a competitive advantage when investing in tech growth stocks. How does Beth do this? She's gained hands on experience over the years. Here's fast eye Organul..</span></pre><p id="469f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，沃斯克在正确抄写大部分单词方面做得很好。但是，它最大的弱点是不使用标点符号。这使得很难阅读转录。</p></div><div class="ab cl oy oz hx pa" role="separator"><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd pe"/><span class="pb bw bk pc pd"/></div><div class="im in io ip iq"><h1 id="65d7" class="me mf it bd mg mh pf mj mk ml pg mn mo jz ph ka mq kc pi kd ms kf pj kg mu mv bi translated">结论</h1><p id="ef6b" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">让Whisper开源对整个机器学习社区非常有益。与Vosk等现有开源解决方案相比，Whisper只需要几行代码，支持标点符号，并能更好地转录单词。因此，当离线转录(大)音频文件时，我更喜欢Whisker而不是Vosk。</p><p id="0656" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对Whisper项目、架构以及他们不同模型的性能和相关论文更感兴趣，你应该访问他们的<a class="ae ky" href="https://github.com/openai/whisper" rel="noopener ugc nofollow" target="_blank"> GitHub页面</a>。</p><h1 id="3396" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">来源</h1><p id="8dcc" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated"><strong class="lb iu">耳语GitHub页面</strong>:【https://github.com/openai/whisper】T4</p><p id="9f70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">沃斯克车型</strong>:<a class="ae ky" href="https://alphacephei.com/vosk/models" rel="noopener ugc nofollow" target="_blank">https://alphacephei.com/vosk/models</a></p><p id="7ce3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">我之前的文章:</strong> <em class="on">用Vosk离线转录大音频文件</em>:<a class="ae ky" rel="noopener" target="_blank" href="/transcribe-large-audio-files-offline-with-vosk-a77ee8f7aa28">https://towardsdatascience . com/register-large-audio-files-offline-with-Vosk-a 77 ee 8 f 7 aa 28</a></p></div></div>    
</body>
</html>