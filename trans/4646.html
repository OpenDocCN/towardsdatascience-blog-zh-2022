<html>
<head>
<title>Nonlinear Time Series — an intuitive introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">非线性时间序列——直观介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/nonlinear-time-series-an-intuitive-introduction-7390aae8b446#2022-10-16">https://towardsdatascience.com/nonlinear-time-series-an-intuitive-introduction-7390aae8b446#2022-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0884" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为什么标准的时间序列分析程序有时会失败？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f501192e8dcd9b0189bb58ff56a9895b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ziX7pAGm0tWxXUOS.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://pixabay.com/pl/photos/zabytek-czechy-czech-praga-rathaus-92861/" rel="noopener ugc nofollow" target="_blank"> sebo106 </a>拍摄</p></figure><p id="902f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:本文假设您已经熟悉SARIMAX模型。如果你不是，请先检查一下。</p><h2 id="1595" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">介绍</h2><p id="ccd3" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我在学习时间序列分析的时候，很多次听人说“<strong class="ky ir"> <em class="mq">如果AR模型解决不了，试试ARIMA </em> </strong> <em class="mq">”。</em></p><p id="a95c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我会听到“<strong class="ky ir"> <em class="mq">”如果ARIMA不工作，检查季节性组件</em> </strong>”。</p><p id="6d65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将继续下去:“<strong class="ky ir"> <em class="mq">如果萨里玛不起作用，尝试添加新的变量，使其成为萨里玛或ARDL </em> </strong>”。</p><p id="37b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当那不行的时候，我听到了“<strong class="ky ir"> <em class="mq">协整呢？</em></strong><em class="mq"/>老实说——在很多情况下，这就足够了。</p><p id="3b54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，当你说以上都不起作用时，事情就有点紧张了。这时，即使是最平和、最善良的计量经济学家也会开始紧张，并说:“<em class="mq">如果真的什么都不管用，就去做一个天真的预测，或者只是假设平均值</em>”甚至是你听到过的最悲伤的句子:“<em class="mq">好吧，那就不可预测了</em>”。</p><p id="f727" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是是吗？</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h2 id="828b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak">线性和非线性</strong></h2><p id="fc48" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">首先，值得注意的是，我提到的所有模型都基于线性回归，识别程序基于滞后变量之间的线性关系或ECM项。这种方法显然是正确的，但是，在某些情况下，它可能被证明是不完整的。我给你举个简单的例子。我生成了一个时间序列:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/4d677608828533d753b63ebc1e59f4f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*hhxXC_2v234njuDM5JoKDA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">生成的时间序列</p></figure><p id="334a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我在做一个标准的EDA。在某一点上，我必须检查时间序列的自相关性:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/cd39ba7c5483e923fe5b05c05f9ea26a.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*-RYC3zoaZSfGJv9sE347gQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">对生成的时间序列进行ACF测试</p></figure><p id="c713" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看到这张图表后，你的第一个结论是什么？ARIMA出局了，也许是没有自回归成分的季节性模型？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/a5f065969b44087930342202ef9e4e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cmqEZmaZgNhleGwl.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从我的生活中</p></figure><p id="7dd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在继续之前，我必须承认我骗了你一点——我生成的时间序列是完全确定的，只取决于第一个滞后！事实上，您可以使用以下代码生成完全相同的时间序列:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="4022" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您现在可能已经注意到，ACF测试在检测数据之间的真实关系方面失败得很惨。我们从这个测试中发现的唯一或多或少正确的是季节性。为了理解为什么会发生这种情况，看一下这个视频:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd nc l"/></div></figure><p id="6a1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但现在，我们来看看它的滞后情节:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/4bcf84990fe9dca142b41c50c61684fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*fitK6q-l8cvi0bcUpg7yEg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">具有AR线的确定性时间序列的滞后图</p></figure><p id="43cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">红线是适合该数据集的回归线。可以看到，时刻<em class="mq"> t </em>和<em class="mq"> t-1 </em>之间的关系是二次的。换句话说，一个<em class="mq">线性</em>模型怎么可能预测到它？我向你们展示这一切是因为我想让你们意识到，即使在最友好的非线性环境中，标准的Box-Jenkins方法也可能不起作用。</p><p id="bfd8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么如何检验非线性时间序列相关性呢？一种方法(当然不是唯一的，也不是在所有情况下都有效)是使用平均互信息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3b9ae298c287f804da03ad04189e1010.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*5ItFB5C0FkwpEZQfHhm1Cg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">确定性时间序列的AMI</p></figure><p id="db8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这看起来确实比我们从ACF测试中学到的更接近真相。请注意，这里我们也可以找到季节性的迹象。在现实生活中很难找到确定性的时间序列(我猜除了物理学)，所以让我们继续讨论非确定性的情况。我们将分析另一个时间序列(人工数据集，用<em class="mq"> tsDyn </em>生成)。其ACF和AMI图如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/25dcfeef44abbdaca66cc436ddf20d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*JzJ27Dzefn45AMVeyym2Gw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ACF和AMI</p></figure><p id="c562" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它的滞后曲线是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/0f3971e7e5ce3cb0043a540a3f33b53b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*LbzcfQ69AWmij2KGbdqmww.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">具有AR线的非确定性时间序列的滞后图</p></figure><p id="8d61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你能说在这一点上ARIMA是否会工作吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/fdc1e3530ccc8a82fe144e34665beda1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vDu69mdWEcam7bmGIpoqtg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">pmdarima估计的ARIMA模型</p></figure><p id="0bd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据ACF测试——不存在自相关，所以auto-arima只拟合截距。通常这意味着，我们的预测不会很好。那我们该怎么办？事实上，有非线性模型可以处理这种时间序列，但我不想让这篇文章太专业，所以我现在不打算解释它的属性(也许在另一篇文章中？).不管怎样，让我比较一下非线性SETAR和线性ARIMA的结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/a042bd7131cf6a58d6d8f5904d746a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Id9anHJZYlm48TQ-hU0jKw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">时间序列和样本内预测</p></figure><p id="f44e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这两者之间的差异是显而易见的——线性ARIMA无法像SETAR一样对这一时间序列建模。由于序列本身不是自相关的，所以检查残差的自相关性是没有意义的，但是，我们能做的是比较初始时间序列中的残差、ARIMA残差和SETAR残差之间的AMI:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/083a8d3f71f0972d63a46ddcf7dfeeae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*8hMxphLrgJe0S2-F0WpxIQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ARIMA和塞塔模型残差的AMI</p></figure><p id="1132" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SETAR残差不再像初始序列和ARIMA残差那样在第一次滞后时有尖峰，因此它是更好的模型。在这一点上，你可能会认为，非线性时间序列和线性时间序列之间有明显的区别。<strong class="ky ir">错了！</strong>虽然存在无法使用Box-Jenkins方法处理的情况(如上例),但大多数非线性时间序列乍一看都是线性的。而且，很多时候线性模型的表现要优于非线性模型！这是因为我们在预测时所做的是最小化某个误差函数。根据哪一个是你的标准，你会得到不同的结论。让我给你看另一个非线性时间序列的例子，它比上面两个更容易找到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/a8a54b95031df8ba6534b06a57ac47fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yBDk6V4FZzr7GYmhTSk0Ig.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">滞后图(人工数据集，用<em class="nk"> tsDyn </em>生成)</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/5bea99ebf8bcf4b24d0fe26b2a628680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*JOjx9k9oEw79qY7g11fOsw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ACF测试图(人工数据集，用<em class="nk"> tsDyn </em>生成)</p></figure><p id="3d79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你在做分析时看到它，你会说它是线性的还是非线性的？ACF测试表明这里存在显著的自相关。虽然我可以向你保证，事实上这个时间序列是非线性生成的，<strong class="ky ir">但我不能保证ARIMA不会做出更好的预测</strong>——这取决于满足什么需求。此外，当你处理非线性模型时，你更容易出现错误的识别和过度拟合。</p><h2 id="5d55" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">摘要</h2><p id="aedd" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">时间序列中有不同类型的非线性关系，不可能在一篇文章中展示所有这些关系，但我想给你一个简单直观的非线性时间序列介绍，以及为什么现实生活中最流行的方法可能会失败。虽然在大多数情况下，标准ARIMA会做得很好，但非线性依赖的世界要复杂得多。</p><p id="00d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，没有一个单一的程序可以处理所有这些问题，因为可能同时发生的非线性的排列数目几乎是无限的。现代贝叶斯、半参数和非参数技术确实在这方面提供了一些帮助——尽管它们肯定不会为我们做所有的工作，但它们可以自动化其中的一些工作，并通过数据驱动的方法覆盖更广泛的可能解决方案。</p><p id="9d1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">别忘了跟着我<a class="ae kv" href="https://medium.com/@michacukrowski" rel="noopener">上媒</a>！</p><p id="9625" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，请随时通过LinkedIn 联系我。</p><div class="nm nn gp gr no np"><a rel="noopener follow" target="_blank" href="/threshold-autoregressive-models-beyond-arima-r-code-6af3331e2755"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">门限自回归模型——超越ARIMA + R码</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">满足TAR——自回归模型的非线性扩展。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">towardsdatascience.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od kp np"/></div></div></a></div><div class="nm nn gp gr no np"><a href="https://medium.com/@michacukrowski/lasso-vs-auto-arima-for-time-series-forecasting-out-of-sample-944a8835eae0" rel="noopener follow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">Lasso与auto-arima在时间序列预测中的比较(样本外)</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">lasso和auto-arima在样本外预测中的比较——一个实验。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">medium.com</p></div></div><div class="ny l"><div class="oe l oa ob oc ny od kp np"/></div></div></a></div><div class="nm nn gp gr no np"><a href="https://medium.com/@michacukrowski/ridge-lasso-and-elastic-net-vs-d73e24208057" rel="noopener follow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">时间序列预测的正则化与自动Arima(样本外)[实验]</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">岭、套索、弹性网和auto-arima用于样本外时间序列预测的比较。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">medium.com</p></div></div><div class="ny l"><div class="of l oa ob oc ny od kp np"/></div></div></a></div></div></div>    
</body>
</html>