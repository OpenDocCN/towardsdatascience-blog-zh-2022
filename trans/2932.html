<html>
<head>
<title>Store Unlimited Data for Free on IPFS and Retrieve it with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在IPFS上免费存储无限数据，并使用Python检索</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/store-unlimited-data-for-free-on-ipfs-and-retrieve-it-with-python-8db7297b493d#2022-06-27">https://towardsdatascience.com/store-unlimited-data-for-free-on-ipfs-and-retrieve-it-with-python-8db7297b493d#2022-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5167" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何将分散存储整合到您的工作流程中</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6ce58145db2960b003383c276b5ab3b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-mdSPFAlLK-e18UqdAZKw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卡特琳娜·林皮索妮“上传”(来源<a class="ae ky" href="https://undraw.co/illustrations" rel="noopener ugc nofollow" target="_blank">https://undraw.co/illustrations</a>)</p></figure><p id="ddf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">新兴技术，如星际文件系统(<a class="ae ky" href="https://ipfs.io" rel="noopener ugc nofollow" target="_blank">【IPFS】</a>，可以促成一个更加可验证和开放的生态系统。由于IPFS依赖于<a class="ae ky" href="https://web3.storage/docs/concepts/content-addressing/" rel="noopener ugc nofollow" target="_blank">内容标识符</a> (CIDs)，这是内容的散列，您可以确信返回的数据是正确的。此外，IPFS是一个开放的公共网络。因此，任何人都可以访问网络上的内容，如果他们有正确的CID。</p><p id="04d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我特别兴奋的一个项目是<a class="ae ky" href="https://web3.storage" rel="noopener ugc nofollow" target="_blank"> web3.storage </a>，这是一项免费服务，减少了使用分散存储的摩擦。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/06e723b3e21dc61b891a364a16567050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLfBUsMwbVYMp4gXwH_KUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">经许可使用的截图(来源:<a class="ae ky" href="https://web3.storage/pricing/" rel="noopener ugc nofollow" target="_blank">https://web3.storage/pricing/</a>)</p></figure><p id="4e25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将…</p><ul class=""><li id="53a9" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">介绍web3.storage以及如何设置它</li><li id="5972" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">提供Python中IPFS的基本CRUD操作示例</li><li id="808e" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">描述我当前创建分散数据存储库的解决方案</li></ul></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="8990" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">web3.storage简介</h1><blockquote class="nj"><p id="6c17" class="nk nl it bd nm nn no np nq nr ns lu dk translated">我们今天的目标是提供一个用户友好的体验，极大地减少今天在web3生态系统中引入新用例的负担，同时为未来提供一个升级路径。— <a class="ae ky" href="https://web3.storage" rel="noopener ugc nofollow" target="_blank"> Web3。存储</a></p></blockquote><p id="5da3" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">Web3。存储允许用户和开发者使用由IPFS和Filecoin网络提供的分散存储。任何上传的内容都会在地理位置分散的存储提供商之间进行复制，从而确保网络的弹性。该服务还处理将您的内容固定在多个服务器上的工作。</p><p id="62b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意你上传的内容，因为任何人都可以访问网络上的内容。但是，您可以在上传前加密内容。我的经验是，<strong class="lb iu">只上传你觉得永久公开的内容。</strong></p><p id="462b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">永久部分很重要。与基于位置的寻址(如URL)不同，<a class="ae ky" href="https://web3.storage/docs/concepts/content-addressing/" rel="noopener ugc nofollow" target="_blank">基于内容的寻址</a>(如CIDs)使得数据一旦上传就很难从网络中删除，因为它可能被固定在多个服务器上。</p><p id="b5d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的配额最初上限为1tb，但可以通过提交请求免费增加。开销成本目前由协议实验室补贴，这可能会在不久的将来转换到某种形式的加密原生支付模式(例如，增加Filecoin以增加存储限制)。</p><p id="3249" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将一切联系在一起的支柱是IPFS，这是一种超媒体协议，旨在通过数据的内容而不是位置来寻址数据，从而使网络更具弹性。为了做到这一点，IPFS使用cid而不是URL——URL指向托管数据的服务器。</p><p id="3549" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">web3.storage还有很多东西，如果你也对这个项目感兴趣，我鼓励你探索一下<a class="ae ky" href="https://web3.storage/docs/" rel="noopener ugc nofollow" target="_blank">文档</a>——尤其是如果你是一名开发人员。</p><h2 id="6bfe" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">设置web3.storage</h2><blockquote class="nj"><p id="0a9c" class="nk nl it bd nm nn no np nq nr ns lu dk translated">转到<a class="ae ky" href="https://web3.storage/" rel="noopener ugc nofollow" target="_blank"> https://web3.storage </a>创建一个帐户</p></blockquote><p id="b5f9" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">详细说明见<a class="ae ky" href="https://web3.storage/docs/#create-an-account" rel="noopener ugc nofollow" target="_blank">文件</a>。</p><h2 id="1c2b" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">创建API令牌</h2><p id="83de" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">从命令行使用web3.storage需要一个<a class="ae ky" href="https://web3.storage/docs/#get-an-api-token" rel="noopener ugc nofollow" target="_blank"> API令牌</a></p><ol class=""><li id="5dfa" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu oq mc md me bi translated">登录您的<a class="ae ky" href="https://web3.storage/account/" rel="noopener ugc nofollow" target="_blank"> web3.storage帐户</a></li><li id="b42a" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu oq mc md me bi translated">点击顶部的<strong class="lb iu">账户</strong>，然后<strong class="lb iu">创建API令牌</strong></li><li id="2860" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu oq mc md me bi translated">为您的令牌输入一个描述性名称，然后单击<strong class="lb iu">创建</strong></li><li id="06af" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu oq mc md me bi translated">您可以单击<strong class="lb iu"> Copy </strong>将新的API令牌复制到您的剪贴板。</li></ol><p id="27ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要与任何人分享你的API密匙，它是你的帐户专用的。您还应该在某个地方记下令牌字段，并安全地存储它。</p><h2 id="3b7b" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">安装w3命令行界面</h2><p id="ff5a" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated"><code class="fe or os ot ou b"><a class="ae ky" href="https://github.com/web3-storage/web3.storage/tree/main/packages/w3#readme" rel="noopener ugc nofollow" target="_blank">w3</a></code> <a class="ae ky" href="https://github.com/web3-storage/web3.storage/tree/main/packages/w3#readme" rel="noopener ugc nofollow" target="_blank">命令行界面</a> (CLI)是基于节点的工具，用于从终端使用web3.storage</p><p id="e493" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Mac上，你可以通过<a class="ae ky" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制</a>轻松安装<code class="fe or os ot ou b">node</code>，这也是安装节点包管理器(<code class="fe or os ot ou b">npm</code>)。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="e7a0" class="nz ms it ou b gy oz pa l pb pc">brew install node</span></pre><p id="2f51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe or os ot ou b">npm</code>安装<code class="fe or os ot ou b"><a class="ae ky" href="https://github.com/web3-storage/web3.storage/tree/main/packages/w3#readme" rel="noopener ugc nofollow" target="_blank">w3</a></code>命令行界面。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="a9d8" class="nz ms it ou b gy oz pa l pb pc">npm install -g @web3-storage/w3</span></pre><p id="18f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行以下命令将<code class="fe or os ot ou b">w3</code>连接到web3.storage。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="060b" class="nz ms it ou b gy oz pa l pb pc">w3 token</span></pre><p id="bbb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">系统将提示您输入之前创建的API令牌。</p><p id="7cd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面显示了有关每个可用命令的信息。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="b134" class="nz ms it ou b gy oz pa l pb pc">w3 --help</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/865d5ce70a9975a62ca70daaea6c942f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlfdWb_zuC_p2--xEbzO_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(使用<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">https://carbon.now.sh/</a>创建)</p></figure><p id="f9e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">上传和下载命令</strong></p><ul class=""><li id="6153" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe or os ot ou b">w3 put /path/to/file</code>(这是我们上传内容到web3.storage的方式)</li><li id="1f1a" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe or os ot ou b">w3 get CID</code>(这是我们如何从特定的CID下载内容)</li></ul><p id="a5c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">在web3.storage上列出您的文件</strong></p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="2c67" class="nz ms it ou b gy oz pa l pb pc">w3 list</span></pre><h2 id="9442" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">使用put的示例</h2><p id="0a28" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">首先，创建一个包含消息的文本文件。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="4d09" class="nz ms it ou b gy oz pa l pb pc">echo "Hello web3.storage" &gt; hello.txt</span></pre><p id="4cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们使用<code class="fe or os ot ou b">put</code>命令将文件推送到IPFS。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="99a6" class="nz ms it ou b gy oz pa l pb pc">w3 put hello.txt --name hello</span></pre><blockquote class="pe pf pg"><p id="6964" class="kz la ny lb b lc ld ju le lf lg jx lh ph lj lk ll pi ln lo lp pj lr ls lt lu im bi translated"><code class="fe or os ot ou b"><em class="it">hello</em></code>将是出现在web3.storage中的名称，使用<code class="fe or os ot ou b">w3 list</code>进行验证</p></blockquote><p id="243e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CID和一个<a class="ae ky" href="https://web3.storage/docs/how-tos/retrieve/#using-an-ipfs-http-gateway" rel="noopener ugc nofollow" target="_blank">公共网关链接</a>被输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/17b9f7e0151949de960190bd49211846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEzeozShLVxBJEMC9JiI1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片(使用<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">https://carbon.now.sh/</a>创建)</p></figure><p id="18ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您完全按照上述步骤操作，那么您的CID应该与我的一致。CID是唯一标识内容的散列。</p><p id="0974" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用下面的链接通过公共网关查看邮件。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="2a53" class="nz ms it ou b gy oz pa l pb pc"><a class="ae ky" href="https://dweb.link/ipfs/bafybeifzoby6p5khannw2wmdn3sbi3626zxatkzjhvqvp26bg7uo6gxxc4" rel="noopener ugc nofollow" target="_blank">https://dweb.link/ipfs/bafybeifzoby6p5khannw2wmdn3sbi3626zxatkzjhvqvp26bg7uo6gxxc4</a></span></pre><blockquote class="pe pf pg"><p id="0732" class="kz la ny lb b lc ld ju le lf lg jx lh ph lj lk ll pi ln lo lp pj lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>如果您的信息不同，链接也会不同</p></blockquote><h1 id="70a3" class="mr ms it bd mt mu pl mw mx my pm na nb jz pn ka nd kc po kd nf kf pp kg nh ni bi translated">使用Python检索内容</h1><p id="0642" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">将来，web3.storage有望与S3兼容，这意味着我们可以访问存储在那里的数据，就像我们访问S3桶中的数据一样。</p><p id="2480" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以使用HTTP请求将数据读入Python。然而，像<code class="fe or os ot ou b">pandas</code>这样的库允许我们直接从网关URL读取CSV文件。另外，<code class="fe or os ot ou b">ipfsspec</code>允许我们用<code class="fe or os ot ou b">xarray</code>从IPFS读取<code class="fe or os ot ou b">zarr</code>数据存储。</p><p id="2b60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在接下来的几节中，我将演示如何阅读这些内容</p><h2 id="b577" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">阅读JSON</h2><p id="3525" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">下面是一个读取存储在IPFS上的<code class="fe or os ot ou b">.json</code>文件的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pq pr l"/></div></figure><h2 id="4229" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">读取CSV文件</h2><p id="f4ad" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">如果您有一个CSV文件，您可以将它直接读入一个<code class="fe or os ot ou b">pandas</code>数据帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pq pr l"/></div></figure><h1 id="5593" class="mr ms it bd mt mu pl mw mx my pm na nb jz pn ka nd kc po kd nf kf pp kg nh ni bi translated">扎尔和IPFS</h1><p id="0407" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">Zarr 格式是一种新的存储格式，它使得大型数据集可以轻松地被分布式计算访问，这是对常用的NetCDF格式的一种改进，NetCDF是一种存储多维数据的格式。</p><p id="f3a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你开始转向zarr格式，我鼓励你看看Pangeo的“<a class="ae ky" href="https://pangeo.io/data.html#guide-to-preparing-cloud-optimized-data" rel="noopener ugc nofollow" target="_blank">准备云优化数据指南</a>”。</p><p id="480d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">NetCDF文件仍然很常见，xarray的函数可以很容易地将这些NetCDF文件转换成zarr数据存储。</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="9b3e" class="nz ms it ou b gy oz pa l pb pc">import xarray as xr<br/>ds = xr.open_dataset('/path/to/file.nc')<br/>ds.to_zarr("./file.nc", consolidated=True)</span></pre><p id="8a73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe or os ot ou b">consolidated=True</code>创建一个“隐藏的”点文件和数据存储，使得用<code class="fe or os ot ou b">xarray</code>从zarr读取数据更快。在一个简单的测试中，我发现读取整合的数据存储比未整合的快5倍。</p><p id="88dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> zarr(合并):</strong> 635毫秒</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pq pr l"/></div></figure><p id="3b06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">zarr(未合并): 3.19秒</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pq pr l"/></div></figure><p id="2271" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想测试上面的代码，我上传了<a class="ae ky" href="https://psl.noaa.gov/data/gridded/data.noaa.oisst.v2.html" rel="noopener ugc nofollow" target="_blank"> NOAA最优插值SST V2数据集</a>在合并和非合并的zarr格式到IPFS。该数据集提供了从1990年到现在的海洋表面温度(SST)的每周平均值，空间分辨率为1度。</p><p id="dd72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据的网关URL如下所示</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="f32f" class="nz ms it ou b gy oz pa l pb pc"><a class="ae ky" href="https://dweb.link/ipfs/bafybeicocwmfbct57lt62klus2adkoq5rlpb6dfpjt7en66vo6s2lf3qmq" rel="noopener ugc nofollow" target="_blank">https://dweb.link/ipfs/bafybeicocwmfbct57lt62klus2adkoq5rlpb6dfpjt7en66vo6s2lf3qmq</a></span></pre><h2 id="b846" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">将Zarr数据存储上传到IPFS</h2><p id="96e4" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">当上传<code class="fe or os ot ou b">zarr</code>文件到IPFS时，你必须确保上传“隐藏”的点文件。对于<code class="fe or os ot ou b">w3</code>，这需要添加<code class="fe or os ot ou b">--hidden</code>标志:</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="f10c" class="nz ms it ou b gy oz pa l pb pc">w3 put ./* --hidden --name filename.zarr</span></pre><h2 id="9488" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">从IPFS读取Zarr数据存储</h2><p id="d373" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">为了用<code class="fe or os ot ou b">xarray</code>从IPFS读取zarr数据存储，你需要<code class="fe or os ot ou b"><a class="ae ky" href="https://github.com/fsspec/ipfsspec" rel="noopener ugc nofollow" target="_blank">ipfsspec</a></code>包(以及<code class="fe or os ot ou b">xarray</code>和<code class="fe or os ot ou b">zarr</code>)</p><pre class="kj kk kl km gt ov ou ow ox aw oy bi"><span id="29f9" class="nz ms it ou b gy oz pa l pb pc">conda install -c conda-forge xarray zarr<br/>pip install ipfsspec</span></pre><p id="1247" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe or os ot ou b">ipfsspec</code>确保<code class="fe or os ot ou b">xarray</code>能够解释IPFS协议。</p><p id="d8bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在下面的例子中，我使用的是IPFS协议，而不是HTTPS的网关URL。然而，在幕后，代码实际上是从网关读取的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pq pr l"/></div></figure><h1 id="9c85" class="mr ms it bd mt mu pl mw mx my pm na nb jz pn ka nd kc po kd nf kf pp kg nh ni bi translated">分散数据仓库</h1><p id="2a27" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">IPFS可以用作数据仓库。但是，您需要将CID链接到人类可读的内容，这样才能成为一个可行的解决方案。我不知道任何关于CID管理的最佳实践。然而，从NFT数据的最佳实践中得到一些启示，我目前的方法是将cid和它们相关的文件名作为一对<code class="fe or os ot ou b">key:value</code>存储在JSON中，然后使用一个<a class="ae ky" href="https://www.mongodb.com/nosql-explained" rel="noopener ugc nofollow" target="_blank"> NoSQL数据库</a>，比如<a class="ae ky" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> MongoDB </a>，用于查询。</p><p id="0f8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将内容上传到web3.storage后，向文件中添加一条新记录，用于标识数据集和内容的CID。这是所需的最少信息量。</p><p id="d859" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个存储为JSON数组的CIDs示例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pq pr l"/></div></figure><p id="dc16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe or os ot ou b"><a class="ae ky" href="https://www.mongodb.com/docs/drivers/pymongo/" rel="noopener ugc nofollow" target="_blank">pymongo</a></code>包使得在Python中使用MongoDB变得容易。</p><ul class=""><li id="4eb6" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><a class="ae ky" href="https://medium.com/analytics-vidhya/connecting-to-mongodb-atlas-with-python-pymongo-5b25dab3ac53" rel="noopener">使用Python-PyMongo连接到MongoDB Atlas】</a></li><li id="a656" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://realpython.com/introduction-to-mongodb-and-python/" rel="noopener ugc nofollow" target="_blank">用真正的Python介绍MongoDB和Python </a></li><li id="36dc" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><a class="ae ky" href="https://www.mongodb.com/docs/drivers/pymongo/" rel="noopener ugc nofollow" target="_blank"> pymongo文档</a></li></ul><p id="0196" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个将记录插入集合，然后在数据库中查询特定CID的示例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pq pr l"/></div></figure><h2 id="9abc" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">替代方法</h2><p id="cf97" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">我一直在考虑的另一种方法是利用<code class="fe or os ot ou b">w3 list</code>的输出，但还没有实现。</p><p id="994a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将显示您在上传内容时提供的CID和名称。</p><p id="4c0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想法是编写一个<code class="fe or os ot ou b">awk</code>脚本，从输出中生成一个JSON文件。</p><p id="9146" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这方面的一些缺点或陷阱包括:</p><ul class=""><li id="7eda" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">处理指向目录而不是纯文件的cid</li><li id="9165" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">忽略与您的数据库无关的cid</li></ul><p id="3c48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我认为最大的障碍是处理目录。仅仅因为这个原因，我坚持手动更新我的数据库，特别是因为它很小并且易于管理——至少现在是这样。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="738f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">最后的想法</h1><p id="b9fb" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">IPFS可能是一个长期存储的地方，CIDs的功能类似于内置的版本控制。</p><p id="b2f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe or os ot ou b">w3</code> CLI使得将数据推送到IPFS变得容易，任何通用格式(JSON、CSV、Zarr)都可以从IPFS读入Python。</p><p id="3be1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，使用IPFS的一个挑战是CID管理。我当前创建分散式数据存储库的解决方案是在MongoDB中将cid及其相关文件名存储为键值对。这个解决方案有点笨拙，我愿意接受如何改进这个设置的建议。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h2 id="f5fd" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">将IPFS用于虚拟主机</h2><p id="2347" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">IPFS的另一个伟大的应用是托管网站。我的个人网页位于IPFS。我想我想出了一个优雅的解决方案来管理一个分散的网站，你可以在下面的文章中了解我的解决方案。</p><div class="ps pt gp gr pu pv"><a href="https://betterprogramming.pub/modern-way-to-host-a-site-on-ipfs-7941b65d27c3" rel="noopener  ugc nofollow" target="_blank"><div class="pw ab fo"><div class="px ab py cl cj pz"><h2 class="bd iu gy z fp qa fr fs qb fu fw is bi translated">在Ipfs上托管站点的现代方式</h2><div class="qc l"><h3 class="bd b gy z fp qa fr fs qb fu fw dk translated">使用web3.storage、GitHub Actions和IPNS</h3></div><div class="qd l"><p class="bd b dl z fp qa fr fs qb fu fw dk translated">better编程. pub</p></div></div><div class="qe l"><div class="qf l qg qh qi qe qj ks pv"/></div></div></a></div><h2 id="b0ca" class="nz ms it bd mt oa ob dn mx oc od dp nb li oe of nd lm og oh nf lq oi oj nh ok bi translated">Storj:另一种分散存储选择</h2><p id="7c95" class="pw-post-body-paragraph kz la it lb b lc ol ju le lf om jx lh li on lk ll lm oo lo lp lq op ls lt lu im bi translated">最后，IPFS不是你唯一的选择。如果你想要一个S3兼容的对象存储，那么我建议你去看看Storj。Storj解决方案依赖于通过分散的网络存储加密数据的碎片，而不是复制您的数据。这是一项付费服务，但非常实惠，尤其是如果您目前正在使用AWS。我个人在日常工作中使用Storj。如果你有兴趣了解我如何使用Storj，请查看下面的文章。</p><div class="ps pt gp gr pu pv"><a href="https://betterprogramming.pub/storj-decentralized-cloud-storage-my-new-favorite-cloud-object-storage-99d95ddc4e6a" rel="noopener  ugc nofollow" target="_blank"><div class="pw ab fo"><div class="px ab py cl cj pz"><h2 class="bd iu gy z fp qa fr fs qb fu fw is bi translated">Storj分散式云存储:我的新宠云对象存储</h2><div class="qc l"><h3 class="bd b gy z fp qa fr fs qb fu fw dk translated">Storj提供150 GB的免费存储和无缝Python集成</h3></div><div class="qd l"><p class="bd b dl z fp qa fr fs qb fu fw dk translated">better编程. pub</p></div></div><div class="qe l"><div class="qk l qg qh qi qe qj ks pv"/></div></div></a></div></div></div>    
</body>
</html>