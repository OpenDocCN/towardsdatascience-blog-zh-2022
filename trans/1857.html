<html>
<head>
<title>Why do we set a random state in machine learning models?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们为什么要在机器学习模型中设置随机状态？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-do-we-set-a-random-state-in-machine-learning-models-bb2dc68d8431#2022-04-30">https://towardsdatascience.com/why-do-we-set-a-random-state-in-machine-learning-models-bb2dc68d8431#2022-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3d6d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">随机状态=42</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b25de78e7cbe53ff58a585ab2833ee39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M7_GzV-glZaZLNuSiNdiPQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4879559" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ky" href="https://pixabay.com/users/aalmeidah-4277022/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=4879559" rel="noopener ugc nofollow" target="_blank"> aalmeidah </a></p></figure><p id="b8f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能已经在你的机器学习模型中使用了<strong class="lb iu"> <em class="lv">随机状态</em> </strong>。你知道<strong class="lb iu"> <em class="lv">随机状态</em> </strong>是一个模型超参数，用来控制机器学习模型中涉及的随机性吗？</p><p id="080d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Scikit-learn中，随机状态超参数用<code class="fe lw lx ly lz b">random_state</code>表示。它通常采用下列值之一。</p><ul class=""><li id="b324" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu mf mg mh mi bi translated"><strong class="lb iu">无:</strong>这是默认值。这允许函数使用来自<code class="fe lw lx ly lz b">np.random</code>的全局随机状态实例。如果你用<code class="fe lw lx ly lz b">random_state=None</code>多次调用同一个函数，这个函数在不同的执行中会产生不同的结果。</li><li id="af87" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><strong class="lb iu"> int: </strong>我们可以用整数来表示<code class="fe lw lx ly lz b">random_state</code>。是啊！我们可以使用包括0在内的任何整数，但不能使用负数，只能使用正整数。最流行的整数是0和42。当我们对<code class="fe lw lx ly lz b">random_state</code>使用整数时，该函数将在不同的执行中产生相同的结果。只有当我们改变整数值时，结果才会改变。</li></ul><h1 id="0899" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">使用随机状态——一个经典的例子</h1><p id="ce62" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">下面我们用一个例子来看看<strong class="lb iu"> <em class="lv">随机态</em> </strong>是如何工作的。为此，我们使用Scikit-learn的<strong class="lb iu"> train_test_split() </strong>函数和<strong class="lb iu"> LinearRegression() </strong>函数。<strong class="lb iu"> train_test_split() </strong>函数用于将数据集分成训练集和测试集。默认情况下，该函数在分割前会对数据进行混洗(使用<code class="fe lw lx ly lz b">shuffle=True</code>)。<strong class="lb iu"> train_test_split() </strong>函数中的随机状态超参数控制洗牌过程。</p><p id="9295" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了<code class="fe lw lx ly lz b">random_state=None</code>，我们在不同的执行中得到不同的训练和测试集，洗牌过程失去了控制。</p><p id="0bb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe lw lx ly lz b">random_state=0</code>，我们在不同的执行中得到相同的训练和测试集。使用<code class="fe lw lx ly lz b">random_state=42</code>，我们在不同的执行中得到相同的训练和测试集，但是在这一次，训练和测试集与之前使用<code class="fe lw lx ly lz b">random_state=0</code>的情况不同。</p><p id="d2a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">训练集和测试集直接影响模型的性能得分。因为我们在<strong class="lb iu"> train_test_split() </strong>函数中为<code class="fe lw lx ly lz b">random_state</code>获得了具有不同整数值的不同训练和测试集，所以随机状态超参数的值间接影响了模型的性能得分。</p><p id="d09e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，请看下面的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="ak">随机状态超参数的影响</strong>(作者代码)</p></figure><p id="5f44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们为<code class="fe lw lx ly lz b">random_state</code>尝试整数值0、35和42，并重新执行上述代码三次。我们会得到以下结果。</p><ul class=""><li id="0c23" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu mf mg mh mi bi translated">对于<code class="fe lw lx ly lz b">random_state=0</code>，我们得到909.81的RMSE。</li><li id="1045" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated">对于<code class="fe lw lx ly lz b">random_state=35</code>，我们得到794.15的RMSE。</li><li id="a520" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated">对于<code class="fe lw lx ly lz b">random_state=42</code>，我们得到824.33的RMSE。</li></ul><p id="0e60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据随机状态超参数中使用的整数值，我们得到模型的三个显著不同的RMSE值。</p><p id="5640" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，有一个明确的问题。我们接受什么样的价值观为正确的RMSE价值观？我们不接受任何单一的价值。相反，我们得到这些RMSE值的平均值。最好尽可能多地(例如10次)重新执行上述代码，并获得平均RMSE。手动做这个很无聊。相反，我们可以使用sci kit-learn<strong class="lb iu">cross _ val _ score()</strong>函数来自动完成这项工作。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="ak">执行交叉验证以获得平均RMSE </strong>(作者代码)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d22f7dff48af3e594e0b65a03851de03.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*JCt8pEcU8o9KwUvykoXEyg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd no">交叉验证结果</strong>(图片由作者提供)</p></figure><h1 id="5f28" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">使用随机状态的其他流行的机器学习算法</h1><p id="d195" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated"><strong class="lb iu"> train_test_split() </strong>函数是一个使用随机状态的经典例子。除此之外，下面的机器学习算法包括随机状态超参数。</p><ul class=""><li id="917d" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu mf mg mh mi bi translated"><strong class="lb iu">k means():</strong>k means算法中的<code class="fe lw lx ly lz b">random_state</code>控制质心初始化的随机数生成。更多详情，请看<a class="ae ky" href="https://medium.com/mlearning-ai/k-means-clustering-with-scikit-learn-e2af706450e4" rel="noopener">我写的这篇文章</a>。</li><li id="a4f6" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><strong class="lb iu">RandomizedSearchCV():</strong>RandomizedSearchCV函数中的<code class="fe lw lx ly lz b">random_state</code>控制在不同执行中获取超参数组合样本的随机化。更多详情，请看<a class="ae ky" rel="noopener" target="_blank" href="/python-implementation-of-grid-search-and-random-search-for-hyperparameter-optimization-2d6a82ebf75c">我写的这篇文章</a>。</li><li id="c141" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><strong class="lb iu"> DecisionTreeRegressor() </strong>或<strong class="lb iu">DecisionTreeClassifier():</strong>这些算法中的<code class="fe lw lx ly lz b">random_state</code>通过搜索最佳特征来控制节点分裂过程中涉及的随机性。它将定义树结构。</li><li id="752a" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><strong class="lb iu">RandomForestRegressor()</strong>或<strong class="lb iu">RandomForestClassifier():</strong>这些算法中的<code class="fe lw lx ly lz b">random_state</code>控制两个随机过程——在创建树时引导样本，以及在创建每棵树的节点分裂过程中获取随机特征子集以搜索最佳特征。更多详情，请看<a class="ae ky" rel="noopener" target="_blank" href="/random-forests-an-ensemble-of-decision-trees-37a003084c6c">我写的这篇文章</a>。</li><li id="6b08" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><strong class="lb iu">椭圆包络():</strong>椭圆包络函数中的<code class="fe lw lx ly lz b">random_state</code>决定了用于混洗数据的随机数发生器。更多细节，请阅读我写的这篇文章。</li></ul><h1 id="a66f" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">何时使用随机状态</h1><p id="f4b1" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">以下几点给出了“我们为什么要在机器学习模型中设置随机状态”这个问题的答案—今日话题。</p><p id="74d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们通常在机器学习模型中使用随机状态，原因如下。</p><ul class=""><li id="1486" class="ma mb it lb b lc ld lf lg li mc lm md lq me lu mf mg mh mi bi translated"><strong class="lb iu">一致性:</strong>有时，我们需要模型的不同执行之间的一致结果。当我写数据科学教程时，我总是为机器学习模型中的随机状态设置一个整数值。这是因为我需要在不同时间运行模型时得到相同的结果，并且我希望您在试用我的代码时得到相同的结果。</li><li id="8598" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><strong class="lb iu">实验目的:</strong>有时候，我们手动调优我们的模型。在这些情况下，我们希望保持所有其他的超参数，包括随机状态常数，除了我们正在调整的那个。为此，我们可以为机器学习模型中的随机状态设置一个整数。</li><li id="7797" class="ma mb it lb b lc mj lf mk li ml lm mm lq mn lu mf mg mh mi bi translated"><strong class="lb iu">提高模型性能:</strong>有时，您可以通过使用不同的随机状态多次运行您的模型来获得显著的性能提高。这是因为<code class="fe lw lx ly lz b">random_state</code>也是一个超参数，我们可以调整它以获得更好的结果。这在编写教程和参加机器学习竞赛时非常有用。但是不建议在生产环境或其他类似的实际场景中使用这种方法，在这些场景中，准确度分数的微小变化都会严重影响最终结果。</li></ul><h1 id="4123" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">何时不使用随机状态</h1><p id="2c4b" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">这是一个令人困惑的问题。当您没有为随机状态超参数指定一个整数时，默认的<code class="fe lw lx ly lz b">None</code>总是在后台应用。<code class="fe lw lx ly lz b">None</code>允许函数使用来自<code class="fe lw lx ly lz b">np.random</code>的全局随机状态实例。这也是模型所依赖的一种单随机状态！</p><p id="60fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，不指定随机状态并不意味着函数不使用随机状态。它使用一个由NumPy随机状态实例定义的。</p><p id="935c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这要危险得多，在生产环境、医疗领域等现实生活场景中应该避免。作为一个解决方案，我们可以通过做<a class="ae ky" rel="noopener" target="_blank" href="/k-fold-cross-validation-explained-in-plain-english-659e33c0bc0">交叉验证</a>来得到平均值，就像我之前讨论的那样。</p><h1 id="89bd" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">摘要</h1><p id="48c7" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">不同类型的随机化任务涉及机器学习模型和其他相关功能。当分割数据集、分割决策树或随机森林中的节点、初始化聚类中的质心时，会发生随机化。随机状态超参数用于控制机器学习模型中涉及的任何此类随机性，以获得一致的结果。</p><p id="57db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用交叉验证来减轻机器学习模型中涉及的随机性的影响。</p><p id="e820" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随机状态超参数直接控制不同函数的多种类型的随机性。</p><pre class="kj kk kl km gt np lz nq nr aw ns bi"><span id="44c7" class="nt mp it lz b gy nu nv l nw nx">from sklearn.model_selection import train_test_split<br/>from sklearn.ensemble import RandomForestRegressor</span><span id="c792" class="nt mp it lz b gy ny nv l nw nx">X_train, X_test, y_train, y_test = train_test_split(<strong class="lz iu">random_state=42</strong>)</span><span id="0edc" class="nt mp it lz b gy ny nv l nw nx">rf = RandomForestRegressor(<strong class="lz iu">random_state=42</strong>)</span></pre><p id="bf7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使我们对两个随机状态使用了同一个整数，每个函数的随机性也是独立控制的。互不影响。</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="10e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天的帖子到此结束。</p><p id="6482" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有任何问题或反馈，请告诉我。</p><p id="df94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢阅读这篇文章。如果你愿意支持我成为一名作家，请考虑 <a class="ae ky" href="https://rukshanpramoditha.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="lv">注册会员</em> </strong> </a> <em class="lv">以获得无限制的媒体访问权限。它只需要每月5美元，我会收到你的会员费的一部分。</em></p><div class="og oh gp gr oi oj"><a href="https://rukshanpramoditha.medium.com/membership" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">通过我的推荐链接加入Medium</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">rukshanpramoditha.medium.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox ks oj"/></div></div></a></div><p id="c8a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢你一直以来的支持！下一篇文章再见。祝大家学习愉快！</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><h2 id="1600" class="nt mp it bd mq oy oz dn mu pa pb dp my li pc pd na lm pe pf nc lq pg ph ne pi bi translated">接下来阅读(推荐)——我写的！</h2><p id="7fd8" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">通过例子学习如何做交叉验证。</p><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/k-fold-cross-validation-explained-in-plain-english-659e33c0bc0"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">用简单的英语解释k倍交叉验证</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">用于评估模型的性能和超参数调整</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="pj l ou ov ow os ox ks oj"/></div></div></a></div><p id="a159" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">了解随机森林如何在幕后工作，以及随机森林中涉及的两种随机性。</p><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/random-forests-an-ensemble-of-decision-trees-37a003084c6c"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">随机森林——决策树的集合</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">这就是决策树组合成随机森林的方式</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="pk l ou ov ow os ox ks oj"/></div></div></a></div><p id="368a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">了解参数和超参数之间的区别。</p><div class="og oh gp gr oi oj"><a href="https://rukshanpramoditha.medium.com/parameters-vs-hyperparameters-what-is-the-difference-5f40e16e2e82" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">参数Vs超参数:区别是什么？</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">用4个不同的例子进行讨论</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">rukshanpramoditha.medium.com</p></div></div><div class="os l"><div class="pl l ou ov ow os ox ks oj"/></div></div></a></div></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="6869" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特别感谢Pixabay上的<a class="ae ky" href="https://pixabay.com/users/aalmeidah-4277022/" rel="noopener ugc nofollow" target="_blank"> aalmeidah </a>，<strong class="lb iu"> </strong>为我提供了这篇文章的封面图片。请注意，我稍微编辑了图像。</p><p id="1d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="pm pn ep" href="https://medium.com/u/f90a3bb1d400?source=post_page-----bb2dc68d8431--------------------------------" rel="noopener" target="_blank">鲁克山·普拉莫蒂塔</a><br/><strong class="lb iu">2022–04–30</strong></p></div></div>    
</body>
</html>