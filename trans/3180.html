<html>
<head>
<title>Getting Started with the Polars DataFrame Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Polars数据帧库入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-with-the-polars-dataframe-library-6f9e1c014c5c#2022-07-13">https://towardsdatascience.com/getting-started-with-the-polars-dataframe-library-6f9e1c014c5c#2022-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="88b9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用Polars dataframe库操作表格数据(并替换Pandas)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fc015131f67483d3286c126a3489313d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lEnn25a7SEn5dHY8"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">汉斯-尤尔根·马杰在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2e6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数使用Python的数据科学家/分析师都熟悉熊猫。如果你在数据科学领域，你可能已经投入了相当多的时间学习如何使用它们来操作你的数据。然而，对熊猫的主要抱怨之一是它在处理大型数据集时的速度和效率低下。幸运的是，有一个新的数据框架库试图解决关于熊猫的这一主要抱怨。</p><p id="dc0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Polars是一个完全用Rust编写的DataFrame库。在这篇文章中，我将带你了解极地犬的基本知识，以及如何用它来代替熊猫。在后续文章中，我将深入研究Polars的各种特性。</p><h1 id="38ec" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是Polars？</h1><p id="6f30" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">理解Polars的最好方法是，它是一个比Pandas更好的数据框架库。以下是极地狗相对于熊猫的一些优势:</p><ul class=""><li id="cd0a" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">Polars不对数据帧使用索引。消除索引使得操作数据帧变得更加容易(无论如何，索引在Pandas数据帧中是多余的)。</li><li id="c3bb" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">Polars使用<em class="ng"> Apache Arrow数组</em>在内部表示数据，而Pandas使用NumPy数组在内部存储数据。Apache Arrow arrays在加载时间、内存使用和计算等方面效率更高。</li><li id="891e" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">Polars比熊猫支持更多的并行操作。由于Polars是用Rust编写的，它可以并行运行许多操作。</li><li id="477c" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">Polars支持<em class="ng">懒评估</em>。根据你的查询，Polars将检查你的查询，优化它们，并寻找加速查询或减少内存使用的方法。而熊猫只支持<em class="ng">热切求值</em>，一遇到表达式就立刻求值。</li></ul><h1 id="6d4b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装Polars</h1><p id="cbf0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">要安装Polars，只需使用<code class="fe nh ni nj nk b">pip</code>命令:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="e237" class="np lw it nk b gy nq nr l ns nt"><strong class="nk iu">pip install polars</strong></span></pre><p id="0e29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，使用<code class="fe nh ni nj nk b">conda</code>命令:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="7ea2" class="np lw it nk b gy nq nr l ns nt"><strong class="nk iu">conda install polars</strong></span></pre><p id="63a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本文，我将假设您已经安装了Anaconda，并且熟悉Jupyter Notebook。</p><h1 id="117a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建Polars数据框架</h1><p id="4201" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">学习一个新库的最好方法是亲自动手。因此，让我们从导入<code class="fe nh ni nj nk b">polars</code>模块并创建Polars数据帧开始:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="578b" class="np lw it nk b gy nq nr l ns nt">import polars as pl</span><span id="648a" class="np lw it nk b gy nu nr l ns nt">df = pl.DataFrame(<br/>     {<br/>         'Model': ['iPhone X','iPhone XS','iPhone 12',<br/>                   'iPhone 13','Samsung S11','Samsung S12',<br/>                   'Mi A1','Mi A2'],<br/>         'Sales': [80,170,130,205,400,30,14,8],     <br/>         'Company': ['Apple','Apple','Apple','Apple',<br/>                     'Samsung','Samsung','Xiao Mi','Xiao Mi'],<br/>     }<br/>)<br/>df</span></pre><p id="4836" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像熊猫一样，Polars在Jupyter Notebook中展示数据帧时会将其打印出来:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e143acdea386e99cdd938d835e050753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*W4kPmYW5LOafa09J7XubhQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5c24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Polars希望列标题名称是字符串类型。考虑下面的例子:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="8d4d" class="np lw it nk b gy nq nr l ns nt">df2 = pl.DataFrame(<br/><strong class="nk iu">     {<br/>        0 : [1,2,3],<br/>        1 : [80,170,130],<br/>     }<br/></strong>)</span></pre><p id="2362" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码片段将<em class="ng">而不是</em>工作，因为字典中的键是整数类型(0和1)。要使它工作，您需要确保键是字符串类型(“0”和“1”):</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="42c9" class="np lw it nk b gy nq nr l ns nt">import polars as pl<br/>df2 = pl.DataFrame(<br/>     {<br/>        <strong class="nk iu">"0"</strong> : [1,2,3],<br/>        <strong class="nk iu">"1"</strong> : [80,170,130],<br/>     }<br/>)</span></pre><p id="cef8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了显示每一列的标题名称，Polars还显示每一列的数据类型。如果想明确显示每一列的数据类型，使用<code class="fe nh ni nj nk b">dtypes</code>属性:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="4b12" class="np lw it nk b gy nq nr l ns nt">df.<strong class="nk iu">dtypes</strong></span></pre><p id="0937" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于上述示例，您将看到以下输出:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="278c" class="np lw it nk b gy nq nr l ns nt">[polars.datatypes.Utf8, <br/> polars.datatypes.Int64, <br/> polars.datatypes.Utf8]</span></pre><p id="3701" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得列名，使用<code class="fe nh ni nj nk b">columns</code>属性:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="ac32" class="np lw it nk b gy nq nr l ns nt"><strong class="nk iu">df.columns    </strong>#<strong class="nk iu"> </strong>['Model', 'Sales', 'Company']</span></pre><p id="05fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要以元组列表的形式获取数据帧的内容，请使用<code class="fe nh ni nj nk b">rows()</code>方法:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="b8da" class="np lw it nk b gy nq nr l ns nt">df.<strong class="nk iu">rows()</strong></span></pre><p id="aa98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于上述示例，您将看到以下输出:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="0b08" class="np lw it nk b gy nq nr l ns nt">[('iPhone X', 80, 'Apple'),<br/> ('iPhone XS', 170, 'Apple'),<br/> ('iPhone 12', 130, 'Apple'),<br/> ('iPhone 13', 205, 'Apple'),<br/> ('Samsung S11', 400, 'Samsung'),<br/> ('Samsung S12', 30, 'Samsung'),<br/> ('Mi A1', 14, 'Xiao Mi'),<br/> ('Mi A2', 8, 'Xiao Mi')]</span></pre><blockquote class="nw nx ny"><p id="b416" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated">Polars没有指数的概念，不像熊猫。Polars的设计理念明确指出索引在数据帧中没有用。</p></blockquote><h1 id="7f8b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">选择列</h1><p id="d8a8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在Polars中选择列非常简单——只需使用<em class="ng"/><code class="fe nh ni nj nk b">select()</code>方法指定列名:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="f955" class="np lw it nk b gy nq nr l ns nt">df.<strong class="nk iu">select</strong>(<br/>    'Model'<br/>)</span></pre><p id="e77f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述语句返回一个包含<em class="ng">型号</em>列的Polars数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/771f867da33a3a2fb8e7dfdc958c6451.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*IQja3sKGUXqPRc46ignQBQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><blockquote class="nw nx ny"><p id="7aeb" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated">Polars还支持方括号索引方法，这是大多数熊猫开发者都熟悉的方法。然而，Polars的文档特别提到方括号索引方法是Polars的<strong class="lb iu">反模式</strong>。虽然您可以使用<code class="fe nh ni nj nk b">df[:,[0]]</code>完成上述操作，但是在Polars的未来版本中，方括号索引方法可能会被删除。</p></blockquote><p id="88c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果需要多列，请以列表形式提供列名:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="6237" class="np lw it nk b gy nq nr l ns nt">df.select(<br/>    <strong class="nk iu">['Model','Company']</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/6037c6f6edb3e99efaa5ff27dc5a4089.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*_CjDtkyrUGQrYUbw02g5yw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="878e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果想要检索数据帧中的所有整数(特别是<code class="fe nh ni nj nk b">Int64</code>)列，可以在<code class="fe nh ni nj nk b">select()</code>方法中使用一个<em class="ng">表达式</em>:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="40b0" class="np lw it nk b gy nq nr l ns nt">df.select(<br/>    <strong class="nk iu">pl.col(pl.Int64)</strong><br/>)</span></pre><p id="5dea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">众所周知，语句<code class="fe nh ni nj nk b">pl.col(pl.Int64)</code>是一个极坐标表达式。该表达式被解释为“获取所有数据类型为Int64的列”。上述代码片段产生以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/d879d4501367b99d9cf20aa3508756c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*wG9tkiefi9Lsm9bHegB85Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e2fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在极性中，表达式是非常强大的。例如，你可以把<em class="ng">和</em>连在一起的表达式，就像这样:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="cb04" class="np lw it nk b gy nq nr l ns nt">df.select(<br/><strong class="nk iu">    pl.col(['Model','Sales']).sort_by('Sales')    </strong><br/>)</span></pre><p id="7229" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的表达式选择了<em class="ng">型号</em>和<em class="ng">销售</em>列，然后根据<em class="ng">销售</em>列中的值对行进行排序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1812d53822d9391e1d6cb646e88f1259.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*ScsColh7q5dCst6AuKR8IA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7e46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果需要多列，可以将表达式包含在列表中:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="a9d7" class="np lw it nk b gy nq nr l ns nt">df.select(<br/>    <strong class="nk iu">[pl.col(pl.Int64),'Company']</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/4c15037b990acde5adc7373fbf1cca2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*z5xm07KzCKEO58TjW0OJ2Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1af4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想获得所有字符串类型的列，请使用<code class="fe nh ni nj nk b">pl.Utf8</code>属性:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="3ec6" class="np lw it nk b gy nq nr l ns nt">df.select(<br/> <strong class="nk iu">   [pl.col(pl.Utf8)]</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/46eca9aa0ebcecf77bc32fccb9e31ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*P8zOGNZUyu7txZh5YNW6iQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><blockquote class="nw nx ny"><p id="6c78" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated">我将在以后的文章中更多地讨论表达式。</p></blockquote><h1 id="7ddc" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">选择行</h1><p id="3d0b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">要选择数据帧中的一行，使用<code class="fe nh ni nj nk b">row()</code>方法传入行号:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="fbb0" class="np lw it nk b gy nq nr l ns nt">df.row(0)   # get the first row</span></pre><p id="3882" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是一个元组:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="377f" class="np lw it nk b gy nq nr l ns nt">('iPhone X', 80, 'Apple')</span></pre><blockquote class="nw nx ny"><p id="bd77" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated">如果您需要基于行号获取多行，您需要使用方括号索引方法，尽管在Polars中这不是推荐的方法。以下是一些例子:</p><p id="21cd" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">df[:2]# first 2 rows</code> <br/> <code class="fe nh ni nj nk b">df[[1,3]] # second and fourth row</code></p></blockquote><p id="7d6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要选择多行，Polars建议使用<code class="fe nh ni nj nk b">filter()</code>功能。例如，如果您想要检索所有苹果产品，您可以使用以下表达式:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="c031" class="np lw it nk b gy nq nr l ns nt">df.filter(<br/>    <strong class="nk iu">pl.col('Company') == 'Apple'</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/35bf352fb581dd8f8443ec8e70f2f5ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*kxvKlUh86Sapu5MrRDx1SQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9e48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以使用逻辑运算符指定多个条件:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="c5c4" class="np lw it nk b gy nq nr l ns nt">df.filter(<br/><strong class="nk iu">    (pl.col('Company') == 'Apple') | <br/>    (pl.col('Company') == 'Samsung')<br/></strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5db8344b98ce924deba462def6af225a.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*I8XZZQL9_za3k8YD1I49hw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><blockquote class="nw nx ny"><p id="054e" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated">您可以在极坐标中使用以下逻辑运算符:</p><p id="41a8" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">|</code> —或者</p><p id="35ad" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">&amp;</code>——还有</p><p id="accd" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">~</code> —不</p></blockquote><h1 id="cf6a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">选择行和列</h1><p id="7826" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">通常，您需要同时选择行和列。您可以通过链接<code class="fe nh ni nj nk b">filter()</code>和<code class="fe nh ni nj nk b">select()</code>方法来实现，如下所示:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="f8c9" class="np lw it nk b gy nq nr l ns nt">df.<strong class="nk iu">filter</strong>(<br/>    pl.col('Company') == 'Apple'<br/>).<strong class="nk iu">select</strong>('Model')</span></pre><p id="e1f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的语句选择所有包含<em class="ng">苹果</em>的行，然后只显示<em class="ng">型号</em>列:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/464178b85ae1abe516c02b1a24560357.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*YRnyVIuVNe0WL2CoQOQaaw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a642" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您还想显示<code class="fe nh ni nj nk b">Sales</code>列，请向<code class="fe nh ni nj nk b">select()</code>方法传递一个列表:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="a43f" class="np lw it nk b gy nq nr l ns nt">df.filter(<br/>    pl.col('Company') == 'Apple'<br/>).select(<strong class="nk iu">[</strong>'Model'<strong class="nk iu">,'Sales']</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/16fce0d70e4c6e92b037748278d4b11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*-Jsfa8qihWjSVYVyckihtA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="f13a" class="np lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">如果你喜欢阅读我的文章，并且认为它对你的职业/学习有所帮助，请考虑注册成为一名灵媒会员。每月5美元，你可以无限制地访问Medium上的所有文章(包括我的)。如果你使用下面的链接注册，我会赚一小笔佣金(不需要你额外付费)。你的支持意味着我将能够投入更多的时间来写这样的文章。</h2><div class="pe pf gp gr pg ph"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd iu gy z fp pm fr fs pn fu fw is bi translated">加入媒介与我的介绍链接-李伟孟</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">阅读李维孟(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">weimenglee.medium.com</p></div></div><div class="pq l"><div class="pr l ps pt pu pq pv ks ph"/></div></div></a></div><blockquote class="nw nx ny"><p id="c838" class="kz la ng lb b lc ld ju le lf lg jx lh nz lj lk ll oa ln lo lp ob lr ls lt lu im bi translated">我将在即将到来的新加坡ML会议(2022年11月22-24日)上主持一个关于Polars的研讨会。如果你想在Polars数据框架上快速起步，请在<a class="ae ky" href="https://mlconference.ai/machine-learning-advanced-development/using-polars-for-data-analytics-workshop/" rel="noopener ugc nofollow" target="_blank">https://ml conference . ai/machine-learning-advanced-development/using-Polars-for-data-analytics-workshop/</a>上注册我的研讨会。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/b1bb1beb7127f109628516f77a2b9338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*3mrWppY0VhWWEoBm5A4qHA.png"/></div></figure><h1 id="9cc9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">摘要</h1><p id="386d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我已经向您展示了Polars数据框架的基础。您已经学习了提取行和列的基础知识以及<code class="fe nh ni nj nk b">select()</code>和<code class="fe nh ni nj nk b">filter()</code>方法的使用。以下是何时使用它们的快速总结:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/d62d0ba3db22938966f8bd64eef60330.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkaWc7LydeJA8hCI2LkrTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div></div>    
</body>
</html>