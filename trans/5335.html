<html>
<head>
<title>Advanced SQL techniques for beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的高级 SQL 技术</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/advanced-sql-techniques-for-beginners-211851a28488#2022-11-30">https://towardsdatascience.com/advanced-sql-techniques-for-beginners-211851a28488#2022-11-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3550" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从 1 到 10，你的数据仓库技能有多好？</h2></div><p id="5bdd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" href="https://gist.github.com/638f8f09346769ad480d11764f11975c" rel="noopener ugc nofollow" target="_blank"> Github </a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/ee65a554736818a370bec57e35f3eb7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QNLQ-9fM3Js4lY0j"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">杰斯·贝利在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6f0e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从 1 到 10，你的数据仓库技能有多好？想上 7/10 以上？这篇文章是给你的。</p><p id="ffb6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想尽快准备好数据分析师的工作面试吗？这篇博文详细解释了一些复杂的数据仓库 SQL 技术。我将使用 BigQuery 标准 SQL 方言来写下关于这个主题的一些想法。</p><h1 id="6e8a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">1.增量表和合并</h1><p id="631b" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">以正确的方式有效地更新表是很重要的。这的确很重要。理想的情况是当你有主键、唯一整数和自动增量的事务时。这种情况下的表更新很简单:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="8c29" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在现代数据仓库中处理非规范化的星型模式数据集时，情况并非总是如此。您可能需要用 SQL 创建<strong class="kk iu">会话</strong>和/或用一部分数据增量更新数据集。<code class="fe mu mv mw mx b">transaction_id</code>可能不存在，但你将不得不处理数据模型，其中唯一键依赖于已知的最新<code class="fe mu mv mw mx b">transaction_id</code>(或时间戳)。例如，<code class="fe mu mv mw mx b">last_online</code>数据集中的<code class="fe mu mv mw mx b">user_id</code>依赖于最近已知的连接时间戳。在这种情况下，您可能希望<code class="fe mu mv mw mx b">update</code>现有用户和<code class="fe mu mv mw mx b">insert</code>新用户。</p><h2 id="71e3" class="my lw it bd lx mz na dn mb nb nc dp mf kr nd ne mh kv nf ng mj kz nh ni ml nj bi translated">合并和增量更新</h2><p id="54ef" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">您可以使用<strong class="kk iu">合并</strong>或者将操作分成两个动作。一个用新记录更新现有记录，另一个插入不存在的全新记录(左连接情况)。</p><p id="8d49" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> MERGE </strong>是关系数据库中普遍使用的语句。Google BigQuery MERGE 命令是数据操作语言(DML)语句之一。它通常用于在一条语句中自动执行三个主要功能。这些功能是更新、插入和删除。</p><ul class=""><li id="e041" class="nk nl it kk b kl km ko kp kr nm kv nn kz no ld np nq nr ns bi translated">当两个或多个数据匹配时，可以使用 UPDATE 或 DELETE 子句。</li><li id="1a56" class="nk nl it kk b kl nt ko nu kr nv kv nw kz nx ld np nq nr ns bi translated">当两个或多个数据不同且不匹配时，可以使用 INSERT 子句。</li><li id="1132" class="nk nl it kk b kl nt ko nu kr nv kv nw kz nx ld np nq nr ns bi translated">当给定的数据与源数据不匹配时，也可以使用 UPDATE 或 DELETE 子句。</li></ul><p id="da3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着 Google BigQuery MERGE 命令允许您通过更新、插入和删除 Google BigQuery 表中的数据来合并 Google BigQuery 数据。</p><p id="9cbd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">考虑这个 SQL: </strong></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="5102" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们只用一个操作就完成了更新和插入。</p><h1 id="6cb4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">2.计数单词</h1><p id="4bc5" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">执行 UNNEST()并检查您需要的单词是否在您需要的列表中，这在许多情况下可能是有用的，例如数据仓库情感分析:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="e1bd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">3.在 SELECT 语句外使用 IF()语句</h1><p id="f13d" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">这给了我们一个机会来节省一些代码行，并且在代码方面更有说服力。通常情况下，您会希望将它放入一个子查询中，并在<strong class="kk iu"> where </strong>子句中添加一个过滤器，但是您可以改为执行<strong class="kk iu"> this </strong>:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="739d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一个例子是<strong class="kk iu">而不是</strong>如何与<strong class="kk iu">分区的</strong>表一起使用。<strong class="kk iu">不要这样</strong>。这是一个不好的例子，因为由于匹配的表后缀可能是动态确定的(基于你的表中的某些东西)，你<strong class="kk iu">将被收取全表扫描的费用。</strong></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="393c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也可以在<code class="fe mu mv mw mx b">HAVING</code>子句和<code class="fe mu mv mw mx b">AGGREGATE</code>函数中使用。</p><h1 id="7b8e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">4.使用分组依据汇总</h1><p id="b634" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">ROLLUP 函数用于在多个级别执行聚合。当您必须处理尺寸图时，这很有用。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ny"><img src="../Images/3865cbf90ea87c82b347102bfb7662d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xMRJPNdX8tI5kxFT.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="36bd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下查询根据在<strong class="kk iu"> where </strong>子句中指定的交易类型(is_gift)返回每天的信用消费总额，并且还显示每天的消费总额以及所有可用日期的消费总额。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="b0f0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">5.将表格转换成 JSON</h1><p id="864e" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">假设您需要将表转换成 JSON 对象，其中每条记录都是嵌套数组的一个元素。这就是<code class="fe mu mv mw mx b">to_json_string()</code>功能变得有用的地方:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="216b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后你可以在任何地方使用它:日期、营销漏斗、指数、直方图等。</p><h1 id="0391" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">6.使用分区依据</h1><p id="3dd1" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">给定<code class="fe mu mv mw mx b">user_id</code>、<code class="fe mu mv mw mx b">date</code>和<code class="fe mu mv mw mx b">total_cost</code>列。对于每个日期，如何在保留所有行的同时显示每个客户的总收入值？您可以这样实现:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="d18f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">7.移动平均数</h1><p id="e0b6" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">通常，BI 开发人员的任务是将移动平均值添加到报告和他们奇妙的仪表板中。这可能是 7 日、14 日、30 日/月甚至是年的 MA 线图。那么我们该怎么做呢？</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="1350" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">8.日期数组</h1><p id="04ee" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">当你使用<strong class="kk iu">用户保持</strong>或者想要检查一些数据集是否缺少值，例如日期时，变得非常方便。BigQuery 有一个函数叫做<code class="fe mu mv mw mx b">GENERATE_DATE_ARRAY</code>:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="2541" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我之前在这里写过:</p><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/retention-and-daily-active-users-explained-79c5dab1bf84"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">留存和日活跃用户解释。</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">针对 Firebase 用户、机器学习爱好者和营销人员的完整 Data Studio 指南和 BigQuery 教程。所有…</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq lp oc"/></div></div></a></div><h1 id="88f7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">9.Row_number()</h1><p id="bed2" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">这有助于从数据中获取最新信息，如最新更新的记录等。或者甚至删除重复项:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="0258" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">10.NTILE()</h1><p id="7fdf" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">另一个编号功能。如果你有一个手机应用程序，监控<code class="fe mu mv mw mx b">Login duration in seconds</code>这样的事情真的很有用。例如，我将我的应用程序连接到 Firebase，当用户使用<code class="fe mu mv mw mx b">login</code>时，我可以看到他们用了多长时间。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi or"><img src="../Images/7508e32fcc9e19f29161d2d8b9bf74a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AVayA4VFY24Z9orD.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">作者图片</p></figure><p id="5766" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该函数根据行排序将行划分到<code class="fe mu mv mw mx b">constant_integer_expression</code>桶中，并返回分配给每一行的从 1 开始的桶号。存储桶中的行数最多相差 1。余数值(行数除以时段的余数)从时段 1 开始为每个时段分配一个。如果<code class="fe mu mv mw mx b">constant_integer_expression</code>评估为空、0 或负，则提供错误。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c60d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，您可以找到如何使用 Firebase 和 Google Analytics 4 数据创建自定义用户活动和绩效仪表板的教程:</p><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/i-stopped-using-firebase-dashboards-ive-built-my-own-instead-299631185b41"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">我不再使用 Firebase 仪表盘。我自己建了一个。</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">你如何解释火基数字？以下是答案。包括简洁的模板以及示例 Firebase 数据集…</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="os l on oo op ol oq lp oc"/></div></div></a></div><h1 id="1832" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">11.等级/密集 _ 等级</h1><p id="cc96" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">它们也被称为<strong class="kk iu">编号</strong>功能。我倾向于使用<code class="fe mu mv mw mx b">DENSE_RANK</code> <strong class="kk iu">作为默认排名函数</strong>，因为它不会跳过下一个可用的排名，而<code class="fe mu mv mw mx b">RANK</code>会。它返回连续的等级值。您可以将它与一个将结果划分到不同存储桶的分区一起使用。如果每个分区中的行具有相同的值，它们将获得相同的等级。<strong class="kk iu">示例:</strong></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="3838" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">另一个关于产品价格的例子:</strong></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="504d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">12.透视/取消透视</h1><p id="2552" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">透视将行更改为列。这就是它的全部功能。Unpivot 做与相反的<a class="ae le" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unpivot_operator" rel="noopener ugc nofollow" target="_blank">。最后，它在 BigQuery 中可用:</a></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="5759" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">13.名值/姓值</h1><p id="ec9f" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">这是另一个有用的函数，它有助于获得特定分区中每一行相对于第一个/最后一个值的增量。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="bd09" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">14.将一个表转换成结构数组，并将它们传递给 UDF</h1><p id="e5f5" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">当您需要将带有复杂逻辑的用户定义函数(UDF)应用于每一行或每一个表时，这非常有用。你总是可以把你的表看作一个 STRUCT 类型对象的数组，然后把它们传递给 UDF。看你的逻辑了。例如，我用它来计算购买过期时间:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="5855" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以类似的方式，您可以创建不需要使用<strong class="kk iu"> UNION ALL </strong>的表。例如，我用它来模拟单元测试的一些测试数据。这样你可以在你的编辑器中使用<code class="fe mu mv mw mx b">Alt</code> + <code class="fe mu mv mw mx b">Shift</code> + <code class="fe mu mv mw mx b">Down</code>来快速完成。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><div class="nz oa gp gr ob oc"><a rel="noopener follow" target="_blank" href="/sql-unit-testing-in-bigquery-here-is-a-tutorial-64fc7a6b377"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd iu gy z fp oh fr fs oi fu fw is bi translated">BigQuery 中的 SQL 单元测试？这里有一个教程。</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">脚本和 UDF 测试完全指南。</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="ot l on oo op ol oq lp oc"/></div></div></a></div><h1 id="4f82" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">15.使用跟随和无限跟随创建事件漏斗</h1><p id="1cae" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">营销渠道就是一个很好的例子。您的数据集可能包含连续重复的相同类型的事件，但理想情况下，您会希望将每个事件与下一个不同类型的事件链接起来。当你需要得到某个东西的列表时，例如事件、购买等，这可能是有用的。为了建立一个漏斗数据集。使用 PARTITION BY it 使您有机会将以下所有事件分组，而不管每个分区中有多少个事件。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="78d0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">16.正则表达式</h1><p id="9be9" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">如果您需要从非结构化数据中提取某些信息，例如汇率、自定义分组等，您可以使用它。</p><h1 id="5d55" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用 regexp 处理货币汇率</h1><p id="ddb0" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">考虑汇率数据的这个例子:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="4654" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用 regexp 处理应用程序版本</h1><p id="2ef5" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">有时，您可能想使用<code class="fe mu mv mw mx b">regexp</code>为您的应用获取<strong class="kk iu">主要</strong>、<strong class="kk iu">发布</strong>或<strong class="kk iu">修改</strong>版本，并创建自定义报告:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="f083" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="a796" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">SQL 是帮助操作数据的强大工具。希望这些来自数字营销的 SQL 用例对你有用。这确实是一项方便的技能，可以帮助你完成许多项目。这些 SQL 片段让我的生活变得更加轻松，我几乎每天都在工作中使用它们。此外，SQL 和现代数据仓库是数据科学的必备工具。其强大的方言功能允许轻松地建模和可视化数据。因为 SQL 是数据仓库和商业智能专业人员使用的语言，如果您想与他们共享数据，它是一个很好的选择。这是与市场上几乎所有数据仓库/湖解决方案进行通信的最常见方式。</p><h1 id="2a7e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">推荐阅读:</h1><p id="ee62" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">[1]<a class="ae le" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/dml-syntax#merge_statement" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/big query/docs/reference/standard-SQL/DML-syntax # merge _ statement</a></p><p id="c04f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[6]<a class="ae le" rel="noopener" target="_blank" href="/how-to-compute-a-moving-average-in-bigquery-using-sql-15f3fedd7489">https://towards data science . com/how-to-compute-a-moving-average-in-big query-using-SQL-15 F3 fedd 7489</a></p><p id="5ad8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[11]<a class="ae le" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/window-function-calls" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/big query/docs/reference/standard-SQL/window-function-calls</a></p><p id="5e73" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[12]<a class="ae le" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#unpivot_operator" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/big query/docs/reference/standard-SQL/query-syntax # unpivot _ operator</a></p><p id="ed4c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[14]<a class="ae le" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators#first_value" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/big query/docs/reference/standard-SQL/functions-and-operators # first _ value</a></p></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="e279" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="pb">最初发表于</em><a class="ae le" href="https://mydataschool.com/blog/advanced-sql-techniques_for-beginners/" rel="noopener ugc nofollow" target="_blank">T5【https://mydataschool.com】</a><em class="pb">。</em></p></div></div>    
</body>
</html>