<html>
<head>
<title>Power BI Tips &amp; Tricks: Filter by Manager Hierarchy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Power BI提示和技巧:按经理层级过滤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/power-bi-tips-tricks-filter-by-manager-hierarchy-14e9a490b4d9#2022-05-05">https://towardsdatascience.com/power-bi-tips-tricks-filter-by-manager-hierarchy-14e9a490b4d9#2022-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e357" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Power BI中创建一个切片器，根据经理的控制范围进行过滤。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3bfbcbe4517b73b975c542f401bc6f3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ee3UaHb9bTn9MxskkWHaA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="815c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">问题简介</h1><p id="7626" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在Power BI中创建仪表板时，通常会有一个请求，要求查看领导控制范围内的数据。这意味着我们需要使用管理器层次结构创建一个切片器。因为我们不仅要包括经理的直接下属，还要包括他们的直接下属的报告(等等)，所以我们需要采取一些额外的步骤。</p><h1 id="13fb" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">过程</h1><ol class=""><li id="ec6e" class="mm mn it ls b lt lu lw lx lz mo md mp mh mq ml mr ms mt mu bi translated">创建一个包含员工ID和经理ID的文件</li><li id="28be" class="mm mn it ls b lt mv lw mw lz mx md my mh mz ml mr ms mt mu bi translated">使用PATH()函数确定员工的管理链</li><li id="6d91" class="mm mn it ls b lt mv lw mw lz mx md my mh mz ml mr ms mt mu bi translated">确定管理链的长度</li><li id="c8e6" class="mm mn it ls b lt mv lw mw lz mx md my mh mz ml mr ms mt mu bi translated">为链中的每个级别创建一列</li><li id="f6e9" class="mm mn it ls b lt mv lw mw lz mx md my mh mz ml mr ms mt mu bi translated">添加切片器</li></ol><h1 id="c1ee" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">1.创建文件</h1><p id="abe8" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">您的文件至少需要包含员工姓名、员工ID和经理ID。</p><p id="787a" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">有几件事要记住:</p><ul class=""><li id="d9c2" class="mm mn it ls b lt na lw nb lz nf md ng mh nh ml ni ms mt mu bi translated">员工ID在每一行中应该是唯一的值</li><li id="3b24" class="mm mn it ls b lt mv lw mw lz mx md my mh mz ml ni ms mt mu bi translated">每个经理ID需要有一行(每个经理也应该作为雇员出现在文件中)</li><li id="1981" class="mm mn it ls b lt mv lw mw lz mx md my mh mz ml ni ms mt mu bi translated">层次结构顶部的人员(例如，CEO)应该有一个空白的经理ID列</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/8b3690208987d600b39a8f78448fc828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q8n5WEtMJpNR85Q8ICg3NA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="574b" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">2.识别管理链</h1><p id="0d59" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">使用PATH()函数创建一个列来标识每个员工的管理链(他们的经理、他们经理的经理等)。)到层级的顶端。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/77705f432bf856c47b1cb641da84c818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bs4L2i9bxXW9hBEZt3ppTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="98de" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">Moira的管理链中只有她自己，因为她处于领导层级的顶端，而David的管理链中有三个人，因为他(1)向Johnny (2)报告，Johnny向Moira (3)报告。</p><h1 id="78ff" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">3.确定管理链的长度</h1><p id="2bd4" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">虽然这是一个小数据集，我们可以清楚地确定最长管理链的长度(3 ),但对于较大的数据集，这要困难得多。幸运的是，我们可以使用PATHLENGTH()函数来计算它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/92894d62ea1b4fa5b2179abe4eddb30e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*drKjlK2hm2NmvKsXEHiuKg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d302" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">我们这样做是为了确定需要添加多少列，以便组织的每个级别都有一个列。在我们的数据集中，有三个级别，所以我们要添加三列。</p><p id="eb8a" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">要查找最大路径长度，您可以按链长列对数据进行排序，或者创建一个度量值<em class="nm">“最大链长=最大(示例[链长])”</em></p><p id="083e" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">您还可以限制列的数量，以便只能筛选组织中的特定级别。例如，如果您只想筛选CEO以下的两个级别，那么您只需创建三列。要点是，您不必为组织中的每个级别创建一个列，如果您愿意，可以限制它。</p><h1 id="88f7" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">4.为每个级别创建一列</h1><p id="5ff4" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">现在，您将为要筛选的每个级别添加一列。您可以对每个列使用相同的DAX，只需更新Lvlnumber变量以匹配您所在的级别。例如，对于层次结构的第一级，Lvlnumber将是1，对于层次结构的第二级，Lvlnumber将是2，依此类推。</p><blockquote class="nn no np"><p id="dd71" class="lq lr nm ls b lt na ju lv lw nb jx ly nq nc mb mc nr nd mf mg ns ne mj mk ml im bi translated">level 1 =<br/>var Lvlnumber = 1<br/>var lvl key = path item(Example[管理链]，lvl number，INTEGER)<br/>var lvl Name = lookup value(Example[员工姓名]，Example[员工ID]，lvl key)<br/>var Result = lvl Name<br/>返回结果</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/1347102131a7a39725f0c7bc6d6d64c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKO5pnHeW0h7dHXKan8ACw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1cc1" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><em class="nm">事实:DAX正在寻找给定级别的员工ID，在本例中是1。因此，它获取管理链中的第一个员工ID 4001，然后查找该员工的姓名Moira Rose。</em></p><h1 id="ea86" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">5.添加切片器</h1><p id="a914" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">最后，您已经准备好为您的经理层次结构创建切片器。在“报表”视图中，添加一个切片器视图，然后添加您创建的希望能够作为筛选依据的每个级别列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/bb84f720f1ce95f384ba2f83d9de4831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qhBrozPZ23mePc7NrU_Xog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c78b" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">旁注，每个级别中的“(空白)”包括该个人。例如，约翰尼下面的“(空白)”包括约翰尼。这是一个有用的功能，您可以为领导过滤数据，但取消选中(空白)则领导看不到他们自己的数据。</p><p id="b0f3" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">现在你知道了！您现在可以通过领导者的控制范围来过滤您的数据。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><p id="d478" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。这是5美元一个月，我赚一小笔佣金，如果你使用我的推荐链接。</p><div class="oc od gp gr oe of"><a href="https://jeagleson.medium.com/membership" rel="noopener follow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">加入我的介绍链接-詹娜伊格尔森媒体</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">jeagleson.medium.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ks of"/></div></div></a></div><p id="5bdc" class="pw-post-body-paragraph lq lr it ls b lt na ju lv lw nb jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">詹娜·伊格尔森(Jenna eagle son)<em class="nm"><br/>我的背景是工业组织心理学，我已经在人物分析中找到了自己的家。数据使我的作品变得生动。我主要使用Power BI，但偶尔也会使用Tableau和其他工具。我很想听到更多关于你的旅程！在</em><a class="ae ou" href="https://www.linkedin.com/in/jenna-eagleson/" rel="noopener ugc nofollow" target="_blank"><em class="nm">Linkedin</em></a><em class="nm">或</em><a class="ae ou" href="https://twitter.com/JennaEagleson" rel="noopener ugc nofollow" target="_blank"><em class="nm">Twitter</em></a><em class="nm">上联系我。</em></p></div></div>    
</body>
</html>