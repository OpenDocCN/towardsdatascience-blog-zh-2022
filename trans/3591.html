<html>
<head>
<title>2 Must-Know PostgreSQL Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2个必须知道的PostgreSQL函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/2-must-know-postgresql-functions-50bbcc30032b#2022-08-09">https://towardsdatascience.com/2-must-know-postgresql-functions-50bbcc30032b#2022-08-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c714" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">举例说明</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5aeac92e8e3b3b19b6c63a0ad16dde4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ISMBOCq1k1WGpfCcyoIENw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(布莱恩·布里登在<a class="ae ky" href="https://unsplash.com/s/photos/life-saver?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae ky" href="https://unsplash.com/@bcbreeden?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="cc02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到存储在关系数据库中的大量结构化数据，数据科学家和分析师几乎每天都要与关系数据库进行交互。我们使用SQL来进行这些交互，这使得它成为数据科学中最受欢迎的技能之一。</p><p id="f6fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有许多不同的关系数据库管理系统(RDBMS)使用SQL与关系数据库中的数据进行交互和管理。流行的RDBMSs之一是PostgreSQL，它是开源的，在可靠性、特性健壮性和性能方面享有很高的声誉。</p><p id="3908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将学习2个PostgreSQL函数，它们简化了复杂的操作，在许多情况下派上了用场。我称它们为救生功能。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="df13" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.生成_系列</h1><p id="3fb7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">该函数可用于创建带有数字和日期的有序表格。日期的一个典型用例是，您有一个事件的开始和结束日期，并且需要将其扩展为一个日历。</p><p id="5a1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个例子。我们有一个包含酒店预订的预订表。它包括预订id、入住和退房日期。我们希望扩展它，以便更容易计算占用率。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2f65" class="ne md it na b gy nf ng l nh ni">SELECT<br/>    id,<br/>    generate_series(<br/>        checkIn, <br/>        checkOut, <br/>        INTERVAL '1 day'<br/>) AS booked<br/>FROM booking</span></pre><p id="b772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述查询将包括实际上不被视为已预订的退房日期。因此，为了准确标记预订的天数，我们需要在生成序列之前从退房日期中减去一天。</p><p id="4221" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是如何做到的:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="f0cd" class="ne md it na b gy nf ng l nh ni">SELECT<br/>    id,<br/>    generate_series(<br/>        checkIn, <br/>        (checkOut - INTERVAL '1 day'), <br/>        INTERVAL '1 day'<br/>) AS booked<br/>FROM booking</span></pre><p id="8b99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码的作用如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/49bff51a716a45909efff584fb8f14bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-5ra4CSZ263kf2RSSpF9ew.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="c575" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以将左边的桌子连接成日历桌，就这样！我们有一个标有预定日期的日历。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9dee" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.收件人_字符</h1><p id="3230" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">to_char函数可用于将时间戳、时间间隔或数值转换为格式化字符串。我发现它在从时间戳或日期中提取信息时最有用。</p><p id="a6a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其语法如下:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2367" class="ne md it na b gy nf ng l nh ni">TO_CHAR(expression, format)</span></pre><p id="a6c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用它来提取月份名称和月份缩写，分别使用' month '和' MON '格式。假设我们有一个预订表，其中有一个名为“已预订”的日期列。我们可以使用to_char函数提取这些片段，如下所示:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="54dc" class="ne md it na b gy nf ng l nh ni">select<br/>     booked,<br/>     to_char(booked, 'MONTH') AS month,<br/>     to_char(booked, 'MON') AS mon,<br/>from booking</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/fcdf6778c719a47b7e7b443ec82d41de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r59QvbYGlIx0f50JbHBfpQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="0b45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以获得字符串形式的年月信息:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7cb1" class="ne md it na b gy nf ng l nh ni">select<br/>     booked,<br/>     to_char(booked, 'YYYY-MM') AS yearmonth<br/>from booking</span></pre><p id="2b40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果日期是2022–10–08，则年月值将是2022–10。</p><p id="6e1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一些与日期相关的有用格式。例如，我们可以提取日期名称和数字。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="4b0c" class="ne md it na b gy nf ng l nh ni">select<br/>     booked,<br/>     to_char(booked, 'DY') AS day_name,<br/>     to_char(booked, 'DD') AS day,<br/>from booking</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/0bfb1620fdac40118c782f0f604e2c87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aZN3O2JRA6gt8-KLqkRPRA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="d529" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于不同的任务，还有其他可能有用的格式。您可以查看官方文档，了解to_char函数支持的其他格式。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="5165" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经介绍了PostgreSQL的两个重要功能。它们主要用于数据预处理，或者使原始数据更好地适合您随后要做的任务。这些函数实际上表明SQL不仅仅是一种查询语言，还是一种高效的数据分析和操作工具。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="89e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">你可以成为</em> <a class="ae ky" href="https://sonery.medium.com/membership" rel="noopener"> <em class="nm">媒介会员</em> </a> <em class="nm">解锁我的全部写作权限，外加其余媒介。如果你已经是了，别忘了订阅</em><a class="ae ky" href="https://sonery.medium.com/subscribe" rel="noopener"><em class="nm"/></a><em class="nm">如果你想在我发表新文章时收到电子邮件。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="edc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>