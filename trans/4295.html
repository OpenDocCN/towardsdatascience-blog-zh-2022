<html>
<head>
<title>Using Resample in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在熊猫中使用重采样</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-resample-in-pandas-14e5483593aa#2022-09-22">https://towardsdatascience.com/using-resample-in-pandas-14e5483593aa#2022-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="28ad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">学习如何使用熊猫重采样方法，这是一种处理基于时间的数据的很酷的方法</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/327a4cad4d84975e6f1fc968fd9dfc10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KgSnI0N4fmDftTC6"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">马库斯·斯皮斯克的照片</p></figure><p id="f18e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">基于时间的数据是最常见的数据格式之一，作为数据科学家，您可能会遇到这种情况。无论是历史特征(例如，客户数据)还是时间序列数据，都经常需要处理数据管道中的时间戳列。</p><p id="62cb" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你在2022年是一名数据科学家，你必须知道如何使用<code class="fe lw lx ly lz b">pandas</code>，这是最强大的Python库之一，可以处理数据。<code class="fe lw lx ly lz b">pandas</code>以其定期更新和新方法而闻名，适用于许多关于数据争论和操纵的任务。</p><p id="599e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">它最著名的方法之一是<code class="fe lw lx ly lz b">resample</code>方法，可以让你平稳地处理基于时间的数据。简而言之，<code class="fe lw lx ly lz b">resample</code>包含几个特性，可以帮助您以一种非常流畅的方式处理基于时间的分组和聚合，从而提高处理datetime列的速度和简单性。在过去，你可能不得不构造复杂的(甚至是错误的)函数，这将会很难维护。有了<code class="fe lw lx ly lz b">resample</code>,这种情况完全消失了，你可以更轻松地在<code class="fe lw lx ly lz b">pandas</code>数据框中摆弄日期。</p><p id="6695" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在本帖中，我们将探索关于这种方法的一些很酷的事情，以及应用它有多容易——特别是当我们想要为我们的数据科学算法创建基于时间的功能时。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="06b9" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">读取数据</h1><p id="93b8" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">首先，我将从加载一个时间序列数据集开始，该数据集由土耳其加利波利<a class="ae kz" href="https://www.kaggle.com/datasets/vivovinco/hourly-weather-data-in-gallipoli-20082021" rel="noopener ugc nofollow" target="_blank">2008年至2021年间的每小时天气数据组成——该数据集属于</a><a class="ae kz" href="https://www.meteoblue.com/" rel="noopener ugc nofollow" target="_blank"> Meteoblue </a>。</p><p id="00ce" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我从将这个数据集加载到Python开始:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="88f7" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data = pd.read_csv(‘../Hourly Weather Data in Gallipoli (2008–2021).csv’)</span></pre><p id="40cf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们看看数据集的前10行:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nn"><img src="../Images/771aebe47daf5b04df683af686deaced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LOLikwEPglmG6UQL0p9gTg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">Gallipoli数据集的先睹为快—图片由作者提供</p></figure><p id="bf62" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">要使用<code class="fe lw lx ly lz b">resample</code>，我们的数据必须满足两个条件:</p><ul class=""><li id="1664" class="no np it lc b ld le lg lh lj nq ln nr lr ns lv nt nu nv nw bi translated">我们将用来表示时间的列必须是<code class="fe lw lx ly lz b">datetime</code>数据类型。</li><li id="2e96" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated">该列必须放入数据帧的索引中。</li></ul><p id="b01e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">首先将<code class="fe lw lx ly lz b">DateTime</code>列转换为日期时间类型:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="5e99" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data[‘DateTime’] = pd.to_datetime(gallipoli_data[‘DateTime’])</span></pre><p id="4553" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">并将我们的列传递到数据帧的索引中:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="8943" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data.index = gallipoli_data[‘DateTime’]</span></pre><p id="8d87" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们的数据框准备好了！让我们也加载跟随这篇博文所需的库:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="77ac" class="ni mi it lz b gy nj nk l nl nm">import pandas as pd</span><span id="80b1" class="ni mi it lz b gy oc nk l nl nm">import numpy as np</span></pre><p id="f4f4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">一切都准备好了，让我们开始处理我们的<code class="fe lw lx ly lz b">resample</code>方法吧！</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="6656" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">使用重采样</h1><p id="0f70" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">让我们从一个简单的用例开始:假设我们希望获得Gallipoli每3小时的平均温度。虽然简单，但如果我们试图用基本Python或定制的<code class="fe lw lx ly lz b">pandas</code>代码来做这件事，就会有点麻烦，因为我们必须:</p><ul class=""><li id="b367" class="no np it lc b ld le lg lh lj nq ln nr lr ns lv nt nu nv nw bi translated">创建某种类型的每3小时增加一次的列；</li><li id="1883" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated">对该列使用group by</li></ul><p id="1505" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">虽然这可以用几行代码来管理，但是一行代码会更好，对吗？如果一个班轮也能够推广到其他时间框架(几周，几个月，几个季度甚至几分钟)呢？这正是<code class="fe lw lx ly lz b">resample</code>的作用！我们可以非常快速地对数据执行基于时间的快速聚合:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="fc60" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data.Temperature.resample(rule = ‘3h’).mean()</span></pre><p id="a35d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">下面是上面代码的输出:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ff6dbfcc7d6a013c71b0837440798eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*shgP7hzYUh3sBUlNVS_bNw.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">使用3h作为时间范围进行重新取样—图片由作者提供</p></figure><p id="a380" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">多酷？<code class="fe lw lx ly lz b">resample</code>方法包含一堆我们可以调节的旋钮，比如我们正在使用的规则或聚合函数。如果我们想检查3小时间隔内日照时间的最大值，你能猜到我们需要调整什么吗？我们只要把<code class="fe lw lx ly lz b">mean()</code>换成<code class="fe lw lx ly lz b">max()</code>！</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="b786" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data[‘Sunshine Duration’].resample(rule = ‘3h’).max()</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/df639692b8dd1809102eabae1a9864b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*n6j6D5I0WlbgrPA1tM4ClA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">使用3h作为时间帧，但使用最大值函数重新取样-作者提供的图像</p></figure><p id="2214" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了让这一点在<code class="fe lw lx ly lz b">resample</code>的引擎盖下更加清晰和突出，让我们来看看1月2日在加利波利举行的<code class="fe lw lx ly lz b">Sunshine Duration</code>的演变:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="ec8d" class="ni mi it lz b gy nj nk l nl nm">(<br/>    gallipoli_data.loc[<br/>        (gallipoli_data.DateTime &gt;= '2008-01-02') <br/>        &amp; <br/>        (gallipoli_data.DateTime &lt;= '2008-01-03')<br/>    ]<br/>)['Sunshine Duration'].plot(color='darkorange')</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi of"><img src="../Images/3be386cdfd35bc09b7c700101a08dc10.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*bbZGeDpTOz8VKqJB7J9Ujg.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">2008年1月2日的日照时间—图片由作者提供</p></figure><p id="5c1b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><code class="fe lw lx ly lz b">resample</code>所做的是通过应用以下内容对每三个小时的数据进行分组:</p><ul class=""><li id="6e94" class="no np it lc b ld le lg lh lj nq ln nr lr ns lv nt nu nv nw bi translated">从上午9点到12点，最大<code class="fe lw lx ly lz b">Sunshine Duration</code>是60。</li><li id="de58" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated">中午到下午15点，最大<code class="fe lw lx ly lz b">Sunshine Duration</code>60。</li><li id="2e5d" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated">从下午15点到18点，最大值<code class="fe lw lx ly lz b">Sunshine Duration</code>为38。</li></ul><p id="8d72" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这反映在我们上面看到的表格中—再次检查:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/df639692b8dd1809102eabae1a9864b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*n6j6D5I0WlbgrPA1tM4ClA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">使用最大值功能以3小时为时间范围进行重新取样—图片由作者提供</p></figure><p id="bb63" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">请注意，间隔在左侧是闭合的。这意味着与<code class="fe lw lx ly lz b">2008-01-02 09:00:00</code>相关的行聚集了从上午09:00:00到上午11:59:59的全部数据。如果我们想要改变这种行为，我们需要向<code class="fe lw lx ly lz b">resample</code>传递一个新的参数<code class="fe lw lx ly lz b">closed</code>:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="4c73" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data['Sunshine Duration'].resample(rule = '3h', closed= 'right').max()</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7794d7e1d43685cf9ca216a4f9a833cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*afuzGOQ2qWiBM78uCBzeAw.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">使用3h作为时间帧重新取样，使用Max和Closed = 'Right'—图片由作者提供</p></figure><p id="6c71" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在这种情况下，同一行<code class="fe lw lx ly lz b">2008-01-02 09:00:00</code>汇总从上午09:00:01到上午12:00:00的所有数据</p><p id="5296" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">拧动<code class="fe lw lx ly lz b">resample</code>旋钮非常容易。我们可能想要调整的另一个常见论点是时间框架聚合——例如，按周或月聚合我们的数据。这可能吗？让我们看看，下一个。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="8825" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">修改规则参数</h1><p id="886a" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated">使用<code class="fe lw lx ly lz b">rule</code>参数，我们不仅仅局限于每小时的聚合！这是<code class="fe lw lx ly lz b">resample</code>功能最酷的特性之一。例如，如果我们想要两周一次的汇总，我们可以:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="0c91" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data.Temperature.resample(rule = ‘2w’).mean()</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/95a904aacf206fe48dc56e0a6b859c41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*SZ7MHm3SUQzuL-nPXa3_pw.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">两周一次的温度汇总-图片由作者提供</p></figure><p id="70ef" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><code class="fe lw lx ly lz b">w</code>前的数字定义了我们想要分组的实例数量，而<code class="fe lw lx ly lz b">w</code>定义了我们想要一周的时间范围。</p><p id="311d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">你能猜出我们需要传递什么参数来聚合每4个月的数据吗？</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="cf32" class="ni mi it lz b gy nj nk l nl nm">gallipoli_data.Temperature.resample(rule = ‘4m’).mean()</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oi"><img src="../Images/057302bfd8905099fe3e29b625862dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*6Q1rq9oZ7oJQFpwSUHNkgw.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">4个月聚合示例—按作者分类的图像</p></figure><p id="60c4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">总之，<code class="fe lw lx ly lz b">rule</code>控制我们想要分组的时间间隔。您可以使用的一些最著名的<code class="fe lw lx ly lz b">rule</code>参数是:</p><ul class=""><li id="0abf" class="no np it lc b ld le lg lh lj nq ln nr lr ns lv nt nu nv nw bi translated"><code class="fe lw lx ly lz b">s</code>为秒</li><li id="eb39" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated"><code class="fe lw lx ly lz b">t</code>持续分钟</li><li id="8391" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated"><code class="fe lw lx ly lz b">h</code>数小时</li><li id="e36a" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated"><code class="fe lw lx ly lz b">w</code>为周</li><li id="b6b8" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated"><code class="fe lw lx ly lz b">m</code>持续数月</li><li id="99c7" class="no np it lc b ld nx lg ny lj nz ln oa lr ob lv nt nu nv nw bi translated"><code class="fe lw lx ly lz b">q</code>为季度</li></ul></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><h1 id="1773" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">填补空白</h1><p id="2ffc" class="pw-post-body-paragraph la lb it lc b ld mz ju lf lg na jx li lj nb ll lm ln nc lp lq lr nd lt lu lv im bi translated"><code class="fe lw lx ly lz b">resample</code>的另一个重要特性是，它可以帮助您通过理解数据中的缺口来创建更完整的数据框架。例如，假设我们有一个商店的每小时销售数据集:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="7bcc" class="ni mi it lz b gy nj nk l nl nm">date_range = pd.date_range('1/2/2022', periods=24, freq='H')<br/>sales = np.random.randint(100, 400, size=24)</span><span id="dc9c" class="ni mi it lz b gy oc nk l nl nm">sales_data = pd.DataFrame(<br/>    sales,<br/>    index = date_range,<br/>    columns = ['Sales']<br/>)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/8f1a1d5bfe1a3dfc5cf72c33614c680f.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*gGDVVMRNCWYSkvuXTjII3g.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">sales_data数据框架的标题—按作者分类的图像</p></figure><p id="3cc8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们删除上午10点的销售行。(想象这是真实发生的事情，并且在此期间该商店没有销售):</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="ea88" class="ni mi it lz b gy nj nk l nl nm">sales_data = sales_data.drop(sales_data.iloc[10].name)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/628a23afc4c28f704e027e1bb3d6ce79.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*VqUve1dzI9EgBuqsYYoirw.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">上午10点没有销售的销售数据数据框架的标题—作者图片</p></figure><p id="e07e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果我们将一个<code class="fe lw lx ly lz b">resample</code>应用到这个数据帧，将会出现一个带有<code class="fe lw lx ly lz b">NaN</code>的新行:</p><pre class="kk kl km kn gt ne lz nf ng aw nh bi"><span id="b533" class="ni mi it lz b gy nj nk l nl nm">pd.DataFrame(<br/>    sales_data.Sales.resample('h').mean()<br/>)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ok"><img src="../Images/bf19dd73a8843edb6a39fcc3f33886e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*u9o99cSy9MR9qoICRbGFAw.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">重新取样后上午10点没有销售额的sales_data数据帧的标题-作者图片</p></figure><p id="73d3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这在很多基于时间的场景中非常方便。通常情况下，如果我们的时间序列数据中有一个缺口，我们希望有一行来表示这个缺口，而<code class="fe lw lx ly lz b">resample</code>为我们提供了一个快速实现它的方法。在上面的例子中，我们甚至可以添加一个<code class="fe lw lx ly lz b">fillna(0)</code>来使我们上午10点的“缺乏销售”场景更加明显:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/719e0a68341053332c85e4e4fce0b581.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*ArxZb4aySnq_xHbJjb_lKQ.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">重新取样后上午10点没有销售额的sales_data数据帧的标题-作者图片</p></figure><p id="6e9f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">填补空白是我们在处理基于时间的数据时经常要做的事情。不仅仅是在创建特性的时候，也是在我们的数据管道中捕捉主要错误的一种方式。</p></div><div class="ab cl ma mb hx mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="im in io ip iq"><p id="d5f5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">感谢你花时间阅读这篇文章！</p><p id="2d10" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你使用基于时间的数据，并且以前从未使用过<code class="fe lw lx ly lz b">resample</code>,我真的建议你彻底学习这种方法，因为它将在你的数据转换过程中为你省去很多麻烦。</p><p id="1d5f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">无论是当我们构建基于时间的特性还是操作时序数据时，使用<code class="fe lw lx ly lz b">resample</code>会使我们的代码更加高效和简洁。正如我们已经讨论过的，这种方法对于捕捉基于时间的数据中的一些意外缺口也很方便，所以我希望您可以在未来的数据管道中使用本文中的知识！</p><p id="74c2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><em class="om">本帖使用的数据集在CC BY 4.0下，属于</em><a class="ae kz" href="https://www.meteoblue.com/" rel="noopener ugc nofollow" target="_blank"><em class="om">Meteoblue</em></a><em class="om">。</em></p><div class="on oo gp gr op oq"><a href="https://medium.com/membership/@ivopbernardo" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">通过我的推荐链接加入Medium-Ivo Bernardo</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">阅读我在Medium上的所有故事，了解更多关于数据科学和分析的信息。加入中级会员，您将…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">medium.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kt oq"/></div></div></a></div></div></div>    
</body>
</html>