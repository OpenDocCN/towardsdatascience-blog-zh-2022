<html>
<head>
<title>Getting Started with Data Cleaning in Python Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Pandas中的数据清理入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-with-data-cleaning-in-python-pandas-76d977f95b57#2022-05-11">https://towardsdatascience.com/getting-started-with-data-cleaning-in-python-pandas-76d977f95b57#2022-05-11</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="1486" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph">数据清理</h2><div class=""/><div class=""><h2 id="0883" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">使用流行的Python库执行数据清理的实际例子。</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/b38980870070431ae1bae8a48ff6a5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MY1E2eNLAiNodAt6"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">Mick Haupt 在<a class="ae lk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="cdb7" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><strong class="ln jg">数据清理是处理数据时必不可少的步骤之一。</strong>事实上，在大多数情况下，您的数据集是脏的，因为它可能包含丢失的值、重复的值、错误的格式等等。在没有清理数据的情况下运行数据分析可能会导致错误的结果，并且在大多数情况下，您甚至无法训练您的模型。</p><p id="b265" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">为了说明执行数据清理所需的步骤，我使用了一个非常有趣的数据集，由Open Africa提供，其中包含维多利亚湖4个子区域的历史和预测降雨量和径流量。该数据集在知识共享许可下发布，可通过<a class="ae lk" href="https://africaopendata.org/dataset/messy-data-for-data-cleaning-exercise" rel="noopener ugc nofollow" target="_blank">此链接</a>获得。我发现这个数据集非常有趣，因为虽然它很小，但它是故意脏的，因此它可以用来说明如何执行数据清理。</p><p id="741f" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">所以，我们继续吧！</p><p id="f14f" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">文章组织如下:</p><ul class=""><li id="ec4b" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">加载数据集</li><li id="1f3f" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">缺少值</li><li id="f0cc" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">数据标准化</li><li id="c39d" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">初步探索性数据分析。</li></ul><h1 id="a9a2" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">1加载数据集</h1><p id="bf61" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">数据集以Excel文件的形式提供，所以我通过<code class="fe ns nt nu nv b">read_excel()</code>函数加载它。为了正常工作，这个函数需要安装<code class="fe ns nt nu nv b">openpyxl</code>库。要安装它，你可以运行<code class="fe ns nt nu nv b">pip install openpyxl</code>。</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="ae47" class="oa mw iw nv b gz ob oc l od oe">import pandas as pd</span><span id="a635" class="oa mw iw nv b gz of oc l od oe">df = pd.read_excel('source/rainfall.xlsx')<br/>df.head()</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj og"><img src="../Images/3fd30fe01338fb8e83087e14eed5f844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sRjLeF85OHHR1c4ZXLWc_g.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="423b" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">数据集未正确加载，因为列名不正确。因此，我需要再次读取数据集，跳过前两行:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="8b7b" class="oa mw iw nv b gz ob oc l od oe">df = pd.read_excel('source/rainfall.xlsx', skiprows=2)<br/>df.head()</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj oh"><img src="../Images/445037009236fa378f7528823f624135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1h8XeDtINHWdNYlvd38J9w.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="c94a" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">还有一些额外的列，我可以通过<code class="fe ns nt nu nv b">usecols</code>参数删除它们:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="97ef" class="oa mw iw nv b gz ob oc l od oe">df = pd.read_excel('source/rainfall.xlsx', skiprows=2, usecols='B:D')<br/>df.head(20)</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj oi"><img src="../Images/b3cc1dbe4474fea8e00a5bb186e40aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*7MHBSX-fJB6DdvZ1L-oKxA.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><h1 id="c796" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">2个缺失值</h1><p id="bae4" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">有两排完全空着。我可以通过<code class="fe ns nt nu nv b">dropna()</code>功能放下它们:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="125f" class="oa mw iw nv b gz ob oc l od oe">df.dropna(inplace=True, axis=0)<br/>df.head(20)</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj oi"><img src="../Images/107f34ebec5830609331e04acd6bb311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*9WiWO1hVY8bGreSDlszrhA.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><h1 id="c852" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">3数据标准化</h1><p id="52d7" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">第一列包含两列。我使用<code class="fe ns nt nu nv b">split()</code>功能将它们分开。</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="135b" class="oa mw iw nv b gz ob oc l od oe">splitted_columns = df['Month, period'].str.split(',',expand=True)<br/>splitted_columns</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj oj"><img src="../Images/747f5a3ee776ec77fceea42557102179.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*-uiPOQ0NZ9pJ9PEnpmIT9w.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="b603" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">现在，我将每个新列分配给原始数据帧中的一个新列:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="976c" class="oa mw iw nv b gz ob oc l od oe">df['Month'] = splitted_columns[0]<br/>df['Period'] = splitted_columns[1]<br/>df.head(15)</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ok"><img src="../Images/102e50bc753ece7c4ef64c22efcf4f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOWNGP_QqDDdRbn8VL40Cw.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="5693" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我放下<code class="fe ns nt nu nv b">Month,period</code>栏:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="c366" class="oa mw iw nv b gz ob oc l od oe">df.drop('Month, period', axis=1, inplace=True)<br/>df.head(15)</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj ol"><img src="../Images/703fd45ec0b91249409989ff2756a9da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*Hga9n5bDSkIgzuPVsGLqYA.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="d5f3" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">有些列包含字符串<code class="fe ns nt nu nv b">mm</code>，所以我定义了一个函数来消除它。</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="c29d" class="oa mw iw nv b gz ob oc l od oe">def remove_mm(x):<br/>    if type(x) is str:<br/>        return x.replace('mm', '')<br/>    else:<br/>        return x</span></pre><p id="1a5d" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我将前面的函数应用于列<code class="fe ns nt nu nv b">Lake Victoria</code>和<code class="fe ns nt nu nv b">Simiyu</code>:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="08cc" class="oa mw iw nv b gz ob oc l od oe">df['Lake Victoria'] = df['Lake Victoria'].apply(lambda x: remove_mm(x))<br/>df['Simiyu'] = df['Simiyu'].apply(lambda x: remove_mm(x))<br/>df.head(20)</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj om"><img src="../Images/a5bf3c0cfbb4fda8e49220c6dcf48b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*bIZSi59kKcqzh3E2KnQFdQ.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="aca9" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">我描述了每一列的类型</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="2d50" class="oa mw iw nv b gz ob oc l od oe">df.dtypes</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj on"><img src="../Images/59dbe8ffab358a11d7a912df01a97310.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*x4n_el2vr19ddlvLx7pwgg.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><p id="552c" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">Lake Victoria</code>和<code class="fe ns nt nu nv b">Simiyu</code>列应该是浮动的。所以我把它们转换成浮点数:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="4e28" class="oa mw iw nv b gz ob oc l od oe">df["Lake Victoria"] = pd.to_numeric(df["Lake Victoria"])<br/>df["Simiyu"] = pd.to_numeric(df["Simiyu"])<br/>df.dtypes</span></pre><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div class="gi gj oo"><img src="../Images/7704c20fadb536bbdd965b4483f863e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*NvQPG1a2X5GOpTtMR4aVww.png"/></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><h1 id="1d3f" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">4初步探索性数据分析</h1><p id="463b" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">为了执行探索性数据分析(EDA)，我使用pandas profiling库。我可以这样安装它:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="1902" class="oa mw iw nv b gz ob oc l od oe">pip install pandas-profiling</span></pre><p id="efd4" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">然后，我用它来构建一个报告:</p><pre class="kv kw kx ky gu nw nv nx ny aw nz bi"><span id="f5b9" class="oa mw iw nv b gz ob oc l od oe">from pandas_profiling import ProfileReport</span><span id="0da5" class="oa mw iw nv b gz of oc l od oe">profile = ProfileReport(df, title="rainfall")<br/>profile.to_file("rainfall.html")</span></pre><p id="9d07" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">该库构建一个HTML文件，其中包含每一列的所有统计数据，并计算每对数字列之间的相关性。下图显示了生成的报告的示例:</p><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj op"><img src="../Images/21044d2dbe3a67dc849c203b79633026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*so_TQGAqNpwlWES0jQP7SQ.png"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated">作者图片</p></figure><h1 id="cef4" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">摘要</h1><p id="07c4" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">恭喜你！您刚刚清理了Python Pandas中的第一个数据集！过程简单快捷！</p><p id="92b7" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">您可以从<a class="ae lk" href="https://github.com/alod83/data-science/blob/master/Preprocessing/DataCleaning/Data%20Cleaning.ipynb" rel="noopener ugc nofollow" target="_blank">我的Github库</a>下载本文使用的代码。</p><p id="da71" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">如果你读到这里，对我来说，今天已经很多了。谢谢！你可以在<a class="ae lk" href="https://alod83.medium.com/my-most-trending-articles-4fbfbe107fb" rel="noopener">这个链接</a>阅读我的趋势文章。</p><h1 id="288c" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">相关文章</h1><div class="oq or gq gs os ot"><a rel="noopener follow" target="_blank" href="/data-preprocessing-with-python-pandas-part-1-missing-data-45e76b781993"><div class="ou ab fp"><div class="ov ab ow cl cj ox"><h2 class="bd jg gz z fq oy fs ft oz fv fx jf bi translated">使用Python Pandas进行数据预处理—第1部分缺失数据</h2><div class="pa l"><h3 class="bd b gz z fq oy fs ft oz fv fx dk translated">本教程解释了如何使用pandas库预处理数据。预处理是做一个…</h3></div><div class="pb l"><p class="bd b dl z fq oy fs ft oz fv fx dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph le ot"/></div></div></a></div><div class="oq or gq gs os ot"><a rel="noopener follow" target="_blank" href="/data-processing-with-python-pandas-part-2-data-formatting-710c2eafa426"><div class="ou ab fp"><div class="ov ab ow cl cj ox"><h2 class="bd jg gz z fq oy fs ft oz fv fx jf bi translated">Python Pandas的数据处理—第2部分数据格式化</h2><div class="pa l"><h3 class="bd b gz z fq oy fs ft oz fv fx dk translated">本教程解释了如何使用Pandas库预处理数据。预处理是做一个…</h3></div><div class="pb l"><p class="bd b dl z fq oy fs ft oz fv fx dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pi l pe pf pg pc ph le ot"/></div></div></a></div><div class="oq or gq gs os ot"><a rel="noopener follow" target="_blank" href="/data-preprocessing-with-python-pandas-part-3-normalisation-5b5392d27673"><div class="ou ab fp"><div class="ov ab ow cl cj ox"><h2 class="bd jg gz z fq oy fs ft oz fv fx jf bi translated">Python Pandas的数据预处理—第3部分标准化</h2><div class="pa l"><h3 class="bd b gz z fq oy fs ft oz fv fx dk translated">本教程解释了如何使用Pandas库预处理数据。预处理是做一个…</h3></div><div class="pb l"><p class="bd b dl z fq oy fs ft oz fv fx dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pj l pe pf pg pc ph le ot"/></div></div></a></div><div class="oq or gq gs os ot"><a rel="noopener follow" target="_blank" href="/data-preprocessing-with-python-pandas-part-4-standardization-ccd5b1608f1c"><div class="ou ab fp"><div class="ov ab ow cl cj ox"><h2 class="bd jg gz z fq oy fs ft oz fv fx jf bi translated">Python Pandas的数据预处理—第4部分标准化</h2><div class="pa l"><h3 class="bd b gz z fq oy fs ft oz fv fx dk translated">本教程解释了如何使用Pandas库预处理数据。预处理是做一个…</h3></div><div class="pb l"><p class="bd b dl z fq oy fs ft oz fv fx dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pk l pe pf pg pc ph le ot"/></div></div></a></div><div class="oq or gq gs os ot"><a rel="noopener follow" target="_blank" href="/data-preprocessing-with-python-pandas-part-5-binning-c5bd5fd1b950"><div class="ou ab fp"><div class="ov ab ow cl cj ox"><h2 class="bd jg gz z fq oy fs ft oz fv fx jf bi translated">用Python Pandas进行数据预处理—第5部分宁滨</h2><div class="pa l"><h3 class="bd b gz z fq oy fs ft oz fv fx dk translated">数据宁滨(或称存储桶)将数据分组到存储箱(或存储桶)中，从这个意义上说，它替换了包含在</h3></div><div class="pb l"><p class="bd b dl z fq oy fs ft oz fv fx dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pl l pe pf pg pc ph le ot"/></div></div></a></div><div class="oq or gq gs os ot"><a rel="noopener follow" target="_blank" href="/data-preprocessing-in-python-pandas-part-6-dropping-duplicates-e35e46bcc9d6"><div class="ou ab fp"><div class="ov ab ow cl cj ox"><h2 class="bd jg gz z fq oy fs ft oz fv fx jf bi translated">Python Pandas中的数据预处理—第6部分删除重复项</h2><div class="pa l"><h3 class="bd b gz z fq oy fs ft oz fv fx dk translated">使用Python熊猫库删除重复项的快速教程。</h3></div><div class="pb l"><p class="bd b dl z fq oy fs ft oz fv fx dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pm l pe pf pg pc ph le ot"/></div></div></a></div><h2 id="8465" class="oa mw iw bd mx pn po dn nb pp pq dp nf lu pr ps nh ly pt pu nj mc pv pw nl jc bi translated">你知道scikit-learn也提供数据清理功能吗？</h2><p id="8911" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">阅读<a class="ae lk" rel="noopener" target="_blank" href="/data-preprocessing-with-scikit-learn-missing-values-8dff2c266db">这篇文章</a>来学习如何处理scikit-learn中的缺失值。</p></div></div>    
</body>
</html>