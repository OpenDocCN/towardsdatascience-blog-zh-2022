<html>
<head>
<title>How To Sort Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对熊猫数据帧进行排序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sort-pandas-df-5748eaadcd4f#2022-07-05">https://towardsdatascience.com/sort-pandas-df-5748eaadcd4f#2022-07-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="1e49" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用一列或多列对熊猫数据帧进行排序</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/674e33bc6eb138ca4ad901ab1a06f925.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpWbqiMz5wNQIfM09GRnAA.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Markus Spiske </a>在<a class="ae kz" href="https://unsplash.com/s/photos/order?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2f2d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当检查我们的数据时，我们有时可能想要或者甚至不得不基于一个或多个列对它进行排序。这个简单的过程可以帮助我们调查一个特定的用例，探索边缘案例等等。</p><p id="f43b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在今天的教程中，我们将详细解释如何对熊猫数据帧进行升序或降序排序。此外，我们还将演示在对数据进行排序时如何使用一个或多个列。我们甚至将讨论如何按升序对列的子集进行排序，并按降序对剩余的子集进行排序。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="5839" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">首先，让我们创建一个示例数据帧，我们将在整个教程中引用它，以演示一些概念并展示如何有效地对pandas数据帧进行排序。</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="752d" class="mi mj iu me b gz mk ml l mm mn">import pandas as pd<br/></span><span id="1bfd" class="mi mj iu me b gz mo ml l mm mn">df = pd.DataFrame(<br/>    [ <br/>        (1, 'A', 140, False, 3.5),<br/>        (2, 'B', 210, True, 4.0),<br/>        (3, 'A', 562, True, 1.1),<br/>        (4, 'D', 133, False, 2.3),<br/>        (5, 'C', 109, False, 9.8),<br/>        (6, 'C', None, True, 3.9),<br/>        (7, 'B', 976, False, 7.8),<br/>        (8, 'D', 356, False, 4.5),<br/>        (9, 'C', 765, True, 2.1),<br/>    ],<br/>    columns=['colA', 'colB', 'colC', 'colD', 'colE']<br/>)</span><span id="3e4e" class="mi mj iu me b gz mo ml l mm mn">print(df)<br/><strong class="me iv"><em class="mp">   colA colB   colC   colD  colE<br/></em></strong><em class="mp">0     1    A  140.0  False   3.5<br/>1     2    B  210.0   True   4.0<br/>2     3    A  562.0   True   1.1<br/>3     4    D  133.0  False   2.3<br/>4     5    C  109.0  False   9.8<br/>5     6    C    NaN   True   3.9<br/>6     7    B  976.0  False   7.8<br/>7     8    D  356.0  False   4.5<br/>8     9    C  765.0   True   2.1</em></span></pre></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="c446" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe mq mr ms me b"><a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.sort_values.html" rel="noopener ugc nofollow" target="_blank">pandas.DataFrame.sort_values()</a></code>是根据特定条件对数据帧进行排序时需要使用的方法。在接下来的几节中，我们将讨论一些潜在的用例，并演示如何使用<code class="fe mq mr ms me b">sort_values</code>来推断出想要的结果。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="5882" class="mi mj iu bd mt mu mv dn mw mx my dp mz lj na nb nc ln nd ne nf lr ng nh ni nj bi translated">按一列排序</h2><p id="2c84" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">现在让我们假设我们想要根据列<code class="fe mq mr ms me b">colC</code>的值对我们刚刚创建的数据帧进行排序。我们需要做的就是在<code class="fe mq mr ms me b">by</code>参数中指定列名:</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="972c" class="mi mj iu me b gz mk ml l mm mn">&gt;&gt;&gt; df.sort_values(by='colC')</span></pre><p id="1866" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">结果将包含按<code class="fe mq mr ms me b">colC</code>升序排列的所有记录(默认)。</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="fce4" class="mi mj iu me b gz mk ml l mm mn"><strong class="me iv"><em class="mp">   colA colB   colC   colD  colE<br/></em></strong><em class="mp">4     5    C  </em><strong class="me iv"><em class="mp">109.0</em></strong><em class="mp">  False   9.8<br/>3     4    D  </em><strong class="me iv"><em class="mp">133.0</em></strong><em class="mp">  False   2.3<br/>0     1    A  </em><strong class="me iv"><em class="mp">140.0</em></strong><em class="mp">  False   3.5<br/>1     2    B  </em><strong class="me iv"><em class="mp">210.0</em></strong><em class="mp">   True   4.0<br/>7     8    D  </em><strong class="me iv"><em class="mp">356.0</em></strong><em class="mp">  False   4.5<br/>2     3    A  </em><strong class="me iv"><em class="mp">562.0</em></strong><em class="mp">   True   1.1<br/>8     9    C  </em><strong class="me iv"><em class="mp">765.0</em></strong><em class="mp">   True   2.1<br/>6     7    B  </em><strong class="me iv"><em class="mp">976.0</em></strong><em class="mp">  False   7.8<br/>5     6    C    NaN   True   3.9</em></span></pre><p id="372e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">或者，您可以指定<code class="fe mq mr ms me b">ascending=False</code>来对列<code class="fe mq mr ms me b">colC</code>上的数据帧进行降序排序:</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="78dd" class="mi mj iu me b gz mk ml l mm mn">&gt;&gt;&gt; <strong class="me iv">df.sort_values(by='colC', ascending=False)</strong><br/><em class="mp">   colA colB   colC   colD  colE<br/>6     7    B  976.0  False   7.8<br/>8     9    C  765.0   True   2.1<br/>2     3    A  562.0   True   1.1<br/>7     8    D  356.0  False   4.5<br/>1     2    B  210.0   True   4.0<br/>0     1    A  140.0  False   3.5<br/>3     4    D  133.0  False   2.3<br/>4     5    C  109.0  False   9.8<br/>5     6    C    NaN   True   3.9</em></span></pre></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="ace6" class="mi mj iu bd mt mu mv dn mw mx my dp mz lj na nb nc ln nd ne nf lr ng nh ni nj bi translated">按多列排序</h2><p id="cdd3" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">现在让我们假设我们想要基于两列，即<code class="fe mq mr ms me b">colA</code>和<code class="fe mq mr ms me b">colC</code>，对DataFrame进行排序。这次我们需要做的就是以列表的形式提供列名，并将其传递给<code class="fe mq mr ms me b">by</code>参数:</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="4c1d" class="mi mj iu me b gz mk ml l mm mn">&gt;&gt;&gt; df.sort_values(by=['colB', 'colC'])</span></pre><p id="2606" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">上面的语句将根据列<code class="fe mq mr ms me b">colB</code>和<code class="fe mq mr ms me b">colC</code>的值对数据帧进行升序排序:</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="1f25" class="mi mj iu me b gz mk ml l mm mn"><strong class="me iv"><em class="mp">   colA colB   colC   colD  colE<br/></em></strong><em class="mp">0     1    A  140.0  False   3.5<br/>2     3    A  562.0   True   1.1<br/>1     2    B  210.0   True   4.0<br/>6     7    B  976.0  False   7.8<br/>4     5    C  109.0  False   9.8<br/>8     9    C  765.0   True   2.1<br/>5     6    C    NaN   True   3.9<br/>3     4    D  133.0  False   2.3<br/>7     8    D  356.0  False   4.5</em></span></pre><p id="224c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是请注意，列名的指定顺序很重要——换句话说,<code class="fe mq mr ms me b">sort_values(by=['colB', 'colC']</code>和<code class="fe mq mr ms me b">sort_values(by=['colC', 'colB']</code>不会产生相同的结果:</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="9fca" class="mi mj iu me b gz mk ml l mm mn"><strong class="me iv">&gt;&gt;&gt; df.sort_values(by=['colC', 'colB'])<br/></strong>   colA colB   colC   colD  colE<strong class="me iv"><br/></strong>4     5    C  109.0  False   9.8<br/>3     4    D  133.0  False   2.3<br/>0     1    A  140.0  False   3.5<br/>1     2    B  210.0   True   4.0<br/>7     8    D  356.0  False   4.5<br/>2     3    A  562.0   True   1.1<br/>8     9    C  765.0   True   2.1<br/>6     7    B  976.0  False   7.8<br/>5     6    C    NaN   True   3.9</span></pre></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="9f69" class="mi mj iu bd mt mu mv dn mw mx my dp mz lj na nb nc ln nd ne nf lr ng nh ni nj bi translated">对多列按升序或降序排序</h2><p id="59e5" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">接下来，我们甚至可以在对多个列进行排序时指定每个列的排序顺序。这意味着我们可以对一列进行升序排序，而对其他列可以进行降序排序。</p><p id="82bd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了实现这一点，我们需要做的就是指定一个包含布尔值的列表，这些值对应于在<code class="fe mq mr ms me b">by</code>参数中指定的每一列，并表示我们是否要按升序排序。</p><p id="046e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以下命令将根据<code class="fe mq mr ms me b">colB</code>(升序)和<code class="fe mq mr ms me b">colC</code>(降序)对数据帧进行排序。</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="9e1d" class="mi mj iu me b gz mk ml l mm mn">&gt;&gt;&gt; df.sort_values(by=['colB', 'colC'], ascending=[True, False])<br/><strong class="me iv"><em class="mp">   colA colB   colC   colD  colE</em></strong><em class="mp"><br/>2     3    A  562.0   True   1.1<br/>0     1    A  140.0  False   3.5<br/>6     7    B  976.0  False   7.8<br/>1     2    B  210.0   True   4.0<br/>8     9    C  765.0   True   2.1<br/>4     5    C  109.0  False   9.8<br/>5     6    C    NaN   True   3.9<br/>7     8    D  356.0  False   4.5<br/>3     4    D  133.0  False   2.3</em></span></pre></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="ecba" class="mi mj iu bd mt mu mv dn mw mx my dp mz lj na nb nc ln nd ne nf lr ng nh ni nj bi translated">处理缺失值</h2><p id="122c" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">你可能已经注意到，空值总是被放在结果的最后，不管我们选择什么顺序。</p><p id="f7ed" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们可以通过简单地指定<code class="fe mq mr ms me b">na_position='first'</code>(默认为<code class="fe mq mr ms me b">'last'</code>)来改变这种行为，将它们放在结果的顶部。</p><pre class="kk kl km kn gu md me mf mg aw mh bi"><span id="e6c6" class="mi mj iu me b gz mk ml l mm mn">&gt;&gt;&gt; df.sort_values(by='colC', ascending=True, na_position='first')<br/><strong class="me iv"><em class="mp">   colA colB   colC   colD  colE<br/>5     6    C    NaN   True   3.9<br/></em></strong><em class="mp">4     5    C  109.0  False   9.8<br/>3     4    D  133.0  False   2.3<br/>0     1    A  140.0  False   3.5<br/>1     2    B  210.0   True   4.0<br/>7     8    D  356.0  False   4.5<br/>2     3    A  562.0   True   1.1<br/>8     9    C  765.0   True   2.1<br/>6     7    B  976.0  False   7.8</em></span></pre></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h2 id="78f3" class="mi mj iu bd mt mu mv dn mw mx my dp mz lj na nb nc ln nd ne nf lr ng nh ni nj bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">在今天的简短教程中，我们演示了熊猫如何进行排序。给定一个相当简单的数据框架，我们展示了如何基于一列甚至多列对数据进行排序。</p><p id="9e63" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">此外，我们演示了如何按降序或升序排序，甚至决定哪些列需要按降序排序，哪些应该按升序排序。</p><p id="47fe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，我们展示了如何选择空值是出现在结果的顶部还是底部，而不管我们选择的记录排序顺序。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="lc iv">成为会员</strong> </a> <strong class="lc iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="np nq gq gs nr ns"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">相关文章您可能也喜欢</strong></p><div class="np nq gq gs nr ns"><a rel="noopener follow" target="_blank" href="/how-to-merge-pandas-dataframes-221e49c41bec"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何合并熊猫数据帧</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">对熊猫数据帧执行左、右、内和反连接</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/loc-vs-iloc-in-pandas-92fc125ed8eb"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">熊猫中的loc与iloc</h2><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/how-to-efficiently-convert-a-pyspark-dataframe-to-pandas-8bda2c3875c3"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">加快PySpark和Pandas数据帧之间的转换</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">将大型Spark数据帧转换为熊猫时节省时间</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oj l od oe of ob og kt ns"/></div></div></a></div></div></div>    
</body>
</html>