<html>
<head>
<title>Streamlit from Scratch: Presenting Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始简化:呈现数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/streamlit-from-scratch-presenting-data-d5b0c77f9622#2022-11-22">https://towardsdatascience.com/streamlit-from-scratch-presenting-data-d5b0c77f9622#2022-11-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6581" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从文本和表格到复杂的图表。从熊猫 dataframes 到 Matplotlib、Plotly、Altair 等图表。Streamlit 提供了一套全面的工具来展示您的数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d178a14d6285e03872c04c2032b82dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lPBFQOMtXwY20Gl0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="07f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit 是为数据科学家设计的，因此数据呈现是它的基础。</p><p id="a2db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit 支持几个图表包，如 Pyplot、Plotly、Altair 和 Bokeh，以及以文本形式呈现数据的方式。我们将简要地看一下它们，以及 Streamlit 的内置图表。</p><p id="f767" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在之前的文章中，我已经介绍了如何<a class="ae ky" href="https://medium.com/towards-data-science/streamlit-from-scratch-getting-started-f4baa7dd6493" rel="noopener">开始使用 Streamlit </a>以及如何在 Streamlit 应用程序中包含各种形式的文本、<a class="ae ky" href="https://medium.com/towards-data-science/streamlit-from-scratch-embedding-images-video-and-audio-8b2e8b98fad4" rel="noopener">图像、视频和音频。现在，我们开始呈现您辛苦发现、处理和分析的数据的本质。</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0cd44debf872e1c60048ce7cfbce1e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bMErx1Dg3R74izExcKfqxA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们将创建的一些图表—按作者分类的图片</p></figure><p id="b041" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将展示一些代码片段，你们可以复制。此外，整个代码可以从我的网站下载。我会在文章的最后放一个链接，它应该在这篇文章发表后不久就可以使用了。</p><p id="68a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想按照编码进行，您需要做的第一件事就是包含 Streamlit 包。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="9703" class="mb mc it lx b be md me l mf mg">import streamlit as st</span></pre><p id="afbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你需要一本关于如何开始使用 Streamlit 以及需要哪些工具的入门书，请参见本系列的第一篇文章<a class="ae ky" rel="noopener" target="_blank" href="/streamlit-from-scratch-getting-started-f4baa7dd6493"> <em class="mh"> Streamlit 从头开始:入门</em> </a>。</p><h1 id="4e42" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">数据</h1><p id="2454" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我们将使用两个小型数据集。第一个是今年迄今(2022 年 11 月)的真实加密货币数据，第二个是一些虚构的销售数据。</p><p id="de9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">加密数据没有正式的来源，我只是谷歌了今年每个月第一天比特币和以太坊的美元价值，到目前为止(2022 年 1 月至 11 月)，我为这篇文章虚构了销售数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/e5bc75565fd43bcdfd9031982ebe8284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S6PtXDIewADZmOoM7lVUfA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">两个简单的数据集——作者图片。数据来源:谷歌</p></figure><p id="c0a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要创建这些数据，请执行以下代码。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="1ecb" class="mb mc it lx b be md me l mf mg"># Crypto monthly data<br/>d = {'Month':[1,2,3,4,5,6,7,8,9,10,11],<br/>     'Bitcoin':[47733,38777,44404,46296,38471,29788,19247,23273,20146,19315,20481],<br/>     'Ethereum':[3767,2796,2973,3448,2824,1816,1057,1630,1587,1311,1579]}<br/><br/>cryptodf = pd.DataFrame(data = d)<br/><br/># The Incredible Widget Company<br/>d = {'Quarter':[1,2,3,4],<br/>     'Widgets':[100,110,112,120],<br/>     'Wodgets':[50,100,120, 125],<br/>     'Wudgets':[200,150,100,90]}<br/>     <br/>salesdf = pd.DataFrame(d)</span></pre><h1 id="89c8" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">文本</h1><p id="4fe4" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我们将很快简化它的图表功能，但呈现数据并不总是与图表有关。有时候，一个简单的文本演示或一个表格就足以让你的信息被理解。</p><p id="2b31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit 提供了一种简洁的方式来表示值的简单变化:<code class="fe nf ng nh lx b">st.metric()</code>。看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/df6af6d3dff394e269304b099dd3e1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*yjV5uoEnauwFZd1LCOIxRg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">圣米制()— <em class="nj">图片作者</em></p></figure><p id="62ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这很容易建造。下面的代码使用<code class="fe nf ng nh lx b">st.metric()</code>来显示今年以来比特币(BTC)的价值变化。我先定义 3 个变量，<code class="fe nf ng nh lx b">btcCurrent</code>，写的时候 BTC 的值，<code class="fe nf ng nh lx b">btcYrBeg</code>，年初的值，<code class="fe nf ng nh lx b">btcDelta</code>，从那时到现在的变化。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="2435" class="mb mc it lx b be md me l mf mg">btcCurrent = 16080<br/>btcYrBeg = 47733<br/>btcdelta = btcCurrent - btcYrBeg<br/><br/>st.metric("Bitcoin", btcCurrent, delta=btcdelta, delta_color="normal", <br/>          help="Change in Bitcoin dollar value since the year beginning")</span></pre><p id="351c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有四个参数:第一个是标题；第二个是当前值，它将是显示的大数字；三是数值的变化，会以红色(数值减少)或绿色(数值增加)显示；第四个参数允许我们改变 delta 值的颜色编码，取值为“正常”(默认)、“相反”(交换红色和绿色)或“关闭”(灰色)；最后是选项工具提示。</p><p id="af2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用以太坊(ETH)做了同样的事情，然后将两个<em class="mh">指标</em>和一些文本组合成三列，以提供一个简单但有效的演示。这里是以太坊需要的代码。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="5037" class="mb mc it lx b be md me l mf mg">ethCurrent = 1225<br/>ethYrBeg = 3767<br/>ethdelta = ethCurrent - ethYrBeg</span></pre><p id="c91b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是以列显示数据的代码:</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="5ce2" class="mb mc it lx b be md me l mf mg"># Use columns to display them together<br/>col1, col2, col3 = st.columns([50,25,25])<br/>col1.write("The value of crytocurrencies has dropped considerably since the beginning of the year")<br/>col2.metric("Bitcoin", btcCurrent, delta=btcdelta, delta_color="normal", <br/>            help="Change in Bitcoin dollar value since the year beginning")<br/>col3.metric("Ethereum", ethCurrent, delta=ethdelta, delta_color="normal", <br/>            help="Change in Ethereum dollar value since the year beginning")</span></pre><p id="b427" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/dcdf93e653ba7a055cab77e616ae158d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*Uobn758PyykrEjVcCNBGFw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">列中显示的公制()示例— <em class="nj">作者图片</em></p></figure><p id="fcb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在以前的文章中简要地提到了专栏。这里我们创建三列，并根据传递给<code class="fe nf ng nh lx b">st.columns()</code>方法的列表中的值对它们进行加权。因此<code class="fe nf ng nh lx b">col2</code>和<code class="fe nf ng nh lx b">col3</code>的宽度相同，而<code class="fe nf ng nh lx b">col1</code>的宽度是另外两个的两倍。我们通过在方法调用之前加上列名而不是<code class="fe nf ng nh lx b">st.</code>来写入这些列</p><h1 id="4a24" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">表格和数据框架</h1><p id="bc2f" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">在 Streamlit 中，您还可以将数据显示为<em class="mh">表格</em>或<em class="mh">数据框</em>。</p><p id="a752" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">表格可能看起来有点无聊，但它们很容易被读者理解，因为它们无处不在。手指沿着行向下移动，直到找到您感兴趣的那一行，然后穿过行，直到找到正确的列，这就是您正在寻找的数字！</p><p id="d3f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从表面上看，这两种方法似乎没有太大的区别；他们都展示了一张桌子。然而<code class="fe nf ng nh lx b">st.dataframe()</code>更加灵活。</p><p id="4ae4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">两者都可以将 Pandas dataframe 作为数据源，但是<code class="fe nf ng nh lx b">st.table()</code>没有其他选择，它只是在适合页面(或容器)的表格中显示数据。<code class="fe nf ng nh lx b">st.dataframe()</code>更灵活，你可以指定高度和宽度，或者填充容器的宽度，如果数据框太大，它将是可滚动的。<code class="fe nf ng nh lx b">st.dataframe()</code>也是交互式的——点击一个单元格，它就会高亮显示；单击一列，数据将按该列排序。</p><p id="5c25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下表显示了 BTC 和 ETH 价格的月度视图。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="9717" class="mb mc it lx b be md me l mf mg">st.table(cryptodf)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/ade3cae1f7b06e9f2601cc6dd018694e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2GEqwWLb5xOjS2LdsXQYw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="nj">一张 Streamlit 表——作者图片。数据来源:谷歌</em></p></figure><p id="6a7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是数据帧版本，有一个用户高亮显示的单元格。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="68d2" class="mb mc it lx b be md me l mf mg">st.dataframe(cryptodf, use_container_width=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/baa82d8c2673b028b23384a3c2b655f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMrxxYl4CLUkhzxfvjpXyg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="nj">一个精简的数据框架——作者图片。数据来源:谷歌</em></p></figure><p id="c936" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我通过将<code class="fe nf ng nh lx b">use_container_width</code>参数设置为<code class="fe nf ng nh lx b">True</code>来保持数据帧与表格的宽度相同。</p><p id="08cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您知道要查找什么，表格提供了对数据的简单访问。但要发现趋势或相关性并不是特别容易。</p><p id="67cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此你需要图表。</p><h1 id="6c1e" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">流线图</h1><p id="5de9" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">Streamlit 支持几个图表包，也有三个内置图表，本质上是它们的<em class="mh"> Altair </em>对等物的包装器。我们将首先查看内置的包，然后探究其他受支持的包。</p><p id="cade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">内置图表有<code class="fe nf ng nh lx b">st.line_chart()</code>、<code class="fe nf ng nh lx b">st.bar_chart()</code>和<code class="fe nf ng nh lx b">st.area_chart()</code>。它们很有吸引力，也很容易使用，但是不够灵活。</p><p id="5a47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个折线图，显示了 2022 年大部分时间里比特币和以太坊的衰落。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/6e0be193f080dd3027e9b57bac974784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*izV_KcvDW-JB48bas7HXzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">流线折线图—作者图片</p></figure><p id="c172" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是产生它的代码。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="09dd" class="mb mc it lx b be md me l mf mg">st.line_chart(df, x='Month')</span></pre><p id="b92e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">内置图表需要一个数据源<code class="fe nf ng nh lx b">df</code>和一个数据列作为 x 轴。如果 y 轴未定义，则将绘制所有剩余的列。否则，y 轴应该是单个列名或列名列表。</p><p id="b4f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是比特币数据的柱状图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/33b62377b41249aa9237792635607fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfgOguzVP6pHDhAl0Dj88w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Streamlit 条形图—作者图片</p></figure><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="b4d2" class="mb mc it lx b be md me l mf mg">st.bar_chart(df, y = 'Bitcoin', x='Month')</span></pre><p id="a200" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我只绘制了一列，因为此图表的默认行为是绘制堆叠条形图，这意味着我们要添加一组或多组值来构建条形图。</p><p id="2477" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这完全适合销售图表，在销售图表中，各个项目可以累加形成一个总数。比如这个，它记录了令人难以置信的小配件公司生产的产品一年来的销售情况。他们的主打产品是<em class="mh"> Widget </em>，但是他们还有另外两款产品，分别是<em class="mh"> Wodget </em>和<em class="mh"> Wudget </em>，下面我们可以看到它们的销售情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/49b73ad49433f114904176389123d7dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ezAvDeQn9CIy1HsmWgQUIg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">流线堆积条形图-作者图片</p></figure><p id="475f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这张图表中，我们可以看到，尽管 Wodgets 明显很受欢迎，但整体销售并没有改善。他们的主要产品小配件的销售保持稳定，但是小配件<em class="mh">销售的下降让公司很失望。</em></p><p id="c908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是生成该图表的代码。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="14d5" class="mb mc it lx b be md me l mf mg">st.bar_chart(salesdf, x='Quarter')</span></pre><p id="2d3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，y 轴没有定义，所以所有剩余的列都被绘制出来。</p><p id="3bf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一个内置图表是面积图。这是销售数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/f94c7a79f384b3b017b2dd6d4cfa5918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tlq-C1cEQVYB1_r-VuseMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">流线面积图—作者图片</p></figure><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="97f8" class="mb mc it lx b be md me l mf mg">st.area_chart(salesdf, x='Quarter')</span></pre><p id="e386" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，您可以看到销售线的相对表现，尽管在面积图中它们不是相加的，因此我们不容易了解整体销售表现。</p><p id="fd5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不得不说，我不太喜欢这个默认的配色方案，而且似乎也没有什么明显的方法来改变它。</p><h1 id="75a5" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">Pyplot</h1><p id="83e9" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">我们要看的第一个支持的图表包是<em class="mh">py plot</em>——本质上这是对 Python Matplotlib 包的支持，但是我们也可以使用 Pandas 绘图方法，因为它们是建立在 Matplotlib 包之上的。</p><p id="fd69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是加密数据的折线图代码。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="b14f" class="mb mc it lx b be md me l mf mg">fig, ax = plt.subplots()<br/>plt.plot(df['Bitcoin'])<br/>st.pyplot(fig)</span></pre><p id="73bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码的第一行初始化图形变量<code class="fe nf ng nh lx b">fig</code>和轴变量<code class="fe nf ng nh lx b">ax</code>。在这个例子中，没有使用<code class="fe nf ng nh lx b">ax</code>，但是我们必须初始化<code class="fe nf ng nh lx b">fig</code>，这样我们就可以将它传递给<code class="fe nf ng nh lx b">st.plot()</code>。</p><p id="dea8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是生成的图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/08a129de3f4a941c2f992b1e76983049.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lo7NkVJDHOaIX3Pz9lfAwA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pyplot 折线图—图片由作者提供</p></figure><p id="0b48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它非常简单，但是我们可以用一些附加的命令来定制它。在这里，我们向轴添加标签、标题，并在条形图上绘制 y 轴网格线。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="340a" class="mb mc it lx b be md me l mf mg"># Pyplot charts are customizable<br/>fig, ax = plt.subplots()<br/>plt.bar(df.Month, df.Bitcoin)<br/>ax.set_ylabel("Value in dollars")<br/>ax.set_xlabel("Month 2022")<br/>ax.set_title("Bitcoin")<br/>plt.grid(axis='y')<br/>st.pyplot(fig)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/2d9a88fd048b191783f94bae9daaf9b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPRi1XkQOTQjOHoo958hpQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pyplot 条形图—作者图片</p></figure><p id="8250" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样更好。Matplotlib 图表是高度可定制的，但是要得到你想要的图表，你可能要写很多代码。</p><p id="97cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个折衷的办法是使用 Pandas 的绘图方法，它用最少的代码提供了一个稍微复杂一点的图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/29b3341e624f792fdabd07f474304a25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idsRjRPCxr_ft0Ny4H3YTQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫分组条形图——作者图片</p></figure><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="ea4e" class="mb mc it lx b be md me l mf mg">fig, ax = plt.subplots()<br/>df.plot.bar(x = 'Month', y=['Bitcoin','Ethereum'],ax=ax)<br/>st.pyplot(fig)</span></pre><p id="12fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在这里我们可以通过在列表中指定 BTC 和 ETH 来轻松绘制它们。同样需要注意的是，我们需要将<code class="fe nf ng nh lx b">ax</code>传递给绘图函数调用——这样，新的绘图就被添加到 Matplotlib 图形中。(如果不这样做，最终会得到一个空的图表。)</p><h1 id="caae" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">阿尔泰尔</h1><p id="1b8b" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">牛郎星图表基于 Vega-Lite 规范，因此牛郎星生成的图形将与 Vega-Lite 相同。正如我们将看到的，这是一种构造图表的声明性方法。</p><p id="a561" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了绘制 Altair 图表，我们首先需要导入库:</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="1f32" class="mb mc it lx b be md me l mf mg">import altair as alt</span></pre><p id="112a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们定义一个图表，并使用<code class="fe nf ng nh lx b">st.altair_chart(c)</code>，其中<code class="fe nf ng nh lx b">c</code>是图表，来绘制它。</p><p id="715f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">定义牛郎星图的语法与我们目前所遇到的完全不同。我们从定义一个图表对象开始。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="cff2" class="mb mc it lx b be md me l mf mg">c = alt.Chart(cryptodf)</span></pre><p id="5562" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这从数据帧<code class="fe nf ng nh lx b">cryptodf</code>中创建了一个图表，但它并没有为我们做太多事情。我们现在需要声明<em class="mh">标记</em>和<em class="mh">编码</em>。</p><p id="30bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mh">标记</em>是图表的可视化方式，可以是线条、点、条等。例如</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="5c44" class="mb mc it lx b be md me l mf mg">c = alt.Chart(cryptodf).mark_line()</span></pre><p id="25bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe nf ng nh lx b">mark_line()</code>意味着我们要画一个折线图。还有其他几个<em class="mh">标记，比如</em><code class="fe nf ng nh lx b"><em class="mh">mark_bar()</em></code><code class="fe nf ng nh lx b">mark_point()</code>会画出不同类型的图表。</p><p id="56dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后为了直观地理解数据，我们可以将各种<em class="mh">编码通道</em>映射到数据集中的列。</p><p id="3b43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将使用代表点的 x 轴位置的<code class="fe nf ng nh lx b">x</code>通道对数据的列<code class="fe nf ng nh lx b">'Month'</code>进行编码。这给了我们一个轴。然后我们将对列<code class="fe nf ng nh lx b">'Bitcoin'</code>到<code class="fe nf ng nh lx b">y</code>进行编码。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="ba20" class="mb mc it lx b be md me l mf mg">c = alt.Chart(cryptodf).mark_line().encode(<br/>    x='Month:O', y='Bitcoin')</span></pre><p id="f47e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码中奇怪的<code class="fe nf ng nh lx b">:O</code>告诉 Altair<code class="fe nf ng nh lx b">'Month'</code>是一个序数值，因此它将显示为一个整数列表(否则它们将显示为实数，用数字 1.0 表示<em class="mh">一月</em>有点奇怪)。</p><p id="19d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了绘制图表，我们称之为<code class="fe nf ng nh lx b">st.altair_chart()</code>方法:</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="7d70" class="mb mc it lx b be md me l mf mg">st.altair_chart(c)</span></pre><p id="a4b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这导致了过去 11 个月 BTC 值的一个简洁的折线图。</p><p id="0ba8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你喜欢条形图吗？简单。用<code class="fe nf ng nh lx b">mark_bar()</code>代替<code class="fe nf ng nh lx b">mark_line()</code>即可。</p><p id="b8c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是两张图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/d67b2084e5ca0a466e9b108c8527cdab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7Sthujrb5p2h9G_Pt8Vrg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">牛郎星图表-作者图片</p></figure><h1 id="be01" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">重新访问数据</h1><p id="40d2" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">这对于绘制单个列很有效，但是如果我们想在同一张图上显示 BTC 和瑞士联邦理工学院，我们需要对数据进行一些处理——实际上是非常多的处理。</p><p id="e167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据加密图表，我们需要将 BTC 和 ETH 值放在同一列中。但是由于我们需要区分它们，我们需要另一个列来标记它们是<em class="mh"> BTC </em>还是<em class="mh">以太</em>。</p><p id="0fdf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，对于销售数据，每个值必须在同一列中，这一次我们需要一个新列，将这些值标记为<em class="mh"> Widget </em>、<em class="mh"> Wodget </em>或<em class="mh"> Wudget </em>。</p><p id="cc7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用 Pandas <code class="fe nf ng nh lx b">melt()</code>方法转换我们当前的数据帧。代码如下:</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="8cbf" class="mb mc it lx b be md me l mf mg">cryptodf1 = pd.melt(cryptodf, <br/>              value_vars=['Bitcoin','Ethereum'], <br/>              id_vars=['Month'],<br/>              var_name='Name'<br/>              )<br/>salesdf1 = pd.melt(salesdf, <br/>              value_vars=['Widgets','Wodgets','Wudgets'], <br/>              id_vars=['Quarter'],<br/>              var_name='Name'<br/>              )</span></pre><p id="1d72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解释这段代码会让我们跑题，所以如果你不熟悉<code class="fe nf ng nh lx b">pd.melt()</code>你可以在这里找到它<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="a2c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有两个新的数据帧，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/092370b4847199741de29025821f66e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fW-38mT4H49EfploDTVk7Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">修改后的数据—作者图片</p></figure><p id="7e92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是相同的数据，但是这种格式允许我们用接下来要看的图表包做更多的事情。</p><h1 id="d332" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">回到牵牛星</h1><p id="cf95" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">像这样重新调整数据意味着我们可以用 Altair 做到这一点:</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="e759" class="mb mc it lx b be md me l mf mg">c = alt.Chart(cryptodf1).mark_line().encode(<br/>    x='Month', <br/>    y='value', <br/>    color = 'Name:N'<br/>    )<br/><br/>st.altair_chart(c)</span></pre><p id="0f73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">y 轴现在映射到包含 BTC 和 ETH 值的<em class="mh">值</em>列。但是现在我们有了第三个编码<code class="fe nf ng nh lx b">color</code>，它被映射到<em class="mh">名称</em>列。所以我们在同一个图表上有两条不同颜色的线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/9454b38014b7c1376827ce8358a3500f.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*r1a2vAMTg5rCsU76r_0bXw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">牛郎星线图——作者图片</p></figure><p id="a0cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种数据格式，我们可以对条形图进行分组。在下图中，我们通过并排显示每个条形来比较这两种加密货币。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/ac27400e73e711b9c6b924998a0bacf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZkFxmfsx1XzJR33Vkotbkg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一组牛郎星条形图-作者图片</p></figure><p id="abee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们通过添加一个新的编码<code class="fe nf ng nh lx b">column</code>来实现这一点，该编码被设置为“Month”。这会将每个月的数据排列在有序的列中，并在这些列中绘制各个条形。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="4dd2" class="mb mc it lx b be md me l mf mg">c = alt.Chart(cryptodf1).mark_bar().encode(<br/>  x='Name:O',<br/>  y='value:Q',<br/>  color = 'Name:N',<br/>  column = 'Month:N')<br/><br/>st.altair_chart(c)</span></pre><p id="8e2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以看到，我在各种编码中添加了新的数据类型。它们的含义如下:</p><p id="9762" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nf ng nh lx b">:O</code>序数，一个离散的有序数量</p><p id="88e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nf ng nh lx b">:Q </code>定量一个连续的实数值</p><p id="0597" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nf ng nh lx b">:N </code>名义上，一个离散无序的范畴</p><p id="908e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候去普洛特利了。</p><h1 id="b523" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">Plotly</h1><p id="4f3b" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">Plotly 是 Python 和 web 上最流行的绘图包之一。可以说，它比 Altair 更容易使用，比 Pyplot 更好看——尽管在 Streamlit 中使用它有一些限制。</p><p id="2ad3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用 Plotly 推荐的包，<em class="mh"> Plotly Express </em>，为了使用它，我们像这样导入它。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="ca27" class="mb mc it lx b be md me l mf mg">import plotly.express as px</span></pre><p id="b841" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们在用 Plotly Express 绘制 ETH 和 BTC 值之前看到的简单线形图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/c8ebc46c35af72ce69d444a8cd6eaac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dfLI1tZ2onjoeRAlNIL33g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Plotly 折线图—作者提供的图片</p></figure><p id="8ee6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码非常简单。使用<code class="fe nf ng nh lx b">px.line()</code>绘制一个线图，我们指定数据、x 轴和 y 轴以及一个数据列，用于给我们绘制的线着色。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="1e18" class="mb mc it lx b be md me l mf mg">c = px.line(cryptodf1, x="Month", y="value",<br/>             color='Name', <br/>             height=400)<br/><br/>st.plotly_chart(c)</span></pre><p id="f96d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经额外设置了图形的高度。</p><p id="9338" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">条形图也一样简单。这是我们销售数据的分组柱状图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/0a6bbd93262ddb3770a684631c572600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*CnNFVRT9ZuDbbwdMe-6I_w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个精心分组的条形图——作者图片</p></figure><p id="d2b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是代码。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="8eac" class="mb mc it lx b be md me l mf mg">c = px.bar(salesdf1, x="Quarter", y="value",<br/>             color='Name', barmode='group',<br/>             height=400)<br/><br/>st.plotly_chart(c)</span></pre><p id="64ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用<code class="fe nf ng nh lx b">px.bar()</code>来绘制图表，但除此之外，它与折线图的唯一区别是可以指定<code class="fe nf ng nh lx b">barmode</code>是<code class="fe nf ng nh lx b">group</code>还是<code class="fe nf ng nh lx b">stack.</code></p><p id="a269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Plotly 是最简单的软件包之一，但我对默认的配色方案有一点小问题，我真的不太喜欢它——我承认这纯粹是个人抱怨。</p><p id="c65e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，通常这不是一个问题。Plotly 提供了许多可供选择的主题供您使用。比如有<em class="mh">剧情 _ 黑暗</em>、<em class="mh">剧情 _ 白色</em>和<em class="mh">简单 _ 白色</em>主题。我通常更喜欢使用其中的一个。</p><p id="dddd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">问题是 Streamlit 不支持 Plotly 中的主题化。这是有意还是无意，我不知道，但 Plotly 主题在 Streamlit 中不起作用。</p><p id="f07b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一种方法可以绕过它。构建图表后，您可以用如下代码更改它的某些方面。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="7781" class="mb mc it lx b be md me l mf mg">c.update_layout(paper_bgcolor="white", <br/>                plot_bgcolor="white", <br/>                yaxis_gridcolor= "black",<br/>                yaxis_linecolor= "black",<br/>                xaxis_linecolor= "black")</span></pre><p id="b863" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的方法应该可以让你改变整个主题，但是虽然这对 Streamlit 不起作用，你可以做一些小的改变，就像上面看到的那样:将纸张颜色和背景改为白色，将 x 轴和 y 轴以及 y 网格改为黑色。</p><p id="7a14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经将该代码应用到一个处于<em class="mh">堆栈</em>模式的条形图中，并绘制出我们的销售数据。</p><p id="6088" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是代码，下面是实际的图表。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="91e4" class="mb mc it lx b be md me l mf mg">c = px.bar(salesdf1, x="Quarter", y="value",<br/>             color='Name', barmode='stack',<br/>             height=400)<br/><br/>c.update_layout(paper_bgcolor="white", <br/>                plot_bgcolor="white", <br/>                yaxis_gridcolor= "black",<br/>                yaxis_linecolor= "black",<br/>                xaxis_linecolor= "black")<br/><br/>st.plotly_chart(c)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/b5bdaf0caed07629148179075e6803f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1PQ4x3355PXYRuDcbOabw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">背景已更改的 Plotly 堆积条形图—图片由作者提供</p></figure><p id="357e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到上面的图表有白色背景和黑色线条。</p><p id="bed2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Plotly 图表是交互式的。将鼠标悬停在它们上面会向您显示数据点，您还可以平移和放大绘图。</p><h1 id="7061" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">散景</h1><p id="3131" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">散景还可以让您创建交互式绘图，您可以平移和放大。生成类似的图需要更多的代码，但是结果非常吸引人。不过，这可能会变得相当复杂。</p><p id="5494" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于我们的目的，我们像这样导入库。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="ebda" class="mb mc it lx b be md me l mf mg">from bokeh.plotting import figure</span></pre><p id="2743" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们的加密线图，同样，散景风格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/45ebc76107d414e2b75a2a3f314aec16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*4NRDMTvwBIUr8ATUFukV_g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">散景折线图—作者图片</p></figure><p id="8d6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您在下面看到的代码相对较长。我们首先创建一个带有标题和轴标签的散景图形对象。然后，我们向该对象添加两行，指定 x 和 y 数据的列、图例标签和颜色。我们还将线宽设置为 2。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="b555" class="mb mc it lx b be md me l mf mg"># create a new plot with a title and axis labels<br/>p = figure(title="Simple line example", <br/>           x_axis_label="Month", <br/>           y_axis_label="value")<br/><br/># add a line renderer with legend and line thickness<br/>p.line(cryptodf['Month'], <br/>       cryptodf['Bitcoin'], <br/>       legend_label="BTC", <br/>       color = 'blue',<br/>       line_width=2)<br/>p.line(cryptodf['Month'], <br/>       cryptodf['Ethereum'], <br/>       legend_label="ETH", <br/>       color = "green",<br/>       line_width=2)<br/><br/>st.bokeh_chart(p)</span></pre><p id="dc2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">BTC 数据的条形图如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/43a45ec2faa884280d5bba6e4a38e898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*bbYtEcMx05YAe_y5aDckLQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">散景条形图—作者提供的图像</p></figure><p id="315c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它是由这段代码产生的。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="61fe" class="mb mc it lx b be md me l mf mg">p = figure(title="Simple bar example", <br/>           x_axis_label="Month", <br/>           y_axis_label="value")<br/><br/>p.vbar(x=cryptodf['Month'], <br/>       top=cryptodf['Bitcoin'], <br/>       legend_label="BTC", <br/>       width=0.5, <br/>       bottom=0, <br/>       color="blue")</span></pre><p id="d2ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这与折线图非常相似，但是我们必须指定条形的顶部和底部。这里底部总是零，每个条形的顶部是“比特币”栏的值。</p><h1 id="6100" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">Vega-lite</h1><p id="c448" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">Vega-Lite 是一种用于交互式可视化的平台中立的图形规范语法。</p><p id="53f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Vega-Lite 图形被指定为 JSON 结构，就像 Vega-Lite 示例 web 页面中的这个。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="f3d1" class="mb mc it lx b be md me l mf mg">{<br/>  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",<br/>  "description": "A simple bar chart with embedded data.",<br/>  "data": {<br/>    "values": [<br/>      {"a": "A", "b": 28}, {"a": "B", "b": 55}, {"a": "C", "b": 43},<br/>      {"a": "D", "b": 91}, {"a": "E", "b": 81}, {"a": "F", "b": 53},<br/>      {"a": "G", "b": 19}, {"a": "H", "b": 87}, {"a": "I", "b": 52}<br/>    ]<br/>  },<br/>  "mark": "bar",<br/>  "encoding": {<br/>    "x": {"field": "a", "type": "nominal", "axis": {"labelAngle": 0}},<br/>    "y": {"field": "b", "type": "quantitative"}<br/>  }<br/>}</span></pre><p id="fe3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://vega.github.io/vega-lite/examples/line.html" rel="noopener ugc nofollow" target="_blank"> <em class="mh">清单由 Vega-Lite 示例网页</em> </a>提供</p><p id="ed25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这也是一个 Python 列表的有效声明，所以我们可以将它赋给一个变量，并像这样绘制它。</p><pre class="kj kk kl km gt lw lx ly bn lz ma bi"><span id="59cf" class="mb mc it lx b be md me l mf mg">st.vega_lite_chart(c)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/8913362fddceae7eb1e770ab39ab5b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*mfACV-Oq5oi7sztieWkmuQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Vega-Lie 条形图——作者图片</p></figure><p id="e932" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我看来，这是一种相当冗长的创建图形的方式，因为 Altair 是 Vega-Lite 在 Python 中的实现，因此对 Python 程序员来说是一个更有吸引力的提议，我们将把 Streamlit 的这一特定特性留在那里。</p><p id="b930" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关 Vega-Lite 规范的更多信息，请参考<a class="ae ky" href="http://vega.github.io/vega-lite/" rel="noopener ugc nofollow" target="_blank"> Vega-Lite 网站</a>。</p><h1 id="2884" class="mi mc it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">结论</h1><p id="0294" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">这是一个由 Streamlit 支持的图表包的快速浏览。不可能在一篇文章中对它们做出公正的评价——你可以就它们中的每一个写一本书。老实说，我已经避免在任何一个包中使用任何过于复杂的东西，但是我希望我已经给了你每一个包的味道。</p><p id="46b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了快速和简单，我的可视化软件包要么是熊猫，要么是 Plotly。但是选择当然是你的。</p><p id="678d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在未来的文章中，我们将探讨如何使用 Streamlit 布局功能来生成一个仪表板或类似的应用程序，以一种高效和令人愉快的方式整合多个元素。</p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="2fe1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读——我希望您发现它很有用。你会发现所有 Streamlit from Scratch 文章的链接，以及从<a class="ae ky" href="https://alanjones2.github.io/streamlitfromscratch/" rel="noopener ugc nofollow" target="_blank"><em class="mh">Streamlit from Scratch</em></a>网站下载所有代码的链接，包括这段代码。</p><p id="8523" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/alanjones2.github.io"> Github 页面</a>包含其他文章和代码的链接。</p><div class="ok ol gp gr om on"><a href="https://alan-jones.medium.com/membership" rel="noopener follow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">通过我的推荐链接——阿兰·琼斯加入 Medium</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">阅读阿兰·琼斯的每一个故事(以及媒体上成千上万的其他作家)。你的会员费直接支持艾伦…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">alan-jones.medium.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ks on"/></div></div></a></div></div></div>    
</body>
</html>