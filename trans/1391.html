<html>
<head>
<title>A simple way to learn generally from a large training set: DINO</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从大型训练集中学习的简单方法:DINO</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-way-to-learn-generally-from-a-large-training-set-dino-95ecd76e9677#2022-04-06">https://towardsdatascience.com/a-simple-way-to-learn-generally-from-a-large-training-set-dino-95ecd76e9677#2022-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3c75" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这篇文章描述了一种自我监督的学习方法:带<strong class="ak">号</strong>标签的自我<strong class="ak"> di </strong>静止(DINO)</h2></div><p id="be2b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然方法(DINO [1])本身简单明了，但理解该方法有一些先决条件，即1)监督学习，2)自监督学习，3)知识提取，和4)视觉转换器。如果你都知道，你可以在这里跳到<a class="ae le" href="#aac4" rel="noopener ugc nofollow"/>。</p><h2 id="4e3e" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">监督学习</h2><p id="b624" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">监督学习很简单。我们有一堆图像，每个图像都有一个标签。然后，我们通过告诉它哪个图像属于哪个标签来训练一个模型。在这种情况下，我们称之为图像分类，学习目标是独热标签和预测概率分布之间的交叉熵损失。通过取概率分布的最大值的索引，我们获得图像的预测标签。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/527ba35aea735fa6c137bcb3f441a33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5qRVGeLcxn6KIDdamWO7EQ.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">图像分类的监督学习。图片作者。</p></figure><p id="60dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是监督学习的问题是，该模型通常会将图像中包含的丰富视觉信息减少到从几千个类别的预定义集合中选择的单一类别中。换句话说，学习信号只是预测一个标签。</p><h2 id="6056" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">自我监督学习</h2><p id="e5de" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">自我监督学习(SSL)与监督学习略有不同。我们设计了一种可以生成“伪标签”的算法，然后我们像使用监督学习方法一样训练该模型。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mt"><img src="../Images/bad59d7940715e164a7906fb11bf3c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-QSMqUEsrhh-eBYQ9W4TiQ.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">具有自定义损失和自定义伪标签的自监督学习。图片作者。</p></figure><p id="5f23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种SSL方法被称为鉴别方法，包括实例分类(考虑到每个图像都是不同的类别，[2])、对比学习(学习比较(像一个连体网络)而不是分类，[3])或聚类(首先对图像进行聚类，获得伪标签，继续监督学习方法，[4])。在实践中，这是缓慢和内存密集型的，因为只有大批量可以学习正确而不崩溃。最近的方法已经表明，不区分图像的SSL也是可能的，也就是说，改为匹配类似度量学习的表示(例如，BYOL [5])。这样，大批量问题就解决了。</p><p id="75c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用SSL训练的模型通常更“通用”，因为这是从数百万张图像中学习的，而没有告诉它具体要学习什么。因此，该模型可以保持图像的更有用的表示。</p><p id="d49c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们可以使用这种通常自我监督的预训练模型作为初始化，通过通常的监督学习(这通常称为下游任务)对小数据集进行微调。这通常会提高下游任务的性能，因为模型不太可能在小数据集上过度拟合，并且学习到的特征更有用。因此，线性分类或对象检测等下游任务通常被用作SSL方法的评估。</p><h2 id="3e9c" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">知识蒸馏</h2><p id="d091" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">考虑一个预训练的模型，它有一个沉重的主干，如ViT-Large，我们想要一个轻量级的模型，它有更少的参数和计算FLOPS，同时能够输出相同的特征(或类概率)，给定相同的输入(以<strong class="kk iu">模仿</strong>沉重模型的输出)。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mu"><img src="../Images/06ccba2303277d2333558f8f001c569b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ms-1GdaymRRFLFxPaMZG2A.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">知识蒸馏。图片作者。</p></figure><p id="28b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">原因是从零开始训练轻量级模型可能不能像预先训练的重度模型一样好地执行，但是模仿预先训练的重度模型的输出可以确保性能将尽可能保持原样。这就是所谓的知识蒸馏，我们将“知识”从重模型(我们通常称之为教师模型)中“蒸馏”到轻量模型(学生模型)中。通过这种方式，我们可以得到一个快速的压缩模型，并且能够执行与原始模型相同的功能。</p><p id="ac7c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意:学生模型通常比教师模型小，但是也有可能与教师模型具有相同的架构(例如，共蒸馏[6])。</p><h2 id="738f" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">视觉变压器</h2><p id="67ae" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">“Transformer”本身是NLP领域中引入的一种体系结构，它利用了注意力机制。我们可以输入一个有N个标记的句子，然后转换器将首先为每个标记计算一个关注向量和一个嵌入向量(作为一个矩阵，大小分别为NxN和NxD)，然后通过执行关注矩阵和嵌入矩阵的点积(NxN点NxD -&gt; NxD)为每个标记获得一个新的嵌入向量。这意味着每个新的嵌入向量被计算为所有原始嵌入向量的加权和，并且权重是注意力矩阵。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/ba71d39b412104ef2c5e2e03b7803e06.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*5Sp1ukZJvYKWEE1siwR6MQ.png"/></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">变压器中的注意机制。图片由<a class="ae le" href="http://arxiv.org/abs/1706.03762v5" rel="noopener ugc nofollow" target="_blank">关注是你所需要的</a></p></figure><p id="68e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，为类似于“变形金刚”的计算机视觉领域引入了“视觉变形金刚”(ViT)，但N个令牌变成了N个补丁。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/fe26530d5fa37555341d7632871fed44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/0*UfOKOEVCppWTHyj_.png"/></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">视觉变压器。图片作者<a class="ae le" href="https://arxiv.org/abs/2010.11929v2" rel="noopener ugc nofollow" target="_blank">一张图片相当于16x16个字:大规模图像识别的变形金刚</a></p></figure><p id="c6b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通常使用CNN来计算图像表示，vit只是一种替代架构。与CNN的两个关键区别是1)注意力机制2)和捕捉全局关系(意味着在计算表示之前看到所有补丁)。CNN只看到本地补丁，即只看到邻居)。</p><h2 id="aac4" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">带<strong class="ak">号</strong>标签的自<strong class="ak"> Di </strong>剧照(DINO)</h2><p id="3d7d" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">有了前提，我们终于到达了主要焦点——<strong class="kk iu">迪诺</strong>。基本上，<strong class="kk iu">它是计算机视觉的通用SSL方法，可以应用于任何架构。</strong>本文表明，Vision Transformer的注意力机制很好地解释了DINO所学的知识，这有利于图像分割，并且能够实现与专门为自我监督学习设计的最佳CNN相当的性能。</p><p id="4e43" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如前面提到的SSL，我们需要定义一个“伪标签”和一个基于定义的伪标签的学习目标，以便网络可以从中学习。DINO将伪标签定义为“教师的表征”，而不是单一的歧视标签，学习目标是将“学生的表征”与教师的表征相匹配。</p><p id="6943" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从技术上讲，这种学习方式被称为知识升华，我们训练一个学生网络来匹配给定教师网络的输出。在DINO中，教师和学生网络具有相同的架构，但参数不同。给定一幅图像，两个网络将输出K维(预定义的超参数)、Pt(教师输出)和Ps(学生输出)上的概率分布。</p><p id="cb71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过固定教师的参数，学生网络通过使用随机梯度下降最小化交叉熵损失(关于学生的参数)，H(Pt，Ps)来学习匹配分布，其中H(a，b) = -a log b。</p><p id="7a7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在计算概率分布时，网络的输出被传递到softmax函数中，然后被“锐化”。锐化类似于软聚类。如果锐化力度足够强，那么输出就变成了一热标签。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mx"><img src="../Images/0626e5f24bf6c9ae1fd0c0a18a8b07b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCVpVIyG032CLKFnQemx0A.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">锐化示例。图片作者。</p></figure><p id="4192" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我们只知道图像本身就是图像本身，所以许多SSL方法利用了这一优势，生成图像的不同“视图”(意味着不同的放大)。然后教导模型区分两个视图是来自同一图像还是不同图像。模型将试图找出两个视图之间的差异，并选择保留或丢弃表示。在DINO中，使用了相同的策略。即两个视图分别传入老师和学生网，那么匹配目标会要求学生网输出与老师输出相同的值(锐化强度强，匹配目标就像要求学生网预测老师网的标签)。</p><p id="19fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">DINO中使用了更多技巧来防止崩溃，例如1)多作物策略，2)教师网络的动量编码器(即学生网络的EMA)以及教师输出的标准化。</p><p id="0572" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于多裁剪策略，图像的许多较小裁剪被传递到学生网络(想象学生网络仅看到一小部分，但是被要求预测整个图像)。</p><p id="f03d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于动量编码器，参数通常是学生网络的EMA，这就像将过去的许多学生网络堆叠为一个教师网络。这个好处大概和刻薄老师有关。许多最近的SSL方法也应用了相同的实践。</p><p id="fd40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于教师输出的规范化，它与批量规范化非常相似。在批次标准化中，我们执行减去一个值以使批次的均值为零，并缩放一个值以使批次的方差为1。教师归一化也类似，既包括居中(零均值)，也包括锐化(缩放)。居中防止一个维度占主导地位，但鼓励崩溃到均匀分布(意味着每个维度，是一个零均值，我们肯定有正值和负值，然后exp(正)~1，exp(负)~0)。锐化则相反(意味着每个维度，我们只希望有一个高的正值)。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi my"><img src="../Images/9e2c2aaa29e37e490434b95cbb6641d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nSl1gt2Hrtn9vWXe0D2I_Q.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">居中的效果。图片作者。</p></figure><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mz"><img src="../Images/93429340b754dfe6111864603baaaecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBLBH2XgGFKdIkKIAh09XA.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">恐龙的插图。图片作者。</p></figure><h2 id="4168" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">下游任务前有多好</h2><p id="951b" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">经过训练后，教师网络作为计算表征的网络(因为教师网络是过去许多学生网络的叠加)。通过对这些特征进行k-NN，DINO已经可以执行接近纯监督的学习。例如，被监督人的k-NN分数是79.3(在ResNet50上)，而迪诺的分数是67.5。请注意，这是一个非常好的成就，因为我们没有使用单个标签，但仍然能够正确地对图像进行分类和分组。</p><p id="0d03" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当使用Vision Transformer进行训练时，计算出的注意力地图具有惊人的可解释性，能够专注于不同的对象或部分。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0f5d63fedb94913ca65b8e5d7a144e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*VIf4RizxQSsDo-t-pI9S3A.png"/></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">来自ViT的注意地图。图像由<a class="ae le" href="https://arxiv.org/abs/2104.14294v2" rel="noopener ugc nofollow" target="_blank">自我监督视觉变压器中的新兴特性</a></p></figure><p id="0848" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着用DINO训练的ViT可以在没有监督的情况下自然地做分割。</p><h2 id="7ce7" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">结论:新兴属性有哪些？</h2><p id="3eaa" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">虽然DINO是一种通用的SSL方法，但这篇论文的名称是“自监督视觉转换器中的新兴属性”。我猜这是因为作者想表明DINO学习的SSL ViT具有以下性质:1)k-NN分类中特征的质量2)有利于弱监督图像分割的特征中存在关于场景布局的信息。</p><p id="041c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个帖子跳过了很多数学和实验。我推荐读者如果感兴趣的话，可以阅读原文[1]。</p><p id="507c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我个人认为DINO是一个非常简单有效的SSL方法。最近，脸书发布了一个通用的SSL框架— data2vec [7]。我有一个简短的阅读，data2vec实际上是DINO和Masked Autoencoder (MAE) [8]的组合，表明这种学习机制不仅对图像，而且对语音和文本等其他领域都有好处。</p><h2 id="12c6" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">参考</h2><ol class=""><li id="b734" class="nb nc it kk b kl ly ko lz kr nd kv ne kz nf ld ng nh ni nj bi translated">玛蒂尔德·卡隆、乌戈·图夫龙、伊桑·米斯拉、埃尔韦·杰古、朱利安·马亚尔、彼得·博亚诺夫斯基和阿曼德·茹林。自监督视觉转换器的新兴特性。</li><li id="36f3" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">、熊、余、林大华。通过非参数实例鉴别的无监督特征学习。在2018年的CVPR。</li><li id="95a8" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">陈婷、西蒙·科恩布鲁斯、穆罕默德·诺鲁齐和杰夫·弗雷·辛顿。视觉表征对比学习的简单框架。</li><li id="44f2" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">谢，罗斯·吉斯克和阿里·法尔哈迪。用于聚类分析的无监督深度嵌入。2016年在ICML。</li><li id="6798" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">Jean-Bastien Grill、Florian Strub、Florent Altche、Corentin Tallec、Pierre H Richemond、Elena Buchatskaya、Carl Doersch、Bernardo Avila Pires、Daniel Guo、Moham- mad Gheshlaghi Azar、Bilal Piot、Koray Kavukcuoglu、Remi Munos和Michal Valko。引导你自己的潜能:自我监督学习的新方法。在NeurIPS，2020年。</li><li id="00c2" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">罗汉·阿尼尔、加布里埃尔·佩雷拉、亚历山大·帕索斯、罗伯特·奥尔-曼迪、乔治·达尔和杰弗里·欣顿。通过在线蒸馏训练大规模分布式神经网络。</li><li id="95ad" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">阿列克谢·巴夫斯基、许伟宁、许千彤、阿伦·巴布、·古和迈克尔·奥利。data2vec:语音、视觉和语言自我监督学习的一般框架。</li><li id="887a" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated">何、陈、谢赛宁、李、Piotr dollar和Ross Girshick。屏蔽的自动编码器是可扩展的视觉学习器。</li></ol></div></div>    
</body>
</html>