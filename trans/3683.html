<html>
<head>
<title>Excel Automation Tools for User-Friendly Reports with XlsxWriter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用XlsxWriter生成用户友好报表的Excel自动化工具</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/excel-automation-tools-for-user-friendly-reports-with-xlsxwriter-557c2332905c#2022-08-16">https://towardsdatascience.com/excel-automation-tools-for-user-friendly-reports-with-xlsxwriter-557c2332905c#2022-08-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8e20" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过编写任何excel用户都可以阅读的显式excel公式，使用python自动创建Excel报表</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fc280756ae25437664ef17f37e1da461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C5oJ3Mj5SiRm5-eA"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@windows?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">窗口</a>拍摄</p></figure><p id="869b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">问题陈述<br/> </strong>使用python和pandas编写的<strong class="ky ir"> excel自动化脚本</strong>可能面临的主要问题是没有<strong class="ky ir">编程技能的用户的体验</strong>。</p><p id="a45e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事实上，您的工具可以被看作是一个黑盒，它从excel文件中获取数据，在后端进行处理，然后导出到另一个excel文件中。</p><p id="3826" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些用户<strong class="ky ir">不能信任报告</strong>，如果他们不能<strong class="ky ir">访问和修改用于填充结果的公式</strong>。</p><p id="d026" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，用python替换excel会影响用户对解决方案的接受度。</p><p id="f641" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">目标<br/> </strong>在本文中，我提出了一种替代方案，用python库xlswriter来克服这个问题。</p><p id="f657" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">💌新文章直接免费放入你的收件箱:<a class="ae kv" href="https://www.samirsaci.com/#/portal/signup" rel="noopener ugc nofollow" target="_blank">时事通讯</a></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0ccb" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">如何用Python构建Excel自动化工具？</h1><h2 id="cbc5" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated"><strong class="ak">情况</strong></h2><p id="cfd1" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">你是一家时尚零售公司的数据分析师，负责销售报告。</p><p id="c1b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">报告由管理商店销售点的系统生成。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="ca38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这些报告中，您有</p><ul class=""><li id="d784" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">单件销售数量</li><li id="0466" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">共有50个项目的项目代码</li><li id="d42d" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">覆盖全年的日期和星期</li></ul><h2 id="4c36" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">工作</h2><p id="8860" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">出于报告目的，您需要处理这些报告，并将数据集与将用于分析销售趋势的附加功能进行映射。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="3c85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些附加特性与物料代码相关联</p><ul class=""><li id="99af" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr np nq nr ns bi translated">项目系列:皮具、配饰、成衣或其他</li><li id="3f3b" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr np nq nr ns bi translated">范围:布尔值，通知项目是否在分析范围内</li></ul><h2 id="fef4" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">目标</h2><p id="5530" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">由于您每个月需要执行这项任务超过100次，因此您正在寻找一个自动化流程的解决方案。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ny"><a href="http://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">萨米尔·萨奇</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">数据科学博客，专注于仓储，运输，数据可视化和机器人流程自动化…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">samirsaci.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om kp ny"/></div></div></a></div></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="057c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">解决方法</h1><h2 id="f093" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">使用Python熊猫的初步解决方案</h2><p id="d426" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">最初，您使用Python构建了一个解决方案，该解决方案使用pandas实现了自动化处理。</p><p id="1a3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用pandas_read excel，<strong class="ky ir">从几个excel文件导入数据，由您的脚本</strong>处理并导出到另一个excel文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/545948d4c58e27f21baff35755164c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*mC_1EWVhMHFlw2DD.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">初始解决方案—(图片由作者提供)</p></figure><p id="d248" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此脚本已转换为可执行文件(。这样您的同事就可以在没有您支持的情况下使用它了</p><ol class=""><li id="b6de" class="nk nl iq ky b kz la lc ld lf nm lj nn ln no lr oo nq nr ns bi translated">设计并测试您的python脚本</li><li id="5eb2" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr oo nq nr ns bi translated">使用pyinstaller将python脚本导出到可执行文件中</li><li id="d7b5" class="nk nl iq ky b kz nt lc nu lf nv lj nw ln nx lr oo nq nr ns bi translated">分享你的。exe文件<em class="op">(有详细说明)</em>与你的同事</li></ol><p id="07d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有关如何构建该解决方案的更多信息，</p><div class="oq or gp gr os ny"><a href="https://www.samirsaci.com/build-excel-automation-tools-with-python/" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">使用Python | Samir Saci构建Excel自动化工具</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">用于销售分析的Excel自动化工具的自动化和报告设计可供您的同事使用，无需…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">www.samirsaci.com</p></div></div><div class="oh l"><div class="ot l oj ok ol oh om kp ny"/></div></div></a></div><h2 id="d4b8" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">用户接受度的问题</h2><p id="4be2" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">一些用户抱怨说<strong class="ky ir">他们无法访问用于处理数据的公式</strong>。</p><blockquote class="ou"><p id="8a51" class="ov ow iq bd ox oy oz pa pb pc pd lr dk translated">你好Samir，为什么我们看不到最终报告中的公式？你确定你选对了列吗？</p></blockquote><p id="647b" class="pw-post-body-paragraph kw kx iq ky b kz pe jr lb lc pf ju le lf pg lh li lj ph ll lm ln pi lp lq lr ij bi translated">这个问题引起了您的同事的一些担忧，他们质疑该工具的准确性，因为他们无法检查它。</p><h2 id="de8b" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">使用xlsxwriter的新解决方案</h2><p id="0e96" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">想法是使用python库xlsxwriter来执行Excel文件中的计算。</p><p id="9836" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在excel单元格中编写公式，输出文件的用户可以阅读(和修改)这些公式。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/c26473df0bec4bfe9250f16c3759217d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*tFic1H3FGndO3JG9lNUaww.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">xlsxwriter生成的公式示例—(图片由作者提供)</p></figure><p id="b36d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，您保留了python的自动化功能，同时为只熟悉Excel的用户提供了更多的可见性。</p><h2 id="4aaf" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">履行</h2><p id="3c87" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">如果你看一下<a class="ae kv" href="https://xlsxwriter.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> xlsxwriter </a>的文档，你会发现几种在excel单元格上创建公式的方法。</p><p id="2319" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用Pip安装这个库</p><pre class="kg kh ki kj gt pk pl pm pn aw po bi"><span id="4b8e" class="mr ma iq pl b gy pp pq l pr ps">pip install xlsxwriter</span></pre><p id="c9de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以编写应用于单个单元格的公式，</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="d30f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并将你的公式应用于一个数组，</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pt"><img src="../Images/662635a46ca05473a31ebc90db4336f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iy9AVSPmelU01Ky3yzJ35g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最终结果—(图片由作者提供)</p></figure><p id="b5ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，您可以为我们的简单处理任务构建一个解决方案</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pu"><img src="../Images/bf0959493a061595d671a7183c37ff4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eqMBtWz9swivAPZZZbxqcQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最终结果—(图片由作者提供)</p></figure><p id="8211" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外三列是使用Excel公式生成的，每个单元格都可以读取这些公式。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="787d" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="d867" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated"><em class="op">关注我的medium，了解更多与供应链数据科学相关的见解。</em></p><p id="a449" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们满足了最终用户对可见性的需求，同时保持了python的自动化功能。</p><h2 id="0d27" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">低处理速度</h2><p id="9b5a" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">但是，由于库的结构和在excel文件中创建公式所需的计算能力，您将会损失处理速度。</p><h2 id="41cf" class="mr ma iq bd mb ms mt dn mf mu mv dp mj lf mw mx ml lj my mz mn ln na nb mp nc bi translated">有限的功能</h2><p id="929a" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">除了excel公式的限制，您还需要处理xlsxwriter的有限功能。</p><p id="d2d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，您不能用它来构建数据透视表。</p><p id="495a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于高级计算和处理，您需要教育您的用户，并使用另一种方式带来透明度，以获得他们的信任。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="647e" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">关于我</h1><p id="24c5" class="pw-post-body-paragraph kw kx iq ky b kz nd jr lb lc ne ju le lf nf lh li lj ng ll lm ln nh lp lq lr ij bi translated">让我们连接上<a class="ae kv" href="https://www.linkedin.com/in/samir-saci/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>和<a class="ae kv" href="https://twitter.com/Samir_Saci_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，我是一名供应链工程师，正在使用数据分析来改善物流运营和降低成本。</p><p id="5724" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你对数据分析和供应链感兴趣，可以看看我的网站</p><div class="oq or gp gr os ny"><a href="https://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">Samir Saci |数据科学与生产力</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">专注于数据科学、个人生产力、自动化、运筹学和可持续发展的技术博客</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">samirsaci.com</p></div></div><div class="oh l"><div class="pv l oj ok ol oh om kp ny"/></div></div></a></div></div></div>    
</body>
</html>