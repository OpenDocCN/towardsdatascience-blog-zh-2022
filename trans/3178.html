<html>
<head>
<title>Deep Convolutional GAN — How to Use a DCGAN to Generate Images in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度卷积GAN——如何使用DCGAN在Python中生成图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-convolutional-gan-how-to-use-a-dcgan-to-generate-images-in-python-b08afd4d124e#2022-07-13">https://towardsdatascience.com/deep-convolutional-gan-how-to-use-a-dcgan-to-generate-images-in-python-b08afd4d124e#2022-07-13</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="dad9" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">神经网络</h2><div class=""/><div class=""><h2 id="d98b" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">DCGAN架构概述，以及使用Keras / Tensorflow构建该架构的分步指南</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/e7f9b2f8873135a76d98ffa8c624eadb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YJvJEbmhYLJdn12r27Qerg.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">图片由<a class="ae li" href="https://pixabay.com/users/52hertz-2683291/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1431760" rel="noopener ugc nofollow" target="_blank">52赫兹</a>发自<a class="ae li" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1431760" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><h1 id="6bc4" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">介绍</h1><p id="a80a" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">数据科学家将生成性对抗网络(GANs)用于广泛的任务，图像生成是最常见的任务之一。一种称为DCGAN(深度卷积GAN)的特定类型的GAN就是为此而专门开发的。</p><p id="4405" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">在本文中，我将解释DCGANs，并向您展示如何使用Keras/Tensorflow库在Python中构建一个。然后，我们将使用它来生成盆景树的图像。</p><h1 id="1e28" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">内容</h1><ul class=""><li id="a966" class="nc nd iu md b me mf mh mi mk ne mo nf ms ng mw nh ni nj nk bi translated">机器学习算法领域中的DCGANs</li><li id="e19b" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">DCGAN架构及其组件概述</li><li id="82ec" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">Python示例向您展示了如何从头开始构建DCGAN</li></ul><h1 id="1877" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">机器学习算法领域中的DCGANs</h1><p id="1feb" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">机器学习算法之间存在相似之处，这使我们能够根据架构和用例对它们进行分类。因此，我创造了下面的观想，帮助我们看到整个ML宇宙。</p><p id="8886" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">这张旭日图是交互式的，所以请<strong class="md je">点击探索ML类别👇在不同区域</strong>展示更多内容。</p><p id="ede9" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">你会在<strong class="md je">神经网络分支</strong>的<strong class="md je">生成对抗网络子类</strong>下找到DCGANs。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nq nr l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">机器学习算法分类。由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>创建的互动图表。</p></figure><p id="ec57" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> <em class="ns">如果你喜欢数据科学和机器学习</em> </strong> <em class="ns">，请</em> <a class="ae li" href="https://bit.ly/3sItbfx" rel="noopener ugc nofollow" target="_blank"> <em class="ns">订阅</em> </a> <em class="ns">获取我的新文章的电子邮件。如果你不是中等会员，可以在这里加入</em><a class="ae li" href="https://bit.ly/36Mozgu" rel="noopener ugc nofollow" target="_blank"><em class="ns"/></a><em class="ns">。</em></p><h1 id="4cc9" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">DCGAN架构及其组件概述</h1><p id="f1fe" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">首先让我强调一下，DCGAN利用了<strong class="md je">卷积</strong>和<strong class="md je">转置卷积</strong>层，并战略性地将其嵌入到<strong class="md je"> GAN架构</strong>中。</p><p id="439b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们将在下面的章节中熟悉这三个项目。然而，如果你希望看到更多的解释和例子，你也可以阅读我关于<a class="ae li" rel="noopener" target="_blank" href="/convolutional-neural-networks-explained-how-to-successfully-classify-images-in-python-df829d4ba761">卷积神经网络</a>、<a class="ae li" rel="noopener" target="_blank" href="/transposed-convolutional-neural-networks-how-to-increase-the-resolution-of-your-image-d1ec27700c6a">转置卷积</a>和<a class="ae li" rel="noopener" target="_blank" href="/gans-generative-adversarial-networks-an-advanced-solution-for-data-generation-2ac9756a8a99"> GANs </a>的深入文章。</p><h2 id="e700" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">卷积层</h2><p id="9860" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">卷积是从数据中提取有意义信息的一种方式。它们特别适合处理图像，使网络能够有效地学习关键特征。</p><p id="26d0" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">卷积有三个部分:输入(如2D图像)、滤波器(又称内核)和输出(又称卷积特征)。下面的gif展示了我们如何在一个5 x 5的图像上应用一个3 x 3的过滤器来创建一个3 x 3的卷积特征。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oe"><img src="../Images/8af173c3c284c5fbe69aa89b826693ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OVeduMtpBhsRKZBrc6u5Eg.gif"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">卷积在起作用。Gif图片由<a class="ae li" href="https://medium.com/@solclover" rel="noopener">作者</a>提供。</p></figure><p id="9838" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">神经网络可以包含多个卷积层和附加池层，以减小卷积特征的大小。</p><p id="4339" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们将在<strong class="md je">鉴别器模型</strong>和<strong class="md je">生成器模型</strong>的最后一层中使用卷积层(在GAN部分有更多相关信息)。</p><h2 id="b418" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">转置卷积层</h2><p id="ec0a" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">转置卷积也使用过滤器来处理数据，但它们的目标与常规卷积相反。也就是说，我们使用它们来<strong class="md je">上采样</strong>数据到更大的输出特征图，而常规卷积<strong class="md je">下采样</strong>。</p><p id="b68e" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">下面的gif说明了转置卷积是如何工作的。该示例使用步长1，通过2 x 2滤波器从2 x 2输入移动到3 x 3输出。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj of"><img src="../Images/f0f1818676f10844e8eaaf007d4d5450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*YwVviBiy2qAp0CwS5CDwmA.gif"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">转置卷积的作用。Gif图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="1bbc" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们将只使用<strong class="md je">发生器模型</strong>内的转置卷积(见下一节)。</p><h2 id="1d5f" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">DCGAN架构</h2><p id="88c0" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">现在我们知道了什么是卷积和转置卷积，让我们看看它们如何适合GAN设置。</p><p id="70cd" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">一个生成式对抗网络(GAN)将<strong class="md je">生成器</strong>和<strong class="md je">鉴别器</strong>模型结合在一起，它们在零和游戏中<strong class="md je">相互竞争</strong>，使它们成为对手。</p><p id="7e06" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je">发生器制造假图像</strong>试图欺骗鉴别者相信它们是真的。同时，<strong class="md je">鉴别器学习图片的本质特征</strong>，以便<strong class="md je">区分</strong>真假样本。</p><p id="fde0" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">下图说明了这两种模型在DCGAN架构中的交互方式。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj og"><img src="../Images/6a08aa76d25546e895fb8e13a55ab9b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SZo1GcSEnm4M5FQZZ2r_rA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">深度卷积生成对抗网络。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="1e44" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">如您所见，鉴别器模型只是一个卷积分类模型。相比之下，生成器模型更复杂，因为它学习在转置和规则卷积的帮助下将潜在输入转换为实际图像。</p><div class="kt ku kv kw gu ab cb"><figure class="oh kx oi oj ok ol om paragraph-image"><a href="https://solclover.com/membership"><img src="../Images/63320331b74bd98eea6402472b4209ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*qkXay39OnVc2IosW6rkxtw.png"/></a></figure><figure class="oh kx oi oj ok ol om paragraph-image"><a href="https://www.linkedin.com/in/saulius-dobilas/"><img src="../Images/60fb21d1cb2701bfb6b71f61c99403e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vabxOXtQ4T034N_mscHSmQ.png"/></a></figure></div><h1 id="88e5" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">Python示例向您展示了如何从头开始构建DCGAN</h1><p id="4ae9" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">理解DCGAN模型如何工作的最好方法是自己创建一个。在本例中，我们将训练一个DCGAN模型来生成盆景树的低分辨率(64 x 64像素)图像。</p><p id="c917" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">请注意，该示例也适用于生成更高分辨率的图像。但是，分辨率越高，模型需要学习的参数(权重)就越多。因此，生成高分辨率图像所需的计算能力将显著增加。</p><h2 id="ad88" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">设置</h2><p id="1a4f" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我们需要获得以下数据和库:</p><ul class=""><li id="de83" class="nc nd iu md b me mx mh my mk on mo oo ms op mw nh ni nj nk bi translated">加州理工学院101图像数据集(<a class="ae li" href="https://data.caltech.edu/records/20086" rel="noopener ugc nofollow" target="_blank">来源</a>)</li></ul><blockquote class="oq or os"><p id="c8c9" class="mb mc ns md b me mx ke mg mh my kh mj ot mz mm mn ou na mq mr ov nb mu mv mw in bi translated"><strong class="md je"> <em class="iu">数据许可:</em> </strong> <em class="iu"> </em> <a class="ae li" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank"> <em class="iu">归属4.0国际(CC BY 4.0) </em> </a></p><p id="018e" class="mb mc ns md b me mx ke mg mh my kh mj ot mz mm mn ou na mq mr ov nb mu mv mw in bi translated"><strong class="md je"> <em class="iu">参考</em> </strong> <em class="iu">:李，f-f，安德烈托，m，兰扎托，m . a .&amp;，，P. (2022)。加州理工101(版本1.0)[数据集]。CaltechDATA。</em><a class="ae li" href="https://doi.org/10.22002/D1.20086" rel="noopener ugc nofollow" target="_blank"><em class="iu">https://doi.org/10.22002/D1.20086</em></a></p></blockquote><ul class=""><li id="b6f4" class="nc nd iu md b me mx mh my mk on mo oo ms op mw nh ni nj nk bi translated"><a class="ae li" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>用于数据操作</li><li id="68d6" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://pypi.org/project/opencv-python/" rel="noopener ugc nofollow" target="_blank"> Open-CV </a>、<a class="ae li" href="https://matplotlib.org/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>和<a class="ae li" href="https://graphviz.org/" rel="noopener ugc nofollow" target="_blank"> Graphviz </a>用于摄取和显示图像并显示模型图</li><li id="109b" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://www.tensorflow.org/api_docs/python/tf" rel="noopener ugc nofollow" target="_blank"> Tensorflow/Keras </a>用于构建神经网络</li><li id="e69e" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://scikit-learn.org/stable/index.html" rel="noopener ugc nofollow" target="_blank">Scikit-学习库</a>用于特征缩放(<a class="ae li" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html" rel="noopener ugc nofollow" target="_blank">最小最大缩放器</a></li></ul><p id="1066" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">让我们导入库:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><p id="1bfd" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">上面的代码打印了本例中使用的包版本:</p><pre class="kt ku kv kw gu ox oy oz pa aw pb bi"><span id="8183" class="nt lk iu oy b gz pc pd l pe pf">Tensorflow/Keras: 2.7.0<br/>numpy: 1.21.4<br/>sklearn: 1.0.1<br/>OpenCV: 4.5.5<br/>matplotlib: 3.5.1<br/>graphviz: 0.19.1</span></pre><p id="2b75" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">接下来，我们下载、保存和摄取加州理工学院101图像数据集。我们将只使用盆景树的图像(类别=“盆景”)，而不是101个类别的完整列表。此外，我们将设置分辨率为(64 x 64)像素。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><p id="7e98" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">上面的代码打印出我们数据的形状，是<strong class="md je">【样本，行，列，通道】</strong>。</p><pre class="kt ku kv kw gu ox oy oz pa aw pb bi"><span id="0a8d" class="nt lk iu oy b gz pc pd l pe pf">Shape of data_lowres:  (128, 64, 64, 3)</span></pre><p id="1a1f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">让我们展示一些低分辨率图像，看看我们将在哪些方面训练我们的模型。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pg"><img src="../Images/25391ed7e69bd520fa687c4fb1465911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vbBpBgzkIM1cGnI2oeDKIA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">训练数据中的低分辨率图像。来自<a class="ae li" href="https://data.caltech.edu/records/20086" rel="noopener ugc nofollow" target="_blank">加州理工学院101 </a>的原始图像数据。组合图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="55ac" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">最后，让我们将当前范围为[0，1]的图像输入数据缩放到范围[-1，1]。我们这样做，所以我们可以在发生器输出中使用<strong class="md je"> tanh激活函数</strong>，因为它通常会产生更好的结果。</p><p id="8af7" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">然而，在发生器输出中使用<strong class="md je"> sigmoid激活函数</strong>也很常见，这不需要您进一步缩放图像。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><h2 id="f7d6" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">创建DCGAN模型</h2><p id="2e04" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">完成数据准备后，让我们定义和组装我们的模型。我们将从发电机开始:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ph"><img src="../Images/234779c77e0d8b97d7a46e65358a81aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1dBMmk8P58NrbG1PTJaY5w.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">发电机模型图。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="2fc6" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们从一个100节点的潜在向量开始，在将其重新整形为8 x 8 x 128之前，我们将其连接到8192节点的密集层。然后，我们通过转置卷积将数据上采样为64 x 64的输出。</p><p id="72e1" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">请注意，我们还在输出层使用常规卷积，因为我们将过滤器从512个减少到只有3个，代表不同的颜色通道。</p><p id="e5d5" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">接下来，让我们定义一个鉴别器模型:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pi"><img src="../Images/0bc6a692414d6ed859081630d9e5758a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3krpS4jj5p_c5xyT1mGWQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">鉴别器模型图。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="29d5" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">如果您将它与生成器模型进行比较，您会注意到鉴别器模型做的正好相反。即，它获取64×64的图像，并将其通过多个卷积层，以将其简化为真/假的二进制分类输出。</p><p id="d77f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">接下来，我们将这两个模型结合起来创建一个DCGAN。下面代码中的一个关键细节是我们<strong class="md je">使鉴别器模型不可训练</strong>。我们这样做是因为我们希望使用真实和虚假(生成)数据的组合来分别训练鉴别器。稍后您将看到我们是如何做到这一点的。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pj"><img src="../Images/ce53f63b661a63e7af2921eb90790ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-u4R8HjnSf_LQaGGlZzHQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">DCGAN模型图。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><h2 id="42a3" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">为发生器和鉴频器准备输入</h2><p id="1f2b" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我们将创建三个简单的函数来帮助我们为这两个模型采样/生成数据。</p><p id="afef" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">第一种方法从训练数据中抽取真实图像，第二种方法从潜在空间中抽取随机向量，第三种方法将潜在变量传递到生成器模型中以生成假样本。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><h2 id="ea73" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">模型训练和评估</h2><p id="ae7e" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">最后两个函数将帮助我们训练模型，并在指定的时间间隔评估结果。</p><p id="1c77" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">让我们首先创建模型性能评估函数:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><p id="4738" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">正如您所看到的，上面的函数分别在真实和虚假(生成)点上评估鉴别器。此外，它还展示了一些模型生成的图像。</p><p id="e335" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">注意，为了显示假的(生成的)图像，我们需要<strong class="md je">将底层数据从[-1，1]范围逆变换到[0，1]范围。</strong></p><p id="f2e8" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">最后，培训功能:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="ow nr l"/></div></figure><p id="18f7" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">如前所述，我们通过传递一批50%真实和50%虚假(生成)的样本来分别训练鉴别器。同时，发电机训练通过组合的DCGAN模型进行。</p><h2 id="2971" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">结果</h2><p id="5a13" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">让我们调用训练函数来训练模型并显示一些结果。</p><pre class="kt ku kv kw gu ox oy oz pa aw pb bi"><span id="aca6" class="nt lk iu oy b gz pc pd l pe pf"># Train DCGAN model<br/>train(gen_model, dis_model, gan_model, data, latent_dim)</span></pre><p id="389e" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">以下是在对模型进行2000个纪元的训练后生成的一些假图像:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pk"><img src="../Images/f8170941b5c052d541f0f543124b4e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tQl9Oyf5WJBEd6B8bbPF7w.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">DCGAN在2000个训练时期后生成盆景树图像。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="643e" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">3000年后又多了一些:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pl"><img src="../Images/4b58d48a6c8902ebf6f428b8cf3e2490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZw0t9Xc928qnnm-FNPIoA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">DCGAN在3000个训练时期后生成盆景树图像。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="99a6" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">正如你所看到的，一些图像很糟糕，而另一些看起来很艺术。然而，很明显需要更多的训练。</p><h1 id="4ab6" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">结束语</h1><p id="c999" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我鼓励你用我的例子做进一步的实验，并分享你的结果。我敢肯定，通过一些额外的培训或替代模型参数，您可以获得更好的结果。</p><p id="91cd" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je">如果你想收到我即将发表的关于其他类型gan的文章</strong>，请用你的电子邮件订阅<a class="ae li" href="https://bit.ly/3uJnQFT" rel="noopener ugc nofollow" target="_blank">，我一发表这些文章，它们就会马上到达你的收件箱。或者，请随意浏览我已经在Medium </a>上发布的关于机器学习的40多篇文章。</p><p id="7762" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">最后，你可以在我的<a class="ae li" href="https://github.com/SolClover/Art053_NN_DCGAN" rel="noopener ugc nofollow" target="_blank"> <strong class="md je"> GitHub库</strong> </a>上找到本文使用的完整Python代码作为Jupyter笔记本。</p><p id="317e" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">干杯！🤓<br/> <strong class="md je">索尔·多比拉斯</strong></p><p id="da3f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> <em class="ns">如果你已经花光了这个月的学习预算，下次请记得我。</em> </strong> <em class="ns">我的个性化加盟链接媒介:</em></p><div class="pm pn gq gs po pp"><a href="https://bit.ly/3J6StZI" rel="noopener  ugc nofollow" target="_blank"><div class="pq ab fp"><div class="pr ab ps cl cj pt"><h2 class="bd je gz z fq pu fs ft pv fv fx jd bi translated">通过我的推荐链接加入Medium索尔·多比拉斯</h2><div class="pw l"><h3 class="bd b gz z fq pu fs ft pv fv fx dk translated">阅读索尔·多比拉斯和媒体上成千上万的其他作家的每一个故事。你的会员费直接支持索尔…</h3></div><div class="px l"><p class="bd b dl z fq pu fs ft pv fv fx dk translated">solclover.com/membership</p></div></div><div class="py l"><div class="pz l qa qb qc py qd lc pp"/></div></div></a></div></div></div>    
</body>
</html>