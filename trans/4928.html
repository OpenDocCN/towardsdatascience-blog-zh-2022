<html>
<head>
<title>How to Quickly Design Advanced Sklearn Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何快速设计先进的Sklearn管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-quickly-design-advanced-sklearn-pipelines-3cc97b59ce16#2022-11-02">https://towardsdatascience.com/how-to-quickly-design-advanced-sklearn-pipelines-3cc97b59ce16#2022-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="c6c5" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">辅导的</h2><div class=""/><div class=""><h2 id="3b9d" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">组合Scikit-Learn管道中的所有组件，构建定制的生产就绪模型</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3a614ade9a86c8317aec6962ec460c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2ZIJBnZTje_O3fo4"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">克林特·帕特森在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6049" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本教程将教你<strong class="lk jd">如何以及何时</strong>使用来自Sklearn Pipelines生态系统的所有高级工具来构建<strong class="lk jd">定制的、可扩展的、模块化的机器学习模型</strong>，这些模型能够<strong class="lk jd">轻松部署到生产中。</strong></p><p id="4994" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">单独来看，Sklearn Pipelines工具箱中有许多关于不同组件的内容。我写这篇教程是因为看到所有这些组件如何在一个更复杂的系统中协同工作是非常珍贵的。</p><p id="5ec0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将使用一个<strong class="lk jd">具体示例</strong>向您展示<strong class="lk jd">如何以及何时</strong>使用以下组件:</p><ul class=""><li id="5fd7" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html" rel="noopener ugc nofollow" target="_blank">变压器混频器</a></li><li id="ae21" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html" rel="noopener ugc nofollow" target="_blank">基本估算器</a></li><li id="c9d6" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.FunctionTransformer.html" rel="noopener ugc nofollow" target="_blank">功能变压器</a></li><li id="4999" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html" rel="noopener ugc nofollow" target="_blank">柱式变压器</a></li><li id="4b4d" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.FeatureUnion.html" rel="noopener ugc nofollow" target="_blank">特征联合</a></li><li id="5fdb" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.TransformedTargetRegressor.html" rel="noopener ugc nofollow" target="_blank">转换的目标进度器</a></li></ul><blockquote class="ms mt mu"><p id="f947" class="li lj mv lk b ll lm kd ln lo lp kg lq mw ls lt lu mx lw lx ly my ma mb mc md im bi translated">知道如何单独使用它们是很容易的，这也是为什么本教程将会强调<strong class="lk jd">何时</strong>使用它们以及<strong class="lk jd">如何在一个复杂的系统中互换使用</strong>。</p></blockquote><h2 id="067f" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">目标</h2><p id="c735" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">我们将建立一个<strong class="lk jd">预测模型</strong>来预测下一年的全球平均小麦产量。</p><p id="9817" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">主要重点将放在<strong class="lk jd"> Sklearn管道</strong> <strong class="lk jd">组件的<strong class="lk jd">高级概念</strong>上。因此</strong>，我们不会在其他数据科学原理上花太多时间。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="7bda" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">目录</h1><ul class=""><li id="3687" class="me mf it lk b ll nr lo ns lr oo lv op lz oq md mj mk ml mm bi translated">资料组</li><li id="1d2a" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">管道基础概述</li><li id="1dd7" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">配置</li><li id="72b0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">数据准备</li><li id="c97f" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">建设管道</li><li id="ff26" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">全球管道。让我们把事情放在一起。</li><li id="6394" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">如何使用全球管道</li></ul><p id="d561" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">注:<em class="mv"> </em> </strong>如果你只对Sklearn管道的高级主题感兴趣，直接跳到<strong class="lk jd">构建管道。</strong></p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="1697" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">资料组</h1><p id="35b7" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">我们使用的是由<a class="ae lh" href="https://doi.pangaea.de/10.1594/PANGAEA.909132" rel="noopener ugc nofollow" target="_blank"> Pangaea </a>提供的公开可用的<strong class="lk jd">数据集</strong>【1】，该数据集跟踪了从1981年到2016年各种植物的全球历史年产量。</p><p id="e2f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们使用这个<a class="ae lh" href="https://github.com/awesomedata/awesome-public-datasets" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>找到了数据集。查看更多精彩的公开数据集。</p><p id="f544" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据集提供了多种类型的作物，但在本例中，我们将只使用小麦。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl or"><img src="../Images/c73239a854fa42df8ef704d447da9437.png" data-original-src="https://miro.medium.com/v2/format:webp/1*SeAX5rQL7UL00uw6Gzwxtg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">全球小麦年产量和泛大陆数据集内提供的位置数量[图片由作者提供]。</p></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="2519" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">管道基础概述</h1><p id="de9b" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">这里有一个Sklearn Pipelines生态系统使用的主要原则的简短提示。</p><p id="a32a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一切都围绕着<strong class="lk jd">管道</strong>对象。</p><p id="823a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个<strong class="lk jd">管道</strong>包含多个<strong class="lk jd">估算器</strong>。</p><p id="1575" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个<strong class="lk jd">估算器</strong>可以具有以下属性:</p><ul class=""><li id="846d" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">从数据中学习→使用<strong class="lk jd"> fit() </strong>方法</li><li id="bcd6" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">转换数据→使用<strong class="lk jd"> transform() </strong>方法。也被称为<strong class="lk jd">变压器</strong>(不，不是机器人，它是<strong class="lk jd">估计器</strong>的<strong class="lk jd">子类</strong>)。</li><li id="5fe4" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">从新数据预测→使用<strong class="lk jd"> predict() </strong>方法。也称为<strong class="lk jd">预测器</strong>。</li></ul><p id="0ab3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">注1: </strong>我们可以拥有没有<strong class="lk jd"> fit() </strong>方法的<strong class="lk jd">变形金刚</strong>。因此，这些类没有参数化，并且遵循纯函数的原则。通常，这些类型的转换器在进行特征工程时很有帮助(例如，在使用<strong class="lk jd"> fit() </strong>方法之前，我们无需学习任何东西就可以将两个不同的列相乘)。</p><p id="142e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">注2:</strong><strong class="lk jd">管道</strong>对象继承了<strong class="lk jd">管道</strong>中最后一个<strong class="lk jd">估算器</strong>的方法。</p><p id="c81c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">注3: </strong>如果你想给你的管道添加一个模型，它必须是最后一个元素。我将向您展示如何使用<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.TransformedTargetRegressor.html" rel="noopener ugc nofollow" target="_blank">TransformedTargetRegressor</a>对模型预测执行后处理操作的技巧。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="26ea" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">配置</h1><h2 id="30d7" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">将管道呈现为图表</h2><p id="7530" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">通过将Sklearn配置的显示设置为“<strong class="lk jd"> diagram，”</strong>，我们可以快速将管道可视化为图表。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/fc08f7470b69bb7880a063a488ddb427.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*Tw9tYDYpeKwOG7TyYE2CSA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Sklearn管道图可视化示例【图片由作者提供】。</p></figure><h2 id="8e3c" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">常数</h2><p id="0e65" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">下面我们将定义一些在代码中使用的常量。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="0437" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">数据准备</h1><h2 id="8b56" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">挑选事实真相</h2><p id="5076" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">因为时间序列预测是一种无监督学习的形式，我们必须使用过去的信息来预测tₙ<strong class="lk jd">的一个数据点。因此，在开始时，我们将把特征和标签作为相同的时间序列。但是在预处理步骤中，我们将使用特征作为过去的数据点，使用标签作为我们想要预测的数据点。</strong></p><p id="9212" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这不是一个时间序列预测帖子。所以，这一步不要想多了。还有，你不用一行一行的读代码。</p><blockquote class="ms mt mu"><p id="3aa5" class="li lj mv lk b ll lm kd ln lo lp kg lq mw ls lt lu mx lw lx ly my ma mb mc md im bi translated">只需<strong class="lk jd">将</strong>聚焦在<strong class="lk jd">大图</strong>和<strong class="lk jd">管道</strong>步骤上。<strong class="lk jd"> </strong>了解<strong class="lk jd">如何以及何时</strong>使用特定<strong class="lk jd"> Sklearn组件的最终目标就足够了。</strong></p></blockquote><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="79a5" class="mz na it ow b gy pa pb l pc pd">X, y = yields.copy(), yields.copy()</span></pre><h2 id="2f06" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">分割数据:培训和测试</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="7eec" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我们将在训练和测试之间拆分数据。您将看到正确使用Sklearn管道在新数据上使用您的模型是多么容易。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="3206" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们看看火车测试分裂看起来如何:</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="6129" class="mz na it ow b gy pa pb l pc pd"><em class="mv">(Starting year of the split, Ending year of the split, number of years within the split)</em></span><span id="2ae7" class="mz na it ow b gy pe pb l pc pd"><strong class="ow jd">X_train.index.min(), X_train.index.max(), X_train.index.max() - X_train.index.min() + 1</strong></span><span id="0abb" class="mz na it ow b gy pe pb l pc pd">(1981, 2012, 32)</span><span id="fe8f" class="mz na it ow b gy pe pb l pc pd"><strong class="ow jd">y_train.index.min(), y_train.index.max(), y_train.index.max() - y_train.index.min() + 1</strong></span><span id="5c85" class="mz na it ow b gy pe pb l pc pd">(1986, 2012, 27)</span><span id="db33" class="mz na it ow b gy pe pb l pc pd"><strong class="ow jd">X_test.index.min(), X_test.index.max(), X_test.index.max() - X_test.index.min() + 1</strong></span><span id="0aa5" class="mz na it ow b gy pe pb l pc pd">(2007, 2016, 10)</span><span id="5c69" class="mz na it ow b gy pe pb l pc pd"><strong class="ow jd">y_test.index.min(), y_test.index.max(), y_test.index.max() - y_test.index.min() + 1</strong></span><span id="df00" class="mz na it ow b gy pe pb l pc pd">(2012, 2016, 5)</span></pre></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="b2c4" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">建设管道</h1><p id="d912" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">说够了。让我们开始实现实际的管道。</p><p id="acca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">全局管道</strong>分为以下子组件:</p><ol class=""><li id="b565" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md pf mk ml mm bi translated">平稳性管线(用于<em class="mv">特征</em>和<em class="mv">目标</em></li><li id="e15c" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md pf mk ml mm bi translated">特色工程管道</li><li id="8222" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md pf mk ml mm bi translated">回归器管道</li><li id="9101" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md pf mk ml mm bi translated">目标管道</li></ol><h2 id="b89d" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">1.平稳流水线</h2><p id="5208" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">流水线用于时间序列，使其保持平稳。更具体地说，它将消除周期性，并对不同时间的平均值和方差进行标准化。你可以在这里阅读更多相关内容。</p><p id="3114" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这一步中，我们将向您展示如何使用以下内容:</p><ul class=""><li id="9a48" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html" rel="noopener ugc nofollow" target="_blank">变压器米欣</a></li><li id="5721" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html" rel="noopener ugc nofollow" target="_blank">基本估算器</a></li><li id="4fb2" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.FunctionTransformer.html" rel="noopener ugc nofollow" target="_blank">功能变压器</a></li></ul><p id="1933" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">我们可以用两种方式来构建管道估算器:</strong></p><p id="ab23" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">1️⃣继承了BaseEstimator + TransformerMixin。使用这种方法，管道单元可以从数据中学习，转换数据，并反转转换。以下是受支持接口的简短描述:</p><ul class=""><li id="9f27" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><strong class="lk jd"> fit(X，y) </strong> —用于从数据中学习</li><li id="3eb6" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd"> transform(X) </strong> —用于转换数据</li><li id="23fa" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd"> fit_transform (X) </strong> —学习并转换数据。该函数继承自TransformerMixin</li><li id="716e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd"> inverse_transform(X) </strong> —用于反向变换</li></ul><p id="ddb5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="mv">注1: </em> </strong>此语句始终成立:<strong class="lk jd">x = = inverse _ transform(transform(x))</strong>—接受小容差。</p><p id="92ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="mv">注2: </em> </strong>目标(如y)只在fit()方法中传递。至于transform()和inverse_transform()，仅给出特征(例如，X)作为输入。此外，我们不能强制管道访问任何其他属性。</p><p id="3261" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">2️⃣编写了一个纯函数，最终被FunctionTransformer封装。</p><p id="31ab" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当转换不需要有状态(它没有fit()方法)，也不需要对转换进行逆变换(它没有inverse_transform()方法)时，这种方法是实用的。因此，当您只需要实现transform()方法时，这很有用。</p><p id="f355" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这必须是一个纯函数(对于输入A，你<strong class="lk jd">总是</strong>得到输出B →它不依赖于外部上下文)。否则，当您的管道变大时，您会遇到奇怪的行为。</p><p id="7089" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="mv">注意:</em> </strong>因为我们只实现了一个转换，所以我们只能访问特性(例如X)。我们无法访问任何其他属性。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="fbf0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">作为观察，我们选择为转换编写一个类，即使它不需要实现fit()方法(例如LogTransformer)。但是，将转换及其逆转换打包到同一个结构中是一个很好的软件实践。</p><p id="cc64" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们利用Python <em class="mv"> functools </em>模块中的<strong class="lk jd">部分</strong>函数来配置转换。</p><p id="008c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如前所述，赋予<strong class="lk jd"> FunctionTransformer </strong>的函数应该只接受一个输入，只输出一个值。<strong class="lk jd"> </strong>还有，在构造函数里面配置它不是一个类。因此，使用<strong class="lk jd"> partial，</strong>我们可以只设置一个函数参数的子集。它将结束我们的初始函数，并在下一次调用时返回另一个函数，该函数只需要未在<strong class="lk jd">部分</strong>中指定的参数作为输入。</p><p id="3ea7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，让我们建立管道。我们使用了<strong class="lk jd"> make_pipeline() </strong>实用函数，它自动命名每个管道步骤。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/99987b5d4a1c120f3b367842da1770b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*G2rYUubcLV1phUlmlprhhA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">stationary_pipeline的示意图[图片由作者提供]。</p></figure><p id="6396" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是如何快速检查您的转换和inverse_transformation是否正确执行的方法:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="11c0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用<strong class="lk jd"> np.allclose()，</strong>我们通过接受一个小错误来检查等式。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl or"><img src="../Images/db0a8423d15a03caf9e37ee6b997ddb8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*QK6XqE791NeCz_ydjcA3xA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">时间序列经过静态管道处理后的样子示例[图片由作者提供]。</p></figure><h2 id="0a47" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">2.特色工程管道</h2><p id="1dc1" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">现在让我们做一些特征工程。</p><p id="0e44" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">注意，你不必理解每个函数的实现。<strong class="lk jd">关注结构</strong>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="b4bb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于大多数转换，我们使用了<strong class="lk jd">纯函数</strong> + <strong class="lk jd"> FunctionTransformer </strong>。我们使用这种方法是因为我们对实现<em class="mv"> fit() </em>或<em class="mv"> inverse_transform() </em>不感兴趣。因此，使用这种方法，我们的代码更加简洁。</p><p id="ed5e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">只有DropRowsTransformer是用类实现的，因为它同时需要<em class="mv"> fit() </em>和<em class="mv">inverse _ transformer()</em>。</p><blockquote class="ms mt mu"><p id="dcbb" class="li lj mv lk b ll lm kd ln lo lp kg lq mw ls lt lu mx lw lx ly my ma mb mc md im bi translated">从我的经验来看，在实现数据和特征工程管道时，我通常发现<strong class="lk jd">函数转换器</strong>更有用、更干净。我不认为继承类并让大多数方法为空是好的做法。</p></blockquote><p id="8f2e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在让我们进入<strong class="lk jd">甜蜜部分</strong>，在这里我们将使用:</p><ul class=""><li id="78a6" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.make_column_transformer.html" rel="noopener ugc nofollow" target="_blank">make _ column _ transformer</a>(<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html" rel="noopener ugc nofollow" target="_blank">column transformer</a>的快捷方式)</li><li id="72b2" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_union.html" rel="noopener ugc nofollow" target="_blank">make _ union</a>(<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.FeatureUnion.html" rel="noopener ugc nofollow" target="_blank">feature union</a>的快捷方式)</li></ul><p id="89df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用<strong class="lk jd">make _ column _ transformer</strong>，我们可以在<em class="mv">列</em>的<em class="mv">子集</em>上运行<em class="mv">不同的操作/流水线</em>。在这个具体的例子中，我们对“<em class="mv">mean _ yield”</em>和“<em class="mv">locations”</em>列运行了不同的转换。这个操作器的另一个好处是，它为<em class="mv">平行</em>中的每一组<em class="mv">列</em>运行<em class="mv">操作</em>。因此，并行计算“<em class="mv">mean _ yield”</em>和<em class="mv">“locations”</em>的特征。</p><p id="093c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用<strong class="lk jd"> make_union </strong>，我们可以计算<em class="mv">平行</em>中的<em class="mv">多重特征</em>。在本例中，对于“<em class="mv"> mean_yield，”</em>，我们并行计算四个不同的特征:</p><ul class=""><li id="0013" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">过去的观察</li><li id="0edc" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">移动平均数</li><li id="3411" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">移动标准偏差</li><li id="5bc7" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">移动中位数</li></ul><p id="1e29" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="mv">注1: </em> </strong>同样的原理也适用于“<em class="mv">位置”</em>特征。</p><p id="0a3c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="mv">注2: </em> </strong>我推荐使用<strong class="lk jd"> make_[x] </strong>效用函数。这会让你的生活更轻松。</p><p id="5393" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下面的代码片段中，您可以看到这些组件的运行。遵循Sklearn管道范例，看看我们如何很好地重用了管道中的大多数功能。</p><p id="98f5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另一个基本元素是<strong class="lk jd"> memory= "cache" </strong>属性。使用它，所有的步骤都被缓存在本地磁盘上。因此，如果您的输出在新运行时被缓存，它将自动从缓存中读取结果。如果发生变化，它还知道何时使缓存无效。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><blockquote class="ph"><p id="08ea" class="pi pj it bd pk pl pm pn po pp pq md dk translated">现在，用最少的努力，通过并行运行<strong class="ak">所有的</strong>转换并缓存管道的输出，你的机器学习管道将会非常快。</p></blockquote><figure class="ps pt pu pv pw kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pr"><img src="../Images/abb4c0947c315850f750440e7029af90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P0LwHOWFJwHs4DRQG3wSuA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">特征_工程_管线图。请注意，在笔记本中，图表是交互式的。你有一个下拉菜单，显示每个管道单元的更多细节。</p></figure><p id="c97b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们在我们的培训功能上运行<em class="mv">功能_工程_管道</em>:</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="32fd" class="mz na it ow b gy pa pb l pc pd">feature_engineered_yields = feature_engineering_pipeline.fit_transform(X_train.copy())</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl or"><img src="../Images/12b36609278b6f1a59d4d2259bfe50aa.png" data-original-src="https://miro.medium.com/v2/format:webp/1*s55MWnpCz8ugpL0VkNdgHg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由feature _ engineering _ pipeline[Image by Author]计算的训练特征。</p></figure><p id="0af3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在让我们在我们的测试功能上运行它:</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="7209" class="mz na it ow b gy pa pb l pc pd">feature_engineering_pipeline.transform(X_test.copy())</span></pre><h2 id="644d" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">3.回归器管道</h2><p id="4e70" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">下面你可以看到如何建立最终回归。除了上面介绍的<em class="mv">feature _ engineer _ pipeline</em>之外，我们还堆叠了一个缩放器和一个随机森林模型。</p><blockquote class="ms mt mu"><p id="3b39" class="li lj mv lk b ll lm kd ln lo lp kg lq mw ls lt lu mx lw lx ly my ma mb mc md im bi translated">您可以观察到模型是添加到管道中的最后一个单元。</p></blockquote><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><h2 id="0963" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">4.目标管道</h2><p id="499c" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated"><strong class="lk jd"> target_pipeline </strong>用于<em class="mv">预处理</em>标签和<em class="mv">后处理</em>模型的<em class="mv">预测</em>。</p><p id="e3e1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一切都会在一瞬间变得有意义。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="a702" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">全球管道。让我们把事情放在一起。</h1><p id="d532" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">这里我们将向您展示如何使用<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.TransformedTargetRegressor.html" rel="noopener ugc nofollow" target="_blank">TransformedTargetRegressor</a>组件。</p><p id="dcad" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">TransformedTargetRegressor</strong>类<strong class="lk jd"> </strong>采用以下参数:</p><ul class=""><li id="8a60" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><strong class="lk jd">回归器</strong>:将上面定义的<em class="mv">回归器_管道</em>作为输入。我们习惯在大多数管道中使用的东西。</li><li id="964d" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd"> transformer: </strong>将<em class="mv"> target_pipeline </em>作为输入，后者将<em class="mv">预处理</em>标签，当使用管道中定义的<em class="mv"> fit() </em>和<em class="mv"> transform() </em> <strong class="lk jd"> </strong>方法时，模型将使用这些标签作为基础事实。<em class="mv">还有</em>，做预测的时候会<em class="mv">后处理</em>模型的输出调用<em class="mv">inverse _ transform()</em><strong class="lk jd">。</strong>多牛逼啊？最后，将所有步骤打包成一个逻辑单元的方法。</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi px"><img src="../Images/e3706742bdc2470818e34c1db5d76d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCuOrUNO9B5VHefOfc3BRQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">整个管道的示意图。随着管道变得更加复杂，一个好的可视化将永远是你的朋友[图片由作者提供]。</p></figure></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="95cf" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">如何使用全球管道</h1><h2 id="a0f4" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">火车</h2><p id="14cb" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">现在，培训步骤只是一行程序。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="a7db" class="mz na it ow b gy pa pb l pc pd">pipeline.fit(X=X_train.copy(), y=y_train.copy())</span></pre><h2 id="c0f0" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">做预测</h2><p id="399a" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">最棒的是做预测；你还必须打电话给一个俏皮话。调用<strong class="lk jd">pipeline . predict(X)</strong>就是这样。你有你的预言。</p><p id="c53a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用<strong class="lk jd"> TransformedTargetRegressor，</strong>调用predict时，预测已经被转换回其初始比例。因此，模型/管道高度紧凑，易于在各种场景中部署:批处理、API、流式、嵌入式等。</p><p id="97cd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">另一个有用的特性是，您可以在您的特征和模型上快速使用GridSearch(或其他技术)。现在，您可以将数据管道中的不同配置视为超参数。因此，您只需几行代码就可以快速体验各种特性。</p><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="f9e9" class="mz na it ow b gy pa pb l pc pd"><strong class="ow jd">y_pred = pipeline.predict(X_test.copy())<br/>y_pred</strong></span><span id="6523" class="mz na it ow b gy pe pb l pc pd">26    4.026584<br/>0     4.122576<br/>1     4.080378<br/>2     4.174781<br/>3     4.380293<br/>Name: 0, dtype: float64</span></pre><h2 id="c087" class="mz na it bd nb nc nd dn ne nf ng dp nh lr ni nj nk lv nl nm nn lz no np nq iz bi translated">试验</h2><p id="2e4d" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">为了好玩，让我们使用传统的<strong class="lk jd"> RMSE </strong>和<strong class="lk jd"> MAPE </strong>指标来评估这个模型。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="os ot l"/></div></figure><pre class="ks kt ku kv gt ov ow ox oy aw oz bi"><span id="05ef" class="mz na it ow b gy pa pb l pc pd"><strong class="ow jd">evaluate(y_test, y_pred)</strong></span><span id="4da5" class="mz na it ow b gy pe pb l pc pd">INFO:sklearn-pipelines:RMSE: 0.147044<br/>INFO:sklearn-pipelines:MAPE: 0.030220</span></pre><p id="2b6e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以观察到，它使用一个简单的模型做得很好，根本没有任何微调。在大约4.0的范围内，大约0.13的RMSE已经很不错了。</p><p id="abcb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是正如几次提到的，本教程是关于利用Sklearn管道，而不是建立一个精确的模型。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="cb72" class="od na it bd nb oe of og ne oh oi oj nh ki ok kj nk kl ol km nn ko om kp nq on bi translated">结论</h1><p id="4fb7" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">如果你已经走了这么远，那你就太棒了。现在你知道如何编写专业的Scikit管道了。谢谢你看我的文章！</p><p id="6246" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">通过一个具体的例子，我们展示了利用Sklearn管道及其整个组件堆栈的强大功能:TransformerMixin、BaseEstimator、FunctionTransformer、ColumnTransformer、FeatureUnion、TransformedTargetRegressor。</p><p id="75e3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用这种方法，我们构建了一个灵活的机器学习管道，我们可以:</p><ul class=""><li id="562f" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">轻松地重用转换，并以各种方式组合它们(模块化代码)。</li><li id="a089" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">编写干净的、可伸缩的类。</li><li id="8723" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">编写高速代码，并行计算所有特性，并缓存整个管道中的中间检查点。</li><li id="b217" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">将模型作为简单的类直接部署，无需进一步的预处理/后处理步骤。</li><li id="5ef5" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">对特征/数据管线和模型本身快速执行超参数调整。</li></ul><blockquote class="ph"><p id="b712" class="pi pj it bd pk pl pm pn po pp pq md dk translated">关于Sklearn管道，你还知道哪些隐藏的宝石？</p></blockquote><p id="9c23" class="pw-post-body-paragraph li lj it lk b ll py kd ln lo pz kg lq lr qa lt lu lv qb lx ly lz qc mb mc md im bi translated">你可以在我的<a class="ae lh" href="https://github.com/IusztinPaul/ml-blog-code/tree/main/professional-sklearn-pipelines" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到教程中使用的例子的完整实现。在这个库中，我将不断地推送我将用来撰写各种文章的所有示例。</p><h1 id="4d47" class="od na it bd nb oe qd og ne oh qe oj nh ki qf kj nk kl qg km nn ko qh kp nq on bi translated">参考</h1><p id="bba4" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">[1] Iizumi，Toshichika，<a class="ae lh" href="https://doi.pangaea.de/10.1594/PANGAEA.909132" rel="noopener ugc nofollow" target="_blank">全球历史收益率数据集v1.2和v1.3对齐版本。盘古大陆</a> (2019)，补充:饭泉，土肥猪；Sakai，【1981年至2016年 (2020年)全球主要农作物历史产量数据集，科学数据</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="c496" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你喜欢读我的文章，你可以在LinkedIn上关注我，了解关于ML、MLOps和自由职业者的每周见解。</p><div class="qi qj gp gr qk ql"><a href="https://medium.com/membership/@pauliusztin" rel="noopener follow" target="_blank"><div class="qm ab fo"><div class="qn ab qo cl cj qp"><h2 class="bd jd gy z fp qq fr fs qr fu fw jc bi translated">通过我的推荐链接加入Medium-Paul Iusztin</h2><div class="qs l"><h3 class="bd b gy z fp qq fr fs qr fu fw dk translated">加入我们，从我和其他作者那里获得关于ML、MLOps和自由职业的独家内容。🚀解锁对…的完全访问权限</h3></div><div class="qt l"><p class="bd b dl z fp qq fr fs qr fu fw dk translated">medium.com</p></div></div><div class="qu l"><div class="qv l qw qx qy qu qz lb ql"/></div></div></a></div></div></div>    
</body>
</html>