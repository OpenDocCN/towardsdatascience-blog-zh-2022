<html>
<head>
<title>Transformers for Tabular Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">表格数据的转换器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/transformers-for-tabular-data-b3e196fab6f4#2022-08-02">https://towardsdatascience.com/transformers-for-tabular-data-b3e196fab6f4#2022-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bebf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何用自己的数据使用SageMaker内置的算法TabTransformer</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c55f151e85ba02b8c12a4e65505b3a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r9DLXn-b1p4w9TDtNeALVw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片(用OpenAI的DALL <code class="fe kv kw kx ky b">·</code> E 2创建)</p></figure><h1 id="89a0" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">这是怎么回事？</h1><p id="29d1" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">2022年6月，AWS <a class="ae mn" href="https://aws.amazon.com/about-aws/whats-new/2022/06/amazon-sagemaker-built-in-algorithms-four-new-tabular-data-modeling-algorithms/" rel="noopener ugc nofollow" target="_blank">宣布</a>一系列新的内置表格数据算法。由于我已经在NLP领域研究了一段时间的变形金刚，我当然对TabTransformer算法很好奇。</p><p id="36a3" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">TabTransformer的前提是有希望的:根据上下文的不同，特性中的分类值可以有不同的含义。就像单词“bank”在句子中可以根据上下文表示不同的意思一样(“river bank”与“Bank of England”)，TabTransformer在表格数据中使用该信息，如果上下文不同，则用不同的表示相同的值。你可以在这篇<a class="ae mn" href="https://arxiv.org/abs/2012.06678" rel="noopener ugc nofollow" target="_blank">论文</a>中了解更多。</p><p id="2026" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">在本教程中，我们将使用新的内置算法，通过自带数据来利用这一新功能。本教程的代码封装在Python脚本中，而不是笔记本中，因此我们可以在本地IDE中舒适地运行整个工作流。</p><p id="9a0d" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">本教程的代码可以在这个<a class="ae mn" href="https://github.com/marshmellow77/tab-transformer" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到。</p><h1 id="91a1" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">为什么这很重要？</h1><p id="1e0b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">TabTransformer使用自然语言处理(NLP)的上下文嵌入概念，并将其扩展到表格数据，这可能会导致对数据的更好理解，并可能最终导致比传统分类模型更好的结果。</p><p id="4e17" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">但之所以这是一件大事，是因为绝大多数ML项目仍然是分类或回归问题，并处理表格数据。因此，我们可以通过新架构实现的任何改进都会产生巨大的影响，这仅仅是因为存在大量的表格数据项目。</p><h1 id="ab50" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">行动（或活动、袭击）计划</h1><p id="3958" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">AWS文档提供了关于如何使用TabTransformer的<a class="ae mn" href="https://docs.aws.amazon.com/sagemaker/latest/dg/tabtransformer.html#tabtransformer-modes" rel="noopener ugc nofollow" target="_blank">示例代码</a>，但是该代码使用了已经相应准备好的标准数据集。然而，在本教程中，我们想带来我们自己的数据集，以便我们了解如何设置整个ML工作流端到端。</p><p id="729d" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">我们将准备数据并上传到S3桶，SageMaker (SM)可以在那里访问它。然后，我们将开始一项SM培训工作，以培训TabTransformer模型并将其部署到一个SM端点。一旦我们完成了这些，我们就可以用维持测试集来测试模型的性能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/423485df33d98d58eed8f27518b2fa29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XPPdA8nqregU43dWid3C7w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="55d5" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">数据</h1><p id="bf66" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">我们将使用的数据集是来自UCI机器学习网站的<a class="ae mn" href="https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)" rel="noopener ugc nofollow" target="_blank">德国信用数据集</a>。它通过<a class="ae mn" href="https://opendatacommons.org/licenses/dbcl/1-0/" rel="noopener ugc nofollow" target="_blank">数据库内容许可证(DbCL)1.0版</a>获得许可，明确授予商业使用的权利。</p><p id="ceda" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">数据集由1000条记录组成，包含20个特征和一个目标变量。每一个条目都代表一个获得荣誉的人。根据属性集，每个人被划分为好的或坏的信用风险(1 =好，2 =坏)。</p><p id="52c2" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">对于TabTransformer来说，这是一个特别好的数据集，因为它有几个分类特征，这是该算法的亮点。</p><h1 id="8b86" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">数据准备</h1><p id="f245" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">我们可以直接从网站上下载数据到熊猫的数据框架中，就像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="9ee6" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">如上所述，数据由20个属性和一个目标列组成。<a class="ae mn" href="https://docs.aws.amazon.com/sagemaker/latest/dg/tabtransformer.html#InputOutput-TabTransformer" rel="noopener ugc nofollow" target="_blank">文档</a>描述了我们必须如何准备数据。首先，目标变量需要是数据集中的第一列。接下来，我们要改变目标变量，使我们有0和1，而不是1和2。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="9f59" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">然后，我们希望将数据分为训练、验证和测试数据集。训练和验证数据将用于训练模型，而测试集将用于在训练完成后评估模型性能。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="3722" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">最后，我们需要在S3桶中指定文件夹，以便算法可以访问数据。文件夹中的最终结构应该如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/11d0ba4fa806dd2cc80ea49dd016a886.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*f8WLFXHEiqJitqVCBFHPmA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="bad9" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">我们可以这样实现:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="b5d6" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">模特培训</h1><p id="1e49" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">一旦我们准备好并上传了数据，我们就完成了大部分的前期工作。我们现在已经建立了能够运行算法的结构。事实上，我们可以从<a class="ae mn" href="https://docs.amazonaws.cn/en_us/sagemaker/latest/dg/tabtransformer.html#tabtransformer-modes" rel="noopener ugc nofollow" target="_blank">文档</a>中复制/粘贴代码。我们所需要做的就是调整路径，我们准备好了。</p><p id="9796" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">需要注意的一点是，我们可以提取算法的hyper参数的默认值，然后使用这些默认的<a class="ae mn" href="https://gist.github.com/bc1b72c459232be4fa29544b3a322c65" rel="noopener ugc nofollow" target="_blank">值</a>运行训练作业，或者像这样更改它们:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="1aa9" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">一旦我们开始了培训工作，我们就可以检查它的状态，并在培训完成后进行部署:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="a34f" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">测试模型</h1><p id="8f20" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">一旦我们部署了模型，我们就可以通过使用数据准备步骤中的维持测试数据集来测试它的性能。我们需要做的只是在将数据提交给端点之前序列化数据，并解析响应以获得预测的标签:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="615c" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">然后，我们将这些预测与实际标签进行比较，并检查常用指标:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/3e91e3230faeec29dfc8d538458075a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*cpeOA9gKy33-_bjdmTFqsQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="729e" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">这些结果是有希望的，不同的超参数值可能会进一步改进模型。</p><h1 id="4013" class="kz la iq bd lb lc ld le lf lg lh li lj jw lk jx ll jz lm ka ln kc lo kd lp lq bi translated">结论</h1><p id="54ed" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz ma mb mc md me mf mg mh mi mj mk ml mm ij bi translated">在本教程中，我们对自己的数据使用了TabTransformer算法。我们已经准备了数据，根据我们的数据训练了算法，并在我们的AWS帐户中部署和测试了模型。</p><p id="babb" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">接下来我们可以:</p><ul class=""><li id="444e" class="my mz iq lt b lu mo lx mp ma na me nb mi nc mm nd ne nf ng bi translated">将TabTransformer算法的结果与传统的非深度学习算法(如XGBoost)进行比较。</li><li id="22a9" class="my mz iq lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">查看TabTransformer在具有大量缺失数据的数据集上表现更好的能力，因为从TabTransformer学习到的上下文嵌入对于缺失和有噪声的数据特征都非常健壮，并且提供了更好的可解释性。</li><li id="800d" class="my mz iq lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">检查TabTransformer使用未标记数据训练模型的能力，因为这些模型在从未标记数据中提取有用信息以帮助监督训练方面很有前途，并且在未标记数据的大小很大时特别有用。</li></ul><p id="f412" class="pw-post-body-paragraph lr ls iq lt b lu mo jr lw lx mp ju lz ma mq mc md me mr mg mh mi ms mk ml mm ij bi translated">我希望这个教程是有用的，如果你有任何意见或问题，请随时联系我。</p></div></div>    
</body>
</html>