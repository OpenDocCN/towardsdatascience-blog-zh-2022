<html>
<head>
<title>How To Remove Punctuation From Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何删除熊猫的标点符号</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/remove-punctuation-pandas-3e461efe9584#2022-04-12">https://towardsdatascience.com/remove-punctuation-pandas-3e461efe9584#2022-04-12</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="4e6b" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">展示了从pandas DataFrame列中消除标点符号的不同方法</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/a62bf94ab9980bfeedce5ad9042536ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0iC83tkRiYOx2YxI0dgfeg.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@albrb?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">亚历杭德罗·巴尔巴</a>在<a class="ae kz" href="https://unsplash.com/s/photos/dot?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="eb49" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当处理文本数据时，我们有时可能需要执行一些清理转换。其中之一通常是在标记化之前删除标点符号。</p><p id="8723" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的文章中，我们将展示几种不同的方法来删除pandas数据帧中字符串列的标点符号。更具体地说，我们将使用</p><ul class=""><li id="b9d7" class="mu mv iu ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated"><code class="fe nd ne nf ng b">str.replace()</code></li><li id="b1e5" class="mu mv iu ly b lz nh mc ni lj nj ln nk lr nl mo mz na nb nc bi translated"><code class="fe nd ne nf ng b">regex.sub()</code></li><li id="e190" class="mu mv iu ly b lz nh mc ni lj nj ln nk lr nl mo mz na nb nc bi translated">还有<code class="fe nd ne nf ng b">str.translate()</code></li></ul></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="2148" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们创建一个示例数据框架，我们将在本文中引用它来演示一些概念。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="01ce" class="la lb iu ng b gz nx ny l nz oa">import pandas as pd<br/></span><span id="a6dc" class="la lb iu ng b gz ob ny l nz oa">df = pd.DataFrame(<br/>    [<br/>        (1, 10, True, 'Hello!!!'),<br/>        (2, 15, False, 'Hey..'),<br/>        (3, 11, True, 'What?!'),<br/>        (4, 12, True, 'Exactly!'),<br/>        (5, 17, True, 'Not bad'),<br/>        (6, 10, False, 'Yeap.!'),<br/>        (7, 12, False, 'Hi. How are you?'),<br/>        (8, 19, True, 'Nope,'),<br/>    ],<br/>    columns=['colA', 'colB', 'colC', 'colD']<br/>)</span><span id="14db" class="la lb iu ng b gz ob ny l nz oa">print(df)<br/><strong class="ng iv"><em class="oc">   colA  colB   colC              colD<br/></em></strong><em class="oc">0     1    10   True          Hello!!!<br/>1     2    15  False             Hey..<br/>2     3    11   True            What?!<br/>3     4    12   True          Exactly!<br/>4     5    17   True           Not bad<br/>5     6    10  False            Yeap.!<br/>6     7    12  False  Hi. How are you?<br/>7     8    19   True             Nope,</em></span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="b3fe" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用str.replace()和正则表达式</h2><p id="1750" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">这里的第一个选项是<code class="fe nd ne nf ng b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.replace.html" rel="noopener ugc nofollow" target="_blank">pandas.Series.str.replace()</a></code>方法，它可以用来替换Series对象中出现的所有正则表达式。</p><p id="78e1" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">所以对我们有用的一个正则表达式是<code class="fe nd ne nf ng b">[^\w\s]+</code>。为了理解这个正则表达式是如何工作的，考虑这样一个事实，即任何标点符号实际上都不是单词或句子。所以我们用否定(即<code class="fe nd ne nf ng b">^</code>)来表示我们要用空字符串替换任何非词非句(即标点符号)。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="a000" class="la lb iu ng b gz nx ny l nz oa">df['colD'] = df['colD'].str.replace(r'[^\w\s]+', '')</span><span id="4e67" class="la lb iu ng b gz ob ny l nz oa">print(df)<br/><strong class="ng iv"><em class="oc">   colA  colB   colC            colD<br/></em></strong><em class="oc">0     1    10   True           Hello<br/>1     2    15  False             Hey<br/>2     3    11   True            What<br/>3     4    12   True         Exactly<br/>4     5    17   True         Not bad<br/>5     6    10  False            Yeap<br/>6     7    12  False  Hi How are you<br/>7     8    19   True            Nope</em></span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="be6a" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用re.sub()方法</h2><p id="edf0" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在另一个选择是<code class="fe nd ne nf ng b">re</code>包中的<code class="fe nd ne nf ng b">sub()</code>方法，它提供正则表达式匹配操作。</p><blockquote class="od oe of"><p id="c493" class="lw lx oc ly b lz mp jv mb mc mq jy me og mr mg mh oh ms mj mk oi mt mm mn mo in bi translated"><code class="fe nd ne nf ng b"><a class="ae kz" href="https://docs.python.org/3/library/re.html#re.sub" rel="noopener ugc nofollow" target="_blank"><strong class="ly iv">re.sub(<em class="iu">pattern</em>, <em class="iu">repl</em>, <em class="iu">string</em>, <em class="iu">count=0</em>, <em class="iu">flags=0</em>)</strong></a></code></p><p id="15d5" class="lw lx oc ly b lz mp jv mb mc mq jy me og mr mg mh oh ms mj mk oi mt mm mn mo in bi translated">返回用替换<code class="fe nd ne nf ng b"><em class="iu">repl</em></code> <em class="iu">替换<code class="fe nd ne nf ng b"><em class="iu">string</em></code>中<code class="fe nd ne nf ng b"><em class="iu">pattern</em></code>最左边不重叠出现的<code class="fe nd ne nf ng b">string</code>。</em></p></blockquote><p id="d900" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">我们将使用与上一节中相同的正则表达式。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="1e73" class="la lb iu ng b gz nx ny l nz oa">import re</span><span id="281b" class="la lb iu ng b gz ob ny l nz oa">df['colD']=[re.sub('[^\w\s]+', '', s) for s in df['colD'].tolist()]</span><span id="70ea" class="la lb iu ng b gz ob ny l nz oa"><br/>print(df)<br/><strong class="ng iv"><em class="oc">   colA  colB   colC            colD<br/></em></strong><em class="oc">0     1    10   True           Hello<br/>1     2    15  False             Hey<br/>2     3    11   True            What<br/>3     4    12   True         Exactly<br/>4     5    17   True         Not bad<br/>5     6    10  False            Yeap<br/>6     7    12  False  Hi How are you<br/>7     8    19   True            Nope</em></span></pre><p id="1d77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">还要注意，有时在替换之前先<strong class="ly iv">编译正则表达式可能更有效。举个例子，</strong></p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="e649" class="la lb iu ng b gz nx ny l nz oa">import re<br/></span><span id="9f69" class="la lb iu ng b gz ob ny l nz oa">r = re.compile(r'[^\w\s]+')<br/>df['colD'] = [r.sub('', s) for s in df['colD'].tolist()]</span></pre></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="1a28" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用str.translate()方法</h2><p id="2f48" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">最后，另一种方法是使用<code class="fe nd ne nf ng b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.translate.html" rel="noopener ugc nofollow" target="_blank">pandas.Series.str.translate()</a></code>方法，通过给定的映射表映射输入字符串中的所有字符。</p><p id="6fc8" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">我们方法背后的直觉是将每行上的所有字符串组合在一起，形成一个大字符串，其中每个单独的字符串将由我们选择的分隔符分隔。</p><p id="c8d3" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">对于我们的例子，我们将使用<code class="fe nd ne nf ng b">|</code>字符作为分隔符。因此，我们首先需要创建一个字符串，其中包含我们希望从字符串中删除的标点符号。请注意，此处不得包含分隔符。显然，选定的分隔符不能出现在任何现有的字符串中，否则这种方法将不起作用。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="dcac" class="la lb iu ng b gz nx ny l nz oa">sep = '|'<br/>punctuation_chars = '!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\\]^_`{}~'</span></pre><p id="2e9d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在我们需要使用<code class="fe nd ne nf ng b">str.maketrans()</code>方法来创建一个可用于<code class="fe nd ne nf ng b">translate()</code>方法的翻译映射表。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="df39" class="la lb iu ng b gz nx ny l nz oa">mapping_table = str.maketrans(dict.fromkeys(punctuation_chars, ''))</span></pre><p id="2831" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在我们需要做的是使用选定的分隔符<code class="fe nd ne nf ng b">sep</code>连接<code class="fe nd ne nf ng b">colD</code>列中的所有字符串。然后使用我们创建的映射表执行<code class="fe nd ne nf ng b">str.translate()</code>,以删除<code class="fe nd ne nf ng b">punctuation_chars</code>中指定的标点字符，最后<code class="fe nd ne nf ng b">split()</code>删除分隔符<code class="fe nd ne nf ng b">sep</code>上的结果字符串，并将结果赋回列。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="c642" class="la lb iu ng b gz nx ny l nz oa">df['colD'] = sep \<br/>    .join(df['colD'].tolist()) \<br/>    .translate(mapping_table) \<br/>    .split(sep)</span></pre><p id="af5a" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">并且目标列应该没有任何标点字符。</p><pre class="kk kl km kn gu nt ng nu nv aw nw bi"><span id="2ee7" class="la lb iu ng b gz nx ny l nz oa">print(df)<br/><strong class="ng iv"><em class="oc">   colA  colB   colC            colD<br/></em></strong><em class="oc">0     1    10   True           Hello<br/>1     2    15  False             Hey<br/>2     3    11   True            What<br/>3     4    12   True         Exactly<br/>4     5    17   True         Not bad<br/>5     6    10  False            Yeap<br/>6     7    12  False  Hi How are you<br/>7     8    19   True            Nope</em></span></pre><p id="67a9" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">注意，这个方法是用C实现的，所以它<strong class="ly iv">应该是相当高效和快速的。</strong></p></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短教程中，我们探索了几种不同的方法，可以用来从pandas数据帧的字符串列中删除标点符号。</p><p id="be89" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">更具体地说，我们展示了如何做到这一点，使用了三种不同的方法— <code class="fe nd ne nf ng b">str.replace()</code>、<code class="fe nd ne nf ng b">str.translate()</code>和<code class="fe nd ne nf ng b">regex.sub()</code>。请注意，不同的方法在不同的数据集规模上可能会表现出明显不同的性能和效率。因此，选择最适合您的特定用例的最佳方式是将结果相互比较，并选择更合适的那个。</p></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="oj ok gq gs ol om"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd iv gz z fq or fs ft os fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa kt om"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">相关文章你可能也喜欢</strong></p><div class="oj ok gq gs ol om"><a rel="noopener follow" target="_blank" href="/how-to-merge-pandas-dataframes-221e49c41bec"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd iv gz z fq or fs ft os fv fx it bi translated">如何合并熊猫数据帧</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">对熊猫数据帧执行左、右、内和反连接</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa kt om"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu om"><a rel="noopener follow" target="_blank" href="/setuptools-python-571e7d5500f2"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd iv gz z fq or fs ft os fv fx it bi translated">Python中的setup.py与setup.cfg</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">使用setuptools管理依赖项和分发Python包</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pc l ox oy oz ov pa kt om"/></div></div></a></div></div><div class="ab cl nm nn hy no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu om"><a rel="noopener follow" target="_blank" href="/save-trained-models-python-22a11376d975"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd iv gz z fq or fs ft os fv fx it bi translated">如何用Python在磁盘上保存训练好的模型</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">用scikit探索模型持久性——在Python中学习</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pd l ox oy oz ov pa kt om"/></div></div></a></div></div></div>    
</body>
</html>