<html>
<head>
<title>Make Your R Code 10x Faster: Vectorization Explained in 3 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让您的R代码速度提高10倍:3分钟解释矢量化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/make-your-r-code-10x-faster-vectorization-explained-in-3-minutes-9eb4cdd7a49e#2022-08-12">https://towardsdatascience.com/make-your-r-code-10x-faster-vectorization-explained-in-3-minutes-9eb4cdd7a49e#2022-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/97ecf8d12b8305509af22ffae7000ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aI-rEZf8f97uILxF"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">矢量化后的代码。<a class="ae kf" href="https://unsplash.com/@natejohnston?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">利特·约翰斯顿</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="6da3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">r并不以快速编程语言著称。与C++等速度更快的同类产品相比，它充其量只能算是缓慢的。也就是说，如果您理解了整个语言背后的一个关键概念，您可以让R代码运行得更快。</p><p id="8a9a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个概念叫做<strong class="ki iu">矢量化</strong>，三分钟就能了解到。</p><p id="ad2f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在R中，向量是包含一个值或一组值的变量的基本类型。它们很常见。如果你曾经给一个变量名分配了一组数字，比如<code class="fe le lf lg lh b">x &lt;- 1:50</code>，那么你就创建了一个向量。您可以在vector中存储最常见的数据类型，包括doubles、integers、logicals、characters等等。</p><p id="de5d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">向量也可以有额外的属性。例如，向量中的每个值(或“元素”)都可以有一个名称。R like列表和数据帧中常见的数据结构也是由带有一些额外属性的向量组成的。</p><p id="a996" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为R是围绕向量构建的，所以它的许多运算会自动作用于向量中的所有元素。换句话说，它们是“矢量化”的。为了解释，这里有一个例子，当你创建一个整数向量，然后乘以2时会发生什么。</p><figure class="lj lk ll lm gt ju gh gi paragraph-image"><div class="gh gi li"><img src="../Images/04f135be983263590bc2c21e2cd94140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*BfHkE_h6v0HUZzrFjqHvNw.png"/></div></figure><p id="b454" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如上所述，乘法运算适用于向量的所有元素。更何况，这并不只是对运营商起作用。许多常见的函数都是矢量化的，这意味着它们以与上面的例子完全相同的方式跨矢量元素工作。例如，您知道粘贴函数是矢量化的吗？</p><figure class="lj lk ll lm gt ju"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="720b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这一点上，你可能想知道为什么R用户不简单地循环向量元素。这是大多数编程语言中的标准方法，那么为什么在R中不能这样做呢？这是省时的部分。</p><p id="8b20" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实是，您可以在R中使用循环，有时有很好的理由这样做。然而，因为R是围绕向量构建的，矢量化表达式的运行速度通常比循环快很多倍。根据您的代码，您通常可以看到矢量化带来10倍的速度提升。下面的例子比较了上面粘贴例子中两个代码块的运行时间。</p><figure class="lj lk ll lm gt ju"><div class="bz fp l di"><div class="ln lo l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">矢量化粘贴表达式与循环的执行时间比较。</p></figure><p id="e4ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这段代码的结果将在一定程度上取决于您机器的规格。在我的计算机上，循环运行平均需要180微秒，而矢量化表达式只需要18微秒；快十倍！就其本身而言，节省162微秒似乎不是什么大事。但是，当你运行这些相同的表达式成千上万次时，这会对你的总运行时间产生巨大的影响。</p><p id="de94" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了速度，矢量表达式还可以节省空间。<em class="lp"> For </em>循环通常很庞大，需要在循环前初始化变量。矢量化将这些冗长的代码块缩减为几行，甚至是上面例子中的一行。这样，你将拥有更快的代码，需要更少的时间和精力来通读；你不能输！</p><h1 id="69fb" class="lq lr it bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">向量化更进一步</h1><p id="6388" class="pw-post-body-paragraph kg kh it ki b kj mo kl km kn mp kp kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">虽然我已经简单介绍了向量化，但是对于高级R用户来说，深入研究这个概念是必须的。一旦你有了更多的经验，并且想学习更多关于R中的向量和其他数据类型，请阅读Hadley Wickham的“高级R”中的<a class="ae kf" href="https://adv-r.hadley.nz/vectors-chap.html" rel="noopener ugc nofollow" target="_blank">这一章</a>。</p><p id="f1c3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您是矢量化的新手，首先要做的就是尝试一下。查看您经常使用的函数，看看它们是否是矢量化的。在你的脚本中加入一些矢量化的操作。过一段时间，这将成为你的第二天性，你将能够用向量而不是循环来思考。试一试，享受你在这个过程中节省的时间。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="2cfa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想阅读我所有关于编程、数据科学等方面的文章吗？在<a class="ae kf" href="https://medium.com/@roryspanton/membership" rel="noopener">这个链接</a>注册一个媒体会员，就可以完全访问我所有的作品和媒体上的所有其他故事。这也直接帮助了我，因为我从你的会员费中得到一小部分，而不需要你额外付费。</p><p id="bc97" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你也可以通过<a class="ae kf" href="https://roryspanton.medium.com/subscribe" rel="noopener">订阅这里</a>让我的所有新文章直接发送到你的收件箱。感谢阅读！</p></div></div>    
</body>
</html>