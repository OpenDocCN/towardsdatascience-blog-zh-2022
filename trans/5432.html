<html>
<head>
<title>Google Cloud vs. Fly.io as Heroku Alternatives</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google Cloud vs. Fly.io 作为 Heroku 替代方案</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/google-cloud-vs-fly-io-as-heroku-alternatives-1f5a47716a58#2022-12-06">https://towardsdatascience.com/google-cloud-vs-fly-io-as-heroku-alternatives-1f5a47716a58#2022-12-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d0a5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">自由层 Docker 部署的比较</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f820a5ef34113dadad17bdb64f0d28ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o4OxN89GQr_jneAH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@poodar?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Poodar Chu </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="faec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着 Heroku 的免费层时代的结束，我正在努力寻找一个替代方案来托管我的 web 应用程序。我之前的一篇关于<a class="ae ky" href="https://kayjanwong.medium.com/heroku-docker-in-10-minutes-f4329c4fd72f" rel="noopener">使用 Heroku </a>部署 Docker 的文章肯定不太适合。</p><p id="bc08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于各种工作流，有许多 Heroku 替代方案，但在我的例子中，它是专门用于使用 Docker 映像部署 web 应用程序的。因此，我需要一个可以构建 docker 映像和托管 docker 容器的服务，谷歌云平台(GCP)和<a class="ae ky" href="https://fly.io/" rel="noopener ugc nofollow" target="_blank"> Fly.io </a>是很有前途的替代品。</p><p id="dffc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文简要解释了使用 GCP 和 Fly.io 的部署过程，并将对这两个平台的最终用户体验进行比较，重点是免费定制域名、易于部署、易于维护、价格差异、冷启动等。</p><p id="1b03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">诚然，我并不精通 docker 和特定于平台(GCP，Fly.io)的知识，我可能会指出有解决方案或变通办法的问题。欢迎在评论中分享你的专业知识！</p><h1 id="d44f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">目录</h1><ul class=""><li id="6da2" class="mn mo it lb b lc mp lf mq li mr lm ms lq mt lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#8d90" rel="noopener">使用谷歌云部署</a></li><li id="22e5" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#bfc7" rel="noopener">使用 Fly.io 部署</a></li><li id="c0c3" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#ce5a" rel="noopener">易于部署</a></li><li id="b3c2" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#b3a3" rel="noopener">易于维护(CICD) </a></li><li id="6c8a" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#7fbe" rel="noopener">免费自定义域名对比</a></li><li id="ea6c" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#c459" rel="noopener">计费对比</a></li><li id="f0f4" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#7fc3" rel="noopener">启动时间对比</a></li><li id="c9df" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/p/1f5a47716a58/#78ab" rel="noopener">环境变量和秘密比较</a></li></ul><p id="ac9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注:由于这是我的爱好项目，我关心的是尽可能降低成本，但不幸的是，它可能不会完全免费。我将详细说明什么是自由层功能和限制，以及如何根据部署设置产生成本。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="8d90" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">使用 Google 云部署</h1><p id="4973" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">要使用 Google Cloud Console 部署 Docker 工作流，这些是您将使用的主要服务及其用途，</p><ul class=""><li id="d777" class="mn mo it lb b lc ld lf lg li ns lm nt lq nu lu mu mv mw mx bi translated"><strong class="lb iu">云运行</strong>:指定构建设置，部署 Docker 容器</li><li id="d0be" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><strong class="lb iu">云构建</strong>:设置规则触发云运行，实现持续集成持续部署(CICD)</li><li id="905f" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><strong class="lb iu">容器注册或工件注册</strong>:存储容器图像，工件注册比容器注册贵 4 倍左右，功能稍微多一些(但可能不必要)</li><li id="c7e6" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">IAM &amp; Admin :管理项目权限</li></ul><p id="9592" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您的用例，您可能还需要其他服务，比如用于管理秘密的<strong class="lb iu">秘密管理器</strong>，这将在本文的最后一节详细介绍。</p><p id="665d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为本文旨在进行比较，所以我不会重点介绍 GCP 部署的分步指南。如果你有兴趣，我推荐这本关于 Google 云部署的<a class="ae ky" href="https://cloud.google.com/run/docs/deploying" rel="noopener ugc nofollow" target="_blank">指南</a>。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="bfc7" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">使用 Fly.io 部署</h1><p id="f0db" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">Fly.io 使用的是命令行实用程序<code class="fe nv nw nx ny b">flyctl</code>，大部分初始设置都是使用命令行完成的。设置中涉及的主要步骤是，</p><ol class=""><li id="7ce3" class="mn mo it lb b lc ld lf lg li ns lm nt lq nu lu nz mv mw mx bi translated"><strong class="lb iu">注册 Fly.io </strong>:安装<code class="fe nv nw nx ny b">flyctl</code>并注册 Fly.io</li><li id="5594" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nz mv mw mx bi translated"><strong class="lb iu">注册 Docker Hub(可选)</strong>:如果您正在本地运行 Docker 来测试您的应用程序(我强烈推荐这一点)，您将需要一个 Docker Hub 帐户来推送至 Docker 注册表，Fly.io 将从那里部署您的 Docker 映像。否则，将使用 Fly.io 的内部注册表。</li><li id="ac09" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nz mv mw mx bi translated"><strong class="lb iu">启动应用程序</strong>:这是为您的应用程序创建配置的一次性设置</li><li id="d228" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nz mv mw mx bi translated">部署应用程序:这是通过一行命令完成的！</li></ol><p id="8b7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设置文档可以在 Fly.io <a class="ae ky" href="https://fly.io/docs/hands-on/" rel="noopener ugc nofollow" target="_blank">动手教程</a>中找到。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="ce5a" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">易于部署</h1><blockquote class="oa ob oc"><p id="9833" class="kz la od lb b lc ld ju le lf lg jx lh oe lj lk ll of ln lo lp og lr ls lt lu im bi translated">获胜者:<strong class="lb iu"> Fly.io </strong>为了更大的透明度</p></blockquote><p id="0494" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在部署方面的一个巨大差异是，谷歌云控制台允许用户在连接网页的同时进行部署，而不是像 Fly.io 那样需要用户运行命令行操作。</p><p id="ab98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然使用网页更加用户友好，但我觉得在 Google Cloud 上部署有一个更陡峭的学习曲线，因为 Google 提供了所有的产品。这一点在谷歌服务的使用量(云运行、云构建等)中显而易见。).</p><p id="250f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就其服务而言，Fly.io 更加透明和直接，您不会因为您不知道自己正在使用的服务而被收费(在接下来的部分中会有更多介绍)！</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="b3a3" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">易于维护(CICD)</h1><blockquote class="oa ob oc"><p id="d40d" class="kz la od lb b lc ld ju le lf lg jx lh oe lj lk ll of ln lo lp og lr ls lt lu im bi translated">赢家:<strong class="lb iu">谷歌云</strong>如果你知道自己在做什么，否则可能会有令人震惊的代价</p></blockquote><p id="4d20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将维护分为三类，重新部署、扩展和处理旧版本。</p><h2 id="98bd" class="oh lw it bd lx oi oj dn mb ok ol dp mf li om on mh lm oo op mj lq oq or ml os bi translated">重新部署</h2><p id="4780" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">作为持续集成持续部署(CICD)最佳实践的一部分，Google Cloud 附带了<strong class="lb iu"> Cloud Build </strong>，它在存储库分支更新时触发云运行重新部署。如果您想要更改部署设置，例如 CPU 的数量，您还可以在<strong class="lb iu">云运行</strong>上手动重新触发部署。</p><p id="f3a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这在 Fly.io 中就不那么简单了，在 fly . io 中，重新触发必须使用命令行终端来完成。或者，您可以使用 Fly.io 设置<a class="ae ky" href="https://fly.io/docs/app-guides/continuous-deployment-with-github-actions/" rel="noopener ugc nofollow" target="_blank"> GitHub 动作，以便在存储库分支更新时重新部署，这与 Google Cloud 相比是一个额外的步骤，但仍然可以完成工作。</a></p><h2 id="2af6" class="oh lw it bd lx oi oj dn mb ok ol dp mf li om on mh lm oo op mj lq oq or ml os bi translated">缩放比例</h2><p id="4c46" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">云托管的一个重要方面是能够动态地扩展和缩减实例(CPU 和内存),并支持自动扩展(实例数量)。这两个平台都具有可伸缩性和自动伸缩性，但实现方式不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/a0a3d7bbe11787fb12891f6cdf88b899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*XX08LEqugR7NuEEKtn-faA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1:谷歌云上的自动缩放——作者图片</p></figure><p id="0554" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google Cloud 伸缩可以通过修改构建设置来推送新的版本，而自动伸缩则取决于实例的最大和最小数量(图 1)。所有这些改变都可以在谷歌云控制台上轻松完成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/ef1e6a2bd364de01aa11d04f1b94e4f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhuHZcn1fibRHNItwl3evQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:fly . io 上的缩放——作者图片</p></figure><p id="5335" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Fly.io 中，缩放是在 Fly 仪表板上完成的(图 2 ),新的修订会立即推送，而指定实例数量和启用自动缩放只能使用命令行来完成。我发现这很麻烦，因为我不能在旅途中改变我的实例数量，只能在安装了<code class="fe nv nw nx ny b">flyctl</code>的笔记本电脑上这样做。</p><h2 id="a858" class="oh lw it bd lx oi oj dn mb ok ol dp mf li om on mh lm oo op mj lq oq or ml os bi translated">处理旧版本</h2><p id="316d" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">在 Heroku 中，旧版本是可见的，用户可以很容易地回滚到以前的版本，这是我所欣赏的。回滚也可以在 Cloud Run 上的 Google Cloud Console 中完成，用户可以从容器注册表或工件注册表中指定容器映像 URL。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/356678152b7636ec4ca7163a2ce55aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*3F9Jq7mRF4L531WxYs98Pg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3:云存储的价格——作者图片</p></figure><p id="f953" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这让我想到了我的下一个观点，容器注册或工件注册存储了<strong class="lb iu">您以前的所有</strong>容器映像——而这种存储<strong class="lb iu">是有代价的</strong>。我想当然地认为它会像 Heroku 一样免费，直到我经历了人生中的震惊(图 3)。此外，谷歌云控制台没有任何允许用户自动删除旧版本的选项——这种删除必须手动完成<a class="ae ky" href="https://cloud.google.com/container-registry/docs/managing#deleting_images" rel="noopener ugc nofollow" target="_blank"/>。</p><blockquote class="ow"><p id="bdd1" class="ox oy it bd oz pa pb pc pd pe pf lu dk translated">如果您将容器映像存储在容器注册中心或工件注册中心，记得经常清除旧的构建！</p></blockquote><p id="e862" class="pw-post-body-paragraph kz la it lb b lc pg ju le lf ph jx lh li pi lk ll lm pj lo lp lq pk ls lt lu im bi translated">在 Fly.io 中，旧的构建被丢弃，只有现有的构建可以在 Fly 仪表板上查看。这意味着无法进行回滚。</p><p id="a629" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，我发现在谷歌云上维护我的网络应用程序更容易——只要你知道你在做什么。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="7fbe" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">免费自定义域名比较</h1><blockquote class="oa ob oc"><p id="6207" class="kz la od lb b lc ld ju le lf lg jx lh oe lj lk ll of ln lo lp og lr ls lt lu im bi translated">胜利者:<strong class="lb iu"> Fly.io </strong>手放下</p></blockquote><p id="e56f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如本文开头提到的，我保持低成本，我没有自己定制域名，依赖于平台提供商提供的免费定制域名。</p><p id="f86c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google Cloud 的默认域名格式是<code class="fe nv nw nx ny b">&lt;app-name&gt;-&lt;random-string&gt;.a.run.app</code>,坦率地说，这种格式不容易记住，看起来不太好，也不像 URL。比如我的 web 应用有<a class="ae ky" href="https://kayjan-634i2gf6lq-as.a.run.app" rel="noopener ugc nofollow" target="_blank"> <em class="od">的链接 Kay Jan-634 I2 gf 6 LQ-as . a . run . app</em></a>(这个链接可能无效)。</p><p id="d7a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Fly.io 有一个更友好、更酷、更容易记住的域名，格式为<code class="fe nv nw nx ny b">&lt;app-name&gt;.fly.dev</code>，我的 web 应用有链接<a class="ae ky" href="https://kayjan.fly.dev" rel="noopener ugc nofollow" target="_blank"> <em class="od"> kayjan.fly.dev </em> </a>。这是 Fly.io 的一大加分点！</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="c459" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">帐单比较</h1><blockquote class="oa ob oc"><p id="85d5" class="kz la od lb b lc ld ju le lf lg jx lh oe lj lk ll of ln lo lp og lr ls lt lu im bi translated">赢家:<strong class="lb iu"> Fly.io </strong>对最大成本的更多控制</p></blockquote><p id="5e31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与主要的云服务一样，谷歌云根据使用情况收费。对于低使用率，它可能是免费的，但对于高使用率，没有最大成本的保证，因为它会自动扩展您的应用程序。</p><p id="b0aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Fly.io 提供了对成本的更多控制，因为它基于设置(而不是使用)收费，并且免费层具有 3 倍 CPU 和 256MB 内存余量。升级设置将根据<a class="ae ky" href="https://fly.io/docs/about/pricing/" rel="noopener ugc nofollow" target="_blank"> Fly.io 定价指南</a>收取相应费用。除非启用自动缩放，否则如果超出资源，web 应用程序将没有响应，并且您还会收到一封关于崩溃的电子邮件。</p><p id="2f22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您更喜欢自动扩展以获得高可用性，Google Cloud 和 Fly.io 在将产生的最大成本方面提供了相同的不确定性。但是，如果您不关心高可用性，限制资源可能是控制成本的好方法。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="7fc3" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">启动时间比较</h1><blockquote class="oa ob oc"><p id="2df6" class="kz la od lb b lc ld ju le lf lg jx lh oe lj lk ll of ln lo lp og lr ls lt lu im bi translated">赢家:<strong class="lb iu"> Fly.io </strong>如果你想保持严格免费</p></blockquote><p id="1a76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了减少冷启动，我们可以在 Google Cloud Run 上将最小实例设置为 1。但是，我意识到资源正在被消耗，并且我不断地被收取使用费用(或缺少使用费用),所以我将最小实例设置为 0，以获得某种程度的“自由”层。我的 web 应用程序的冷启动需要大约 5-10 秒的时间来加载。</p><p id="7deb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，Fly.io 根据设置而不是使用情况收费，其免费层有 3 倍 CPU 和 256MB 内存。这意味着 Fly.io 服务始终可用，即使对于自由层也不会有<strong class="lb iu">冷启动</strong>！</p><h1 id="78ab" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">环境变量和机密比较</h1><blockquote class="oa ob oc"><p id="9423" class="kz la od lb b lc ld ju le lf lg jx lh oe lj lk ll of ln lo lp og lr ls lt lu im bi translated">获胜者:<strong class="lb iu">谷歌云</strong>用于秘密管理，但有成本</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/50bfd76d8f598bbbb48745e438733bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*QfJrdyTUMiTU-dOc8Srt3w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4:在云上设置环境变量和秘密——作者图片</p></figure><p id="7c5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我的 web 应用程序，我在代码中将 API 键设置为环境变量。谷歌云控制台允许我在<strong class="lb iu">云运行</strong>(图 4)中定义环境变量和秘密。一个警告是，这需要 Secrets Manager，另一个谷歌云服务，并且访问操作是收费的。Fly.io 还允许用户设置秘密，但不需要额外的费用。</p><p id="8ae3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果访问控制和安全性是您的应用程序最关心的问题，Google Cloud 有更严格和可定制的 IAM 策略。否则 Fly.io 实现 secrets 零成本就足够了。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><p id="e9cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望你对使用 Google Cloud 和 Fly.io 进行部署有了更好的理解，并从我代价高昂的错误中吸取了教训。由于我最近刚从 Heroku 换过来，考虑到我的网络应用程序使用和 GCP 与 Fly.io 的不同计费框架，我不确定从长远来看哪个平台更贵</p><p id="cf84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我确实偏爱 Fly.io，因为免费的自定义域名和快速的启动时间对我来说是巨大的决定因素。你选择虚拟主机服务的决定因素是什么？我很乐意听听你的想法！</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="42be" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">相关链接</h1><ul class=""><li id="2e5f" class="mn mo it lb b lc mp lf mq li mr lm ms lq mt lu mu mv mw mx bi translated">我的 web 应用(fly . io):<a class="ae ky" href="https://kayjan.fly.dev" rel="noopener ugc nofollow" target="_blank">https://Kay Jan . fly . dev</a></li></ul></div></div>    
</body>
</html>