<html>
<head>
<title>Better Compression of GIS Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更好地压缩GIS要素</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/2022-051-better-compression-of-gis-features-9f38a540bda5#2022-02-28">https://towardsdatascience.com/2022-051-better-compression-of-gis-features-9f38a540bda5#2022-02-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="7122" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">深潜</h2><div class=""/><div class=""><h2 id="dbf5" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">替换JSON、XML和Shapefile格式，以改善访问者的体验</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/dc139cc29f10b218de9c93fe38479a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KNknzduvVpxaiT47pnOAeA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">压缩大型数据集可能是获得和失去潜在用户的区别。(图片由约瑟夫·洪顿提供。)</p></figure><p id="9a0d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">使用在线地理信息系统(GIS)制图工具讲述数据密集型故事需要仔细规划。如果我们提供的数据太少，我们的故事就不会产生应有的影响。如果我们提供太多的数据，我们就有失去不耐烦的用户的风险，这些用户不愿意为下载大型GIS文件多等几秒钟。</p><p id="78a4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">因此，我们工作的一个重要部分是确保我们将GIS数据打包成尽可能紧凑的形式。</p><p id="96a9" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我一直在使用全球数据集，用地球的交互式正投影(T2)来讲述故事。以下是一些有用的策略，用于优化使用基于web的可视化工具访问大型GIS文件所需的时间。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="8ab1" class="mi mj iq bd mk ml mm dn mn mo mp dp mq ln mr ms mt lr mu mv mw lv mx my mz iw bi translated">基线案例</h2><p id="c3b4" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">作为案例研究，使用了世界的<a class="ae ma" href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/10m-admin-0-countries/" rel="noopener ugc nofollow" target="_blank">个国家的自然地球形状文件<code class="fe nf ng nh ni b">(ne_10m_admin_0_countries)</code>。以下是它包含的内容:</a></p><ul class=""><li id="d325" class="nj nk iq lg b lh li lk ll ln nl lr nm lv nn lz no np nq nr bi translated">258个表示国家及其外围区域轮廓的要素。</li><li id="d008" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">每个特征的161个属性:名称、人口、地图颜色等。</li><li id="b3d2" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">474，443个经度/纬度坐标对。</li><li id="5053" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">shapefile坐标的基线文件大小为8.39 MB，加上其dBase属性的794 KB。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2c54f8fd715cc75306e5949816cf550b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UPJRnLiB_iHPvIgmYzPEIg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">在10米分辨率的交互式世界正投影上显示世界上的国家。(图片由约瑟夫·洪顿提供。)</p></figure><p id="df0d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">作为一个案例研究，这是一个很好的优化候选。它太大了，不适合在HTTP连接上使用，尤其是与其他类似大小的数据集结合使用时。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="dcfb" class="mi mj iq bd mk ml mm dn mn mo mp dp mq ln mr ms mt lr mu mv mw lv mx my mz iw bi translated">GIS文件格式的比较</h2><p id="ffce" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated"><a class="ae ma" href="https://www.esri.com/content/dam/esrisites/sitecore-archive/Files/Pdfs/library/whitepapers/pdfs/shapefile.pdf" rel="noopener ugc nofollow" target="_blank"> ESRI shapefile </a>格式已经存在很长时间了，并且被每一个主要的GIS平台所支持。这对于希望分享作品的创作者来说非常有利。他们可以分发shapefiles，并保证以最少的努力获得尽可能多的受众。</p><p id="7d84" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">shapefile格式最初是在20世纪90年代开发的，当时GIS还只是一项地方性事务。当时没有人想到可以远程执行GIS，所以没有考虑优化文件传输时间。</p><p id="b32e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">随着Web 2.0运动的发展，在新千年开始时，XML编码标准成为了惯例。<a class="ae ma" href="https://www.ogc.org/standards/gml" rel="noopener ugc nofollow" target="_blank">地理标记语言</a> (GML)是一种XML文件格式，当时被认为是一种无所不包的交换格式。GML计划成为开发新一代网络地图应用的催化剂。</p><p id="9302" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">几年后，谷歌开始使用另一种XML文件格式——<a class="ae ma" href="https://developers.google.com/kml/documentation/kmlreference" rel="noopener ugc nofollow" target="_blank">Keyhole Markup Language</a>(KML)——用于其新生的Keyhole Earth浏览器(现在称为谷歌地球)。大型KML文件很冗长，所以实际上它们通常被压缩成KMZ文件。</p><p id="b196" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如今，JSON文件通常用于网站数据，而不是XML文件。这主要是因为如此多的语言方便地支持解析和序列化。geoJSON 格式顺应了这一趋势。尽管geoJSON文件很方便，但它几乎和XML文件一样冗长。</p><p id="e5da" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">geoJSON的替代方案是由Mike Bostock和Calvin Metcalf开发的topoJSON文件格式。它利用了共享公共边界的要素之间存在的拓扑冗余。这对于多边形数据(如世界各国)尤其有利。</p><p id="0344" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">另一个选择是<a class="ae ma" href="https://www.geopackage.org/spec/" rel="noopener ugc nofollow" target="_blank"> GeoPackage </a>格式，它不会占用太多空间。它由跨平台SQL数据库中的一组标准化表定义组成。这意味着不需要特殊的导出和导入代码。文件经过优化，可供提供商和用户直接使用。</p><p id="b97e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">以下是每种格式的文件大小比较:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/9cbaefb154bfa4f7e85546d809ed3360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ws1AzVPN2GE1xAVPZ0hl3A.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">XML和JSON文件的大小是原始ESRI shapefile的两倍。只有拉链KML更小。(使用QGIS生成的比较文件。)</p></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="2208" class="mi mj iq bd mk ml mm dn mn mo mp dp mq ln mr ms mt lr mu mv mw lv mx my mz iw bi translated">属性最小化</h2><p id="33aa" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">当从QGIS保存为geoJSON文件时，默认坐标设置为15位十进制数字，我们的案例研究文件膨胀到24.1 MB，是其初始大小的三倍！更好的坐标设置是6个十进制数字，这仍然可以在全球范围内提供1米的精度，但文件大小只会增加到14.8 MB。</p><p id="8e37" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">作为第一个优化——不管我们使用XML、JSON还是其他编码——我们可以删除所有无助于讲述我们故事的属性。对于这个案例研究，只保留了3个属性:<code class="fe nf ng nh ni b">NAME, MAPCOLOR7, POP_EST</code>。当其他158个属性被删除时，geoJSON文件大约减少1MB，变成13.9 MB。</p><p id="8fd4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">对于countries数据集，大部分文件都是由经度/纬度坐标消耗的，因此节省的空间并不大。但相比之下，另一个常用的数据集，世界城市地区<code class="fe nf ng nh ni b">(ne_10m_urban_areas)</code>包含11，878个要素。因此，对于该数据集，最小化每个要素的属性数量会导致更显著的减少。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="b3da" class="mi mj iq bd mk ml mm dn mn mo mp dp mq ln mr ms mt lr mu mv mw lv mx my mz iw bi translated">Web服务器压缩</h2><p id="bd27" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">将坐标精度降低到6位小数，并删除未使用的属性，这仅仅是个开始。考虑网络压缩技术的可用性也很重要。</p><p id="af94" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">Web服务器压缩几乎总是能够大幅减少通过网络传输的字节数。所有web服务器和浏览器都理解三种<code class="fe nf ng nh ni b">content-encoding</code>可能性:deflate、gzip和brotli。</p><p id="ceee" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">作为比较，以下是使用<code class="fe nf ng nh ni b">accept-encoding</code>请求头获取优化的13.9 MB geoJSON文件时，通过网络传输的实际字节数:</p><ul class=""><li id="34b7" class="nj nk iq lg b lh li lk ll ln nl lr nm lv nn lz no np nq nr bi translated"><code class="fe nf ng nh ni b">deflate</code> 4.59兆字节</li><li id="fa7c" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated"><code class="fe nf ng nh ni b">gzip</code> 4.59兆字节</li><li id="bc88" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated"><code class="fe nf ng nh ni b">brotli</code> 2.90 MB</li></ul><p id="9e83" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">相对较新的brotli方案在最小化传输的字节方面是明显的赢家。不利的一面是，brotli方案需要在服务器上花费额外的时间来执行其相当复杂的压缩，因此必须预先缓存并准备好提供，这样才能真正节省时间。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/a59c77bc047b2293fcf6ab4044adff69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mmY4_1SDHMQ4L5Zs8q25sg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">HTTP内容编码很容易获胜。请让您的DevOps工作人员进行设置。(显示的Web压缩统计数据来自<a class="ae ma" href="https://rwserve.readwritetools.com/" rel="noopener ugc nofollow" target="_blank"> RWSERVE HTTP/2服务器</a>。)</p></figure><p id="dede" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果您无法完成配置web服务器的任务，请让您的DevOps工作人员将这些设置添加到您的配置文件中:</p><pre class="kp kq kr ks gt nz ni oa ob aw oc bi"><span id="593f" class="mi mj iq ni b gy od oe l of og">content-types {<br/>        geojson     application/geojson<br/>        topojson    application/topojson<br/>    }<br/>    content-encoding {<br/>        application/geojson  br,gzip,deflate<br/>        application/topojson br,gzip,deflate<br/>    }<br/>    cache-control {<br/>        `*.geojson`   *instructions='public, max-age=86400'<br/>        `*.topojson`  *instructions='public, max-age=86400'<br/>    }</span></pre><p id="9507" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">另外，请记住在服务器和用户浏览器上都启用缓存。在服务器上缓存意味着将预压缩的数据集保存在一个可以立即访问的地方，而不必在每次请求时都重新压缩它。浏览器上的缓存意味着设置<code class="fe nf ng nh ni b">cache-control</code>响应头，这样用户就不必检索他们上次访问你的网站时保存的数据。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="0db7" class="mi mj iq bd mk ml mm dn mn mo mp dp mq ln mr ms mt lr mu mv mw lv mx my mz iw bi translated">三种新的GIS编码</h2><p id="63f4" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">JSON的便利已经变成了一根拐杖，我们经常会蹒跚而行，而不是昂首阔步。我们可以做得更好。</p><p id="70a3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">由于对当前的技术水平不满意，我对这个问题进行了深入的研究，并确定了几个改进的机会。</p><ul class=""><li id="5a4f" class="nj nk iq lg b lh li lk ll ln nl lr nm lv nn lz no np nq nr bi translated">JSON文件语法很多，逗号、引号、花括号和方括号遍布其中。</li><li id="7780" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">每个特征的属性名称都是重复的<em class="nx">。</em></li><li id="5666" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">两个相邻要素之间的边界共享一个公共坐标序列，一个沿顺时针方向，另一个沿逆时针方向。</li><li id="03ff" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">生成的格网上的经度和纬度由多个要素共享，这是一个明显的冗余，应该加以利用。</li><li id="0f72" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">文本文件存储数字效率低下，精度有限。</li><li id="9ea1" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">文本文件需要分隔符(空格或逗号)来分隔数据。</li></ul><p id="b96c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">接下来的三种文件编码是我对这些问题和机会的解决方案:</p><ol class=""><li id="c12a" class="nj nk iq lg b lh li lk ll ln nl lr nm lv nn lz oh np nq nr bi translated">地理要素编码(GFE)</li><li id="af73" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz oh np nq nr bi translated">索引坐标编码</li><li id="0d67" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz oh np nq nr bi translated">拓扑弧编码(TAE)</li></ol><p id="121f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">它们在GDAL的<code class="fe nf ng nh ni b">ogr2ogr</code>转换工具中还不可用；尽管如此，因为它们是用JavaScript编写的，所以使用<a class="ae ma" href="https://www.npmjs.com/package/gcsio" rel="noopener ugc nofollow" target="_blank"> gcsio </a>包的序列化器和解析器在浏览器和Node.js主机上都是可用的。</p><p id="10fd" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">地理要素编码(GFE) </strong></p><p id="1217" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">地理要素编码文件格式删除了所有额外的双引号、花括号、硬括号和逗号，它们在JSON文件中占据了大量空间。在内部，该文件仍然是纯文本，因此任何文件编辑器都可以用来显示其内容或进行微小的编辑。</p><p id="3ded" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">当打开查看时，GFE文件看起来有点像一个老派的制表符分隔的文件，但有了新的面貌。这里有一个展示文件自描述性质的例子。文件的其余部分包含经度、纬度和我们选择保留的三个属性值。</p><pre class="kp kq kr ks gt nz ni oa ob aw oc bi"><span id="b4d6" class="mi mj iq ni b gy od oe l of og">!gfe 1.0<br/>!dataset ne_10m_admin_0_countries<br/>!geometry Polygon<br/>!properties 5<br/>lngRings,latRings,NAME,MAPCOLOR7,POP_EST<br/>lngRings,latRings,string,string,string<br/>!features 258<br/>. . .</span></pre><p id="2acd" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">除了自描述的特性，GFE格式还能够在同一个文件中序列化和解析多个数据集。这对于顶点、边和面的规则模式共享公共坐标的情况尤其重要。</p><p id="a8bf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">索引坐标编码(ICE) </strong></p><p id="033c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">ICE格式更进一步，利用了具有重合折点的数据集。这是通过构建由多个要素共享的经度和纬度值的索引列表来实现的。</p><p id="41db" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">ICE文件看起来类似于GFE文件，但是增加了一个保存唯一经度和纬度值的部分。在这种方案中，单个要素将其坐标存储为短整数索引，而不是长浮点值。</p><p id="8620" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">拓扑弧编码(TAE) </strong></p><p id="3a6f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">一些面(如案例研究文件)具有很长的经度/纬度对序列，这些序列通常定义两个相邻要素之间的公共边界。如果这些序列可以被识别，那么它们可以被两个特征重复使用。</p><p id="7bc6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">TAE分析器能够识别两个要素共有的公共弧。有了这些信息，特征被重新加工成一系列圆弧参考，而不是一系列坐标对。圆弧参照是简单的整数值。</p><p id="1c6c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">TAE文件使用与前两种格式相同的通用自识别方案，并增加了一个拓扑弧部分。</p><p id="4c4b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><strong class="lg ja">二进制序列化</strong></p><p id="d6c1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">GFE、ICE和TAE文件都存在文本文件固有的低效问题。第一，数字占用空间太大。其次，相邻的属性仍然需要用某种类型的空格来分隔，这样解析器才能正常工作。</p><p id="4561" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">它们互补的<em class="nx">二进制</em>文件格式是:</p><ol class=""><li id="94f9" class="nj nk iq lg b lh li lk ll ln nl lr nm lv nn lz oh np nq nr bi translated">地理要素编码二进制(GFEBIN)</li><li id="e231" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz oh np nq nr bi translated">索引坐标编码二进制</li><li id="7afa" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz oh np nq nr bi translated">拓扑弧编码二进制(TAEBIN)</li></ol><p id="70cf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">对于二进制文件，浮点数没有这个问题。数字可以紧凑地存储在1字节、2字节或4字节序列中。对GIS文件特别重要的是，经度和纬度都可以存储为一个4字节的压缩数字。压缩浮点值具有足够的精度，可以以11厘米的精度定位地球上任何地方的对象。相比之下，具有同等精度的十进制经度值“-179.876543”在文本文件中将占据11个字节。</p><p id="7adb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">二进制文件不需要空白分隔符——制表符、换行符和逗号在二进制文件中不起作用。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h2 id="7f7a" class="mi mj iq bd mk ml mm dn mn mo mp dp mq ln mr ms mt lr mu mv mw lv mx my mz iw bi translated">选择最佳优化</h2><p id="2c2d" class="pw-post-body-paragraph le lf iq lg b lh na ka lj lk nb kd lm ln nc lp lq lr nd lt lu lv ne lx ly lz ij bi translated">考虑最佳优化时，应考虑几个正交因素:要素数量、每个要素的属性数量、每个要素的平均折点数、所需的坐标精度以及拓扑共享程度。</p><p id="41e3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">以下是一些有帮助的指导方针:</p><ul class=""><li id="96b4" class="nj nk iq lg b lh li lk ll ln nl lr nm lv nn lz no np nq nr bi translated">线和点数据集通常使用简单的GFE编码效果最佳。</li><li id="a302" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">当要素位于共享同一经度或纬度的规则格网上时，ICE编码将非常有用。</li><li id="f3e6" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">具有共享边界的多边形数据集可以利用拓扑，因此TAE是一个不错的选择。</li><li id="7b48" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">二进制编码的压缩效果总是比文本编码好，所以大多数情况下选择GFEBIN、ICEBIN或者TAEBIN。</li><li id="d7d3" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated">当人的可读性很重要时，退回到基于文本的GFE、ICE和TAE；例如，当调试数据集时，或者当预计要手动编辑要素时。</li></ul><p id="017c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">对于案例研究，结果文件大小为:</p><ul class=""><li id="7983" class="nj nk iq lg b lh li lk ll ln nl lr nm lv nn lz no np nq nr bi translated"><code class="fe nf ng nh ni b">ICE</code> 15.3 MB原始/ 3.2 MB brotli</li><li id="806e" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated"><code class="fe nf ng nh ni b">TAE</code> 13.6 MB原始/ 2.9 MB brotli</li><li id="a875" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated"><code class="fe nf ng nh ni b">GFE</code> 11.4 MB raw / 2.8 MB brotli</li><li id="07c1" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated"><code class="fe nf ng nh ni b">ICEBIN</code> 7.6 MB原始/ 2.8 MB brotli</li><li id="0664" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated"><code class="fe nf ng nh ni b">TAEBIN</code> 6.0 MB raw / 2.6 MB brotli</li><li id="fc6b" class="nj nk iq lg b lh ns lk nt ln nu lr nv lv nw lz no np nq nr bi translated"><code class="fe nf ng nh ni b">GFEBIN</code> 4.5 MB原始/ 2.2 MB brotli</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/0f6a589c4f9208023a4cf89d02bf9193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4xkfvpprs4iwKijRyzlP5g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">这三种新格式的二进制编码的大小是文本的一半，brotli压缩又将文件大小减少了一半。</p></figure><p id="6e47" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">不管文件格式如何，brotli网络压缩无疑是赢家。但是要小心，因为服务器端的压缩需要时间。请确保预先缓存压缩文件，以便可以毫不延迟地提供该文件。</p><p id="170e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">至于文件格式本身，“哪种格式把最多的数据挤进最小的空间”这个问题没有简单的答案。最好的工作流程是自动将源数据集转换为每种受支持的格式，然后比较它们的结果大小。当这不可能时，GFEBIN是最好的通用默认设置。</p></div></div>    
</body>
</html>