<html>
<head>
<title>Supercharged Pandas: Reading from and Writing to Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超级熊猫:从Excel中读取和写入</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3#2022-09-12">https://towardsdatascience.com/supercharged-pandas-reading-from-and-writing-to-excel-9379f39db4b3#2022-09-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="45af" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">增强。read_excel &amp;。to_excel方法，让您专注于数据探索</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7066d19fab51c0b8b17c5d21214bef86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVK8zrRzwDYJ_0ZR1gYllQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">读取和写入Excel(图片由作者提供)</p></figure><h1 id="b2b3" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">谁应该读这个？</h1><p id="9ae5" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">如果您已经使用python pandas库读取Excel文件，分析/转换数据，并将pandas数据帧写入Excel，那么我将要分享的内容可能会让您受益。您可能已经经历了以下一种或多种情况:</p><ul class=""><li id="c5db" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">使用<code class="fe mu mv mw mx b">pd.read_excel</code>，将数据作为数据帧读取，进行一些分析，然后意识到您使用了错误的工作表进行分析。(向您提出要求的人并没有指定您应该使用<code class="fe mu mv mw mx b">Sheet 1</code>而不是<code class="fe mu mv mw mx b">Sheet 2</code>。熊猫默认读取，不抛出任何警告。)</li><li id="c197" class="mj mk iq lp b lq my lt mz lw na ma nb me nc mi mq mr ms mt bi translated">运行一个函数进行数据分析，然后在最后一步，当您调用<code class="fe mu mv mw mx b">df.to_excel</code>方法时，您意识到您没有键入<code class="fe mu mv mw mx b">.xlsx</code>作为文件的扩展名，这导致了一个错误。你必须从头到尾重新运行整个脚本，浪费宝贵的时间。</li><li id="b434" class="mj mk iq lp b lq my lt mz lw na ma nb me nc mi mq mr ms mt bi translated">您更喜欢输出到Excel来创建图表或数据透视表，因为最终用户更喜欢在Excel中查看输出，但总是要双击才能打开Excel输出文件是一件痛苦的事情。(您希望有一种方法可以在Excel文件编写完成后自动打开它。)</li></ul><h1 id="795a" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">我为什么要写这个？</h1><p id="81bb" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我经历过上述情况，我理解这有多么令人沮丧。更重要的是，这些情况会打断一个人在解决问题时的思路。作为一名为项目从一家银行转到另一家银行的顾问，我完全具备消除这些干扰的工具是至关重要的。通过分享我如何改进了<code class="fe mu mv mw mx b">read_excel</code>和<code class="fe mu mv mw mx b">to_excel</code>方法，我希望你也能从中受益。如果你扩展并构建了这些方法，也请与我分享！:D</p><p id="4e27" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">完整的代码(pypo.py)可以在页面的最后找到，这里是<a class="ae ng" href="https://gist.github.com/jiweiliew/d82961006acf89b2cb0eefcc4544d68b" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="a5d0" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">增强型“<code class="fe mu mv mw mx b">read_excel</code>”方法</h1><p id="1268" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">增强型<code class="fe mu mv mw mx b">read_excel</code>方法有2个关键功能:</p><ol class=""><li id="3a40" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi nh mr ms mt bi translated">如果要读取的文件包含多个Excel工作表，它将打印每个工作表的名称以及每个工作表的行数和列数。人们可以通过输入<code class="fe mu mv mw mx b">inspect=True</code>作为关键字参数来开启这种行为。pythonista还会认识到，可以通过将<code class="fe mu mv mw mx b">kw.get('inspect', True)</code>中的第二个参数从<code class="fe mu mv mw mx b">True</code>调整为<code class="fe mu mv mw mx b">False</code>来配置默认行为。</li><li id="d1c9" class="mj mk iq lp b lq my lt mz lw na ma nb me nc mi nh mr ms mt bi translated">如果没有提供文件名，会出现一个<code class="fe mu mv mw mx b">tkinter</code>文件对话框，提示您选择一个Excel文件。这在数据浏览中非常有用，因为您可能更喜欢通过用户界面导航到文件，而不是键入文件的完整路径。</li></ol><p id="3857" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">要在现有脚本中包含这个函数，假设您有一个名为<code class="fe mu mv mw mx b">helloworld.py</code>的python脚本，只需将<code class="fe mu mv mw mx b">pypo.py</code>放在同一个文件夹中，然后添加<code class="fe mu mv mw mx b">import pypo</code>并将<code class="fe mu mv mw mx b">pd.read_excelp = pypo.read_excelp</code>包含在<code class="fe mu mv mw mx b">helloworld.py</code>中</p><h1 id="0f3c" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">增强型“<code class="fe mu mv mw mx b">to_excel</code>”方法</h1><p id="2668" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">数据分析师可能更喜欢将数据输出到Excel进行简单分析，或者准备一些报告和/或数据透视表/图表。在编写脚本的过程中，通常会经常执行脚本，然后打开Excel文件检查输出文件。这里有两个干扰因素:</p><ol class=""><li id="7a8a" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi nh mr ms mt bi translated">手动打开Excel需要双击Excel文件，或者按<code class="fe mu mv mw mx b">Alt + Tab</code>并按箭头键导航到该文件。</li></ol><blockquote class="ni nj nk"><p id="4e9f" class="ln lo nl lp b lq ml jr ls lt mm ju lv nm nd ly lz nn ne mc md no nf mg mh mi ij bi translated">如果文件能自动打开，这样我们就不需要在键盘和鼠标之间切换了，这不是很好吗？</p></blockquote><p id="4f67" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">2.您需要始终使用一个唯一的名称，否则如果它们共享相同的文件名，新的输出文件将会覆盖以前的文件。</p><blockquote class="ni nj nk"><p id="5e82" class="ln lo nl lp b lq ml jr ls lt mm ju lv nm nd ly lz nn ne mc md no nf mg mh mi ij bi translated">如果有一种优雅的方式来重命名文件，如果存在另一个同名的文件，这不是很好吗？</p></blockquote><p id="ce71" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">该函数将数据帧写入Excel并打开它。如果您提供的文件名已经存在于目标文件夹中，那么它会在文件名中添加一个时间字符串(“YYYYMMDD_HHMMSS”)。如果您输入的文件名不包含Excel扩展名，则默认情况下会添加<code class="fe mu mv mw mx b">.xlsx</code>。</p><p id="96d7" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">要将此功能包含到您现有的脚本中，只需<code class="fe mu mv mw mx b">import pypo</code>即可。最后一行代码，即<code class="fe mu mv mw mx b">PandasObject.to_excelp = to_excelp</code>将<code class="fe mu mv mw mx b">to_excelp</code>方法添加到所有pandas dataframe对象中</p><h1 id="7bd0" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">结论</h1><p id="f691" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">对原始pandas方法的这些改进是出于一种需要。在几家银行的多个项目中工作过之后，我创建了自己的脚本小工具箱来加速我的工作。</p><p id="2f16" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">如果你发现这个脚本已经或将要帮助你，请喜欢并分享我的文章，因为这将极大地鼓励我分享更多我工具箱里的东西。</p><p id="1e18" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">也请看看我的其他文章:</p><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/how-to-compare-2-dataframes-easily-b8f6788d5f07"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">如何轻松比较两个数据帧</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">…使用全面的数据协调脚本。</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kp ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/how-to-create-a-list-of-files-folders-and-subfolders-and-then-export-as-excel-6ce9eaa3867a"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">如何创建文件、文件夹和子文件夹的列表，然后导出为Excel</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">一个生产力工具玛丽近藤你的文件夹</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kp ns"/></div></div></a></div><h2 id="3b82" class="oi kw iq bd kx oj ok dn lb ol om dp lf lw on oo lh ma op oq lj me or os ll ot bi translated">警告</h2><p id="7f0f" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我只用Windows对于Mac用户来说，真的很抱歉，你将需要找到替代品或者相当于<code class="fe mu mv mw mx b">win32com.client</code>的东西。这里有一个堆栈溢出<a class="ae ng" href="https://stackoverflow.com/a/29629721/8350440" rel="noopener ugc nofollow" target="_blank">答案</a>，它可以为你指出正确的方向。</p><p id="2d24" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw nd ly lz ma ne mc md me nf mg mh mi ij bi translated">我不使用IDE我使用可靠的Notepad++和Powershell。对我来说，这是我被分配到的所有公司中最可靠、最稳定的。我不使用Juypter笔记本，我很确定<code class="fe mu mv mw mx b">tkinter</code>和/或<code class="fe mu mv mw mx b">win32com.client</code>在Juypter笔记本上不能很好地工作。</p><h1 id="932b" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">完整代码</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div></figure></div></div>    
</body>
</html>