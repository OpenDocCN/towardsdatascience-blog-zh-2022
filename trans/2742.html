<html>
<head>
<title>How to Add an Image to a Matplotlib Plot in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中将图像添加到Matplotlib绘图中</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-add-an-image-to-a-matplotlib-plot-in-python-76098becaf53#2022-06-14">https://towardsdatascience.com/how-to-add-an-image-to-a-matplotlib-plot-in-python-76098becaf53#2022-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="afd4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Matplotlib读取图像数据并将其添加到绘图中</h2></div><p id="713d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">向现有地块添加外部图像或图标不仅增加了美感，还从整体角度增加了其清晰度。外部图像可以是公司或产品的标志、国家的旗帜等。这些图像有助于巩固传达给读者的信息。<br/>Python中有不同的图像处理包。一些著名的包括OpenCV、imageio、scikit-image、Pillow、NumPy、SciPy和Matplotlib。Matplotlib是Python中最著名的数据分析和可视化包之一。在这篇文章中，我将分享使用Python中的Matplotlib读取图像、显示图像并将其添加到现有绘图中的步骤。事不宜迟，我们开始吧。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/261d4bc0438a3229cd8f9e7b355ec19c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TIc7MY_6CfETqcLtdT-zqw.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图片由<a class="ae lu" href="https://unsplash.com/@glenncarstenspeters" rel="noopener ugc nofollow" target="_blank">格伦·卡斯滕斯-彼得斯</a>在<a class="ae lu" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3be9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">数据</h1><p id="16b8" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">我从一个数据帧<code class="fe mz na nb nc b">df</code>开始，如下图所示。<code class="fe mz na nb nc b">df</code>包含2011年至2021年全球太阳能光伏(PV)装机容量。这一数据是从(IRENA，2021年)获得的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/f8a45ef371e9ad637a0942eef550c9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*ApBXmDXUTNzPGYKSymCcrA.png"/></div></figure><h1 id="6335" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">条形图</h1><p id="7c1f" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在这一步，我用<code class="fe mz na nb nc b">df</code>创建了一个规则的条形图。相同的代码在下面的代码块中。我删除了情节的图例，包括它的框架。我把右边和顶部的刺设置为不可见。此外，我在图中添加了网格线。</p><p id="6366" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用for循环遍历<code class="fe mz na nb nc b">df</code>的每一行，我使用<code class="fe mz na nb nc b">plt.text(x, y, s)</code>将顶部每一条的值相加，其中，</p><ul class=""><li id="32ca" class="nj nk it kk b kl km ko kp kr nl kv nm kz nn ld no np nq nr bi translated"><code class="fe mz na nb nc b">x</code>是年在X轴上的位置，从0到10(包括10)</li><li id="002d" class="nj nk it kk b kl ns ko nt kr nu kv nv kz nw ld no np nq nr bi translated"><code class="fe mz na nb nc b">y</code>和<code class="fe mz na nb nc b">s</code>均基于<code class="fe mz na nb nc b">df</code>的值，即全球太阳能光伏年装机容量，单位为千兆瓦。</li></ul><pre class="lf lg lh li gt nx nc ny nz aw oa bi"><span id="8296" class="ob md it nc b gy oc od l oe of">fig, ax = plt.subplots(figsize = (12, 8))</span><span id="e982" class="ob md it nc b gy og od l oe of">df.plot(kind = “bar”, ax = ax)</span><span id="f97e" class="ob md it nc b gy og od l oe of">plt.ylabel(“GW”)</span><span id="2fb7" class="ob md it nc b gy og od l oe of">#Remove legend along with the frame<br/>plt.legend([], frameon = False)</span><span id="61e1" class="ob md it nc b gy og od l oe of">plt.title(“Global Installed Capacity of Solar PV”)</span><span id="daf2" class="ob md it nc b gy og od l oe of"># Hide the right and top spines<br/>ax.spines.right.set_visible(False)<br/>ax.spines.top.set_visible(False)</span><span id="d107" class="ob md it nc b gy og od l oe of">#Set xticks rotation to 0<br/>plt.xticks(rotation = 0)</span><span id="59a2" class="ob md it nc b gy og od l oe of">#Add grid line<br/>plt.grid(axis = “y”)</span><span id="0c3a" class="ob md it nc b gy og od l oe of">#Adding value labels on top of bars<br/>for i in range(len(df)): <br/>     installed = df.iloc[i][0]<br/>     plt.text(x = i — 0.2,<br/>     y = installed + 5,<br/>     s = str(installed))</span><span id="e97a" class="ob md it nc b gy og od l oe of">#Add source<br/>plt.text(8, -100, “Source: IRENA, 2022”)</span><span id="ac42" class="ob md it nc b gy og od l oe of">plt.savefig(“../output/global solar pv trend.jpeg”,<br/> dpi = 300)<br/>plt.show()</span></pre><p id="449a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">结果，我得到了下面的图表，它展示了在过去十年里太阳能光伏在全球范围内的急剧增长。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oh"><img src="../Images/de87b15d34c5b3aa70448ce62c6424ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tXCP7833Pz0em70QKXJlEw.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">显示2011年至2021年全球太阳能光伏装机容量的柱状图。图片作者。</p></figure><h1 id="1787" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">阅读图像</h1><p id="4c95" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">可以使用Python中的不同包读取图像，如Matplotlib、OpenCV、ImageIO和PIL (GeeksforGeeks，2022)。在上面的图中，我想在顶部中心的某个地方添加一个太阳能电池板的图标。我用绘画软件手工绘制了一个太阳能电池板的标志。使用Matplotlib的<a class="ae lu" href="https://matplotlib.org/3.5.0/tutorials/introductory/images.html" rel="noopener ugc nofollow" target="_blank">图像</a>模块读取该图像，如下所示:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oi"><img src="../Images/2726d0187c028d7d961fa0f503a75f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WsfgwXLCZq7LrffVv64hEw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">读取包含太阳能电池板标识的图像文件。图片作者。</p></figure><p id="cc8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里，<code class="fe mz na nb nc b">logo</code>是形状(520，720，4)的3D NumPy数组。三维(3D)数组由3个嵌套层次的数组组成，每个维度一个(Adamsmith，2022)。</p><p id="36b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mz na nb nc b">logo</code>具有(M，N，4)的形状。520和720是指图像的行数和列数。4是指具有RGBA值(0–1浮点或0–255整数，包括透明度)的图像，即红色、绿色、蓝色和Alpha的值(Matplotlib，2020)。</p><h1 id="db88" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">显示图像数据</h1><p id="8155" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">包含RGB(A)数据的<code class="fe mz na nb nc b">logo</code>可使用<code class="fe mz na nb nc b">plt.imshow(logo)</code>在2D常规光栅上显示为图像。根据<code class="fe mz na nb nc b">logo</code>的形状，该图在X轴和Y轴上分别以720和520为界限，如下图所示:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oj"><img src="../Images/71effa1af79bf1b4c01fe4695c01b5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzu4axTTlj5da1BHNn38vQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">使用Matplotlib显示图像数据。图片作者。</p></figure><h1 id="54a8" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">将图像添加到Matplotlib图</h1><p id="d36f" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">为了将<code class="fe mz na nb nc b">logo</code>图像添加到条形图中，我创建了一个OffsetBox(一个简单的容器艺术家),并在其中传递了<code class="fe mz na nb nc b">logo</code>。缩放设置为0.15，即图像原始尺寸的15%。这个OffsetBox被命名为imagebox，因为它包含图像。</p><p id="7561" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我创建了一个AnnotationBbox，它是imagebox的容器。我在图(5700)的顶部中心为它指定了一个<code class="fe mz na nb nc b">xy</code>位置，并隐藏了框架。这在下面的代码中表示，该代码与条形图的代码块一起使用:</p><pre class="lf lg lh li gt nx nc ny nz aw oa bi"><span id="fcc7" class="ob md it nc b gy oc od l oe of">from matplotlib.offsetbox import (OffsetImage, AnnotationBbox)</span><span id="40bd" class="ob md it nc b gy og od l oe of">#The OffsetBox is a simple container artist.<br/>#The child artists are meant to be drawn at a relative position to its #parent.<br/>imagebox = OffsetImage(logo, zoom = 0.15)</span><span id="75a0" class="ob md it nc b gy og od l oe of">#Annotation box for solar pv logo<br/>#Container for the imagebox referring to a specific position *xy*.<br/>ab = AnnotationBbox(imagebox, (5, 700), frameon = False)<br/>ax.add_artist(ab)</span></pre><p id="30b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我可以将太阳能电池板的徽标与显示全球太阳能光伏趋势的条形图一起添加。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oh"><img src="../Images/4c830c4b540861cd1b8de7e32115dd95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQDxCEHy-BiPlIBwcKCIuw.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">在条形图上添加太阳能电池板的标志。图片作者。</p></figure><p id="f751" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我想在太阳能电池板周围加一个圈来突出它。条形图中的X轴和Y轴具有不同的刻度。X轴上的每个小刻度以1年为步长，而Y轴上的每个小刻度以100 GW为步长。因此，使用<code class="fe mz na nb nc b">plt.Circle((x,y),r)</code>和<code class="fe mz na nb nc b">ax.add_patch(circle)</code>添加一个<code class="fe mz na nb nc b">circle</code>会使其在图中显得不均匀。</p><p id="ac71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相反，我使用了一个散点图，其中心与AnnotationBbox的中心相同。我将半径<code class="fe mz na nb nc b">s</code>设置为20000，<code class="fe mz na nb nc b">marker</code>设置为“o”形，<code class="fe mz na nb nc b">color</code>设置为“红色”，<code class="fe mz na nb nc b">facecolors</code>设置为“无”，在太阳能电池板周围添加一个圆。</p><pre class="lf lg lh li gt nx nc ny nz aw oa bi"><span id="8ad2" class="ob md it nc b gy oc od l oe of">plt.scatter(5, 700, s = 20000, marker = “o”,<br/>            color = “red”, facecolors = “none”)</span></pre><p id="307c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">结果图如下所示。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oh"><img src="../Images/f4ee268ab2a9c6434c54b43c1ad97989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fWXFG3iZ7NEaEgtiO92TkA.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">在条形图上的太阳能电池板标志周围添加一个圆圈。图片作者。</p></figure><h1 id="3594" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">结论</h1><p id="bf4f" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">在现有地块上添加图像或图标可以增加视觉吸引力和感知度。在这篇文章中，我逐步描述了如何使用Matplotlib将外部图像读取为二进制格式的NumPy数组，以及如何显示图像数据并将其添加到条形图中。在这种情况下，我提供了一个简单的例子，在显示太阳能光伏装机容量全球趋势的条形图顶部添加一个太阳能电池板的徽标。这篇文章的笔记本可以在这个<a class="ae lu" href="https://github.com/hbshrestha/Data_Analytics" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到。感谢您的阅读！</p><h1 id="6c3d" class="mc md it bd me mf ne mh mi mj nf ml mm jz ng ka mo kc nh kd mq kf ni kg ms mt bi translated">参考</h1><p id="bb7a" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">亚当史密斯，2022。<a class="ae lu" href="https://www.adamsmith.haus/python/answers/how-to-create-a-3d-numpy-array-in-python" rel="noopener ugc nofollow" target="_blank">如何用Python创建3D NumPy数组</a></p><p id="9906" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">极客forGeeks，2022。<a class="ae lu" href="https://www.geeksforgeeks.org/reading-images-in-python/" rel="noopener ugc nofollow" target="_blank">用Python阅读图像。</a></p><p id="fb91" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">IRENA，2021。<a class="ae lu" href="https://www.irena.org/Statistics/View-Data-by-Topic/Capacity-and-Generation/Statistics-Time-Series" rel="noopener ugc nofollow" target="_blank">统计时间序列:可再生能源趋势。</a></p><p id="993e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Matplotlib，2020。<a class="ae lu" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.imshow.html" rel="noopener ugc nofollow" target="_blank">matplotlib . axes . axes . im show</a></p></div></div>    
</body>
</html>