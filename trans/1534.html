<html>
<head>
<title>Documenting Python code with Sphinx</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Sphinx记录Python代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/documenting-python-code-with-sphinx-554e1d6c4f6d#2022-04-14">https://towardsdatascience.com/documenting-python-code-with-sphinx-554e1d6c4f6d#2022-04-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/55a4f132cbf4cef3fee795dea928e862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2N7vp8G97_Dt_dDyi1uF4Q.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@patrickian4" rel="noopener ugc nofollow" target="_blank"> Patrik Fore </a>发自U<a class="ae kc" href="https://unsplash.com/photos/59lC6TgZAbQ" rel="noopener ugc nofollow" target="_blank">n spash</a></p></figure><p id="fe6b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当从事一个需要在特定时间框架内完成的项目时，除了代码审查、自动化测试、单元测试和许多其他事情，我们很少有时间留给文档。不管你在开发什么，迟早你和你的同事会再次访问那段代码。当这一天到来时，我们大多数人都将迷失在这些代码块中！</p><p id="8149" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于耗费时间，文档被省略了，但是如果所有这些都可以自动化，并且只需一瞥，您就可以生成一个漂亮的网站来记录您的全部代码，那会怎么样呢？这就是斯芬克斯的用武之地！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="74c5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="li">什么是斯芬克斯？</em> </strong></p><p id="c642" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，狮身人面像吸收了你的。rst文件并将其转换为HTML，所有这些都是通过一堆命令完成的！像<a class="ae kc" href="https://docs.djangoproject.com/en/4.0/" rel="noopener ugc nofollow" target="_blank"> Django </a>、<a class="ae kc" href="https://numpy.org/doc/stable/reference/" rel="noopener ugc nofollow" target="_blank"> NumPy </a>、<a class="ae kc" href="https://docs.scipy.org/doc/scipy/reference/" rel="noopener ugc nofollow" target="_blank"> SciPy </a>、<a class="ae kc" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn </a>、<a class="ae kc" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>等主要Python库都是用Sphinx编写的。现在，轮到我们使用它了，让我们开始吧。</p><p id="309b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="li">安装斯芬克斯:</em> </strong></p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="b858" class="ls lt iq lo b gy lu lv l lw lx">pip install sphinx sphinx_rtd_theme</span></pre><p id="e90d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将安装sphinx包和主题<em class="li">(可选)</em>，这将使我们的网站大放异彩。</p><p id="a942" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="li">文件夹结构:</em> </strong></p><p id="9da7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，你可以克隆我的<a class="ae kc" href="https://github.com/Raxy45/sphinx_basics" rel="noopener ugc nofollow" target="_blank"> Github库</a>，它的结构如下。在其中，数学存放了我们的python代码，这些代码需要进行文档化，我们的文档将放在docs文件夹中。</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="1eb1" class="ls lt iq lo b gy lu lv l lw lx">📦sphinx_basics<br/> ┣ 📂docs<br/> ┗ 📂maths<br/> ┃ ┣ 📜add.py<br/> ┃ ┣ 📜divide.py<br/> ┃ ┣ 📜multiply.py<br/> ┃ ┣ 📜subtract.py<br/> ┃ ┗ 📜__init__.py</span></pre><p id="d72d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一般来说，这是使用的惯例，你的代码将在一个源目录中(在我们的例子中是数学目录), docs将存放你的文档。既然你已经装好了。遵循以下给出的步骤:</p><p id="413f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="li">第一步:斯芬克斯-快速入门</em> </strong></p><p id="0e23" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在docs文件夹中运行下面的命令</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="79e2" class="ls lt iq lo b gy lu lv l lw lx">sphinx-quickstart</span></pre><p id="2857" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">运行该命令后，接受默认值。它看起来会像这样:</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/e348fe3443fa85d4609f0f6f2eaa269a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*zvnY0MJoigTKnJTFkV9-3w.gif"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">sphinx快速入门示例</p></figure><p id="4ab0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="li"> sphinx-quickstart </em>是一个交互式工具，它询问一些关于您的项目的问题，然后生成一个完整的文档目录和一个<code class="fe lz ma mb lo b">make.bat</code>文件，稍后将使用该文件生成HTML。</p><p id="0cbd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="li">第二步:编辑conf.py文件</em> </strong></p><p id="bc8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">转到您的<code class="fe lz ma mb lo b">conf.py</code>文件，取消第13、14和15行的注释。将<code class="fe lz ma mb lo b">os.path.abspath('.')</code>改为<code class="fe lz ma mb lo b">os.path.abspath('..')</code>。这里，我们告诉sphinx代码位于当前docs文件夹之外。</p><p id="87ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在转到扩展部分，添加下面给出的扩展</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/51fb766d56b74875fa8a622425e1c1b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WfQO6LG5PSkCKtB25z53Fg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">更新的扩展列表</p></figure><p id="cab7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，进入主题，将“雪花石膏”替换为“斯芬克斯rtd主题”，完整的更新后的<code class="fe lz ma mb lo b">conf.py</code>文件如下所示:</p><figure class="lj lk ll lm gt jr"><div class="bz fp l di"><div class="md me l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">最终conf.py文件</p></figure><p id="5bc2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="li">第三步:生成。rst文件</em> </strong></p><p id="5669" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，您的docs文件夹中有<code class="fe lz ma mb lo b">index.rst</code>，这将是您的文档的登录页。但是我们还没有生成<code class="fe lz ma mb lo b">maths.rst</code>，里面有我们的python代码。</p><p id="14e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">转到父文件夹sphinx_basics，运行命令:</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="6227" class="ls lt iq lo b gy lu lv l lw lx">sphinx-apidoc -o docs maths/</span></pre><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/ba514c38a092b92adf0ec8c1c692edc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zpMO2tl90uPWWZdidce6w.png"/></div></div></figure><p id="4ff6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个命令中，我们告诉sphinx从maths文件夹中获取我们的代码，并输出生成的。docs文件夹中的rst文件。在这个命令之后，您将看到在您的文档中生成的<code class="fe lz ma mb lo b">maths.rst</code>和<code class="fe lz ma mb lo b">modules.rst</code>。</p><p id="ff59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="li">第四步:包含module.rst并生成html </em> </strong></p><p id="d837" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，将生成的<code class="fe lz ma mb lo b">modules.rst</code>文件包含在您的<code class="fe lz ma mb lo b">index.rst</code>中</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/18884e3d108b29afbbb546a00e3ccb23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GMV9BhIFM9toidxJ4x9cZw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://gist.github.com/Raxy45/ea71369fa0345113534b2911ea667557" rel="noopener ugc nofollow" target="_blank"> index.rst </a>文件</p></figure><p id="a2eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们就可以生成漂亮的文档了，进入docs文件夹并运行命令</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="ae67" class="ls lt iq lo b gy lu lv l lw lx">make html</span></pre><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/e355624b88f8d5a4cc2114ae978eff10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zs4VFfaaODf7LPC2UDTPNQ.png"/></div></div></figure><p id="751f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样！！！。您可以在docs中的_build文件夹中看到生成的HTML文件，该HTML文件如下所示</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/5a3d3d24a685bb9bcd8dfed0dbd241b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nuYjMVxM1VN4wsqzLO4c4g.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">文档网站的登录页面</p></figure><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/6a097008cb4073121154cf25b867f1e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cc8ywLOUCOajfaq_HA9rNg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">数学包</p></figure><p id="85da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，除此之外，您还可以在搜索页面上搜索任何方法、子包等</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/b3199c4e880907509ea17fc88f4c7ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KiB15iOD6rhWk7L2hbSdMA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">搜索页面</p></figure><p id="74aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样！Sphinx完成了创建HTML文档的所有繁重工作。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="7ef5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，假设您对代码做了一些更改，现在您想重新构建HTML，请转到docs文件夹并编写</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="6746" class="ls lt iq lo b gy lu lv l lw lx">make clean html</span></pre><p id="f805" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后</p><pre class="lj lk ll lm gt ln lo lp lq aw lr bi"><span id="097d" class="ls lt iq lo b gy lu lv l lw lx">make html</span></pre><p id="99d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将重新构建您的HTMLs，同时考虑您的更改。</p><p id="4446" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有，你可以改变<a class="ae kc" href="https://sphinx-themes.org/#themes" rel="noopener ugc nofollow" target="_blank">主题</a>，尝试不同的；通过格式化文档字符串和更多的东西来改变文档格式！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="b309" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">耶！我们成功地自动化了催眠文档部分。希望这篇文章对你有所帮助，你可以随时记录下你的下一个项目🚀</p></div></div>    
</body>
</html>