<html>
<head>
<title>What Does Your Favorite Movie Look Like?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你最喜欢的电影是什么样子的？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-does-your-favorite-movie-look-like-8c7b4a13ee94#2022-07-17">https://towardsdatascience.com/what-does-your-favorite-movie-look-like-8c7b4a13ee94#2022-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c9fc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何将任何视频转换成反映其配色方案的图像</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3557d25461521fd2be1972fd255ec1ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vygDcrYdjTb3K8w1Y7Ni6Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">你最喜欢的电影是什么样子的？作者图片</p></figure><p id="0ef2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你有没有想过你最喜欢的电影是什么样子的？嗯，你肯定知道它看起来像什么，因为你很可能不止一次地看过它，但是它在静态下看起来如何，或者它如何使用单一图像可视化？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/c31150036c754e81df5776d8b7c49fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DK9inY-V-0BRAO-lHTqt3A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">怪物史莱克2电影的配色方案。作者图片</p></figure><p id="25fb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我提出了一种使用机器学习算法来创建反映任何视频配色方案的图像的方法。这不仅是一个有趣的项目，也是给你热爱电影的朋友和熟人的<strong class="la iu">无尽的礼物创意来源</strong>:首先，它是非常<em class="lu">个人和独特的</em>，其次，它是<em class="lu">高度可定制的</em>，因为你可以使用这个图像作为任何你可以订购打印的东西的打印:帽子、t恤、毛巾、帆布等。等。</p><h1 id="07e8" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">如何阅读这篇文章</h1><p id="51e4" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">为了方便起见，让我简要描述一下本文的所有主要部分，以便您知道从哪里开始，并在将来成功地导航:</p><ul class=""><li id="b0d6" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated">在<strong class="la iu">问题陈述</strong>部分，我会告诉你我要用这个项目解决什么问题；</li><li id="08f9" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">在<strong class="la iu">算法和实现细节</strong>部分，我将告诉你我是如何使用Python实现这个项目的，以及它的库:<a class="ae nh" href="https://zulko.github.io/moviepy/" rel="noopener ugc nofollow" target="_blank"> moviepy </a>和<a class="ae nh" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>。如果你不熟悉Python或一般的编程，不要害怕跳过这一节<em class="lu">，因为使用项目代码不需要你具备任何特定的知识；</em></li><li id="cf95" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">在<strong class="la iu">用户指南</strong>部分，你会找到最终程序的用户指南和带源代码的<a class="ae nh" href="https://gitlab.com/Winston-90/movie_color_scheme" rel="noopener ugc nofollow" target="_blank"> GitLab库的链接；</a></li><li id="5590" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">在<strong class="la iu">图库</strong>部分，您可以看到程序根据不同电影生成的结果图像。开始时看一下这里，看看这个程序能够做什么；</li><li id="81b5" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">在<strong class="la iu">结果和结论</strong>部分，我总结了已完成的工作，并分享了我对可能改进的想法。</li></ul><p id="77e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，当你知道以什么顺序阅读这篇文章时，让我们开始吧！</p><h1 id="b71f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">问题陈述</h1><p id="d0fb" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">我想写一个程序，将一些视频文件作为输入，输出一个图像，反映给定视频的配色方案。结果图像的一些特征也由附加参数设置。</p><p id="d627" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要查看程序能够生成的示例图像，请参见<strong class="la iu">图库</strong>部分。</p><h1 id="71bb" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">算法和实现细节</h1><p id="840b" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">让我们将初始问题分解成子问题，并一步一步地回顾算法:</p><ol class=""><li id="0549" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt ni mz na nb bi translated">首先，我们需要<strong class="la iu">将提议的视频转换成图像列表；</strong></li><li id="9b7c" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt ni mz na nb bi translated">对于给定列表中的每张图片，我们需要<strong class="la iu">通过分析图片提取最流行的颜色</strong>；</li><li id="00b4" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt ni mz na nb bi translated">最后，有了颜色列表，我们需要<strong class="la iu">合成最终的图像。</strong></li></ol><p id="7aac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们更详细地讨论这些步骤，并查看执行它们的代码。请注意<strong class="la iu">gists中的代码不要直接使用</strong>，这里只是给大家一个大概的概念。我试图保持它尽可能简单，同时存储库中的结果代码在某种程度上被优化并包装在类中。</p><h2 id="774f" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">1.将视频转换为图像列表</h2><p id="16ea" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">首先，我们需要将给定的视频转换成一组图像，以便将来进行分析。有了<a class="ae nh" href="https://zulko.github.io/moviepy/" rel="noopener ugc nofollow" target="_blank">电影库</a>就很容易了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7973" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们读取moviepy对象中的视频。使用<code class="fe nx ny nz oa b">duration</code>属性获取以秒为单位的视频持续时间，并设置<code class="fe nx ny nz oa b">step</code>变量以确定我们希望提取视频帧的频率，我们使用<em class="lu"> for循环</em>获取当前时间戳中的图像(使用<a class="ae nh" href="https://zulko.github.io/moviepy/ref/VideoClip/VideoClip.html#moviepy.video.VideoClip.VideoClip.get_frame" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> get_frame </em>函数</a>)并将其添加到结果列表中。</p><p id="520f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nx ny nz oa b">start</code>变量需要一点偏移，因为所有的视频在第0秒开始黑屏。</p><h2 id="0137" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">2.分析图像颜色</h2><p id="6f0e" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">当我们将一个视频“切片”成一系列图像时，我们需要分析其中哪些颜色是最流行的。让我简单地告诉你我们将如何做。</p><p id="624f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总体思路是对图像使用聚类算法。聚类是将相似的数据点分组到组(或聚类)中的任务。在我们的例子中，数据点是图像的像素，特征是三个RGB颜色值。</p><p id="f21e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在聚类算法为我们计算了聚类之后(这意味着它分析了所有图像像素并基于一种颜色创建了前k个像素组，其中k是聚类的数量)，我们可以使用这些聚类代表来获得最流行的颜色。最简单的方法是应用基于<em class="lu">质心</em>概念的聚类算法。聚类中的质心只是一个聚类的几何中心(可以解释为给定组中最常见的元素)。有几种基于质心的聚类算法；我选了<a class="ae nh" href="https://scikit-learn.org/stable/modules/clustering.html#k-means" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> K-Means </em> </a>(也可以是<a class="ae nh" href="https://scikit-learn.org/stable/modules/clustering.html#mean-shift" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> MeanShift </em> </a>、<a class="ae nh" href="https://scikit-learn.org/stable/modules/clustering.html#affinity-propagation" rel="noopener ugc nofollow" target="_blank"> <em class="lu">亲和传播</em> </a>等。):它迭代地更新聚类质心，直到收敛。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/d77f6fdc8e5d5e9a83a4b92b8a339cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/1*_HQTHY2_IO-PBTFYyEo1mw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">K-均值算法的收敛性。<a class="ae nh" href="https://en.wikipedia.org/wiki/K-means_clustering#/media/File:K-means_convergence.gif" rel="noopener ugc nofollow" target="_blank">公共领域</a></p></figure><h2 id="68eb" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">了解更多关于集群的资源</h2><p id="9d73" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">如果您想了解关于如何使用聚类从图像中提取颜色的更多详细信息，可以查看以下文章:</p><div class="oc od gp gr oe of"><a href="https://medium.com/analytics-vidhya/color-separation-in-an-image-using-kmeans-clustering-using-python-f994fa398454" rel="noopener follow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">使用Python使用KMeans聚类在图像中进行颜色分离</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">图像中的颜色分离是分离图像中的颜色的过程。这个过程是通过KMeans完成的…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">medium.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ks of"/></div></div></a></div><p id="a255" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想从总体上了解更多关于聚类算法的知识，请查看我的聚类备忘单文章，它将为您提供关于聚类算法动物园和聚类分析的总体情况:</p><div class="oc od gp gr oe of"><a rel="noopener follow" target="_blank" href="/clustering-cheat-sheet-dcf72259abb6"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">聚类备忘单</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">在11分钟内你应该知道的关于聚类的所有事情</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">towardsdatascience.com</p></div></div><div class="oo l"><div class="ou l oq or os oo ot ks of"/></div></div></a></div><h2 id="a72d" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">回到实践中</h2><p id="cc6d" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">但是让我们继续练习吧。让我们以下图为例进行颜色分析:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/6e53de3c18d44fbbfb60184c20da6641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RvjBsW2dFkxq2-OQKA04lA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯文·施密德在<a class="ae nh" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="4538" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用不同的k值通过聚类算法运行此图像，您将获得以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/398fb53d230a1937e9a0c2f18ca32c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RPAqpRqSXU3kL57fSg_7wA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">上图中3、5、10和20种最受欢迎的颜色。作者图片</p></figure><p id="1ca2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你所看到的，使用太少的颜色不能反映真实的画面，使用太多的颜色会使结果变得嘈杂。在我的实验中，我设置了5种颜色。</p><p id="a012" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看代码并讨论实现细节。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="b1d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们首先对给定的图像进行预处理:将其调整为较小的尺寸，以使算法运行得更快，并根据scikit-learn对象的期望将其重新整形为2D数组。然后，我们训练一个聚类算法，获得聚类质心的坐标，并根据流行度对结果颜色进行排序，将它们从RGB转换为十六进制以便于可视化。</p><p id="e123" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想更好地理解代码和每个变量的类型和形状，请看看<a class="ae nh" href="https://gitlab.com/Winston-90/movie_color_scheme/-/blob/main/video_color_scheme_demo.ipynb" rel="noopener ugc nofollow" target="_blank">这个交互式Jupyter笔记本</a>，里面有演示代码和更详细的注释。</p><h2 id="2e3d" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">3.合成生成的图像</h2><p id="30ec" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">现在问题仍然很小:有了一组颜色，我们只需要合成最终的图像。</p><p id="fc87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要做到这一点，我们需要一些简单的坐标计算，我已经在下面可视化了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/124bfd9ad422e30eb7e9b32667e4f0e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iKGESR3T2VGjNzxFkginrw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">坐标计算的可视化。作者图片</p></figure><p id="89b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们知道，在matplotlib约定中，图像左下角点的坐标为<em class="lu"> (0，0) </em>，右上角点的坐标为<em class="lu"> (w，h) </em>(如果图像的宽度等于<em class="lu"> w </em>，高度等于<em class="lu"> h </em>)。</p><p id="7e60" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要依次画出n个矩形，每次稍微向右移动。我将使用的Matplotlib Rectangle类使用三个参数绘制一个矩形:左下角的坐标、宽度和高度。</p><p id="890d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个矩形的宽度和高度是相同的:高度等于图像的高度，宽度是图像的宽度除以矩形的数量。左下点的坐标等于索引<em class="lu"> i </em>与图像宽度除以矩形数量的乘积。通过将<em class="lu"> i </em> = 0，1，2代入上述公式来确保这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="accc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，图像宽度和高度是以英寸为单位设置的，而不是以像素为单位。请参考<a class="ae nh" href="https://gitlab.com/Winston-90/movie_color_scheme/-/blob/main/video_color_scheme_demo.ipynb" rel="noopener ugc nofollow" target="_blank">带有演示代码的同一个Jupyter笔记本</a>进行交互可视化。</p><p id="0513" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了简单起见，在上面的例子中，我明确指定了一个颜色列表。事实上，对于每张图片，我都保存了所有的前k种颜色。有了这些信息，您可以根据分析结果创建不同的颜色选择方法。</p><p id="978b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我已经实现了由<code class="fe nx ny nz oa b">mode</code>参数选择的两个选项。如果<code class="fe nx ny nz oa b">mode="popular"</code>，我们就选择最流行的颜色。但是如果<code class="fe nx ny nz oa b">mode="sample"</code>，我们根据给定的分布采样颜色。因此，即使对于同一视频，您也可以获得不同的结果，使图像更加多样化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/c34c2e8baa8f740a61429413af03d889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pZhJoUJ4fDCtHtbMzOn9Mw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用<a class="ae nh" href="https://www.youtube.com/watch?v=mqqft2x_Aa4" rel="noopener ugc nofollow" target="_blank">蝙蝠侠预告片</a>中的一帧解释模式参数。作者图片</p></figure><h1 id="8763" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">用户指南</h1><p id="f5f9" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">让我们来谈谈如何使用这个程序。您可以在下面的资源库中找到代码:</p><div class="oc od gp gr oe of"><a href="https://gitlab.com/Winston-90/movie_color_scheme" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">dmytro Nikolai ev/movie _ color _ scheme git lab</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">GitLab.com</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">gitlab.com</p></div></div><div class="oo l"><div class="oz l oq or os oo ot ks of"/></div></div></a></div><p id="130e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在设置好环境并安装了所需的库之后，就可以像我们通常在Python脚本中所做的那样，通过设置参数来使用程序:<code class="fe nx ny nz oa b">python main.py --parameter1 value --parameter2 value</code>。让我们回顾一下程序参数。</p><h2 id="f34e" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">程序参数列表</h2><p id="0133" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">必需的参数:</p><ul class=""><li id="96af" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated"><code class="fe nx ny nz oa b">video_path</code>:要处理的视频文件的路径；</li><li id="63db" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">result_path</code>:保存结果图像的路径(包括。png)；</li><li id="2fc6" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">width</code>:结果图像的宽度，英寸。默认值:25；</li><li id="613c" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">height</code>:生成图像的高度，英寸。默认值:5。</li></ul><p id="7afa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不太重要的参数(您可以只使用默认值):</p><ul class=""><li id="b459" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated"><code class="fe nx ny nz oa b">mode</code>:选择颜色的模式。如果是‘流行的’——返回最流行的颜色，否则根据分布抽样颜色。默认值:“样本”；</li><li id="3382" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">start</code>:开始视频处理的时间(秒)。默认值:1；</li><li id="7712" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">step</code>:以秒为单位步进。默认值:1；</li><li id="80bf" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">number_of_colors</code>:从每幅图像中提取的颜色数(聚类数)。默认值:5；</li><li id="72d7" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">compress_to</code>:预处理过程中调整图像大小的像素数。默认值:200；</li><li id="d289" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">verbose</code>:如果为真，显示结果图像。默认值:False</li><li id="6b60" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><code class="fe nx ny nz oa b">delete_after</code>:如果为真，处理后删除临时文件。默认值:False。</li></ul><h2 id="00a6" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">保存中间结果</h2><p id="442e" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">我还需要提到一个可以节省您时间的实现细节。由于分析阶段需要很长时间，拒绝保存中间结果将不是一个好的解决方案。</p><p id="c79e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我保存了<em class="lu">图像数组</em>和<em class="lu">颜色数组</em>，以便您稍后可以重现实验。例如，如果您设置了<code class="fe nx ny nz oa b">mode="sample"</code>，但没有发现结果图像非常吸引人，您可以只运行最后一个阶段，提供保存的颜色数组文件的路径(注释掉<em class="lu"> main.py </em> ) <strong class="la iu">中相应的代码行)，而不需要从头开始运行整个分析</strong>。</p><p id="8571" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于<em class="lu">videoname.mp4</em>，这些文件将被命名为<em class="lu"> videoname_images.pkl </em>和<em class="lu"> videoname_colors.pkl </em>并保存在<code class="fe nx ny nz oa b">tmp</code>文件夹中。</p><h1 id="de3a" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">走廊</h1><p id="c3b7" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">在这个部分中，您可以找到基于不同电影的程序输出。所有提供的高分辨率图像你也可以在回购中找到。</p><p id="31f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我先分析一下我在文章开头给你看的《怪物史莱克2》的配色方案，以基本证明这种方法是可行的，并且能够引起真正的电影爱好者的兴趣。让我们放大来回顾前10分钟:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/b44b0f6c3abcd0ea1254876712669dda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4YWEfmYxJQTG_pi8EGiG4g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">《怪物史莱克2》前10分钟色彩分析。图片作者。</p></figure><p id="9c16" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里的步长参数等于它的默认值1，所以上图中的每个小矩形都是视频中的一秒。</p><p id="4ecd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">漫画以梦工厂的开场主题开始，一个孩子坐在月亮上扔鱼竿。这是发生在<em class="lu">浅蓝色</em> <em class="lu">背景</em>中的。黑色背景上的白色小标题写着梦工厂的礼物……然后就出现了。</p><p id="c77d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来是一个带有故事书的小故事和白马王子据称拯救了菲奥娜的时刻，之后是一个关于菲奥娜和史莱克的电影的真正的屏幕保护程序，顺便提一下，这里有许多关于各种文化作品的参考资料。之后，叙述实际上开始于沼泽，以适当的色调。</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><p id="dc3e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们继续看<em class="lu">指环王</em>。第二部电影的色彩设计和第三部电影明亮的结尾吸引了我的眼球。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/1bcb85e1e11e883a1f131389e22168a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pOLkWLSqmFveee1J-Gn-iw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">指环王-指环联盟。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/02e0af464b837bc299cd1ce3b9b49ebb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8C2NTulxiTuV3YXN6DJHA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">指环王-双塔。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/3e8ca21607b7687f027de749a8ff8ea4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hih4DSQZ7khaBU3tUWCl3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">指环王-王者归来。作者图片</p></figure><p id="da18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我也分析了所有的<em class="lu">哈利波特</em>电影。第三部电影的标题在这里最引人注目——它们很轻(以掠夺者地图为背景)。在最后一部电影中，哈利和邓布利多谈话的那个精彩瞬间也历历在目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/c000ac4d6721a4c906724514c577b2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-_uXUqFyR_u8B4wwSICeg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利波特与魔法石。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/dc6f52e4312e855d3d6cbedcb5d2b309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1q4hQB-gwmYNIEkOKE2BjA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利波特与密室。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/c8857931606dc0a61bd3f5a10d439129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cUkxhrsY6ajMehvxJiY-sg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利波特与阿兹卡班的囚徒。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0c06ed412c27a8c4d04b8e81cabb5717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqSCMZ7ToEYVt_1QDdYSyg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利波特与火焰杯。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/3e74e9c33cf0368412e2f15eecca6ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eZI9dSWNTM3Gw1M86BWi1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利波特与凤凰社。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/974b879804b8faf9e715e1368e768693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYT03nVpsZ3mHWT2wDctBw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利波特与混血王子。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/43fffa22dba99fa08fc3417127b72708.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yLk3n0J9EZBapyQ8aHt0yA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利·波特与死亡圣器(上)。作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/3795c6e74aada7bf697b0f16337e72ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBjYcxRwc_NlVvRbJUN9tw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哈利·波特与死亡圣器第二部。作者图片</p></figure><p id="52ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只要有一点想象力，你就可以根据这些图像创作出迷人的艺术作品。我不太擅长这个，但让我告诉你一个大概的想法。</p><p id="cfe8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由此可知:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/f699caad2bddf117e18f9a6d8fa800f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXaaGb4yqcbON5oZQHG6Ng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">搏击俱乐部，1999年。作者图片</p></figure><p id="a532" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对此:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/d4337946e74cf99bb2572a480f6d9fdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WxqgKNlMfG-GaLV_JSLtew.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">搏击俱乐部艺术图片:<a class="ae nh" href="https://commons.wikimedia.org/wiki/File:Fight_Club_logo1.png" rel="noopener ugc nofollow" target="_blank">公共领域</a>和照片由<a class="ae nh" href="https://www.pexels.com/photo/left-fist-635356/" rel="noopener ugc nofollow" target="_blank"> NEOSiAM 2021 </a></p></figure><h1 id="c534" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结果和结论</h1><p id="161c" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">最后，让我稍微讨论一下所做的工作。</p><h2 id="fc25" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">支持的视频格式</h2><p id="ba72" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">这个程序使用<a class="ae nh" href="https://zulko.github.io/moviepy/" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> moviepy </em>库</a>进行视频处理，所以支持FFmpeg支持的各种视频格式，像. mp4，.mpeg，。avi，。mov，。mkv等。参见此处的完整列表<a class="ae nh" href="https://en.wikipedia.org/wiki/FFmpeg#:~:text=of%20re%2Dencoding.-,Muxers,-%5Bedit%5D" rel="noopener ugc nofollow" target="_blank">(多路复用器部分)</a>。</p><p id="1bd8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有时我会遇到moviepy视频读取错误，将视频文件从一种格式转换为另一种格式通常会有所帮助。我用了一个免费的VLC视频播放器。</p><h2 id="eee1" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">执行时间</h2><p id="9152" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">正如我们上面讨论的，该程序包括三个主要阶段——从视频中提取图像，分析它们，并编辑最终图像。</p><p id="54ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个和最后一个阶段进行得相当快。图像的编辑几乎在瞬间发生，而视频到图像的转换通常不超过两分钟。</p><p id="d3da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是图像分析需要很多时间，通常情况下，它是<strong class="la iu">大约与视频的持续时间</strong>相同(对于1秒的步骤)。要缩短这一时间，您可以:</p><ul class=""><li id="2b50" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated">将<code class="fe nx ny nz oa b">step</code>参数设置为较大的值(例如2或3)。这将允许您在最终图像中使用较少的矩形获得不太精确的可视化效果，但会显著提高执行速度。</li><li id="6afa" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">将<code class="fe nx ny nz oa b">number_of_colors</code>或<code class="fe nx ny nz oa b">compress_to</code>参数设置为较小的值，尽管这样会产生较差的结果，不推荐使用。</li></ul><p id="e6b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于这个项目是业余的，只是为了兴趣和乐趣，它有许多缺点和未来工作的巨大领域。例如，聚类算法的优化实现和GPU的使用可以大大减少运行时间。</p><h2 id="f474" class="nj lx it bd ly nk nl dn mc nm nn dp mg lh no np mi ll nq nr mk lp ns nt mm nu bi translated">结论</h2><p id="8598" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">很久以前，我就有了这个项目的想法。很久都没找到时间实现，后来开始写代码，遇到错误和未知。当代码准备好的时候，我花了<em class="lu">20多个小时</em>来处理你在上面看到的流行电影。最后，我整理了一下思路，把它们转移到这篇文章上。</p><p id="6e17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然实现并非没有缺点(它可以工作得更快，并且我没有删除黑条，这在黑暗电影中可能是一个问题)，但我对结果非常满意。设定目标，并面临挫折，但最终实现你想要的是一个人能经历的最好的感觉之一。</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><h1 id="9a72" class="lw lx it bd ly lz pi mb mc md pj mf mg jz pk ka mi kc pl kd mk kf pm kg mm mn bi translated">感谢您的阅读！</h1><ul class=""><li id="4a40" class="mt mu it la b lb mo le mp lh pn ll po lp pp lt my mz na nb bi translated">我希望这些材料对你有用。<a class="ae nh" href="https://medium.com/@andimid" rel="noopener">在Medium </a>上关注我，获取更多类似的文章。</li><li id="8e86" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">如果您有任何问题或意见，我将很高兴得到任何反馈。在评论中问我，或者通过<a class="ae nh" href="https://www.linkedin.com/in/andimid/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae nh" href="https://twitter.com/dimid_ml" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我。</li><li id="bd58" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">为了支持我作为一名作家，并获得数以千计的其他媒体文章，使用<a class="ae nh" href="https://medium.com/@andimid/membership" rel="noopener">我的推荐链接</a>获得媒体会员资格(不收取额外费用)。</li></ul></div></div>    
</body>
</html>