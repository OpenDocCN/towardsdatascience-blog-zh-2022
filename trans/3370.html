<html>
<head>
<title>Views: An Underrated Alternative to Tables in SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">视图:SQL中被低估的表的替代品</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/views-an-underrated-alternative-to-tables-in-sql-26cd6d1d8660#2022-07-26">https://towardsdatascience.com/views-an-underrated-alternative-to-tables-in-sql-26cd6d1d8660#2022-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2a96" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">SQL用户将从早期养成使用视图的习惯中受益匪浅</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8db960444b192a4b981a4f5a3e7c252c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f04RDocsnYpmz6gx"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@pawelskor?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">保罗·斯科鲁普斯卡斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8b81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">视图通常被称为“虚拟表”，是许多SQL脚本中不可或缺的组件。</p><p id="d7d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管如此，大多数钻研SQL的资源很少关注视图，而是选择更重视更高级的查询概念，如连接和cte。</p><p id="922d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可能是因为视图在语法方面更容易掌握，并且在编码访谈中不常见。</p><p id="55b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不管怎样，视图有巨大的效用。SQL用户将从早期养成使用它们的习惯中受益匪浅。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="328c" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">什么是视图？</h2><p id="8823" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">视图只是在给定数据库上运行的存储查询的输出。</p><p id="0fda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们经常被比作表格，因为它们也以行和列的形式报告数据。</p><p id="fede" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，与表不同，视图实际上不是数据库模式的一部分。使用视图只需要运行它存储的查询。因此，它们需要内存，但不需要额外的存储空间。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="e934" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">视图的好处</h2><p id="5566" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">视图在SQL中非常有用，因为它们能够简化操作和管理访问控制。</p><ol class=""><li id="1d6a" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><strong class="lb iu">简化复杂查询</strong></li></ol><p id="7e09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然有些SQL查询简单易懂，但其他查询可能很复杂，需要许多行代码。</p><p id="9765" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑已经被规范化的数据库，其结果是包含多个表。不断编写使用多个连接或cte来获取相同信息的查询会很麻烦。这不仅费时，而且让用户容易出错。</p><p id="9b00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，当试图重复访问相同的信息时，没有必要经历这么多麻烦。视图可以让用户以最小的努力重复查询，从而消除所有不必要的复杂性。</p><p id="556b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。管理访问控制</strong></p><p id="ef21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安全性是数据库管理中的一个关键因素。理想情况下，人们应该只被授权访问符合其角色或地位的数据。</p><p id="78c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您不希望存储在表格或列中的任何个人信息或机密信息被错误的人看到。</p><p id="2b9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据库管理员可以通过创建视图并授予其他人访问这些视图的权限来规避这个问题。通过这种安排，任何外部方(例如客户)都无法看到他们不应该知道的信息。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="1aa7" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">在SQL中使用视图</h2><p id="cac0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">由于SQL的用户友好语法，视图易于创建和管理。</p><p id="b46d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为视图的演示，我们有两个表，名为<code class="fe nj nk nl nm b">People</code>和<code class="fe nj nk nl nm b">Job</code>，我们将使用PostgreSQL查询它们(语法可能会因所选的RDMBS而异)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/27bd860c712621446f885d94e729331c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*MJumrvyvWOqCqFLRhse6GQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/e996134388cf9971e80e64ac4a3b9177.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*gFRC72PFtMuvVqZVsdIQig.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="b072" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您想要定期跟踪“高收入者”的记录，这些人的工资至少为20万英镑。您可以通过以下查询获得这些记录。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/accaf2bf181b7bb7ca3a844a59e2751b.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*qMY9I1OD5I4A5MZfGoCVzw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="2250" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该查询将返回期望的输出，但是重复编写多行代码来获得相同的输出会令人厌烦。</p><p id="a2b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，向外部客户机显示这些信息的用户可能不希望他们也能访问数据库中的<code class="fe nj nk nl nm b">first_name</code>列。对于这样的场景，创建一个只存储所需列的视图，然后将这些列提供给客户机，这将是非常有益的。</p><ol class=""><li id="c5c1" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><strong class="lb iu">创建视图</strong></li></ol><p id="a7f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建视图的语法类似于创建表的语法。</p><p id="0ecc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述查询可以存储在具有以下内容的视图中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="34fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以像查询任何其他表一样查询视图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/86eccc27d78852606a52c4fa2bed9456.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*iqG_psuR7eZs1ei2EGQQEw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="81f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。更新视图</strong></p><p id="73f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以用<code class="fe nj nk nl nm b">CREATE OR REPLACE</code>命令更新视图。</p><p id="409a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设定义高收入者的起征点应该是15万，而不是20万。</p><p id="85eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以修改视图来解决这一变化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="a674" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在查询同一个视图会产生稍微不同的输出。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/ba7afa25e98afb59c3806bd588c241c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*Qv-7EKn_1baR3qAZ3_z8GQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="a3e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然<code class="fe nj nk nl nm b">CREATE OR REPLACE</code>命令能够修改视图，但是它有自己的局限性。也就是说，它希望查询输出保留相同的列数、列名和列数据类型。因此，任何导致数据结构变化的修改都会产生错误。</p><p id="2728" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3。查看所有视图</strong></p><p id="a1ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在SQL脚本上花费大量时间后，很容易失去对所有创建视图的跟踪。此外，记住存储在这些视图中的复杂查询可能会很麻烦。</p><p id="e038" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这种情况，可以使用下面的查询找到所有创建的视图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/b11b205b3a4036786f3a2ee4ad94f1be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*gxXmEmAcpPy63i68eRfVrg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出预览(由作者创建)</p></figure><p id="259e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，包含了<code class="fe nj nk nl nm b">WHERE</code>命令是为了省略PostgreSQL中的内置视图。</p><p id="8f7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在输出中，<code class="fe nj nk nl nm b">table_name</code>列显示了视图的名称，而<code class="fe nj nk nl nm b">view_definition</code>列显示了视图中存储的查询。</p><p id="f837" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 4。删除视图</strong></p><p id="01d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，可以用简单的一行程序删除视图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="34ab" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">结论</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/e2374d70e6056fe5afd3aedbb1f0537c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*u0CVBk_13PQ_RVVt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@prateekkatyal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b561" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">视图不仅使用户能够简化复杂的查询，还允许他们限制其他人对个人或机密信息的访问。</p><p id="b50b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总而言之，对于那些希望在与同事或外部客户协作的同时高效地执行SQL数据分析的人来说，它们非常有用。</p><p id="092d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我祝你在数据科学的努力中好运！</p></div></div>    
</body>
</html>