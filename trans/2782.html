<html>
<head>
<title>4 Python Packages to Learn Causal Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习因果分析的4个Python包</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-python-packages-to-learn-causal-analysis-9a8eaab9fdab#2022-06-16">https://towardsdatascience.com/4-python-packages-to-learn-causal-analysis-9a8eaab9fdab#2022-06-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d0c4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过这些包学习因果分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e51cec10ff97ecd808beb3607b1ff180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GUGbYP-WL4DVEj-O"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@fabioha?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">法比奥</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="46b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因果分析是实验统计学中证明和建立因果关系的一个领域。在统计学中，利用统计算法在严格假设下推断数据集内的因果关系，称为<strong class="lb iu">探索性因果分析</strong> ( <strong class="lb iu"> ECA </strong>)。</p><p id="ae73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">反过来，ECA是一种用更可控的实验证明因果关系的方法，而不仅仅是基于相关性。我们经常需要证明<strong class="lb iu">反事实</strong>——其他情况下的不同条件。问题是我们只能近似因果效应，而不能近似反事实。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/63a02666e637b34734d5ccc37e1e27af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8aqOKJJ4EtgcjbOO.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="1c89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因果分析已经是数据科学中一个不同的学习领域，因为它与机器学习建模的预测有着内在的不同。我们可以从现有数据中预测最大似然结果，但无法预测现有数据之外的结果。</p><p id="49f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了学习更多关于因果分析的知识，本文将向您展示4个Python包，您可以使用它们作为学习材料。让我们开始吧。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="b86e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">1.因果关系</h1><p id="4985" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://causalinferenceinpython.org/" rel="noopener ugc nofollow" target="_blank"> Causalinference </a>是一个Python包，提供了各种用于因果分析的统计方法。这是一个简单的包，用于基本的因果分析学习。这些软件包的主要功能包括:</p><ul class=""><li id="1325" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">倾向得分估计和子类化</li><li id="e2ce" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">通过修整改善协变量平衡</li><li id="73ad" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">治疗效果评估</li><li id="0e92" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">协变量分布中重叠的评估</li></ul><p id="258b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在他们的<a class="ae ky" href="https://github.com/laurencium/causalinference/blob/master/docs/tex/vignette.pdf" rel="noopener ugc nofollow" target="_blank">网页</a>上找到关于每个术语的更长的解释。</p><p id="a50b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们试试Causalinference包。首先，我们需要安装软件包。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="603d" class="nt me it np b gy nu nv l nw nx">pip install causalinference</span></pre><p id="529e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装完成后，我们将尝试实现一个因果模型来进行因果分析。我们将使用来自因果参考包的随机数据。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="9420" class="nt me it np b gy nu nv l nw nx">from causalinference import CausalModel<br/>from causalinference.utils import random_data</span><span id="50d7" class="nt me it np b gy ny nv l nw nx">#Y is the outcome, D is treatment status, and X is the independent variable</span><span id="b984" class="nt me it np b gy ny nv l nw nx">Y, D, X = random_data()<br/>causal = CausalModel(Y, D, X)</span></pre><p id="2042" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">CausalModel类将分析数据。我们需要再做一些步骤来从模型中获取重要的信息。首先，让我们得到统计摘要。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a230" class="nt me it np b gy nu nv l nw nx">print(causal.summary_stats)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/f9544a65080f821166be8382ccf17da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1poYEAhly6sdxVMex2mbQw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0a3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过使用<code class="fe oa ob oc np b">summary_stats</code>属性，我们将获得数据集的所有基本信息。</p><p id="7ead" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因果分析的主要部分是获取治疗效果信息。最简单的方法是使用普通的最小二乘法。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="cc75" class="nt me it np b gy nu nv l nw nx">causal.est_via_ols()<br/>print(causal.estimates)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/be4dd080fb769002f9ba449a9c275efa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Ur238N_50OxASJ0NK-IIw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="26fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ATE、ATC和ATT分别代表平均治疗效果、对照的平均治疗效果和治疗的平均治疗效果。利用这些信息，我们可以评估与对照组相比，治疗是否有效果。</p><p id="f111" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用倾向评分法，我们也可以获得关于独立变量的治疗概率的信息。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="e83e" class="nt me it np b gy nu nv l nw nx">causal.est_propensity_s()<br/>print(causal.propensity)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/3143cffc056d3acedfa44221ea401fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9v9l1SeTeUdEnWX6aRMPUg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="ac51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用倾向评分法，我们可以评估给定独立变量的治疗概率。</p><p id="7c1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仍然有许多方法你可以探索和学习。建议大家访问causalinference网页，进一步了解。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2531" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">2.考萨利布</h1><p id="3032" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://github.com/IBM/causallib" rel="noopener ugc nofollow" target="_blank"> Causallib </a>是IBM开发的用于因果分析的Python包。该包提供了与Scikit-Learn API统一的因果分析API，这允许使用拟合和预测方法的复杂学习模型。</p><p id="3806" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Causallib软件包的好处是我们可以在学习过程中使用的<a class="ae ky" href="https://github.com/IBM/causallib/tree/master/examples" rel="noopener ugc nofollow" target="_blank">示例笔记本</a>的数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/b4b846a137e0f13b6d672455fb5b023a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s0mOwWyIAFmy6pvQsOhAnA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="36b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，让我们尝试使用causallib包进行学习。首先，我们需要安装软件包。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="dcab" class="nt me it np b gy nu nv l nw nx">pip install causallib</span></pre><p id="7b7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们将使用causallib包中的一个示例数据集，并使用Scikit-Learn中的模型估计因果分析。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0f7e" class="nt me it np b gy nu nv l nw nx">from sklearn.linear_model import LogisticRegression<br/>from causallib.estimation import IPW <br/>from causallib.datasets import load_nhefs</span><span id="f217" class="nt me it np b gy ny nv l nw nx">data = load_nhefs()<br/>ipw = IPW(LogisticRegression())<br/>ipw.fit(data.X, data.a)<br/>potential_outcomes = ipw.estimate_population_outcome(data.X, data.a, data.y)<br/>effect = ipw.estimate_effect(potential_outcomes[1], potential_outcomes[0])</span></pre><p id="ede3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述代码将加载一项关于吸烟对健康影响的跟踪研究。我们使用逻辑回归模型作为因果模型来建立和评估因果效应。</p><p id="941b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们检查一下治疗的潜在结果和效果。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="6048" class="nt me it np b gy nu nv l nw nx">print(potential_outcomes)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/f3806a4e1560659d71cb4a07608aada6.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*_d8yWNvZAS2_iLCp4pjzhQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="604f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查潜在的结果，我们可以看到，如果每个人都戒烟(1)的平均体重差异是5.38公斤，而如果每个人都一直吸烟(0)的平均体重差异是1.71公斤。</p><p id="4655" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着我们的平均体重相差约3.67公斤。因此，我们可以得出结论，吸烟治疗将减少体重增加约3.67公斤。</p><p id="765f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如需更多信息和学习材料，请访问Causallib页面上的笔记本。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="547f" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">3.因果影响</h1><p id="5675" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://github.com/jamalsenouci/causalimpact" rel="noopener ugc nofollow" target="_blank"> Causalimpact </a>是一个用于因果分析的Python包，用于估计时间序列干预的因果效应。该分析试图看出事实发生之前和之后的处理之间的差异。</p><p id="f6ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Causalimpact将分析响应时间序列(例如，点击、药物效应等)。)和一个控制时间序列(你的反应，但在一个更受控制的环境中)与贝叶斯结构时间序列模型。这个模型预测反事实(如果干预从未发生会发生什么)，然后我们可以比较结果。</p><p id="255c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们通过安装软件包来开始使用它。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="97af" class="nt me it np b gy nu nv l nw nx">pip install causalimpact</span></pre><p id="0a55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成安装包后，让我们创建模拟数据。我们将创建一个具有100个观察值的示例数据集，其中在时间点71之后将有一个干预效应<em class="oh"> </em>。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="228f" class="nt me it np b gy nu nv l nw nx">import numpy as np<br/>from statsmodels.tsa.arima_process import arma_generate_sample<br/>from causalimpact import CausalImpact</span><span id="166c" class="nt me it np b gy ny nv l nw nx">np.random.seed(1)</span><span id="9e91" class="nt me it np b gy ny nv l nw nx">x1 = arma_generate_sample(ar=[0.999], ma=[0.9], nsample=100) + 100<br/>y = 1.2 * x1 + np.random.randn(100)</span><span id="cb17" class="nt me it np b gy ny nv l nw nx">y[71:100] = y[71:100] + 10<br/>data = pd.DataFrame(np.array([y, x1]).T, columns=["y","x1"])<br/>pre_period = [0,69]<br/>post_period = [71,99]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/83acebc1b614d952e2a4bf6ee505309e.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*EgWcke_Fda5u7jbVy2qb8Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5cd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面，我们获得了一个因变量(y)和一个自变量(x1)。通常，我们会有不止一个独立的，但让我们坚持使用当前的数据。让我们用这些数据进行分析。我们需要具体说明干预之前和之后的时间。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="f07b" class="nt me it np b gy nu nv l nw nx">impact = CausalImpact(data, pre_period, post_period)<br/>impact.run()<br/>impact.plot()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/fb7ceca47ae6c6f02e77d589df30cada.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQka1kZ3EmB0sH21iybykQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="96d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的图给了我们三组信息。上图显示了治疗后时期的实际数据和反事实预测。中间的面板显示了实际数据和反事实预测之间的差异，这是逐点的<em class="oh"> </em>因果效应。底部面板是干预的累积效果图，其中我们累积了中间面板的逐点贡献。</p><p id="8ba9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想从每个数据点获得信息，我们可以使用下面的代码。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a8bd" class="nt me it np b gy nu nv l nw nx">impact.inferences</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/51cedf1f252617d57d13ab967f70be5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vYDWliB5gBescRgFi3ul9w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="77b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，通过下面的代码获得一个汇总结果。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="2ad5" class="nt me it np b gy nu nv l nw nx">impact.summary()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/bfc26edba6896b8fee86b7fe3db37773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*brrltmqAGTnMo56Mw8yfqA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b0c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该总结允许我们评估干预的发生是否有因果关系。如果您想要更详细的报告，您可以使用下面的代码。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="253e" class="nt me it np b gy nu nv l nw nx">impact.summary(output = 'report')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/cca3090f4a81c8edf537840754600466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TuQKqf6KrOeJ2_3lvryHwg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="df82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想了解更多关于时间干预因果分析的知识，请查看他们的<a class="ae ky" href="https://nbviewer.org/github/jamalsenouci/causalimpact/blob/master/GettingStarted.ipynb" rel="noopener ugc nofollow" target="_blank">文档页面</a>。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="9d02" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">4.为什么</h1><p id="7dba" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">DoWhy 是一个Python包，它用一个简单的API和完整的文档提供了最先进的因果分析。</p><p id="6441" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们访问文档页面，为什么通过4个步骤进行因果分析:</p><ol class=""><li id="5b44" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu on ng nh ni bi translated">使用我们创建的假设对因果推理问题建模，</li><li id="b676" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated">确定假设下因果效应的表达式，</li><li id="2fb9" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated">使用统计方法估计表达式，</li><li id="6f4d" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated">验证评估的有效性。</li></ol><p id="b926" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们试着用DoWhy包开始一个因果分析。首先，我们必须通过运行下面的代码来安装DoWhy包。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="b904" class="nt me it np b gy nu nv l nw nx">pip install dowhy</span></pre><p id="108e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，作为样本数据集，我们将使用来自DoWhy包的随机数据集。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="d223" class="nt me it np b gy nu nv l nw nx">from dowhy import CausalModel<br/>import dowhy.datasets</span><span id="e867" class="nt me it np b gy ny nv l nw nx"># Load some sample data<br/>data = dowhy.datasets.linear_dataset(<br/>    beta=10,<br/>    num_common_causes=5,<br/>    num_instruments=2,<br/>    num_samples=10000,<br/>    treatment_is_binary=True)</span></pre><p id="6d02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，给定我们创建的图表和假设，我们可以将其发展成因果模型。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="26d6" class="nt me it np b gy nu nv l nw nx">Create a causal model from the data and given graph.<br/>model = CausalModel(<br/>    data=data["df"],<br/>    treatment=data["treatment_name"],<br/>    outcome=data["outcome_name"],<br/>    graph=data["gml_graph"])</span><span id="c9f0" class="nt me it np b gy ny nv l nw nx">model.view_model()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/e27695fac8ce0f30748c33233dc05b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*MG1PLYmabjwpX2H2q-NFSA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="459c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要用下面的代码来确定因果关系。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="840c" class="nt me it np b gy nu nv l nw nx">#Identify the causal effect<br/>estimands = model.identify_effect()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/02fbb82ce0c99e165072439ee289ac52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a7OUj6hiu5XTTt87pgSuQQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e31e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们确定一个因果效应，然后我们需要从统计上估计这个效应有多强。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="a054" class="nt me it np b gy nu nv l nw nx">estimate = model.estimate_effect(identified_estimand,                              method_name="backdoor.propensity_score_matching")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/62b19315a6618c24c60f4ff2165a0104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2qL6ZkN2E3-QdMlZIBA7Lg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b00f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，因果效应估计是基于数据的统计估计，但因果关系本身并不基于数据；相反，它是基于我们以前的假设。我们需要用健壮性检查来检查假设的有效性。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="f871" class="nt me it np b gy nu nv l nw nx">refute_results = model.refute_estimate(identified_estimand, estimate,                                     method_name="random_common_cause")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/7758e22e887f14358e8d4e711efde370.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*B4zEIe9B3IWuEBuZalyF1Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="36a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，我们就完成了因果分析，并可以利用这些信息来决定治疗是否有因果影响。</p><p id="fa9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">DoWhy文档提供了大量的学习材料；您应该访问网页以了解更多信息。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="9459" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated"><strong class="ak">结论</strong></h1><p id="e2b0" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">因果分析是实验统计学中证明和建立因果关系的一个领域。这是数据科学中的一个不同领域，需要它的学习材料。</p><p id="5866" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我概述了4个Python包，您可以用它们来学习因果分析。它们是:</p><ol class=""><li id="e614" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu on ng nh ni bi translated">因果关系</li><li id="dcb5" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated">考萨利布</li><li id="0a75" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated">因果影响</li><li id="81c0" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu on ng nh ni bi translated">为什么</li></ol><p id="c0e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望有帮助！</p><blockquote class="or os ot"><p id="a128" class="kz la oh lb b lc ld ju le lf lg jx lh ou lj lk ll ov ln lo lp ow lr ls lt lu im bi translated"><em class="it">访问我的</em> <a class="ae ky" href="https://bio.link/cornelli" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="it">社交媒体</em></strong></a><strong class="lb iu"><em class="it"/></strong><em class="it">进行更深入的交谈或有任何问题。</em></p></blockquote><blockquote class="ox"><p id="9a83" class="oy oz it bd pa pb pc pd pe pf pg lu dk translated"><em class="ph">如果您没有订阅为中等会员，请考虑通过我的推荐订阅。</em></p></blockquote></div></div>    
</body>
</html>