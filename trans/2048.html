<html>
<head>
<title>Top 3 New Features in Python 3.11: Prepare Yourself</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 3.11的三大新特性:做好准备</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/top-3-new-features-in-python-3-11-prepare-yourself-701cca4af9c3#2022-05-09">https://towardsdatascience.com/top-3-new-features-in-python-3-11-prepare-yourself-701cca4af9c3#2022-05-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="98ca" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python 3.11还没有发布，但是你可以尝试一下RC版本。剧透警告:太神奇了</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/60800f317ec69b5bd974fc96341d1558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2_RO4uAYk6t9qNtk"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/es/@comparefibre?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上对比纤维</a></p></figure><p id="517a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.11预计2022年10月播出。那是五个月以后的事了，为什么要大肆宣传呢？像往常一样，我们可以测试RC版本，看看它与Python 3.10相比如何。</p><p id="5fdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这正是我所做的。我设置了两个Docker容器，一个用于<a class="ae ky" href="https://github.com/docker-library/python/blob/f871d0435e7f35a693fa1b60aa159e6a1a4c6a2e/3.10/bullseye/Dockerfile" rel="noopener ugc nofollow" target="_blank"> Python 3.10 </a>，另一个用于<a class="ae ky" href="https://github.com/docker-library/python/blob/f871d0435e7f35a693fa1b60aa159e6a1a4c6a2e/3.11-rc/bullseye/Dockerfile" rel="noopener ugc nofollow" target="_blank"> Python 3.11 </a>，并将它们附加到单独的Visual Studio代码窗口。我们将在两个版本中运行完全相同的代码，看看新版本带来了什么。</p><p id="f56d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">TL；有很多新功能，但我决定写三个。这些是更好的错误位置、异常注释和内置的TOML解析器。相对于旧的Python版本，这是一个很大的改进。参考<a class="ae ky" href="https://docs.python.org/3.11/whatsnew/3.11.html" rel="noopener ugc nofollow" target="_blank">官方变更日志</a>获得新特性的完整列表。</strong></p><blockquote class="lv lw lx"><p id="6d9d" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><em class="it">您知道Python 3.11将比Python 3.10快60%吗？</em> <a class="ae ky" href="https://medium.com/towards-data-science/python-is-about-to-become-64-faster-python-3-10-vs-python-3-11-benchmark-3a6abcc25b90" rel="noopener"> <em class="it">下面是详细的基准</em> </a> <em class="it">。</em></p></blockquote><p id="8550" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不想看书？请观看我的视频:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="89ba" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">Python 3.11功能1-增强的错误位置</h1><p id="22c1" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">当打印回溯时，Python解释器现在将指向导致错误的确切表达式，而不仅仅是该行。例如，下面的代码片段会抛出一个错误，因为给定索引处的列表项不存在:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="2f5f" class="nn mm it nj b gy no np l nq nr">if __name__ == "__main__":<br/>    l = [1, 2, 3]<br/>    print(l[3])</span></pre><p id="6368" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python 3.10中，您将获得以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/dc6cdb78c44170d66f13a846529e07c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ylw8-zYmeyUcPBv7I3C7QQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片1-增强的错误位置(1)(图片由作者提供)</p></figure><p id="d726" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，Python 3.11将打印以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/459e371c96f5206afc99955c8096d478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CllZk1FG4qDjm-cTlkT2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2-增强的错误位置(2)(图片由作者提供)</p></figure><p id="6d2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.11在导致错误的代码部分加了下划线，非常简洁。比方说，Python字典也是如此。下面的代码片段将引发一个错误，因为字典没有那个键:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="9e61" class="nn mm it nj b gy no np l nq nr">if __name__ == "__main__":<br/>    d = {"key1": "value1", "key2": "value2"}<br/>    print(d["key3"])</span></pre><p id="1bf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是Python 3.10吐出的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/1d472d5c2253b5f9c7df298afe3c043d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7TNbc17LV_hn5OBCJNUDfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3-增强的错误位置(3)(图片由作者提供)</p></figure><p id="29f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是Python 3.11的输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/5e54c17ca403552f40df79412520214d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCeZQ7O553fPAvx8ng7sYA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4 —增强的错误位置(4)(图片由作者提供)</p></figure><p id="7733" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.11再次强调了导致错误的确切代码部分。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="4bd5" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">Python 3.11功能# 2-异常注释</h1><p id="c729" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">Python的<code class="fe nu nv nw nj b">Exception</code>类在Python 3.11中会有一个<code class="fe nu nv nw nj b">__note__</code>属性。默认情况下它是<code class="fe nu nv nw nj b">None</code>，但是你可以用任何你想要的字符串覆盖它。当然，这不是最具突破性的特性，但是如果您有几十个自定义异常类，这里或那里的一个注释会派上用场。</p><p id="6fbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们将在两个容器中运行的代码:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="293f" class="nn mm it nj b gy no np l nq nr">class CustomException(Exception):<br/>    __note__ = "Note about my custom exception"<br/></span><span id="ef42" class="nn mm it nj b gy nx np l nq nr">if __name__ == "__main__":<br/>    raise CustomException()</span></pre><p id="b20e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是Python 3.10的输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/c42088c8e2dc386470931a1814d064dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*APXemqEE8Y8YVhVAY1Y6mQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5 —引发自定义异常(1)(作者图片)</p></figure><p id="958a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所料，Python 3.10的<code class="fe nu nv nw nj b">Exception</code>类不知道这个新属性。Python 3.11的情况完全不同:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/b59b31bf34bdaddd9afb29388f21076a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fy1FrbtqOW4TyA45gdarPw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6 —引发自定义异常(2)(作者图片)</p></figure><p id="40db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.11再次强调了导致错误的那一行——在本例中是一个明显的错误——但是它也在最后打印了我们的注释。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="a004" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">Python 3.11特性#3 —内置的TOML解析器</h1><p id="5d70" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated"><a class="ae ky" href="https://toml.io/en/" rel="noopener ugc nofollow" target="_blank"> TOML </a>，或者说<em class="ly"> Tom显而易见的极简语言</em>，是一种极简配置文件格式。在Python 3.11之前，没有内置的库来处理TOML配置文件。现在情况变了。</p><p id="a003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我们将在两个容器中运行的代码片段:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="fc6e" class="nn mm it nj b gy no np l nq nr">import tomllib </span><span id="a4e4" class="nn mm it nj b gy nx np l nq nr">DOC = """<br/>[main]<br/>python_version = 3.11</span><span id="c984" class="nn mm it nj b gy nx np l nq nr">[api]<br/>endpoint_users = "/api/v2/users"<br/>endpoint_posts = "/api/v2/posts"<br/>"""</span><span id="6c64" class="nn mm it nj b gy nx np l nq nr">if __name__ == "__main__":<br/>    doc_parsed = tomllib.loads(DOC)<br/>    print(doc_parsed)</span></pre><p id="4d2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.10没有<code class="fe nu nv nw nj b">tomllib</code>库，所以立即引发了异常:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/e019f9dfe704a81d858293f3848a8780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3g7GjFvRZGV3JujBhUy5GA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7 — TOML配置文件(1)(图片由作者提供)</p></figure><p id="6ee1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.11支持它，因为解析TOML字符串没有问题:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/65d4f1f6588d3c7b3ea40328f8e9fa66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n5ls9dWsjAojtIlaYKDn7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8 — TOML配置文件(2)(图片由作者提供)</p></figure><p id="a0b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，安装一个解析TOML文件的专用库需要几秒钟，但是很高兴看到它将成为新版本的内置功能。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="71b7" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">Python 3.11新特性概述</h1><p id="a06a" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们已经介绍了Python 3.11中的三个特性。当然，还有其他的，比如自我类型、异常组、异步理解等等，但是如果你感兴趣的话，你可以参考官方变更日志。</p><p id="79ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">新Python版本带来的最大改进可能是速度的提高。平均而言，Python 3.11将比Python 3.10快15%，差距高达64%。我在我的详细的<a class="ae ky" href="https://betterdatascience.com/python-310-vs-python-311/" rel="noopener ugc nofollow" target="_blank">基准测试文章</a>中比较了这两者，所以请务必查看一下。</p><p id="54a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly">你最喜欢的Python 3.11特性是什么？请在下面的评论区告诉我。</em></p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="974d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">喜欢这篇文章吗？成为 <a class="ae ky" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="ly">中等会员</em> </a> <em class="ly">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ny nz gp gr oa ob"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">medium.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op ks ob"/></div></div></a></div></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="4e4f" class="nn mm it bd mn oq or dn mr os ot dp mv li ou ov mx lm ow ox mz lq oy oz nb pa bi translated">推荐阅读</h2><ul class=""><li id="e585" class="pb pc it lb b lc nd lf ne li pd lm pe lq pf lu pg ph pi pj bi translated"><a class="ae ky" href="https://betterdatascience.com/best-data-science-prerequisite-books/" rel="noopener ugc nofollow" target="_blank">学习数据科学先决条件(数学、统计和编程)的5本最佳书籍</a></li><li id="c030" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated"><a class="ae ky" href="https://betterdatascience.com/top-books-to-learn-data-science/" rel="noopener ugc nofollow" target="_blank">2022年学习数据科学的前5本书</a></li><li id="5972" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated"><a class="ae ky" href="https://betterdatascience.com/python-list-print/" rel="noopener ugc nofollow" target="_blank">用Python打印列表的7种方法</a></li></ul><h2 id="d766" class="nn mm it bd mn oq or dn mr os ot dp mv li ou ov mx lm ow ox mz lq oy oz nb pa bi translated">保持联系</h2><ul class=""><li id="c266" class="pb pc it lb b lc nd lf ne li pd lm pe lq pf lu pg ph pi pj bi translated">雇用我作为一名技术作家</li><li id="5707" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated">订阅<a class="ae ky" href="https://www.youtube.com/c/BetterDataScience" rel="noopener ugc nofollow" target="_blank"> YouTube </a></li><li id="64ff" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated">在<a class="ae ky" href="https://www.linkedin.com/in/darioradecic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</li></ul></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="a32f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly">原载于2022年5月9日https://betterdatascience.com</em><em class="ly">的</em> <a class="ae ky" href="https://betterdatascience.com/python-311-whats-new/" rel="noopener ugc nofollow" target="_blank"> <em class="ly">。</em></a></p></div></div>    
</body>
</html>