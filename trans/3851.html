<html>
<head>
<title>Build your first CNN with Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Tensorflow构建您的第一个CNN</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-your-first-cnn-with-tensorflow-a9d7394eaa2e#2022-08-26">https://towardsdatascience.com/build-your-first-cnn-with-tensorflow-a9d7394eaa2e#2022-08-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="59bc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建第一个神经网络的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ce558922a4f989c6f218e2bb5ef06c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7T3sDWWqhJzckjZr6PryMw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.pexels.com/es-es/@mccutcheon/" rel="noopener ugc nofollow" target="_blank">亚历山大·格雷</a>在<a class="ae kv" href="http://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><p id="89bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计算机视觉是当今的热门话题之一。它为涉及图像的不同问题提供了可靠的解决方案。在本文中，我们将使用Tensorflow从头开始创建一个卷积神经网络(CNN)。然后，我们将使用它对猫和狗的图像进行分类，这是最流行的图像分类数据集之一。</p><p id="331f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文旨在帮助该领域的新手(尤其是Tensorflow新手)学习获取数据、处理数据、构建模型、训练模型以及最终使用数据进行预测的基本原则。</p><h1 id="8078" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是分类？</h1><p id="e0df" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们要回答的第一个问题是什么是分类。我将尽可能缩短这些原则，并提供其他有价值的文章来更深入地介绍它们。</p><p id="c5f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">分类</strong>是给给定的输入数据分配一个标签的过程。例如，我们可以对电子邮件是否是垃圾邮件进行分类。在这种情况下，对于给定的图像，我们将预测图像是猫还是狗。</p><p id="13f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于什么是分类和最流行的算法的更详细的解释，我强烈推荐阅读下面的文章:</p><div class="mp mq gp gr mr ms"><a rel="noopener follow" target="_blank" href="/machine-learning-classifiers-a5cc4e1b0623"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">机器学习分类器</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">什么是分类？</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng kp ms"/></div></div></a></div><h1 id="f5c0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">卷积神经网络(CNN)</h1><p id="2b3e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">下面的关键概念是CNN(或ConvNet)。CNN是一类神经网络，它将图像作为输入，对其应用一系列操作并返回输出。该输出可以是概率、图像类别的预测或另一个新图像。这取决于网络架构和我们试图解决的问题。</p><p id="db03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，我们将使用一个简单的CNN来将输入图像分类为狗或猫类。它将返回给定图像是狗还是猫的概率。</p><p id="7662" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了更多更好地理解这种神经网络在图像中执行的操作，我建议这篇文章:</p><div class="mp mq gp gr mr ms"><a rel="noopener follow" target="_blank" href="/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">卷积神经网络综合指南ELI5方法</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">人工智能见证了人类能力差距的巨大增长…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="nh l nd ne nf nb ng kp ms"/></div></div></a></div><h1 id="6eac" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">构建我们的网络</h1><p id="5154" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">(你可以在这个<a class="ae kv" href="https://github.com/Psancs05/Medium/tree/master/Cats-Dogs" rel="noopener ugc nofollow" target="_blank"> repo </a>中找到所有代码)</p><p id="981d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">是时候开始工作并构建我们的分类器了。如前所述，我们将使用Tensorflow和Keras，使用简单的CNN架构制作一个猫/狗分类器。</p><h2 id="cd9b" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">加载数据集</h2><p id="dec3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将使用<a class="ae kv" href="https://www.robots.ox.ac.uk/~vgg/data/pets/" rel="noopener ugc nofollow" target="_blank">牛津-IIIT宠物数据集</a>，包含超过7000张猫和狗的图片。该数据集拥有CC-BY-SA 4.0许可证，这意味着我们可以为任何目的共享和调整数据。</p><p id="bb42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要下面的库。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b04c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们将加载数据集。你可以从<a class="ae kv" href="https://www.kaggle.com/datasets/tanlikesmath/the-oxfordiiit-pet-dataset" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载，并将文件夹复制到你的工作目录中。另外，你可以直接从数据集的<a class="ae kv" href="https://www.robots.ox.ac.uk/~vgg/data/pets/" rel="noopener ugc nofollow" target="_blank">网站</a>获取数据。</p><p id="78ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦我们有了数据集，它将包含一个名为<em class="nw">‘images’</em>的文件夹，里面有所有的宠物图像。</p><p id="0b44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个图像将在文件名中包含其标签。正如我们在数据集的信息中看到的，数据被分成不同的品种。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/ca315a4a11100d71cef69985fb465b5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tfeBZwTYILt41_jAy1MF7g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集信息，<a class="ae kv" href="https://www.robots.ox.ac.uk/~vgg/data/pets/" rel="noopener ugc nofollow" target="_blank">链接</a></p></figure><p id="2658" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有12个品种的猫和25只狗。我们将遵循的策略是使用所有的狗品种作为狗图像，所有的猫品种作为猫图像。我们不考虑品种，因为我们想建立一个二元分类器。</p><p id="503a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看看我们有多少数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="8d54" class="ni lt iq nz b gy od oe l of og">There are 7390 images in the dataset</span></pre><p id="8835" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到，总共有7390张图片。现在是时候除掉这些品种了。我们将创建两个列表，一个包含所有狗的照片，另一个包含所有猫的图片。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="f482" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以看一下，看看我们有多少张每种动物的图片。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="13d9" class="ni lt iq nz b gy od oe l of og">There are 2400 images of cats<br/>There are 4990 images of dogs</span></pre><p id="3122" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该数据集有2400只猫和4990只狗。</p><h2 id="513d" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">数据分区</h2><p id="71b8" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">对于我们的网络，我们希望使用三个不同的集合:</p><ul class=""><li id="33e5" class="oh oi iq ky b kz la lc ld lf oj lj ok ln ol lr om on oo op bi translated">训练:训练模型的图像。</li><li id="4a18" class="oh oi iq ky b kz oq lc or lf os lj ot ln ou lr om on oo op bi translated">验证:在训练过程中测试模型的图像。</li><li id="5d3b" class="oh oi iq ky b kz oq lc or lf os lj ot ln ou lr om on oo op bi translated">test:在模型完成训练后对其进行测试的图像。</li></ul><p id="83fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用70%的图像进行训练，10%用于验证，剩下的20%用于测试。</p><p id="1fab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于我们只有两个图像列表(狗和猫)，我们需要将这些列表分成不同的集合。我们将用熊猫来做这件事。</p><p id="02e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们将数据混洗并分成三组，其对应的数据分布为70/10/20。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="6ea8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们必须使用<em class="nw">熊猫</em>创建<em class="nw">数据帧</em>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="36e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它们只有两列，一列是图像名称，另一列是标签“猫”或“狗”。</p><p id="d008" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们可以连接<em class="nw">数据帧。</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="49ce" class="ni lt iq nz b gy od oe l of og">There are 5173 images for training<br/>There are 739 images for validation<br/>There are 1478 images for testing</span><span id="389d" class="ni lt iq nz b gy ov oe l of og">There are 7000 images for training<br/>There are 1000 images for validation<br/>There are 2000 images for testing</span></pre><p id="a6ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完美！我们已经从数据集创建了三个分区。</p><h2 id="5b75" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">数据预处理</h2><p id="5e67" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">接下来的步骤是预处理所有的图像。我们希望它们具有相同的维度(因为CNN将需要具有相同维度的所有输入数据),并且它们的像素被归一化。这样做的原因是为了更快地训练我们的神经网络模型。</p><p id="751e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用Keras中的ImageDataGenerator类。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="24cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们刚刚创建了3个新的数据集，每个数据集都有经过预处理的图像。此外，我们应用了<em class="nw"> shuffle </em>属性来随机重组图像的顺序，并应用了<em class="nw"> batch_size </em>来将图像加入32个元素的组中。这意味着我们将一次给CNN 32张图片。每一步中的图像越少，模型的学习效果就越好，但完成训练过程需要的时间就越长。这是一个参数，我们可以用它来检查性能如何变化。</p><h2 id="21cd" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">形象化</h2><p id="1eea" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果我们想检查数据集的结果，我们可以做以下比较。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="e522" class="ni lt iq nz b gy od oe l of og">Batch shape:  (32, 224, 224, 3)<br/>Label shape:  (32,)</span></pre><p id="7821" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们有32张图片及其相关标签。此外，我们可以绘制这些图像(例如，第四个)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/00d17f82c904c4461d7b9faeb75eb9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*DmFIYET--cPON7-rMw6M8A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">该批次的第四个图像，作者</p></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="f3fc" class="ni lt iq nz b gy od oe l of og">Label:  1.0</span></pre><p id="3025" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">狗的标签是1，猫的标签是0。</p><h2 id="594c" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">模型</h2><p id="6d89" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们已经准备好了所有的数据，是时候构建模型了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="20fe" class="ni lt iq nz b gy od oe l of og">Model: "sequential" _________________________________________________________________  Layer (type)                    Output Shape            Param #    =================================================================  conv2d (Conv2D)                 (None, 222, 222, 64)    1792                                                                          max_pooling2d (MaxPooling2D)    (None, 111, 111, 64)    0                                                                                                                                             conv2d_1 (Conv2D)               (None, 109, 109, 128)   73856                                                                         max_pooling2d_1 (MaxPooling2D)  (None, 54, 54, 128)     0                                                                                                                                          conv2d_2 (Conv2D)               (None, 52, 52, 256)     295168                                                                        max_pooling2d_2 (MaxPooling2D)  (None, 26, 26, 256)     0                                                                                                                                        conv2d_3 (Conv2D)               (None, 24, 24, 512)     1180160                                                                       global_average_pooling2d (G     (None, 512)             0           lobalAveragePooling2D)                                                                                                              dense (Dense)                   (None, 1)               513<br/>=================================================================<br/>Total params: 1,551,489<br/>Trainable params: 1,551,489<br/>Non-trainable params: 0 _________________________________________________________________</span></pre><p id="403e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个简单的CNN模型，有四个卷积层和一个输出层，输出层由一个密集层和1个输出神经元组成。</p><p id="46d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们进入训练阶段。我们需要编译和拟合模型。我们将使用<em class="nw">二进制交叉熵</em>作为损失函数，因为我们正在处理带有整数标签的类(0代表猫，1代表狗)。优化器将是<em class="nw"> adam </em>算法，我们将使用<em class="nw">精度</em>作为流程的度量。</p><p id="dd61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将训练15个纪元的网络。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="db1c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经训练出了第一个CNN！我们可以在训练过程中查看网络的<em class="nw">精度</em>和<em class="nw">损耗</em>值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/8475787c8e2fe20ffe95eb1ad3ab8e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*8S7or8BCsMXv9kpvOSoJwg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">培训指标，按作者</p></figure><p id="c8d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后一步是评估这个模型。为此，我们将使用测试数据集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="b5ec" class="ni lt iq nz b gy od oe l of og">47/47 [==============================] - 10s 204ms/step - loss: 0.4277 - accuracy: 0.8051</span><span id="2265" class="ni lt iq nz b gy ov oe l of og">Loss: 0.4276582598686218<br/>Accuracy: 0.8051421046257019</span></pre><p id="73c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型的准确率为80%。</p><p id="f4ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你已经训练了你的第一个卷积神经网络，祝贺你！既然我们已经训练了新模型，我们可以用它来预测猫和狗的真实图像。这是我们可以使用模型进行预测的部分。这些图像在任何过程阶段都是前所未见的。</p><h2 id="c789" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">预言</h2><p id="904f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">预测阶段是与现实世界问题最相似的场景，在这一阶段，一旦模型被定型，它就必须对看不见的数据进行分类。</p><p id="6d90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的例子中，我们将预测下图的类。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/b018f0e790b19db5e4cf957692c128d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*GXx4cxkwlfpIXH_DQgUQWA.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://www.pexels.com/es-es/@pixabay/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>在<a class="ae kv" href="http://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>上制作的一只猫的图像</p></figure><p id="3531" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于人类来说，这显然是一只可爱的猫的图像，但让我们看看我们的模型对此有什么看法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><pre class="kg kh ki kj gt ny nz oa ob aw oc bi"><span id="29e2" class="ni lt iq nz b gy od oe l of og">array([[0.08732735]], dtype=float32)</span></pre><p id="a27c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，我们必须将影像整形为网络的输入格式，并像对所有数据集影像一样对其进行归一化。</p><p id="6491" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们给模型，输出是<em class="nw"> 0.08 </em>。该输出可以从0到1变化，因为网络的输出层具有sigmoid激活函数。因为我们的猫的类是0，狗的类是1，所以我们的模型同意这个图像是一只猫。</p><p id="e483" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这个<a class="ae kv" href="https://github.com/Psancs05/Medium/tree/master/Cats-Dogs" rel="noopener ugc nofollow" target="_blank">回购</a>中看到完整的代码。</p><h1 id="0f58" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">后续步骤</h1><p id="9f06" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们已经看到了一个简单的从头开始CNN的方法。它的性能很好，但仍有很大的改进空间。在这里，我将列举一些可能的修改，您可以研究以增强网络。</p><ul class=""><li id="0f63" class="oh oi iq ky b kz la lc ld lf oj lj ok ln ol lr om on oo op bi translated">改变网络架构。您可以尝试新的层，编辑现有的层或更改激活功能。你尝试的越多，你在CNN获得的知识就越多。</li><li id="e211" class="oh oi iq ky b kz oq lc or lf os lj ot ln ou lr om on oo op bi translated">增加<a class="ae kv" href="https://keras.io/api/layers/regularization_layers/dropout/" rel="noopener ugc nofollow" target="_blank">漏失</a>和<a class="ae kv" href="https://keras.io/api/layers/normalization_layers/batch_normalization/" rel="noopener ugc nofollow" target="_blank">批量归一化</a>图层。有非常有用的，尤其是在更大的模型中。这些层也有助于避免模型中的过度拟合。</li><li id="fc6e" class="oh oi iq ky b kz oq lc or lf os lj ot ln ou lr om on oo op bi translated">尝试新的优化训练过程。有很多不同的<a class="ae kv" href="https://keras.io/api/optimizers/#available-optimizers" rel="noopener ugc nofollow" target="_blank">优化器</a>可以用来训练网络。你可以改变它们，看看是否有改进。</li><li id="9145" class="oh oi iq ky b kz oq lc or lf os lj ot ln ou lr om on oo op bi translated">做图像增强，这是一种从现有图像中创建新图像的技术。您可以尝试缩放、旋转或裁剪部分图像，以生成更多数据。</li></ul><p id="0e52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你掌握了所有这些要点(以及你能想到的任何其他要点)，我建议着手于一个多类分类模型。例如，考虑到这次的品种，你可以使用相同的数据集。创建一个分类器，不仅区分猫和狗，而且区分数据集中可用的品种。这将是一个有趣的挑战！</p><p id="913c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望本教程对你有所帮助。如果您有任何问题，请随时发表评论！👋🏻​</p></div></div>    
</body>
</html>