<html>
<head>
<title>How to Create a Data Formatting Plugin in VDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在VDK创建一个数据格式插件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-a-data-formatting-plugin-in-vdk-dc5f1c7d206d#2022-10-12">https://towardsdatascience.com/how-to-create-a-data-formatting-plugin-in-vdk-dc5f1c7d206d#2022-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1d2c" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据工程，数据湖</h2><div class=""/><div class=""><h2 id="56c0" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">关于如何通过编写VDK自定义插件来操作数据湖中的表的分步教程</h2></div><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj kr"><img src="../Images/67b66c6bf3eeaa038b6c60ad568441ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zLiz6sl8UQ79tX1_"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动创建者</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="86bb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://github.com/vmware/versatile-data-kit" rel="noopener ugc nofollow" target="_blank">通用数据工具包</a> (VDK)是一个框架，用于将不同的数据源接收和操作到一个数据湖中。我已经在我的上一篇文章中讨论过VDK，所以关于它的介绍，你可以参考那里。</p><p id="771f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我将讨论如何在VDK中实现一个自定义插件。<strong class="lk jd">作为一个用例，我将实现一个简单的插件，它从现有的表中获取输入，并在其上执行数据格式化。为了展示插件是如何工作的，我将只实现一个简单的任务，从一个表的一列中取出一些字符串，并用另一个字符串替换它们。下图显示了我将要实现的数据格式化作业:</strong></p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj me"><img src="../Images/7e6178f9fd8b003ffa8dccb7a9c0e25a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0z4HEJYSzhH3-5uC00ABKQ.png"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><p id="4cc6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在左边的表中，同一个国家意大利出现了两个不同的名称，因此我将执行数据格式化，以得到一个同质的国家值，如右边的表所示。</p><p id="448c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了执行前面描述的任务，我将实现一个VDK插件，您可以如下调用:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="df94" class="mk ml it mg b gz mm mn l mo mp"><strong class="mg jd">vdk format-column</strong> -t my-table -c country -o "Italie,Italia" -d Italy</span></pre><p id="2f24" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中:</p><ul class=""><li id="5d79" class="mq mr it lk b ll lm lo lp lr ms lv mt lz mu md mv mw mx my bi translated"><code class="fe mz na nb mg b"> -t</code>选项指定要操作的表格</li><li id="409d" class="mq mr it lk b ll nc lo nd lr ne lv nf lz ng md mv mw mx my bi translated"><code class="fe mz na nb mg b">-c</code>选项指定要操作的列</li><li id="bd1b" class="mq mr it lk b ll nc lo nd lr ne lv nf lz ng md mv mw mx my bi translated"><code class="fe mz na nb mg b">-o</code>选项指定要替换的事件列表</li><li id="19c3" class="mq mr it lk b ll nc lo nd lr ne lv nf lz ng md mv mw mx my bi translated"><code class="fe mz na nb mg b">-d</code>选项指定目标值。</li></ul><p id="3ada" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了在VDK实现这个自定义插件，我将遵循下面描述的步骤:</p><ol class=""><li id="a432" class="mq mr it lk b ll lm lo lp lr ms lv mt lz mu md nh mw mx my bi translated">创建骨架</li><li id="4507" class="mq mr it lk b ll nc lo nd lr ne lv nf lz ng md nh mw mx my bi translated">配置插件</li><li id="4116" class="mq mr it lk b ll nc lo nd lr ne lv nf lz ng md nh mw mx my bi translated">配置作业</li><li id="2cf9" class="mq mr it lk b ll nc lo nd lr ne lv nf lz ng md nh mw mx my bi translated">测试和安装插件。</li></ol><h1 id="756a" class="ni ml it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">1.创建骨架</h1><p id="5837" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">为了创建插件的框架，我使用如下的<code class="fe mz na nb mg b">cookiecutter</code>:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="0abf" class="mk ml it mg b gz mm mn l mo mp"><strong class="mg jd">cookiecutter</strong> https://github.com/tozka/cookiecutter-vdk-plugin</span></pre><p id="4e12" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我运行前面的命令时，我需要回答一些问题:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj oe"><img src="../Images/72e754bb3f91a1cec860050988d937e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMEMLfmmlwyIt4P6acWnkQ.png"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><p id="15ec" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该过程完成后，将创建一个新目录。下图显示了所创建目录的树:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div class="gi gj of"><img src="../Images/97dc7a79a4c863717d8db1a3da373556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*3S1HMVLoOfsazLQK_w1lDg.png"/></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><p id="62ec" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">包含两个主目录:<code class="fe mz na nb mg b">src</code>和<code class="fe mz na nb mg b">tests</code>，以及三个文件:<code class="fe mz na nb mg b">README.md</code>、<code class="fe mz na nb mg b">requirements.txt</code>和<code class="fe mz na nb mg b">setup.py</code>。</p><p id="f8ba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我编辑<code class="fe mz na nb mg b">README.md</code>文件。我可以让<code class="fe mz na nb mg b">requirements.txt</code>保持原样，因为我不会添加任何特定的库。</p><p id="693a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我现在把重点放在插件配置上。</p><h1 id="4a55" class="ni ml it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">2配置插件</h1><p id="802d" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">我用编辑器打开了<code class="fe mz na nb mg b">setup.py</code>文件。在这个文件中，您可以指定插件的版本、名称、所需的包以及插件的入口点目录:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="d529" class="mk ml it mg b gz mm mn l mo mp">__version__ = "0.1.0"</span><span id="c4c4" class="mk ml it mg b gz og mn l mo mp">setuptools.setup(<br/> <strong class="mg jd">name="vdk-preprocessing",</strong><br/> version=__version__,<br/> url="https://github.com/vmware/versatile-data-kit",<br/> description="Versatile Data Kit SDK Preprocessing plugin to manipulate an already ingested table.",</span><span id="4d7f" class="mk ml it mg b gz og mn l mo mp"> long_description=pathlib.Path("README.md").read_text(),<br/> long_description_content_type="text/markdown",<br/> install_requires=["vdk-core"],<br/> package_dir={"": "src"},</span><span id="b6e1" class="mk ml it mg b gz og mn l mo mp"> packages=setuptools.find_namespace_packages(where="src"),</span><span id="2a6c" class="mk ml it mg b gz og mn l mo mp"> <strong class="mg jd">entry_points={"vdk.plugin.run": ["vdk-preprocessing =  vdk.plugin.preprocessing.preprocessing_plugin"]},</strong></span><span id="78f6" class="mk ml it mg b gz og mn l mo mp"> classifiers=[</span><span id="fc27" class="mk ml it mg b gz og mn l mo mp"> "Development Status :: 4 - Beta",<br/> "License :: OSI Approved :: Apache Software License",<br/> "Programming Language :: Python :: 3.7",<br/> "Programming Language :: Python :: 3.8",<br/> "Programming Language :: Python :: 3.9",<br/> "Programming Language :: Python :: 3.10",<br/> ],)</span></pre><p id="51bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我可以重命名目录的名称来反映我的项目的语义。最终的目录树应该如下所示:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div class="gi gj oh"><img src="../Images/de0ddc18690e7c3fa286e58592f026f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*tQ6fFrjN2EmLTXjf0hAvVQ.png"/></div></figure><p id="9055" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我已经将<code class="fe mz na nb mg b">plugin_entry.py</code>重命名为<code class="fe mz na nb mg b">preprocessing_plugin.py</code>，然后我在<code class="fe mz na nb mg b">preprocessing</code>中添加了一个<code class="fe mz na nb mg b">preprocessing_formatting_job</code>目录，在那里我放了一个<code class="fe mz na nb mg b">format_column_step.py</code>脚本。</p><p id="8b91" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我正在写剧本<code class="fe mz na nb mg b">preprocessing_plugin.py</code>。这个脚本定义了插件接口。在我的例子中，我将实现一个命令行插件，所以这里我必须定义插件的命令名，以及传递给命令的选项。在我的例子中，该命令将接收4个参数作为输入:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="bbe0" class="mk ml it mg b gz mm mn l mo mp"><strong class="mg jd">@click.command</strong>(<br/>  name="format-column",<br/>  help="Execute a SQL query against a configured database and format the table.",<br/>  no_args_is_help=True,<br/>)</span><span id="188f" class="mk ml it mg b gz og mn l mo mp"><strong class="mg jd">@click.option</strong>(<br/>  "-t",<br/>  "--table",<br/>  help="The name of the table.",<br/>  default="my_table",<br/>  type=click.STRING,<br/>)</span><span id="9276" class="mk ml it mg b gz og mn l mo mp"><strong class="mg jd">@click.option</strong>(<br/>  "-c",<br/>  "--column",<br/>  help="The column to format.",<br/>  default="my_column",<br/>  type=click.STRING,<br/>)</span><span id="57c0" class="mk ml it mg b gz og mn l mo mp"><strong class="mg jd">@click.option</strong>(<br/>  "-o",<br/>  "--occurrences",<br/>  help="The list of occurrences to modify separated by comma.",<br/>  default="",<br/>  type=click.STRING,<br/>)</span><span id="0a92" class="mk ml it mg b gz og mn l mo mp"><strong class="mg jd">@click.option</strong>(<br/>  "-d",<br/>  "--destination",<br/>  help="The target value.",<br/>  default="",<br/>  type=click.STRING,<br/>)</span><span id="c2c8" class="mk ml it mg b gz og mn l mo mp"><strong class="mg jd">@click.pass_context</strong></span></pre><p id="9d8d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以注意到，我需要将上下文传递给我的命令函数。</p><p id="ad9c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">VDK使用<code class="fe mz na nb mg b">hookimpl</code> decorators实现了一个插件，所以你可以参考<a class="ae lh" href="https://github.com/vmware/versatile-data-kit/tree/main/projects/vdk-plugins" rel="noopener ugc nofollow" target="_blank"> VDK官方文档</a>了解更多细节。</p><p id="e53f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦定义了选项，我就可以定义<code class="fe mz na nb mg b">format_column()</code>函数，它将接收它们:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="9f16" class="mk ml it mg b gz mm mn l mo mp"><strong class="mg jd">def format_column(ctx: click.Context, table: str, column: str, occurrences : str, destination : str):</strong><br/>  args = dict(table=table, column=column, occurrences=occurrences, destination=destination)<br/>  ctx.invoke(<br/>    run,<br/>    data_job_directory=os.path.dirname(format_column_step.__file__),<br/>    arguments=json.dumps(args),<br/>)</span></pre><p id="441e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">前面的函数只是调用运行任务的特定作业。</p><p id="c268" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我给VDK加上命令:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="6a3d" class="mk ml it mg b gz mm mn l mo mp">@hookimpl<br/><strong class="mg jd">def vdk_command_line(root_command: click.Group) -&gt; None:</strong><br/>   root_command.add_command(format_column)</span></pre><h1 id="8970" class="ni ml it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">3配置作业</h1><p id="ea1d" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">现在是配置格式化作业的时候了。这个作业只包含一个名为format_column.py的步骤。</p><p id="162b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我定义了一个名为ColumnFormatter的新类来执行该任务。在我的例子中，它搜索作为参数传递的表的列中的所有匹配项，并用目标值替换它:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="09b5" class="mk ml it mg b gz mm mn l mo mp">class <strong class="mg jd">ColumnFormatter</strong>:<br/>  def __init__(self, job_input: IJobInput):<br/>     self.__job_input = job_input</span><span id="2a80" class="mk ml it mg b gz og mn l mo mp">  def format_column(self, table: str, column: str, occurrences: list, destination : str):<br/>     for value in occurrences:<br/>        query = f"UPDATE {table} SET {column} = '{destination}' WHERE {column} = '{value}'; "<br/>       self.__job_input.execute_query(query)</span></pre><p id="c47a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe mz na nb mg b">ColumnFormatter</code>类必须包含一个<code class="fe mz na nb mg b">IJobInput</code>实例对象。</p><p id="b8a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我实现了<code class="fe mz na nb mg b">run()</code>函数，向VDK表明这是一个步骤:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="a5b1" class="mk ml it mg b gz mm mn l mo mp">def <strong class="mg jd">run(job_input: IJobInput) -&gt; None:<br/>   </strong>table = job_input.get_arguments().get("table")<br/>   column = job_input.get_arguments().get("column") <br/>   occurrences = job_input.get_arguments().get("occurrences").split(",")<br/>   destination = job_input.get_arguments().get("destination")</span><span id="7d55" class="mk ml it mg b gz og mn l mo mp">   formatter = ColumnFormatter(job_input)<br/>   formatter.format_column(table, column, occurrences,destination)</span></pre><p id="0133" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe mz na nb mg b">run()</code>函数只是检索命令行参数，并将它们传递给ColumnFormatter方法<code class="fe mz na nb mg b">format_column()</code>。</p><h1 id="d5d4" class="ni ml it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">4测试和安装插件</h1><p id="4c4f" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">插件准备好了。最后一步包括编写测试和安装插件。我更改了<code class="fe mz na nb mg b">tests</code>目录的默认结构，因为我将实现一个简单的测试。</p><p id="0578" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将测试编写为包含在测试目录中的脚本，如下图所示:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div class="gi gj oi"><img src="../Images/e4fd59fd0ea696a07252c59daedf617b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*VOe7dW7TGvCjVXwblnV02g.png"/></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><p id="3fb1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以编写任意多的测试。在这个例子中，我只编写了一个测试来展示它们是如何工作的。VDK使用<code class="fe mz na nb mg b">pytest</code>来执行测试。</p><p id="e845" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我编写了下面的测试:</p><ul class=""><li id="c6d7" class="mq mr it lk b ll lm lo lp lr ms lv mt lz mu md mv mw mx my bi translated">我使用<code class="fe mz na nb mg b">sqlite-query</code>插件创建了一个表格。我还用本文顶部显示的表中的值填充了该表(列town和country)</li></ul><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="d5fd" class="mk ml it mg b gz mm mn l mo mp">runner = <strong class="mg jd">CliEntryBasedTestRunner</strong>(sqlite_plugin, preprocessing_plugin)</span><span id="1b45" class="mk ml it mg b gz og mn l mo mp">runner.invoke(<br/>[<br/> "sqlite-query",<br/> "--query",<br/> "CREATE TABLE test_table (city TEXT, country TEXT)",<br/>]<br/>)</span><span id="e006" class="mk ml it mg b gz og mn l mo mp">mock_sqlite_conf = mock.MagicMock(SQLiteConfiguration)<br/>sqlite_ingest = IngestToSQLite(mock_sqlite_conf)<br/>payload = [<br/>{"city": "Pisa", "country": "Italie"},<br/>{"city": "Milano", "country": "Italia"},<br/>{"city": "Paris", "country": "France"},<br/>]</span><span id="3b54" class="mk ml it mg b gz og mn l mo mp">sqlite_ingest.ingest_payload(<br/> payload=payload,<br/> destination_table="test_table",<br/> target=db_dir,<br/>)</span></pre><p id="6261" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我使用了VDK提供的<code class="fe mz na nb mg b">CliEntryBasedTestRunner()</code>类来调用sqlite-query插件。</p><ul class=""><li id="2f49" class="mq mr it lk b ll lm lo lp lr ms lv mt lz mu md mv mw mx my bi translated">我调用vdk预处理插件，用值“意大利”替换国家列中出现的“意大利，意大利”</li></ul><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="af52" class="mk ml it mg b gz mm mn l mo mp">result = runner.invoke(["<strong class="mg jd">format-column</strong>", "--table", "test_table", "--column", "country", "--occurrences", "Italie,Italia", "--destination", "Italy"])</span></pre><ul class=""><li id="584c" class="mq mr it lk b ll lm lo lp lr ms lv mt lz mu md mv mw mx my bi translated">我检查输出。</li></ul><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="f7cb" class="mk ml it mg b gz mm mn l mo mp">result = runner.invoke(</span><span id="392e" class="mk ml it mg b gz og mn l mo mp">[<br/> "sqlite-query",<br/> "--query",<br/> "SELECT country FROM test_table",<br/>]<br/>)</span><span id="3787" class="mk ml it mg b gz og mn l mo mp">output = result.stdout<br/>assert output == (<br/>  "country\n"<br/>  "---------\n"<br/>  "Italy\n"<br/>  "Italy\n"<br/>  "France\n")</span></pre><p id="6717" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在你可以运行测试。首先，我安装软件包:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="14b5" class="mk ml it mg b gz mm mn l mo mp">pip install -e /path/to/vdk-preprocessing/</span></pre><p id="9b33" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后从<code class="fe mz na nb mg b">vdk-preprocessing</code>目录中:</p><pre class="ks kt ku kv gu mf mg mh mi aw mj bi"><span id="22d2" class="mk ml it mg b gz mm mn l mo mp">pytest</span></pre><p id="2b58" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果一切正常，你的测试应该是<code class="fe mz na nb mg b">PASSED</code>。</p><h1 id="8b6c" class="ni ml it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">摘要</h1><p id="c256" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">恭喜你！你刚刚学会了如何在VDK建立一个自定义插件！你可以在<a class="ae lh" href="https://github.com/vmware/versatile-data-kit/tree/main/projects/vdk-plugins" rel="noopener ugc nofollow" target="_blank"> VDK官方知识库</a>中找到更多关于VDK插件的信息。你也可以使用VDK已经有的插件！</p><p id="5666" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在我的<a class="ae lh" href="https://github.com/alod83/vdk-examples/tree/main/plugins/vdk-preprocessing" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到这篇文章中描述的例子的代码。</p><h1 id="07b2" class="ni ml it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">相关文章</h1><div class="oj ok gq gs ol om"><a rel="noopener follow" target="_blank" href="/handling-missing-values-in-versatile-data-kit-bb4f2a907b9c"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd jd gz z fq or fs ft os fv fx jc bi translated">处理通用数据工具包中的缺失值</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">关于如何使用VDK处理缺失值来构建数据管道的教程</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa lb om"/></div></div></a></div><div class="oj ok gq gs ol om"><a rel="noopener follow" target="_blank" href="/how-to-build-a-web-app-with-data-ingested-through-versatile-data-kit-ddae43b5f62d"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd jd gz z fq or fs ft os fv fx jc bi translated">如何使用通过多功能数据工具包获取的数据构建Web应用程序</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">关于如何构建Web应用程序的分步教程，结合了Streamlit Python库和通用数据…</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa lb om"/></div></div></a></div><div class="oj ok gq gs ol om"><a rel="noopener follow" target="_blank" href="/using-versatile-data-kit-to-ingest-and-process-data-from-rest-api-6e3e0660b791"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd jd gz z fq or fs ft os fv fx jc bi translated">使用通用数据工具包从REST API获取和处理数据</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">关于如何使用通用数据工具包(VDK)从REST API获取数据的教程，以及一些关于如何安装…</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pc l ox oy oz ov pa lb om"/></div></div></a></div><div class="oj ok gq gs ol om"><a rel="noopener follow" target="_blank" href="/from-raw-data-to-a-cleaned-database-a-deep-dive-into-versatile-data-kit-ab5fd992a02e"><div class="on ab fp"><div class="oo ab op cl cj oq"><h2 class="bd jd gz z fq or fs ft os fv fx jc bi translated">从原始数据到干净的数据库:对多功能数据工具包的深入研究</h2><div class="ot l"><h3 class="bd b gz z fq or fs ft os fv fx dk translated">使用通用数据工具包(VMware最近发布的一个框架)和Trino DB的完整示例</h3></div><div class="ou l"><p class="bd b dl z fq or fs ft os fv fx dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pd l ox oy oz ov pa lb om"/></div></div></a></div></div></div>    
</body>
</html>