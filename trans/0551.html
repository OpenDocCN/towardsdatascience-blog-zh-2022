<html>
<head>
<title>Deep Learning vs Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习vs线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-vs-linear-regression-ea74aca115ea#2022-02-22">https://towardsdatascience.com/deep-learning-vs-linear-regression-ea74aca115ea#2022-02-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/a17ececd479a7296fcadfbf791d9477c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tnX7ZorxxS4bO0SzdLCBBQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><a class="ae jd" href="https://unsplash.com/@mitifotos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">通产省</a>在<a class="ae jd" href="https://unsplash.com/s/photos/line?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="a433" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">机器学习问题中关于MLP和线性回归的理论差异和实例。</h2></div><p id="0dd8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们从一个简单的考虑开始:<strong class="kx jh">我们都喜欢神经网络</strong>。</p><p id="d23d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们喜欢它们，因为它们是<strong class="kx jh">直观的</strong>，大多数时候<strong class="kx jh">它们不需要领域知识</strong>，它们<strong class="kx jh">易于编码</strong>并且非常<strong class="kx jh">简单易懂。即使现在它们如此时髦和常用，它们也有相当长的历史了。</strong></p><p id="d366" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如今，由于硬件的改进，神经网络比以前快得多，也更容易开发。但是我们真的需要它们吗？</p><p id="58be" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这本笔记本中，我们将使用一种<strong class="kx jh">深度学习</strong>算法(多层感知器)，并将它与最简单、最直接的机器学习方法进行比较，即<strong class="kx jh">线性回归</strong>。在这篇文章的最后，我们将会更清楚什么时候我们真的需要深度学习，什么时候我们可以只使用一个非常简单的算法并侥幸成功。</p><p id="f735" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们从有趣的部分开始:</p><h1 id="b9c8" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">0.图书馆</h1><p id="1cb4" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在我们的例子中，我们将使用Python和一些非常著名的库(numpy，pandas，sklearn，…)。在开始复制粘贴代码之前，请<strong class="kx jh">将</strong>全部导入。</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><blockquote class="mu mv mw"><p id="5c87" class="kv kw mx kx b ky kz kh la lb lc kk ld my lf lg lh mz lj lk ll na ln lo lp lq ij bi translated">对于可视化部分，我使用了<strong class="kx jh"> plotly </strong>，因为它允许对我们正在做的事情进行3d可视化，并且是交互式的。对于机器学习部分来说，它真的不是必需的，所以你可以安全地避免安装它，跳过结果的可视化</p></blockquote><h1 id="057e" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">1.第一个例子</h1><p id="baa5" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在第一个例子中，我编造了一些<strong class="kx jh">二次</strong>相关数据。我为什么这么做？说明<strong class="kx jh">线性回归</strong>也可用于模拟<strong class="kx jh">多项式函数！但是我们会到达那里的。</strong></p><p id="0af0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们构建这个数据集:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="3142" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为可以看到目标是以下函数:</p><pre class="mo mp mq mr gt nb nc nd ne aw nf bi"><span id="6c2a" class="ng ls jg nc b gy nh ni l nj nk">t = c_0 +c_1*x+c_2*y+c_3*x*y</span></pre><p id="208e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我知道你在想什么:这个模型不完全是线性的。但是再想想:x和y基本上是同一个变量，所以可以认为是这样的东西:</p><pre class="mo mp mq mr gt nb nc nd ne aw nf bi"><span id="1d95" class="ng ls jg nc b gy nh ni l nj nk">t = c_0 +(c_1+c_2)*x+c_3*x*x</span></pre><p id="1771" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们还是好的。:)</p><p id="e251" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们绘制表面:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h2 id="8b3b" class="ng ls jg bd lt nl nm dn lx nn no dp mb le np nq md li nr ns mf lm nt nu mh nv bi translated">1.1线性回归</h2><p id="96f8" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">现在让我们定义我们的预测函数:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="b7af" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们编造了我们的数据，所以我们确切地知道参数，我们可以测试预测功能是否有效:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1918" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以看到，它的工作非常完美！我们继续吧。<br/>线性回归任务中使用的<strong class="kx jh">损失</strong> <strong class="kx jh">函数</strong>为均方误差，其表达式如下:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="0191" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是我们的损失函数<strong class="kx jh">梯度</strong>，我们希望将其设置为0:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1de1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于我们的“完美”解决方案，损失函数和梯度正确地为0:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="5718" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">线性回归</strong>任务的最优解如下:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="2d7b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">实现如下:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="8a3c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个方法非常有效！我说的完美是指<strong class="kx jh">我们唯一的不确定性是计算机在计算矩阵的逆矩阵和矩阵乘法时可能产生的数值误差</strong>，如果与机器学习算法的误差相比，这个误差低得离谱。</p><blockquote class="mu mv mw"><p id="9dd0" class="kv kw mx kx b ky kz kh la lb lc kk ld my lf lg lh mz lj lk ll na ln lo lp lq ij bi translated"><strong class="kx jh">注意</strong>:我们使用了整个数据集，但在这种情况下我们真的需要4个数据点，我们会得到同样精确的结果。</p></blockquote><h2 id="04b6" class="ng ls jg bd lt nl nm dn lx nn no dp mb le np nq md li nr ns mf lm nt nu mh nv bi translated">1.2深度学习</h2><p id="548c" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在深度学习算法中，我们正在做一些不同的事情。我们有数据，我们有多个处理输入数据的隐藏层，以及一个提供预测的输出节点。我们定义了一个介于0和1之间的得分函数，我们希望将它最大化。在我们的例子中，我们使用<strong class="kx jh"> R2 </strong>:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="24a1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们将此方法应用于我们正在考虑的数据集:</p><ol class=""><li id="6039" class="nw nx jg kx b ky kz lb lc le ny li nz lm oa lq ob oc od oe bi translated"><strong class="kx jh">让我们进行列车试运行:</strong></li></ol><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="6050" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.<strong class="kx jh">我们来看看比分:</strong></p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="8dd9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.<strong class="kx jh">我们来策划一下吧</strong>:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c265" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得分99.2%。这当然真的很好，但是与我们在之前的方法中看到的确切结果相比太糟糕了！</p><h2 id="93a1" class="ng ls jg bd lt nl nm dn lx nn no dp mb le np nq md li nr ns mf lm nt nu mh nv bi translated">1.3考虑因素</h2><p id="b7ba" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">如果你有一个线性或多项式问题，使用线性回归模型很容易解决。你不仅不需要神经网络，而且如果你使用神经网络而不是线性回归，你实际上会有更低的性能。</p><h1 id="cae1" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">2.第二个例子</h1><p id="7c16" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">让我们通过添加一个具有随机幅度的正弦函数来复杂化我们之前的情况:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="2d79" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们有:</p><pre class="mo mp mq mr gt nb nc nd ne aw nf bi"><span id="3e0d" class="ng ls jg nc b gy nh ni l nj nk">t = c_0 +c_1*x+c_2*y+c_3*x*y + Rsin(x)</span></pre><p id="60d5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其中R是-5和5之间的随机振幅。</p><h2 id="a90a" class="ng ls jg bd lt nl nm dn lx nn no dp mb le np nq md li nr ns mf lm nt nu mh nv bi translated"><strong class="ak"> 2.1线性回归:</strong></h2><p id="ce6e" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">如果你使用线性回归模型，你会得到和以前一样的结果。这意味着线性模型尽了最大努力，但损失仍然很可怕:(</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h2 id="92a1" class="ng ls jg bd lt nl nm dn lx nn no dp mb le np nq md li nr ns mf lm nt nu mh nv bi translated">2.2深度学习:</h2><p id="4f02" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">如果你使用深度学习，结果真的很低:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c271" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，R2=99.20%，与前一种方法的巨大损失相比，这是很大的损失。</p><h2 id="389a" class="ng ls jg bd lt nl nm dn lx nn no dp mb le np nq md li nr ns mf lm nt nu mh nv bi translated">2.3考虑因素</h2><p id="251d" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在这种情况下，模型不是多项式，而是受到随机正弦函数的干扰，我们得到的结果是<strong class="kx jh">线性模型</strong>工作很糟糕，而<strong class="kx jh">深度学习</strong>模型工作得很好。</p><h1 id="7aa4" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">3.计算时间</h1><p id="17c7" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在处理高维数据时，你真的想使用机器学习，甚至是回归问题。事实上，对一台计算机来说，对一个庞大的矩阵求逆是一件大事。</p><p id="acc7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们对一个不同维数的随机矩阵求逆:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="bab4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们画出你做这个反转需要的时间:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="ab3e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在深度学习环境中，你可以尝试使用一些卷积网络，找到一个数值解，这可能与解析解略有距离，但需要的时间更少。</p><h1 id="f807" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">4.结论</h1><p id="553e" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">结论永远是这样:<strong class="kx jh">先看看你的数据。</strong> <br/>如果你能注意到有一些“线性”或“多项式”的行为，不用担心深度学习。只需使用一些<strong class="kx jh">线性回归模型</strong>，你就会以非常低的(如果不是空的)误差完成你的工作。</p><p id="9a00" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果行为很奇怪，很难被认为是线性或多项式的，如果你有足够的数据，使用深度学习可能是有意义的。</p><p id="1deb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="ce33" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">A.在<a class="ae jd" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Linkedin </strong> </a>上关注我，我在那里发布我所有的故事<br/> B .订阅我的<a class="ae jd" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="kx jh">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae jd" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="kx jh">推荐会员</strong> </a>，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p></div></div>    
</body>
</html>