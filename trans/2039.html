<html>
<head>
<title>Feynman’s Restaurant Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">费曼的餐馆问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/feynmans-restaurant-problem-57121af0bb92#2022-05-09">https://towardsdatascience.com/feynmans-restaurant-problem-57121af0bb92#2022-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9822" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从RecSys的角度介绍和解决费曼的餐馆问题</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c64df8b77b83c9932296cc297a0ef8dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I8rtxMBYMyNfMsLm"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@shawnanggg?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> shawnanggg </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="5a40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你在度假，接下来的几天你将在太平洋的一个偏远岛屿上度过。这里有几家餐馆，你会喜欢品尝最地道的菜肴。你面临的问题是，先验的你不知道哪些餐厅是你要去享受的，哪些不是，你也找不到Yelp上的餐厅，所以你不能用别人的意见来决定去哪些餐厅。还有，餐馆的数量比你要在岛上呆的天数还多，所以你不可能试遍所有的餐馆，找到最好的一家。然而，由于你热爱数学，你决定寻找最佳策略来优化你的假期体验。这就是所谓的<strong class="ky ir">费曼餐厅问题</strong>。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="d499" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样的问题可以从餐厅的角度来解释，厨师想向客户推荐菜肴，但他们不知道客户会喜欢或不喜欢哪些菜肴。所以这个问题属于<strong class="ky ir">推荐系统的范畴。</strong>更一般地说，这是从一组评价未知的<em class="lz"> N </em>个项目中推荐<em class="lz"> M </em>个项目(有重复)的问题。</p><p id="a861" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章的内容很大程度上受到了<a class="ae kv" href="https://www.feynmanlectures.caltech.edu/info/solutions/restaurant_problem_sol_1.html" rel="noopener ugc nofollow" target="_blank">这个解决方案</a>的启发。我试图解释一些对我来说晦涩难懂的细节，我还添加了一些情节和代码，让我对这个问题有更多的直觉。<a class="ae kv" href="https://www.feynmanlectures.caltech.edu/info/other/Feynmans_Restaurant_Problem_Revealed.html" rel="noopener ugc nofollow" target="_blank">在这里</a>你可以阅读更多关于这个问题的历史。</p><h1 id="f98b" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">数学公式</h1><p id="6e8c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">让我们试着用数学来形式化这个问题。首先，让我们定义<em class="lz"> D </em>为你要在这个城市待的天数，定义<em class="lz"> N </em>为餐馆的数量。让我们假设你可以根据你的口味对所有的餐馆进行排名，让我们称<em class="lz"> r_i </em>对餐馆<em class="lz"> i </em>的排名。让我们假设你可以每天去同一家餐馆而不感到厌倦，这意味着如果你知道这个城市最好的餐馆，你会一直去那里。</p><p id="0151" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，因为你不能尝试这个城市的所有餐馆，所以你永远不会知道你是否去过最好的餐馆。</p><blockquote class="mx my mz"><p id="4c0e" class="kw kx lz ky b kz la jr lb lc ld ju le na lg lh li nb lk ll lm nc lo lp lq lr ij bi translated"><em class="iq">注意，你永远不会知道实际的评级ri。你只有在那一刻才知道一家餐厅是不是最好的。你可以对某个时刻你尝试过的餐馆进行排名，但是这个“部分”排名可能和“绝对”排名不一样。例如，如果你只尝试了10家餐馆中的4家，你可以得到排名</em> <code class="fe nd ne nf ng b"><em class="iq">[3, 2, 1, 4, ?, ?, ?, ?, ?, ?]</em></code> <em class="iq">，但实际排名可能是</em> <code class="fe nd ne nf ng b"><em class="iq">[5, 4, 3, 6, 1, 2, 7, 8, 9]</em></code> <em class="iq">。</em></p></blockquote><p id="88ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您想要优化的函数是</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/0a4d4c3ea1613f7ea7d4538b72c8a0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*oMF2dTlR_VXTtD6t9I6gVg.png"/></div></figure><p id="b800" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中<em class="lz"> r_i </em>是您在<em class="lz"> i </em>日去过的餐厅评分。</p><h1 id="9905" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">解决办法</h1><h2 id="dcfb" class="ni mb iq bd mc nj nk dn mg nl nm dp mk lf nn no mm lj np nq mo ln nr ns mq nt bi translated">分析的</h2><p id="c144" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">你在这个城市的每一天都有两种选择:(1)尝试一家新餐馆，或者(2)去你之前去过的最好的餐馆。我们可以把这个问题想成一个<em class="lz">探索-开发</em>问题，也就是说，你在第一个<em class="lz"> M </em>天探索这个城市，之后，在接下来的<em class="lz">D M</em>个晚上，你总是去那个时刻最好的地方。</p><p id="e258" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们可以将函数拆分为</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/91ee74433a9eeddd93313c3a4cce52ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*cntslVnps_Si7zMbKzoILQ.png"/></div></figure><p id="8233" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中<em class="lz"> b_M，N </em>是你在第<em class="lz"> M </em>天尝试过的最好餐厅的排名。</p><p id="5d07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们方程中唯一的自由参数是<em class="lz"> M </em>，所以你要求期望利润最大化的<em class="lz"> M </em>的值。这是</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/69017647bff97196310148053d4808bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPpa21Xl5Bfx4wt8snP_VA.png"/></div></div></figure><p id="f101" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于第一项，应用线性并知道<em class="lz"> &lt; r_i &gt; = (N+1)/2 </em>我们得到</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/4edcc24985085dba8c252ec4d1c7198e.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*3scAA2E-qTQbAecLe8bVgg.png"/></div></figure><p id="a2b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们需要计算<em class="lz"> ⟨b_M,N⟩ </em>，它是m从区间<em class="lz"> (1，N) </em>中抽取后得到的期望最大值。</p><p id="7288" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一方面，我们知道如果你只尝试一家餐馆，期望的排名是<em class="lz"> ⟨b_1,N⟩ = (N+1) / 2。</em>另一方面，如果你尝试了所有的餐馆，期望的最高排名当然是<em class="lz"> ⟨b_N,N⟩ = N. </em></p><p id="d38c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以计算出<em class="lz"> ⟨b_2,N⟩ </em>在这种情况下，只存在1对餐厅，其中2是最大值，即您选择餐厅<em class="lz"> (1，2)。</em>最多只有2对餐厅，即<em class="lz"> (1，3) </em>和<em class="lz"> (2，3) </em>。只有3对餐厅，其中最大值为4，即<em class="lz"> (1，4) </em>、<em class="lz"> (2，4) </em>、<em class="lz"> (3，4) </em>。诸如此类。总共有<em class="lz">N(n1)/2</em>个可能的对。因此</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/f47e9c754df44d38631b08497b04bd3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vBHVJOCkwjaR0B8yQ7w_kw.png"/></div></div></figure><p id="2d20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在考虑<em class="lz"> ⟨b_N−1,N⟩ </em>。这是，你尝试了城市里所有的餐馆，除了一家。在这种情况下，你会在<em class="lz">n1</em>种情况下参观最好的餐馆，只有一种情况下你会跳过最好的餐馆。因此，预期值为</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/fad6ad1ac51893d9846c615c20ecc803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yZ8XS0lKePl4EeQlX0Ew0Q.png"/></div></div></figure><p id="005b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从所有这些结果中，人们可以看出模式并猜测</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/84f5096af801016882fd3d6187b5cd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*8sM8aaK3unNAzrC6I9N7Xg.png"/></div></figure><p id="ea58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">把这些放在一起，我们终于有了</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/ec2bd24d085dc211c2b2dfdc434d2e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*cLaaweUtR2cKaaPpaPkWbg.png"/></div></figure><p id="1dd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其最大值在</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/9a44cd4b001b004f2669947ce8fce5db.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*ihH72s0rY2vdEyaynrZF6Q.png"/></div></div></figure><blockquote class="mx my mz"><p id="e8eb" class="kw kx lz ky b kz la jr lb lc ld ju le na lg lh li nb lk ll lm nc lo lp lq lr ij bi translated">注意，结果不依赖于n。这意味着你不关心城市里有多少不同的餐馆，这听起来——至少对我来说——有点违反直觉。</p><p id="75b1" class="kw kx lz ky b kz la jr lb lc ld ju le na lg lh li nb lk ll lm nc lo lp lq lr ij bi translated"><em class="iq">还要注意的是，如果你想在不降低预期利润的情况下尝试这个城市的所有餐馆，你需要在这个城市呆</em> D≥(N+1)^2/2−1 <em class="iq">天。因此，如果这个城市有10家餐馆，你需要在这个城市呆至少60天:头10天探索这个城市，在接下来的50天去最好的餐馆。</em> <strong class="ky ir">请不要用这些结果来计划你接下来的假期。</strong></p></blockquote><h2 id="037f" class="ni mb iq bd mc nj nk dn mg nl nm dp mk lf nn no mm lj np nq mo ln nr ns mq nt bi translated">数字的</h2><p id="f32e" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在上一节中，我们导出了问题的解析解。现在让我们运行一些模拟来获得关于这个问题的更多直觉。尤其令人惊讶的是，解决方案并不依赖于<em class="lz"> N </em>。所以让我们看看模拟是否支持这种说法。</p><p id="4c2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的代码片段，可以通过一组参数模拟预期利润<em class="lz"> ⟨F⟩ </em></p><pre class="kg kh ki kj gt oc ng od oe aw of bi"><span id="cead" class="ni mb iq ng b gy og oh l oi oj"><strong class="ng ir">import</strong> numpy <strong class="ng ir">as</strong> np<br/><br/><strong class="ng ir">def</strong> <strong class="ng ir">expected_profit</strong>(n_days: int, n_restaurants: int, n_experiments<strong class="ng ir">=</strong>10000):<br/>    """<br/>    Computes the average profit at each <br/>    possible m \in range(1, n_days) over n_experiments.<br/><br/>    :param n_days: number of times one can visit the restaurant.<br/>    :param n_restaurants: number of restaurants in the city.<br/>    :param n_experiments: number of experiments to perform.<br/>    """<br/><br/>    results <strong class="ng ir">=</strong> {}<br/><br/>    <strong class="ng ir">for</strong> m <strong class="ng ir">in</strong> range(1, n_days <strong class="ng ir">+</strong> 1):<br/>        results[m] <strong class="ng ir">=</strong> []<br/>        <strong class="ng ir">for</strong> i <strong class="ng ir">in</strong> range(n_experiments):<br/>            ranks <strong class="ng ir">=</strong> x <strong class="ng ir">=</strong> list(range(n_restaurants))<br/>            np.random.shuffle(ranks)<br/>            profit <strong class="ng ir">=</strong> sum(ranks[:m]) <strong class="ng ir">+</strong> (n_days <strong class="ng ir">-</strong> m) <strong class="ng ir">*</strong> max(ranks[:m])<br/>            results[m].append(profit)<br/>    results <strong class="ng ir">=</strong> {k: np.mean(v) <strong class="ng ir">for</strong> k, v <strong class="ng ir">in</strong> results.items()}<br/>    <strong class="ng ir">return</strong> results</span></pre><p id="b663" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用这个片段，我们生成了下面的图，使用了<em class="lz"> N=(100，110，120) </em>和<em class="lz"> D=10 </em>。注意三条曲线的最大值是如何重合的，这支持了违反直觉的分析结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e27ad9f55072271f5eef76f77b0cb23a.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*C4t3yuxBo5UtoxJHgxoTTQ.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">预期利润与勘探天数。<a class="ae kv" href="https://www.amolas.dev/posts/feynman-restaurant-problem/" rel="noopener ugc nofollow" target="_blank">原著</a>。</p></figure><h1 id="2a50" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">结论</h1><p id="6f75" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在本帖中，我们探讨了费曼的餐馆问题。首先，我们导出了最优探索策略的解析解，然后我们用一些模拟来检验解析结果。尽管这些结果从数学的角度来看是有意义的，但没有一个头脑正常的人会遵循最优策略。这很可能是由我们做出的不切实际的假设造成的，即:你不可能一生中每天都去同一家餐厅而不感到厌倦。一个可能的解决方案是改变一家餐馆的评级，使之与你去过的次数挂钩，即T21。然而，这超出了本文的范围，我们不打算这样做，但也许它可以作为另一篇文章的灵感。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="b549" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个故事最初贴在<a class="ae kv" href="https://www.amolas.dev/posts/feynman-restaurant-problem/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div></div>    
</body>
</html>