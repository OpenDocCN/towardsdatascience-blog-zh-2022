<html>
<head>
<title>How To Remove Unwanted Parts From Strings in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何去除熊猫身上不需要的部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-remove-unwanted-parts-from-strings-92ac881e60a2#2022-03-29">https://towardsdatascience.com/pandas-remove-unwanted-parts-from-strings-92ac881e60a2#2022-03-29</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="a5ef" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">在 Pandas 中从列中删除不需要的子字符串</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/0ec327846fbd17c13805c8da2f5879d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wGqRgZuz3vyCrmwo4yUP-A.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@paullywooten?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">波莱特·伍滕</a>在<a class="ae kz" href="https://unsplash.com/s/photos/lamps?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="8621" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当使用 pandas 时，我们通常需要执行一些预处理任务，以便将数据转换成所需的形式。作为这一步骤的一部分，通常需要执行的一项常见任务涉及到字符串列的转换，我们会消除一些不需要的部分。</p><p id="44c2" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的简短教程中，我们将讨论几种可能的方法，您最终可以应用于 pandas 数据帧，以便从某些列的字符串中删除任何不需要的部分。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="2148" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们创建一个示例 DataFrame，我们将在本文中引用它来演示一些概念，并展示如何在使用字符串列时获得预期的结果。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="cc13" class="la lb iu nc b gz ng nh l ni nj">import pandas as pd</span><span id="feac" class="la lb iu nc b gz nk nh l ni nj"><br/>df  = pd.DataFrame(<br/>    [<br/>        (1, '+9A', 100),<br/>        (2, '-1A', 121),<br/>        (3, '5B', 312),<br/>        (4, '+1D', 567),<br/>        (5, '+1C', 123),<br/>        (6, '-2E', 101),<br/>        (7, '+3T', 231),<br/>        (8, '5A', 769),<br/>        (9, '+5B', 907),<br/>        (10, '-1A', 15),<br/>    ],<br/>    columns=['colA', 'colB', 'colC']<br/>)<br/></span><span id="d41c" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><strong class="nc iv"><em class="nl">   colA colB  colC</em></strong><br/><em class="nl">0     1  +9A   100<br/>1     2  -1A   121<br/>2     3   5B   312<br/>3     4  +1D   567<br/>4     5  +1C   123<br/>5     6  -2E   101<br/>6     7  +3T   231<br/>7     8   5A   769<br/>8     9  +5B   907<br/>9    10  -1A    15</em></span></pre><p id="dacf" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">让我们假设我们想要转换存储在列<code class="fe nm nn no nc b">colB</code>下的数据，以便移除前缀符号<code class="fe nm nn no nc b">-/+</code>和后缀字母。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="2174" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">用熊猫。Series.str.replace()方法</h2><p id="d922" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated"><code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.replace.html" rel="noopener ugc nofollow" target="_blank">pandas.Series.str.replace()</a></code>方法可以用来替换<code class="fe nm nn no nc b">Series</code> / <code class="fe nm nn no nc b">Index</code>中每一次出现的模式/正则表达式。</p><p id="e25a" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在我们的例子中，我们可以指定一个正则表达式将所有非数字值替换成一个空字符串。因此，下面的表达式可以解决这个问题:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="36ba" class="la lb iu nc b gz ng nh l ni nj">df['colB'] = df['colB'].str.replace(r'\D', '')</span><span id="63d9" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><strong class="nc iv"><em class="nl">   colA colB  colC</em></strong><em class="nl"><br/>0     1    9   100<br/>1     2    1   121<br/>2     3    5   312<br/>3     4    1   567<br/>4     5    1   123<br/>5     6    2   101<br/>6     7    3   231<br/>7     8    5   769<br/>8     9    5   907<br/>9    10    1    15</em></span></pre><p id="8832" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在使用正则表达式时，这无疑是众多选择之一。我猜你可以变得很有创造性，但是这个正则表达式应该是我们特定用例中最直接的。</p><p id="9b20" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">另一个适合我们用例的选项是删除任何非整数字符:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="cafa" class="la lb iu nc b gz ng nh l ni nj">df['colB'].str.replace(r'[^0-9]', '')</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="893e" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">用熊猫。Series.str.extract()方法</h2><p id="e2fd" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在 pandas 中，从字符串中删除不需要的部分的另一个选择是<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.extract.html" rel="noopener ugc nofollow" target="_blank">pandas.Series.str.extract()</a></code>方法，该方法用于提取 regex pat 中的捕获组作为 DataFrame 中的列。</p><p id="3849" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在我们的例子中，我们将简单地提取字符串中我们希望保留的部分:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="22de" class="la lb iu nc b gz ng nh l ni nj">df['colB'] = df['colB'].str.extract(r'(\d+)', expand=False)</span><span id="d14a" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><strong class="nc iv"><em class="nl">   colA colB  colC</em></strong><em class="nl"><br/>0     1    9   100<br/>1     2    1   121<br/>2     3    5   312<br/>3     4    1   567<br/>4     5    1   123<br/>5     6    2   101<br/>6     7    3   231<br/>7     8    5   769<br/>8     9    5   907<br/>9    10    1    15</em></span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="03e1" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">用熊猫。Series.replace()方法</h2><p id="6b6c" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated"><code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.replace.html" rel="noopener ugc nofollow" target="_blank">pandas.Series.replace()</a></code>是另一种选择，与我们在本教程中讨论的第一种方法非常相似。该方法将把<code class="fe nm nn no nc b">to_replace</code>中给定的值替换为 value，并允许用户指定提供给<code class="fe nm nn no nc b">to_replace</code>的值是否应该解释为正则表达式。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="edbd" class="la lb iu nc b gz ng nh l ni nj">df['colB'] = df['colB'].replace(r'\D', r'', regex=True)</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="82ae" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用 map()方法</h2><p id="8a89" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">另一种选择是利用<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.map.html" rel="noopener ugc nofollow" target="_blank">map()</a></code>方法，该方法可用于根据输入映射或函数来映射熊猫<code class="fe nm nn no nc b">Series</code>的值。</p><p id="9a71" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在我们的具体示例中，我们可以使用<code class="fe nm nn no nc b">map()</code>来应用一个 lambda 函数，该函数从字符串的开头移除<code class="fe nm nn no nc b">+/-</code>，从字符串的结尾移除任何 ascii 字符。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="b388" class="la lb iu nc b gz ng nh l ni nj">from string import ascii_letters</span><span id="ec8f" class="la lb iu nc b gz nk nh l ni nj">df['colB'] = \<br/>    df['colB'].map(lambda x: x.lstrip('+-').rstrip(ascii_letters))</span><span id="8aa2" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><strong class="nc iv"><em class="nl">   colA colB  colC<br/></em></strong><em class="nl">0     1    9   100<br/>1     2    1   121<br/>2     3    5   312<br/>3     4    1   567<br/>4     5    1   123<br/>5     6    2   101<br/>6     7    3   231<br/>7     8    5   769<br/>8     9    5   907<br/>9    10    1    15</em></span></pre><p id="c123" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">同样，在处理这种类型的操作时，您可以变得非常有创造性，因此可以随意尝试最适合您的特定用例的方法。</p><p id="11b8" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">你也可以在我最近的一篇文章中读到更多关于<code class="fe nm nn no nc b">map()</code>、<code class="fe nm nn no nc b">apply()</code>和<code class="fe nm nn no nc b">applymap()</code> pandas 方法的内容。</p><div class="np nq gq gs nr ns"><a rel="noopener follow" target="_blank" href="/apply-vs-map-vs-applymap-pandas-529acdf6d744"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">熊猫中的 apply() vs map() vs applymap()</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">讨论 Python 和 Pandas 中 apply()、map()和 applymap()的区别</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kt ns"/></div></div></a></div><h2 id="1500" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用列表理解</h2><p id="0b1a" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当处理大型熊猫数据帧时，您应该始终考虑矢量化，因为这将极大地提高执行操作的效率。</p><p id="08be" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">大多数时候，字符串函数可能很难向量化，因此它们可能以迭代的方式执行(这<a class="ae kz" rel="noopener" target="_blank" href="/how-to-iterate-over-rows-in-a-pandas-dataframe-6aa173fc6c84">不是最好的方法</a>)。</p><p id="ca8e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">一个可能解决这个问题的好方法是列表理解。例如，代替<code class="fe nm nn no nc b">str.replace()</code>，我们可以使用<code class="fe nm nn no nc b">re.sub()</code>方法作为列表理解。</p><blockquote class="oh oi oj"><p id="701e" class="lw lx nl ly b lz mp jv mb mc mq jy me ok mr mg mh ol ms mj mk om mt mm mn mo in bi translated"><code class="fe nm nn no nc b"><a class="ae kz" href="https://docs.python.org/3/library/re.html#re.sub" rel="noopener ugc nofollow" target="_blank"><em class="iu">re.</em><strong class="ly iv"><em class="iu">sub</em></strong><em class="iu">(pattern, repl, string, count=0, flags=0)</em></a></code></p><p id="4537" class="lw lx nl ly b lz mp jv mb mc mq jy me ok mr mg mh ol ms mj mk om mt mm mn mo in bi translated">返回用替换<code class="fe nm nn no nc b"><em class="iu">repl</em></code>替换<code class="fe nm nn no nc b"><em class="iu">string</em></code>中<em class="iu">图案</em>最左边不重叠出现的<code class="fe nm nn no nc b"><em class="iu">string</em></code>。如果没有找到<code class="fe nm nn no nc b"><em class="iu">pattern</em></code>，则不变地返回<code class="fe nm nn no nc b"><em class="iu">string</em></code>。<code class="fe nm nn no nc b"><em class="iu">repl</em></code>可以是字符串，也可以是函数；如果它是一个字符串，其中的任何反斜杠转义都会被处理。</p></blockquote><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="32c2" class="la lb iu nc b gz ng nh l ni nj">import re</span><span id="ca1a" class="la lb iu nc b gz nk nh l ni nj">df['colB'] = [re.sub('[^0-9]', '', x) for x in df['colB']]</span></pre><p id="d5ec" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">或者，<code class="fe nm nn no nc b">str.extract()</code>方法可以用<code class="fe nm nn no nc b">re.search()</code>表示为列表理解:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="b6d0" class="la lb iu nc b gz ng nh l ni nj">import re</span><span id="7d38" class="la lb iu nc b gz nk nh l ni nj">df['colB'] = [re.search('[0-9]', x)[0] for x in df['colB']]</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的简短教程中，我们讨论了如何处理 pandas 数据帧，以便从包含 string 对象的列中截断任何不需要的部分。</p><p id="8a64" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">请注意，在对相当大的数据帧应用这种转换时，应该考虑每种方法的性能。性能通常因数据帧的大小而异，例如，一种方法在应用于小数据帧时可能最有效，但在应用于大数据帧时就不那么有效了。</p><p id="8b31" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">因此，尝试不同的方法并为您的特定用例应用最有效的方法总是有益的。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="np nq gq gs nr ns"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">通过我的推荐链接加入 Medium-Giorgos Myrianthous</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="ob l"><div class="on l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">相关文章你可能也喜欢</strong></p><div class="np nq gq gs nr ns"><a rel="noopener follow" target="_blank" href="/how-to-efficiently-convert-a-pyspark-dataframe-to-pandas-8bda2c3875c3"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">加快 PySpark 和 Pandas 数据帧之间的转换</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">将大火花数据帧转换为熊猫时节省时间</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oo l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/combine-two-string-columns-pandas-fde0287485d9"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何在熊猫中组合两个字符串列</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">了解如何在 pandas 数据框架中更有效地将两个字符串列连接成一个新列</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="op l od oe of ob og kt ns"/></div></div></a></div></div></div>    
</body>
</html>