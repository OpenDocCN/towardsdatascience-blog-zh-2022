<html>
<head>
<title>Advanced Tips on How to Read CSV Files into Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于如何将 CSV 文件读入熊猫的高级技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/advanced-tips-on-how-to-read-csv-files-into-pandas-84ebb170f6e5#2022-02-26">https://towardsdatascience.com/advanced-tips-on-how-to-read-csv-files-into-pandas-84ebb170f6e5#2022-02-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7045" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习 5 个小技巧，让你远离痛苦。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/341bfefffbf1c6bb198ccf11f1e420a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gZZVZDpSqu9rdy4-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@sam_truong?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sam Dan Truong </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="1a98" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">您的旅程概述</h1><ol class=""><li id="0f08" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><a class="ae ky" href="#5d0c" rel="noopener ugc nofollow">设置舞台</a></li><li id="d8fa" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#6fd9" rel="noopener ugc nofollow">以普通的方式导入 CSV 文件</a></li><li id="e9c5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#a6e8" rel="noopener ugc nofollow">第一个提示:仅导入选定的列</a></li><li id="57cb" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#2d13" rel="noopener ugc nofollow">第二个提示:处理真值和假值</a></li><li id="5dd4" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#b6fd" rel="noopener ugc nofollow">第三个技巧:偷看数据</a></li><li id="d35b" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#d5e9" rel="noopener ugc nofollow">第四个提示:设置索引列</a></li><li id="8ee7" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#37ac" rel="noopener ugc nofollow">第五个技巧:像专家一样处理缺失值</a></li><li id="4705" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#0e70" rel="noopener ugc nofollow">收尾</a></li></ol></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="5d0c" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">1 —搭建舞台</h1><p id="e221" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">在从事数据科学和数据分析工作时，<strong class="lt iu">将数据加载到熊猫</strong>中是令人难以置信的常见。有许多不同的格式需要考虑，如<em class="nn"> CSV 文件</em>、<em class="nn"> Excel 文件</em>、<em class="nn"> JSON 文件</em>、<em class="nn">原始文本文件</em>、<em class="nn">拼花文件</em>等。</p><p id="3635" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">说到 CSV 文件，你很快就知道熊猫可以用方法<code class="fe nt nu nv nw b">pd.read_csv()</code>轻松导入 CSV 文件。然而，鲜为人知的是可以传递给方法<code class="fe nt nu nv nw b">pd.read_csv()</code>的可选参数数量惊人。这给了你很大的定制！如果你认为我夸张了，看看下面熊猫文档的截图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/3bd7a58224d51539856e06621e4568ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmknCv35x-N3INq8ILQkbA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图来自<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/docs/reference/API/pandas . read _ CSV . html</a></p></figure><p id="573a" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">这是相当压倒性的，对不对？😧别担心，<strong class="lt iu">我会教你知道的最重要的 5 个</strong>。</p><p id="5da8" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">如果没有这些有用的可选参数，您将不得不做额外的预处理。这通常较慢，并且需要较高的计算成本。简而言之，这些可选参数中的一些可以节省大量时间，让你从枯燥的工作中解脱出来。</p><blockquote class="ny"><p id="ea72" class="nz oa it bd ob oc od oe of og oh me dk translated">告别不必要的预处理，向导入 CSV 文件的高效、干净的代码问好。</p></blockquote><p id="c403" class="pw-post-body-paragraph na nb it lt b lu oi ju nc lw oj jx nd ly ok nf ng ma ol ni nj mc om nl nm me im bi translated"><strong class="lt iu">先决条件:</strong>你应该已经安装了 Pandas，并且知道什么是 CSV 文件。除此之外，没有任何先决条件。我们走吧！</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="6fd9" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">2-以普通的方式导入 CSV 文件</h1><p id="6ca9" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">在您学习这些很酷的技巧之前，让我们确保您知道在 Pandas 中导入 CSV 文件的基本方法。假设您有一个名为<code class="fe nt nu nv nw b">employees.csv</code>的 CSV 文件，其中包含以下信息:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="23ba" class="or la it nw b gy os ot l ou ov">Name,Age,Wage<br/>Eirik,27,75000<br/>John,33,85000<br/>Janet,25,78000<br/>Phil,23,66000</span></pre><p id="1f8a" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">然后您可以用下面的代码片段将整个文件<code class="fe nt nu nv nw b">employees.csv</code>导入到 Pandas 中:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="d791" class="or la it nw b gy os ot l ou ov">import pandas as pd</span><span id="87b4" class="or la it nw b gy ow ot l ou ov">employees = pd.read_csv("filepath_to_employees.csv")</span></pre><p id="9948" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">你得到的数据帧<code class="fe nt nu nv nw b">employees</code>包含以下信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/7df897b2d1ba73820dfa028c75c48b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*8rpbbUuWhbpqPxeZMoV8xw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫数据帧从简单的 CSV 文件。</p></figure><p id="9ec2" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">上面的代码是在 Pandas 库中使用函数<code class="fe nt nu nv nw b">read_csv()</code>的最基本方法。<strong class="lt iu">导入整个 CSV 文件</strong>。</p><p id="8a53" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">如果 CSV 文件格式完美，没有丢失的值，并且您需要所有的列和行，这将非常有用。然而，实际上，对许多人来说，这些要求更像是白日梦，而不是现实。让我们看看如何使用可选参数来处理更复杂的情况🔥</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="a6e8" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">3 —第一个提示:仅导入选定的列</h1><p id="4ca4" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">通常，您只需要 CSV 文件中的一些列，而不是所有列。对此的一个解决方案是导入整个 CSV 文件，然后按如下方式过滤掉列:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="6470" class="or la it nw b gy os ot l ou ov">employees = pd.read_csv("filepath_to_employees.csv")<br/>employees = employees[["Name", "Wage"]]</span></pre><p id="a0b0" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">数据框<code class="fe nt nu nv nw b">employees</code>现在包含以下信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/01f1b76142f7d50e2a4dea617544b2cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:366/format:webp/1*DJDUQk4uWjID95iBssizxg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">包含选定列的熊猫数据框架。</p></figure><p id="12d8" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">虽然这种方法确实有效，但在代码长度和性能方面效率都很低。您导入了整个<code class="fe nt nu nv nw b">Age</code>列，但从未使用过它！</p><p id="ea1f" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">最好告诉函数<code class="fe nt nu nv nw b">read_csv()</code>只导入您需要的列。您可以使用可选参数<code class="fe nt nu nv nw b">usecols</code>来完成此操作，如下所示:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="3d39" class="or la it nw b gy os ot l ou ov">employees = pd.read_csv(<br/>  "filepath_to_employees.csv", <br/>  usecols=["Name", "Wage"]<br/>)</span></pre><p id="bf9e" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">这产生了完全相同的结果。避免导入大量不需要的数据，避免编写 Pandas 代码来过滤掉无用的列。那是一石二鸟😄</p><p id="02f3" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">参数<code class="fe nt nu nv nw b">usecols</code>通常期望您要导入的列名列表。但是，您也可以传递一个(通常是匿名的)函数来确定一个列是否被选中。有关这方面的更多信息，请查看<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank"> Pandas 文档</a>中的<code class="fe nt nu nv nw b">usecols</code>可选参数。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="2d13" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">第二个技巧:处理真值和假值</h1><p id="f261" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">CSV 文件通常包含指示某事物是真还是假的值。问题是，这种迹象可以有各种各样的味道。要查看示例，请考虑具有以下额外列的 CSV 文件<code class="fe nt nu nv nw b">employees.csv</code>:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="98bd" class="or la it nw b gy os ot l ou ov">Name,Age,Wage,Insurance<br/>Eirik,27,75000,Yes<br/>John,33,85000,No<br/>Janet,25,78000,yes<br/>Phil,23,66000,no</span></pre><p id="8d52" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">这个 CSV 文件中的真值有两个直接问题:</p><ul class=""><li id="7a05" class="lr ls it lt b lu no lw np ly oz ma pa mc pb me pc mg mh mi bi translated">CSV 文件使用单词<code class="fe nt nu nv nw b">Yes</code>和<code class="fe nt nu nv nw b">No</code>，而不是 Python 识别的关键字<code class="fe nt nu nv nw b">True</code>和<code class="fe nt nu nv nw b">False</code>。</li><li id="55ec" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me pc mg mh mi bi translated"><code class="fe nt nu nv nw b">Yes/yes</code>和<code class="fe nt nu nv nw b">No/no</code>既有小写也有大写。可能是 HR 员工手动输入的数据？无论如何，你都要考虑到这一点。</li></ul><p id="8512" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">通过做一个简单的导入语句，熊猫不知道单词<code class="fe nt nu nv nw b">Yes</code>和<code class="fe nt nu nv nw b">No</code>是什么意思:下面的代码</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="640b" class="or la it nw b gy os ot l ou ov">employees = pd.read_csv("filepath_to_employees.csv")</span></pre><p id="dcce" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">简单给出数据框架:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/acc1cd06020f4711070531ed44f06a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*GjVFTKWt0SOXse-4X1SIgA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有保险栏的数据框很难处理。</p></figure><p id="6fe5" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">现在，根据<code class="fe nt nu nv nw b">Insurance</code>列中的值过滤列非常麻烦。</p><p id="6025" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">您可以使用<code class="fe nt nu nv nw b">map()</code>功能手动重命名<code class="fe nt nu nv nw b">Insurance</code>列中的值。然而，如果你已经在博文中走到这一步，你就知道这不是办法。</p><p id="a118" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">最好的处理方式是在函数<code class="fe nt nu nv nw b">read_csv()</code>中使用可选参数<code class="fe nt nu nv nw b">true_values</code>和<code class="fe nt nu nv nw b">false_values</code>。两个参数都只需要一个单词列表，这些单词应该被翻译成 Python 关键字<code class="fe nt nu nv nw b">True</code>和<code class="fe nt nu nv nw b">False</code>:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="f25b" class="or la it nw b gy os ot l ou ov">employees = pd.read_csv(<br/>    "filepath_to_employees.csv", <br/>    true_values=["Yes", "yes"], <br/>    false_values=["No", "no"]<br/>)</span></pre><p id="e3e7" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">数据帧现在看起来如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/c88082ff3eae1001c7bc9c83e8e304fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*R6Tbaa-5Y6__XFelhuMrfQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有保险栏的数据框易于操作。</p></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="b6fd" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">5 —第三个技巧:查看数据</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/1e579e7d125b1ec37d0c454aa593bba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*efGyBeUAFxlkG2DO"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@ratushny?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Dmitry Ratushny </a>拍摄的照片</p></figure><p id="386e" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">这是一个短的。如果您有一个巨大的 CSV 文件，但只想看一眼数据，那么加载整个文件是一个巨大的时间浪费。相反，您可以使用可选参数<code class="fe nt nu nv nw b">nrows</code>来指定应该读入多少行 CSV 文件。</p><p id="84b1" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">让我们考虑下面这个简单的 CSV 文件<code class="fe nt nu nv nw b">numbers.csv</code>:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="1d0e" class="or la it nw b gy os ot l ou ov">Numbers,Squares<br/>1,1<br/>2,4<br/>3,9<br/>4,16<br/>5,25<br/>6,36<br/>7,49<br/>8,64<br/>9,81<br/>10,100<br/>.<br/>.<br/>.<br/>1000000,1000000000000</span></pre><p id="1045" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">这是一个包含 1.000.000 个数字的文件。我知道这很做作，但它是一个很好的例子。下面的代码将只导入 1.000 行:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="58c8" class="or la it nw b gy os ot l ou ov">numbers = pd.read_csv(<br/>  "filepath_to_numbers.csv",<br/>  nrows=1000<br/>)</span></pre><p id="46a7" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">此代码仅挑选出前 1000 行，您将获得数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/b61f1751032bf2249b37ae0263beda95.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*Cj7bTnMY7IK2PsoMxIkYRQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">前 1000 行。</p></figure><p id="eba1" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">通常，选择这样的样本就足以探索数据。</p><blockquote class="ph pi pj"><p id="b319" class="na nb nn lt b lu no ju nc lw np jx nd pk nq nf ng pl nr ni nj pm ns nl nm me im bi translated"><strong class="lt iu">注意:</strong>如果您正在导入的数据是以某种方式排序的(如时间序列)，那么导入前 1000 行可能会使数据呈现出非常扭曲的画面。</p></blockquote><p id="ee46" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">在上面的例子中，您可能还想将索引列设置为 CSV 文件中的<code class="fe nt nu nv nw b">Numbers</code>列。现在的数据框架有很多冗余信息。这是下一个提示！</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="d5e9" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">6 —第四个技巧:设置索引列</h1><p id="50f4" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">考虑<code class="fe nt nu nv nw b">numbers</code>数据帧</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/b61f1751032bf2249b37ae0263beda95.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*Cj7bTnMY7IK2PsoMxIkYRQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">索引列和数字列本质上是相同的。</p></figure><p id="47ae" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">有时您希望将一个列(在本例中是<code class="fe nt nu nv nw b">Numbers</code>列)设置为索引列。这在时间序列数据中经常发生，其中事件的时间是索引数据的一个很好的列。Pandas 将默认创建自己的索引列。但是，您可以通过使用可选参数<code class="fe nt nu nv nw b">index_col</code>来决定自己的索引列，如下所示:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="9f0c" class="or la it nw b gy os ot l ou ov">numbers = pd.read_csv(<br/>  "filepath_to_numbers.csv",<br/>  nrows=1000,<br/>  index_col="Numbers"<br/>)</span></pre><p id="3b5a" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">使用此代码，您将获得以下数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/6f00f721a211da670524c51d08594baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*XWrfa--2httHQphdLx6ePg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Numbers 列现在是索引。</p></figure><p id="8535" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">可选参数<code class="fe nt nu nv nw b">index_col</code>通常需要一个与 CSV 文件中的列名相对应的字符串。然而，如果你传入一个字符串列表，那么你会得到一个<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html" rel="noopener ugc nofollow" target="_blank"> Pandas MultiIndex </a>👍</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="37ac" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">第五个技巧:像专家一样处理缺失值</h1><p id="2590" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">熊猫功能<code class="fe nt nu nv nw b">read_csv()</code>不傻。每当 CSV 文件中的条目具有值<strong class="lt iu"> NULL </strong>、<strong class="lt iu"> NaN </strong>或<strong class="lt iu"> n/a </strong>，则<code class="fe nt nu nv nw b">read_csv()</code>会将该值解释为缺失。在<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank"> read csv 文档</a>中有一个 Pandas 将识别为缺失的值的完整列表。很聪明，对吧？</p><p id="6b28" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">然而，有时 CSV 文件包含微妙格式的缺失值。让我们回头看看你在博文中提到的<code class="fe nt nu nv nw b">employees.csv</code>文件:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="ae20" class="or la it nw b gy os ot l ou ov">Name,Age,Wage<br/>Eirik,27,75000<br/>John,33,85000<br/>Janet,25,78000<br/>Phil,23,66000</span></pre><p id="1467" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">现在让我们假设一个叫“Sarah”的新员工即将开始工作。但是，她的新工资尚未被 HR 登记，因此在输入正确的金额之前，该工资将被设置为零:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="8806" class="or la it nw b gy os ot l ou ov">Name,Age,Wage<br/>Eirik,27,75000<br/>John,33,85000<br/>Janet,25,78000<br/>Phil,23,66000<br/>Sarah,25,0</span></pre><p id="8382" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">显然，Sarah 的工资应该被认为是一个缺失值，因为它还没有被写入系统。然而，熊猫不会理解这一点，只会简单地把它当作莎拉是一个拿“经验”报酬的实习生😡</p><p id="2497" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">对此的一个解决方案是在数据导入后过滤掉工资为零的员工。但是，正如您现在所期望的，您可以在<code class="fe nt nu nv nw b">read_csv()</code>函数中使用一个可选参数。如下使用可选参数<code class="fe nt nu nv nw b">na_values</code>:</p><pre class="kj kk kl km gt on nw oo op aw oq bi"><span id="9f0d" class="or la it nw b gy os ot l ou ov">employees = pd.read_csv(<br/>    "path_to_employees.csv",<br/>    na_values=["0"]<br/>)</span></pre><p id="1fbb" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">现在，数据框架已经正确地将 Sarah 的工资识别为丢失:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/7caf818ccfe8692005801b5fd7d77959.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*tLak7MeyU6wSwc-2gYbwWg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">莎拉的工资被正确地认定为失踪。</p></figure><p id="d091" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">如果您想将更多的值标记为缺失，那么只需将它们提供给传递给<code class="fe nt nu nv nw b">na_values</code>参数的列表。</p><blockquote class="ph pi pj"><p id="1a2e" class="na nb nn lt b lu no ju nc lw np jx nd pk nq nf ng pl nr ni nj pm ns nl nm me im bi translated"><strong class="lt iu">警告:</strong>如果您的其他列中有一列的有效值为零，那么这种方法也会将它们标记为缺失。不太好。为了避免这种情况，你也可以传递一个字典给<code class="fe nt nu nv nw b">na_values</code>。字典的键是有问题的列名(在您的例子中是“工资”)，值是缺少的值(在您的例子中是“0”)。运行 Pandas 的<code class="fe nt nu nv nw b">info()</code>方法来检查您没有引入错误的缺失值总是一个很好的明智检查。</p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="0e70" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">8 —总结</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/90d641f0142a7e585c94054d9ed04b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TQtgscSn3y_-3hxZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Joshua Hoehne 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="494a" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">我已经向您展示了在 Pandas 中导入 CSV 文件的 5 个技巧。我希望你学到了一些新东西，并且能够在未来的项目中使用。如果你需要知道更多，那么看看熊猫文档。</p><p id="ae0f" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated"><strong class="lt iu">喜欢我写的？</strong>查看我的其他帖子，了解更多 Python 内容:</p><ul class=""><li id="0a07" class="lr ls it lt b lu no lw np ly oz ma pa mc pb me pc mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1">用漂亮的类型提示使你罪恶的 Python 代码现代化</a></li><li id="6a45" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me pc mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/visualizing-missing-values-in-python-is-shockingly-easy-56ed5bc2e7ea">用 Python 可视化缺失值非常简单</a></li><li id="4af6" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me pc mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/introducing-anomaly-outlier-detection-in-python-with-pyod-40afcccee9ff">使用 PyOD 在 Python 中引入异常/异常值检测🔥</a></li><li id="d73d" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me pc mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/5-awesome-numpy-functions-that-can-save-you-in-a-pinch-ba349af5ac47"> 5 个能在紧要关头救你的牛逼数字功能</a></li><li id="3c73" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me pc mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/5-expert-tips-to-skyrocket-your-dictionary-skills-in-python-1cf54b7d920d"> 5 个专家提示，让你的 Python 字典技能一飞冲天🚀</a></li></ul><p id="1138" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">如果你对数据科学、编程或任何介于两者之间的东西感兴趣，那么请随意在 LinkedIn 上加我，并向✋问好</p></div></div>    
</body>
</html>