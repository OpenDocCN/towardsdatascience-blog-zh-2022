<html>
<head>
<title>An Introduction To Supervised Encoding Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">监督编码方法介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-supervised-encoding-methods-add83390686f#2022-09-12">https://towardsdatascience.com/an-introduction-to-supervised-encoding-methods-add83390686f#2022-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c783" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索使用标记数据转换分类特征</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/255d1e700b96bd190ff7749cfcb54bac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1O0RTWlZGD1VxKwmD81Ulw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">luis gomes的照片:<a class="ae ky" href="https://www.pexels.com/photo/close-up-photo-of-programming-of-codes-546819/" rel="noopener ugc nofollow" target="_blank">https://www . pexels . com/photo/close-up-photo-of-programming-of-codes-546819/</a></p></figure><p id="3589" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像one hot编码和ordinal编码这样的编码技术目前主导着数据科学领域。它们是无监督的方法，这意味着它们仅基于分类特征的值来转换分类特征。</p><p id="11b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说，还有一个不太知名的编码方法分支:<strong class="lb iu">监督编码方法</strong>。监督编码方法需要使用目标标签来导出分类数据的数字表示。</p><p id="e286" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前有大量的文献支持某些监督编码方法，因此值得掌握使用目标标签对分类特征进行编码的概念。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="4efb" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">使用目标标注对要素进行编码</h2><p id="d392" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">对于那些习惯于只使用像一个热编码这样的无监督编码方法的人来说，使用目标标签来编码值可能看起来像一个陌生的概念。</p><p id="7172" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为介绍，我们可以进行一种最简单的监督编码方法:<strong class="lb iu">目标编码</strong>。目标编码需要用相应目标标签的平均值来表示类别。</p><p id="9fbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用下面的虚拟数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/f793a31331bc812d6cfc07bae89ea0f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*QS_x0dmCU9LAfLSXMyWYpg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="e777" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，每种水果都有相应的目标。在这种情况下，我们将数据按水果分组，并找出每种水果的平均价格。这些平均值将用于表示水果类别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/4338c5ff4cccf23ab436a5d79fbb2e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*K4CFqfaT-opZfvpsHPDO4w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="a2df" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">利益</h2><p id="252a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">使用标记数据对分类特征进行编码的优势一目了然。</p><p id="092e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，编码方法直观且易于执行。</p><p id="a08a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它还使用户能够在不增加数据集中列数的情况下转换分类特征。在这方面，监督编码方法优于像热编码这样的方法，热编码容易受到维数灾难的影响。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="5ca1" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">缺点</h2><p id="2e14" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">像任何技术一样，监督编码方法也有自己的缺点。</p><p id="629a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，用这种方法建立的模型容易过度拟合。毕竟，分配给分类特征的数值完全取决于目标标签在训练集中的分布，因此存在用此数据训练的模型不能用看不见的数据正确概括的风险。</p><p id="7e39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，监督编码方法可能不足以代表少数类别。</p><p id="43e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，如果监督编码方法执行不当，随后的模型将遭受数据泄漏，这可能发生在数据被分割之前的<em class="nc">应用变换时。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="8bd8" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">潜在的解决方案</h2><p id="17d8" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">自然，那些寻求解决监督编码方法风险的人有许多工具和技术可供他们使用。</p><p id="1e9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户可以将某种形式的正则化合并到他们的转换中。他们可以应用平滑技术，这需要在类别平均值和全局平均值之间指定一个值。另一种选择是将高斯噪声添加到训练数据中，以减轻模型过拟合。</p><p id="2867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户也可以选择使用更复杂的编码方法。毕竟，像目标编码这样的技术是建立在过于简单的逻辑之上的，可能不适合编码特性。替代目标编码的一个例子是<strong class="lb iu">留一个编码</strong>，这需要取除当前行之外的所有行的目标标签的平均值。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="0d48" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">Python中的监督编码</h2><p id="4d3c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">现在的大问题是:我们如何将监督编码方法纳入我们的特征工程程序？</p><p id="369e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于Python用户来说，<a class="ae ky" href="https://contrib.scikit-learn.org/category_encoders/" rel="noopener ugc nofollow" target="_blank"> category_encoders </a>包提供了各种监督和非监督转换器，可用于对分类特征进行编码。</p><p id="5deb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，该包中的变压器与Scikit Learn管道兼容，因此它们可以与其他功能工程工具结合使用！</p><p id="a524" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，这个包是那些希望使用监督编码方法来转换分类特征的人的天赐之物。</p><p id="8fd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将使用他们的一个转换器来执行目标编码。让我们使用相同的虚拟数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c56bb63c9dc5de01036cb796331205be.png" data-original-src="https://miro.medium.com/v2/resize:fit:294/format:webp/1*w7N-Lp9Znuw9LOVf_JIPUQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="17fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们可以创建一个<code class="fe ne nf ng nh b">TargetEncoder</code>对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="8724" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意<code class="fe ne nf ng nh b">smoothing</code>超参数当前设置为0。这意味着在变换中不会应用平滑。</p><p id="8135" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以使用这个对象来转换虚拟数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/cc4deb2c931e9ed9d8f557d920a4208a.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*Sgw73KnhjnKaIHW6FHCskw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="54cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以使用这个转换器为看不见的数据编码。假设我们正在使用下面的测试集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/45cdffab4287c855c875821a21d01dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:194/format:webp/1*D7rcAe8hHjIElPoJy7tkUw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建)</p></figure><p id="cd68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ne nf ng nh b">TargetEncoder</code>对象可以使用来自训练数据的参数为测试数据中的每个类别分配数值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/3626635bafe90ae7057bd3fdbc76efda.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*9Adw-uQ27DxMIhxMKIW2AA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="7d0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意,“Apple”和“Orange”类别的赋值与它们在训练数据中的赋值相同，而“Grape”类别的赋值是目标标签的全局平均值。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="34e6" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">结论</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/d12d09c0308d29897263378d84b1035b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E-7_z1hBgFGb7TCz"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@prateekkatyal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="565b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然本文没有探索监督编码方法的能力，但是它已经让您熟悉了使用目标标签来转换分类特征的想法。</p><p id="b745" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终，像热编码这样的无监督技术可以完成这项工作，但它们并不总是理想的选择。一般来说，最好不要依赖某些技术，总是愿意探索相同问题的新解决方案。</p><p id="113c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我祝你在数据科学的努力中好运！</p></div></div>    
</body>
</html>