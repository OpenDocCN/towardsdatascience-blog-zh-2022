<html>
<head>
<title>How You Can Make Pandas Joins 5 Times Faster</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何让熊猫加入速度提高5倍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-you-can-make-pandas-joins-5-times-faster-3ef0d157e70b#2022-05-19">https://towardsdatascience.com/how-you-can-make-pandas-joins-5-times-faster-3ef0d157e70b#2022-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9c9c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">pd.merge()的更快替代方案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1020ed3244c233a7e650d6e9b0221af7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vf6EroTIlpTCd4oR"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">乔纳森·彼得森在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="90e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">处理真实世界的数据集一直吸引着数据科学家去大规模构建优化、高效和准确的系统。毫无疑问，优化是构建现实世界软件解决方案成功的关键。虽然我知道不是每个人都在大规模地构建解决方案，但是了解优化技术仍然是有帮助的，甚至适用于一般的数据科学用例。</p><p id="e230" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，在这篇文章中，我将考虑Pandas中最受欢迎的函数之一，即<strong class="ky ir">连接、</strong>，并通过实验证明分享如何优化Pandas合并操作近5倍。如果你对熊猫的加入不熟悉，我强烈推荐<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html?highlight=merge#pandas.DataFrame.merge" rel="noopener ugc nofollow" target="_blank">这篇</a>文章，以便在继续下一步之前了解它们。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="258b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">实验1:使用pd.merge()</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/f8c4b2b0ef53945831b1e0d56e058ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNS7ul9CW0MjGfgRJa5yNA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">pd.merge的代码片段(作者使用snappify.io创建的图像)</p></figure><p id="939c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们创建两个虚拟数据帧，并使用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.merge.html" rel="noopener ugc nofollow" target="_blank"> pd.merge() </a>函数合并它们——显式地指定对哪些列执行合并操作。</p><h1 id="785a" class="lz ma iq bd mb mc ms me mf mg mt mi mj jw mu jx ml jz mv ka mn kc mw kd mp mq bi translated">实验2:索引列并使用df.join()</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/7fc7ce8c7fbd6d54bde17d5d75079883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krvpRqoIOGm6-ed834WuzQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">pd.join的代码片段(作者使用snappify.io创建的图像)</p></figure><p id="cfc0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似于实验1，我们创建两个虚拟数据帧。然而，我们不是直接进行连接，而是首先索引数据帧，然后采用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html?highlight=join#pandas.DataFrame.join" rel="noopener ugc nofollow" target="_blank"> J </a> OIN方法来合并数据帧。</p><h1 id="9383" class="lz ma iq bd mb mc ms me mf mg mt mi mj jw mu jx ml jz mv ka mn kc mw kd mp mq bi translated">实验设置:</h1><ul class=""><li id="9390" class="my mz iq ky b kz na lc nb lf nc lj nd ln ne lr nf ng nh ni bi translated">在两个实验中，即实验1和实验2，两个数据帧都具有相同数量的行和两列，其中一列用于连接数据帧。</li><li id="a374" class="my mz iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">我考虑了不同大小的数据帧，从100万行到1000万行，每次实验都将行数增加100万。</li><li id="c98d" class="my mz iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">我在固定数量的行上重复了十次实验性试验，以消除任何随机性。</li><li id="58ef" class="my mz iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">下面，我报告了这十次试验中合并操作的平均运行时间。</li></ul><h1 id="7c96" class="lz ma iq bd mb mc ms me mf mg mt mi mj jw mu jx ml jz mv ka mn kc mw kd mp mq bi translated">结果:</h1><p id="dc9d" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf no lh li lj np ll lm ln nq lp lq lr ij bi translated">现在，是时候给出令人难以置信的结果了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/9a561abe4bc64f6852160403dc011866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wWZXMNBxyV4X6XV-9sAuHQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">描述连接操作运行时的实验结果(图片由作者创建)</p></figure><ul class=""><li id="4df4" class="my mz iq ky b kz la lc ld lf ns lj nt ln nu lr nf ng nh ni bi translated">上面的图描述了实验1中执行合并操作和实验2中执行(索引+合并)操作所花费的时间(以毫秒为单位)。</li><li id="bc4a" class="my mz iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">正如我们从图中看到的，两个实验的运行时间有很大的不同——实验2的速度接近实验1的5倍。</li><li id="676c" class="my mz iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">随着数据帧大小的增加，两个实验的运行时间之间的差异也增加。这表明索引应该始终是您处理较大数据集的方式。</li><li id="056a" class="my mz iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">两个连接操作<em class="nv">几乎都随着数据帧的大小而线性增加。然而，实验2的运行时间增加的速率远低于实验1。</em></li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="5616" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我强烈建议阅读这篇文章的每个人立即停止使用pd.merge()来执行连接操作，尤其是如果您正在处理大量数据的话。</p><p id="5ac0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。我希望这篇文章是有帮助的。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/cc53c5b1e281148f7c26b2b788aa01b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*6rRM17bxa9-HQYUiMQYHtw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者创造的模因</p></figure></div></div>    
</body>
</html>