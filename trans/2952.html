<html>
<head>
<title>Energy Management Using Real-Time Non-Intrusive Load Monitoring</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用实时非侵入式负载监控的能量管理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/energy-management-using-real-time-non-intrusive-load-monitoring-3c9b0b4c8291#2022-06-28">https://towardsdatascience.com/energy-management-using-real-time-non-intrusive-load-monitoring-3c9b0b4c8291#2022-06-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6117" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在边缘使用机器学习构建可持续清洁能源的关键组成部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f660dc3e80f6382bde029cde1f38a159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R4_2wH8wfnnMaZWI"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">罗伯特·林德在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="17d9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="129e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">非侵入式负载监测(NILM)的目标是从总电源信号中恢复单个设备的能耗，总电源信号是建筑物或房屋总耗电量的一种度量。NILM也被称为能量分解，这两个术语将在本文中互换使用。</p><p id="9302" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">R.Gopinath等人在论文<em class="mp">中很好地总结了NILM背后的理性:使用非侵入式负载监控技术的能源管理——最新技术和未来研究方向:</em></p><blockquote class="mq mr ms"><p id="1247" class="lo lp mp lq b lr mk jr lt lu ml ju lw mt mm lz ma mu mn md me mv mo mh mi mj ij bi translated">近年来，发展智能可持续城市已成为城市规划者和决策者负责任地利用资源、保护环境和改善社会福祉的首要重点。能源管理是智能可持续城市发展方案的一个组成部分，该方案涉及有意识和有效地利用现有能源资源，以实现能源系统的可持续性和自力更生。建筑行业是使用能源较多的关键行业之一。因此，人们正在努力有效地监控和管理住宅和商业建筑中的能源消耗。近年来，非侵入式负荷监测(NILM)技术已成为一种流行的新兴方法，用于使用单个电能表来监测建筑物中电器/电力设施的事件(开/关)和能耗。关于电器级别的能量消耗的信息将帮助消费者了解他们的电器使用行为，并采取必要的步骤来减少能量消耗。</p></blockquote><p id="10ff" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">通过使用在公开可用的数据集上训练的深度学习模型，现在可以通过利用商用硬件和开源软件以非常经济高效的方式实现NILM。在电网的边缘，即建筑物层，部署训练模型导致额外的成本节约，因为它消除了对总是连接的互联网云服务的需要，这在规模上可能是昂贵的，并且实时运行算法提供了低延迟操作。</p><p id="8e4d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这篇文章将向你展示NILM是如何工作的，带你完成我在家里实现一个原型系统的步骤。</p><h1 id="6372" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">体系结构</h1><p id="7a0b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">下面的前两个图表从较高的层面说明了NILM的概念和流程步骤。最后一张图展示了我的原型系统，它基于这些概念，并使用基于Arduino和Raspberry Pi的计算来实现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/13c0cbfd8bd022dfdd8e3e58dfa08d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aDz94wcT-6v7r-P8M_CF_w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一般NILM概念(R. Gopinath等人)</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/f1b13748c60e9bc9d55e54b7328afcc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dWzCGBnu9PgDoyXoDoVQg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">NILM过程步骤(R. Gopinath等人)</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/911b5d90bb540ebd247a4b9bfe7b4c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9VMCxcaVxcTdf5wHI9_IQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">NILM原型系统框图</p></figure><h1 id="e10f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">NILM算法选择和模型训练</h1><h2 id="efac" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">算法选择</h2><p id="1eea" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">能量分解是一个非常欠定的单通道盲源分离(BSS)问题，这使得很难获得准确的预测。您需要从单个观察中提取多个来源。过去的方法包括因子隐马尔可夫模型(FHMM)和具有一些success⁶.的各种基于事件的方法</p><p id="ea3f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您还可以通过使用神经网络的序列到序列(seq2seq)学习来解决单通道BSS问题，并且可以使用卷积和递归神经网络将其应用于NILM问题。Seq2seq学习涉及训练一个深度网络，以在输入时间序列(如NILM的总电力读数)和输出序列(如单台设备的估计能耗)之间进行映射。滑动输入窗口通常用于训练网络，该网络产生相应的输出窗口。此方法为输出中的每个设备生成多个预测，因此预测的平均值用于最终结果。有些预测会比其他预测更准确，尤其是那些接近输入滑动窗口中点的预测。平均会降低预测的整体准确度。</p><p id="c069" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">对于单通道BSS⁴.，seq2seq学习的一些缺点可以通过序列到点学习(seq2point)来减轻在这种方法中还使用滑动输入信号窗口，但是网络被训练为仅在窗口的中点预测输出信号，这使得网络上的预测问题更容易，从而导致更准确的结果。</p><p id="fecf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我为我的原型系统选择了seq2point学习方法，我的实现受到了Michele DIncecco、Stefano Squartini和Mingjun Zhong⁵.描述的工作的启发和指导</p><h2 id="37f3" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">数据集</h2><p id="8852" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">有许多专门为解决NILM问题而设计的大规模公开可用数据集，这些数据集是在不同国家的家庭建筑中捕获的。下面的table⁷展示了几种最广泛使用的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/7144fcbc543f172ec4b881bd7dcf98b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aQVwEVbIVtg8LbaQthP_mQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">NILM数据集(奥利弗·帕森和al.⁷)</p></figure><p id="bc64" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">数据集通常包括数百万个有功功率、无功功率、电流和电压样本，但采样频率不同，需要在使用前对数据进行预处理。大多数NILM算法仅利用有功或视在功率数据。能源分解研究通常考虑五种电器，它们是水壶、微波炉、冰箱、洗碗机和洗衣机。这些是我根据Michele DIncecco等人的工作为原型考虑的设备。 ⁵，我主要关注REFIT⁸数据et，但最终将包括UK-DALE和REDD。</p><h2 id="78ce" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">模特培训</h2><p id="5244" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我使用TensorFlow 2和Keras APIs来训练和测试模型。与这部分相关的所有代码都可以在该项目的GitHub，<a class="ae kv" href="https://github.com/goruck/nilm/tree/main/ml" rel="noopener ugc nofollow" target="_blank"> NILM </a> ⁹.的机器学习部分找到</p><p id="2f17" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">用于器具的seq2point学习模型在z归一化改装数据上被单独训练。我使用以下四个指标来评估模型的性能。你可以在这里查看计算这些指标<a class="ae kv" href="https://github.com/goruck/nilm/blob/main/ml/nilm_metric.py" rel="noopener ugc nofollow" target="_blank">的代码。</a></p><ul class=""><li id="adc6" class="nm nn iq lq b lr mk lu ml lx no mb np mf nq mj nr ns nt nu bi translated">平均绝对误差(MAE ),用于评估每个时间点的预测值与实际值之间的绝对差值，并计算平均值。</li><li id="f270" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">归一化信号总误差(SAE)，表示总能量的相对误差。</li><li id="7802" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">每日能量(EpD ),用于测量一天中使用的预测能量的绝对误差，当家庭用户对一段时间内消耗的总能量感兴趣时非常有用。</li><li id="9090" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">标准化分解误差(NDE ),用于测量预测值和设备实际值之间的平方差的标准化误差。</li></ul><p id="1ec1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我使用Keras Functional API创建了seq2point学习模型，如下面的Python函数所示。您可以在该项目的GitHub中找到替代的模型架构，但是这个目前给出了最好的结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">seq2point学习模型</p></figure><p id="6496" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">集合表观功耗信号的599个样本的滑动窗口被用作seq2point模型的输入，并且电器的相应窗口的中点被用作目标。您可以在下面的代码片段中看到示例和目标是如何生成的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">窗口生成器</p></figure><p id="9362" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">你可以在下面看到我用来训练模型的代码片段和完整的程序<a class="ae kv" href="https://github.com/goruck/nilm/blob/main/ml/train.py" rel="noopener ugc nofollow" target="_blank">这里</a>。为了训练，我使用了Keras <a class="ae kv" href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/Adam" rel="noopener ugc nofollow" target="_blank"> Adam </a>优化器，为了减少过度拟合，我使用了<a class="ae kv" href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/EarlyStopping" rel="noopener ugc nofollow" target="_blank">提前停止</a>和<a class="ae kv" href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers/schedules/InverseTimeDecay" rel="noopener ugc nofollow" target="_blank"> InverseTimeDecay </a>。训练代码可以配置为从头开始训练seq2point模型，或者给定一个拟合的模型，用量化感知训练(QAT)对其进行修剪或微调，这两种方法都可以提高推理性能，尤其是在边缘硬件上。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">主要培训代码</p></figure><p id="b4ca" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">训练和优化程序的超参数总结如下。</p><ul class=""><li id="9eb0" class="nm nn iq lq b lr mk lu ml lx no mb np mf nq mj nr ns nt nu bi translated">输入窗口大小:599个样本</li><li id="778a" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">批量:1000个样品。</li><li id="4c59" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">从零开始学习率:0.001，具有逆时间衰减。</li><li id="3752" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">QAT和剪枝学习率:0.0001。</li><li id="ba4c" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">优化器:beta_1=0.9，beta_2=0.999，ε= 1e-08。</li><li id="4726" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj nr ns nt nu bi translated">从无到有的早期停止标准:6个时代。</li></ul><p id="d45d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">训练程序监控训练和验证数据的均方误差(MSE)损失和验证数据的平均绝对误差(MAE ),并及早停止以减少过度拟合。数据集包含大量具有重复模式的样本(数以百万计);对于一些器具来说，仅在一个时期之后就出现过度适配的情况并不罕见。为了缓解这种情况，我使用了训练数据的子集，通常在500万到1000万个样本之间。</p><p id="25fa" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">微波设备的典型从头训练运行的MSE和MAE结果如下所示。您可以看到，最小验证损失发生在第10个时期左右，此时训练程序保存为最终训练模型，并在第16个时期后提前停止。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/5ae3e30c806e9b34c6a1c8f6237ddd15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*P7VYaxdlJppM0JAKHXH9Rg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">微波训练和验证损失</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/4700bc27c28930bcb2031a9da2716728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*R0xcdR-9yO8crmpOvgGPkA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">微波验证</p></figure><p id="67a7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">按照上述指标得出的典型模型性能结果可在附录中找到。我达到或超过了Michele DIncecco等人在工作中报告的结果。 ⁵</p><h2 id="bdf6" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">模型量化</h2><p id="fd86" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我使用<a class="ae kv" href="https://www.tensorflow.org/lite" rel="noopener ugc nofollow" target="_blank"> TensorFlow Lite </a>将模型的权重和激活函数从Float32量化到INT8，以提高边缘硬件上的推理性能，包括Raspberry Pi和Google Edge TPU。量化后，您可能会观察到性能略有下降，但这对于大多数用例来说是可以接受的。典型结果如下所示，请注意，浮点模型在INT8转换之前既没有使用QAT进行微调，也没有进行修剪。</p><pre class="kg kh ki kj gt od oe of og aw oh bi"><span id="64bc" class="mz kx iq oe b gy oi oj l ok ol">### Fridge Float32 vs INT8 Model Performance ###</span><span id="cfc1" class="mz kx iq oe b gy om oj l ok ol">Float32 tflite Model (Running on x86 w/XNNPACK):<br/>MAE 17.10(Watts)<br/>NDE 0.373<br/>SAE 0.283<br/>Inference Rate 701.0 Hz</span><span id="c462" class="mz kx iq oe b gy om oj l ok ol">INT8 tflite Model (running on Raspberry Pi 4):<br/>MAE: 12.75 (Watts)<br/>NDE 0.461<br/>SAE 0.120<br/>Inference Rate 163.5 Hz</span></pre><p id="91d7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">与此部分相关的所有代码都可以在该项目的GitHub、<a class="ae kv" href="https://github.com/goruck/nilm/tree/main/ml" rel="noopener ugc nofollow" target="_blank"> NILM </a> ⁹的机器学习部分找到，特别是参见下面的模块<a class="ae kv" href="https://github.com/goruck/nilm/blob/main/ml/convert_keras_to_tflite.py" rel="noopener ugc nofollow" target="_blank">convert _ keras _ to _ TF lite . py</a>及其代码片段。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Keras到tflite转换函数</p></figure><h1 id="6431" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">NILM原型系统组件</h1><p id="4db2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我在家里建造了一个NILM原型，在真实世界条件下测试能量分解算法，并了解它们可以改进的地方。原型由以下主要子系统组成。你可以在附录中看到原型的照片。</p><h2 id="43a7" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">模拟信号调理</h2><p id="14e5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我在家里的一个子面板上使用了两个夹式电流互感器来感测流经每个分压相位的电流，并在断路器面板附近的插座上插入了一个电压互感器，以提供其中一个相位的电压。这些信号由该子系统进行电平转换、放大和低通滤波，然后传递给执行总指标计算的<a class="ae kv" href="https://docs.arduino.cc/hardware/mega-2560" rel="noopener ugc nofollow" target="_blank"> Arduino MEGA 2560 </a>内部的模数转换器。您可以在附录中看到模拟信号调理子系统的原理图。</p><h2 id="c154" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">聚合指标计算</h2><p id="4db1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我使用Arduino MEGA 2560来托管信号处理算法，该算法从模拟信号调理子系统获取电压信号，并实时产生总均方根电压、均方根电流、有功功率和视在功率指标。目前，在下游处理中仅使用有功功率。我利用了⁰的emonLibCM来实现这些信号处理算法。emonLibCM在后台持续运行，对Arduino的模拟输入通道进行数字化处理，计算这些指标，然后通知Arduino草图测量可用，应由下游处理读取和处理。草图配置为每八秒更新一次指标，每次更新后执行模拟前端的自动增益控制，以优化信噪比。</p><p id="366a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">你可以在下面和项目的GitHub中看到Arduino草图，<a class="ae kv" href="https://github.com/goruck/nilm/blob/main/ard/ard.ino" rel="noopener ugc nofollow" target="_blank"> NILM </a> ⁹</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Arduino草图</p></figure><h2 id="0413" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">分项能耗计算</h2><p id="b50a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">实际的能源分解计算在一个<a class="ae kv" href="https://www.raspberrypi.com/products/raspberry-pi-4-model-b/" rel="noopener ugc nofollow" target="_blank"> Raspberry Pi 4 </a>上进行，它通过USB连接到Arduino以获取聚合指标。计算包括运行tflite设备推理模型，按照上述步骤进行训练和量化，以及预处理和后处理步骤。推理模型从集合实际功率输入信号的599个样本大小的窗口中输出每个设备的预测能量。这些预测存储在本地CSV文件中，可用于下游报告和分析。</p><p id="5a7b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">下图显示了我家的典型分类能源预测结果，使用的是在另一台机器上根据上述数据集训练的tflite模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/eb87ae53fda1b256cc2eb228eae1577b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYWdHLZERaml4nf4ncYHXw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Float32和tflite设备型号预测</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/48e27db795d3695e75950cea88724102.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ADptOCXlGvxw1wzZ1500FA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">放大冰箱和微波炉</p></figure><p id="3231" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">没有对本地数据进行微调。水平轴是由八秒样本数(采样间隔是八秒)测量的时间，在本例中，它跨越了大约八天半。纵轴是以瓦特为单位的能耗。顶部曲线是总(两相)市电视在功率。以下轨迹是每个设备的预测能量。在此期间，参考设备组中只有一台冰箱和一台微波炉在使用，尽管同一子面板还提供了其他设备，如计算机和加热器。</p><p id="2a8d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">可以看到，Float32和tflite版本的算法都检测冰箱和微波炉，但两者之间存在能量偏移，这可能表明需要更好的校准。我用功率表计算了冰箱和微波炉的均方根功耗；它与Float32预测的误差在+/- 15%以内。</p><p id="3f33" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">与此部分相关的所有代码都可以在该项目的GitHub、<a class="ae kv" href="https://github.com/goruck/nilm/tree/main/rpi" rel="noopener ugc nofollow" target="_blank"> NILM </a> ⁹的机器学习部分找到，特别是参见模块<a class="ae kv" href="https://github.com/goruck/nilm/blob/main/rpi/infer.py" rel="noopener ugc nofollow" target="_blank"> infer.py </a>和下面来自它的执行实时预测的代码片段。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">infer.py主要</p></figure><h2 id="2d82" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">亚马逊Alexa</h2><p id="da30" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我计划使用亚马逊Alexa作为设备能源数据的用户界面，但这项工作尚未开始。</p><h1 id="9c4a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="63e4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">通过使用大型公开可用数据集来训练seq2point学习模型，执行相当准确的能量分解是非常可行的，而无需用本地数据微调模型。这些模型大小适中，精度损失很小，可以量化以在商用边缘硬件(如Raspberry Pi 4)上有效运行。需要做更多的工作来进一步提高模型的准确性，并使用更多的设备类型进行测试。该项目表明，可持续和可扩展的电网的一个关键组成部分是大众消费市场所能达到的。</p><h1 id="42bd" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">参考</h1><ol class=""><li id="50f9" class="nm nn iq lq b lr ls lu lv lx oo mb op mf oq mj or ns nt nu bi translated">可持续的城市和社会62 (2020) 102411 |使用非侵入式负荷监测技术的能源管理R. Gopinath、Mukesh Kumar、C. Prakash Chandra Joshua和Kota Srinivas的最新技术和未来研究方向。</li><li id="7b55" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">维基| <a class="ae kv" href="https://en.wikipedia.org/wiki/Signal_separation" rel="noopener ugc nofollow" target="_blank">信号分离</a>。</li><li id="210c" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">arXiv:1507.06594 | <a class="ae kv" href="https://arxiv.org/pdf/1507.06594.pdf" rel="noopener ugc nofollow" target="_blank">神经NILM:应用于能量分解的深度神经网络</a>作者:Jack Kelly和William Knottenbelt。</li><li id="0330" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">arXiv:1612.09106 | <a class="ae kv" href="https://arxiv.org/pdf/1612.09106.pdf" rel="noopener ugc nofollow" target="_blank">用于非侵入式负荷监控的神经网络序列点到点学习</a>作者:、钟明军、王宗佐、Nigel Goddard和Charles Sutton。</li><li id="76e7" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">arXiv:1902.08835 |<a class="ae kv" href="https://arxiv.org/pdf/1902.08835.pdf" rel="noopener ugc nofollow" target="_blank">Michele DIncecco、Stefano Squartini和Mingjun Zhong的《非侵入式负载监控的迁移学习》</a>。</li><li id="e1f8" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">可扩展能源转换的人工智能技术第109–131页|基于机器学习的非侵入式负荷监控方法综述。</li><li id="e930" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">在第三届IEEE信号与信息处理全球会议上召开的第一届智能建筑信号处理应用国际研讨会| <a class="ae kv" href="https://www.researchgate.net/profile/Nipun-Batra/publication/281538210_Dataport_and_NILMTK_A_Building_Data_Set_Designed_for_Non-intrusive_Load_Monitoring/links/55ed13e208aeb6516268cffc/Dataport-and-NILMTK-A-Building-Data-Set-Designed-for-Non-intrusive-Load-Monitoring.pdf?origin=publication_detail" rel="noopener ugc nofollow" target="_blank"> Dataport和NILMTK:专为非侵入式负载监控设计的建筑数据集</a>作者:Oliver Parson、Grant Fisher、April Hersey、Nipun Batra、Jack Kelly、Amarjeet Singh、William Knottenbelt和Alex Rogers。</li><li id="9196" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">第八届国际家用电器和照明能效会议论文集| <a class="ae kv" href="https://pure.strath.ac.uk/ws/portalfiles/portal/45214811/Murray_etal_EEDAL_2015_A_data_management_platform_for_personalised_real_time.pdf" rel="noopener ugc nofollow" target="_blank">个性化实时能源反馈数据管理平台</a>作者:大卫·穆雷、廖婧、莉娜·斯坦科维奇、弗拉基米尔·斯坦科维奇、理查德·豪克斯韦尔·鲍德温、查理·威尔森、迈克尔·科尔曼、Tom Kane和史蒂文·弗斯。本项目中使用的改装数据集是在知识共享署名4.0国际公共许可证下许可的。</li><li id="5173" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">GitHub | <a class="ae kv" href="https://github.com/goruck/nilm" rel="noopener ugc nofollow" target="_blank"> NILM </a>作者林多·圣·安吉尔</li><li id="a149" class="nm nn iq lq b lr nv lu nw lx nx mb ny mf nz mj or ns nt nu bi translated">Trystan Lea，Glyn Hudson，Brian Orpin和Ivan克拉韦茨。</li></ol><h1 id="02e5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">附录</h1><h2 id="3e2e" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">原型照片</h2><p id="711a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">下面是我的原型系统的早期版本的照片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/ce5f98ed68c218b2dba1f087201de226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U6sXHYgk6SJNGiXbZrHzxA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">早期原型</p></figure><h2 id="a55c" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">模拟信号调理原理图</h2><p id="86e1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">模拟信号调理电路原理图如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/e74a3b1e8d659c20d05fada2018d781a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bvz2srBpCu6Hg4VBJpBSzA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模拟信号调理原理图</p></figure><h2 id="fd4c" class="mz kx iq bd ky na nb dn lc nc nd dp lg lx ne nf li mb ng nh lk mf ni nj lm nk bi translated">模型训练结果</h2><p id="1026" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">根据上述指标评估的典型模型性能如下。</p><pre class="kg kh ki kj gt od oe of og aw oh bi"><span id="e64e" class="mz kx iq oe b gy oi oj l ok ol">### Dishwasher ###</span><span id="6021" class="mz kx iq oe b gy om oj l ok ol">2022–06–05 12:48:09,322 [INFO ] Appliance target is: dishwasher<br/>2022–06–05 12:48:09,322 [INFO ] File for test: dishwasher_test_H20.csv<br/>2022–06–05 12:48:09,322 [INFO ] Loading from: ./dataset_management/refit/dishwasher/dishwasher_test_H20.csv<br/>2022–06–05 12:48:10,010 [INFO ] There are 5.169M test samples.<br/>2022–06–05 12:48:10,015 [INFO ] Loading saved model from ./models/dishwasher/checkpoints.<br/>2022–06–05 12:48:35,045 [INFO ] aggregate_mean: 522<br/>2022–06–05 12:48:35,046 [INFO ] aggregate_std: 814<br/>2022–06–05 12:48:35,046 [INFO ] appliance_mean: 700<br/>2022–06–05 12:48:35,046 [INFO ] appliance_std: 1000<br/>2022–06–05 12:48:35,121 [INFO ] true positives=5168007.0<br/>2022–06–05 12:48:35,121 [INFO ] false negatives=0.0<br/>2022–06–05 12:48:35,121 [INFO ] recall=1.0<br/>2022–06–05 12:48:35,173 [INFO ] true positives=5168007.0<br/>2022–06–05 12:48:35,173 [INFO ] false positives=0.0<br/>2022–06–05 12:48:35,173 [INFO ] precision=1.0<br/>2022–06–05 12:48:35,173 [INFO ] F1:1.0<br/>2022–06–05 12:48:35,184 [INFO ] NDE:0.45971032977104187<br/>2022–06–05 12:48:35,657 [INFO ] <br/>MAE: 10.477645874023438<br/> -std: 104.59112548828125<br/> -min: 0.0<br/> -max: 3588.0<br/> -q1: 0.0<br/> -median: 0.0<br/> -q2: 0.78582763671875<br/>2022–06–05 12:48:35,675 [INFO ] SAE: 0.1882956475019455<br/>2022–06–05 12:48:35,691 [INFO ] Energy per Day: 145.72999548734632</span><span id="450f" class="mz kx iq oe b gy om oj l ok ol">### Microwave ###</span><span id="3e48" class="mz kx iq oe b gy om oj l ok ol">2022-06-05 18:14:05,471 [INFO ]  Appliance target is: microwave<br/>2022-06-05 18:14:05,471 [INFO ]  File for test: microwave_test_H4.csv<br/>2022-06-05 18:14:05,471 [INFO ]  Loading from: ./dataset_management/refit/microwave/microwave_test_H4.csv<br/>2022-06-05 18:14:06,476 [INFO ]  There are 6.761M test samples.<br/>2022-06-05 18:14:06,482 [INFO ]  Loading saved model from ./models/microwave/checkpoints.<br/>2022-06-05 18:14:38,385 [INFO ]  aggregate_mean: 522<br/>2022-06-05 18:14:38,385 [INFO ]  aggregate_std: 814<br/>2022-06-05 18:14:38,385 [INFO ]  appliance_mean: 500<br/>2022-06-05 18:14:38,385 [INFO ]  appliance_std: 800<br/>2022-06-05 18:14:38,478 [INFO ]  true positives=6759913.0<br/>2022-06-05 18:14:38,478 [INFO ]  false negatives=0.0<br/>2022-06-05 18:14:38,478 [INFO ]  recall=1.0<br/>2022-06-05 18:14:38,549 [INFO ]  true positives=6759913.0<br/>2022-06-05 18:14:38,549 [INFO ]  false positives=0.0<br/>2022-06-05 18:14:38,549 [INFO ]  precision=1.0<br/>2022-06-05 18:14:38,549 [INFO ]  F1:1.0<br/>2022-06-05 18:14:38,568 [INFO ]  NDE:0.6228251457214355<br/>2022-06-05 18:14:39,469 [INFO ]  <br/>MAE: 7.6666789054870605<br/>    -std: 73.37799835205078<br/>    -min: 0.0<br/>    -max: 3591.474365234375<br/>    -q1: 0.757080078125<br/>    -median: 1.178070068359375<br/>    -q2: 1.459686279296875<br/>2022-06-05 18:14:39,493 [INFO ]  SAE: 0.2528369128704071<br/>2022-06-05 18:14:39,512 [INFO ]  Energy per Day: 99.00535584592438</span><span id="3fe6" class="mz kx iq oe b gy om oj l ok ol">### Fridge ###</span><span id="b2e0" class="mz kx iq oe b gy om oj l ok ol">2022-06-06 05:14:39,830 [INFO ]  Appliance target is: fridge<br/>2022-06-06 05:14:39,830 [INFO ]  File for test: fridge_test_H15.csv<br/>2022-06-06 05:14:39,830 [INFO ]  Loading from: ./dataset_management/refit/fridge/fridge_test_H15.csv<br/>2022-06-06 05:14:40,671 [INFO ]  There are 6.226M test samples.<br/>2022-06-06 05:14:40,677 [INFO ]  Loading saved model from ./models/fridge/checkpoints.<br/>2022-06-06 05:15:11,539 [INFO ]  aggregate_mean: 522<br/>2022-06-06 05:15:11,539 [INFO ]  aggregate_std: 814<br/>2022-06-06 05:15:11,539 [INFO ]  appliance_mean: 200<br/>2022-06-06 05:15:11,539 [INFO ]  appliance_std: 400<br/>2022-06-06 05:15:11,649 [INFO ]  true positives=6225098.0<br/>2022-06-06 05:15:11,649 [INFO ]  false negatives=0.0<br/>2022-06-06 05:15:11,649 [INFO ]  recall=1.0<br/>2022-06-06 05:15:11,713 [INFO ]  true positives=6225098.0<br/>2022-06-06 05:15:11,713 [INFO ]  false positives=0.0<br/>2022-06-06 05:15:11,713 [INFO ]  precision=1.0<br/>2022-06-06 05:15:11,713 [INFO ]  F1:1.0<br/>2022-06-06 05:15:11,728 [INFO ]  NDE:0.390367716550827<br/>2022-06-06 05:15:12,732 [INFO ]  <br/>MAE: 18.173030853271484<br/>    -std: 22.19791030883789<br/>    -min: 0.0<br/>    -max: 2045.119873046875<br/>    -q1: 5.2667236328125<br/>    -median: 12.299388885498047<br/>    -q2: 24.688186645507812<br/>2022-06-06 05:15:12,754 [INFO ]  SAE: 0.3662513792514801<br/>2022-06-06 05:15:12,774 [INFO ]  Energy per Day: 219.63657335193759</span><span id="aa7e" class="mz kx iq oe b gy om oj l ok ol">### Washing Machine ###</span><span id="b1bd" class="mz kx iq oe b gy om oj l ok ol">2022-06-05 05:49:17,614 [INFO ]  Appliance target is: washingmachine<br/>2022-06-05 05:49:17,614 [INFO ]  File for test: washingmachine_test_H8.csv<br/>2022-06-05 05:49:17,614 [INFO ]  Loading from: ./dataset_management/refit/washingmachine/washingmachine_test_H8.csv<br/>2022-06-05 05:49:18,762 [INFO ]  There are 6.118M test samples.<br/>2022-06-05 05:49:18,767 [INFO ]  Loading saved model from ./models/washingmachine/checkpoints.<br/>2022-06-05 05:49:47,965 [INFO ]  aggregate_mean: 522<br/>2022-06-05 05:49:47,965 [INFO ]  aggregate_std: 814<br/>2022-06-05 05:49:47,965 [INFO ]  appliance_mean: 400<br/>2022-06-05 05:49:47,965 [INFO ]  appliance_std: 700<br/>2022-06-05 05:49:48,054 [INFO ]  true positives=6117871.0<br/>2022-06-05 05:49:48,055 [INFO ]  false negatives=0.0<br/>2022-06-05 05:49:48,055 [INFO ]  recall=1.0<br/>2022-06-05 05:49:48,115 [INFO ]  true positives=6117871.0<br/>2022-06-05 05:49:48,115 [INFO ]  false positives=0.0<br/>2022-06-05 05:49:48,115 [INFO ]  precision=1.0<br/>2022-06-05 05:49:48,115 [INFO ]  F1:1.0<br/>2022-06-05 05:49:48,128 [INFO ]  NDE:0.4052383601665497<br/>2022-06-05 05:49:48,835 [INFO ]  <br/>MAE: 20.846961975097656<br/>    -std: 155.17930603027344<br/>    -min: 0.0<br/>    -max: 3972.0<br/>    -q1: 3.0517578125e-05<br/>    -median: 0.25152587890625<br/>    -q2: 1.6888427734375<br/>2022-06-05 05:49:48,856 [INFO ]  SAE: 0.3226347267627716<br/>2022-06-05 05:49:48,876 [INFO ]  Energy per Day: 346.94591079354274</span><span id="a950" class="mz kx iq oe b gy om oj l ok ol">### Kettle ###</span><span id="0ab4" class="mz kx iq oe b gy om oj l ok ol">2022-05-25 15:19:15,366 [INFO ]  Appliance target is: kettle<br/>2022-05-25 15:19:15,366 [INFO ]  File for test: kettle_test_H2.csv<br/>2022-05-25 15:19:15,366 [INFO ]  Loading from: ./dataset_management/refit/kettle/kettle_test_H2.csv<br/>2022-05-25 15:19:16,109 [INFO ]  There are 5.734M test samples.<br/>2022-05-25 15:19:16,115 [INFO ]  Loading saved model from ./models/kettle/checkpoints.<br/>2022-05-25 15:19:44,459 [INFO ]  aggregate_mean: 522<br/>2022-05-25 15:19:44,459 [INFO ]  aggregate_std: 814<br/>2022-05-25 15:19:44,459 [INFO ]  appliance_mean: 700<br/>2022-05-25 15:19:44,459 [INFO ]  appliance_std: 1000<br/>2022-05-25 15:19:44,540 [INFO ]  true positives=5732928.0<br/>2022-05-25 15:19:44,540 [INFO ]  false negatives=0.0<br/>2022-05-25 15:19:44,540 [INFO ]  recall=1.0<br/>2022-05-25 15:19:44,597 [INFO ]  true positives=5732928.0<br/>2022-05-25 15:19:44,597 [INFO ]  false positives=0.0<br/>2022-05-25 15:19:44,597 [INFO ]  precision=1.0<br/>2022-05-25 15:19:44,597 [INFO ]  F1:1.0<br/>2022-05-25 15:19:44,610 [INFO ]  NDE:0.2578023374080658<br/>2022-05-25 15:19:45,204 [INFO ]  <br/>MAE: 18.681659698486328<br/>    -std: 125.82673645019531<br/>    -min: 0.0<br/>    -max: 3734.59228515625<br/>    -q1: 0.0<br/>    -median: 0.20867919921875<br/>    -q2: 1.63885498046875<br/>2022-05-25 15:19:45,224 [INFO ]  SAE: 0.2403179109096527<br/>2022-05-25 15:19:45,243 [INFO ]  Energy per Day: 155.25137268110353</span></pre></div></div>    
</body>
</html>