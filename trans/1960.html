<html>
<head>
<title>Implementing an Enterprise Recommendation System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实施企业推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implementing-an-enterprise-recommendation-system-89dd439db444#2022-05-04">https://towardsdatascience.com/implementing-an-enterprise-recommendation-system-89dd439db444#2022-05-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5f69" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">实现“真实世界”基于内容的推荐系统的端到端研究</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/7b9372542a0d312f2fd2d7fd013970ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHFz2uMXlpmwqOlmr1TkGA.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由<a class="ae kw" href="https://www.dreamstime.com/" rel="noopener ugc nofollow" target="_blank">梦想时间</a>的<a class="ae kw" href="https://www.dreamstime.com/ammentorp_info" rel="noopener ugc nofollow" target="_blank">安门特鲁普</a>拍摄的照片</p></figure><p id="6dd2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我最近完成了一个推荐系统，它将作为一个高流量全球网站的新闻提要的一部分发布。由于必须具备亚秒级的建议响应时间，这些要求带来了巨大的设计挑战。</p><p id="dabf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">与将部署到生产环境中的任何应用程序一样，需要对以下主题做出重要决策</p><ul class=""><li id="e500" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">性能，</li><li id="0ce3" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">可用性，</li><li id="575b" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">数据准备就绪，以及</li><li id="449c" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">总成本，</li></ul><p id="e025" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">每一个都需要适当的考虑。</p><p id="b28d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在我最初的项目评估期间，我发现很少有公开可用的企业级机器学习(ML)资源，这些资源旨在为现实世界项目的端到端决策提供信息。这篇文章旨在帮助从业者在企业推荐系统项目的各种决策点中跋涉。</p><h1 id="eac9" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">项目要求</h1><p id="78aa" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">需求需要一个带有RESTful API的推荐系统来集成网站的新闻提要。通过让访问者访问个性化内容，推荐系统可以成为洞察和参与的重要驱动力，这是新闻订阅源的主要目标。</p><p id="7130" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">其他关键要求:</p><ul class=""><li id="239d" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">可衡量的模型性能和商业价值</li><li id="4b79" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">低于500毫秒的亚秒延迟。</li><li id="fb3d" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">高可用性和可扩展性，服务级别协议(SLA)级别为99.9%，相当于每天最多1.44分钟的停机时间。</li><li id="4fb6" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">使用自动化进行数据提取和模型构建-部署-监控生命周期。</li><li id="5021" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">用于持续改进的全面模型和API监控。</li><li id="9dbd" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">总拥有成本(TCO)也是一个因素，尤其是经常性的托管成本。</li></ul><h1 id="5964" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">步骤1:探索性数据分析</h1><p id="c9f4" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">在任何机器学习项目中，最重要的第一步是获得最佳质量的可用数据。项目通常没有容易访问的数据，这些数据被标记并准备好用于培训。在这种情况下，开发定制接口是为了从多个来源、供应商托管的API、内部内容管理系统和Google Analytics报告API提取数据集。</p><p id="364b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据提取后，探索性数据分析显示，语料库的规模有限，约有6800篇新闻稿和700篇专题文章。这些数据还缺乏一致的跨数据集元数据或标签来帮助生成候选数据。更重要的是，进一步的分析发现没有用户数据或明确/隐含的访问者反馈历史来作为推荐的基础。</p><p id="37d0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据现有数据，有必要建立一个无人监管的基于内容的推荐系统，以及一种以支持个性化推荐的方式跟踪访问者的方法。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/b3b4f61a9589ec91da74538306ee21ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxYZs-OKIgWDKd888jEuVA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">基于内容的过滤与协同过滤(图片由作者提供)</p></figure><h1 id="c4eb" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">步骤2:开发推荐模型</h1><p id="e190" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">对于推荐，每篇新闻稿和专题文章都需要语料库中最相似的内容来响应API请求。为了选择最佳的无监督自然语言处理(NLP)技术，有必要评估几种可以将文本转换为特征向量的算法。选择SentenceBERT、Doc2Vec、FastText和TF-IDF来评估哪种算法对用例及语料库最有效。</p><p id="3a13" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦为每个算法生成了语料库中文档的向量表示，就必须确定7500个文档之间的相似性。余弦相似性是计算向量之间相似性的优选度量，只要向量不太大，其中性能可能是一个问题。余弦相似性提供了一种基于文档的矢量化得分或嵌入来衡量文档与另一个文档相似程度的方法。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nf"><img src="../Images/74c558cd917372f440bc9246c20a7151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MdjUGlZasaSSxowgZTSGTA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">预处理的TF-IDF生成特征的词云(图片由作者提供)</p></figure><p id="4b39" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在没有可依赖的标记数据和标准评估度量的情况下，计算在余弦相似性矩阵中自己作为最高得分文档的文档的百分比的准确性度量被用作估计模型的一般准确性的方式。该指标还用于执行随机交叉验证，以在产生最终比较之前调整超参数和预处理步骤。总体结果对于一般的推荐系统来说是好的，但是TF-IDF与其他模型相比具有稍微更好的推荐。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ng"><img src="../Images/e77896fa40af2fb5f142ad415efc4d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2xt1hOVE6E6HQlJdbvLaPA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">T2的算法比较。Xlarge实例(图片由作者提供)</p></figure><p id="caaa" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了确认最初的发现，每个模型都通过比较大量的建议样本和观察结果进行了验证，确认TF-IDF提供了良好的准确性，是项目的最佳选择。</p><p id="c7ed" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">与计算单词和句子嵌入的其他NLP技术不同，TF-IDF通过重视不太频繁的术语来提供直接的特征提取。TF-IDF还提供了更快、资源更少的模型生成，并且实现非常简单，可以很容易地向涉众解释。</p><h2 id="2e21" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">重新排列建议</h2><p id="3873" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">为了进一步改进推荐，通过包括流行度和新鲜度特征来重新排列相似性分数。使用流行度是一种促进推荐的好方法，在这种情况下，流行度分数基于从Google Analytics提取的页面视图指标，而新鲜度基于文档年龄。两个分数都被标准化，然后在合并成最终分数之前对重要性进行加权平均。</p><p id="6233" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了确保只提供最高质量的建议，每个文件的API建议被限制在三个最高分。推荐也限于访问者最近没有查看的内容。没有与新闻订阅源内容交互的新访问者将获得新闻订阅源中最受欢迎内容的混合。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/8d08a62a337cca058b0e2b678b5cd566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G67oel70VOOIQ1xCCoZn7g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">推荐系统概述(图片由作者提供)</p></figure><h2 id="438f" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">未来状态</h2><p id="f45d" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">一旦收集了足够的访问者历史数据，就可以试验更有效的技术，包括结合协作和基于内容的过滤的混合方法。</p><h1 id="2394" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">步骤3:个性化推荐</h1><p id="793a" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">拥有新闻订阅源访问者历史对于API能够提供个性化网站推荐至关重要。由于网站的性质，在这种情况下，访问者没有通过身份验证或跟踪。谷歌分析用于跟踪一般网站活动，但不允许提取未采样的用户级数据。为了避免不必要的复杂性，选择了一种依赖浏览器cookies的方法来跟踪新闻提要中最近的访问者选择。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nt"><img src="../Images/6d1a73104df2c8bee8f3351d794c04dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jqz2Yr9HYlPLfaWHKRX9lg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">网站推荐生命周期(作者图片)</p></figure><p id="2276" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">每当访问者点击新闻内容时，访问者的浏览器中就会更新一个cookie，反映最近浏览的页面。这些id随后被传递给API以提供个性化的推荐。</p><h1 id="7d6d" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">步骤4:设计部署架构</h1><p id="bd0b" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">现在是设计整体API部署架构的时候了，同时保持亚秒级响应时间和TCO需求。该架构还需要驻留在私有云环境的范围内，并且必须满足其他专有的安全限制，这里不做介绍。</p><p id="78c1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">考虑了各种AWS部署选项，包括SageMaker端点和Elastic Beanstalk。SageMaker端点可以使部署模型变得相对简单，但是根据我的经验，不是在SageMaker中创建的模型部署起来可能会很麻烦，并且文档可能会缺乏，有时甚至会过时。从成本角度来看，SageMaker部署通常使用EC2虚拟服务器实例，即使在需求较低的时候也是按小时计费的。对于新闻订阅来说并不理想，因为预计在工作日晚上和周末的需求会更低。</p><p id="c135" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">另一种选择是使用Elastic Beanstalk来部署带有负载平衡和自动伸缩EC2实例的API，以实现高可用性。每个实例将运行Flask、Django或FastAPI来处理传入的API请求。尽管Elastic Beanstalk是部署应用程序的有效方法，但它也有类似的成本问题；这项服务是免费的，但是任何启动的EC2实例都要24x7付费，不管它们是否被充分利用。</p><h2 id="968f" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">无服务器Lambda</h2><p id="ecdb" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">无服务器架构很快成为部署推荐API的最佳选择。有了预先生成的相似性矩阵，就不需要实时推理，并且只要针对新内容更新模型，就可以使用查找表。一个查找表提供了使用DynamoDB进行模型存储的灵活性，并与Lambda相结合，最大化了性能、成本和可用性。Lambda函数仅在被使用时计费，并且可以提供显著的成本节约。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nu"><img src="../Images/f338cd27ec393936dcde2dd3698fee81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JQHUN-9dsIsL8F0A38IHcA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">高级API架构(图片由作者提供)</p></figure><p id="7011" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">除了节省成本，Lambda还支持可伸缩性和可用性。Lambda函数可自动扩展，以处理每个区域1，000多个并发执行，并在多个可用性区域中运行，满足99.9%的SLA要求。</p><h2 id="6486" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">DynamoDB</h2><p id="9020" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">对于模型存储，选择了使用dynamo db(AWS的NoSQL数据库)的非传统模式。数据库中的每一项都是一个JSON文档，主要包含一个惟一的内容ID和三个得分最高的内容ID。这使得API查找速度非常快，互联网响应时间平均为250毫秒。</p><p id="5f30" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在可伸缩性和高可用性方面，DynamoDB会随着表大小的增长自动扩展容量和重新分区数据。数据还在AWS区域的三个设施之间复制，提供99.99%的SLA。</p><p id="2bef" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">尽管DynamoDB非常有效，但用它来存储ML模型在许多情况下可能并不可行。为了存储和加载用于推理目的的大型模型，无服务器Lambda可以与AWS弹性文件系统(EFS)一起用于各种用例。关于Lambda/EFS模式的更多信息可以在参考资料部分找到。</p><h2 id="8718" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">AWS Lambda注意事项</h2><p id="51af" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">与标准的负载平衡EC2架构相比，无服务器架构提供了许多优势，但它们也有一个固有的冷启动问题。根据部署包的大小和函数的初始化时间，通常可以在1%的调用中看到执行延迟。保持部署包的轻量级很重要，但是如果这不是一个选项，那么可以启用供应并发来保持请求数量的执行环境被初始化并准备好响应传入的请求。</p><p id="561e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于新闻订阅源，将在高峰时段启用供应的并发性，以确保API可以扩展以满足具有低延迟建议的流量。</p><h2 id="d2c6" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">全局考虑</h2><p id="f72d" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">对于全球使用案例，评估内容交付网络(CDN)的使用是至关重要的。根据通过API发送的数据量和缓存的情况，CDNs可以显著缩短全球响应时间。对于newsfeed，推荐缓存得很好，AWS CloudFront的边缘位置将在调用API时为全球各地的访问者提供快速和一致的性能。</p><h1 id="3c46" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">步骤5: MLOps和最终确定部署策略</h1><p id="665a" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">机器学习操作，或MLOps，简化了将ML模型投入生产，然后维护和监控它们的过程。虽然基本的MLOps自动化管道有许多选项，但我们强烈推荐其中一些，而其他的则取决于数据敏感度、团队规模和API可用性需求。下面，我总结了我对每个关键部署主题的策略，以及一些一般考虑事项。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nv"><img src="../Images/ea53bb337c491d52106d8acfe8c525cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v_sckl7ylRPupR2uh1SI9g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">基本MLOps自动化管道(图片由作者提供)</p></figure><h2 id="8cdf" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">自动化模型构建</h2><p id="29ae" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">新创建的内容将由计划的模型构建每小时自动处理一次。可以实现接近实时的处理，但这不是必需的，因为新闻订阅源内容不是以高频率发布的。托管在EC2实例上的Python脚本使得从多个来源收集数据、生成模型并将结果推送到DynamoDB成为可能。大量使用带有错误警报的日志记录可以确保快速检查和解决任何故障。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/11ce8e451966bcc5c21b52fc6d5946b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3q2CehhW-rStWYmpfHeHfQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">自动化模型构建架构(图片由作者提供)</p></figure><h2 id="e153" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">安全性</h2><p id="9079" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">安全性是整体设计的重要组成部分，需要遵循组织策略。除了AWS服务之间的默认资源策略保护之外，到API的流量需要通过内部网络安全基础设施进行TLS加密和过滤。根据项目需要，可以使用各种各样的安全措施，包括IP过滤、自定义承载令牌身份验证和AWS Cognito，用于单点登录或社交登录的(联合)身份验证。</p><h2 id="6c50" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">API监控</h2><p id="969a" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">持续的应用程序监控是部署API的另一个重要方面。AWS CloudWatch默认捕获Lambda执行指标，但也将用于详细的日志记录以及流量指标和健康检查触发的警报。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/4af1329d6a26565110f9aea9f11670be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P-90NyFwpEN_rx74RTGLKA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">AWS CloudWatch日志和警报(图片由作者提供)</p></figure><p id="5aa2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于要求高连续性的情况，CloudWatch警报可以集成到组织的现有服务台基础架构中，用于优先生成票证。日志还可以整合到Splunk等工具中，以获得它们提供的额外好处。</p><h2 id="f7fd" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">模型漂移监控</h2><p id="a676" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">一旦进入生产环境，模型需要持续的监控来重新验证它们的健康和业务价值。随着时间的推移，更改和转移数据是所部署模型的准确性降低的主要原因。对于新闻订阅源，在没有可依赖的标记数据或“基本事实”标签的情况下，通过计算所有文档的最高(非父)相似性得分的平均值来设计相似性分布得分指数。然后，总分数被索引到基线。</p><p id="317e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">此外，用于超参数调整的精度度量是监控模型持续精度的另一种方式。在每个模型建立后计算，这两个漂移分数将随着时间的推移被跟踪，并被用作领先指标和故障排除工具。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nw"><img src="../Images/e8dce9f436a7a88b912b4e4c232fc5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iebYTL10Buh9McB7c4XtMg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">模型漂移仪表板示例(图片由作者提供)</p></figure><h2 id="084f" class="nh mi iq bd mj ni nj dn mn nk nl dp mr lg nm nn mt lk no np mv lo nq nr mx ns bi translated">CI/CD和版本控制</h2><p id="3284" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">根据项目的规模，可以实现持续集成/持续交付管道，以加强构建、测试和部署的自动化。有多种CI/CD选项可用，包括AWS的CodeDeploy和SAM管道。对于这个项目，PyCharm和AWS Toolkit以及GitLab插件允许管理对Lambda的版本控制和部署，而生产就绪的模型构建脚本会在每次计划运行之前自动下载到EC2实例。</p><h1 id="e1f3" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">第六步:A/B测试</h1><p id="321e" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">推荐是估计的预测，并不保证网站的观众会对推荐策略做出什么反应。一旦推荐系统部署到生产中，将进行A/B测试，通过比较网站指标，如有推荐和无推荐的<em class="nx">点击率(CTR) </em>、<em class="nx">每次会话的页面数、</em>和<em class="nx">平均会话持续时间</em>，来衡量其有效性。实验期间收集的度量数据将有助于验证(或否定)策略。最终，A/B测试也将用于比较当前和未来的推荐策略。</p><h1 id="33b5" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">结论</h1><p id="95f5" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">我希望这篇文章能为开发和部署推荐系统提供一些思路。从整体上看一个项目，将生产放在心上，将有助于交付真正的商业价值，并对组织内部和外部如何看待项目产生积极的影响。</p><p id="adc1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我在这里介绍的是一个更大的主题。例如，像混合模型这样的实现可能需要多种部署方法，并且会给所讨论的每个方面带来额外的挑战。欢迎来到企业推荐系统的世界！</p><h1 id="fd0a" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">资源</h1><p id="dfa0" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">[1] AWS，<a class="ae kw" href="https://docs.aws.amazon.com/lambda/latest/dg/index.html" rel="noopener ugc nofollow" target="_blank"> AWS Lambda开发者指南(2022) </a>，亚马逊网络服务</p><p id="f615" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[2] AWS，<a class="ae kw" href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/index.html" rel="noopener ugc nofollow" target="_blank"> AWS DynamoDB开发者指南(2022) </a>，亚马逊网络服务</p><p id="dbc3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[3] AW，<a class="ae kw" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html" rel="noopener ugc nofollow" target="_blank"> AWS API网关开发者指南(2022) </a>，亚马逊网络服务</p><p id="e793" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[4] AWS，<a class="ae kw" href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/Introduction.html" rel="noopener ugc nofollow" target="_blank"> AWS CloudFront开发者指南(2022) </a>，亚马逊网络服务</p><p id="8bd2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[5] AWS，<a class="ae kw" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html" rel="noopener ugc nofollow" target="_blank"> AWS CloudWatch开发者指南(2022) </a>，亚马逊网络服务</p><p id="0de2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[6] N. Jain，A. Vaidyanathan，S. Debnath和V. Krishnamoorthy，<a class="ae kw" href="https://aws.amazon.com/blogs/machine-learning/deploy-multiple-machine-learning-models-for-inference-on-aws-lambda-and-amazon-efs/" rel="noopener ugc nofollow" target="_blank">在AWS Lambda和亚马逊EFS上部署多个机器学习模型进行推理(2021) </a>，预测黑客</p><p id="5b4b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[7] I. Njanji，<a class="ae kw" href="https://aws.amazon.com/blogs/mt/how-to-automatically-create-an-incident-in-servicenow-from-an-amazon-cloudwatch-alarm/" rel="noopener ugc nofollow" target="_blank">了解如何利用亚马逊CloudWatch警报在亚马逊网络服务ServiceNow (2018) </a>中创建事件</p><p id="80f8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[8] Splunk，<a class="ae kw" href="https://www.splunk.com/en_us/blog/tips-and-tricks/how-to-easily-stream-aws-cloudwatch-logs-to-splunk.html" rel="noopener ugc nofollow" target="_blank">如何将AWS CloudWatch日志流式传输到Splunk (2017) </a>，Splunk</p><p id="882c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">[9] M. Mantosh，<a class="ae kw" href="https://www.jetbrains.com/pycharm/guide/tutorials/intro-aws/background/" rel="noopener ugc nofollow" target="_blank">使用AWS工具包开发和部署无服务器API(2021)</a>，JetBrains</p></div></div>    
</body>
</html>