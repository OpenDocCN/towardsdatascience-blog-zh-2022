<html>
<head>
<title>How to Develop an Enterprise Document Management Application using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python开发企业文档管理应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-developed-an-enterprise-document-management-application-using-python-97a1c4836602#2022-07-18">https://towardsdatascience.com/how-i-developed-an-enterprise-document-management-application-using-python-97a1c4836602#2022-07-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="34e1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">客户发票管理应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f1c348dfe8c4946ee0089e1dd4a99d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vhuuih7XNMmTPk1I"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卡罗琳娜·加西亚·塔维森在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="799d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python是数据科学和机器学习领域最著名的语言。然而，它的魔力并不止于数据科学和机器学习相关的应用。它一直让我惊叹我们可以用它实现什么。这篇文章是关于Python的一个惊人的应用。</p><h1 id="8f6b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">要求</h1><p id="c887" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">作为一名系统集成专家，我从事过各种IT领域的工作——有些看起来过时了，有些则是世界顶级的——打包过ERP和商业智能应用程序。我的大部分时间都在获取需求，并将它们与这些打包应用程序提供的内容相匹配。</p><p id="c12e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，我遇到了一个非常有趣的挑战。</p><p id="3715" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们把这个概括为一个虚构的公司。这家公司有许多后台应用程序。</p><ul class=""><li id="14b1" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">一些办公室使用SAP ERP</li><li id="20a7" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">当地子公司使用Oracle ERP</li><li id="10e9" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">其服务机构使用e-Automate</li></ul><p id="57b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些应用程序都有内置的订购、运输、服务和发票功能。这些应用程序都可以生成发票并将其发送给客户。问题是，客户从同一家公司获得了来自不同应用程序的不同产品和服务的单独发票。客户希望一张发票列出公司的所有产品和服务。</p><h1 id="a3be" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">体系结构</h1><p id="e005" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当这个需求来到我面前时，它让我想知道我是否可以使用Python来做这件事。</p><blockquote class="ng nh ni"><p id="e017" class="kz la nj lb b lc ld ju le lf lg jx lh nk lj lk ll nl ln lo lp nm lr ls lt lu im bi translated">答案是一个大大的“是”。</p></blockquote><p id="af5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们是怎么做到的？</p><p id="a4de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们要求每个应用程序的所有者将XML格式的发票发送到中央计算机。我们编写了一个基于python的应用程序，运行在这台中央计算机上，扫描这些文件。它每隔几分钟扫描一次文件，将每个客户的文件整合成一个XML文件，创建pdf格式的发票，将整合后的发票通过电子邮件发送给客户，还将发票的副本发送给公司的文档管理应用程序。</p><p id="3aa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下流程解释了整体系统架构和解决方案。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/97204a998322580b70bc91a691707635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRnBqUKqeGr0Nn3zfXc83w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文档来源到存储和流通(图片由作者提供)</p></figure><p id="9384" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建这个应用程序我们需要什么？</p><p id="9d30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">a.<strong class="lb iu">读取单独的XML文件</strong>:每个应用程序都在发送XML格式的文件。我们需要一个文档对象模型(DOM)接口来读取这些XML文件。Python <a class="ae ky" href="https://docs.python.org/3/library/xml.dom.minidom.html" rel="noopener ugc nofollow" target="_blank">最小DOM实现</a> <strong class="lb iu"> minidom </strong>完美地满足了这一需求。</p><p id="1806" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">b.<strong class="lb iu">创建合并的XML文件</strong>:在读取来自不同应用程序的XML文件后，下一个任务是将它们合并到一个文件中。用于创建统一XML文件的Python框架。</p><p id="2255" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">c.<strong class="lb iu">创建pdf格式的发票</strong>:到目前为止，我们读取了不同的XML文件，并将它们合并成一个XML文件。下一个任务是创建pdf格式的专业发票。Python框架reportlab完成了这项工作。如果你想知道什么是reportlab，这里有来自<a class="ae ky" href="https://www.reportlab.com/opensource/" rel="noopener ugc nofollow" target="_blank">网站</a>的描述。</p><p id="9e23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nj"> ReportLab是久经考验的超级强大的开源引擎，用于创建复杂的数据驱动的PDF文档和自定义矢量图形。</em> <strong class="lb iu"> <em class="nj">它是免费的</em> </strong> <em class="nj">，开源，用Python写的。</em></p><p id="6683" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">d.<strong class="lb iu">通过电子邮件发送发票:</strong>创建了pdf格式的发票后，就可以通过电子邮件将它们发送给客户了。python框架<strong class="lb iu"> smtplib </strong>和<strong class="lb iu"> email </strong>通过公司的SMTP服务器将发票通过电子邮件发送给客户。</p><h1 id="d3ca" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设计</h1><p id="0e39" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在上面列出的四项主要任务中，最耗时的是创建pdf格式的发票。该公司对发票布局和发票上打印的信息量有非常严格的指导原则。一些关键的设计限制。</p><ol class=""><li id="165d" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu no my mz na bi translated">客户帐单寄送地址和送货地址应该只在第一页打印一次。</li><li id="8172" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu no my mz na bi translated">小字应该只印在最后一页。</li><li id="bf66" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu no my mz na bi translated">发货产品的序列号应与产品发货和发票明细一起打印在发票行上。</li><li id="ba5a" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu no my mz na bi translated">根据收货地址、省份和税码，会有所不同。应相应地打印明细税码和税额。</li><li id="3119" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu no my mz na bi translated">生产线上的任何特殊说明都应打印在生产线部分。</li></ol><p id="cf29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与此类似，几个要求使得整个发票布局成为一项困难的任务。</p><p id="bd2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是发票的整体布局。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/22b8c136f0f7a21fef157ef9a8c84be3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*wHedZ-A4mcbLJsLEpIrbCg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文档示例(图片由作者提供)</p></figure><h1 id="bb9e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">发展</h1><p id="7526" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在您已经理解了需求和总体设计，是时候更深入地研究组件开发了。让我们来看看这个应用程序的主要组件。</p><h2 id="2d9e" class="nq lw it bd lx nr ns dn mb nt nu dp mf li nv nw mh lm nx ny mj lq nz oa ml ob bi translated">步骤1:读取XML文件</h2><p id="07d3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">第一步是扫描每个应用程序的XML文件被发送到的文件夹。</p><ul class=""><li id="7040" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">Python库操作系统可用于监控文件夹中的传入文件。</li><li id="eb76" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">文档对象模型接口xml.dom的Python minidom模块可以用来解析每个文件中的xml数据。</li></ul><p id="f106" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是扫描文件夹下的文件，然后解析文件中的xml标记值的示例代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="5b34" class="nq lw it bd lx nr ns dn mb nt nu dp mf li nv nw mh lm nx ny mj lq nz oa ml ob bi translated">步骤2:编写XML文件</h2><p id="202b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">读取XML文件后，下一步是将数据合并到一个XML文件中。Python包yattag非常适合创建XML文件。</p><p id="11bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是使用yattag包创建XML文件的代码片段。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="6561" class="nq lw it bd lx nr ns dn mb nt nu dp mf li nv nw mh lm nx ny mj lq nz oa ml ob bi translated">步骤3:发票创建</h2><p id="4ead" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是项目的核心，也是最耗时的任务。这项任务包括读取XML文件以及创建pdf格式的发票布局。</p><p id="234b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建发票的第一步是导入reportlab的pdfgen包并实例化一个Canvas对象。创建对象时提及页面大小和文件名。一旦创建了canvas对象，您就可以像画家在画布上绘画一样开始构建内容。</p><p id="afbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在向画布添加内容时，确保选择合适的字体并提到x和y坐标。下面是创建对象和创建上述发票的前几行的代码片段。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="466f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从文件中选择徽标，并通过canvas对象invcanvas的drawImage方法将其分别放置在画布上的x和y坐标20和760处。</p><p id="5af2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，一切顺利。当你不得不把价值放在画布上的特定位置时，乐趣就开始了，但是内容和它们的总大小可能会随着每张发票而变化。例如，打印买方地址和收货地址。</p><p id="d801" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">reportlab的getSampleStyleSheet包最适合此类任务。将内容放在ParagraphStyle中，将它们放在一起并打印到画布上所需的位置会变得更容易。</p><p id="4094" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是示例代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="9883" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，发票的所有其他内容都是在发票画布上创建的。关键的部分是将它们放置在正确的坐标上，没有任何重叠。</p><h2 id="3ef2" class="nq lw it bd lx nr ns dn mb nt nu dp mf li nv nw mh lm nx ny mj lq nz oa ml ob bi translated">第四步:发电子邮件</h2><p id="25a7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Python电子邮件模块可用于通过电子邮件发送发票。下面的代码显示了自定义函数psendmail，它使用Python电子邮件模块和MIMEmultipart模块来编写电子邮件主题、正文并以附件形式发送发票。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><h1 id="b290" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="84f4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Python是一种多用途的开源编程语言，可以与数据科学和机器学习一起用于应用程序开发。使用Python开发文档管理应用程序非常有趣。</p><p id="d878" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我期待您对本文的反馈，以及您在工作中是如何使用Python的。</p><h1 id="75bb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考资料:</h1><p id="f760" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><a class="ae ky" href="https://docs.python.org/3/library/email.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/email.html</a></p><p id="8754" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">https://www.reportlab.com/opensource/<a class="ae ky" href="https://www.reportlab.com/opensource/" rel="noopener ugc nofollow" target="_blank"/></p><div class="oe of gp gr og oh"><a href="https://docs.python.org/3/library/xml.dom.minidom.html" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">xml.dom.minidom -最小dom实现- Python 3.10.5文档</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">源代码:Lib/xml/dom/minidom.py是文档对象模型接口的最小实现，带有API…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">docs.python.org</p></div></div></div></a></div><p id="038d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【https://www.reportlab.com/docs/reportlab-userguide.pdf T4】</p></div></div>    
</body>
</html>