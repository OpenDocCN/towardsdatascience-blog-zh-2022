<html>
<head>
<title>Learn How to Use NeoVim as an IDE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解如何使用 NeoVim 作为 IDE</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-how-to-use-neovim-as-an-ide-bc8a4b12cdb2#2022-12-22">https://towardsdatascience.com/learn-how-to-use-neovim-as-an-ide-bc8a4b12cdb2#2022-12-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="43f8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何设置和使用 NeoVim 的一步一步的教程，适合完全的初学者</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b1f5ba44b7228403c73e8ea1cfc2d266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3oe0yORBfZY_2b3MxbMweQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由 AltumCode 在 Unsplash 上拍摄</p></figure><p id="4697" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很多年前，我尝试了 NeoVim，我被需要的设置数量吓坏了，我跑了。</p><p id="ddd7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我跑到我的常规 VS 代码的舒适处。一个有效的 IDE，看起来不错，拥有我想要的大部分功能。</p><p id="c12d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我以为我在 VS 代码中是有效的，但后来我决定再试一次 NeoVim。</p><p id="86f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有些人可能会问，当您可以在一分钟内完成一个完整的工作时，为什么要花几个小时来设置一个 IDE，我同意。但是让我们面对现实吧，如果我们每天都要在 IDE 中工作，几个小时的配置并不是一件坏事。</p><p id="40f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用 NeoVim 的原因是它是超级可定制的，你真的可以让这个编辑器看起来像你想要的样子，让它的行为像你想要的样子。</p><p id="c724" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">NeoVim 的缺点也是定制能力，它需要一些时间来设置和修改在未来。但是一旦你知道如何添加你想要的任何特性，这并不困难或费时。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lu lv l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">你也可以在 YouTube 上看这篇文章</p></figure><p id="d27e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本教程不会给你一个完美的 IDE 配置，因为你可以搜索人们的点文件。本教程旨在帮助你理解 NeoVim 并学习如何管理它，让你以后可以构建任何你想要的东西。我不会期望在 Vi 或 NeoVim 中有任何先前的知识。</p><p id="bebb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你知道他们说什么吗</p><p id="2d5a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">给开发人员一个 IDE，他/她就会编码。</p><p id="0572" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">给开发者定制 IDE 的能力，他/她将成为开发者之神。</p><blockquote class="lw lx ly"><p id="0f75" class="ky kz lz la b lb lc ju ld le lf jx lg ma li lj lk mb lm ln lo mc lq lr ls lt im bi translated">如果你想了解更多关于 Vim 的知识，一本很棒的书是《现代 VIM》。你可以在这里找到<a class="ae md" href="https://amzn.to/3FWK5fQ" rel="noopener ugc nofollow" target="_blank"/>，链接是联盟链接，购买会赞助我。</p></blockquote><h2 id="10e8" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">安装 NeoVim 并打包插件管理器</h2><p id="21f1" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">按照<a class="ae md" href="https://github.com/neovim/neovim/wiki/Installing-Neovim" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的说明开始安装 NeoVim。如果你使用的是 ubuntu，我不推荐使用 apt-get install，因为它是一个旧版本。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="ec6d" class="nh mf it nd b be ni nj l nk nl">curl https://github.com/neovim/neovim/releases/download/stable/nvim-linux64.tar.gz<br/>tar -xvf nvim-linux64.tar.gz</span></pre><p id="12bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将解压后的文件夹移到存储软件的地方，或者将在<code class="fe nm nn no nd b">./nvim-linx64/bin/nvim</code>找到的二进制文件添加到您的 PATH 中。</p><p id="8add" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，您可以通过运行<code class="fe nm nn no nd b">nvim</code>来打开它</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="5117" class="nh mf it nd b be ni nj l nk nl">nvim</span></pre><p id="fbfa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这样做将打开 NeoVim 和一个闪屏。请记住，NeoVim 更多的是一个终端，而不是一个具有花哨 UI 的常规编辑器。</p><p id="ac8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您的终端应该如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/152e46e12ca471d2dd145f6591eed1cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OxsuADlOg5khX-UAubJJAg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">NeoVim 闪屏</p></figure><p id="c7a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们不开始添加一些插件，NeoVim 就没有什么特别的了。这是大部分人刚开始使用 NeoVim 时被吓跑的部分。所以让我们试着简单点。</p><p id="82da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你现在可以通过按下<code class="fe nm nn no nd b">SHIFT+:</code>关闭 NeoVim，这将打开命令提示符，然后在底部出现的选项卡中写下<code class="fe nm nn no nd b">q</code>，并按下 enter 键。</p><p id="6187" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按下<code class="fe nm nn no nd b">SHIFT+:</code>将打开命令选项卡，允许我们传递命令。</p><p id="0156" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要一个插件管理器，我们将使用的一个流行的插件是<a class="ae md" href="https://github.com/wbthomason/packer.nvim" rel="noopener ugc nofollow" target="_blank"> Packer </a>。</p><p id="4bda" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在 bash 中使用一行程序来安装它，它将获取存储库并将其放在第二个参数的<code class="fe nm nn no nd b">~/.local/share/nvim</code>路径中。除非你知道你在做什么，否则不要修改这个路径，它使用默认路径指向 Vim/NeoVim 中的 PackPath。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="a507" class="nh mf it nd b be ni nj l nk nl">git clone --depth 1 https://github.com/wbthomason/packer.nvim\<br/> ~/.local/share/nvim/site/pack/packer/start/packer.nvim</span></pre><p id="6f4e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们已经安装了 Packer，我们需要第一次访问插件配置文件。</p><p id="db35" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有的配置都保存在一个 LUA 文件中，默认保存在<code class="fe nm nn no nd b">~/.config/nvim/lua/</code>。在该位置，我们可以指定配置文件。</p><h2 id="5754" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">编写第一个配置&amp;导入插件&amp;导航</h2><p id="fd1d" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">NeoVim 中的一切几乎都是由一个插件处理的，例如，如果我们将 NeoVim 用作 IDE，我们将需要语言服务器来理解代码。</p><p id="b511" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将继续创建第一个配置文件，它将是<code class="fe nm nn no nd b">~/.config/nvim/lua/plugins.lua</code>。</p><p id="84b6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果该文件夹不存在，则创建它并通过用 NeoVim 打开它来创建文件。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="8718" class="nh mf it nd b be ni nj l nk nl">mkdir -p ~/.config/nvim/lua<br/>nvim ~/.config/nvim/lua/plugins.lua</span></pre><p id="a5f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过将名字传递给<code class="fe nm nn no nd b">require</code>函数，可以在 Lua 文件中导入 Packer。然后，我们将在 NeoVim 上运行一个名为<code class="fe nm nn no nd b">startup</code>的函数，该函数将在 NeoVim 启动时执行，这意味着每当 neo vim 启动时，我们都会添加插件和功能。</p><p id="7cd4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按下<code class="fe nm nn no nd b">Insert</code>或<code class="fe nm nn no nd b">i</code>进入插入模式，然后添加以下内容</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="abe3" class="nh mf it nd b be ni nj l nk nl">return require('packer').startup(function(use)<br/>  -- Configurations will go here soon<br/> use 'wbthomason/packer.nvim'<br/>end)</span></pre><p id="e650" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们所做的是让 packer 在启动时运行，然后导入我们想要使用的所有插件，我们还包括 Packer 插件。这允许包装商自我管理和更新等。</p><p id="efb3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按<code class="fe nm nn no nd b">ESC</code>退出插入模式，打开命令选项卡<code class="fe nm nn no nd b">SHIFT+:</code>并传入<code class="fe nm nn no nd b">w</code>保存文件，T10 是 write 的缩写。</p><p id="745f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你现在重启 NeoVim，什么都不会改变，很郁闷吧？</p><p id="f7c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还需要告诉 NeoVim 找到这个配置文件并加载它。</p><p id="6afc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可以在第二个配置文件<code class="fe nm nn no nd b">~/.config/nvim/init.lua</code>中完成，这个文件在启动时由 NeoVim 执行，我们将需要 Lua 中的配置脚本。</p><p id="e2ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">再次打开<code class="fe nm nn no nd b">plugins.lua</code>文件，让我们学习如何在 NeoVim 中导航(暂时),这样我们就不需要一直跳出去了。</p><p id="d5f5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦 NeoVim 打开，输入命令<code class="fe nm nn no nd b">Explore</code>，这将为我们打开一个基于文本的浏览器。它叫<a class="ae md" href="https://neovim.io/doc/user/pi_netrw.html" rel="noopener ugc nofollow" target="_blank"> Netrw </a>，我就不细说了，它甚至可以抓取远程文件等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/924a8782821ffc1fcf2cb6679deeb260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pVJNfoFoPk5jU107aGTUdQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">探索显示 NetRW 目录列表</p></figure><p id="9b18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这里，您可以看到当前目录中的文件，以及默认的 Linux 路径指示器<code class="fe nm nn no nd b">./</code>和<code class="fe nm nn no nd b">../</code>。一个点是当前目录，两个点是父目录。</p><p id="2dd3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们想在父目录中创建<code class="fe nm nn no nd b">init.lua</code>文件，所以选择<code class="fe nm nn no nd b">../</code>后按 enter 键，然后按<code class="fe nm nn no nd b">SHIFT+%</code>。Shift+%会在底部打开一个输入栏，要求输入文件名，输入<code class="fe nm nn no nd b">init.lua</code>。它将在创建文件后打开它。</p><p id="3d20" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将向它添加一行，如果它不存在，则创建该文件。这一行将确保插件被添加。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="c068" class="nh mf it nd b be ni nj l nk nl">require('plugins')</span></pre><p id="d218" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用<code class="fe nm nn no nd b">w</code>命令保存并重启 NeoVim，我们应该已经安装了 Packer，我们可以通过运行命令来控制它。</p><p id="5c74" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果 Packer 安装正确，我们应该可以使用它的命令，其中一个是<code class="fe nm nn no nd b">PackerStatus</code>，它打印所有使用的插件列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/135a820ad7e135d1f2b10040d9df74c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*4DXeOtbxXIXZF_FnxTrJ7g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PackerStatus 输出所有使用的插件</p></figure><p id="e017" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以按 q 键把状态栏打印下来。</p><p id="4aaa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">简而言之，我们到目前为止所做的。</p><ol class=""><li id="cab7" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">学习了如何使用 Packer 来导入插件，<code class="fe nm nn no nd b">~/.config/nvim/lua/plugins.lua</code>与此相关。</li><li id="89cc" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated"><code class="fe nm nn no nd b">~/.config/nvim/init.lua</code>允许我们告诉 NeoVim 在启动时尊重我们的 Packer 文件。</li><li id="3028" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">使用<code class="fe nm nn no nd b">SHIFT+:</code>运行命令，如<code class="fe nm nn no nd b">PackerStatus</code>。</li><li id="e8cc" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">学习如何使用<code class="fe nm nn no nd b">Explore</code>命令导航。</li></ol><p id="661e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，这可能看起来不太令人印象深刻，我同意。让我们添加更多的插件。</p><p id="d74b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们要编码，所以我们需要语言服务器和调试器等插件。有一个很棒的插件叫做<a class="ae md" href="https://github.com/williamboman/mason.nvim" rel="noopener ugc nofollow" target="_blank"> Mason </a>可以用来做这个，让我们更新一下打包器的配置，你现在应该知道是哪个文件了吧！我们还将获取<code class="fe nm nn no nd b">neovim/nvim-lspconfig</code>，这使我们能够获取不同 LSP 的不同配置，查看<a class="ae md" href="https://github.com/neovim/nvim-lspconfig/blob/master/doc/server_configurations.md" rel="noopener ugc nofollow" target="_blank">文档</a>以获得完整列表。</p><p id="51f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将插件配置更新为以下内容。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="3485" class="nh mf it nd b be ni nj l nk nl">return require('packer').startup(function(use)<br/>        -- Configurations will go here<br/>        use 'wbthomason/packer.nvim'<br/>        use 'williamboman/mason.nvim'   <br/>        use 'williamboman/mason-lspconfig.nvim'<br/>        use 'neovim/nvim-lspconfig'  <br/> <br/>end)</span></pre><p id="be9c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦完成，打开命令栏<code class="fe nm nn no nd b">SHIFT+:</code>保存文件，然后运行命令<code class="fe nm nn no nd b">w</code>，它将记录下你所做的任何更改。</p><p id="55f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经保存了文件，但是我们需要重新加载它，这样 Packer 才能注意到这些变化，所以打开命令栏，输入下面的命令，它将重新加载当前打开的 lua 文件。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="355a" class="nh mf it nd b be ni nj l nk nl">:luafile %</span></pre><p id="d659" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后执行<code class="fe nm nn no nd b">PackerInstall</code>命令下载新插件。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="3bd0" class="nh mf it nd b be ni nj l nk nl">:PackerInstall</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/e3ab44af764ddba04c6d672af4ac3635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*u_rROpurxHFBsOud1HXW1w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PackerInstall 显示成功安装的软件包</p></figure><p id="fe27" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，我们现在安装的插件只帮助我们设置和配置 LSP。例如，如果我们想要 GOPLS，它不会为我们下载它们，我们仍然需要单独安装。</p><h2 id="55f8" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">启用语言服务器协议支持</h2><p id="20a7" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">使用 nvim-lspconfig 要求我们安装第三方语言服务器，然后可以连接到 NeoVim。这就是我如何在 Mason 的帮助下启用 GOPLS 的。</p><p id="c3c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们首先启用 Mason，这与 Packer 的做法相同，我们创建一个 lua 脚本来启用它，然后在<code class="fe nm nn no nd b">init.lua</code>中需要该脚本。</p><p id="2340" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从创建 lua 文件来管理 mason 开始。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="79f0" class="nh mf it nd b be ni nj l nk nl">touch ~/.config/nvim/lua/mason-config.lua</span></pre><p id="30ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后打开文件，并填写下面的代码，要求插件和调用他们的设置功能。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="fcb0" class="nh mf it nd b be ni nj l nk nl">require("mason").setup()<br/>require("mason-lspconfig").setup()</span></pre><p id="ca71" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用<code class="fe nm nn no nd b">w</code>保存文件。</p><p id="b860" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们通过使用名称前缀<code class="fe nm nn no nd b">mason-config</code>来更新<code class="fe nm nn no nd b">init.lua</code>以要求该脚本。在文件之间切换时，记得使用<code class="fe nm nn no nd b">Explore</code>。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="e978" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('mason-config')</span></pre><p id="1359" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦完成，打开 NeoVim 应该有新的<code class="fe nm nn no nd b">Mason</code>命令，这将为我们打开一个设置管理器。</p><p id="ea0e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您使用的是早于 0.7 的 NeoVim 版本，打开 NeoVim 时可能会出现错误，请按 enter 键并运行命令</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="8b1f" class="nh mf it nd b be ni nj l nk nl">:checkhealth</span></pre><p id="022f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个非常有用的命令，用于测试和检测任何错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/1d9314b9f3ef013db8334c2b14331587.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*v4-RmEsyHB8-HN1Wdy9AmA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">运行旧版本 NeoVim 时出错</p></figure><p id="e5fc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行<code class="fe nm nn no nd b">:Mason</code>将调出所有可用的 LSP，找到您拥有的 LSP，并记住名称。我就装<code class="fe nm nn no nd b">gopls</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/597d31aef4b6edbc12c5b3eb43d0bf15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cNh2WxiK7J3EkqoD0Ig3oQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Mason 命令调出一个 UI 来设置语言服务器</p></figure><p id="a2de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要安装它，运行命令，添加您想要的任何包，如果您添加了许多包，那么用空格将它们分开。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="24fc" class="nh mf it nd b be ni nj l nk nl">MasonInstall gopls</span></pre><p id="1f41" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，每个安装可能需要您安装软件，就像 gopls 安装需要 go 一样。</p><p id="4f8e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在 gopls 已经安装好了，我们需要让 NeoVim 附加上它。</p><p id="8dc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这真的很简单，过程现在应该很熟悉了，我们将在 lua 文件夹中创建一个<code class="fe nm nn no nd b">gopls.lua</code>文件，然后我们将在<code class="fe nm nn no nd b">init.lua</code>中需要该脚本。</p><p id="1b36" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nm nn no nd b">gopls.lua</code>将导入 lspconfig 包，它允许我们将 gopls 附加到 neovim。</p><p id="5fb1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以配置 gopls 来做很多事情，我们将使用 gopls 文档中的简单示例，每个服务器都有自己的一组配置，您需要查看它们的文档来指定哪些内容。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="f22a" class="nh mf it nd b be ni nj l nk nl"> -- Require LSP config which we can use to attach gopls<br/>  lspconfig = require "lspconfig"<br/>  util = require "lspconfig/util"<br/>-- Since we installed lspconfig and imported it, we can reach<br/>-- gopls by lspconfig.gopls<br/>-- we can then set it up using the setup and insert the needed configurations<br/>  lspconfig.gopls.setup {<br/>    cmd = {"gopls", "serve"},<br/>    filetypes = {"go", "gomod"},<br/>    root_dir = util.root_pattern("go.work", "go.mod", ".git"),<br/>    settings = {<br/>      gopls = {<br/>        analyses = {<br/>          unusedparams = true,<br/>        },<br/>        staticcheck = true,<br/>      },<br/>    },<br/>  }</span></pre><p id="8495" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你正在使用 go，你会想添加更多的分析等，但我们在这里如何学习如何设置，然后定制是由你决定的。</p><blockquote class="lw lx ly"><p id="db9e" class="ky kz lz la b lb lc ju ld le lf jx lg ma li lj lk mb lm ln lo mc lq lr ls lt im bi translated">我向你推荐 go 版的<a class="ae md" href="https://github.com/ray-x/go.nvim" rel="noopener ugc nofollow" target="_blank"> ray-x </a>，按照本教程学习后，它应该很容易安装。</p></blockquote><p id="f4b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">确保在<code class="fe nm nn no nd b">init.lua</code>中需要新的 lua 脚本。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="2ace" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('mason-config')<br/>require('gopls')</span></pre><p id="9402" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在创建一个<code class="fe nm nn no nd b">main.go</code>,看看它是否能检测到错误，这里有一张图片显示了我的错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/0febf6e12fe562b38855c1d664142376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*-BJpDe21Gliom6GnfPDpRA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">main.go 文件中出现错误</p></figure><h2 id="c49a" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">代码完成和建议</h2><p id="873f" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们正朝着正确的方向前进，但我们看到了错误。不知道大家注意到没有代码补全或者建议。</p><p id="8760" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那是编辑器里的超级必备，我们来补充一下。</p><p id="5f66" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">补充一下，我们需要一个…..<em class="lz">鼓点</em>，等着吧，一个插件！</p><p id="59c0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将利用<a class="ae md" href="https://github.com/hrsh7th/" rel="noopener ugc nofollow" target="_blank"> hrsh7th </a>插件为这个或插件。</p><p id="e7db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">他有一整套插件，我会把链接放在这里，但我不会详细介绍它们</p><ul class=""><li id="5881" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt ok ny nz oa bi translated">nvim-CMP—neo vim 的完井引擎插件</li><li id="568f" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated"><a class="ae md" href="https://github.com/hrsh7th/cmp-nvim-lsp" rel="noopener ugc nofollow" target="_blank">CMP-nvim-LSP</a>—neo vim 内置语言服务器客户端的 nvim-cmp 源代码。</li><li id="376a" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated"><a class="ae md" href="https://github.com/hrsh7th/cmp-nvim-lsp-signature-help" rel="noopener ugc nofollow" target="_blank">CMP-nvim-LSP-signature-help</a>—nvim-CMP 源，用于显示强调当前参数的函数签名:</li><li id="6bb2" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated"><a class="ae md" href="https://github.com/hrsh7th/cmp-nvim-lua" rel="noopener ugc nofollow" target="_blank">CMP-nvim-Lua</a>—neovim Lua API 的 nvim-cmp 源代码。</li><li id="3d84" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated"><a class="ae md" href="https://github.com/hrsh7th/vim-vsnip" rel="noopener ugc nofollow" target="_blank"> vim-vsnip </a> —创建和使用 vs 代码片段的能力。</li><li id="2296" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated"><a class="ae md" href="https://github.com/hrsh7th/cmp-path" rel="noopener ugc nofollow" target="_blank"> cmp-path </a> —文件系统路径的 nvim-cmp 源文件。</li><li id="965f" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated"><a class="ae md" href="https://github.com/hrsh7th/cmp-buffer" rel="noopener ugc nofollow" target="_blank"> cmp-buffer </a> —缓冲字的 nvim-cmp 源。</li></ul><p id="5c89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以将所有这些插件添加到<code class="fe nm nn no nd b">lua/plugins.lua</code>文件中。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="88e0" class="nh mf it nd b be ni nj l nk nl">-- Hrsh7th Code Completion Suite<br/>    use 'hrsh7th/nvim-cmp' <br/>    use 'hrsh7th/cmp-nvim-lsp'<br/>    use 'hrsh7th/cmp-nvim-lua'<br/>    use 'hrsh7th/cmp-nvim-lsp-signature-help'<br/>    use 'hrsh7th/cmp-vsnip'                             <br/>    use 'hrsh7th/cmp-path'                              <br/>    use 'hrsh7th/cmp-buffer'                            <br/>    use 'hrsh7th/vim-vsnip'</span></pre><p id="d09c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后通过运行<code class="fe nm nn no nd b">:w</code>命令保存文件，用<code class="fe nm nn no nd b">:luafile %</code>重新加载 lua 文件，然后用<code class="fe nm nn no nd b">:PackerSync</code>同步软件包，这将删除任何未使用的插件，并安装新的插件。</p><p id="6928" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦完成，我们需要在<code class="fe nm nn no nd b">lua/code-completion.lua</code>中编写一个新的配置文件，我们用它来管理插件，并配置它们按照我们想要的方式运行。</p><p id="50e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们希望出现一个带有代码建议的小弹出对话框，这可以使用 NeoVim 中可用的许多配置之一来完成，所有配置都可以在这里找到<a class="ae md" href="https://neovim.io/doc/user/options.html" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="6a50" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们正在寻找的是<code class="fe nm nn no nd b">vim.opt.<a class="ae md" href="https://neovim.io/doc/user/options.html#'completeopt'" rel="noopener ugc nofollow" target="_blank">completeopt</a></code>，这是用来使一个菜单出现的建议。所有可用的配置都在<a class="ae md" href="https://neovim.io/doc/user/options.html#'completeopt'" rel="noopener ugc nofollow" target="_blank">文档</a>中，我将只在每个文档上方留下注释来解释它。</p><p id="bfc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，我们将需要<code class="fe nm nn no nd b">cmp</code>，它允许我们配置插件。我们将调用 setup 函数在设置时应用一些设置。</p><p id="9a62" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该文件在开始时将如下所示</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="ea10" class="nh mf it nd b be ni nj l nk nl">-- completeopt is used to manage code suggestions<br/>-- menuone: show popup even when there is only one suggestion<br/>-- noinsert: Only insert text when selection is confirmed<br/>-- noselect: force us to select one from the suggestions<br/>vim.opt.completeopt = {'menuone', 'noselect', 'noinsert', 'preview'}<br/>-- shortmess is used to avoid excessive messages<br/>vim.opt.shortmess = vim.opt.shortmess + { c = true}<br/><br/>local cmp = require'cmp'<br/>cmp.setup({ <br/>  -- Configurations will go here<br/>})</span></pre><p id="35bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要配置的第一件事是源代码，我们在这里做的是将已安装的插件设置为代码建议的源代码。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="35af" class="nh mf it nd b be ni nj l nk nl">-- sources are the installed sources that can be used for code suggestions<br/> sources = {<br/>      { name = 'path' },<br/>      { name = 'nvim_lsp', keyword_length = 3 },<br/>      { name = 'nvim_lsp_signature_help'}, <br/>      { name = 'nvim_lua', keyword_length = 2},<br/>      { name = 'buffer', keyword_length = 2 },<br/>      { name = 'vsnip', keyword_length = 2 },<br/> }</span></pre><p id="c1e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，我们将想要添加映射！</p><p id="4905" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">映射非常有趣，这意味着我们可以创建键盘快捷键来执行某些命令。如果代码建议对话框显示选项，我们如何选择我们想要的选项，如何确认，当我们确认时会发生什么？</p><p id="2010" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">映射很容易建立，我们做的第一件事是声明激活动作的键。语法是<code class="fe nm nn no nd b">&lt;Key-Key2-Key3&gt;</code>，可能需要一段时间来学习哪些键是可用的，但是<a class="ae md" href="https://neovim.io/doc/user/intro.html" rel="noopener ugc nofollow" target="_blank">文档</a>为我们提供了帮助。</p><p id="c859" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望有和我在 VS 代码中使用的相同的映射，但是你可以按照你想要的方式设置它！我将使用缩写为<code class="fe nm nn no nd b">C</code>的 CTRL。如何在按下<code class="fe nm nn no nd b">CTRL+SPACE</code>时触发代码完成对话框的示例如下所示。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="dc08" class="nh mf it nd b be ni nj l nk nl"> ['&lt;C-Space&gt;'] = cmp.mapping.complete(),</span></pre><p id="6d43" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们使用的 cmp 包有几个可以调用的可用函数，它们都出现在这里<a class="ae md" href="https://github.com/hrsh7th/nvim-cmp/blob/main/doc/cmp.txt" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="cf96" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将在每个映射上面添加注释，下面是我的<code class="fe nm nn no nd b">code-completion.lua</code>如何处理映射。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="6cc2" class="nh mf it nd b be ni nj l nk nl">-- completeopt is used to manage code suggestions<br/>-- menuone: show popup even when there is only one suggestion<br/>-- noinsert: Only insert text when selection is confirmed<br/>-- noselect: force us to select one from the suggestions<br/>vim.opt.completeopt = {'menuone', 'noselect', 'noinsert', 'preview'}<br/>-- shortmess is used to avoid excessive messages<br/>vim.opt.shortmess = vim.opt.shortmess + { c = true}<br/><br/>local cmp = require'cmp'<br/>cmp.setup({ <br/><br/>  mapping = {<br/>    -- Shift+TAB to go to the Previous Suggested item<br/>    ['&lt;S-Tab&gt;'] = cmp.mapping.select_prev_item(),<br/>    -- Tab to go to the next suggestion<br/>    ['&lt;Tab&gt;'] = cmp.mapping.select_next_item(),<br/>    -- CTRL+SHIFT+f to scroll backwards in description<br/>    ['&lt;C-S-f&gt;'] = cmp.mapping.scroll_docs(-4),<br/>    -- CTRL+F to scroll forwards in the description<br/>    ['&lt;C-f&gt;'] = cmp.mapping.scroll_docs(4),<br/>    -- CTRL+SPACE to bring up completion at current Cursor location<br/>    ['&lt;C-Space&gt;'] = cmp.mapping.complete(),<br/>    -- CTRL+e to exit suggestion and close it<br/>    ['&lt;C-e&gt;'] = cmp.mapping.close(),<br/>    -- CR (enter or return) to CONFIRM the currently selection suggestion<br/>    -- We set the ConfirmBehavior to insert the Selected suggestion<br/>    ['&lt;CR&gt;'] = cmp.mapping.confirm({<br/>      behavior = cmp.ConfirmBehavior.Insert,<br/>      select = true,<br/>    })<br/>  },<br/><br/>  -- sources are the installed sources that can be used for code suggestions<br/> sources = {<br/>      { name = 'path' },<br/>      { name = 'nvim_lsp', keyword_length = 3 },<br/>      { name = 'nvim_lsp_signature_help'}, <br/>      { name = 'nvim_lua', keyword_length = 2},<br/>      { name = 'buffer', keyword_length = 2 },<br/>      { name = 'vsnip', keyword_length = 2 },<br/> }<br/>})</span></pre><p id="f66c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打开<code class="fe nm nn no nd b">init.lua</code>并将<code class="fe nm nn no nd b">code-completion.lua</code>添加到文件中。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="7e17" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('mason-config')<br/>require('gopls')</span></pre><p id="8c8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦在配置中，保存它，打开一个新的<code class="fe nm nn no nd b">.go</code>文件，并尝试它！您应该看到代码建议，并且能够使用键映射来导航这些建议。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/7cb4db286ff48b05870d04b2c613d690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kth8lXD7TmUhFh5U41NMzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码建议现在起作用了</p></figure><p id="994d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想要启用 vsnip 插件，我们还需要将以下代码添加到<code class="fe nm nn no nd b">code-completion.lua</code>中。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="1d63" class="nh mf it nd b be ni nj l nk nl">  snippet = {<br/>    expand = function(args)<br/>        vim.fn["vsnip#anonymous"](args.body)<br/>    end,<br/>  },</span></pre><p id="7f4b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在窗户上加一些边框，让它看起来好一点。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="1cad" class="nh mf it nd b be ni nj l nk nl">  window = {<br/>      completion = cmp.config.window.bordered(),<br/>      documentation = cmp.config.window.bordered(),<br/>  },</span></pre><p id="c5bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们添加它，它将看起来像下面这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/acee3b1c41642ee6596a1a2a118a6fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ELEWY9Zo0bYIep1LAAEHMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为建议添加边框</p></figure><p id="a4ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有时编辑格式可能是有意义的，例如，我们可以根据建议的来源添加图标。下面的代码片段根据源的名称添加格式。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="c52a" class="nh mf it nd b be ni nj l nk nl">-- completeopt is used to manage code suggestions<br/>-- menuone: show popup even when there is only one suggestion<br/>-- noinsert: Only insert text when selection is confirmed<br/>-- noselect: force us to select one from the suggestions<br/>vim.opt.completeopt = {'menuone', 'noselect', 'noinsert', 'preview'}<br/>-- shortmess is used to avoid excessive messages<br/>vim.opt.shortmess = vim.opt.shortmess + { c = true}<br/><br/><br/><br/>local cmp = require'cmp'<br/>cmp.setup({ <br/>  -- Required by vsnip<br/>  snippet = {<br/>    expand = function(args)<br/>        vim.fn["vsnip#anonymous"](args.body)<br/>    end,<br/>  },<br/>  -- Add Mappings to control the code suggestions<br/>  mapping = {<br/>    -- Shift+TAB to go to the Previous Suggested item<br/>    ['&lt;S-Tab&gt;'] = cmp.mapping.select_prev_item(),<br/>    -- Tab to go to the next suggestion<br/>    ['&lt;Tab&gt;'] = cmp.mapping.select_next_item(),<br/>    -- CTRL+SHIFT+f to scroll backwards in description<br/>    ['&lt;C-S-f&gt;'] = cmp.mapping.scroll_docs(-4),<br/>    -- CTRL+F to scroll forwards in the description<br/>    ['&lt;C-f&gt;'] = cmp.mapping.scroll_docs(4),<br/>    -- CTRL+SPACE to bring up completion at current Cursor location<br/>    ['&lt;C-Space&gt;'] = cmp.mapping.complete(),<br/>    -- CTRL+e to exit suggestion and close it<br/>    ['&lt;C-e&gt;'] = cmp.mapping.close(),<br/>    -- CR (enter or return) to CONFIRM the currently selection suggestion<br/>    -- We set the ConfirmBehavior to insert the Selected suggestion<br/>    ['&lt;CR&gt;'] = cmp.mapping.confirm({<br/>      behavior = cmp.ConfirmBehavior.Insert,<br/>      select = true,<br/>    })<br/>},<br/><br/>  -- sources are the installed sources that can be used for code suggestions<br/>  sources = {<br/>      { name = 'path' },<br/>      { name = 'nvim_lsp', keyword_length = 3 },<br/>      { name = 'nvim_lsp_signature_help'}, <br/>      { name = 'nvim_lua', keyword_length = 2},<br/>      { name = 'buffer', keyword_length = 2 },<br/>      { name = 'vsnip', keyword_length = 2 },<br/>  },<br/>  -- Add borders to the windows<br/>   window = {<br/>      completion = cmp.config.window.bordered(),<br/>      documentation = cmp.config.window.bordered(),<br/>  },<br/>  -- add formating of the different sources<br/>    formatting = {<br/>      fields = {'menu', 'abbr', 'kind'},<br/>      format = function(entry, item)<br/>          local menu_icon ={<br/>              nvim_lsp = 'λ',<br/>              vsnip = '⋗',<br/>              buffer = 'b',<br/>              path = 'p'<br/>          }<br/>          item.menu = menu_icon[entry.source.name]<br/>          return item<br/>      end,<br/>  },<br/>})</span></pre><p id="6ac7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">应用后，你应该会看到小图标或文字取决于来源。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6eeb6788991d6262ab8e1209ca765fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*hFhDmYkFtRlhOdzZAq7bug.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示信号源的图标</p></figure><p id="1d59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在已经有了代码完成功能，但是我们还可以做得更多！</p><h2 id="a74c" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">文件树&amp;简单遍历&amp;第一个自定义键映射</h2><p id="437c" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">到目前为止，我们一直使用<code class="fe nm nn no nd b">Explore</code>命令来切换文件。如果你想保持理智，我不建议你在开发环境中这么做。</p><p id="20a6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">幸运的是，在 NeoVim 中有一个简单的解决方案。有一个非常流行的插件叫做<code class="fe nm nn no nd b">nvim-tree</code>，可以在<a class="ae md" href="https://github.com/nvim-tree/nvim-tree.lua" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><p id="8ac3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在安装它应该是轻而易举的。</p><p id="c749" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打开 Packer 配置文件<code class="fe nm nn no nd b">plugins.lua</code>并添加 Nvim 插件。我们将添加<code class="fe nm nn no nd b">nvim-web-devicons</code>使新的文件浏览器更好看一些。</p><p id="196e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这一次，你会在 Packer 配置中看到一个新的语法，我们不会使用一个字符串来导入插件，而是一个内部有需求的对象。</p><p id="e247" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着我们将需要 nvim-tree 插件，但也需要 devicons。这可以用来确保我们有所有需要的插件，而不是只有一个。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="c04e" class="nh mf it nd b be ni nj l nk nl">return require('packer').startup(function(use)<br/> -- Configurations will go here<br/> use 'wbthomason/packer.nvim'<br/> use 'williamboman/mason.nvim'<br/> use 'williamboman/mason-lspconfig.nvim'<br/> use 'neovim/nvim-lspconfig'<br/> -- Hrsh7th Code Completion Suite<br/> use 'hrsh7th/nvim-cmp' <br/> use 'hrsh7th/cmp-nvim-lsp'<br/> use 'hrsh7th/cmp-nvim-lua'<br/> use 'hrsh7th/cmp-nvim-lsp-signature-help'<br/> use 'hrsh7th/cmp-vsnip'                             <br/> use 'hrsh7th/cmp-path'                              <br/> use 'hrsh7th/cmp-buffer'                            <br/> use 'hrsh7th/vim-vsnip'<br/> -- File explorer tree<br/> use {<br/>  'nvim-tree/nvim-tree.lua',<br/>    requires = {<br/>      'nvim-tree/nvim-web-devicons', -- optional, for file icons<br/>    },<br/> }<br/>end)</span></pre><p id="6fa0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，为了让 devicons 正常工作，你需要安装书呆子字体，如果你不想要，就跳过这个要求。书呆子字体很容易安装滚动到网页底部，并安装他们的修补软件。</p><p id="71e6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下载一个字体，我用<code class="fe nm nn no nd b">Go-Mono</code>然后把它添加为字体，我推荐用<code class="fe nm nn no nd b">font-manager</code>，这里看怎么用<a class="ae md" href="https://itsfoss.com/font-manager/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="68ad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦完成，保存文件<code class="fe nm nn no nd b">:w</code>，然后重新加载<code class="fe nm nn no nd b">luafile %</code>，然后用<code class="fe nm nn no nd b">PackerSync</code>更新插件。</p><p id="019a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们希望在启动时配置 NvimTree，我们将从他们的文档中获取配置，但添加它以便树在启动时打开。</p><p id="e8ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建一个新的 lua 脚本并适当地命名，我将命名我的<code class="fe nm nn no nd b">file-explorer.lua</code>。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="7f37" class="nh mf it nd b be ni nj l nk nl">-- disable netrw at the very start of your init.lua (strongly advised)<br/>vim.g.loaded_netrw = 1<br/>vim.g.loaded_netrwPlugin = 1<br/><br/>-- set termguicolors to enable highlight groups<br/>vim.opt.termguicolors = true<br/><br/>-- empty setup using defaults<br/>require("nvim-tree").setup({<br/>  open_on_setup = true,<br/>  ignore_buffer_on_setup = true,<br/>})</span></pre><p id="71d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们要求<code class="fe nm nn no nd b">init.lua</code>里面的脚本</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="c90e" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('file-explorer')<br/>require('mason-config')<br/>require('gopls')<br/>require('code-completion')</span></pre><p id="6496" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重新启动 NeoVim 将会显示一个新的漂亮的文件树，这样我们就可以导航了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/798e0726d11b7486d09c3cd885ecef67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*38WKXcVfK1IX781tNz1Wgg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">NvimTree 现在显示文件和目录</p></figure><p id="4b8e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用鼠标或它附带的许多默认映射，在树中导航很容易。我推荐这本<a class="ae md" href="https://docs.rockylinux.org/books/nvchad/nvchad_ui/nvimtree/" rel="noopener ugc nofollow" target="_blank">指南</a>，它很适合学习。</p><p id="6333" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以使用快捷键<code class="fe nm nn no nd b">CTRL+w</code>进入导航模式，该模式允许您在打开的面板之间跳转，按左键或右键向该方向跳转。您也可以使用<code class="fe nm nn no nd b">CTRL+w+w</code>快速跳到下一个面板。</p><p id="2c8d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能需要了解一些不错的命令。一旦你进入 NvimTree，按<code class="fe nm nn no nd b">a</code>将允许你创建一个文件，<code class="fe nm nn no nd b">d</code>将删除一个文件。</p><p id="c32e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按下<code class="fe nm nn no nd b">q</code>将关闭该树，要打开它，我们可以运行长而不必要的命令<code class="fe nm nn no nd b">:NvimTreeToggle</code>。</p><p id="9609" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我喜欢在按下<code class="fe nm nn no nd b">ctrl+n</code>时打开树，所以我将添加映射。</p><p id="5691" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用 NvimTree，我将转到<code class="fe nm nn no nd b">lua</code>目录并创建一个<code class="fe nm nn no nd b">custom-keys.lua</code>文件，我将在其中存储我的个人键映射。我可以通过按下<code class="fe nm nn no nd b">a</code>来创建文件。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="e291" class="nh mf it nd b be ni nj l nk nl">-- fetch keymap<br/>local map = vim.api.nvim_set_keymap<br/><br/>-- map the key n to run the command :NvimTreeToggle<br/>map('n', 'n', [[:NvimTreeToggle&lt;CR&gt;]], {})</span></pre><p id="82f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在脚本中，我们使用 nvim api 的一部分<code class="fe nm nn no nd b">vim.api.nvim_set_keymap</code>来创建自定义键映射。查看他们的<a class="ae md" href="https://neovim.io/doc/user/api.html#nvim_set_keymap()" rel="noopener ugc nofollow" target="_blank">文档</a>了解所有可用的设置和模式。</p><p id="7a1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个参数指定启用键映射的模式，我希望它处于正常模式。您也可以在其他模式下使用它，例如插入模式。</p><p id="ed63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们设置按 n 将触发<code class="fe nm nn no nd b">:NvimTreeToggle</code>命令，我们添加<code class="fe nm nn no nd b">&lt;CR&gt;</code>来自动触发命令，我们不想每次都按 enter。</p><p id="d49b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，当然，我们需要更新<code class="fe nm nn no nd b">init.lua</code>来包含<code class="fe nm nn no nd b">custom-keys</code>文件。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="7508" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('file-explorer')<br/>require('mason-config')<br/>require('gopls')<br/>require('code-completion')<br/>require('custom-keys')</span></pre><p id="24ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重新打开 NeoVim 并按下<code class="fe nm nn no nd b">n</code>将会打开 NvimTree，你应该把它设置成你觉得舒服的键。</p><h2 id="b46b" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">使用 DAP 和 DapUI 调试</h2><p id="f160" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们现在有了一个文件树，我们有了代码完成，还有一个语言服务器，它会告诉我们什么时候出错了。</p><p id="cd3f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">开发时的一件重要事情是测试和调试代码，所以我们需要添加这一点。</p><p id="ec50" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以再次使用 Mason 插件，我们想要安装一个 DAP，因为我关注 Go，所以我想要<a class="ae md" href="https://github.com/go-delve/delve" rel="noopener ugc nofollow" target="_blank"> Delve </a>。</p><p id="e228" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行命令</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="1e78" class="nh mf it nd b be ni nj l nk nl">:MasonInstall delve</span></pre><p id="3f67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，我们需要安装一个名为<code class="fe nm nn no nd b">nvim-dap</code>的<a class="ae md" href="https://github.com/mfussenegger/nvim-dap" rel="noopener ugc nofollow" target="_blank">插件</a>，用于管理多种语言的 DAP。</p><p id="75e6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">把它添加到<code class="fe nm nn no nd b">plugins.lua</code>，保存文件并重新加载它，你记得怎么对吗？然后执行<code class="fe nm nn no nd b">PackerSync</code>。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="4fc7" class="nh mf it nd b be ni nj l nk nl">return require('packer').startup(function(use)<br/> -- Configurations will go here<br/> use 'wbthomason/packer.nvim'<br/> use 'williamboman/mason.nvim'<br/> use 'williamboman/mason-lspconfig.nvim'<br/> use 'neovim/nvim-lspconfig'<br/> -- Hrsh7th Code Completion Suite<br/>     use 'hrsh7th/nvim-cmp' <br/>     use 'hrsh7th/cmp-nvim-lsp'<br/>     use 'hrsh7th/cmp-nvim-lua'<br/>     use 'hrsh7th/cmp-nvim-lsp-signature-help'<br/>     use 'hrsh7th/cmp-vsnip'                             <br/>     use 'hrsh7th/cmp-path'                              <br/>     use 'hrsh7th/cmp-buffer'                            <br/>     use 'hrsh7th/vim-vsnip'<br/> -- File explorer tree<br/>     use 'nvim-tree/nvim-web-devicons' -- optional, for file icons<br/> use 'nvim-tree/nvim-tree.lua'<br/> -- DAP for debugging<br/> use 'mfussenegger/nvim-dap'<br/>end)</span></pre><p id="9822" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据您想要调试的语言，我们需要对其进行配置。您可以在<a class="ae md" href="https://github.com/mfussenegger/nvim-dap/wiki/Debug-Adapter-installation#Go" rel="noopener ugc nofollow" target="_blank">文档</a>中找到不同语言的完整示例列表。</p><p id="c42f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从要求 dap 开始，然后您可以使用<code class="fe nm nn no nd b">dap.adapters</code>后跟适配器名称来定位 DAP。在我的例子中，我的目标是<code class="fe nm nn no nd b">delve</code>，它将是<code class="fe nm nn no nd b">dap.adapters.delve</code>。应该为每个适配器检查要设置的配置，我将简单地让 delve 运行当前打开的文件。</p><p id="d349" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将创建一个新的配置脚本，惊喜！</p><p id="5d57" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这一个将被命名为<code class="fe nm nn no nd b">debugging.lua</code>。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="ca65" class="nh mf it nd b be ni nj l nk nl">-- fetch the dap plugin<br/>local dap = require('dap')<br/>-- Add adapter to delve<br/>dap.adapters.delve = {<br/>  type = 'server',<br/>  port = '${port}',<br/>  executable = {<br/>    command = 'dlv',<br/>    args = {'dap', '-l', '127.0.0.1:${port}'},<br/>  }<br/>}<br/><br/>-- https://github.com/go-delve/delve/blob/master/Documentation/usage/dlv_dap.md<br/>dap.configurations.go = {<br/>  {<br/>    type = "delve",<br/>    name = "Debug",<br/>    request = "launch",<br/>    program = "${file}"<br/>  },<br/>  {<br/>    type = "delve",<br/>    name = "Debug test", -- configuration for debugging test files<br/>    request = "launch",<br/>    mode = "test",<br/>    program = "${file}"<br/>  },<br/>  -- works with go.mod packages and sub packages <br/>  {<br/>    type = "delve",<br/>    name = "Debug test (go.mod)",<br/>    request = "launch",<br/>    mode = "test",<br/>    program = "./${relativeFileDirname}"<br/>  } <br/>}</span></pre><p id="c625" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">和往常一样，更新<code class="fe nm nn no nd b">init.lua</code>以包含脚本</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="a7b9" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('file-explorer')<br/>require('mason-config')<br/>require('gopls')<br/>require('code-completion')<br/>require('custom-keys')<br/>require('debugging')</span></pre><p id="1044" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">nvim-dap 不附带任何预设映射。没有映射，使用它是一种痛苦。</p><p id="18ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要设置断点，我们需要执行命令<code class="fe nm nn no nd b">:lua require'dap'.toggle_breakpoint()</code>。</p><p id="f2e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者开始调试当前文件，我们需要<code class="fe nm nn no nd b">:lua require'dap'.continue()</code>。</p><p id="0cd3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可能会理解，这有点过了。让我们修复键映射，因为我们已经知道如何做了！</p><p id="ce29" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将首先添加两个映射，第一个是当我按 F5 时启动调试器，第二个是使用<code class="fe nm nn no nd b">CTRL+b</code>切换断点。</p><p id="7fe2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe nm nn no nd b">custom-keys.lua</code>内添加以下内容</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="a89b" class="nh mf it nd b be ni nj l nk nl">-- nvim-dap keymappings<br/>-- Press f5 to debug<br/>map('n', '&lt;F5&gt;', [[:lua require'dap'.continue()&lt;CR&gt;]], {})<br/>-- Press CTRL + b to toggle regular breakpoint<br/>map('n', '&lt;C-b&gt;', [[:lua require'dap'.toggle_breakpoint()&lt;CR&gt;]], {})</span></pre><p id="b677" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重新启动 NeoVim 并在文件中按 CTRL+B 将会设置断点，如左边的 B 所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/68ce925126bd46f1071a96f00816cb1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*1-I4Q7c2HlCTVE9lSzEdig.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">b 表示断点</p></figure><p id="51d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按 F5 应该会调出配置选择，并显示我们创建的所有不同配置。你可以添加许多不同的配置，比如一个<code class="fe nm nn no nd b">launch.json</code>。如果你有一个来自 VS 代码的。</p><p id="f577" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果选择 1，调试器将运行，并在断点处停止。用箭头表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/9c03f7a79bc06cf757e21932049514e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*gu3ns_xtcr8E_iFV8SLeEA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">箭头显示我们正在调试当前行</p></figure><blockquote class="lw lx ly"><p id="27a0" class="ky kz lz la b lb lc ju ld le lf jx lg ma li lj lk mb lm ln lo mc lq lr ls lt im bi translated">现在你可能已经明白，我们可以配置图标和更多。查看插件文档</p></blockquote><p id="27ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们可以打开一个<a class="ae md" href="https://github.com/mfussenegger/nvim-dap/blob/master/doc/dap.txt#L794" rel="noopener ugc nofollow" target="_blank"> REPL </a>窗口来使用 delve 查找值等。</p><p id="cc74" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行以下命令浏览 REPL</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="b4b3" class="nh mf it nd b be ni nj l nk nl">:lua require'dap'.repl.open()</span></pre><p id="dba1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该会看到一个新窗口出现</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/5a58dad4df3a7b242e9ecc2e69ce63ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*j3TvFrzGOfIT6fI6e4brnA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">REPL 窗口与我们的调试器</p></figure><p id="bb0a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用<code class="fe nm nn no nd b">CTRL+w+arrowdown</code>导航到它。然后你需要通过按下<code class="fe nm nn no nd b">i</code>激活插入模式，并尝试执行一个命令。我将使用<code class="fe nm nn no nd b">.scopes</code>来查看局部范围变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d9a433318fbfab7d8ff54bbba8201183.png" data-original-src="https://miro.medium.com/v2/resize:fit:354/format:webp/1*3HIyHnyOsl-HEBhkZC2SUg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">打印局部范围变量</p></figure><p id="c47d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以用<code class="fe nm nn no nd b">:q</code>关闭调试窗口。</p><p id="0935" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们知道了如何使用调试器，让我们添加一些更方便的映射。我已经为每个命令添加了解释，你可以根据自己的需要更改按钮。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="5345" class="nh mf it nd b be ni nj l nk nl">-- nvim-dap keymappings<br/>-- Press f5 to debug<br/>map('n', '&lt;F5&gt;', [[:lua require'dap'.continue()&lt;CR&gt;]], {})<br/>-- Press CTRL + b to toggle regular breakpoint<br/>map('n', '&lt;C-b&gt;', [[:lua require'dap'.toggle_breakpoint()&lt;CR&gt;]], {})<br/>-- Press CTRL + c to toggle Breakpoint with Condition<br/>map('n', '&lt;C-c&gt;', [[:lua require'dap'.set_breakpoint(vim.fn.input('Breakpoint Condition: '))&lt;CR&gt;]], {})<br/>-- Press CTRL + l to toggle Logpoint<br/>map('n', '&lt;C-l&gt;', [[:lua require'dap'.set_breakpoint(nil, nil, vim.fn.input('Log Point Msg: '))&lt;CR&gt;]], {})<br/>-- Pressing F10 to step over<br/>map('n', '&lt;F10&gt;', [[:lua require'dap'.step_over()&lt;CR&gt;]], {})<br/>-- Pressing F11 to step into<br/>map('n', '&lt;F11&gt;', [[:lua require'dap'.step_into()&lt;CR&gt;]], {})<br/>-- Pressing F12 to step out<br/>map('n', '&lt;F12&gt;', [[:lua require'dap'.step_out()&lt;CR&gt;]], {})<br/>-- Press F6 to open REPL<br/>map('n', '&lt;F6&gt;', [[:lua require'dap'.repl.open()&lt;CR&gt;]], {})<br/>-- Press dl to run last ran configuration (if you used f5 before it will re run it etc)<br/>map('n', 'dl', [[:lua require'dap'.run_last()&lt;CR&gt;]], {})</span></pre><p id="a474" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，运行调试器是惊人的，但有时有一个 UI 来帮助我们也不错。</p><p id="793e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我推荐<a class="ae md" href="https://github.com/rcarriga/nvim-dap-ui" rel="noopener ugc nofollow" target="_blank"> nvim-dap-ui </a>，它让一切看起来更干净一点。</p><p id="550c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，添加插件应该是轻而易举的事情。更新<code class="fe nm nn no nd b">plugins.lua</code>。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="12a3" class="nh mf it nd b be ni nj l nk nl">return require('packer').startup(function(use)<br/> -- Configurations will go here<br/> use 'wbthomason/packer.nvim'<br/> use 'williamboman/mason.nvim'<br/> use 'williamboman/mason-lspconfig.nvim'<br/> use 'neovim/nvim-lspconfig'<br/> -- Hrsh7th Code Completion Suite<br/>     use 'hrsh7th/nvim-cmp' <br/>     use 'hrsh7th/cmp-nvim-lsp'<br/>     use 'hrsh7th/cmp-nvim-lua'<br/>     use 'hrsh7th/cmp-nvim-lsp-signature-help'<br/>     use 'hrsh7th/cmp-vsnip'                             <br/>     use 'hrsh7th/cmp-path'                              <br/>     use 'hrsh7th/cmp-buffer'                            <br/>     use 'hrsh7th/vim-vsnip'<br/> -- File explorer tree<br/>     use 'nvim-tree/nvim-web-devicons' -- optional, for file icons<br/> use 'nvim-tree/nvim-tree.lua'<br/> -- DAP for debugging<br/> use 'mfussenegger/nvim-dap'<br/> -- UI for DAP<br/> use { "rcarriga/nvim-dap-ui", requires = {"mfussenegger/nvim-dap"} }<br/>end)</span></pre><p id="4a18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">保存、重新加载(luafile %)和打包同步。</p><p id="f8d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">安装后，我们还需要设置它。由于这是调试的一部分，我将把它存储在我们配置 dap 的<code class="fe nm nn no nd b">debugging.lua</code>中。为 dapui 添加一个需求，执行 setup()函数。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="b16a" class="nh mf it nd b be ni nj l nk nl">-- fetch the dap plugin<br/>local dap = require('dap')<br/>-- Setup DapUI<br/>local dapui = require('dapui')<br/>-- set it up see more configs in their repo<br/>dapui.setup()</span></pre><p id="001e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">和大多数插件一样，这增加了一些命令，我们将更新<code class="fe nm nn no nd b">custom-keys.lua</code>来触发 DapUi。</p><p id="038d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">DapUI 有一个切换功能来打开它，我们想移除 Nvim 树来让它看起来更好一些。</p><p id="87fa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是 NeoVim 开始变酷的时候，看看我们如何轻松地将这些功能链接在一起。无限可能。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="6688" class="nh mf it nd b be ni nj l nk nl">-- Press Ctrl+d to toggle debug mode, will remove NvimTree also<br/>map('n', '&lt;C-d&gt;', [[:NvimTreeToggle&lt;CR&gt; :lua require'dapui'.toggle()&lt;CR&gt;]], {})</span></pre><p id="c355" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您执行我们之前使用的相同的<code class="fe nm nn no nd b">main.go</code>，设置一个断点并启动调试器(F5)。一旦停止，按<code class="fe nm nn no nd b">d</code>调出 DapUI，显示线程、变量值、REPL 和播放/重复/停止按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/d294de1f1a5d40fa17ea5ad7db1b749f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*95mczug7xwgsn3sxmsRRLQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DAPUi 让调试变得更好。</p></figure><p id="50a6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按<code class="fe nm nn no nd b">CTRL+d</code>恢复 nvimtree 并移除调试栏。</p><h2 id="705a" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">使用事件监听器使 NeoVim 具有反应性</h2><p id="b62f" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">这很好，我们可以调试我们写的代码。</p><p id="7b21" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当你穿越 NeoVim 无底洞去做你想做的事情时，有一件重要的事情需要知道，那就是如何使用<a class="ae md" href="https://neovim.io/doc/user/api.html#api-global-events" rel="noopener ugc nofollow" target="_blank">事件</a>。NeoVim 触发事件，插件也可以触发事件。</p><p id="58ac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就像在 JavaScript 等中一样，我们可以监听这些事件并应用命令来触发它们。</p><p id="9925" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">了解这一点的一个简单方法是每当我们触发一个调试会话时就让 DapUI 出现。</p><p id="0433" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Nvim DAP 将触发两个事件，<code class="fe nm nn no nd b">before</code>和<code class="fe nm nn no nd b">after</code>，可以在它们的<a class="ae md" href="https://github.com/mfussenegger/nvim-dap/blob/master/doc/dap.txt#L1002" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p><p id="4949" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe nm nn no nd b">debugging.lua</code>内部，我将添加一个事件监听器，并在 DAP 初始化后触发<code class="fe nm nn no nd b">dapui.open</code>。一旦 DAP 被终止或退出，我们将使用<code class="fe nm nn no nd b">dapui.close</code>关闭。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="cf11" class="nh mf it nd b be ni nj l nk nl">-- fetch the dap plugin<br/>local dap = require('dap')<br/>-- Setup DapUI<br/>local dapui = require('dapui')<br/>-- set it up see more configs in their repo<br/>dapui.setup()<br/><br/>-- dap fires events, we can listen on them to open UI on certain events<br/>dap.listeners.after.event_initialized["dapui_config"] = function()<br/>  dapui.open()<br/>end<br/>dap.listeners.before.event_terminated["dapui_config"] = function()<br/>  dapui.close()<br/>end<br/>dap.listeners.before.event_exited["dapui_config"] = function()<br/>  dapui.close()<br/>end</span></pre><p id="1a3a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重启<code class="fe nm nn no nd b">main.go</code>中的调试器，看看它现在是如何自动打开和关闭的。</p><p id="a35c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用侦听器，您可以添加格式等任何您想要的东西。</p><h2 id="1528" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">样式和添加开发工具</h2><p id="0743" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">老实说，我们目前所做的非常强大和灵活，但是看起来像垃圾。</p><p id="725e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了让 NeoVim 看起来更好一点，我们可以开始修改配色方案。改变颜色模式将应用不同的颜色，使事情看起来更好。</p><p id="fa3f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个真正常见的主题是吸血鬼主题。它之所以流行，大概是因为它看起来很棒，支持很多流行的插件。</p><p id="37d2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它安装起来超级简单，和所有其他插件一样。</p><p id="0513" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">强大的三步火箭，更新插件，添加配置文件，在 init.lua 中添加 require。</p><p id="e51b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">添加到<code class="fe nm nn no nd b">plugins.lua</code></p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="4c56" class="nh mf it nd b be ni nj l nk nl"> -- Dracula theme for styling<br/> use 'Mofiqul/dracula.nvim'</span></pre><p id="ee2c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">保存文件<code class="fe nm nn no nd b">:w</code>，重新加载文件<code class="fe nm nn no nd b">:luafile %</code>，执行<code class="fe nm nn no nd b">:PackerSync</code></p><p id="18d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 NvimTree 中按下<code class="fe nm nn no nd b">a</code>创建一个名为<code class="fe nm nn no nd b">styling.lua</code>的新文件。</p><p id="ea4d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 styling.lua 内部，应用 dracula 配色方案。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="028a" class="nh mf it nd b be ni nj l nk nl">vim.cmd[[colorscheme dracula]]</span></pre><p id="52ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">保存文件并更新<code class="fe nm nn no nd b">init.lua</code>以包含样式</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="8995" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('file-explorer')<br/>require('mason-config')<br/>require('gopls')<br/>require('code-completion')<br/>require('custom-keys')<br/>require('debugging')<br/>require('styling')</span></pre><p id="6e8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重新加载 NeoVim，它应该看起来更酷！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/4fe85e0a8b44368172f6ae20ec851cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*roNFvFpg3sJze_b9FTjyXw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">德古拉主题已应用</p></figure><p id="ce26" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了使它更加强大，让我们添加<a class="ae md" href="https://github.com/nvim-treesitter/nvim-treesitter" rel="noopener ugc nofollow" target="_blank"> nvim-treesitter </a>。Treesitter 是在代码中提供更好的突出显示的一种方式。</p><p id="45ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">至此，您已经非常熟悉如何安装插件了，所以我不会解释每个步骤，只展示文件。您应该能够自己配置它。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="338a" class="nh mf it nd b be ni nj l nk nl">return require('packer').startup(function(use)<br/> -- Configurations will go here<br/> use 'wbthomason/packer.nvim'<br/> use 'williamboman/mason.nvim'<br/> use 'williamboman/mason-lspconfig.nvim'<br/> use 'neovim/nvim-lspconfig'<br/> -- Hrsh7th Code Completion Suite<br/>     use 'hrsh7th/nvim-cmp' <br/>     use 'hrsh7th/cmp-nvim-lsp'<br/>     use 'hrsh7th/cmp-nvim-lua'<br/>     use 'hrsh7th/cmp-nvim-lsp-signature-help'<br/>     use 'hrsh7th/cmp-vsnip'                             <br/>     use 'hrsh7th/cmp-path'                              <br/>     use 'hrsh7th/cmp-buffer'                            <br/>     use 'hrsh7th/vim-vsnip'<br/> -- File explorer tree<br/>     use 'nvim-tree/nvim-web-devicons' -- optional, for file icons<br/> use 'nvim-tree/nvim-tree.lua'<br/> -- DAP for debugging<br/> use 'mfussenegger/nvim-dap'<br/> -- UI for DAP<br/> use { "rcarriga/nvim-dap-ui", requires = {"mfussenegger/nvim-dap"} }<br/> -- Dracula theme for styling<br/> use 'Mofiqul/dracula.nvim'<br/> -- Treesitter<br/> use {<br/>  -- recommended packer way of installing it is to run this function, copied from documentation<br/>         'nvim-treesitter/nvim-treesitter',<br/>      run = function()<br/>              local ts_update = require('nvim-treesitter.install').update({ with_sync = true })<br/>              ts_update()<br/>         end,<br/><br/> }<br/>end)</span></pre><p id="5c90" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后是一个<code class="fe nm nn no nd b">syntax-highlight.lua</code>文件来处理配置</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="afad" class="nh mf it nd b be ni nj l nk nl">require'nvim-treesitter.configs'.setup {<br/>  -- A list of parser names, or "all"<br/>  ensure_installed = { "go", "lua", "rust" },<br/><br/>  -- Install parsers synchronously (only applied to `ensure_installed`)<br/>  sync_install = false,<br/><br/>  -- Automatically install missing parsers when entering buffer<br/>  -- Recommendation: set to false if you don't have `tree-sitter` CLI installed locally<br/>  auto_install = true,<br/><br/><br/>  highlight = {<br/>    -- `false` will disable the whole extension<br/>    enable = true,<br/><br/>  },<br/>}</span></pre><p id="1433" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">和<code class="fe nm nn no nd b">init.lua</code></p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="789d" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('file-explorer')<br/>require('mason-config')<br/>require('gopls')<br/>require('code-completion')<br/>require('custom-keys')<br/>require('debugging')<br/>require('styling')<br/>require('syntax-highlight')</span></pre><p id="8bf9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重启后，代码应该会突出显示函数名。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/a92d40c69dddb104afd91219be5f2b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*eQVfcVzhtXlo7I8gkqj46Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">树保姆突出显示</p></figure><p id="a334" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们要的下一个插件是模糊搜索文件，它叫做<a class="ae md" href="https://github.com/nvim-telescope/telescope.nvim" rel="noopener ugc nofollow" target="_blank">望远镜</a>。</p><blockquote class="lw lx ly"><p id="de7d" class="ky kz lz la b lb lc ju ld le lf jx lg ma li lj lk mb lm ln lo mc lq lr ls lt im bi translated">要获得完整的功能，您需要安装<a class="ae md" href="https://github.com/BurntSushi/ripgrep" rel="noopener ugc nofollow" target="_blank"> RipGrep </a></p></blockquote><p id="624e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们把它加到 Packer 上。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="3782" class="nh mf it nd b be ni nj l nk nl"> -- Telescope used to fuzzy search files<br/> use {<br/>    'nvim-telescope/telescope.nvim', tag = '0.1.0',<br/>    requires = { {'nvim-lua/plenary.nvim'} }<br/> }</span></pre><p id="fa57" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后添加一个<code class="fe nm nn no nd b">file-finder.lua</code>并填写配置，在本例中，一个键映射显示不同的搜索栏。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="5396" class="nh mf it nd b be ni nj l nk nl">-- search files, even hidden ones<br/>vim.keymap.set('n', '&lt;leader&gt;ff', ':lua require"telescope.builtin".find_files({no_ignore=true, hidden=true})&lt;CR&gt;', {})<br/>-- ripgrep files, respects gitignore<br/>vim.keymap.set('n', '&lt;leader&gt;fg', ':lua require"telescope.builtin".live_grep()&lt;CR&gt;', {})</span></pre><p id="3819" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，Live Grep 尊重任何<code class="fe nm nn no nd b">.gitignore</code>文件，并从其中排除结果。除非配置为包含它们。</p><p id="cffb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后也把它加到<code class="fe nm nn no nd b">init.lua</code></p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="5c79" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('file-explorer')<br/>require('mason-config')<br/>require('gopls')<br/>require('code-completion')<br/>require('custom-keys')<br/>require('debugging')<br/>require('styling')<br/>require('file-finder')<br/>require('syntax-highlight')</span></pre><p id="cba8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在你可能注意到映射使用了<code class="fe nm nn no nd b">Leader</code>，默认情况下是反斜杠键。这在我的笔记本电脑上真的很乱，所以我将通过添加下面一行来将其重新映射到<code class="fe nm nn no nd b">custom-keys.lua</code>内的<code class="fe nm nn no nd b">,</code>中。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="9c90" class="nh mf it nd b be ni nj l nk nl">-- update leader key to ,<br/>vim.g.mapleader = ","</span></pre><p id="5704" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，重新启动 NeoVim，享受难以置信的模糊搜索</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/0359011af9e87a393a8f3dfa558f2ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1Gwc1uz-uzDJIG1qSRg_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按下<leader> ff 打开文件搜索</leader></p></figure><p id="fd1a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我特别喜欢使用<code class="fe nm nn no nd b">&lt;Leader&gt;fg</code>的 live-grep 搜索，它也搜索文件中的关键字。</p><p id="23f5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后要补充的是，我喜欢有一个状态栏来显示一些信息，比如 git 分支等等。</p><p id="8f68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过添加<code class="fe nm nn no nd b">nvim-lualine</code> <a class="ae md" href="https://github.com/nvim-lualine/lualine.nvim" rel="noopener ugc nofollow" target="_blank">插件</a>来添加这个。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="9bd2" class="nh mf it nd b be ni nj l nk nl"> -- Lualine information / Status bar<br/> use {<br/>    'nvim-lualine/lualine.nvim',<br/>    requires = { 'kyazdani42/nvim-web-devicons', opt = true }<br/> }</span></pre><p id="9a6b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">安装后，按照你认为合适的方式配置它，我将在一个新文件<code class="fe nm nn no nd b">statusbar.lua</code>中使用默认值。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="ea86" class="nh mf it nd b be ni nj l nk nl">require('lualine').setup()</span></pre><p id="17bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后也更新<code class="fe nm nn no nd b">init.lua</code>以包含状态栏。</p><pre class="kj kk kl km gt nc nd ne bn nf ng bi"><span id="fc0b" class="nh mf it nd b be ni nj l nk nl">require('plugins')<br/>require('file-explorer')<br/>require('mason-config')<br/>require('gopls')<br/>require('code-completion')<br/>require('custom-keys')<br/>require('debugging')<br/>require('styling')<br/>require('file-finder')<br/>require('syntax-highlight')<br/>require('statusbar')</span></pre><p id="b84e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重启 Neovim，你应该会看到一个漂亮的小状态栏。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/7fe9a9aa3ccf0c17ca91d42b6a269473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UFGbLtBpWIx5-sZrTroF_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Lualine 状态栏—我不在 Git Repo 中，所以它显示一个错误的图标</p></figure><h2 id="8e8e" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">推荐的插件</h2><p id="35ad" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">这里有一个我推荐的插件列表，可以给你一些安装时的训练。</p><p id="86f4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/windwp/nvim-autopairs" rel="noopener ugc nofollow" target="_blank">自动配对</a> —创建括号和圆括号对时生成它们。</p><p id="93a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/akinsho/bufferline.nvim" rel="noopener ugc nofollow" target="_blank"> Bufferline </a> —添加一个显示打开的缓冲区(文件)的标题</p><p id="4918" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/glepnir/lspsaga.nvim" rel="noopener ugc nofollow" target="_blank"> LSPSaga </a> —代码动作、浮动悬停文档等。</p><p id="1580" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/lukas-reineke/indent-blankline.nvim" rel="noopener ugc nofollow" target="_blank"> IndentBlankline </a> —压痕指南</p><p id="15ed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/voldikss/vim-floaterm#lazygit" rel="noopener ugc nofollow" target="_blank"> FloatTerm </a> —开放浮动终端，适用于开放 LazyGit 等。</p><p id="8bf5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/mfussenegger/nvim-lint" rel="noopener ugc nofollow" target="_blank"> nvim-lint </a> — Linter！非常需要。</p><p id="8807" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/folke/trouble.nvim" rel="noopener ugc nofollow" target="_blank">故障</a> —思考 VS 代码按钮错误标签</p><p id="fd7b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我喜欢写 TODO 注释作为提醒，这个插件使它们可以用 Telescope 搜索到，并且突出显示它们。</p><p id="4e18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://github.com/preservim/tagbar" rel="noopener ugc nofollow" target="_blank">标签栏</a> —获取文件中结构、功能等的概述。</p><h2 id="071a" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">结论</h2><p id="7190" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们已经学会了如何使用 NeoVim，当然还有更多要学，但我认为如果你开始每天使用它，那会很自然。</p><p id="753a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，我们已经涵盖了最需要的基础知识，以及开始有效使用 NeoVim 所需的知识。学完这个之后，你应该可以毫无问题地使用 NeoVim。</p><p id="959b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该熟悉以下内容</p><ul class=""><li id="c17a" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt ok ny nz oa bi translated">使用正常模式和插入模式导航 NeoVim</li><li id="4bd2" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated">在 Vim 中执行命令</li><li id="6ed3" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated">添加插件和配置 NeoVim</li><li id="ca99" class="ns nt it la b lb ob le oc lh od ll oe lp of lt ok ny nz oa bi translated">处理插件及其配置</li></ul><p id="9242" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我推荐查找 Linters 和 Formatters(提示:mason 可以帮助你)。</p><p id="20f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这对你来说是一个很好的练习，你可以自己安装一个插件来真正学习并坚持下去。</p><p id="01dd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住，通常有一些插件可以帮助您定制完整的开发环境，例如 x-ray/go。它们的缺点是，它们通常包含太多，以至于很难真正了解默认映射以及如何使用它们。</p><p id="2890" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在<a class="ae md" href="https://github.com/percybolmer/dotfiles/tree/learn/demo" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到我的 dotfiles 和当前的 NeoVim 配置。</p><p id="fd56" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望你喜欢这篇文章，现在去为自己打造一个梦想的编辑器吧。</p></div></div>    
</body>
</html>