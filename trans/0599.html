<html>
<head>
<title>Train Test Split in Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习中的训练测试拆分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/train-test-split-in-deep-learning-e1b1fed01989#2022-02-23">https://towardsdatascience.com/train-test-split-in-deep-learning-e1b1fed01989#2022-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9fb1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">机器学习的黄金法则之一是将数据集分成训练集、验证集和测试集。了解如何绕过最常见的警告</h2></div><p id="7929" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们这样做的原因很简单。如果我们不将数据分成不同的集合，模型将根据它在训练期间看到的相同数据进行评估。因此，我们可能会在不知不觉中遇到过度拟合等问题。</p><p id="3d9f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在使用深度学习模型之前，我们经常使用三个不同的集合。</p><ul class=""><li id="df17" class="lb lc iq kh b ki kj kl km ko ld ks le kw lf la lg lh li lj bi translated">一个<strong class="kh ir">训练组</strong>用于训练模型</li><li id="e870" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">用于在训练过程中评估模型的<strong class="kh ir">验证集</strong></li><li id="ae58" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">用于在部署前评估最终模型准确性的<strong class="kh ir">测试集</strong></li></ul><h2 id="d8a1" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">我们如何使用训练、验证和测试集？</h2><p id="6edf" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">通常，我们使用如下不同的集合:</p><ol class=""><li id="e7a7" class="lb lc iq kh b ki kj kl km ko ld ks le kw lf la mn lh li lj bi translated">我们将数据集<em class="mo">随机地</em>分成三个子集，称为<strong class="kh ir">训练</strong>、<strong class="kh ir">验证</strong>和<strong class="kh ir">测试集</strong>。分割比例可以是 60/20/20 或 70/20/10 或任何你想要的比例。</li><li id="7b5d" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la mn lh li lj bi translated">我们使用<strong class="kh ir">训练组</strong>训练一个模型。</li><li id="8964" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la mn lh li lj bi translated">在训练过程中，我们在<strong class="kh ir">验证集</strong>上评估模型。</li><li id="5e5b" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la mn lh li lj bi translated">如果我们对结果不满意，我们可以更改超参数或选择另一个模型，然后<em class="mo">再次进入第 2 步</em></li><li id="6f77" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la mn lh li lj bi translated">最后，一旦我们对<strong class="kh ir">验证集</strong>上的结果感到满意，我们就可以在<strong class="kh ir">测试集</strong>上评估我们的模型。</li><li id="8f6d" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la mn lh li lj bi translated">如果我们对结果满意，我们现在可以再次使用我们最后导出的超参数在<strong class="kh ir">训练</strong>和<strong class="kh ir">验证集</strong>上训练我们的模型。</li><li id="febf" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la mn lh li lj bi translated">我们可以在<strong class="kh ir">测试集</strong>上再次评估模型的准确性，如果我们满意，可以部署模型。</li></ol><p id="5d44" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大多数 ML 框架为数据集的随机训练/测试分割提供了内置方法。最知名的例子就是 scikit-learn 的<a class="ae mp" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> train_test_split 函数。</a></p><h2 id="7872" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">使用非常小的数据集有什么问题吗？</h2><p id="faae" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">是的，这可能是个问题。对于非常小的数据集，测试集将会很小，因此单个错误的预测会对测试准确性产生很大影响。幸运的是，有一种方法可以解决这个问题。</p><p id="d9b0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个问题的解决方案叫做<a class="ae mp" href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)" rel="noopener ugc nofollow" target="_blank">交叉验证</a>。我们基本上创建了数据集的分区，如下图所示。我们总是拿出一套进行测试，并使用所有其他数据进行训练。最后，我们从测试集中收集并平均所有结果。我们基本上训练了 k 个模型，并使用这个技巧设法获得在完整数据集上评估模型的统计数据(因为每个样本都是 k 个测试集之一的一部分)。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mq"><img src="../Images/c39847386a099bc9af4a379668702fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RDeZd15Qg9AhT5-u.png"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">来自维基百科的插图展示了 k 倍交叉验证是如何工作的。我们迭代地混合用于训练和测试的数据，并评估整体统计数据。</p></figure><p id="c6fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种方法在最近的深度学习方法中很少使用，因为训练一个模型 k 次非常昂贵。</p><p id="461f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着深度学习的兴起和数据集规模的大规模增长，对交叉验证或拥有单独验证集等技术的需求已经减少。其中一个原因是实验非常昂贵，而且需要很长时间。另一个原因是，由于大数据集和大多数深度学习方法的性质，模型受过度拟合的影响较小。</p><p id="02f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">过拟合仍然是深度学习中的一个问题。但是过拟合 50 个具有 10 个特征的样本比过拟合 100k 个具有数百万像素的图像要快</p><p id="43c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有人可能会说，研究人员和从业人员变得懒惰/马虎。再次看到最近研究这种效应的论文会很有趣。例如，在过去的几年中，研究人员可能严重地过度适应了 ImageNet 的测试集，因为一直在努力改进它，使其成为最先进的。</p><h1 id="db81" class="ng lq iq bd lr nh ni nj lu nk nl nm lx jw nn jx ma jz no ka md kc np kd mg nq bi translated">我应该如何选择我的训练集、验证集和测试集？</h1><p id="e087" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">天真地，人们可以手动将数据集分成三个块。这种方法的问题是，我们人类非常有偏见，这种偏见会被引入到三个集合中。</p><p id="e72f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在学术界，我们知道我们应该随机选择他们。随机分成三组保证了所有三组遵循相同的统计分布。这就是我们想要的，因为 ML 是关于统计的。</p><p id="1fb8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从完全不同的分布中导出三个集合会产生一些不希望的结果。如果我们想用猫的图片来给花分类，那么在猫的图片上训练一个模型是没有多大价值的。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nr"><img src="../Images/0f03372cb0c6fbefe07e7176f289a3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oAaq1Y4hfEb0_jOFU8RmRA.jpeg"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">我应该如何选择我的训练集、验证集和测试集？</p></figure><p id="091d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，随机分割的基本假设是初始数据集已经与我们想要解决的问题的统计分布相匹配。这意味着，对于自动驾驶等问题，我们的数据集涵盖了各种城市、天气状况、车辆、季节、特殊情况等。</p><p id="8bb9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你可能认为的那样，这个假设对于大多数实际的深度学习应用来说实际上是不成立的。每当我们在不受控制的环境中使用传感器收集数据时，我们可能不会得到理想的数据分布。</p><p id="6e2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是这很糟糕。如果我无法收集到我试图解决的问题的代表性数据集，我该怎么办？</p><p id="80d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你要寻找的是围绕发现和处理<strong class="kh ir">领域差距</strong>、<strong class="kh ir">分布转移、</strong>或<strong class="kh ir">数据漂移</strong>的研究领域。所有这些术语都有其特定的定义。我把它们列在这里，这样你可以很容易地找到相关的问题。</p><p id="1451" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于<em class="mo">域</em>，我们称之为数据域，作为我们使用的数据的来源和类型。有三种前进的方式:</p><ul class=""><li id="fff3" class="lb lc iq kh b ki kj kl km ko ld ks le kw lf la lg lh li lj bi translated">通过收集更具代表性的数据来解决数据缺口</li><li id="c620" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">使用数据监管方法使已经收集的数据更具代表性</li><li id="9b3e" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">专注于构建一个足够健壮的模型来处理这样的领域差距</li></ul><p id="e37d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">后一种方法侧重于为分发任务建立模型。</p><h2 id="b564" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">为分配外的任务选择训练测试分割</h2><p id="6d71" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在机器学习中，每当我们的模型必须在新输入数据来自不同于训练数据的分布的情况下表现良好时，我们就称之为非分布。回到我们之前的自动驾驶示例，我们可以说，对于一个只在阳光明媚的加州天气下训练的模型，在欧洲进行预测是不合理的。</p><p id="1bc7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mo">现在，对于这样的任务，我们应该如何分割数据集？</em></p><p id="7c06" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们使用不同的传感器收集数据，因此我们还可能拥有关于每个样本来源的附加信息(样本可以是图像、激光雷达帧、视频等。).</p><p id="0127" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过以下方式分割数据集来解决这个问题:</p><ul class=""><li id="cbf9" class="lb lc iq kh b ki kj kl km ko ld ks le kw lf la lg lh li lj bi translated">我们根据列表 A 中城市的一组数据进行训练</li><li id="7260" class="lb lc iq kh b ki lk kl ll ko lm ks ln kw lo la lg lh li lj bi translated">并对来自列表 B 中城市的一组数据评估该模型</li></ul><p id="ceac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Yandex research 发表了一篇很棒的文章，介绍了他们解决数据集分布变化的新数据集。</p><h1 id="8abd" class="ng lq iq bd lr nh ni nj lu nk nl nm lx jw nn jx ma jz no ka md kc np kd mg nq bi translated">可能出错的事情</h1><h2 id="1853" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">验证集和测试集的准确性相差很大</h2><p id="7aaf" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">您很可能将您的模型过度适应验证集，或者验证集和测试集非常不同。但是怎么做呢？</p><p id="7ec0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可能会反复调整参数，以挤出模型在验证集上能够产生的最后一点准确性。验证集不再发挥其作用。此时，您应该放松一些超参数或引入正则化方法。</p><h2 id="4bfb" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">在导出我的最终超参数后，我想在发货前在完整数据集上重新训练我的模型(训练+验证+测试)</h2><p id="3766" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">不，不要这样做。超参数已经针对训练(或者训练+验证)集进行了调整，当用于完整数据集时，可能会产生不同的结果。此外，当测试集不再存在时，你将无法回答你的模型实际表现有多好的问题。</p><h2 id="ad5d" class="lp lq iq bd lr ls lt dn lu lv lw dp lx ko ly lz ma ks mb mc md kw me mf mg mh bi translated">我有一个视频数据集，想将这些帧随机分成训练集、验证集和测试集</h2><p id="e80b" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">由于视频帧很可能是高度相关的(例如，两个相邻的帧看起来几乎相同)，这是一个坏主意。这与我们根据训练数据评估模型几乎是一样的。相反，您应该将数据集拆分为多个视频(例如，视频 1、3、5 用于训练，视频 2、4 用于验证)。您可以再次使用随机训练测试分割，但这次是在视频级别而不是帧级别。</p><p id="c92f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Igor 联合创始人<br/> <a class="ae mp" href="https://lightly.ai/" rel="noopener ugc nofollow" target="_blank"> Lightly.ai </a></p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><div class="mr ms mt mu gt nz"><a href="https://medium.datadriveninvestor.com/the-advantage-of-self-supervised-learning-bd6fddc8f345" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">自我监督学习的优势</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">关于为什么自我监督学习会对 AI 产生强烈影响的几点个人想法。从最近的 NLP 到计算机…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">medium.datadriveninvestor.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on na nz"/></div></div></a></div><div class="oo op gp gr oq nz"><a rel="noopener follow" target="_blank" href="/few-shot-learning-with-fast-ai-81c66064e372"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">用 fast.ai 进行少拍学习</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">在少镜头学习中，我们只使用几个带标签的例子来训练模型。了解如何使用…训练您的分类器</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="or l ok ol om oi on na nz"/></div></div></a></div><div class="oo op gp gr oq nz"><a rel="noopener follow" target="_blank" href="/how-to-keep-up-with-the-latest-research-and-trends-in-ml-a45a356b1001"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">如何跟上 ML 的最新研究和趋势</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">对 ML 的大肆宣传导致该领域的研究和兴趣急剧增加。在这篇文章中，我分享了我的…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="os l ok ol om oi on na nz"/></div></div></a></div></div></div>    
</body>
</html>