<html>
<head>
<title>Hands-On Reinforcement Learning Course: Part 5</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实践强化学习课程:第5部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hands-on-reinforcement-learning-course-part-5-bdb2e7fa243c#2022-02-10">https://towardsdatascience.com/hands-on-reinforcement-learning-course-part-5-bdb2e7fa243c#2022-02-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e0da" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">深度Q学习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/57b7b00ddc36a556dffa06edfe5d4b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTsu8y5rH95ugNPoaKE5RQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们再深入一点！🙏来自<a class="ae ky" href="https://www.pexels.com/photo/photo-of-sea-turtle-2765872/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的Jeremy Bishop </p></figure><h1 id="87f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">欢迎来到我的强化学习课程❤️</h1><p id="b8dd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是强化学习实践课程的第5部分，带你从零到英雄🦸‍♂️.</p><p id="0341" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/hands-on-reinforcement-learning-course-part-1-269b50e39d08">第一部分:强化学习简介</a> <br/> <a class="ae ky" rel="noopener" target="_blank" href="/hands-on-reinforcement-learning-course-part-2-1b0828a1046b">第二部分:表格Q-learning </a> <br/> <a class="ae ky" rel="noopener" target="_blank" href="/hands-on-reinforcement-learning-course-part-3-5db40e7938d4">第三部分:表格SARSA </a> <br/> <a class="ae ky" rel="noopener" target="_blank" href="/hands-on-reinforcement-learning-course-part-4-55da5eae851f">第四部分:线性Q-learning </a> <strong class="lt iu"> </strong> <br/>👉🏻<strong class="lt iu">第五部分:深度Q学习</strong>(今天)</p><p id="f177" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在第4部分中，我们为Cart Pole环境构建了一个不错的代理。我们使用线性模型的参数Q学习。</p><p id="17c0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">今天我们将用一个<strong class="lt iu">神经网络</strong>代替这个线性模型。</p><p id="b838" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将彻底解决手推车的环境问题😎</p><p id="0323" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">今天的课程有点长，因为它包括一个关于训练神经网络模型的迷你速成班。除非你是深度学习方面的专家，否则我强烈建议你不要跳过它。</p><p id="a974" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本课所有代码都在<a class="ae ky" href="https://github.com/Paulescu/hands-on-rl" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">本Github repo </strong> </a> <strong class="lt iu">中。Git克隆它来跟进今天的问题。</strong></p><p id="266f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你喜欢这个课程，请<a class="ae ky" href="https://github.com/Paulescu/hands-on-rl" rel="noopener ugc nofollow" target="_blank">在Github上给它一个⭐ </a>！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><a href="https://github.com/Paulescu/hands-on-rl"><div class="gh gi ki"><img src="../Images/28ecceaa3a50de0598a4888854b1ad77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aj4YIHdszTNqy4OE.jpeg"/></div></a></figure><p id="d0b8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">☕.喝了一大口我们准备开始了！</p><h1 id="0c94" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">第五部分</h1><h1 id="ab1c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">内容</h1><ol class=""><li id="506a" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated"><a class="ae ky" href="#1391" rel="noopener ugc nofollow">我们深入吧！</a></li><li id="b8b2" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="#459b" rel="noopener ugc nofollow">深度学习实践介绍</a></li><li id="49a8" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="#2d1f" rel="noopener ugc nofollow">深度Q学习解决大车杆子</a></li><li id="0ed3" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="#16f3" rel="noopener ugc nofollow">重述✨ </a></li><li id="52f7" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="#1a9f" rel="noopener ugc nofollow">作业📚</a></li><li id="a575" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="#dffb" rel="noopener ugc nofollow">接下来呢？❤️ </a></li></ol><h1 id="1391" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.我们深入吧！</h1><p id="b326" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在上一课中，我们使用这种线性参数化来表示最佳q函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/35207a4f4dcf42459ae107429737a5a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/0*ziABdoI655gxHn3H.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线性q函数(图片由作者提供)</p></figure><p id="06aa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是一个只有10个参数的小模型。</p><p id="9c71" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">参数Q学习代理的成功(或失败)很大程度上取决于我们用来逼近最优Q值函数的参数化。</p><p id="6e0a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">线性模型概念简单，训练速度快，运行速度快。然而，他们不是很<em class="nh">灵活</em>。给定一组输入和输出，线性图层很难将输入映射到输出。</p><p id="374f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是神经网络进入游戏的时候。</p><p id="9947" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">神经网络模型是我们拥有的最强大的函数逼近。它们非常灵活，可用于揭示输入要素和目标标注之间的复杂模式。</p><blockquote class="ni nj nk"><p id="8f53" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it">普适逼近定理</em> </strong> <em class="it"> </em>📘<em class="it">是一个数学结果，本质上是说</em></p><p id="0e80" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">神经网络就像你希望的那样灵活。如果您设计了一个足够大的神经网络(即具有足够的参数)，您将发现输入特征和目标值之间的精确映射。</p></blockquote><p id="17db" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">或者如果你喜欢更哲学的风格…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/c5c5b933be8bf77b746c5e5dd11c97fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*Z_0zd9ld4CaSptmAlrYcdw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">布鲁斯大师说得再好不过了(由作者从<a class="ae ky" href="https://openclipart.org/detail/223057/bruce-lee-1973" rel="noopener ugc nofollow" target="_blank">剪贴画</a>编辑)</p></figure><p id="6026" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">今天，我们将用最简单的神经网络架构取代第4部分中的线性模型:一个<strong class="lt iu">前馈</strong>神经网络。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/aad4a472af57e9f029194a3227edcc6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*Ibtr60PwTe51yyJqUqh8Eg.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">前馈神经网络(图片由作者提供)</p></figure><p id="33db" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在课程的后面，我们将使用其他神经网络来处理更复杂的<em class="nh">状态</em>空间(例如卷积神经网络)。</p><p id="52c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如我在课程开始时所说的，我并不期望你成为神经网络方面的专家。</p><p id="b7db" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你确实是其中之一，请随意跳过下一部分，直接进入第3部分。</p><p id="f88b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">否则，就让我们用下面这个我今天为大家创造的模仿学习问题来预热我们的深度学习掌握吧。</p><p id="613d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要涵盖的内容相当多，所以用深度聚焦来武装自己。</p><h1 id="459b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.深度学习实践介绍:从标记数据中学习最优策略</h1><p id="f4b0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl/blob/main/03_cart_pole/notebooks/05_crash_course_on_neural_nets.ipynb" rel="noopener ugc nofollow" target="_blank">👉🏽notebooks/05 _ crash _ course _ on _ neural _ nets . ipynb</a></p><p id="69ad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本节中，我们将使用深度学习解决一个有监督的机器学习问题。</p><p id="78c6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nh">但是，我们为什么不直接解决大车杆子呢？🤔</em></p><p id="614f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有监督的最大似然问题与我们在参数Q学习中解决的优化之间的关键区别在于，在超最大似然中，目标是<strong class="lt iu">固定的</strong>，而在参数Q学习中，目标是<strong class="lt iu">不固定的</strong>，而是<em class="nh">移动</em> <strong class="lt iu">。</strong></p><p id="ff48" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正因为如此，有监督的最大似然问题更容易解决，因此它们是我们接触神经网络模型的更好起点。</p><p id="17cc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在监督机器学习中，你有一个数据集对<strong class="lt iu"> <em class="nh">(输入，输出)</em> </strong>，你想找到输入(又名特征)和输出(又名目标/标签)之间的<em class="nh">右</em>映射。</p><p id="1c29" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nh">好，我们要解决的有监督ML问题是什么？</em></p><p id="e268" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我采用了我们将在下一节中训练的完美deep-q代理(也称为<em class="nh">完美</em>代理),并生成了1000个状态的样本(输入),以及这个完美代理采取的相应动作(输出)。从这个观察样本中，我们想了解代理遵循的基本最优策略。</p><p id="df26" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">就当是模仿学习问题吧。从专家的表现中给你1000个样本(状态，动作)，你的工作是学习代理遵循的基本策略。</p><p id="bbb4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">说够了。让我们看看代码。我们首先看看如何生成训练数据。然后，我们将训练几个神经网络模型，并提取一些学习。</p><h2 id="5d2d" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">2.1生成列车数据</h2><p id="3e89" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">像往常一样，我们从加载环境开始</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/9f7d94020cd25b4a4a04ca73deb806dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhGSIgNor_2GjvPTSZcqjQ.png"/></div></div></figure><p id="c60c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了生成训练数据，我们首先需要获得完美的代理参数(和超参数)。我把这些上传到了你可以访问的公共Google Drive，你可以从那里下载，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/5cc831bfb0e71112a7b4f8730c155b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mw4yS1C96pvRf9Gq_QxGsg.png"/></div></div></figure><p id="bb5e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在<code class="fe oe of og oh b">path_to_agent_data</code>中，您有两个文件:</p><ul class=""><li id="3258" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><code class="fe oe of og oh b">model</code> →用参数函数的参数保存PyTorch模型，本例中为神经网络。</li><li id="be10" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm ol my mz na bi translated"><code class="fe oe of og oh b">hparams.json</code> →用于培训代理的超参数</li></ul><p id="ca4f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，您可以从这些参数(和超参数)实例化一个<code class="fe oe of og oh b">QAgent</code>对象，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/cbc7e8311393495443415a3f3a458a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JrTjtOPB6K4W-PLP1A4wag.png"/></div></div></figure><p id="d844" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在继续之前，我希望你相信我说的代理人是完美的。我们随机1000集评估一下，查看一下总奖励。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/c750b97df9a2c4cdb5e658dc27d2a15d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8HFaxWBOHrY7Jwh_yP8jQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/816ff5a3da0d69efd8d9c8aa1003917a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYi18tcj3vGs768NcC_KTA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/9194f2716d119cf8328c3821a7a64e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bnsBzA7Hbyf1rOjKvCtd4Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">满分！</p></figure><p id="7498" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">500是最高总奖励，我们的经纪人在所有1000集里都拿到了。太棒了。您需要等到下一节自己来训练这个完美的代理。</p><p id="3d70" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们让代理与环境交互几集，直到我们收集到1000对(状态、动作)。这就是我们如何生成我们的<strong class="lt iu">训练数据</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/146b7cd4304f824b8cfa9f3e4d673191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yo9mAMRTgsrclyxQxt4Lig.png"/></div></div></figure><p id="1895" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe oe of og oh b">generate_state_action_data</code>函数生成一个CSV文件，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/d4a90f5552e6a3bbaf0f08ceed337421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*lmjP6mtRDks6w0pYECcUyQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">train.csv</p></figure><p id="59fb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中:</p><ul class=""><li id="00c9" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><code class="fe oe of og oh b">s1, s2, s3, s4</code>是输入特征，和</li><li id="604d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm ol my mz na bi translated"><code class="fe oe of og oh b">action</code>是目标，在本例中是二进制目标(0或1)。我们将解决一个<strong class="lt iu">二元分类问题</strong>。</li></ul><p id="13e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，在我们进入建模部分之前，我们还需要做一件事。</p><p id="b554" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当你训练有监督的ML模型(尤其是神经网络)并且想要正确评估它们的准确性时，你<strong class="lt iu">不能</strong>使用你用来训练它们的相同数据集。</p><p id="b745" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nh">为什么？</em></p><p id="4379" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为可能发生的情况是，你的模型只是简单地记住了训练数据，而不是揭示特征和目标之间的真实相关性。这在高参数模型中很容易发生，比如大型神经网络。因此，当您将模型用于模型的新的和不可见的数据时，您的模型性能将低于您在训练期间获得的性能。</p><p id="72be" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了解决这个问题，我们生成另一个数据集，称为<strong class="lt iu">测试数据</strong>，我们不使用它来调整任何模型参数。测试数据专门用于评估模型的性能。</p><p id="caf5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们生成的方式和火车集一样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/e585ed3e8c575a956eb2f7fd9c076e06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hepc8jCRvxl96d2StS7l1Q.png"/></div></div></figure><p id="4588" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">观察我们如何使用不同于<code class="fe oe of og oh b">train.csv</code>的种子，以保证我们不会为训练和测试数据集生成相同的样本。</p><p id="2ff9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">酷毙了。我们得到了数据。让我们继续到建模部分。</p><h2 id="20b4" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">2.2.系统模型化</h2><p id="24d0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如我们在强化学习问题中经常做的那样，最好从建立一个快速基线模型开始，以了解问题有多难。</p><p id="2dbc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们加载CSV文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/0dc03d011a60946def0c8c06d1355fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*syroBbIBA2HNYaqkv9YGOQ.png"/></div></div></figure><p id="ec6e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们检查训练数据，我们可以看到目标值(即最佳行动)具有完全平衡的分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/0e57b7d8cab33c4092b351527a8c0d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nDNDBlBlcSAMKERUmPzT6g.png"/></div></div></figure><p id="321b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这意味着预测总是action = 0(或action = 1)的非常虚拟的基线模型具有50%的准确性，这意味着模型预测有50%的时间匹配正确的标签。</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><h2 id="ae4b" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">将数据加载到PyTorch模型中</h2><p id="80e7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们进入模型之前，我们需要构建一个<em class="nh">数据</em> <em class="nh">管道</em>来快速地将数据从<em class="nh"> pandas数据帧</em>成批移动到我们的PyTorch模型。</p><p id="f686" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">PyTorch API提供了两个辅助对象来让您轻松完成这项工作:</p><ul class=""><li id="bacc" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><code class="fe oe of og oh b">torch.utils.data.Dataset</code> →包裹您的熊猫数据框的便捷包装。它检索数据帧特征并一次标记一个样本。</li><li id="b1a4" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm ol my mz na bi translated"><code class="fe oe of og oh b">torch.utils.data.DataLoader</code> →为您完成繁重的工作，批量将数据从<code class="fe oe of og oh b">Dataset</code>转移到Pytorch模型。它使用Python的<code class="fe oe of og oh b">multiprocessing</code>库来加速数据检索。</li></ul><p id="b8fd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们需要两条数据管道，一条用于训练数据，一条用于测试数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/ee1b819465fe9387a3bd9d16a9858253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*afIZMrp9HEu6722cM1FBPw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据管道(图片由作者提供)</p></figure><p id="30d6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们创建了一个自定义的<code class="fe oe of og oh b">Dataset</code>类，并实现了3个必不可少的方法:<code class="fe oe of og oh b">__init__()</code>、<code class="fe oe of og oh b">__len__()</code>和<code class="fe oe of og oh b">__getitem__(idx).</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/9bc0f44d389a3feddb8afc40e9e6896c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqNG35mkMCTm_ZKIaDP9sw.png"/></div></div></figure><p id="e9cf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，我们实例化2个<code class="fe oe of og oh b">Dataset</code>对象:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/11fd7e9de8e7b370197b2348f9cc0e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3QkbGDmhX88RL1o9nnleKA.png"/></div></div></figure><p id="4c80" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe oe of og oh b">DataLoaders</code>甚至更容易实现，因为我们只需要声明它们，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/6280b1c192fa448084f70d83dd9026e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flvW27tH_KL04ghev6oijw.png"/></div></div></figure><p id="68a7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">很好！数据管道准备好了。现在，我们有了一种快速成批移动数据并将其提供给我们将要构建的模型的方法。</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><p id="a1eb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所有模型都将使用<a class="ae ky" href="https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html" rel="noopener ugc nofollow" target="_blank">交叉熵损失函数</a>进行训练，这是分类问题的标准选择。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/4b08961afeae7e2351ce43a47b24823d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IioQtDP4tQ8jTa4UK19fQQ.png"/></div></div></figure><p id="263d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将使用<a class="ae ky" href="https://www.tensorflow.org/tensorboard" rel="noopener ugc nofollow" target="_blank"> TensorBoard </a>来可视化培训和测试指标(损失和准确性)。尽管Tensorboard是由Google为其DL框架TensorFlow开发的，但它与PyTorch集成得非常好。</p><h2 id="33c1" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">2.2.1线性模型→ 10个参数</h2><p id="5ad7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是我们学习最优策略的第一个候选人。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/525c79a969fbcc98675a1d8820e8a1d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*xTfPFtWGArFwzjEauzTHJQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线性模型=无隐层的神经网络(图片由作者提供)</p></figure><p id="2ee0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们创建PyTorch模型如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/d3c1a1974c2701d24ccc3e5de9514ba2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h_AVNJmiKpKcv7e1m0JcWQ.png"/></div></div></figure><p id="f0fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们训练这个模型150个纪元。一个历元是整个列车数据的完整传递。因此，我们将使用训练数据中的每个样本150次来调整模型参数</p><p id="a73a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在每个时期结束时，我们使用测试数据计算模型损失和精确度。通过这种方式，我们可以衡量<em class="nh">模型有多好</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/0e243b12adaee65731e8fd141d11d144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Y0wxONQYPS9a_tr-y7-Mg.png"/></div></div></figure><p id="2e0a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们启动Tensorboard服务器来可视化训练和测试指标。我们可以在Jupyter笔记本上使用</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/8e275d4b3ea8dc163c3604cc39e65607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ThCAXZ09h-cuu2dl_eHsQg.png"/></div></div></figure><blockquote class="ni nj nk"><p id="fa7e" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu">注意</strong>:如果你愿意，你可以直接从命令行启动Tensorboard，并导航到控制台上打印的URL，在我这里是<code class="fe oe of og oh b">localhost:6009/</code></p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/98933c3b98ddac842bc3e503568a7759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HFXxMxmiyUi9gW8GoimH-Q.png"/></div></div></figure><p id="8c1c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">打开Tensoboard，选择最近一次跑步。您应该会看到这两个图表:</p><ul class=""><li id="9946" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><strong class="lt iu">列车数据上的精度</strong>，一批接一批。它稳定在70%左右。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/f0c2d62e8c5dcc61b6e4876907fca699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8WZo0EuQYSHZczrlq2Amw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">列车精度(图片由作者提供)</p></figure><ul class=""><li id="0be1" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><strong class="lt iu">测试数据的准确性</strong>，一批接一批。它也稳定在70%左右。这个数字大于50%的基线，因此模型正在学习一些东西。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/98b23536b3de55e100ed542fe239184f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMpIDtT7Tey4yXeU8H9WcA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试准确度(图片由作者提供)</p></figure><p id="a763" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">70%没那么差，但也远非完美。</p><blockquote class="ni nj nk"><p id="3324" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it">💡提示:绘制训练度量来检测bug</em><br/></strong>总是绘制训练准确性和损失，因为它可以帮助您找到代码中的bug。如果准确度(损失)在每个时期后没有增加(减少)，这意味着你的网络没有学习。这可能是由于您需要修复代码中的一个bug。</p><p id="b2d6" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it"> 🧠学习:欠拟合训练数据</em> </strong> <br/>如果模型对于任务来说太小，我们观察到训练和测试精度都处于中等水平，在这种情况下为70%。我们说模型<strong class="lt iu">不符合数据</strong>，我们需要尝试一个更大的模型。</p></blockquote><p id="69a8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们扩大网络以改善结果。</p><h2 id="9c8f" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">2.2.2具有1个隐含层的神经网络→1795个参数</h2><p id="7524" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们创建一个具有256个单元的隐藏层的神经网络:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/03fe1a895ab210bbc26545bf39a73164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d2y8aensI7C6S7pe_Lt1_g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/fabef12dccfc91525f74c6caa88243aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*YM8QxUKz2MCqHq5ZHB47Lw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有1个隐藏层的神经网络(图片由作者提供)</p></figure><p id="7b99" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们训练它150个历元，然后去Tensorboard检查指标</p><ul class=""><li id="b110" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><strong class="lt iu">测试数据的准确性。</strong>我们从70%提高到了85%左右。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/f004aaa3ddf5079c4e01382bb92901bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q7xq33fRMqOQaEGQ2763ZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试准确度(图片由作者提供)</p></figure><p id="081c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">85%看起来好多了。但是，我认为我们可以做得更好。让我们试试更大的神经网络。</p><h2 id="b3b1" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">2.2.3具有两个隐藏层的神经网络→ 67，586个参数</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/5f448feb4c912e41b7238a91db5760f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*syGB3VvNZX0Q9emC3Kb26Q.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/30a8363a44bd26504241f78c080f45e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*x4OpkNFrh-83pHqSnjxGag.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有两个隐藏层的神经网络(图片由作者提供)</p></figure><p id="eb3a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你会观察到它的<strong class="lt iu">测试准确率</strong>达到90%。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/674583e445b8bc162588261833072bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIAv49NLd1cMmH9bSoYLag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试准确度(图片由作者提供)</p></figure><p id="e1ce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">增加网络规模似乎是一个明智的策略。我们再进一步，再加一层。</p><h2 id="e41c" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">2 . 2 . 4 3隐层神经网络→ 133，378个参数</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/db7dff3c20dc6ae00c22722ece0c3154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVcI_7HCQpbYTk6VY3_T7A.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/6613c015a1461e7d6ac7f0581d1925b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVoB2JqdfaPayTFjVyZRlA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有3个隐藏层的神经网络(图片由作者提供)</p></figure><p id="c4de" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你在测试数据上检查它的准确性，你会看到它达到90%。因此，这种模式并不能改善我们的最佳结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/e52ee05e597f0d1f8cce1891759d4314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0YFs0rH2ZVeyyoWNAz71Ig.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试准确度(图片由作者提供)</p></figure><p id="ed5d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">直观地看，我们之前的模型，有两个隐藏层和大约67k的参数，做得足够好了。使用更复杂的模型并不能真正带来更好的结果。</p><blockquote class="ni nj nk"><p id="97fb" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it"> 🧠学习:过拟合训练数据<br/> </em> </strong>如果你的模型相对于训练数据量过大，你会<strong class="lt iu">过拟合</strong>训练数据。要检测过度拟合，看一看火车和测试损失。<br/>如果训练损失继续减少，而测试损失保持平稳，这意味着你开始过度拟合</p></blockquote><p id="e6d3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这种情况下，我们可以通过查看序列和测试损耗来检查过度拟合:</p><ul class=""><li id="2e86" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><strong class="lt iu">列车数据丢失</strong>几乎达到0 <strong class="lt iu">。</strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/638c59fb4eb722c555dbdb33842eec6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tQ728rrKCuSjdVtD7ZPGJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">列车数据丢失几乎达到0！(图片由作者提供)</p></figure><ul class=""><li id="833e" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated"><strong class="lt iu">测试数据损失</strong>在0.3处达到平稳状态，这与具有两个隐藏层的先前模型相同。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/9ab3bcedaacdf4ec0e6cb5b919fef838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jvh4svszItJEmwlsTf7r3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试数据丢失(图片由作者提供)</p></figure><blockquote class="ni nj nk"><p id="153b" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu">T19】💡提示:收集更多的数据来改善结果 </strong></p><p id="1775" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">改进神经网络模型的最有效策略是使用更大的训练集。这个建议适用于任何机器学习模型，而不仅仅是神经网络。然而，神经网络是从更大的训练集受益最多的网络，因为它们是高度参数化的，并且可以灵活地适应数据中最复杂的模式。</p></blockquote><p id="aa08" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如你所看到的，有相当多的实验来为这个问题找到正确的神经网络结构。</p><p id="8f1b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可能会问…</p><p id="6176" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nh">有没有系统的方法来为我的数据找到合适的架构？</em></p><p id="ef5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">是的，有。在这一节中，我们从小模型到大模型，以便逐步增加复杂性。然而，在实践中，你应该走另一条路。</p><blockquote class="ni nj nk"><p id="159b" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu">T25】💡提示:由大变小 </strong></p><p id="e1da" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">一般来说，你应该从一个足够大的网络开始，这个网络要能够适应训练数据。一旦您确定网络有足够的容量，您就开始减少它，以减少对训练数据的过度拟合并提高验证数据的准确性。</p><p id="373d" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><a class="ae ky" href="https://twitter.com/karpathy" rel="noopener ugc nofollow" target="_blank">安德烈·卡帕西</a>有一篇关于这方面的非常好的博文，我强烈推荐你阅读<br/>📝<a class="ae ky" href="http://karpathy.github.io/2019/04/25/recipe/" rel="noopener ugc nofollow" target="_blank">训练神经网络的方法</a></p></blockquote><p id="f26e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望在本节之后，您对如何训练神经网络模型有更好的理解。</p><p id="9e9c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我建议您浏览一下<code class="fe oe of og oh b"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl/blob/main/03_cart_pole/src/supervised_ml.py" rel="noopener ugc nofollow" target="_blank">src/supervised_ml.py</a></code>中的代码，以巩固我们在本节中所讨论的内容。在监督设置中训练神经网络模型是现实世界中深度学习的一个非常实际的用例。练习100次，如果有问题就告诉我📩。</p><p id="80c1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在下一节中，我们将回到车杆问题。</p><p id="beaf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你准备好把RL和你刚刚学到的关于神经网络的知识混合起来了吗？</p><h1 id="2d1f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.深度Q-学习解大车杆子</h1><p id="da5a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">回到参数Q学习和推车杆。</p><p id="22bb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将完全重用第4部分的代码，唯一的区别是我们将替换最优q函数的线性参数化</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/41cbf7dd6d5a8db84b22ba0206df9f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*g6KgxrSVAYlGZO7AK1q7Gg.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线性模型(图片由作者提供)</p></figure><p id="d099" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">具有两个隐藏层的神经网络</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/aad4a472af57e9f029194a3227edcc6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*Ibtr60PwTe51yyJqUqh8Eg.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有两个隐藏层的神经网络(图片由作者提供)</p></figure><p id="2d58" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这将是课程中第一个深度强化学习算法。在这种情况下，深度Q网络。</p><p id="f561" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nh">超参数呢？</em></p><p id="b9be" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">RL算法对超参数极其敏感。深度Q学习也不例外。</p><p id="5d7b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我不想对你撒谎。寻找正确的超参数可能非常耗时。超参数在深度强化学习中非常关键，许多作者都没有发表它们。这对任何进入这个领域的人来说都是相当令人沮丧的。</p><p id="5b1c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">甚至训练循环中的随机性，例如来自存储器中成批训练数据的混洗，也会对最终的代理参数产生很大的影响。</p><p id="6d61" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正因为如此，我们总是在Python脚本的开头修复所有的种子</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/25ae2debebe643890447d3fc2d849dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LLjpdLwtaoGMR-L6xnfKsw.png"/></div></div></figure><p id="124b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，这不足以确保机器间的可重复性。可能发生的情况是，你和我都使用相同的超参数和随机种子，但我们得到不同的模型，只是因为你在GPU上训练，而我没有。</p><p id="8ae5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">换句话说，不能保证PyTorch版本、不同平台或硬件设置(GPU与CPU)之间完全可再现的结果。</p><blockquote class="ni nj nk"><p id="3c9a" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated"><strong class="lt iu"> <em class="it">结果的再现性</em> </strong> <br/>当使用我在本节分享的完全相同的超参数时，您可能不会得到与我相同的结果。</p><p id="dbb4" class="lr ls nh lt b lu mn ju lw lx mo jx lz nl mp mc md nm mq mg mh nn mr mk ml mm im bi translated">不要沮丧。在下一课中，我们将学习如何自己调整超参数，您将能够找到那些对您的设置非常有用的参数，以防它们对您不起作用。</p></blockquote><h2 id="0743" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">错误的超参数</h2><p id="f2e3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl/blob/main/03_cart_pole/notebooks/06_deep_q_agent_bad_hyperparameters.ipynb" rel="noopener ugc nofollow" target="_blank">👉🏽notebooks/06 _ deep _ q _ agent _ bad _ hyperparameters . ipynb</a></p><p id="2f0b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些超参数绝对不是我发现的最差的。我称它们为<em class="nh">坏的</em>，因为它们给出了与第4部分中的线性q模型相似的结果。</p><p id="b264" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当超参数设置不当时，使用复杂的神经网络模型有什么意义？</p><p id="e0e4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些是超参数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/38da47af1378925dc24a6952343bd20c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WPb5cengOyIZ_qCHguHdHQ.png"/></div></div></figure><p id="f2b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">像往常一样，我们修复种子</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/fc7a2cddb598631d7051f540ecb2d88a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ehEMqjwNcQ2n9wox8ESsA.png"/></div></div></figure><p id="17df" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们从这些超参数中声明<code class="fe oe of og oh b">QAgent</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/9bfadd064204eb91d027a81cf8fb2b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HoGMfB9P_47JSGXbAJIBwg.png"/></div></div></figure><p id="5c51" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们训练了200集:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/6a48fdf82291901b53817f1974ee9763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTy4pMfsH2TbbIEXv2XOZg.png"/></div></div></figure><p id="b775" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后我们对1000集的代理进行评估</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/16119a0ea4af5ae61dbde9048f64f44b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eDQv_AXEhvdJeDqxjXUMkw.png"/></div></div></figure><p id="9583" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">结果还不错，但我们可以做得更好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/5ad94f29789f50ddea635670f4c4e9eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwGRzsoFRHMqMyQ8PMz0Jw.png"/></div></div></figure><p id="12a2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">那就开始吧！</p><h2 id="237d" class="nq la it bd lb nr ns dn lf nt nu dp lj ma nv nw ll me nx ny ln mi nz oa lp ob bi translated">良好的超参数</h2><p id="b687" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl/blob/main/03_cart_pole/notebooks/07_deep_q_agent_good_hyperparameters.ipynb" rel="noopener ugc nofollow" target="_blank">👉🏽notebooks/07 _ deep _ q _ agent _ good _ hyperparameters . ipynb</a></p><p id="aebd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些超级参数在我的MacBook上非常管用:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/1ba22a700cae0f071f5a81bf1d9c0350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clsPwr8a3soNYiKPOyI5hw.png"/></div></div></figure><p id="232a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">像往常一样，我们修复种子</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/fc7a2cddb598631d7051f540ecb2d88a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ehEMqjwNcQ2n9wox8ESsA.png"/></div></div></figure><p id="ed5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们从这些超参数中声明<code class="fe oe of og oh b">QAgent</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/9bfadd064204eb91d027a81cf8fb2b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HoGMfB9P_47JSGXbAJIBwg.png"/></div></div></figure><p id="0920" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们训练了200集:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/6a48fdf82291901b53817f1974ee9763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTy4pMfsH2TbbIEXv2XOZg.png"/></div></div></figure><p id="d371" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你评价《T2》剧集的经纪人</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/16119a0ea4af5ae61dbde9048f64f44b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eDQv_AXEhvdJeDqxjXUMkw.png"/></div></div></figure><p id="978d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您将看到它达到了100%的性能:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/b6dd4da3cda2992e353af52ba7e9ec1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5uaJkrCsdl3x9LW5FZPwwg.png"/></div></div></figure><p id="52db" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">呜哇！！Amaaaziiiing！！！</p><p id="0732" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这很酷。我们在CartPole环境中找到了完美的deep q-agent！(如果您还没有在您的计算机上，请等待第6部分，我将揭示超参数调谐背后的科学和工程😉).</p><p id="cafe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">今天就到这里吧，伙计们。</p><p id="b337" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">渴望了解更多信息？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/04cb7dfd3d498448b6e5efa6dbfef883.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*babPSq0Fx_ZPhuMFfesnmQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯·❤️意大利面(图片由作者提供)</p></figure><h1 id="16f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.重述✨</h1><p id="a02d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这些是我希望你们从今天的课程中汲取的重要知识:</p><ul class=""><li id="e90d" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm ol my mz na bi translated">神经网络是非常强大的函数逼近器。您可以在完全监督的设置中使用它们(例如，从标记数据中学习最佳策略)，或者作为RL算法的一个组件(例如，逼近最佳q值函数)。</li><li id="1269" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm ol my mz na bi translated">找到正确的神经网络架构并不容易。过大(过小)的神经导致过度拟合(欠拟合)。一般来说，从一个过度拟合训练数据的大型网络开始。然后你开始减少它来提高验证的准确性。</li><li id="cc84" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm ol my mz na bi translated">深度Q学习中的超参数对于确保训练循环收敛到最优解至关重要。此外，跨平台(例如Windows vs Mac)、底层硬件(GPU vs CPU)和PyTorch版本的完全再现性极其困难，如果目前还不可能的话。</li></ul><h1 id="1a9f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5.家庭作业📚</h1><p id="2609" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl/blob/main/03_cart_pole/notebooks/08_homework.ipynb" rel="noopener ugc nofollow" target="_blank">👉🏽笔记本/08 _作业. ipynb </a></p><p id="48de" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们弄脏你的手:</p><ol class=""><li id="4bbc" class="ms mt it lt b lu mn lx mo ma oi me oj mi ok mm mx my mz na bi translated"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> Git克隆</strong> </a>回购到你的本地机器。</li><li id="d779" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl/tree/main/02_mountain_car#quick-setup" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">设置</strong> </a>本课的环境<code class="fe oe of og oh b">03_cart_pole</code></li><li id="a655" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">打开<code class="fe oe of og oh b"><a class="ae ky" href="https://github.com/Paulescu/hands-on-rl/blob/main/03_cart_pole/notebooks/08_homework.ipynb" rel="noopener ugc nofollow" target="_blank">03_cart_pole/notebooks/08_homework.ipynb</a></code>并尝试完成2个挑战。</li></ol><p id="13bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你不是深度学习高手，我推荐你解决第1个挑战。在我们的<em class="nh">模拟问题</em>中，增加训练数据量并尝试达到至少95%的准确率。</p><p id="e6ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在第二个挑战中，我希望你能找到一个更简单的神经网络(例如，只有一个隐藏层)，它可以完美地解决横竿问题。</p><h1 id="dffb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">6.下一步是什么？❤️</h1><p id="f6de" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在下一课中，我们将学习如何像专业人士一样使用正确的工具来调整超参数。</p><p id="4905" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在那之前，</p><p id="527e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">爱和学习。</p><p id="4686" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">还要特别感谢<a class="ae ky" href="https://www.linkedin.com/in/neria-uzan-369803107/" rel="noopener ugc nofollow" target="_blank"> Neria Uzan </a>，感谢他对课程如此投入。感谢你的辛勤工作和给我的反馈！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pv"><img src="../Images/82fa9b57f341ca8981d27146f45e26d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0jE9WFHWSECzeFD5k-eZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来吧伙计。(图片由作者提供)</p></figure></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><p id="082f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="nh">你想成为(甚至)更好的数据科学家，接触关于机器学习和数据科学的顶级课程吗？</em></p><p id="61c4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">👉🏽订阅<a class="ae ky" href="https://datamachines.xyz/subscribe/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> <em class="nh"> datamachines </em>简讯</strong> </a> <strong class="lt iu">。</strong></p><p id="c9fa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">👉🏽<a class="ae ky" href="https://pau-labarta-bajo.medium.com/" rel="noopener"> <strong class="lt iu">跟着我</strong> </a>上媒。</p><p id="4911" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">👉🏽给课程一个⭐<a class="ae ky" href="https://github.com/Paulescu/hands-on-rl" rel="noopener ugc nofollow" target="_blank">github回购</a></p><p id="fb70" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">祝你愉快，🧡❤️💙</p><p id="4f0f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">避寒胜地</p></div></div>    
</body>
</html>