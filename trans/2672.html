<html>
<head>
<title>In-Depth spaCy Tutorial For Beginners in NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NLP初学者的深入空间教程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/in-depth-spacy-tutorial-for-beginners-in-nlp-2ba4d961328f#2022-06-09">https://towardsdatascience.com/in-depth-spacy-tutorial-for-beginners-in-nlp-2ba4d961328f#2022-06-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="870a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习Scikit-学习自然语言处理</h2></div><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/7da0e8a1efb4c648a6029f07ab71cf34.png" data-original-src="https://miro.medium.com/v2/format:webp/1*azin0zDhpwSHArqo4z3_Nw.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated"><strong class="bd ku">照片由</strong> <a class="ae kv" href="https://www.pexels.com/photo/red-blue-and-white-fluid-abstract-painting-2317710/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ku">安妮荣凯</strong> </a></p></figure><h2 id="e30b" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">介绍</h2><p id="0f85" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">不，我们今天不会用数十亿个参数来构建语言模型。我们将从小处着手，学习spaCy的NLP基础知识。我们将仔细研究这个库是如何工作的，以及如何使用它来轻松解决初级/中级NLP问题。</p><p id="01b6" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">帖子已经很长了，我就截到这里，直接跳到文章的正文。</p><div class="mq mr gp gr ms mt"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">通过我的推荐链接加入Medium-BEXGBoost</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">获得独家访问我的所有⚡premium⚡内容和所有媒体没有限制。支持我的工作，给我买一个…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ko mt"/></div></div></a></div><p id="e188" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">获得由强大的AI-Alpha信号选择和总结的最佳和最新的ML和AI论文:</p><div class="mq mr gp gr ms mt"><a href="https://alphasignal.ai/?referrer=Bex" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">阿尔法信号|机器学习的极品。艾总结的。</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">留在循环中，不用花无数时间浏览下一个突破；我们的算法识别…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">alphasignal.ai</p></div></div><div class="nc l"><div class="ni l ne nf ng nc nh ko mt"/></div></div></a></div></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="b6c0" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">spaCy是什么？</h2><p id="2582" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">spaCy就像自然语言处理的Sklearn。它是一个具有大量功能的行业标准，能够以一流的速度、准确性和性能解决许多NLP任务。</p><p id="7663" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">其核心是管道，你可以把它想象成已经在数百万文本实例上训练过的特定于语言的模型。</p><p id="77e1" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">它也是spaCy生态系统的领导者，该生态系统包括几十个库和工具，如Prodigy、Forte、displaCy、explacy、ADAM、Coreferee等。</p><p id="384c" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">spaCy还可以与来自TensorFlow、PyTorch和其他框架的定制模型握手。</p><p id="cf8d" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，spaCy支持66种语言作为独立的管道，新的语言正在慢慢增加。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="24b1" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">空间基础</h2><p id="eff9" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">在了解spaCy如何工作之前，让我们安装它:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="9262" class="kw kx it nr b gy nv nw l nx ny">pip install -U spacy</span></pre><p id="1007" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">spaCy有三条英语管道，对于复杂的任务有不同的大小和功能。在本教程中，我们将只需要安装小型和中型管道，但为了完整起见，我也包括了大型管道:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="eb4a" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">导入spaCy后，我们需要加载刚刚安装的一个管道。现在，我们将加载小的并存储到<code class="fe ob oc od nr b">nlp</code>:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="f85f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在spaCy生态系统中命名任何加载的语言模型<code class="fe ob oc od nr b">nlp</code>是一个惯例。现在可以在任何文本上调用该对象来启动信息提取:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="7cba" class="kw kx it nr b gy nv nw l nx ny"># Create the Doc object<br/>doc = nlp(txt)</span></pre><p id="fc16" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated"><code class="fe ob oc od nr b">doc</code>对象也是一个约定，现在它已经填充了关于给定文本的句子和单词的额外信息。</p><p id="d471" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">一般来说，<code class="fe ob oc od nr b">doc</code>对象只是一个迭代器:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="c1be" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">您可以使用切片或索引符号来提取单个令牌:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="751f" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; type(token)</span><span id="491c" class="kw kx it nr b gy oe nw l nx ny">spacy.tokens.token.Token</span><span id="4443" class="kw kx it nr b gy oe nw l nx ny">&gt;&gt;&gt; len(doc)</span><span id="01ba" class="kw kx it nr b gy oe nw l nx ny">31</span></pre><blockquote class="of og oh"><p id="3aca" class="ls lt oi lu b lv ml ju lx ly mm jx ma oj mn mc md ok mo mf mg ol mp mi mj mk im bi translated">记号化就是把句子拆分成单词和标点符号。单个标记可以是一个单词、一个标点符号或一个名词块等。</p></blockquote><p id="f6a9" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">如果您提取了多个令牌，那么您就有了一个span对象:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="0956" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; span = doc[:5]<br/>&gt;&gt;&gt; type(span)</span><span id="c175" class="kw kx it nr b gy oe nw l nx ny">spacy.tokens.span.Span</span><span id="89ac" class="kw kx it nr b gy oe nw l nx ny">&gt;&gt;&gt; span.text</span><span id="b402" class="kw kx it nr b gy oe nw l nx ny">'The tallest living man is'</span></pre><p id="22c8" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">spaCy也是为了提高内存效率而构建的。这就是为什么<code class="fe ob oc od nr b">token</code>和<code class="fe ob oc od nr b">span</code>对象都只是<code class="fe ob oc od nr b">doc</code>对象的视图。没有重复。</p><p id="0660" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">预训练的英语管道和许多其他管道具有特定于语言的规则，用于标记化和提取它们的词汇属性。这里有6个这样的属性:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="4cff" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">一些有趣的属性是<code class="fe ob oc od nr b">lemma_</code>，它返回去掉了任何后缀、前缀、时态或任何其他语法属性的基本单词，还有<code class="fe ob oc od nr b">like_num</code>，它既能识别文字数字，也能识别字母数字。</p><p id="ac9c" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">你将把大部分时间花在这四个物体上——<code class="fe ob oc od nr b">nlp</code>、<code class="fe ob oc od nr b">doc</code>、<code class="fe ob oc od nr b">token</code>和<code class="fe ob oc od nr b">span</code>。让我们仔细看看它们是如何关联的。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="f5b9" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">架构和核心数据结构</h2><p id="b2dc" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">让我们从<code class="fe ob oc od nr b">nlp</code>开始，它是一个隐藏的语言对象:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="73a1" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">语言对象在数百万个文本实例和标签上进行预训练，并以其二进制权重加载到spaCy中。这些权重允许您在新数据集上执行各种任务，而不必担心繁琐的细节。</p><p id="9125" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">正如我前面提到的，spaCy拥有22种语言的完整训练管道，其中一些你可以在下面看到:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="3201" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">对于其他+40语言，spaCy只提供基本的标记化规则，其他功能正在慢慢与社区的努力集成。</p><p id="0277" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">也可以直接从<code class="fe ob oc od nr b">lang</code>子模块加载语言模型:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="4faa" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在处理一个文本后，单词和标点符号被存储在<code class="fe ob oc od nr b">nlp</code>的词汇对象中:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="e4b4" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; type(nlp.vocab)</span><span id="d31d" class="kw kx it nr b gy oe nw l nx ny">spacy.vocab.Vocab</span></pre><p id="4c23" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">这个<code class="fe ob oc od nr b">Vocab</code>在文档之间共享，这意味着它存储所有文档中的所有新单词。相比之下，<code class="fe ob oc od nr b">doc</code>对象的词汇表只包含来自<code class="fe ob oc od nr b">txt</code>的单词:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="c200" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; type(doc.vocab)</span><span id="7986" class="kw kx it nr b gy oe nw l nx ny">spacy.vocab.Vocab</span></pre><p id="3958" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在内部，spaCy以散列方式通信以节省内存，并有一个名为<code class="fe ob oc od nr b">StringStore</code>的双向查找表。您可以获取字符串的哈希值，或者如果有哈希值，则获取字符串:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="fda1" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; type(nlp.vocab.strings)</span><span id="4c34" class="kw kx it nr b gy oe nw l nx ny">spacy.strings.StringStore</span><span id="2305" class="kw kx it nr b gy oe nw l nx ny">&gt;&gt;&gt; nlp.vocab.strings["google"]</span><span id="559c" class="kw kx it nr b gy oe nw l nx ny">1988622737398120358</span><span id="cbd4" class="kw kx it nr b gy oe nw l nx ny">&gt;&gt;&gt; nlp.vocab.strings[1988622737398120358]</span><span id="3513" class="kw kx it nr b gy oe nw l nx ny">'google'</span></pre><p id="2e88" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">当令牌进入<code class="fe ob oc od nr b">Vocab</code>时，它们会丢失所有特定于上下文的信息。所以，当你从词汇库中查找单词时，你是在查找<code class="fe ob oc od nr b">lexeme</code> s:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="0d9f" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; lexeme = nlp.vocab["google"]<br/>&gt;&gt;&gt; type(lexeme)</span><span id="c224" class="kw kx it nr b gy oe nw l nx ny">spacy.lexeme.Lexeme</span></pre><p id="48bf" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">词汇不包含特定语境的信息，如词性标记、形态依赖等。但是它们仍然提供了这个词的许多词汇属性:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="cb54" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; print(lexeme.text, lexeme.orth, lexeme.is_digit)</span><span id="fedc" class="kw kx it nr b gy oe nw l nx ny">google 1988622737398120358 False</span></pre><blockquote class="of og oh"><p id="02d8" class="ls lt oi lu b lv ml ju lx ly mm jx ma oj mn mc md ok mo mf mg ol mp mi mj mk im bi translated"><code class="fe ob oc od nr b">orth</code>属性是针对词素的散列。</p></blockquote><p id="d060" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">所以，如果你正在通过<code class="fe ob oc od nr b">doc</code>对象看一个单词，它就是一个令牌。如果是来自<code class="fe ob oc od nr b">Vocab</code>，那就是一个词位。</p><p id="c74b" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，我们再来谈谈<code class="fe ob oc od nr b">doc</code>这个物体。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="5940" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在文本上调用<code class="fe ob oc od nr b">nlp</code>对象生成文档及其特殊属性。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="8e86" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">您可以通过从<code class="fe ob oc od nr b">tokens</code>模块导入<code class="fe ob oc od nr b">Doc</code>类来手动创建文档:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="204f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated"><code class="fe ob oc od nr b">Doc</code>需要三个参数——来自<code class="fe ob oc od nr b">nlp</code>的词汇表、一个单词列表和另一个指定单词后面是否有空格的列表(包括最后一个)。<code class="fe ob oc od nr b">doc</code>所有tokes都有这个信息。</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="bb80" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; len(doc)</span><span id="2acd" class="kw kx it nr b gy oe nw l nx ny">4</span><span id="a602" class="kw kx it nr b gy oe nw l nx ny">&gt;&gt;&gt; doc.text</span><span id="d84b" class="kw kx it nr b gy oe nw l nx ny">'I love Barcelona!'</span></pre><p id="46bc" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">Spans也是它们自己的一个类，公开了一系列属性，尽管它们只是<code class="fe ob oc od nr b">doc</code>对象的一个视图:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="1a25" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">要手动创建span对象，请将doc对象和标记的开始/结束索引传递给<code class="fe ob oc od nr b">Span</code>类:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="b422" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">命名实体识别(NER)</h2><p id="2f1f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">自然语言处理中最常见的任务之一是预测命名实体，如人、地点、国家、品牌等。</p><p id="6e86" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在太空中表演NER简单得可笑。处理完一个文本后，只需提取<code class="fe ob oc od nr b">doc</code>对象的<code class="fe ob oc od nr b">ents</code>属性:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="295f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">克利奥帕特拉被认为是一个人，而埃及是一个地缘政治实体(GPE)。要了解其他标签的含义，您可以使用<code class="fe ob oc od nr b">explain</code>功能:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="da49" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">除了打印文本，您还可以使用spaCy的可视实体标记器，可通过<code class="fe ob oc od nr b">displacy</code>获得:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/7dff608f9c8ad27d00cac0d8aae31286.png" data-original-src="https://miro.medium.com/v2/format:webp/1*eRSLmX0WfjsZanIe3PkeMA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="859e" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">图像显示亚历山大大帝没有被识别为一个人，因为它不是一个普通的名字。不过没关系，我们可以手动给亚历山大贴上一个人的标签。</p><p id="69ab" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">首先，通过给它一个标签(PERSON)来提取全名作为span:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="92a9" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">然后，用跨度更新<code class="fe ob oc od nr b">ents</code>列表:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="a5a9" class="kw kx it nr b gy nv nw l nx ny">doc.ents = list(doc.ents) + [alexander]</span></pre><p id="0070" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，<code class="fe ob oc od nr b">displacy</code>也对其进行标记:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/77d84de093ca31d5d07946c5c9f9ba14.png" data-original-src="https://miro.medium.com/v2/format:webp/1*5KfXJX5JVD3Dm_LUcdTjEg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="e8d1" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">您也可以用<code class="fe ob oc od nr b">set_ents</code>函数设置新实体:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="9793" class="kw kx it nr b gy nv nw l nx ny"># Leaves the rest of ents untouched<br/>doc.set_ents([alexander], default="unmodified")</span></pre></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="1979" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">预测词性(POS)标签和句法依赖性</h2><p id="2213" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">spaCy还为文档的语法分析提供了丰富的工具选择。标记的词汇和语法属性作为属性给出。</p><p id="2a0a" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">例如，让我们来看看每个标记的词性标签及其句法依赖性:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="c0fe" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">输出包含一些令人困惑的标签，但我们可以推断出其中的一些，如动词、副词、形容词等。让我们看看其他几个人的解释:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="3047" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">上表中的最后一列表示单词关系，如“第一个”、“第一个脚印”、“保持在那里”等。</p><p id="a1da" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">spaCy包含许多更强大的语言分析特性。作为最后一个例子，下面是你如何提取名词块:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="6eb1" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">从spaCy用户指南的本页了解更多关于语言特性的信息。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="5b20" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">基于自定义规则的令牌化</h2><p id="2345" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">到目前为止，spaCy已经完全控制了标记化规则。但是一种语言可能有许多文化特有的特质和不符合spaCy规则的边缘情况。例如，在更早的例子中，我们看到“亚历山大大帝”作为一个实体被遗漏了。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="e331" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">如果我们再次处理相同的文本，spaCy将实体视为三个令牌。我们需要告诉它，像亚历山大大帝或破碎的布兰这样的有头衔的名字应该被认为是一个记号，而不是三个，因为把它们分开没有意义。</p><p id="7b55" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">让我们看看如何通过创建自定义令牌化规则来实现这一点。</p><p id="ceb1" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们将从创建一个模式作为字典开始:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="a8be" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在spaCy中，您可以组合使用大量的关键字来解析几乎任何类型的令牌模式。例如，上面的模式是一个三标记模式，第一个和最后一个标记是一个字母数字文本，中间的一个是一个停用词(如<em class="oi"> the、and、or等)。)</em>。换句话说，我们是在匹配“亚历山大大帝”而没有明确告诉spaCy。</p><p id="b30f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，我们将用这种模式创建一个<code class="fe ob oc od nr b">Matcher</code>对象:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="7b34" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">处理完文本后，我们在<code class="fe ob oc od nr b">doc</code>对象上调用这个matcher对象，它返回一个匹配列表。每个匹配是一个包含三个元素的元组——匹配ID、开始和结束:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="723f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">你可以随意调整图案。例如，您可以在reGex关键字中使用像<code class="fe ob oc od nr b">OP</code>这样的量词，或者使用reGex本身:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="ffb9" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">你可以从<a class="ae kv" href="https://spacy.io/usage/rule-based-matching" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多关于定制的基于规则的匹配。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="08b1" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">词向量和语义相似度</h2><p id="a283" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">NLP的另一个日常用例是预测语义相似度。相似性得分可用于推荐系统、抄袭、重复内容等。</p><p id="c4a4" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">spaCy使用单词向量(如下所述)计算语义相似度，单词向量在中型模型中可用:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="ad30" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">所有的<code class="fe ob oc od nr b">doc</code>、<code class="fe ob oc od nr b">token</code>和<code class="fe ob oc od nr b">span</code>对象都有这个<code class="fe ob oc od nr b">similarity</code>方法:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="70b6" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">这三个类也可以相互比较，就像span的一个标记:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="7230" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; doc1[0:2].similarity(doc[3])</span><span id="c928" class="kw kx it nr b gy oe nw l nx ny">0.8700238466262817</span></pre><p id="d8d1" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">使用单词向量来计算相似度，单词向量是单词的多维数学表示。例如，下面是文档中第一个标记的向量:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="eca3" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">关于管道的一切</h2><p id="5e60" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">在引擎盖下，语言模型不是一个管道，而是一个集合:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="167d" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">当用<code class="fe ob oc od nr b">nlp</code>处理一个文本时，它首先被标记化，并从上面的列表传递给每个管道，管道又修改并返回带有新信息的Doc对象。以下是空间文档中对此的说明:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/1cdefef113480ed5af0ef88da9c323a9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*KwE-Cdp89oCCP8eUHP-CJg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片来自空间文档</p></figure><p id="b84b" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">但是，spaCy没有为您在现实世界中可能遇到的任何NLP问题提供定制管道。例如，您可能希望在将文本传递给其他管道之前执行预处理步骤，或者编写回调来提取管道之间不同类型的信息。</p><p id="a2a4" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">对于这种情况，您应该学习如何编写定制的管道函数并将它们添加到<code class="fe ob oc od nr b">nlp</code>对象中，这样当您对文本调用<code class="fe ob oc od nr b">nlp</code>时，它们就会自动运行。</p><p id="fa04" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">以下是如何做到这一点的基本概述:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="bd11" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">你需要通用的<code class="fe ob oc od nr b">Language</code>类，并在你的函数上修饰它的<code class="fe ob oc od nr b">component</code>方法。自定义函数必须接受并返回doc对象的单个参数。上面，我们定义了一个简单的管道，打印出doc对象的长度。</p><p id="c0de" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">让我们将它添加到<code class="fe ob oc od nr b">nlp</code>对象中:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="3c61" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">如您所见，自定义管道被添加到末尾。现在，我们将在一个示例文本上调用<code class="fe ob oc od nr b">nlp</code>:</p><pre class="ki kj kk kl gt nq nr ns nt aw nu bi"><span id="a1c4" class="kw kx it nr b gy nv nw l nx ny">&gt;&gt;&gt; doc = nlp("Bird dies, but you remember the flight.")</span><span id="32d8" class="kw kx it nr b gy oe nw l nx ny">There are 9 tokens in this text.</span></pre><p id="50b6" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">按预期工作。</p><p id="3e4f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，让我们做一个更严肃的例子。我们将回到“亚历山大大帝”的例子，并编写一个管道来添加征服者的名字作为一个实体。我们希望所有这些都自动发生，而不需要找到管道外的实体。</p><p id="4645" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">以下是完整的代码:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="7840" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们定义模式，创建匹配器对象，将匹配添加到实体中，并返回文档。让我们来测试一下:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="7a78" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">它正在按预期工作。</p><p id="3d77" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">到目前为止，我们一直在末尾添加自定义管道，但是我们可以控制这种行为。<code class="fe ob oc od nr b">add_pipe</code>函数有参数来精确地指定您想要插入函数的位置:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nz oa l"/></div></figure></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><h2 id="dcc0" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h2><p id="ea31" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">今天，你已经朝着掌握自然语言处理的Scikit-learn迈出了大胆的步伐。有了这篇文章的知识，你现在可以自由地浏览spaCy的用户指南，它和Scikit-learn的一样大，信息丰富。</p><p id="d3d8" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">感谢您的阅读！</p><div class="mq mr gp gr ms mt"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">通过我的推荐链接加入Medium。</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nc l"><div class="om l ne nf ng nc nh ko mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a href="https://ibexorigin.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">每当Bex T .发布时收到电子邮件。</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">每当Bex T .发布时收到电子邮件。注册后，如果您还没有中型帐户，您将创建一个…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nc l"><div class="on l ne nf ng nc nh ko mt"/></div></div></a></div></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="d814" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated"><strong class="lu iu">我的更多故事… </strong></p><div class="mq mr gp gr ms mt"><a href="https://ibexorigin.medium.com/in-depth-guide-to-building-custom-sklearn-transformers-for-any-data-preprocessing-scenario-33450f8b35ff" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">为任何数据预处理场景构建定制Sklearn转换器的深入指南</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">在Sklearn做好每一件事，大家都会开心</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nc l"><div class="oo l ne nf ng nc nh ko mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/advanced-missing-data-imputation-methods-with-sklearn-d9875cbcc6eb"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">Sklearn高级缺失数据插补方法的深入教程</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">学会利用强大的基于模型的插补技术。</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="op l ne nf ng nc nh ko mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/10-minute-effortless-sql-tutorial-for-die-hard-pandas-lovers-a64c36733fd0"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">10分钟轻松的SQL教程，适合铁杆熊猫爱好者</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">曾几何时，情况正好相反</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="oq l ne nf ng nc nh ko mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/how-to-create-slick-math-animations-like-3blue1brown-in-python-457f74701f68"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">如何用Python创建像3Blue1Brown这样流畅的数学动画</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">学习将你对数学和编程的热爱结合起来的最佳方式</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="or l ne nf ng nc nh ko mt"/></div></div></a></div><div class="mq mr gp gr ms mt"><a rel="noopener follow" target="_blank" href="/matplotlib-vs-plotly-lets-decide-once-and-for-all-dc3eca9aa011"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">Matplotlib vs. Plotly:让我们决定一劳永逸</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">从7个关键方面进行深入快速的比较</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="os l ne nf ng nc nh ko mt"/></div></div></a></div></div></div>    
</body>
</html>