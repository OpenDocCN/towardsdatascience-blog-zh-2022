<html>
<head>
<title>Turn Google Sheets into Your Own Database with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python把Google Sheets变成你自己的数据库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/turn-google-sheets-into-your-own-database-with-python-4aa0b4360ce7#2022-06-02">https://towardsdatascience.com/turn-google-sheets-into-your-own-database-with-python-4aa0b4360ce7#2022-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eb5b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python创建电子表格并将数据保存到Google Sheets的指南。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9646763e05993dbedfa5fda31da9092d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L37Oow1jLC44pjgxF-R81g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自Shutterstock，授权给Frank Andrade</p></figure><p id="a26c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您知道Google Sheets可以用作轻量级数据库吗？</p><p id="fd4f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Google Sheets是一个基于云的电子表格应用程序，可以像大多数数据库管理系统一样以结构化的方式存储数据。您还可以通过几次点击来编辑和删除数据，除此之外，还可以在线访问您的数据。</p><p id="7c0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尽管Google Sheets有一些限制，比如您可以使用的单元格数量(最多1000万个单元格)和每分钟可以进行的API调用，但它仍然是一个不错的选择，您可以免费获得。</p><p id="bf74" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本指南中，我将向您展示如何在Python中使用Google Sheets。我们将学习如何使用Python创建电子表格并保存数据，这样您就可以将Google Sheets转换成自己的数据库。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="cb16" class="lz ma it lv b gy mb mc l md me"><strong class="lv iu">Table of Contents<br/></strong>1. <a class="ae mf" href="#461d" rel="noopener ugc nofollow">Enable APIs and download credentials</a><br/>2. <a class="ae mf" href="#6054" rel="noopener ugc nofollow">Turning Google Sheets into a Database with Python</a><br/> - <a class="ae mf" href="#7881" rel="noopener ugc nofollow">Connect to Google Sheets</a><br/> - <a class="ae mf" href="#36be" rel="noopener ugc nofollow">Create a blank spreadsheet</a><br/> - <a class="ae mf" href="#06b5" rel="noopener ugc nofollow">Sharing a spreadsheet</a><br/> - <a class="ae mf" href="#34d4" rel="noopener ugc nofollow">Open the spreadsheet and upload data</a><br/>3. <a class="ae mf" href="#c20a" rel="noopener ugc nofollow">Bonus: Open Any Google Sheet File with Python</a></span></pre><p id="45a1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你不想看，你可以看我的视频！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h1 id="461d" class="mj ma it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">1.启用Google Drive和Google Sheet API并下载凭证</h1><p id="dbc8" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">要用Python连接Google Sheets，我们必须将我们的凭证下载到一个JSON文件中。为此，我们必须开始一个新项目。</p><h2 id="d317" class="lz ma it bd mk nf ng dn mo nh ni dp ms lh nj nk mu ll nl nm mw lp nn no my np bi translated">创建新项目</h2><p id="b6ae" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">要创建一个新项目，请访问这个<a class="ae mf" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">网站</a>，并遵循以下步骤(您需要已经登录您的谷歌账户)。</p><ol class=""><li id="0ad5" class="nq nr it la b lb lc le lf lh ns ll nt lp nu lt nv nw nx ny bi translated">选择一个项目</li><li id="2c60" class="nq nr it la b lb nz le oa lh ob ll oc lp od lt nv nw nx ny bi translated">点击“新项目”</li><li id="9011" class="nq nr it la b lb nz le oa lh ob ll oc lp od lt nv nw nx ny bi translated">将加载一个新页面。在那里，你必须写下你的新项目的名称，然后点击“创建”</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/fae3249a8156186930649d97a49ae58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSk17rV8w5859hWdEZnAdg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c490" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.创建项目后，您将看到下图</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/643575dcfa02add90a531a57344212c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*SUmVHHRwrQ7JsD-mZTUaMA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7632" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击“选择项目”您应该会看到新的一页。</p><h2 id="70ee" class="lz ma it bd mk nf ng dn mo nh ni dp ms lh nj nk mu ll nl nm mw lp nn no my np bi translated">为新项目启用Google Drive API，创建凭证，并下载它</h2><p id="042d" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">选择项目后，转到左侧面板，单击“APIs &amp; Services”，然后选择“Library”，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/79a0fc9c09a966141de1295dfbb8d9c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*GsDfXnT9e0fwmjGC8NQSeA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2e08" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你现在应该看到下面的页面。在那里，我们必须搜索<strong class="la iu"> Google Drive API </strong>并启用它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/06ef91badb2ecc202aa1cc1a03981538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8ZqUbDf5HDLxQccLtDRMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7124" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">启用后，我们必须单击右上角的“创建凭据”。</p><p id="1ffc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在此之后，我们必须选择下面的选项，然后单击“下一步”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b15b98e431d08ff2713b8c6d3d237039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*HXa_aPwIIKXMIQKBcg7wWg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7076" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们为我们的服务帐户命名，并单击“创建并继续”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5bb69cdecf3ce7b6da351cb5f9320ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*-5SaJ750Bs4mfSiCv0QLfw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="80a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们必须选择角色。在这种情况下，我们从“项目”选项中选择“编辑器”，然后单击“完成”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5c437a017d9a3c4184e4405f26d4eb7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*xUJvFQ9TNunVeAHkuIdMnw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cd8e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在此之后，我们必须再次打开左侧面板，单击“APIs &amp; Services ”,然后选择“Credentials”</p><p id="cf80" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在页面底部，您会看到一个“服务帐户”部分。在这里，我们必须点击我们的<strong class="la iu">客户端电子邮件</strong>(请记住，我们将在该部分创建的所有文件都将保存在该客户端电子邮件中)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/1ab3e5fd4b98e480e4f658972d4968ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*3MLB46GRezwMbONxyVrp3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8518" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们必须转到“密钥”部分，并单击“创建新密钥”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/c6d00908fcf7b268905d1818b3d63806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*b_D9Shu5Y416sR18EBBeXg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7c72" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后点击“创建”,一个包含您的凭证的JSON文件将被下载到您的计算机上。我将把这个文件重命名为"<strong class="la iu"> gs_credentials.json" </strong>你必须把这个json文件移动到你的Python脚本所在的同一个文件夹中。</p><p id="d94c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们必须搜索<strong class="la iu"> Google Sheets API </strong>，并像我们之前对Google Drive API所做的那样启用它。</p><h1 id="6054" class="mj ma it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">2.用Python将Google Sheets转化为数据库</h1><h2 id="7881" class="lz ma it bd mk nf ng dn mo nh ni dp ms lh nj nk mu ll nl nm mw lp nn no my np bi translated">连接到Google Sheets</h2><p id="56b9" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">要在Python中使用Google Sheets，首先，我们必须安装gspread和oauth2client。除此之外，我们将使用Pandas来读取我们的本地数据，并将其更新到Google Sheets。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="2c74" class="lz ma it lv b gy mb mc l md me">pip install gspread<br/>pip install oauth2client<br/>pip install pandas</span></pre><p id="42a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们导入库并连接到Google Sheets。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om mi l"/></div></figure><p id="edfe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的代码中，我们在<code class="fe on oo op lv b">scope</code>列表中启用对特定链接的访问，然后在<code class="fe on oo op lv b">credentials</code>变量中写入我们之前下载的JSON文件的名称。</p><p id="b032" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们创建一个<code class="fe on oo op lv b">client</code>变量。</p><h2 id="36be" class="lz ma it bd mk nf ng dn mo nh ni dp ms lh nj nk mu ll nl nm mw lp nn no my np bi translated">创建空白电子表格</h2><p id="54b5" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">让我们创建一个名为“NewDatabase”的新电子表格</p><p id="4c22" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我们必须使用我们之前定义的<code class="fe on oo op lv b">client</code>变量的<code class="fe on oo op lv b">.create</code>方法。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="702e" class="lz ma it lv b gy mb mc l md me">sheet = client.create("NewDatabase")</span></pre><p id="feec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，这个新工作表仅对我们之前创建的服务帐户可见。要使用我们自己的Google帐户访问此表单，我们必须通过电子邮件共享它</p><h2 id="06b5" class="lz ma it bd mk nf ng dn mo nh ni dp ms lh nj nk mu ll nl nm mw lp nn no my np bi translated">共享电子表格</h2><p id="439c" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">让我们用自己的谷歌账号来分享这个<code class="fe on oo op lv b">sheet</code>。为此，请运行下面的代码。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="da33" class="lz ma it lv b gy mb mc l md me">sheet.share('your_email_goes_here', perm_type='user', role='writer')</span></pre><p id="eada" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行上面的代码后，该表将位于Google Drive的“与我共享”部分。</p><h2 id="34d4" class="lz ma it bd mk nf ng dn mo nh ni dp ms lh nj nk mu ll nl nm mw lp nn no my np bi translated">打开电子表格并上传数据</h2><p id="c98b" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">现在是时候打开工作表并向其中上传数据了。为此，我们使用<code class="fe on oo op lv b">.open</code>方法并选择<code class="fe on oo op lv b">sheet1</code>。</p><p id="9efe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们阅读任何关于熊猫的CSV文件。在这种情况下，我将使用一个CSV文件，您可以在<a class="ae mf" href="https://docs.google.com/spreadsheets/d/1NaEkBT4oER7eq3qfziH5X7-1_-Sye5k5fqMvItbykbo/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Drive </a>或我的<a class="ae mf" href="https://github.com/ifrankandrade/api.git" rel="noopener ugc nofollow" target="_blank"> Github </a>中找到，但是您可以随意使用任何您想要的CSV文件。</p><p id="4a92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们使用<code class="fe on oo op lv b">.update</code>方法将数据上传到工作表中。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="1304" class="lz ma it lv b gy mb mc l md me"><em class="mg"># Open the spreadsheet</em><br/>sheet = client.open("NewDatabase").sheet1</span><span id="25b2" class="lz ma it lv b gy oq mc l md me"><em class="mg"># read csv with pandas</em><br/>df = pd.read_csv('football_news')</span><span id="8a96" class="lz ma it lv b gy oq mc l md me"><em class="mg"># export df to a sheet</em><br/>sheet.update([df.columns.values.tolist()] + df.values.tolist())</span></pre><p id="a224" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样！现在，您的工作表应该具有与CSV文件中相同的数据。你可以在我的<a class="ae mf" href="https://github.com/ifrankandrade/api.git" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到本指南所写的所有代码。</p><h1 id="c20a" class="mj ma it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">额外收获:用Python打开任何Google工作表文件</h1><p id="0995" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">现在是时候打开任何Google工作表文件了(即使那些不是由我们的客户电子邮件创建的)。</p><p id="538a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要做到这一点，打开任何谷歌工作表文件，转到右上角，点击“分享”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/5f89fe66ce8904479b637141dcb3c63b.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*t8eACgYQ_KM_5Hkf-HdN5A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="12e9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将弹出一个新窗口。插入我们之前收到的客户电子邮件(也在我们下载的JSON文件中),然后单击“发送”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/13705203cdbaaf2dc6f3fabdd794f78d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*d77wEaDHAk1r9qT0rTmasA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7cd0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">太好了！现在我们有了权限，您可以使用我们之前编写的相同代码打开它。</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><p id="f96a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用Python学习数据科学？<a class="ae mf" href="https://frankandrade.ck.page/26b76e9130" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">通过加入我的10k+人电子邮件列表，获得我的免费Python for Data Science备忘单。</strong>T3】</a></p><p id="a5f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你用<a class="ae mf" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="pa pb gp gr pc pd"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd iu gy z fp pi fr fs pj fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr ks pd"/></div></div></a></div></div></div>    
</body>
</html>