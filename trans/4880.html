<html>
<head>
<title>A Quick Guide on How to Safely Store and Retrieve Sensitive Data When Developing Locally</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">本地开发时如何安全存储和检索敏感数据的快速指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-quick-guide-on-how-to-safely-store-and-retrieve-sensitive-data-when-developing-locally-cd766d2ea1c5#2022-10-30">https://towardsdatascience.com/a-quick-guide-on-how-to-safely-store-and-retrieve-sensitive-data-when-developing-locally-cd766d2ea1c5#2022-10-30</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="2eb3" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">永远不要在代码中放入用户名、密码或API密钥/秘密。利用环境变量保护您的数据安全。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/c3fffbfa549aa1af58ab7e667e5a30ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FEgHz3yj1EYLPPQ9"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@moneyphotos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> regularguy.eth </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5eb0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">注意:</strong> <em class="lw">本文建议在本地开发时，使用一种安全的方法来存储和检索环境变量中的敏感数据。在公司环境中工作时，请遵循公司推荐的最佳实践。</em></p><p id="3e2d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您曾经使用过任何API(比如Twitter)或者试图连接到任何远程数据源，您可能会遇到需要传递敏感参数的情况，比如<strong class="lc iv"> API密钥/秘密</strong>、<strong class="lc iv">用户名</strong>和<strong class="lc iv">密码</strong>。你用GitHub展示你的作品吗？如果您这样做了，并且您已经在笔记本或代码中以纯文本的形式输入了这些值，那么您肯定会收到电子邮件警告，您的敏感信息是公开的！</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="9ace" class="mc md iu ly b be me mf l mg mh">twitter_api_key = 'frBtFyG7JefJcY76nTlyOuT2iAUg457ndbhKpj9vERw'</span></pre><p id="0fc9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">好消息是，你可以养成一个简单的习惯，让你的钥匙、秘密和敏感信息只属于你一个人。我们将利用<strong class="lc iv">环境变量、</strong>和一个名为<code class="fe mi mj mk ly b">os</code>的简单Python库，它将允许我们从本地机器中检索这些值。</p><h1 id="a2b0" class="ml md iu bd mm mn mo mp mq mr ms mt mu ka mv kb mw kd mx ke my kg mz kh na nb bi translated">什么是环境变量？</h1><p id="2998" class="pw-post-body-paragraph la lb iu lc b ld nc jv lf lg nd jy li lj ne ll lm ln nf lp lq lr ng lt lu lv in bi translated"><strong class="lc iv">环境变量</strong>存储在您机器本地的用户配置文件中。当执行代码时，它们可以在python中动态地准备好，并使敏感数据远离人类可读的代码。</p><h1 id="88af" class="ml md iu bd mm mn mo mp mq mr ms mt mu ka mv kb mw kd mx ke my kg mz kh na nb bi translated">添加环境变量</h1><p id="7af4" class="pw-post-body-paragraph la lb iu lc b ld nc jv lf lg nd jy li lj ne ll lm ln nf lp lq lr ng lt lu lv in bi translated">让我们从添加环境变量开始。<strong class="lc iv">。zshrc </strong>是一个配置文件，包含运行zsh shell的命令，就像<strong class="lc iv">一样。包含bash shell命令的bashrc </strong>文件。您可以运行下面的命令来查看您的<strong class="lc iv">。zshrc </strong>文件。请注意，这是一个隐藏文件，所以您必须将<code class="fe mi mj mk ly b">-a</code>参数添加到<code class="fe mi mj mk ly b">ls</code>命令中。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="c6b9" class="mc md iu ly b be me mf l mg mh">ls -a</span></pre><h1 id="5464" class="ml md iu bd mm mn mo mp mq mr ms mt mu ka mv kb mw kd mx ke my kg mz kh na nb bi translated">是时候简单介绍一下VIM了</h1><p id="0e97" class="pw-post-body-paragraph la lb iu lc b ld nc jv lf lg nd jy li lj ne ll lm ln nf lp lq lr ng lt lu lv in bi translated">现在我们将进入一个小小的<strong class="lc iv"> VIM </strong>。VIM是一个开源的基于屏幕的文本编辑器，内置于MacOS中。如果你从未接触过VIM，要习惯它可能有点复杂，但它非常强大。如果你不熟悉VIM，我建议你看看这个<a class="ae kz" href="https://www.openvim.com/" rel="noopener ugc nofollow" target="_blank"> VIM教程</a>。我将运行您将环境变量添加到<strong class="lc iv">所需的基本命令。zshrc </strong>文件。先来打开我们的<strong class="lc iv">。VIM中的zshrc </strong>文件。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="9a90" class="mc md iu ly b be me mf l mg mh">vim .zshrc</span></pre><p id="6d1e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你的<strong class="lc iv">。zshrc </strong>文件将会打开，并根据写入的其他解决方案进行不同的设置。在我已经安装了Anaconda的地方，它可能看起来像这样。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="4ada" class="mc md iu ly b be me mf l mg mh"># If you come from bash you might have to change your $PATH.<br/># export PATH=$HOME/bin:/usr/local/bin:$PATH<br/><br/># &gt;&gt;&gt; conda initialize &gt;&gt;&gt;<br/># !! Contents within this block are managed by 'conda init' !!<br/>__conda_setup="$('/Users/brianroepke/miniforge3/bin/conda' 'shell.zsh' 'hook' 2&gt; /dev/null)"<br/>if [ $? -eq 0 ]; then<br/>    eval "$__conda_setup"<br/>else<br/>    if [ -f "/Users/brianroepke/miniforge3/etc/profile.d/conda.sh" ]; then<br/>        . "/Users/brianroepke/miniforge3/etc/profile.d/conda.sh"<br/>    else<br/>        export PATH="/Users/brianroepke/miniforge3/bin:$PATH"<br/>    fi<br/>fi<br/>unset __conda_setup<br/># &lt;&lt;&lt; conda initialize &lt;&lt;&lt;</span></pre><p id="ff68" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">接下来，我们可以四处导航。VIM中有两种模式。编辑器将在<strong class="lc iv">正常</strong>模式下打开，在这里您可以浏览文件。您的触控板/鼠标应该可以使用箭头键。滚动到文件底部，按下<code class="fe mi mj mk ly b">i</code>进入<strong class="lc iv">插入</strong>模式。现在您可以添加您的环境变量。我将在下面补充几个例子。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="21c5" class="mc md iu ly b be me mf l mg mh">export USER="test_user"<br/>export PW="some_very_hard_to_crack_password"<br/>export HOST="foo.bar.net"</span></pre><p id="a889" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">按下<code class="fe mi mj mk ly b">esc</code>退出<strong class="lc iv">插入</strong>模式。现在，您可以在文件中导航。按下<code class="fe mi mj mk ly b">:</code>进入<strong class="lc iv">命令</strong>模式。键入<code class="fe mi mj mk ly b">wq</code>并按下<code class="fe mi mj mk ly b">enter</code>保存并退出。</p><p id="f07c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当你加到<strong class="lc iv">的时候。zshrc </strong>文件或进行更改，需要重新加载文件才能使更改生效。在zsh shell中运行以下命令来重新加载配置文件并使您的更改生效。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="6606" class="mc md iu ly b be me mf l mg mh">source ~/.zshrc</span></pre><p id="de4c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">注:</strong>我有时发现，即使我这样做了，我也需要重启我的计算机，让python能够用<code class="fe mi mj mk ly b">os.environ</code>命令读取它们。</p><p id="0054" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用以下命令检查新的<strong class="lc iv">环境变量</strong>:</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="656d" class="mc md iu ly b be me mf l mg mh">export</span></pre><p id="5e2f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">每当您需要在项目中使用一组新的敏感信息时，请重复此过程。对我来说很有效的一件事是使用描述性的名称，比如<code class="fe mi mj mk ly b">TWITTER_API_KEY</code>或<code class="fe mi mj mk ly b">TWITTER_API_SECRET</code>。这样，你就可以很容易地记住它们的用途，并把它们添加到你的<strong class="lc iv">中。zshrc </strong>文件。</p><h1 id="0c07" class="ml md iu bd mm mn mo mp mq mr ms mt mu ka mv kb mw kd mx ke my kg mz kh na nb bi translated">在Python中使用环境变量</h1><p id="2a5a" class="pw-post-body-paragraph la lb iu lc b ld nc jv lf lg nd jy li lj ne ll lm ln nf lp lq lr ng lt lu lv in bi translated">剩下的就简单了！现在我们可以在<strong class="lc iv"> Python </strong>中使用我们的环境变量了。让我们从导入<code class="fe mi mj mk ly b">os</code>库开始。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="568f" class="mc md iu ly b be me mf l mg mh">import os</span></pre><p id="7bfb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后，我们使用<code class="fe mi mj mk ly b">os.environ</code>命令获取环境变量的值，并将它们存储在内存中。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="e908" class="mc md iu ly b be me mf l mg mh">USER = os.environ.get("USER")<br/>PW = os.environ.get("PASS")<br/>HOST = os.environ.get("HOST")</span></pre><p id="c7db" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">像任何其他变量一样，您可以将它们传递给函数、连接字符串或任何您喜欢的东西。下面是一个在连接字符串中使用它们的例子。</p><pre class="kk kl km kn gu lx ly lz bn ma mb bi"><span id="9c7c" class="mc md iu ly b be me mf l mg mh">uri = f"mongodb+srv://{USER}:{PW}@{HOST}"<br/>client = MongoClient(uri)</span></pre><p id="9571" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">查看我的文章<a class="ae kz" rel="noopener" target="_blank" href="/quick-start-from-mongodb-to-pandas-3f777dcbfb6e">关于用Python从MongoDB中提取数据的</a>,了解更多关于使用这个连接字符串的细节。</p><h1 id="c913" class="ml md iu bd mm mn mo mp mq mr ms mt mu ka mv kb mw kd mx ke my kg mz kh na nb bi translated">结论</h1><p id="c031" class="pw-post-body-paragraph la lb iu lc b ld nc jv lf lg nd jy li lj ne ll lm ln nf lp lq lr ng lt lu lv in bi translated">了解如何正确存储和检索敏感数据对于任何数据科学家和分析师都至关重要。这是一个非常简单的习惯，可以确保你不会将敏感信息暴露给外界，或者在你的第一个职业角色中看起来很傻！我们从向<strong class="lc iv">添加环境变量开始。zshrc </strong>文件。然后我们使用<code class="fe mi mj mk ly b">os</code>库在Python中检索它们。现在你已经准备好了！</p><p id="3e77" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，考虑注册成为一名媒体成员。一个月5美元，无限量访问数千篇文章。如果你使用 <a class="ae kz" href="https://medium.com/@broepke/membership" rel="noopener"> <em class="lw">我的链接</em> </a> <em class="lw">注册，我将免费获得一小笔佣金。</em></p></div></div>    
</body>
</html>