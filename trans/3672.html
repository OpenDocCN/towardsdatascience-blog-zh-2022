<html>
<head>
<title>Python Data Engineer Interview Questions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python数据工程师面试问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-data-engineer-interview-questions-18a218c0bce1#2022-08-16">https://towardsdatascience.com/python-data-engineer-interview-questions-18a218c0bce1#2022-08-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5e9d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">顶级公司为所有初露头角的数据工程师提供的关于Python概念和问题的全面指南，帮助他们准备下一次面试。</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/f6b7d3f4faf47e947493a3ca21d955fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjqQHQ1NmdjU_g5paHSZ-A.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://www.canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图片</p></figure><p id="824f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">今天我们将讨论数据工程面试中的Python面试问题。本文将涵盖Python中解决数据工程面试所需的概念和技能。作为一名数据工程师，你需要精通SQL和Python。本博客将只涉及Python，但如果你有兴趣了解SQL，那么有一篇综合文章“<a class="ae kw" href="https://www.stratascratch.com/blog/data-engineer-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> <em class="lt">数据工程师面试问题</em> </a>”。</p><p id="bff7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据对各种编程语言教程在谷歌上搜索频率的分析，Python在PYPL编程语言流行指数中排名第一。对于数据工程和数据科学来说，Python是许多其他语言中的佼佼者。</p><p id="d5ab" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据工程师通常处理各种数据格式，Python使得处理这些格式变得更加容易。此外，数据工程师需要使用API从不同的来源检索数据。通常数据是JSON格式的，Python也使得使用JSON更加容易。数据工程师不仅从不同的来源提取数据，还负责处理数据。最著名的数据引擎之一是Apache spark，如果你懂Python，你可以很好地使用Apache Spark，因为他们为它提供了一个API。Python在最近一段时间成为了一个数据工程师的必备技能！现在让我们看看怎样才能成为一名优秀的数据工程师。</p><h1 id="7486" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">怎样才能成为一名优秀的数据工程师</h1><p id="3a2c" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">数据工程是一个广泛的学科，有许多不同的角色和职责。数据工程活动的最终目的是为业务提供一致的数据流，使组织能够进行数据驱动的决策，并帮助数据科学家/分析师进行机器学习。</p><p id="753b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这种数据流可以通过许多不同的方式完成，其中一种方式是使用Python。</p><p id="2ec4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一名优秀的数据工程师应该能够:</p><ul class=""><li id="cea7" class="mr ms iq kz b la lb ld le lg mt lk mu lo mv ls mw mx my mz bi translated">建立和维护数据库系统</li><li id="f917" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">精通SQL和Python</li><li id="7419" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">构建数据流管道</li><li id="1b01" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">了解云架构和系统设计概念</li><li id="4888" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">了解数据库建模</li></ul><p id="1be2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">除了技术技能之外，一名优秀的数据工程师还应具备出色的沟通技巧。当你向公司里的非技术人员解释这些概念时，这些技能是特别需要的。现在你知道了什么是一个好的数据工程师，让我们看看数据工程师是如何使用Python的。</p><h1 id="f7f5" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">面向数据工程师的Python</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/1ae598b43edf7efb673d7d14ecae4042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gPY9BcpxO_1ErJ6A"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://www.canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="dcb9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，您已经对优秀数据工程师的素质有了一个大致的了解，让我们看看数据工程师是如何使用Python的，以及它的重要性。对于数据工程师来说，Python最重要的用途是构建数据和分析管道。这些管道从多个来源获取数据，将其转换为可用的格式，然后放入数据湖或数据仓库，以便数据分析师和数据科学家可以使用这些数据。</p><ul class=""><li id="80cb" class="mr ms iq kz b la lb ld le lg mt lk mu lo mv ls mw mx my mz bi translated">出于许多原因，Python是数据工程师中流行的语言，因为它易于使用和实用。它是世界上三大主流编程语言之一。事实上，根据2020年11月TIOBE社区的数据，它是第二大最常用的编程语言。</li><li id="6890" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">Python在机器学习和人工智能中应用广泛。当生产中需要机器学习模型时，数据科学家和数据工程师密切合作。因此，在数据工程师和数据科学家之间有一个共同的语言是一个优点。</li><li id="1e30" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">Python是一种通用语言，它提供了许多用于访问数据库和存储技术的库。这是一种非常流行的运行ETL作业的语言。</li><li id="c22a" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated">Python在各种应用程序和技术中使用，其中一个应用是在Apache Spark等数据引擎中的使用。Spark有一个API，数据工程师可以通过它运行Python代码。</li></ul><p id="9f81" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">因此，Python因其多才多艺的特性而在所有数据工程师中变得非常流行。</p><p id="b192" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在是时候开始Python实践了。StrataScratch上还有另一篇文章，关注数据科学家的<a class="ae kw" href="https://www.stratascratch.com/blog/top-30-python-interview-questions-and-answers/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> Python面试问题</a>。那篇文章有一个全面的Python问题列表，集中在一个数据科学访谈上。</p><h1 id="2dc6" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试练习题</h1><h1 id="34cc" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试问题#1:工资最高的员工</h1><p id="7725" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/10353-workers-with-the-highest-salaries?code_type=2&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10353-工资最高的工人</a></p><h2 id="7c7d" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">问题:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nr"><img src="../Images/b86f016c206800a428ebbd17f1a43cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6mr4b_Nd0VJh05xc"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10353-workers-with-the-highest-salaries?code_type=2&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="a505" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题要求您找出工资最高的员工头衔。在这个问题中，有两个表。</p><p id="d6f8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">工作人员:</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ns"><img src="../Images/1a4f230c38bcf153bad10853601845f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EnCd2oKLHtrCe_zq"/></div></div></figure><p id="1b59" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">标题:</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nt"><img src="../Images/9d7371f56ed30e1487e9c27172120e44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7inCkKFtJOBxJDRI"/></div></div></figure><h2 id="47ac" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">方法:</h2><p id="cd57" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">有两张桌子；工人和职称，它们都可以通过工人标识和工人引用标识连接。为了连接pandas中的表，让我们使列名保持一致。让我们使用“重命名”功能将标题表中的名称从worker_ref_id更改为worker_id。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="3975" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd<br/><em class="lt"># Change the columm name </em><br/>title_worker_id = title.rename(columns = {'worker_ref_id':'worker_id'})</span></pre><p id="c2a4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">使用pandas的“合并”功能，将工人ID上的两个表连接起来，以在同一个数据框中获得ID和职称。将连接结果保存到不同的数据框中。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="4649" class="nf lv iq nv b gy nz oa l ob oc">merge_df = pd.merge(worker, title_worker_id, on = 'worker_id')</span></pre><p id="5d36" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">查看最高工资:</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="39d1" class="nf lv iq nv b gy nz oa l ob oc">merged_df['salary'].max()</span></pre><p id="c91b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">勾选与最高薪资相对应的行:</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="bc6e" class="nf lv iq nv b gy nz oa l ob oc">rows_with_max_salary = merged_df[merged_df['salary'] == merged_df['salary'].max()]</span></pre><p id="377b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这些问题仅询问员工职称，因此，我们将从上述数据框中仅选择员工职称。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="d0e2" class="nf lv iq nv b gy nz oa l ob oc">result = rows_with_max_salary['worker_title']</span></pre><h2 id="5ce9" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">最终代码:</h2><p id="cd70" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">下面是这个python数据工程师面试问题的最终代码。请注意，您应该在顶部导入所有相关/必要的库。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="39ce" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd<br/><em class="lt"># Change the columm name </em><br/>title_worker_id = title.rename(columns = {'worker_ref_id':'worker_id'})</span><span id="3ac1" class="nf lv iq nv b gy od oa l ob oc">merged_df = pd.merge(worker, title_worker_id, on = 'worker_id')</span><span id="5d99" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Get Max Salary</em></span><span id="21d6" class="nf lv iq nv b gy od oa l ob oc">rows_with_max_salary = merged_df[merged_df['salary'] == merged_df['salary'].max()]</span><span id="b82c" class="nf lv iq nv b gy od oa l ob oc">result = rows_with_max_salary['worker_title']</span></pre><h2 id="e964" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">代码输出:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/7a5ea374b54d41a15aa431d13b4c9608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*nrryU--2Jv6i7d4t"/></div></figure><h1 id="3dc8" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试问题#2:活动等级</h1><p id="e763" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/10351-activity-rank?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10351-activity-rank</a></p><h2 id="83a5" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">问题:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi of"><img src="../Images/670c4f3056cb7d2c4106ef48a9365a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/0*w7w_RmHNdxgGGwV4"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10351-activity-rank?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="04c2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个python数据工程师面试问题有一个包含4个字段的表。</p><p id="ea50" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> google_gmail_emails </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi og"><img src="../Images/4e6e27560da0b680e53f87719e6fa54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YvAclcO2EdfVxMdT"/></div></div></figure><p id="0211" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们需要找到每个用户的电子邮件活动，然后根据他们的电子邮件活动按降序排列所有用户。如果有用户有相同的电子邮件活动，那么按字母顺序排列这些用户。</p><h2 id="535d" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">方法</h2><p id="ab48" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">第一步是计算每个用户的电子邮件活动。我们将使用pandas的“分组”功能对用户进行分组，然后统计该用户发送的电子邮件数量。结果将是一个序列，因此我们需要使用“to_frame”函数将其转换为数据帧，然后重置索引。</p><p id="031b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">之后，根据发送的电子邮件总数按降序对数据进行排序，如果任何两个用户发送了相同的电子邮件，则按“发件人用户”按升序排序。为了在代码中包含这一点，我们将使用sort_values，它将在第一个参数中接受两个变量，在函数的“升序”参数中接受“真/假”值。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="aa82" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd<br/><em class="lt"># Start writing code</em><br/>df = google_gmail_emails<br/>df1 = df.groupby('from_user').id.count().to_frame('total_emails').reset_index().sort_values(['total_emails','from_user'],ascending=[False,True])</span></pre><p id="52f2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦我们根据电子邮件活动和用户对数据进行了分类，就该对数据进行排序了。这类似于在SQL中使用RANK() OVER()函数。Pandas有一个名为“rank()”的函数，它接受多个参数。</p><p id="7739" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于rank()函数，第一个参数是一个等于“first”的方法。rank()函数提供了多种方法，您可以在这里查看详细内容<a class="ae kw" href="https://www.w3resource.com/pandas/dataframe/dataframe-rank.php" rel="noopener ugc nofollow" target="_blank"/>。“First”方法的等级是按照它们在数组中出现的顺序来分配的，这符合我们的需要。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="0d78" class="nf lv iq nv b gy nz oa l ob oc">df1['rank'] = df1['total_emails'].rank(method='first',ascending = False)</span></pre><p id="3ea7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">因此，我们根据发送的电子邮件总数对每个用户进行排名。如果发送的电子邮件数量相等，我们将根据from_user字段按字母顺序排序。</p><h2 id="8992" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">最终代码:</h2><p id="ce40" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">为了更好的可读性，不要忘记在代码中包含注释。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="0a7e" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd<br/><em class="lt"># Start writing code</em><br/>df = google_gmail_emails</span><span id="bc45" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Group by from_user</em><br/><em class="lt"># Count IDs</em><br/><em class="lt"># Convert to Data Frame using to_frame</em><br/><em class="lt"># Sort data using sort_values()</em><br/>df1 = df.groupby('from_user').id.count().to_frame('total_emails').reset_index().sort_values(['total_emails','from_user'],ascending=[False,True])</span><span id="22dc" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Rank() the data</em><br/>df1['rank'] = df1['total_emails'].rank(method='first',ascending = False)<br/>df1<!-- --> </span></pre><h2 id="02c8" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">代码输出:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/8bc02e85150ecd106b3e74c3cc355fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*Y4hcCPqyciyknCgA"/></div></figure><h1 id="ab5b" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试问题3:已完成的任务</h1><p id="8c0d" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/2096-completed-tasks?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/2096-已完成-任务</a></p><h2 id="2cee" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">问题:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f4b3b564d35eb9de960202a22b7b297c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/0*l1U28fzlfGzWf4jk"/></div></figure><p id="f970" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题有两个表格。</p><p id="6ae5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> Asana_Users </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e1fd8922537d075ed1791c3b487d0628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/0*H0hl_y-whraA-w9q"/></div></figure><p id="2c75" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该表包含用户id和用户信息，如姓名和公司。</p><p id="75c7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">体式_动作</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9f174d555d50d0d0c70c0f6f74f3af88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/0*zDyE7vAtTTVCryfy"/></div></figure><p id="7a6c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这看起来像一个事件表，其中每一行代表特定用户的一个操作、用户的操作数和操作名称。</p><h2 id="8836" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">方法:</h2><p id="e6a6" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">有两张桌子；asana_users和asana_tables。所以第一步是连接user_id上的两个表。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="63a6" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd</span><span id="d91b" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Start writing code</em><br/>asana_actions.head()</span><span id="7c4a" class="nf lv iq nv b gy od oa l ob oc">df = asana_users.merge(asana_actions, left_on = 'user_id', right_on = 'user_id', how = 'left')</span></pre><p id="85ac" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们只需要关注ClassPass公司。因此，只为ClassPass过滤该数据帧。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="abae" class="nf lv iq nv b gy nz oa l ob oc">df = df[df['company'] == 'ClassPass']</span></pre><p id="f169" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们只需要关注2022年1月，因此过滤数据框架。我们可以在pandas 'to_period '中使用一个函数。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="2b46" class="nf lv iq nv b gy nz oa l ob oc">df = df[df['date'].dt.to_period('m') =="2022-01"]</span></pre><p id="9dbf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦我们过滤了ClassPass和一月份，就该计算每个用户的动作数量了。你可以使用熊猫的groupby函数。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="b923" class="nf lv iq nv b gy nz oa l ob oc">df = df.groupby(['user_id','action_name'])['num_actions'].sum().unstack().fillna(0).reset_index()</span></pre><p id="7ef3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，我们只需要选择两列；user_id和CompleteTask。就这么办吧！</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="bee9" class="nf lv iq nv b gy nz oa l ob oc">df = df[['user_id','CompleteTask']]</span></pre><h2 id="59e4" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">最终代码:</h2><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="8301" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd<br/><em class="lt"># Start writing code</em><br/>asana_actions.head()<br/>df = asana_users.merge(asana_actions, left_on = 'user_id', right_on = 'user_id', how = 'left')<br/>df = df[df['company'] == 'ClassPass']<br/>df = df[df['date'].dt.to_period('m') =="2022-01"]<br/>df = df.groupby(['user_id','action_name'])['num_actions'].sum().unstack().fillna(0).reset_index()<br/>df = df[['user_id','CompleteTask']]<br/>df</span></pre><h2 id="7374" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">代码输出:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/3e65e2db1ebdcc83cc64111d509bf3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/0*OIk5fnInFdfEaHPL"/></div></figure><h1 id="a9fd" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试问题#4:每个邮政编码的街道数量</h1><p id="89ce" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/10182-number-of-streets-per-zip-code?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10182-number-of-streets-per-zip-code</a></p><h2 id="854f" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">问题:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/1cfb389b78019faf8eaaa13f1f999d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/0*Ih7aJPG42FELR4Hd"/></div></figure><p id="2c47" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个python数据工程师面试问题中，我们需要根据问题中给出的一些条件，计算每个邮政编码的街道名称的数量。例如，如果街道名称有多个单词(East Main可以算作East)，我们需要只计算名称的第一部分。</p><p id="77f3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题有助于你练习拆分和操作文本进行分析。</p><p id="7fc2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有一个表格可以解决这个问题:</p><p id="92a3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">Sf _餐厅_卫生_违规</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ol"><img src="../Images/f3a37f4d3ccb4f42b0ffb8e7a5b44c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y0nH7ZFaEo4imOzI"/></div></div></figure><h2 id="d008" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">方法:</h2><p id="de60" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">我们需要拆分公司地址以获得街道名称的第一部分。例如，“350百老汇街”街道名称可以使用拆分功能拆分成不同的元素。让我们使用列表理解(Lambda函数)来创建一个函数。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="cf52" class="nf lv iq nv b gy nz oa l ob oc">df = sf_restaurant_health_violations</span><span id="8a01" class="nf lv iq nv b gy od oa l ob oc">df['street'] = df['business_address'].apply(lambda x: x.split(' '))</span></pre><p id="b2f4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">上述代码的输出将给出一个元素列表。该字符串将被分解成多个元素，这取决于所使用的分隔符的类型。在这种情况下，我们使用“空格”作为分隔符，因此，“百老汇街350号”将被转换为列表[“350”、“百老汇”、“St”]。</p><p id="779a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题提到了不区分大小写的街道名，因此我们需要降低()或提高()所有的街道名。让我们用小写来回答这个问题。此外，列表的第一个元素应该是一个单词，所以在第一个元素是一个数字的情况下，然后我们采取下一个元素。下面是为此实现的代码。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="7891" class="nf lv iq nv b gy nz oa l ob oc">df['street'] = df['business_address'].apply(lambda x: x.split(' ')[1].lower() if str(x.split(' ')[0][0]).isdigit() == True else x.split(' ')[0].lower())</span></pre><p id="2a58" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在找出非唯一街道名称的数量。在group by函数之后，数据被转换为一个序列，因此，我们需要_frame函数将其转换回数据帧。让我们将街道的数量命名为“n_street ”,并使用sort_values函数对其进行降序排序。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="79ae" class="nf lv iq nv b gy nz oa l ob oc">result = sf_restaurant_health_violations.groupby('business_postal_code')['street'].nunique().to_frame('n_street').reset_index().sort_values(by='business_postal_code', ascending=True).sort_values(by='n_street',ascending=False)</span></pre><h2 id="b2ef" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">最终代码:</h2><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="573a" class="nf lv iq nv b gy nz oa l ob oc">import pandas as pd</span><span id="ccf7" class="nf lv iq nv b gy od oa l ob oc">df = sf_restaurant_health_violations</span><span id="c94f" class="nf lv iq nv b gy od oa l ob oc">df['street'] = df['business_address'].apply(lambda x: x.split(' ')[1].lower() <br/>                if str(x.split(' ')[0][0]).isdigit() == True else x.split(' ')[0].lower())<br/>                <br/>result = sf_restaurant_health_violations.groupby('business_postal_code')['street'].nunique().to_frame('n_street').reset_index().sort_values(by='business_postal_code', ascending=True).sort_values(by='n_street',ascending=False)</span></pre><h2 id="5495" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">代码输出:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/41cb9078df2da2477e831f71ce63566a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/0*Vf7ayIzkblq2m8Yh"/></div></figure><h1 id="a1b7" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试问题5:连续几天</h1><p id="07b4" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/2054-consecutive-days?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/2054-continuous-days</a></p><h2 id="2564" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">问题:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/40edd629b6a33772636e4cb9cd44e0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/0*QW6w2Nf3o0IqiteC"/></div></figure><p id="bd9c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题有一个表格如下。</p><p id="c1c2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> sf_events </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/73212dfc2c6f92019e525d681dfc0890.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*9sfARVjkJEJyvC96"/></div></div></figure><p id="57de" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个问题中，你需要找到所有连续三天活跃的用户。</p><h2 id="1c0b" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">方法:</h2><p id="b69d" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">首先，这是events表，没有任何惟一的标识符，比如event_id。因此，让我们使用pandas中的drop_duplicates()函数删除这个表中的重复项。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="6ade" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd<br/><em class="lt"># Start writing code</em><br/>df = sf_events.drop_duplicates()</span></pre><p id="c9ba" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个表中，我们有用户id、帐户id和日期，但是我们只需要两列作为问题；用户ID和日期。让我们只选择这两列，并使用pandas的sort_values()函数对每个用户和每个日期的数据进行升序排序。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="d823" class="nf lv iq nv b gy nz oa l ob oc">df = df[['user_id', 'date']].sort_values(['user_id', 'date'])</span></pre><p id="8ca7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在下一步中，您需要考虑一个类似于SQL中的LEAD()或LAG()的函数。有一个叫做SHIFT()的函数可以帮助我们移动日期。该函数采用一个称为<strong class="kz ir">周期</strong>的标量参数，该参数代表在所需轴上移动的次数。这个函数在处理时序数据时非常有用。让我们使用这个函数，通过添加2天来创建另一个列，因为我们需要连续3天活跃的用户。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="210f" class="nf lv iq nv b gy nz oa l ob oc">df['3_days'] = df['date'] + pd.DateOffset(days=2)<br/>df['shift_3'] = df.groupby('user_id')['date'].shift(-2)<br/><em class="lt"># Check Output</em><br/>df.head()</span></pre><p id="44a9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">上述步骤的输出:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/8f3fd4d7333508d149813020c5969733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*a9za80kmGo5JLpjv"/></div></div></figure><p id="ad04" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们有了所需格式的数据，让我们比较“3_days”和“shift_3”列，看看它们是否相等。如果它们相等，那么我们提取相应的用户ID，因为这就是问题所要问的。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="d822" class="nf lv iq nv b gy nz oa l ob oc">df[df['shift_3'] == df['3_days']]['user_id']</span></pre><h2 id="b303" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">最终代码:</h2><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="104a" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd<br/><em class="lt"># Start writing code</em><br/>df = sf_events.drop_duplicates()</span><span id="7c32" class="nf lv iq nv b gy od oa l ob oc">df = df[['user_id', 'date']].sort_values(['user_id', 'date'])</span><span id="2ecf" class="nf lv iq nv b gy od oa l ob oc">df['3_days'] = df['date'] + pd.DateOffset(days=2)<br/>df['shift_3'] = df.groupby('user_id')['date'].shift(-2)<br/>df[df['shift_3'] == df['3_days']]['user_id']</span></pre><h2 id="5567" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">代码输出:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/24b88d6de51ed8913f87ae3f5cd35dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*md4wWjKjqCTKmsnm"/></div></figure><h1 id="eaa8" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试问题#6:按床位排列主机</h1><p id="3768" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/10161-ranking-hosts-by-beds?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10161-ranking-hosts-by-beds</a></p><h2 id="e3a7" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">问题:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/9ae371cf914bbe4abea8c686818b884d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*ebG5AXAPIxZ0xI48"/></div></figure><p id="f457" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">提供了一个表格来解决这个问题。在这个问题中，我们需要根据主机列出的床位数对主机进行排名。一个主机可能有多个列表。此外，一些主机可能有相同数量的床位，因此它们的等级应该相同。请查看提供的表格中的示例输出:</p><p id="ec08" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">Airbnb _公寓</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi om"><img src="../Images/0d7a011e5afa38061fa4170fbcebffee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hD1uTC7O4y6ThmIv"/></div></div></figure><h2 id="c159" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">方法:</h2><p id="2f95" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">作为第一步，我们需要找到每个主机列出的床位总数。问题提到一个主机可能列出了多个属性，因此，我们需要使用python中的groupby()函数将每个主机的床位数相加，然后将结果转换为数据框</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="46e7" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd</span><span id="30e7" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Start writing code</em><br/>result = airbnb_apartments.groupby('host_id')['n_beds'].sum().to_frame('number_of_beds').reset_index()</span></pre><p id="1f69" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下一步是根据主机列出的床位数量对主机进行排名。我们已经有了在前面步骤中计算的主机和床位数列。让我们将rank()函数与Dense方法结合使用，因为我们需要为网站上列出的具有相同床位数的主机提供相同的排名。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="571b" class="nf lv iq nv b gy nz oa l ob oc">result['rank'] = result['number_of_beds'].rank(method = 'dense', ascending = False)</span></pre><p id="2dc0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，我们需要根据排名对数据进行升序排序。让我们使用sort_values()按照每个主机排名的升序对数据进行排序。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="cf71" class="nf lv iq nv b gy nz oa l ob oc">result = result.sort_values(by='rank')</span></pre><h2 id="1e6e" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">最终代码:</h2><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="5eae" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd</span><span id="bc81" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Start writing code</em><br/>result = airbnb_apartments.groupby('host_id')['n_beds'].sum().to_frame('number_of_beds').reset_index()</span><span id="622e" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Rank</em><br/>result['rank'] = result['number_of_beds'].rank(method = 'dense', ascending = False)<br/>result = result.sort_values(by='rank')</span></pre><h2 id="4063" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">代码输出:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/0ec157c734eb12724b70628e28841a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*8HytFClFXgjYZXBX"/></div></figure><h1 id="d735" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Python数据工程师面试问题7:昂贵的项目</h1><p id="fba6" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10301-贵-项目</a></p><h2 id="7121" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">问题:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/51741b2310e0ac9faff615f5f5dd5c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*eLA1oXGLa8VfIhFF"/></div></figure><p id="b32b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题有两个表格。第一个名为“project_title”的表包含项目的名称/标题、项目ID及其预算。</p><p id="3e75" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> ms_projects </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/a90238863850fb6c34b352c7168f2c31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*tFupsVTuchTG7C6E"/></div></figure><p id="2ca6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下一个表称为“ms_emp_project”，它将员工ID映射到每个项目ID。</p><p id="b59c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> ms_emp_projects </strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/6b968a94e73a737a15b31cd4de558a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*1TL_KZyw3LAWeCN-"/></div></figure><p id="76ba" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题要求您计算分配给每个员工的项目预算金额。</p><h2 id="629b" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">方法:</h2><p id="5417" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">问题中有两个表格，每个表格都有不同的信息。所以第一步是连接项目ID上的两个表。我们将使用merge()函数将这些表连接在一起。结果将是一个数据帧，我们将它保存到一个名为df的变量中。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="aeb2" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import Libraries</em><br/>import pandas as pd<br/><em class="lt"># Start writing code</em><br/>df= pd.merge(ms_projects, ms_emp_projects, how = 'inner',left_on = ['id'], right_on=['project_id'])</span></pre><p id="daff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下一步是统计每个项目的员工总数。因此，我们将使用groupby()函数，按照项目标题和预算对数据进行分组，并计算分配给每个项目的员工数量。我们将重置结果数据帧的索引，并将其保存在一个名为df1的新变量中。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="17bc" class="nf lv iq nv b gy nz oa l ob oc">df1=df.groupby(['title','budget'])['emp_id'].size().reset_index()</span></pre><p id="1e51" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下一步，我们将计算每个员工的预算。为此，我们将总预算除以分配给特定项目的员工人数。如问题中所述，我们将把它四舍五入到最接近的整数。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="72e5" class="nf lv iq nv b gy nz oa l ob oc">df1['budget_emp_ratio'] = (df1['budget']/df1['emp_id']).round(0)</span></pre><p id="bef0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下一步是根据分配给每个员工的预算按降序对数据进行排序。我们将使用sort_values()函数来做到这一点，以保持函数的“升序”参数为FALSE，因为我们需要降序。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="b0d3" class="nf lv iq nv b gy nz oa l ob oc">df2=df1.sort_values(by='budget_emp_ratio',ascending=False)</span></pre><p id="39a2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，问题只提到将每个雇员的职称和预算作为输出，因此，我们将使用df[[ ]]语法在pandas中只选择那些列。</p><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="c7e7" class="nf lv iq nv b gy nz oa l ob oc">result = df2[["title","budget_emp_ratio"]]</span></pre><h2 id="604b" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">最终代码:</h2><pre class="kh ki kj kk gt nu nv nw nx aw ny bi"><span id="cbf7" class="nf lv iq nv b gy nz oa l ob oc"><em class="lt"># Import your libraries</em><br/>import pandas as pd</span><span id="3924" class="nf lv iq nv b gy od oa l ob oc"><em class="lt"># Start writing code</em><br/>df= pd.merge(ms_projects, ms_emp_projects, how = 'inner',left_on = ['id'], right_on=['project_id'])</span><span id="0406" class="nf lv iq nv b gy od oa l ob oc">df1=df.groupby(['title','budget'])['emp_id'].size().reset_index()</span><span id="894a" class="nf lv iq nv b gy od oa l ob oc">df1['budget_emp_ratio'] = (df1['budget']/df1['emp_id']).round(0)</span><span id="8061" class="nf lv iq nv b gy od oa l ob oc">df2=df1.sort_values(by='budget_emp_ratio',ascending=False)</span><span id="0bd8" class="nf lv iq nv b gy od oa l ob oc">result = df2[["title","budget_emp_ratio"]]</span></pre><h2 id="973b" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">代码输出:</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/0a4953c81e7b1edf95ca74f0215ed0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*zZc4QI6yJ70xjmer"/></div></figure><p id="0018" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Python编码动手练习到此结束。我们希望你感到自信。如果你需要更多的练习，这里有一个<a class="ae kw" href="https://www.stratascratch.com/blog/top-30-python-interview-questions-and-answers/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> python面试问题</a>的综合列表，你可以参考一下。</p><h2 id="f506" class="nf lv iq bd lw ng nh dn ma ni nj dp me lg nk nl mg lk nm nn mi lo no np mk nq bi translated">结论</h2><p id="0f57" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">我们希望你对下一次数据工程面试有个好印象。在本文中，我们研究了数据工程面试的各个方面。我们探讨了如何成为一名优秀的数据工程师，需要哪些技能，并深入研究了Python及其对数据工程师的重要性，同时进行了一些实践。</p></div></div>    
</body>
</html>