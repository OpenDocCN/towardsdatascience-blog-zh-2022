<html>
<head>
<title>Using Google Cloud Machine Learning APIs programmatically in python - Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 python 编程使用 Google Cloud 机器学习 APIs 第 2 部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-google-cloud-machine-learning-apis-programmatically-in-python-part-2-8867d272edf0#2022-02-13">https://towardsdatascience.com/using-google-cloud-machine-learning-apis-programmatically-in-python-part-2-8867d272edf0#2022-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9155404b192a23da1823ceac10352ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7CQjg7KkV50vIbsd"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@mitchel3uo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米切尔罗</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="c95c" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">介绍</h1><p id="e909" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在本文的<a class="ae kc" rel="noopener" target="_blank" href="/using-google-cloud-machine-learning-apis-programmatically-in-python-part-1-430f608af6a5">前一部分(第 1 部分)</a>中，我们探讨了 Google Cloud Vision、文本到语音以及 python 中的语音到文本 API。</p><p id="e63d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在本文的这一部分，我们将探索其余的 API。</p><ol class=""><li id="08a6" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly mj mk ml mm bi translated">翻译 API</li><li id="48be" class="me mf iq ld b le mn li mo lm mp lq mq lu mr ly mj mk ml mm bi translated">视频智能 API</li><li id="6a64" class="me mf iq ld b le mn li mo lm mp lq mq lu mr ly mj mk ml mm bi translated">自然语言 API</li></ol><h2 id="2d5d" class="ms ke iq bd kf mt mu dn kj mv mw dp kn lm mx my kr lq mz na kv lu nb nc kz nd bi translated">注意</h2><p id="5de1" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="ne">在 Medium 中，Jupyter 笔记本上的小部件无法在手机这样的小屏幕上正常显示。它们只有在笔记本电脑这样的大屏幕上才能正常显示。</em></p><h1 id="ef30" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">谷歌云机器学习 API</h1><h2 id="1991" class="ms ke iq bd kf mt mu dn kj mv mw dp kn lm mx my kr lq mz na kv lu nb nc kz nd bi translated">1.翻译 API</h2><p id="2288" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">顾名思义，这个 API 主要用于文本翻译。这还有一个附加功能，可以从文本中检测语言。使用之前，在<a class="ae kc" href="https://console.cloud.google.com/marketplace/product/google/translate.googleapis.com?project=text-analysis-323506" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>中启用该 API。</p><p id="c991" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我试验过的这个 API 的特性列表:</p><ul class=""><li id="d4c8" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">翻译</strong></li></ul><p id="ca14" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这项功能可以将文本翻译成数百种语言。它也非常准确，因为该模型是由谷歌研究人员在谷歌的超大数据集上构建和训练的。此处提供了所有支持语言的列表<a class="ae kc" href="http://www.mathguide.de/info/tools/languagecode.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6297" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">下面举一个小例子来说明它有多好。在这个例子中，我使用翻译 API 将一篇法语文章翻译成英语和日语。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">翻译</p></figure><ul class=""><li id="a1e7" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">语言检测</strong></li></ul><p id="4918" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">该功能检测给定文本的语言。返回检测到的语言代码。这里有一个例子:</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">语言检测</p></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h2 id="5bd4" class="ms ke iq bd kf mt mu dn kj mv mw dp kn lm mx my kr lq mz na kv lu nb nc kz nd bi translated">2.视频智能 API</h2><p id="8063" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">视频智能 API 用于常见的视频处理问题。使用之前，在<a class="ae kc" href="https://console.cloud.google.com/marketplace/product/google/videointelligence.googleapis.com" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>中启用该 API。</p><p id="88d5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我试验过的这个 API 的特性列表:</p><ul class=""><li id="8ec7" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">镜头变化检测</strong></li></ul><p id="8d6b" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">此功能可检测视频镜头的变化。对于每一个镜头，它返回它的开始和结束时间。</p><p id="8369" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在这个实验中，我使用了奥迪的一个广告视频，是从<a class="ae kc" href="https://www.youtube.com/watch?v=uWXyAgP1sJQ&amp;ab_channel=AudiNederland" rel="noopener ugc nofollow" target="_blank"> youtube </a>上为其 e-tron 电动车拍摄的。响应太大，无法在笔记本中显示，必须转储到文本文件中。这里看一下<a class="ae kc" href="https://github.com/Subrahmanyajoshi/Google-Cloud-Machine-Learning-APIs/blob/main/cloud-video-intelligence-api/results/shot_change_detection.txt" rel="noopener ugc nofollow" target="_blank">的详细输出</a>。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">镜头变化检测</p></figure><ul class=""><li id="2ecd" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">语音转录</strong></li></ul><p id="77e1" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这项功能可以转录视频中的语音。不需要手动将视频转换为音频，然后输入语音转文本 API。</p><p id="40c4" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我再次用奥迪的广告视频作为例子。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">语音转录</p></figure><ul class=""><li id="8107" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">标签检测</strong></li></ul><p id="b745" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">此功能可检测视频中的标签。它检测在视频上能找到的一切并返回。</p><p id="e336" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我也用奥迪的广告视频来做这个实验。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">标签检测</p></figure><ul class=""><li id="2f5a" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">标志检测</strong></li></ul><p id="1779" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">检测视频中出现的所有流行标志。</p><p id="bcaf" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在这个实验中，我使用了从 Youtube<a class="ae kc" href="https://www.youtube.com/watch?v=hPcQ5lCTe2U&amp;ab_channel=JocoFlimz" rel="noopener ugc nofollow" target="_blank">上截取的百事可乐的广告视频。</a></p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">徽标检测</p></figure><ul class=""><li id="bc59" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">人物检测</strong></li></ul><p id="44a2" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">该功能检测视频中的人，并提供坐标以在检测到的人周围绘制边界框。给出每个检测到的人出现在视频中的时间范围。还给出附加的细节，如每个被检测的人穿什么样的衣服，衣服的颜色等。</p><p id="aaa3" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我再次用百事可乐的广告视频作为例子。回复太大，无法在笔记本中显示，必须转储到文本文件中。这里看一下<a class="ae kc" href="https://raw.githubusercontent.com/Subrahmanyajoshi/Google-Cloud-Machine-Learning-APIs/main/cloud-video-intelligence-api/results/people_detection.txt" rel="noopener ugc nofollow" target="_blank">详细输出</a>。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">人物检测</p></figure><ul class=""><li id="c493" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">人脸检测</strong></li></ul><p id="ccd8" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">该功能可以检测视频中的人脸。返回坐标以在每个检测到的人脸周围绘制边界框，每个检测到的人脸出现的时间范围，以及诸如此人是否戴着头带、此人是否在微笑等等。它还可以进行人脸标注。</p><p id="4186" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我也用百事可乐的广告视频来做这个实验。这里的响应也太大，必须转储到一个文本文件中。这里看一下<a class="ae kc" href="https://github.com/Subrahmanyajoshi/Google-Cloud-Machine-Learning-APIs/blob/main/cloud-video-intelligence-api/results/face_detection.txt" rel="noopener ugc nofollow" target="_blank">详细输出</a>。</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">人脸检测</p></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h2 id="0620" class="ms ke iq bd kf mt mu dn kj mv mw dp kn lm mx my kr lq mz na kv lu nb nc kz nd bi translated"><strong class="ak"> 3。自然语言 API </strong></h2><p id="6284" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">自然语言 API 用于解决一些常见的 NLP 问题。使用前在<a class="ae kc" href="https://console.cloud.google.com/marketplace/product/google/language.googleapis.com" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>中启用该 API。</p><p id="7449" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我试验过的功能列表:</p><ul class=""><li id="fba8" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">实体分析</strong></li></ul><p id="957d" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">该特性分析输入文本中的已知实体，如专有名词或普通名词。这里有一个例子:</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">实体分析</p></figure><ul class=""><li id="c6d5" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">情感分析</strong></li></ul><p id="2af0" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">该特征检测输入文本的情感。一个例子:</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">情感分析</p></figure><ul class=""><li id="255d" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">语法分析</strong></li></ul><p id="1915" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这个特性分析输入文本并返回语法细节。一个例子:</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">语法分析</p></figure><ul class=""><li id="663e" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated"><strong class="ld ir">文本分类</strong></li></ul><p id="71df" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">该特征将输入文本分类成不同的已知类别。一个例子:</p><figure class="ng nh ni nj gt jr"><div class="bz fp l di"><div class="nk nl l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">文本分类</p></figure></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h1 id="acf6" class="kd ke iq bd kf kg nt ki kj kk nu km kn ko nv kq kr ks nw ku kv kw nx ky kz la bi translated">一个示例用例</h1><p id="b270" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">多个 API 可以组合起来解决一个复杂的问题。想象一个问题，我们需要从图像中读取文本并检测这些文本的情感。下面是如何仅使用 API 来解决这个问题:</p><ul class=""><li id="77f1" class="me mf iq ld b le lz li ma lm mg lq mh lu mi ly nf mk ml mm bi translated">使用<strong class="ld ir">视觉 API </strong>的文本检测功能从图像中读取文本。</li><li id="b10e" class="me mf iq ld b le mn li mo lm mp lq mq lu mr ly nf mk ml mm bi translated">使用<strong class="ld ir">翻译 API </strong>的语言检测功能检查文本是否为英文。</li><li id="a71e" class="me mf iq ld b le mn li mo lm mp lq mq lu mr ly nf mk ml mm bi translated">如果文本不是英文，使用<strong class="ld ir">翻译 API </strong>的翻译功能进行翻译。</li><li id="d519" class="me mf iq ld b le mn li mo lm mp lq mq lu mr ly nf mk ml mm bi translated">然后使用<strong class="ld ir">自然语言 API </strong>的情感分析功能获取翻译文本的情感。</li></ul><p id="60e5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">我们通过结合使用三种不同的 API 解决了这个问题。此外，请注意，为这个问题构建一个定制的机器学习系统将过于复杂。</p><h1 id="e555" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">尾注</h1><p id="2fa7" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这些 API 最好的一点是，我们让谷歌来处理一切。从构建和训练准确的模型到管理和扩展部署基础设施。我们唯一担心的两件事是发送请求和处理响应。</p><p id="6dc5" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">在上面的大部分实验中，我只用了一个例子。也可以在一个请求中发送一批示例，API 将在一个响应中返回每个示例的结果。</p><p id="858e" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">Python 客户端并不是访问这些 API 的唯一方式。这些也可以通过 curl 命令来访问。JSON 文件需要以特定的格式创建，包含示例的路径以及关于使用什么 API 特性/方法的规范。然后可以使用 curl 命令将其发送到 API 端点，响应将显示在命令行上。</p><p id="bae6" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这总结了我已经试验过的机器学习 API 及其特性的列表。正如我们在本文中看到的，大多数常见的机器学习问题都可以使用这些 API 本身来解决。</p><p id="e62f" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">许多行业已经在使用这些 API 来自动化各种手工任务。关于他们的信息可以在 Google Cloud 的官网上找到。</p></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><p id="9332" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">谢谢</p></div></div>    
</body>
</html>