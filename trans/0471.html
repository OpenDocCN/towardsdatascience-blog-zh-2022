<html>
<head>
<title>Build your first Neural Network with Flux.jl in Julia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Julia中用Flux.jl构建你的第一个神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-your-first-neural-network-with-flux-jl-in-julia-10ebdfcf2fa3#2022-02-18">https://towardsdatascience.com/build-your-first-neural-network-with-flux-jl-in-julia-10ebdfcf2fa3#2022-02-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="098f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">没有任何外部数据的初学者教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1da198b53ac346d6ce22a39fcde3270d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wBBqiySx9gFjTq6MvIvosQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时代是你不应该预测的——胡尔基·奥莰·塔巴克在Unsplash上拍摄的照片</p></figure><p id="ce2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习的第一条规则应该是<strong class="lb iu">你不要用机器学习</strong>。我的意思是，如果你有一个新项目，试着<strong class="lb iu">不用机器学习</strong>来解决。ML很贵，很难监控、维护和运行，更不用说数据科学家可能很贵。如果你真的不能用启发式规则解决问题，那么你可以去ML。</p><p id="685d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程将把上面的陈述颠倒过来。我们将使用神经网络从给定的日期时间中预测Unix纪元。这是为了练习，没别的。求求你，求求你不要为了学习之外的任何事情而这样做！🙏</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="07b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="mc">这一整篇教程作为冥王星笔记本提供:</em> </strong></p><div class="md me gp gr mf mg"><a href="https://github.com/niczky12/medium/blob/master/julia/epoch_pluto.jl" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">medium/epoch _ Pluto . JL at master niczky 12/medium</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">中篇文章代码https://medium.com/@niczky12-medium/epoch _ Pluto . JL at master niczky 12/medium</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">github.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu ks mg"/></div></div></a></div><p id="f9ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="mc">不知道冥王星是什么？请看这篇</em> </strong> <a class="ae ky" rel="noopener" target="_blank" href="/jupyter-notebooks-can-be-a-pain-but-i-️-pluto-f47913c5c16d"> <strong class="lb iu"> <em class="mc">文章</em> </strong> </a> <strong class="lb iu"> <em class="mc">。</em> </strong></p><blockquote class="mv"><p id="292a" class="mw mx it bd my mz na nb nc nd ne lu dk translated">要获得所有媒体文章的完整信息——包括我的——请点击这里订阅<a class="ae ky" href="https://niczky12.medium.com/membership" rel="noopener"/>。</p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="151d" class="nf ng it bd nh ni nj nk nl nm nn no np jz nq ka nr kc ns kd nt kf nu kg nv nw bi translated">你说纪元？</h1><p id="d12d" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">澄清一下，一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Unix_time" rel="noopener ugc nofollow" target="_blank">纪元时间是从1970年1月1日午夜起经过的<strong class="lb iu">秒</strong> </a>。我们可以通过调用<code class="fe oc od oe of b">datetime2unix</code>函数从Julia的DateTime中获得一个epoch(或unix)时间:</p><pre class="kj kk kl km gt og of oh oi aw oj bi"><span id="b73f" class="ok ng it of b gy ol om l on oo"><strong class="of iu">julia&gt; </strong>using Dates</span><span id="67ce" class="ok ng it of b gy op om l on oo"><strong class="of iu">julia&gt; </strong>dt = DateTime("2021-09-01T12:45:00")</span><span id="850a" class="ok ng it of b gy op om l on oo">2021-09-01T12:45:00</span><span id="763b" class="ok ng it of b gy op om l on oo"><strong class="of iu">julia&gt; </strong>datetime2unix(dt)</span><span id="ae84" class="ok ng it of b gy op om l on oo">1.6305003e9</span></pre><p id="f27e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的目标是获取一个日期时间，并预测它在Unix纪元中的值。系好安全带，我们有工作要做！</p><h1 id="c7bf" class="nf ng it bd nh ni oq nk nl nm or no np jz os ka nr kc ot kd nt kf ou kg nv nw bi translated">那可是好多秒啊！</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/fff3e875438ece1edac7b97a17320d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vEwk3TfwNmSlKjiYkNkZWA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我打赌今天的日期和这张图上的沙子一样多，证明我错了！—<a class="ae ky" href="https://unsplash.com/@jimgade?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">吉姆·盖德</a>在<a class="ae ky" href="https://unsplash.com/s/photos/sand?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5886" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个教程——而且很傻——所以我会设定一些界限。假设我们的<strong class="lb iu">训练输入在2010年到2020年之间</strong>，我们只对预测到2030年的值感兴趣:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="d878" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道了y的变化范围，我们可以取几个样本并创建我们的数据。注意，我们不需要从任何地方下载任何东西，我发现很多ML教程都要求你下载数据或者在不同格式之间转换。这可能会很困难，困难是不好的，所以我们将避免所有的麻烦，并制作我们自己的数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="db09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们正在建立一个神经网络，标准化我们的输入是必须的。但是由于我们的输出是如此之大——在1，000，000，000的规模上——我们也将需要<strong class="lb iu">标准化我们的输出</strong>。这样，我们可以避免等待神经网络达到它需要的巨大权重。</p><p id="7e67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是一些将x和y归一化的辅助函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="67b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用小批量来加速训练。IterTools的<code class="fe oc od oe of b">partition</code>函数使这变得简单:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow ox l"/></div></figure><blockquote class="oy oz pa"><p id="e64c" class="kz la mc lb b lc ld ju le lf lg jx lh pb lj lk ll pc ln lo lp pd lr ls lt lu im bi translated">如果你觉得以上令人困惑，看看我在Julia 发表的关于广播的<a class="ae ky" rel="noopener" target="_blank" href="/vectorize-everything-with-julia-ad04a1696944">文章。</a></p></blockquote><h1 id="242a" class="nf ng it bd nh ni oq nk nl nm or no np jz os ka nr kc ot kd nt kf ou kg nv nw bi translated">建立一个网络，训练一个网络</h1><p id="38a4" class="pw-post-body-paragraph kz la it lb b lc nx ju le lf ny jx lh li nz lk ll lm oa lo lp lq ob ls lt lu im bi translated">为了容易开始，我们将只使用一个单层和<code class="fe oc od oe of b">identity</code>作为我们的激活函数。非常欢迎您下载<a class="ae ky" href="https://github.com/niczky12/medium/blob/master/julia/epoch_pluto.jl" rel="noopener ugc nofollow" target="_blank">源文件</a>并在Pluto中使用它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="7866" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面有3个组件:</p><ul class=""><li id="e9fb" class="pe pf it lb b lc ld lf lg li pg lm ph lq pi lu pj pk pl pm bi translated"><strong class="lb iu">模型</strong>:这是我们的NN架构。</li><li id="84ef" class="pe pf it lb b lc pn lf po li pp lm pq lq pr lu pj pk pl pm bi translated"><strong class="lb iu">损失</strong>:这告诉Flux我们的损失函数是什么。上面我用的是Flux内置的均方误差。</li><li id="c831" class="pe pf it lb b lc pn lf po li pp lm pq lq pr lu pj pk pl pm bi translated"><strong class="lb iu">优化器</strong>:告诉Flux如何更新权重的函数。</li></ul><p id="3acb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了训练我们的网络，我们将这些数据连同输入和输出数据对一起传入<code class="fe oc od oe of b">Flux.train!</code>，并对我们的数据进行几次迭代。令人困惑的是，每次迭代也被称为一个纪元😃。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow ox l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/727603034d1f2577dfa858f98c39d511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*LSGnaFhPj0Zfyv9poJNhGw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">随着时间的推移，我们的训练损失——作者制作的图表</p></figure><p id="43ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了预测值，我们需要将预测值重新调整到各个时期:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="a9ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还用2020年至2030年间的例子创建了一个测试集，以下是预测样本:</p><pre class="kj kk kl km gt og of oh oi aw oj bi"><span id="811b" class="ok ng it of b gy ol om l on oo">Input -&gt; Predicted epochs as datetime | difference<br/>2030-02-13T03:33:28 -&gt; 2030-02-11T17:01:22.811 | -35 hours<br/>2021-02-18T12:15:50 -&gt; 2021-02-16T17:24:46.530 | -43 hours<br/>2022-06-26T02:55:35 -&gt; 2022-06-26T08:19:32.420 | 5 hours<br/>2023-11-16T05:54:15 -&gt; 2023-11-16T01:11:17.980 | -5 hours<br/>2030-06-24T05:38:26 -&gt; 2030-06-24T13:47:39.302 | 8 hours<br/>2026-04-19T21:39:56 -&gt; 2026-04-20T07:08:37.777 | 9 hours<br/>2028-01-16T20:26:00 -&gt; 2028-01-16T12:52:12.389 | -8 hours<br/>2029-12-21T02:00:31 -&gt; 2029-12-20T21:20:49.342 | -5 hours<br/>2027-03-05T14:17:19 -&gt; 2027-03-06T21:43:38.841 | 31 hours<br/>2026-07-01T05:54:13 -&gt; 2026-07-02T01:32:57.773 | 20 hours</span></pre><p id="7624" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，我们的预测并不完美，还有改进的空间，但我们的<strong class="lb iu"> NN正在收敛并产生合理的结果</strong>。当你预测10年后的未来时，20个小时的时差对于时代来说并不算太差。</p><h1 id="cd8b" class="nf ng it bd nh ni oq nk nl nm or no np jz os ka nr kc ot kd nt kf ou kg nv nw bi translated">现在轮到你了</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/b7b9e01a1163b641b172614cbf0a702b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yWtleAKh-jYxBQnmMrhFcg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">去把他们都按下来！—<a class="ae ky" href="https://unsplash.com/@tengyart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">腾雅特</a>在<a class="ae ky" href="https://unsplash.com/s/photos/buttons?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="9bc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你读这篇文章的时候和我写作的时候一样开心。这仅仅是开始。<strong class="lb iu">你可以用上面的来开始你的NNs和Flux.jl的旅程</strong><a class="ae ky" href="https://github.com/niczky12/medium/blob/master/julia/epoch_pluto.jl" rel="noopener ugc nofollow" target="_blank">冥王星笔记本在这里</a>供你消遣。欢迎您更改输入样本大小、日期、优化器、损失函数、激活函数、神经网络结构等。<strong class="lb iu">去野外按几个按钮！</strong></p><div class="md me gp gr mf mg"><a href="https://github.com/niczky12/medium/blob/master/julia/epoch_pluto.jl" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">medium/epoch _ Pluto . JL at master niczky 12/medium</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">中篇文章代码https://medium.com/@niczky12-medium/epoch _ Pluto . JL at master niczky 12/medium</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">github.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu ks mg"/></div></div></a></div><blockquote class="oy oz pa"><p id="e683" class="kz la mc lb b lc ld ju le lf lg jx lh pb lj lk ll pc ln lo lp pd lr ls lt lu im bi translated">我写朱莉娅和其他很酷的东西。如果你喜欢这样的文章，请考虑关注我。</p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><div class="kj kk kl km gt mg"><a rel="noopener follow" target="_blank" href="/jupyter-notebooks-can-be-a-pain-but-i-️-pluto-f47913c5c16d"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">朱庇特笔记本可能是一种痛苦，但我❤️布鲁托</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">朱莉娅的Pluto.jl将使教育变得更好</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="pu l mr ms mt mp mu ks mg"/></div></div></a></div><div class="md me gp gr mf mg"><a rel="noopener follow" target="_blank" href="/vectorize-everything-with-julia-ad04a1696944"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">向量化朱莉娅的一切</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">告别for loops，广播所有的东西</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="pv l mr ms mt mp mu ks mg"/></div></div></a></div><div class="md me gp gr mf mg"><a href="https://blog.devgenius.io/make-a-command-line-game-with-julia-a408057adcfe" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">和Julia一起做一个命令行游戏</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">没有图形用户界面的2048游戏</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">blog.devgenius.io</p></div></div><div class="mp l"><div class="pw l mr ms mt mp mu ks mg"/></div></div></a></div><div class="md me gp gr mf mg"><a rel="noopener follow" target="_blank" href="/control-flow-basics-with-julia-c4c10abf4dc2"><div class="mh ab fo"><div class="mi ab mj cl cj mk"><h2 class="bd iu gy z fp ml fr fs mm fu fw is bi translated">Julia的控制流基础知识</h2><div class="mn l"><h3 class="bd b gy z fp ml fr fs mm fu fw dk translated">休息，继续和所有其他有趣的事情</h3></div><div class="mo l"><p class="bd b dl z fp ml fr fs mm fu fw dk translated">towardsdatascience.com</p></div></div><div class="mp l"><div class="px l mr ms mt mp mu ks mg"/></div></div></a></div></div></div>    
</body>
</html>