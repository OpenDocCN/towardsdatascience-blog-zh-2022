<html>
<head>
<title>Mastering the evaluation of classification models with storytelling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过讲故事掌握分类模型的评估</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mastering-the-evaluation-of-classification-models-with-storytelling-f8a9f63f3723#2022-08-29">https://towardsdatascience.com/mastering-the-evaluation-of-classification-models-with-storytelling-f8a9f63f3723#2022-08-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="48da" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学家必备的知识</h2><div class=""/><figure class="gl gn ka kb kc kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi jz"><img src="../Images/59dc98af381456aa59d0da7db37ef4ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7FrwPkUpr2pS0BZB"/></div></div><p class="kk kl gj gh gi km kn bd b be z dk translated">照片由<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ko" href="https://unsplash.com/@adroman?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aditya Romansa </a>拍摄</p></figure><p id="6c9c" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi ln translated">今天，我们可以从世界各地获得源源不断的数据。分类模型是最流行的机器学习工具之一，用于在数据中发现模式并理解它，以便我们可以揭示决策的相关见解。它们是一种监督学习的形式，在这种学习中，我们训练一个模型，根据预先确定的特征对数据点进行分组。反过来，该模型输出数据点属于特定类别的可能性或概率。</p><p id="3e34" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">用例层出不穷，广泛分布于各个行业— <em class="lw">语音识别、垃圾邮件检测、异常/欺诈检测、客户流失预测、客户细分和信用评估。</em></p><p id="02d7" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jd">因此，作为一名数据科学家，掌握分类模型的艺术至关重要。</strong></p><p id="90e3" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在本文中，我们将关注在数据科学中创建模型的最后一个步骤:评估模型性能，或者换句话说，评估分类的好坏。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="6a57" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jd">有什么比一个好故事更能解释这些指标以及如何使用它们呢？</strong></p><p id="c769" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="lw">假设你是所在城市医院产前部的负责人。你的目标是为未来的父母提供最积极的体验。在这方面，你们雇佣了最好的医生，并组建了一支由护士和助产士组成的梦之队来支持他。</em></p><figure class="mf mg mh mi gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi me"><img src="../Images/2eea92cb8f1cc23e5a04ddc4143910e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SSNTH0C-66W4Sd2J"/></div></div><p class="kk kl gj gh gi km kn bd b be z dk translated"><a class="ae ko" href="https://unsplash.com/@usmanyousaf?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乌斯曼·优素福</a>在<a class="ae ko" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9c5f" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">医生忙得不可开交，没有时间检查所有的病人以确定他们是否怀孕。所以他使用分析和不同的血液标记进行验证。护士的角色是探访病人以确保预见性。这里我们有4种可能的情况:</p><ul class=""><li id="7800" class="mj mk it kr b ks kt kw kx la ml le mm li mn lm mo mp mq mr bi translated"><em class="lw">医生说病人怀孕了，护士确认<br/> → </em> <strong class="kr jd"> <em class="lw">真阳性(TP) </em> </strong></li><li id="3af5" class="mj mk it kr b ks ms kw mt la mu le mv li mw lm mo mp mq mr bi translated"><em class="lw">医生说病人怀孕了，但护士宣布无效<br/> → </em> <strong class="kr jd"> <em class="lw">假阳性【FP】</em></strong></li><li id="e5e2" class="mj mk it kr b ks ms kw mt la mu le mv li mw lm mo mp mq mr bi translated"><em class="lw">医生说病人没有怀孕，护士确认<br/> → </em> <strong class="kr jd"> <em class="lw">真阴性(TN) </em> </strong></li><li id="8d17" class="mj mk it kr b ks ms kw mt la mu le mv li mw lm mo mp mq mr bi translated"><em class="lw">医生说病人没有怀孕，但护士宣布无效<br/> → </em> <strong class="kr jd"> <em class="lw">假阴性(FN) </em> </strong></li></ul><p id="ae77" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="lw">作为部门主管，你专注于提供最佳质量的服务，因此你想评估医生在识别早孕方面的能力。为此，您可以使用5个关键指标:</em></p><h2 id="ecce" class="mx my it bd mz na nb dn nc nd ne dp nf la ng nh ni le nj nk nl li nm nn no iz bi translated">1.准确(性)</h2><p id="7e94" class="pw-post-body-paragraph kp kq it kr b ks np ku kv kw nq ky kz la nr lc ld le ns lg lh li nt lk ll lm im bi translated">准确性可能是最常见的度量标准，因为它相对容易理解。它是<strong class="kr jd">正确预测数除以预测总数的比值。</strong></p><pre class="mf mg mh mi gt nu nv nw nx aw ny bi"><span id="f3a0" class="mx my it nv b gy nz oa l ob oc">(TP+TN) / (TP + FP + TN + FN)</span></pre><p id="c94a" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">换句话说，准确性会告诉我们医生在给病人分类方面有多好。</p><p id="b648" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">50%的准确率意味着这个模型和掷硬币一样好。一般来说，根据应用领域的不同，我们的目标是达到90%、95%或99%以上的精度。</p><blockquote class="od"><p id="9038" class="oe of it bd og oh oi oj ok ol om lm dk translated">记住:有人说，如果我们有高精度，我们就有一个好模型。只有当数据集平衡时才是这样，也就是说，类的大小相对均匀。</p></blockquote><p id="05d2" class="pw-post-body-paragraph kp kq it kr b ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm im bi translated">假设在患者群中有更多未怀孕的患者(<em class="lw">，即怀孕患者占少数</em>)。在这种情况下，我们说样本是不平衡的，精确度不是评估性能的最佳指标。</p><h2 id="2481" class="mx my it bd mz na nb dn nc nd ne dp nf la ng nh ni le nj nk nl li nm nn no iz bi translated">2.精确</h2><p id="3738" class="pw-post-body-paragraph kp kq it kr b ks np ku kv kw nq ky kz la nr lc ld le ns lg lh li nt lk ll lm im bi translated">精度是正确预测的正元素数除以预测的正元素总数。所以这是一个准确性和质量的衡量标准——它告诉我们医生在预测怀孕方面有多好。</p><pre class="mf mg mh mi gt nu nv nw nx aw ny bi"><span id="1dce" class="mx my it nv b gy nz oa l ob oc">TP / (TP + FP)</span></pre><blockquote class="od"><p id="b56a" class="oe of it bd og oh os ot ou ov ow lm dk translated">根据模型应用，具有高精度可能是至关重要的。始终评估出错的风险，以决定精度值是否足够好。</p></blockquote><p id="dc61" class="pw-post-body-paragraph kp kq it kr b ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm im bi translated">如果医生宣布怀孕(但他错了)，这可能会影响患者，因为他们可能会就这个重大消息做出改变人生的决定(例如，买新房子或换车)。</p><h2 id="b7bf" class="mx my it bd mz na nb dn nc nd ne dp nf la ng nh ni le nj nk nl li nm nn no iz bi translated">3.回忆</h2><p id="47eb" class="pw-post-body-paragraph kp kq it kr b ks np ku kv kw nq ky kz la nr lc ld le ns lg lh li nt lk ll lm im bi translated">回忆——又名敏感度或真阳性率或命中率，是与实际阳性数相比，正确预测的阳性元素数。它告诉我们医生在检测怀孕方面有多好。</p><pre class="mf mg mh mi gt nu nv nw nx aw ny bi"><span id="676d" class="mx my it nv b gy nz oa l ob oc">TP / (TP + FN)</span></pre><blockquote class="od"><p id="161c" class="oe of it bd og oh os ot ou ov ow lm dk translated">与precision类似，根据模型应用，拥有高召回率可能是至关重要的。有时，我们不能错过一个预测(欺诈，癌症检测)。</p></blockquote><p id="79ae" class="pw-post-body-paragraph kp kq it kr b ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm im bi translated">假设医生错过了一个病例，没有预测到怀孕。患者在怀孕期间可能会保持一些不健康的习惯，如吸烟或饮酒。</p><h2 id="695e" class="mx my it bd mz na nb dn nc nd ne dp nf la ng nh ni le nj nk nl li nm nn no iz bi translated">4.特征</h2><p id="5831" class="pw-post-body-paragraph kp kq it kr b ks np ku kv kw nq ky kz la nr lc ld le ns lg lh li nt lk ll lm im bi translated">特异性—也称为选择性或真阴性率，总结了当结果为阴性时预测阳性类别的频率。<strong class="kr jd">可以理解为误报警指示灯</strong>。</p><pre class="mf mg mh mi gt nu nv nw nx aw ny bi"><span id="be96" class="mx my it nv b gy nz oa l ob oc">TN / (TN + FP)</span></pre><blockquote class="od"><p id="7b6e" class="oe of it bd og oh os ot ou ov ow lm dk translated">理想情况下，一个模型应该具有<strong class="ak">高特异性和</strong>高召回率，但这是一个权衡。每个模型都需要选择一个阈值。</p></blockquote><p id="b424" class="pw-post-body-paragraph kp kq it kr b ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm im bi translated">基于上面提到的原因，我们不想错过一个怀孕案例。同时，如果我们没有可靠的血液标志物来确认怀孕，我们也不想提醒患者。作为部门主管，你需要决定医生的预后不够好的转变点是什么，我们需要护士进行体检。</p><h2 id="1e4f" class="mx my it bd mz na nb dn nc nd ne dp nf la ng nh ni le nj nk nl li nm nn no iz bi translated"><strong class="ak"> 5。F-measure | F1得分</strong></h2><p id="20b4" class="pw-post-body-paragraph kp kq it kr b ks np ku kv kw nq ky kz la nr lc ld le ns lg lh li nt lk ll lm im bi translated">F1分数是精确度和召回率的加权调和平均值。它反映了一个模型的有效性——<strong class="kr jd">当错过一个病例或错误宣布怀孕同样有风险时，医生的表现如何。</strong></p><pre class="mf mg mh mi gt nu nv nw nx aw ny bi"><span id="affb" class="mx my it nv b gy nz oa l ob oc">2 x (Precision x Recall) / (Precision + Recall)</span></pre><blockquote class="od"><p id="3ff5" class="oe of it bd og oh os ot ou ov ow lm dk translated">当样本不平衡，准确性变得不合适时，我们可以使用F1分数来评估模型的性能。</p></blockquote><p id="01e8" class="pw-post-body-paragraph kp kq it kr b ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm im bi translated">如果没有怀孕的患者比怀孕的患者多得多，我们认为样本是不平衡的，并将使用F1分数来评估医生的表现。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="b651" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">既然我们已经设置了评估分类模型的关键指标，我们可以更仔细地研究如何以一种令人信服的方式可视化它们。</p><h2 id="3ce9" class="mx my it bd mz na nb dn nc nd ne dp nf la ng nh ni le nj nk nl li nm nn no iz bi translated">混淆矩阵</h2><p id="3605" class="pw-post-body-paragraph kp kq it kr b ks np ku kv kw nq ky kz la nr lc ld le ns lg lh li nt lk ll lm im bi translated">混淆矩阵或误差矩阵是一个简单的表格，汇集了来自分类模型的预测结果:<em class="lw">真阳性、真阴性、假阳性&amp;假阴性。</em>它通过分解每个类别的正确和错误预测的数量，帮助可视化分类器产生的错误类型。</p><figure class="mf mg mh mi gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi ox"><img src="../Images/eff0c99ce7c92775f6e356fbbaa05af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w3XiotONmvTrGJpxvKPO0g.png"/></div></div><p class="kk kl gj gh gi km kn bd b be z dk translated">来源:<a class="ae ko" href="https://www.researchgate.net/publication/330174519_Application_of_an_interpretable_classification_model_on_Early_Folding_Residues_during_protein_folding" rel="noopener ugc nofollow" target="_blank">蛋白质折叠过程中早期折叠残基可解释分类模型的应用(Sebastian Bittrich) </a></p></figure><blockquote class="od"><p id="2984" class="oe of it bd og oh os ot ou ov ow lm dk translated">混淆矩阵突出显示了模型在进行预测时混淆的地方。</p></blockquote><p id="8b96" class="pw-post-body-paragraph kp kq it kr b ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm im bi translated">因此，与单独使用准确性相比，这是一种有用的可视化方法，因为它显示了模型的薄弱之处，并提供了改进它的可能性。</p><h2 id="791f" class="mx my it bd mz na nb dn nc nd ne dp nf la ng nh ni le nj nk nl li nm nn no iz bi translated">ROC曲线和精确回忆曲线</h2><p id="0d96" class="pw-post-body-paragraph kp kq it kr b ks np ku kv kw nq ky kz la nr lc ld le ns lg lh li nt lk ll lm im bi translated">ROC曲线是假阳性率(也称为反向特异性)对真阳性率(也称为灵敏度)的曲线图。如果每个类别的患者数量大致相等(<em class="lw">即平衡数据集</em>)，则应使用精确-召回曲线，而非平衡病例应使用精确-召回曲线(<a class="ae ko" href="https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-classification-in-python/#:~:text=Generally,%20the%20use%20of%20ROC,moderate%20to%20large%20class%20imbalance." rel="noopener ugc nofollow" target="_blank">来源</a>)。</p><blockquote class="od"><p id="dc15" class="oe of it bd og oh oi oj ok ol om lm dk translated">一个好的模型用一条从0到1快速增长的曲线来表示。该公司表示，该模型不会牺牲太多的精确度来获得高召回率。</p></blockquote><p id="f555" class="pw-post-body-paragraph kp kq it kr b ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm im bi translated">一个糟糕的模型——又名无技能分类器——不能区分类别，因此，在所有情况下都预测一个随机或恒定的类别。这些模型由从图的左下角到右上角的对角线表示。</p><figure class="mf mg mh mi gt kd gh gi paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="gh gi oy"><img src="../Images/02579ff0de5dc168932bcc3bd200517b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJgroE0qihloJEpLv9li_A.png"/></div></div><p class="kk kl gj gh gi km kn bd b be z dk translated">来源:作者</p></figure><p id="1700" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">所以你现在可能知道曲线的形状给了我们调试模型的宝贵信息:</p><ul class=""><li id="6c27" class="mj mk it kr b ks kt kw kx la ml le mm li mn lm mo mp mq mr bi translated">如果曲线更接近左下方的随机线，则表明假阳性较低，真阴性较高。另一方面，如果图的y轴上有更大的值，这意味着更高的真阳性和更低的假阴性。</li><li id="a6b3" class="mj mk it kr b ks ms kw mt la mu le mv li mw lm mo mp mq mr bi translated">如果曲线不平滑，则意味着模型不稳定。</li></ul><p id="dc2b" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这些曲线也是比较模型和选择最佳模型的重要工具。</p><p id="cb34" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">曲线下面积(AUC或AUROC)通常用于总结模型技巧。它可以取从0.5(最差模型)到1(完美模型)的值。</p><blockquote class="od"><p id="e1f9" class="oe of it bd og oh oi oj ok ol om lm dk translated">AUROC值越高，模型越好。</p></blockquote></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="702d" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kr jd">现在，您已经掌握了开始评估您的分类模型所需的所有基本知识，对于您的数据科学家角色来说，同样重要的是，要有一个好的故事来向大量观众传达您的表现。</strong></p><p id="2b59" class="pw-post-body-paragraph kp kq it kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">像往常一样，给我留下你的评论和<a class="ae ko" href="https://www.linkedin.com/in/aureliegiraud9000/" rel="noopener ugc nofollow" target="_blank">消息</a>，我会很高兴收到你的来信，让这篇文章变得更好。在Medium上关注我，了解更多关于数据科学的内容。</p><div class="oz pa gp gr pb pc"><a href="https://agiraud.medium.com/membership" rel="noopener follow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd jd gy z fp ph fr fs pi fu fw jc bi translated">通过我的推荐链接加入Medium-aurélie Giraud</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">不要错过我的下一篇文章，阅读Medium上成千上万的其他作者的文章！我写的是如何使用数据科学…</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">agiraud.medium.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq ki pc"/></div></div></a></div></div></div>    
</body>
</html>