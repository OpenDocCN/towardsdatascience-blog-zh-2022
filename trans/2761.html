<html>
<head>
<title>Recipe Cuisine Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">食谱烹饪分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/recipe-cuisine-classification-278ea0837c94#2022-06-14">https://towardsdatascience.com/recipe-cuisine-classification-278ea0837c94#2022-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4e2e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">伯特变压器&amp;食物-药物负相互作用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c1e7572b793fbd5893aad3fc44872602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8fjRr9KZfNll6OVI"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@socialcut?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">S O C I A L C U T</a>拍摄</p></figure><h1 id="79a1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="76c0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">几个模型架构可以用来执行烹饪分类。一些最受欢迎的模型，按照复杂程度的增加顺序，是支持向量机(Pouladzadeh等人，2015年)、BERT (Devlin等人，2018年)、RoBERTa(刘等人，2019年)或3(布朗等人，2020年)模型。</p><h2 id="3242" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">变形金刚(电影名)</h2><p id="9b45" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">与计算机视觉不同，在自然语言处理(NLP)中，预训练模型最近才变得广泛可用。部分由于文本数据集的稀缺，NLP的进展缓慢，直到变压器(BERT)的双向编码器表示的发布(Devlin等人，2018)。</p><p id="921d" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">BERT有两种预训练模型:基本模型和大型模型。虽然两者使用相同的架构，但前者包含1.1亿个参数，而后者包含3.45亿个参数。能够使用预先训练的模型并对其进行微调以适应不同的任务意味着即使在缺乏足够的数据来训练具有数百万个参数的模型的情况下，也可以避免模型过度拟合。较大的模型通常具有更好的性能(Devlin等人，2018年)。</p><p id="8dec" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">在微调BERT时，有三种可能性(Devlin et al .，2018):</p><ul class=""><li id="20dd" class="ne nf it lt b lu mz lx na ma ng me nh mi ni mm nj nk nl nm bi translated">训练所有建筑</li><li id="cd2d" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">训练一些层，冷冻其他层</li><li id="38bb" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">冻结整个网络并将额外的层附加到模型上</li></ul><p id="e11a" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">与其他神经网络架构一样，提供的训练数据量越大，它的性能就越好。因此，一个重要的收获是，运行更多代的BERT将导致更高的准确性，并有足够的数据。就所需的计算能力而言，它相当于使用多个最先进的GPU进行几天的训练(Devlin et al .，2018)。</p><p id="3f28" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">BERT的另一个特点是它的双向方法。相比之下，以前的努力要么从左到右要么结合从左到右和从右到左的训练来查看文本序列(Devlin等人，2018年)。</p><p id="bf13" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">与递归神经网络和长短期记忆神经网络相比，BERT的一个优点是它可以并行化。这意味着它可以通过在多个GPU中训练来加速。如果输入数据是文本序列，这意味着它可以一次接受多个标记作为输入(Devlin et al .，2018)。</p><p id="ee6e" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">变形金刚的两个后验实现分别是Research和OpenAI的鲁棒优化BERT预训练方法(RoBERTa)(刘等，2019)和生成预训练变形金刚3(3)(布朗等，2020)。</p><p id="32d9" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">BERT transformer用于根据配料列表构建菜肴预测模型。这使得在烹饪水平上用于治疗AD的药物的负面食物-药物相互作用最小化。</p><h2 id="8f58" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">烹饪/药物的负面相互作用</h2><p id="eafb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">因为BERT模型以前是用数百万个样本训练的，所以它们可以通过更少的微调数据被广泛的应用程序重新调整用途(Devlin等人，2018)。在这种特定情况下，烹饪预测。</p><p id="16e7" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">配料和食谱的选择受地理和文化的影响很大。一些食谱比其他食谱更富含已知AD和/或新冠肺炎(Laponogov等人，2021年)打浆特性的成分。在烹饪水平上考虑这种变化允许我们在烹饪水平上预测最有可能减少与药物的负面相互作用的数量，即使没有所有成分的这种信息。食物-药物相互作用可导致药物生物利用度的显著降低，这是由于食物分子和药物化学成分之间的直接相互作用，或者是由于食物摄入的生理反应。世界上销售最多的一些药物是抗肿瘤药和针对神经系统疾病的药物。图1中提供的信息有助于我们根据食谱估算食谱的健康益处(Jovanovik等人，2015年)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/f273af065c55855876cbd1010a3a9a2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OrU587pmaHqnZfLstCo09A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nt">图1 </strong>药物(左图)和菜肴(上图)之间现有相互作用的百分比。作为参考，对于北美料理(<em class="nu"/>)和抗肿瘤药物(<em class="nu"> A </em>)，预计0.005288%的负相互作用。[图片来源=(约万诺维克等人，2015)]</p></figure><p id="b3d7" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">另一方面，与其他行业一样，推荐系统通常会将产品分为多个类别。食物推荐系统可以通过将用户导向他们最喜欢的选择而受益于美食分类(Anderson等人，2018)。</p><p id="a2fc" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">一个烹饪分类器被训练、测试和验证，以预测神经(AD)和抗感染(新冠肺炎)药物与烹饪确定的食谱之间的负面相互作用。</p><h1 id="35c3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">方法</h1><p id="2a17" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用BERT变换器，训练、验证和测试了一个根据配料列表预测菜肴的模型。</p><p id="c25e" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated"><a class="ae ky" href="https://raw.githubusercontent.com/warcraft12321/HyperFoods/master/data/kaggle_and_nature/kaggle_and_nature.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle和Nature </a>数据集包含大约100000个配方，用于训练变压器。每个食谱都包括一份配料清单，以及相应的菜肴。一份按字母顺序排列的配料清单给了模型。数据集的80%用于训练，10%用于验证，10%用于测试。</p><p id="3c49" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">在训练模型之前，使用BERT记号化器，记号化步骤将每个配方分成50个记号。初始变压器的所有参数都被冻结。</p><p id="ab5f" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">为神经网络选择的体系结构包括一个下降层，一个包含768层512个节点的密集层1和一个包含512层的层2，每个层有11个节点(与菜肴的数量相同)。</p><p id="0f70" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">在训练时，使用了实现权重衰减为1e-3的Adam算法的优化器。负对数似然损失被用作损失函数。并且模型收敛需要40个时期。训练是在Google Collab的一个GPU中进行的。</p><p id="d34d" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">模型的性能是通过对每种菜肴的精确度、召回率和f1分数来评估的。</p><p id="8138" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">最后，介绍了在抗感染类(针对新冠肺炎)和神经类(针对AD)中具有最低数量的负面食物-药物相互作用的烹饪。</p><h1 id="46b1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结果和讨论</h1><h2 id="6293" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">菜肴分类</h2><p id="6f80" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在图2中，<a class="ae ky" href="https://raw.githubusercontent.com/warcraft12321/HyperFoods/master/data/kaggle_and_nature/kaggle_and_nature.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle &amp; Nature </a>数据集基于配料数量的食谱数量分布被表示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/8e69f011a43d6f71f3a8f7055cdf484b.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*M37K7wOFtmNsK8abRpEe_g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nt">图2 </strong>配方分布在<a class="ae ky" href="https://raw.githubusercontent.com/warcraft12321/HyperFoods/master/data/kaggle_and_nature/kaggle_and_nature.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle &amp; Nature </a>数据集中对应的配料数量</p></figure><p id="efa4" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">根据上图，Kaggle和Nature数据集中的大多数食谱包含6到8种成分。平均来说，每份食谱有12种配料。没有一个食谱包含超过60种成分。</p><p id="ca26" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">在图3中，显示了<a class="ae ky" href="https://raw.githubusercontent.com/warcraft12321/HyperFoods/master/data/kaggle_and_nature/kaggle_and_nature.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle &amp; Nature </a>数据集中每种菜肴的食谱数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/659ed3abfa946e2544ac608a6dbe0f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*fGpJ83DpxyvSEqNd_1hjbQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nt">图3 </strong>在<a class="ae ky" href="https://raw.githubusercontent.com/warcraft12321/HyperFoods/master/data/kaggle_and_nature/kaggle_and_nature.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle &amp; Nature </a>数据集中每个菜系的菜谱数量。</p></figure><p id="97a1" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">共有96250种食谱，涵盖11大菜系。食谱最多的三大菜系分别是北美、南欧和拉美，分别有45843、14178和11892种食谱。</p><p id="4ec2" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">在表1中，展示了菜肴分类器精度、召回率和F1分数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/2bc3f708f14415dcffece30b3427a9b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Za2hO7PAz9zV1jSFEZCkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nt">表1 </strong>模型分类准确度——精度、召回率和f1-分数被详细描述到训练数据集中的每一个菜系</p></figure><p id="038c" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">南欧、拉丁美洲、北美和东亚的F1得分高于55%。</p><p id="ab78" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">图4显示了与神经系统药物(AD)和抗感染药物(新冠肺炎)的负面食物-药物相互作用最少的菜肴的地理分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/969f4f52a0fe80ddb8b6937f4b227aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*6UxlAXJ97ifHaxSAbWKFww.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nt">图4 </strong>拉丁美洲美食与神经类药物——AD的负面相互作用数量最低。西欧抗感染药效果最好——新冠肺炎。</p></figure><p id="9a65" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">拉丁美洲和西欧的菜肴分别显示出与神经系统药物和抗感染药物的负面相互作用最少。</p><p id="03de" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated"><a class="ae ky" href="https://raw.githubusercontent.com/warcraft12321/HyperFoods/master/data/kaggle_and_nature/kaggle_and_nature.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle &amp; Nature </a>数据库包含分布在各大菜系的不平衡数量的食谱。虽然BERT模型是针对不平衡数据集进行训练的，但这可能仍然会影响模型的预测能力。只考虑成分列表而不考虑各自的食谱说明可能会导致较差的检测。以及北欧某些菜系的食谱数据集的有限大小。某些菜系的精确度、召回率和f1评分较低，可能与缺乏独特的配料有关。</p><h1 id="2229" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">后续步骤</h1><p id="4b82" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了实现训练更准确的烹饪分类器的目标，我们将优化电流互感器的架构(考虑罗伯塔和GPT-3的实现)，并考虑烹饪过程，而不仅仅是配料。使用带有更多食谱的烹饪标签数据集也将有助于在11种烹饪中获得更高的检测率。</p><h1 id="b0af" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">参考</h1><p id="3b07" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Pouladzadeh，p .，Shirmohammadi，s .，Bakirov，a .，Bulut，a .，和Yassine，A. (2015年)。基于云的食品分类SVM。<em class="nz">多媒体工具及应用</em>，<em class="nz"> 74 </em> (14)，5243–5260。<a class="ae ky" href="https://doi.org/10.1007/s11042-014-2116-x" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1007/s11042-014-2116-x</a></p><p id="880b" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">Devlin，j .，Chang，m-w .，Lee，k .，&amp; Toutanova，K. (2018年)。<em class="nz"> BERT:用于语言理解的深度双向转换器的预训练</em>。</p><p id="06b1" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">刘，y .，奥特，m .，戈亚尔，n .，杜，j .，乔希，m .，陈，d .，利维，o .，刘易斯，m .，泽特勒莫耶，l .，&amp;斯托扬诺夫，V. (2019)。<em class="nz"> RoBERTa:一种稳健优化的BERT预训练方法</em>。</p><p id="3897" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">Brown，T. B .、Mann，b .、Ryder，n .、Subbiah，m .、Kaplan，j .、Dhariwal，p .、Neelakantan，a .、Shyam，p .、Sastry，g .、Askell，a .、Agarwal，s .、Herbert-Voss，a .、Krueger，g .、Henighan，t .、Child，r .、Ramesh，a .、Ziegler，D. M .、Wu，j .、Winter，c .……Amodei，D. (2020年)。<em class="nz">语言模型是一次性学习者</em>。</p><p id="f028" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">Laponogov，I .，Gonzalez，g .，Shepherd，m .，Qureshi，a .，Veselkov，d .，Charkoftaki，g .，瓦西利乌，v .，Youssef，j .，Mirnezami，r .，Bronstein，m .，和Veselkov，K. (2021)。网络机器学习绘制富含植物化学成分的“超级食物”来对抗新冠肺炎。<em class="nz">人类基因组学</em>，<em class="nz"> 15 </em> (1)，1。【https://doi.org/10.1186/s40246-020-00297-x T4】</p><p id="ab5e" class="pw-post-body-paragraph lr ls it lt b lu mz ju lw lx na jx lz ma nb mc md me nc mg mh mi nd mk ml mm im bi translated">Jovanovik，m .，Bogojeska，a .，Trajanov，d .，和Kocarev，L. (2015年)。使用关联数据方法推断烹饪-药物相互作用。<em class="nz">科学报道</em>，<em class="nz"> 5 </em> (1)，9346。<a class="ae ky" href="https://doi.org/10.1038/srep09346" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1038/srep09346</a></p></div></div>    
</body>
</html>