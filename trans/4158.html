<html>
<head>
<title>Yes, Python Has a Built-In Database. Here’s How to Use It.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">是的，Python有一个内置的数据库。以下是使用方法。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/yes-python-has-a-built-in-database-heres-how-to-use-it-b3c033f172d3#2022-09-15">https://towardsdatascience.com/yes-python-has-a-built-in-database-heres-how-to-use-it-b3c033f172d3#2022-09-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="59db" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python中SQLite的简单指南。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/806ecb5fd495076db5de55507c52a4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PsnGY7NGiSg7rF2TkVFEUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自Shutterstock，授权给Frank Andrade</p></figure><p id="5c17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">信不信由你，在你的电脑上安装Python的那一刻，你也安装了其他奇妙的工具。其中之一就是SQLite。</p><p id="8b10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">SQLite是一个嵌入式的、基于文件的关系数据库管理系统(RDBMS ),可以在我们的Python应用程序中使用，而无需安装任何额外的软件。相反，我们只需要导入内置的Python库<code class="fe lu lv lw lx b">sqlite3</code>就可以使用这个数据库。</p><p id="255c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本指南中，我们将了解如何连接到数据库，创建表，将数据插入表中，以及如何将其与Pandas集成。</p><p id="9f4f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ly">如果你不想看，可以看我的YouTube视频！</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div></figure><blockquote class="mb mc md"><p id="c598" class="ky kz ly la b lb lc ju ld le lf jx lg me li lj lk mf lm ln lo mg lq lr ls lt im bi translated"><strong class="la iu">请务必点击</strong> <a class="ae mh" href="https://frankandrade.ck.page/f2fbbdc6db" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">订阅此处</strong> </a> <strong class="la iu">获取我在所有教程中使用的SQL备忘单(免费PDF) </strong></p></blockquote><h2 id="aaf0" class="mi mj it bd mk ml mm dn mn mo mp dp mq lh mr ms mt ll mu mv mw lp mx my mz na bi translated">创建到数据库的连接</h2><p id="5a0d" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">我们要做的第一件事是创建一个到数据库的连接。为此，我们只需要导入sqlite3并使用<code class="fe lu lv lw lx b">.connect</code>方法。在括号内，我们写下我们想要创建的数据库的名称。在我的例子中，我将其命名为“students.db”</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="355f" class="mi mj it lx b gy nk nl l nm nn"><strong class="lx iu">import</strong> sqlite3<br/><br/># create a connection<br/>conn = sqlite3.connect('students.db')</span></pre><p id="41c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您运行上面的代码，将在您的工作目录中创建一个名为“students.db”的新文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/0313649afacb1e32eb0468a37b9ec891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LWmVhmgsIAwzgk1HOrkL1w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="ed32" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以创建一个表并将数据放入其中。</p><h2 id="1659" class="mi mj it bd mk ml mm dn mn mo mp dp mq lh mr ms mt ll mu mv mw lp mx my mz na bi translated">创建表格</h2><p id="f9ee" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在创建表之前，我们需要创建一个游标。游标是一种用于建立执行SQL查询的连接的对象。我们将使用光标来创建表格、插入数据等等。</p><p id="3641" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要创建一个光标，我们只需要使用我们已经创建的连接和<code class="fe lu lv lw lx b">.cursor</code>方法。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="1c4a" class="mi mj it lx b gy nk nl l nm nn">c = conn.cursor()</span></pre><p id="e09d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，我们使用<code class="fe lu lv lw lx b">.execute</code>方法在数据库中创建一个新表。在引号内，我们编写了用于在大多数RDBMS中创建表的普通SQL语法。在这种情况下，我们使用<code class="fe lu lv lw lx b">CREATE TABLE</code>语句。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="486a" class="mi mj it lx b gy nk nl l nm nn">c.<strong class="lx iu">execute</strong>("""<strong class="lx iu">CREATE TABLE</strong> students (<br/>            name <strong class="lx iu">TEXT</strong>,<br/>            age <strong class="lx iu">INTEGER</strong>,<br/>            height <strong class="lx iu">REAL</strong><br/>    )""")</span></pre><p id="08dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如您所见，在创建表的列时，我们需要定义数据类型。与大多数拥有数十种数据类型的RDBMS不同，SQLite只有5种数据类型:</p><ul class=""><li id="472f" class="np nq it la b lb lc le lf lh nr ll ns lp nt lt nu nv nw nx bi translated">Null:缺少值</li><li id="cc56" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">整数:没有小数点的数字(例如1、2、3、4)</li><li id="1514" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">实数:带小数点的数字(如6.2、7.6、11.2)</li><li id="7125" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">文本:任何字符数据</li><li id="2ef1" class="np nq it la b lb ny le nz lh oa ll ob lp oc lt nu nv nw nx bi translated">Blob:作为值存储在数据库中的二进制数据的集合。它允许我们在数据库中存储文档、图像和其他多媒体文件。</li></ul><p id="49ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们必须提交并关闭连接。以下是目前为止的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od ma l"/></div></figure><p id="e397" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">太好了！我们已经创建了第一个表，但是它是空的，所以让我们将一些数据放入其中。</p><h2 id="2ddb" class="mi mj it bd mk ml mm dn mn mo mp dp mq lh mr ms mt ll mu mv mw lp mx my mz na bi translated">将数据插入表格</h2><p id="9b06" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">让我们从向“学生”表添加一行开始。为此，我们再次使用<code class="fe lu lv lw lx b">.execute</code>，但是现在我们使用<code class="fe lu lv lw lx b">INSERT INTO</code>语句。</p><p id="655c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面我补充一个学生“马克”的数据，他今年20岁，身高1.9米。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="989d" class="mi mj it lx b gy nk nl l nm nn">c.<strong class="lx iu">execute</strong>("<strong class="lx iu">INSERT INTO</strong> students <strong class="lx iu">VALUES</strong> ('mark', 20, 1.9)")</span></pre><p id="130c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，在运行上面的代码之前，您需要注释掉<code class="fe lu lv lw lx b">CREATE TABLE</code>语句，因为该表已经存在。</p><p id="74da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们也可以插入多行，但是在这种情况下，我们使用<code class="fe lu lv lw lx b">.executemany </code>方法。除此之外，我们使用<code class="fe lu lv lw lx b">?</code>作为占位符。这有助于我们从名为<code class="fe lu lv lw lx b">all_students</code>的列表中添加数据。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="9bd2" class="mi mj it lx b gy nk nl l nm nn">all_students = [<br/>    ('john', 21, 1.8),<br/>    ('david', 35, 1.7),<br/>    ('michael', 19, 1.83),<br/>]<br/>c.<strong class="lx iu">executemany</strong>("<strong class="lx iu">INSERT INTO</strong> students <strong class="lx iu">VALUES</strong> (?, ?, ?)", all_students)</span></pre><h2 id="18b2" class="mi mj it bd mk ml mm dn mn mo mp dp mq lh mr ms mt ll mu mv mw lp mx my mz na bi translated">从表a中选择数据显示数据</h2><p id="a01d" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">到目前为止，我们已经创建了一个表并将数据放入其中，但是我们还没有看到我们的表。要查看我们的数据，我们首先需要用<code class="fe lu lv lw lx b">SELECT</code>语句从我们的表中选择数据，然后用<code class="fe lu lv lw lx b">.fetchall</code>显示它。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="1743" class="mi mj it lx b gy nk nl l nm nn">c.execute("<strong class="lx iu">SELECT</strong> * <strong class="lx iu">FROM</strong> students")<br/><strong class="lx iu">print</strong>(c<strong class="lx iu">.fetchall()</strong>)</span></pre><p id="4bc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打印的输出应该是:</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="0709" class="mi mj it lx b gy nk nl l nm nn">[(‘mark’, 20, 1.9), (‘john’, 21, 1.8), (‘david’, 35, 1.7), (‘michael’, 19, 1.83)]</span></pre><p id="c10f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您不想在每次想要查看表格中的数据时都重复这些步骤，您可以使用<a class="ae mh" href="https://inloop.github.io/sqlite-viewer/" rel="noopener ugc nofollow" target="_blank"> SQLiteViewer </a>。在那里你只需要拖动你的。db文件来查看其内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/265c8b3c5a9b1e054978618f6096d507.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7r5F78zdRqBQ2cbPw7rTBQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="dc27" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我们到目前为止所做的一切</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od ma l"/></div></figure><p id="dddc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是Python中SQLite的基础。在SQLite中，更新行、删除行、排序数据和删除表也是可能的。您只需要使用您的SQL知识来执行它们。</p><h2 id="b29c" class="mi mj it bd mk ml mm dn mn mo mp dp mq lh mr ms mt ll mu mv mw lp mx my mz na bi translated">使用Pandas和SQLite</h2><p id="8a7f" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">SQLite可以与Pandas中的dataframes集成。例如，我们将使用一个名为<code class="fe lu lv lw lx b">population_total.csv</code>的CSV文件，您可以在这里下载<a class="ae mh" href="https://github.com/ifrankandrade/python-course-for-excel-users/tree/main/4.Data%20Visualization" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="5abe" class="mi mj it lx b gy nk nl l nm nn"><strong class="lx iu">import</strong> pandas <strong class="lx iu">as</strong> pd<br/>df = pd.read_csv("population_total.csv")</span></pre><p id="50e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是数据帧的外观:</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="959e" class="mi mj it lx b gy nk nl l nm nn">&gt;&gt;&gt; df</span><span id="f98e" class="mi mj it lx b gy of nl l nm nn">             country year    population</span><span id="c634" class="mi mj it lx b gy of nl l nm nn">0             China  2020.0  1.439324e+09<br/>1             China  2019.0  1.433784e+09<br/>2             China  2018.0  1.427648e+09<br/>3             China  2017.0  1.421022e+09<br/>4             China  2016.0  1.414049e+09<br/>...             ...     ...           ...<br/>4180  United States  1965.0  1.997337e+08<br/>4181  United States  1960.0  1.867206e+08<br/>4182  United States  1955.0  1.716853e+08<br/>4183          India  1960.0  4.505477e+08<br/>4184          India  1955.0  4.098806e+08</span></pre><p id="b580" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们创建一个内存中的SQLite数据库。为此，首先，我们需要安装sqlalchemy: <code class="fe lu lv lw lx b">pip install sqlalchemy</code></p><p id="59dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们需要创造一个引擎。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="5008" class="mi mj it lx b gy nk nl l nm nn"><strong class="lx iu">from</strong> sqlalchemy <strong class="lx iu">import</strong> create_engine<br/>engine = create_engine('sqlite://', echo=<strong class="lx iu">False</strong>)</span></pre><p id="19df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们将数据帧附加到数据库中的一个表中(这个表不需要预先创建)。在本例中，我将把<code class="fe lu lv lw lx b">df</code>附加到一个我命名为“population”的表中。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="45cd" class="mi mj it lx b gy nk nl l nm nn">df.<strong class="lx iu">to_sql</strong>("population", con=engine)</span></pre><p id="9e6f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要查看我们的表，我们运行下面的代码。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="90d8" class="mi mj it lx b gy nk nl l nm nn">engine.<strong class="lx iu">execute</strong>("<strong class="lx iu">SELECT</strong> * <strong class="lx iu">FROM</strong> population").fetchall()</span></pre><p id="aa04" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:如果您想要创建一个sqlite文件(而不是内存中的数据库)，您应该创建一个带有文件数据库的引擎。</p><p id="72af" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们创建一个<code class="fe lu lv lw lx b">mydb.db</code>文件，然后将<code class="fe lu lv lw lx b">df</code>数据帧附加到一个“人口”表。</p><pre class="kj kk kl km gt ng lx nh ni aw nj bi"><span id="159b" class="mi mj it lx b gy nk nl l nm nn"><strong class="lx iu">from</strong> sqlalchemy <strong class="lx iu">import</strong> create_engine<br/>engine = create_engine("sqlite:///mydb.db")</span><span id="a7a2" class="mi mj it lx b gy of nl l nm nn">df.to_sql("population", engine)</span></pre><p id="7701" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，您可以使用<code class="fe lu lv lw lx b">.fetchall</code>来查看表格或使用SQLite Viewer。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/3133ec6132233ed634ebf0460af50ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCFpbZJBLPGyTHxOt7-HHA.png"/></div></div></figure><p id="5f47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">恭喜你！现在您知道如何在Python中使用SQLite，甚至将它与Pandas中的dataframes集成。</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><p id="01d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">学习SQL —数据专业人员最需要的技能。<a class="ae mh" href="https://frankandrade.ck.page/f2fbbdc6db" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">加入我的20k+人电子邮件列表，获取我的免费SQL备忘单。</strong>T3】</a></p><p id="ace2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你用<a class="ae mh" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="oo op gp gr oq or"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ks or"/></div></div></a></div></div></div>    
</body>
</html>