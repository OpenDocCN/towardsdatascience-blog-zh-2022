<html>
<head>
<title>How to Merge Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何合并熊猫数据帧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-merge-pandas-dataframes-35afe8b1497c#2022-07-20">https://towardsdatascience.com/how-to-merge-pandas-dataframes-35afe8b1497c#2022-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1949" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何避免丢失有价值的数据点(包括备忘单)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9e36f19c69a8ebdbdc9f68a7ddceb884.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0xIn3fNIwwxy-3IK6Raog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">合并的熊猫(图片由作者提供)</p></figure><p id="7071" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">合并两个数据帧时的一个常见陷阱是无意中丢失了有价值的数据点。有时，您需要用第二个数据集中的附加信息来扩展您的初始数据集。为此，您可以将两个数据集读入pandas数据帧，然后用<code class="fe lu lv lw lx b">.merge()</code>方法将它们组合成一个数据帧。但是，根据您合并它们的方式，您最终可能会得到比预期更少或更多的数据点。</p><blockquote class="ly"><p id="6bc7" class="lz ma it bd mb mc md me mf mg mh lt dk translated">但是，根据您合并它们的方式，您最终可能会得到比预期更少或更多的数据点。</p></blockquote><p id="eddf" class="pw-post-body-paragraph ky kz it la b lb mi ju ld le mj jx lg lh mk lj lk ll ml ln lo lp mm lr ls lt im bi translated">本文将介绍合并两个数据帧的四种最常见的方法。由于合并pandas数据帧类似于SQL连接，我们将使用它们作为类比[1]。也就是说，我们将展示如何进行:</p><ul class=""><li id="2ed8" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">左外部联接(熊猫:“左”)</li><li id="b882" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">右外部联接(熊猫:“右”)</li><li id="fdf0" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">完全外部连接(熊猫:“外部”)</li><li id="41e5" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">内部联接(熊猫:“内部”)</li></ul><p id="3fcd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，我们将向您展示如何验证您的结果。</p><h1 id="22ec" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">基本原则</h1><p id="7013" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">为了解释这些概念，我们将使用下面两个最小的虚构数据集。在这个例子中，我们为动物园中的熊猫准备了两张桌子。第一个表包含动物园的位置信息。第二个表包含关于哪只熊猫在哪个动物园的信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/29ce0be358445e8a10c1e448d7842e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LOtV5lQIn_ar5BTTI2tweA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左侧数据帧df1(蓝色)和右侧数据帧df2(黄色)(图片由作者提供)</p></figure><p id="5e1d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下面的例子中，数据帧被着色以说明哪个条目来自哪个数据帧。当合并两个数据帧时，您将它们称为“左”和“右”数据帧。在本例中，<code class="fe lu lv lw lx b">df1</code>是左边的数据帧，颜色为蓝色。<code class="fe lu lv lw lx b">df2</code>是右边的数据框，用黄色标出。如果合并的数据帧中的一个条目来自两个数据帧，它将用绿色行背景指示。</p><ul class=""><li id="768a" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">左侧数据框:<code class="fe lu lv lw lx b">df1</code>，以<strong class="la iu">蓝色</strong>着色</li><li id="68fc" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">右侧数据框:<code class="fe lu lv lw lx b">df2</code>，用<strong class="la iu">黄色</strong>着色</li><li id="2d86" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">关键列:合并<code class="fe lu lv lw lx b">df1</code>和<code class="fe lu lv lw lx b">df2</code>的公共列。在本例中，键列是“zoo_id”。</li><li id="a057" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated">合并的数据帧:<code class="fe lu lv lw lx b">df_merged</code>，左边的<strong class="la iu">行为蓝色</strong>，右边的<strong class="la iu">行为黄色</strong>，右边的<strong class="la iu">行为绿色</strong></li></ul></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="7a7d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看<code class="fe lu lv lw lx b">.merge()</code>方法及其必要参数。这种方法比下面讨论的参数更多。然而，我们将只涉及与本文相关的内容。您可以参考文档[2]了解更多参数。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="bc5a" class="oj nc it lx b gy ok ol l om on">DataFrame.merge(right, <br/>                how = "...", <br/>                on = None, <br/>                indicator = False,<br/>                ...)</span></pre><p id="2f12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，从左边的数据帧<code class="fe lu lv lw lx b">df1</code>调用<code class="fe lu lv lw lx b">.merge()</code>方法，第一个参数是右边的数据帧<code class="fe lu lv lw lx b">df2</code>。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="1b54" class="oj nc it lx b gy ok ol l om on">df_merged = df1.merge(df2)</span></pre><p id="dbad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您也可以合并两个数据帧，如下所示，其中第一个参数是左侧数据帧，第二个参数是右侧数据帧:</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="ed91" class="oj nc it lx b gy ok ol l om on">df_merged = pd.merge(df1, df2)</span></pre><p id="14dd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然<code class="fe lu lv lw lx b">.merge()</code>方法足够智能，可以找到要合并的公共键列，但我建议用参数<code class="fe lu lv lw lx b">on</code>显式定义它。<strong class="la iu">这不仅让你的代码可读性更好，还加快了执行时间。</strong></p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="571d" class="oj nc it lx b gy ok ol l om on">df_merged = df1.merge(df2,<br/>                      on = "zoo_id")</span></pre><p id="721c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果键列在两个数据帧中没有相同的名称，可以使用参数<code class="fe lu lv lw lx b">on_left</code>和<code class="fe lu lv lw lx b">on_right</code>代替<code class="fe lu lv lw lx b">on</code>。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="63ba" class="oj nc it lx b gy ok ol l om on">df_merged = df1.merge(df2,<br/>                      on_left = "key1",<br/>                      on_right = "key2")</span></pre><p id="bb99" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了指示合并的数据帧中的一行来自哪个数据帧，我们将使用参数<code class="fe lu lv lw lx b">indicator = True</code>。该选项将在合并的数据框架中创建一个新列“_merge”，如下例所示。<strong class="la iu">对于合并数据帧的常规用法，可以省略</strong> <code class="fe lu lv lw lx b"><strong class="la iu">indicator</strong></code> <strong class="la iu">参数。</strong></p><h1 id="69d7" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">完全外部连接(熊猫:“外部”)</h1><p id="bc6b" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">如果你想拍下每只熊猫和每个动物园的全景，该怎么办？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8023f52939cea60d2b99093eb944a468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*640di3qElSVheL4UrHRIDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">完全外部连接(图片由作者提供)</p></figure><p id="d878" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，您可以在SQL speak [1]中使用完整的外部连接。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="18a7" class="oj nc it lx b gy ok ol l om on">SELECT *<br/>FROM df1<br/><strong class="lx iu">FULL OUTER JOIN</strong> df2<br/>  ON df1.zoo_id = df2.zoo_id;</span></pre><p id="2144" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在熊猫身上，你可以使用<code class="fe lu lv lw lx b">how = "outer"</code>【2】。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="076c" class="oj nc it lx b gy ok ol l om on">df_merged = df1.merge(df2, <br/>                      on = "zoo_id", <br/>                      how = <strong class="lx iu">"outer"</strong>,<br/>                      indicator = True)</span></pre><p id="226a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面，您可以看到通过键列匹配两个数据框中每一行的各种可能性。值101、102和103出现在两个数据帧的两个键列中。如果两个数据帧都匹配，则在两个数据帧的相交处会出现一个绿点。</p><p id="872a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，值104仅出现在左侧数据帧的关键字列中，而值105仅出现在右侧数据帧的关键字列中。不匹配的行在与称为“不匹配”的线的相交处分别用蓝色或黄色点表示。</p><p id="0522" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完整的外部联接包含下图中的所有点。</p><blockquote class="ly"><p id="7a5d" class="lz ma it bd mb mc md me mf mg mh lt dk translated">如果你想拍下每只熊猫和每个动物园的全景，该怎么办？</p></blockquote><figure class="oo op oq or os kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f3bc4247505bb0295d7b41de3a10779b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-FwPrF_EVRGX8VNyMF-Afg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DataFrame与“外部”合并(图片由作者提供)</p></figure><p id="3b68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为健全性检查，合并数据帧的预期长度应该大于或等于较长数据帧的长度。合并的数据帧<code class="fe lu lv lw lx b">df_merged</code>总共有七行:如列<code class="fe lu lv lw lx b">_merge</code>所示，两个都有四行，一个只从左边，两个只从右边。</p><p id="31f4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">绿色行不包含空值，而蓝色和黄色行包含缺失值。由于绿色行来自两个数据帧，因此每列都有一个值。然而，因为左边的数据帧<code class="fe lu lv lw lx b">df2</code>不包含任何与<code class="fe lu lv lw lx b">zoo_id = 104</code>一起生活在动物园中的熊猫，所以第4行的列<code class="fe lu lv lw lx b">panda_name</code>是nan。黄色的第5行和第6行也是如此，因为<code class="fe lu lv lw lx b">df1</code>不包含任何关于带有<code class="fe lu lv lw lx b">zoo_id = 105</code>的动物园的信息。</p><h1 id="6070" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">内部联接(熊猫:“内部”)</h1><p id="a83d" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">但是，如果你只想看看饲养熊猫的动物园呢？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e62bf4c276e5fc2b2a2516ecb56fccc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqMSx4nLaJC3g6BxOYau4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内部连接(图片由作者提供)</p></figure><p id="2eaf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，您可以在SQL speak [1]中使用内部连接。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="ab9d" class="oj nc it lx b gy ok ol l om on">SELECT *<br/>FROM df1<br/><strong class="lx iu">INNER JOIN</strong> df2<br/>  ON df1.zoo_id = df2.zoo_id;</span></pre><p id="f302" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在熊猫身上，你会用<code class="fe lu lv lw lx b">how = "inner"</code>【2】。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="ed88" class="oj nc it lx b gy ok ol l om on">df_merged = df1.merge(df2, <br/>                      on = "zoo_id", <br/>                      how = <strong class="lx iu">"inner"</strong>,<br/>                      indicator = True)</span></pre><p id="c34a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下图中，您可以再次看到完全外部连接所描述的匹配。但是，内部连接只考虑绿点，这表示两个数据帧的两个键列中都存在一个值。不匹配的值(完全外部连接中的蓝色和黄色点)被排除在外，如上图所示。</p><blockquote class="ly"><p id="2059" class="lz ma it bd mb mc md me mf mg mh lt dk translated">但是，如果你只想看看饲养熊猫的动物园呢？</p></blockquote><figure class="oo op oq or os kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c391538c8ff64be3ad96ca33138c0080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZ2fEG9FFQw7Ysu_jgzC8w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DataFrame与“inner”合并(图片由作者提供)</p></figure><p id="e9f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为健全性检查，合并数据帧的预期长度应该<strong class="la iu">长于或等于较短数据帧的长度。</strong>合并的数据帧<code class="fe lu lv lw lx b">df_merged</code>总共有四行:如列<code class="fe lu lv lw lx b">_merge</code>中所示，两者都有四行。</p><h1 id="30e7" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">左外部联接(熊猫:“左”)</h1><p id="17b3" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">现在，假设您想知道每个动物园都有哪些熊猫。有了这些信息，你可以计算出每个动物园有多少只熊猫。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eefb9cf4818f9424a5ee11f88b03e833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqwhQUSXo2O0Mz_fqe73vQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左外部连接(图片由作者提供)</p></figure><p id="4280" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，您可以在SQL speak [1]中使用左外连接。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="348a" class="oj nc it lx b gy ok ol l om on">SELECT *<br/>FROM df1<br/><strong class="lx iu">LEFT OUTER JOIN</strong> df2<br/>  ON df1.zoo_id = df2.zoo_id;</span></pre><p id="6583" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在熊猫身上，你可以用<code class="fe lu lv lw lx b">how = "left"</code>【2】。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="4520" class="oj nc it lx b gy ok ol l om on">df_merged = df1.merge(df2, <br/>                      on = "zoo_id", <br/>                      how = <strong class="lx iu">"left"</strong>,<br/>                      indicator = True)</span></pre><p id="c64d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下图中，您可以再次看到完全外部连接所描述的匹配。然而，左外连接只考虑绿点和蓝点，如上图所示。右侧数据框中不匹配的值(完全外部连接中的黄点)将被排除。</p><blockquote class="ly"><p id="4a82" class="lz ma it bd mb mc md me mf mg mh lt dk translated">假设您想要计算每个动物园有多少只熊猫。</p></blockquote><figure class="oo op oq or os kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8bff5da7b2763ec8e59f79335f2cffd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sAbG9T8nsnuWoxZ1_WDF3Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DataFrame与“左”合并(图片由作者提供)</p></figure><p id="a0b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为健全性检查，合并数据帧的预期长度应<strong class="la iu">长于或等于左侧数据帧的长度。</strong>合并的数据帧<code class="fe lu lv lw lx b">df_merged</code>总共有5行:如列<code class="fe lu lv lw lx b">_merge</code>所示，两边各4行，左边1行。</p><h1 id="6dee" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">右外部联接(熊猫:“右”)</h1><p id="3695" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">最后，假设您想知道每只熊猫生活在哪个动物园。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/165184f12305e62185e45b13d5dbc6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GfGRqe4rsQHwaNv4_wanBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">右外部连接(图片由作者提供)</p></figure><p id="b563" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，您可以在SQL speak [1]中使用右外连接。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="4620" class="oj nc it lx b gy ok ol l om on">SELECT *<br/>FROM df1<br/><strong class="lx iu">RIGHT OUTER JOIN</strong> df2<br/>  ON df1.zoo_id = df2.zoo_id;</span></pre><p id="7a42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在熊猫身上，你可以用<code class="fe lu lv lw lx b">how = "right"</code>【2】。</p><pre class="kj kk kl km gt of lx og oh aw oi bi"><span id="46ab" class="oj nc it lx b gy ok ol l om on">df_merged = df1.merge(df2, <br/>                      on = "zoo_id", <br/>                      how = <strong class="lx iu">"right"</strong>,<br/>                      indicator = True)</span></pre><p id="e61b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下图中，您可以再次看到完全外部连接所描述的匹配。然而，一个右外连接只考虑绿色和黄色的点，如上面的panda Venn图所示。左侧数据框中不匹配的值(完全外部连接中的蓝点)将被排除。</p><blockquote class="ly"><p id="72ca" class="lz ma it bd mb mc md me mf mg mh lt dk translated">假设您想知道每只熊猫生活在哪个动物园。</p></blockquote><figure class="oo op oq or os kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ee37bb05128f7c2f006ee4cc34850dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUUlNjuBQKhIBEC84hALzw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DataFrame与“右”合并(图片由作者提供)</p></figure><p id="5e67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为健全性检查，合并的数据帧的预期长度应该比右数据帧的长度长或等于右数据帧的长度<strong class="la iu">。</strong>合并后的数据帧<code class="fe lu lv lw lx b">df_merged</code>总共有六行:如<code class="fe lu lv lw lx b">_merge</code>列所示，四行来自两边，两行仅来自右边。</p><h1 id="a395" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">结论</h1><p id="b3d9" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">这篇文章(字面上)演示了如何用<code class="fe lu lv lw lx b">.merge()</code>方法合并两个熊猫数据帧。也就是说，我们研究了如何在pandas中执行最常见的SQL连接类型:全外部连接、内部连接、左外部连接和右外部连接。</p><p id="31bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面你可以找到这篇文章的直观摘要:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/4d5782d37875802bbf59287cf94bef18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vq8e0dAr0Xsfw0bJRz4FRg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如何合并熊猫数据帧的备忘单(图片由作者提供)</p></figure></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h1 id="43bd" class="nb nc it bd nd ne ou ng nh ni ov nk nl jz ow ka nn kc ox kd np kf oy kg nr ns bi translated">喜欢这个故事吗？</h1><p id="3ba6" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">要阅读更多来自我和其他作家的故事，请在Medium上注册。报名时可以用我的 <a class="ae pa" href="https://medium.com/@iamleonie/membership" rel="noopener"> <em class="oz">推荐链接</em> </a> <em class="oz">支持我。我将收取佣金，不需要你额外付费。</em></p><div class="pb pc gp gr pd pe"><a href="https://medium.com/@iamleonie/membership" rel="noopener follow" target="_blank"><div class="pf ab fo"><div class="pg ab ph cl cj pi"><h2 class="bd iu gy z fp pj fr fs pk fu fw is bi translated">通过我的推荐链接加入Medium—Leonie Monigatti</h2><div class="pl l"><h3 class="bd b gy z fp pj fr fs pk fu fw dk translated">阅读Leonie Monigatti(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接…</h3></div><div class="pm l"><p class="bd b dl z fp pj fr fs pk fu fw dk translated">medium.com</p></div></div><div class="pn l"><div class="po l pp pq pr pn ps ks pe"/></div></div></a></div><p id="ae10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="oz">在</em><a class="ae pa" href="https://www.linkedin.com/in/804250ab/" rel="noopener ugc nofollow" target="_blank"><em class="oz">LinkedIn</em></a><em class="oz">和</em> <a class="ae pa" href="https://www.kaggle.com/iamleonie" rel="noopener ugc nofollow" target="_blank"> <em class="oz">上找我Kaggle </em> </a> <em class="oz">！</em></p><h1 id="cdc3" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">参考</h1><p id="9dd8" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated">[1]“熊猫1.4.2文档”，“与SQL的比较。”pandas.pydata.org。<a class="ae pa" href="https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_sql.html#join" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/docs/getting _ started/comparison/comparison _ with _ SQL . html # join</a>(2022年7月13日访问)</p><p id="0b45" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[2]“pandas 1 . 4 . 2文档”，“pandas . data frame . merge .”pandas.pydata.org。<a class="ae pa" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html</a>(2022年7月13日访问)</p></div></div>    
</body>
</html>