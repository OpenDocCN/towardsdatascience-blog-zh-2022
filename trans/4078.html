<html>
<head>
<title>Open Domain Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开放领域分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/open-domain-classification-1a10a8dd0431#2022-09-09">https://towardsdatascience.com/open-domain-classification-1a10a8dd0431#2022-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7e4a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">开放域中的聊天机器人</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a385636a12b769cb0661225aea9e7fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CpxBTDD2_jXJk_Bj"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@sarahleejs?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">李宗盛</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="156b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们设计聊天机器人时，我们意识到会有一些我们无法处理的查询。在相当长的一段时间里，我们的方法是对我们的分类器预测的意图置信度使用一个阈值。这个阈值是一个超参数，我们通过审查客户的真实反馈添加的。然而，我们仍然不断得到一些明确的域外 查询的假阳性结果。</p><p id="2bc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个糟糕的客户体验。我们对于聊天机器人的目标是善于处理那些聊天机器人应该处理的事情。但是，也要确保聊天机器人清楚地退出那些它不应该处理的查询。</p><p id="1219" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">聊天机器人对开放域查询表现不稳定有三个原因——</p><ol class=""><li id="6b29" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">设计聊天机器人时的封闭世界假设。</li><li id="d118" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">神经网络的过度自信。</li><li id="3da9" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">ReLU网络产生高可信度预测的倾向。</li></ol><p id="748a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将讨论这3个问题以及我们为聊天机器人实现开放域分类的策略。</p><h1 id="b49f" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">封闭世界假设</h1><p id="bc29" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated"><a class="ae kv" href="https://aclanthology.org/N16-1061.pdf" rel="noopener ugc nofollow" target="_blank">葛力飞和刘冰</a>的论文定义了封闭世界假设-</p><blockquote class="ne nf ng"><p id="8a60" class="kw kx ls ky b kz la jr lb lc ld ju le nh lg lh li ni lk ll lm nj lo lp lq lr ij bi translated">封闭世界假设，其关注于在训练时所有测试类都已知的假设下设计精确的分类器。</p></blockquote><p id="640c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大多数文本分类系统都是在封闭世界假设下运行的。对于许多应用程序来说，这种假设就足够了。如果我们想将电子邮件分为垃圾邮件或垃圾邮件，或者如果我们想将评论分为正面、中性或负面，封闭世界假设就足够了。</p><p id="2df4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，对于聊天机器人来说，封闭世界的假设并不现实。一个更现实的场景是在测试期间预期看不见的类(开放世界)。因此，聊天机器人的目标不仅仅是将聊天文本分类为多种意图之一，还包括拒绝不属于任何已知类别的文本。</p><p id="9c53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">典型的基于Softmax的多类分类系统不是为检测域外类而设计的。而且，正如我们将在接下来的部分中看到的，由于置信度分数的错误校准，置信度阈值化不是检测域外类别的最佳方式。</p><h1 id="9fc2" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">神经网络的过度自信</h1><p id="8ceb" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">基于神经网络的分类器在准确性上有所提高。但是精度的提高是以校准为代价的。神经网络的校准是输出置信度等于正确概率的概念。如果某个类的Softmax图层的输出置信度为0.8，并且我们有100个独立的预测，每个预测的得分为0.8，则我们预计其中20个预测是错误的。然而，现代深度神经网络(DNN)是错误校准的。如果在上面的例子中，分数来自DNN，超过20的预测将是错误的。</p><p id="5760" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">郭川等人在一篇论文中实证性地衡量了这种相对于旧模式(古典的和不那么深刻的)的变化。在论文中，他们表明，在浅层网络(LeNet)中，网络的准确性接近平均置信度得分。然而，在更深的网络(ResNet)中，平均置信度得分比准确度高得多。作者实证证明，更深层的网络是<strong class="ky ir"> <em class="ls">过度自信</em> </strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/da103b025bfc1351e914f8e08df48509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gBR7TNlBUOWuAOuzav-yfw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自<a class="ae kv" href="https://arxiv.org/pdf/1706.04599.pdf" rel="noopener ugc nofollow" target="_blank">郭川等人</a></p></figure><p id="dc36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然作者没有重复文本分类的实验，但我们可以说同样的现象是真实的。即使在文本分类器中，DNNs的精度增益也是以误校准为代价的。</p><p id="1c84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了检测域外查询，我们可以使用一个高的类阈值。但是由于阈值是一个超参数，知道它的值的唯一方法是在虚拟代理发布后获得真实的数据。因此，价值只能从负面的用户反馈中获得。第二个问题是，在我们的实践经验中，我们注意到每个班级的“过度自信”程度是不同的。因此，在理想情况下，我们将需要一个独立的超参数，用于我们在虚拟代理中支持的每个类。</p><h1 id="fa7a" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">ReLU网络产生高置信度的预测</h1><p id="7f2f" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">与该问题相关的最后一个问题是基于ReLU的神经网络中的固有问题。Matthias Hein等人在一篇数学密集的论文中讨论了这个问题。在该论文中，作者首先证明了基于ReLU的神经网络是连续分段仿射分类器。利用这一结果，他们随后证明，只要一些温和的条件为真，基于ReLU的网络将<strong class="ky ir"> <em class="ls">总是</em> </strong>预测假阳性。论文进一步证明了在输入空间中，误报不一定接近训练样本。事实上，它们证明，如果您尝试，您将总能找到一个与该类的训练示例 相距很远的示例<strong class="ky ir"> <em class="ls">，该示例将为该类提供高置信度预测。</em></strong></p><p id="47a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这最后一点证明了任何高阈值都不是排除域外类别的假阳性的充分条件。即使我们将阈值保持得足够高，也总会有远离训练样本的样本，这些样本将具有高置信度预测。</p><h1 id="c600" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">这个问题的解决方案</h1><p id="b2e7" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">我们已经确定，在封闭世界的假设下，基于ReLU的DNNs会产生错误的分类。由于基于ReLU的DNNs固有的过度自信，置信分数的阈值不是预测域外类别的可靠方式。多类分类的典型方法如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/4a9c78650b006735fbd8580f4a4f8746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e_jwB9fVv3acQM1exvEVxQ.png"/></div></div></figure><p id="5488" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用了舒磊等人在论文中提出的方法。al 解决虚拟代理中的误分类问题。这种方法很适合我们，因为我们既不需要额外的训练数据，也不需要改变我们使用分类器的方式。这种方法的示意图如下—</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/23fa047c0c490a24ab6a5084ab641ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTXD7TCO-jS4RGyvw9rdhQ.png"/></div></div></figure><p id="a38f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在此方法中，我们使用多个Sigmoid，而不是Softmax，从而获得多个概率得分，每个得分来自每个Sigmoid单元。这种配置允许我们创建一个简单的域外检测器—如果没有一个sigmoids高于阈值，我们就将输入文本声明为域外。然而，如果多个sigmoids的输出高于阈值，我们选择激活最高的类。</p><p id="4cbe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该架构通过最小化所有类的累积负对数似然性来训练。该论文使用了一种类似于异常检测的方法来进一步微调预测。作者引入了可变阈值，而不是使用固定的0.5(或替代值)作为阳性类别的阈值。外部参数α控制这个阈值。Alpha是偏离平均值的标准偏差数，仍可视为正类。欲知详情，请参阅参考文件。</p><h1 id="f7c8" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">结论</h1><p id="9375" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">聊天系统的用户可能没有意识到所设计系统的局限性。他们会有我们设计的聊天机器人无法解决的问题。在本文中，我们探讨了设计中的问题，并对聊天机器人进行了改进。在新的设计中，聊天机器人清楚地知道域外查询，并能优雅地响应这些查询。</p></div></div>    
</body>
</html>