<html>
<head>
<title>Why You Should Use Scikit-Learn Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么您应该使用Scikit-Learn管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-you-should-use-scikit-learn-pipelines-8754b4d1e375#2022-08-08">https://towardsdatascience.com/why-you-should-use-scikit-learn-pipelines-8754b4d1e375#2022-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6f2b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这个工具把你的代码带到了一个新的高度</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e184f98cfbdece81e738e0875995e00b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WtH7U3CoJR-_gNEZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约翰·金南德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a152" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在使用Scikit-learn包足够长的时间后，机器学习工作流可能会开始出现重复。任务通常需要对数据进行一系列转换，然后将处理后的数据拟合到估计器，估计器随后将进行预测。</p><p id="757f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于那些希望将他们的Scikit-learn专业知识提升到下一个级别的人，该模块提供了<code class="fe lv lw lx ly b">Pipeline</code>类，这是一个使用户能够以更加用户友好的方式执行这些转换的工具。</p><p id="b5cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们深入研究Scikit-learn管道做什么，以及为什么它们应该更多地用于机器学习项目。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="e7a0" class="mg mh it bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">为什么要使用管道？</h2><p id="b9bb" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">Scikit-learn pipeline是一个工具，它将工作流程的所有步骤连接在一起，以简化流程。</p><p id="600b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建管道的主要好处是提高了可读性。</p><p id="8d02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">管道能够通过一次调用执行一系列转换，允许用户用更少的代码获得结果。</p><p id="84c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们只需要一个<code class="fe lv lw lx ly b">fit</code>方法来将所有转换应用于数据，这比将<code class="fe lv lw lx ly b">fit</code>和<code class="fe lv lw lx ly b">transform</code>方法应用于每个预处理步骤的训练和测试数据要方便得多。</p><p id="c783" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，通过使用管道来链接过程中的所有转换，用户一眼就可以轻松理解工作流。有了这种安排，提前进行修改和发现任何潜在错误将变得更加容易。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="8e92" class="mg mh it bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">管道是强制性的吗？</h2><p id="46f1" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">此时，您可能会想:管道可能会提高可读性，但是我们不能通过使用适当的文档编写结构良好的代码来获得可读性吗？</p><p id="030a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答案当然是肯定的！</p><p id="ed57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Scikit-learn管道只是一个方便的工具，对于项目的成功并不重要。</p><p id="92ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当一个模块直接提供了一个可以让生活变得如此简单的工具，为什么要拒绝它呢？</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="99ae" class="mg mh it bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">个案研究</h2><p id="3fa6" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li nb lk ll lm nc lo lp lq nd ls lt lu im bi translated">Scikit-learn管道的效用可以通过用Python创建一个管道得到最好的演示。</p><p id="ac94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们正在建立一个使用玩具数据集预测乳腺癌的模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="db42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建模型的步骤包括:</p><ul class=""><li id="7601" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">使用最小最大缩放器缩放功能</li><li id="a17d" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">利用主成分分析降低维数</li><li id="723d" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">将数据拟合到随机森林分类器</li></ul><p id="c519" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们先在没有管道的情况下进行这个练习，然后再使用管道。然后，我们可以在过程和模型性能方面比较这两种方法。</p><p id="a7d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要导入以下包:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><ol class=""><li id="4e55" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nu nm nn no bi translated"><strong class="lb iu">在没有管道的情况下训练模型<em class="nv"/></strong></li></ol><p id="8a76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个没有管道的评估器非常简单。对于每个预处理步骤，我们对训练数据使用<code class="fe lv lw lx ly b">fit_transform</code>方法，对测试数据使用<code class="fe lv lw lx ly b">transform</code>方法。然后，我们将处理后的数据与随机森林分类器相匹配，并用它进行预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="3585" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然已经训练了随机森林分类器，让我们使用f-1得分度量来评估它在测试集上的性能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/2d2a5cebd517f9421a28e445dc9b9ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*QEpesM9ILIMnD-3ZNl71fA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="300d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是训练分类器的可行方法。然而，由于一些原因，从长远来看，它可能并不理想。</p><p id="8bf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，随着编写更多的代码来促进转换，出错的几率会增加。例如，可能会意外地将<code class="fe lv lw lx ly b">fit_transform</code>方法应用于测试数据，或者以错误的顺序执行转换(例如，在特征缩放之前执行PCA)。</p><p id="4a4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，这种方法产生的代码在可读性方面不是最理想的。当您执行工作流的每一步时，代码可能看起来很直观，但是当您在几个月后重新访问您的工作时，它会保持这种方式吗？对阅读你的代码的其他人来说是直观的吗？</p><p id="14ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。用 a管道</strong>训练模型<em class="nv"/></p><p id="859a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次，我们将使用管道将过程中的所有步骤连接在一起。</p><p id="e0eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着创建一个管道对象，并在<code class="fe lv lw lx ly b">steps</code>参数中指定所有的转换。输入的参数是一个元组列表，每个元组代表一个转换。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="458f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有多简单？</p><p id="4759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过最少的代码，我们能够执行所有的转换，训练模型，并使用模型生成预测。</p><p id="c7b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只需要使用一次<code class="fe lv lw lx ly b">fit</code>方法来执行流水线中的所有步骤，而不是应用大量的<code class="fe lv lw lx ly b">fit</code>和<code class="fe lv lw lx ly b">transform</code>方法。</p><p id="eff7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们现在可以清楚地检查在训练模型之前将应用于数据的一系列转换。这使得代码更容易理解，更不容易出错。</p><p id="37ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">管道对象现在可以像任何估计器一样用于生成预测。让我们看看它在测试集上的表现。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/f30bbce2f2f54cc47c45073b4068d21d.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*CbNgw6Buv9TCOg4v4XMydw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="6759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">f-1分数保持不变，这并不奇怪，因为管道只是方便的工具，并不能提高模型性能。然而，如果我们比较两种方法中使用的代码，很容易看出Scikit-learn管道的吸引力。</p><p id="b5ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3。额外收获:用管道优化模型</strong></p><p id="9f1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经展示了Scikit-learn管道如何通过使用户能够用最少的代码训练模型来增强可读性。</p><p id="2cd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，管道还有一个值得一提的特性。</p><p id="9566" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了用更简洁的代码顺序执行转换之外，pipeline对象还可以通过超参数调整来优化模型性能！</p><p id="067f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，超参数调整用于单独为估计量寻找最佳超参数集。然而，通过管道，用户也可以优化特征工程过程！</p><p id="209c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了实现这一点，我们需要创建存储工作流中所有步骤的管道对象以及存储所有感兴趣的超参数的字典。</p><p id="058f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该字典包含超参数及其对应的值列表，作为键-值对。该字典中的关键字必须以<transformer> __ <hyperparameter>格式指定转换器/估算器和超参数。</hyperparameter></transformer></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="34d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在创建了管道对象和超参数字典之后，我们可以使用网格搜索来执行超参数调整。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="bb17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以用最佳超参数导出模型，并使用它来生成预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/7cef1f0616363efeebcc75ea08f1beaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*8hZFSR8d0Hxbd1HuyIycmw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码输出(由作者创建)</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="f921" class="mg mh it bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">结论</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/092dfc2af84120c56bf917f2811ab77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hqAkKEVmiX-3i01v"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/es/@prateekkatyal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>拍摄的照片</p></figure><p id="b9a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总而言之，Scikit-learn管道作为一种手段，以更简洁的方式将机器学习任务中的所有步骤链接在一起。</p><p id="0269" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们可能不会提高模型性能，但它们简化机器学习工作流程的能力使它们变得非常有价值。</p><p id="4811" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我祝你在数据科学的努力中好运！</p></div></div>    
</body>
</html>