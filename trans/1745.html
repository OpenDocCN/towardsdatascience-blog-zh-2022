<html>
<head>
<title>DAGs and Control Variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Dag和控制变量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/controls-b63dc69e3d8c#2022-04-25">https://towardsdatascience.com/controls-b63dc69e3d8c#2022-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="3114" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/causal-data-science" rel="noopener" target="_blank">因果数据科学</a></h2><div class=""/><div class=""><h2 id="80ae" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">如何使用有向无环图选择因果推理的控制变量</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4ebb1d734422a4c4775666c4a1c40d06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KGkIs38ZzIjnI8Ag1q0ZBQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">所有图片由作者提供，由<a class="ae le" href="https://mermaid-js.github.io/" rel="noopener ugc nofollow" target="_blank">美人鱼-js </a>生成</p></figure><p id="a3a6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在分析因果关系时，很难理解哪些变量是<strong class="lh ja">在</strong>进行分析的条件，即如何“分割”数据，以便我们在<strong class="lh ja">比较苹果和苹果</strong>。例如，如果你想了解拥有一台平板电脑对学生成绩的影响，比较学生社会经济背景相似的学校是有意义的。否则，风险在于只有更富裕的学生才能买得起平板电脑，如果不加以控制，我们可能会将这种影响归因于平板电脑，而不是社会经济背景。</p><p id="373c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">当感兴趣的治疗来自适当的随机实验时，我们不需要担心其他变量的条件作用。如果平板电脑在学校之间随机分配，并且我们在实验中有足够多的学校，我们就不必担心学生的社会经济背景。以一些所谓的“控制变量”为条件进行分析的唯一好处可能是功率的增加。然而，这是一个不同的故事。</p><p id="3f88" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这篇文章中，我们将简要介绍有向无环图，以及它们如何有助于选择变量来进行因果分析。Dag不仅为我们在分析中需要<em class="mb">包括</em>哪些变量提供了直观的视觉感受，还提供了我们不应该<em class="mb">包括</em>哪些变量以及为什么。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="eeeb" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">有向无环图</h1><h2 id="2cfc" class="nb mk iq bd ml nc nd dn mp ne nf dp mt lo ng nh mv ls ni nj mx lw nk nl mz iw bi translated">定义</h2><p id="88f0" class="pw-post-body-paragraph lf lg iq lh b li nm ka lk ll nn kd ln lo no lq lr ls np lu lv lw nq ly lz ma ij bi translated"><strong class="lh ja">有向无环图</strong> ( <strong class="lh ja"> DAG </strong> s)提供了数据生成过程的可视化表示。随机变量用字母表示(如<strong class="lh ja"> <em class="mb"> X </em> </strong>)，因果关系用箭头表示(如→)。例如，我们解读</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/bdc307497ebc082cc9084326363c5b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ghrvvna6Z-n-4sTQgXk1w.png"/></div></div></figure><p id="252b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">作为<strong class="lh ja"> <em class="mb"> X </em> </strong>(可能)原因<strong class="lh ja"> <em class="mb"> Y </em> </strong>。我们称一条<strong class="lh ja">路径为</strong>两个变量<strong class="lh ja"><em class="mb"/></strong>和<strong class="lh ja"><em class="mb"/></strong><em class="mb">之间的任意连接，独立于箭头</em>的方向。如果所有的箭头都指向前方，我们称之为<strong class="lh ja">因果路径</strong>，否则我们称之为<strong class="lh ja">寄生路径</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/b5c5f46be24ae23d597bacdebf937b6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bEv8LfGk2M7y7BkO3N4gNA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="84c6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在上面的例子中，我们在<strong class="lh ja"> <em class="mb"> X </em> </strong>和<strong class="lh ja"> <em class="mb"> Y </em> </strong>之间有一条路径，通过变量<strong class="lh ja"><em class="mb">【z₁】</em></strong>、<strong class="lh ja"><em class="mb">【z₂】</em></strong>和<strong class="lh ja"><em class="mb">【z₃】</em></strong>。既然不是所有的箭头都指向前方，那么路径就是<em class="mb">乱真</em>和<strong class="lh ja"> <em class="mb"> X </em> </strong>对<strong class="lh ja"> <em class="mb"> Y </em> </strong>没有因果关系。实际上，变量<strong class="lh ja"><em class="mb">【z₂】</em></strong>是由<strong class="lh ja"><em class="mb"/></strong>和<strong class="lh ja"><em class="mb">【z₃】</em></strong>共同造成的，因此<strong class="lh ja">阻断了</strong>路径。</p><p id="042e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="mb"> Z₂ </em> </strong>被称为<strong class="lh ja">对撞机</strong>。</p><p id="ea8a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们分析的目的是评估两个变量<strong class="lh ja"> <em class="mb"> X </em> </strong>和<strong class="lh ja"> <em class="mb"> Y </em> </strong>之间的<strong class="lh ja">因果关系。有向无环图是有用的，因为它们为我们提供了关于哪些其他变量<strong class="lh ja"> <em class="mb"> Z </em> </strong>的指示，我们需要在这些变量上<strong class="lh ja">条件</strong>我们的分析。以一个变量为分析条件意味着我们保持它不变，并得出我们的结论<em class="mb">其他条件不变</em>。例如，在线性回归框架中，插入另一个回归变量<strong class="lh ja"> <em class="mb"> Z </em> </strong>意味着我们在给定<strong class="lh ja"><em class="mb"/></strong><em class="mb">X</em></strong><em class="mb">条件</em>Z<em class="mb"/>的观测值上，计算<strong class="lh ja"> <em class="mb"> Y </em> </strong>的条件期望函数的最佳线性逼近。</p><h2 id="10c8" class="nb mk iq bd ml nc nd dn mp ne nf dp mt lo ng nh mv ls ni nj mx lw nk nl mz iw bi translated">因果关系</h2><p id="e7eb" class="pw-post-body-paragraph lf lg iq lh b li nm ka lk ll nn kd ln lo no lq lr ls np lu lv lw nq ly lz ma ij bi translated">为了评估因果关系，我们要<strong class="lh ja">关闭<strong class="lh ja"> <em class="mb"> X </em> </strong>和<strong class="lh ja"> <em class="mb"> Y </em> </strong>之间的所有伪路径</strong>。现在的问题是:</p><ul class=""><li id="77d6" class="nt nu iq lh b li lj ll lm lo nv ls nw lw nx ma ny nz oa ob bi translated">一个路径<strong class="lh ja">什么时候打开</strong>？如果不包含<em class="mb">对撞机。</em>否则为<em class="mb">关闭</em>。</li><li id="548d" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma ny nz oa ob bi translated">如何<strong class="lh ja">关闭一个打开的路径</strong>？您在<em class="mb">上设定至少一个</em>中间变量。</li><li id="cf79" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma ny nz oa ob bi translated">你如何<strong class="lh ja">打开一个封闭的路径</strong>？你的条件是<em class="mb">沿途所有的</em>碰撞器。</li></ul><p id="e5c1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">假设我们再次对<strong class="lh ja"> <em class="mb"> X </em> </strong>对<strong class="lh ja"> <em class="mb"> Y </em> </strong>的因果关系感兴趣。让我们考虑下图:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/0c5d6ba9d715a2028d11ac2f55a8cd51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2ReLlxgIBpHz7a2LDEVLg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="0f38" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这种情况下，除了直接路径之外，通过变量<strong class="lh ja"><em class="mb">【z₁】</em></strong><strong class="lh ja"><em class="mb">【z₂】</em></strong>和<strong class="lh ja"> <em class="mb"> Z₃ </em> </strong>，在<strong class="lh ja"> <em class="mb"> X </em> </strong>和<strong class="lh ja"> <em class="mb"> Y </em> </strong>之间还有<strong class="lh ja">三条非直接路径</strong>。</p><p id="4cb8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们考虑这样的情况，我们分析<strong class="lh ja"> <em class="mb"> X </em> </strong>和<strong class="lh ja"> <em class="mb"> Y </em> </strong>之间的关系，忽略所有其他变量。</p><ol class=""><li id="c1c8" class="nt nu iq lh b li lj ll lm lo nv ls nw lw nx ma oi nz oa ob bi translated">通过<strong class="lh ja"> <em class="mb"> Z₁ </em> </strong>的路径是<strong class="lh ja">开放的</strong>但是它是<strong class="lh ja">虚假的</strong></li><li id="e69f" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma oi nz oa ob bi translated">通过<strong class="lh ja">t39】z₂t41】的路径是<strong class="lh ja">开</strong>和<strong class="lh ja">因果</strong></strong></li><li id="ed3d" class="nt nu iq lh b li oc ll od lo oe ls of lw og ma oi nz oa ob bi translated">通过<strong class="lh ja"> <em class="mb"> Z₃ </em> </strong>的路径是<strong class="lh ja">闭合的</strong>既然<strong class="lh ja"> <em class="mb"> Z₃ </em> </strong>是<em class="mb">碰撞器</em>而且是<strong class="lh ja">乱真的</strong></li></ol><p id="ee6e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们画同样的图，用灰色的<em class="mb">变量表示我们正在调节的变量，用<em class="mb">虚线表示</em>闭合路径，用<em class="mb">红线表示</em>虚假开路，用<em class="mb">绿线表示</em>因果开路。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oj"><img src="../Images/6e0816496e543e2f188e282158093cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-atX19aYLlKDrSleJNjsQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="a119" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这种情况下，要评估<strong class="lh ja"><em class="mb"/></strong>和<strong class="lh ja"><em class="mb"/></strong>之间的<strong class="lh ja">因果关系，我们需要通过<strong class="lh ja">关闭</strong><strong class="lh ja"><em class="mb">【z₁】</em></strong>的路径。我们可以通过对Z₁的<strong class="lh ja"><em class="mb"/></strong>进行条件分析来做到这一点。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/7bafe186c6aaccc41a67d3271d41acb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7hlfbMBOIpYo3fwmjvUEA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="3a85" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们能够通过对<strong class="lh ja"><em class="mb">【z₁】</em></strong>的条件作用来恢复<strong class="lh ja"/>x与<strong class="lh ja"><em class="mb"/></strong>y之间的因果关系。</p><p id="ac97" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果我们也在<strong class="lh ja">调节<em class="mb"> Z₂ </em>和</strong>会发生什么？在这种情况下，我们将<strong class="lh ja">关闭</strong>通过<strong class="lh ja"><em class="mb"/></strong>的路径，只留下<strong class="lh ja"> <em class="mb"> X </em> </strong>和<strong class="lh ja"> <em class="mb"> Y </em> </strong>之间的<em class="mb">直接</em>路径打开。然后我们将只恢复<strong class="lh ja"> <em class="mb"> X </em> </strong>对<strong class="lh ja"> <em class="mb"> Y </em> </strong>的<strong class="lh ja">直接效果</strong>，而不是<em class="mb">间接</em>效果。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ol"><img src="../Images/d9fe5efbdaa48491dd59b36dbc5f9f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qVRqsbyaD4-S4NkIyGhN5Q.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="5f77" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果我们也在<strong class="lh ja">条件作用于<em class="mb"> Z₃ </em> </strong>会发生什么？在这种情况下，我们将<strong class="lh ja">打开</strong>通过<strong class="lh ja"> <em class="mb"> Z₃ </em> </strong>的路径，这是一条<strong class="lh ja">虚假</strong>路径。然后我们将<strong class="lh ja">而不是</strong>能够恢复<strong class="lh ja"> <em class="mb"> X </em> </strong>对<strong class="lh ja"> <em class="mb"> Y </em> </strong>的因果关系。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi om"><img src="../Images/bbfb996572ffd98b3250b356da66e123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MFKH3QKQYrpk5QUWVadyIg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="1a60" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">例如:班级人数和数学成绩</h1><p id="512c" class="pw-post-body-paragraph lf lg iq lh b li nm ka lk ll nn kd ln lo no lq lr ls np lu lv lw nq ly lz ma ij bi translated">假设你对班级规模对数学成绩的影响感兴趣。大班对学生的表现是好是坏？</p><p id="5ecf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">假设数据生成过程可以用下面的<strong class="lh ja"> DAG </strong>来表示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi on"><img src="../Images/b3f59256937b85af2afb3805e15304fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yPK7xjCoTcWZ07jl9jnzyA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="3a1e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">感兴趣的变量被突出显示。而且，<code class="fe oo op oq or b">ability</code>周围的虚线表示这是一个我们在数据中没有观察到的变量。</p><p id="ec05" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们现在可以加载数据并检查它看起来像什么。数据是模拟的，你可以在这里找到原始数据生成过程<a class="ae le" href="https://github.com/matteocourthoud/Blog-Posts/blob/main/notebooks/src/dgp.py" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kp kq kr ks gt os or ot ou aw ov bi"><span id="23aa" class="nb mk iq or b gy ow ox l oy oz">from src.dgp import dgp_school</span><span id="3add" class="nb mk iq or b gy pa ox l oy oz">df = dgp_school().generate_data()<br/>df.head()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="ab gu cl pb"><img src="../Images/84eafec9050047bce3a0ff562926b2fc.png" data-original-src="https://miro.medium.com/v2/format:webp/1*zrqsU5CiQaI98JG_fGUHUg.png"/></div></figure><p id="ebaa" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了估计<code class="fe oo op oq or b">class size</code>对<code class="fe oo op oq or b">math scores</code>的因果影响，我们应该以哪些变量作为回归的条件？</p><p id="79ef" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，让我们看看，如果我们不以任何变量为条件进行分析，而只是对<code class="fe oo op oq or b">class size</code>进行<code class="fe oo op oq or b">math score</code>回归，会发生什么。我们使用<a class="ae le" href="https://www.statsmodels.org/" rel="noopener ugc nofollow" target="_blank"> statsmodels </a>软件包进行统计分析。</p><pre class="kp kq kr ks gt os or ot ou aw ov bi"><span id="2ab7" class="nb mk iq or b gy ow ox l oy oz">import statsmodels.formula.api as smf</span><span id="e70e" class="nb mk iq or b gy pa ox l oy oz">smf.ols('math_score ~ class_size', df).fit().summary().tables[1]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pc"><img src="../Images/06a59ab5978eeb856beb372528fb894d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RrK8aZyUqUVA-tLpxRHOA.png"/></div></div></figure><p id="c14a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在表格的第二行，我们可以看到<strong class="lh ja">估计的感兴趣系数</strong>(<code class="fe oo op oq or b">class size)</code>的<code class="fe oo op oq or b">coef</code>及其估计的标准误差(<code class="fe oo op oq or b">std err</code>)。<code class="fe oo op oq or b">class_size</code>的影响是负的，在统计上不同于零(具有非常低的p值，<code class="fe oo op oq or b">P&gt;|t|=0.003</code>)。</p><p id="756c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是我们应该相信这个估计的效果吗？没有任何控制，这是我们正在捕捉的效果的<strong class="lh ja"> DAG表示。</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pd"><img src="../Images/053e25cfa5686df1456b101fd6f0655c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MhWx0w-D3rfrEq2JvO5t1A.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="09e8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">有一个通过<code class="fe oo op oq or b">good school</code>的<strong class="lh ja">寄生</strong>路径，该路径使<strong class="lh ja">偏向</strong>我们估计的系数。直觉上，被更好的学校录取会提高学生的数学成绩，更好的学校可能会有更小的班级规模。我们需要控制学校的质量。</p><pre class="kp kq kr ks gt os or ot ou aw ov bi"><span id="7b03" class="nb mk iq or b gy ow ox l oy oz">smf.ols('math_score ~ class_size + good_school', df).fit().summary().tables[1]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pe"><img src="../Images/0c9e60eef74a275c354fc70e83809bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oSqjG4K9Zj82ZCXyJiY9GA.png"/></div></div></figure><p id="5eef" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在估计<code class="fe oo op oq or b">class size</code>对<code class="fe oo op oq or b">math score</code>的影响是<strong class="lh ja">无偏</strong>！的确，数据生成过程中的真实系数是<em class="mb"> 0.2 </em>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/8cd1550fb035f67e460b61c788f4c4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLrn75r1LpcUym-fbcUiBA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="cb52" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果我们用<strong class="lh ja">控制所有变量</strong>会发生什么？</p><pre class="kp kq kr ks gt os or ot ou aw ov bi"><span id="0005" class="nb mk iq or b gy ow ox l oy oz">smf.ols('math_score ~ class_size + good_school + math_hours + class_year + hist_score', df).fit().summary().tables[1]</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pg"><img src="../Images/f18ef9b494ecea14c5b1c805f670fa1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cnot1vpxJteUx2azYmBgnA.png"/></div></div></figure><p id="dec4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">系数再次被<strong class="lh ja">偏置</strong>。为什么？</p><p id="84b7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们通过控制<code class="fe oo op oq or b">hist score</code>打开了一条新的伪路径。事实上，<code class="fe oo op oq or b">hist score</code>是一个<strong class="lh ja">对撞机</strong>，对它的控制打开了一条通过<code class="fe oo op oq or b">hist score</code>和<code class="fe oo op oq or b">ability</code>的路径，否则这条路径是关闭的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ph"><img src="../Images/966b46cac3c107aaad99b828ac2b2203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oSueTvUH14Rg0VEd4Rhezg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="12eb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这个例子的灵感来自下面的推文。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="pi pj l"/></div></figure></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="80fc" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">结论</h1><p id="6eeb" class="pw-post-body-paragraph lf lg iq lh b li nm ka lk ll nn kd ln lo no lq lr ls np lu lv lw nq ly lz ma ij bi translated">在这篇文章中，我们看到了如何使用有向无环图来选择因果分析中的控制变量。Dag是非常有用的工具，因为它们提供了随机变量之间因果关系的直观图形表示。与“信息越多越好”的普遍直觉相反，有时包括额外的变量可能会使分析产生偏差，妨碍对结果的因果解释。特别是，我们必须注意不要包括打开原本会关闭的虚假路径的碰撞器。</p><h2 id="a37a" class="nb mk iq bd ml nc nd dn mp ne nf dp mt lo ng nh mv ls ni nj mx lw nk nl mz iw bi translated">参考</h2><p id="7004" class="pw-post-body-paragraph lf lg iq lh b li nm ka lk ll nn kd ln lo no lq lr ls np lu lv lw nq ly lz ma ij bi translated">[1] C .西内利，A .福尼，j .珀尔，<a class="ae le" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3689437" rel="noopener ugc nofollow" target="_blank">好与坏控制的速成班</a> (2018)，<em class="mb">工作论文</em>。</p><p id="5437" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[2] J. Pearl，<a class="ae le" href="http://bayes.cs.ucla.edu/BOOK-2K/" rel="noopener ugc nofollow" target="_blank">因果关系</a> (2009)，<em class="mb">剑桥大学出版社</em>。</p><p id="34b6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[3] S .坎宁安，《因果推论》第三章<a class="ae le" href="https://mixtape.scunning.com/dag.html" rel="noopener ugc nofollow" target="_blank"/>(2021)，耶鲁大学出版社<em class="mb"/>。</p><h2 id="6bc9" class="nb mk iq bd ml nc nd dn mp ne nf dp mt lo ng nh mv ls ni nj mx lw nk nl mz iw bi translated">密码</h2><p id="a7af" class="pw-post-body-paragraph lf lg iq lh b li nm ka lk ll nn kd ln lo no lq lr ls np lu lv lw nq ly lz ma ij bi translated">你可以在这里找到Jupyter的原始笔记本:</p><div class="pk pl gp gr pm pn"><a href="https://github.com/matteocourthoud/Blog-Posts/blob/main/notebooks/controls.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd ja gy z fp ps fr fs pt fu fw iz bi translated">main matter上的Blog-Posts/controls . ipynb courthoud/Blog-Posts</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">我博客文章的代码和笔记本。通过在…上创建帐户，为matteocourthoud/Blog-Posts的发展做出贡献</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">github.com</p></div></div><div class="pw l"><div class="px l py pz qa pw qb ky pn"/></div></div></a></div></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h2 id="d038" class="nb mk iq bd ml nc nd dn mp ne nf dp mt lo ng nh mv ls ni nj mx lw nk nl mz iw bi translated">感谢您的阅读！</h2><p id="a168" class="pw-post-body-paragraph lf lg iq lh b li nm ka lk ll nn kd ln lo no lq lr ls np lu lv lw nq ly lz ma ij bi translated">真的很感谢！🤗<em class="mb">如果你喜欢这个帖子并且想看更多，可以考虑</em> <a class="ae le" href="https://medium.com/@matteo.courthoud" rel="noopener"> <strong class="lh ja"> <em class="mb">关注我</em> </strong> </a> <em class="mb">。我每周发布一次与因果推断和数据分析相关的主题。我尽量让我的帖子简单而精确，总是提供代码、例子和模拟。</em></p><p id="9638" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="mb">还有，一个小小的</em> <strong class="lh ja"> <em class="mb">免责声明</em> </strong> <em class="mb">:我写作是为了学习所以错误是家常便饭，尽管我尽力了。当你发现他们的时候，请告诉我。也很欣赏新话题的建议！</em></p></div></div>    
</body>
</html>