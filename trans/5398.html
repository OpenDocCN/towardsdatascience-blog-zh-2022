<html>
<head>
<title>Pandas Isn’t Enough. Learn These 25 Pandas to SQL Translations To Upgrade Your Data Analysis Game</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫还不够。学习这 25 个熊猫到 SQL 的翻译来升级你的数据分析游戏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-isnt-enough-learn-these-25-pandas-to-sql-translations-to-upgrade-your-data-analysis-game-af8d0c26948d#2022-12-05">https://towardsdatascience.com/pandas-isnt-enough-learn-these-25-pandas-to-sql-translations-to-upgrade-your-data-analysis-game-af8d0c26948d#2022-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3953" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">熊猫中常见的 25 种 SQL 查询及其对应方法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/694a7fa94cf1f1068a4e45c6b2b7a67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KPvGUt6NPDqfCsHi"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@jamesyarema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">詹姆斯·亚雷马</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><blockquote class="kw kx ky"><p id="fd7c" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这是我第 50 篇关于媒介的文章。非常感谢你阅读和欣赏我的作品<em class="iq">😊</em>！这绝对是一次收获颇丰的旅程。</p><p id="fdc9" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果你喜欢在 Medium 上阅读我的文章，我相信你也会喜欢这个:<a class="ae kv" href="https://avichawla.substack.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"/></a>【数据科学的每日剂量】。</p><p id="733c" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ir">这是什么？</strong>这是一份面向数据科学的出版物，我在 substack 上运营。</p><p id="2ce9" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ir">你会从中得到什么？</strong>在这里，我介绍了关于数据科学/Python/机器学习等的优雅而方便的技巧和诀窍。，一天一个提示(见出版档案<a class="ae kv" href="https://avichawla.substack.com/archive" rel="noopener ugc nofollow" target="_blank">此处</a>)。如果你感兴趣，你可以在你的收件箱里订阅每日剂量。而且完全免费。很想看到另一面！</p></blockquote></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="6e3c" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">动机</h1><p id="879c" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">SQL 和 Pandas 都是数据科学家处理数据的强大工具。</p><p id="4949" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">众所周知，SQL 是一种用于管理和操作数据库中数据的语言。另一方面，Pandas 是 Python 中的一个数据操作和分析库。</p><p id="cd96" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">此外，SQL 通常用于从数据库中提取数据，并为 Python 中的分析做准备，主要使用 Pandas，它提供了广泛的工具和函数来处理表格数据，包括数据操作、分析和可视化。</p><p id="0a7f" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">SQL 和 Pandas 一起可用于清理、转换和分析大型数据集，并创建复杂的数据管道和模型。因此，精通这两种框架对于数据科学家来说非常有价值。</p><p id="18ac" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">因此，在这篇博客中，我将提供一个快速指南，将最常见的 Pandas 操作翻译成它们的等效 SQL 查询。</p><p id="49f8" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">我们开始吧🚀！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="b1df" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">资料组</h1><p id="ad83" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">出于演示目的，我使用 Faker 创建了一个虚拟数据集:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/394d838d0756cebe048ec1b5706fe295.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/0*R72JMS_dcYpvXlwa.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随机员工数据集(图片由作者提供)</p></figure><h1 id="1960" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#1 读取 CSV 文件</h1><h2 id="83c4" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="f964" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">CSV 通常是读取熊猫数据帧最流行的文件格式。这是在熊猫身上用<code class="fe nv nw nx ny b">pd.read_csv()</code>方法完成的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="a701" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="6d24" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">要在数据库中创建表，第一步是创建一个空表并定义其模式。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oa l"/></div></figure><p id="72ff" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">下一步是将 CSV 文件的内容(如果第一行是标题，从第二行开始)转储到上面创建的表中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc oa l"/></div></figure><h2 id="4044" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">输出</h2><p id="37e8" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">创建数据帧/表后，我们得到以下输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/394d838d0756cebe048ec1b5706fe295.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/0*R72JMS_dcYpvXlwa.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">读取 CSV 后的输出(图片由作者提供)</p></figure><h1 id="8744" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#2 显示前 5(或 k)行</h1><h2 id="521a" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="254b" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">我们可以在熊猫身上使用<code class="fe nv nw nx ny b">df.head()</code>方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><h2 id="fcd9" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="223e" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">在 MySQL 语法中，我们可以在<code class="fe nv nw nx ny b">select</code> <em class="lb"> </em>后使用<code class="fe nv nw nx ny b">limit</code>，指定我们想要显示的记录数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oe oa l"/></div></figure><h1 id="239d" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#3 打印尺寸</h1><h2 id="cf5d" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="c767" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">DataFrame 对象的<code class="fe nv nw nx ny b">shape</code>属性打印行数和列数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of oa l"/></div></figure><h2 id="0b82" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="3ec3" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">我们可以使用 count 关键字来打印行数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oa l"/></div></figure><h1 id="e41c" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#4 打印数据类型</h1><h2 id="f1be" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="593f" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">您可以使用<code class="fe nv nw nx ny b">dtypes</code>参数打印所有列的数据类型:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oh oa l"/></div></figure><h2 id="c0cf" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="e4c9" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">在这里，您可以打印如下数据类型:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h1 id="7a89" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#5 修改列的数据类型</h1><h2 id="2c2c" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="fa83" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">这里，我们可以使用如下的<code class="fe nv nw nx ny b">astype()</code>方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oi oa l"/></div></figure><h2 id="0dc2" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="2303" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">使用<code class="fe nv nw nx ny b">ALTER COLUMN</code>改变列的数据类型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj oa l"/></div></figure><p id="c66d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">上述操作将永久修改表中列的数据类型。但是，如果您只是想在过滤时这样做，请使用<code class="fe nv nw nx ny b">cast</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ok oa l"/></div></figure><h1 id="7e1f" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated"># 6–11 过滤数据</h1><p id="5ae1" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">有各种方法来过滤熊猫的数据帧。</p><p id="ec9a" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><strong class="lc ir"> #6: </strong>您可以按如下方式过滤一列:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><p id="c11d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">上述内容可以转换为 SQL，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol oa l"/></div></figure><p id="c695" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><strong class="lc ir"> #7: </strong>此外，您还可以过滤多个列:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om oa l"/></div></figure><p id="dfe5" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">上述过滤的 SQL 等价物是:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oa l"/></div></figure><p id="8a8e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><strong class="lc ir"> #8: </strong>您还可以使用<code class="fe nv nw nx ny b">isin()</code>从值列表中进行筛选:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo oa l"/></div></figure><p id="36e5" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">为了模拟上述情况，我们在 SQL 中使用了<code class="fe nv nw nx ny b">in</code>关键字:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oa l"/></div></figure><p id="3871" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><strong class="lc ir"> #9: </strong>在 Pandas 中，您还可以使用点运算符选择特定的列。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oc oa l"/></div></figure><p id="c527" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">在 SQL 中，我们可以在<code class="fe nv nw nx ny b">select</code>之后指定所需的列。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oa l"/></div></figure><p id="bb3a" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><strong class="lc ir"> #10: </strong>如果您想在 Pandas 中选择多个列，您可以执行以下操作:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo oa l"/></div></figure><p id="d24e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">通过在 SQL 中的<code class="fe nv nw nx ny b">select</code>之后指定多个列也可以做到这一点。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oa l"/></div></figure><p id="8e5c" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">你也可以根据熊猫的 NaN 值进行过滤。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们没有 NaN 值，所以我们看不到行。</p></figure><p id="a971" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">这同样可以扩展到 SQL，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oq oa l"/></div></figure><p id="56a8" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">我们还可以执行一些复杂的基于模式的字符串过滤。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om oa l"/></div></figure><p id="d3b8" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">在 SQL 中，我们可以使用<code class="fe nv nw nx ny b">LIKE</code>子句。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oa l"/></div></figure><p id="5523" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">您也可以在字符串中搜索子字符串。例如，假设我们想要查找所有<code class="fe nv nw nx ny b">last_name</code>包含子字符串“an”的记录。</p><p id="cd9f" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">在熊猫身上，我们可以做到以下几点:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo oa l"/></div></figure><p id="0ff9" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">在 SQL 中，我们可以再次使用<code class="fe nv nw nx ny b">LIKE</code>子句。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="op oa l"/></div></figure><h1 id="3353" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated"># 14–16 排序数据</h1><p id="34f6" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">排序是数据科学家用来对数据进行排序的另一种典型操作。</p><h2 id="299c" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="2292" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">使用<code class="fe nv nw nx ny b">df.sort_values()</code>方法对数据帧进行排序。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="or oa l"/></div></figure><p id="07e5" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">您也可以按多列排序:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="or oa l"/></div></figure><p id="9327" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">最后，我们可以使用<code class="fe nv nw nx ny b">ascending</code>参数为不同的列指定不同的标准(升序/降序)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="or oa l"/></div></figure><p id="6f29" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">这里，<code class="fe nv nw nx ny b">ascending</code>对应的列表表示<code class="fe nv nw nx ny b">last_name</code>降序排列，<code class="fe nv nw nx ny b">level</code>升序排列。</p><h2 id="6a42" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="cf21" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">在 SQL 中，我们可以使用<code class="fe nv nw nx ny b">order by</code>子句来实现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os oa l"/></div></figure><p id="1361" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">此外，通过在<code class="fe nv nw nx ny b">order by</code>子句中指定更多的列，我们可以包含更多的列作为排序标准:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os oa l"/></div></figure><p id="42bd" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">我们可以为不同的列指定不同的排序顺序，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os oa l"/></div></figure><h1 id="89b1" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#17 填充 NaN 值</h1><blockquote class="kw kx ky"><p id="4592" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">对于这一个，我有意删除了 salary 列中的几个值。这是更新后的数据框架:</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><h2 id="92a2" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="ec3d" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">在 Pandas 中，我们可以使用<code class="fe nv nw nx ny b">fillna()</code>方法来填充 NaN 值:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><h2 id="f6a9" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="b243" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">然而，在 SQL 中，我们可以使用 case 语句来实现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot oa l"/></div></figure><h1 id="2366" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated"># 18–19 连接数据</h1><h2 id="46d8" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="d089" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">如果你想用一个连接键合并两个数据帧，使用<code class="fe nv nw nx ny b">pd.merge()</code>方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou oa l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="om oa l"/></div></figure><h2 id="0dc9" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on oa l"/></div></figure><p id="6cfa" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">连接数据集的另一种方法是将它们连接起来。</p><h2 id="887b" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="f834" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">考虑下面的数据框架:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ov oa l"/></div></figure><p id="e1a5" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">在 Pandas 中，您可以使用<code class="fe nv nw nx ny b">concat()</code>方法并传递 DataFrame 对象以连接成一个列表/元组。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ow oa l"/></div></figure><h2 id="5195" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="3f49" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">使用 SQL 中的<code class="fe nv nw nx ny b">UNION</code>(只保留唯一的行)和<code class="fe nv nw nx ny b">UNION ALL</code>(保留所有行)也可以达到同样的效果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ox oa l"/></div></figure><h1 id="05ae" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#20 分组数据</h1><h2 id="be71" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="1760" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">要对数据帧进行分组并执行聚合，请在 Pandas 中使用<code class="fe nv nw nx ny b">groupby()</code>方法，如下所示</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><h2 id="485d" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="6d0d" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">在 SQL 中，可以使用 group by 子句并在 select 子句中指定聚合。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oy oa l"/></div></figure><p id="119e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">我们确实看到了相同的输出！</p><h1 id="e160" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated"># 21–22 寻找独特的价值</h1><h2 id="3fa0" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="5431" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">要打印一列中的不同值，我们可以使用<code class="fe nv nw nx ny b">unique()</code>方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of oa l"/></div></figure><p id="47e5" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">要打印不同值的数量，使用<code class="fe nv nw nx ny b">nunique()</code>方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of oa l"/></div></figure><h2 id="4501" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="6823" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">在 SQL 中，我们可以如下使用<code class="fe nv nw nx ny b">select</code>中的<code class="fe nv nw nx ny b">DISTINCT</code>关键字:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oz oa l"/></div></figure><p id="5553" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">为了计算 SQL 中不同值的数量，我们可以将<code class="fe nv nw nx ny b">COUNT</code>聚合器包装在<code class="fe nv nw nx ny b">distinct</code>周围。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pa oa l"/></div></figure><h1 id="bfc6" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#23 重命名列</h1><h2 id="bee8" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="3adc" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">这里，使用<code class="fe nv nw nx ny b">df.rename()</code>方法，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><h2 id="6006" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="29c3" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">我们可以使用<code class="fe nv nw nx ny b">ALTER TABLE</code>来重命名一个列:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pb oa l"/></div></figure><h1 id="cc6a" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#24 删除列</h1><h2 id="8b35" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="0584" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">使用<code class="fe nv nw nx ny b">df.drop()</code>方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><h2 id="6cfd" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="2790" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">类似于重命名，我们可以使用<code class="fe nv nw nx ny b">ALTER TABLE</code>，将<code class="fe nv nw nx ny b">RENAME</code>改为<code class="fe nv nw nx ny b">DROP</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj oa l"/></div></figure><h1 id="954f" class="md me iq bd mf mg ne mi mj mk nf mm mn jw ng jx mp jz nh ka mr kc ni kd mt mu bi translated">#25 创建新列</h1><p id="8bb3" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">假设我们想要创建一个新列<code class="fe nv nw nx ny b">full_name</code>，它是列<code class="fe nv nw nx ny b">first_name</code>和<code class="fe nv nw nx ny b">last_name</code>的串联，中间有一个空格。</p><h2 id="1070" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">熊猫</h2><p id="9444" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">我们可以在 Pandas 中使用一个简单的赋值操作符。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="od oa l"/></div></figure><h2 id="ad2d" class="nj me iq bd mf nk nl dn mj nm nn dp mn mx no np mp mz nq nr mr nb ns nt mt nu bi translated">结构化查询语言</h2><p id="9942" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">在 SQL 中，第一步是添加新列:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pc oa l"/></div></figure><p id="1c0c" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">接下来，我们使用 SQL 中的<code class="fe nv nw nx ny b">SET</code>设置该值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pc oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">||在 Sqlite 中用作串联运算符。<a class="ae kv" href="https://www.sqlitetutorial.net/sqlite-string-functions/sqlite-concat/" rel="noopener ugc nofollow" target="_blank">延伸阅读</a>。</p></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="1a1b" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">结论</h1><p id="52bf" class="pw-post-body-paragraph kz la iq lc b ld mv jr lf lg mw ju li mx my ll lm mz na lp lq nb nc lt lu lv ij bi translated">恭喜你！您现在知道了 Pandas 中最常见方法的 SQL 翻译。</p><p id="be76" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">我试着翻译了科学家们经常在熊猫身上使用的大部分数据。然而，我知道我可能错过了一些。</p><p id="593c" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">请在回复中让我知道。</p><p id="b094" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated">一如既往的感谢阅读！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/df8a7f30559e5cee8f5f08d62b54103e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*Lw3yCMrhaDijsz6HiCmd8A.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者使用稳定扩散生成和编辑的图像。</p></figure></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="171e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><a class="ae kv" href="https://avichawla.substack.com/" rel="noopener ugc nofollow" target="_blank">🚀<strong class="lc ir">订阅数据科学每日剂量。在这里，我分享关于数据科学的优雅技巧和诀窍，一天一个技巧。每天在你的收件箱里收到这些提示。</strong>T12】</a></p><p id="f3ec" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><a class="ae kv" href="https://subscribepage.io/450q" rel="noopener ugc nofollow" target="_blank"> 🧑‍💻<strong class="lc ir">成为数据科学专家！获取包含 450 多个熊猫、NumPy 和 SQL 问题的免费数据科学掌握工具包。</strong> </a></p><p id="d8eb" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li mx lk ll lm mz lo lp lq nb ls lt lu lv ij bi translated"><a class="ae kv" href="https://alphasignal.ai/?referrer=Chawla" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir">获取机器学习领域排名前 1%的研究论文、新闻、开源回购、推文的每周汇总。</strong> </a></p></div></div>    
</body>
</html>