<html>
<head>
<title>CFA Paper Review: Coupled-hypersphere-based Feature Adaptation for Target-Oriented Anomaly Localization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CFA论文综述:基于耦合超球的特征适应用于面向目标的异常定位</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cfa-paper-review-coupled-hypersphere-based-feature-adaptation-for-target-oriented-anomaly-c3b46316266b#2022-10-05">https://towardsdatascience.com/cfa-paper-review-coupled-hypersphere-based-feature-adaptation-for-target-oriented-anomaly-c3b46316266b#2022-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="579f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一种新颖的异常定位方法，产生适应于目标数据集的特征并采用迁移学习</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6684733afcdb47afb4b2f15a955e97af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E9QRuKfezF5o1iRd"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">妮可·阿瓦里亚诺在<a class="ae kv" href="https://unsplash.com/photos/TeLjs2pL5fA" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="85ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文是故事【T4论文综述:通过修复进行视觉异常检测的重建和<a class="ae kv" href="https://medium.com/towards-data-science/ganomaly-paper-review-semi-supervised-anomaly-detection-via-adversarial-training-a6f7a64a265f" rel="noopener"> GANomaly论文综述:通过对抗训练进行半监督异常检测</a>的延续。在之前的文章中，我介绍了基于重建的方法来识别图像中的异常。诸如自动编码器和生成对抗网络的模型可以用于检测图像中的异常。它们是如何工作的？</p><p id="28e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它们在训练期间只编码和重建正常图像。在评估中，假设这些模型不应该很好地重建异常图像，因为它们在训练期间没有被馈送，然后，缺陷图像应该比无缺陷图像具有更高的异常分数。然而，这项任务对于复杂的数据集来说是具有挑战性的，并且有时这些类型的方法可以对异常图像产生良好的重建结果，从而导致无法区分异常图像和正常图像。</p><p id="de9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出于这个原因，我研究了其他类型的异常检测方法，并发现了一种新的方法，称为<strong class="ky ir">基于耦合超球的特征适应</strong> (CFA)。这种方法背后有两个主要思想:</p><ul class=""><li id="2005" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">它利用预先训练好的CNN来提取斑块的特征</li><li id="7368" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">它采用迁移学习来使特征适应目标数据集，因此，异常特征可以与正常特征清楚地区分。</li></ul><p id="b690" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将回顾介绍这种新颖的异常检测模型的文章。</p><h2 id="802e" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">概述</h2><ol class=""><li id="4c68" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr ne ly lz ma bi translated"><a class="ae kv" href="#dec9" rel="noopener ugc nofollow"> <strong class="ky ir">要求</strong> </a></li><li id="79f3" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="#edf8" rel="noopener ugc nofollow"><strong class="ky ir">CFA概述</strong> </a></li><li id="9b9c" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="#c96c" rel="noopener ugc nofollow"> <strong class="ky ir">实验设置</strong> </a></li><li id="9bbd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="#26a4" rel="noopener ugc nofollow"> <strong class="ky ir">量化结果</strong> </a></li><li id="bcfb" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="#63ce" rel="noopener ugc nofollow"> <strong class="ky ir">定性结果</strong> </a></li></ol></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h2 id="dec9" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">1.要求</h2><p id="4a09" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">当你阅读一篇论文时，总有一些概念是想当然的，是深入理解作品所必需的。如果您不知道这些术语中的某一个，我建议您看看这一部分:</p><ul class=""><li id="8e34" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">铲子</strong></li><li id="3656" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">转移学习</strong></li><li id="8ad0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">视觉异常检测</strong></li></ul><h2 id="f10a" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">铲</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/f9ac40f8122af8bb9592de34f90b6f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avWjowoDdt17QcqWNwIuvQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">黑桃的例子。在评估过程中，SPADE提取测试图像在每个像素位置的特征，通过K个最近邻找到测试图像与正常图像之间的差异，并返回预测的掩模。</p></figure><p id="20c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">语义金字塔异常检测(SPADE)是一种异常检测方法，它使用预训练的CNN，如ResNet-18和Wide ResNet-50，来提取有意义的特征[2]。与CFA不同，这种方法利用ImageNet上的预训练CNN，而无需学习目标数据集，目标数据集可以具有与馈送给预训练CNN的数据集完全不同的分布。</p><p id="c53d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SPADE包含3个不同的阶段来解决异常检测任务:</p><ol class=""><li id="69f2" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ne ly lz ma bi translated"><strong class="ky ir">预训练的CNN </strong>从目标数据集中提取特征。</li><li id="b418" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated">第二阶段使用KNN<strong class="ky ir">从每个测试图像的训练集中检索</strong> <strong class="ky ir"> K个最近的正常图像</strong>。使用从训练数据集中提取的表示正态性的特征和测试图像的提取特征之间的欧几里德度量来计算距离。</li><li id="6daa" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated">第三阶段找到目标和正常图像之间密集的像素级对应关系。如果目标图像区域不存在与第二阶段中检索的正常图像的近似匹配，则标记为异常。</li></ol><h2 id="ad9d" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">迁移学习</h2><p id="3201" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">迁移学习是一个深度学习研究领域，专注于应用以前在一个领域获得的知识来解决一个不同但相关的任务。例如，您可以使用预先训练的CNN，如之前在ImageNet上训练的ResNet，将图像分类到猫和狗的类别中。</p><h2 id="efec" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">视觉异常检测</strong></h2><p id="39be" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">视觉异常检测是结合了计算机视觉和异常检测的机器学习领域中的一个重要问题[3]。它可以进一步分为两个不同的类别:</p><ul class=""><li id="c961" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">图像级异常检测</strong>仅尝试了解整幅图像是异常还是正常。</li><li id="e951" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">像素级异常检测</strong>定位图像内的异常区域。由于这个原因，它通常被称为异常定位。</li></ul><h2 id="edf8" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak"> 2。CFA概述</strong></h2><p id="947d" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">基于耦合超球的特征自适应(CFA)是一种结合特征提取器和迁移学习的异常定位方法。事实上，它利用迁移学习的原理来创建更健壮和概括的特征，这些特征允许确定目标数据集的输入图像是否异常。</p><p id="427e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以前的工作只使用预训练的CNN而不使用迁移学习，如SPADE，Padim和PatchCore，使用大型数据集，如ImageNet，取得了非常好的性能。然而，当目标数据集与ImageNet完全不同，并且中间层中生成的要素因此有偏差时，这可能是一个挑战。这种方法还有另外两个主要贡献:</p><ul class=""><li id="0338" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">基于软边界回归，提出了一种新的损失函数,它搜索具有最小半径的超球来聚类正常特征。因此，它允许片描述符提取区别特征，然后，异常特征可以与正常特征清楚地区分。</li><li id="8f9d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">可扩展</strong> <strong class="ky ir">存储体</strong>的压缩与目标数据集的大小无关。它提供了三个好处:减轻了异常特征被高估的正态性的风险，实现了空间复杂性的效率。</li></ul><h2 id="3d9b" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">基于耦合超球的特征自适应</h2><p id="3b99" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">通过结合基于超球的损失函数和记忆库，解决了预训练CNN的偏差问题。它尝试使用K-means算法提取<strong class="ky ir">聚类特征</strong> φ(pt ),因为正常特征对于区分异常特征很重要。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/6cd24267747f6354f28af5b2d8da7d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*B8GZJy8Rims7hNafcGluhw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Att Loss [1]。</p></figure><p id="bc77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中K是与面向目标的特征匹配的最近邻的数量，D是距离度量。因此，CFA允许通过优化面向目标的特征φ(pt)的参数来进行特征自适应，以通过迁移学习来最小化损失L_{att}。</p><p id="5c6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了避免高估异常特征的正态性，定义了附加损失。为了解决这个问题，<strong class="ky ir">硬否定特征</strong>被用于执行对比监督，导致更具判别力的φ(pt)。硬负特征被定义为pt的第K+j个最近邻ct^j。损失L_{rep}对比监督φ()，使得以ct^j为中心创建的超球面排斥pt。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/0275db5a6484b48231f956f4733e078f.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*gE0J30w8fwIj6zC5GqYFKA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代表损失[1]。</p></figure><p id="a872" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中J是用于对比监督的硬负面特征的总数，α是控制这两个损失L_{att}和L_{rep}之间平衡的超参数。因此，这两个损失合并成一个独特的损失:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/3f6c58183839074aebcd39067a526707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*qg1ATk90PcTyXldgjhebbw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将前面两个损失合并成一个唯一的损失[1]。</p></figure><h2 id="db42" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">存储体压缩</h2><p id="31f7" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">目标是构建一个有效的记忆库。首先，通过将K-means聚类应用于从训练集x的第一个正常样本x0获得的所有特征来构建初始记忆库C0。</p><ul class=""><li id="cf97" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">推断第<strong class="ky ir">个正常样本</strong>并从先前的存储体C_{i-1}中搜索最近的面片特征集合</li><li id="aefb" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">通过Ci^{NN}和C_{i-1}的指数移动平均(EMA)来计算下一状态 Ci的第<strong class="ky ir">个存储体</strong></li></ul><p id="49e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过对训练集的所有正常样本重复上述过程|X|次，获得最终的记忆库C。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/5e22d4f5001014869323cddcb8961c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*PE_PepatkUOruepLYtbmCA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">算法与内存条的压缩过程[1]。</p></figure><p id="98ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以注意到，与其他基于特征提取器而没有迁移学习的方法相比，空间复杂度降低了。特别是，它不依赖于目标数据集|X|的大小。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/c12aff504c40798f9cb16f49b6abbda3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*JpoRSjhLP8HxjkQm1az5NA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">记忆库建模和记忆库大小的空间复杂度估计[1]。</p></figure><h2 id="0c1e" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">评分功能</h2><p id="3645" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">使用面向目标的特征φ(pt)和记忆的特征之间的最小距离来定义异常分数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/010a0968789a870c210caaed99159d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*wwWVN9RCZwJlmyxdsCWAnw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">异常分数的定义[1]。</p></figure><p id="9d8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，正常特征的聚类之间的边界并不清楚，并且很难用朴素异常分数精确地区分异常特征。为此，提出了一种新的评分函数来考虑φ(pt)的确定性。φ(pt)匹配得越多，与其他记忆特征相比，到特定记忆特征的距离就越短。Softmin用于衡量最近的c与另一个c相比有多接近。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/90b05a7b261e3110a30afe2b8e3b0473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*JwhWgPBt3bHi5aAfP1JRfg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">新颖的评分函数[1]。</p></figure><p id="3484" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在评估新方法CFA的过程中，我们可以获得异常得分图，该异常得分图构成了异常定位的最终输出。</p><h2 id="c96c" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">3.实验设置</h2><p id="ce80" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">有两个数据集被认为是评估新方法的基准:MVTec AD和RD-MVTec数据集。虽然MVTec AD是一个新颖而全面的工业数据集，包含5354幅高分辨率图像，分为15个类别，但RD-MVTec只是MVTec AD的一个副本，样本未经比对。RD-MVTec的图像在+/-10度范围内随机旋转。转换后，样本大小调整为256x256，并随机裁剪为224x224。</p><p id="bb43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用受试者操作曲线下面积(AU-ROC)作为度量来评估性能。<strong class="ky ir">图像级AUROC </strong>用于评估模型异常检测的性能，而<strong class="ky ir">像素级AUCROC </strong>用于评估异常定位的性能。</p><p id="d89b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用ImageNet上所有预训练的CNN执行实验，其中从每个预训练的CNN的中间层{C2、C3、C4}提取特征图。1x1 CoordConv被认为是补丁描述符，它被训练30个时期。</p><h2 id="26a4" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">4.定量结果</h2><p id="aff5" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">表1和表2分别显示了不同异常定位方法在MVTec AD数据集和RD-MVTec AD数据集上的性能。</p><ul class=""><li id="dac5" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">当考虑MVTec AD数据集上的所有类时，CFA++呈现比CFLOW稍低的像素级AUROC分数。但是应该注意，它利用具有较小空间复杂度的存储体获得了良好的性能。</li><li id="c3e0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在RD-MVTec AD数据集上，异常定位方法的性能低于MVTec AD数据集的性能。特别是，SPADE似乎对图像的旋转更敏感，这大大降低了它的AUROC分数。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/6b4060a5d80077a119a48eb643cb16c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-uwNXNyLaLYFcsdlS3Snw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">表MVTec AD数据集上不同异常定位方法的图像级AUROC和像素级au pro[1]。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/a7caf05583734bbfa9e60db0eec496a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*8z9pzDr4jVtj48HnGkaAmA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">表2:RD-mv tec AD数据集上不同异常定位方法的图像级AUROC和像素级au pro[1]。</p></figure><p id="acb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在表3中，通过在MVTec AD数据集上可视化每个类别的图像级ROCAUC得分，CFA++的性能更加出色。值得注意的是，由于特性适应目标数据集的影响，CFA++在类级别上的性能优于所有其他方法，而在一次处理一个类时，CFLOW的性能低于CFA++。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/afff3093bc0d8fc5269f3c7971563509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gpd5ertVivU5B_4nAeZv5A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">表MVTec AD数据集上每个类的图像级AUROC。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/1919d1d89fe18a984ffa5fe62b454251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*rS3kaSIfpU8pLkT8iwCeDw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">表MVTec AD数据集上不同预训练CNN的图像级/像素级ROCAUC得分[1]。</p></figure><p id="5f95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">表4允许将异常检测/定位的性能与预训练的CNN进行比较。当使用eff net-B5和ResNet18作为特征提取器时，CFA++获得了最高的性能。</p><h2 id="63ce" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">5.定性结果</h2><p id="b63b" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">定性结果对于解释由CFA产生的特征是否能够区分正常图像和异常图像是重要的。下图显示了两个示例的补片特征的异常分数，一个是容易识别缺陷的瓶子，另一个是具有更具挑战性异常的电缆。</p><p id="edff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在异常分值中，红色代表异常分值。该可视化想要强调在提取的特征上应用或不应用迁移学习时的差异:</p><ul class=""><li id="f4c3" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">当在没有迁移学习的情况下获得特征<strong class="ky ir">时，正常特征的正态性被低估，并且具有与异常特征相似的分数。然后，很难识别两个特征之间的差异，因为基于异常分数的边界是模糊的，不是很清楚<em class="ob">(第二列—有偏差)</em>。</strong></li><li id="4bce" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">当在<strong class="ky ir">之后使用迁移学习</strong>获得面向目标的特征时，它们被很好地聚类，如图1的第三列所示。然而，单独的聚类不足以精确地对疑难病例的不确定异常特征进行评分。本文提出的评分函数通过考虑确定性来计算异常得分。通过这种方式，我们能够在困难的情况下将异常特征与正常特征区分开来。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a010a79e4a873bd13da78c37edb2d260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*jNrI4wq1CejQq5Q_Y4Vzkw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图1:每个斑块特征的异常分数的2D可视化，其中三角形表示记忆的特征，虚线圆圈表示异常特征的区域[1]。</p></figure><p id="1943" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是异常定位结果，显示由CFA识别的异常区域。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/d68c9290bf0a77e1db79badec9ae7dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEPgKAP1riPki63rnjQ7Uw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图2:原始图像VS地面实况VS预测热图VS分割结果[1]。</p></figure><h2 id="1670" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">外卖食品</h2><p id="4d34" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">我希望你喜欢CFA的这篇评论。正如我不厌其烦地重复的那样，异常检测是一个需要解决的具有挑战性的问题，需要对这些方法进行概述，以了解哪种方法最适合特定的环境。</p><p id="d526" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上一篇文章中，我建议你看一下解释<a class="ae kv" href="https://arxiv.org/abs/1901.08954" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Skip-GANomaly </strong> </a>和<a class="ae kv" href="https://arxiv.org/abs/1703.05921" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> AnoGAN </strong> </a>的论文。在这篇文章中，我建议你阅读关于<a class="ae kv" href="https://arxiv.org/pdf/2005.02357v3.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"/></a><a class="ae kv" href="https://arxiv.org/abs/2011.08785" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">PaDiM</strong></a><a class="ae kv" href="https://arxiv.org/abs/2107.12571" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">cf flow</strong></a>和<a class="ae kv" href="https://arxiv.org/abs/2111.07677" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> FastFlow </strong> </a>的论文。所有这些方法的共同点在于，它们利用预先训练的CNN来检测和定位异常。如果你有其他关于阅读的建议，请告诉我，分享知识是提高的最好方法。感谢阅读。祝您愉快！</p><h2 id="dce1" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">参考资料:</h2><p id="22b6" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">[1] <a class="ae kv" href="https://arxiv.org/pdf/2206.04325.pdf" rel="noopener ugc nofollow" target="_blank"> CFA:基于耦合超球的特征适应用于面向目标的异常定位</a>，S. Lee，S. Lee和B. Cheol Song，(2022)</p><p id="f5bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2] <a class="ae kv" href="https://arxiv.org/pdf/2005.02357v3.pdf" rel="noopener ugc nofollow" target="_blank">具有深金字塔对应关系的子图像异常检测</a>，N. Cohen和Y. Hoshen，(2021)</p><p id="7c3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3] <a class="ae kv" href="https://www.sciencedirect.com/science/article/pii/S1877050922000576" rel="noopener ugc nofollow" target="_blank">图像的视觉异常检测:一个系统的综述</a>，杨军，徐，齐，石，(2022)</p><h2 id="785a" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated">GitHub知识库</h2><div class="oe of gp gr og oh"><a href="https://github.com/sungwool/CFA_for_anomaly_localization" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">GitHub-sung wool/CFA _ for _ anomaly _ localization</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">通过在GitHub上创建帐户，为sung wool/CFA _ for _ anomaly _ localization开发做出贡献。</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">github.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov kp oh"/></div></div></a></div></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="ce3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你喜欢我的文章吗？<a class="ae kv" href="https://eugenia-anello.medium.com/membership" rel="noopener"> <em class="ob">成为会员</em> </a> <em class="ob">每天无限获取数据科学新帖！这是一种间接的支持我的方式，不会给你带来任何额外的费用。如果您已经是会员，</em> <a class="ae kv" href="https://eugenia-anello.medium.com/subscribe" rel="noopener"> <em class="ob">订阅</em> </a> <em class="ob">每当我发布新的数据科学和python指南时，您都会收到电子邮件！</em></p></div></div>    
</body>
</html>