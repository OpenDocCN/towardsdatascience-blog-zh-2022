<html>
<head>
<title>Deploy XGBoost Models from SageMaker using Lambda Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Lambda函数从SageMaker部署XGBoost模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploy-xgboost-models-from-sagemaker-using-lambda-functions-be58284ca0cf#2022-05-15">https://towardsdatascience.com/deploy-xgboost-models-from-sagemaker-using-lambda-functions-be58284ca0cf#2022-05-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dc12" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于如何公开SageMaker ML模型端点供所有人使用的快速教程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b2e6c22a5202fbd166914fd61e8145ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uqUM6PXSXLobHGlI"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">杰克·法甘在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5abf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Amazon SageMaker中创建ML模型端点非常棒，但是除非您能够让其他人使用它们，否则这有什么意义呢？在上一个教程中:</p><blockquote class="ls"><p id="1450" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated"><a class="ae kv" href="https://medium.com/@nikola.kuzmic945/train-xgboost-models-in-amazon-sagemaker-in-4-simple-steps-4eb3e104ee61" rel="noopener"> <strong class="ak">用4个简单的步骤在亚马逊SageMaker中训练XGBoost模型</strong> </a></p></blockquote><p id="9358" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">我们讨论了如何创建一个XGBoost分类器，它可以根据一个人的房子面积来预测一只完美的小狗。也就是说，对于小于500平方英尺的房屋，模型会推荐小猎犬(0)，而对于大于500平方英尺的房屋，模型会推荐德国牧羊犬(1)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/78be886705ef0b3be4f83b926ceafbf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CqEftEcFxVMrNWyWgBzDFQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:左[1]和右[2]</p></figure><p id="c069" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在是时候在互联网上部署这个端点了！以下是方法:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/fd9a55c4cc3e71cdc130265b23cf51d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*g9du0EsgvaPiI4ch1NvIZw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="1713" class="mj mk iq bd ml mm mn dn mo mp mq dp mr lf ms mt mu lj mv mw mx ln my mz na nb bi translated">👉策略</h2><ol class=""><li id="85a8" class="nc nd iq ky b kz ne lc nf lf ng lj nh ln ni lr nj nk nl nm bi translated">创建一个Lambda函数，用于处理传入的请求有效负载(即住宅区输入)，并将其传递给SageMaker ML模型端点</li><li id="f881" class="nc nd iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">使用API网关创建一个REST API来接受客户机请求</li></ol><p id="db77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我们努力实现的最终目标。我们希望能够从互联网上的任何地方向我们的SageMaker端点发送POST请求:</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="2459" class="mj mk iq nt b gy nx ny l nz oa">curl -X POST https://&lt;Your_API_Gateway_REST_API&gt;/resource/method -H 'Content-Type: application/json' -d '{"area":"300"}'</span></pre><p id="59ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并接收以下输出响应:</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="808d" class="mj mk iq nt b gy nx ny l nz oa">"beagle"</span></pre><p id="c772" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看如何！</p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><h2 id="ee2a" class="mj mk iq bd ml mm mn dn mo mp mq dp mr lf ms mt mu lj mv mw mx ln my mz na nb bi translated">1.创建Lambda函数</h2><p id="11b1" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">在AWS中创建一个Lambda函数非常简单，只需几次点击。以下是您需要的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="8ecd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在进入AWS控制台中的Lambda选项卡之前，首先确保<strong class="ky ir">记下</strong>您的XGBoost <strong class="ky ir">端点名称</strong>，您需要将它作为环境变量存储在Lambda函数中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/3eb69353ad68593b7ab948af570648f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bc87H3eTUQ-BZ51odKr9vw.png"/></div></div></figure><p id="e736" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们创建Lambda函数</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/02a2e7d155f1a3d43378e8723cbefef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cp83oQkNSbh2cVYdJ3CvjQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/fab6fb9d6906dd269047763f3389701d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YdkdGMR3BJphPYzVs7AdIQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/303bdf95d243006914963de29cc127e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eiwvYb10j375Pc_bxt3J4Q.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/e182b075fb1b7192d210a217d39b3aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iiZivwz5aXAZbvRpfwameg.png"/></div></div></figure><p id="b9f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里粘贴lambda代码:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/396d5e608273c1a54cfc2b07d90fae90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Ls8yTdpF9SsEBMqqye85w.png"/></div></div></figure><p id="97c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，输入SageMaker端点名称(您之前复制的)作为环境变量</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/206b6458d33c25776a4462ad6a24fed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jBBebDUMaueBs9mdrOwGQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/de67c0a64e4096c1dae3b283002190e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GuRBbXsNtxKM3N2ycM27uw.png"/></div></div></figure><p id="80a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们需要给我们的Lambda函数权限来调用SageMaker端点。在权限下，单击执行角色:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/11b472b1eaf79af42b00333d7b7aa649.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0DPEyZAKKC51Wo82Al7rVg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/7b4b26a2eb5c979cee330f74386ea30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KNmwXEmcRUI0K4Es3_YD5Q.png"/></div></div></figure><p id="0229" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将给予Lambda函数对SageMaker的完全访问权:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/3082525018d8df2259fad33cb99290c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3d33JZgWjvVyIFSRk_K9zw.png"/></div></div></figure><p id="f050" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的Lambda函数现在知道<strong class="ky ir">要调用哪个端点</strong>，并且拥有<strong class="ky ir">相应的权限</strong>来这样做。是时候创建REST API了。</p><h2 id="e3a8" class="mj mk iq bd ml mm mn dn mo mp mq dp mr lf ms mt mu lj mv mw mx ln my mz na nb bi translated">2.使用API网关创建一个REST API</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/17a03d57ea8a3304160508e2901da0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MR2PFGS8pesdNLXx_4FyNw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/f87f3d3c544f6cc8231dde304c8d93da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DuM7npzOtRLKrP7ujoGmA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/62de5afb52ce0baa886083881a20d6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qoF4Q2Z3JqbRnywUDlYFUQ.png"/></div></div></figure><p id="0eb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择:</p><ul class=""><li id="03e5" class="nc nd iq ky b kz la lc ld lf pa lj pb ln pc lr pd nk nl nm bi translated">休息</li><li id="fe2b" class="nc nd iq ky b kz nn lc no lf np lj nq ln nr lr pd nk nl nm bi translated">新API</li></ul><p id="237f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给它一个<strong class="ky ir">名称</strong>，保留默认类型为<strong class="ky ir">区域</strong>和<strong class="ky ir">点击:创建API </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/e68e0cd814721243dfa274d201e2d3b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otTZKI-froAejkoD21ZFUQ.png"/></div></div></figure><p id="ffdb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们需要<strong class="ky ir">创建资源</strong>作为REST API的一部分:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/9d537ce3df8a9ce3a8024d3ad782a6d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rbntj_VyLOv6I1Sekpf31Q.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/bb045dd5ce614a909cd8b6d01c92b6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MeYAqrGE_8PkaDUqd1Ws2w.png"/></div></div></figure><p id="9a7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后<strong class="ky ir">创建方法</strong>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/050574672fb6212bb8111081b2655ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6hZO2JLStE3kznSjU8ra-Q.png"/></div></div></figure><p id="887f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择发布方法:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pi"><img src="../Images/4596cfb72881b1cb256cbd6459a5a1d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KPd5bw1rKgYRIUcONovo7w.png"/></div></div></figure><p id="90c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们将这个REST API指向我们在上一步中创建的Lambda函数(“demo1”):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pj"><img src="../Images/50411a4b54b85f0db18b280fb4e23e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PL3WiZrX7h139ccn_0CSxg.png"/></div></div></figure><p id="6b6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们将<strong class="ky ir">部署API </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/4edaf2b97d74d132568a70cebb566fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*3TuENC6OWzAKfKZ2g-rAXw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/80ffa4297dd622abaf9a1cdeb86446d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6QjyGJz49bSeF2d8H12enA.png"/></div></div></figure><p id="b6b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">复制REST API url:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pm"><img src="../Images/b04a905307905ebde0b9e33050b978ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*edABfcTkynJ4dT53neeAoA.png"/></div></div></figure><p id="f725" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在发送请求时，确保将<strong class="ky ir">方法名</strong>(即demo1)添加到复制的API url中</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="c3a4" class="mj mk iq nt b gy nx ny l nz oa">curl -X POST https://&lt;Your_API_Gateway_REST_API&gt;/test/demo1 -H 'Content-Type: application/json' -d '{"area":"300"}'</span><span id="1009" class="mj mk iq nt b gy pn ny l nz oa"><strong class="nt ir">Output:</strong><br/>"beagle"</span></pre><h2 id="5335" class="mj mk iq bd ml mm mn dn mo mp mq dp mr lf ms mt mu lj mv mw mx ln my mz na nb bi translated">最后的话</h2><p id="869b" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">现在你知道了！现在，我们已经证明，我们的SageMaker模型已经成功地在互联网上公开，供每个人使用，如果我们有React、Vue.js或Angular frontend应用程序，它将能够提出类似的请求，并为用户提供完美的小狗推荐。</p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><h2 id="0bf2" class="mj mk iq bd ml mm mn dn mo mp mq dp mr lf ms mt mu lj mv mw mx ln my mz na nb bi translated">清理以停止产生成本！</h2><blockquote class="ls"><p id="649d" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">1.通过在Jupyter笔记本中运行以下命令来删除已部署的端点</p></blockquote><pre class="po pp pq pr ps ns nt nu nv aw nw bi"><span id="2a81" class="mj mk iq nt b gy nx ny l nz oa">xgb_predictor.delete_endpoint()</span></pre><blockquote class="ls"><p id="6ef5" class="lt lu iq bd lv lw pt pu pv pw px lr dk translated">2.停止SageMaker笔记本实例</p></blockquote><blockquote class="py pz qa"><p id="f9ef" class="kw kx qb ky b kz mc jr lb lc md ju le qc me lh li qd mf ll lm qe mg lp lq lr ij bi translated"><strong class="ky ir">感谢你的阅读，如果这篇文章帮你节省了时间或者解决了问题，一定要点击下面的按钮！总是非常感谢。</strong></p></blockquote><h2 id="f7f2" class="mj mk iq bd ml mm mn dn mo mp mq dp mr lf ms mt mu lj mv mw mx ln my mz na nb bi translated">图像来源</h2><p id="c4bb" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">[1]<a class="ae kv" href="https://commons.wikimedia.org/wiki/File:Beagle_puppy_Cadet.jpg" rel="noopener ugc nofollow" target="_blank">https://commons . wikimedia . org/wiki/File:Beagle _ puppy _ cadet . jpg</a></p><p id="5891" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://pxhere.com/en/photo/1003603" rel="noopener ugc nofollow" target="_blank">https://pxhere.com/en/photo/1003603</a></p></div></div>    
</body>
</html>