<html>
<head>
<title>How to Style Pandas DataFrames Like a Pro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何像专业人士一样设计熊猫数据框</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-style-pandas-dataframes-like-a-pro-541c84142c17#2022-07-27">https://towardsdatascience.com/how-to-style-pandas-dataframes-like-a-pro-541c84142c17#2022-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c4d0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">用这份完整的初学者指南让你的数据框架惊艳四座。</strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/563e0c0c45bdea72d264b389b6cb5fdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pWiKdO57RpPXURaJ61qXQw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文章缩略图(图片由作者提供)</p></figure><p id="b132" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python的Pandas库允许您以类似于Excel的方式呈现表格数据。不太相似的是样式功能。在Excel中，您可以利用一次单击着色或条件格式使您的表格引人注目。对熊猫来说，这就有点棘手了。</p><p id="07df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好消息是——<strong class="la iu">熊猫中的风格API可以帮助</strong>。直到最近我才完全意识到这一点，这也是我希望能早点发现的事情之一。我花了太多时间在Python和Pandas中聚集数据，然后将结果复制到Excel中进行样式化。</p><p id="7bb0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">听起来很熟悉？好，我们走吧！</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="ea38" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">数据集</h1><p id="15e5" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">在深入研究好的东西之前，我们必须关注数据集。您将在下面看到的代码片段为您创建了一个。它有四列，每列有5个任意值。一些值也丢失了，原因您将很快看到:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="0552" class="nd mc it mz b gy ne nf l ng nh">import numpy as np<br/>import pandas as pd<br/><br/>df = pd.DataFrame({<br/>    "A": [0, -5, 12, -4, 3],<br/>    "B": [12.24, 3.14, 2.71, -3.14, np.nan],<br/>    "C": [0.5, 1.2, 0.3, 1.9, 2.2],<br/>    "D": [2000, np.nan, 1000, 7000, 5000]<br/>})<br/>df</span></pre><p id="0811" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据集如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/952ce9af65b188b36f9b4e844577cc75.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*CGRxzfdzQ2XR3XLbzbVDUw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片1-虚构的数据集(图片由作者提供)</p></figure><p id="5c2d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个非常标准的熊猫输出，看起来很熟悉，让我们面对它，<strong class="la iu">无聊</strong>。接下来，你将学习如何调味。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="f38a" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">熊猫样式的基本格式</h1><p id="58ae" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">Pandas提供了一个样式API，允许你改变数据帧的显示方式。有许多内置的样式函数，但也有选择编写自己的。</p><p id="0804" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">大部分时间我觉得很烦的一件事就是索引栏。它只是一个序列，并没有为表格可视化提供真实的价值。使用<code class="fe nj nk nl mz b">hide()</code>方法来摆脱它:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="a8d0" class="nd mc it mz b gy ne nf l ng nh">df.style.hide(axis="index")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/9736e5327bc972a31de5a4889c038b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*_eZimVgbGAZ_1dJiip-4-g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2 —隐藏数据帧索引(作者图片)</p></figure><p id="e590" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好多了！</p><p id="75c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有其他事情让我们的数据框架看起来很痛苦。例如，这些十进制数的精度是不必要的。出于可视化的目的，大多数情况下两位小数就足够了:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="4396" class="nd mc it mz b gy ne nf l ng nh">df.style.format(precision=2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/65d2b321808bbfe258c80d233039d97e.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*5R1pD7K3GZUKHIKXBHsiKA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3-指定数值精度(作者图片)</p></figure><p id="7696" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以更进一步，指定自定义格式字符串。下面的示例将在每个值的前后添加一个减号，并将每个数字的格式设置为三位小数:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="acc2" class="nd mc it mz b gy ne nf l ng nh">df.style.format("- {:.3f} -")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/d81bed615ef9de53a90ca63c82afb726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x3PZqqzTvvZVMZJLratc6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4-自定义值格式样式(作者图片)</p></figure><p id="81f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事情不会就此结束。有时，您希望每列有不同的格式。将格式化字符串指定为键值对，这样就可以了:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="84ac" class="nd mc it mz b gy ne nf l ng nh">df.style.format({<br/>    "A": "{:.2f}",<br/>    "B": "{:,.5f}",<br/>    "C": "{:.1f}",<br/>    "D": "$ {:,.2f}"<br/>})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/a1c4280cbeab3ae8c2d5b5c1278d673c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*39JCiaO5Fg9g-uDj72ViPw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5-为每列指定格式样式(按作者分类的图像)</p></figure><p id="1479" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是格式化的基础。接下来，我们将学习许多改变文本和背景颜色的方法——等等。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="ab58" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">使用熊猫风格来改变文本和背景颜色</h1><p id="7c55" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">通常，突出显示您想要引起注意的数据点是一个好主意。方便的<code class="fe nj nk nl mz b">highlight_max()</code>函数将数据帧中每个单元格的最大值指定为黄色:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="4098" class="nd mc it mz b gy ne nf l ng nh">df.style.highlight_max()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/1779e05b2244bdbbb22cb6c6151f113d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ExyQdqnvcJ4DvhzqgVu4lg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6-突出显示最大值(作者图片)</p></figure><p id="63a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nj nk nl mz b">highlight_min()</code>函数的作用正好相反:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="5066" class="nd mc it mz b gy ne nf l ng nh">df.style.highlight_min()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e7157e03c3a7e7af727a5c1c2da30991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*HCGQnOyfAdODlZPk6ZpsiQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7-突出显示最小值(作者图片)</p></figure><p id="8814" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了最小和最大数据点之外，您还可以突出显示缺少的值。以下示例显示了如何将没有值的单元格着色为红色:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="ba4e" class="nd mc it mz b gy ne nf l ng nh">df.style.highlight_null(null_color="red")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/5eb2983037001f43a79b8d1fc043aa47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5ACGy0isLJ7dKJrcZxoyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8-突出显示空值(作者图片)</p></figure><p id="fa57" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您对默认打印的<em class="nt"> nan </em>不满意，您还可以用自定义字符串格式化缺少的值:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="a401" class="nd mc it mz b gy ne nf l ng nh">df.style.format(na_rep="Missing").highlight_null(null_color="red")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/854ddd9bf85031067d99fbea5d27673d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7tcPKaCrOvUKSS-3KyQJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9-突出显示空值(2)(作者图片)</p></figure><p id="7afa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">整洁！让我们探索一些其他的颜色选择。</p><p id="abed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，<code class="fe nj nk nl mz b">background_gradient()</code>函数将使用渐变调色板为单个行的单元格着色。默认情况下使用蓝色调色板，值较高的单元格用较暗的颜色填充:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="80d6" class="nd mc it mz b gy ne nf l ng nh">df.style.background_gradient()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/f545aebc6b9c53fe8a90f794e3e848b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9I85ELqtaAwHSl7XFEPmg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10 —使用渐变调色板突出显示(图片由作者提供)</p></figure><p id="e7aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您不必对整个数据集进行着色——<code class="fe nj nk nl mz b">subset</code>参数允许您指定想要着色的列列表:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="4da9" class="nd mc it mz b gy ne nf l ng nh">df.style.background_gradient(subset=["B", "D"])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/d7fa19581c6ca88282c18474a3239d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C1j4DD2SLwTbhRt96tuiFQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11 —使用渐变调色板突出显示(2)(图片由作者提供)</p></figure><p id="d710" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有一种方法可以改变调色板，并明确设置最小值和最大值。这些参数在<code class="fe nj nk nl mz b">background_gradient()</code>和<code class="fe nj nk nl mz b">text_gradient()</code>功能中都可用。我们先来看看后一种是如何工作的:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="ea53" class="nd mc it mz b gy ne nf l ng nh">df.style.text_gradient(subset=["C"], cmap="RdYlGn", vmin=0, vmax=2.5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/551cafbe6cc3cc55a018be0665b5299f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XzXfncdk4wO0cDOSGNsIsg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图12 —使用自定义渐变调色板更改文本颜色(图片由作者提供)</p></figure><p id="04d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不错，但是不太好看。第二个值有点难读。这就是为什么最好给整个单元格着色，而不仅仅是文本:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="fcba" class="nd mc it mz b gy ne nf l ng nh">df.style.background_gradient(subset=["C"], cmap="RdYlGn", vmin=0, vmax=2.5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/35d5e001b0b89c701b9506df770cd1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PJx6eBiutfJMBcImjmy5aQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图13 —使用自定义渐变调色板更改背景色(图片由作者提供)</p></figure><p id="eb89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们进入真正令人兴奋的东西。我们将以条形图的形式研究每个单元格的颜色。条形的“长度”由单元格的值表示，相对于列的其余部分，该值越高，单元格的颜色就越多。</p><p id="f83b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要给数据帧添加条形颜色，只需调用<code class="fe nj nk nl mz b">bar()</code>函数:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="546b" class="nd mc it mz b gy ne nf l ng nh">df.style.format(precision=2).bar(color="orange")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/06fc06fb26dc3c46a0d1ece141e6be1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXz3NYkO1Clc-vdFeq0yxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图14-以条形图形式显示的值范围(作者图片)</p></figure><p id="d366" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">默认不是最好看的桌子。有一些列是负值，所以该条是双向的，没有视觉上的区别。至少可以说，这是一个糟糕的设计实践。</p><p id="7f2b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，如果单元格之间有边界，也会有所帮助。否则，填充颜色会与周围的颜色融合:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="2285" class="nd mc it mz b gy ne nf l ng nh">df.style.format(precision=2).bar(align="mid", color=["red", "lightgreen"]).set_properties(**{"border": "1px solid black"})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/0bdddaa16dedb61ab48da224c56c9f52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x4Qce4ytfo2jkmreBoaXOQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图15-以条形图形式显示的值范围(2)(图片由作者提供)</p></figure><p id="5774" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好多了！</p><p id="8de5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果说许多熊猫用户有一个担心点，那就是文本大小。如果你在一个大显示器上工作，并且不想让一切都变得更大，那么它就太小了。</p><p id="c64f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以使用<code class="fe nj nk nl mz b">set_properties()</code>函数传入一个键值对字典。键和值都来自CSS，如果你有任何网页设计的经验，你会有宾至如归的感觉。</p><p id="a7df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的代码片段设置了较粗的灰色边框，将绿色应用于文本，并增加了文本的整体大小:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="b308" class="nd mc it mz b gy ne nf l ng nh">properties = {"border": "2px solid gray", "color": "green", "font-size": "16px"}<br/>df.style.set_properties(**properties)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/64a5f349e1666ce8b42d9bdebd42f5ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xaI-vEC_Es1vZvL-9QkEEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图16 —更改文本颜色和大小(图片由作者提供)</p></figure><p id="3566" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这对于基本的造型来说已经足够了。接下来，我们将通过几个高级示例来突出这个表格。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="d104" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">高级:样式标题行和索引列</h1><p id="943e" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">桌子设计，或者说一般意义上的设计，是高度主观的。但是所有好看的表格都有一个共同点——一个易于区分的标题行。在本节中，您将学习如何设计风格:</p><ul class=""><li id="5513" class="ob oc it la b lb lc le lf lh od ll oe lp of lt og oh oi oj bi translated">表格标题行</li><li id="b213" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">表索引列</li><li id="3745" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">处于悬停状态的表格单元格</li></ul><p id="991e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们开始吧！我们将声明三个字典——第一个用于悬停状态，第二个用于索引列，最后一个用于标题行。您可以使用<code class="fe nj nk nl mz b">set_table_styles()</code>功能将它们全部应用于一个数据帧:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="ae96" class="nd mc it mz b gy ne nf l ng nh">cell_hover = {<br/>    "selector": "td:hover",<br/>    "props": [("background-color", "#FFFFE0")]<br/>}<br/>index_names = {<br/>    "selector": ".index_name",<br/>    "props": "font-style: italic; color: darkgrey; font-weight:normal;"<br/>}<br/>headers = {<br/>    "selector": "th:not(.index_name)",<br/>    "props": "background-color: #800000; color: white;"<br/>}<br/><br/>df.style.set_table_styles([cell_hover, index_names, headers])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/dcd780f71c9e7452c2ce76a3fc811909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9zQufqSiok1z9vnKmFN9w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图17 —带有样式化标题和索引行的表格(作者图片)</p></figure><p id="c830" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这与我们以前的情况有天壤之别，但我们可以做得更好。例如，我们可以使所有列具有相同的宽度，使单元格内容居中，并在它们之间添加1像素的黑色边框:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="f7fd" class="nd mc it mz b gy ne nf l ng nh">headers = {<br/>    "selector": "th:not(.index_name)",<br/>    "props": "background-color: #800000; color: white; text-align: center"<br/>}<br/>properties = {"border": "1px solid black", "width": "65px", "text-align": "center"}<br/><br/>df.style.format(precision=2).set_table_styles([cell_hover, index_names, headers]).set_properties(**properties)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/564a1dc66381e2969fe8865c8728ec24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-PxEZZvxqJpcsktJiZbfiw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图18-带有样式化标题和索引行的表格(2)(作者图片)</p></figure><p id="07be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这张桌子真好看！</p><p id="68a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，让我们看看如何根据Python函数的输出有条件地声明样式。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="e954" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">高级:用Pandas Styler声明自定义样式</h1><p id="21fd" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">有时内置的样式就是不能满足它。幸运的是，您可以应用自己的Python函数。</p><p id="afbb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一个例子:<code class="fe nj nk nl mz b">mean_highlighter()</code>函数将:</p><ul class=""><li id="649c" class="ob oc it la b lb lc le lf lh od ll oe lp of lt og oh oi oj bi translated">如果值小于或等于平均值，则将单元格染成红色</li><li id="5725" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">如果值大于平均值，则将单元格涂成绿色</li><li id="01a7" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">将文本设置为白色和粗体</li></ul><p id="8b5e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦在Python函数之外，只需从Pandas Styles API调用<code class="fe nj nk nl mz b">apply()</code>函数:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="5bc2" class="nd mc it mz b gy ne nf l ng nh">def mean_highlighter(x):<br/>    style_lt = "background-color: #EE2E31; color: white; font-weight: bold;"<br/>    style_gt = "background-color: #31D843; color: white; font-weight: bold;"<br/>    gt_mean = x &gt; x.mean()<br/>    return [style_gt if i else style_lt for i in gt_mean]<br/>    <br/>    <br/>df.style.apply(mean_highlighter)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/5329987f31133eb57ba3693ec2696f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cNacHkBir7igJERcQizISQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图19 —使用均值高亮功能(图片由作者提供)</p></figure><p id="2db5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不是最漂亮的颜色，但绝对是在Python中设置条件格式的简单方法。</p><p id="f956" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个常见的用例是，如果值为负，则将单元格的文本颜色设置为红色。下面是您如何实现这一点:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="8a52" class="nd mc it mz b gy ne nf l ng nh">def negative_highlighter(x):<br/>    is_negative = x &lt; 0<br/>    return ["color: #EE2E31" if i else "color: #000000" for i in is_negative]<br/>    <br/>    <br/>df.style.apply(negative_highlighter)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/acf812ac7a2a23f98cd05ce4c1ca34bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8qJtnqjQOhjbgk-1nYZD1A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图20 —使用负荧光笔功能(图片由作者提供)</p></figure><p id="8383" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有了这些知识，我们只剩下一件事要讨论——导出您的样式化表格。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="c566" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">如何将设计好的熊猫数据框导出到Excel</h1><p id="28a1" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">所有熊猫风格API函数的结果是一个熊猫数据帧。因此，您可以调用<code class="fe nj nk nl mz b">to_excel()</code>函数在本地保存数据帧。如果您要将此函数链接到一组样式调整，结果Excel文件也将包含这些样式。</p><p id="2b77" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是导出基于渐变的彩色表格的代码:</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="d22c" class="nd mc it mz b gy ne nf l ng nh">df.style.background_gradient(cmap="RdYlGn").to_excel("table.xlsx")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/7658d7e83ae834119b0f6de571c3be83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZ4GMopRWkA5Tqu10uWKLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图21 —导出的Excel文件(作者提供的图片)</p></figure><p id="4147" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这也可以在Excel中实现，但在Pandas中实现要简单得多。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="ff48" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">熊猫风格API概述</h1><p id="018d" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">今天，您已经了解了熊猫风格API的来龙去脉。正如我前面提到的，这是一个我希望能尽快学会的API，因为它能为我在做演示和写论文时节省很多时间。</p><p id="94ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用你今天学到的工具和技巧，没有什么是你做不到的。当您想要应用多种样式时，可以将函数链接在一起，例如，更改小数位数和给单元格着色。排序很重要，所以请记住这一点。</p><p id="f599" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你最喜欢用什么方式来设计熊猫数据框？请在下面的评论区告诉我。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="2c79" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nt">喜欢这篇文章吗？成为</em> <a class="ae os" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="nt">中等会员</em> </a> <em class="nt">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ot ou gp gr ov ow"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd iu gy z fp pb fr fs pc fu fw is bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">阅读达里奥·拉德契奇(以及媒体上数以千计的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">medium.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk ks ow"/></div></div></a></div></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="b600" class="nd mc it bd md pl pm dn mh pn po dp ml lh pp pq mn ll pr ps mp lp pt pu mr pv bi translated">保持联系</h2><ul class=""><li id="1ac4" class="ob oc it la b lb mt le mu lh pw ll px lp py lt og oh oi oj bi translated">雇用我作为一名技术作家</li><li id="b333" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">订阅<a class="ae os" href="https://www.youtube.com/c/BetterDataScience" rel="noopener ugc nofollow" target="_blank"> YouTube </a></li><li id="2454" class="ob oc it la b lb ok le ol lh om ll on lp oo lt og oh oi oj bi translated">在<a class="ae os" href="https://www.linkedin.com/in/darioradecic/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</li></ul></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="16c7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nt">原载于2022年7月27日</em><a class="ae os" href="https://betterdatascience.com/style-pandas-dataframes/" rel="noopener ugc nofollow" target="_blank"><em class="nt">https://betterdatascience.com</em></a>T22。</p></div></div>    
</body>
</html>