<html>
<head>
<title>Pandas Exercise for Data Scientists — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学家的熊猫练习—第一部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-exercise-for-data-scientists-part-1-b601a97ee091#2022-06-05">https://towardsdatascience.com/pandas-exercise-for-data-scientists-part-1-b601a97ee091#2022-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c25b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一组具有挑战性的熊猫问题</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/80f2da71cf0b9755df65f877e3ab8ddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F1z7av0Nt-bbz1NS"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">奥拉夫·阿伦斯·罗特内在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="9280" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">熊猫图书馆一直吸引着数据科学家用它来做令人惊奇的事情。毫无疑问，它是表格数据处理、操作和加工的首选工具。</p><p id="3239" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，为了扩展您的专业知识，挑战您现有的知识，并向您介绍数据科学家中众多受欢迎的Pandas功能，<em class="ls"> </em>我将介绍Pandas练习的第一部分。目标是增强您的逻辑能力，并帮助您用最好的Python包之一进行数据分析来内化数据操作。</p><p id="eb19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里找到包含本次测验所有问题的笔记本:<a class="ae kv" href="https://github.com/ChawlaAvi/Pandas-Quiz-P1" rel="noopener ugc nofollow" target="_blank"> GitHub </a>。</p><p id="3572" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">目录:</strong></p><p id="aa9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="#54af" rel="noopener ugc nofollow"> 1。基于另一个列表</a> <br/> <a class="ae kv" href="#9c0c" rel="noopener ugc nofollow"> 2对数据帧进行排序。在DataFrame </a> <br/> <a class="ae kv" href="#3872" rel="noopener ugc nofollow"> 3中的特定位置插入一列。根据列的数据类型</a> <br/> <a class="ae kv" href="#689a" rel="noopener ugc nofollow"> 4选择列。计算每列的非NaN单元的数量</a> <br/> <a class="ae kv" href="#e829" rel="noopener ugc nofollow"> 5。将数据帧分割成相等的部分</a> <br/> <a class="ae kv" href="#e620" rel="noopener ugc nofollow"> 6。反转数据帧的行或列。重新排列数据帧</a> <br/> <a class="ae kv" href="#c3bb" rel="noopener ugc nofollow"> 8的列。获取数据帧的交替行</a> <br/> <a class="ae kv" href="#261e" rel="noopener ugc nofollow"> 9。在任意位置插入一行</a> <br/> <a class="ae kv" href="#4442" rel="noopener ugc nofollow"> 10。将函数应用于数据帧的每个单元格</a></p><p id="c087" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为练习，我建议你先自己尝试这些问题，然后看看我提供的解决方案。</p><p id="8316" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，我在这里提供的解决方案可能不是解决问题的唯一方法。你可能会得出不同的结论，但仍然是正确的。然而，如果发生这种情况，请留下评论，我会很有兴趣知道你的方法。</p><p id="37d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们开始吧！</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="54af" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated"><strong class="ak"> 1。基于另一个列表对数据帧进行排序</strong></h1><p id="037f" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">提示:给你一个数据框。此外，您还有一个包含数据帧中特定列的所有唯一值的列表。对数据帧进行排序，使列中的值以与给定列表中相同的顺序出现。</p><p id="77e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输入和预期输出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="737b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="2e59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里的想法是从给定的列表中生成一个序列。每个索引将表示字符，相应的值将指示位置。使用这个，我们可以将原始数据帧映射到生成的序列，并将其传递给<em class="ls"> sort_values() </em>方法进行引用，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="54c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，我们也可以使用merge来解决这个问题。如果你能明白这一点，请在评论中告诉我。</p><h1 id="9c0c" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated">2.在数据帧中的特定位置插入列</h1><p id="3f3a" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>假设您又有了一个类似上面使用的数据帧。此外，您会得到一个列表，其大小与给定数据帧中的行数相同。任务是将给定的列表作为新列插入到数据帧的给定位置。</p><p id="73d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输入和预期输出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne my l"/></div></figure><p id="33a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="5dd2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们可以使用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.insert.html" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> insert() </em> </a>方法，并将位置、列名和值作为参数传递，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf my l"/></div></figure><h1 id="3872" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated"><strong class="ak"> 3。根据列的数据类型选择列</strong></h1><p id="c835" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>我们都很熟悉基于行的过滤，不是吗？好吧，让我们试试别的。您的任务是从数据帧中筛选出所有符合给定数据类型的列。</p><p id="0b41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">投入和预期产出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne my l"/></div></figure><p id="1a1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="5d46" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们可以使用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.select_dtypes.html" rel="noopener ugc nofollow" target="_blank"><em class="ls">select _ dtypes()</em></a>方法，传递我们需要过滤出来的数据类型，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf my l"/></div></figure><h1 id="689a" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated">4.计算每列中非NaN单元格的数量</h1><p id="e4d8" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>接下来，给定一个DataFrame(一列或多列有NaN值)，需要打印每列非NaN单元格的个数。</p><p id="c753" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输入和预期输出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng my l"/></div></figure><p id="c4a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="cbad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们可以使用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.count.html" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> count() </em> </a>方法来获得结果:如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh my l"/></div></figure><h1 id="e829" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated"><strong class="ak"> 5。将数据帧分割成相等的部分</strong></h1><p id="13bf" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>给定一个数据帧，你的任务是将该数据帧分割成给定数量的相等部分。</p><p id="e0b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输入和预期输出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni my l"/></div></figure><p id="5516" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="3269" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们将使用NumPy的<a class="ae kv" href="https://numpy.org/doc/stable/reference/generated/numpy.split.html" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> split() </em> </a>方法，并将零件数作为参数传递，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf my l"/></div></figure><h1 id="e620" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated">6.按行或按列反转数据帧</h1><p id="49a6" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>接下来，考虑您有一个类似于我们上面使用的数据帧。你的任务是按行或列翻转整个数据帧。</p><p id="02a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输入和预期输出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj my l"/></div></figure><p id="a07d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="8de5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> loc </em> </a>(或<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> iloc </em> </a>)并使用“::-1”指定反向分度方法，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk my l"/></div></figure><h1 id="5535" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated">7.重新排列数据帧的列</h1><p id="acc9" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>在这个练习中，给你一个数据框。此外，您还有一个指定列在数据帧中出现的顺序的列表。给定列表和数据框架，按照列表中指定的顺序打印各列。</p><p id="53eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">投入和预期产出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne my l"/></div></figure><p id="26bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="e8a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与上面类似，我们可以使用<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> iloc </em> </a>选择所有行，并指定列表中给定的列的顺序，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf my l"/></div></figure><h1 id="c3bb" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated">8.获取数据帧的交替行</h1><p id="7cb5" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>接下来，给定一个数据帧，您需要从数据帧的第一行开始打印每一个交替的行。</p><p id="5a12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输入和预期输出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf my l"/></div></figure><p id="c5f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="49e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个解决方案也和上面两个类似。这里，在定义切片部分时，我们可以将切片的步骤指定为2，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh my l"/></div></figure><h1 id="261e" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated">9.在任意位置插入一行</h1><p id="28dd" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>与前面的任务类似，您会看到相同的数据帧。您的任务是在数据帧的特定索引处插入一个给定的列表，并重新分配索引。</p><p id="00e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输入和预期输出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nl my l"/></div></figure><p id="284f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="9713" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给定一个插入位置，首先将新行分配给给定索引和前一个索引之间的一个索引。这就是赋值语句要做的事情。接下来，我们对索引上的数据帧进行排序。最后，我们重新分配索引以消除基于浮点的索引值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="4442" class="ma mb iq bd mc md mz mf mg mh na mj mk jw nb jx mm jz nc ka mo kc nd kd mq mr bi translated">10.将函数应用于数据帧的每个单元格</h1><p id="3100" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><strong class="ky ir">提示:</strong>最后，您需要给整个数据帧应用一个给定的函数。给定的数据帧仅由整数值组成。任务是通过函数将每个条目加1。</p><p id="57a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">投入和预期产出:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne my l"/></div></figure><p id="7718" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">解决方案:</strong></p><p id="9a6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们不使用apply()方法，而是使用如下所示的<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.applymap.html" rel="noopener ugc nofollow" target="_blank"> <em class="ls"> applymap() </em> </a>方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nf my l"/></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="5ab1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个小测验到此结束，我希望你喜欢尝试这个。让我知道你答对了多少。另外，如果你没有注意到，这个小测验可以在Jupyter笔记本上找到，你可以从<a class="ae kv" href="https://github.com/ChawlaAvi/Pandas-Quiz-P1" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="f978" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，不要走开，因为我打算很快发布更多的练习。感谢阅读。</p></div></div>    
</body>
</html>