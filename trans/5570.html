<html>
<head>
<title>Ace your Machine Learning Interview — Part 9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">赢得机器学习面试——第九部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ace-your-machine-learning-interview-part-9-2fd782b4bb8#2022-12-15">https://towardsdatascience.com/ace-your-machine-learning-interview-part-9-2fd782b4bb8#2022-12-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8fcd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 Python 深入研究混淆矩阵的性能评估指标和热图可视化</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/87df48a293544e546962f6c2ea568d50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tgydb-jFL-e_Etsl"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@jopwell?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">摄于<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的 Jopwell 系列</a></p></figure><p id="e982" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个<em class="ls">“Ace your Machine Learning Interview”</em>系列的这篇新文章中，我开始讨论一个不同的话题。我不会描述一种新的机器学习算法，而是向你展示如何评估一种算法是否工作良好。知道如何很好地评估一个 ML 系统和开发系统本身一样重要。</p><p id="138e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你在处理下一次面试时会发现它很有用！😁</p><h2 id="d10a" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">介绍</h2><p id="61d8" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">知道如何评估机器学习算法是非常重要的。如果我们不能判断算法的输出是好是坏，我们该如何改进我们的算法呢？有许多指标，有时很难浏览它们。你可能听说过类似于<strong class="ky ir"> ROC </strong>或<strong class="ky ir"> AUC </strong>的缩写，或者你可能听说过<strong class="ky ir"> Precision </strong>和<strong class="ky ir"> Recall </strong>以及其他指标。但是它们是什么，应该如何恰当地使用它们呢？</p><p id="8b64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些用于评估 ML 算法的各种度量可以从混淆矩阵中导出，混淆矩阵是算法预测我们的数据集中的标签有多好的一种“总结”。</p><p id="45e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我参加的最后一次面试中，特别是在计算机视觉领域，我被要求解释什么是混淆矩阵，以及如何使用 Python 在实际练习中实现它。所以我决定写这篇文章来和你分享我的经历。</p><p id="25fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我也想给你一个建议，当你面临面试的时候，好好重温一下机器学习的基础知识。通常招聘的公司更感兴趣的是知道你能掌握机器学习的主要概念，而不是知道最新和最深奥的神经网络架构是什么。</p><p id="7a58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我想谈谈如何阅读混淆矩阵，以及如何使用 Python 用几行代码实现它。</p><h2 id="dec5" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">混淆矩阵</h2><p id="c08e" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">先说最简单的情况。假设你正在训练任何分类器:它可以是基于逻辑回归或朴素贝叶斯或任何其他你想要的算法的分类器。</p><p id="835c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给定输入的分类器只需说明该输入是肯定的还是否定的(狗或猫是同一个东西)。首先，你要做的是<strong class="ky ir">计算出这个分类器错误输出了多少次，它猜对了哪些点</strong>。</p><p id="05c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我们可以开始计算他出错的次数。也就是说，它应该预测为正但预测为负的所有时间，以及它应该预测为负但预测为正的所有时间。然后我们也感兴趣的是算法给出了多少次正确的输出。也就是它正确预测了多少次正反。</p><p id="84a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了避免混淆，简单地<strong class="ky ir">在一个被称为混淆矩阵</strong> x. <strong class="ky ir">的表格中总结所有这些值，行代表实际标签，列代表预测标签</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/e574c2602e6325b0d0f852c4520c24cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uarYsqCOzzhIoa6wgTt1YQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">困惑矩阵(图片由作者提供)</p></figure><p id="1c59" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">真阳性(TP) </strong>:分类器正确预测阳性。<em class="ls">例</em>:分类器预测患者有肿瘤，是真的！</p><p id="7877" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">真阴性(TN): </strong>分类器正确预测阴性。<em class="ls">示例</em>:分类器预测患者没有肿瘤，事实上患者是健康的。</p><p id="f8dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">假阳性(FP): </strong>又称<strong class="ky ir"><em class="ls">1 型错误。</em> </strong>分类器预测为阳性，但要预测的标签为阴性。<em class="ls">例</em>:分类器预测患者患有癌症，但实际上是健康的。</p><p id="0b12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">假阴性(FN): </strong>又称<strong class="ky ir"><em class="ls">2 型错误。</em> </strong>分类器预测为阴性，但待预测的标签为阳性。<em class="ls">示例:</em>分类器预测患者没有肿瘤，而他有！</p><p id="ed6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来看一个如何在 Python 中使用 sklearn 计算混淆矩阵的例子。</p><p id="6913" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下虹膜数据集是 sklearn 在开放许可下提供的，在这里可以找到<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_iris.html#" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="744c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们将<strong class="ky ir">下载数据</strong>并且<strong class="ky ir">像往常一样通过使用 sklearn 函数将</strong>分割成<strong class="ky ir">训练和测试集</strong>。</p><pre class="kg kh ki kj gt mu mv mw bn mx my bi"><span id="eecc" class="mz lu iq mv b be na nb l nc nd">from sklearn import datasets<br/>import numpy as np<br/>from sklearn.model_selection import train_test_split<br/><br/>iris = datasets.load_iris()<br/><br/>x = iris.data<br/>y = iris.target<br/><br/>x_train, x_test, y_train, y_test = train_test_split(x,y, test_size = 0.3, stratify = y)</span></pre><p id="845e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在用你喜欢的分类器，在训练数据上训练它。在这种情况下，我将使用简单的<strong class="ky ir">逻辑回归</strong>。</p><pre class="kg kh ki kj gt mu mv mw bn mx my bi"><span id="8aa3" class="mz lu iq mv b be na nb l nc nd">from sklearn.linear_model import LogisticRegression<br/><br/>lr = LogisticRegression()<br/>lr.fit(x_train, y_train)</span></pre><p id="76dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们已经训练了我们的算法，剩下的就是对测试集进行预测。</p><pre class="kg kh ki kj gt mu mv mw bn mx my bi"><span id="910d" class="mz lu iq mv b be na nb l nc nd">predictions = lr.predict(x_test)</span></pre><p id="671f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了计算混淆矩阵所需的一切，从而对算法产生的错误有了更清楚的了解。为了计算混淆矩阵，我们只需要实现这两行代码。</p><pre class="kg kh ki kj gt mu mv mw bn mx my bi"><span id="8e64" class="mz lu iq mv b be na nb l nc nd">from sklearn.metrics import confusion_matrix<br/><br/>cf = confusion_matrix(y_test, predictions)<br/>print(cf)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/efd63a0bffa504fe2bb1f7dc0885b388.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*q5PbApjEL96y4urlSDDVBw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">困惑矩阵(图片由作者提供)</p></figure><p id="35a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就这样:你现在拥有了你的混乱矩阵。如果我能再给你一个建议的话，在我看来，<strong class="ky ir">这样显示出来的混淆矩阵还是可读性不太好</strong>。<strong class="ky ir">我经常喜欢把它显示成热图</strong>，这样当数字高的时候我就有明亮的颜色。这样，只要看一眼，我就能对我的算法的进展有个印象。为此，我使用了<strong class="ky ir"> Seaborn 库</strong>。</p><pre class="kg kh ki kj gt mu mv mw bn mx my bi"><span id="2813" class="mz lu iq mv b be na nb l nc nd">import seaborn as sns<br/><br/>sns.heatmap(confusion_matrix(y_test, predictions))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/868fe2069255cddc6686ada7af22ccad.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*8WmW2bEwAa7xBOqaxVqd6g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">混淆矩阵和热图(图片由作者提供)</p></figure><p id="b2c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我觉得好多了！因为大部分预测都是正确的，所以对角线上的颜色最浅。</p><h1 id="09bf" class="ng lu iq bd lv nh ni nj ly nk nl nm mb jw nn jx me jz no ka mh kc np kd mk nq bi translated">最后的想法</h1><p id="b2e1" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">知道如何评估你的机器学习算法是最重要的。为了做到这一点，知道如何计算和混淆矩阵代表什么肯定是第一步。在我经历的不同机器学习面试中，我经常不得不回答关于混淆矩阵和衍生指标的各种问题。因此，我希望这篇文章对您了解这个主题或刷新您的记忆有所帮助。😁</p><p id="0978" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您对本系列之前的文章感兴趣，我在这里留下了链接:</p><ol class=""><li id="880d" class="nr ns iq ky b kz la lc ld lf nt lj nu ln nv lr nw nx ny nz bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/ace-your-machine-learning-interview-part-1-e6a5897e6844"> <em class="ls"> Ace your Machine Learning 面试—第一部分</em> </a> <em class="ls">:深入线性、套索和岭回归及其假设</em></li><li id="6112" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/ace-your-machine-learning-interview-part-1-e6a5897e6844"><em class="ls">Ace your Machine Learning 访谈—第二部分</em> </a> <em class="ls"> 2:使用 Python 深入研究分类问题的逻辑回归</em></li><li id="1145" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/ace-your-machine-learning-interview-part-1-e6a5897e6844"><em class="ls">Ace your Machine Learning 面试—部分</em> </a> <em class="ls"> 3:使用 Python 深入研究朴素贝叶斯分类器</em></li><li id="6b59" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" href="https://medium.com/p/e30b695ce63/edit" rel="noopener"><em class="ls">Ace your Machine Learning 面试—第四部分</em> </a> <em class="ls">:深入研究使用 Python 的支持向量机</em></li><li id="ad71" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" href="https://medium.com/p/e30b695ce63/edit" rel="noopener"><em class="ls">Ace your Machine Learning 访谈—第五部分</em> </a> <em class="ls"> 5:使用 Python 深入研究内核支持向量机</em></li><li id="8a52" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" href="https://medium.com/p/5f0d84e435a1/edit" rel="noopener"><em class="ls">Ace your Machine Learning 面试—第六部分</em> </a> <em class="ls">:使用 Python 深入决策树</em></li><li id="0edb" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" href="https://medium.com/p/2688de34805f/edit" rel="noopener"><em class="ls">Ace your Machine Learning 面试—第七部分</em> </a> <em class="ls">:使用 Python </em>研究硬投票分类器的集成学习</li><li id="761e" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" href="https://medium.com/p/a9b94b8ed468/edit" rel="noopener"> <em class="ls"> Ace your Machine Learning 面试—第八部分</em> </a> <em class="ls">:使用 Python 从头开始使用 AdaBoost 进行集成学习</em></li></ol><h1 id="c6e9" class="ng lu iq bd lv nh ni nj ly nk nl nm mb jw nn jx me jz no ka mh kc np kd mk nq bi translated">结束了</h1><p id="a0e9" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated"><em class="ls">马赛洛·波利蒂</em></p><p id="20f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.linkedin.com/in/marcello-politi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae kv" href="https://twitter.com/_March08_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae kv" href="https://march-08.github.io/digital-cv/" rel="noopener ugc nofollow" target="_blank"> CV </a></p></div></div>    
</body>
</html>