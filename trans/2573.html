<html>
<head>
<title>Why PCA Looks Triangular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么PCA看起来是三角形的</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-pca-looks-triangular-a642daac721a#2022-06-04">https://towardsdatascience.com/why-pca-looks-triangular-a642daac721a#2022-06-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="68db" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences" rel="noopener" target="_blank">生命科学的数理统计和机器学习</a></h2><div class=""/><div class=""><h2 id="1aa8" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">通常在计算生物学中</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/995df7f3e4a7c9544919f3e46e63fcf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7kMLmwiGwOAqhP4Xf3G05A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">对1000个基因组遗传变异的主成分分析(左)，对微生物丰度HMP数据的主成分分析(右)。作者图片</p></figure><p id="1029" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是我的专栏<a class="ae md" href="https://towardsdatascience.com/tagged/stats-ml-life-sciences?source=post_page---------------------------" rel="noopener" target="_blank"> <strong class="lj jd">生命科学的数理统计和机器学习</strong> </a>中的<strong class="lj jd">第二十四篇</strong>文章，在这里我用通俗易懂的语言讨论了计算生物学和生命科学中一些有趣的分析方法。<a class="ae md" href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="noopener ugc nofollow" target="_blank">主成分分析</a>广泛应用于计算生物学，特别是<a class="ae md" href="https://en.wikipedia.org/wiki/Population_genetics" rel="noopener ugc nofollow" target="_blank">群体遗传学</a>、<a class="ae md" href="https://en.wikipedia.org/wiki/Microbial_ecology" rel="noopener ugc nofollow" target="_blank">微生物生态学</a>、<a class="ae md" href="https://en.wikipedia.org/wiki/Single_cell_sequencing" rel="noopener ugc nofollow" target="_blank">单细胞分析</a>，用于建立样本与细胞之间的<strong class="lj jd">关联性</strong>。PCA经常呈现出一种奇特的<strong class="lj jd">三角形</strong>或<strong class="lj jd">拱形</strong>或<strong class="lj jd">马蹄形</strong>形状，这可以用数据中一些有趣的潜在模式来解释。在这篇文章中，我将讨论哪些数据可以导致三角PCA结构，以及为什么理解这种效应对于<strong class="lj jd">仔细</strong>解释PCA图很重要。</p><h1 id="c4c6" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">为什么PCA而不是tSNE用于群体遗传学？</h1><p id="9d53" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">从遗传变异和微生物组数据(上图)到<strong class="lj jd">单细胞</strong>基因表达分析(下图)，显著的三角形PCA模式在生命科学中随处可见。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/b88a097b363525f18ff749e08a56df23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iP442jTqTr1FvrbqZEyW1g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PCA对来自<a class="ae md" href="https://pubmed.ncbi.nlm.nih.gov/30514914/" rel="noopener ugc nofollow" target="_blank">癌症相关成纤维细胞</a>(左)和<a class="ae md" href="https://www.nature.com/articles/ni.3368" rel="noopener ugc nofollow" target="_blank">先天淋巴细胞</a>(右)的基因表达的影响</p></figure><p id="cd4d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">然而，正如人们所看到的，PCA似乎没有提供足够的<strong class="lj jd">分辨率</strong>来辨别单细胞基因表达分析中的不同细胞类型，而<a class="ae md" href="https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding" rel="noopener ugc nofollow" target="_blank"> tSNE </a>或<a class="ae md" href="https://umap-learn.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> UMAP </a>通常更能提供这方面的信息。相比之下，群体遗传学和基因组学研究人员很少(或几乎从不)使用tSNE和UMAP，样本之间的遗传相似性通常通过PCA或<a class="ae md" href="https://en.wikipedia.org/wiki/Phylogenetic_tree" rel="noopener ugc nofollow" target="_blank">系统发育树</a>来建立。为什么这两个领域在选择降维技术上有如此大的差异？一种解释似乎是<a class="ae md" rel="noopener" target="_blank" href="/how-exactly-umap-works-13e3040e1668">tSNE / UMAP提供样本聚类之间可靠相似性的内在困难</a>，这使得使用tSNE/UMAP进行群体遗传学分析非常成问题，其中一个非常重要的目标是建立不同群体之间的遗传距离。相比之下，主成分分析可以提供更准确的样本组之间的关系，但对于发现样本之间的异质性(即样本总体)可能不是那么方便。另一方面，在计算PCA之前，从人类学和考古学研究中，群体通常在群体遗传学中是已知的，因此这里的目标不是发现它们，而是理解群体之间的<strong class="lj jd">相互关系</strong>。</p><h1 id="2558" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">遗传距离和地理距离之间的联系</h1><p id="33f5" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">通过PCA可视化精确的遗传相似性对于<strong class="lj jd">群体遗传学</strong>如此重要的原因之一是，人们很早就认识到世界人口的遗传距离和地理距离之间存在某种相关性。Menozzi、Piazza和Cavalli-Sforza在1978年注意到了这一趋势，并建议将新石器时代的农业迁移作为这一效应的可能解释。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/be4c787a2a388e566b2b538c48a0f85f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kc1fVM1aKLy2nvXy75Dhgg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Menozzi，Piazza和Cavalli-Sforza，科学，第201卷，第786页，1978年</p></figure><p id="e53e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">后来，随着<a class="ae md" href="https://en.wikipedia.org/wiki/Massive_parallel_sequencing" rel="noopener ugc nofollow" target="_blank">下一代测序</a>技术的兴起，当更全面的采样变得可用时，<a class="ae md" href="https://www.nature.com/articles/nature07331" rel="noopener ugc nofollow" target="_blank">约翰·十一月布雷和合著者</a>提出，欧洲的地理地图自然出现，作为欧洲人遗传变异的有效二维PCA总结。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/b074a29efa5b2930b30de0f6f3b57d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lrsSffSEKiYk6OPXnbtl1Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae md" href="https://www.nature.com/articles/nature07331" rel="noopener ugc nofollow" target="_blank"> J. Novembre等人，自然，第456卷，第98页，2008年</a></p></figure><p id="db0d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">事实上，从上图可以看出，根据欧洲人的基因变异计算出的五氯苯甲醚图可以很好地反映欧洲地图。此外，有人提出，PCA成分可用于准确预测欧洲人的血统(即原产地)的<strong class="lj jd">。也请注意上图中PCA图壮观的<strong class="lj jd">三角形</strong>形状。</strong></p><h1 id="c2c3" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">随机数据的主成分分析</h1><p id="0666" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">我们看到<strong class="lj jd"> PCA是建立样本组之间<strong class="lj jd">相似性</strong>的重要工具</strong>，在群体遗传学的情况下，PCA的三角形形状在关联遗传和地理距离时可能是有意义的。然而，事实证明，生命科学中的某些数据类型能够产生三角形或楔形的PCA图，这是因为数据的非高斯性质，即如果在计算PCA之前没有对数据进行适当的转换。为了证明这一点，让我们使用不同的概率分布，如泊松分布、二项式分布等，生成样本之间没有结构或相关性的随机数据矩阵<strong class="lj jd">。这在生命科学中是常见的，并在模拟数据上计算PCA。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nf"><img src="../Images/557a166041d9276bbea5df302a983f89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4sc2IY1rkBGxQ7BWcrBNA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="4d99" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里，人们可以观察到，通常没有任何相关结构的<strong class="lj jd"/>分布数据应该给出围绕PCA图原点的数据点的<strong class="lj jd">近似球形分布</strong>。遵循<strong class="lj jd">均匀</strong>分布的随机数据产生了一个有趣的<strong class="lj jd">方形</strong>外观的主成分分析，就好像在两个正交的方向上拉动前面图上的高斯圆。非常值得注意的是，泊松、对数正态和负二项分布数据往往在PCA图中形成三角形或楔形结构。甚至，二项式分布的数据有时会给出一个看起来像<strong class="lj jd">楔形或三角形</strong>的PCA，见上图。事实是，模拟的统计观察应该是独立于<strong class="lj jd">的</strong>，也就是说，随机数据矩阵中没有相关性，并且样本不应该形成聚类。然而，稍微发挥一下<strong class="lj jd">想象力</strong>，人们就可以将三角形/楔形PCA形状的顶点中的点误解为属于不同细胞群或人类群体的<strong class="lj jd">。</strong></p><p id="454f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这些三角形或楔形结构可以部分地由计算生物学中许多类型数据的<strong class="lj jd">非高斯性</strong>来解释，这似乎违反了PCA的一个非常基本的假设。也就是说，PCA可以被看作是用两个矩阵(加载和得分)的乘积来逼近一个数据集，数据和逼近之间的平方误差的以下<strong class="lj jd">隐式最小化</strong>。平方误差的最小化意味着假设近似误差或残差的正态/高斯分布，如果数据矩阵X不遵循高斯分布，这可能<strong class="lj jd">难以</strong>满足。有人会问，在非正态分布的数据上使用PCA是否可行？实际上，如果在计算PCA之前已经应用了一些<strong class="lj jd">数据</strong> <strong class="lj jd">变换</strong>，PCA通常在非正态分布的数据上运行。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ng"><img src="../Images/5c209f29b8beeab5adc29122357d4ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPFJuxjoUo58OM9EgCQpeQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="ca8e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">标准化和<strong class="lj jd">对数变换</strong>通常在PCA之前应用于许多生命科学数据，即<strong class="lj jd">屏蔽</strong> <strong class="lj jd">数据的非高斯性</strong>并满足PCA的正态性假设。在实践中，这通常会导致五氯苯甲醚图呈不太明显的三角形。让我们将标准化和对数变换应用于先前模拟的数据矩阵，并观察差异。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nf"><img src="../Images/a7374256d51823b57488fbdf1b041ce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kGI-eD-kqV3VgAdRhGi0g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="0ccf" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以观察到，一旦应用了<strong class="lj jd">对数变换</strong>和<strong class="lj jd">标准化</strong>，PCA图中数据点的分布变得越来越呈球形。这直观地意味着在高维空间中没有数据的优选取向的<strong class="lj jd">方向，即所有方向都具有同等的信息性/重要性。</strong></p><p id="138f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上面的例子处理的是纯随机数据<strong class="lj jd">，样本之间没有任何相关</strong>结构。然而，通常在基因表达或微生物丰度数据中存在大量相关性，其中样品或细胞可能不是独立的并形成集群。在这种情况下，可以获得有意义的三角形PCA图，其中三角形的顶点通常表示不同的样本总体。下面讨论一个有趣的例子，叫做<strong class="lj jd">拱门</strong>或<strong class="lj jd">马蹄效应</strong>。</p><h1 id="e376" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">具有块结构的数据，以及拱形效应</h1><p id="bc8e" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">就我的经验而言，拱形效应或马蹄形效应在遗传学或单细胞分析中讨论得不多，但在微生物生态学中却很有名。人们需要检查例如一些<a class="ae md" href="https://stats.stackexchange.com/questions/158552/what-is-the-horseshoe-effect-and-or-the-arch-effect-in-pca-correspondence" rel="noopener ugc nofollow" target="_blank">旧的讨论</a>来获得关于效果的更多信息。还有这篇<a class="ae md" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5320001/" rel="noopener ugc nofollow" target="_blank">优秀论文</a>提供了关于马蹄效应起源的见解，我强烈推荐阅读。</p><p id="e9fb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">事实证明，当统计观察值之间存在强<strong class="lj jd">相关性</strong>时，即当样品/细胞属于<strong class="lj jd">不同的簇/群</strong>时，可以得到三角形的PCA。在这种情况下，数据矩阵具有特殊的形式:人们可以直观地观察到对于一些样本和一些变量具有大值的元素的<strong class="lj jd">块</strong>，而低值<strong class="lj jd">零</strong>在矩阵中的其他任何地方。让我们用<strong class="lj jd">两个这样的块</strong>模拟一个数据矩阵，并将矩阵的元素可视化为热图。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nh"><img src="../Images/5101244c15d886c12bddf864514170e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O2Fvlrm8ea3x1yqRopoY-g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="766f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">上面模拟的数据矩阵包含200个样本(S0，…，S199)和200个变量(V0，…，V199)。热图中较暗的区域对应于矩阵的<strong class="lj jd">零</strong>个元素，而较亮的颜色对应于矩阵元素的较大值。因此，<strong class="lj jd">数据矩阵由</strong> <strong class="lj jd">两个空白块</strong>或<strong class="lj jd">簇</strong>或总体组成，其中样本S0、…、S99看起来完全<strong class="lj jd">与样本S100、…、S199解耦</strong>，因为它们没有公共变量，即变量V0、…、V99仅对于样本S0、…、S99具有非零值，而变量V100、…、V199仅对于样本S100、…、S199具有非零值这是一个极端的解耦，<strong class="lj jd">对于现实世界的项目来说，这种情况很少发生</strong>，但是这个模拟将帮助我们<strong class="lj jd">建立我们的</strong> <strong class="lj jd">直觉</strong>关于是什么导致了PCA图中的<strong class="lj jd">三角形结构。在微生物生态学中，研究人员通常谈论导致这种块状数据(pH、温度等)的<strong class="lj jd">环境</strong> <strong class="lj jd">梯度</strong>。).通过对两个块中变量的元素进行平均，我们确实可以查看数据矩阵，就好像两个不相互作用的<strong class="lj jd">物种</strong>存在于不共享环境的数据中，即无法找到两个物种都存在的样本。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ni"><img src="../Images/e18fddf35dd7c2eed133a9653f3ae198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qVVLXTuMLzFjMKQnwqvHKQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="7abb" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">因此，人们可以得出这样的结论:如果样品碰巧是按照<strong class="lj jd">强</strong> <strong class="lj jd">环境梯度</strong>排序的，这可能会导致某种物种在一组样品中大量存在，而在其他组中完全不存在的情况。例如，土壤微生物组可能与海洋微生物组非常不同。在这种情况下，计算来自 <strong class="lj jd">极端不同环境</strong>的样本之间的正确<strong class="lj jd">相似性通常变得越来越成问题。然而，在这里，为了演示和建立我们的直觉，让我们在块数据矩阵上计算PCA，并可视化PCA图和显示由每个主成分解释的方差的图。</strong></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nj"><img src="../Images/e4c3162e104c9ade5a56a7459b46f93a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GUBrJVs7ovHHRL1BOSSJxA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片作者。添加红色虚线(右图)是为了突出潜在的三角形</p></figure><p id="95dd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里我们可以观察到<strong class="lj jd">数据中几乎所有的方差都被第一主成分</strong>捕获。这并不奇怪，因为我们知道在样本中有两个集群的非常强的主导分组效应(<strong class="lj jd">梯度</strong>)。因此，人们可以将领先PC的数量k(解释了数据中的大部分变化)视为一种<strong class="lj jd">快速方法，以将数据中的聚类数量估计为k+1个聚类</strong>。</p><p id="06be" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">接下来，我们或许可以观察到，使用<strong class="lj jd">两块</strong>矩阵，著名的PCA三角形开始变得更加明显，不过，通过一些<strong class="lj jd">想象</strong>，我用红色虚线突出显示了它。我们可以在PCA图中清楚地看到两个集群。然而，如果我们<strong class="lj jd">增加</strong>数据矩阵中的块数，会发生什么呢？让我们模拟一个具有三个块的数据矩阵，并可视化每个PC解释的方差以及PCA和tSNE图，以进行比较。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/ebf782b430351c6c12ce5ec50ff368a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Her80q5tYB5MEy3bT1W-YA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="6215" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">正如所料，我们看到<strong class="lj jd">两个PC</strong>解释了<strong class="lj jd">数据中的大部分方差</strong>，并且<strong class="lj jd">三组样本</strong>在PCA和tSNE图中都清晰可见。然而，当集群数量增加更多时，即当我们拥有超过2–3个集群时，情况会发生巨大变化。现在让我们用10个不同的样本群体来模拟一个块矩阵。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/1efad7e377332d886324ee78ca6377b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4dh20OVxlWuTwJzsgk03NQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="c062" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">值得注意的是，我们<strong class="lj jd">似乎不能区分2D PCA图中的</strong> 10个集群，事实上一些种群似乎<strong class="lj jd">聚集在一起</strong>，以至于<strong class="lj jd">从PCA图的视觉检查中检测不到超过4个清晰的集群</strong>。这意味着，即使我们提供了数据中样本总体的准确数量<strong class="lj jd">和</strong>，任何聚类算法都很难根据<strong class="lj jd">两个主成分</strong>对样本进行分组。因此，需要考虑两个以上的主成分来获得样本的正确聚类，然而，这将越来越难以可视化，甚至更难在降维和聚类之间达成一致。引人注目的是，<strong class="lj jd"> tSNE似乎只用两个潜在的tSNE变量</strong>就能轻松解决所有10个集群 <strong class="lj jd">。即使总的来说这不是一个好主意，但对于这种特殊的情况，在2D tSNE图上进行聚类将是成功的，也就是说，人们可以很容易地将所有样本归入它们的10个群体。</strong></p><h1 id="107b" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">具有模糊块和马蹄铁效应的数据</h1><p id="ad54" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">上一节所示的<strong class="lj jd">极端</strong> <strong class="lj jd">块</strong>结构在现实世界数据中很少见到。通常，样本聚类不太透明，人们可能会认为具有更多<strong class="lj jd">模糊块</strong> <strong class="lj jd">结构</strong>的数据矩阵对于生命科学项目来说非常典型。给先前的块矩阵增加一些“模糊性”的一种方法是创建一个<strong class="lj jd">带数据矩阵</strong>，其中只有对角线周围的元素是非零的。这里，我们仍然怀疑一些样本块，但是它们<strong class="lj jd">不像上一节中的</strong>那样透明。让我们用<strong class="lj jd">两个“模糊”模块</strong>模拟并可视化一个典型的波段数据矩阵。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nl"><img src="../Images/b258eef165e879a27e5770f6c8fedc77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5u1ymkWreMSeVOg2NtfuA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片作者。添加绿色和蓝色虚线是为了突出显示模糊的块</p></figure><p id="7af0" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这种<strong class="lj jd">带矩阵</strong>可能会在计算生物学项目中出现，当样本有很强的<strong class="lj jd">空间</strong>或<strong class="lj jd">时间</strong>排序时，通常他们说有一个<strong class="lj jd">梯度</strong>影响样本中的丰度。这种梯度的例子可以是<strong class="lj jd"> pH </strong>、<strong class="lj jd">温度</strong>、<strong class="lj jd">空间坐标</strong>、采样的时间周期，也可以有诸如批次(实验室、技术、国家)的技术梯度。使用上一节中关于在特定环境中存在但在其他环境中不存在的物种的<strong class="lj jd">直觉</strong>，我们可以再次对以下变量组中的矩阵元素进行平均:V0、…、V99 ( <strong class="lj jd">“物种1”</strong>)和V100、…、V199 ( <strong class="lj jd">“物种2”</strong>)，并观察到从一种环境改变到另一种环境时物种1和2丰度的更为<strong class="lj jd">渐进的</strong>，即不太突然的变化在下文中，我们可以观察到，例如，物种1也可以存在于上一节中仅由物种2占据的环境中，但是丰度较低。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ni"><img src="../Images/bfd002c708e935af967f28b1554b24b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8gRo-CwOQ0teMJZQSZY2WQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="ef0c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">一个<strong class="lj jd"> PCA </strong>用于<strong class="lj jd">波段矩阵</strong>怎么样？下面，我们将计算由主成分解释的方差以及带数据矩阵的PCA图，该带数据矩阵具有两个可能的模糊聚类。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nm"><img src="../Images/d73fc07fb52b3a43b4b71a064e459fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IgGl43izr5_1YjwQBIjEOQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="a7f8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里我们观察PCA图中著名的<strong class="lj jd">拱门或马蹄铁</strong>。数据点分布的形状仍然有点像三角形，拱形或马蹄形的两个“翅膀”对应于两个不同的簇。另外，请注意由主成分图解释的方差的逐渐变化。对于干净的块结构矩阵，有<strong class="lj jd">几个同样重要的</strong> <strong class="lj jd">主导PC</strong>，而现在有<strong class="lj jd">一个主导PC </strong>，其通常对应于主导带数据矩阵的值的强<strong class="lj jd">梯度</strong>(例如<strong class="lj jd">时间</strong>)。通常，他们说马蹄形PCA图中的样本按时间从早到晚排序<strong class="lj jd">、</strong>即<strong class="lj jd">时间排序</strong>，或从地理西到地理东(<strong class="lj jd">空间排序</strong>)。在单细胞分析中，当监测<strong class="lj jd">干细胞分化</strong>时，换句话说，当细胞沿着所谓的<a class="ae md" href="https://www.nature.com/articles/nbt.2859" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">细胞命运轨迹</strong> </a>排序时，这种有序的细胞“线”是典型的。通常，<a class="ae md" href="https://academic.oup.com/bioinformatics/article/31/18/2989/241305" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">扩散图</strong> </a>(另一种降维技术)在解析<strong class="lj jd">细胞轨迹</strong>方面表现出色，在单细胞生物学<strong class="lj jd">中与<strong class="lj jd">细胞发育</strong>一起工作时，广泛使用<strong class="lj jd">代替PCA </strong>。</strong></p><p id="8c77" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">PCA图中奇特的拱形或马蹄形形状的形成与数学上已知的<a class="ae md" href="https://en.wikipedia.org/wiki/Lissajous_curve" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd">李沙育曲线</strong> </a>有关。这也在群体遗传学文献中被注意到，例如见2008年11月Stephens在《自然遗传学》中的文章。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nn"><img src="../Images/d2e032702cafff3a231bd885d4d3af6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVJAzv8fPQidRc-BW3cHcw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">从具有马蹄形效应的PCA中可见的利萨如曲线。遗传学2008</p></figure><p id="628f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当<strong class="lj jd">样本已经沿着环境梯度</strong><strong class="lj jd"/>排序时，如果我们将每个主成分绘制为样本数量的函数，则可以看到那些<strong class="lj jd">曲线</strong>。让我们检查这些曲线从模拟带矩阵上计算的PCA中是否可见:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/cdd5ae85fb1fbd855814afabd50647bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xgb3VbTs2a-IllI_lREkeA.png"/></div></div></figure><p id="0c1e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">的确，非常有趣和<strong class="lj jd">奇特的形状</strong>！请注意，PC1似乎与环境梯度密切相关。现在，如果我们考虑三个“模糊”样本总体，会发生什么？</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/e5e0855c530c7274debfda006b8c281c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0HzQtVHfaUb523ryiLqZ1Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="a88b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以看到马蹄铁的两端开始向质心弯曲。我们可以观察到的另一件事是深绿色和品红色样本群体看起来彼此非常遥远，而红色样本群体是共同的邻居。如果我们查看<strong class="lj jd">波段数据矩阵</strong>并认识到前100个(深绿)和后100个(洋红)样本<strong class="lj jd">几乎不共享任何变量</strong>，而红色样本(波段矩阵中间的100个样本)与洋红和深绿样本群体共享大量V变量，则可以直观地理解这种效应<strong class="lj jd">。现在，我们将更多地增加“模糊”块的数量，看看对于<strong class="lj jd"> 10个样本群体</strong>的PCA和tSNE图会发生什么。</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/c5c170bf7fb52c6050829a3366191f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UihCBzxHGYWbjwPwUlBQBQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="c653" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里一个明显的观察结果是，PCA图中马蹄铁的两端现在向马蹄铁的质心弯曲了很多。因此，这里我们有一个反直觉的效果:马蹄形两端 <strong class="lj jd">的金色和深绿色样本群<strong class="lj jd">看起来比马蹄形</strong>中间的青色和蓝色样本群<strong class="lj jd">彼此更接近<strong class="lj jd">，并且如果我们增加数据矩阵中模糊块的数量，它们将彼此更加接近。现在，假设有一个<strong class="lj jd">时间梯度</strong>沿着马蹄形起作用，即样本从早时间到晚时间</strong>排序<strong class="lj jd">，深绿色样本最年轻，金色样本最老，而青色和蓝色样本来自一些中间时间点。这种马蹄铁两端</strong>的<strong class="lj jd">相互靠近意味着<strong class="lj jd">最小的</strong>和<strong class="lj jd">最大的</strong>样本<strong class="lj jd">与来自<strong class="lj jd">中间时间点</strong>的样本相比</strong>变得非常相似，这很奇怪。人们会<strong class="lj jd">期望</strong>相对于来自中间时间点的样本，最年轻和最老的样本彼此更加<strong class="lj jd">不相似</strong>。</strong></strong></strong></p><p id="5a25" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在比较世界人口的遗传变异时，对五氯苯甲醚图中马蹄形的解释变得更加棘手。如果存在样本的<strong class="lj jd">空间梯度</strong> <strong class="lj jd">【地理分离】</strong><strong class="lj jd">其中遗传变异被测量为条带矩阵中的V-变量，那么从PCA图看起来，来自远东的种群与来自远西的种群在遗传上比它们的共同邻居更相似</strong>。因此，拱形和马蹄形效应通常被认为是<a class="ae md" href="http://ordination.okstate.edu/CA.htm" rel="noopener ugc nofollow" target="_blank">微生物生态学</a>中的一种<strong class="lj jd">假象</strong>，最近在群体遗传学中也是如此，在群体遗传学中发展了特殊的方法<strong class="lj jd">来最小化这些效应</strong>，例如参见Francois &amp; Jay在《自然通讯2020》中的<strong class="lj jd">因子分析</strong>方法。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi no"><img src="../Images/58e37f08327ab5a21c1ac6622374e28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LdGcjCyl5TwhT2PiYlbe2w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">消除五氯苯甲醚马蹄形效应的因子分析，Francois &amp; Jay，Nat。通信2020</p></figure><h1 id="13c8" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">摘要</h1><p id="9645" class="pw-post-body-paragraph lh li it lj b lk mw kd lm ln mx kg lp lq my ls lt lu mz lw lx ly na ma mb mc im bi translated">在本文中，我们了解到，在生命科学的各个领域，如微生物生态学、群体遗传学和单细胞生物学中，经常可以看到特殊的三角形PCA结构。我们讨论过，假设数据的<strong class="lj jd">概率分布</strong>不远离正态分布，这对于PCA是必不可少的，PCA图中数据点的三角形分布通常意味着数据中存在<strong class="lj jd">相关结构</strong>。特别是，当数据矩阵由不同的或模糊的样本块组成时，它会导致一个拱形(T20)<strong class="lj jd">或马蹄形</strong><strong class="lj jd"/><strong class="lj jd">效应</strong>，有时会导致对PCA图中聚类的错误生物学解释。尽管如此，PCA似乎仍然比tSNE和UMAP更准确，更适用于群体遗传学，其中样本(群体)聚类之间的遗传相关性至关重要。</p><p id="54fa" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">像往常一样，让我在下面的评论中知道生命科学<strong class="lj jd"> </strong>和计算生物学的哪些分析方法对你来说似乎<strong class="lj jd">特别神秘</strong>，我将在这个专栏中尝试解决它们。在我的<a class="ae md" href="https://github.com/NikolayOskolkov/WhyPCALooksTriangular" rel="noopener ugc nofollow" target="_blank"> github </a>上查看帖子使用的文件。在<strong class="lj jd">Medium</strong><a class="np nq ep" href="https://medium.com/u/8570b484f56c?source=post_page-----a642daac721a--------------------------------" rel="noopener" target="_blank"><strong class="lj jd">Nikolay Oskolkov</strong></a>关注我，在<strong class="lj jd">Twitter</strong>@ NikolayOskolkov关注我，并通过<a class="ae md" href="http://linkedin.com/in/nikolay-oskolkov-abb321186?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd"> Linkedin </strong> </a>连接。在下一篇文章中，我们将讨论<strong class="lj jd">如何在UMAP空间</strong>聚集，敬请关注。</p></div></div>    
</body>
</html>