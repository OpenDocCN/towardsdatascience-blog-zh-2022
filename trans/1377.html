<html>
<head>
<title>How to Easily Build Your First Machine Learning Web App in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python轻松构建第一个机器学习Web应用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-build-your-first-machine-learning-web-app-in-python-c3d6c0f0a01c#2022-04-06">https://towardsdatascience.com/how-to-easily-build-your-first-machine-learning-web-app-in-python-c3d6c0f0a01c#2022-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="21bc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python中的Flask创建ML web应用程序的分步指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3bae4bc7d0c9cb0160ae681036622ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OXbPW9eu8VB-oRUD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用<a class="ae ky" href="https://www.pexels.com/@format-380633" rel="noopener ugc nofollow" target="_blank">格式</a>在<a class="ae ky" href="https://www.pexels.com/photo/photo-of-imac-near-macbook-1029757/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍照</p></figure><p id="c760" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建机器学习模型最酷的部分之一是与他人分享我们构建的模型。</p><p id="d47f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不管你建立了多少模型，如果它们离线，只有很少的人能够看到你的成就。这就是为什么我们应该部署我们的模型，这样任何人都可以通过一个漂亮的UI来使用它们。</p><p id="56c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将从头开始使用Flask部署一个线性回归模型。Flask是一个Python框架，让我们可以轻松开发web应用程序。遵循本指南后，您将能够在浏览器中使用简单的机器学习模型，如下图gif所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/07d51d745948db4ed8b5cfddc7891bfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gn36zjJRoqi1l6fXf4YuDQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="79b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本指南分为两部分。在第1节中，我们将快速构建我们的模型，在第2节中，我们将从头开始构建web应用程序。本指南的主要目的是构建一个ML web应用程序，所以你可以去我的<a class="ae ky" href="https://github.com/ifrankandrade/ml-web-app.git" rel="noopener ugc nofollow" target="_blank"> Github </a>下载在第一部分创建的模型(model.pkl)并跳到第二部分。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="597f" class="mb mc it lx b gy md me l mf mg"><strong class="lx iu">Table of Contents<br/></strong>1. <a class="ae ky" href="#7113" rel="noopener ugc nofollow">Building a Simple Machine Learning Model</a><br/> - <a class="ae ky" href="#a1b9" rel="noopener ugc nofollow">First things first — Libraries and Dataset</a><br/> - <a class="ae ky" href="#b886" rel="noopener ugc nofollow">The dependent and independent variable</a><br/> - <a class="ae ky" href="#6bad" rel="noopener ugc nofollow">Fitting and saving the model</a><br/>2. <a class="ae ky" href="#e14b" rel="noopener ugc nofollow">Building The Web App with Flask</a><br/> - <a class="ae ky" href="#17b3" rel="noopener ugc nofollow">Setting up a new virtual environment</a><br/> - <a class="ae ky" href="#e0d6" rel="noopener ugc nofollow">Installing Flask and quick setup</a><br/> - <a class="ae ky" href="#4a1e" rel="noopener ugc nofollow">Loading the model, building the home function and front end</a><br/> - <a class="ae ky" href="#0f0a" rel="noopener ugc nofollow">Building the form and predict function</a></span></pre><p id="dbd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mh">不想看书？你可以看我的视频！</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure><h1 id="7113" class="mk mc it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">1.构建一个简单的机器学习模型</h1><p id="b815" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">最简单的机器学习算法之一是线性回归。在本节中，我们将构建一个预测房价的多元线性回归。在这一节的最后，我们的模型将保存在pickle中，在下一节，我们将使用Flask部署我们的机器学习模型。</p><h2 id="a1b9" class="mb mc it bd ml ng nh dn mp ni nj dp mt li nk nl mv lm nm nn mx lq no np mz nq bi translated">先做最重要的事—库和数据集</h2><p id="7287" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">对于这一部分，我们必须安装scikit-learn和pandas:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9f89" class="mb mc it lx b gy md me l mf mg">pip install scikit-learn<br/>pip install pandas</span></pre><p id="53dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们将使用包含3列的数据集:值(以1000美元为单位)、房间数(每个住所的房间数)和距离(到就业中心的加权距离)。你可以在<a class="ae ky" href="https://github.com/ifrankandrade/ml-web-app.git" rel="noopener ugc nofollow" target="_blank"> Github </a>或者<a class="ae ky" href="https://drive.google.com/file/d/1tWpwUG56-7mBLmyETzf7ZtrcuzNMNjul/view?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Drive </a>上找到这个用Excel生成的随机数据。</p><p id="4dcf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用熊猫来看看这个数据集。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5c5d" class="mb mc it lx b gy md me l mf mg"><strong class="lx iu">import pandas as pd</strong><br/>df = pd.read_csv('prices.csv')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ca2025a864c1a58841effd485d07bae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*Pnh189OCsXtiDQrm4L9BxQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="ed1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的线性回归模型的目标是根据房屋的房间数量和到就业中心的距离来预测房屋价值。</p><h2 id="b886" class="mb mc it bd ml ng nh dn mp ni nj dp mt li nk nl mv lm nm nn mx lq no np mz nq bi translated">因变量和自变量</h2><p id="5259" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了建立我们的线性回归模型，我们必须定义因变量(结果)和自变量(预测)。</p><p id="9e2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们的因变量和自变量。</p><ul class=""><li id="704c" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">因变量:“值”</li><li id="f49e" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">自变量:“房间”和“距离”</li></ul><p id="e5b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是设置这两个变量的代码</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="6a5b" class="mb mc it lx b gy md me l mf mg">y = df['Value'] <br/>X = df[['Rooms', 'Distance']]</span></pre><h2 id="6bad" class="mb mc it bd ml ng nh dn mp ni nj dp mt li nk nl mv lm nm nn mx lq no np mz nq bi translated">拟合和保存模型</h2><p id="f105" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">通常，您需要争论数据、训练和验证结果，但是为了简单起见，我们将只关注模型的拟合和部署。</p><p id="9215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了构建我们的回归模型，我们需要从<code class="fe og oh oi lx b">sklearn</code>导入<code class="fe og oh oi lx b">linear_model</code>。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="8b78" class="mb mc it lx b gy md me l mf mg"><strong class="lx iu">from</strong> sklearn <strong class="lx iu">import</strong> linear_model</span><span id="9ad9" class="mb mc it lx b gy oj me l mf mg">lm = linear_model.LinearRegression()<br/>lm.fit(X, y)</span></pre><p id="2dba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们建立了<code class="fe og oh oi lx b">lm</code>模型，我们就可以预测给定<code class="fe og oh oi lx b">rooms</code>和<code class="fe og oh oi lx b">distance</code>的<code class="fe og oh oi lx b">value</code>。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="3ae5" class="mb mc it lx b gy md me l mf mg">lm.predict([[15, 61]]</span></pre><p id="eccf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果运行上面的代码，预测值将被打印出来。</p><p id="43fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那好吧！但是现在我们想把所有这些部署在一个网站上，这样任何人都可以玩我们的模型。在下一节中，我们将用Flask将所有内容从后端发送到前端，但在此之前，让我们用pickle保存我们的<code class="fe og oh oi lx b">lm</code>模型。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="4b53" class="mb mc it lx b gy md me l mf mg"><strong class="lx iu">import</strong> pickle<br/>pickle.dump(lm, open('model.pkl','wb')) </span></pre><p id="433a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意；如前例所示，<code class="fe og oh oi lx b">lm.predict()</code>接受数据帧格式的输入<code class="fe og oh oi lx b">[[]]</code>。在下一节中，请记住这一点。</p><h1 id="e14b" class="mk mc it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">2.用Flask构建Web应用程序</h1><p id="d436" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Python为构建web应用程序提供了不同的选项。烧瓶是最简单的选择之一。</p><p id="d9a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本节，建议创建一个新环境。使用不同的环境将有助于我们更好地管理构建模型和部署web应用程序所需的不同资源。</p><h2 id="17b3" class="mb mc it bd ml ng nh dn mp ni nj dp mt li nk nl mv lm nm nn mx lq no np mz nq bi translated">设置新的虚拟环境</h2><p id="dbc7" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在本节中，我将创建一个名为<code class="fe og oh oi lx b">deploy-mlmodel-env </code>的虚拟环境，在终端上运行以下命令。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="aa67" class="mb mc it lx b gy md me l mf mg">python3 -m venv <!-- -->deploy-mlmodel-env</span></pre><p id="11a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将创建一些其他文件夹来更好地组织我的目录。这是它的样子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/361a4af0b0a7d3d49d53e48e73a27a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*uzaIkpMqLlxEib6LQasucw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片bu作者</p></figure><p id="665a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以随意组织您的目录，但是要确保我们在上一节中保存的<code class="fe og oh oi lx b">model.pkl</code>在web app(我们将要构建的)所在的同一个文件夹中。</p><h2 id="e0d6" class="mb mc it bd ml ng nh dn mp ni nj dp mt li nk nl mv lm nm nn mx lq no np mz nq bi translated">安装烧瓶和快速设置</h2><p id="cc0c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">要安装Flask，请在终端上运行以下命令。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="4961" class="mb mc it lx b gy md me l mf mg">pip install flask</span></pre><p id="326f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，要检查一切工作正常，请遵循以下步骤。</p><p id="2eb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个新文件——我将命名为mine<code class="fe og oh oi lx b">app.py</code>——并粘贴以下代码(这是从<a class="ae ky" href="https://flask.palletsprojects.com/en/2.0.x/quickstart/" rel="noopener ugc nofollow" target="_blank"> Flask文档</a>中提取的一个最小的应用程序示例)</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="38b5" class="mb mc it lx b gy md me l mf mg"><strong class="lx iu">from</strong> flask <strong class="lx iu">import</strong> Flask<br/><br/>app = Flask<strong class="lx iu">(</strong>__name__<strong class="lx iu">)</strong><br/><br/>@app.route<strong class="lx iu">(</strong>"/"<strong class="lx iu">)</strong><br/><strong class="lx iu">def</strong> hello_world<strong class="lx iu">():</strong><br/>    <strong class="lx iu">return</strong> "&lt;p&gt;Hello, World!&lt;/p&gt;"</span><span id="9e30" class="mb mc it lx b gy oj me l mf mg">if __name__ == "__main__":<br/>    app.run()</span></pre><p id="e73b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开一个终端，使用<code class="fe og oh oi lx b">cd</code>进入<code class="fe og oh oi lx b">app.py</code>所在的工作目录，运行以下命令。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5c0b" class="mb mc it lx b gy md me l mf mg">python app.py</span></pre><p id="25cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应该会弹出以下消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/7498f0f54b70a219b5c5c0af1f0780bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nKTG9LWgPdZ76PapTi6kgQ.png"/></div></div></figure><p id="7883" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一行有一个格式为<code class="fe og oh oi lx b">127.0.0.1:port</code>的链接。指示我们的应用程序运行的位置。复制链接(我的是<code class="fe og oh oi lx b">http://127.0.0.1:5000</code>)粘贴到你的网页浏览器。如果在按下enter键后，您看到消息“你好，世界！”一切都设置正确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/aecd296d991f34e3358438e4a6ed7bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/0*6GOo7HY5BxCGoeCX.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:文献</p></figure><p id="dabd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我给你解释一下这个小脚本是做什么的。</p><ul class=""><li id="4741" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated"><code class="fe og oh oi lx b">app = Flask<strong class="lb iu">(</strong>__name__<strong class="lb iu">): </strong></code>创建Flask类的一个实例。<code class="fe og oh oi lx b">__name__ </code>是一个代表应用程序模块名称的变量(这有助于Flask知道在哪里寻找资源，比如我们稍后将使用的“模板”)</li><li id="89eb" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe og oh oi lx b">@app.route<strong class="lb iu">(</strong>"/"<strong class="lb iu">): @</strong></code>代表装饰者(他们修改函数或类的行为)。装饰器告诉Flask哪个URL应该触发我们的函数。在我们的例子中，主页(/)应该触发<code class="fe og oh oi lx b">hello_world()</code>函数。</li><li id="a5f0" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe og oh oi lx b">def hello_world<strong class="lb iu">(): </strong></code>该函数返回将在浏览器中显示的消息。</li></ul><h2 id="4a1e" class="mb mc it bd ml ng nh dn mp ni nj dp mt li nk nl mv lm nm nn mx lq no np mz nq bi translated">加载模型，构建主页功能和前端</h2><p id="0e47" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">现在是时候开始在我们之前创建的<code class="fe og oh oi lx b">app.py</code>文件中构建我们的web应用程序了。首先，我们导入<code class="fe og oh oi lx b">Flask</code>、<code class="fe og oh oi lx b">request</code>和<code class="fe og oh oi lx b">render_template</code>。</p><p id="1adb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们加载之前用pickle保存的线性回归模型<code class="fe og oh oi lx b">model.pkl</code>。</p><p id="a466" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们将把<code class="fe og oh oi lx b">hello_world</code>函数重命名为<code class="fe og oh oi lx b">home</code>。每当我们访问主页<code class="fe og oh oi lx b">(‘/’)</code>时，这个函数将呈现一个名为<code class="fe og oh oi lx b">index.html</code>的HTML文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on mj l"/></div></figure><p id="04b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe og oh oi lx b">index.html</code>文件将包含网站的前端(导航栏、按钮、图片等。).构建前端通常需要一些JavaScript和CSS的知识。也就是说，我们仍然可以只使用Bootstrap和基本HTML来构建很酷的web应用程序。</p><p id="ccb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要构建前端，首先在你的app所在的文件夹中创建一个名为“templates”(不能使用任何其他名称)的文件夹。在这个“模板”文件夹中创建一个HTML文件。我把这个文件命名为<code class="fe og oh oi lx b">index.html</code>，但是你可以随意命名。</p><p id="b000" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的目录应该如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/50ba2b1c06060d65dd6b61f72bceb112.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*LMSMg4Dve1KZ4kf-If7sTw.png"/></div></figure><p id="05db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开HTML文件，写下<code class="fe og oh oi lx b">doc</code>或<code class="fe og oh oi lx b">html</code>，然后按tab键。如果幸运的话，您的IDE将生成一个基本的HTML模板。如果没有，复制并粘贴以下模板。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on mj l"/></div></figure><p id="0640" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在添加引导程序，进入这个<a class="ae ky" href="https://getbootstrap.com/docs/5.1/getting-started/introduction/" rel="noopener ugc nofollow" target="_blank">网站</a>，将CSS部分的代码复制/粘贴到<code class="fe og oh oi lx b">index.html</code>的<code class="fe og oh oi lx b">&lt;head&gt;</code>部分。这将加载他们的CSS。</p><p id="444d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您找不到它，下面是要复制/粘贴的代码:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9d9d" class="mb mc it lx b gy md me l mf mg">&lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"&gt;</span></pre><p id="271a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了好玩，我们还会添加一个导航栏(我们实际上并不需要它，但它会帮助你习惯于引导程序)，所以去网站的<a class="ae ky" href="https://getbootstrap.com/docs/5.1/components/navbar/" rel="noopener ugc nofollow" target="_blank">导航栏</a>部分，复制代码并粘贴到<code class="fe og oh oi lx b">&lt;head&gt;</code>部分(就在CSS下面)</p><p id="c545" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的<code class="fe og oh oi lx b">index.html</code>文件应该是这样的(我知道看起来很吓人，但这只是我们复制的代码！)</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on mj l"/></div></figure><p id="0b35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在运行脚本之前，我将把第一行代码中的<code class="fe og oh oi lx b">light</code>元素改为<code class="fe og oh oi lx b">dark</code>，从而把导航条改为深色(如果保持不变，它将是浅色)。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="68ff" class="mb mc it lx b gy md me l mf mg">&lt;nav class=”navbar navbar-expand-lg navbar-<strong class="lx iu">dark</strong> bg-<strong class="lx iu">dark</strong>”&gt;</span></pre><p id="641e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，在正文部分，我将添加一个“Hello World！”：</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="7772" class="mb mc it lx b gy md me l mf mg">&lt;body&gt;<br/>  <br/>  &lt;h1&gt;"Hello World!"&lt;/h1&gt;</span><span id="b6f2" class="mb mc it lx b gy oj me l mf mg">&lt;/body&gt;</span></pre><p id="63fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在要看到所有这些变化，首先，按CTRL + C退出终端上运行的当前进程。在此之后，再次运行命令<code class="fe og oh oi lx b">python app.py</code>。</p><p id="328b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你去<a class="ae ky" href="http://127.0.0.1:5000" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000 </a>，你应该会看到以下内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/7eba8844485267e49f0fa26ff631e639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SKtinJ_4JiEe9kk5Dl6p_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="be3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！有标题、导航条和信息。现在，让我们构建实际的应用程序来处理预测。</p><h2 id="0f0a" class="mb mc it bd ml ng nh dn mp ni nj dp mt li nk nl mv lm nm nn mx lq no np mz nq bi translated">构建表单和预测函数</h2><p id="6c6a" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">预测功能将使用我们的机器学习模型进行预测。为此，首先，最终用户需要在表单中引入两个输入(房间和距离)。</p><p id="3d26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在<code class="fe og oh oi lx b">index.html</code>文件的<code class="fe og oh oi lx b">&lt;body&gt;</code>部分构建这个表单。</p><p id="9000" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们创建一个<code class="fe og oh oi lx b">&lt;form&gt;</code>标签。这将包含最终用户需要引入的输入。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="44cf" class="mb mc it lx b gy md me l mf mg">&lt;form action="{{url_for('predict')}}" method=”post”&gt;</span><span id="f5bb" class="mb mc it lx b gy oj me l mf mg">&lt;/form&gt;</span></pre><p id="ddc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参数<code class="fe og oh oi lx b">action </code>中的URL表示提交表单时将表单数据发送到哪里。</p><p id="1a20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们会将它发送到“/predict”(我们网站的一个新部分)。我们可以编写“/predict”或者使用<code class="fe og oh oi lx b">url_for() </code>函数来构建一个特定函数的URL。</p><p id="5266" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在表单部分，我们创建2个<code class="fe og oh oi lx b">&lt;input&gt;</code>标签和1个<code class="fe og oh oi lx b">&lt;button&gt;</code>。它们背后的代码很简单，所以我不会深入研究。</p><p id="d053" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重要的是要知道输入标签包含房间和距离变量，为了进行预测，用户需要点击“预测值！”按钮</p><p id="91dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们目前掌握的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on mj l"/></div></figure><p id="0a25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，我包含了添加空格的<code class="fe og oh oi lx b">&lt;br&gt;</code>标签和带有说明的<code class="fe og oh oi lx b">&lt;p&gt;</code>标签。此外，我将所有这些都放在一个带有<code class="fe og oh oi lx b">login</code>类的<code class="fe og oh oi lx b">&lt;div&gt;</code>中。</p><p id="4db5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们构建预测函数！</p><p id="886b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe og oh oi lx b">app.py</code>文件中，我们用URL“/predict”创建一个装饰器，它触发一个预测函数并呈现<code class="fe og oh oi lx b">index.html</code>文件。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="eb0e" class="mb mc it lx b gy md me l mf mg">@app.route('/predict',methods=['POST'])<br/><strong class="lx iu">def</strong> predict():</span><span id="a648" class="mb mc it lx b gy oj me l mf mg">    <strong class="lx iu">return</strong> render_template('index.html')</span></pre><p id="7893" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们需要从<code class="fe og oh oi lx b">flask</code>导入<code class="fe og oh oi lx b">request</code>来访问终端用户在表单中引入的值。</p><p id="1889" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">表单中的值以字典形状返回，因此我们必须使用方括号来获取每个值。一旦我们有了值，我们就把它们放在双方括号<code class="fe og oh oi lx b">[[ ]]</code>中进行预测(这是我们的<code class="fe og oh oi lx b">model.pkl</code>接受的格式)</p><p id="3465" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们正在构建的预测函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on mj l"/></div></figure><p id="03c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，<code class="fe og oh oi lx b">render_template</code>方法有一个名为<code class="fe og oh oi lx b">prediction_text</code>的新参数。该参数包含用户单击预测按钮后将弹出的消息。</p><p id="8c2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个消息现在在后端。要将其发送到前端，请在<code class="fe og oh oi lx b">index.html</code>文件的<code class="fe og oh oi lx b">&lt;body&gt;</code>中添加<code class="fe og oh oi lx b">prediction_text </code>变量。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="c9bc" class="mb mc it lx b gy md me l mf mg">&lt;body&gt;<br/> &lt;div class="login"&gt;<br/>   ...<br/>  &lt;b&gt; {{ prediction_text }} &lt;/b&gt;<br/> &lt;/div&gt;<br/>&lt;/body&gt;</span></pre><p id="ca05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后的<code class="fe og oh oi lx b">index.html</code>是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on mj l"/></div></figure><p id="caae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">而最后的<code class="fe og oh oi lx b">app.py</code>看起来是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on mj l"/></div></figure><p id="c84e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！现在用CTRL+C退出当前进程，在终端运行命令<code class="fe og oh oi lx b">python app.py</code>并转到<a class="ae ky" href="http://127.0.0.1:5000" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000 </a>。</p><p id="6cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您现在应该可以在浏览器中玩您的模型了！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/07d51d745948db4ed8b5cfddc7891bfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gn36zjJRoqi1l6fXf4YuDQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="ff82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://frankandrade.ck.page/bd063ff2d3" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入我的电子邮件列表，与10k以上的人一起获取我在所有教程中使用的Python for Data Science备忘单(免费PDF) </strong> </a></p><p id="4e59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你使用<a class="ae ky" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="ox oy gp gr oz pa"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div></div></div>    
</body>
</html>