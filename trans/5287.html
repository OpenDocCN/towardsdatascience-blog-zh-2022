<html>
<head>
<title>You deserve a better ROC curve</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你值得拥有更好的 ROC 曲线</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/you-deserve-a-better-roc-curve-970617528ce8#2022-11-27">https://towardsdatascience.com/you-deserve-a-better-roc-curve-970617528ce8#2022-11-27</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="6412" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">通过 ROC 阈值可视化提取更深入的见解</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj kg"><img src="../Images/61fe447442421f3de2ddc0a464321679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*47QOl7X_GmdFvUAjqbn3Og.png"/></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">具有可视化决策阈值的 ROC。我们将学习如何阅读它！图片作者。</p></figure><p id="1742" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">本文中的所有源代码都可以在 Github 上<a class="ae lo" href="https://github.com/peterbbryan/rainbow-roc/blob/main/scripts/sample_use.py" rel="noopener ugc nofollow" target="_blank">获得！在任何上下文中随意重用图形，无需注明出处(不保留任何权利)。</a></p><h1 id="e7dc" class="lp lq ir bd lr ls lt lu lv lw lx ly lz jx ma jy mb ka mc kb md kd me ke mf mg bi translated">动机</h1><p id="a528" class="pw-post-body-paragraph ks kt ir ku b kv mh js kx ky mi jv la lb mj ld le lf mk lh li lj ml ll lm ln ik bi translated">接收器操作特性(ROC)曲线对于理解模型的行为是非常宝贵的。不过，这些曲线包含的信息比你通常看到的要多。通过可视化阈值，我们可以更多地了解我们的分类器。另外，保留这些信息可以使 ROC 曲线更加直观。</p><h1 id="9710" class="lp lq ir bd lr ls lt lu lv lw lx ly lz jx ma jy mb ka mc kb md kd me ke mf mg bi translated">历史</h1><p id="e43c" class="pw-post-body-paragraph ks kt ir ku b kv mh js kx ky mi jv la lb mj ld le lf mk lh li lj ml ll lm ln ik bi translated">ROC 曲线是由战时挑战激发的。在第二次世界大战中，人们希望量化雷达系统的行为。让我们考虑雷达解释的四种可能结果:</p><blockquote class="mm mn mo"><p id="e32f" class="ks kt mp ku b kv kw js kx ky kz jv la mq lc ld le mr lg lh li ms lk ll lm ln ik bi translated"><strong class="ku is">真阴性(TN) </strong>:射程内没有飞机，雷达技师报告没有飞机。唷。</p><p id="f6b8" class="ks kt mp ku b kv kw js kx ky kz jv la mq lc ld le mr lg lh li ms lk ll lm ln ik bi translated"><strong class="ku is">真阳性(TP) </strong>:射程内有飞机，雷达技师报告有飞机。至少我们知道它在那里！</p><p id="ed8f" class="ks kt mp ku b kv kw js kx ky kz jv la mq lc ld le mr lg lh li ms lk ll lm ln ik bi translated"><strong class="ku is">假阴性(TN) </strong>:射程内有一架飞机，但雷达技师没有报告。啊哦，我们毫无准备。</p><p id="cb07" class="ks kt mp ku b kv kw js kx ky kz jv la mq lc ld le mr lg lh li ms lk ll lm ln ik bi translated"><strong class="ku is">误报(FP) </strong>:范围内没有飞机，但雷达技师报告有飞机。我们在浪费资源准备一架不真实的飞机！</p></blockquote><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gi gj mt"><img src="../Images/59acb94ff0e11d28563b4e2952029522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m4PM9G2MAWpfFtIUr0pA-w.png"/></div></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">二元分类器结果。图片作者。</p></figure><p id="d337" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">显然，前两种结果比后两种好，即真比假好。然而，在现实中，我们不得不进行权衡。</p><p id="abf6" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">例如，如果我们的雷达技术人员有很多假阴性，我们可以让她的指挥官对她大喊，直到她报告更多出现在她屏幕上的东西。通过降低她报告的“决策门槛”，她会得到更少的假阴性和更多的真阳性。然而，不幸的是，她也更有可能意外报告假阳性。</p><p id="27af" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">为了总结雷达“接收器”的“工作特性”的权衡，军事分析家们提出了“接收器工作特性”曲线。</p><h1 id="26fa" class="lp lq ir bd lr ls lt lu lv lw lx ly lz jx ma jy mb ka mc kb md kd me ke mf mg bi translated">标准 ROC 曲线</h1><p id="fbde" class="pw-post-body-paragraph ks kt ir ku b kv mh js kx ky mi jv la lb mj ld le lf mk lh li lj ml ll lm ln ik bi translated">怎样才能有意义地总结这四个量之间的关系？一种方法是使用真阳性率(TPR)和假阳性率(FPR)。</p><p id="e0eb" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">TPR 有很多名字。你可能会称之为“敏感”或“回忆”。它是所有实际阳性(TP+FN)的一部分，我们的模型将其标记为阳性。这是我们的雷达技术报告的真正飞机的一部分。相比之下，FPR 是非平面场景(FP+TN)的百分比，我们的雷达技术报告为平面。</p><p id="e5bd" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">ROC 曲线将 TPR 绘制为不同决策阈值下 FPR 的函数。基于这些定义，我们希望在最大化 TPR 的同时最小化我们的 FPR。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gi gj my"><img src="../Images/090fe5dd88a1b62846d58cd1e140a521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gT_bw-XFwNEJnkTbyEIsQ.png"/></div></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">定义真阳性率(TPR)和假阳性率(FPR)。图片作者。</p></figure><p id="43d3" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">实现低 FPR 有一个简单的方法…永远不要报告<em class="mp">任何</em>飞机(蓝色)。也有一个简单的方法来实现高 TPR…称<em class="mp">一切</em>为飞机(黄色)。不过，理想情况下，我们会两者兼得。我们将拥有 100%的 TPR 和 0%的 FPR。我们的雷达技术人员将正确地报告所有真实的飞机，而不会意外地报告一架非飞机(绿色)。如果我们真的非常非常不擅长我们的工作，我们可能无法正确地报告<em class="mp">任何</em>真实的飞机，而把每一个非飞机称为<em class="mp">飞机(红色)。</em></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gi gj mz"><img src="../Images/dbf877c8bdb9609841fd00b6cc3ee9b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRrem2_0V_G3C6DAumP5FQ.png"/></div></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">基本 ROC 曲线解释，参见第节。图片作者。</p></figure><p id="5eeb" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">一个好的模型(或雷达技术)会弯向绿色角落。不好的模型(即随机的)会拥抱对角线。一个可笑的坏模型(即，比随机模型更坏)将向红色角落弯曲。</p><p id="a9b5" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">不过，这开始变得抽象了……让我们用具体的雷达例子来说明这一点。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gi gj na"><img src="../Images/6ab03a7853e75c3a4ca5b970611117b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*XOb5GFvSrJFumoYEt6UpzQ.gif"/></div></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">一组样本分类决策的 ROC 曲线。图片作者。</p></figure><p id="5c47" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">让我们考虑一下我们想象中的雷达技术的六种分类情况，三种飞机和三种非飞机。对于每一项，她都用 0%到 100%的范围来表示自己的信心。在一个给定的阈值处，我们想象我们的雷达技术将关于该阈值的一切都报告为一架飞机。然后，我们使用上面的等式计算 FPR 和 TPR。绘制这些值的结果就是…上图所示的 ROC 曲线！</p><h1 id="e161" class="lp lq ir bd lr ls lt lu lv lw lx ly lz jx ma jy mb ka mc kb md kd me ke mf mg bi translated">带阈值的 ROC 曲线</h1><p id="4cf0" class="pw-post-body-paragraph ks kt ir ku b kv mh js kx ky mi jv la lb mj ld le lf mk lh li lj ml ll lm ln ik bi translated">我的问题是:我们使用决策阈值来计算那条绿线，但随后我们丢弃了那条信息！从绿线中，我们无法判断每个点的决策阈值。在部署后选择要使用的决策阈值时，这些信息非常有用。</p><p id="97b6" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">让我们试着用彩色地图保存这些信息。我还没有在网上为这种 ROC 曲线找到一个好名字…所以我称它为彩虹 ROC。</p><p id="6e45" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">让我们放下雷达技术的例子，考虑一个真正的分类器。让我们使用<a class="ae lo" href="https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" rel="noopener ugc nofollow" target="_blank">虹膜数据集</a>。我们将把三个类的问题视为一个<a class="ae lo" href="https://scikit-learn.org/stable/modules/generated/sklearn.multiclass.OneVsRestClassifier.html" rel="noopener ugc nofollow" target="_blank">一对其余</a>的问题，结果是每个类有一个 ROC。</p><p id="3c95" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">首先，我们需要加载数据集并拟合我们的模型。我们将使用基本的 SVM！</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nb nc l"/></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">数据加载和模型拟合。作者来源。</p></figure><p id="ed41" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">现在我们有了分类器，我们可以得到分类分数并生成我们的 ROC 曲线。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nb nc l"/></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">CLI 处理程序和彩虹 ROC 逻辑。作者来源。</p></figure><p id="0a4f" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">结果是具有可视化决策阈值的 ROC 曲线。基于我们对假阳性率和期望的真阳性率的容忍度，我们可以为我们的用例选择适当的决策阈值。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj kg"><img src="../Images/05a4d072867b00ff846cafe59c19f58c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*_4ky_jTiQw9KcdY5mL20sQ.png"/></div><p class="ko kp gk gi gj kq kr bd b be z dk translated">彩虹 ROC 曲线与彩色地图的决策阈值。图片作者。</p></figure><h1 id="325d" class="lp lq ir bd lr ls lt lu lv lw lx ly lz jx ma jy mb ka mc kb md kd me ke mf mg bi translated">结论</h1><p id="e855" class="pw-post-body-paragraph ks kt ir ku b kv mh js kx ky mi jv la lb mj ld le lf mk lh li lj ml ll lm ln ik bi translated">彩虹 ROC 帮助我们保持阈值信息，并且，至少对我来说，使得解释 ROC 曲线更容易。感谢阅读！我希望你学到了一些东西。</p></div></div>    
</body>
</html>