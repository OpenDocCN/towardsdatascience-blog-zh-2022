<html>
<head>
<title>How to Perform JSON Conversion, Serialization, and Comparison in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中执行JSON转换、序列化和比较</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-work-with-json-in-python-bdfaa3074ee4#2022-07-29">https://towardsdatascience.com/how-to-work-with-json-in-python-bdfaa3074ee4#2022-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="24fb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过简单的例子学习基本的JSON操作</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/801e152ba866c066e826a2ece5ef864a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hPu0aUIz6hBxH8TO.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://pixabay.com/illustrations/web-design-user-interface-website-3411373/" rel="noopener ugc nofollow" target="_blank">图片由kreatikar在Pixabay拍摄</a></p></figure><p id="a611" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">JSON</strong>(JavaScript Object Notation)是一种<strong class="lb iu"> <em class="lv"> text </em> </strong>格式，它与语言无关，通常用于不同应用程序之间的数据交换。一个很好的例子是，来自API的响应通常是JSON格式的，因此后端和前端可以自由地交换数据，而不需要知道彼此的技术细节。在这篇文章中，我们将介绍Python中JSON的常见用例，Python是一种用于后端开发和数据工程/分析的流行语言。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="4493" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">JSON和字典</h2><p id="ab30" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">首先，我们应该知道JSON是一种字符串格式。因此，它不同于Python中的字典数据类型。JSON字符串可以用任何现代编程语言解析成相应的数据。通常，JSON字符串可以被解析成两种数据类型，即object和array。对象是一组无序的键/值对，对应于Python中的字典数据类型，而数组是值的有序集合，对应于Python中的列表数据类型</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="09e6" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">JSON字符串和数据之间的转换</h2><p id="1e1b" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">如上所述，在所有现代编程语言中，JSON字符串可以被解析为对象或数组，反之亦然。在Python中，<code class="fe nb nc nd ne b">json</code>库可以用于这种类型的转换。我们使用<code class="fe nb nc nd ne b">loads</code>函数将JSON字符串转换成对象或数组，并使用<code class="fe nb nc nd ne b">dumps</code>函数执行相反的转换。注意<code class="fe nb nc nd ne b">loads</code>中的<code class="fe nb nc nd ne b">s</code>和<code class="fe nb nc nd ne b">dumps</code>代表<strong class="lb iu"> s </strong> tring，这意味着它们在JSON字符串上工作。如果没有指定<code class="fe nb nc nd ne b">s</code>，那么这些函数将会处理JSON文件，这将在后面介绍。</p><p id="2ead" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面这段代码演示了JSON字符串和对象/数组之间的常见转换。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="ca12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有趣的是，当我们将数组转储回JSON时，结果与原始结果不同。如果你仔细检查，你会发现细微的差别。当我们不指定分隔符时，将在项目分隔符后面添加一个空格，默认情况下是逗号。我们可以指定一个自定义分隔符来使结果相同。请注意，我们需要指定项目分隔符和键分隔符，即使我们只想更改其中之一:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="720b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实际上，<code class="fe nb nc nd ne b">separators</code>参数更常用于定制JSON对象的表示。我们可以使用不同的分隔符使转储的字符串更紧凑或更易读:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="d7d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nb nc nd ne b">indent</code>参数用于在每个键之前插入一些空格，以提高可读性。而<code class="fe nb nc nd ne b">sort_keys</code>参数用于按字母顺序对键进行排序。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="d282" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">为无法序列化的值添加自定义序列化程序</h2><p id="b8d7" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">在上面的例子中，目标字典(<code class="fe nb nc nd ne b">dict_from_json</code>)的所有值都可以序列化。实际上，有些值是无法序列化的，尤其是<code class="fe nb nc nd ne b">Decimal</code>和<code class="fe nb nc nd ne b">date</code> / <code class="fe nb nc nd ne b">datetime</code>类型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="e94e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们需要创建一个定制的序列化函数，并将其设置为<code class="fe nb nc nd ne b">default</code>参数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="a1ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在自定义序列化程序中，我们在f字符串中使用<code class="fe nb nc nd ne b"><a class="ae ky" href="https://lynn-kwong.medium.com/special-python-string-formatting-in-logging-and-pint-unit-conversion-fddb51f3d03a" rel="noopener">!r</a></code> <a class="ae ky" href="https://lynn-kwong.medium.com/special-python-string-formatting-in-logging-and-pint-unit-conversion-fddb51f3d03a" rel="noopener">来显示值的表示，这对于调试来说非常方便。如果取消对其中一个<code class="fe nb nc nd ne b">if/elif</code>条件的注释，并再次运行<code class="fe nb nc nd ne b">json.dumps</code>命令，您将看到相应的错误:</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="8dbe" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">比较两个JSONs的区别</h2><p id="1d63" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">有时候我们需要比较两个JSON对象的区别。例如，我们可以检查和比较一些可以导出为JSON的表的模式，如果一些重要表的模式发生了变化，就会发出一些警报。</p><p id="0fa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nb nc nd ne b"><a class="ae ky" href="https://github.com/xlwings/jsondiff" rel="noopener ugc nofollow" target="_blank">jsondiff</a></code> <a class="ae ky" href="https://github.com/xlwings/jsondiff" rel="noopener ugc nofollow" target="_blank">库</a>可用于比较Python中两个JSON对象之间的差异:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="b689" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想要控制结果应该如何显示，我们可以使用<code class="fe nb nc nd ne b">syntax</code>、<code class="fe nb nc nd ne b">marshal</code>和<code class="fe nb nc nd ne b">dump</code>参数来自定义结果。</p><p id="6abb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<code class="fe nb nc nd ne b">syntax</code>字段来指定值和动作应该如何显示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="0dc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<code class="fe nb nc nd ne b">load</code>参数从JSON字符串中加载数据，并类似地使用<code class="fe nb nc nd ne b">dump</code>参数将结果转储到一个JSON字符串中，该字符串可以直接写入一个文件，这将很快介绍。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="1182" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">读写JSON</h2><p id="b604" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我们可以用<code class="fe nb nc nd ne b">json.dump</code>函数将一个JSON字符串写到一个文件中。注意，函数名中没有<code class="fe nb nc nd ne b">s</code>。带有<code class="fe nb nc nd ne b">s</code> ( <code class="fe nb nc nd ne b">json.dumps</code>)的那个是用来处理字符串的，不是文件。JSON文件只是一个纯文本文件，默认扩展名是<code class="fe nb nc nd ne b">.json</code>。让我们将由<code class="fe nb nc nd ne b">jsondiff</code>返回的两个模式之间的差异写到一个名为<code class="fe nb nc nd ne b">schema_diff.json</code>的文件中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="8aef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将创建一个名为<code class="fe nb nc nd ne b">schema_diff.json</code>的文件，该文件将包含变量<code class="fe nb nc nd ne b">result</code>中的JSON字符串。如果字典/列表的值包含不可序列化的数据，我们需要用序列化函数指定<code class="fe nb nc nd ne b">default</code>参数，如本文开头所示。</p><p id="8f52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以使用<code class="fe nb nc nd ne b">json.load</code>函数从JSON文件中加载数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="2eaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，通过简单的例子介绍了JSON的基础知识以及如何在Python中使用它。我们已经学习了如何从字符串或文件中读写JSON对象。此外，我们现在知道如何为JSON对象编写定制的序列化程序，这些对象包含默认序列化程序无法序列化的数据。最后，我们可以使用<code class="fe nb nc nd ne b">jsondiff</code>库来比较两个JSON对象之间的差异，这对于数据监控来说非常方便。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="7ab5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相关文章:</p><ul class=""><li id="858e" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated"><a class="ae ky" href="https://lynn-kwong.medium.com/how-to-use-json-schema-to-validate-json-documents-ae9d8d1db344" rel="noopener">如何使用JSON模式在Python中验证JSON文档</a></li><li id="6278" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/how-to-work-with-json-data-in-mysql-11672e4da7e9">如何在MySQL中使用JSON数据</a></li></ul></div></div>    
</body>
</html>