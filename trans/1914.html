<html>
<head>
<title>10 SQL Operations for 80% of your Data Manipulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">80%的数据操作需要10次SQL操作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/10-sql-operations-for-80-of-your-data-manipulation-7461c56e25f4#2022-05-03">https://towardsdatascience.com/10-sql-operations-for-80-of-your-data-manipulation-7461c56e25f4#2022-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a6eebd2aaafa22a2739520cbd9da6d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ASE941P2dUAVE5zuQKjb9g.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="a0b9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">关系数据库(表格数据)是最常用的数据库之一，它占被捕获数据总量的70%。</p><p id="8b11" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">SQL是操作关系数据最常用的编程语言之一。数据分析师和数据科学家非常积极地使用SQL来完成数据拉取和数据操作任务。</p><p id="fcce" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这篇博客中，我将带您了解10个最常用的SQL操作，每个有抱负的数据科学家/数据分析师都应该知道。让我们开始吧:</p><ol class=""><li id="30af" class="ld le it kh b ki kj km kn kq lf ku lg ky lh lc li lj lk ll bi translated"><strong class="kh iu"> Limit </strong>:查看行会让你对数据表不同列中的值有一个概念。获取并查看数据表的“所有”行是一个昂贵的<strong class="kh iu"> </strong>操作，它需要时间和资源。因此，获取数据表前几行的功能变得非常有用。Limit子句用于获取数据表的顶行。</li></ol><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ls"><img src="../Images/27146c385a5e0145d10531635f632d66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fybufvop8XglplGkyQ1pnA.png"/></div></div></figure><p id="1459" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">2.<strong class="kh iu"> Distinct </strong>:使用Distinct，我们可以找到一列中的不同值，应用count函数可以给出该列中不同值的计数。例如，我们可以使用下面的代码来查找不同(或唯一)产品id的数量。</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lt"><img src="../Images/089742e454e2fa1ca5dca8eb1483097e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GfG_YJJ59GDigMqfkR0c5A.png"/></div></div></figure><p id="4ed3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> 3。聚合:</strong>聚合运算用于求出一列值的总和、计数、最小值、最大值等。例如，如果我们想找到售出产品的总数量(或单位),我们可以将sum函数应用于quantity列。类似地，我们还可以通过对quantity列应用max函数来查找产品的最大销售量。</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lu"><img src="../Images/c008346a8185c93b25a5eb4542244e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VUdhCbGujuPi_bt6pqrmbg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">总量(图片由作者提供)</p></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lv"><img src="../Images/99bd230f65fdd267182b20cfb955085e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tyuTf4m8QoEl8MbM7USGkA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">最大数量(图片由作者提供)</p></figure><p id="a6b3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> 4。Groupby: </strong> Groupby用于查找列级的聚合/组。Groupby与sum、min、max、count等聚合一起使用。例如，为了找到所有产品的总销售量，我们可以按产品id分组，并找到数量的总和。</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lw"><img src="../Images/0b7fd0640172e518441ea62690546dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MWwm6pkL57c7OnfqCNaSw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">所有产品的总销量(图片由作者提供)</p></figure><p id="f9c1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> 5。Where: </strong> Where子句用于根据一些列值过滤行。例如，假设我们想要查看对应于产品id 10的总销售量，我们可以在产品id列上使用where子句。</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/e84dbf6a7c7128e62791d6f862dae9aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EsussBdffHtDbWdU3_5g7w.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">对应于ProductID — 10的总数量</p></figure><p id="7b9d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> 6。Having: </strong> Having子句用于对聚集的列/值应用过滤器。例如，假设我们想要查找总销售量大于350件的产品，我们可以使用having子句对聚合数量应用过滤器。</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/78e6c81881bbcf27c6cf6327202cb72f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ZM2ogTz8hmX-xvCEebtrg.png"/></div></div></figure><p id="b4b2" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="lz"> Where vs Having: Where用于对数据帧的现有列应用过滤器，而Having用于对列的聚合值应用过滤器。</em></p><p id="fc19" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">7 .<strong class="kh iu">。Order by: </strong> Order by子句用于按升序(默认)或降序对列的值进行排序。例如，如果我们想找到零售商销售的最大数量的产品，那么我们可以使用order by函数。</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ma"><img src="../Images/ef4cc2ecba5a6a37c44bbb0337ebaefe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sXnAyQkrwy77c9lqkdsczQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">按聚合列排序(按作者排序的图像)</p></figure><p id="1895" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">Order by也可以应用于非聚合列。例如，使用下面的代码，我们可以对数量列进行排序:</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mb"><img src="../Images/a5e386e392177c73e1a5b3fb508decfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKtgeMQ0T-E6fA9mi6mYpQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">按ProductID列排序(按作者排序的图像)</p></figure><p id="02c3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> 8。Join: </strong> Join用于将两个数据表中的信息合并到一个表中。图像，如果我们想获得产品的信息，我们可以将订单明细表与产品表连接起来以获得产品信息。为了连接两个数据表，我们需要在两个表中公共的主键(或列)上连接它们。在下面的示例中，我们使用ProductID列在两个表之间应用内部联接。</p><p id="86a7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这里了解更多关于加入的信息:<a class="ae mc" href="https://medium.com/codex/learn-everything-about-joins-in-pandas-5370a8ad7aa5" rel="noopener">加入简介！</a></p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/1fd30adacb2ce4168da1cff66fd7714c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tEeAf6caklrJvXee5BILjw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">连接表(作者图片)</p></figure><p id="1006" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> 9。窗口:</strong>窗口函数用于在数据的子集/窗口上应用函数。例如，为了找到每个类别中的前3个销售产品，我们可以按类别列对数据进行分区(按CategoryID进行分区)，按总量排序(从高到低)，将行号附加到每一行，并过滤前3行(如下面的代码所示)。</p><p id="8371" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">数据划分的目的是找到等级、滞后等。在数据子群中。下面是窗口函数的一些使用案例:找出每个类别中的前3名，比较当前行和前一行的值，等等。</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div class="gh gi me"><img src="../Images/fb44a4cae9d3047b95f37577197dabfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*mnhVreXi_ewTOkR_Hi-Bmw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">过滤每个类别中的前3个产品(按作者分类的图片)</p></figure><p id="f132" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> 10。LIKE </strong> : Like操作符与‘Where’子句一起使用，用于搜索列中的特定模式。例如，为了找到联系号码以代码171开头的供应商，我们可以使用以下代码:</p><figure class="lm ln lo lp gt ju"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mf"><img src="../Images/fcb0c0c69c68696a5b37e17640a0da0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hO0nTj35nhLF0-R650111Q.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">使用LIKE运算符过滤联系人(图片由作者提供)</p></figure></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="da4b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="lz">如果你觉得我的博客有用，那么你可以</em> <a class="ae mc" href="https://anmol3015.medium.com/subscribe" rel="noopener"> <strong class="kh iu"> <em class="lz">关注我</em> </strong> </a> <em class="lz">每当我发布一个故事时，你都可以直接得到通知。如果你自己喜欢体验媒介，可以考虑通过</em> <a class="ae mc" href="https://anmol3015.medium.com/membership" rel="noopener"> <strong class="kh iu"> <em class="lz">注册会员</em> </strong> </a> <em class="lz">来支持我和其他成千上万的作家。</em></p><h1 id="fdfb" class="mn mo it bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">谢谢大家！</h1><p id="e815" class="pw-post-body-paragraph kf kg it kh b ki nl kk kl km nm ko kp kq nn ks kt ku no kw kx ky np la lb lc im bi translated">这里还有一个与你相关的故事:</p><div class="nq nr gp gr ns nt"><a href="https://anmol3015.medium.com/write-your-sql-queries-the-right-way-9c04dfbb6499" rel="noopener follow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd iu gy z fp ny fr fs nz fu fw is bi translated">以正确的方式编写您的SQL查询！</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">去掉你所有的语法错误！</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">anmol3015.medium.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh jz nt"/></div></div></a></div></div></div>    
</body>
</html>