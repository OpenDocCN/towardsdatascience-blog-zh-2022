<html>
<head>
<title>Decoding the Basic Math in GAN — Simplified Version</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GAN 中的基本数学解码—简化版</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/decoding-the-basic-math-in-gan-simplified-version-6fb6b079793#2022-02-24">https://towardsdatascience.com/decoding-the-basic-math-in-gan-simplified-version-6fb6b079793#2022-02-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="824a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">生成性对抗网络的数学基础是什么？</h2></div><p id="500c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在过去十年中，生成对抗网络(GANs)是深度学习领域的一场革命。自 Ian Goodfellow 等人在 2014 年发布第一个 GAN 版本以来，已经有许多 GAN 的变体，其中一些应用令人惊叹。</p><p id="0377" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将尝试用简单的术语来理解 GAN 背后的基本数学基础。</p><p id="9917" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了对 GANs 如何工作有一个高层次的直觉，建议您首先浏览下面的文章:<a class="ae lb" href="https://lakshmi1212.medium.com/intuitive-introduction-to-generative-adversarial-networks-gans-230e76f973a9" rel="noopener">对 GANs 的直观介绍</a></p><h1 id="f1c1" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">GAN 概述</h1><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lu"><img src="../Images/3311e7d730a29b2c6524ba45cef196fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXHuw5mEPPK73GzDyPUeGA.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated"><strong class="bd mk">甘输入输出流程</strong>(图片作者提供)</p></figure><p id="26cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">生成器将随机向量[z]作为输入，并生成输出图像[G(z)]。鉴别器将生成的图像[G(z)]或真实图像[x]作为输入，并生成输出[D]。</p><p id="647e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在鉴别器训练期间，生成器的权重和偏差被冻结。当鉴别器预测真实图像是假的或者假图像是真的时，它将受到惩罚。鉴频器的权重和偏置通过来自鉴频器损耗的反向传播来更新。</p><p id="9bcf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">类似地，在生成器训练期间，鉴别器的权重和偏差被冻结。生成器的目标是欺骗鉴别器。因此，如果鉴别器能够识别出生成器生成的图像是假图像，则生成器会受到处罚。在这种情况下，损耗通过发电机网络反向传播，以更新其权重和偏差。</p><h1 id="09de" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">双人极大极小游戏</h1><p id="e5e2" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">GAN 在概念上可以被认为是发生器模型和鉴别器模型之间的极小极大博弈。两个模型同时被训练，其中一个模型试图最小化损失，而另一个试图最大化损失。</p><p id="fb78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据原始 GAN 论文，GAN 的损失函数如下</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mq"><img src="../Images/4fb02487f9738117bdd93776fe3738a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Q4CvU9nH44u37uTuJSlSA.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">图片来自<a class="ae lb" href="https://arxiv.org/abs/1406.2661" rel="noopener ugc nofollow" target="_blank">甘— 2014 论文</a></p></figure><p id="2876" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们试着推导这个等式来更好地理解它。</p><h1 id="6358" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">二元交叉熵损失</h1><p id="2457" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">生成器和鉴别器都使用二进制交叉熵损失来训练模型。一般来说，二元交叉熵损失可以写成:</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mr"><img src="../Images/0a9ddeccbb1e23e76bad86f11727230a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ekc1AxHLC7uj3aWzspYhFg.png"/></div></div></figure><h1 id="9bf4" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">鉴频器损耗</h1><p id="44e8" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">鉴别器可以有两种可能的输入，真的或假的。</p><ol class=""><li id="5111" class="ms mt iq kh b ki kj kl km ko mu ks mv kw mw la mx my mz na bi translated">对于实数输入，y = 1。在二元交叉熵损失函数中代入这个值，得到下面的损失值:</li></ol><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nb"><img src="../Images/516d4cb40ccc4f1feeeb2621a3ddb625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gvq9AkrTb3Jv8nkBV_NoNQ.png"/></div></div></figure><p id="ab7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.类似地，对于伪输入，y = 0，这给出了下面的损耗值:</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nc"><img src="../Images/ce498ab89aaf96e199d25bd0c65a5ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nc62FYU0pOyot6fe3Pb95A.png"/></div></div></figure><p id="5401" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结合鉴频器的上述损耗，一个是真实输入，另一个是虚假输入，得出以下鉴频器损耗</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nd"><img src="../Images/a9a7f8409bf350c4c3115f9b5c56c9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4VPYs8_2UVsCdFILZzlnQ.png"/></div></div></figure><p id="d4b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">鉴别器的目标是最小化这种损失，</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi ne"><img src="../Images/3d4fd1398470fa7f6b431c25fd3447ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fS6AGZN6lCONV97s3mrs7w.png"/></div></div></figure><p id="08ce" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">移除负号会将最小值变为最大值，因此单个数据点的最终鉴频器损耗可写为:</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nf"><img src="../Images/1081daa8d0bb4f2eb520ab2d5abea52b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LkIaxjdkx8uO3zNLxM7vtg.png"/></div></div></figure><h1 id="dce8" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">发电机损耗</h1><p id="bf5d" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">对于发生器，损耗是根据鉴频器损耗计算的。在发电机训练期间，鉴别器被冻结。因此，对于鉴别器来说，只有一个输入是可能的，这就是伪输入。这使得鉴频器损耗等式中的第一项为零。</p><p id="326d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">生成器试图欺骗鉴别器将假数据归类为真实数据。这意味着发生器试图最小化鉴频器损耗方程中的第二项。单个生成数据点的发电机损耗函数可写为:</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi ng"><img src="../Images/726a86e76197e78c7fa83e5e1000fabf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Gr9zaUs3hyogGtQe8vcCg.png"/></div></div></figure><h1 id="90f8" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">GAN —损耗方程</h1><p id="420f" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">将鉴频器损耗和发生器损耗结合起来，我们可以得到一个单一数据点的等式，如下所示。</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nh"><img src="../Images/f2fced6b3d20034495976a57d6a9091b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7lSvjddbm2jQsHUqXCbxjA.png"/></div></div></figure><p id="8263" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是发生器和鉴别器之间的极小极大博弈。发电机试图最小化损耗，而鉴别器试图最大化损耗。</p><p id="fb3a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将该方程推广到多个数据点的期望值(E)给出了如下的最终方程，</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi ni"><img src="../Images/5c84aaeccb4032dd45901dfd55535bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DwM4NHqWH7crqFqGinfX4Q.png"/></div></div></figure><p id="8552" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在将其与 GAN 论文中给出的损失函数进行比较，以便更好地理解它。</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mq"><img src="../Images/4fb02487f9738117bdd93776fe3738a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Q4CvU9nH44u37uTuJSlSA.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">图片来自<a class="ae lb" href="https://arxiv.org/abs/1406.2661" rel="noopener ugc nofollow" target="_blank">甘— 2014 论文</a></p></figure><h1 id="106b" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">GAN 的局限性</h1><p id="65e7" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">以下是 GAN 中常见的一些问题</p><ol class=""><li id="f026" class="ms mt iq kh b ki kj kl km ko mu ks mv kw mw la mx my mz na bi translated">消失梯度问题，由于该问题，发电机训练可能会失败</li><li id="242a" class="ms mt iq kh b ki nj kl nk ko nl ks nm kw nn la mx my mz na bi translated">模型折叠，其中生成器可能重复创建相同的输出</li><li id="384c" class="ms mt iq kh b ki nj kl nk ko nl ks nm kw nn la mx my mz na bi translated">无法收敛，因为鉴频器反馈对发生器的意义变得更小，从而影响其质量</li></ol><h1 id="442c" class="lc ld iq bd le lf lg lh li lj lk ll lm jw ln jx lo jz lp ka lq kc lr kd ls lt bi translated">结论</h1><p id="23f7" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">自问世以来，GANs 已经有了很大的改进，研究人员已经找到了在很大程度上克服这些局限性的方法。选择正确的损失函数是热门的研究课题之一，许多备选方案正在被提出和评估。</p><p id="44be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望你喜欢这篇文章。尽情享受甘的各种风味吧。</p></div></div>    
</body>
</html>