<html>
<head>
<title>API Performance Testing Using Jmeter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Jmeter 进行 API 性能测试</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/api-performance-testing-using-jmeter-d873b99f2d32#2022-12-28">https://towardsdatascience.com/api-performance-testing-using-jmeter-d873b99f2d32#2022-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="82f6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过自动化测试最大限度地提高效率和可靠性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/80700f107037ae8ccbe5977fcd955f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YRiucq6nr63aySH9.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用稳定扩散创建</p></figure><p id="e0be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">API 性能测试在数据科学中的重要性有几个原因。</p><ol class=""><li id="0037" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><strong class="la iu">速度</strong>:在许多数据科学应用中，API 性能至关重要，因为 API 可能会执行计算开销很大的任务或处理大量数据。糟糕的 API 性能会导致系统运行缓慢或无响应，这会让用户感到沮丧，并对数据科学管道的整体效率产生负面影响。</li><li id="8917" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">可伸缩性</strong> : API 性能测试可以帮助识别瓶颈或其他问题，这些问题可能会阻止 API 扩展以满足不断增长的用户群或更大数据集的需求。</li><li id="1c3b" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">可靠性</strong>:通过测试 API 的性能，您可以确保它是可靠的，并且能够处理它所设计的工作负载。这在任务关键型应用程序中尤其重要，因为在这些应用程序中，API 停机或缓慢的性能会带来严重的后果。</li><li id="76e0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">调试</strong>:性能测试还有助于识别和排除 API 的问题，比如内存泄漏或其他可能导致性能下降的问题。</li></ol><p id="9496" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">JMeter 是一个流行的开源工具，可以用来测试 API 和其他类型的 web 应用程序的性能。它旨在模拟大量用户向服务器发出请求，并可用于测量服务器在负载下的性能。</p><p id="5552" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将向您展示如何为 post 创建测试计划，并以最简单的方式获取 API。</p><h1 id="b01d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">装置</h1><p id="cf6a" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">要安装和运行 JMeter，请按照下列步骤操作:</p><ol class=""><li id="9643" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">从<a class="ae mi" href="https://jmeter.apache.org/download_jmeter.cgi" rel="noopener ugc nofollow" target="_blank"> Apache JMeter 网站</a>下载 JMeter 的最新版本。</li><li id="8780" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">将下载的存档文件解压缩到您计算机上的某个位置。</li><li id="814d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">运行<strong class="la iu">JMeter . bat</strong>(Windows)或<strong class="la iu">JMeter</strong>(Unix)文件。这些文件可以在<strong class="la iu"> bin </strong>目录下找到。</li></ol><p id="cabd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将启动 JMeter 图形用户界面。</p><p id="401b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:为了运行 JMeter，您可能需要在系统上安装 Java。如果没有安装 Java，可以从<a class="ae mi" href="https://www.oracle.com/java/technologies/javase-downloads.html" rel="noopener ugc nofollow" target="_blank">甲骨文网站</a>下载。</p><p id="2515" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您使用的是<strong class="la iu"> MAC OS，</strong>您可以使用运行以下程序的自制软件轻松安装 Jmeter:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="afb0" class="nl mk it nh b be nm nn l no np">brew install jmeter</span></pre><p id="6d8d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，您可以通过运行以下命令来打开它:</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="f263" class="nl mk it nh b be nm nn l no np">open /opt/homebrew/bin/jmeter</span></pre><p id="235f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者</p><pre class="kj kk kl km gt ng nh ni bn nj nk bi"><span id="57ee" class="nl mk it nh b be nm nn l no np">open /usr/local/bin/jmeter</span></pre><h1 id="62b7" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">为 GET API 创建一个测试计划</h1><p id="eb9e" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">对于这个例子，我在本地运行一个 GET API，它位于<strong class="la iu"> 127.0.0.1:8000 </strong>中，返回短语“Hello World”。现在，我们想使用 Jmeter 测试这个 API，所以我们需要创建一个测试计划。</p><p id="8d00" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在 JMeter 中为 GET API 创建一个简单的测试计划，您可以遵循以下步骤:</p><ol class=""><li id="2252" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">启动 JMeter 并创建一个新的测试计划，方法是点击左侧树中的“测试计划”节点，然后选择“添加”&gt;“线程(用户)”&gt;“线程组”。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7ca22b051f8e23ee41fa4ebcd3300f4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WP2yRQ-LVJyLKWHy.png"/></div></div></figure><p id="8693" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.通过右键单击左侧树中的“线程组”节点，然后选择“添加”&gt;“采样器”&gt;“HTTP 请求”来添加 HTTP 请求。这是设置 API 信息的地方(URL、端口等。).</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4d890660767da9e9a07f92ba78b80e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BrixxnV6qjyGZGT4.png"/></div></div></figure><p id="9093" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.通过右键单击“HTTP 请求”节点，然后选择“添加”&gt;“侦听器”&gt;“查看结果树”来添加结果树。这允许您以树的形式查看测试运行的结果。它显示了测试计划中每个采样器(“用户”)的请求和响应数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1eabe62baabe77852cb93bf8ac09b173.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*K8ax6q3ExTrDYuU5.png"/></div></div></figure><p id="34f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.通过右键单击“HTTP 请求”节点，然后选择“添加”&gt;“侦听器”&gt;“摘要报告”来添加摘要报告。这提供了测试运行的性能摘要。它显示一系列指标，包括样本数量、平均响应时间、吞吐量和错误百分比。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/73124240f35e12e0f678ec498efabc15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m8jmWPoOVBIsBvtI.png"/></div></div></figure><h1 id="4ebf" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">设置和运行测试</h1><p id="5147" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在 HTTP 请求中，你必须设置 URL 中的“服务器名或 IP”和端口号。另外，您必须设置 HTTP 请求来获取 API。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f99815947a30c9edc323d64608e47d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Djnk5MiJlIy8nUju.png"/></div></div></figure><p id="7fff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在线程组中，您可以设置线程的数量，这意味着有多少用户将调用 API。上升期是 JMeter 将线程(虚拟用户)数量上升到所需水平所需的时间。它以秒为单位。例如，如果一个线程组的上升周期为 60 秒，线程(用户)数为 10，那么 JMeter 需要 60 秒的时间将线程数从 0 上升到 10。此外，您可以设置循环计数，这是线程组调用 API 的周期数。</p><p id="02ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个例子，我希望 1 个用户连续调用 API 10 次。这就是为什么我把线程数设为 1，循环数设为 10。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c2e27724a1fbb36bffbae6d60da16c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*soPq4-P-QXP5L9ge.png"/></div></div></figure><p id="d12f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们准备运行测试。点击“运行”&gt;“开始”。让我们看看结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/65e11ffcee7147585209726898fc95c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lzq9VxrKOimGhXXr.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9a78ed18fb0d17dc3dbd5d66137768fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*54pKp08qu-4nkUNT.png"/></div></div></figure><p id="c154" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如您在总结报告中看到的，我们的 API 调用平均花费了 2 毫秒，并且没有任何错误。</p><h1 id="5137" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">为发布 API 创建测试计划</h1><p id="d5b0" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">本例中的 API 获得 4 个变量的 JSON 输入，并再次返回这些变量。</p><p id="82e1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了运行 POST API 的测试计划，我们必须添加与 GET API 相同的元素和一个 HTTP 头管理器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fc0cae7c3764e5fc219ac94658971f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KJ1gsoYEBL7lFKF8.png"/></div></div></figure><p id="833a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们首先设置 HTTP 请求。与 GET API 的不同之处在于，我们需要添加 JSON 输入的主体。同样在这个示例中，API 在/show_data 路径上运行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e9a0ba4b79ea56a6c69c169e4302c7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3gWjXuA9SXpU73VL.png"/></div></div></figure><p id="d607" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们需要在 HTTP 头管理器中设置头。正如您在下面看到的，我添加了内容类型:application/json。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/09ac7d635768a729bafa977664592099.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4vDu1QQJiK5RGWvX.png"/></div></div></figure><p id="18a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们准备运行测试。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4cbc600c665b98d3e33f7f129bf0010b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SdIWv7idXzNn78XO.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4d4d8eae60fe832197ce64535420ec04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jBGZvwuGApB3h8nN.png"/></div></div></figure><p id="09ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你所看到的，这个 API 我们的 API 调用平均花费了 3 毫秒，误差为 0%。此外，您可以在查看结果树中看到对每个呼叫的响应。</p><p id="12fc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Jmeter 的一个很好的特性是您可以保存测试计划，这允许您轻松地重新运行测试。</p><h1 id="d730" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">最后的话</h1><p id="4623" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">总的来说，JMeter 是一个强大而灵活的工具，非常适合测试 API，并且可以成为数据科学家工具箱中有价值的补充。</p><blockquote class="nq nr ns"><p id="344d" class="ky kz nt la b lb lc ju ld le lf jx lg nu li lj lk nv lm ln lo nw lq lr ls lt im bi translated">最初发布于<a class="ae mi" href="https://predictivehacks.com/api-performance-testing-using-jmeter/" rel="noopener ugc nofollow" target="_blank">predictivehacks.com</a>。</p></blockquote><h1 id="70b7" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">感谢您的阅读！</h1><ul class=""><li id="17fe" class="lu lv it la b lb nb le nc lh nx ll ny lp nz lt oa ma mb mc bi translated">订阅我的<a class="ae mi" href="https://billybonaros.medium.com/subscribe" rel="noopener">简讯</a></li><li id="54a6" class="lu lv it la b lb md le me lh mf ll mg lp mh lt oa ma mb mc bi translated">在<a class="ae mi" href="https://www.linkedin.com/in/billybonaros/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我</li></ul></div></div>    
</body>
</html>