<html>
<head>
<title>Image Processing: Trivialised</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像处理:平凡化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-processing-trivialized-575bfa4bec3b#2022-05-11">https://towardsdatascience.com/image-processing-trivialized-575bfa4bec3b#2022-05-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2aab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">深度学习，对于一切，为什么？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f36f42ec3c084739577dc5707a7c8923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTtmDyHdakE_7Cx1sQM_Fg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">杰姆·萨哈冈在<a class="ae kv" href="https://unsplash.com/s/photos/thinking-robots?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e5fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">图像处理的意义正在递减，对于图像分类、物体检测等很多任务，它都被深度学习所取代。对于一些人来说，我同意深度学习比图像处理提供了更好的结果。但对于其他人，我会否认。在机器学习中，不能一刀切。根据我的经验，机器学习任务都是为了找到一个简单且接近准确的解决方案。客户和管理者都没有兴趣处理复杂和僵化的解决方案，除非它们比简单的解决方案好得多。</p><p id="3993" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当采用深度学习代替图像处理时，也会出现类似的情况。它成为过度工程的典型案例。我最近在处理<a class="ae kv" href="https://data.mendeley.com/datasets/5y9wdsg2zt/2" rel="noopener ugc nofollow" target="_blank">表面裂纹检测</a>数据集时遇到了类似的情况。它受“CC by 4.0”许可。数据集包含有裂缝和无裂缝的各种混凝土表面的图像。数据集的目标是对图像进行分类。我喜欢浏览别人发表的作品。在这样做的时候，我惊讶地发现，他们中的大多数都实现了用于图像分类的卷积神经网络。我脑海中出现的即兴问题是，</p><blockquote class="ls lt lu"><p id="2e90" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">为什么选择卷积神经网络？为什么不是图像处理？</p></blockquote><p id="a057" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这让我对自己实施图像处理的决定产生了怀疑，因为他们中的大多数人实施了用于图像分类的卷积神经网络。因此，我决定深入了解问题陈述，并设计合适的图像处理算法来破解它。在这篇文章中，我们将经历我所承担的整个过程。</p><h1 id="7947" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">目录</h1><ol class=""><li id="37ce" class="mr ms iq ky b kz mt lc mu lf mv lj mw ln mx lr my mz na nb bi translated"><a class="ae kv" href="https://medium.com/p/575bfa4bec3b/edit#a1dc" rel="noopener">当前工业方法</a></li><li id="5ddf" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><a class="ae kv" href="https://medium.com/p/575bfa4bec3b/edit#3f52" rel="noopener">数据集概述</a></li><li id="0814" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><a class="ae kv" href="https://medium.com/p/575bfa4bec3b/edit#1b37" rel="noopener">可用解决方案</a></li><li id="e87f" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><a class="ae kv" href="https://medium.com/p/575bfa4bec3b/edit#8e99" rel="noopener">图像处理算法</a></li><li id="efcf" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><a class="ae kv" href="https://medium.com/p/575bfa4bec3b/edit#dc05" rel="noopener">结论</a></li></ol><h1 id="a1dc" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">当前工业方法</h1><p id="6b87" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">裂缝是监测混凝土结构健康和诊断其劣化的一个重要方面。如果在早期阶段发现裂缝，可以采取进一步措施改善结构健康状况。</p><p id="c38e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">混凝土结构的检查每五到十年进行一次，以评估刚度和抗拉强度。在此过程中，经验丰富的土木工程师会目视检查裂缝及其特征，如长度、形状和深度。接下来，他们画出所有裂缝的草图，并准备检查报告。这一过程耗时、成本高，并且容易出现人为错误。这些行业最近开始使用摄像机进行基于图像的检测，以克服这些问题。公共数据集是可用的，包括有裂缝和没有裂缝的混凝土结构的图像。</p><h1 id="6197" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">数据集概述</h1><p id="1b37" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">用于问题陈述的数据集是“<a class="ae kv" href="https://data.mendeley.com/datasets/5y9wdsg2zt/2" rel="noopener ugc nofollow" target="_blank">表面裂纹检测</a>”。Kaggle上也有。数据集包含有裂缝和无裂缝的各种混凝土表面的图像。图像数据分为两类，即负像(无裂纹)和正像(有裂纹)，放在单独的文件夹中进行图像分类。每个类有20000幅RGB图像，每幅图像的尺寸为227 x 227像素。高分辨率图像在表面光洁度和照明条件方面差异很大。</p><h1 id="6522" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">可用的解决方案</h1><p id="7918" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">Kaggle上可用于该数据集的大多数笔记本要么应用定制的CNN架构，要么微调预训练的模型。那很好，但是为什么不保持简单。在我们的领域中，图像处理是一个被严重低估的方面。对图像处理的深入理解有助于解决几个问题。</p><p id="4e9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我用OpenCV开发了一个图像处理算法来解决图像分类的问题。对于那些不知道OpenCV的人来说，它是一个python库，提供了调整图像和对图像执行一些数学运算的功能。</p><h1 id="2ee4" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">图像处理算法</h1><p id="1718" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">博客的这一部分将描述算法的代码演练，这将提供对解决方案的理解。首先，我比较了两类图像的数量，以确认我有足够的样本来测试我的算法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="535a" class="nr ma iq nn b gy ns nt l nu nv">Total number of positive images are 20000<br/>Total number of negative images are 20000</span></pre><p id="d522" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以实现翻转、旋转和颜色增强等数据增强技术来增加数据量，但对于图像处理来说似乎没有必要。首先，我们将看一些消极和积极类的例子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/b534a608bfd3dd95774f1361f6a01fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3MVdjEa842KWcIfNECk_tw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来自<a class="ae kv" href="https://data.mendeley.com/datasets/5y9wdsg2zt/2" rel="noopener ugc nofollow" target="_blank">混凝土裂缝图像的正面图像用于分类</a></p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/d98658d8ae7a01274c24c60c6677f189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZ9WZKDl9G9oOCDrf0KpDg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用于分类的<a class="ae kv" href="https://data.mendeley.com/datasets/5y9wdsg2zt/2" rel="noopener ugc nofollow" target="_blank">混凝土裂缝图像的负像</a></p></figure><p id="94ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下一步我已经用OpenCV创建了一个图像处理算法。我把这个过程分成了四个简单的步骤。</p><ol class=""><li id="e768" class="mr ms iq ky b kz la lc ld lf nx lj ny ln nz lr my mz na nb bi translated"><strong class="ky ir">锐化:</strong>每一张通过算法的图像都会被初步锐化。这一步骤的目的是确保图像中的每个边缘都是明显可见的。</li><li id="85a9" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><strong class="ky ir">模糊:</strong>我们只对捕捉大边缘感兴趣，因为它们代表裂缝。如果在不模糊的情况下应用锐化，它也将捕捉小边缘。因此，我在第二步中对图像进行了模糊处理，以消除小边缘。锐化的强度必须高于模糊，以确保大边缘在此步骤中不会模糊。</li><li id="76e2" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><strong class="ky ir">阈值处理:</strong>首先将图像转换为灰度图像(单通道)，然后将灰度图像转换为二值图像。二进制图像是像素值为0或255的图像。通俗地说可以认为是黑白图像。我使用了一个简单的阈值技术，基本阈值为230。</li><li id="6ca5" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated"><strong class="ky ir">轮廓检测:</strong>从第三步获得的二值图像中检测轮廓。对于每幅图像，我都提取了具有最大像素点的轮廓。图像分类的两个关键条件如下:</li></ol><ul class=""><li id="902b" class="mr ms iq ky b kz la lc ld lf nx lj ny ln nz lr oa mz na nb bi translated">正片图像的最大轮廓应该超过N个像素。</li><li id="a1d3" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr oa mz na nb bi translated">负像的最大轮廓应该少于N个像素。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="8f8b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果正类的分数接近于零，负类的分数接近于20000，则该算法工作良好。在这种情况下，我们将N取为100。可以对其进行优化以获得更好的结果。上面定义的方法在数据集的所有图像上实现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="f8f1" class="nr ma iq nn b gy ns nt l nu nv">{'Positive': 1582, 'Negative': 19962}</span></pre><p id="f457" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上述结果可以解释如下:</p><ul class=""><li id="e85c" class="mr ms iq ky b kz la lc ld lf nx lj ny ln nz lr oa mz na nb bi translated">1582张正面图像被错误分类</li><li id="eeb2" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr oa mz na nb bi translated">19962张底片图像被正确分类</li></ul><p id="cc05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我也计算了算法的准确性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="0ee4" class="nr ma iq nn b gy ns nt l nu nv">Accuracy is 95.95%</span></pre><h1 id="dc05" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">结论</h1><p id="3d48" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在代码演练之后，您可能会想，“这很简单。我也可以做到这一点”。确实如此。比起检测裂缝，<strong class="ky ir">我更感兴趣的是传播对图像处理重要性的认识</strong>。深度学习并不是所有问题的答案。一些用例可以用图像处理来解决，如寻找停车位、评估MCQ考试等。此外，还有许多额外津贴，如下所列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/b372dfdbdc05e11a20ae8579be5e02cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avyTakZc4dRfl2d4IfJmag.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图像处理津贴。来源:作者图片</p></figure><p id="f08a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了OpenCV，Scikit-image也是一个著名的对图像进行操作的库。我希望通过这篇文章，你学会了图像处理的重要性。下面列出了一些通过OpenCV学习图像处理的资源，</p><ul class=""><li id="19f9" class="mr ms iq ky b kz la lc ld lf nx lj ny ln nz lr oa mz na nb bi translated"><a class="ae kv" href="https://docs.opencv.org/4.x/d1/dfb/intro.html" rel="noopener ugc nofollow" target="_blank"> OpenCV文档</a></li><li id="cb6e" class="mr ms iq ky b kz nc lc nd lf ne lj nf ln ng lr oa mz na nb bi translated"><a class="ae kv" href="https://pyimagesearch.com/category/image-processing/" rel="noopener ugc nofollow" target="_blank"> PyImageSearch平台</a></li></ul><p id="727e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就这些了，伙计们。快乐学习。</p></div></div>    
</body>
</html>