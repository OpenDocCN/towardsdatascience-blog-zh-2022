<html>
<head>
<title>5 Hidden Secrets of Pandas to Improve Your Workflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫的5个隐藏秘密改善你的工作流程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-hidden-secrets-of-pandas-to-improve-your-workflow-9f2bbebe584a#2022-07-25">https://towardsdatascience.com/5-hidden-secrets-of-pandas-to-improve-your-workflow-9f2bbebe584a#2022-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9bc8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索熊猫图书馆中隐藏的珍宝</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b8fbe710124de40b472dd9e5eb2c2818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*841kStktVoZYH_yc"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Joshua Reddekopp 在Unsplash 上拍摄的照片</p></figure><p id="e4c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是Python中数据分析的精华库！该库使复杂的数据分析变得非常简单。然而，图书馆里有许多隐藏的宝石被藏了起来。在这篇文章中，你将学习五个顶级的功能和方法来改善你的熊猫工作流程。</p><p id="0625" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程结束时，您将学会:</p><ol class=""><li id="a23c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">如何提高阅读Excel文件的能力</li><li id="8560" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何掌握缺失数据</li><li id="d62c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何使用分类数据节省空间和改进功能</li><li id="88f9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何将连续变量转换为分类变量</li><li id="315c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何使用逗号分隔的调查数据</li></ol><p id="ab6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><h1 id="aeee" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">像冠军一样阅读Excel文件</h1><p id="93fd" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在许多情况下，您将从读取Excel文件开始分析。与读取整个文件、删除列、转换数据类型和处理缺失值不同，您可以一次性完成所有这些工作！</p><p id="1bfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在许多情况下，积极主动地了解如何读取数据可以提高代码的性能，并使其更易于阅读。让我们来看一个有一些怪癖的数据集:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/cfe87e342c3c052b17d6e9c01ab383d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SbxH_g1-g7VrRF3mYhmTLw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">要使用的Excel报表</p></figure><p id="a958" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的报告中，我们可以注意到一些事情:</p><ol class=""><li id="356a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">数据直到第3行才开始</li><li id="b60c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">有一个随机列不包含任何数据</li><li id="41ff" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们有并不真正丢失的丢失数据，只是简单地标记为<code class="fe ni nj nk nl b">MISSING</code></li><li id="bede" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们有多种数据类型</li></ol><p id="f385" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何使用强大的<code class="fe ni nj nk nl b">pd.read_excel()</code>函数一次性处理所有这些。接下来，<a class="ae ky" href="https://github.com/datagy/mediumdata/raw/master/PandasTips.xlsx" rel="noopener ugc nofollow" target="_blank">可以在这里随意下载虚构的数据集</a>(来源:作者创建)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b96b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来分解一下我们的代码做了什么:</p><ul class=""><li id="96a9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu no mb mc md bi translated"><code class="fe ni nj nk nl b">skiprows=</code>指示熊猫跳过规定的行数</li><li id="8557" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated"><code class="fe ni nj nk nl b">usecols=</code>允许我们传入想要阅读的列。在这种情况下，我们使用Excel范围！</li><li id="1378" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated"><code class="fe ni nj nk nl b">na_values=</code>指定哪些值代表缺失值。这也可以是一个值列表。</li><li id="174c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated"><code class="fe ni nj nk nl b">dtype=</code>接受一个<code class="fe ni nj nk nl b">column:datatype</code>键值对的字典。这里有一点预览，用于将数据作为分类读取！</li></ul><p id="4819" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下一节中，您将了解如何更优雅地处理丢失的数据。</p><h1 id="c177" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">改进缺失数据的处理</h1><p id="334b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Pandas为处理缺失数据提供了一个有用的缺失方法，即<code class="fe ni nj nk nl b">.fillna()</code>方法。从表面上看，这个方法似乎很简单——事实也的确如此。也就是说，该方法还提供了相当多有用的功能，尤其是在与其他方法结合使用时。</p><p id="9571" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看下面的数据集:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/f3e0b5a6530a6363fe33aa644c8dff80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o5LrOehiN6yZHHfOUlI4JQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">含有大量缺失数据的数据集(来源:Nik Piepenbreier)</p></figure><p id="36b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的数据集中，我们有两列，每列都有缺失的数据:</p><ol class=""><li id="9518" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe ni nj nk nl b">Category</code>栏缺少可以填写的类别</li><li id="866f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ni nj nk nl b">Amount</code>列缺少数据。在这种情况下，考虑到每个类别中值的差异，用单个值填充可能没有意义。</li></ol><p id="5384" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们先处理一下<code class="fe ni nj nk nl b">Category</code>列:<code class="fe ni nj nk nl b">.fillna()</code>方法有一个可选参数，它提供了向前填充数据的选项。我们可以通过在函数中传递<code class="fe ni nj nk nl b">method='ffill'</code>来做到这一点。</p><p id="075e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ni nj nk nl b">Amount</code>列稍微复杂一点:我们可能不想用任何给定值填充它。由于书籍和计算机的金额相差很大，简单地使用该列的平均值是不合适的。<strong class="lb iu">不过，我们可以用各组的平均值来填补缺失值。</strong></p><p id="6179" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何在熊猫身上处理这两种操作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="029e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们能够使用<code class="fe ni nj nk nl b">.groupby()</code>方法和<code class="fe ni nj nk nl b">.fillna()</code>方法来填充每组数据的平均值。</p><h1 id="2e82" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">使用分类数据节省空间</h1><p id="1c83" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在这一节中，我们将深入分类数据的奇妙世界！虽然这听起来可能不令人兴奋，但分类数据提供了很多很多好处。这些优势中有两个关键优势:</p><ol class=""><li id="8b79" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">节省了大量空间，而且</li><li id="1f57" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">向数据中添加自定义排序顺序</li></ol><p id="9fc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们先看看如何创建分类数据及其节省空间的属性。在第一部分中，我们在读取Excel文件时分配了数据类型。虽然这是最聪明的处理方式，但是让我们稍后转换一个列，看看这样可以节省多少空间。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="c9d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的代码中我们可以看到，即使在一个小的数据集中，将数据转换成分类数据<strong class="lb iu">也节省了将近1/3的空间</strong>！</p><p id="a2aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下一节中，您将学习如何使用分类数据通过逻辑类别对数据进行排序！</p><h1 id="dcfc" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建有序类别</h1><p id="e016" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">基于您在上一节中学到的分类数据，我们甚至可以创建有序分类数据。当您有逻辑分类数据(如质量等级或衬衫尺寸)时，这很有帮助。</p><p id="6357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何在熊猫身上做到这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="31ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来分解一下上面的代码实现了什么:</p><ol class=""><li id="c42d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我们创建了一个包含两列的数据框架</li><li id="2f14" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们创建了一个分类数据类型，它按照逻辑顺序对我们的类别进行排序</li><li id="006d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">然后，我们将列转换为这种新的数据类型</li></ol><p id="bb10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在那里，我们通过以下方式演示这种有序分类数据类型的功能:</p><ul class=""><li id="c0e4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu no mb mc md bi translated">按衬衫尺寸排序——数据不是按字母顺序排序，而是按我们之前提供的顺序排序</li><li id="ee9a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu no mb mc md bi translated">我们使用一个类别过滤我们的数据框架，并计算总销售额</li></ul><h1 id="66b9" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">展开您的调查数据</h1><p id="b78c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在最后一节中，我们将了解如何更好地处理调查数据，或者更确切地说，如何处理列中逗号分隔的值。</p><p id="360a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在许多情况下，从测量工具中提取的数据将在一个单元格中包含一个选项列表，用逗号分隔。这通常不是很好的工作，但谢天谢地熊猫来救援了！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0d66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，在我们的数据帧中，<code class="fe ni nj nk nl b">Sports</code>列并不是特别有用。我们可以通过使用<code class="fe ni nj nk nl b">.explode()</code>方法将这个列转换成更有用的东西，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="305f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，通过分解我们的<code class="fe ni nj nk nl b">Sports</code>列，我们创建了该列的非透视版本，在那里我们可以随心所欲地过滤！</p><h1 id="0ee9" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论</h1><p id="e0d2" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在本教程中，我们探索了熊猫图书馆的五个隐藏的瑰宝。该库充满了惊人的功能，让您以多种不同的方式探索和操作您的数据。</p></div></div>    
</body>
</html>