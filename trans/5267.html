<html>
<head>
<title>Time series forecasting in Snowflake using SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 SQL 的雪花时序预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-forecasting-in-snowflake-using-sql-6ce7cedce862#2022-11-25">https://towardsdatascience.com/time-series-forecasting-in-snowflake-using-sql-6ce7cedce862#2022-11-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="58c1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">需求预测、供应链和库存管理、财务规划对企业运营非常重要。Modelstar 让您在雪花中做到这一点，只需一行 SQL。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/262716df1d6ac45e8ffd78bf4d2e1e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0arcxHyLoSO9q7v_87SIkw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">博客输出概述。图片作者。</p></figure><h1 id="7970" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">什么是时间序列预测及其用例？</h1><p id="1056" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">时间序列预测是一种基于历史时间采样数据预测值的技术。</p><h2 id="ea37" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">预测是企业管理的基础<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#sales-forecasting-is-rudimentary-for-business-management" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="0105" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">预测可以帮助公司在供应链管理、库存管理(关于补货数量和时间)、财务规划、产品路线图和招聘策略等方面做出正确的商业决策。有了准确及时的预测结果，企业管理层可以更好地了解如何分配资源或利用顺风。</p><h2 id="026e" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">预测的技术挑战</h2><p id="e94c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">预测是时间序列分析的一种应用。有几个组件需要考虑:</p><ul class=""><li id="8c1a" class="mw mx iq lp b lq my lt mz lw na ma nb me nc mi nd ne nf ng bi translated">季节性:随时间的周期性变化。例如:寒暑假是每年一次，或者每天早上喝更多的咖啡。</li><li id="1120" class="mw mx iq lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">趋势:持续的非周期性变化。例如:过去 5 年公司销售额的增长。</li><li id="db91" class="mw mx iq lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">破坏性事件:突然的变化。它可能由可预测的因素(如假期或服务维护)和不可预测的问题(如随机错误或缺陷)共同驱动。</li></ul><p id="50c3" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">一个好的预测算法应该捕获大部分成分，并在统计上以一定的置信度做出预测。</p><h2 id="bde0" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">实施的技术挑战</h2><p id="dcd4" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Python 有丰富的生态系统来实现机器学习和预测算法。雪花的新 Snowpark 功能将 Python 引入您的数据仓库，使用 UDF 在 SQL 中运行 Python，这是您可以对数据执行的转换的游戏规则改变者。但是，如果您想要实施一个端到端的解决方案来执行预测，这可能会令人望而生畏并且非常耗时。<a class="ae mv" href="https://github.com/modelstar-labs/modelstar" rel="noopener ugc nofollow" target="_blank"> Modelstar </a>通过提供一个简化的解决方案将 Python 的强大功能引入 SQL，解决了这个问题。</p><blockquote class="np nq nr"><p id="8494" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><a class="ae mv" href="https://github.com/modelstar-labs/modelstar" rel="noopener ugc nofollow" target="_blank"> Modelstar </a>是一个开源项目，建立在最近推出的雪花功能上，比如 Snowpark。它在雪花计算中自动处理依赖关系、模型人工制品和文件 I/O。</p></blockquote><h2 id="12a5" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">用于预测的 SQL 1-liner<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#the-sql-1-liner-for-forecasting" rel="noopener ugc nofollow" target="_blank"/></h2><p id="f9e7" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mv" href="https://modelstar.io/" rel="noopener ugc nofollow" target="_blank"> Modelstar </a>让您可以发送和管理预测模型，并在雪花中用一行 SQL 可视化建模结果。在幕后，Modelstar 提供了预构建的预测算法，并将它们作为 SQL 存储过程公开在您的数据库中。在这个例子中，我们将使用<code class="fe nw nx ny nz b">univariate_time_series_forecast</code> ( <a class="ae mv" href="https://modelstar.io/docs/api/ml-sql-functions/univariate-time-series-forecast" rel="noopener ugc nofollow" target="_blank"> API 文档</a>)。这个 API 基于一个开源库<a class="ae mv" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank"> Prophet </a>，这是业界使用最广泛的预测算法之一。</p><p id="9f91" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi oa translated">本教程提供了建立时间序列预测模型和报告的步骤。它包括:</p><ul class=""><li id="d5c0" class="mw mx iq lp b lq my lt mz lw na ma nb me nc mi nd ne nf ng bi translated">基本概念:关于销售预测用例及技术。</li><li id="70b1" class="mw mx iq lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">Modelstar CLI 工具:Modelstar 安装指南</li><li id="c79f" class="mw mx iq lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated"><code class="fe nw nx ny nz b">univariate_time_series_forecast</code> SQL 语法:进行预测的 SQL 1-liner</li><li id="5649" class="mw mx iq lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">预测报告:可供业务团队使用的预测结果</li></ul><p id="c36a" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">在本示例结束时，您将知道如何在雪花内部训练预测模型，并生成显示模型性能的报告，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/d53b766ae997e571a0557e758bd4d51c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/0*paHe0TZrXPWL0GTN.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们的产出报告。图片作者。</p></figure><h1 id="09a0" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">SQL ML 之旅的准备<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#preparation-for-the-sql-ml-journey" rel="noopener ugc nofollow" target="_blank"> </a></h1><p id="e95f" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">如果您是第一次使用 Modelstar，这是一个安装 Modelstar 的快速入门指南。</p><h2 id="b346" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">第一步:安装型号之星<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#step-1-install-modelstar" rel="noopener ugc nofollow" target="_blank"> </a></h2><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="cef9" class="oo kw iq nz b be op oq l or os">$ pip install modelstar</span></pre><blockquote class="np nq nr"><p id="c6d9" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><strong class="lp ir">提示:</strong>我们建议使用虚拟环境来管理依赖关系。下面是如何开始的快速概述:<a class="ae mv" href="https://krishadi.com/zettelkasten/python" rel="noopener ugc nofollow" target="_blank"> Python 环境</a>。</p></blockquote><p id="e78a" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">通过快速版本检查来验证安装:</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="60ff" class="oo kw iq nz b be op oq l or os">$ modelstar --version</span></pre><p id="5858" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">这应该会在您的终端中显示版本号。</p><h2 id="2467" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">步骤 2:初始化一个模型星项目<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#step-2-initialize-a-modelstar-project" rel="noopener ugc nofollow" target="_blank"> </a></h2><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="e20f" class="oo kw iq nz b be op oq l or os">$ modelstar init forecast_project</span></pre><blockquote class="np nq nr"><p id="1d29" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><strong class="lp ir">提示:</strong> <code class="fe nw nx ny nz b">modelstar init &lt;project_name&gt;</code> <strong class="lp ir"> </strong>是基本命令，其中<code class="fe nw nx ny nz b">&lt;project_name&gt;</code>可以替换为您选择的名称。</p></blockquote><p id="1ca5" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">现在你会看到一个<code class="fe nw nx ny nz b">forecast_project</code>文件夹创建在你的工作目录中。</p><h2 id="824c" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">步骤#3:配置雪花会话<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#step-3-config-snowflake-session" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="f8b6" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在<code class="fe nw nx ny nz b">forecast_project</code>文件夹中，找到文件<code class="fe nw nx ny nz b">modelstar.config.yaml</code>，用你最喜欢的编辑器打开它。向其中添加您的雪花帐户信息和凭据。随意用任何名称命名会话。在这个例子中，我们使用<code class="fe nw nx ny nz b">snowflake-test</code>。该文件中的凭证用于连接到您的雪花数据仓库。(注意:不要将 modelstar.config.yaml 文件提交到您的 CI/CD 版本控制中。)</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="d8fa" class="oo kw iq nz b be op oq l or os"># ./modelstar.config.yaml<br/># MODELSTAR CONFIGURATION FILE<br/>---<br/>sessions:<br/>    - name: snowflake-test<br/>      connector: snowflake<br/>      config:<br/>          account: WQA*****<br/>          username: &lt;username&gt;<br/>          password: &lt;password&gt;<br/>          database: MODELSTAR_TEST<br/>          schema: PUBLIC<br/>          stage: test<br/>          warehouse: COMPUTE_WH</span></pre><blockquote class="np nq nr"><p id="cdf4" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><strong class="lp ir">注意:</strong>请在您的雪花仓库数据库中创建阶段，并在配置中指定它。</p></blockquote><h2 id="3223" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">第四步:Ping 雪花<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#step-4-ping-snowflake" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="a4a1" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我们现在可以从您的终端启动 Modelstar 会话。在新生成的 Modelstar 项目的目录中(在我们的示例中，它是<code class="fe nw nx ny nz b">./forecast_project/</code>)，运行以下命令:</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="3ccf" class="oo kw iq nz b be op oq l or os">$ modelstar use snowflake-test</span></pre><blockquote class="np nq nr"><p id="738d" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><strong class="lp ir">提示:</strong> <code class="fe nw nx ny nz b">modelstar use &lt;session name&gt;</code>是命令，如果你给了另一个会话名，用那个来代替<code class="fe nw nx ny nz b">&lt;session name&gt;</code>。</p></blockquote><p id="7a3f" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">一次成功的 ping 应该会导致如下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/35a3ae245b8ea002481d1dc4938e61c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xkb6p4xI6ZSjbqKl.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">控制台输出。图片作者。</p></figure><h2 id="02f9" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">第五步:将预测算法注册到雪花<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#step-5-register-the-forecast-algorithm-to-snowflake" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="5c0e" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Modelstar 提供了现成的预测算法，并管理该算法的依赖关系，因此您不必这样做。要使其在您的雪花仓库中可用，请运行以下命令:</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="1023" class="oo kw iq nz b be op oq l or os">$ modelstar register forecast:univariate_time_series_forecast</span></pre><p id="ba86" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">成功消息如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/f871a5ea412086f5e5438d75626f8372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a_kqw10gypV96xDW.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">控制台输出。图片作者。</p></figure><h2 id="33b1" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">步骤#6:将样本销售数据上传到雪花(可选，如果您使用自己的数据集)<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#step-6-upload-sample-sales-data-to-snowflake" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="f845" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">如果您想在示例销售数据集上尝试预测算法，请运行此命令在您的数据仓库中创建一个数据表。如果您想使用自己的数据，可以跳过这一步。</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="e308" class="oo kw iq nz b be op oq l or os">$ modelstar create table sample_data/time_series_data.csv:TS_DATA_TABLE</span></pre><p id="a588" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">该命令将<code class="fe nw nx ny nz b">time_series_data.csv</code>文件上传到雪花并创建一个名为<code class="fe nw nx ny nz b">‘TS_DATA_TABLE’</code>的表。在这里找到更多关于这个<a class="ae mv" href="https://modelstar.io/docs/api/cli/create" rel="noopener ugc nofollow" target="_blank"> API 的信息。</a></p><h1 id="024d" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">使用 SQL 1-linear <a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#build-a-forecast-model-using-a-sql-1-linear" rel="noopener ugc nofollow" target="_blank"> </a>构建预测模型</h1><h2 id="2922" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">在雪花工作表<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#run-this-script-in-a-snowflake-worksheet" rel="noopener ugc nofollow" target="_blank"> </a>中运行该脚本</h2><p id="a934" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在 Snowflake 中使用以下命令来构建预测模型(下面的示例使用了在步骤#6 中上传的样本数据):</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="8dff" class="oo kw iq nz b be op oq l or os">CALL UNIVARIATE_TIME_SERIES_FORECAST('TS_DATA_TABLE', 'DS', 'Y', 40, 'M');</span></pre><p id="ca70" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">意思是:根据<code class="fe nw nx ny nz b">TS_DATA_TABLE</code>表中的历史数据预测<code class="fe nw nx ny nz b">Y</code>值的下一个<code class="fe nw nx ny nz b">40</code> <code class="fe nw nx ny nz b">M</code>(月)，其中<code class="fe nw nx ny nz b">DS</code>为时间列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/d388a07089af85f1921a13f4e3b73249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uPq-MrLBmwFiVOHEvJ8kg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">雪花雪景。图片作者。</p></figure><h2 id="f252" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">对您自己的数据运行预测算法<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#to-run-the-forecasting-algorithm-on-your-own-data" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="8782" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在幕后，预测算法作为存储过程在雪花内部运行。它采用以下参数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="cf79" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">要配置您自己的预测周期，请查看<a class="ae mv" href="https://modelstar.io/docs/api/ml-sql-functions/univariate-time-series-forecast" rel="noopener ugc nofollow" target="_blank">该 API 文档</a>以获取设备别名的完整列表。</p><h2 id="1c0d" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">检查结果<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#check-the-result" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="88bc" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">模型训练完成后，在雪花结果窗口中，一次成功的运行应该会输出如下所示的 json 字符串:</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="ff16" class="oo kw iq nz b be op oq l or os">{<br/>    "return_table": "RESULT_UNIVARIATE_TIME_SERIES_FORECAST",<br/>    "run_id": "3NvQXnHQqUdYG4Fu"<br/>}</span></pre><p id="bc34" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">表示已经创建了一个名为“RESULT _ UNIVARIATE _ TIME _ SERIES _ FORECAST”的表来物化预测数据，运行 id(“3 nvqxnhqkudyg 4 fu”)可以帮助您拉取预测报告。</p><h2 id="450b" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">查看<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#check-the-prediction-data-table" rel="noopener ugc nofollow" target="_blank">预测数据表</a></h2><p id="8547" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">让我们使用以下命令检查运行的结果表:</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="8160" class="oo kw iq nz b be op oq l or os">SELECT * FROM RESULT_UNIVARIATE_TIME_SERIES_FORECAST;</span></pre><p id="d706" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">表格中有 4 列:</p><ul class=""><li id="aa7d" class="mw mx iq lp b lq my lt mz lw na ma nb me nc mi nd ne nf ng bi translated"><code class="fe nw nx ny nz b">DS</code> ( <code class="fe nw nx ny nz b">datetime</code>):日期时间</li><li id="6f89" class="mw mx iq lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated"><code class="fe nw nx ny nz b">Y_FORECAST</code>、<code class="fe nw nx ny nz b">YHAT_LOWER</code>、<code class="fe nw nx ny nz b">YHAT_UPPER</code> (float):预测值的均值、下键和上键(其含义参见术语表部分的<code class="fe nw nx ny nz b">Uncertainty Intervals</code>)。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/efa082338296ee78f6cf8b322d728632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SLSV77WwJt37PDYR08IVA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">雪花雪景。图片作者。</p></figure><h2 id="c892" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">检查预测报告</h2><p id="f960" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">使用 Modelstar 自动生成一份报告，其中记录了有关运行的信息，以及机器学习工件。要检查报告，只需在本地计算机上运行以下命令:</p><pre class="kg kh ki kj gt ok nz ol bn om on bi"><span id="2ea1" class="oo kw iq nz b be op oq l or os">$ modelstar check &lt;run_id&gt;</span></pre><p id="3996" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">您的终端应该会显示以下消息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/70b248fac98318fc26e236652d1f2250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iVXLmzOhXujR3_0O.png"/></div></div></figure><p id="3428" class="pw-post-body-paragraph ln lo iq lp b lq my jr ls lt mz ju lv lw nm ly lz ma nn mc md me no mg mh mi ij bi translated">如前所述，一份报告将出现在您的浏览器中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/e804c632b09f3b23ccfe2c40be1c0708.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/0*tNt0aL8ovoAVsU6a.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模特之星报道。图片作者。</p></figure><h2 id="0e3b" class="mj kw iq bd kx mk ml dn lb mm mn dp lf lw mo mp lh ma mq mr lj me ms mt ll mu bi translated">报告里有什么<a class="ae mv" href="https://modelstar.io/docs/tutorials/sales-forecasting-inside-snowflake/#whats-in-the-report" rel="noopener ugc nofollow" target="_blank"> </a></h2><p id="679e" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">该报告包括 3 个部分:</p><ul class=""><li id="cb54" class="mw mx iq lp b lq my lt mz lw na ma nb me nc mi nd ne nf ng bi translated">本次运行的元信息</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/f0966a789eb0fad577caafb77376b098.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/0*RbDtqLKdMgRoRcCO.png"/></div></figure><ul class=""><li id="957c" class="mw mx iq lp b lq my lt mz lw na ma nb me nc mi nd ne nf ng bi translated">预测图:检查建模质量和预测结果。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/c9f8583b0a3a876fd581b6160dc43d8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fnXW4SyMBs24x15A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模特之星报道。图片作者。</p></figure><ul class=""><li id="f484" class="mw mx iq lp b lq my lt mz lw na ma nb me nc mi nd ne nf ng bi translated">组件分析:为了说明趋势和季节性，您的模型已经“学习”了，包括总体趋势，以及每年和每周的季节性(超过 1 年/周的周期模式)。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/6b90aaeaf6cc3349aa212023fc0ae024.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/0*cOIeT029azHFKTQG.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模特之星报道。图片作者。</p></figure><blockquote class="np nq nr"><p id="cfe1" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><strong class="lp ir">词汇</strong></p><p id="a510" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><strong class="lp ir"> <em class="iq">样本内和样本外预测:</em> </strong> <em class="iq">通过样本内预测，可以检查预测模型与实际数据的拟合程度。样本外预测显示对未来的预测。</em></p><p id="3857" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><strong class="lp ir"> <em class="iq">不确定区间:</em> </strong> <em class="iq">上下界之间的区间。这意味着真实值有 80%的概率落在该区间内。更高的确定性要求导致更宽的频带(参见</em> <a class="ae mv" href="https://www.mikulskibartosz.name/understanding-uncertainty-intervals-generated-by-prophet/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">巴托兹的文章</em> </a> <em class="iq">)。不确定性也随着我们走向更远的未来而增长，导致作为时间函数的带宽变宽。</em></p></blockquote><h1 id="3595" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">结论</h1><p id="80d3" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">预测是商业管理的基础。我们的目标是为雪花提供预测功能，以训练机器学习模型并使用它进行预测。我们只用一行 SQL 就实现了所有这些。与此同时，还会生成一个运行报告，其中包含运行的详细信息以及预测分析。这是由<a class="ae mv" href="https://github.com/modelstar-labs/modelstar" rel="noopener ugc nofollow" target="_blank"> Modelstar </a>实现的。</p><blockquote class="np nq nr"><p id="ae4b" class="ln lo ns lp b lq my jr ls lt mz ju lv nt nm ly lz nu nn mc md nv no mg mh mi ij bi translated"><em class="iq">查看 Modelstar 的</em> <a class="ae mv" href="https://github.com/modelstar-labs/modelstar" rel="noopener ugc nofollow" target="_blank"> <strong class="lp ir"> <em class="iq"> GitHub 库:这里</em> </strong> </a> <em class="iq">，star 它将会在最新更新。如果您的用例出现了 bug、问题或功能请求，请联系</em><a class="ae mv" href="https://github.com/modelstar-labs" rel="noopener ugc nofollow" target="_blank"><em class="iq">Github</em></a><em class="iq">或在</em><a class="ae mv" href="https://github.com/modelstar-labs/modelstar/issues" rel="noopener ugc nofollow" target="_blank"><em class="iq">Github</em></a><em class="iq">上打开问题。</em></p></blockquote><ul class=""><li id="fa95" class="mw mx iq lp b lq my lt mz lw na ma nb me nc mi nd ne nf ng bi translated">GitHub 库:<a class="ae mv" href="https://github.com/modelstar-labs/modelstar" rel="noopener ugc nofollow" target="_blank">https://github.com/modelstar-labs/modelstar</a></li><li id="b370" class="mw mx iq lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">文档:【https://modelstar.io/docs/quickstart/ T2】</li></ul></div></div>    
</body>
</html>