<html>
<head>
<title>Introduction to Global Forecasting Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">全球预测模型简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-global-forecasting-models-3ca8e69a6524#2022-05-02">https://towardsdatascience.com/introduction-to-global-forecasting-models-3ca8e69a6524#2022-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cd3a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python训练具有多个时间序列的预测模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c38d765ccdaf539c2acfe3c0441b2462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8hTjswolBPNyd8Ln"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@kar111?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">郭佳欣·阿维蒂西安</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="65f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">全球模型正成为时间序列预测的首选方法。以下是如何使用Python构建这些模型。</strong></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0bd6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从本地模式到全球模式</h1><p id="4343" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">假设我们想要预测给定时间序列的未来值。我们使用时间序列的历史观察来建立训练集。然后，使用该数据选择并拟合预测模型。图1显示了这个过程的一个例子。</p><p id="dbfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们创建模型的典型操作方式。这方面的例子是经典的方法，如ARIMA或指数平滑。ARIMA的AR(自回归)部分将未来观测值建模为过去观测值的线性组合。自动回归也可以应用于非线性回归模型，如随机森林。MA部分类似，但使用过去的误差。指数平滑法使用过去值的加权平均值。对于较老的观测值，权重呈指数衰减。</p><p id="0e05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些模型是局部的，因为训练数据只涉及一个时间序列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/829ed33968a99d0be6feddf5f2a56b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gDjgUNZm_2yWWXnnsyaEfQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:澳大利亚啤酒产量的时间序列，蓝色部分是ARIMA对未来观测的预测。在这种情况下，在预测之前，使用过去的观察训练一个<strong class="bd na">局部</strong>模型。图片作者。</p></figure><p id="ae42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，全球预测模型越来越受欢迎。这些<strong class="lb iu">汇集了多个时间序列的历史观测值，以符合预测模型</strong>。</p><p id="94a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">全球预测模型不同于多元时间序列预测。在前者中，我们将许多时间序列的观察值(表中的行)连接起来。对于多元时间序列，我们包括额外的序列作为解释变量(表中的列)。ARIMAX就是一个例子。</p><h2 id="dcb9" class="nb md it bd me nc nd dn mi ne nf dp mm li ng nh mo lm ni nj mq lq nk nl ms nm bi translated">直觉和假设</h2><p id="d80d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">通过对多个时间序列的学习，模型获得了更好的泛化能力。这将导致更好的预测性能。额外的可用时间序列代表更多的训练数据。机器学习方法通过更大的训练样本提高了它们的预测性能。你可以在<a class="ae ky" href="https://medium.com/p/b5271ec784dc" rel="noopener">之前的文章</a>中读到更多。</p><p id="c283" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">全球预测模型有一个重要的假设。输入的时间序列彼此之间有些关联。这里有个例子。假设我的目标是预测给定位置的风速以产生能量。加上谷歌的股价对训练模型帮助不大。然而，添加从不同位置捕获的风速可能会有一些用处。</p><p id="e184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在应用全局模型之前对时间序列进行聚类可能是一个合理的想法。详见参考文献[3]。</p><h2 id="2a6a" class="nb md it bd me nc nd dn mi ne nf dp mm li ng nh mo lm ni nj mq lq nk nl ms nm bi translated">成功的例子</h2><p id="2bbc" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">全球方法的有用性在M4和M5的预报竞赛中得到了证明。表现最好的方法遵循这种训练策略。</p><p id="a228" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">从许多时间序列中交叉学习</strong>是训练深度神经网络的标准方法。示例包括DeepAR或N-BEATS等。使用其他算法也可以提高预测性能。M5竞赛的获胜者采用了LightGBM全球战略。</p><h1 id="892a" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">把手放在某物或者某人身上</h1><p id="61b6" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">现在我们对全球预测模型的运作有了基本的了解。在这里，我将编写一个简单的全球预测模型来预测电力需求。</p><h2 id="8048" class="nb md it bd me nc nd dn mi ne nf dp mm li ng nh mo lm ni nj mq lq nk nl ms nm bi translated">案例研究—电力需求预测</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/9d9dbdbdee9b981f1d7292cc15a234ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sJdoT5st-StI-PZ_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@matthewhenry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马太·亨利</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="e40d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">电力需求预测对于管理电网运行非常重要。例如，平衡能源的供求。这里我们将使用一组可用的时间序列<a class="ae ky" href="https://www.entsoe.eu/data/data-portal/" rel="noopener ugc nofollow" target="_blank"/>。该数据集包含许多欧洲国家每小时的电力消耗数据。为简单起见，我们将重点关注三个国家:葡萄牙、法国和英国。</p><p id="cc5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是完整的代码，我将在下面解释。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="15e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先读取数据，并将其准备成合适的格式(第1–17行)。这里，为了简洁起见，我跳过了基本的数据操作。我们创建函数<em class="nv"> ts_as_supervised </em>，它将时间序列转换成表格格式。</p><p id="70f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于每个时间序列，我们执行以下操作:</p><ol class=""><li id="cd39" class="nw nx it lb b lc ld lf lg li ny lm nz lq oa lu ob oc od oe bi translated">将数据分成训练集和测试集。在2015年7月1日之后收集的所有观察结果用于测试(第32-34行)；</li><li id="b77f" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">根据训练数据中计算的平均值对时间序列进行规范化(第36–39行)。这一步很重要，因为输入的时间序列通常有不同的尺度。在这个阶段，您可能还需要执行其他预处理步骤。例如，应用幂变换来稳定方差。你可以查看<a class="ae ky" rel="noopener" target="_blank" href="/12-things-you-should-know-about-time-series-975a185f4eb2">之前的一篇文章</a>，在这篇文章中我回顾了最常见的预处理步骤；</li><li id="e951" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu ob oc od oe bi translated">应用函数<em class="nv"> ts_as_supervised </em>将序列转换成表格格式(第41–43行)。</li></ol><p id="7812" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在有趣的部分来了。<strong class="lb iu">我们将所有时间序列的观测值连接起来，以训练一个预测模型</strong>(第46行)。这是目前数据集的一个小样本。请注意，国家和指数列不用于培训。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="65ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在剩余的代码行(48-60)中，我们训练了一个岭回归模型，并将其应用于一个时间序列。</p><h1 id="75cd" class="mc md it bd me mf nn mh mi mj no ml mm jz np ka mo kc nq kd mq kf nr kg ms mt bi translated">外卖</h1><ul class=""><li id="2ee0" class="nw nx it lb b lc mu lf mv li ok lm ol lq om lu on oc od oe bi translated">传统上，使用单个时间序列的历史观察来训练模型；</li><li id="68cb" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu on oc od oe bi translated">全球预测模型通过使用多个相关的时间序列训练模型来工作；</li><li id="2662" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu on oc od oe bi translated">这些方法正在成为训练预测模型的标准方法。这些包括深度神经网络或梯度增强算法(例如light GBM)；</li><li id="0e99" class="nw nx it lb b lc of lf og li oh lm oi lq oj lu on oc od oe bi translated">全球方法的成功例子包括M4和M5预测竞赛的获胜者。</li></ul><h2 id="b0a7" class="nb md it bd me nc nd dn mi ne nf dp mm li ng nh mo lm ni nj mq lq nk nl ms nm bi translated">进一步阅读</h2><p id="2d4d" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">[1] Hewamalage、Hansika、Christoph Bergmeir和Kasun Bandara。"时间序列预测的全球模型:模拟研究."<em class="nv">模式识别</em> 124 (2022): 108441。</p><p id="e52b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] Makridakis，Spyros，Evangelos Spiliotis和Vassilios Assimakopoulos。" M5精确度竞赛:结果、发现和结论."《国际预测杂志》 (2022)。</p><p id="7a67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3] Bandara、Kasun、Christoph Bergmeir和Slawek Smyl。"使用递归神经网络对相似序列组进行跨时间序列数据库的预测:聚类方法."<em class="nv">专家系统及应用</em> 140 (2020): 112896。</p></div></div>    
</body>
</html>