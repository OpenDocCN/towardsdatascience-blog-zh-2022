<html>
<head>
<title>Create a Butterfly Chart Easily Using Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Plotly轻松创建蝴蝶图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-butterfly-chart-easily-using-plotly-aa3d43ba410d#2022-04-11">https://towardsdatascience.com/create-a-butterfly-chart-easily-using-plotly-aa3d43ba410d#2022-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f58e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何用两个简单的步骤创建一个漂亮的蝴蝶图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e3bfe0822680f8acd7a9dde6577e6c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*itMx_UW808p1ZJtviiUoVA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/photos/painted-lady-vanessa-cardui-4294793/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>提供</p></figure><p id="4611" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">蝴蝶图(也称为龙卷风图或双向图)是一种数据可视化类型，它通过并排显示两个水平条形图来比较两个数据系列。左右横条共享中心的同一y轴，并沿x轴指向相反的方向，类似蝴蝶翅膀。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/a1c0ed517b03fd5d607291745e9adc04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HXNTmTUBMmNyZctn3JfYag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">蝴蝶图示例(图片由作者提供)</p></figure><p id="c7c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">蝴蝶图是在一组维度上可视化两组之间差异的好方法。例如，您可以使用它来可视化两组调查参与者(例如，调查1与调查2)对一组调查问题的响应差异。你可以用它来形象化不同行业的性别薪酬差距。你可以用它来比较两种产品在不同地区的销售情况，等等。</p><p id="0150" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将向你展示如何用两个简单的步骤用<code class="fe lw lx ly lz b">Plotly</code>创建一个蝴蝶图。<code class="fe lw lx ly lz b">Plotly</code>没有内置的蝶形图“跟踪”。然而，由于蝴蝶图只是水平条形图的一种特殊类型，我们可以使用一些变通方法来轻松解决这个问题。下面是我们将在本帖中创建的可视化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ma"><img src="../Images/b4fdb1d2d8c217d0157bd7f183d4d9d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eHOu7QW_ZBkXNUQr7Gcn1Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="f6fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用于演示的样本数据可以从美国商务部网站上的<a class="ae ky" href="https://qwiexplorer.ces.census.gov/static/explore.html#x=0&amp;g=0" rel="noopener ugc nofollow" target="_blank"> QWI浏览器</a>下载。该数据集按不同行业和性别显示了Q1 2021的就业人数。让我们导入所有必要的库并将数据读入一个<code class="fe lw lx ly lz b">pandas</code>数据框架。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/7281767a817a5f8877d67d184fc78ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*UiwmPvcspO96QX4-s6jKKg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用<code class="fe lw lx ly lz b">Plotly</code>创建蝴蝶图，我们只需执行以下两个步骤:</p><p id="c4a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤1:创建一个并排有两个水平支线剧情的图形</p><p id="9944" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤2:反转左侧水平条形图的方向</p><p id="765f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！让我们看看它是如何工作的。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h2 id="b2c5" class="ml mm it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">第一步:用两个并排的水平条形图创建一个图形</h2><p id="df37" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">让我们首先使用<code class="fe lw lx ly lz b">plotly.subplots.make_subplots()</code>创建两个水平条形图。这允许我们创建一个1行2列的绘图网格，我们可以用一个共享的y轴并排放置两个水平条形图(“跟踪”)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="446f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第2–3行:因为我们想并排放置两个水平条形图，我们需要创建一个fig(绘图网格),它有1行2列，共享y轴。</p><p id="58c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第5–13行:我们将第一个水平条形图添加到绘图中。这个条形图显示了各行业男性员工的就业情况。第7–8行使我们能够用千位分隔符显示计数，并在条形上显示数字。第13行指定了图表的位置—放置在绘图网格左侧的第1行第1列。</p><p id="a241" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第15–23行:我们将第二个水平条形图添加到绘图中。该柱状图显示了按行业分列的女性员工的就业人数。第23行指定第二个条形图的位置——放置在绘图网格右侧的第1行第2列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/51613a72e4b7781a89a6246da5c10026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60bjXhUi5RX3h1BEDbNgOg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="9c00" class="ml mm it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">步骤2:反转左侧水平条形图的方向</h2><p id="8853" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">上面的图表看起来不错！现在让我们反转第一个水平条形图的方向，并使图双向。这是通过使用<code class="fe lw lx ly lz b">fig.update_xaxes()</code>并将<code class="fe lw lx ly lz b">range</code>参数指定为[16000000，0]来实现的，如下面的代码(第1行)所示。</p><p id="db6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果两个条形图的x轴范围相同，我们也可以使用<code class="fe lw lx ly lz b">autorange='reversed'</code>。在我们的示例中，左侧条形图的默认x轴范围(自动范围)是0–8M，这比右侧条形图的范围(0–15M)小得多，会使可视化产生误导。因此，我们为左侧图表显式指定范围，并使用[16000000，0]来确保左侧图表的x轴反转(从右到左)。</p><p id="03c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以添加一个图表标题，并使用<code class="fe lw lx ly lz b">fig.update_layout()</code>调整图片大小和其他属性。注意，在第11行和第12行，我们可以指定x轴标题的位置在顶部。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mi mj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ma"><img src="../Images/b4fdb1d2d8c217d0157bd7f183d4d9d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eHOu7QW_ZBkXNUQr7Gcn1Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="57e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就对了。只需两个简单的步骤和几行python代码，您就创建了一个漂亮的蝴蝶图，直观地显示了不同行业中男性和女性员工人数的差异。从可视化上，我们可以立刻分辨出哪些行业板块是男性集中vs .女性集中，结果相当直观！</p><p id="1ea3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，我希望你喜欢这个关于<code class="fe lw lx ly lz b">Plotly</code>的教程。如果你对<code class="fe lw lx ly lz b">Plotly</code>完全陌生，并且想阅读一篇关于如何使用<code class="fe lw lx ly lz b">Plotly</code>创建数据可视化的介绍性文章，你可以在这里阅读我的另一篇<a class="ae ky" rel="noopener" target="_blank" href="/leap-from-matplotlib-to-plotly-a-hands-on-tutorial-for-beginners-d208cd9e6522">文章</a>。</p><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/leap-from-matplotlib-to-plotly-a-hands-on-tutorial-for-beginners-d208cd9e6522"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">从Matplotlib到Plotly的飞跃:初学者实践教程</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">如何使用Plotly创建带有自定义工具提示和范围滑块的交互式组合图</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ks nn"/></div></div></a></div></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="8653" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据来源:</strong></p><p id="804a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Q1 2021年按行业和性别统计的就业人数:<a class="ae ky" href="https://qwiexplorer.ces.census.gov/static/explore.html#x=0&amp;g=0" rel="noopener ugc nofollow" target="_blank">美国人口普查局，LEHD经济研究中心</a>。这是一个免费的开放数据集，可以使用<a class="ae ky" href="https://qwiexplorer.ces.census.gov/static/explore.html#x=0&amp;g=0" rel="noopener ugc nofollow" target="_blank"> QWI浏览器</a>下载。不需要许可证。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="b858" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以通过这个<a class="ae ky" href="https://medium.com/@insightsbees/membership" rel="noopener">推荐链接</a>注册Medium会员(每月5美元)来获得我的作品和Medium的其他内容。通过这个链接注册，我将收到你的一部分会员费，不需要你额外付费。谢谢大家！</p></div></div>    
</body>
</html>