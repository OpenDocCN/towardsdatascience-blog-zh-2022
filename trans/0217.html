<html>
<head>
<title>K-Nearest Neighbors in Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Excel中的k-最近邻</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/k-nearest-neighbors-in-excel-76edd4102a5b#2022-02-09">https://towardsdatascience.com/k-nearest-neighbors-in-excel-76edd4102a5b#2022-02-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="184d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在一系列文章中，我使用Excel/Google Sheet来实现基本的机器学习算法，以便我们可以理解其中的基本原理:</p><ul class=""><li id="ea21" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated"><a class="ae kx" rel="noopener" target="_blank" href="/linear-regression-from-scratch-in-excel-3d8192214752">Excel中带梯度下降的线性回归</a> /Google Sheet</li><li id="a8dc" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated"><a class="ae kx" rel="noopener" target="_blank" href="/logistic-regression-with-gradient-descent-in-excel-52a46c46f704">Excel中的梯度下降逻辑回归</a> /Google Sheet</li><li id="610a" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated"><a class="ae kx" rel="noopener" target="_blank" href="/neural-network-from-scratch-in-excel-4774f6131cdb">Excel中的神经网络从无到有</a></li><li id="0a63" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated"><a class="ae kx" rel="noopener" target="_blank" href="/k-means-from-scratch-in-excel-bb60778d186e">K-Excel中从头开始的意思</a></li></ul><p id="7225" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这篇文章中，我将解释K近邻是如何工作的。为了全面理解机器学习算法是如何工作的，你可以阅读我关于监督学习算法的<a class="ae kx" rel="noopener" target="_blank" href="/overview-of-supervised-machine-learning-algorithms-a5107d036296">完整概述</a>的文章。</p><p id="1cff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与大多数机器学习算法相反，没有针对KNN的训练。更准确地说，如果我们区分所有机器学习算法的以下步骤:</p><ul class=""><li id="864d" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated"><strong class="js iu">训练</strong>的算法，找到<strong class="js iu">模型的参数</strong></li><li id="e804" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated"><strong class="js iu">超参数调整</strong>通过网格搜索找到最佳超参数，避免过拟合和欠拟合</li></ul><p id="5e39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那么对于KNN，只有超参数调整这一步，包括找到最佳超参数<strong class="js iu"> k </strong>。</p><p id="7414" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于<strong class="js iu">模型</strong>部分，KNN的原理是利用整个数据集寻找k个最近邻。欧几里得距离经常被使用。预测阶段包括</p><ul class=""><li id="1b7b" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">对于<strong class="js iu">回归</strong>，计算所选邻居的目标变量的平均值</li><li id="2821" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">对于<strong class="js iu">分类</strong>，计算所选最近邻的每一类目标变量的比例</li></ul><p id="0681" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们开始在Excel中实现吧！我们将演示如何用KNN解决回归问题。作为练习，您可以修改分类任务的文件。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/d0ad001d8ee5223e4220bbea1cf246c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4hqRu2cRMJDutKQMlCFNA.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure><h1 id="a54f" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">从零开始为ML的谷歌表</h1><p id="83e2" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">如果你想得到谷歌表，请在Ko-fi上支持我。</p><p id="f74d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以得到我创建的所有谷歌表单(梯度下降的线性回归，逻辑回归，神经网络，KNN，k-means，等等)。)和下面的链接。</p><p id="79d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae kx" href="https://ko-fi.com/s/4ddca6dff1" rel="noopener ugc nofollow" target="_blank">https://ko-fi.com/s/4ddca6dff1</a></p><h1 id="0cc2" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">资料组</h1><p id="9431" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">我们可以只使用一个特征变量x，一个连续的目标变量y。然后我们可以绘制x为横轴，y为纵轴。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/598e818e1121afc4ec702fafa13b8fc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*hg5wDjUz7OUWzt2hihAfVA.png"/></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure><p id="e527" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们可以使用两个特征变量x1和x2。那么我们将无法绘制y。使用Python或R包，我们将创建3D图，或将y的值表示为点的大小，但使用Excel，我不知道如何做到这一点。但正如我们将会看到的，这仍然很有趣。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/d708d21342efb56c4e652e577e227caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*52sJSR6OpO3DO_9DpRi6Wg.png"/></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure><h1 id="f031" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">新观测的预测</h1><p id="74ba" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">对KNN来说，没有可以训练的模式。对于超参数k，我们将使用k=3，因为数据集非常小。</p><p id="b21c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">预测阶段由以下步骤组成:</p><ul class=""><li id="f2f5" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">对于一个给定的新观察值，计算该新观察值与训练数据集中所有观察值之间的距离。</li><li id="d7de" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">找出距离最短的k个观察值。在Excel中，我们将使用筛选器对训练数据集进行手动排序</li><li id="222d" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">计算预测值。对于回归任务，我们计算目标变量的平均值。</li></ul><h2 id="65d7" class="my lu it bd lv mz na dn lz nb nc dp md kb nd ne mh kf nf ng ml kj nh ni mp nj bi translated">一个特征变量</h2><p id="d640" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">对于一个特征变量，欧几里德距离变成新观测值和其他观测值之间的差值的绝对值。</p><p id="6192" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在工作表<em class="nk"> algo1 </em>中，您可以更改新观察值，并使用距离列C的过滤器对数据集进行升序排序，3个最近邻将被自动绘制。</p><p id="b62b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在剧情中，</p><ul class=""><li id="19cf" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">浅蓝色的点代表数据集</li><li id="c0bc" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">黄色圆点用红色表示新观测值的3个最近邻</li><li id="d189" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">红点表示具有预测y值的新观测值</li></ul><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nl"><img src="../Images/5f1515c2d70556b948b79213678c2971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nILF6YYMntZX4VKKVB9M2Q.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure><p id="bca6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在工作表<em class="nk"> algo1f </em>中，我绘制了新观测值的预测，范围从1到17。有了编程语言，我们可以在一个循环中很容易地做到这一点，对于大量的新观察，所以表示可以更密集。</p><p id="5720" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用Excel，我手动重复了以下步骤:</p><ul class=""><li id="3198" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">输入x的值</li><li id="5b94" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">对距离列进行排序</li><li id="31d8" class="ko kp it js b jt ky jx kz kb la kf lb kj lc kn kt ku kv kw bi translated">复制粘贴预测</li></ul><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nm"><img src="../Images/b7eb4f4cc4f3fac2156736abbe4fffc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DW3AFRdpekJMvyihSee8pw.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure><h2 id="4010" class="my lu it bd lv mz na dn lz nb nc dp md kb nd ne mh kf nf ng ml kj nh ni mp nj bi translated">两个特征变量</h2><p id="49e6" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">当我们有两个特征变量时，由于我无法使用Excel进行3D绘图，因此我将只表示一个给定新观测值的相邻要素。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nn"><img src="../Images/aa11be5b990d2c59c9cf1cec8b3c62c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyCiKa4x8_bI60NNBC8YUA.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure><p id="4fa5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于一个<strong class="js iu">二元分类</strong>任务，我们可以用背景上的某种颜色(由许多点组成)来表示概率。我们在<a class="ae kx" href="https://scikit-learn.org/stable/auto_examples/classification/plot_classifier_comparison.html" rel="noopener ugc nofollow" target="_blank"> <em class="nk"> sklearn的分类器比较</em> </a>中有一个图解。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi no"><img src="../Images/a6284b5f43ae2339f66659f653ab04bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZOUlvADDElHgV3r3kRM2cg.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者编辑自<a class="ae kx" href="https://scikit-learn.org/stable/auto_examples/classification/plot_classifier_comparison.html" rel="noopener ugc nofollow" target="_blank"> <em class="np"> sklearn的分类器对比</em> </a></p></figure><h1 id="4868" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">结论</h1><p id="2e94" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">KNN是最简单的机器学习，而且非常容易理解。使用Excel，我们可以演示它如何为业务人员工作，以便他们可以对这种方法以及它是否适合于业务问题有良好的直觉。</p><p id="2b25" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">邻居的概念很容易理解，在某些情况下，他们可以是地理距离上的真实邻居。因此它可用于平滑空间数据。</p><p id="771f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下图中，您可以看到原始值适用于巴黎市的小区域。所以从一个四分之一到它相邻的四分之一，变量可能是不连续的。</p><p id="b926" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这种情况下，KNN可以这样使用:对于巴黎的每个地址，我们找到其最近的邻居并计算平均值。这将导致该目标变量的更加平滑的版本。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nq"><img src="../Images/4a000e30b31e4a33e7b39fd72c020dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P9lozdfODCq1I32dqSrjsw.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">作者图片</p></figure></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="ef45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想获得一个监督机器学习算法的完整概述，你可以我的文章:</p><div class="ny nz gp gr oa ob"><a rel="noopener follow" target="_blank" href="/overview-of-supervised-machine-learning-algorithms-a5107d036296"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">监督机器学习算法综述</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">大图如何通过连接点给我们洞察力和对ML的更好理解</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">towardsdatascience.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op ln ob"/></div></div></a></div><p id="1283" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我写关于机器学习算法的文章，请通过下面的链接关注我，并完全访问我的文章:</p><div class="ny nz gp gr oa ob"><a href="https://medium.com/@angela.shi/membership" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">通过我的推荐链接加入灵媒——安琪拉·施</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">medium.com</p></div></div><div class="ok l"><div class="oq l om on oo ok op ln ob"/></div></div></a></div></div></div>    
</body>
</html>