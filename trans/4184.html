<html>
<head>
<title>ROC and Precision-Recall Curves, Probabilities Distribution, and Density Plots in the binclass-tools Python Package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">binclass-tools Python包中的ROC和精度召回曲线、概率分布和密度图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/roc-and-pr-curves-probabilities-distribution-and-density-plots-now-in-binclass-tools-python-9351681a3803#2022-09-16">https://towardsdatascience.com/roc-and-pr-curves-probabilities-distribution-and-density-plots-now-in-binclass-tools-python-9351681a3803#2022-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="80d1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">二元分类的标准图现在可以在binclass-tools包中获得</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3d65e744cc1b15076d3c87b604a0ec0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BgGUdiDM_nZAl-ftvF2n4w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="1c3d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我最近宣布了一个Python包的发布，这个包对于二进制分类的分析非常有用。特别是，开发这一软件包的需要源于分析不平衡的二进制分类的困难。使用交互式绘图进行混淆矩阵和成本分析被证明对研究模型性能至关重要，因此创建了Python<a class="ae lu" href="https://github.com/lucazav/binclass-tools" rel="noopener ugc nofollow" target="_blank"><strong class="la iu">bin class-tools</strong></a>包，正如我在下面的文章中强调的:</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/finding-the-best-classification-threshold-for-imbalanced-classifications-with-interactive-plots-7d65828dda38"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">使用交互式图为不平衡分类寻找最佳分类阈值</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">使用binclass-tools惊人的Python包将您对二进制分类问题的分析提升到一个新的水平！</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="420e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于该Python包的目标是为最终用户提供一组用于二进制分类模型的有用工具，因此添加了基本图，以及混淆矩阵和成本图，用于测量模型性能。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="7d0e" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">ROC曲线和PR曲线</h1><p id="101b" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">通常，为了了解二元分类模型的表现，除了分析其混淆矩阵，分析师还绘制了著名的<em class="nr">接收器操作特性</em> ( <em class="nr"> ROC </em>)和<em class="nr">精确召回</em> ( <em class="nr"> PR </em>)曲线。这篇文章超出了解释上述曲线是如何构造的范围。关于如何做到这一点的更多细节可以在参考资料中找到。有趣的是，由于有了<em class="nr"> binclass-tools </em>包，现在也可以非常容易地绘制上述两条曲线。</p><p id="4265" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦训练了分类器，就可以很容易地计算包含通过将测试数据集传递给分类器的<code class="fe ns nt nu nv b"><strong class="la iu">predict_proba</strong></code> <strong class="la iu"> </strong>(产生变量<code class="fe ns nt nu nv b"><strong class="la iu">test_predicted_proba</strong></code> <strong class="la iu"> </strong>)而获得的预测分数的向量。然后，可以使用该包的<code class="fe ns nt nu nv b">curve_ROC_plot</code>功能来获得ROC曲线，传递预测分数和相应的真实标签:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="5ea5" class="oa mv it nv b gy ob oc l od oe">area_under_ROC = bc.curve_ROC_plot(<br/>    true_y = y_test,<br/>    predicted_proba = test_predicted_proba)</span></pre><p id="3871" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了绘图之外，该函数还返回ROC曲线下的面积值。结果图如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/0e6a272736f7495e6fbe18ccd58b0e86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/0*fjJRNWpZHGzvmKSM.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1 —使用binclass-tools软件包获得的ROC曲线(作者提供)</p></figure><p id="c29b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于图的交互性，您可以在工具提示中查看曲线上每个点的阈值、假阳性率(FPR)和真阳性率(TPR)的值。</p><p id="9c5b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">类似地，可以用下面的简单代码来绘制<em class="nr">精确召回曲线</em>:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="6e01" class="oa mv it nv b gy ob oc l od oe">area_under_PR = bc.curve_PR_plot(<br/>    true_y= y_test, <br/>    predicted_proba = test_predicted_proba, <br/>    beta = 1)</span></pre><p id="229a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了返回PR曲线下的面积之外，该函数还返回以下图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/584385751f09b561c880b6ac18901ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/0*-CvycF4cHnPIJMWv.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2 —使用binclass-tools软件包获得的PR曲线(作者提供)</p></figure><p id="6cd5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，图形的交互性允许您探索每个阈值的精确度和召回值。工具提示还显示了<em class="nr"> fᵦ-score </em>值(β值作为参数传递给函数)，这是一个通过精度和召回定义的指标，通常用于评估模型性能。此外，该图包含<em class="nr"> iso-fᵦ曲线</em>，为了方便起见，这些曲线标识了fᵦ值恒定的点。</p><p id="704f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在ROC和PR曲线中，绘制了基线(随机猜测目标类别的天真模型的虚拟曲线)。</p><h1 id="5d85" class="mu mv it bd mw mx oh mz na nb oi nd ne jz oj ka ng kc ok kd ni kf ol kg nk nl bi translated">概率分布和密度图</h1><p id="a9ec" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">两个目标类别的<em class="nr"> predict_proba </em>分数的分布可以使用<em class="nr">交互概率分布图</em>进行研究，该分布图使用<em class="nr"> violin图</em>来最好地表示它们。所讨论的图用于回答问题“每个预测目标类的概率分值是如何分布的？”。</p><p id="6340" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这种交互式绘图的一个非常方便的功能是允许改变分类器阈值的滑块。这允许与混淆矩阵分类(TP、TN、FP、FN)相关联的预测子集显示为每个目标类别的分数分布图上方的点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/6ee40759380dca20d62631c53d605d4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/0*wf7Lb0pqW0ijuKQp.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3 —作者使用binclass-tools软件包获得的概率分布图</p></figure><p id="1778" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将鼠标悬停在这些点上会产生一个工具提示，其中包含与该点关联的观察的行号指示器(<em class="nr"> idx </em>)、观察的真实类(<em class="nr"> class </em>)以及与观察关联的<em class="nr"> predict_proba </em>分值(<em class="nr"> pred </em>)。通过将鼠标悬停在图的侧边，我们可以获得两个violin图的四分位数信息。不同的颜色区分不同类别的混淆矩阵。</p><p id="8ad7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Violin plots允许您获得按目标类别细分的预测分布的“自上而下”视图。另一方面，如果您想要查看与“轮廓图像”相同的分布(通常显示的分布)，您可以借助新的<em class="nr">predicted _ proba _ Density _ curve _ Plot</em>函数生成<em class="nr">交互概率密度图</em>，使用高斯或KDE方法平滑直方图，使用以下代码:</p><pre class="kj kk kl km gt nw nv nx ny aw nz bi"><span id="0265" class="oa mv it nv b gy ob oc l od oe">threshold_step = 0.05<br/>curve_type = 'kde' #'kde' is the default value, 'normal' otherwise</span><span id="a6f2" class="oa mv it nv b gy on oc l od oe">bc.predicted_proba_density_curve_plot(<br/>    true_y = y_test, <br/>    predicted_proba = test_predicted_proba, <br/>    threshold_step = threshold_step,<br/>curve_type = curve_type)</span></pre><p id="c351" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您得到的输出是一个交互式绘图，其中也有阈值滑块，其步长在对上一个函数的调用中定义:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/3abe417b79ea849b5470a8f10370079b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WSMZ7h1CUXJIlLkH.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4——作者使用binclass-tools软件包获得的概率密度图</p></figure><p id="3b94" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该图中的两个子图中的每一个都被标识阈值的垂直虚线分成两个区域。该图中的两个子图中的每一个都被标识阈值的垂直虚线分成两个区域。这样就形成了四个区域，每个区域与一个混淆矩阵分类(TN，FP，FN，TP)相关联。因此，工具提示突出显示了每个单独区域的详细信息，显示了<em class="nr"> predict_proba </em>得分以及属于特定阈值的特定分类的预测数量。</p><h1 id="b11c" class="mu mv it bd mw mx oh mz na nb oi nd ne jz oj ka ng kc ok kd ni kf ol kg nk nl bi translated">结论</h1><p id="7e94" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">从版本0.3.0开始，Python <em class="nr"> binclass-tools </em>包引入了四个新的交互式情节:</p><ul class=""><li id="dd1a" class="op oq it la b lb lc le lf lh or ll os lp ot lt ou ov ow ox bi translated"><em class="nr">交互式接收机工作特性(ROC)曲线</em></li><li id="547e" class="op oq it la b lb oy le oz lh pa ll pb lp pc lt ou ov ow ox bi translated"><em class="nr">交互式精确召回曲线</em></li><li id="f021" class="op oq it la b lb oy le oz lh pa ll pb lp pc lt ou ov ow ox bi translated"><em class="nr">交互概率分布图</em></li><li id="bf11" class="op oq it la b lb oy le oz lh pa ll pb lp pc lt ou ov ow ox bi translated"><em class="nr">交互概率密度图</em></li></ul><p id="0460" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有了新版本，<em class="nr"> binclass-tools </em>包可以被认为是研究二进制分类器性能的完整工具。</p><p id="9ae1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以在Github上找到binclass-tools存储库:</p><div class="lv lw gp gr lx ly"><a href="https://github.com/lucazav/binclass-tools" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">GitHub-Luca zav/bin class-tools:bin class-tools包包含一组Python包装器和…</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">binclass-tools包包含一组Python包装器和交互式绘图，有助于分析…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="pd l mj mk ml mh mm ks ly"/></div></div></a></div><h1 id="3ca2" class="mu mv it bd mw mx oh mz na nb oi nd ne jz oj ka ng kc ok kd ni kf ol kg nk nl bi translated">信用</h1><p id="1a08" class="pw-post-body-paragraph ky kz it la b lb nm ju ld le nn jx lg lh no lj lk ll np ln lo lp nq lr ls lt im bi translated">你可以在精确召回曲线和概率分布图中找到的一些细节受到了<em class="nr"> Yohann Lereclus </em>和<em class="nr"> Pi Esposito </em>的<em class="nr"> plot-metric </em>包的启发:</p><div class="lv lw gp gr lx ly"><a href="https://github.com/yohann84L/plot_metric" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">GitHub-yohann 84 l/plot _ metric:Python包简化了ROC曲线等指标的绘制…</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">Librairie简化了ROC曲线、混淆矩阵等度量标准的绘制..使用pip:让我们加载一个简单的数据集…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="pe l mj mk ml mh mm ks ly"/></div></div></a></div><h1 id="c519" class="mu mv it bd mw mx oh mz na nb oi nd ne jz oj ka ng kc ok kd ni kf ol kg nk nl bi translated">参考</h1><ol class=""><li id="54f7" class="op oq it la b lb nm le nn lh pf ll pg lp ph lt pi ov ow ox bi translated"><a class="ae lu" rel="noopener" target="_blank" href="/understanding-auc-roc-curve-68b2303cc9c5">理解AUC-ROC曲线|作者Sarang Narkhede |走向数据科学</a></li><li id="8aa9" class="op oq it la b lb oy le oz lh pa ll pb lp pc lt pi ov ow ox bi translated"><a class="ae lu" href="https://medium.com/@douglaspsteen/precision-recall-curves-d32e5b290248" rel="noopener">精确召回曲线。有时一条曲线值一千……|道格·斯汀| Medium </a></li><li id="47e3" class="op oq it la b lb oy le oz lh pa ll pb lp pc lt pi ov ow ox bi translated"><a class="ae lu" href="https://mode.com/blog/violin-plot-examples/" rel="noopener ugc nofollow" target="_blank"> Violin Plots 101:可视化分布和概率密度|模式</a></li><li id="e12e" class="op oq it la b lb oy le oz lh pa ll pb lp pc lt pi ov ow ox bi translated"><a class="ae lu" href="https://jakevdp.github.io/PythonDataScienceHandbook/05.13-kernel-density-estimation.html" rel="noopener ugc nofollow" target="_blank">深度:内核密度估计| Python数据科学手册(jakevdp.github.io) </a></li></ol></div></div>    
</body>
</html>