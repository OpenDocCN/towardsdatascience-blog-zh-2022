<html>
<head>
<title>Cubic Splines: The Ultimate Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">三次样条:终极回归模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cubic-splines-the-ultimate-regression-model-bd51a9cf396d#2022-07-26">https://towardsdatascience.com/cubic-splines-the-ultimate-regression-model-bd51a9cf396d#2022-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f2a7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为什么三次样条是最好的回归模型。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b7d76ea25a7e8320e70e4e7655cecd2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Loc4TDp6TaqtJsR7D8V2w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">三次样条简介—作者</p></figure><h2 id="b473" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">介绍</h2><p id="c82b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">在本文中，我将介绍三次样条，并展示它们如何比高度线性回归模型更稳健。首先，我将遍历三次样条背后的数学，然后我将用Python展示这个模型，最后，我将解释龙格现象。</p><p id="5918" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">本文中使用的python库叫做<a class="ae mp" href="https://github.com/brendanartley/Regressio" rel="noopener ugc nofollow" target="_blank"> Regressio </a>。这是作者为单变量回归、插值和平滑创建的开源python库。</p><p id="d090" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi">—</p><p id="a8a3" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">首先，三次样条是一种分段插值模型，它将三次多项式拟合到分段函数中的每一段。在两个多项式相交的每一点，一阶和二阶导数相等。这有助于形成平滑的拟合线。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/19ee1f01e3c53146772b48073397ee1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0iQv88nHpsI7YOI43ezX_w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">分段函数示例—作者</p></figure><p id="816a" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">例如，在上图中，我们可以看到三次多项式是如何被分割的。在这个图像中，有3块，中间的两个蓝色点是多项式相交的地方。我们可以看到函数在这两点周围是光滑的，并且整个函数是连续的。让我们看看拟合三次样条背后的数学原理。</p><h2 id="4643" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">数学</h2><p id="6162" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated"><em class="mr">注:所有数学函数均由本文作者创建。</em></p><p id="fdcc" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">假设我们有三个数据点(2，3)、(3，2)和(4，4)。计算三次样条时，我们必须使用至少2个最多n-1个分段函数。这些分段函数中的每一个都是三次回归模型。</p><p id="1397" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">由于我们有3个数据点，我们将需要2个分段函数。我们将这些表示为f1(x)和f2(x)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/48cfbfaf770bbb28ecb875b2e8297cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e5RUT-PusDFL25C5cxu7CA.png"/></div></div></figure><p id="002e" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">在上面的每个方程中，我们有4个未知变量(a，b，c，d)。我们需要建立一个方程组来计算每个方程中的未知数，所以我们总共有8个未知数。首先，我们知道对于第一点和第二点，这些点必须落在第一个函数上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/7111b2a759344ea035731b0a78a47275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlLs1GDxjGZKToxK1WaB3g.png"/></div></div></figure><p id="671e" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">接下来，我们知道第二点和第三点一定落在第二个函数上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/d2a181c48ad552e3b92e0113b93770a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WAVGLMY7_uC72faUkTYQw.png"/></div></div></figure><p id="b991" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">我们还知道，两个函数相交时，它们的一阶导数必须相等。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/5c7be34c4dce21b024c852ac43ed1c84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IG9060YIxpyyhKP4lMGR1Q.png"/></div></div></figure><p id="33db" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">然后，我们知道相交样条的二阶导数必须相等。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/b3bdcea0338e16530252319b577f18fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XI1APy5BqYeiRt6qVye4fQ.png"/></div></div></figure><p id="100e" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">最后，我们希望每个端点的二阶导数为0。这就形成了自然的三次样条曲线。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/ab7f6c143f5e90b077faa676309e5cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d8PDOb7gUpBvmOwtT-sQWg.png"/></div></div></figure><p id="6595" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">得到的8个等式如下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/37904ccb96601559db32cd782fe2a75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRqQ_A3HuMoCU4pk0LfqAQ.png"/></div></div></figure><p id="445b" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">然后我们可以插入三个数据点(2，3)，(3，2)，(4，4)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/3498635c7f78f055dae469c41b3eac69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aL8QYHIXKS3XmSJapRdTBg.png"/></div></div></figure><p id="9b16" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">上述方程可以用矩阵形式表示，并用线性代数求解。这些方程用大小为4 x (n - 1)的矩阵表示。在这个例子中，矩阵将是8×8。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/317c59d87d866a54e6f38bbea2d41112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AJxmiYEQNzIjEwXcEgeD6w.png"/></div></div></figure><p id="a338" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">然后我们可以把这些值代入我们的两个方程，我们就有了分段函数！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/0a78efa425169b9f128e787320f453e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlzfQ55ZoRjBE3csOXDbOw.png"/></div></div></figure><p id="7ae9" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">我们理解了算法背后的数学原理，这很好，但是我们不应该每次都必须手动计算权重。在下面的单元格中，我展示了如何在Numpy中求解方程。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/12126d2298af5013526e7205de14b80b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*kl7BEcznQXgzh-zc-UyXAg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Numpy输出—按作者</p></figure><h2 id="2b75" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">回归图书馆</h2><p id="4bc2" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们可以做一个比手工输入更好的。我们可以使用一个名为<a class="ae mp" href="https://github.com/brendanartley/Regressio" rel="noopener ugc nofollow" target="_blank"> Regressio </a>的轻量级python库。该库具有用于回归、插值和平滑的单变量模型。在下面的单元格中，我们正在安装库并生成200个数据点的随机样本。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c9f6acb8ae31471ca769e72fc7852740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*u02n5QkDPUVcJUXNlFKnWw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随机数据样本—按作者</p></figure><p id="63dd" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">然后，我们可以简单地导入三次样条模型，并对数据进行拟合。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/057376c593afb08d3a16face04be747f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*KIufx_-RRSQaqhv12NEEGQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">回归三次样条模型—作者</p></figure><p id="66ec" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">这是一个非常惊人的模型，因为我们可以使用低次多项式的组合来拟合高度可变的关系。使用<a class="ae mp" href="https://github.com/brendanartley/Regressio" rel="noopener ugc nofollow" target="_blank"> Regressio </a>可以很容易地试验不同的数据集和分段大小，我鼓励你使用这个库进行试验。现在让我们看看为什么这些模型比线性回归更好。</p><h2 id="ede6" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">龙格现象</h2><p id="bcb1" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">拟合样条模型正是Carl David Tolmé Runge在1901年所做的事情，他发现三次样条等多项式插值方法的效果优于高次线性回归模型。这是由于线性回归模型中区间边缘的大振荡。这在下面的这张图片中很好地显现出来。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/6347c3b164ca5bcdb21c63a2c70e9012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*faEezTyOM2O13L90IP9s_A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者:龙格现象</p></figure><p id="2753" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">在此图像中，橙色线表示三次样条插值法，蓝色线表示线性回归模型。我们可以看到这两个模型的振荡非常不同。</p><p id="0c5c" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">对于线性回归模型，如果给我们一个位于训练数据边界之外的数据点，那么我们将得到一个异常预测。这是因为训练范围之外的模型导数的幅度非常大。这不是样条模型的情况，也是它更健壮的原因。</p><h2 id="1a9d" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">最后的想法</h2><p id="0a99" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">希望本文向您展示了三次样条如何比高度线性回归模型更稳健。在回归入门课程中，经常会跳过三次样条，但这是不应该的。在我看来，它们是线性回归模型的优秀解决方案，因为它们减轻了龙格现象。</p><p id="16f8" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">我鼓励你尝试更多三次样条的例子，并看看<a class="ae mp" href="https://github.com/brendanartley/Regressio" rel="noopener ugc nofollow" target="_blank">回归</a>库中的其他模型。作为这个包的作者，我使代码库对于那些试图理解每个模型如何工作的人来说非常可读。该库仍在生产中，并经常发生变化，请随意给它一颗星以跟踪它的变化，或者自己做出贡献！</p><p id="9aba" class="pw-post-body-paragraph lr ls iq lt b lu mk jr lw lx ml ju lz le mm mb mc li mn me mf lm mo mh mi mj ij bi translated">如果你想要这篇文章的笔记本代码，你可以在这里找到<a class="ae mp" href="https://github.com/brendanartley/Medium-Article-Code" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="f9f7" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">参考</h2><ul class=""><li id="162a" class="ne nf iq lt b lu lv lx ly le ng li nh lm ni mj nj nk nl nm bi translated">约翰·c(2022年4月11日)。<em class="mr">等间距节点插值的龙格现象</em>。约翰d .库克|应用数学咨询。检索于2022年7月26日，发自https://www.johndcook.com/blog/2017/11/18/runge-phenomena/<a class="ae mp" href="https://www.johndcook.com/blog/2017/11/18/runge-phenomena/" rel="noopener ugc nofollow" target="_blank"/></li><li id="6c9c" class="ne nf iq lt b lu nn lx no le np li nq lm nr mj nj nk nl nm bi translated"><em class="mr"> Python编程和数值方法:工程师指南和… </em>加州大学伯克利分校。(2021).检索于2022年7月26日，来自<a class="ae mp" href="https://pythonnumericalmethods.berkeley.edu/notebooks/Index.html" rel="noopener ugc nofollow" target="_blank">https://python numerical methods . Berkeley . edu/notebooks/index . html</a></li><li id="72b1" class="ne nf iq lt b lu nn lx no le np li nq lm nr mj nj nk nl nm bi translated">维基媒体基金会。(2022年6月9日)。<em class="mr">龙格现象</em>。维基百科。检索于2022年7月26日，来自<a class="ae mp" href="https://en.wikipedia.org/wiki/Runge%27s_phenomenon" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Runge%27s_phenomenon</a></li></ul></div></div>    
</body>
</html>