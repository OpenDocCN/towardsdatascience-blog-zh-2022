<html>
<head>
<title>What Is Data Leakage, and How Can It Be Avoided in Machine Learning?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是数据泄露，在机器学习中如何避免？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-is-data-leakage-and-how-can-it-be-avoided-in-machine-learning-eb435a27c3e3#2022-06-14">https://towardsdatascience.com/what-is-data-leakage-and-how-can-it-be-avoided-in-machine-learning-eb435a27c3e3#2022-06-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bef7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">虽然机器学习中使用的指标可以在测试集上显示出令人印象深刻的结果，但除非彻底理解，否则它们有时会产生误导。</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/ffcb4d8eb9d742db7b2ae3691e1ca5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AvJX3hHSDC9s5ZNF"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/@izzygerosa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">伊西·杰罗萨</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="59a0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在执行了机器学习的所有任务和工作流程之后，例如数据收集、数据可视化、数据处理、数据操纵和训练，您还需要执行一项有趣的任务，即分析您的模型并评估它们的性能。为了做到这一点，您将整个数据分为两部分，其中第一部分通常包括大多数样本，用于训练机器学习模型，而剩余的样本用于测试它们在测试数据或模型之前未见过的数据上的表现如何。</p><p id="e196" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在执行训练并等待<strong class="kz ir"> ML模型</strong>在分类和均方误差、平均绝对误差和均方根误差以及回归情况下的R平方误差的情况下，在准确度、精确度、召回率和F1分数等各种指标上产生良好的结果之后，您决定部署在测试集中表现最佳的机器学习模型。但是，应该注意，在实时部署模型之前，应该了解一个重要的机制。虽然ML模型在测试数据的情况下表现非常令人印象深刻，但如果在部署前没有理解或检查<strong class="kz ir">数据泄漏</strong>的现象，那么实时部署它有时会对该算法创造的价值有害。</p><h2 id="0f9b" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">什么是数据泄露？</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mm"><img src="../Images/b9defa8cc69294158f64605b4441bfd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FDE2rCoM2iThffwR"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">丹·卡尔森在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3015" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在开始我们将要训练一个机器学习模型的时候，隐含的是我们把数据分成3部分，即<strong class="kz ir">训练</strong>、<strong class="kz ir">交叉验证、</strong>和<strong class="kz ir">测试集</strong>。在训练模型并让算法学习最重要的参数以获得良好性能之后，我们使用交叉验证来调整这些超参数，以确保我们为这些调整的超参数获得更好的性能。最后，我们用我们的测试集来看看模型在测试集上的表现如何，并且<strong class="kz ir">监控</strong>它的表现。</p><p id="df54" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在做这些步骤之前，人们有时会对整个数据集使用<strong class="kz ir"> one hot encoding </strong>或<strong class="kz ir">特征标准化</strong>，而不是仅将其应用于训练集。通过将这些过程应用于整个数据集，存在信息泄漏，因为模型正在学习测试集具有与训练数据相关联的一些信息，因此，由于它实际上在训练集上被很好地训练的事实，它也可以在测试集上很好地执行。通过这种方式，我们往往会在测试集上获得良好的性能，这使我们相信我们做得很好，并为我们实时部署模型提供积极的指导。然而，该模型在部署时实际上可能会表现得更差。因此，<strong class="kz ir">在部署后监控</strong>ML模型的预测以处理这种现象也很重要。</p><p id="5698" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">尽管如此，当相同的模型被<strong class="kz ir">实时部署</strong>时，我们往往会看到性能下降，因为存在许多不确定性，并且没有关于整个数据平均值的<strong class="kz ir">先验信息</strong>，这是测试阶段数据泄漏的结果。因此，在我们能够实际实时部署一个<strong class="kz ir">更高质量的模型</strong>之前，在机器学习中考虑这种现象并进一步理解它是很重要的。</p><h2 id="f8a5" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">克服数据泄漏的方法</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mn"><img src="../Images/6f58e8a74611b021f8ccc4b9edcce5f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vEyE_b_LJLMJAPyp"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@kris_ricepees?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">加里·本迪格</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="d3a4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有多种方法可以防止数据泄露，我们将在接下来的几个段落中详细介绍。</p><h2 id="9e9b" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">k折叠交叉验证</h2><p id="91f0" class="pw-post-body-paragraph kx ky iq kz b la mo jr lc ld mp ju lf lg mq li lj lk mr lm ln lo ms lq lr ls ij bi translated">消除数据泄漏的最好方法之一是执行<strong class="kz ir"> k重交叉验证</strong>，其中整体数据被<strong class="kz ir">分成</strong>k个部分。分成k个部分后，我们把每个部分作为交叉验证数据，剩下的部分作为训练数据。在测量了每组k个零件的性能后，我们用<strong class="kz ir">平均值</strong>来表示模型的整体性能。</p><h2 id="a563" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">丢弃重复项</h2><p id="974a" class="pw-post-body-paragraph kx ky iq kz b la mo jr lc ld mp ju lf lg mq li lj lk mr lm ln lo ms lq lr ls ij bi translated">用于训练和交叉验证的数据也可能包含重复的值<strong class="kz ir">。这意味着我们有相同的行，这有时会影响我们对模型性能的<strong class="kz ir">夸大的</strong>描述。例如，假设我们将所有数据分为训练集和测试集。当我们有重复的行时，有可能其中一个重复的行在定型数据中，而另一个在测试集中。在这种情况下，由于该模型已经使用此行的训练数据进行了训练，并且它也存在于测试集中，因此我们在测试集中获得了提高的性能，但这实际上并不正确。因此，最好检查数据集是否包含任何重复值。</strong></p><h2 id="8da0" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">移除与输出或目标变量高度相关的特征</h2><p id="c9a2" class="pw-post-body-paragraph kx ky iq kz b la mo jr lc ld mp ju lf lg mq li lj lk mr lm ln lo ms lq lr ls ij bi translated">当我们执行机器学习分析时，通常可以假设给定特征与目标或输出标签的相关性<strong class="kz ir">越高，ML模型的预测就越好。虽然这可能是真的，并且在开发模型时应该加以考虑，但是经常会有我们不能实时获得该特性的情况。</strong></p><p id="0b3e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">考虑一个<strong class="kz ir">银行交易</strong>和一个ML模型的例子，该模型被部署来监控和检查给定客户是否将超过每天的交易限额。在这种情况下，如果我们有一个特性，如总体日常开支，它可以与输出特性直接相关。当该模型被实时部署时，如果我们不知道客户在该时刻的日常支出是多少，该模型就没有最重要的信息来决定客户是否会在特定的一天超出交易限额。在这种情况下，我们主要依靠特征<strong class="kz ir">“日常费用”</strong>来预测客户是否会超出交易限额。因此,“日常费用”这一特征很好地表明了客户是否超出了交易限额。此功能导致数据泄漏，可以通过删除它来避免。</p><h2 id="b509" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">在时间序列预测的情况下执行时间排序</h2><p id="ff3f" class="pw-post-body-paragraph kx ky iq kz b la mo jr lc ld mp ju lf lg mq li lj lk mr lm ln lo ms lq lr ls ij bi translated">当实际执行诸如<strong class="kz ir">随机分裂</strong>的方法时，我们随机置换或重新排列行，以便我们能够将数据分成训练集和测试集。在时间序列预测的情况下，由于目标变量(输出变量)对当前输入值的时间依赖性以及<strong class="kz ir">之前的</strong>时间步长，不应执行该方法。如果我们随机分割数据，ML模型已经存在未来信息，可以做出最佳预测。因此，我们将在所考虑的指标(<strong class="kz ir">，例如精度</strong>)方面获得非常好的性能。因此，在时间序列预测的情况下，我们必须小心，在时间上而不是随机地分割数据，以避免数据泄漏。</p><h2 id="d462" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lg mc md me lk mf mg mh lo mi mj mk ml bi translated">结论</h2><p id="b198" class="pw-post-body-paragraph kx ky iq kz b la mo jr lc ld mp ju lf lg mq li lj lk mr lm ln lo ms lq lr ls ij bi translated">总而言之，我们已经看到了这样的情况，即<strong class="kz ir">泄漏数据</strong>的存在可能导致我们相信模型在测试集上表现得相当好，而这远非事实。因此，可以采取措施，通过定期检查我们是采用整个数据的<strong class="kz ir">平均值</strong>还是仅采用训练数据来执行<strong class="kz ir">数据标准化</strong>来确保没有数据泄漏。对于<strong class="kz ir">一键编码</strong>也必须进行类似的程序，这样可以确保测试数据没有数据泄漏。在本文中，我们还研究了减少数据泄漏的方法。感谢您花时间阅读这篇文章。</p><p id="5eb7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">以下是您联系我或查看我作品的方式。谢了。</p><p id="6213" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> GitHub: </strong> <a class="ae kw" href="https://github.com/suhasmaddali" rel="noopener ugc nofollow" target="_blank">苏哈斯·马达利(Suhas Maddali)(github.com)</a></p><p id="3657" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> LinkedIn: </strong> <a class="ae kw" href="https://www.linkedin.com/in/suhas-maddali/" rel="noopener ugc nofollow" target="_blank"> (1)苏哈斯·马达利，东北大学，数据科学| LinkedIn </a></p><p id="a813" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">培养基:</strong> <a class="ae kw" href="https://suhas-maddali007.medium.com/" rel="noopener">苏哈斯·马达利—培养基</a></p></div></div>    
</body>
</html>