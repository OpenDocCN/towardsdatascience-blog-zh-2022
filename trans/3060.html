<html>
<head>
<title>Deploying Your Machine Learning Model Is Just the Beginning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署你的机器学习模型只是开始</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploying-your-machine-learning-model-is-just-the-beginning-b4851e665b11#2022-07-05">https://towardsdatascience.com/deploying-your-machine-learning-model-is-just-the-beginning-b4851e665b11#2022-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7d3b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何将ML模型转化为有用的商业行为:MLOps入门</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a8515c46d2ee3d88387317f93d6ebd5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F5PJCQ-JjytW6W_1"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯瑟琳·麦科马克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="eb01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> L </span>和许多刚开始从事ML的人一样，我接触到的第一个问题是泰坦尼克号数据集。这个问题的任务是在给定机票等级、客舱位置、性别、年龄等特征的情况下，“预测”一名乘客是否在泰坦尼克号灾难中幸存。虽然这是一个有趣的问题，但由于显而易见的原因，它实际上是无用的。没有人真的需要一个巨大的分类器。这个模型在现实世界中无法采取任何行动。</p><p id="53de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在现实世界中，行动很重要。一个实际上什么都不做的模型并不比完全没有模型好。然而，将ML模型转化为有用的商业行为的微妙之处通常不在ML研究的范围内。</p><p id="d233" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本帖中，我们将深入探讨:</p><ul class=""><li id="1ac7" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">你的模型在现实世界中可以采取的一系列行动，</li><li id="a91e" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">如何监控模型的工作点，</li><li id="5a6d" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">为什么在生产中既不能保证精度，也不能保证召回率(以及如何应对)，以及</li><li id="6506" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">如果循环中有人类注释者，应该考虑什么。</li></ul><p id="ac66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧。</p><h2 id="f407" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated"><strong class="ak">您的ML系统可以采取哪些措施？</strong></h2><p id="79fc" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">概括地说，您的模型可以采取3种类型的操作:</p><ul class=""><li id="49e1" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><em class="nq">软动作</em>:把某样东西搁置一边供人调查，除此之外什么都不做。让人类决定并采取最终行动。</li><li id="c4d3" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><em class="nq">硬动作</em>:自动做一些事情(例如，将电子邮件移动到垃圾邮件文件夹，或者取消信用卡交易)。</li><li id="177f" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">无操作/通过操作。什么都不做。</li></ul><p id="8a36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个特定的ML应用程序可能需要在生产中采取几个行动，这取决于ML模型分数。例如，在信用卡欺诈检测系统中，您可以自动取消具有最高模型分数的订单(硬操作)，通过具有最低模型分数的订单(无操作)，并发送两者之间的所有信息以进行人工调查(软操作)。在垃圾邮件检测系统中，您可以自动将具有最高模型分数的电子邮件移动到垃圾邮件文件夹，并将具有中间模型分数的电子邮件标记为潜在垃圾邮件，但仍将其保留在用户的主邮箱中。</p><p id="048f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，排名模型又如何呢？它为搜索、订阅和广告等应用提供了动力。这里的操作是，嗯，排序:以尽可能好的顺序显示项目。</p><div class="nr ns gp gr nt nu"><a rel="noopener follow" target="_blank" href="/learning-to-rank-a-primer-40d2ff9960af"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">学习排名:入门</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">为搜索引擎、推荐系统、社交媒体和广告提供动力的算法</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">towardsdatascience.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ks nu"/></div></div></a></div><h2 id="c703" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated"><strong class="ak">如何监控精度和召回</strong></h2><p id="4b13" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">ML课程教你精确度(正确的正面预测的比率)和回忆(我们的模型捕捉到的所有正面预测的比率)的重要性。这是一种交换，你可以牺牲一个来换取另一个。系统运行的精确度和召回率的精确组合称为<em class="nq">运行点</em>。但是我们实际上如何测量生产中的操作点呢？</p><p id="8947" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">先考虑测量精度的问题。如果你的系统采取软动作，那么精度相对容易跟踪。简单地跟踪人们对被搁置的项目所做的决定。如果你的系统采取艰难的行动，你可以建立一个<em class="nq">控制组</em>:对于体积的一小部分，让一个人来决定，而不是你的模型。那么控制组中的精度就是你的模型精度的估计。</p><p id="bc79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">衡量回忆可能要复杂得多。为了做到这一点，根据定义，你需要审核你的负面预测。这很棘手，因为典型的用例可能有不平衡的类。例如，假设您构建了一个欺诈检测系统，每天对100万个订单采取通过措施，您的召回率预计为99.9%。这意味着，平均而言，您每天至少需要审核1K个否定，才能发现一个错误否定，如果这个数字具有统计意义，就需要更多。</p><p id="5896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，简单随机抽样的召回审核是非常不切实际的。一个更好的方法是<em class="nq">重要性抽样</em>，其中我们不是随机抽样否定，而是基于他们的模型分数。关键的想法是从具有高模型分数的数据点进行更多的采样，因为这是我们预期的大部分假阴性所在。在一篇博客文章中，谷歌研究人员Arun Chaganty展示了他如何使用重要性抽样将测量召回的成本降低了大约三分之一。</p><h2 id="71ad" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated">为什么在生产中既不能保证精度，也不能保证召回率(以及如何应对)</h2><p id="b879" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">无论您如何在离线评估集上调整操作点，实际上您都无法保证您的系统在生产中达到一定的精度或召回率。这是因为数据漂移:生产中的数据分布总是与离线测试中的略有不同。数据漂移量取决于问题领域，在欺诈和滥用等敌对领域尤为严重。</p><p id="b3d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个问题怎么办？一个解决方案是添加一个缓冲区:例如，如果业务目标是95%的精度，您可以尝试在离线评估集上将您的模型调整到96–97%的操作点，以便考虑到数据漂移导致的预期模型降级。</p><p id="f9c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于ML团队来说，为商业利益相关者设定正确的期望也很重要。例如，我见过一个案例，ML团队与业务涉众的合同是保证已知(历史)数据的X%召回率。这是一份很好的合同，因为它不会试图对ML团队无法完全控制的事情做出保证:生产中的实际召回取决于数据漂移的数量，因此是不可预测的。</p><h2 id="fb12" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated">人类在厕所里的动态变化</h2><p id="a6ed" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">一旦您在循环中引入了有人类调查员参与的外围操作，您的ML应用程序的操作方面就会发生巨大的变化。</p><p id="675f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，一些术语:</p><ul class=""><li id="04b9" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><em class="nq">积压</em>是指你已经搁置的用于人工调查的项目数量。</li><li id="79f9" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><em class="nq">排队率</em>是所有被你排除在外的订单的比率。</li><li id="6c6d" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated"><em class="nq">容量</em>衡量的是在给定的时间段内你最多可以排队多少。例如，如果您雇用100名人工注释员，每天工作8小时，一个注释需要5分钟，那么您每天可以对10K项目进行排队，这就是您的系统的容量。</li></ul><p id="d7de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">积压管理的基本法则是这样的:如果您的排队率高于您的能力，您的积压就会增加。如果你的排队速度低于你的能力，你的积压就会减少。理想情况下，你会希望有一个稳定的积压工作，进来的和出去的一样多，就像一个浴缸，任何时候流入的水和流出的水一样多。</p><p id="6bda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而在实践中，由于数据漂移，队列速率可能是不可预测的。例如，在欺诈检测中，新的欺诈攻击可能会导致您的排队率激增。同样，在产品分类中，来自新供应商的产品可能会突然激增。出于这个原因，你会希望你的贴标劳动力有一定的<em class="nq">弹性</em>，即能够根据需要快速增加或减少劳动力的规模。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/5b284ef49ab90df6666cf6345ba84ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5lGXhd8tZpt2fhVQVdtKcg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">沃尔玛的产品分类渠道利用了人类专家和大众工作者。(<a class="ae ky" href="https://pages.cs.wisc.edu/~anhai/papers/chimera-vldb14.pdf" rel="noopener ugc nofollow" target="_blank">来源</a>)</p></figure><p id="682e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">沃尔玛实验室的一篇论文提出了这个问题的一个有趣的解决方案(Sun et al 2014):他们的系统使用专家人类分析师和人群工作者的组合来进行产品分类。虽然大众工作者不如人类专家准确，但他们也是极具弹性的劳动力。这种弹性尤其有助于应对“突然涌入的成百上千个项目”。此外，人类专家会定期审核群体生成的标签，以确保其质量。</p><h2 id="8b3f" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated">结论:部署您的模型仅仅是开始</h2><p id="ae3d" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">我希望至少已经明确了一件事:在部署您的ML模型之后，工作还远远没有完成。我认为这项工作才刚刚开始。总结一下:</p><ul class=""><li id="a77b" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">ML模型只有在采取行动时才有用。这些可以是硬动作(例如，取消信用卡交易)或软动作(例如，将其标记为手动检查)。</li><li id="2618" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">为了跟踪整个系统的健康状况，监控精确度和召回率是至关重要的。对于高等级不平衡的问题来说，召回审计是昂贵的，但是通过重要性抽样可以降低成本。</li><li id="2958" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">实际上，由于数据漂移，您无法保证生产中的精确度和召回率。因此，ML团队和利益相关者之间的良好契约可以保证对已知数据的一定程度的召回/精确。</li><li id="74c4" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">当人工贴标机处于循环中时，除了精确度和召回率之外，您还需要跟踪队列速率。如果队列速度激增，您将需要额外的人工贴标机来跟上额外的数量。</li></ul><p id="d4dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，尽管<a class="ae ky" href="https://medium.com/towards-data-science/is-my-model-really-better-560e729f81d2" rel="noopener">在ML研究中关注模型性能</a>，但应该清楚的是，并非所有对ML生产系统的改进都需要模型改进。例如，假设您可以通过为人类贴标机构建更好的UI来找到将调查时间减半的方法。这种改进将使我们能够节省标签成本，或者通过利用新的容量来提高整体召回率或精确度。无论哪种方式，如果不对ML模型进行任何改进，系统都会有显著的改进。</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><h2 id="99d1" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated">在你走之前…</h2><p id="bbf8" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><em class="nq">喜欢这个内容吗？在Medium上关注/订阅，这样你就不会错过我以后写的新帖。</em> <a class="ae ky" href="/@samuel.flender/membership" rel="noopener ugc nofollow" target="_blank"> <em class="nq">成为中等会员</em> </a> <em class="nq">这样你就可以无限阅读文章了。并确保在</em><a class="ae ky" href="https://www.linkedin.com/in/sflender/" rel="noopener ugc nofollow" target="_blank"><em class="nq">LinkedIn</em></a><em class="nq">和/或</em><a class="ae ky" href="https://twitter.com/samflender" rel="noopener ugc nofollow" target="_blank"><em class="nq">Twitter</em></a><em class="nq">上关注我！</em></p></div></div>    
</body>
</html>