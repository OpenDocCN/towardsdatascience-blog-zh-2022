<html>
<head>
<title>Causal Discovery: Does the Cockerel Crowing Cause the Sun to Rise?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">因果发现:小公鸡的啼叫会导致太阳升起吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/causal-discovery-does-the-cockerel-crowing-cause-the-sun-to-rise-f4308453ecfa#2022-11-01">https://towardsdatascience.com/causal-discovery-does-the-cockerel-crowing-cause-the-sun-to-rise-f4308453ecfa#2022-11-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4cce" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">10行Python代码来自动发现因果关系，你一定要看看</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3a158e9fdff52c9d6ff491cbc1a99807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8x9cboL3ovBF0RRkNL4pg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@vonshnauzer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">叶戈尔·迈兹尼克</a>在<a class="ae ky" href="https://unsplash.com/images/animals/chicken?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="57e1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="62c8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我最近的研究重点是<strong class="lt iu">因果推理</strong>，这是由我收到的越来越多的客户要求我超越机器学习预测，回答“如果?”键入问题以推动影响和结果。</p><p id="996c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最初引起我兴趣的事情之一是——“因果图是如何构建的？”。在许多网上的例子中，它们似乎是在没有解释节点和链接是如何被识别的情况下完全形成的。</p><p id="c5eb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这让我读了朱迪亚·珀尔和达纳·麦肯齐的《为什么之书》(读了好几遍！)并且表达的一种观点是，你不能仅从数据逆向工程因果图，也称为有向无环图(DAG)。</p><p id="8fca" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据可以揭示相关性，但不能揭示因果关系，那么怎么可能“发现”因果关系呢？</p><p id="645f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">注意:本文中的所有数据集都获得了公开使用的许可，有关所有来源和参考资料，请参见文章末尾的参考资料部分。</em>T9】</strong></p><p id="1bde" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">在我们深入因果发现之前，请考虑… </strong></p><p id="29ea" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/membership" rel="noopener">通过我的推荐链接</a>加入Medium(如果你使用此链接注册，我将收取一定比例的费用)。</p><p id="fea7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">每当我发表新故事时，订阅一封免费电子邮件。</p><p id="6445" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/" rel="noopener">快速浏览我之前的文章</a>。</p><p id="a160" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://relentless-originator-3199.ck.page/5f4857fd12" rel="noopener ugc nofollow" target="_blank">下载我的免费战略数据驱动决策框架</a>。</p><p id="1e71" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">访问我的数据科学网站— <a class="ae ky" href="https://www.the-data-blog.co.uk/" rel="noopener ugc nofollow" target="_blank">数据博客</a>。</p><h1 id="6dfc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">从数据中可以建立因果关系吗？</h1><p id="6fc7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">考虑以下二进制数据集中的值计数…</p><p id="b151" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">注:日出/小公鸡数据集是作者创作的合成数据，完整来源和参考详情请见文末参考资料部分。</em>T25】</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/22efb96da0f7598b8af0b9a0f627bc25.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*zphfRuHE5uL2w7utNxJ-1g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4604" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以看到，在90.25%的观察中，公鸡在太阳升起时啼叫，但仅凭数据，我们如何知道是太阳升起导致公鸡啼叫，还是公鸡啼叫导致太阳升起？</p><p id="d8f5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当太阳没升起时小公鸡啼叫的次数和当太阳升起时小公鸡保持沉默的次数实际上是相同的(50，000次对47，500次),所以通过比较相对数量的数据无法找到因果答案。</p><p id="1064" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一种方法可以是着眼于时间方面。如果太阳总是在小公鸡打鸣之前升起，这将是一个很好的因果关系指示器，但是如果我们的小公鸡是一个早起的人呢？</p><p id="5c84" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">答案是咨询领域专家。如果我们能召集一个由占星家、物理学家和家禽饲养者组成的团队，他们会得出结论:是太阳导致了公鸡啼叫，而不是相反！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/465f399eb8f882cec9d3c43f7cd30aa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4iqYakcZ_xaNzWepBYl2OA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">费德里科·雷斯皮尼在<a class="ae ky" href="https://unsplash.com/s/photos/sunrise?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="d9e0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">那么图书馆能做些什么呢？</h1><p id="fc03" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我没有被太阳升起和公鸡啼叫所吓倒，而是出发去寻找某种已经存在的东西，这种东西也许能够在数据的基础上发挥因果发现的魔力。</p><p id="282a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有一个叫“NOTEARS”的算法，确实号称可以实现因果发现，那我们就来试一试，看看它能做什么……</p><p id="986d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">注:天花数据集是作者创建的合成数据，完整来源和参考资料详情请见文末参考资料部分。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/19c0c47a089fa37a8f02a8f522be5622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*nqiqYJQqP1X8MuJtdaWdHQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6f29" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个数据集正在模拟天花疫苗接种中的因果关系。让我们对它运行NOTEARS算法，看看它能做什么…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="107c" class="nd la it mz b gy ne nf l ng nh">[('Reaction?', 'Vaccination?'),<br/> ('Smallpox?', 'Reaction?'),<br/> ('Death?', 'Reaction?'),<br/> ('Death?', 'Smallpox?')]</span></pre><p id="b72f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们设想由NOTEARS产生的结果，它看起来会是这样的…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/27a839d1c7e28b94b2c371bda70a8461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XCQnSmF4AplJ1rAZzNWHfQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="03bb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">看起来不太好，是吗？根据诺埃尔的说法，死亡会导致天花。时间相位告诉我们天花是最先出现的，所以它不可能是由死亡引起的。天花也不能引起反应(疫苗引起反应),反应当然不能引起疫苗接种。</p><p id="a019" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">利用领域专家的知识，我们可以很容易地确定疫苗接种对患者是否有反应以及他们是否继续发展疾病有因果关系，并且反应和天花都与死亡有因果联系…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/8f01671c1fe1f28f1acaa26456d1bb90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ul6zwldGJc1dh6UpG6mNDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="90ea" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，我们已经确定，即使在非常简单的因果模型中，NOTEARS因果发现算法也不会产生正确的结果。此外，我以前的一篇文章的读者指出，NOTEARS在Python 3.9中不工作，当我准备升级时，这是另一个大问题。</p><p id="47b4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想了解更多关于笔记不适合因果关系的内容，这里有一篇优秀的学术论文——https://arxiv.org/pdf/2104.05441.pdf(Marcus Kaiser)和马克西姆·希波什(Andrew Smith)。</p><p id="1386" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们放弃全自动因果发现之前，让我们来看看NOTEARS的一个替代方案，即“套索”算法</p><p id="9e6e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="ms">注:人口普查收入/毕业生收入数据集被授权公开使用，请参见文章末尾的参考资料部分，了解完整的来源和参考资料详情。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/e03c7f0409083a8d27bb75a41b4dc314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--ud2yFGOfiV3mL3-ORp1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/c10f8a2ad38bf4c98434c3b4d78773eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZ0hy-8xrNgT--Mwe1s48w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cfd6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">哦，亲爱的，套索是一场灾难！它已经预测到一切事物会引发其他事物，节点也会引发它们自己！</p><p id="9c91" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我最后的尝试是尝试GES，GIES和LINGAM算法，但这些都需要R库。我不使用R，即使我成功地进行了正确的配置，我也永远无法创建其他数据科学家可以使用的可移植代码。</p><p id="7945" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可用的因果发现库和算法不起作用，这强化了“为什么之书”中表达的观点，即因果关系不能仅从数据进行逆向工程。</p><p id="835c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个结论促使我开发了自己的方法…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/6ccbd19a546fd9056a55b81e2c135ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eZr5Gil2FG1wSX-yNe1_WQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@amandagraphc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿曼达·琼斯</a>在<a class="ae ky" href="https://unsplash.com/s/photos/card-game?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="242e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">坦白说，我还没有写因果发现算法。更确切地说，我的算法实现了一个扭曲的相关发现(没有双关语的意思！).</p><p id="a9d4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当我放弃因果发现库时，我仍然需要一种方法来可视化因果关系，作为与领域专家对话的起点。</p><p id="0223" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我推断我可以很容易地计算特征/节点之间的相关性，这至少是一个好的起点。</p><p id="f60b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我的想法如下——在因果发现模型中，我们通常识别“效果”,即我们感兴趣的数据特征(就像机器学习预测中的“目标”)。在天花的例子中，这是“死亡？”，在毕业生收入示例中是收入“大于5万”。</p><p id="2bd6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，如果任何特征和“效果”之间存在相关性，因果方向必须是从其他特征到效果，因为它在“线的末端”。</p><p id="28a3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我的下一步是开发一个递归算法，可以如下所示…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/41a1f4ad47396ef8b403c1550c052250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*T-HGE0DljrT7suTxKfiVkw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8b16" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">必须强制排除重复和双向链接。我还希望能够明确地包含或排除连接(边)以及明确地排除特征(节点)。</p><blockquote class="no np nq"><p id="dadb" class="lr ls ms lt b lu mn ju lw lx mo jx lz nr mp mc md ns mq mg mh nt mr mk ml mm im bi translated">这是我实现因果发现的10行递归Python代码</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="4179" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">行动中的解决方案</h1><p id="a3b7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了展示这个解决方案是如何工作的，我选择了一些关于酒店预订取消的数据。</p><p id="4504" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们从读取数据开始，看一看相关性…</p><p id="7e36" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">T3】</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/f96b4683f4bab3d873b42cfd8bbbca34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QSvmHolZdZooYp8ZprPnYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c049" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">发现算法的第一次运行涉及将迭代次数保持在1，因此我们只是查看与“效果”的相关性(应该是因果关系),即酒店预订是否被取消…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/3bae2944e797ede6667c7363a5048fc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4faFf51JQPn1XwWi6lit1w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cb8f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">好了，这是一个不错的开始，让我们将迭代/递归/层数增加到3，稍微调整一下相关阈值，看看我们会得到什么…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/32428a2a97d9e9ca8053a1c112d89050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-8vH-jDz7NKvu5mipLR-xA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2158" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">好的，也不太坏，但是有点“忙”，所以下一步是排除一些我们怀疑可能会引起一些噪音的节点(注意:在真实的业务案例中，我们将在这个阶段与我们的领域专家交谈)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/f49db2a68871b79ab229bae4252dfb69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tqu_9fncv6AqZKvcQoXI0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="57a6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这开始变得更好看了。请记住，我的算法确信“被取消”的链接是因果的，因为它是“结果”，因此没有什么在它之后。</p><p id="cb93" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">虽然树的其他层只是相关的，但箭头的方向是简单地根据算法发现它们的顺序添加的。</p><p id="85a0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">与领域专家合作(或者我自己在酒店预订方面的经验！)我注意到以下几点——</p><ul class=""><li id="598f" class="ny nz it lt b lu mn lx mo ma oa me ob mi oc mm od oe of og bi translated">从“不同的预订”到“提前期”的链接方向是错误的，因为较长的预订提前期增加了客房预订发生变化的可能性，而不是相反。</li><li id="c02e" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">“登记变更”和“不同的未分配”之间的相关性低于阈值，但它可能是一个重要的因果关系，因此需要包括在内。</li></ul><p id="fe70" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下一次尝试指示算法进行这些修正-</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/11cd6ff9a0f7145e5e81b4de5362632c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOQDwJuE7YRH7bhWL1-Akw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="821e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">最后一次迭代:考虑“未观察到的混杂因素”</h1><p id="580d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">“未观察到的混杂因素”是我们认为通过提供一些节点之间的联系而影响我们的因果模型的一个因素，但尚未测量，因此未包括在图表中。</p><p id="b12c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我去酒店的经历和我对酒店数据集的了解使我怀疑有一个“未观察到的混杂因素”影响着酒店数据。</p><p id="4f9e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据中有两家酒店——一家“城市”酒店和一家“度假”酒店。这让我假设这个因果模型中未被观察到的混杂因素是<strong class="lt iu">“住酒店的原因”</strong>。</p><p id="883f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我的假设是，度假者主要住在度假酒店，商务人士和城市游客主要住在城市酒店。</p><p id="92bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，我假设这两组有不同的行为，这是“未观察到的混杂因素”(未观察到，因为数据没有捕捉到“停留的原因”)。</p><p id="0d5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">NOTEARS和其他类似的算法不能解释“未观察到的混杂因素”,但是我开发的算法可以将它们考虑在内，方法是将它们明确地包括在内，如下所示…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/074011924b383aec4f90879fbbdde693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGTFDUejuhviPjN-Ak-O5g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e99b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最终迭代的结果是酒店数据中的因果关系的一个可信的、可读的和可理解的可视化，我有信心与领域专家一起探索和提炼。这些都是重点…</p><ul class=""><li id="268d" class="ny nz it lt b lu mn lx mo ma oa me ob mi oc mm od oe of og bi translated">有一个“未被观察到的混杂因素”是停留的主要原因(度假与商务/城市休息)。</li><li id="6088" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">“国家”对未被观察到的混杂因素有因果影响——那些从一些国家旅行的人更有可能是在度假。</li><li id="37f5" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">这同样适用于“全部来宾”。大型聚会更有可能是度假，单身人士更有可能是商务旅行，单身人士更有可能是城市度假。</li><li id="41d0" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">未观察到的“停留原因”对“交付周期”、“酒店类型”和“存款类型”有因果影响。</li><li id="0479" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">“交付时间”、“不同的订单”、“酒店类型”、“存款类型”和“停留原因”(U)都对“取消”有因果关系。</li></ul><h1 id="7859" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="a2ed" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">因果发现</strong>是超越相关链接发现因果链接的过程(即箭头属于相关线的哪一端？).用像NOTEARS这样的算法来实现自动化是不可能的，或者至少是极其困难的，因为答案不仅仅存在于数据中。</p><p id="7835" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，仍然迫切需要将因果关系可视化，以便领域专家可以对其进行探索，从而构建因果图(也称为有向无环图或DAG)。</p><p id="cb72" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这篇文章中，提出了一种基于增强关联发现的算法，该算法仅使用了10行Python代码，领域专家可以使用该代码来重复地改进敏感度(阈值)以及校正、添加或移除链接(箭头)并排除不相关的节点。</p><p id="b591" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在未来的文章中，这些因果图将用于建立一个成熟的因果机器学习模型，可以回答复杂的“如果会怎样？”键入客户和企业领导的问题。</p><p id="7c06" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你喜欢这篇文章，请考虑…</p><p id="e11b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/membership" rel="noopener">通过我的推荐链接</a>加入媒体(如果你使用这个链接注册，我将收取一定比例的费用)。</p><div class="oo op gp gr oq or"><a href="https://grahamharrison-86487.medium.com/membership" rel="noopener follow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">通过我的推荐链接加入媒体-格雷厄姆哈里森</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">阅读格雷厄姆·哈里森(以及媒体上成千上万的其他作家)的每一个故事。增强您的数据知识…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">grahamharrison-86487.medium.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ks or"/></div></div></a></div><p id="abfc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/subscribe" rel="noopener">每当我发表一个新故事时，订阅一封免费电子邮件</a>。</p><p id="5d31" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/" rel="noopener">快速浏览我以前的文章</a>。</p><p id="e9b2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><a class="ae ky" href="https://relentless-originator-3199.ck.page/5f4857fd12" rel="noopener ugc nofollow" target="_blank">下载我的免费战略数据驱动决策框架</a>。</p><p id="3b74" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">访问我的数据科学网站— <a class="ae ky" href="https://www.the-data-blog.co.uk/" rel="noopener ugc nofollow" target="_blank">数据博客</a>。</p><h1 id="ca07" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">参考</h1><h2 id="6e31" class="nd la it bd lb pg ph dn lf pi pj dp lj ma pk pl ll me pm pn ln mi po pp lp pq bi translated">日出/公鸡打鸣数据</h2><ul class=""><li id="a2f8" class="ny nz it lt b lu lv lx ly ma pr me ps mi pt mm od oe of og bi translated">来源:作者创建的综合数据</li><li id="d178" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">参考:<a class="ae ky" rel="noopener" target="_blank" href="/how-to-generate-synthetic-data-for-any-causal-inference-project-in-less-than-10-lines-of-code-158688a89349">https://towardsdatascience . com/how-to-generate-synthetic-data-for-any-causal-inference-project-in-less-10-line of-code-158688 a 89349</a></li><li id="f614" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">执照:<a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by/4.0/</a></li></ul><h2 id="d4e4" class="nd la it bd lb pg ph dn lf pi pj dp lj ma pk pl ll me pm pn ln mi po pp lp pq bi translated">天花数据</h2><ul class=""><li id="b228" class="ny nz it lt b lu lv lx ly ma pr me ps mi pt mm od oe of og bi translated">来源:作者创建的综合数据</li><li id="b1e7" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">参考:<a class="ae ky" rel="noopener" target="_blank" href="/how-to-generate-synthetic-data-for-any-causal-inference-project-in-less-than-10-lines-of-code-158688a89349">https://towardsdatascience . com/how-to-generate-synthetic-data-for-any-causal-inference-project-in-less-10-line of-code-158688 a 89349</a></li><li id="ef49" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">执照:<a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by/4.0/</a></li></ul><h2 id="5ca6" class="nd la it bd lb pg ph dn lf pi pj dp lj ma pk pl ll me pm pn ln mi po pp lp pq bi translated">毕业生收入/人口普查收入数据</h2><ul class=""><li id="6a14" class="ny nz it lt b lu lv lx ly ma pr me ps mi pt mm od oe of og bi translated">资料来源:https://archive.ics.uci.edu/ml/datasets/census+income</li><li id="f97d" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">参考资料:Dua，d .和Graff，C. (2019)。http://archive.ics.uci.edu/ml的UCI机器学习库。加州欧文:加州大学信息与计算机科学学院。</li><li id="166c" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">许可:公共使用-<a class="ae ky" href="https://archive.ics.uci.edu/ml/citation_policy.html" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/citation_policy.html</a></li></ul><h2 id="71df" class="nd la it bd lb pg ph dn lf pi pj dp lj ma pk pl ll me pm pn ln mi po pp lp pq bi translated">酒店预订数据</h2><ul class=""><li id="2569" class="ny nz it lt b lu lv lx ly ma pr me ps mi pt mm od oe of og bi translated">来源:<a class="ae ky" href="https://www.sciencedirect.com/science/article/pii/S2352340918315191" rel="noopener ugc nofollow" target="_blank">https://www . science direct . com/science/article/pii/s 2352340918315191</a></li><li id="f22e" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">参考:安东尼奥，阿尔梅达和努内斯，2019</li><li id="2b26" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">许可:在知识共享许可下的开放获取(<a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by/4.0/</a></li></ul></div></div>    
</body>
</html>