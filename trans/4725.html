<html>
<head>
<title>Multivariate matching engine on Textual, Categorical and Numerical data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文本、分类和数字数据的多元匹配引擎</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/multivariable-matching-engine-on-textual-categorical-and-numerical-data-d90b0dca7f4c#2022-10-20">https://towardsdatascience.com/multivariable-matching-engine-on-textual-categorical-and-numerical-data-d90b0dca7f4c#2022-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5862fe2fdb96fb89f9c921023d8f4396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VcMYlF_bYg6iJFzDpnNZjQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://www.pexels.com/fr-fr/photo/gros-plan-de-la-photographie-d-un-fruit-cerise-rouge-162689/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄</p></figure><div class=""/><div class=""><h2 id="2902" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">发现嵌入和相似性的力量</h2></div><p id="06e7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如今，许多公司不得不在其活动中处理类似的案件。他们中的少数人利用旧的和以前的工作，而绝大多数人从头再来。</p><p id="0b14" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将发现如何利用人工智能算法来构建一个匹配引擎，该引擎可以使用文本、分类和数字变量。</p><p id="3477" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为简单起见，我们将考虑一个案例由以下数据描述:</p><ul class=""><li id="cd6f" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><em class="md"> Num </em>:数值型变量</li><li id="2014" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><em class="md">类别</em>:分类变量(一个单词)</li><li id="1077" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><em class="md">已发送</em>:文本变量(1个句子-需要嵌入)</li><li id="0848" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><em class="md">段落</em>:文本变量(段落-需要嵌入)</li></ul><p id="cc9d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您的数据库不遵循相同的结构，您可以应用预处理管道来实现相同的场景。</p><h1 id="e21d" class="mj mk jj bd ml mm mn mo mp mq mr ms mt kp mu kq mv ks mw kt mx kv my kw mz na bi translated">目录</h1><p id="ca81" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">摘要如下:</p><h1 id="2eb8" class="mj mk jj bd ml mm mn mo mp mq mr ms mt kp mu kq mv ks mw kt mx kv my kw mz na bi translated">1-嵌入<br/> 2-相似性<br/> 3-匹配引擎</h1></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="5b6a" class="mj mk jj bd ml mm nn mo mp mq no ms mt kp np kq mv ks nq kt mx kv nr kw mz na bi translated"><strong class="ak">嵌入</strong></h1><h2 id="9174" class="ns mk jj bd ml nt nu dn mp nv nw dp mt lh nx ny mv ll nz oa mx lp ob oc mz od bi translated">单词嵌入</h2><p id="04ef" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">单词嵌入是在大小为N的向量空间中表示单词的艺术，其中语义相似的单词，从数学上来说，彼此接近。<br/>在处理文本数据时，这是一个重要的步骤，因为ML算法主要处理数值。</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/b6692e618ed6e1f642a98d5e9dee326b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inGWL5R3HqjH0Pz50q4-LQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="f53c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">单词嵌入算法有<a class="ae jg" href="https://ar5iv.labs.arxiv.org/html/1402.3722" rel="noopener ugc nofollow" target="_blank"> Word2Vec </a>、<a class="ae jg" href="https://ar5iv.labs.arxiv.org/html/1607.04606" rel="noopener ugc nofollow" target="_blank"> FastText </a>、<a class="ae jg" href="https://ar5iv.labs.arxiv.org/html/1810.04805" rel="noopener ugc nofollow" target="_blank"> BERT </a>、…，在不同语言中有几种改编。</p><h2 id="26ce" class="ns mk jj bd ml nt nu dn mp nv nw dp mt lh nx ny mv ll nz oa mx lp ob oc mz od bi translated">句子嵌入</h2><p id="c66f" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">一个句子是一系列单词。也就是说，我们可以按照以下步骤聚合单词嵌入来生成句子嵌入:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oj"><img src="../Images/92891226956c44de1c19ca59d85f037c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dLxcWx7e-mT1aRnNn2VUg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="486f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/d01032a9d560f2a4da87141ab8d8a57c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1sFCcewRiQLlboxiZ4k4dw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><ul class=""><li id="2bb7" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">NB1:在清理阶段，我们可以只保留要嵌入的关键字</li><li id="b309" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">NB2:聚合公式可以平衡长句和短句</li><li id="13ba" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">NB3:句子嵌入的大小与单词嵌入的大小相同</li></ul><h2 id="e4d5" class="ns mk jj bd ml nt nu dn mp nv nw dp mt lh nx ny mv ll nz oa mx lp ob oc mz od bi translated">段落嵌入</h2><p id="a58b" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">鉴于段落是一系列句子的事实，我们可以使用与上面相同的方法:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ol"><img src="../Images/fd91ef2cf39cf2e7f664b335ead6e484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N360mLXy8qn8FCAlVeisHw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><ul class=""><li id="5b66" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">NB1:在普通语言中，句子通常用字符串“.”来分隔，但在某些情况下可能需要定制。</li><li id="0c37" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">NB2:段落嵌入的大小是(N，k ),其中N是句子嵌入的大小，k是段落中句子的数量。</li></ul></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="d2eb" class="mj mk jj bd ml mm nn mo mp mq no ms mt kp np kq mv ks nq kt mx kv nr kw mz na bi translated">类似</h1><h2 id="b827" class="ns mk jj bd ml nt nu dn mp nv nw dp mt lh nx ny mv ll nz oa mx lp ob oc mz od bi translated">数字相似性</h2><p id="05df" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">让我们考虑两个数值x、y和NumSim，两者之间的距离定义如下:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi om"><img src="../Images/70fda2a89349eec6d497beba99d51ec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipotTPIyvrCYrNzwDbHKlA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="2527" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果:</p><ul class=""><li id="9edb" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">x=y =&gt; NumSim(x，y)=1</li><li id="0097" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">x&gt;&gt;y =&gt; NumSim(x，y) <strong class="la jk"> ≈1/(|x|+1)≈0 </strong></li></ul><h2 id="5f5c" class="ns mk jj bd ml nt nu dn mp nv nw dp mt lh nx ny mv ll nz oa mx lp ob oc mz od bi translated">词汇相似性</h2><p id="a250" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">有许多方法可以计算两个单词之间的相似度，下面我们列举两种最著名的方法:</p><ul class=""><li id="c4c3" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><em class="md">近似字符串匹配</em>(基于字符):Levenshtein的距离，…</li><li id="5ef5" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><em class="md">语义串匹配</em>(基于嵌入):余弦相似度、欧几里德距离、…</li></ul><p id="996a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将主要关注余弦相似度，它只不过是两个比较单词的两个嵌入向量之间的角度的余弦:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/4cc77a1dbf5f0c1e70918d98bd2acb7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDs-Heo0TAWh0KS_NGPIoQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="e6d4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/b9c0584aa38604a6344799e2602d3a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZyenQuXk8TU-L8gM-OMuqw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><h2 id="fec7" class="ns mk jj bd ml nt nu dn mp nv nw dp mt lh nx ny mv ll nz oa mx lp ob oc mz od bi translated">句子相似性</h2><p id="f315" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">我们遵循相同的方法，这次使用上面定义的句子嵌入算法:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/9b371b33dfed82c9345298ee86a321db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C32BWvBTMoh2o0BPMorqLg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="0f26" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/4fa9bd35e534c9ddbd8ef964c5904c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FlrQdlMwoO1xpUHXQRhusg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><h2 id="2e53" class="ns mk jj bd ml nt nu dn mp nv nw dp mt lh nx ny mv ll nz oa mx lp ob oc mz od bi translated">相似之处</h2><p id="a251" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">这一段的相似之处稍微复杂一些，因为它们的嵌入被认为是2D矩阵而不是向量。为了比较这两个段落，我们计算每个对等句子的SentSim，并生成2D相似度矩阵，然后将该矩阵汇总为一个分数:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/5a6daf601109eaf67597effa7247ad8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xK2mIf2JI3pKne92aOsH5Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="a6ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/be52bc8fb8676e47c04e7f01c37419f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ma7JGzr_n0v_ZCYAjzrINQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="0f64" class="mj mk jj bd ml mm nn mo mp mq no ms mt kp np kq mv ks nq kt mx kv nr kw mz na bi translated"><strong class="ak">匹配引擎</strong></h1><p id="ee29" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">如前所述，让我们考虑一个业务案例，其中我们必须处理许多案例。每种情况都用四个变量描述:<em class="md"> Num、Categ、Sent和Parag </em>(见简介)。<br/>我们可以利用历史数据将每个新案例与整个数据库进行比较，并使用下图选择最相似的案例:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/a236958a3697e28a39ca7c9ca31542c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SfRkO5wgBlY0gzc8bmVk1g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="8a7d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中:</p><figure class="of og oh oi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/b0b76a83a6b461a34482e40e8d929455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xF5-bCb0i2r6aKpqOJ5nfA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="3733" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们对从1到L(数据库的大小)的所有情况执行这些操作，并输出最高的匹配分数。</p><ul class=""><li id="8244" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">NB1:如果<em class="md"> Categ </em>变量具有唯一且稳定的模态，我们可以用简单的过滤代替匹配</li><li id="e915" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">NB2:如果每种类型有不止一个变量，可以使用正确的相似性方法将它们堆叠到同一个引擎中</li><li id="2dfb" class="lu lv jj la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">NB3:每个变量的权重根据其业务优先级和重要性进行选择</li></ul></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="c1b2" class="mj mk jj bd ml mm nn mo mp mq no ms mt kp np kq mv ks nq kt mx kv nr kw mz na bi translated">结论</h1><p id="517e" class="pw-post-body-paragraph ky kz jj la b lb nb kk ld le nc kn lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">匹配引擎在科技界非常流行和使用。它们为企业提供了更快的处理工具，节省了时间和资金。<br/>在本文中，我们关注的是特定类型的输入(数字和文本)，但是您也可以想象使用一个图像作为我们案例的额外描述。这需要使用CNN技术，例如<a class="ae jg" rel="noopener" target="_blank" href="/object-detection-face-recognition-algorithms-146fec385205">暹罗网络</a>，其生成与余弦相似性一起使用的图像嵌入，以生成额外的匹配分数。</p></div></div>    
</body>
</html>