<html>
<head>
<title>Creating True Multi-Page Streamlit Apps — The New Way (2022)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建真正的多页面简化应用——新方式(2022年)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-true-multi-page-streamlit-apps-the-new-way-2022-b859b3ea2a15#2022-07-04">https://towardsdatascience.com/creating-true-multi-page-streamlit-apps-the-new-way-2022-b859b3ea2a15#2022-07-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c099" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">制作多页简化应用程序的最新方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4cec10003076e27587968b7dbc40ad39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qKvlmwj7PE6UiPGv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尼克·莫里森在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7bfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>是一个基于python的开源框架，用于开发和部署交互式<a class="ae ky" href="https://en.wikipedia.org/wiki/Data_science" rel="noopener ugc nofollow" target="_blank">数据科学</a>仪表盘和<a class="ae ky" href="https://www.ibm.com/cloud/learn/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>模型。</p><p id="1ed9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我之前的Streamlit文章中，我讨论了如何开始构建一个简单的地震数据浏览器。这是一个简单的单页web应用程序，允许您查看数据并生成一些图表。</p><p id="3c21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建单个页面的Streamlit应用程序相对简单，然而，直到最近，构建具有多个页面的Streamlit应用程序还需要许多变通方法。<a class="ae ky" href="https://blog.streamlit.io/introducing-multipage-apps/" rel="noopener ugc nofollow" target="_blank">随着真正的多页简化应用程序的发布，这种情况有所改变</a>。</p><p id="6459" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将介绍如何使用新技术创建一个多页面的Streamlit应用程序。我还发布了一个YouTube视频，你可以在下面看到。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><h2 id="47d1" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">教程的数据源</h2><p id="37bd" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">本教程使用的数据可以在CC0: Public Domain下使用，并且来自Kaggle。这是一个数据集，包含1965年至2016年期间世界上震级为5.5或更高的最重大地震的数据。您可以通过以下链接查看原始数据。</p><p id="e75d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.kaggle.com/datasets/usgs/earthquake-database?select=database.csv" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/datasets/usgs/earthquake-database?select=database.csv </a></p><h1 id="aa12" class="mv ly it bd lz mw mx my mc mz na nb mf jz nc ka mi kc nd kd ml kf ne kg mo nf bi translated">为什么要在一个Streamlit应用中使用多个页面？</h1><p id="7b29" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">当使用<a class="ae ky" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>构建基于web的应用程序时，很容易连续不断地向我们的应用程序添加部分，一个接一个。然而，这最终会生成一个页面，这个页面可能会很快变得很长。</p><p id="2aa8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解决这个问题的一个方法是将信息分成多页。这改善了应用程序的外观和感觉，也改善了用户体验。</p><h2 id="77e4" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">创建多页面简化应用程序的老方法</h2><p id="45a8" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">直到最近<a class="ae ky" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>还没有一个官方的方法来给一个应用添加多个页面。作为变通办法，我们不得不<a class="ae ky" href="https://medium.com/@u.praneel.nihar/building-multi-page-web-app-using-streamlit-7a40d55fa5b4" rel="noopener">使用单选按钮或下拉列表在我们的<a class="ae ky" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>应用程序的不同页面</a>或部分之间切换。虽然这是一个很好的方法，但看起来确实有点“粗糙”。</p><p id="5fa7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下示例说明了使用单选按钮更改应用程序中主要内容的过程。本质上，当一个按钮被选中时，旧的内容被隐藏，新的内容被添加。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/0b7fcf6ca39ec53bbdcc80325e651fa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*G_Uh2t7ytjzQ_T9DwGqaLg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用单选按钮的多页Streamlit应用程序示例。图片由作者提供。</p></figure><p id="faaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的例子是使用下面的代码生成的。所有代码都包含在一个Python文件中，然后可以通过调用来运行该文件。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="ff23" class="lx ly it ni b gy nm nn l no np">streamlit run app.py</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq lw l"/></div></figure><h1 id="30dc" class="mv ly it bd lz mw mx my mc mz na nb mf jz nc ka mi kc nd kd ml kf ne kg mo nf bi translated">创建多页简化应用程序的新方法</h1><p id="f7be" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">【2022年6月2日，Streamlit宣布真正的多页面应用功能的到来。他们没有使用选择框，而是对库进行了改造，使其能够本地处理多个页面。</p><p id="9cdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个很大的进步，尤其是如果你是一个Streamlit的重度用户。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/3a8cf43fb94ae65de21c2abaebb6cff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fPwaVDXZw6S_vpP3zutmXQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Streamlit宣布真正的多页面功能的到来。</p></figure><h2 id="e000" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">创建多页Streamlit应用程序—新方式</h2><p id="34c6" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">以下方法适用于新应用程序和现有应用程序。</p><p id="d35a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用新功能，您需要使用以下方式更新您的Streamlit版本:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a72d" class="lx ly it ni b gy nm nn l no np">pip install --upgrade streamlit</span></pre><p id="470c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的主Streamlit应用程序目录中，创建一个名为pages的新子目录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/13a2e5f970f02e9d040ef7b64f674112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xCvV-Jz_EElUegGsESEDSg.png"/></div></div></figure><p id="50a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在该文件夹中，开始为您想要添加到应用程序的每个页面添加新的<code class="fe nt nu nv ni b">.py</code>文件。Streamlit将自动检测这些文件，并开始将它们作为页面添加到应用程序中。</p><p id="68ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">页面会自动按字母顺序排序。如果你想控制页面的顺序，你可以在文件的开头添加一个数字。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/edb73ab95fa02e13f39b44cba13cb7a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*alHhfjEBjefClNsvnK_8-g.png"/></div></div></figure><p id="b41b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的主要Streamlit应用程序python文件中有现有的函数/代码，您可以将它们转移到新文件中，并根据需要进行拆分。此外，如果你有代码创建单选按钮，这可以从你的主应用程序中删除。</p><p id="9c2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你的页面已经创建好了，在你的应用文件夹中打开你的终端/命令提示符，输入如下。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="b0b8" class="lx ly it ni b gy nm nn l no np">streamlit run streamlit_app.py</span></pre><p id="98b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，您需要将<code class="fe nt nu nv ni b">streamlit_app.py</code>部分更改为您的主应用程序文件的名称。</p><p id="7116" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦您重新启动并运行了Streamlit，您将会在应用程序的左侧看到新菜单。</p><p id="5114" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，您的主应用程序页面将位于菜单顶部。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/27bc95b441b84777d7091cee650a10c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*aqVasuX9ClvKMqB18Ajvug.gif"/></div></div></figure><p id="c4ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是新的<code class="fe nt nu nv ni b">streamlit_app.py</code>文件中的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq lw l"/></div></figure><p id="d1ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是其中一页的代码示例。请注意，您确实需要为每个子页导入streamlit。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq lw l"/></div></figure><h1 id="86ee" class="mv ly it bd lz mw mx my mc mz na nb mf jz nc ka mi kc nd kd ml kf ne kg mo nf bi translated">添加页面图标</h1><p id="9629" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">当您向Streamlit应用程序添加新页面时，页面的图标将全部相同。然而，你可以使用表情图标在菜单和页面标题中添加一个简单的图标，就像这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/e93e84714049ceb03a45624834c4bef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2cbu2fi7ADnxwIw-onDeeA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用文件名中的表情符号简化多页应用程序，以生成菜单图标。图片由作者提供。</p></figure><p id="a681" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你回到你的应用程序时，每个菜单项现在都有相同的图标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/bc24bff37468f89fc2590948ecc8edf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FXe4vK7EPKZC-d4HalfalQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用页面图标简化多页面应用程序。图片由作者提供。</p></figure><p id="c473" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不确定在python文件中给文件名添加表情符号有多稳定，但是时间会证明一切。</p><h1 id="a999" class="mv ly it bd lz mw mx my mc mz na nb mf jz nc ka mi kc nd kd ml kf ne kg mo nf bi translated">通过会话状态在Streamlit应用程序页面之间传递数据</h1><p id="2e2c" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">需要注意的最后一点是，上面创建的每个页面都是独立运行的。换句话说，如果你在一个页面上上传了一个文件，它在另一个页面上是不可用的。</p><p id="d5c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理这个问题的一种方法是使用会话状态。</p><p id="fd73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果您想使用Pandas数据帧，那么在文件上传器所在的<code class="fe nt nu nv ni b">.py</code>中添加如下代码:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="7b16" class="lx ly it ni b gy nm nn l no np">st.session_state['df'] = df</span></pre><p id="8218" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后在其他<code class="fe nt nu nv ni b">.py</code>文件中，调用该会话状态来检索数据帧，如下所示:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="6aaf" class="lx ly it ni b gy nm nn l no np">df = st.session_state['df']</span></pre><p id="6d54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您应该能够在任何页面中处理这些数据，而不必重新加载这些数据。</p><h1 id="5aec" class="mv ly it bd lz mw mx my mc mz na nb mf jz nc ka mi kc nd kd ml kf ne kg mo nf bi translated">摘要</h1><p id="201d" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">为<a class="ae ky" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>添加一个真正的多页面功能是期待已久的改进，它确实改善了用户体验。但是，当处理多个页面时，您需要将希望在它们之间使用的数据保存到会话状态中。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="0a0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oh">感谢阅读。在你走之前，你一定要订阅我的内容，把我的文章放到你的收件箱里。</em> <a class="ae ky" href="https://andymcdonaldgeo.medium.com/subscribe" rel="noopener"> <strong class="lb iu"> <em class="oh">你可以在这里做！</em> </strong> </a></p><p id="6ba4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，通过注册会员，你可以获得完整的媒介体验，并支持我自己和成千上万的其他作家。它每个月只花你5美元，你可以完全接触到所有令人惊叹的媒体文章，也有机会用你的写作赚钱。如果你使用 <a class="ae ky" href="https://andymcdonaldgeo.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="oh">我的链接</em> </strong> </a> <strong class="lb iu"> <em class="oh">，</em> </strong> <em class="oh">报名，你会直接用你的一部分费用支持我，不会多花你多少钱。如果你这样做了，非常感谢你的支持！</em></p></div></div>    
</body>
</html>