<html>
<head>
<title>Open-Source ML Project With DagsHub: Improve Pet Adoption With Machine Learning, #1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DagsHub 的开源 ML 项目:通过机器学习提高宠物认养率，第一</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/open-source-ml-project-with-dagshub-improve-pet-adoption-with-machine-learning-1-e9403f8f7711#2022-03-08">https://towardsdatascience.com/open-source-ml-project-with-dagshub-improve-pet-adoption-with-machine-learning-1-e9403f8f7711#2022-03-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0b00" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">构建一个预测猫狗可爱程度的应用程序</h2></div><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/24d95f658519f575a2cf3cc0911346b1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*WXWvbPmOonDHrk54rs3NaQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated"><strong class="bd ku">照片由</strong> <a class="ae kv" href="https://unsplash.com/@miaanderson?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ku">米娅·安德森</strong> </a> <strong class="bd ku">上</strong> <a class="ae kv" href="https://unsplash.com/s/photos/cute-puppy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ku">下</strong> </a></p></figure><h2 id="2288" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">项目介绍</h2><p id="401f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">令人难以置信的是，机器学习已经改变了生活的许多方面。它的应用远远超出了商业领域，并被用于许多公益事业，如保护环境、公共卫生、安全和动物福利。</p><p id="8cb5" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">一个例子是最近由马来西亚动物福利平台主办的 Kaggle 比赛。在这项挑战中，参与者被要求处理数千张带标签的宠物图片，并为每张图片生成可爱度评分。</p><p id="6c95" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">这个可爱度，或者在比赛中被称为可爱度的分数，被用来匹配潜在家庭的宠物档案，以增加他们被收养的机会。</p><p id="e443" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">尽管挑战已经结束，我们仍将通过一系列文章尝试构建一个稳健的预测模型来完成这项任务。最后，我们将使用我们的解决方案创建一个 web 应用程序，这样任何人都可以给他们的宠物拍照并获得可爱度评分。</p><p id="2a88" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在本文中，您将探索:</p><ol class=""><li id="dc65" class="mr ms it lu b lv ml ly mm lf mt lj mu ln mv mk mw mx my mz bi translated">Petfinder Pawpularity 评分和数据介绍。</li><li id="a9bd" class="mr ms it lu b lv na ly nb lf nc lj nd ln ne mk mw mx my mz bi translated">解决手头问题的方法</li><li id="bdea" class="mr ms it lu b lv na ly nb lf nc lj nd ln ne mk mw mx my mz bi translated">项目的所有开源工具列表以及它们解决了哪些挑战</li><li id="af44" class="mr ms it lu b lv na ly nb lf nc lj nd ln ne mk mw mx my mz bi translated">Petfinder 数据集的元数据和图像上的 EDA</li></ol><p id="6fd0" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">您可以在 DagsHub 上开始<a class="ae kv" href="https://dagshub.com/BexTuychiev/pet_pawpularity" rel="noopener ugc nofollow" target="_blank">这个存储库</a>来跟随整篇文章。</p><div class="nf ng gp gr nh ni"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">通过我的推荐链接加入 Medium-BEXGBoost</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">获得独家访问我的所有⚡premium⚡内容和所有媒体没有限制。支持我的工作，给我买一个…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw ko ni"/></div></div></a></div><p id="53c9" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">获得由强大的 AI-Alpha 信号选择和总结的最佳和最新的 ML 和 AI 论文:</p><div class="nf ng gp gr nh ni"><a href="https://alphasignal.ai/?referrer=Bex" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">阿尔法信号|机器学习的极品。艾总结的。</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">留在循环中，不用花无数时间浏览下一个突破；我们的算法识别…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">alphasignal.ai</p></div></div><div class="nr l"><div class="nx l nt nu nv nr nw ko ni"/></div></div></a></div></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="db41" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">解决问题的方法</h2><p id="7a01" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">如果你已经在考虑启动 Jupyter 实验室会议，请停止。在这个项目中，我们将尽可能远离笔记本电脑，并使用市场上最好的开源工具来使这个过程完全可重复。</p><p id="d2dd" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">首先，我们需要解决大文件的问题。Git/GitHub 不会削减它，因为他们在这个任务上是垃圾。我们需要更强大、更灵活的东西，比如 DVC。</p><p id="f4d2" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated"><a class="ae kv" href="https://dvc.org/" rel="noopener ugc nofollow" target="_blank">数据版本控制(DVC) </a>是追踪大文件变化的最好的开源工具之一。正如 DVC 文档中所说，它是“数据的 Git”。</p><p id="d8c4" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">就像你在 GitHub 上托管代码一样，DVC 需要远程存储来存储你的数据和文件。你可以选择像 AWS、Azure 或 GCP 这样的云解决方案，但是设置会很麻烦，而且它们也不是免费的。</p><p id="2a77" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">为了解决这个问题，我们将使用<a class="ae kv" href="https://dagshub.com/" rel="noopener ugc nofollow" target="_blank"> DagsHub </a>，你可以把它想象成“数据科学家的 GitHub”。这是一个供数据专业人员托管和版本化他们的数据、模型、实验和代码的平台。</p><p id="9765" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">一旦您创建了您的帐户，DagsHub 将为您提供 10GB 的免费存储空间，仅适用于 DVC。</p><p id="2de7" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">DagsHub 会自动生成一个远程存储链接以及为您创建的每个存储库设置该链接的命令。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi of"><img src="../Images/142f79c9192c9631cd920ad7e9c34a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*c69JFH1e9WM6Otysz7tjDg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">存储库页面上的 DVC 指令示例。按作者。</p></figure><p id="aff9" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">所有添加到 DVC 的文件都将在您的 DagsHub repo 页面上进行标记:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="oh oi di oj bf ok"><div class="gh gi og"><img src="../Images/7d67dc066588cffb237fd08efe27a026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DHlIxkZyxSjn-S8I8sMSaQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者截图</p></figure><p id="4df3" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">为了保持实验的可重复性，我们将使用另一个开源包— <a class="ae kv" href="https://mlflow.org/" rel="noopener ugc nofollow" target="_blank"> MLFlow </a>。</p><p id="36f1" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">使用 MLFlow，您可以记录实验的每个细节——用于跟踪性能的指标、模型名称、其超参数、相应的分数等等。</p><p id="fbd7" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">像 DVC 一样，MLFlow 需要一个服务器来保存你实验的细节。DagsHub 也涵盖了这一点:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/f6572ce3c01cc53f49f62162538ce610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*ELsFSV8CYEke8ziLAP03hg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者截图</p></figure><p id="80be" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">设置 MLFlow remote 后，DagsHub 将在“实验”选项卡下记录您的每个实验:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="oh oi di oj bf ok"><div class="gh gi om"><img src="../Images/6ff784a6e3965d17af68c4ca9f3a97f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UFhMCGCLHT_jMwnqqMQm0A.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">DagsHub 上一个示例实验页面的屏幕截图。按作者。</p></figure><p id="7eef" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">您可以选择几个成功的实验，并通过按“比较”按钮开始比较它们，这将生成漂亮的表格和图表，以直观地探索这些实验。</p><p id="cdce" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">最后，一旦我们有了问题的现成解决方案，我们需要使用 web 应用程序来公开它，以便每个人都可以使用友好的 UI 来尝试它，而不是克隆我们的存储库。</p><p id="f6fd" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">传统上，这是使用像 Flask 这样的 web 框架来完成的，但是我们将使用现在所有酷家伙都在使用的东西——Streamlit。</p><p id="ee2c" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">一旦我们完成这个项目，我们将在 Streamlit Cloud 上托管一个应用程序，它可以接受其他人的宠物的图像，并预测它们的可爱程度。</p><p id="2a66" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">目前，Streamlit cloud 只接受 GitHub 存储库，这意味着我们的应用程序代码必须托管在那里。但这不就意味着我们的项目会被分割 GitHub 上的代码和我们 DagsHub 上的数据、模型、度量吗？</p><p id="e5de" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">幸运的是，对于这种情况，可以用 DagsHub 连接 GitHub:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi on"><img src="../Images/1acf41b600d93e2d24d8e7f82e8da6d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*ivN_1iqJgt6G5kLny23veQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者截图</p></figure><p id="1741" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">每当你将更改推送到 GitHub，它将被同步到 DagsHub 镜像 repo，它也跟踪你的数据和实验:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="oh oi di oj bf ok"><div class="gh gi oo"><img src="../Images/d17d9d207dd20871d52125f8cefd2f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1n3owSMK8FiSr2iHAnmHg.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="ea44" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在本文中，我们将只讨论项目设置和对数据执行 EDA。让我们开始吧。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="3f8a" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">项目设置</h2><p id="50f0" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">继续向前，我将假设您已经创建了一个 DagsHub 帐户，并从 GitHub 连接了一个空的存储库。</p><p id="a1cf" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">如果是这样，您可以在 conda 环境中安装 DVC，并按照存储库页面上的说明设置遥控器。您可以调用以下命令来创建我们的项目树结构:</p><pre class="ki kj kk kl gt op oq or os aw ot bi"><span id="dc7d" class="kw kx it oq b gy ou ov l ow ox">mkdir data data/raw data/prepared models notebooks</span></pre><p id="4619" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我还假设您熟悉 DVC 及其对数据进行添加、拉取和推送更改的常用命令。如果没有，你可以阅读<a class="ae kv" href="https://realpython.com/python-data-version-control/" rel="noopener ugc nofollow" target="_blank">这篇优秀的教程</a>来帮你补上。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="8f3c" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">获取数据</h2><p id="e430" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">你可以从<a class="ae kv" href="https://www.kaggle.com/c/petfinder-pawpularity-score" rel="noopener ugc nofollow" target="_blank"> Kaggle 宠物搜索大赛</a>页面下载完整的数据，但我已经把它上传到我的 repo 了。以下命令将 zip 文件夹提取到项目根目录:</p><pre class="ki kj kk kl gt op oq or os aw ot bi"><span id="05ac" class="kw kx it oq b gy ou ov l ow ox">dvc get https://dagshub.com/BexTuychiev/pet_pawpularity data/raw/petfinder-pawpularity-score.zip</span></pre><p id="5d2c" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">将其解压缩，并将所有文件移动到<code class="fe oy oz pa oq b">data/raw</code>目录。您可以稍后删除原始 zip 文件:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="2c75" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated"><code class="fe oy oz pa oq b">dvc get</code>命令可以处理 DVC 跟踪的任何文件，甚至是其他人的存储库中的文件。</p><p id="c13f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，让我们开始工作，探索数据。</p><blockquote class="pd pe pf"><p id="cac0" class="ls lt mq lu b lv ml ju lx ly mm jx ma pg mn mc md ph mo mf mg pi mp mi mj mk im bi translated">数据集所有者完全允许我使用文章中的数据。</p></blockquote></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="c44e" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">图像元数据的 EDA</h2><p id="6eef" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">Petfinder 数据集有大约 10k 个 pet 图像和每个图像的元数据。在本节中，我们将分析以 CSV 文件形式给出的元数据文件:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/2d0e26c15a2cd78a423bd7b0db1e61b5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*9Ja1dtwKmDXsGixw9xsb6Q.png"/></div></figure><pre class="ki kj kk kl gt op oq or os aw ot bi"><span id="db1f" class="kw kx it oq b gy ou ov l ow ox">&gt;&gt;&gt; test_df.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/017256a306428d6c5d358ecf10fca2b3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*3UFCCH32bvAqSSc491xtAw.png"/></div></figure><p id="62a3" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">有 13 个特征，ID 是图像的文件名，其余的是与图像特征相关的二进制特征。最后一个“Pawpularity”列是目标。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/63fcec317485b93beb48d214c7b16108.png" data-original-src="https://miro.medium.com/v2/format:webp/1*AuCe1Tv7uZ8zvFrT4fSWqA.png"/></div></figure><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="26f7" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">如您所见，在训练集中有 9912 个观察值，而在测试集中只有 8 个。我们必须在文章的下一部分开发一个可靠的验证策略，因为测试图像非常少。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="7d99" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">目标的 5 个数字总结告诉我们，可爱分数的范围从 1 到 100，平均值为 38，75%的图像的可爱分数为 46 或更低。为了更好地了解目标，我们来看一下直方图:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/8d449306fc8c343b5c4164f49a77027e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*qVuLyJG-Vhq6dSMQ-WIhSw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者图片</p></figure><p id="5e4d" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们可以看到大多数宠物的年龄在 20-40 岁之间。看到这么多可爱度分数最高的宠物也很意外。</p><p id="cdf9" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">由于特性都是二进制的，我们不会从中提取太多。因此，我们将查看按每个功能分组的目标分布。在开始绘图之前，让我们看看每一列代表什么:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/379dfffa13e718e24d9d99c3ae38a411.png" data-original-src="https://miro.medium.com/v2/format:webp/1*eue_C_0ot9A-y8MIb3m65Q.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated"><strong class="bd ku">截图自比赛资料页。</strong>作者。</p></figure><p id="330e" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们将为每一列创建一对图—一个箱线图和一个直方图:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/76fada0cb174e0d96926e0fc8058a7b9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Qc0504IaoXxBK1Ri8HrRKA.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/95d7d41ed8c6538379b7e02887020148.png" data-original-src="https://miro.medium.com/v2/format:webp/1*mANEfp24HtOrR0LO33yY2Q.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/a149069c93f3722abe82d16b257682f6.png" data-original-src="https://miro.medium.com/v2/format:webp/1*oRzXA-p10wxmdJz8U_k9WQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者提供的图片</p></figure><blockquote class="pd pe pf"><p id="9813" class="ls lt mq lu b lv ml ju lx ly mm jx ma pg mn mc md ph mo mf mg pi mp mi mj mk im bi translated">我省略了一些情节，因为它们都很相似，但是你可以查看<a class="ae kv" href="https://github.com/BexTuychiev/pet_pawpularity/blob/main/notebooks/eda.ipynb" rel="noopener ugc nofollow" target="_blank">GitHub 上的这个笔记本</a>，它展示了完整的分析。</p></blockquote><p id="3bb5" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">箱线图显示，即使按特征分组，目标也有相似的分布。直方图证实了这一点，表明这些元数据特征在构建预测模型时可能用处不大。</p><p id="ed64" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，让我们继续探索图像。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="4b5e" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">图像上的 EDA</h2><p id="1eb3" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">首先，让我们创建一个简单的函数，它加载一个图像并使用 Matplotlib 绘制它:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="3480" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们将把这个函数与另一个函数结合起来，这样我们每次调用它时都可以查看宠物的随机图片:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="a59d" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">正如我们前面看到的，元数据表在 Id 列中包含每个观察的文件名。我们将使用来自<code class="fe oy oz pa oq b">pathlib</code>模块的 Path 类，用它来构建所有图像路径的列表:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/45c7a5b5e5d10f2b093e9da4ea3f3fbe.png" data-original-src="https://miro.medium.com/v2/format:webp/1*yta_AF-_rKzZE1rCXbMWww.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">来自 Petfinder 数据集的图像</p></figure><p id="075c" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">您可以一遍又一遍地运行<code class="fe oy oz pa oq b">draw_random_image</code>函数，从中获得一点乐趣。</p><p id="149a" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">同时，让我们看看图像的维度以及它们之间的区别。宽度与高度的散点图应给出一个粗略的概念:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/9cca1a9d8d2bb43af7c2b1c8c717719f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*SvYP7rtj1CFUz9VepoU_pA.png"/></div></figure><p id="85f0" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们可以看到图像尺寸变化很大。在构建模型之前，我们需要在下面的文章中解决这个问题。</p><p id="fddd" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">现在，让我们来看看不同可爱程度的宠物照片，看看我们是否能找出一些模式来解释它们为什么有其他得分。为了实现这一点，我们将创建一个函数，在提供的 pawpularity 级别绘制<em class="mq"> n </em>个宠物的随机图像。这是:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="55ec" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">让我们画出从 20 到 100 的五个不同等级:</p><pre class="ki kj kk kl gt op oq or os aw ot bi"><span id="b81a" class="kw kx it oq b gy ou ov l ow ox">for level in range(20, 101, 20):<br/>    show_pawpularity_level(train_df, pawpularity=level)</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/f320c29054c166714652058a008ce0e6.png" data-original-src="https://miro.medium.com/v2/format:webp/1*4gmkuten_2hgBAep6Lz0rQ.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/285ab26899576989c03764d4d87931f2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*DItEU9TnN2LHN81PD83x_g.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/55f44d5e18dcd643cf860680c0d4b315.png" data-original-src="https://miro.medium.com/v2/format:webp/1*OMfOkScWGTfxAwkpxRxFhw.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/2bc865d22564afaa3c39e012e739d5b5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*akmr_Jl6_pzufytcdEPYcg.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/78fbd79af407ee4bd0772b467431a772.png" data-original-src="https://miro.medium.com/v2/format:webp/1*7EdZmLVZ2r_XNmuQ6MMi1w.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">来自 Petfinder 数据集的图像</p></figure><p id="c7e4" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">运行这个函数几次，发现很难辨别为什么 100 级宠物比低级宠物更受欢迎。</p><p id="b0f2" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">作为最后一步，让我们测试我们在最后一节中的观点，看看仅将模型与元数据相匹配是否会产生任何显著的结果。</p><h2 id="50b3" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">拟合基线模型</h2><p id="29fa" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">由于目标包含可爱分数，因此默认情况下这是一个回归任务。但是，我们总是可以把它看作一个 100 类的多类问题，并适合一个分类器。我们将两者都尝试，从使用随机森林的回归开始:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="aedf" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们不是过度配合，而是分数太可怕了。每幅图像的平均误差幅度约为 20%。让我们试试分类器:</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="f1c9" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">分类器更令人失望。</p><p id="7b84" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">我们将在下面的文章中使用图像和深度学习技术来提高这个分数。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="dacf" class="kw kx it bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h2><p id="3f0f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma lf mb mc md lj me mf mg ln mh mi mj mk im bi translated">本文仅作为项目概述。我们已经了解了机器学习项目面临的挑战，以及正在使用哪些工具来解决这些挑战。我们还初步研究了数据，探索了元数据文件和图像。</p><p id="6176" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated">在下一篇文章中，我们将继续发现 DVC DagsHub 的更多特征，并了解<a class="ae kv" href="https://mlflow.org/" rel="noopener ugc nofollow" target="_blank"> MLFlow </a>以跟踪我们对图像数据的实验。当我们在 DagsHub 中结合所有这些工具时，您将开始欣赏机器学习生命周期变得多么容易。感谢您的阅读！</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="5fd7" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated"><strong class="lu iu">您可以使用下面的链接成为高级媒体会员，并访问我的所有故事和数以千计的其他故事:</strong></p><div class="nf ng gp gr nh ni"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">通过我的推荐链接加入 Medium。</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nr l"><div class="pj l nt nu nv nr nw ko ni"/></div></div></a></div><p id="9a3f" class="pw-post-body-paragraph ls lt it lu b lv ml ju lx ly mm jx ma lf mn mc md lj mo mf mg ln mp mi mj mk im bi translated"><strong class="lu iu">或者订阅我的邮件列表:</strong></p><div class="nf ng gp gr nh ni"><a href="https://ibexorigin.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">每当 Bex T .发布时收到电子邮件。</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">每当 Bex T .发布时收到电子邮件。注册后，如果您还没有中型帐户，您将创建一个…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nr l"><div class="pk l nt nu nv nr nw ko ni"/></div></div></a></div></div></div>    
</body>
</html>