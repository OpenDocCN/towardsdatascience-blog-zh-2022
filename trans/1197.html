<html>
<head>
<title>Beginner’s Guide to the GPT-3 Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GPT-3 模型初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beginners-guide-to-the-gpt-3-model-2daad7fc335a#2022-03-28">https://towardsdatascience.com/beginners-guide-to-the-gpt-3-model-2daad7fc335a#2022-03-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0ada" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用 Python 演示了一些有趣的示例应用程序，只有几行代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/78aeb81e024c091ab393bea98812f535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yd5zDhL80qtfT-Yf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@helloimnik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">你好我是尼克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="625b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">背景</h1><p id="89c3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">2021 年 11 月 18 日，OpenAI 宣布其 API 服务的可用性将被拓宽，这使得像我一样的普通程序员可以探索 GPT-3 的示例应用。在此之前，API 服务只能通过等待列表获得。</p><p id="38dd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我在听 SuperDataScience 上最近的一期播客<a class="ae ky" href="https://www.superdatascience.com/podcast/gpt-3-for-natural-language-processing" rel="noopener ugc nofollow" target="_blank">节目</a>时，偶然发现了术语<strong class="lt iu"> GPT-3 游乐场</strong>，主持人和嘉宾讨论了 GPT-3 模型的发展。浏览互联网和媒体，我惊讶地发现几乎没有关于在<a class="ae ky" href="https://beta.openai.com/examples" rel="noopener ugc nofollow" target="_blank"> GPT-3 游乐场</a>演示的示例应用的报道。这是我决定写下 GPT-3 的一些应用的主要原因，这些应用可能会引起本文读者的兴趣。</p><h1 id="05a9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">GPT-3</h1><p id="196f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尽管普遍的共识是 GPT 3 是一个拥有数十亿参数的最先进的自然语言模型。对于初学者来说，可能有以下几点:</p><ul class=""><li id="296c" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated">该模型是预先训练的，这意味着它可以用于大量的“零射击”训练(尽管“少量射击”训练可能会显著提高其性能，我将在稍后的一个示例应用程序中解释)。</li><li id="8292" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">该模型与任务无关。例如，在各种其他应用中，可以调用它来执行文本生成或文本分类。正如稍后所演示的，对于 GPT-3 来说，要区分这些应用程序，只需要提供简要的上下文，有时只需要任务的“动词”(例如，翻译、创建)。</li></ul><p id="edcd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> GPT-3 游乐场</strong>是一个虚拟的在线环境，允许用户试验 GPT-3 API。它提供了一个基于 web 的界面，用户可以输入代码并实时查看查询结果。</p><p id="11c2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">只是为了好玩，我让 GPT 3 号本身(在 GPT 3 号游乐场)来“详细描述 GPT 3 号模型”，以下是返回的内容:</p><p id="d5e2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi">“</p><p id="95fd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">GPT-3 模型是一个基于转换器的语言模型，它是在一个大的文本数据语料库上训练的。该模型旨在用于自然语言处理任务，如文本分类、机器翻译和问题回答。该模型可以针对特定的任务或领域进行微调，并在许多基准测试中表现出优于其他基于 transformer 的模型。</p><p id="91ee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi">”</p><h1 id="02d3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">示例应用</h1><p id="2b15" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本节中，我将演示 GPT-3 的三(3)个应用示例。对于本文来说，示例应用程序是用一个带有<strong class="lt iu"> openai </strong>库的 Python 实现来演示的。</p><p id="59b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">加载 openai 库</strong></p><p id="2978" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，安装并导入 openai 库。这可以通过下面的 Python 代码来实现(在 Google Colab 中):</p><pre class="kj kk kl km gt nh ni nj bn nk nl bi"><span id="6300" class="nm la it ni b be nn no l np nq">!pip install openai<br/>import os<br/>import openai</span></pre><p id="8985" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> API 键</strong></p><p id="715f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们进入技术细节之前，需要一个 API 密钥来访问 GPT-3。这可以通过在 OpenAI(个人使用)注册一个帐户来获得。然后可以在注册帐户下查看 API 密钥。</p><p id="9fb0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">示例应用 1:根据某些配料制作食谱</strong></p><p id="6df0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这可以使用 GPT-3 <strong class="lt iu">完成</strong>端点来完成，该端点可用于各种应用，如翻译、汇总、Q &amp; A 等。首先，我将使用下面的 Python 代码定义一个将文本作为输入的通用函数。所有三(3)个具有不同文本输入的示例应用程序都将使用该函数。</p><pre class="kj kk kl km gt nh ni nj bn nk nl bi"><span id="1721" class="nm la it ni b be nn no l np nq">def GPT_Completion(texts):<br/>## Call the API key under your account (in a secure way)<br/>openai.api_key = "your API key"<br/>response = openai.Completion.create(<br/>engine="text-davinci-002",<br/>prompt =  texts,<br/>temperature = 0.6,<br/>top_p = 1,<br/>max_tokens = 64,<br/>frequency_penalty = 0,<br/>presence_penalty = 0<br/>)<br/>return print(response.choices[0].text)</span></pre><p id="8ee5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以看到完成端点下有许多参数，即:</p><ul class=""><li id="4ebc" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><strong class="lt iu">引擎</strong>设置为“text-davinci-002”，这是基于 OpenAI 的文档的“最有能力”的 GPT-3 模型。</li><li id="13ae" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">提示</strong>设置为“文本”，这是一个变量，代表输入到函数的文本。</li><li id="1220" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">温度</strong>规定了模型输出的确定性。高温使模型对输出进行采样的自由度更大。比如假设某个任务中返回单词<em class="ng"> A </em>和单词<em class="ng"> B </em>作为下一个单词的概率分别是 80%和 20%。设置“低”温度(即更接近 0)可能会在函数运行的所有情况下返回字<em class="ng"> A </em>，而设置“高”温度(即更接近 1)则允许模型在某些情况下返回字<em class="ng"> B </em>。</li><li id="0cba" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> top_p </strong>设置选择输出的分配。使用上面相同的例子，0.75 的 top_p 告诉模型只选择单词<em class="ng"> A </em>，因为它是唯一概率超过 0.75 的单词。</li><li id="a72d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> max_tokens </strong>设置返回的字数限制。这可能具有财务影响，因为 GPT-3 可能对商业应用按令牌收费。一般的经验法则是，模型允许返回的单词越多，输出就越不“抽象”。</li><li id="5222" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> frequency_penalty </strong>和<strong class="lt iu"> presence_penalty </strong>都是惩罚返回经常出现的输出的模型的参数。</li></ul><p id="3836" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，为了让 GPT-3 提供一份由<em class="ng">苹果、面粉、鸡肉和盐</em>组成的烹饪食谱，我们运行了下面的 Python 代码:</p><pre class="kj kk kl km gt nh ni nj bn nk nl bi"><span id="2a20" class="nm la it ni b be nn no l np nq">recipe = 'Provide a cooking recipe based on the following ingredients: \<br/>\n \nApple \<br/>\n \nFlour \<br/>\n \nChicken \<br/>\n \nSalt'<br/>GPT_Completion(recipe)</span></pre><p id="e409" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">GPT-3 返回以下输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/a1c65928eb388b0242ab6cc4b724500e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kEo7CQ-IJakpho6qUarstA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1:GPT 3 号生成的配方。作者图片</p></figure><p id="9828" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我没有亲自测试过这个食谱，但是它看起来相当详细，注意放松 max_tokens 参数会返回更详细的指令。</p><p id="97c0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">示例应用 2:一个讽刺的聊天机器人</strong></p><p id="6e6c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">示例应用 1 是一个“零射击”训练的例子，其中我们简单地要求 GPT-3 执行一个任务。如果我们想让 GPT-3 在交谈时模仿讽刺，就需要进行“少量射击”训练，如下所示:</p><pre class="kj kk kl km gt nh ni nj bn nk nl bi"><span id="a82e" class="nm la it ni b be nn no l np nq">## Provide 'training' to GPT-3 on how to be sarcastic<br/>chatbot = 'Marv is a chatbot that reluctantly answers questions with sarcastic responses:\<br/>\n \nYou: How many pounds are in a kilogram? \<br/>\n \nMarv: This again? There are 2.2 pounds in a kilogram. Please make a note of this.\<br/>\n \nYou: What does HTML stand for?\<br/>\n \nMarv: Was Google too busy? Hypertext Markup Language. The T is for try to ask better questions in the future.\<br/>\n \nYou: When did the first airplane fly?\<br/>\n \nMarv: On December 17, 1903, Wilbur and Orville Wright made the first flights. I wish they would come and take me away.\<br/>\n \nYou: What is the meaning of life?\<br/>\n \nMarv: I am not sure. I will ask my friend Google.\<br/>\n \nYou: What time is it?\<br/>\n \nMarv:'</span></pre><p id="d327" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用上面定义的聊天机器人文本调用示例应用 1 中定义的<em class="ng">GPT _ 完成()</em>函数，对最后一个问题(“现在几点？”)作者 GPT-3 是:</p><p id="f236" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">“你该问一个更有趣的问题了。”，这已经够讽刺的了，尽管我确实想知道 GPT-3 是否会在未来引入一个更细粒度讽刺(或许还有幽默)的参数。</p><p id="fbce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">示例应用 3:创建 Excel 表格</strong></p><p id="5dbe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这实际上是与示例应用 1 类似的应用。然而，我强调这个例子是因为它可以推广到其他有用的应用程序，比如文本到代码，或者代码到文本。</p><p id="cced" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要创建一个其他软件(如 Excel)可读的表格，只需给出下面的指令(鉴于奥斯卡就要到了)，并通过如下的<em class="ng">GPT _ 完成()</em>函数运行它:</p><pre class="kj kk kl km gt nh ni nj bn nk nl bi"><span id="9cae" class="nm la it ni b be nn no l np nq">spreadsheet = 'Create a two-column spreadsheet showing the 2019 oscar nominees for best movies and the director of the movie'<br/>GPT_Completion(spreadsheet)</span></pre><p id="2928" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">将返回下表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/deb124e25b0eddb17ecaa5f0ad3846d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*iRbK6T3dr1HqF2Bb6OR73w.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2: GPT-3 tble。作者图片</p></figure><h1 id="d604" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">其他 GPT-3 应用程序(附代码)</h1><p id="0abb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">除了本文讨论的示例应用，鉴于通用自然语言理解模型的广泛应用，OpenAI 在此<a class="ae ky" href="https://beta.openai.com/examples" rel="noopener ugc nofollow" target="_blank">链接</a>中提供了 GPT-3 的其他可能的示例应用。</p><p id="b3e9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些应用包括情感分类(使用分类端点，而不是完成端点)、语言(和代码)翻译、文本摘要等等，所有这些都可以用几行代码实现。</p><h1 id="300c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">总结想法</h1><p id="d15c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">总之，本文为初学者开始使用 GPT-3 模型下的一些示例应用程序提供了实用指南。GPT 3 游乐场证明了用户开始尝试最先进的自然语言模型是多么容易，而不需要实际了解模型是如何构建的。我个人认为，像 GPT-3 这样的“零射击”或“少射击”训练模式将会越来越受欢迎，特别是在商业环境中。</p><p id="aadc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你喜欢这些关于机器学习主题的实用指南吗？关注或访问我在<a class="ae ky" href="https://jin-cui.medium.com/" rel="noopener"> <strong class="lt iu">中的</strong> </a>获取更多信息！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><p id="8cc1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[1]本示例的文本输入由 GPT-3 在此<a class="ae ky" href="https://beta.openai.com/playground/p/default-marv-sarcastic-chat?model=text-davinci-002" rel="noopener ugc nofollow" target="_blank">链接</a>中提供。</p></div></div>    
</body>
</html>