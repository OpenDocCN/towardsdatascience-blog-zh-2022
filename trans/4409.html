<html>
<head>
<title>DoorDash SQL Interview Questions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DoorDash SQL面试问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/doordash-sql-interview-questions-509e1dfbb1fb#2022-09-29">https://towardsdatascience.com/doordash-sql-interview-questions-509e1dfbb1fb#2022-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="527f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">一个有趣的DoorDash SQL面试问题和解决方案的详细演练</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/bd22d04ea74ae6a90459ada8a9cba600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G8RB2P-ifKWELBoZs8tmbg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图片</p></figure><p id="fec7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们今天为您选择的DoorDash SQL面试问题很有趣，因为它要求您了解各种SQL概念。它通过使用<strong class="kz ir"> TO_CHAR() </strong>和<strong class="kz ir"> EXTRACT() </strong>等函数来测试您处理不同类型数据的能力。还有，它涉及到<a class="ae kw" href="https://www.stratascratch.com/blog/the-ultimate-guide-to-sql-aggregate-functions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir">聚合函数</strong> </a>和<strong class="kz ir"> CASE </strong>语句。</p><p id="cde3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们不会把问题和解决方案扔给你。如果你继续阅读，你会发现我们对如何回答这个问题的建议，而不仅仅是这个。其他任何DoorDash或者其他公司的<a class="ae kw" href="https://www.stratascratch.com/blog/sql-interview-questions-you-must-prepare-the-ultimate-guide/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank"> <em class="lt"> SQL面试题</em> </a>都可以用。我们相信这对你参加任何SQL面试都有很大帮助。</p><p id="41d3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了让它更有帮助，我们制作了一个视频，可以让你更容易地了解我们在这里将要谈论的一切。反之亦然。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="lu lv l"/></div></figure><h2 id="c460" class="lw lx iq bd ly lz ma dn mb mc md dp me lg mf mg mh lk mi mj mk lo ml mm mn mo bi translated">DoorDash SQL面试问题</h2><p id="b788" class="pw-post-body-paragraph kx ky iq kz b la mp jr lc ld mq ju lf lg mr li lj lk ms lm ln lo mt lq lr ls ij bi translated"><strong class="kz ir">极度延迟交货</strong></p><p id="b371" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们要谈的问题就是这一个。</p><blockquote class="mu mv mw"><p id="d946" class="kx ky lt kz b la lb jr lc ld le ju lf mx lh li lj my ll lm ln mz lp lq lr ls ij bi translated">如果实际交付时间比预测交付时间晚20分钟以上，则交付被标记为极度延迟。在每个月中，有百分之多少的订单是极度延迟的？以YYYY-MM格式输出月份，以及相应的极迟订单占本月所有订单的百分比。</p></blockquote><p id="c6df" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你想跟随我，这是的<a class="ae kw" href="https://platform.stratascratch.com/coding/2113-extremely-late-delivery?code_type=1&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank">链接。</a></p><p id="2572" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你事先对公司有过调研(强烈推荐！)，这是展示你对业务理解的时候了。</p><p id="00e4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Doordash想要调查他们的送货时间是有道理的。尤其是在食品行业，准时交货对于确保客户满意度至关重要。除此之外，还影响食品质量和安全。食物需要新鲜供应！</p><p id="ecf7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">假设你是DoorDash的一名数据分析师，管理层想知道每个月他们的订单中有多少百分比是“极度延迟交付”。如果订单交付时间比预计交付时间晚20分钟以上，则交付被视为“极度延迟”。</p><p id="1102" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">凭直觉，我们会逐月监控“极度延迟”交付的数量。然而，我们不能只看这个数字。总交付量将每月变化，并根据季节、假期以及公司的总体发展而波动。一个更好的跟踪指标是“极度延迟”订单占总订单的百分比。这正是这个DoorDash SQL面试问题要求我们做的。</p><p id="76d0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">理想情况下，我们希望看到这个指标随着时间的推移而降低，或者至少保持在某个阈值内。否则，这是一个值得关注的原因，导致收视率低，回头客少，食品质量差。比你想象的要快，公司倒闭了。你就失业了！</p><p id="ca6b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们不能让你为失去工作做好准备，但我们可以为找到工作做好准备！</p><h1 id="8acb" class="na lx iq bd ly nb nc nd mb ne nf ng me jw nh jx mh jz ni ka mk kc nj kd mn nk bi translated">解决这一问题的解决方案框架</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/9adc1665c0b9c51bd0ad8feaa0a2e542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fjJh9ofPFFdsRbKXuPwARA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="b490" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在你明白了你需要解决的问题，让我们开始制定解决方案。</p><p id="4925" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为此使用一个框架将帮助你组织你的想法，并以一种面试官可以理解的方式进行交流。这一点很重要，因为经常不仅仅是你的编码技能被测试，你的交流技能也被测试。</p><p id="6651" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们推荐的框架由以下步骤组成。</p><ol class=""><li id="d43e" class="nl nm iq kz b la lb ld le lg nn lk no lo np ls nq nr ns nt bi translated">探索和理解数据集</li><li id="2dea" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">确认并陈述你的假设</li><li id="b5a6" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">用英语或伪代码概述你的高级方法</li><li id="7d33" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">编码解决方案</li><li id="4e7d" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">代码优化(如果有)</li></ol><p id="50c8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你还不熟悉这个，去看看这个视频，里面详细解释了所有的步骤。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="lu lv l"/></div></figure><h1 id="6361" class="na lx iq bd ly nb nc nd mb ne nf ng me jw nh jx mh jz ni ka mk kc nj kd mn nk bi translated">1.浏览数据集</h1><p id="a1c0" class="pw-post-body-paragraph kx ky iq kz b la mp jr lc ld mq ju lf lg mr li lj lk ms lm ln lo mt lq lr ls ij bi translated">我们得到了<strong class="kz ir"> delivery_orders </strong>表，其中显示了配送ID、下订单的时间、预计配送时间、实际配送时间、为该配送提供的评级，以及配送员(骑手)、餐馆和消费者(顾客)的ID。</p><p id="5b00" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面是表格结构。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nz"><img src="../Images/9e1831f277ecdfe0aace6cfac76907d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LiRa3aez8k-82g1b2KGZ9g.png"/></div></div></figure><p id="941e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该表的预览显示了以下数据。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oa"><img src="../Images/7342f8a1ecb8ad0440d730f041a885b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tqJsRiMeudBK17xLnkrVfA.png"/></div></div></figure><p id="4f9e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦下了订单，就会给它分配一个惟一的交付ID，然后记录订单的相关细节，如客户、餐馆、日期和订单时间。计算交货时间/交货的预期到达时间，并将订单分配给配送员/骑手，其ID也包含在表中。订单交付后，会记录准确的时间，客户会通过评分提供反馈。</p><h1 id="d694" class="na lx iq bd ly nb nc nd mb ne nf ng me jw nh jx mh jz ni ka mk kc nj kd mn nk bi translated">2.确认并陈述你的假设</h1><p id="da83" class="pw-post-body-paragraph kx ky iq kz b la mp jr lc ld mq ju lf lg mr li lj lk ms lm ln lo mt lq lr ls ij bi translated">该问题没有提供如果订单被取消或交付正在途中(即，已下单但尚未交付)会发生什么情况的信息。</p><p id="7f67" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可以和面试官澄清这一点。我们没有这个选项，所以我们假设数据集只包含已履行的订单。</p><h1 id="73f4" class="na lx iq bd ly nb nc nd mb ne nf ng me jw nh jx mh jz ni ka mk kc nj kd mn nk bi translated">3.概述高级方法</h1><p id="a756" class="pw-post-body-paragraph kx ky iq kz b la mp jr lc ld mq ju lf lg mr li lj lk ms lm ln lo mt lq lr ls ij bi translated">现在，让我们解开获得目标输出表所需的东西。这个DoorDash SQL面试问题要求我们显示每个月的极度延迟订单的比例。</p><p id="9d52" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">输出应该以YYYY-MM格式显示月份，在第二列中显示相应的极度延迟订单的百分比。</p><p id="d3f9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了获得所需格式的日期，我们需要从order_placed_date列中提取月份和年份信息。</p><p id="74d3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">至于百分比，需要计算每个月的延期订单总数和订单总数。</p><p id="5fed" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">获得订单总数很容易:我们只需要计算唯一的交货id的数量。但是每个月的极晚订单总数呢？</p><p id="5b3c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了确定某个订单是否是“极度”延迟订单，我们必须比较预测交货时间和实际交货时间这两列。如果实际交付时间超过预测交付时间超过20分钟，那么我们就有一个“极度延迟”订单。</p><p id="ff5d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了剔除非常晚的订单，我们将使用CASE语句。</p><p id="5390" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">将这个详细的描述分成几个步骤:</p><ol class=""><li id="6eb5" class="nl nm iq kz b la lb ld le lg nn lk no lo np ls nq nr ns nt bi translated">TO _ CHAR()-从order_placed_date列中提取月份和年份，格式为YYYY-MM</li><li id="1cba" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">案例陈述——确定行级别的极度延迟交付</li><li id="cb52" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">EXTRACT() —获取实际交付时间和预测交付时间之间的差值(以分钟为单位)</li><li id="fb05" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">SUM() —获取极度延迟交货的总数</li><li id="ffc9" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">COUNT()和DISTINCT —获取所有交付的总数；除以上一步得到百分比</li><li id="4db5" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">CAST()-获取百分比中的小数点(浮点)</li><li id="a103" class="nl nm iq kz b la nu ld nv lg nw lk nx lo ny ls nq nr ns nt bi translated">分组依据-按月获取输出</li></ol><p id="8eed" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦你列出了所有的步骤，和面试官核对一下。这有助于你尽早获得反馈。如果一切顺利，您可以开始编码了。</p><h1 id="edf0" class="na lx iq bd ly nb nc nd mb ne nf ng me jw nh jx mh jz ni ka mk kc nj kd mn nk bi translated">4.编码解决方案</h1><p id="7fec" class="pw-post-body-paragraph kx ky iq kz b la mp jr lc ld mq ju lf lg mr li lj lk ms lm ln lo mt lq lr ls ij bi translated">编码现在仅仅意味着将上述步骤翻译成SQL代码。</p><p id="3229" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">1.<strong class="kz ir">提取月份和年份</strong></p><p id="7664" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将使用TO_CHAR()函数获取所需格式的数据。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="0304" class="lw lx iq oc b gy og oh l oi oj">SELECT TO_CHAR(order_placed_time,'YYYY-MM') AS year_month<br/>FROM delivery_orders;</span></pre><p id="7871" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果您的想法是使用EXTRACT()或DATE_PART()函数，您可以这样做。但是，这些函数不会直接获得您需要的格式，即YYYY-MM。如果您想了解更多关于日期时间操作的信息，请查看此视频。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="ec2c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 2。识别极度迟交的货物</strong></p><p id="8993" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">CASE语句是SQL中的一个IF-THEN-ELSE语句，它将允许我们识别极度延迟的交付。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="952c" class="lw lx iq oc b gy og oh l oi oj">SELECT TO_CHAR(order_placed_time, 'YYYY-MM') AS year_month,<br/>       CASE<br/>           WHEN (prediced_delivery_time - actual_delivery_time) &gt; 20 THEN 1<br/>           ELSE 0<br/>       END<br/>FROM delivery_orders;</span></pre><p id="4840" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，要做到这一点，我们需要提取分钟并减去它们。</p><p id="d282" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 3。以分钟为单位显示差异</strong></p><p id="892d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这一步中，我们将使用EXTRACT()函数。到目前为止，代码是这样的。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="0504" class="lw lx iq oc b gy og oh l oi oj">SELECT TO_CHAR(order_placed_time, 'YYYY-MM') AS year_month,<br/>       CASE<br/>           WHEN EXTRACT(MINUTE<br/>                        FROM (actual_delivery_time - predicted_delivery_time)) &gt; 20 THEN 1<br/>           ELSE 0<br/>       END<br/>FROM delivery_orders;<!-- --> </span></pre><p id="99a9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 4。极度延迟交货的数量</strong></p><p id="3124" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">CASE语句除了每一个非常晚的交付外，还会显示整数1。为了得到它们的数量，我们使用SUM()聚合函数。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="eb07" class="lw lx iq oc b gy og oh l oi oj">SELECT TO_CHAR(order_placed_time, 'YYYY-MM') AS year_month,<br/>       SUM(CASE<br/>               WHEN EXTRACT(MINUTE<br/>                            FROM (actual_delivery_time - predicted_delivery_time)) &gt; 20 THEN 1<br/>               ELSE 0<br/>           END)<br/>FROM delivery_orders;</span></pre><p id="8560" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 5。所有交付的数量</strong></p><p id="7b76" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下一步是使用COUNT()和DISTINCT查找所有唯一交付的数量。此外，极晚交货的数量必须除以这个数字。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="95c2" class="lw lx iq oc b gy og oh l oi oj">SELECT TO_CHAR(order_placed_time, 'YYYY-MM') AS year_month,<br/>       SUM(CASE<br/>               WHEN EXTRACT(MINUTE<br/>                            FROM (actual_delivery_time - predicted_delivery_time)) &gt; 20 THEN 1<br/>               ELSE 0<br/>           END)/COUNT(DISTINCT delivery_id)*100<br/>FROM delivery_orders;</span></pre><p id="ec74" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 6。转换为浮点型</strong></p><p id="5d71" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">上面的get将除法结果显示为整数。即零，因为极度延迟交货的数量低于总交货数量。</p><p id="ce3b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要解决这个问题，可以使用CAST()函数。我们将使用双冒号(::)，这是该函数的简写。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="3980" class="lw lx iq oc b gy og oh l oi oj">SELECT TO_CHAR(order_placed_time, 'YYYY-MM') AS year_month,<br/>       SUM(CASE<br/>               WHEN EXTRACT(MINUTE<br/>                            FROM (actual_delivery_time - predicted_delivery_time)) &gt; 20 THEN 1<br/>               ELSE 0<br/>           END)/COUNT(DISTINCT delivery_id)::FLOAT*100 AS perc_extremely_late<br/>FROM delivery_orders;</span></pre><p id="8ded" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 7。按年月分组</strong></p><p id="c052" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在剩下的就是使用GROUP BY子句了，您已经得到了这个DoorDash SQL面试问题的完整答案。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="49fb" class="lw lx iq oc b gy og oh l oi oj">SELECT TO_CHAR(order_placed_time, 'YYYY-MM') AS year_month,<br/>       SUM(CASE<br/>               WHEN EXTRACT(MINUTE<br/>                            FROM (actual_delivery_time - predicted_delivery_time)) &gt; 20 THEN 1<br/>               ELSE 0<br/>           END)/COUNT(DISTINCT delivery_id)::FLOAT*100 AS perc_extremely_late<br/>FROM delivery_orders<br/>GROUP BY 1;</span></pre><p id="6971" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这一结果需要引起注意，因为Doordash有几个月的交货时间非常晚，比例很高。表现最差的是2022年1月，约有36%的订单极度延迟。同样，2021年11月也有令人不安的31%的交付业绩。这样，公司管理层会希望调查根本原因，以便将极迟交付保持在最低限度；否则，漫长的等待可能会吓跑Doordash的宝贵客户！</p><h1 id="a480" class="na lx iq bd ly nb nc nd mb ne nf ng me jw nh jx mh jz ni ka mk kc nj kd mn nk bi translated">5.代码优化</h1><p id="1560" class="pw-post-body-paragraph kx ky iq kz b la mp jr lc ld mq ju lf lg mr li lj lk ms lm ln lo mt lq lr ls ij bi translated">您是否需要这一步取决于代码本身。有些代码不需要优化，而有些则需要。面试官往往喜欢要求一个代码进行优化。受访者这样做的能力表明，他们可以编写一个有效的代码。</p><p id="a799" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果面试结束的时候还剩下更多的时间，那就想想你该如何改进解决方案，即使面试官没有要求你优化。</p><p id="5115" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于我们的DoorDash问题解决方案，我们可以改进它。一个方便的技巧是使用公共表表达式或cte。</p><p id="244d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果存在列转换或者代码更复杂，那么在出现错误的情况下，会使您的解决方案更难理解和调试。cte在这里特别有用！</p><p id="cd45" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">通过在汇总最终结果之前编写CTE，我们可以优化我们的解决方案。</p><pre class="kh ki kj kk gt ob oc od oe aw of bi"><span id="fce9" class="lw lx iq oc b gy og oh l oi oj">WITH orders AS<br/>  (SELECT TO_CHAR(order_placed_time, 'YYYY-MM') AS year_month,<br/>          delivery_id,<br/>          CASE<br/>              WHEN EXTRACT(MINUTE<br/>   FROM (actual_delivery_time - predicted_delivery_time)) &gt; 20 THEN 1<br/>              ELSE 0<br/>          END AS extremely_late<br/>   FROM delivery_orders)<br/><br/>SELECT year_month,<br/>       SUM(extremely_late)/COUNT(DISTINCT delivery_id)::FLOAT*100 AS perc_extremely_late<br/>FROM orders<br/>GROUP BY 1;</span></pre><p id="021b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">运行这段代码，您将看到它返回与第一个解决方案相同的结果。</p><h2 id="5050" class="lw lx iq bd ly lz ma dn mb mc md dp me lg mf mg mh lk mi mj mk lo ml mm mn mo bi translated">结论</h2><p id="f0bf" class="pw-post-body-paragraph kx ky iq kz b la mp jr lc ld mq ju lf lg mr li lj lk ms lm ln lo mt lq lr ls ij bi translated">这个中等难度的SQL面试问题真正展示了面试官喜欢问的问题。我们讨论了数据聚合，处理日期、数据转换、CASE语句和数据分组。这些也是在工作面试中测试的流行的SQL概念。还有更多这样的DoorDash问题，请查看我们的帖子“<a class="ae kw" href="https://www.stratascratch.com/blog/most-common-doordash-data-scientist-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank"> <em class="lt">最常见的DoorDash数据科学家面试问题</em> </a>”。尝试解决其中的一些问题，看看你在这里学到的东西是否可以应用到其他问题上。在面试中回答问题时，不要忘记使用结构化框架。这对你来说真的很重要！</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="7678" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">【https://www.stratascratch.com】最初发表于<a class="ae kw" href="https://www.stratascratch.com/blog/doordash-sql-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank"><em class="lt"/></a><em class="lt">。</em></p></div></div>    
</body>
</html>