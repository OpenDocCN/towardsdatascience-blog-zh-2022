<html>
<head>
<title>Creating autocomplete search forms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建自动完成搜索表单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-autocomplete-search-forms-e8bc3f2c1669#2022-05-25">https://towardsdatascience.com/creating-autocomplete-search-forms-e8bc3f2c1669#2022-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5509" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Tkinter vs Excel VBA</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/27f16dbd714f2d5ab33509e8cc236a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AD6zBUpnf2W221eut7Go4Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自动完成功能让搜索变得更容易</p></figure><p id="329d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在今天的数据洪流中，用户友好的搜索掩码几乎是不可或缺的。在这篇文章中，我们将看到如何使用Tkinter开发一个用于翻译目的的响应搜索，并与VBA进行比较。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/08e467078f56100b0ebe18667565ea41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/1*WnzkfiK6ihAmpksv4HBn0g.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">响应搜索表单(图片由作者提供)</p></figure><p id="3eb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">背景:</strong></p><p id="57bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的表由两列组成。第一列包含英语术语，第二列包含相应的德语翻译。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/81fadb19fdd87211ef9c49d6746214c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*qqOaKm-QgCWClhDfVuXFCw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">德-英金融术语摘录(图片由作者提供)</p></figure><p id="5f4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们希望为用户提供一个用户友好的输入掩码来搜索翻译。两种语言都要搜索。为了好玩，我们将在Excel VBA中创建一次，然后将其与Python的Tkinter匹配。这样我们将再次认识到为什么Python是如此伟大的编程语言。玩笑归玩笑，这主要是针对那些来自VBA，现在想学习Python的人。希望这能帮助你更容易理解基本概念。</p><p id="f1ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">解决方案:</strong></p><p id="7fcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">搜索到的单词会立即与相应的翻译一起列在命中列表中。搜索栏中每输入一个字母，命中列表的范围就会相应缩小。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/8ed566999bc725d9c73d1c79f908d092.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*9C3re8yOzyg9WL9NPHhtLQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="a3e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在Excel VBA中实现这一点，需要一系列不同的步骤。我只说明最重要的几个方面，这些方面我们也和Tkinter比较。但是如果您想详细研究代码，可以在我的Github资源库中找到完整的文件和代码。</p><p id="0997" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Excel表格被分成称为“SearchText”的用户输入:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/4c5b0b21e6af2387c7fa2562f464dfca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*XaLKVcD4ktWT2mMq5btGcA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="cbb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果显示在“ListBoxTerms”中时:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/d1fc6b10390f664094798fb371e5ffc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*XOfhA5_KnzgU-VySsJFceQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="c362" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果搜索成功，您可以双击每个匹配项，将翻译转移到搜索选择选项卡:</p><pre class="kj kk kl km gt ma mb mc md aw me bi"><span id="c37d" class="mf mg it mb b gy mh mi l mj mk">Private Sub ListBoxTerms_DblClick(ByVal Cancel As MSForms.ReturnBoolean)<br/>If ListBoxTerms.ListIndex = -1 Then<br/>    MsgBox "No dataset selected"<br/>    Exit Sub<br/>End If<br/>Dim wks As Worksheet<br/>Set wks = Worksheets("SearchSelect")<br/>With Me.ListBoxTerms<br/>wks.Range("F11:F12").ClearContents<br/>wks.Range("F12").Value = .List(.ListIndex, 0)<br/>wks.Range("F11").Value = .List(.ListIndex, 1)<br/>End With<br/>Unload Me<br/>End Sub</span></pre><p id="d746" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有输入搜索，默认情况下，列表中会填充范围A1至B1000(数据来自“标准”选项卡):</p><pre class="kj kk kl km gt ma mb mc md aw me bi"><span id="be94" class="mf mg it mb b gy mh mi l mj mk">Sub ListFill()<br/>Dim SD As Worksheet<br/>Set SD = Sheets("Standards")<br/>Dim LastRow%<br/>LastRow = Sheets("Standards").Range("A1000").End(xlUp).Row + 1<br/>ListBoxTerms.RowSource = "Standards!A1:B" &amp; LastRow<br/>End Sub</span></pre><p id="c6f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据最近的字符串搜索显示的过滤列表可能值得更仔细地观察一下。我们使用大写字母(UCase)来确保搜索不区分大小写。然后，我们比较Standards选项卡中第一列(包含英文单词)中的每一行，以查看它是否包含在搜索文本(SearchText)的字符串(InStr)中。如果大于0，则“标准”选项卡中的单词将显示在ListBoxTerms(显示与用户当前搜索相对应的匹配项的列表框)中。这个英语单词使用VBA的AddItem显示在ListBoxTerms中。“标准”选项卡的第二列也是如此，其中包含德语翻译(SD。细胞(I，2))。借助VBA的ListCount函数，这个德语单词被插入到ListBoxTerms中。</p><pre class="kj kk kl km gt ma mb mc md aw me bi"><span id="ebd0" class="mf mg it mb b gy mh mi l mj mk">Sub ListFillFilter()<br/>If SearchText = "" Then<br/>    Call ListFill<br/>    Exit Sub<br/>End If<br/>Dim SD As Worksheet<br/>Set SD = Sheets("Standards")<br/>Dim LastRow%<br/>Dim i%<br/>LastRow = Sheets("Standards").Range("A1000").End(xlUp).Row + 1<br/>ListBoxTerms.RowSource = ""<br/>i = 1<br/>Do<br/>    If InStr(UCase(SD.Cells(i, 1)), UCase(SearchText)) &gt; 0 Or InStr(UCase(SD.Cells(i, 2)), UCase(SearchText)) &gt; 0 Then<br/>        ListBoxTerms.AddItem SD.Cells(i, 1)<br/>        ListBoxTerms.List(ListBoxTerms.ListCount - 1, 1) = SD.Cells(i, 2)<br/>    End If<br/>i = i + 1<br/>Loop Until i &gt; LastRow<br/>End Sub</span></pre><p id="0c98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Excel VBA的初始化功能，每当打开文件时都会填充列表表单:</p><pre class="kj kk kl km gt ma mb mc md aw me bi"><span id="f31e" class="mf mg it mb b gy mh mi l mj mk">Private Sub SearchText_Change()<br/>Call ListFillFilter<br/>End Sub</span></pre><p id="0c36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，使用VBA的change函数，我们在每次向搜索表单中输入内容时调用ListFillFilter:</p><pre class="kj kk kl km gt ma mb mc md aw me bi"><span id="934a" class="mf mg it mb b gy mh mi l mj mk">Private Sub UserForm_Initialize()<br/>Call ListFill<br/>End Sub</span></pre><p id="8e8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是在Excel中设置搜索表单的方法。<br/>现在让我们看看在Python中使用Tkinter解决这个问题的完整方案。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/613a576966b5ddb1ca3d31a35b60f66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*z79o6iBZSgRJwpPnwlVdUQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用Tkinter解决Python中的响应搜索(图片由作者提供)</p></figure><p id="c73f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文的目的不是争论哪个解决方案是更好的选择。但是对您来说，比较VBA和Python可能会很有趣，特别是对于本例中三个最重要的函数。Python代码对你来说看起来也更苗条了吗(或者只是我不同的截图技术扭曲了这种印象)？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/9018437ede6939fc4077a53e28b0e164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQu-I2O-kKhNwYzXzVOH0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ListFill，VBA左对Python右(图片由作者提供)</p></figure><p id="e575" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至少从上面的ListFillFilter我们可以清楚的看到，Python让对比变得更加方便。Python中的循环不太费力，因为我们不必一直数到翻译字典的末尾。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/e86b848cb4b618e823bc08728beb3666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UMGZrP6sBQJxSKO6Cs0EDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ListFillFilter，VBA左vs Python右(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/2ff4a098151c2b36145a67006820f4e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-YM_Xf4XZqJdtgpSreokQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ListBoxTermsDoubleClick，VBA左vs Python右(图片由作者提供)</p></figure><p id="34f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">概要:</strong></p><p id="08e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜您，您已经编写了一个动态搜索程序，使用户更容易输入数据。在这个例子中，我们只搜索了字符串的匹配，这是一个非常简单的搜索功能。但是对于我们的翻译需求，这已经足够了。在<a class="ae ky" rel="noopener" target="_blank" href="/high-scalable-fast-search-with-haystack-8b7bb103df8e">的另一篇文章</a>中，我们将把这种“字符串匹配方法”与高度可扩展的认知搜索进行比较(这里有一个小玩笑:Haystack和Elasticsearch是神奇的词)。</p><p id="a394" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此之前，非常感谢您的阅读！希望这篇文章对你有帮助。请随时在<a class="ae ky" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ky" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室</a>与我联系。</p><div class="mr ms gp gr mt mu"><a href="https://jesko-rehberg.medium.com/membership" rel="noopener follow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">通过我的推荐链接加入Medium-Jesko Rehberg</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">阅读杰斯科·雷伯格(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">jesko-rehberg.medium.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni ks mu"/></div></div></a></div><p id="5df5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在我的<a class="ae ky" href="https://github.com/DAR-DatenanalyseRehberg/SearchSelectAutocomplete" rel="noopener ugc nofollow" target="_blank"> Github </a>资源库中找到完整的代码和文件。请随时在<a class="ae ky" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ky" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室</a>与我联系。</p></div></div>    
</body>
</html>