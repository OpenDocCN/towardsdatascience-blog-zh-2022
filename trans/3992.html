<html>
<head>
<title>Introduction to Two-Stage Least Squares Estimation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">两步最小二乘估计简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-two-stage-least-squares-estimation-4dbabdd98102#2022-09-06">https://towardsdatascience.com/introduction-to-two-stage-least-squares-estimation-4dbabdd98102#2022-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/99c4d66db64bd01cc715224c538debb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILYeDiWgpK8_p3p_3osppg.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://pixabay.com/users/spacex-imagery-885857/" rel="noopener ugc nofollow" target="_blank"> SpaceX-Imagery </a>发自<a class="ae jd" href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=693206" rel="noopener ugc nofollow" target="_blank"> Pixabay </a> ( <a class="ae jd" href="https://pixabay.com/service/license/" rel="noopener ugc nofollow" target="_blank">牌照</a>)</p></figure><div class=""/><div class=""><h2 id="b6f4" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">我们将学习如何使用2SLS技术来估计包含工具变量的线性模型</h2></div><p id="4191" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我们将学习使用<strong class="kx jh">工具变量</strong>技术估计线性模型的两种不同方法。</p><p id="a4a8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上一篇文章中，<a class="ae jd" rel="noopener" target="_blank" href="/introduction-to-instrumental-variables-estimation-3eba75a04418">我们学习了工具变量</a>，它们是什么，何时以及如何使用它们。让我们回顾一下我们所学的内容:</p><p id="6ad1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">考虑以下线性模型:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lr"><img src="../Images/d38abcb584f15fd0dfe69fdd0fc27d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8p2NYHdKP0vr_qebcwLr2g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">二元线性模型<strong class="bd lw"> x </strong> _2和<strong class="bd lw"> x </strong> _3(图片由作者提供)</p></figure><p id="82e1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上式中，<strong class="kx jh"><em class="lx"/></strong><em class="lx">，</em> <strong class="kx jh"> <em class="lx"> 1，x </em> </strong> <em class="lx"> _2，</em><strong class="kx jh"><em class="lx">x</em></strong><em class="lx">_ 3</em>，<strong class="kx jh"><em class="lx">【ϵ</em></strong>为大小为<em class="lx">【n×1】</em>的列向量。从后面的等式中，为了简洁起见，我们将去掉<strong class="kx jh"> <em class="lx"> 1 </em> </strong>(它是1的向量)。</p><p id="5450" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果一个或多个回归变量，比如说<strong class="kx jh"><em class="lx">x</em></strong><em class="lx">_ 3</em>，是<a class="ae jd" rel="noopener" target="_blank" href="/what-are-exogenous-and-endogenous-regression-variables-c0ea1ba03ce8"><strong class="kx jh"/></a>，即它与误差项<strong class="kx jh"><em class="lx"/></strong>相关，则普通最小二乘(OLS)估计量是<strong class="kx jh">不</strong> <a class="ae jd" rel="noopener" target="_blank" href="/the-consistent-estimator-913fab06f4f3"> <strong class="kx jh">一致</strong> </a>。它生成的系数估计值偏离了真实值，使人对实验的有用性产生疑问。</p><p id="60bd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">挽救这种局面的一个办法是想出一个办法，有效地将<strong class="kx jh"><em class="lx">×3</em></strong><em class="lx">_ 3</em>分成两部分:</p><ol class=""><li id="cfd2" class="ly lz jg kx b ky kz lb lc le ma li mb lm mc lq md me mf mg bi translated">与<strong class="kx jh"> <em class="lx"> ϵ </em> </strong>不相关的块，我们将把它添加回模型中，以代替<strong class="kx jh"><em class="lx">x</em></strong><em class="lx">_ 3</em>。这是<strong class="kx jh"><em class="lx">x</em></strong><em class="lx">_ 3</em>的部分，其实是外生的。</li><li id="c0d2" class="ly lz jg kx b ky mh lb mi le mj li mk lm ml lq md me mf mg bi translated">与<strong class="kx jh"> <em class="lx">、ϵ </em> </strong>相关的第二个块，我们将从模型中切掉。这是内生的部分。</li></ol><p id="d343" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">而实现这个目标的一个方法就是标识一个变量<strong class="kx jh"><em class="lx"/></strong><em class="lx">_ 3</em>，“一个用于<strong class="kx jh"><em class="lx">x</em></strong><em class="lx">_ 3</em>”，具有以下属性:</p><ol class=""><li id="48fc" class="ly lz jg kx b ky kz lb lc le ma li mb lm mc lq md me mf mg bi translated">与<strong class="kx jh"> <em class="lx"> x </em> </strong> <em class="lx"> _3相关。</em>认为(在某种程度上)满足了上述两个要求中的第一个，并且</li><li id="4be0" class="ly lz jg kx b ky mh lb mi le mj li mk lm ml lq md me mf mg bi translated">它与满足第二个要求的误差项无关。</li></ol><p id="ac9e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将<strong class="kx jh"><em class="lx">x</em></strong><em class="lx">_ 3</em>替换为<strong class="kx jh"><em class="lx">z</em></strong><em class="lx">_ 3</em>产生以下模型:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mm"><img src="../Images/211f9edab4c219bc5661a2a7732dd6a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZFMWpJf1DkgKen9-voTMg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">内生变量<strong class="bd lw"> x </strong> _3替换为变量<strong class="bd lw"> z </strong> _3的线性模型(图片由作者提供)</p></figure><p id="ffb8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">等式(1a)的R.H.S上的所有变量都是外生的。该模型可以使用最小二乘法进行一致估计。</p><p id="66fb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上述估计技术可以很容易地扩展到多个内生变量及其相应的工具<em class="lx">，只要每个内生变量与单个唯一的工具变量</em>一对一配对。</p><p id="d93d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上面的例子给出了IV估计的一般框架，我们将在下面介绍。</p><p id="b890" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="lx"> y </em> </strong>对<strong class="kx jh"> <em class="lx"> X </em> </strong>的线性回归采用如下矩阵形式:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/adf2042d1bfe2d3a75325e40eeaab6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*Kohjytp1VEz9mrhgBdZXzw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性模型，其中<strong class="bd lw"> y </strong>在<strong class="bd lw"> X </strong>上回归(图片由作者提供)</p></figure><p id="fb48" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设数据集的大小为<em class="lx"> n </em>，在等式(2)中:</p><ul class=""><li id="af18" class="ly lz jg kx b ky kz lb lc le ma li mb lm mc lq mo me mf mg bi translated"><strong class="kx jh"> <em class="lx"> y </em> </strong>是大小<em class="lx">【n×1】</em>的向量。</li><li id="aa4e" class="ly lz jg kx b ky mh lb mi le mj li mk lm ml lq mo me mf mg bi translated"><strong class="kx jh"> <em class="lx"> X </em> </strong>是大小为<em class="lx">【n X(k+1)】</em>的回归变量的矩阵，即它有<em class="lx"> n </em>行和<em class="lx"> (k+1) </em>列，其中第一列是一列1，作为截距的占位符。</li><li id="12a6" class="ly lz jg kx b ky mh lb mi le mj li mk lm ml lq mo me mf mg bi translated"><strong class="kx jh"> <em class="lx"> β </em> </strong>是大小为<em class="lx"> [(k+1) x 1] </em>的回归系数的列向量，其中第一个元素<em class="lx"> β_1 </em>是回归的截距。</li><li id="dbaf" class="ly lz jg kx b ky mh lb mi le mj li mk lm ml lq mo me mf mg bi translated"><strong class="kx jh"> <em class="lx"> ϵ </em> </strong>是回归误差大小<em class="lx">【n x1】</em>的列向量。<strong class="kx jh"><em class="lx"/></strong>有效保存了<strong class="kx jh"><em class="lx"/></strong>中模型<strong class="kx jh"> <em class="lx"> Xβ </em> </strong>无法解释的差额余额。</li></ul><p id="3a3e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是上述等式的矩阵格式:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mp"><img src="../Images/c0ad5fa2df9e1111f90592197156c4f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V6IrYxPSgHgVxSMsvysI_w.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性回归模型的矩阵版本(图片由作者提供)</p></figure><p id="6650" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不失一般性，且不计截距，让我们假设<strong class="kx jh"> <em class="lx"> X </em> </strong>中的第一个<em class="lx"> p </em>回归变量是外生的，下一个<em class="lx"> q </em>变量是内生的，使得<em class="lx"> 1 + p + q = k </em>:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mq"><img src="../Images/a58759928ea26fc1f80b0facd24ca26f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-x36o4Huwy1EICrpG3Pow.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">由p个外生变量和q个内生变量组成的<strong class="bd lw"> X </strong>矩阵(图片由作者提供)</p></figure><p id="8ce9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设我们能够识别出<em class="lx"> q </em>工具变量，这些工具变量将是<strong class="kx jh"> <em class="lx"> X </em> </strong>中相应的<em class="lx"> q </em>回归变量的工具，即<strong class="kx jh"><em class="lx">X</em></strong><em class="lx">_(p+1)</em>到<strong class="kx jh"><em class="lx">X</em><em class="lx">_ k</em>中被怀疑是内生的变量。</strong></p><p id="15d0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们构造一个矩阵<strong class="kx jh"> <em class="lx"> Z </em> </strong>如下:</p><ul class=""><li id="9d90" class="ly lz jg kx b ky kz lb lc le ma li mb lm mc lq mo me mf mg bi translated"><strong class="kx jh"> <em class="lx"> Z </em> </strong>的第一列将是1的一列。</li><li id="6e9d" class="ly lz jg kx b ky mh lb mi le mj li mk lm ml lq mo me mf mg bi translated">下一个<em class="lx"> p </em>列的<strong class="kx jh"> Z </strong>即<strong class="kx jh"><em class="lx">Z</em></strong><em class="lx">_ 2</em>到<strong class="kx jh"><em class="lx">Z</em></strong><em class="lx">_ p</em>将与<em class="lx"> p </em>外生变量<strong class="kx jh"><em class="lx">x</em></strong><em class="lx">_ 2</em>到<strong class="kx jh"> <em class="lx"> x相同</em></strong></li><li id="08de" class="ly lz jg kx b ky mh lb mi le mj li mk lm ml lq mo me mf mg bi translated"><strong class="kx jh"><em class="lx"/></strong>中的最后一组<em class="lx"> q </em>列，即<strong class="kx jh"><em class="lx">Z</em></strong><em class="lx">【p+1】</em>到<strong class="kx jh"><em class="lx">Z</em></strong><em class="lx">_ k</em>将保存<em class="lx"> q </em>变量的数据，这些变量将作为相应<em class="lx">q</em>的工具</li></ul><p id="cc6e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，<strong class="kx jh"> <em class="lx"> Z </em> </strong>的大小也是<em class="lx">【n X(k+1)】</em>，即与<strong class="kx jh"> <em class="lx"> X </em> </strong>的大小相同。</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/91936aaecfe87fa77c3c5228781126b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*tjpxmK_FbL3zoHr3zvO0Gg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd lw"> Z </strong>矩阵(图片由作者提供)</p></figure><p id="0d4c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们将采用转置<strong class="kx jh"> <em class="lx"> Z </em> </strong>来交换行和列。转置操作实质上是将<strong class="kx jh"> <em class="lx"> Z </em> </strong>翻转过来。<strong class="kx jh"> <em class="lx"> Z </em> </strong>的转置记为<strong class="kx jh"><em class="lx">Z’</em></strong>大小为<em class="lx"> [(k+1) x n]。</em></p><p id="98c4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，让我们将等式(2)与<strong class="kx jh"><em class="lx">Z’</em></strong>预先相乘:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/ae43828a4c4514346a5269540eab54d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*vTWF2NS3o-1LFZ25RFUGcg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">将等式(2)与<strong class="bd lw">Z’</strong>相乘(图片由作者提供)</p></figure><p id="7ad2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">等式(3)在尺寸上是正确的。在左侧，<strong class="kx jh"><em class="lx"/></strong>的大小为<em class="lx">[(k+1)x n]</em><strong class="kx jh"><em class="lx">y</em></strong>的大小为<em class="lx">【n x 1】</em>。因此<strong class="kx jh"> <em class="lx"> Z'y </em> </strong>的大小为<em class="lx"> [(k+1) x 1] </em>。</p><p id="4759" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在右侧，<strong class="kx jh"> <em class="lx"> X </em> </strong>的尺寸为<em class="lx">【n X(k+1)】</em><strong class="kx jh"><em class="lx">β</em></strong>的尺寸为<em class="lx">[(k+1)X 1】</em>。从左到右，<strong class="kx jh"> <em class="lx"> Z'X </em> </strong>是一个大小为<em class="lx">[(k+1)x(k+1)】</em>和<em class="lx">(</em><strong class="kx jh"><em class="lx">Z ' x</em></strong><em class="lx">)</em><strong class="kx jh"><em class="lx"/></strong>的大小为<em class="lx"> [(k+1) x 1】。</em></p><p id="082e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，<strong class="kx jh"> <em class="lx"> ϵ </em> </strong>大小为<em class="lx">【n×1】</em>。所以<strong class="kx jh"> <em class="lx"> Z'ϵ </em> </strong>的大小也是<em class="lx"> [(k+1) x 1]。</em></p><p id="1ce9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，让我们应用期望操作符<em class="lx"> E(。)</em>情商两边。(3):</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/e8f543216bbb009f84cf6c5d12b67a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLyvuJP4gjQkyzCCZt4SvA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">将期望算子应用于等式(3)的两边(图片由作者提供)</p></figure><p id="4474" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lx">E(</em><strong class="kx jh"><em class="lx">Z ' y</em></strong><em class="lx">)</em>和<em class="lx">E(</em><strong class="kx jh"><em class="lx">Z ' xβ</em></strong><em class="lx">)</em>分别解析为<strong class="kx jh"> <em class="lx"> Z'y </em> </strong>和<strong class="kx jh"> <em class="lx"> Z'Xβ </em> </strong>。</p><p id="9a17" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">回忆一下<strong class="kx jh"> <em class="lx"> Z </em> </strong>只包含外生变量。因此，<strong class="kx jh"><em class="lx">【z】</em></strong>和<strong class="kx jh"><em class="lx"/></strong>不相关，因此<em class="lx">(</em><strong class="kx jh"><em class="lx">【z'ϵ</em></strong><em class="lx">)</em>的平均值是零的列向量，等式(3a)解析为:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/a5b9a74f08c29504e64600e0cc18eeb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*ltUGU3iXt_EN7aNDyq4yvg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="4a97" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们将通过将等式(4)的两边乘以方阵的逆矩阵(<strong class="kx jh"><em class="lx">Z ' x</em></strong><em class="lx">)来分离等式(4)的R.H.S .上的系数向量<strong class="kx jh"> <em class="lx"> β </em> </strong>。</em></p><p id="750c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">矩阵的逆在概念上是标量数<em class="lx"> N </em>的逆的多维等价(假设<em class="lx"> N </em>不为零)<em class="lx">。</em>矩阵的逆矩阵是用一个复杂的公式计算的，我们将跳过这个公式。</p><p id="222d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有可能表明(<strong class="kx jh"> <em class="lx"> Z'X </em> </strong>)是<a class="ae jd" href="https://en.wikipedia.org/wiki/Invertible_matrix" rel="noopener ugc nofollow" target="_blank">可逆</a>(同样这点我们不会在这里深究)。等式两边的预乘。(4)由<em class="lx">(</em><strong class="kx jh"><em class="lx">z ' x</em></strong><em class="lx">)</em>的逆即<em class="lx">(</em><strong class="kx jh"><em class="lx">z ' x</em></strong><em class="lx"/>，得到如下结论:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/9a3e7a788dc3394a4ca33b0a56910bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8gQQ32Lx68zRRHHAjMpyEQ.png"/></div></div></figure><p id="ca15" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">R.H.S .上的黄色位和绿色位相互抵消，以与N*(1/N)等于1相同的方式产生一个单位矩阵，留给我们以下等式来估计仪表模型的系数向量<strong class="kx jh"> <em class="lx"> β </em> </strong>:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/55f3ae470c0f9cf866b5f4abe7045d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*MG8F657ekSd6nEqshqCaTA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">计算包含工具变量的回归模型的回归系数的公式(图片由作者提供)</p></figure><p id="d49b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请注意，<strong class="kx jh"> <em class="lx"> Z </em> </strong>、<strong class="kx jh"> <em class="lx"> X </em> </strong>和<strong class="kx jh"> <em class="lx"> y </em> </strong>都是可观测的量，因此只要<strong class="kx jh"><em class="lx">×T41】中的内生变量与<strong class="kx jh"><em class="lx">【Z</em></strong>中选择的工具一一对应，就可以使用等式(6)一次性估计所有回归系数。</em></strong></p><p id="0962" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于等式(6)，还有最后一点必须提及。严格地说，等式(6)仅可渐近估计，即当数据样本的数量<em class="lx"> n → ∞ </em>时。但是在实践中，由于一系列数学原因，我们可以用它来计算一个模型的系数估计值，这个模型是通过IV对有限大小的样本进行估计的，换句话说，是对真实世界的数据集进行估计的。</p><p id="8c53" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，<strong class="kx jh"><em class="lx"/></strong>的有限样本IV估计量<strong class="kx jh"> <em class="lx"> β_cap_IV </em> </strong>可表述如下:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9e2fc1087b4df43fdb95b6600d0978ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*aG20fR8Y3HGMUyzbtgt9RA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">含IVs模型回归系数的有限样本估计量(图片由作者提供)</p></figure><p id="93cf" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，让我们看看内生变量定义了多个工具变量的情况。</p><p id="36fd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">考虑以下工资回归模型:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi my"><img src="../Images/fc8a88d6cf4b630ba17693b568bc8994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Xarm8g_Ebb0ihBvrysNRA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">根据各种变量回归的工资记录(图片由作者提供)</p></figure><p id="a1af" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的模型中，我们回归了<strong class="kx jh"> <em class="lx">工资</em> </strong>的自然对数，而不是原始工资，因为工资数据通常是右偏的，记录它可以减少偏斜。<strong class="kx jh"> <em class="lx">学历</em> </strong>是以受教育年限来衡量的。<strong class="kx jh"> <em class="lx">学院</em> </strong>和<strong class="kx jh"> <em class="lx">城市</em> </strong>是布尔变量，表示这个人是否上过大学，是否居住在一个城市。<strong class="kx jh"> <em class="lx"> Unemp </em> </strong>包含居住县的失业率百分比。</p><p id="3354" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的<strong class="kx jh"> <em class="lx"> X </em> </strong>矩阵是<em class="lx"/><strong class="kx jh"><em class="lx">1</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">年龄</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">经历</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">学院</em></strong><em class="lx"/><strong class="kx jh">城市<em class="lx"/>T53</strong></p><p id="bd45" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们会认为<strong class="kx jh"> <em class="lx">教育</em> </strong>是内生的。因此，学校教育年数只掌握了在学校或大学里教授的内容。它还忽略了一些方面，如这个人对材料的掌握程度，他们对课程之外的主题的了解程度等等，所有这些都没有被观察到，因此在错误术语<strong class="kx jh"><em class="lx"/></strong>中被捕捉到。</p><p id="4da6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将提出两个变量，母亲的受教育年数(<strong class="kx jh"><em class="lx"/></strong>)和父亲的受教育年数(<strong class="kx jh"><em class="lx">feeducation</em></strong>)作为个人的<strong class="kx jh"><em class="lx"/></strong>的IVs。</p><h2 id="8d1c" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">关联性和外生性条件</h2><p id="6d64" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">我们选择的iv需要通过<strong class="kx jh">关联条件</strong>。如果对<strong class="kx jh"> <em class="lx">教育</em> </strong>进行一次回归，对其余变量进行<strong class="kx jh"><em class="lx"/></strong>X<strong class="kx jh"><em class="lx">教育</em> </strong>和<strong class="kx jh"> <em class="lx">教育</em> </strong>揭示(通过一次<a class="ae jd" rel="noopener" target="_blank" href="/fisher-test-for-regression-analysis-1e1687867259"> <strong class="kx jh"> F检验</strong> </a>)即<strong class="kx jh"> <em class="lx">教育</em> </strong>和<strong class="kx jh"> <em class="lx">教育</em></strong></p><p id="b6b7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">误差项<strong class="kx jh"> <em class="lx"> ϵ </em> </strong>本来就是不可观测的。因此不能直接检测IVs的<strong class="kx jh">外源性条件</strong>。相反，我们相信父母的受教育年限不太可能与孩子对材料的掌握等因素相关，即隐藏在错误术语中并使教育成为内生的因素。但是我们可能错了。我们很快就会知道了。</p><h2 id="1ee4" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">包含IVs的回归模型</h2><p id="44a8" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">我们的IVs回归模型如下:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nx"><img src="../Images/18b751c6f20dcb5ee2a9760fd18f4b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kT5VeM07o-NbGCfjN6rxpA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">各种变量的工资回归记录，包括两个变量:教育和非教育(图片由作者提供)</p></figure><p id="b1bd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的<strong class="kx jh"><em class="lx"/></strong>矩阵是<em class="lx"/><strong class="kx jh"><em class="lx">1</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">年龄</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">经验</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">学院</em></strong><em class="lx"/><strong class="kx jh"> 其中每个变量是大小为<em class="lx">【n×1】</em>的列向量，大小为<strong class="kx jh"><em class="lx"/></strong>的列向量是<em class="lx">【n×8】。 注意我们是如何用它的两个IVs取代了education。</em></strong></p><p id="1bae" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并且待估计的系数向量是:</p><p id="0fd9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"><em class="lx">β_ cap _ IV =[</em></strong><em class="lx">β* _ 1 _ cap，β*_2_cap，β*_3_cap，β*_4_cap，β*_5_cap，β*_6_cap，β*_7_cap，β*_8_cap] </em></p><p id="031f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其中大写字母表示估计值。</p><p id="96ef" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">定义了<strong class="kx jh"> <em class="lx"> X </em> </strong>和<strong class="kx jh"> <em class="lx"> Z </em> </strong>之后，是否可以用Eq (6a)对<strong class="kx jh"><em class="lx">β_ cap _ IV</em></strong><em class="lx">进行单次计算？</em></p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9e2fc1087b4df43fdb95b6600d0978ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*aG20fR8Y3HGMUyzbtgt9RA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">含IVs模型回归系数的有限样本估计量(图片由作者提供)</p></figure><p id="1e54" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">很遗憾，答案是，没有。</p><p id="f3ac" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">回想一下ZT3的大小<strong class="kx jh"> <em class="lx">是<em class="lx">【n×8】。</em>所以，<strong class="kx jh"> <em class="lx"> Z' </em> </strong>的大小为<em class="lx">【8 x n】</em>。<strong class="kx jh"> <em class="lx"> X </em> </strong>的大小为<em class="lx">【n X 7】</em>。因此<strong class="kx jh"><em class="lx">Z’x</em></strong>的尺寸<em class="lx">【8×7】</em>不是方阵，因此<strong class="kx jh"> <em class="lx">不可逆</em> </strong>。于是，Eq。(6a)当多个工具变量如<strong class="kx jh"><em class="lx"/></strong><strong class="kx jh"><em class="lx">教育</em> </strong>用于代表单一内生变量如<strong class="kx jh"><em class="lx"/></strong>时，不能使用。</em></strong></p><p id="b687" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个困难建议我们探索一种不同的方法来估计<strong class="kx jh"> <em class="lx"> β_cap_IV。</em> </strong>这种不同的方法是两阶段OLS估计量。</p><h1 id="683e" class="ny na jg bd nb nz oa ob ne oc od oe nh km of kn nk kp og kq nn ks oh kt nq oi bi translated">两步OLS估计量</h1><p id="c37b" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">我们从开发这个估计器的第一阶段开始。</p><h2 id="db73" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">第一阶段</h2><p id="161f" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">在这个阶段，我们将倒退<strong class="kx jh"> <em class="lx">学历</em><em class="lx">年龄</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">阅历</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">学院</em></strong><em class="lx"/><strong class="kx jh"><em class="lx">城市</em> </strong> <em class="lx">，</em></p><p id="525b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设我们已经通过f检验确定<strong class="kx jh"> <em class="lx">教育</em> </strong>确实与IVs <strong class="kx jh"> <em class="lx">教育</em> </strong>和<strong class="kx jh"> <em class="lx">教育</em> </strong>相关。</p><p id="33dd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在将回归<strong class="kx jh"> <em class="lx">教育</em> </strong>不仅关于<strong class="kx jh"> <em class="lx">教育</em> </strong>和<strong class="kx jh"> <em class="lx">教育</em> </strong>而且关于其他变量，这允许我们考虑非IV变量和IV变量之间可能的相关性的影响。参见我之前关于<a class="ae jd" rel="noopener" target="_blank" href="/introduction-to-instrumental-variables-estimation-3eba75a04418">工具变量</a>的文章，了解这种效应的详细解释。</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oj"><img src="../Images/1382994dbe77e092ab6d7ea0531a51a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zsQ2HarlSz8RxqI7Ot5bLQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">教育在<strong class="bd lw"> <em class="ok"> Z </em> </strong>矩阵上退步(图片由作者提供)</p></figure><p id="c6b0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="lx"> ν </em> </strong>是误差项。由于所有回归变量都是外生的，因此可以使用OLS对上述模型进行一致估计。估计模型具有以下形式:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ol"><img src="../Images/dff27369f748f8d225ab3f0720a5e0df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UkBgxnrn6OdU69gbr5BjCQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">拟合模型后教育的估计值，该模型在<strong class="bd lw"> Z </strong>矩阵上回归教育(图片由作者提供)</p></figure><p id="b27f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的等式中，<strong class="kx jh"> <em class="lx"> education_cap </em> </strong>是<strong class="kx jh"> <em class="lx"> education </em> </strong>的估计值(又称预测值)。系数上的上限同样表示估计值。</p><p id="0c20" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上述基于OLS的回归代表了我们即将进行的两阶段OLS (2SLS)估算的第一阶段<strong class="kx jh">。</strong></p><h2 id="aa2c" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">第二阶段</h2><p id="83d7" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated"><em class="lx">关于第一阶段的关键见解是</em><strong class="kx jh"><em class="lx">education _ cap</em></strong><em class="lx">仅包含</em><strong class="kx jh"><em class="lx">education</em></strong><em class="lx">的方差的一部分，即外生的，即与错误项不相关。</em></p><p id="8216" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，我们可以将原模型中的<em class="lx"> ln( </em> <strong class="kx jh"> <em class="lx">工资</em> </strong> <em class="lx"> ) </em>替换为<strong class="kx jh"><em class="lx">education _ cap</em></strong>，形成一个只包含外生回归变量的模型，如下:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi om"><img src="../Images/12387137866774c37a77ebe3345d1c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tIzDR6gfsnXyV2MNISO6w.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd lw">工资</strong>日志在<strong class="bd lw"> X </strong>回归，用其外生部分替换<strong class="bd lw">学历</strong>(图片由作者提供)</p></figure><p id="7e33" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于上述模型仅包含外生回归变量，因此可以使用OLS对其进行一致估计。该估计形成了2级OLS估计器的第二级。</p></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><h1 id="ec17" class="ny na jg bd nb nz ou ob ne oc ov oe nh km ow kn nk kp ox kq nn ks oy kt nq oi bi translated">2sl的总体框架</h1><p id="9ca8" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">对于那些对线性代数有天赋的人来说，2阶段最小二乘法的一般框架如下(如果你愿意，你可以跳过这一节直接进入Python教程2sl):</p><p id="13ed" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们开始第一阶段的工作。</p><h2 id="15e6" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">第一阶段</h2><p id="5e94" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">在第一阶段，我们估计以下模型。为了保持事物的一般性，<strong class="kx jh"> <em class="lx"> X </em> </strong>不仅包含内生教育，还包含其余变量，<strong class="kx jh"> <em class="lx"> γ </em> </strong>是回归系数的向量，<strong class="kx jh"> <em class="lx"> ν </em> </strong>是误差项:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/c854ec9086b0f104f976aae79d2c39f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*BzOutY0qaTKgFN1JTa7GFA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd lw"> X </strong>对<strong class="bd lw"> Z </strong>的线性回归(图片由作者提供)</p></figure><p id="bfd0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="lx"> γ </em> </strong>的最小二乘估计量可以显示为使用基于最小二乘的估计量的标准公式计算如下:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/b683162f998c42af111847004b05e510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*pkOy0uEcDX5BXznMgLn8sg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd lw"> <em class="ok"> γ </em> </strong> <em class="ok">的OLS估计量(图片由作者提供)</em></p></figure><p id="a603" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用<strong class="kx jh"> <em class="lx"> γ </em> </strong> _cap，<strong class="kx jh"> <em class="lx"> X </em> </strong>的估计值由下式给出:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/7b7e3788cfbe670ecd3d7704b429ca82.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*H8icuDW3UghZUaqwYFGp4Q.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">使用估计的<em class="ok">系数</em><strong class="bd lw"><em class="ok">γ</em></strong><em class="ok">_ cap【图片由作者提供】</em>估计<strong class="bd lw"> X </strong></p></figure><p id="74d5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就完成了2-SLS的第一阶段。</p><p id="5e3d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，让我们开始第二阶段的工作。</p><h2 id="eb1e" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">第二阶段</h2><p id="057c" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">让我们回忆一下等式6(a ),它是我们针对<strong class="kx jh"><em class="lx"/></strong>中的内生变量与<strong class="kx jh"><em class="lx"/></strong>中的工具之间存在一一对应关系的情况构建的IV估计量:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9e2fc1087b4df43fdb95b6600d0978ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*aG20fR8Y3HGMUyzbtgt9RA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">含IVs模型回归系数的有限样本估计量(图片由作者提供)</p></figure><p id="3514" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将等式(6c)中的<strong class="kx jh"><em class="lx">X</em></strong><em class="lx">_ cap</em>代入等式(6a)中的<strong class="kx jh"> <em class="lx"> Z </em> </strong>得到<strong class="kx jh"><em class="lx"/></strong><em class="lx">_ cap _ 2 SLS</em>如下:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/a79a0cd77d45836add5e28a498c2f958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*gaFK5ULUNHsJY6wnspV40Q.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">使用2阶段最小二乘法估算的仪器模型的系数(图片由作者提供)</p></figure><p id="4745" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这就完成了2-SLS估计器的公式化。实验者完全可以观察到方程(6b)的R.H.S .上的所有矩阵。系数的估计可以通过简单地按顺序应用等式(6bb)、(6c)和(6d)来实现:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pd"><img src="../Images/ff0e6d20039b6f01441b52c3e9efd586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IOpeJgm24mPyU07nKXwMkw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">二阶段最小二乘估计器(图片由作者提供)</p></figure></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><h1 id="3c6b" class="ny na jg bd nb nz ou ob ne oc ov oe nh km ow kn nk kp ox kq nn ks oy kt nq oi bi translated">使用Python和statsmodels使用2SLS估计线性模型的教程</h1><p id="b9f6" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">我们将使用1976年基于前一年1975年数据的已婚妇女收入动态研究的截面数据。</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pe"><img src="../Images/e0fd413c026cb7bb50d03223308a7e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jKjHucAh6ReOH1GHda77PQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">PSID76数据集(来源:<a class="ae jd" href="https://vincentarelbundock.github.io/Rdatasets/doc/AER/PSID1976.html" rel="noopener ugc nofollow" target="_blank"> R数据集</a>在<a class="ae jd" href="https://vincentarelbundock.github.io/Rdatasets/index.html" rel="noopener ugc nofollow" target="_blank"> GPL v3 </a>下)</p></figure><p id="c0c1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每行包含一个已婚女性参与者的时薪数据和其他变量。数据集包含几个变量。我们感兴趣的问题如下:</p><p id="07e9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lx">工资</em>:1975年平均小时工资<br/> <em class="lx">学历</em>:参与者的受教育年限<br/> <em class="lx">学历</em>:参与者母亲的受教育年限<br/> <em class="lx">学历</em>:参与者父亲的受教育年限<br/> <em class="lx">参与度</em>:个人是否于1975年参加劳动？(1/0).我们只考虑那些在1975年参加的人。</p><p id="b524" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的目标是<strong class="kx jh">估计教育对1975年已婚女性受访者小时工资的影响，具体来说是小时工资的对数</strong>。</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pf"><img src="../Images/c36024880ecc8e6fbab6660a2c2d197e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vgFTugwprQUYcHJb-CANRg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">估计教育对小时工资日志影响的模型(图片由作者提供)</p></figure><p id="3290" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如我们之前看到的，教育是内生的，因此使用OLS的直接估计将产生所有系数的有偏估计。具体来说，OLS对<em class="lx"> β_1 </em>和<em class="lx"> β_2 </em>的估计可能会高估它们的值，也就是说，它会高估教育对时薪的影响。</p><p id="b84b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将尝试通过使用<em class="lx">教育</em>和<em class="lx">教育</em>作为教育的<strong class="kx jh">工具</strong>来补救这种情况。</p><p id="6834" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将使用Python、<a class="ae jd" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>和<a class="ae jd" href="https://www.statsmodels.org/dev/gettingstarted.html" rel="noopener ugc nofollow" target="_blank"> Statsmodels </a>来加载数据集并构建和训练模型。让我们从导入所需的包开始:</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="fa0e" class="mz na jg ph b gy pl pm l pn po"><strong class="ph jh">import </strong>pandas <strong class="ph jh">as </strong>pd<br/><strong class="ph jh">import </strong>numpy <strong class="ph jh">as </strong>np<br/><strong class="ph jh">import </strong>statsmodels.formula.api <strong class="ph jh">as </strong>smf<br/><strong class="ph jh">from</strong> statsmodels.api <strong class="ph jh">import</strong> add_constant<br/><strong class="ph jh">from </strong>statsmodels.sandbox.regression.gmm <strong class="ph jh">import </strong>IV2SLS</span></pre><p id="796e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们将数据集加载到熊猫<code class="fe pp pq pr ph b">Dataframe</code>:</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="9c9a" class="mz na jg ph b gy pl pm l pn po">df = pd.<strong class="ph jh">read_csv</strong>(<strong class="ph jh">'PSID1976.csv'</strong>, <strong class="ph jh">header</strong>=0)</span></pre><p id="e777" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们将使用数据集的一个子集，其中participation=yes。</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="4fbb" class="mz na jg ph b gy pl pm l pn po">df_1975 = df.<strong class="ph jh">query</strong>('participation == \'yes\'')</span></pre><p id="38ac" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们需要验证仪器<em class="lx">教育</em>和<em class="lx">教育</em>满足<strong class="kx jh">相关条件</strong>。为此，我们将对<em class="lx">教育</em>和<em class="lx">教育</em>的<em class="lx">教育</em>进行回归，并使用f检验验证<em class="lx">教育</em>和<em class="lx">教育</em>在此回归中的系数<em class="lx">和</em>共同显著。</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="e5ca" class="mz na jg ph b gy pl pm l pn po">reg_expr = <strong class="ph jh">'education ~ meducation + feducation'</strong></span><span id="99a4" class="mz na jg ph b gy ps pm l pn po">olsr_model = smf.<strong class="ph jh">ols</strong>(<strong class="ph jh">formula</strong>=reg_expr, <strong class="ph jh">data</strong>=df_1975)</span><span id="26d4" class="mz na jg ph b gy ps pm l pn po">olsr_model_results = olsr_model.<strong class="ph jh">fit</strong>()</span><span id="4946" class="mz na jg ph b gy ps pm l pn po"><strong class="ph jh">print</strong>(olsr_model_results.<strong class="ph jh">summary</strong>())</span></pre><p id="6e97" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到以下输出:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pt"><img src="../Images/cf812b9c97a709a04682d46866f93586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRDOuLYDBxBZHLe3GmMw7g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性模型的训练摘要，该模型对教育、教育和常数进行回归(图片由作者提供)</p></figure><p id="768e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lx">教育</em>和<em class="lx">教育</em>的系数在&lt;的p为0.001时各自显著，如其p值基本为零所示。这些系数在p为2.96e-22时也是共同显著的，即&lt; .001。<em class="lx">教育</em>和<em class="lx">教育</em>明显满足<em class="lx">教育</em>的IVs的<strong class="kx jh">关联条件</strong>。</p><p id="3e70" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在将为工资方程建立一个线性模型，并使用statsmodels，我们将使用2SLS估计量来训练该模型。</p><p id="c146" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将从构建设计矩阵开始。因变量为<em class="lx"> ln(工资)</em>:</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="3577" class="mz na jg ph b gy pl pm l pn po">ln_wage = np.<strong class="ph jh">log</strong>(df_1975['<strong class="ph jh">wage</strong>'])</span></pre><p id="9cb9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Statsmodel的IV2SLS估计量定义如下:</p><p id="fb54" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe pp pq pr ph b">statsmodels.sandbox.regression.gmm.IV2SLS(<strong class="kx jh"><em class="lx">endog</em></strong>, <strong class="kx jh"><em class="lx">exog</em></strong>, <strong class="kx jh"><em class="lx">instrument</em></strong><em class="lx">=None</em>)</code></p><p id="8501" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Statsmodels需要以如下特定方式构建<code class="fe pp pq pr ph b"><strong class="kx jh"><em class="lx">endog</em></strong></code>、<code class="fe pp pq pr ph b"><strong class="kx jh"><em class="lx">exog</em></strong></code>和<code class="fe pp pq pr ph b"><strong class="kx jh"><em class="lx">instrument</em></strong></code>矩阵:</p><p id="237b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe pp pq pr ph b"><strong class="kx jh"><em class="lx">endog</em></strong></code>是包含因变量的<em class="lx">【n×1】</em>矩阵。在我们的示例中，它是<em class="lx"> ln_wage </em>变量。</p><p id="4141" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe pp pq pr ph b"><strong class="kx jh"><em class="lx">exog</em></strong></code>是一个<em class="lx">【n x(k+1)】</em>大小的矩阵，它必须包含所有的内生变量和外生变量，加上常数。在我们的例子中，除了常数之外，我们没有在工资方程中定义任何外生变量。所以它看起来像这样:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/ea6f81cd59573e2649e4ade4c342478c.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*j2i-mrYH0XzvwzVpMfKaig.png"/></div></figure><p id="ffec" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe pp pq pr ph b"><strong class="kx jh"><em class="lx">instrument</em></strong></code>是包含工具变量的矩阵。此外，Statsmodels的<code class="fe pp pq pr ph b">IV2SLS</code>估计器要求<code class="fe pp pq pr ph b">instrument</code>也包含<code class="fe pp pq pr ph b">exog</code>矩阵中<em class="lx">未被检测的</em>的所有变量。在我们的例子中，工具变量是<em class="lx">教育</em>和<em class="lx">教育</em>。<code class="fe pp pq pr ph b">exog</code>中的变量是<em class="lx">而不是</em>被检测的，它们只是截距的占位符列。因此，我们的仪器矩阵将如下所示:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/3bd9f755b7583d3973f0c95e4c626b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*xvQHDVMLaCEM-hZ0C5vDyw.png"/></div></figure><p id="8fae" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们构建三个矩阵:</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="52b4" class="mz na jg ph b gy pl pm l pn po">df_1975[<strong class="ph jh">'ln_wage'</strong>] = np.log(df_1975[<strong class="ph jh">'wage'</strong>])</span><span id="5d9b" class="mz na jg ph b gy ps pm l pn po">exog = df_1975[[<strong class="ph jh">'education'</strong>]]<br/>exog = <strong class="ph jh">add_constant</strong>(exog)</span><span id="0aa0" class="mz na jg ph b gy ps pm l pn po">instruments = df_1975[[<strong class="ph jh">'meducation'</strong>, <strong class="ph jh">'feducation'</strong>]]<br/>instruments = <strong class="ph jh">add_constant</strong>(instruments)</span></pre><p id="9547" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们构建并训练<code class="fe pp pq pr ph b">IV2SLS</code>模型:</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="504d" class="mz na jg ph b gy pl pm l pn po">iv2sls_model = <strong class="ph jh">IV2SLS</strong>(<strong class="ph jh">endog</strong>=df_1975[<strong class="ph jh">'ln_wage'</strong>], <strong class="ph jh">exog</strong>=exog, <strong class="ph jh">instrument</strong>=instruments)</span><span id="9fb5" class="mz na jg ph b gy ps pm l pn po">iv2sls_model_results = iv2sls_model.<strong class="ph jh">fit</strong>()</span></pre><p id="e6f9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们打印培训总结:</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="850e" class="mz na jg ph b gy pl pm l pn po"><strong class="ph jh">print</strong>(iv2sls_model_results.<strong class="ph jh">summary</strong>())</span></pre><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pw"><img src="../Images/c494963d17af5f14f3cdfc24b74f6038.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5uAu2KX-ADWcqL4TjKVeQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">2SLS模型的训练总结(图片由作者提供)</p></figure><h2 id="28a2" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">2SLS模型结果的解释</h2><p id="52c4" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">由于我们的主要兴趣是估计教育对小时工资的影响，我们将把注意力集中在教育变量的系数估计上。</p><p id="7b55" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到2SLS模型已经估计出<em class="lx">教育</em>的系数为0.0505，标准差为0.032，95% <a class="ae jd" rel="noopener" target="_blank" href="/interval-estimation-an-overview-and-a-how-to-guide-for-practitioners-e2a0c4bcf108">置信区间</a>为-0.013到0.114。p值为0.117表明显著性为(1–0.117)100% = 88.3%。总的来说，正如2-SLS模型所预期的那样，该模型缺乏精确性。</p><p id="2731" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">注意因变量是<em class="lx"> log </em>(工资)。要计算教育每单位变化(即一年)的小时工资变化率，必须对<em class="lx">教育</em>的系数取指数。</p><p id="cb08" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">e^(0.0505)=1.05179暗示，教育年数每增加一个单位，小时工资估计会增加1.05179美元，反之亦然。</p><h2 id="a4de" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">IV估计量与OLS估计量的比较</h2><p id="fa91" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">让我们比较一下2SLS模型和简单的OLS模型的表现，后者回归了关于教育的log(工资)T1和T2 T3。</p><pre class="ls lt lu lv gt pg ph pi pj aw pk bi"><span id="b958" class="mz na jg ph b gy pl pm l pn po">reg_expr = <strong class="ph jh">'ln_wage ~ education'</strong></span><span id="4604" class="mz na jg ph b gy ps pm l pn po">olsr_model = smf.<strong class="ph jh">ols</strong>(<strong class="ph jh">formula</strong>=reg_expr, <strong class="ph jh">data</strong>=df_1975)</span><span id="625d" class="mz na jg ph b gy ps pm l pn po">olsr_model_results = olsr_model.<strong class="ph jh">fit</strong>()</span><span id="be27" class="mz na jg ph b gy ps pm l pn po"><strong class="ph jh">print</strong>(olsr_model_results.<strong class="ph jh">summary</strong>())</span></pre><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi px"><img src="../Images/85c1d62200d07f4568f5895809728c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KKNlqylsemLWrVgOajwxsQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">OLS模式的培训总结(图片由作者提供)</p></figure><p id="94f0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将关注<em class="lx">教育</em>系数的估计值。0.1086，是2SLS模型报告的估计值的两倍。</p><p id="f733" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">e^(0.1086)=1.11472，这意味着教育年数的单位增加(减少)估计会转化为每小时工资增加(减少)1.11472美元。</p><p id="b9e9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于怀疑教育的内生性，预计OLS的估计值会更高。实际上，根据我们正在建模的情况，我们可能希望接受由2SLS模型报告的更保守的估计值0.0505。然而，(相对于2SLS模型)，OLS模型的系数估计非常显著，p值基本为零。回想一下，来自2SLS模型的估计仅在88%的置信水平下是显著的。</p><p id="48ac" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，(再次如OLS模型所预期的那样)，OLS模型报告的<em class="lx">教育</em>的系数估计值的标准误差(0.014)比2SLS模型的标准误差(0.032)小得多。因此，来自OLS模型的相应的95% ci比由2SLS模型估计的那些要紧密得多。</p><p id="2a89" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了比较，下面是两个模型中<em class="lx">教育</em>和相应95%置信区间的系数估计值:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi py"><img src="../Images/34a86a16dc304b7ab9b02f5311e6f621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gSuycv0ifXxSVxLSTvHyhA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">2sl和OLS模型报告的教育系数估计值的比较(图片由作者提供)</p></figure><blockquote class="pz qa qb"><p id="e57e" class="kv kw lx kx b ky kz kh la lb lc kk ld qc lf lg lh qd lj lk ll qe ln lo lp lq ij bi translated">使用IV估计量，可以用估计精度来换取估计中内生性和随之而来的偏差的消除。</p></blockquote><p id="bb73" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是两个模型估算的<em class="lx">教育</em>的<a class="ae jd" rel="noopener" target="_blank" href="/understanding-partial-effects-main-effects-and-interaction-effects-in-a-regression-model-54e8a127c62d"> <strong class="kx jh">主效应</strong> </a>对时薪的比较:</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/4a25cc521a82bb713f7673187ff83c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*gYLjZjKYJADmum8NNaoL2Q.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">教育对2sl和OLS模型估算的时薪的主要影响的比较(图片由作者提供)</p></figure></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><h1 id="64d6" class="ny na jg bd nb nz ou ob ne oc ov oe nh km ow kn nk kp ox kq nn ks oy kt nq oi bi translated">数据集和教程代码</h1><p id="e08e" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">文章中使用的工资数据集可以通过<a class="ae jd" href="https://vincentarelbundock.github.io/Rdatasets/csv/AER/PSID1976.csv" rel="noopener ugc nofollow" target="_blank">此链接</a>访问。相关文件可以在这里找到。</p><p id="28db" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是本文中显示的完整源代码:</p><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="qg qh l"/></div></figure></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><h1 id="79ac" class="ny na jg bd nb nz ou ob ne oc ov oe nh km ow kn nk kp ox kq nn ks oy kt nq oi bi translated">相关阅读</h1><div class="ip iq gp gr ir qi"><a rel="noopener follow" target="_blank" href="/introduction-to-instrumental-variables-estimation-3eba75a04418"><div class="qj ab fo"><div class="qk ab ql cl cj qm"><h2 class="bd jh gy z fp qn fr fs qo fu fw jf bi translated">工具变量估计导论</h2><div class="qp l"><h3 class="bd b gy z fp qn fr fs qo fu fw dk translated">我们将学习工具变量，以及如何使用它们来估计线性回归模型</h3></div><div class="qq l"><p class="bd b dl z fp qn fr fs qo fu fw dk translated">towardsdatascience.com</p></div></div><div class="qr l"><div class="qs l qt qu qv qr qw ix qi"/></div></div></a></div></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><h1 id="2502" class="ny na jg bd nb nz ou ob ne oc ov oe nh km ow kn nk kp ox kq nn ks oy kt nq oi bi translated">参考文献、引文和版权</h1><h2 id="6e19" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">数据集</h2><p id="bf04" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">劳动力参与数据集是R数据集的一部分。Vincent Arel-Bundock根据<a class="ae jd" href="https://www.r-project.org/Licenses/GPL-3" rel="noopener ugc nofollow" target="_blank"> GPL-3 </a>许可将其作为<a class="ae jd" href="https://vincentarelbundock.github.io/Rdatasets/" rel="noopener ugc nofollow" target="_blank"> Rdatasets </a>包的一部分提供。</p><h2 id="4896" class="mz na jg bd nb nc nd dn ne nf ng dp nh le ni nj nk li nl nm nn lm no np nq nr bi translated">形象</h2><p id="54cc" class="pw-post-body-paragraph kv kw jg kx b ky ns kh la lb nt kk ld le nu lg lh li nv lk ll lm nw lo lp lq ij bi translated">本文中的所有图片版权归<a class="ae jd" href="https://www.linkedin.com/in/sachindate/" rel="noopener ugc nofollow" target="_blank"> Sachin Date </a>所有，版权归<a class="ae jd" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener ugc nofollow" target="_blank"> CC-BY-NC-SA </a>所有，除非图片下面提到了不同的来源和版权。</p></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><p id="7fb0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lx">如果您喜欢这篇文章，请关注我的</em><a class="ae jd" href="https://timeseriesreasoning.medium.com" rel="noopener"><strong class="kx jh"><em class="lx">Sachin Date</em></strong></a><em class="lx">以获得关于回归、时间序列分析和预测主题的提示、操作方法和编程建议。</em></p></div></div>    
</body>
</html>