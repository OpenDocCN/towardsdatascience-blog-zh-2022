<html>
<head>
<title>Run Airbyte Syncs On A Custom Schedule With Crontab And HTTP Requests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Crontab和HTTP请求按照自定义计划运行Airbyte同步</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/run-airbyte-syncs-on-a-custom-schedule-with-crontab-and-http-requests-8d6fbb3ea112#2022-04-23">https://towardsdatascience.com/run-airbyte-syncs-on-a-custom-schedule-with-crontab-and-http-requests-8d6fbb3ea112#2022-04-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0506" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用Airbyte的简单REST API进行复杂配置</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fa9f2b6ce8f56215a4cc99b8cdf2a533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8M2_93JHmYYpC6qu"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@insungyoon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">尹英松</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="b8ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Airbyte是一个神奇的工具，最近在数据工程社区掀起了波澜。这是一个用于运行ELT(提取、加载和转换)过程的开源工具。它是Fivetran等昂贵软件的绝佳替代品，每月可为您的公司节省数千美元。</p><p id="de36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从现在开始，我将假设您对Airbyte的结构以及如何在生产环境中使用它有一定的了解。</p><p id="5a3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Airbyte很棒，但是，就目前的情况来看，Airbyte对连接同步的cron式调度没有一流的支持。这很快就会到来，但还没有完全准备好，我的公司运行的是旧版本的Airbyte，还不需要升级。</p><p id="bf78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当谈到目前的日程安排，有几个选项，如让您的同步运行每分钟，每小时，每天等。，但是如果你想要更具体的东西，或者如果你想自己编排你的同步，在UI中是不可能的，这是大多数用户在大多数情况下与Airbyte交互的方式。</p><p id="53f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是不要害怕！Airbyte不仅提供了一个很好的UI来管理您的ELT过程，而且还提供了一个HTTP REST API，允许您使用POST请求来触发来自外部源的连接。</p><p id="9b4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整的API文档在这里是<a class="ae kv" href="https://airbyte-public-api-docs.s3.us-east-2.amazonaws.com/rapidoc-api-docs.html" rel="noopener ugc nofollow" target="_blank"/>，但是如果你继续读下去，我将向你展示如何使用Crontab和Python来按照你自己的计划运行你的同步。当然，您可以使用任何您喜欢的工具和语言。</p><h1 id="23cb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">⚙️连接到API</h1><p id="5626" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Airbyte公开的所有端点都是POST端点，这使得它非常容易交互。因为Airbyte是容器化的，所以我将假设您正在使用Airbyte附带的所有默认端口，并且您将在同一台机器上运行您的Python脚本。</p><p id="bc16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码非常简单，将使用API同时触发每个启用的连接，但是它应该让您对需要访问的端点有一定的了解。</p><p id="730b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您使用Python，您需要确保安装了<code class="fe mp mq mr ms b">requests</code>模块，然后开始编写一个函数来获取与您的安装相关联的Airbyte工作空间:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5470" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Airbyte中的每个工作区都有多个源、多个目的地和多个连接，这些连接决定了数据从源到目的地的流动。为了触发同步，我们首先必须获得每个工作区的连接列表，然后单独触发每个连接。我们可以通过以下两个函数来实现:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="a50e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们要做的就是把它打包成一个整洁的小包，这样整个程序看起来就像这样:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f443" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是Python的一面。剩下的就是安排这个脚本运行了！</p><h1 id="d3f1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">🕒计划Airbyte同步</h1><p id="5a66" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">同样，您可以使用任何您喜欢的工具，但是我喜欢使用Crontab，因为它简单快捷。将上面的脚本调整为使用Python <code class="fe mp mq mr ms b">schedule</code>包并一直在后台运行也是可行的。</p><p id="59b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您决定只使用Crontab，请确保它安装在您的机器上。我喜欢使用Crontab.guru来确保我会得到我想要的时间表。我不会在这里给出完整的教程，但是如果您想在每小时的早上6点到下午6点之间运行Airbyte同步，您可以使用<code class="fe mp mq mr ms b">crontab -e</code>命令将下面一行插入Crontab:</p><p id="6943" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mp mq mr ms b">00 6-18 * * * python3 force_airbyte_sync.py</code></p><p id="7bc2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保存您的Crontab，并确保使用<code class="fe mp mq mr ms b">crontab -l</code>将其正确插入。然后坐下来，放松，享受在你的英语教学过程中少花50%的钱！</p><p id="14ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这篇文章至少对你们有些人有用！如果你有任何问题，欢迎评论这篇文章或发邮件给我，地址是isaac@isaacharrisholt.com<a class="ae kv" href="mailto:isaac@isaacharrisholt.com" rel="noopener ugc nofollow" target="_blank"/>。我喜欢谈论数据和所有工程方面的东西，所以为什么不开始一个对话呢！</p><p id="ded3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也可以在<a class="ae kv" href="https://github.com/isaacharrisholt/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> GitHub </strong> </a>上找我或者在<a class="ae kv" href="https://www.linkedin.com/in/isaac-harris-holt/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> LinkedIn </strong> </a>上联系我！我喜欢写我的项目，所以你可能也想在<a class="ae kv" href="https://isaacharrisholt.medium.com/" rel="noopener"> <strong class="ky ir"> Medium </strong> </a>上关注我。</p><div class="mv mw gp gr mx my"><a rel="noopener follow" target="_blank" href="/parsing-qif-files-to-retrieve-financial-data-with-python-f599cc0d8c03"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd ir gy z fp nd fr fs ne fu fw ip bi translated">使用Python解析QIF文件以检索金融数据</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">Quiffen包的基本概述以及它如此有用的原因</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm kp my"/></div></div></a></div><p id="d2db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="nn">这一条就这么多了！我希望你喜欢它，任何反馈都非常感谢！</em> </strong></p></div></div>    
</body>
</html>