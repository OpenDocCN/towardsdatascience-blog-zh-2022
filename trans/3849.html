<html>
<head>
<title>Bayesian Conjugate Priors Simply Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">贝叶斯共轭先验简单解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bayesian-conjugate-priors-simply-explained-747218be0f70#2022-08-26">https://towardsdatascience.com/bayesian-conjugate-priors-simply-explained-747218be0f70#2022-08-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5b7a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">执行贝叶斯统计的一种计算有效的方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8f2c57c2a797d39cefbba69230af9db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3InGGHpYM_mqhGf5"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">希瑟·吉尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="0ab2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="9adb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在<a class="ae ky" href="https://en.wikipedia.org/wiki/Bayesian_probability" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">贝叶斯统计</strong> </a>中，<a class="ae ky" href="https://en.wikipedia.org/wiki/Conjugate_prior" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">共轭先验</strong> </a>是当后验和先验分布属于同一分布时。这种现象允许更简单的后验计算，使得<a class="ae ky" href="https://en.wikipedia.org/wiki/Bayesian_inference" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">贝叶斯推断</strong> </a>容易得多。</p><p id="bad4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我们将深入了解共轭先验。我们将展示它的必要性，从基本原理中推导出一个例子，最后将它应用到现实世界的问题中。</p><h1 id="a5dd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">贝叶斯推理概述</h1><h2 id="009a" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">贝叶斯定理</h2><p id="37f4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们快速回顾一下<a class="ae ky" href="https://en.wikipedia.org/wiki/Bayes%27_theorem" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">贝叶斯定理</strong> </a> <strong class="lt iu"> : </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/18feaecf9728b45456c78d0768346a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*RKYfKnmcfWUgTlwlhoonAw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><ul class=""><li id="798b" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated"><strong class="lt iu"><em class="no">P(H):</em></strong><a class="ae ky" href="https://en.wikipedia.org/wiki/Prior_probability" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a><strong class="lt iu">。</strong>假设的概率，<strong class="lt iu"> <em class="no"> H. </em> </strong></li><li id="c0b7" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><strong class="lt iu"><em class="no">P(D | H):</em></strong><a class="ae ky" href="https://en.wikipedia.org/wiki/Likelihood_function" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">可能性</strong> </a> <strong class="lt iu">。</strong>数据的概率，<strong class="lt iu"><em class="no"/></strong>，给定我们当前的假设，<strong class="lt iu"><em class="no"/></strong></li><li id="f391" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><strong class="lt iu"><em class="no">P(H | D):</em></strong><a class="ae ky" href="https://en.wikipedia.org/wiki/Posterior_probability" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">后路</strong> </a>。当前假设的概率，<strong class="lt iu"> <em class="no"> H，</em> </strong>，给定数据，<strong class="lt iu"> <em class="no"> D. </em> </strong></li><li id="d375" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><strong class="lt iu"><em class="no">P(D):</em></strong><a class="ae ky" href="https://en.wikipedia.org/wiki/Normalizing_constant#Bayes'_theorem" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">归一化常数</strong> </a> <strong class="lt iu">。</strong>这个<strong class="lt iu"> </strong>是可能性和先验的乘积之和，也就是所谓的<a class="ae ky" href="https://en.wikipedia.org/wiki/Law_of_total_probability" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">全概率定律</strong> </a>:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/94e7b2033ce34bf81d65ba638d8b364d.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*ICPrrYL6ZbbU4dXaoGnEPg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="372f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想更深入地推导和理解贝叶斯定理，可以在这里查阅我以前的文章:</p><div class="nv nw gp gr nx ny"><a href="https://pub.towardsai.net/conditional-probability-and-bayes-theorem-simply-explained-788a6361f333" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">条件概率和贝叶斯定理浅释</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">条件概率和贝叶斯定理的简单直观的解释。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">pub.towardsai.net</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div><h2 id="735f" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">贝叶斯更新</h2><p id="069c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当我们收到更多关于某个事件的数据时，我们使用贝叶斯定理来更新我们的信念。</p><p id="dea1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一般来说，我们按如下方式进行更新:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/621962575384296a6543142db0a72f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*HBQe1n4WuC1Uvts9vgvsPg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="d341" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，当新数据到达时，后验数据成为新的先验数据。这个过程随着新数据不断重复，因此被称为贝叶斯更新。这就是贝叶斯推理的本质。</p><p id="96a3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以在此阅读有关贝叶斯更新的更多信息:</p><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/bayesian-updating-simply-explained-c2ed3e563588"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">贝叶斯更新简单解释</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">用贝叶斯定理更新信念的直观解释</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="oo l oj ok ol oh om ks ny"/></div></div></a></div><p id="4a0b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，如果我们想要获得有效的概率，我们需要计算<strong class="lt iu"> <em class="no"> P(D) </em> </strong>。如上所示，这是可能性和先验的乘积之和。描述求和的另一种方式是通过积分:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/b98f8d5ecdb0845861836aa96d433dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*WFzP9sQh9c6bbX5CjODjVw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="e213" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这种积分往往是<a class="ae ky" href="https://www.reddit.com/r/askmath/comments/cghi5c/what_is_an_intractable_integral_and_why_this/" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>。这基本上意味着它在计算上非常昂贵，或者它没有一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Closed-form_expression" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">封闭形式的解</strong> </a>。我在这里链接了<a class="ae ky" href="https://stats.stackexchange.com/questions/202917/why-is-computing-the-bayesian-evidence-difficult" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>一个StatExchange线程，解释了为什么它很难处理。</p><h1 id="f242" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">共轭先验</h1><h2 id="b2e1" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">背景</h2><p id="0778" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">共轭先验是避免贝叶斯推理中棘手的积分问题的一种方法。这是当先验分布和后验分布相同时。这允许我们简化计算后验概率的表达式。在下一节中，我们将从数学上展示这一现象。</p><h2 id="55ed" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">二项式和贝塔权变</h2><p id="1fb9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最简单和常见的共轭分布对之一是<a class="ae ky" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>(先验)和<a class="ae ky" href="https://en.wikipedia.org/wiki/Binomial_distribution" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>(似然)。</p><p id="d163" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">贝塔分布</strong>:</p><ul class=""><li id="4977" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated">被称为概率分布的<strong class="lt iu">，因为它的定义域介于0和1之间。</strong></li><li id="a8e0" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated">传达事件成功的最大可能性。</li></ul><p id="4228" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其<a class="ae ky" href="https://en.wikipedia.org/wiki/Probability_density_function" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">概率密度函数</strong> </a> <strong class="lt iu"> (PDF) </strong>写成:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/c10793844421055b5d6288b6297cb5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*hJykSxf84vxF6_v84Lc4zg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="8635" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里<strong class="lt iu"> <em class="no"> x </em> </strong>有界为<strong class="lt iu"> <em class="no"> 0 ≤ x ≤ 1，</em> </strong>所以很容易解释为概率和<strong class="lt iu"> <em class="no"> B(α，β) </em> </strong>是<a class="ae ky" href="https://en.wikipedia.org/wiki/Beta_function" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">β函数</strong> </a> <strong class="lt iu">。</strong></p><p id="f9f0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您想全面了解Beta发行版，您应该浏览一下我以前关于它的文章:</p><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/beta-distribution-simply-explained-839b3acde6e9"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">贝塔分布，简单解释</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">贝塔分布的简明解释。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="or l oj ok ol oh om ks ny"/></div></div></a></div><p id="75c3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">二项分布:</strong></p><ul class=""><li id="e932" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated">传达来自<strong class="lt iu"> <em class="no"> n </em> </strong>试验的一定数量的成功概率<strong class="lt iu"> <em class="no"> k </em> </strong>，其中成功概率为<strong class="lt iu"> <em class="no"> x </em> </strong>。</li></ul><p id="b33a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">PDF:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/03d9dc588928ed988e98ccd44da6b395.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*sdmK7UfFsEAOOBLQpkNeag.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="9a36" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">关键点</strong></p><ul class=""><li id="5524" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated">二项式分布和贝塔分布的主要区别在于，对于贝塔分布来说，<strong class="lt iu">概率、<em class="no"> x </em>、是一个随机变量，而对于二项式分布来说，<strong class="lt iu">概率、<em class="no"> x </em>是一个固定参数。</strong></strong></li></ul><h2 id="42cf" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">与贝叶斯的关系</h2><p id="c035" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在让我们来做一些有趣的数学！</p><p id="b6a2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以使用成功的概率重写贝叶斯定理，<strong class="lt iu"> <em class="no"> x </em> </strong>，对于事件和数据，<strong class="lt iu"> <em class="no"> k </em> </strong>，这是我们观察到的成功次数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/c7adc53dc58d0a1598b04c1b10818f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*t2x0OKwwQLvd9tCZKol_Og.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="6fdd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的后验基本上是成功率所有可能概率的概率分布。换句话说，后验分布是贝塔分布。</p><p id="27dc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以使用二项式分布作为我们的可能性，使用贝塔分布作为我们的先验来表达上面的等式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/dfd484eee7e8b23d2cd4a90efea8b9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*fwZAn6JJrbOKB9jDGPOX5g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="80f1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">是啊，看起来没那么好。然而，我们现在要简化它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/f71ed66236ff6b1c1d1916847e391bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*xNdv9NoHMXXL6UbIb_AkNA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="ea52" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有些人可能会注意到这个积分的特别之处。它的定义是<a class="ae ky" href="https://en.wikipedia.org/wiki/Beta_function" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">贝塔函数</strong> </a> <strong class="lt iu">！</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/dc7f97099df856a25e58e7c2f6769880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*GmaEKH1AlzJjmm3WRmvcjA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><p id="c38b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，我们后路的最终形式是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/dd35a04704f583bf42d6dfc31e6f3cb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*YdiS-w-9dr_bQiopWzCljg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者在LaTeX中生成的方程。</p></figure><blockquote class="oy"><p id="a582" class="oz pa it bd pb pc pd pe pf pg ph mm dk translated">一个测试版！</p></blockquote><p id="508e" class="pw-post-body-paragraph lr ls it lt b lu pi ju lw lx pj jx lz ma pk mc md me pl mg mh mi pm mk ml mm im bi translated">瞧，我们刚刚从β先验到β后验，因此我们有了共轭先验！</p><blockquote class="pn po pp"><p id="031f" class="lr ls no lt b lu mn ju lw lx mo jx lz pq mp mc md pr mq mg mh ps mr mk ml mm im bi translated">如果你对β-二项式共轭先验更感兴趣，有一本很棒的在线书籍深入描述了它们的关系<a class="ae ky" href="https://www.bayesrulesbook.com/chapter-3.html#ch3-bbmodel" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">这里</strong> </a>。</p></blockquote><h2 id="5004" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">为什么有用？</h2><p id="4852" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可能会挠头，想知道为什么我带你经历这个可怕的推导，只是为了得到另一个版本的测试版？</p><p id="d996" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个漂亮的结果告诉我们，要做贝叶斯更新，我们不再需要计算可能性和先验的乘积。正如我前面所讨论的，这在计算上是昂贵的，有时是不可行的。我们现在可以只使用简单的加法！</p><h1 id="d67d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">例如:棒球击球平均数</h1><h2 id="ed26" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">问题背景</h2><p id="579e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在美国职业棒球大联盟(MLB)中，击球手击球的比率除以他们投出的球数被称为平均击球率。<a class="ae ky" href="https://www.baseball-reference.com/leagues/majors/bat.shtml" rel="noopener ugc nofollow" target="_blank">2021年MLB的击球率为0.244 (24.4%) </a>。</p><p id="71f0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一名球员在赛季开始时表现很好，并打出了他的第一个<strong class="lt iu"> 3 </strong>球。他的平均击球率会是多少？一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Frequentist_inference" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">常客</strong> </a>会说是<strong class="lt iu"> 100% </strong>，然而我们贝叶斯人会得出不同的结论。</p><h2 id="7684" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">在先的；在前的</h2><p id="6264" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们知道击球率是0.244，但是可能的取值范围呢？一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Batting_average_(baseball)" rel="noopener ugc nofollow" target="_blank">好的平均值被认为在0.3 </a>左右，这是较高的范围，一个低于<a class="ae ky" href="https://en.wikipedia.org/wiki/Batting_average_(baseball)" rel="noopener ugc nofollow" target="_blank"> 0.2的平均值被认为相当差。</a></p><p id="2e9a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用这些值，我们可以构建一个合适的贝塔先验分布:</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="1bdf" class="ms la it pu b gy py pz l qa qb">from scipy.stats import beta as beta_dist<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="c234" class="ms la it pu b gy qc pz l qa qb">alpha = 49<br/>beta = 151<br/>probability = np.arange (0, 1, 0.001)<br/>prior = beta_dist.pdf(probability, alpha, beta)</span><span id="0f60" class="ms la it pu b gy qc pz l qa qb">plt.figure(figsize=(12,6))<br/>plt.plot(probability, prior, linewidth=3)<br/>plt.xlabel('Batting Average', fontsize=20)<br/>plt.ylabel('PDF', fontsize=20)<br/>plt.xticks(fontsize=18)<br/>plt.yticks(fontsize=18)<br/>plt.axvline(0.244,  linestyle = 'dashed', color='black', label='Average')<br/>plt.legend(fontsize=18)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/48c5fa965a2750a8047b1ceb0eac6a42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLW4ykC-JTUNteI4Qc0dAw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者用Python生成的图。</p></figure><p id="363a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这看起来很合理，因为我们的范围很小，在0.2到0.3之间。我选择<strong class="lt iu"> <em class="no"> α=49 </em> </strong>和<strong class="lt iu"> <em class="no"> β=151，</em> </strong>的值并没有什么特别的原因，它们只是满足了我们对先验分布的了解。</p><p id="f64f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，这往往是反对贝叶斯统计的论点。既然先验是主观的，那么后验也是如此。这意味着概率不再是客观的，而是一种个人信念。</p><h2 id="8d01" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">可能性和后验概率</h2><p id="c0e1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据的可能性是新玩家从<strong class="lt iu"> 3 </strong>击中了<strong class="lt iu"> 3 </strong>，因此他们有额外的<strong class="lt iu"> 3成功</strong>和<strong class="lt iu"> 0失败</strong>。</p><p id="30eb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">利用我们的共轭先验知识，我们可以简单地将一个<strong class="lt iu">额外的3 </strong>加到<strong class="lt iu"> <em class="no"> α </em> </strong>和<strong class="lt iu"> 0 </strong>到<strong class="lt iu"> <em class="no"> β: </em> </strong></p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="cf4b" class="ms la it pu b gy py pz l qa qb">alpha = 49<br/>beta = 151<br/>new_alpha = 49+3<br/>new_beta = 151<br/>probability = np.arange (0, 1, 0.001)<br/>prior = beta_dist.pdf(probability, alpha, beta)<br/>posterior = beta_dist.pdf(probability, new_alpha, new_beta)</span><span id="e9aa" class="ms la it pu b gy qc pz l qa qb">plt.figure(figsize=(12,6))<br/>plt.plot(probability, prior, linewidth=3, label='Prior')<br/>plt.plot(probability, posterior, linewidth=3, label='Posterior')<br/>plt.xlabel('Batting Average', fontsize=20)<br/>plt.ylabel('PDF', fontsize=20)<br/>plt.xticks(fontsize=18)<br/>plt.yticks(fontsize=18)<br/>plt.axvline(0.244,  linestyle = 'dashed', color='black', label='Average')<br/>plt.legend(fontsize=18)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/3852ce6865bd189684b092080b881ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHPQljEFb3O_PpPWsqj6ow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者用Python生成的图。</p></figure><p id="c27a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">三个球并不多，为什么平均值几乎没有变化，这是有道理的。如果我们现在说这名球员从<strong class="lt iu"> 50 </strong>个球中击出了<strong class="lt iu"> 40 </strong>个球，那么他的后路会是什么样子？</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="c6b0" class="ms la it pu b gy py pz l qa qb">alpha = 49<br/>beta = 151<br/>new_alpha = 49+40<br/>new_beta = 151+10<br/>probability = np.arange (0, 1, 0.001)<br/>prior = beta_dist.pdf(probability, alpha, beta)<br/>posterior = beta_dist.pdf(probability, new_alpha, new_beta)</span><span id="7abc" class="ms la it pu b gy qc pz l qa qb">plt.figure(figsize=(12,6))<br/>plt.plot(probability, prior, linewidth=3, label='Prior')<br/>plt.plot(probability, posterior, linewidth=3, label='Posterior')<br/>plt.xlabel('Batting Average', fontsize=20)<br/>plt.ylabel('PDF', fontsize=20)<br/>plt.xticks(fontsize=18)<br/>plt.yticks(fontsize=18)<br/>plt.axvline(0.244,  linestyle = 'dashed', color='black', label='Average')<br/>plt.legend(fontsize=18)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/79548bc646a3c664d62dc59aaa3ef33e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o1UADyXBiSx9J_bYOqYKmQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者用Python生成的图。</p></figure><p id="7310" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们看到了更大的变化，因为我们现在有了更多的数据。</p><h2 id="cd18" class="ms la it bd lb mt mu dn lf mv mw dp lj ma mx my ll me mz na ln mi nb nc lp nd bi translated">没有共轭先验</h2><p id="f36c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果没有共轭先验，我们将不得不使用可能性和先验的乘积来计算后验概率。为了完整起见，我们来看一下这个过程。</p><p id="97ef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将使用一个例子，玩家在50个球中击中了40个。在这种情况下，我们的可能性是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/f739d7cccfd5a8243dba453b6e64669e.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*hWfBC-ogkcM8Zp3jP95vLw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者用Python生成的图。</p></figure><p id="9df3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里我们使用了二项式<strong class="lt iu"/><a class="ae ky" href="https://en.wikipedia.org/wiki/Probability_mass_function" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">【PMF】</strong></a><strong class="lt iu">概率质量函数。</strong></p><p id="1f48" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">执行贝叶斯更新并绘制后验概率图:</p><pre class="kj kk kl km gt pt pu pv pw aw px bi"><span id="fbff" class="ms la it pu b gy py pz l qa qb">alpha = 49<br/>beta = 151</span><span id="d008" class="ms la it pu b gy qc pz l qa qb">probability = np.arange(0, 1, 0.001)<br/>prior = beta_dist.pdf(x, alpha, beta)<br/>likelihood = 10272278170*probability**40*(1-probability)**10<br/>posterior = prior*likelihood<br/>posterior = posterior/sum(posterior)</span><span id="f61e" class="ms la it pu b gy qc pz l qa qb">plt.figure(figsize=(12,6))<br/>plt.plot(probability, posterior, linewidth=3, label='Posterior')<br/>plt.xlabel('Batting Average', fontsize=20)<br/>plt.ylabel('Probability', fontsize=20)<br/>plt.xticks(fontsize=18)<br/>plt.yticks(fontsize=18)<br/>plt.axvline(0.244,  linestyle = 'dashed', color='black', label='Average')<br/>plt.legend(fontsize=18)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/a41597b9807bed1e29894e0d366208a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOUEFqVeFXID4mdU-r7LnA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者用Python生成的图。</p></figure><p id="583f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们到达和以前一样的分布！</p><p id="3723" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">眼尖的你可能会注意到一个不同，y轴是不同的。这与返回PDF的SciPy Beta函数有关，而这里我们使用的是PMF。</p><h1 id="127c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">其他共轭分布</h1><p id="499c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">贝塔二项分布并不是唯一的共轭分布:</p><ul class=""><li id="3293" class="nf ng it lt b lu mn lx mo ma nh me ni mi nj mm nk nl nm nn bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noopener ugc nofollow" target="_blank">贝塔-<strong class="lt iu">伯努利</strong> </a></li><li id="f86a" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Gamma_distribution" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>-<a class="ae ky" href="https://en.wikipedia.org/wiki/Poisson_distribution" rel="noopener ugc nofollow" target="_blank">-<strong class="lt iu">阿松</strong> </a></li><li id="f947" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Dirichlet_distribution" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">狄利克雷</strong></a>-<a class="ae ky" href="https://en.wikipedia.org/wiki/Multinomial_distribution" rel="noopener ugc nofollow" target="_blank">-<strong class="lt iu">多项式</strong> </a></li></ul><p id="ecfd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">仅举几个例子。</p><p id="d19a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可悲的是，并不是所有的问题，事实上很少，都可以用共轭先验来解决。</p><p id="cd1a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，还有更一般的替代方案如<a class="ae ky" href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">马尔可夫链蒙特卡罗</strong> </a> <strong class="lt iu">，</strong>为棘手的积分提供了另一种解决方案。</p><h1 id="a67b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="6c63" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这篇文章中，我们描述了共轭先验如何让我们通过简单的加法计算后验概率。这非常有用，因为它消除了计算可能性和先验的乘积的需要，这可能导致难以处理的积分。</p><p id="dc3b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文中使用的完整代码可以在我的GitHub上找到:</p><div class="nv nw gp gr nx ny"><a href="https://github.com/egorhowell/Medium-Articles/blob/main/Statistics/Conjugate_Priors.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">Medium-Articles/Conjugate _ priors . ipynb at main egorhowell/Medium-Articles</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">我在我的媒体博客/文章中使用的代码。通过创建一个关于…的帐户，为egorhowell/Medium-Articles的开发做出贡献</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">github.com</p></div></div><div class="oh l"><div class="qf l oj ok ol oh om ks ny"/></div></div></a></div><h1 id="e561" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">和我联系！</h1><ul class=""><li id="ca40" class="nf ng it lt b lu lv lx ly ma qg me qh mi qi mm nk nl nm nn bi translated">要在媒体上阅读无限的故事，请务必在此注册！T17<em class="no">T19】💜</em></li><li id="9786" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><a class="ae ky" href="/subscribe/@egorhowell" rel="noopener ugc nofollow" target="_blank"> <em class="no">要想在我发帖注册时得到更新的邮件通知就在这里！</em> </a> <em class="no"> </em>😀</li><li id="b8dc" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><a class="ae ky" href="https://www.linkedin.com/in/egor-howell-092a721b3/" rel="noopener ugc nofollow" target="_blank"><em class="no">LinkedIn</em></a><em class="no"/>👔</li><li id="a7a0" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><a class="ae ky" href="https://twitter.com/EgorHowell" rel="noopener ugc nofollow" target="_blank"> <em class="no">推特</em> </a> <em class="no"> </em> 🖊</li><li id="fb18" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><a class="ae ky" href="https://github.com/egorhowell" rel="noopener ugc nofollow" target="_blank"><em class="no">github</em></a><em class="no"/>🖥</li><li id="87b0" class="nf ng it lt b lu np lx nq ma nr me ns mi nt mm nk nl nm nn bi translated"><a class="ae ky" href="https://www.kaggle.com/egorphysics" rel="noopener ugc nofollow" target="_blank"><em class="no"/></a><em class="no"/>🏅</li></ul><blockquote class="pn po pp"><p id="72f1" class="lr ls no lt b lu mn ju lw lx mo jx lz pq mp mc md pr mq mg mh ps mr mk ml mm im bi translated">(所有表情符号都是由<a class="ae ky" href="https://openmoji.org/" rel="noopener ugc nofollow" target="_blank"> OpenMoji </a>设计的——开源的表情符号和图标项目。许可证:<a class="ae ky" href="https://creativecommons.org/licenses/by-sa/4.0/#" rel="noopener ugc nofollow" target="_blank"> CC BY-SA 4.0 </a></p></blockquote></div></div>    
</body>
</html>