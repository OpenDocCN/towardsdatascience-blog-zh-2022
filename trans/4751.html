<html>
<head>
<title>How to Do an EDA for Time-Series</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对时间序列进行EDA</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-do-an-eda-for-time-series-cbb92b3b1913#2022-10-22">https://towardsdatascience.com/how-to-do-an-eda-for-time-series-cbb92b3b1913#2022-10-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1ec3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">熊猫-剖析时间序列探索性分析</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3fc8e50a5712534f72ffc3bfe50597df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UXtE3lYd-CDw5RHu"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@aronvisuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aron视觉</a>拍摄的照片</p></figure><p id="b21a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据科学开发周期的早期步骤之一是理解和探索您正在解决的问题的数据。EDA是更好的数据科学工作流的关键一步，Pandas profiling是我的首选，它可以用一行代码快速完成，同时为我提供更好地理解数据和发现有意义的见解的输出。</p><p id="85a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能一直在使用Pandas Profiling来分析结构化表格数据，这通常是我们学习探索的第一种数据类型，我们都知道Iris数据集，对吗？然而，在现实世界的应用中，我们在日常生活中经常会发现另一种类型的数据结构:从交通，到我们的日常轨迹，甚至是我们的电力和水消耗，它们都有一个共同点——时间依赖性。</p><p id="4016" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在一个越来越受数据驱动的世界中，时间序列或序列数据已经成为最有价值的商品之一，这使得执行EDA和挖掘时间序列数据成为数据科学从业者迫切需要的技能。</p><p id="2e6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于时间序列数据的性质，当探索数据集时，它的分析类型不同于当数据集记录被认为是全部独立时。随着在同一数据集中增加一个以上的实体，分析的复杂性也随之增加。</p><p id="c96f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇博文中，我将探索数据集分析中的一些关键步骤，同时利用pandas的时间序列特征进行分析。探索的数据集参考了美国<a class="ae kv" href="https://www.epa.gov/outdoor-air-quality-data" rel="noopener ugc nofollow" target="_blank">的空气质量</a>，可以从<a class="ae kv" href="https://www.epa.gov/outdoor-air-quality-data/download-daily-data" rel="noopener ugc nofollow" target="_blank">环保局网站</a>下载。*</p><p id="d712" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整的代码和例子可以在<a class="ae kv" href="https://github.com/ydataai/pandas-profiling/tree/master/examples/usaairquality" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到，所以你可以跟随教程。</p><h1 id="9da3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">分析时序数据集中的多个实体</h1><p id="1cd4" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">数据描述称，这是美国、波多黎各和美属维尔京群岛的户外监测器收集的空气质量数据。有了这些信息，我们知道这是一个多变量时间序列数据，有几个我们需要考虑的实体。</p><p id="138c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">了解这一点后，我有一些后续问题:有多少位置可用于污染物测量？所有传感器在同一时间段内收集的数据量是否相同？收集的度量在时间和位置上是如何分布的？</p><p id="f985" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些问题中的一部分可以很容易地通过热图来回答，热图将所有测量和位置与时间进行比较，如下面的代码片段和图像所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用pandas-profiling生成时间热图的代码</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/695de6f2d3f9204cc0f29f861f24a700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hIUQjQabxDFktWVa"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">美国空气质量数据集热图(图片由作者提供)</p></figure><p id="810f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上图展示了一段时间内每个实体的数据点。我们看到并非所有站点都同时开始收集数据，根据热图的强度，我们可以了解到在给定时间段内，一些站点比其他站点拥有更多的数据点。</p><p id="abae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着在对时间序列建模时，为训练和测试数据集使用动态时间戳可能比使用预先确定的时间戳更好。我们还必须进一步调查丢失的记录和输入记录的范围。</p><p id="710c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了对我们的实体时间分布的基本理解，我们可以开始深入数据分析以获得更多的见解。由于有多个时间序列，让我们来看看每个实体的行为。</p><h1 id="530d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">对时间序列指标的探究</h1><p id="2854" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您已经在使用pandas-profiling，您可能知道如何<a class="ae kv" href="https://pub.towardsai.net/advanced-eda-made-simple-using-pandas-profiling-35f83027061a" rel="noopener ugc nofollow" target="_blank">生成配置文件报告</a>。</p><p id="5473" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以通过传递参数<em class="ms"> tsmode </em> = <strong class="ky ir"> true </strong>来启用对时间序列的支持，并且库将自动识别具有自相关的特征的存在(稍后将详细介绍)。为了让分析正常工作，数据帧需要按照实体列和时间进行排序，否则您总是可以利用<strong class="ky ir"> sortby </strong>参数。</p><p id="fb24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这方面的代码非常简单:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="6183" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是使用时序模式时输出报告的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/4bd57ff0c6abc64faba5ef2b038b4e2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*-VHA-ZVHyCkL0yeB"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">熊猫概况报告的截屏(作者截屏)</p></figure><h2 id="b6ac" class="mu lt iq bd lu mv mw dn ly mx my dp mc lf mz na me lj nb nc mg ln nd ne mi nf bi translated">季节性和不稳定的警报</h2><p id="3727" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">具体到时间序列分析，我们可以发现两个新的警告— <strong class="ky ir">非平稳</strong>和<strong class="ky ir">季节性。</strong>快速掌握你的时间序列的最简单的方法是查看警告部分。对于这个特定的用例，每个配置文件报告将描述每个美国位置在污染物测量方面的特定行为。</p><p id="5f0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是我们报告中的警告:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/754f038de678ac68d4c5f027e4070842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*7hojTc4M_-ASITkG"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">分析中的警报。(作者截屏)</p></figure><p id="eb91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当一个时间序列的统计特性(如均值和方差)在观察时间内不发生变化时，称该时间序列是平稳的。相反，当时间序列的统计特性依赖于时间时，它是非平稳的。例如，具有趋势和季节性的时间序列(稍后将详细介绍)不是静态的，这些现象会影响时间序列在不同时间的值。</p><p id="87e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">平稳过程相对更容易分析，因为时间和变量之间存在静态关系。事实上，平稳已经成为大多数时间序列分析的普遍假设。</p><p id="b68b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然有针对非平稳时间序列的<a class="ae kv" href="https://people.stat.sc.edu/hitchcock/stat520ch5slides.pdf" rel="noopener ugc nofollow" target="_blank">模型，但大多数ML算法确实期望输入特征和输出之间存在静态关系。当时间序列不稳定时，根据数据建模的模型的精度在不同点会有所不同。这意味着建模选择受到时间序列的平稳/非平稳性质的影响，当您想要</a><a class="ae kv" href="https://analyticsindiamag.com/how-to-make-a-time-series-stationary/" rel="noopener ugc nofollow" target="_blank">将时间序列</a>转换成平稳序列时，需要应用不同的数据准备步骤。</p><p id="e45d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，此警报将帮助您识别此类列，并相应地预处理时间序列。</p><p id="0580" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">时间序列中的季节性是一种情况，在这种情况下，数据会经历定期和可预测的变化，这些变化在一个定义的周期内重复出现。这种季节性可能会在时间序列建模时掩盖我们希望建模的信号，甚至更糟的是，它可能会向模型提供一个强烈的信号。此警报可以帮助您识别此类列，并提醒您解决季节性问题。</p><p id="0111" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">关于时间相关特性的更多信息</strong></p><p id="ab5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将注意到的第一个区别是，线形图将取代被标识为依赖于时间的列的直方图。使用线图，我们可以更好地理解所选列的轨迹和性质。对于该NO2均值线图，我们看到轨迹呈下降趋势，具有连续的季节变化，最大值记录在系列的初始阶段。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/08ded07c8ec3afc165bb0c24e2f965d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H5GtbKk7ZDtFbdRh"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">专栏的特征细节(按作者分类的图片)</p></figure><p id="42fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，当我们切换到该列的更多详细信息时(如上图所示)，我们将看到一个带有自相关和偏自相关图的新选项卡。</p><p id="5916" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于时间序列，自相关显示了时间序列在其当前值与其先前值之间的关系。部分自相关是时间序列在去除先前时间滞后的影响后的自相关。这意味着这些图对于提供关于被分析序列的自相关程度以及移动平均程度的信息是至关重要的。</p><p id="092e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的ACF和PACF的情节有点像预期的那样模棱两可。纵观我们的警告，我们可以看到<strong class="ky ir"> NO2意味着</strong>是一个<em class="ms">非平稳的</em>时间变量，这消除了这些图的可解释性。然而，ACF图有助于证实我们已经怀疑的东西——<strong class="ky ir">NO2意味着</strong>是非平稳的——因为ACF图值下降非常缓慢，而不是像平稳序列的情况下预期的那样快速下降到零。</p><p id="7d56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从数据分析中收集的信息、时间序列的性质以及非平稳性和季节性等警报让您能够更好地理解手头的时间序列数据。这并不意味着您已经完成了探索性数据分析，我们的目标是将这些见解作为起点，继续进行深入的数据分析和进一步的数据准备步骤。</p><p id="c497" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过分析空气质量数据集，我们看到几个恒定的列，这些列在建模时可能不会增加太多价值。从缺失值图表中，我们看到SO2和CO2空气质量指数存在缺失数据，我们应进一步探讨这种情况的影响以及插补或完全删除这些列的范围。发现几个列具有非平稳和季节性警报，下一步将是使它们平稳或确保我们将使用的模型能够处理非平稳数据点。</p><p id="0841" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您已经明白了——作为数据科学家，使用分析工具快速获得数据的整体视图(在我们的案例中是时间序列)并进一步检查数据预处理和建模阶段并做出明智的决策是非常重要的。</p><h1 id="cbf3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="179c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">熊猫概况的座右铭一直是一样的:“读数据？暂停。生成Pandas Profiling报告，并检查数据。现在开始清理，重新迭代探索数据。”</p><p id="c841" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然结构化表格数据仍然是数据科学初级阶段最常见的数据，但时间序列数据被广泛使用，并且是许多业务和高级数据驱动解决方案开发的核心。由于时间序列的性质以及记录如何依赖于时间并影响未来事件，数据科学家在探索性数据分析阶段会寻求不同的见解。</p><p id="4276" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，在Pandas Profiling library整合功能以启用时间序列分析模式来揭示这些见解之前，这只是一个时间问题。从用户获取特定于时间序列的分析报告所需的更改，到提示关注特定于时间序列分析的数据、折线图和关联图的新警报的输出，我们在本文中演示了所有内容。</p><p id="4afd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是今天探索的度量和分析仅仅是一个开始！更多的问题有待解答。对你来说，你通常用什么方法分析时间序列数据？使用顺序数据集时，您最怀念的是什么？</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="9276" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">引文:</strong></p><p id="2e8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">“EPA美国环境保护署”(公共领域)【http://www.ics.uci.edu/~mlearn/MLRepository.html T2</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><p id="91bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.linkedin.com/in/fabiana-clemente/" rel="noopener ugc nofollow" target="_blank"> <em class="ms">法比亚娜</em> </a> <em class="ms">是CDO在</em><a class="ae kv" href="https://ydata.ai/?utm_source=medium&amp;utm_medium=signature&amp;utm_campaign=blog" rel="noopener ugc nofollow" target="_blank"><em class="ms">y data</em></a><em class="ms">。</em></p><p id="dc8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">用改进的数据加速AI。</strong></p></div></div>    
</body>
</html>