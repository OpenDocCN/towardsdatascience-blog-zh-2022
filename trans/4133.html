<html>
<head>
<title>I Built A Brain Computer Interface To Play Space Invaders Using Thoughts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我建立了一个脑机接口，用思想来玩太空入侵者</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/i-built-a-brain-computer-interface-to-play-space-invaders-using-thoughts-23980cb4faf7#2022-09-13">https://towardsdatascience.com/i-built-a-brain-computer-interface-to-play-space-invaders-using-thoughts-23980cb4faf7#2022-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fd11" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我将向您解释如何操作，包括Python中的代码示例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/c24f5b0f0d749dc71a7384a6c5a8b13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*N6k1tqi-TeU4pnbpG-MQYQ.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">用我们的BCI系统和g.tec Unicorn EEG设备玩太空入侵者。图片作者。</p></figure><p id="6008" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">想象一下，人们在脊髓损伤导致瘫痪后再次移动他们的手臂，用他们的思想控制机器人手臂。想象一下，人们中风后再次行走，用他们的思想指挥外骨骼。</p><p id="dcc3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有了脑机接口(BCI)，这是可能的。</p><p id="19ac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">瘫痪的人不能移动他们身体的某些部分，但是大脑仍然可以通过运动想象(MI)想象移动这些部分。BCI系统收集这些大脑信号数据，在机器学习(ML)的帮助下，可以预测一个人正在执行的精神任务。</p><p id="34ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些脑机接口可以用来控制外部设备，如外骨骼和机械臂，使瘫痪的人恢复功能，并改善他们的康复[1]。</p><p id="b4cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在过去的6个月里，我为VU的人工智能大师做了我的硕士项目。我学会了编写一个程序，让某人使用MI玩太空入侵者，使用比研究中常用的设备便宜得多的设备来捕捉大脑信号。能够使用独角兽玩太空入侵者游戏是建造更便宜的BCI的第一步，降低了最终被尽可能多的瘫痪者在康复期间使用的门槛。</p><p id="2cb8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我将告诉你我学到的主要概念，包括Python中的代码示例！</p><p id="8fbc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该职位的组织结构如下:</p><ol class=""><li id="10cd" class="lr ls it kw b kx ky la lb ld lt lh lu ll lv lp lw lx ly lz bi translated">简而言之，脑-机接口的6个组成部分是:人、数据收集、预处理、特征提取、预测和输出。</li><li id="eb67" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">人物:运动想象&amp;如何设置你的实验</li><li id="e8ea" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">数据收集:使用哪种设备&amp;如何将数据传输到Python</li><li id="0b7d" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">预处理:陷波滤波器、公共平均参考和伪像检测</li><li id="4b47" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">特征提取:频率滤波和空间滤波</li><li id="9355" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">预测:应用机器学习来获得你的预测</li><li id="88c0" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">输出:使用预测输出作为输入来玩太空入侵者</li></ol><h2 id="75d5" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">脑机接口的6个组成部分</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/d5550a3714c67a0a08ead8d471dd6dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_R-3Rx46D7JZZbBR.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">BCI循环。图片由作者提供，灵感来自[2]。</p></figure><p id="0c8d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">人:</strong>当然，没有人使用这个系统，BCI就不可能存在。这个人执行某种精神任务，如运动想象(MI)，导致特定区域的大脑活动。MI通常用于对健康人进行BCI实验，试图模拟瘫痪的人如何使用该系统。要区分的类别可能是<em class="mz">左臂MI对右臂MI </em>控制机械臂，<em class="mz">腿MI对放松</em>启动和停止外骨骼，或者在我的情况下，<em class="mz">左臂MI对右臂MI对放松</em>玩太空入侵者。</p><p id="eb2b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">数据收集:</strong>当一个人在执行一项脑力任务时，我们需要收集他的大脑活动数据。在这篇文章中，我们主要关注脑电图。脑电图设备的电极被放置在你的头皮上，测量来自电极下区域脑细胞的电活动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/3c20ec6983f79330f0c40204f00429d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v13vF7Z79a869hafuVGJzg.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">3个电极的EEG信号示例。图片作者。</p></figure><p id="3974" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">预处理:</strong>数据采集完成后，需要进行预处理。许多因素会影响EEG信号，并在信号中加入大量噪声。预处理的一般步骤包括去除电力线噪声(来自其它电子器件的噪声)、伪像检测和信号的重新参考。</p><p id="7c7a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">特征提取:</strong>大脑活动以不同的幅度(信号的最大位移)和频率(每秒通过的波数)发生。不同的频段对应不同的精神状态，因为特定频率区间的大脑活动被发现比其他频率区间占主导地位。为了提取与您的任务相关的频带中的特征，需要应用频率过滤。接下来，应用空间滤波。由于EEG设备被放置在你的头皮上，因此远离你的大脑，并使用有限数量的电极来测量你的大脑活动，相关的大脑信号可以传播到几个EEG通道。空间滤波器组合来自几个通道的EEG信号的信息，试图通过收集来自不同通道的相关信息来恢复原始信号。</p><p id="bfb8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">预测:</strong>在特征提取之后，我们得到预测。这就是机器学习模型发挥作用的地方，它试图将数据区分成类别(MI的精神状态)。</p><p id="c9b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">输出:</strong>对于一个实时BCI系统来说，预测并不是最后一步！在在线BCI系统中，预测用于控制一些外部设备。值得注意的是，这种输出反过来会影响这个人的想法和目标，完成这个循环。</p><h2 id="f67e" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">人物:运动想象&amp;如何设置你的实验</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/7a2b66df61c18c16b2f82dabd35164ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*i42tt3vWFtK0qWDf.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">为运动想象收集脑电图数据的典型设置。图片作者。</p></figure><p id="3b6b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然未来的目标是在日常生活中使用脑机接口，但现在它们还不够好，影响性能的因素应该是有限的。想想分心。疲劳。噪音。</p><p id="0703" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一个好的实验设计试图避免这种情况。那么，一个好的BCI实验是什么样的呢？</p><p id="cd77" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上图给出了一个实验中一个循环的概述。我们获取了右臂运动想象(右箭头)、左臂运动想象(左箭头)、腿部运动想象(下箭头)和放松(圆圈)的数据。每次试验，我们有8个循环。每个实验，我们有10个试验。</p><p id="c0c6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们实施了多项措施来避免分心。有一点在上面的概述中看不到，但非常重要，那就是在这个人面前有一张空桌子，只有监视器显示这个实验。在每一个循环的开始，都会出现一个十字，意思是给人一个新任务即将到来的信号，让他们分散注意力集中在屏幕上。</p><p id="ff65" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">执行MI可能很难。尤其是长时间这样做的时候。为了避免疲劳，我们将试验限制在8个循环(3分钟)，每个循环之间有2分钟的休息时间。</p><p id="56cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">EEG数据中的噪声可能由多种因素引起。在概览图中，您可以看到一个名为“ERP”的小模块。这是“事件相关电位”的缩写，是作为感官、认知或运动事件的直接结果，你大脑活动<strong class="kw iu"> </strong>中特有的峰值数量[3]。在我们的实验中，ERP可能是由于任务(认知和运动)的开始和线索(感觉)的消失而启动的。ERP持续大约1秒钟。为了确保我们的数据中没有事件相关电位，我们跳过了运动想象任务的前2秒。</p><p id="fc17" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">噪音的另一个原因是由于肌肉运动。想想眨眼睛，动眼睛，咬紧牙关，或者吞咽。因此，受试者被指示从提示出现的那一刻起直到任务结束尽可能少地眨眼，并在任务过程中避免下巴紧闭、突然的眼球运动和吞咽。</p><h2 id="0a73" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">数据收集:使用哪种设备&amp;如何将数据传输到Python</h2><p id="7d06" class="pw-post-body-paragraph ku kv it kw b kx nf ju kz la ng jx lc ld nh lf lg lh ni lj lk ll nj ln lo lp im bi translated">市场上有各种各样的脑电图设备。直截了当地说，要寻找的最重要的特征是电极的位置！</p><p id="9ec7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了说明这一点，让我谈谈我的两个运动想象项目:一个是去年的失败项目，另一个是我在硕士项目期间做的比较成功的项目。</p><p id="eb3b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">去年夏天，我试图为运动想象预测建立我的第一个BCI项目。对于这个项目，我使用了<a class="ae lq" href="https://choosemuse.com/muse-2/" rel="noopener ugc nofollow" target="_blank">缪斯2 </a>耳机。我一点也不知道，通过选择Muse 2，我几乎不可能成功完成这项任务，甚至在我写任何代码之前！</p><p id="b5d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">负责运动控制的区域位于大脑中央部分的中间，在额叶中被称为运动皮层的区域。为了捕捉这个区域周围的大脑活动，需要在这个区域上方放置电极。10–20国际系统是一个用于电极放置的系统，以确保不同研究之间的放置具有可比性，同时还能识别每个电极捕获的大脑层区域。</p><p id="96b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下图中，我们看到了Muse 2与我今年使用的设备<a class="ae lq" href="https://www.unicorn-bi.com/" rel="noopener ugc nofollow" target="_blank"> g.tec Unicorn </a>的电极放置。可以清楚地看到，Muse 2的电极没有覆盖运动皮层，而Unicorn在该区域有3个电极！这似乎更有希望。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nk"><img src="../Images/042b42ac2b9c536b2b40c1cd0fb99320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDpY6tDeQNGPyK7A1dJO9g.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">Muse 2(左)和g.tec Unicorn(右)的电极位置。红色突出显示的区域包含放置在运动皮层上方的电极。图片由作者提供，灵感来自[4]。</p></figure><p id="1ba7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过使用<a class="ae lq" href="https://github.com/chkothe/pylsl" rel="noopener ugc nofollow" target="_blank"> PyLSL </a>，将数据流式传输到Python实际上非常容易，PyLSL 是实验室流式传输层(LSL)的Python接口。Unicorn套件软件提供了一个扩展，Unicorn LSL接口，您可以使用它从Unicorn获取数据并将其转发给LSL。</p><p id="aeb7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">将您的Unicorn连接到Unicorn套件:</strong>我们首先需要将Unicorn设备连接到Unicorn套件软件。关于这一点，g.tec实际上提供了一些非常方便的<a class="ae lq" href="https://www.youtube.com/watch?v=LOfIr2F7-Tc&amp;t=361s" rel="noopener ugc nofollow" target="_blank"> YouTube教程</a>。成功后，让我们进入第2步！</p><p id="ace5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">将Unicorn连接到LSL接口:</strong>在Unicorn Suite软件中，进入<em class="mz"> DevTools &gt; LSL接口&gt;打开。</em>然后，启动UnicornLSL可执行文件，您的Unicorn设备应该显示为可用设备。然后，只需打开流，并按下开始。现在，你的独角兽正在向你的笔记本电脑传输数据。现在我们需要编写一些Python代码来收集这些数据！</p><p id="d617" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">写一个Python脚本:</strong>首先我们只需要安装pylsl和pandas包。然后，我们写下面的小Python脚本，就万事俱备了！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="dcd2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">由于我们正在构建实时BCI，我们还需要将数据分割成更小的部分；这些段就是我们的数据点，用作管道的输入。后来，当使用该系统进行实时预测时，我们向系统提供一个2秒的片段。</p><p id="fabf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">观察力敏锐的读者现在会注意到，我们的系统实际上不是实时的，而是有2秒的延迟。然而，实时听起来比几乎实时更酷。所以，请原谅我；)</p><p id="9078" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">补充一点，如果你不能自己收集数据，获得开源EEG数据的最佳在线资源是<strong class="kw iu"> MOABB:所有BCI基准之母</strong>。MOABB是一个开放的科学项目，旨在建立一个应用于免费脑电图数据集的流行BCI算法的基准。代码可以在<a class="ae lq" href="https://github.com/NeuroTechX/moabb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到，也可以在<a class="ae lq" href="https://neurotechx.github.io/moabb/" rel="noopener ugc nofollow" target="_blank">文档</a>上找到。</p><h2 id="3a8e" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">预处理:陷波滤波器、公共平均参考和伪像检测</h2><p id="c5f7" class="pw-post-body-paragraph ku kv it kw b kx nf ju kz la ng jx lc ld nh lf lg lh ni lj lk ll nj ln lo lp im bi translated">现在我们有了数据，我们可以应用预处理来清理我们的数据，以便进行下一步。这包括3个步骤:使用陷波滤波器的电力线噪声滤波、公共平均参考(CAR)和伪像检测。</p><p id="a20a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">脑电图检测房间里各种电子设备的噪音。因此，我们需要用陷波滤波器去除电力线的频率。在欧洲，这是在50赫兹，而在美国，这是在60赫兹。大多数EEG设备都有内置的模拟电力线噪声滤波器，如果没有，这就是如何在Python中以数字方式应用电力线噪声滤波器。</p><p id="139c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，可以应用伪影检测。已经基于对片段的统计分析实现了自动伪影去除[5]。当试验的功率、标准偏差或振幅比所有片段的平均信号值高2.5倍时，该片段被认为包含伪影，并且这样的片段被拒绝。这种统计方法已在后来的研究中进行了调整，稍作修改，通过只分析当前段而不是所有段来处理实时实验[6]。当段的绝对幅度超过125 μV时，或者当段的峰度超过段的标准偏差四倍时，段将被丢弃。作者声称该方法是成功的，尽管没有提供该方法与其他伪影去除方法之间的比较。由于该方法的简单性，与更高级的算法相比，另一个好处是处理时间短，使其适合于实时处理。其他方法的处理时间可能需要更多时间，这可能成为实时处理的瓶颈。</p><p id="6f1a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，汽车可以应用[7]。汽车可以被描述为一个简单的空间噪声过滤器。CAR的工作原理是计算每个时间点所有EEG通道的平均信号值，然后将这个值从每个EEG通道的值中减去。这里，目标是减少所有通道中存在的一般噪声，以便改善每个单独EEG电极下的大脑区域的通常微弱的特定信号分量。</p><p id="7b4e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对预处理步骤进行编码的过程如下。将我们的脑电图数据放在熊猫数据帧中(时间点，通道)，代码将是:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="6555" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated"><strong class="ak">特征提取:频率滤波&amp;空间滤波</strong></h2><p id="f346" class="pw-post-body-paragraph ku kv it kw b kx nf ju kz la ng jx lc ld nh lf lg lh ni lj lk ll nj ln lo lp im bi translated">为了解释为什么我们应用频率和空间滤波进行特征提取，让我们首先解释在运动想象期间大脑中发生了什么。</p><p id="1f4c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">运动想象通过所谓的事件相关同步(ERS)和事件相关去同步(ERD)引起大脑活动的变化。在某一频带内EEG信号功率的增加称为ERS，EEG信号功率的减少称为ERD [8]。例如，右臂MI将导致运动皮层(即左运动皮层)中的对侧ERD，并在MI结束后立即导致ERS。对于左臂MI，这适用于右运动皮层。</p><p id="b68d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">频带滤波给出了表示在特定时间窗口内给定频带的EEG数据的功率(能量)的特征。MI期间信号功率的变化在8至24 Hz频带附近最为显著。然而，最显著的MI信号的频率因受试者而异。为了从所有受试者的MI中广泛捕获相关的EEG信号，研究人员通常为MI-BCI设计4到40 Hz之间的频谱滤波器。</p><p id="85fd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Python中的频率滤波可以按如下方式完成:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="0a29" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">观察2秒钟的片段，我们可以清楚地看到信号的差异:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nn"><img src="../Images/80e4f9a34398bda72ff5df19f0f1a5f1.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dP8H60zZDDsWdq9ii6zEZg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">频率滤波前(左)和后(右)2秒的EEG片段。图片作者。</p></figure><p id="073c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了揭示信号的位置，我们使用空间滤波。脑电图的空间分辨率<br/>很差，潜在的大脑信号可以分散在几个脑电图通道周围。空间滤波器通常使用加权线性组合来组合来自几个通道的EEG信号的信息。因此，空间滤波可以通过收集分布在不同信道上的相关信息来恢复原始信号。两种常用的空间滤波方法是公共空间模式滤波器(CSP)和黎曼几何(RG) [9，10]。在这篇文章中，我们不会深入探讨这些方法，但是会提供代码，以便您可以应用它们。</p><p id="2e03" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">用于空间过滤的代码将与机器学习模型的代码一起提供，因为scikit-learn和附加包使得将两者结合起来非常容易！</p><h2 id="8ac4" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">预测:应用机器学习来获得你的预测</h2><p id="dfe6" class="pw-post-body-paragraph ku kv it kw b kx nf ju kz la ng jx lc ld nh lf lg lh ni lj lk ll nj ln lo lp im bi translated">在空间滤波之后，MI-BCI管道中的下一步是使用机器学习(ML)对MI状态进行分类。</p><p id="fe6c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">由于在应用CSP或RG后，数据已经被大量处理，因此通常应用传统的线性ML算法，如线性判别分析(LDA)、支持向量机(SVM)或更复杂的算法，如随机森林(RF)。</p><p id="d7a8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在编写代码之前，我们先来讨论一下数据格式。我们的数据本质上是一个3D数组，具有(通道、时间点)格式的多个分段。Scikit-learn喜欢使用Numpy数组。为此，Numpy函数<em class="mz">栈</em>可以派上用场<em class="mz">。</em></p><blockquote class="no np nq"><p id="0dd9" class="ku kv mz kw b kx ky ju kz la lb jx lc nr le lf lg ns li lj lk nt lm ln lo lp im bi translated"><a class="ae lq" href="https://numpy.org/doc/stable/reference/generated/numpy.stack.html" rel="noopener ugc nofollow" target="_blank"> np.stack </a>:沿着一个新轴加入一系列数组。</p></blockquote><p id="e382" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，通过将我们的片段(每个片段是一个np.array(通道，时间点))放入一个列表或数组中，我们可以使用np.stack来获得我们的3D数组。</p><p id="199f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要应用CSP，我们需要安装MNE库。然后，我们从mne.decoding导入CSP。</p><blockquote class="no np nq"><p id="dd5e" class="ku kv mz kw b kx ky ju kz la lb jx lc nr le lf lg ns li lj lk nt lm ln lo lp im bi translated">MNE-Python :开源Python包，用于探索、可视化和分析人类神经生理数据:脑磁图、脑电图、视觉诱发电位、ECoG、NIRS等等。</p></blockquote><p id="869e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">关于黎曼几何，已经开发了一个名为PyRiemann的库。</p><blockquote class="no np nq"><p id="c0d0" class="ku kv mz kw b kx ky ju kz la lb jx lc nr le lf lg ns li lj lk nt lm ln lo lp im bi translated"><a class="ae lq" href="https://github.com/pyRiemann/pyRiemann" rel="noopener ugc nofollow" target="_blank"> PyRiemann </a>:基于<a class="ae lq" href="http://scikit-learn.org/stable/modules/classes.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a> API的Python机器学习包。它通过对称正定(SPD)矩阵的黎曼几何为多元时间序列的处理和分类提供了一个高级接口。</p></blockquote><p id="fd92" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，我们可以使用scikit-learn函数<a class="ae lq" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank"><em class="mz">Pipeline</em></a><em class="mz"/>和scikit-learn提供的ML模型将所有内容整齐地缝合在一起，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="75e9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如您所见，代码本质上只有3行:管道初始化、拟合和预测。那相当容易！</p><h2 id="191e" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">输出:使用预测输出作为输入来玩太空入侵者</h2><p id="0da0" class="pw-post-body-paragraph ku kv it kw b kx nf ju kz la ng jx lc ld nh lf lg lh ni lj lk ll nj ln lo lp im bi translated">我们做到了！我们现在有了一个关于执行哪种运动想象的预测。剩下的唯一事情就是将这个预测转化为太空入侵者游戏中的一步棋。我发现最简单的方法是写一个Python脚本，根据预测按下键盘上的某些键。</p><p id="fb31" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为此，我们运行两个Python脚本:一个运行太空入侵者游戏。我用PyGame做这个。另一个用于捕获数据，对于每两秒钟的片段，应用预处理、特征提取，用ML得到我们的预测，最后按下对应于预测的键盘按键。左臂运动想象会让玩家向左移动，右臂运动想象向右，放松会射出子弹！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="ff8d" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">结论</h2><p id="4e9b" class="pw-post-body-paragraph ku kv it kw b kx nf ju kz la ng jx lc ld nh lf lg lh ni lj lk ll nj ln lo lp im bi translated">在这篇文章中，我们回顾了建造一个性能良好的BCI来玩太空入侵者的所有步骤。我们讨论了如何建立BCI实验，如何使用g.tec Unicorn收集数据，如何预处理这些数据，提取特征，并进行预测。最后，我们看了如何将所有这些与太空入侵者的游戏结合起来。</p><p id="8798" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章的最后，我想指出一个事实，即我们所讨论的BCI系统在开发时需要非常小心和遵守安全协议。虽然脑机接口对于运动障碍者通过外骨骼控制重新获得自主能力有很大的积极意义，但在特定情况下，系统故障和错误可能会危及这些系统用户的生命。例如，当一个人过马路时，基于EEG的外骨骼发生故障可能会导致事故，而外骨骼的意外移动可能会造成伤害。在日常生活中实施这种BCI系统也引起了数据收集的问题，因为数据将在日常活动的全过程中被收集，引起了隐私问题。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/c24f5b0f0d749dc71a7384a6c5a8b13b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*N6k1tqi-TeU4pnbpG-MQYQ.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">用我们的BCI系统和g.tec Unicorn EEG设备玩太空入侵者。图片作者。</p></figure><p id="1014" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">关于这篇文章中讨论的每个步骤的更多细节，读者可以参考包含每个步骤的单独文章的出版物。</p><p id="a333" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里有各种代码片段，目的是让你一步一步地理解理论和代码。如果你想更深入地研究代码，我的项目的完整资源库可以在GitHub <a class="ae lq" href="https://github.com/Timm877/BCI_upper_limb_MI/tree/main/scripts/realtime_exp" rel="noopener ugc nofollow" target="_blank">这里</a>找到。在知识库中，还可以看到已经应用了带有迁移学习的深度学习。为了保证这篇文章篇幅有限，我就不深究这个话题了。然而，如果你对我如何应用深度迁移学习感兴趣，我很乐意向你推荐<a class="ae lq" href="https://medium.com/@timdb877/convolutional-neural-networks-for-eeg-brain-computer-interfaces-9ee9f3dd2b81" rel="noopener">我的另一篇文章</a>解释BCIs的卷积神经网络。</p><p id="25b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢您的阅读，祝您在脑机接口领域的旅程中好运！</p><h2 id="8cd6" class="mf mg it bd mh mi mj dn mk ml mm dp mn ld mo mp mq lh mr ms mt ll mu mv mw mx bi translated">参考</h2><p id="3a8a" class="pw-post-body-paragraph ku kv it kw b kx nf ju kz la ng jx lc ld nh lf lg lh ni lj lk ll nj ln lo lp im bi translated">[1]刘静怡，穆罕默德阿卜杜勒巴尔，和约翰H池。<a class="ae lq" href="https://pubmed.ncbi.nlm.nih.gov/27861407/" rel="noopener ugc nofollow" target="_blank">采用基于脑机接口的步态方案进行长期训练可使截瘫患者获得部分神经功能恢复</a>。神经外科，79(6):N13–N14，2016。</p><p id="00db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[2] Marcel Van Gerven，Jason Farquhar，Rebecca Schaefer，Rutger Vlek，耶鲁安Geuze，Anton Nijholt，Nick Ramsey，Pim Haselager，Louis Vuurpijl，Stan Gielen，et al. <a class="ae lq" href="https://pubmed.ncbi.nlm.nih.gov/19622847/" rel="noopener ugc nofollow" target="_blank">脑-机接口循环</a>。神经工程杂志，6(4):041001，2009。</p><p id="3d42" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[3]史蒂文·J·勒克。<a class="ae lq" href="https://mitpress.mit.edu/9780262525855/an-introduction-to-the-event-related-potential-technique/" rel="noopener ugc nofollow" target="_blank">事件相关电位技术简介</a>。麻省理工学院出版社，2014。</p><p id="fb75" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[4] Piotr Szczuko。<a class="ae lq" href="https://link.springer.com/article/10.1007/s11042-017-4458-7" rel="noopener ugc nofollow" target="_blank">面向多媒体应用的基于粗糙集分析的脑电信号实部和虚部运动分类。</a>多媒体工具与应用，76(24):25697-25711，2017。</p><p id="4b5e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[5] Eduardo López-Larraz、Fernando Trincado-Alonso、Vijaykumar Rajasekaran、苏拉娅·佩雷斯-Nombela、Antonio J . Del-Ama、Joan Aranda、Javier明格斯、Angel Gil-阿古多和Luis Montesano。<a class="ae lq" href="https://pubmed.ncbi.nlm.nih.gov/27536214/" rel="noopener ugc nofollow" target="_blank">带脑机接口的移动外骨骼控制，用于脊髓损伤步态康复</a>。神经科学前沿，10:359，2016。</p><p id="7f2b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[6] Andreas Schwarz，Patrick Ofner，Joana Pereira，Andreea Ioana斯布利亚，Gernot Rüller-Putz。<a class="ae lq" href="https://pubmed.ncbi.nlm.nih.gov/28853420/" rel="noopener ugc nofollow" target="_blank">从人体脑电图中解码自然的伸手抓握动作</a>。神经工程杂志，15(1):016005，2017。</p><p id="5d1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[7] Kip A Ludwig，Rachel M Miriani，Nicholas B Langhals，Michael D Joseph，David J Anderson和Daryl R Kipke。<a class="ae lq" href="https://journals.physiology.org/doi/full/10.1152/jn.90989.2008" rel="noopener ugc nofollow" target="_blank">使用共同平均参考值改善来自微电极阵列的皮质神经元记录。</a>神经生理学杂志，101(3):1679-1689，2009。</p><p id="e8c5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[8] Gert Pfurtscheller和FH Lopes Da Silva。<a class="ae lq" href="https://pubmed.ncbi.nlm.nih.gov/10576479/" rel="noopener ugc nofollow" target="_blank">事件相关脑电图/脑磁图同步化和去同步化:基本原理。</a>临床神经生理学，110(11):1842-1857，1999。</p><p id="665f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[9]凯坑昂，钦，王传初，崔存泰，张海红.<a class="ae lq" href="https://www.frontiersin.org/articles/10.3389/fnins.2012.00039/full" rel="noopener ugc nofollow" target="_blank">BCI竞争iv数据集2a和2b上的滤波器组公共空间模式算法</a>。神经科学前沿，6:39，2012。</p><p id="6121" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[10] Alexandre Barachant、Stéphane Bonnet、Marco Congedo和Christian Jutten。利用黎曼几何进行多类脑-计算机接口分类。2012年IEEE生物医学工程汇刊，59(4):920–928。</p></div></div>    
</body>
</html>