<html>
<head>
<title>Songs to Playlist Classification Using NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 NLP 将歌曲分类到播放列表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/songs-to-playlist-classification-using-nlp-1821c66b1a16#2022-11-23">https://towardsdatascience.com/songs-to-playlist-classification-using-nlp-1821c66b1a16#2022-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="56fc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 word2vec 和逻辑回归将新歌曲分配到 Spotify 播放列表的指导方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/749a45d4021eb4b348d3de3fa40ada2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QbZGx3yIOAWQhpMI"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@othentikisra?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> israel palacio </a>拍摄</p></figure><p id="30f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文将介绍一个 NLP 项目，旨在将歌曲分配到播放列表。</p><p id="4bf0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">已经从 Spotify 中选择了两个播放列表，并且通过 Spotify API 选择了诸如艺术家、歌曲标题、流行度等信息。已下载。歌词数据不是通过 API 获得的，而是通过网络搜集获得的。</p><p id="a18b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，对原始歌词执行一些数据预处理步骤，以便训练 Word2Vec 模型并将文本编码成高维向量。</p><p id="a261" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用 PCA 生成每个播放列表的 2D 表示，并且我们最终使用新歌来完成播放列表分配的任务。这个任务是通过一个逻辑回归模型解决，并给出了一个图形表示。</p><p id="6cf2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是所用方法的概述:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/9ab92f5f40736afcce1fe8a2b809e6d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5RvN7cwW7eLdunydVB2yDQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="564d" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">目录:</h1><p id="9ac4" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><a class="ae kv" href="#43c0" rel="noopener ugc nofollow"> 1 —数据</a> <br/> <a class="ae kv" href="#56d0" rel="noopener ugc nofollow"> 1.1 —使用 Spotify API </a> <br/> <a class="ae kv" href="#778c" rel="noopener ugc nofollow">下载播放列表信息 1.2 —抓取歌词</a> <br/> <a class="ae kv" href="#778c" rel="noopener ugc nofollow"> 1.3 —数据预处理</a> <br/> <a class="ae kv" href="#1d72" rel="noopener ugc nofollow"> 1.4 —播放列表概述与世界云</a> <br/> <a class="ae kv" href="#20f3" rel="noopener ugc nofollow"> 2 —歌词嵌入</a> <br/> <a class="ae kv" href="#be15" rel="noopener ugc nofollow"> 2.1 — Word2Vec 模型概述</a> <br/> <a class="ae kv" href="#31d3" rel="noopener ugc nofollow"> 2.2 <br/> </a><a class="ae kv" href="#8384" rel="noopener ugc nofollow"> 3.2 —绘制播放列表质心</a> <br/> <a class="ae kv" href="#7935" rel="noopener ugc nofollow"> 3.3 —用逻辑回归进行歌曲分类</a> <br/> <a class="ae kv" href="#788e" rel="noopener ugc nofollow"> 4 —结论</a> <br/> <a class="ae kv" href="#8551" rel="noopener ugc nofollow">参考文献</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="43c0" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">1.数据</h1><p id="6aa4" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这篇文章是基于这两个 Spotify 播放列表上的歌曲歌词:</p><ul class=""><li id="2a2d" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">第一个是<a class="ae kv" href="https://open.spotify.com/playlist/37i9dQZEVXbMDoHDwVN2tF" rel="noopener ugc nofollow" target="_blank">全球播放列表</a>，其中包括全平台用户收听的前 50 首歌曲。播放列表每天更新，通常包括流行歌曲。</li><li id="cdf1" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">第二个播放列表是<a class="ae kv" href="https://open.spotify.com/playlist/37i9dQZF1EQpgT26jgbgRI" rel="noopener ugc nofollow" target="_blank">金属混音</a>，包括排名前 50 的金属歌曲</li></ul><p id="7485" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">两个播放列表的音乐流派似乎相当“遥远”:让我们验证这个“距离”是否也存在于我们将使用 NLP 模型获得的向量中，并让我们确认这是否将帮助我们完成播放列表分配任务。</p><h2 id="56d0" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">1.1 使用 Spotify API 下载播放列表信息</h2><p id="5431" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">为了使用 Spotify API，首先，我们应该在 https://developer.spotify.com/的<a class="ae kv" href="https://developer.spotify.com/" rel="noopener ugc nofollow" target="_blank">上创建一个开发者账户，并创建一个新的应用程序。</a></p><p id="cd9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，通过点击我们的应用程序，我们可以获得:</p><ul class=""><li id="9ac5" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">客户端 ID</li><li id="8f30" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">客户机密</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/279fde7550d3cbaf52289b3c06117984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*j5HXtlq08LuveW-WF15zDQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="dc57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了以上信息，我们可以连接到 API:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="a75d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，通过传递播放列表 id(我们可以从 Spotify 上的 URL 获得)，我们可以开发一个函数来获得我们想要的信息，具体来说就是:艺术家、标题、专辑、流行度。</p><p id="f367" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">(类型是手动创建的字段，用于区分两个播放列表)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/a8c19fd6c7cc930cf7496fe57c356d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GJcZKI1o49HEGewap-CKxQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="778c" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">1.2 刮歌歌词</h2><p id="c784" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在撰写本文时，Spotify API 不允许提取歌词。然而，通过艺术家和标题，我们可以执行一些网络搜集来获得歌词。</p><p id="2872" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此开发的代码相当长，超出了本文的范围。我创建了一个关于网络抓取的教程，我在这里引用了<a class="ae kv" href="https://medium.com/@gabri-albini/python-webscraping-best-practices-for-an-efficient-but-safe-respectful-web-scraping-171c4a474806" rel="noopener"/>。</p><p id="102e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完成这一步后，数据最终看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/fb24476ec6a4989b74a1e99ebd5198d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*taDUeOAWtsvWg8Sz7Oy_aw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="d550" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">文章中使用的数据已经上传到这个<a class="ae kv" href="https://github.com/gabri-al/Spotify-Playlist-Representation" rel="noopener ugc nofollow" target="_blank"> github 库</a>上。</p><h2 id="2c9b" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">1.3 数据预处理</h2><p id="0a25" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们的目标是使用 Word2Vec 模型将单词嵌入到向量中。</p><p id="ce90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了做到这一点，我们将继续下面的步骤，以便原始文本可以被清理并转换成模型可以使用的格式:</p><ul class=""><li id="a070" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">删除无用的行(如歌词中的“重复行”、“合唱”)数字、符号</li><li id="285a" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">降低每个单词</li><li id="9627" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">单词词条化:我们更喜欢词条化而不是词干化。这两种技术在项目中给出了非常相似的结果，但是词干化会截断单词，词汇化会将单词转换成一种常见的“基本”形式，从而给出更具可读性的结果。例如，单词“caring”将通过词干化被截断为“car ”,但通过词汇化被转换为“care”</li><li id="8271" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">(此处保留了通常在 NLP 预处理步骤中消除的停用词。删除它们并没有改善这个项目的结果——可能是因为词汇表不是很大，Word2Vec 模型可以在上下文评估中使用它们)</li><li id="a2ff" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">(最后，单词标记化将在模型训练时执行)</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="49a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这些步骤之后，每首歌曲都被转换成一个列表，每个列表元素都是一行歌曲:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/840c9af417b499b42b792fa12ec9f741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xew1SxWJRVI0F418S_3f2w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="1d72" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">1.4 世界云播放列表概述</h2><p id="7518" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">现在，我们将通过生成两个世界云图来初步了解这些数据，每个播放列表一个。</p><p id="41df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了产生下面的图像，所有歌曲的歌词被合并成两个变量，每个播放列表一个，然后使用遮罩生成世界云。</p><p id="9ae4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些图表基于单词在每个播放列表中的出现次数，突出显示出现次数最多的单词:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/983cad5a77e61f4253ef36daea955b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*0H84Q-yFJjrM2Ywqx-rbFA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">金属播放列表|作者图片</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/b09dc897bc81d6e32cd7a33559d500f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*84LYsqRpUAuTGZoiDwMhtw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">全球 plyalist |作者图片</p></figure><h1 id="20fe" class="ma mb iq bd mc md of mf mg mh og mj mk jw oh jx mm jz oi ka mo kc oj kd mq mr bi translated">2.歌词嵌入</h1><p id="9f3e" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">为了训练一个能够将新歌曲分配到播放列表的模型，我们需要将歌词嵌入到向量中。</p><p id="c18e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有几种策略可以做到这一点，这些策略可以分为两类:</p><ol class=""><li id="f211" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr ok nd ne nf bi translated">基于词频的模型，这些被称为“单词包”方法，如 Tf-Idf 模型或 N-grams</li><li id="35c0" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr ok nd ne nf bi translated">使用简单神经网络提取向量表示的模型，该向量表示考虑了单词之间的“距离”(或相似性)。这些模型更先进，它们的出发点是出现在同一语境中的两个词在意义上应该“接近”。因此，有了这些模型，就有可能根据单词出现的上下文来捕捉它们之间的相似之处。这些模型可以进一步分为两种方法:</li></ol><ul class=""><li id="01b5" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">全局矩阵分解方法(如 LSA、LDA)</li><li id="4597" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">本地上下文窗口方法(如使用 cbow / skip-gram 的 Word2Vec)。这将是我们的重点领域。</li></ul><p id="05be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">(注意:<em class="ol">还有许多其他方法可以使用，例如 GloVe，它旨在使用完整的语料库从词出现的分布中提取词义— [1] Pennington et al .，2014 </em>)。</p><p id="c15a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Word2Vec 将在这个项目中使用，因为 Python Gensim 库提供的内置方法正好满足我们的目的。</p><h2 id="be15" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">2.1 Word2Vec 车型概述</h2><p id="ea39" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">Mikolov 等人(2013 年)[2]开发了这个模型，它由一个单隐层神经网络组成，在单词分类任务上进行训练。该网络学习单词与其上下文的句法和语义关系(在给定窗口中使用前面的和前面的单词)。</p><p id="829b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在该模型中有两种可能的算法可以使用:Skip-gram 和 continuous bag-of-words (CBOW)。</p><p id="3a3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在 skip-gram 变体中，目标是在给定单词的情况下预测单词上下文；而 cbow 是镜面反射的:它的目标是预测给定上下文的单词。</p><p id="a3e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">skip-gram 模型在我们的项目中表现更好，其架构如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/12cbb1cdc6872592b27de0aa2a7cf48c.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*KJq5xR22-vRZRBROpvaeeg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由 Mikolov 等人提供(2013 年)[2]</p></figure><p id="78c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了获得成功预测周围单词的单词的矢量表示，给定我们的当前单词，该算法最大化观察一些上下文单词的平均对数概率:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/3269c531a0888dd0c0c7632c08f1658a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*dul6SzfJ11aie2ISJmUjgg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由 Mikolov 等人提供(2013 年)[3]</p></figure><p id="051e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在公式中:</p><ul class=""><li id="e8b0" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">c 是“窗口”，或一个词的上下文的大小。这是一个用“单词”表示的模型超参数，例如，7 表示我们在当前单词 w_t 周围使用 7 个单词的上下文</li><li id="fa28" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">t 表示训练规模(即语料库中用于训练模型的所有单词)</li><li id="7a39" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">条件概率由以下 softmax 函数定义，其中“v”表示神经网络中单词 w 的输入和输出向量:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/ea39a7dda2b83fbedaac3c42f3c7efce.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*gv4zbS-tasdmLfHN_3ejEQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由 Mikolov 等人提供(2013 年)[3]</p></figure><p id="a86e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终输出将是期望维度(另一个模型超参数)的向量(词汇表中每个单词一个)。</p><p id="41e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些向量应该高精度地表示单词之间的关系。比如米科洛夫等人。，2013 [3]获得了可用于执行线性运算的向量，如:<king> - <man> + <woman>将给出非常接近对应于<queen>的向量的结果。</queen></woman></man></king></p><h2 id="31d3" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">2.2 概率近似值</h2><p id="dff4" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">上述最大化需要计算对数概率的梯度。</p><p id="5ef3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">米科洛夫等人的论文。，2013 [3]示出了该梯度的计算如何具有 O(V)的复杂度，即与词汇表的大小成比例(通常是巨大的)。这是实施方面的一个瓶颈。</p><p id="24a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，同一篇论文提出了以更有效的方式实现 word2vec 的几种策略，例如:</p><ul class=""><li id="020c" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">通过<em class="ol">分级 softmax </em>得到的 softmax 的近似值。这通过使用二叉树简化了输出图层表示，从而减少了参数的数量。</li><li id="9622" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated"><em class="ol">负采样</em>:这种技术允许从数据中区分“噪声”，通过训练模型从噪声分布中采样我们的目标词。</li></ul><p id="8227" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这两种技术都在项目中使用，分层 softmax 近似给出了更好的结果。</p><h1 id="cbdc" class="ma mb iq bd mc md of mf mg mh og mj mk jw oh jx mm jz oi ka mo kc oj kd mq mr bi translated">3.结果讨论</h1><h2 id="88e6" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">3.1 Word2Vec 模型培训</h2><p id="9fd2" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">为了训练 word2vec 模型，我们首先对歌词进行标记，并选择在分类任务中表现最佳的超参数，我们将在下面介绍:</p><ul class=""><li id="e9ad" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">sg = 1 以使用跳格算法</li><li id="d37c" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">hs = 1，使用分级 softmax 方法来近似概率</li><li id="0037" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">vector_size = 300 意味着每个单词的输出向量将有 300 个坐标。这与在整个 Google 新闻语料库上训练的 word2vec 模型使用的向量维度相同</li><li id="e775" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">window = 7 意味着我们的上下文将基于 7 个单词。在这个项目中，使用了不同的窗口大小，5 到 10 之间的数字给出了最好的结果。</li><li id="0c84" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">min_count = 3 意味着出现次数少于 3 次的单词将从语料库中排除。这将过滤掉那些很少使用的单词，从而减少我们的词汇量。</li></ul><p id="7d51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用这些值，模型训练得非常快，这个小数据集上的词汇大小为 1223。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="8284" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">3.2 绘制播放列表质心</h2><p id="a97d" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">训练之后，我们在播放列表中获得每个单词一个向量。因此，我们可以计算:播放列表质心，播放列表中最具代表性的单词。</p><ul class=""><li id="3c89" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">首先，我们提取了对应于播放列表中每个单词的向量，并对它们进行平均以获得质心</li><li id="e93d" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">然后，我们提取与质心相似的词，这些词是每个播放列表中最有代表性的词。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="792b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每种金属和全球播放列表的“前 10 个单词”分别是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/26ddb7f9aaeac96b60ca182045257ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*S5Z6DPHgQjClkNgzMmaMIw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="5af1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有趣的是，我们注意到最有代表性的单词并不一定与最常用的单词相对应(如上面的单词云图片所示)。正如所料，该算法超出了词频来计算向量坐标。</p><p id="1316" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们也可以把这些单词形象化，我们将使用主成分分析来表示 2D 的 300 坐标向量:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/bb37a30dae1dfc7f7367137986fa7d17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4supso-xG7uz7tB73CJndA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="c8fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似地，我们可以绘制两个播放列表质心的 PCA:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/c3e409da35b8d12009b6f8b17c31cc58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mi2-aq_-XkwKUNSVETYofw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="bd64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以根据最有代表性的单词和两个质心来分离这两个播放列表。让我们利用这些距离将新歌曲分配到播放列表。</p><h2 id="7935" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated">3.3 用逻辑回归对歌曲进行分类</h2><p id="baa8" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们现在将使用我们的向量和播放列表标签来训练逻辑回归模型。该模型将在由 6 首未被观察到的歌曲组成的测试集上进行测试。(这些歌曲以前是 Spotify 上这两个播放列表的一部分，但现在不再是它们的一部分了)。我们将确认模型是否会将歌曲分配到正确的播放列表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/8b24d65198da3195aaaccc27e656af6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EbXixkAwQxoZNqFoeznkQw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="921a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">逻辑回归是广义线性回归模型，这是一种非常常见的分类技术，特别是用于二元分类(2 类。然而，该模型也适用于多类分类问题)。</p><p id="aba8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型返回记录属于“类 1”的概率；可以设置阈值，以便“硬”将记录分配到“类别 1”，仅当概率高于阈值时。</p><h2 id="ad05" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated"><strong class="ak"> <em class="ot">数据预处理:</em>T3】</strong></h2><p id="2f07" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">让我们首先准备数据集:</p><ul class=""><li id="c04c" class="mx my iq ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">我们将使用已经导入的歌词来计算每首歌的平均向量。这将是我们的火车布景。</li><li id="1616" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">我们将上传新歌曲，并使用相同的 word2vec 模型计算每首歌曲的向量(平均单词向量)。这将是我们的测试集。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="5bcd" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated"><strong class="ak"> <em class="ot">超参数调谐:</em> </strong></h2><p id="8c34" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">接下来，我们运行交叉验证网格搜索，以确定最佳模型超参数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="c8fc" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated"><strong class="ak"> <em class="ot">模型训练&amp;测试:</em> </strong></h2><p id="c1fc" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们现在可以在训练集上训练最佳模型，然后通过对新歌曲进行分类来测试它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="6c17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们获得了以下预测的标签和性能:在训练集上的非常高的准确度和在测试集上的一首错误分类的歌曲。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/19af2b951c62a50fa6334bfa13761b58.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*FON1K8Vseoyt7XTsQwr5AA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="dc91" class="nl mb iq bd mc nm nn dn mg no np dp mk lf nq nr mm lj ns nt mo ln nu nv mq nw bi translated"><strong class="ak"> <em class="ot">图形概述:</em> </strong></h2><p id="4383" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">通过对 Word2Vec 模型向量使用 PCA，现在可以可视化测试集歌曲(每个点代表一首歌曲，通过对单词向量进行平均获得)。让我们检查一下新歌离两个播放列表质心有多近:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/e94616f6ceacc4c87f94386b7a0e1a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jHrX8z_fGmyWa4vjfEXkgg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="0e24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用这种表示，我们还可以可视化新歌曲是否非常接近播放列表的质心，从而使分类更加健壮。事实上，我们可以看到为什么一首歌被错误分类:它更接近“错误的”播放列表的质心。</p><h1 id="788e" class="ma mb iq bd mc md of mf mg mh og mj mk jw oh jx mm jz oi ka mo kc oj kd mq mr bi translated">4.结论</h1><p id="2bda" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">本文介绍了一种基于歌词将新歌曲分配到现有播放列表的可行策略。</p><p id="fb9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用 word2vec 进行歌词嵌入，使用 logistic 回归进行分类，取得了很好的效果。</p><p id="6b8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了推广这种策略，可以比较不同的嵌入技术和不同的回归模型，理想情况下使用大得多的数据集，这通常会改进单词嵌入任务。</p><p id="274f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读！</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="8551" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">参考</h1><ul class=""><li id="9e16" class="mx my iq ky b kz ms lc mt lf ow lj ox ln oy lr nc nd ne nf bi translated">[1] Jeffrey Pennington、Richard Socher 和 Christopher D. Manning2014.<a class="ae kv" href="https://nlp.stanford.edu/pubs/glove.pdf" rel="noopener ugc nofollow" target="_blank">手套:单词表示的全局向量</a></li><li id="8f1a" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">[2]托马斯·米科洛夫、程凯、格雷戈·科拉多、杰弗里·迪恩，2013 年。<a class="ae kv" href="https://arxiv.org/abs/1301.3781" rel="noopener ugc nofollow" target="_blank">向量空间中单词表示的有效估计</a></li><li id="9c9d" class="mx my iq ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">[3]托马斯·米科洛夫、伊利亚·苏茨基弗、程凯、格雷戈·科拉多、杰弗里·迪恩，2013 年。<a class="ae kv" href="https://arxiv.org/abs/1310.4546" rel="noopener ugc nofollow" target="_blank">单词和短语的分布式表示及其组合性</a></li></ul></div></div>    
</body>
</html>