<html>
<head>
<title>How To Convert Pandas DataFrame Into NumPy Array</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Pandas数据帧转换成NumPy数组</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-df-to-numpy-array-c1a9e7d8585f#2022-05-06">https://towardsdatascience.com/pandas-df-to-numpy-array-c1a9e7d8585f#2022-05-06</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="783f" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">将熊猫数据帧转换为NumPy数组</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e2df43a0ee110a2422b7afb7abd8f2ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YONgWGG9pmrdwWKOX8D6gQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@ltmonster?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">徐世洋</a>在<a class="ae kz" href="https://unsplash.com/s/photos/pandas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="744f" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当处理pandas数据帧时，如果我们将它们转换成NumPy数组，有时会有好处。后者似乎更节省内存，尤其是在对数据执行一些复杂的数学运算时。</p><p id="f290" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">当您处理相对少量的数据(比如50K行或更少)时尤其如此。在涉及大量数据的情况下(比如说超过50万行)，Pandas通常会优于ndarrays。不过这只是一个经验法则——在大多数情况下，根据您的特定需求和使用案例，测试两个选项并查看哪一个在性能和内存使用方面更好会更好。</p><p id="4af0" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的简短教程中，我们将展示如何有效地将熊猫数据帧转换成NumPy数组。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="8723" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们创建一个示例pandas DataFrame，我们将使用它来演示几种可能用于将其转换为numpy数组的不同方法。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="edc8" class="la lb iu nc b gz ng nh l ni nj">import pandas as pd<br/></span><span id="4b3d" class="la lb iu nc b gz nk nh l ni nj">df = pd.DataFrame(<br/>    [<br/>        (1, 'A', 10.5, True),<br/>        (2, 'B', 10.0, False),<br/>        (3, 'A', 19.2, False),<br/>        (4, 'C', 21.1, True),<br/>        (5, 'A', 15.5, True),<br/>        (6, 'C', 14.9, False),<br/>        (7, 'C', 13.1, True),<br/>        (8, 'B', 12.5, False),<br/>        (9, 'C', 11.2, False),<br/>        (10, 'A', 31.4, False),<br/>        (11, 'D', 10.4, True),<br/>    ],<br/>    columns=['colA', 'colB', 'colC', 'colD']<br/>)</span><span id="3b03" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><strong class="nc iv"><em class="nl">    colA colB  colC   colD<br/></em></strong><em class="nl">0      1    A  10.5   True<br/>1      2    B  10.0  False<br/>2      3    A  19.2  False<br/>3      4    C  21.1   True<br/>4      5    A  15.5   True<br/>5      6    C  14.9  False<br/>6      7    C  13.1   True<br/>7      8    B  12.5  False<br/>8      9    C  11.2  False<br/>9     10    A  31.4  False<br/>10    11    D  10.4   True</em></span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="2148" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">用熊猫。DataFrame.to_numpy()</h2><p id="1e9d" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当谈到将pandas数据帧转换成NumPy数组时，我们的第一个选择是<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_numpy.html" rel="noopener ugc nofollow" target="_blank">pandas.DataFrame.to_numpy()</a></code>方法。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="5e22" class="la lb iu nc b gz ng nh l ni nj"><strong class="nc iv">ndarray = df.to_numpy()</strong></span><span id="f662" class="la lb iu nc b gz nk nh l ni nj">print(ndarray)</span><span id="879d" class="la lb iu nc b gz nk nh l ni nj"><em class="nl">array([[1, 'A', 10.5, True],<br/>       [2, 'B', 10.0, False],<br/>       [3, 'A', 19.2, False],<br/>       [4, 'C', 21.1, True],<br/>       [5, 'A', 15.5, True],<br/>       [6, 'C', 14.9, False],<br/>       [7, 'C', 13.1, True],<br/>       [8, 'B', 12.5, False],<br/>       [9, 'C', 11.2, False],<br/>       [10, 'A', 31.4, False],<br/>       [11, 'D', 10.4, True]], dtype=object)</em></span></pre><p id="018c" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">并且返回对象的类型将是<code class="fe nm nn no nc b">numpy.ndarray</code>:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="ae63" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; type(ndarray)<br/>&lt;class 'numpy.ndarray'&gt;</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="c1c2" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">用熊猫。DatFrame.to_records()</h2><p id="f99f" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">这里的另一个选项是<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_records.html" rel="noopener ugc nofollow" target="_blank">pandas.DataFrame.to_records()</a></code>方法，它将把pandas数据帧转换成一个<strong class="ly iv"> NumPy记录数组</strong>:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="4cd2" class="la lb iu nc b gz ng nh l ni nj"><strong class="nc iv">recarray = df.to_records()</strong></span><span id="febf" class="la lb iu nc b gz nk nh l ni nj">print(recarray)</span><span id="dc88" class="la lb iu nc b gz nk nh l ni nj">rec.array([( 0,  1, 'A', 10.5,  True), <br/>           ( 1,  2, 'B', 10. , False),<br/>           ( 2,  3, 'A', 19.2, False), <br/>           ( 3,  4, 'C', 21.1,  True),<br/>           ( 4,  5, 'A', 15.5,  True), <br/>           ( 5,  6, 'C', 14.9, False),<br/>           ( 6,  7, 'C', 13.1,  True), <br/>           ( 7,  8, 'B', 12.5, False),<br/>           ( 8,  9, 'C', 11.2, False), <br/>           ( 9, 10, 'A', 31.4, False),<br/>           (10, 11, 'D', 10.4,  True)],<br/>          dtype=[('index', '&lt;i8'), ('colA', '&lt;i8'), ('colB', 'O'), ('colC', '&lt;f8'), ('colD', '?')])</span></pre><p id="7cdb" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">如上所述，与<code class="fe nm nn no nc b">to_numpy()</code>相反，<code class="fe nm nn no nc b">to_records()</code>方法将返回一个类型为<code class="fe nm nn no nc b">nympy.recarray</code>的对象:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="b113" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; type(recarray)<br/>&lt;class 'numpy.recarray'&gt;</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="9231" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用numpy.asarray()</h2><p id="a330" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">第三个选项是<code class="fe nm nn no nc b"><a class="ae kz" href="https://numpy.org/doc/stable/reference/generated/numpy.asarray.html#numpy-asarray" rel="noopener ugc nofollow" target="_blank">numpy.asarray()</a></code>方法，它将输入的pandas数据帧转换成一个NumPy数组:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="0028" class="la lb iu nc b gz ng nh l ni nj">import numpy as np</span><span id="04f3" class="la lb iu nc b gz nk nh l ni nj"><strong class="nc iv">ndarray = np.asarray(df)</strong></span><span id="751a" class="la lb iu nc b gz nk nh l ni nj">print(ndarray)</span><span id="9260" class="la lb iu nc b gz nk nh l ni nj">array([[1, 'A', 10.5, True],<br/>      [2, 'B', 10.0, False],<br/>      [3, 'A', 19.2, False],<br/>      [4, 'C', 21.1, True],<br/>      [5, 'A', 15.5, True], <br/>      [6, 'C', 14.9, False],<br/>      [7, 'C', 13.1, True],<br/>      [8, 'B', 12.5, False],<br/>      [9, 'C', 11.2, False],<br/>      [10, 'A', 31.4, False],<br/>      [11, 'D', 10.4, True]], dtype=object)</span></pre><p id="1afc" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">返回的对象将再次成为<code class="fe nm nn no nc b">numpy.ndarray</code>的实例:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="cb77" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; type(ndarray)<br/>&lt;class 'numpy.ndarray'&gt;</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="2b7b" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">避免使用df.values</h2><p id="41a1" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在较早的pandas版本中，将pandas数据帧转换成NumPy数组的另一种方法是通过<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.values.html#pandas.DataFrame.values" rel="noopener ugc nofollow" target="_blank">pandas.DataFrame.values</a></code>属性。但是请注意，即使是官方文档也鼓励您不要再使用它:</p><blockquote class="np nq nr"><p id="2d7b" class="lw lx nl ly b lz mp jv mb mc mq jy me ns mr mg mh nt ms mj mk nu mt mm mn mo in bi translated">我们建议使用<code class="fe nm nn no nc b"><a class="ae kz" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_numpy.html#pandas.DataFrame.to_numpy" rel="noopener ugc nofollow" target="_blank"><strong class="ly iv">DataFrame.to_numpy()</strong></a></code>来代替。</p></blockquote><p id="3111" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">这是因为该属性的行为不一致。要了解更多细节，可以阅读0.24.0 版本的<a class="ae kz" href="https://pandas-docs.github.io/pandas-docs-travis/whatsnew/v0.24.0.html#accessing-the-values-in-a-series-or-index" rel="noopener ugc nofollow" target="_blank">发行说明。</a></p><blockquote class="np nq nr"><p id="1e96" class="lw lx nl ly b lz mp jv mb mc mq jy me ns mr mg mh nt ms mj mk nu mt mm mn mo in bi translated">从历史上看，这可以用<code class="fe nm nn no nc b">series.values</code>来完成，但是用<code class="fe nm nn no nc b">.values</code>还不清楚返回值是实际的数组、它的某种转换，还是熊猫定制的数组之一(像<code class="fe nm nn no nc b">Categorical</code>)。</p></blockquote></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的文章中，我们讨论了将pandas数据帧转换成NumPy数组，以及在什么情况下这样做是有益的。</p><p id="bfef" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，我们展示了如何使用<code class="fe nm nn no nc b">pandas.DataFrame</code>对象的<code class="fe nm nn no nc b">to_numpy()</code>和<code class="fe nm nn no nc b">to_records()</code>方法以及<code class="fe nm nn no nc b">numpy.asarray()</code>方法将DataFrame转换为ndarray。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="nv nw gq gs nx ny"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="nz ab fp"><div class="oa ab ob cl cj oc"><h2 class="bd iv gz z fq od fs ft oe fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="of l"><h3 class="bd b gz z fq od fs ft oe fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="og l"><p class="bd b dl z fq od fs ft oe fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om kt ny"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">相关文章你可能也喜欢</strong></p><div class="nv nw gq gs nx ny"><a rel="noopener follow" target="_blank" href="/how-to-efficiently-convert-a-pyspark-dataframe-to-pandas-8bda2c3875c3"><div class="nz ab fp"><div class="oa ab ob cl cj oc"><h2 class="bd iv gz z fq od fs ft oe fv fx it bi translated">加快PySpark和Pandas数据帧之间的转换</h2><div class="of l"><h3 class="bd b gz z fq od fs ft oe fv fx dk translated">将大火花数据帧转换为熊猫时节省时间</h3></div><div class="og l"><p class="bd b dl z fq od fs ft oe fv fx dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om kt ny"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ny"><a rel="noopener follow" target="_blank" href="/how-to-merge-pandas-dataframes-221e49c41bec"><div class="nz ab fp"><div class="oa ab ob cl cj oc"><h2 class="bd iv gz z fq od fs ft oe fv fx it bi translated">如何合并熊猫数据帧</h2><div class="of l"><h3 class="bd b gz z fq od fs ft oe fv fx dk translated">对熊猫数据帧执行左、右、内和反连接</h3></div><div class="og l"><p class="bd b dl z fq od fs ft oe fv fx dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="oo l oj ok ol oh om kt ny"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ny"><a rel="noopener follow" target="_blank" href="/random-seed-numpy-786cf7876a5f"><div class="nz ab fp"><div class="oa ab ob cl cj oc"><h2 class="bd iv gz z fq od fs ft oe fv fx it bi translated">random.seed在NumPy中做什么</h2><div class="of l"><h3 class="bd b gz z fq od fs ft oe fv fx dk translated">理解在Python中使用NumPy生成伪随机结构时如何创建可再现的结果</h3></div><div class="og l"><p class="bd b dl z fq od fs ft oe fv fx dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="op l oj ok ol oh om kt ny"/></div></div></a></div></div></div>    
</body>
</html>