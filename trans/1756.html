<html>
<head>
<title>Convert CSV Files to LAS Files with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python将CSV文件转换为LAS文件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/convert-csv-files-to-las-files-with-python-7de4a47fc996#2022-04-25">https://towardsdatascience.com/convert-csv-files-to-las-files-with-python-7de4a47fc996#2022-04-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8708" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">快速简单的转换过程，使用LASIO和CSV数据从头开始创建LAS文件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/aa55772b25fa7791c07cf7d79f44c7b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uA-jrr6riCn3koai7rCwsQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用LASIO从CSV到LAS。作者创建的图像。</p></figure><p id="6e7e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://en.wikipedia.org/wiki/Well_logging" rel="noopener ugc nofollow" target="_blank">测井数据</a>可以多种格式交付(<a class="ae lu" href="https://dlisio.readthedocs.io/en/stable/dlis/specification.html" rel="noopener ugc nofollow" target="_blank"/>、<a class="ae lu" href="https://www.cwls.org/products/#products-las" rel="noopener ugc nofollow" target="_blank"> LAS </a>、CSV、ASC等)。).如果你有一个包含测井数据的CSV文件，并且你想把它转换成LAS格式，你可以使用<a class="ae lu" href="https://lasio.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> LASIO </a>库</p><p id="bdc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">LAS文件是一种简单的格式。它们是简单的文本文件，包含油井元数据、参数信息和测井数据测量值。这些文件很容易在任何文本编辑器中打开，您可以快速轻松地阅读内容。</p><p id="c1d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，有时您可能会得到一个包含测井测量值的CSV文件，并希望将其转换为LAS文件。在这篇文章中，我们将涵盖这一点。</p><p id="7697" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将看到如何使用优秀的LASIO库将一个简单的CSV文件转换成这样的LAS文件。</p><p id="88c2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你愿意，你可以在我的YouTube频道下面观看这个版本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><h1 id="b7a6" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">笔记本和数据</h1><p id="6ea5" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">你可以从我的Github仓库下载笔记本和数据，这里:<a class="ae lu" href="https://github.com/andymcdgeo/Petrophysics-Python-Series" rel="noopener ugc nofollow" target="_blank">https://github.com/andymcdgeo/Petrophysics-Python-Series</a></p><h1 id="5bee" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">加载所需的库</h1><p id="e846" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">首先，我们将加载所需的python库。在本教程中，我们将使用<a class="ae lu" href="https://lasio.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">拉西奥</a>和<a class="ae lu" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="b162" class="mz ly it mv b gy na nb l nc nd">import lasio<br/>import pandas as pd</span></pre><p id="1f94" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有关使用lasio的更多信息，请点击此处查看本文:</p><div class="ne nf gp gr ng nh"><a href="https://andymcdonaldgeo.medium.com/loading-and-displaying-well-log-data-b9568efd1d8" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">加载和显示测井数据</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">任何曾经或目前在石油和天然气行业工作的人都会理解，有一个大的…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">andymcdonaldgeo.medium.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ks nh"/></div></div></a></div><h1 id="c219" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">使用熊猫载入CSV文件</h1><p id="feb2" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">接下来，我们需要加载我们的CSV文件。</p><p id="3d29" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是使用pandas的<code class="fe nw nx ny mv b">read_csv()</code>函数并传入文件位置和文件名来完成的。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="dca9" class="mz ly it mv b gy na nb l nc nd">data = pd.read_csv('Data/Notebook 22/Notebook 22 - VOLVE - 15_9-19.csv')</span></pre><p id="910d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦文件被读取，我们就可以通过调用pandas <code class="fe nw nx ny mv b">data.head()</code>函数来检查文件的内容。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="4787" class="mz ly it mv b gy na nb l nc nd">data.head()</span></pre><p id="bcea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它返回一个包含数据统计信息的表格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/0041eb3ab58b0fda1b115aab972a6b1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vsCmOTsHBX2LmZA0IM48ZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测井数据的数据帧头。图片由作者提供。</p></figure><p id="e68f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在可以看到，在我们的<a class="ae lu" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">数据框架</a>中有18列，以及测井记录测量的混合。</p><p id="779d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了确保数据都是数字，并了解数据中有多少个空值，我们可以调用pandas函数<code class="fe nw nx ny mv b"><a class="ae lu" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.info.html?highlight=info#pandas-dataframe-info" rel="noopener ugc nofollow" target="_blank">.info()</a></code>。这不是一个必要的步骤，但是它允许我们检查列是否是数字的(float64或int64)。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="cb17" class="mz ly it mv b gy na nb l nc nd">data.info()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/fb10b5b62c3dbd303be3998057643dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*h3F28fxPJXjz9hFnIS2C5w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">dataframe.info()方法应用于测井数据，指示数据类型和空计数。图片由作者提供。</p></figure><h1 id="e37e" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">用LASIO创建一个空的LAS对象</h1><p id="0853" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">在将数据从CSV传输到LAS之前，我们首先需要创建一个空白的LAS文件。这是通过调用<code class="fe nw nx ny mv b">lasio.LASFile()</code>并将其赋给一个变量来实现的。在这个例子中，这个变量叫做<code class="fe nw nx ny mv b">las_file</code>。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="339b" class="mz ly it mv b gy na nb l nc nd">las_file = lasio.LASFile()</span></pre><p id="4848" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们尝试查看新创建的LAS文件的内容时，我们可以看到标题信息为空。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="c041" class="mz ly it mv b gy na nb l nc nd">las_file.header</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/e8b5d5498ecda053d60bd9ae7b9870b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PU8qZZ4-gsbI84JSZD8urQ.png"/></div></div></figure><p id="b4e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还可以通过调用<code class="fe nw nx ny mv b">las_file.curves</code>来确认文件中没有数据，这将返回一个空列表。</p><h1 id="403b" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">设置LAS文件元数据</h1><p id="4c7c" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">现在我们有了一个空白的las对象，我们需要向LAS头添加信息。</p><p id="9a4c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一步是创建一些我们想要填充的变量。这样做，而不是直接将它们传递到HeaderItem函数中，使得将来更改它们更容易，也使得可读性更好。</p><p id="a8d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，如果我们创建了一个函数，我们希望根据不同的文件更新头文件中的特定参数，我们可以很容易地将这些变量传递到函数中，而不必更新函数中的代码。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="4e27" class="mz ly it mv b gy na nb l nc nd">well_name = 'Random Well'<br/>field_name = 'Random Field'<br/>uwi = '123456789'<br/>country = 'Random Country'</span></pre><p id="e133" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要开始给标题赋值，我们需要调用<code class="fe nw nx ny mv b">las_file.well</code>并选择我们想要添加的标题属性。在右边，我们将更新HeaderItem并为其提供一个值。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="86e3" class="mz ly it mv b gy na nb l nc nd">las_file.well['WELL'] = lasio.HeaderItem('WELL', value=well_name)<br/>las_file.well['FLD'] = lasio.HeaderItem('FLD', value=field_name)<br/>las_file.well['UWI'] = lasio.HeaderItem('UWI', value=uwi)<br/>las_file.well['CTRY'] = lasio.HeaderItem('CTRY', value=country)</span></pre><p id="d339" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完成后，我们可以再次调用我们的头，我们现在可以看到井名、UWI、国家和字段名称的值都已更新。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="9bc1" class="mz ly it mv b gy na nb l nc nd">las_file.header</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/69421d04502d519e492e642b63362b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0GFf2raTPRt5izYOmjcNiA.png"/></div></div></figure><h1 id="4057" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">添加深度曲线</h1><p id="ed62" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">要将曲线添加到文件中，我们可以使用<code class="fe nw nx ny mv b">add_curve</code>功能并传入数据和单位。</p><p id="8afb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此处的示例显示了如何将一条曲线添加到名为DEPT的文件中。注意，如果添加主深度数据，它需要作为DEPT而不是depth放入。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="d7b5" class="mz ly it mv b gy na nb l nc nd">las_file.add_curve('DEPT', data['DEPTH'], unit='m')</span></pre><h1 id="84e8" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">书写剩余的曲线</h1><p id="a75b" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">为了使事情变得简单，我创建了一个包含每条测井曲线的测量单位的列表。请注意，这不包括深度测量的单位。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="4fcb" class="mz ly it mv b gy na nb l nc nd">units = ['m',<br/> 'inches',<br/> 'unitless',<br/> 'us/ft',<br/> 'us/ft',<br/> 'us/ft',<br/> 'us/ft',<br/> 'API',<br/> 'v/v_decimal',<br/> 'v/v_decimal',<br/> 'v/v_decimal',<br/> 'v/v_decimal',<br/> 'v/v_decimal',<br/> 'g/cm3',<br/> 'g/cm3',<br/> 'ohm.m',<br/> 'ohm.m',<br/> 'degC']</span></pre><p id="22e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以开始遍历数据帧中的每个测井测量值/列以及单位列表。这是使用Python <code class="fe nw nx ny mv b">zip</code>函数实现的。</p><p id="6914" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们在las文件中已经有了深度，所以我们可以通过检查列名来跳过这一列。还有其他处理方法，例如将深度和曲线一次性写入las文件。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="752c" class="mz ly it mv b gy na nb l nc nd">for col, unit in zip(data.columns, units):<br/>    if col != 'DEPTH':<br/>        las_file.add_curve(col, data[col], unit=unit)</span></pre><p id="9350" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们检查<code class="fe nw nx ny mv b">curves</code>函数时，我们可以看到我们所有的曲线都有适当的单位。我们还可以从列表的data.shape部分看到，每条曲线有4101个值，这证实了我们有数据。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="8c05" class="mz ly it mv b gy na nb l nc nd">las_file.curves</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/b03194c4969e3c04e2d6673e033e7e96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ylVxUveWUyZKhCfxMBD9fg.png"/></div></div></figure><p id="6154" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过调用曲线来确认我们有值。在下面的例子中，我调用了GR，我们得到了一个返回的包含伽马射线值的数组，它与前面给出的dataframe中的值相匹配。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="1049" class="mz ly it mv b gy na nb l nc nd">las_file['GR']</span></pre><p id="7f65" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它返回:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="bb27" class="mz ly it mv b gy na nb l nc nd">array([  36.621,   36.374,   30.748, ..., -999.   , -999.   , -999.   ])</span></pre><h1 id="1d42" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">导出LAS文件</h1><p id="686a" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">一旦我们对las文件感到满意，我们现在可以将其导出到一个文件中，并在任何其他软件包中使用它。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="026c" class="mz ly it mv b gy na nb l nc nd">las_file.write('Output/Notebook 22/OutputLAS_FINAL.las')</span></pre><h1 id="2357" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">摘要</h1><p id="714f" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">在本文中，我们介绍了如何将包含测井/岩石物理测量值的简单CSV文件转换为行业标准LAS (Log ASCII标准)文件。一旦在lasio中创建了一个空白的LASFile对象，就可以用正确的元数据手动更新标题项，也可以用正确的值更新曲线。</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><p id="0a4a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ol">感谢阅读。在你走之前，你一定要订阅我的内容，把我的文章放到你的收件箱里。</em> <a class="ae lu" href="https://andymcdonaldgeo.medium.com/subscribe" rel="noopener"> <strong class="la iu"> <em class="ol">你可以在这里做！</em> </strong> </a></p><p id="d0b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其次，通过注册会员，你可以获得完整的媒介体验，并支持我自己和成千上万的其他作家。它每个月只花你5美元，你可以完全接触到所有令人惊叹的媒体文章，也有机会用你的写作赚钱。如果你使用 <a class="ae lu" href="https://andymcdonaldgeo.medium.com/membership" rel="noopener"> <strong class="la iu"> <em class="ol">我的链接</em></strong></a><strong class="la iu"><em class="ol"/></strong><em class="ol">报名，你会直接用你的一部分费用支持我，不会多花你多少钱。如果你这样做了，非常感谢你的支持！</em></p><div class="ne nf gp gr ng nh"><a href="https://andymcdonaldgeo.medium.com/membership" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">通过我的推荐链接加入Medium安迪·麦克唐纳</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">andymcdonaldgeo.medium.com</p></div></div><div class="nq l"><div class="om l ns nt nu nq nv ks nh"/></div></div></a></div></div></div>    
</body>
</html>