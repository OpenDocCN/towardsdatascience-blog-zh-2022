<html>
<head>
<title>Understanding t-SNE in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Python中的t-SNE</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-t-sne-in-python-8a3286fd3ea6#2022-06-28">https://towardsdatascience.com/understanding-t-sne-in-python-8a3286fd3ea6#2022-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1a60" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">查看邻居并使用t分布SNE对数据进行分组</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d822705806f36e25b80b43dab2af7b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDOIQLtq-sUOsMEZ6QzE-Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@snapsbyclark?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Clark Van Der Beken </a>在<a class="ae ky" href="https://unsplash.com/s/photos/patterns?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h2 id="bda7" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">t-随机邻居嵌入</h2><p id="0520" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">t-SNE算法是查看高维数据的一个很好的资源。想想看:可视化二维以上的数据会变得非常具有挑战性。我的意思是超过2，因为即使现在有很好的3D图像，我们的大脑仍然很难理解3D图像。毕竟，我们的显示器或屏幕仍然是平面好老2D，对不对？</p><p id="b0b7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">所以我们想出了这个好的资源。t分布随机近邻嵌入。这个花里胡哨的名字是什么意思？</p><p id="cc89" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这意味着算法将查看数据集，检查数据点之间的相似性，并将它们转换为联合概率(<em class="mt">两个事件在同一时间点同时发生的可能性</em>)。然后，它将尝试最小化低维嵌入和高维数据的联合概率之间的Kullback-Leibler散度(两个概率分布之间的差异)。</p><blockquote class="mu"><p id="97ad" class="mv mw it bd mx my mz na nb nc nd mn dk translated">检查数据点，计算低维和高维数据中事件同时发生的概率。</p></blockquote><h2 id="f60c" class="kz la it bd lb lc ne dn le lf nf dp lh li ng lk ll lm nh lo lp lq ni ls lt lu bi translated">困惑</h2><p id="24b0" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">如果我们查看文档，困惑是"<em class="mt">与在其他流形学习算法中使用的最近邻的数量相关"</em>。它还说“<em class="mt">更大的数据集通常需要更大的困惑度</em>”。</p><p id="92f5" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这是一个可调参数。该参数可以理解为每个点的近邻数量的估计值。我还看到这里的<a class="ae ky" href="https://medium.com/towards-data-science/understanding-t-sne-by-implementing-2baf3a987ab3" rel="noopener">是计算t分布标准差的参数之一。根据文档，考虑选择一个介于5和50之间的值。</a></p><p id="7c66" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">还要考虑用不同的值创建一个测试，因为不同的值会导致明显不同的结果。</p><p id="c5fe" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">请看这个测试，它使用了我为了学习而创建的一个假数据集:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/abbb29acf6f9b81f68fe8f601cd61dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D8R48E1mXpvIA4BtwT__hg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1: t-SNE有不同的困惑值。图片由作者提供。</p></figure><p id="f120" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果我们强制迭代的数量<code class="fe nk nl nm nn b">n_iter=250</code>，那么结果如下。注意，在这种情况下，我们没有看到高复杂度的明确分离，因为该算法需要不同次数的迭代才能收敛到最佳解。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/9f6641a33802e8d69faf55ce217f1700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nAoC7F3C4oUaqvjoDAFXfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:在n_iter=250的情况下，具有不同困惑值的t-SNE。图片由作者提供。</p></figure><p id="b708" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">由于我的数据集很小，您可以看到，在相邻点数量较少的情况下，较小的数字会产生更好的结果。</p><p id="c9d3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果我用50个均匀分布的变量创建另一个数据集，并将其呈现给t-SNE，看看不同<code class="fe nk nl nm nn b">perplexity </code>数的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/3584ce7bd3ccd98455b0b5b11c70a3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K1-H4dVnDXWP0xZW9qIwEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3:高度困惑&gt; 50不是很有效。图片由作者提供。</p></figure><p id="7d38" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在这种情况下，30之后的<code class="fe nk nl nm nn b">perplexity</code>参数开始变得非常随机。正如我们在文档中看到的，它不应该在50以上使用，因为结果不会如此精确。</p><h2 id="4f22" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">其他考虑</h2><p id="0c70" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">从这篇好文章<a class="ae ky" href="https://distill.pub/2016/misread-tsne/" rel="noopener ugc nofollow" target="_blank">中，我们可以考虑如何有效地使用t-SNE</a>的其他注意事项有:</p><ul class=""><li id="e59a" class="nq nr it lx b ly mo mb mp li ns lm nt lq nu mn nv nw nx ny bi translated">SNE霸王龙图中的集群大小没有任何意义:SNE霸王龙不会关心每个集群的大小。</li><li id="4f5e" class="nq nr it lx b ly nz mb oa li ob lm oc lq od mn nv nw nx ny bi translated">星团之间的距离可能没有任何意义。t-SNE并不总是能反映出星团之间的距离。记住这一点。</li><li id="f3ab" class="nq nr it lx b ly nz mb oa li ob lm oc lq od mn nv nw nx ny bi translated">随机噪声看起来并不总是随机的:如果你创建一个随机数据集并将其提交给t-SNE，你仍然可以看到一些低值<code class="fe nk nl nm nn b">perplexity</code>的模式。这并不意味着存在集群。</li><li id="3915" class="nq nr it lx b ly nz mb oa li ob lm oc lq od mn nv nw nx ny bi translated">你可以看到一些形状，有时:<code class="fe nk nl nm nn b">perplexity</code>会拨出小值的局部方差或高值的全局方差。这导致了形状的出现。</li></ul><p id="e95f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">t-SNE的结果也许可以用于聚类，因为结果矩阵将是数据的低维版本，因此结果应该是相似的。您可以在本文末尾提供的代码测试中看到，KMeans使用矩阵或one hot编码的高维数据显示了相同的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/68e867a646b17ac1835794785d764471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1VcRYlTQun-YsMAzNtthA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在高维或低维数据集上使用KMeans得到相同的结果。图片由作者提供。</p></figure><h2 id="4041" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">在你走之前</h2><p id="1a7a" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">这里展示的是SNE霸王龙。使用T分布，这个好的算法帮助我们可视化2D的高维数据。</p><p id="c23d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">您必须找到<code class="fe nk nl nm nn b">perplexity</code>和<code class="fe nk nl nm nn b">n_iter</code>超参数的微调，以便能够获得数据的最佳分离度和相似度。尝试使用循环和绘图以获得最佳效果。</p><p id="3515" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">本练习使用的数据集<a class="ae ky" href="https://github.com/gurezende/Studying/tree/master/Python/t-SNE" rel="noopener ugc nofollow" target="_blank">可以在我的GitHub中找到。</a></p><h2 id="acbb" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">参考</h2><div class="of og gp gr oh oi"><a href="https://distill.pub/2016/misread-tsne/" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">如何有效地使用t-SNE</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">一种流行的探索高维数据的方法叫做t-SNE，是由范德马滕和辛顿提出的…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">蒸馏. pub</p></div></div><div class="or l"><div class="os l ot ou ov or ow ks oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">sklearn.manifold.TSNE</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">t分布随机邻居嵌入。t-SNE [1]是一个可视化高维数据的工具。它转换…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">scikit-learn.org</p></div></div><div class="or l"><div class="ox l ot ou ov or ow ks oi"/></div></div></a></div><div class="of og gp gr oh oi"><a rel="noopener follow" target="_blank" href="/understanding-t-sne-by-implementing-2baf3a987ab3"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">通过实施了解t-SNE</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">t-SNE是如何工作的以及如何实施的</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">towardsdatascience.com</p></div></div><div class="or l"><div class="oy l ot ou ov or ow ks oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://scikit-learn.org/stable/auto_examples/manifold/plot_t_sne_perplexity.html#sphx-glr-auto-examples-manifold-plot-t-sne-perplexity-py" rel="noopener  ugc nofollow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">t-SNE:不同困惑值对形状的影响</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">两个同心圆上的t-SNE图和不同困惑值的S曲线数据集。我们…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">scikit-learn.org</p></div></div><div class="or l"><div class="oz l ot ou ov or ow ks oi"/></div></div></a></div><p id="d521" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果这些内容有用，请关注我的博客。</p><div class="of og gp gr oh oi"><a href="https://gustavorsantos.medium.com/" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">古斯塔沃·桑托斯-中等</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">阅读古斯塔夫·桑托斯在媒介上的作品。数据科学家。我从数据中提取见解，以帮助个人和公司…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">gustavorsantos.medium.com</p></div></div><div class="or l"><div class="pa l ot ou ov or ow ks oi"/></div></div></a></div><p id="cf11" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">考虑使用此推荐代码<a class="ae ky" href="https://gustavorsantos.medium.com/membership" rel="noopener">注册为中级会员。</a></p><p id="5ae8" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pb pc l"/></div></figure></div></div>    
</body>
</html>