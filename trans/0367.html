<html>
<head>
<title>Django First Steps for Total Beginners: A Quick Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Django完全初学者的第一步:快速教程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/django-first-steps-for-the-total-beginners-a-quick-tutorial-5f1e5e7e9a8c#2022-02-15">https://towardsdatascience.com/django-first-steps-for-the-total-beginners-a-quick-tutorial-5f1e5e7e9a8c#2022-02-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ec8a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何在Django应用程序中嵌入Plotly图形，以及其他主题</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9170d42e189cca0a8c994680624b62e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hZkV7I-nyYygoMkVepPLGA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@faisaldada?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">费萨尔</a>在<a class="ae kv" href="https://unsplash.com/s/photos/django?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d91f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你喜欢用Python编程，并且想第一次进入web开发领域，我认为Django可能非常适合你。Django是最受欢迎的Python框架之一，它为web开发中非常常见的任务提供了出色的内置解决方案，使快速高效地实现项目和编写代码成为可能。此外，Django也被大公司用于制作，比如<a class="ae kv" href="https://trio.dev/blog/django-applications" rel="noopener ugc nofollow" target="_blank"> Instagram和Spotify </a>。因此，这一出色的Python框架也很有可能满足您的项目需求。</p><p id="07ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我最近从Coursera的<a class="ae kv" href="https://www.coursera.org/specializations/django" rel="noopener ugc nofollow" target="_blank">Django for Everybody Specialization</a>毕业，我惊讶于使用Django内置视图类构建一个具有用户认证和登录功能的完整CRUD应用程序是如此的快速和简单。我将永远感谢来自密歇根大学的Charles Severance教授，因为他组织了这样一个令人惊叹和兴奋的课程，将我的Django技能提升到了一个完全不同的水平。</p><p id="5a58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我决定通过创建一个简单的CRUD应用程序来管理和显示我喜欢的电影中的数据，来实践我从这门课程中学到的东西。然而，在以后的文章中展示这种CRUD的代码之前，我想收集一些关于Django入门的介绍性信息。因此有了这个教程。</p><p id="d55a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这份材料能帮助一些人。至少，它帮助了我，因为这是一个回顾Django中一些基本概念和实践的机会。</p><p id="c06c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用Python 3.10.2和Django 4.0.2开发了本教程。我还使用Git Bash作为我的终端，这是在Windows操作系统中运行Linux命令的好方法。</p><p id="f8cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第1部分:第一步</strong></p><ol class=""><li id="927c" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">创建一个名为<code class="fe mb mc md me b">films_project</code>的项目文件夹并进入其中。</li></ol><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="cc72" class="mj mk iq me b gy ml mm l mn mo">mkdir films_project<br/>cd films_project</span></pre><p id="c219" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果没有另外提到，本教程中的所有终端命令都应该在<code class="fe mb mc md me b">films_project</code>目录中运行。</p><p id="4b13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.使用<code class="fe mb mc md me b">venv</code> Python模块创建一个新的虚拟环境。我将我的虚拟环境命名为<code class="fe mb mc md me b">.myenv</code>，但是如果您愿意，也可以使用其他名称。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="3216" class="mj mk iq me b gy ml mm l mn mo">python -m venv .myenv</span></pre><p id="90fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.通过针对您选择的终端和操作系统运行正确的命令来激活虚拟环境。下面的命令在我的Git Bash for Windows中有效。如果你对用<code class="fe mb mc md me b">venv</code>激活虚拟环境有疑问，请查阅<a class="ae kv" href="https://docs.python.org/3/library/venv.html" rel="noopener ugc nofollow" target="_blank"> Python文档</a>。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="6cc9" class="mj mk iq me b gy ml mm l mn mo">source .myenv/Scripts/activate</span></pre><p id="d50f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">激活它之后，您应该会在终端中看到您的虚拟环境名称，如下例所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/db8ada15bf2c321857bc1ce9282af5bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YGY_-pJL_pmz9apliUcqXw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="33f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从现在开始，所有命令都必须在激活虚拟环境的情况下运行。</p><p id="5f65" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.用PIP安装Django:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="b2a1" class="mj mk iq me b gy ml mm l mn mo">pip install django</span></pre><p id="8152" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">5.自己开始一个叫<code class="fe mb mc md me b">project</code>的Django项目。</p><p id="2447" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">重要提示:不要忘记这个命令末尾的点。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="fe13" class="mj mk iq me b gy ml mm l mn mo">django-admin startproject project .</span></pre><p id="3798" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行这个命令将创建一个<code class="fe mb mc md me b">manage.py</code>文件和一个名为<code class="fe mb mc md me b">project</code>的文件夹，里面有五个文件(算上<code class="fe mb mc md me b">__init__.py</code>一个)。因此，您的<code class="fe mb mc md me b">films_project</code>目录树现在应该是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/13656948091cab07885f3478bc92cc07.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*2NHnN-QwmYCDMkWtCSvsmA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e0e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请记住<code class="fe mb mc md me b">.myenv</code>是我选择命名我的虚拟环境文件夹的方式，它在上面的图像中是折叠的(里面有一堆文件夹和文件，与我们的教程无关)。</p><p id="6d31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">6.启动名为<code class="fe mb mc md me b">films</code>的Django应用程序:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="e975" class="mj mk iq me b gy ml mm l mn mo">python manage.py startapp films</span></pre><p id="e942" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Django项目可以有一个或多个应用程序。您可以将Django中的应用程序视为在不同项目之间重用代码的一种方式。</p><p id="9d3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个命令<code class="fe mb mc md me b">python manage.py</code>将在您的Django项目中频繁使用，所以请习惯它。另外，在终端中只运行<code class="fe mb mc md me b">python manage.py</code>，不使用任何其他参数，将会显示所有可用选项的列表。</p><p id="30cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的<code class="fe mb mc md me b">startapp</code>命令创建了一个名为<code class="fe mb mc md me b">films</code>的新文件夹，里面有一些文件和一个文件夹。查看它们:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/91b1f35214d230b00130042306ddd49b.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*0jU9Q0oj0J_sV1gYMivhfg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3886" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mb mc md me b">films_project/films/migrations</code>中唯一的文件是一个<code class="fe mb mc md me b">__init__.py</code>文件，表明这个迁移目录将来应该作为一个模块使用。</p><p id="b877" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">7.每当我们创建一个新的应用程序时，我们必须将它添加到<code class="fe mb mc md me b">settings.py</code>文件中的已安装应用程序列表中。我们现在就开始吧。打开<code class="fe mb mc md me b">project/settings.py</code>，在<code class="fe mb mc md me b">INSTALLED_APPS</code>变量中保存的列表末尾添加一个带有<code class="fe mb mc md me b">films</code>应用的字符串。不要删除或更改列表中已有的任何其他字符串:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="f4ef" class="mj mk iq me b gy ml mm l mn mo"># inside project/settings.py</span><span id="4c05" class="mj mk iq me b gy ms mm l mn mo">INSTALLED_APPS = [</span><span id="65a5" class="mj mk iq me b gy ms mm l mn mo">    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',</span><span id="05bd" class="mj mk iq me b gy ms mm l mn mo">    #new value below:<br/>    'films.apps.FilmsConfig',<br/>]</span></pre><p id="45c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当<code class="fe mb mc md me b">settings.py</code>仍然打开时，您可以在<code class="fe mb mc md me b">LANGUAGE_CODE</code>和<code class="fe mb mc md me b">TIME_ZONE</code>变量中更改整个应用程序的默认语言和时区。</p><p id="ee1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">8.运行以下代码检查错误:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="925a" class="mj mk iq me b gy ml mm l mn mo">python manage.py check</span></pre><p id="6c1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您收到消息'<em class="mt">系统检查未发现问题(0沉默)'</em>，这意味着您的申请是好的。我们现在准备启动本地服务器，并第一次检查我们的Django网站。</p><p id="cce3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">9.运行以下命令，在默认端口(8000)启动本地服务器</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="2b13" class="mj mk iq me b gy ml mm l mn mo">python manage.py runserver</span></pre><p id="f0de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果8000端口已被计算机中的另一个应用程序占用，请更改端口。只需在命令中添加新的端口号(例如8050 ):</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="b98f" class="mj mk iq me b gy ml mm l mn mo">python manage.py runserver 8050</span></pre><p id="641e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">10.打开浏览器并转到以下地址之一:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="e782" class="mj mk iq me b gy ml mm l mn mo"><a class="ae kv" href="http://127.0.0.1:8000/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8000/</a></span></pre><p id="d2c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="454e" class="mj mk iq me b gy ml mm l mn mo"><a class="ae kv" href="http://localhost:8000/" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/</a></span></pre><p id="8c25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如有必要，用您的新端口号替换<code class="fe mb mc md me b">8000</code>。</p><p id="3a00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过访问这个运行在本地机器上的服务器，您将看到一个新项目的Django默认主页。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/8cc02ea6d1455234f2b9712369f8b042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yi6axiNGulmz2EvCLjugqw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="9575" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">11.注意，在<code class="fe mb mc md me b">films_project</code>文件夹中创建了一个名为<code class="fe mb mc md me b">db.sqlite3</code>的新文件。这是因为sqlite3是在<code class="fe mb mc md me b">project/settings.py</code>文件中配置的默认数据库。然而，Django允许与许多其他数据库连接；您只需要进行正确的配置。我们现在不会谈论这个话题，因为这个话题已经超出了我们当前基础教程的范围。</p><p id="ba3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">12.Django已经为您创建了另一条路线。首先，确保您的本地服务器正在运行(也就是说，您在终端中执行了<code class="fe mb mc md me b">python manage.py runserver</code>，并且那里没有错误消息)。然后转到管理页面查看:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="4181" class="mj mk iq me b gy ml mm l mn mo"><a class="ae kv" href="http://localhost:8000/admin/" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/admin/</a></span></pre><p id="0baa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当您尝试访问下面的链接时，您可能会看到一条非常难看的错误消息，在<em class="mt">异常值</em>字段中显示信息“<em class="mt">no this table:django _ session</em>”。我想让你看看那一页，因为我们可以从编程过程中出现的错误信息中学到很多。对此有一个非常简单的解决方法:我们只需要运行命令在数据库中创建管理应用程序使用的表。所以:</p><p id="a6ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">13.运行以下命令创建数据库表。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="dd5d" class="mj mk iq me b gy ml mm l mn mo">python manage.py migrate</span></pre><p id="7b11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大约十几条消息将显示在终端控制台中，表示迁移已被应用。这意味着Django为数据库中的默认应用程序创建了必要的表，比如admin。实际上，如果您使用一个sqlite3服务连接到数据库并列出它的所有表，您将会看到这些由您刚才运行的<code class="fe mb mc md me b">migrate</code>命令创建的新表。</p><p id="06ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">14.您还需要创建一个超级用户来登录管理区。使用以下终端命令完成此操作:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="b691" class="mj mk iq me b gy ml mm l mn mo">python manage.py createsuperuser</span></pre><p id="e9af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">告知用户名、电子邮件和密码。然后，使用<code class="fe mb mc md me b">python manage.py runserver</code>重启服务器，并使用您的信息登录到管理区域。您将看到以下页面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/d701b536d7e819cce022d15efb95369f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZNZ9kT0Ak7HR3NHacxIbQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="47ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是Django从一开始就提供给开发人员的许多内置资源之一，我想让您知道它的存在，尽管我们现在不会在本教程中探究它。管理区是Django的强大特性之一，因此值得花时间学习如何使用它。</p><p id="c979" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二部分:我们的第一条路线和风景。</p><p id="bb78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">15.让我们创建我们的第一个新路由，它将替换我们刚刚访问的Django默认页面。我们将通过修改<code class="fe mb mc md me b">project/urls.py</code>文件来实现。注意，我们还向它添加了一个新的import语句。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="cec1" class="mj mk iq me b gy ml mm l mn mo"># inside project/urls.py</span><span id="3ea5" class="mj mk iq me b gy ms mm l mn mo">from django.contrib import admin<br/>from django.urls import path<br/>from films import views    # added </span><span id="fff9" class="mj mk iq me b gy ms mm l mn mo"><br/>urlpatterns = [<br/>    path('', views.home, name='home'),    # added<br/>    path('admin/', admin.site.urls),  <br/>]</span></pre><p id="89d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">16.如果我们现在运行<code class="fe mb mc md me b">python manage.py check</code>，它将返回一个错误，因为你的<code class="fe mb mc md me b">films/views.py</code>是空的。让我们通过向该文件添加以下函数来纠正这一点:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="cae5" class="mj mk iq me b gy ml mm l mn mo"># inside films/views.py</span><span id="20cf" class="mj mk iq me b gy ms mm l mn mo">from django.shortcuts import render<br/>from django.http import HttpResponse   # added</span><span id="8537" class="mj mk iq me b gy ms mm l mn mo"><br/>def home(request):<br/>    return HttpResponse('This is the home page.')</span></pre><p id="8545" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，再次访问<code class="fe mb mc md me b">http://localhost:8000</code>,检查新修改的页面如何显示我们在<code class="fe mb mc md me b">home</code>视图功能中设置的信息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/7504c6044a5a39671911bd9745abdb6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVxcGlvFRW5EjQa1jEHnjw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="10ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">干得好！它看起来一点也不花哨，但我们需要欣赏我们在这里取得的成就:我们使用Django和Python创建了我们的第一个网页，所有这些只需编写几行代码并在终端中运行几个命令。此外，所有这些知识将有助于我们在未来创建更加复杂和令人兴奋的网站，这一点可以肯定。如果我们现在建立了足够好的基础，将来我们可以成为非常熟练的Django开发人员，制作伟大而有用的web应用程序，同时享受用Python编程的乐趣。</p><p id="1fd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一点上，对Django所认为的视图做一些简单的考虑是很有趣的。与大多数MVC(模型-视图-控制器)框架不同，在MVC框架中，视图指的是应用程序的前端部分，Django将视图称为配置应用程序逻辑和规则的代码。Django中的接口部分被称为模板，这使得Django成为一个MVT(模型-视图-模板)框架。</p><p id="122d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我再说一遍:Django中的视图是我们创建控制器和应用程序逻辑的地方；不是前端的部分(这些在Django里叫模板)。我在这里提到它是因为这一点让许多人感到困惑，尤其是那些来自经典MVC模式的人。</p><p id="407e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从我们目前所做的可以看出，<code class="fe mb mc md me b">films/views.py</code>中的<code class="fe mb mc md me b">home</code>函数简洁明了；它只接受一个请求对象作为其参数，并返回一个响应对象，该对象在DOM中写入一个短语，并在所选的URL中显示它。但是我们也可以在视图函数中将HTML元素传递给响应对象，这样浏览器就可以用不同的字体大小和格式显示它们。</p><p id="06a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">17.然后让我们修改<code class="fe mb mc md me b">films/views.py</code>中的<code class="fe mb mc md me b">home</code>函数如下:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="ff96" class="mj mk iq me b gy ml mm l mn mo"># inside films/views.py</span><span id="67af" class="mj mk iq me b gy ms mm l mn mo">from django.shortcuts import render<br/>from django.http import HttpResponse</span><span id="6de2" class="mj mk iq me b gy ms mm l mn mo"><br/>def home(request):<br/>    # remove these print statements later<br/>    print('\n\nRequest object:', request)<br/>    print('Request object type:', type(request), '\n\n')<br/>    <br/>    html_tags = '''<br/>    &lt;h1&gt;This is the Home Page&lt;/h1&gt;<br/>    &lt;h3&gt;Thanks for visiting us&lt;/h3&gt;<br/>    &lt;p&gt;MVT means:&lt;/p&gt;<br/>    &lt;ul&gt;<br/>      &lt;li&gt;Model&lt;/li&gt;<br/>      &lt;li&gt;View&lt;/li&gt;<br/>      &lt;li&gt;Template&lt;/li&gt;<br/>    &lt;/ul&gt;'''<br/>    <br/>    response = HttpResponse(html_tags)</span><span id="5b6e" class="mj mk iq me b gy ms mm l mn mo">    # remove these print statements later<br/>    print('Response object:', response)<br/>    print('Response object type:', type(response))<br/>    print('\n\nUser-agent info :', end='')<br/>    print(request.META['HTTP_USER_AGENT'], '\n\n')<br/>   <br/>    return response</span></pre><p id="179f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你的Django本地服务器正在运行，用<code class="fe mb mc md me b">CTRL + C</code>停止它，运行<code class="fe mb mc md me b">python manage.py check</code>查看是否有错误，然后用<code class="fe mb mc md me b">python manage.py runserver</code>再次启动服务器。接下来，进入<code class="fe mb mc md me b">http://localhost:8000</code>查看新网页。每次刷新这个页面，都会向Django服务器发送一个GET请求，并执行<code class="fe mb mc md me b">home</code>函数视图。您可以检查一些关于请求和响应对象的信息，我们要求在终端控制台中打印这些信息。</p><p id="75ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个重要的警告:我们永远不会在Django产品代码中使用带有HTML标签的字符串。否则，我们将把我们的申请提交给XSS恶意攻击。因此，在第一个例子中，我们将在Django视图中使用HTML。稍后我将向您展示如何在Django中使用模板来呈现HTML页面。</p><p id="528c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在将创建新的路线来巩固我们到目前为止所学的内容。</p><p id="953e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">18.创建文件<code class="fe mb mc md me b">films/urls.py</code>。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="2e46" class="mj mk iq me b gy ml mm l mn mo">touch films/urls.py</span></pre><p id="24a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">19.在<code class="fe mb mc md me b">project/urls.py</code>中添加新路线。它将作为我们稍后为<code class="fe mb mc md me b">films</code>应用创建的路线的入口点。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="2f0b" class="mj mk iq me b gy ml mm l mn mo"># inside projects/urls.py</span><span id="6dc1" class="mj mk iq me b gy ms mm l mn mo">from django.contrib import admin<br/>from django.urls import path, include<br/>from films import views</span><span id="c027" class="mj mk iq me b gy ms mm l mn mo"><br/>urlpatterns = [<br/>    path('', views.home, name='home'),<br/>    path('admin/', admin.site.urls),<br/>    path('films/', include('films.urls')),   # added<br/>]</span></pre><p id="fecf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">20.用新的路线信息填充<code class="fe mb mc md me b">films/urls.py</code>文件。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="5d21" class="mj mk iq me b gy ml mm l mn mo"># films/urls.py</span><span id="51a6" class="mj mk iq me b gy ms mm l mn mo">from django.urls import path<br/>from . import views</span><span id="dee1" class="mj mk iq me b gy ms mm l mn mo"><br/>app_name = 'films'</span><span id="df99" class="mj mk iq me b gy ms mm l mn mo">urlpatterns = [<br/>    path('', views.main, name='main'),<br/>    path('user_info/', views.user_info, name='user_info'),<br/>]</span></pre><p id="e7ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">21.在<code class="fe mb mc md me b">films/views.py</code>末尾增加新的视图功能:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="4758" class="mj mk iq me b gy ml mm l mn mo"># films/views.py</span><span id="1dde" class="mj mk iq me b gy ms mm l mn mo">(...)</span><span id="5252" class="mj mk iq me b gy ms mm l mn mo">def main(request):<br/>    message = '&lt;h1&gt;This is the films MAIN page.&lt;/h1&gt;'<br/>    return HttpResponse(message)</span><span id="9b33" class="mj mk iq me b gy ms mm l mn mo">def user_info(request):<br/>    message = '&lt;h1&gt;This is the films USER_INFO page.&lt;/h1&gt;'<br/>    return HttpResponse(message)</span></pre><p id="4ccb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">22.现在访问创建的路由，检查它们是否显示正确的消息:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="df3a" class="mj mk iq me b gy ml mm l mn mo">http://localhost:8000/films/<br/>http://localhost:8000/films/user_info</span></pre><p id="6e40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第3部分:让视图呈现HTML模板文件</strong></p><p id="f133" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在是时候开始使用Django模板了。现在，它们将是由视图函数呈现的简单HTML文件。</p><p id="78bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">23.创建保存HTML文件的必要文件夹。</p><p id="22ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">重要提示:请注意，这些新文件夹中有两个被命名为<code class="fe mb mc md me b">templates</code>:一个在<code class="fe mb mc md me b">films</code>中，另一个直接位于<code class="fe mb mc md me b">films_project</code>的项目根目录中，与<code class="fe mb mc md me b">films</code>处于同一层级。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="09b8" class="mj mk iq me b gy ml mm l mn mo">mkdir templates<br/>mkdir films/templates<br/>mkdir films/templates/films</span></pre><p id="c658" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">24.创建以下HTML文件:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="c4e0" class="mj mk iq me b gy ml mm l mn mo">touch templates/home.html<br/>touch films/templates/films/main.html<br/>touch films/templates/films/user_info.html</span></pre><p id="0a21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">25.打开<code class="fe mb mc md me b">project/settings.py</code>，导入<code class="fe mb mc md me b">os</code>模块，在变量<code class="fe mb mc md me b">TEMPLATES</code>中，用以下信息填充<code class="fe mb mc md me b">TEMPLATES['DIR']</code>键中的空列表(只改变这一行，保留其他行):</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="33ad" class="mj mk iq me b gy ml mm l mn mo">TEMPLATES = [<br/>{</span><span id="181d" class="mj mk iq me b gy ms mm l mn mo">(...)</span><span id="4d7f" class="mj mk iq me b gy ms mm l mn mo">   'DIRS': [os.path.join(BASE_DIR, 'templates')],</span><span id="e5d6" class="mj mk iq me b gy ms mm l mn mo">(...)</span><span id="e3e5" class="mj mk iq me b gy ms mm l mn mo">}<br/>]</span></pre><p id="d215" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">26.将以下信息放入相应的HTML文件中:</p><ul class=""><li id="e3ca" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated"><code class="fe mb mc md me b">templates/home.html</code>:</li></ul><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="43d8" class="mj mk iq me b gy ml mm l mn mo">&lt;h1&gt;This is the Home Page&lt;/h1&gt;<br/>&lt;h3&gt;Thanks for visiting us&lt;/h3&gt;<br/>&lt;p&gt;MVT means:&lt;/p&gt;<br/>&lt;ul&gt;<br/>  &lt;li&gt;Model&lt;/li&gt;<br/>  &lt;li&gt;View&lt;/li&gt;<br/>  &lt;li&gt;Template&lt;/li&gt;<br/>&lt;/ul&gt;<br/>&lt;h3&gt;Link to the website pages:&lt;/h3&gt;<br/>&lt;ul&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'home' %}"&gt;Home Page&lt;/a&gt;&lt;/li&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'films:main' %}"&gt;Films Main Page&lt;/a&gt;&lt;/li&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'films:user_info' %}"&gt;Films User_Info Page&lt;/a&gt;&lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><ul class=""><li id="6333" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated"><code class="fe mb mc md me b">films/templates/films/main.html</code></li></ul><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="be52" class="mj mk iq me b gy ml mm l mn mo">&lt;h1&gt;This is the films MAIN page.&lt;/h1&gt;<br/>&lt;h3&gt;Link to the website pages:&lt;/h3&gt;<br/>&lt;ul&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'home' %}"&gt;Home Page&lt;/a&gt;&lt;/li&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'films:main' %}"&gt;Films Main Page&lt;/a&gt;&lt;/li&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'films:user_info' %}"&gt;Films User_Info Page&lt;/a&gt;&lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><ul class=""><li id="1d67" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated"><code class="fe mb mc md me b">films/templates/films/user_info.html</code></li></ul><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="4ed8" class="mj mk iq me b gy ml mm l mn mo">&lt;h1&gt;This is the films USER_INFO page.&lt;/h1&gt;<br/>&lt;p&gt;Username: Fabrício&lt;/p&gt;<br/>&lt;h3&gt;Link to the website pages:&lt;/h3&gt;<br/>&lt;ul&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'home' %}"&gt;Home Page&lt;/a&gt;&lt;/li&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'films:main' %}"&gt;Films Main Page&lt;/a&gt;&lt;/li&gt;<br/>  &lt;li&gt;&lt;a href="{% url 'films:user_info' %}"&gt;Films User_Info Page&lt;/a&gt;&lt;/li&gt;<br/>&lt;/ul&gt;</span></pre><p id="a461" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个重要的提示:如果你现在访问这些页面，你会发现什么都没有改变。这是因为我们没有在视图中进行任何更新。我们需要让每一个视图呈现正确的模板。</p><p id="7aab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">27.因此，将<code class="fe mb mc md me b">films/views.py</code>中的所有内容替换为下面的新代码:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="f4b1" class="mj mk iq me b gy ml mm l mn mo">from django.shortcuts import render</span><span id="9a91" class="mj mk iq me b gy ms mm l mn mo"><br/>def home(request):<br/>    return render(request, 'home.html')</span><span id="fb3c" class="mj mk iq me b gy ms mm l mn mo">def main(request):<br/>    return render(request, 'films/main.html')</span><span id="0e60" class="mj mk iq me b gy ms mm l mn mo">def user_info(request):<br/>    return render(request, 'films/user_info.html')</span></pre><p id="e813" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在访问网址并注意不同之处。浏览链接，在页面间快速移动。</p><p id="b9ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第4部分:使用基础模板避免代码重复</strong></p><p id="67d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不知道你是否注意到了，HTML文件中的代码有许多重复的行。这一点都不可取，因为它违反了DRY ( <em class="mt">不要重复自己</em>)原则，我们需要修正这一点。Django允许使用模板标签，以一种非常简单的方式，将应该出现在多个页面中的HTML代码编写在一个HTML文件中。</p><p id="4ed4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">28.创建一个<code class="fe mb mc md me b">templates/base.html</code>文件。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="ec61" class="mj mk iq me b gy ml mm l mn mo">touch templates/base.html </span></pre><p id="0025" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在将在我们的项目中使用一些来自Bootstrap web设计框架的代码。不幸的是，我不能在这里解释基本的HTML、CSS和引导代码是如何工作的。否则，本教程将会比现在更加广泛。然而，如果你想从事web开发，即使是在后端，这些都是很好的学习技巧。在我看来，新知识从来没有坏处。</p><p id="5b24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，如果你想知道更多关于如何创建漂亮的网页界面，我建议你去看看丹尼尔·沃尔特·斯科特的名为<a class="ae kv" href="https://www.udemy.com/course/responsive-web-design-tutorial-course-html5-css3-bootstrap/" rel="noopener ugc nofollow" target="_blank">响应式网页设计基础——html 5 CSS3引导</a>的伟大课程。这些视频信息量很大，练习也很棒，丹尼尔设法以一种非常有效和有趣的方式传播他的知识。</p><p id="3f20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">29.用下面的代码填充<code class="fe mb mc md me b">templates/base.html</code>文件。这将是将在其他HTML页面中扩展的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="57e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意<code class="fe mb mc md me b">base.html</code>中出现的以下新结构:</p><ul class=""><li id="8dfc" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated"><code class="fe mb mc md me b">{% block head %}</code>和<code class="fe mb mc md me b">{% endblock %}</code>；</li><li id="a585" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr mw ly lz ma bi translated"><code class="fe mb mc md me b">{% block content %}</code>和<code class="fe mb mc md me b">{% endblock %}</code>；</li><li id="2673" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr mw ly lz ma bi translated"><code class="fe mb mc md me b">{% if title %}</code>和<code class="fe mb mc md me b">{% else %}</code>和<code class="fe mb mc md me b">{% endif %}</code>；</li><li id="226c" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr mw ly lz ma bi translated"><code class="fe mb mc md me b">{{title}}</code>。</li></ul><p id="bd6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">符号<code class="fe mb mc md me b">{% %}</code>在Django模板语言中被广泛使用。使用基本模板，<code class="fe mb mc md me b">{% block BLOCKNAME %}</code>和<code class="fe mb mc md me b">{% endblock %}</code>标签用于标记我们应用程序中每个页面的特定代码块的插入点。</p><p id="18d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Django模板语言使用了很多过滤器，这些过滤器允许它在模板中执行函数和方法。例如，我们已经看到了在我们代码的早期阶段使用的<code class="fe mb mc md me b">{% url %}</code>过滤器:它接收一个字符串作为它的参数，以<code class="fe mb mc md me b">'app_name:route_name'</code>的形式，并且它返回一个web资源的绝对路径。例如:<code class="fe mb mc md me b">{% url 'films:user_info %}</code>将获得名为<code class="fe mb mc md me b">user_info</code>的路线，在<code class="fe mb mc md me b">films</code>应用程序中，它将以字符串形式返回其路径，并将其呈现在HTML页面上。</p><p id="6aa3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以注意到，Django允许在模板中使用条件语句。正如我们将在后面看到的，循环的<em class="mt">在这里也是可能的，这有助于创建更易维护的代码。</em></p><p id="abb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，注意<code class="fe mb mc md me b">{{title}}</code>中的双花括号。这是Django呈现视图传递给模板的Python变量的方式。我们还没有做到这一点，但我们以后会的。</p><p id="016a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">30.替换HTML文件的内容，如下所示:</p><ul class=""><li id="48a9" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated"><code class="fe mb mc md me b">templates/home.html</code>:</li></ul><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="a48b" class="mj mk iq me b gy ml mm l mn mo">{% extends 'base.html' %}</span><span id="3646" class="mj mk iq me b gy ms mm l mn mo">{% block content %}</span><span id="d20c" class="mj mk iq me b gy ms mm l mn mo">&lt;h1&gt;This is the Home Page&lt;/h1&gt;<br/>&lt;br&gt;<br/>&lt;h3&gt;Thanks for visiting us&lt;/h3&gt;<br/>&lt;br&gt;<br/>&lt;p&gt;MVT means:&lt;/p&gt;<br/>&lt;ul&gt;<br/>  &lt;li&gt;Model&lt;/li&gt;<br/>  &lt;li&gt;View&lt;/li&gt;<br/>  &lt;li&gt;Template&lt;/li&gt;<br/>&lt;/ul&gt;</span><span id="5110" class="mj mk iq me b gy ms mm l mn mo">{% endblock  %}</span></pre><ul class=""><li id="114d" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated"><code class="fe mb mc md me b">films/templates/films/main.html</code>:</li></ul><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="9aaa" class="mj mk iq me b gy ml mm l mn mo">{% extends 'base.html' %}</span><span id="4ae1" class="mj mk iq me b gy ms mm l mn mo">{% block content %}</span><span id="e591" class="mj mk iq me b gy ms mm l mn mo">&lt;h1&gt;This is the films MAIN page&lt;/h1&gt;<br/>&lt;br&gt;<br/>&lt;h4&gt;Some Pixar Movies:&lt;/h4&gt;</span><span id="8918" class="mj mk iq me b gy ms mm l mn mo">&lt;ul&gt;<br/>  {% for number in '012'|make_list %}<br/>    &lt;li&gt;Toy Story {{forloop.counter}}&lt;/li&gt;<br/>  {% endfor %}<br/>&lt;/ul&gt;</span><span id="1893" class="mj mk iq me b gy ms mm l mn mo">{% endblock  %}</span></pre><ul class=""><li id="daf5" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated"><code class="fe mb mc md me b">films/templates/films/user_info.html</code>:</li></ul><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="090e" class="mj mk iq me b gy ml mm l mn mo">{% extends 'base.html' %}</span><span id="98d4" class="mj mk iq me b gy ms mm l mn mo">{% block content %}</span><span id="9567" class="mj mk iq me b gy ms mm l mn mo">&lt;h1&gt;This is the films USER_INFO page&lt;/h1&gt;<br/>&lt;br&gt;</span><span id="44a4" class="mj mk iq me b gy ms mm l mn mo">{% if userinfo %}<br/>  &lt;h4&gt;username: {{userinfo.username}}&lt;/h4&gt;<br/>  &lt;h4&gt;country: {{userinfo.country}}&lt;/h4&gt;<br/>{% else %}<br/>  &lt;h4&gt;username: not informed&lt;/h4&gt;<br/>  &lt;h4&gt;country: not informed&lt;/h4&gt;<br/>{% endif %}</span><span id="a340" class="mj mk iq me b gy ms mm l mn mo">{% endblock  %}</span></pre><p id="caf8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意这最后三个HTML文件是如何以<code class="fe mb mc md me b">{% extends 'base.html' %}</code>开始的，这表明我们正在扩展来自<code class="fe mb mc md me b">base.html</code>文件的模板信息。而且我们希望每个页面显示的HTML在<code class="fe mb mc md me b">{% block content %}</code>……<code class="fe mb mc md me b">{% endblock %}</code>标签之间，显示我们希望它从<code class="fe mb mc md me b">base.html</code>插入到这些标签所在的地方。</p><p id="e926" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在用<code class="fe mb mc md me b">python manage.py check</code>查找错误，然后用<code class="fe mb mc md me b">python manage.py runserver</code>运行服务器。看看我们的页面现在有多像样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/fe948902edba583514f2e18f7c45b024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLQObP8bvxSBurdK6orUxA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="25b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第5部分:将PYTHON变量传递给模板</strong></p><p id="5220" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">31.现在打开<code class="fe mb mc md me b">films/views.py</code>，为这个新版本替换旧代码。然后运行服务器，注意这一变化如何影响页面标题中显示的信息(浏览器选项卡中显示的文本元信息)和<code class="fe mb mc md me b">user_info</code>页面中显示的用户信息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="aad4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们所看到的，<code class="fe mb mc md me b">render()</code>函数可以接收一个字典(通常命名为<code class="fe mb mc md me b">context</code>或<code class="fe mb mc md me b">ctx</code>)作为它的第三个参数。然后，我们可以通过使用不带引号的键来访问这些字典值。</p><p id="3923" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，注意<code class="fe mb mc md me b">title</code>变量及其值如何出现在视图和<code class="fe mb mc md me b">base.html</code>模板条件结构中。<code class="fe mb mc md me b">home</code>视图函数不传递标题信息，因此<code class="fe mb mc md me b">title</code>值将为<code class="fe mb mc md me b">None</code>，并且将执行<code class="fe mb mc md me b">else</code>子句，在主页上显示默认标题。另一方面，<code class="fe mb mc md me b">main</code>和<code class="fe mb mc md me b">user_info</code>视图函数在上下文字典中都有一个键<code class="fe mb mc md me b">'title'</code>，所以它的值将是‘truthy’，并且将执行<code class="fe mb mc md me b">if</code>子句，在呈现模板时在标签浏览器中显示<code class="fe mb mc md me b">title</code>值。</p><p id="e1fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似的事情发生在由<code class="fe mb mc md me b">user_info</code>视图函数传递给<code class="fe mb mc md me b">user_info.html</code>模板的<code class="fe mb mc md me b">userinfo</code>变量上。还要注意，我们将使用点符号来访问嵌套值，类似于Javascript对象中使用的符号。如果您尝试从Python中使用<code class="fe mb mc md me b">context[key]</code>结构访问嵌套字典中的值，将无法工作，并且会出现错误。</p><p id="8934" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第6部分:使用DJANGO模型创建自己的数据库表</strong></p><p id="73ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">32.打开<code class="fe mb mc md me b">films/models.py</code>，插入下面的代码。我们将创建我们的第一个Django模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="8be9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意，Django模型是作为继承自<code class="fe mb mc md me b">models.Model</code> Django类的类创建的。我们在这里创建两个表:<code class="fe mb mc md me b">genre</code>和<code class="fe mb mc md me b">film</code>，实际上分别有2和4列。我们不必在代码中为每个模型添加<code class="fe mb mc md me b">id</code>列，因为在<code class="fe mb mc md me b">project/settings.py</code>文件中，变量<code class="fe mb mc md me b">DEFAULT_AUTO_FIELD</code>被配置为为每个模型表创建一个具有自动递增整数值的<code class="fe mb mc md me b">id</code>列。</p><p id="0dfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还要注意的是，<code class="fe mb mc md me b">Film</code>模型有一个名为<code class="fe mb mc md me b">genre</code>的外键列，具有一对多关系。这两张表之间的关系并不完美。不过，出于教学目的，我们在这里使用一个更简化的模型，因为多对多模型更复杂，应该马上学习。</p><p id="725c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">32.运行<code class="fe mb mc md me b">python manage.py makemigrations</code>来创建迁移文件，这些文件将设置Django必须如何创建这两个新表<code class="fe mb mc md me b">film</code>和<code class="fe mb mc md me b">genre</code>。</p><p id="5d9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">33.现在运行<code class="fe mb mc md me b">python manage.py migrate</code>命令，按照上次迁移中创建的指令，在<code class="fe mb mc md me b">db.sqlite3</code>数据库中实际创建两个表。它们在数据库中的名称前面会有应用程序名称，所以实际的表名将是<code class="fe mb mc md me b">films_film</code>和<code class="fe mb mc md me b">films_genre</code>，如果您想运行一些SQL代码来检查它们的话。</p><p id="1462" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们准备填充我们创建的这些新表。我将在这里展示两种不同的方法:</p><ul class=""><li id="19de" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated">使用管理区</li><li id="6028" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr mw ly lz ma bi translated">使用Django shell</li></ul><p id="6ed2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">34.打开<code class="fe mb mc md me b">films/admin.py</code>，添加以下代码:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="966c" class="mj mk iq me b gy ml mm l mn mo">from django.contrib import admin<br/>from .models import Film, Genre</span><span id="9fad" class="mj mk iq me b gy ms mm l mn mo"><br/>admin.site.register(Film)<br/>admin.site.register(Genre)</span></pre><p id="3177" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过这样做，我们使得管理应用程序可以访问<code class="fe mb mc md me b">Film</code>和<code class="fe mb mc md me b">Genre</code>模型。</p><p id="a463" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">35.现在转到<code class="fe mb mc md me b">http://localhost:8000/admin/</code>，输入你创建的超级用户的登录信息，检查两个新模型是如何出现在屏幕上的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/b74a7eb0e9b6c219f758e9c75affc168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3DSfpBXPpff1IuvY4Hyx1Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="31ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">36.点击<code class="fe mb mc md me b">Films</code>链接，找到<code class="fe mb mc md me b">Add Film</code>按钮，填写字段并保存信息。你可以点击旁边的绿色加号在这个页面上添加一个新的流派。这将在<code class="fe mb mc md me b">genre</code>表中插入一个新行。至少保存三部新电影。我保存了四部《黑客帝国》电影，你可以看到它们的名字被很好地列在管理区。我可以点击他们中的任何一个，对他们的数据进行更改，然后按保存按钮。所有这些更改都会自动保存在Django应用程序的sqlite3数据库中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/05fdcb2a5d905867039df4a0b9a35de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQpY4MjipvNyu_lKFOvxyg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e1ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">37.现在停止服务器并在终端中运行<code class="fe mb mc md me b">python manage.py shell</code>。Django解释器将会打开。这是另一个非常酷的特性:它不仅允许你用解释器运行Python代码，还可以加载你所有的项目文件。因此，您可以使用您的项目文件在这里运行Django命令，比如我们刚刚创建的模型。</p><p id="c78a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将使用Django ORM中的一些命令。它允许我们编写在数据库中运行查询的Python代码。使用ORM的优势在于，如果我们想要将数据库连接更改为MySQL或PostgreSQL，我们只需要在<code class="fe mb mc md me b">project/settings.py</code>中设置正确的数据库配置。所有使用Django ORM(带有Python代码)的查询都将保持不变，这在我看来很棒。</p><p id="7d2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">38.在我们刚刚初始化的Django shell中键入以下命令。这将创建新的<code class="fe mb mc md me b">Film</code>和<code class="fe mb mc md me b">Genre</code>对象，将它们保存到各自的表中，并显示一个针对<code class="fe mb mc md me b">films_film</code>表中所有电影的选择查询的快速示例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/363eac65cf7ec2e1b03561494588d76b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uT8ybTgotOcshHl0qXlkMA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="566b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将使用我们创建的这些新模型，并将它们连接到我们的视图，以便数据库数据可以从<code class="fe mb mc md me b">films</code>应用程序显示在我们的主网页上。</p><p id="4513" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">39.在<code class="fe mb mc md me b">films/views.py</code>内部，导入<code class="fe mb mc md me b">Film</code>模型，改变<code class="fe mb mc md me b">main</code>视图功能。保持其他视图不变:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="eeef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">40.打开<code class="fe mb mc md me b">films/main.html</code>并将其内容更改为以下代码。请注意我们如何使用for循环来显示保存在数据库中的所有电影信息。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="23c1" class="mj mk iq me b gy ml mm l mn mo">{% extends 'base.html' %}</span><span id="3577" class="mj mk iq me b gy ms mm l mn mo">{% block content %}</span><span id="d405" class="mj mk iq me b gy ms mm l mn mo">&lt;h1&gt;This is the films MAIN page&lt;/h1&gt;<br/>&lt;br&gt;<br/>&lt;h4&gt;Films saved in our database:&lt;/h4&gt;</span><span id="e6e4" class="mj mk iq me b gy ms mm l mn mo">&lt;ul&gt;<br/>{% for film in films_list %}<br/>  <br/>  &lt;li&gt;{{film.title}} ({{film.year}}, genre: "{{film.genre}}")&lt;/li&gt;</span><span id="1cae" class="mj mk iq me b gy ms mm l mn mo">{% endfor %}<br/>&lt;/ul&gt;</span><span id="585c" class="mj mk iq me b gy ms mm l mn mo">{% endblock  %}</span></pre><p id="892c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是我接入<code class="fe mb mc md me b"><a class="ae kv" href="http://localhost:8000/main." rel="noopener ugc nofollow" target="_blank">http://localhost:8000/films</a></code>后的画面。它显示了我保存在数据库中的所有五部电影(四部黑客帝国电影和海底总动员)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/5168f192dad53b1d663d1784a6367c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GDuEXjZ1ks9uTn5EABCCjQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3c8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这只是一个简单的例子，展示了我们如何显示数据库中的信息，并将其发送到我们的页面之一。实际上，Django有一些定制的视图，以类的形式构建，我们可以用它们来完成一些最常见的任务，比如在网页上列出所有的观察结果(或者部分观察结果)。这是由<code class="fe mb mc md me b"><strong class="ky ir">django.views.generic.list.ListView</strong></code>类完成的。</p><p id="7703" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个介绍性教程中，我们不会讨论更多关于视图类的内容。如果你想了解更多信息，请查看Django文档页面。</p><p id="ce3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第7部分:查询参数</strong></p><p id="57fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">到目前为止，我们只处理了GET请求。当我们用GET方法发出请求时，我们可以传递直接附加到URL的参数，称为查询参数。我们将修改<code class="fe mb mc md me b">user_info</code>视图函数，使用这些参数作为模板的输入。</p><p id="1e6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">41.在<code class="fe mb mc md me b">films/views.py</code>的<code class="fe mb mc md me b">user_info</code>函数中进行以下修改，保留文件中的其他行。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="d7fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个新版本中，我们使用了一个<code class="fe mb mc md me b">if</code> / <code class="fe mb mc md me b">elif</code>结构来检查请求方法。我们还不会访问<code class="fe mb mc md me b">elif</code>部分，但是我已经选择将它写在代码中，这样您就可以看到我们如何根据请求方法是GET还是POST来让视图函数运行代码。例如，如果我们使用基于类的视图，我们将有两个类方法(<code class="fe mb mc md me b">.get()</code>和<code class="fe mb mc md me b">.post()</code>)，每个方法处理各自的请求类型。</p><p id="7b85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还想提醒您注意重要的<code class="fe mb mc md me b">request.GET</code>属性，它使用URL中使用的所有查询参数来访问字典。</p><p id="d080" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">42.现在，访问<code class="fe mb mc md me b">user_info</code> URL并添加必要的查询参数，如下例所示:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="1b08" class="mj mk iq me b gy ml mm l mn mo"><a class="ae kv" href="http://localhost:8000/films/user_info/?username=Novo&amp;country=Sui%C3%A7a" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/films/user_info/?username=Neo&amp;country=USA</a></span></pre><p id="70f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意问号是如何用于开始编写查询参数的。这里我们有两个(用户名和国家)，值分别为“Neo”和“USA”。此外，我们可以观察到查询参数名称/值由等号分隔，而&amp;符号用于分隔不同的参数。</p><p id="339e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">继续更改参数值，按enter键，并查看页面上的值将如何变化。还可以查看控制台，了解查询参数字典的结构。您可以使用<code class="fe mb mc md me b">request.GET.get(KEY)</code>代码获得它的任何值。</p><p id="c8c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第8部分:</strong> <strong class="ky ir"> HTML表单和帖子请求</strong></p><p id="f2e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们用POST方法构建一个HTML表单。</p><p id="de26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">43.创建<code class="fe mb mc md me b">films/templates/films/user_form.html</code>文件，并将以下HTML代码放入其中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="fa75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">44.在<code class="fe mb mc md me b">templates/base.html</code>导航栏中做一个小改动，添加一个链接到新的<code class="fe mb mc md me b">user_form</code>页面。我不会在这里重复所有的<code class="fe mb mc md me b">base.html</code>代码；我将在结束的<code class="fe mb mc md me b">&lt;/ul&gt;</code>标签之前添加额外的<code class="fe mb mc md me b">&lt;li&gt;</code>标签:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="3b0a" class="mj mk iq me b gy ml mm l mn mo">&lt;li class="nav-item active"&gt;<br/>  &lt;a class="nav-link active" href="{% url 'films:user_form' %}"&gt;UserForm&lt;/a&gt;<br/>&lt;/li&gt;</span></pre><p id="aa91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">45.向<code class="fe mb mc md me b">films/urls.py</code>添加新路线。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="2067" class="mj mk iq me b gy ml mm l mn mo">from django.urls import path<br/>from . import views</span><span id="1fe4" class="mj mk iq me b gy ms mm l mn mo">app_name = 'films'</span><span id="476f" class="mj mk iq me b gy ms mm l mn mo">urlpatterns = [<br/>    path('', views.main, name='main'),<br/>    path('user_info/', views.user_info, name='user_info'),<br/>    <br/>    ## new route below ##<br/>    path('user_form/', views.user_form, name= 'user_form'),<br/>]</span></pre><p id="94eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">46.在<code class="fe mb mc md me b">films/views.py</code>中，一方面修改imports和<code class="fe mb mc md me b">user_info</code>视图，另一方面创建<code class="fe mb mc md me b">user_form</code>视图。由于这里做了很多修改，所以我给出了所有修改过的文件代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="4803" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们更详细地评论一下这个新的<code class="fe mb mc md me b">films/views.py</code>代码。当我们第一次访问<code class="fe mb mc md me b">http://localhost:8000/films/user_form</code>时，这将是一个GET请求，因此视图中的<code class="fe mb mc md me b">if</code>子句将被执行，只是加载各自的模板。但是当我们填写表单字段并按下submit按钮时，POST方法被激活，并且运行<code class="fe mb mc md me b">elif</code>子句中的代码。</p><p id="dbb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我在Charles Severance教授的课程中所学到的，将POST请求中的数据发送到不同于表单所在的URL是一个很好的做法。当我们这样做时，一个GET请求将被调用到新的URL，并且POST数据将会丢失。</p><p id="b33c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，在我们进入下一页之前，我们需要保存表单中传递的数据。我们通过对每个输入字段使用<code class="fe mb mc md me b">request.POST.get(KEY)</code>来做到这一点，其中<code class="fe mb mc md me b">KEY</code>是来自相应的<code class="fe mb mc md me b">&lt;input&gt;</code> HTML标签的name属性的值，所以我们不能忘记设置它们。然后我们可以将这些值传递给位于<code class="fe mb mc md me b">request.session</code>的另一个字典，这非常有帮助。它允许将数据存储在当前浏览器会话中，并在不同时刻由我们的代码检索。这就是为什么我们可以在<code class="fe mb mc md me b">user_info</code>视图中使用保存在会话字典中的信息并显示它们。</p><p id="ddfe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第9部分:路线参数和详细页面</p><p id="61ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">47.在<code class="fe mb mc md me b">films/urls.py</code>创建新路线。我们将只在下面显示这一行，但是您已经知道如何将它插入到文件中。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="2e7a" class="mj mk iq me b gy ml mm l mn mo">(...)</span><span id="8e1c" class="mj mk iq me b gy ms mm l mn mo">path('&lt;int:id&gt;/details', views.details, name='details')</span><span id="42fa" class="mj mk iq me b gy ms mm l mn mo">(...)</span></pre><p id="9df0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意新的符号<code class="fe mb mc md me b">&lt;int:id&gt;</code>。这里的<code class="fe mb mc md me b">&lt; &gt;</code>符号显示我们正在处理一个新的参数类型，称为路由参数。<code class="fe mb mc md me b">int</code>显示它是来自<code class="fe mb mc md me b">int</code>类的一个对象，并且<code class="fe mb mc md me b">id</code>告诉Django这里需要一个主键。</p><p id="b4fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">48.用以下内容创建<code class="fe mb mc md me b">films/templates/films/details.html</code>模板。我们现在将使用一个带有一些引导类的HTML表结构。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="e77e" class="mj mk iq me b gy ml mm l mn mo">{% extends 'base.html' %}</span><span id="1757" class="mj mk iq me b gy ms mm l mn mo">{% block content %}</span><span id="5229" class="mj mk iq me b gy ms mm l mn mo">&lt;h1&gt;Film details:&lt;/h1&gt;<br/>&lt;br&gt;</span><span id="7052" class="mj mk iq me b gy ms mm l mn mo">&lt;table class="table" style="width: 30%"&gt;<br/>  &lt;thead&gt;<br/>    &lt;tr&gt;<br/>      &lt;th scope="col"&gt;Attribute&lt;/th&gt;<br/>      &lt;th scope="col"&gt;Value&lt;/th&gt;<br/>    &lt;/tr&gt;<br/>  &lt;/thead&gt;<br/>  &lt;tbody&gt;<br/>    &lt;tr&gt;<br/>      &lt;td scope="row"&gt;Title:&lt;/td&gt;<br/>      &lt;td class="text-dark"&gt;{{film.title}}&lt;/td&gt;<br/>    &lt;/tr&gt;<br/>    &lt;tr&gt;<br/>      &lt;td scope="row"&gt;Year:&lt;/td&gt;<br/>      &lt;td&gt;{{film.year}}&lt;/td&gt;<br/>    &lt;/tr&gt;<br/>    &lt;tr&gt;<br/>      &lt;td&gt;Genre:&lt;/td&gt;<br/>      &lt;td&gt;{{film.genre}}&lt;/td&gt;<br/>    &lt;/tr&gt;<br/>  &lt;/tbody&gt;<br/>&lt;/table&gt;</span><span id="3799" class="mj mk iq me b gy ms mm l mn mo">{% endblock  %}</span></pre><p id="e121" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">49.在<code class="fe mb mc md me b">films/views.py</code>中添加新的<code class="fe mb mc md me b">details</code>视图。我注释掉了一行代码，它也可以用于通过id查询单个元素。注意电影id是如何作为一个额外的参数传递给视图的。</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="f901" class="mj mk iq me b gy ml mm l mn mo">def details(request, id):<br/>    film = Film.objects.get(id=id)<br/>    # other query option:<br/>    # film = Film.objects.filter(id=id)[0]<br/>    context = {'film': film}<br/>    return render(request, 'films/details.html', context)</span></pre><p id="5581" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">50.现在选择一条类似<code class="fe mb mc md me b">http://localhost:8000/films/1/details</code>的路线，并查看这部电影的详细信息。手动更改id号，以便您可以查看其他影片的详细信息。如果选择了一个不存在的id号，视图将会产生一个错误，因为它没有针对这种情况的错误处理代码。所以，如果你觉得有趣，就去搜索处理这类问题的方法。</p><p id="fdb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第10部分:在DJANGO中使用PLOTLY图</p><p id="0136" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一部分可能对那些想把这两个惊人的资源放在一起的人有用:Plotly graphs和Django。这里需要注意的最重要的事情如下:</p><ul class=""><li id="e0b1" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr mw ly lz ma bi translated">从一个Plotly图形对象使用<code class="fe mb mc md me b">.to_html()</code>方法，并将其保存在一个上下文字典中，名称如<code class="fe mb mc md me b">fig</code>。</li><li id="fcc6" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr mw ly lz ma bi translated">在Django模板中，使用标签<code class="fe mb mc md me b">{{fig | safe}}</code>来呈现图形。</li></ul><p id="979e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将在这里使用Gapminder数据集来加快速度。因为它与电影无关，所以创建另一个Django应用程序是正确的程序。但我不会那么做。相反，我将在<code class="fe mb mc md me b">films</code>路径之外放置一条新路径，并借用<code class="fe mb mc md me b">films/views.py</code>来存储显示图表所需的视图和辅助功能。我还将使用路线参数按年份过滤图表。</p><p id="d4a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">51.打开<code class="fe mb mc md me b">project/urls.py</code>并添加新的Gapminder路线:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="358b" class="mj mk iq me b gy ml mm l mn mo">from django.contrib import admin<br/>from django.urls import path, include<br/>from films import views</span><span id="0d74" class="mj mk iq me b gy ms mm l mn mo"><br/>urlpatterns = [<br/>    path('', views.home, name='home'),<br/>    path('admin/', admin.site.urls),<br/>    path('films/', include('films.urls')),</span><span id="d943" class="mj mk iq me b gy ms mm l mn mo">    # new route: <br/>    path('gapminder/&lt;int:year&gt;', views.gapminder, name='gapminder'),<br/>]</span></pre><p id="2670" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<code class="fe mb mc md me b">films/views.py</code>中，我们将添加两个不是Django视图的函数，因为它们不会处理HTTP请求。函数<code class="fe mb mc md me b">get_data()</code>只从<code class="fe mb mc md me b">plotly.express</code>获取Gapminder数据集作为Pandas数据帧。并且<code class="fe mb mc md me b">create_plot()</code>会生成著名的Gapminder气泡图。这些函数在<code class="fe mb mc md me b">gapminder</code>函数视图中被调用，year route参数在这里用于在生成图表之前过滤数据集。</p><p id="4be0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">52.用PIP安装Pandas和Plotly:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="80cb" class="mj mk iq me b gy ml mm l mn mo">pip install pandas plotly</span></pre><p id="3fa4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">53.打开<code class="fe mb mc md me b">films/views.py</code>，导入Plotly Express，在最后一次导入后，定义<code class="fe mb mc md me b">get_data()</code>和<code class="fe mb mc md me b">create_plot()</code>功能:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="f5dd" class="mj mk iq me b gy ml mm l mn mo">import plotly.express as px</span><span id="bd4b" class="mj mk iq me b gy ms mm l mn mo"># keep the other imports</span><span id="78cc" class="mj mk iq me b gy ms mm l mn mo">(...)</span><span id="9b34" class="mj mk iq me b gy ms mm l mn mo">def get_data():<br/>    df = px.data.gapminder()<br/>    return df</span><span id="b0f5" class="mj mk iq me b gy ms mm l mn mo">def create_plot(df, year):<br/>    fig = px.scatter(<br/>      data_frame = df.query(f'year=={year}'),<br/>      x = 'gdpPercap',<br/>      y = 'lifeExp',<br/>      color = 'continent',<br/>      size = 'pop',<br/>      height = 500,<br/>      log_x=True,<br/>      size_max=60,<br/>      hover_name="country")<br/>      <br/>    fig =  fig.to_html()<br/>    return fig</span></pre><p id="4552" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">54.在<code class="fe mb mc md me b">films/views.py</code>结束时，创建<code class="fe mb mc md me b">gapminder</code>视图:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="8dff" class="mj mk iq me b gy ml mm l mn mo">def gapminder(request, year):<br/>    df = get_data()<br/>    fig = create_plot(df, year)<br/>    context = {"plot": fig, "year": year}<br/>    template = 'gapminder.html'<br/>    return render(request, template, context)</span></pre><p id="a4d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">55.创建文件<code class="fe mb mc md me b">templates/gapminder.html</code>并在其中写入以下代码:</p><pre class="kg kh ki kj gt mf me mg mh aw mi bi"><span id="c32d" class="mj mk iq me b gy ml mm l mn mo">{% extends 'base.html' %}</span><span id="4f27" class="mj mk iq me b gy ms mm l mn mo">{% block content %}</span><span id="9d6b" class="mj mk iq me b gy ms mm l mn mo">&lt;h1 class="text-center"&gt;GAPMINDER (YEAR {{year}})&lt;/h1&gt;<br/>&lt;div class="container-fluid d-flex justify-content-center"&gt;<br/>  {{plot | safe}}<br/>&lt;/div&gt;</span><span id="29be" class="mj mk iq me b gy ms mm l mn mo">{% endblock  %}</span></pre><p id="a60b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">56.访问Gapminder数据集中的一个带有年份的URL(比如<code class="fe mb mc md me b">http://localhost:8000/gapminder/2007</code>)并播放您的网页及其漂亮的交互式图表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/74cdd014798ee1da3c70372671cf787c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZlmU0ZdyG6Xbe3fL8slGA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="2688" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">遗言</strong></p><p id="3dcb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你到达这里并征服了这个教程，你就是一个真正的战士。恭喜你！Django是一个完整的世界，还有很多需要了解的；只要坚持学习和练习，成功就会到来。</p><p id="9902" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">亲爱的读者，非常感谢你花时间和精力阅读我的文章。</p><p id="7e08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mt">快乐编码！</em></p></div></div>    
</body>
</html>