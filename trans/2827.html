<html>
<head>
<title>Correlation vs covariance: it’s much simpler than it seems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">相关性vs协方差:这比看起来简单得多</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/correlation-vs-covariance-its-much-simpler-than-it-seems-2e9a5d33945b#2022-06-20">https://towardsdatascience.com/correlation-vs-covariance-its-much-simpler-than-it-seems-2e9a5d33945b#2022-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9491" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">什么是相关性？我们如何计算连续变量之间的相关性？和协方差有什么区别？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/68b0ca89de48ace82d1fe9f184c1c8c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*49MaQR5GcVdsN8TgjBgtqg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">显然，两个人都明白什么是相关性。吉尔·威灵顿摄:<a class="ae kv" href="https://www.pexels.com/it-it/foto/due-persone-in-piedi-nella-fotografia-di-sagoma-40815/" rel="noopener ugc nofollow" target="_blank">https://www . pexels . com/it-it/foto/due-persone-in-piedi-nella-fotografia-di-sa Goma-40815/</a></p></figure><p id="212d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">机器学习是一个奇妙的研究领域。研究机器学习意味着从最不同的领域(数学、金融、生物学、计算机科学等)获取最有趣的概念，目的是产生准确可靠的预测模型。在我在<a class="ae kv" href="https://datamasters.it/" rel="noopener ugc nofollow" target="_blank"> Datamasters </a>担任机器学习和数据科学教师的经历中，学生们不止一次对与数据科学世界相关的基本概念和索引感到困惑。在我的第一篇文章中(这里有意大利语的<a class="ae kv" href="https://medium.com/@mastrandreagiuseppe/come-non-avere-paura-di-deviazione-standard-varianza-e-covarianza-12425a9dca09" rel="noopener"/>)，我写了一些指数:方差、标准差和协方差。</p><p id="0e9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我们将研究另一个听起来令人困惑的指数，但是让我告诉你:它绝对不是火箭科学。我们说的是<strong class="ky ir">相关</strong>系数。相关性看起来很像协方差，它的使用非常精确:为我们提供关于两个随机变量之间存在<strong class="ky ir">关系</strong>的信息(如果是的话，还有存在的<em class="ls">种类</em>)。不同寻常的是，在“相关性”这个术语下，可以找到许多彼此非常不同的公式和系数。一个系数对另一个系数的使用是基于我们想要计算相关性的变量的类型。</p><p id="1528" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">似乎是件大事，嗯？嗯，也许吧。事实是，在某些情况下，事实证明这根本不是限制性的，比你所能想象的要简单得多。让我们从两个随机变量开始，旧好的6个人的“体重”和“身高”:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="705c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们想象一下这些要点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lv"><img src="../Images/1ac57d491a8a2109b18e5f5509847328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KcJ9qWC83u5XW5ol"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用pyplot制作的数据集的可视化。图片由作者提供。</p></figure><p id="35df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开始之前，我们先做个声明。这些变量是<em class="ls">数字</em>，即可以在一个数字集合或该集合的区间中采用任何值的变量。它们是<strong class="ky ir">而不是</strong> <strong class="ky ir">分类变量</strong>(其可能值在预定义的集合中的变量，例如“头发颜色”，该集合中可能只有值[“棕色”、“金发”、“黑色”等])。对于我们之前介绍的数值变量，计算相关系数的最常见方法是使用<strong class="ky ir">皮尔逊系数</strong>。公式是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lw"><img src="../Images/d027410b308f805a0acb0445656c33d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TyvPulkgZZqKvMsQ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">皮尔逊相关系数。图片由作者提供。</p></figure><p id="89f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们所看到的，皮尔逊相关只不过是一个分数，分子是协方差，分母是变量标准差的乘积。</p><p id="da60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">皮尔逊系数用于检测两个随机连续变量之间的线性关系。如果您想测量两个随机变量之间的非线性关系，您只需使用其他系数(如Spearman系数)。计算两个随机变量样本之间相关性的公式<a class="ae kv" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient#For_a_sample" rel="noopener ugc nofollow" target="_blank">稍微复杂一些</a>，但基本上我们总是使用相对于变量标准偏差“标准化”的协方差测量。毕竟，为了计算两个随机变量(X，Y)之间的相关性，我们必须:</p><ul class=""><li id="9998" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated">计算变量平均值</li><li id="7d58" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">计算变量std。偏差<br/> -计算每个样本与变量平均值之差的平方<br/> -对所有这些平方求和<br/> -除以样本数<br/> -求这个分数的平方根</li><li id="0566" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">计算X和Y之间的协方差<br/> -对于我们数据集中的每个条目，计算X分量和X均值之间的差，并将其乘以Y分量和Y均值之间的差<br/> -对这些乘积求和<br/> -除以样本数</li></ul><p id="7222" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">说起来容易做起来难。让我们继续:</p><p id="fe2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计算“体重”和“身高”的平均值:</p><p id="17e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">μ_w = 76KG <br/> μ_h = 180.33cm</p><p id="d0b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">计算标准。重量偏差:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/6bfe424ecc1fbc34d68c722e1f184aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fMhS8vOG8VSk15mC"/></div></div></figure><p id="bfaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们得到这样的结果:</p><p id="a0df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">σ_w = 13.5523</p><p id="8e53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">身高标准也是一样。偏差:</p><p id="1a4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">σ_h = 10.8115</p><p id="7789" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了计算协方差，我们必须考虑每个点(即初始表的单行/单对:[100，194]，[80，182]，[75，184]，…)，计算每个分量与其均值之间的差，然后将它们相乘，并对所有这些乘积求和。最后，我们除以6:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/3673ec2126ff284c5b8a1d5673200f78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s5McVKQrWQYqm0Qk"/></div></div></figure><p id="7471" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们得到的是体重和身高之间的<strong class="ky ir">协方差:</strong></p><p id="eeca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">cov(体重、身高)= 163公斤-厘米</p><p id="f077" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以计算体重和身高之间的皮尔逊相关:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/dd7ee8413654a49988d169c7508f9999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xY4W22N-DVnkEV56"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">体重和身高之间的皮尔逊相关</p></figure><p id="3921" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">被这些数字吓到了？</p><p id="d266" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好吧，如果你喜欢Python，你可以用NumPy用这几行代码得到同样的结果:</p><pre class="kg kh ki kj gt mn mo mp mq aw mr bi"><span id="b370" class="ms mt iq mo b gy mu mv l mw mx">import numpy </span><span id="78f6" class="ms mt iq mo b gy my mv l mw mx">weight = [100, 80, 75, 56, 66, 79]<br/>height = [194, 182, 184, 162, 171, 189]<br/>pearson_corr = numpy.corrcoef(weight, height)[0, 1]<br/>print(pearson_corr) # we'd get exactly 0.92932799</span></pre><p id="f491" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，休息一下，注意两件事。首先，相关性<strong class="ky ir">是一个无单位数。</strong>分子处的kg-cm对简化为分母处的标准偏差测量单位。仅这个特性就使得相关性<em class="ls">非常有趣，使用起来非常灵活。但是真正改变游戏规则的是相关性有一个明确的区间:它总是一个介于-1和1之间的数字<strong class="ky ir">。其含义类似于协方差:</strong></em></p><ul class=""><li id="7ab9" class="lx ly iq ky b kz la lc ld lf lz lj ma ln mb lr mc md me mf bi translated">当X和Y之间的相关性在-1和0之间时，X和Y是<strong class="ky ir">反向相关</strong>:这意味着当X增加时，Y减少</li><li id="9711" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">当X和Y之间的相关性为0时，X和Y没有线性关系</li><li id="57a2" class="lx ly iq ky b kz mg lc mh lf mi lj mj ln mk lr mc md me mf bi translated">当X和Y之间的相关性在0和1之间时，X和Y直接相关<strong class="ky ir">:当X增加时，Y也增加。</strong></li></ul><p id="026b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，相关性越接近-1，反向相关性就越“明显”。当然，相关性越接近1，直接相关性就越明显。在我们的例子中，0.929<strong class="ky ir">非常</strong>接近1，这表明体重和身高之间有非常<strong class="ky ir">高的直接相关性</strong>:我们基本上是说一个人越高，他/她就越重。毕竟这是有道理的。只要看一眼图表，我们就能注意到体重和身高之间的相同关系:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/e83eff6082c23e35d67dd30900155b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PNzS3xVRSJx-vnKO"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">相当的正相关，是吧？图片由作者提供。</p></figure><p id="32c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们画出变量之间相关的另外两种情况。这里有一个非常接近-1的相关性:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/442adcc2da51d12771de2a27fd27c51c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vtRd7NX7ZXADUriB"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">相关性接近-1。图片由作者提供。</p></figure><p id="2954" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一个非常接近于0的相关性:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/e67e7dd52feb5cab875d424724a9ef83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XcotvnLhN7BfdlG8"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">相关性接近于0。图片由作者提供。</p></figure><p id="91ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在每个图表之前，我们用Python打印了<strong class="ky ir">相关矩阵</strong>，它类似于协方差矩阵。这是一个描述变量之间相关性的正方形表格。在主对角线上我们找到一个变量和<em class="ls">本身</em>之间的相关性，当然我们有最大相关值:1。在其他单元格中，我们有行值和列值之间的相关性。但是在另一篇文章中有更多关于这个主题的内容。</p><p id="4628" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在文章结束之前，让我们快速回顾一下协方差和相关性的类比和区别。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/cbea2edfc441f47c797dc2c6c40dbb3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CguUJPfbFHlfajyU5fL-CA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者提供。</p></figure><p id="c2f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这篇文章对你的读者有用。不客气！</p></div></div>    
</body>
</html>