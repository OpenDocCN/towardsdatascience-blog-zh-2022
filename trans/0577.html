<html>
<head>
<title>Build a geospatial dashboard in Python using Greppo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Greppo在Python中构建地理空间仪表板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-a-geospatial-dashboard-in-python-using-greppo-60aff44ba6c9#2022-02-23">https://towardsdatascience.com/build-a-geospatial-dashboard-in-python-using-greppo-60aff44ba6c9#2022-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fdfb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">缺乏前端、后端和web开发经验会限制用Python制作web应用程序。不再是了…</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/175277dc47f5759e803e45dccd077a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*roDG3MBZhff1om23mZmU1w.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用Python中的Greppo构建的地理空间仪表板。图片作者。</p></figure><p id="a8c9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">地理空间数据分析已经成为数据科学中的一个常见领域。除了绘图和可视化，它主要包括通过检测和识别模式来提取知识，并建立模型进行预测。Python仍然是数据科学中的标准，对于地理空间数据科学也是如此。支持像<a class="ae lr" href="https://github.com/geopandas/geopandas" rel="noopener ugc nofollow" target="_blank"> GeoPandas </a>、<a class="ae lr" href="https://github.com/shapely/shapely" rel="noopener ugc nofollow" target="_blank"> Shapely </a>和<a class="ae lr" href="https://github.com/rasterio/rasterio" rel="noopener ugc nofollow" target="_blank"> Rasterio </a>这样的项目的社区已经使Python成为地理空间分析的首选。</p><p id="b707" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为一名数据科学家，与包括非技术人员在内的多个利益相关方合作是很常见的。将你的研究成果浓缩成非技术性叙述的能力非常有用。这一切都归结于沟通的结果如何能使利益相关者受益。为Python脚本创建仪表盘是讲述故事的有效方法。当您想要与外部利益相关者共享您的工作时，仪表板也很方便，只限制他们的交互和可视化，而不共享内部工作。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="3ab7" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">reppo:一种构建地理空间仪表板的快速简单的方法。</h1></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="9b5f" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">格雷波</h1><p id="bcb8" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">Greppo是一个用于构建地理空间网络应用的开源Python框架。它提供了现成的前端和后端组件作为函数，充当前端交互组件和绑定的后端变量之间的API。要了解更多关于心智模型的信息，请参考第<a class="ae lr" href="https://docs.greppo.io/mental-model.html" rel="noopener ugc nofollow" target="_blank">页</a>。</p><p id="3c72" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">TL；DR:没有太多的前端、后端和web开发经验，你可以用基本的Python在5分钟内构建和部署一个全功能的web应用程序。</strong></p><ul class=""><li id="eb48" class="ne nf iq kx b ky kz lb lc le ng li nh lm ni lq nj nk nl nm bi translated">GitHub库:<a class="ae lr" href="https://github.com/greppo-io/greppo" rel="noopener ugc nofollow" target="_blank">https://github.com/greppo-io/greppo</a></li><li id="cdc3" class="ne nf iq kx b ky nn lb no le np li nq lm nr lq nj nk nl nm bi translated">文件:<a class="ae lr" href="https://docs.greppo.io/" rel="noopener ugc nofollow" target="_blank">https://docs.greppo.io/</a></li><li id="ce17" class="ne nf iq kx b ky nn lb no le np li nq lm nr lq nj nk nl nm bi translated">网址:<a class="ae lr" href="https://greppo.io/" rel="noopener ugc nofollow" target="_blank">https://greppo.io/</a></li></ul><blockquote class="ns nt nu"><p id="6ec0" class="kv kw nv kx b ky kz jr la lb lc ju ld nw lf lg lh nx lj lk ll ny ln lo lp lq ij bi translated">在本教程中，我们将使用Greppo在Python中构建一个地理空间仪表板。我们将通过设置环境、安装、导入数据、为我们的仪表板添加组件和服务来完成工作。您需要了解Python、GeoPandas和地理空间分析的基础知识。</p></blockquote><h1 id="0c1d" class="lz ma iq bd mb mc nz me mf mg oa mi mj jw ob jx ml jz oc ka mn kc od kd mp mq bi translated">开始使用…</h1><p id="634b" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">首先要做的是安装Python并设置您的Python环境。对于新手来说，可以看看这篇<a class="ae lr" href="https://krishadi.com/zettelkasten/python/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="nv">博客文章</em> </strong> </a>来帮助你开始使用python环境。一旦你准备好了，让我们安装我们的依赖项。</p><pre class="kg kh ki kj gt oe of og oh aw oi bi"><span id="8efa" class="oj ma iq of b gy ok ol l om on">pip install greppo geopandas</span></pre><p id="9caa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下载本教程所需的数据集。本教程的所有数据和代码都可以在这个GitHub资源库中找到:<a class="ae lr" href="https://github.com/greppo-io/greppo-demo/tree/main/vector-demo" rel="noopener ugc nofollow" target="_blank">GRE PPO-demo/vector-demo</a>(数据来源:<a class="ae lr" href="https://github.com/openpolis/geojson-italy" rel="noopener ugc nofollow" target="_blank">https://github.com/openpolis/geojson-italy</a>)</p><h1 id="263a" class="lz ma iq bd mb mc nz me mf mg oa mi mj jw ob jx ml jz oc ka mn kc od kd mp mq bi translated">编写仪表板脚本</h1><p id="ce60" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">我们从建立项目的文件夹结构开始。我将使用以下项目文件夹结构:</p><pre class="kg kh ki kj gt oe of og oh aw oi bi"><span id="e2af" class="oj ma iq of b gy ok ol l om on">└── vector-demo<br/>    ├── app.py<br/>    ├── cities.geojson<br/>    ├── regions.geojson<br/>    └── roads.geojson</span></pre><p id="c5a4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们为仪表板创建Python脚本。应用程序的代码进入<strong class="kx ir"> <em class="nv"> app.py </em> </strong>。</p><p id="c611" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第0步:服务应用</strong></p><p id="4acf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要运行和提供应用程序，请打开一个终端并按照以下说明操作。首先，将目录(<code class="fe oo op oq of b">cd</code>)切换到项目文件夹<code class="fe oo op oq of b">vector_demo</code>。进入之后，激活安装了greppo的Python环境。我在这个例子中使用pyenv。然后运行应用程序，你需要做的就是运行<code class="fe oo op oq of b">greppo serve app.py</code>命令。命令<code class="fe oo op oq of b">serve</code>，启动服务器并编译<code class="fe oo op oq of b">app.py</code>中的代码，可以重命名为任何文件。注意:一定要在app.py所在的项目文件夹里面，或者使用<code class="fe oo op oq of b">greppo serve ./vector-demo/app.py</code>这样的相对文件夹结构。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/ab852af924841945893196fbd38fb10b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*In8t7r2-YJ63ZMkf4Cg7-Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从终端运行和服务应用程序。图片作者。</p></figure><p id="cd9d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后您将看到Uvicorn服务器在指定的位置运行。将地址复制并粘贴到浏览器中。然后加载应用程序。如果您对<code class="fe oo op oq of b">app.py</code>进行了任何更改，只需保存更改并重新加载web-app页面。您将在其中看到应用程序的更新更改。</p><p id="5806" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第一步:为应用程序搭建基础架构。</strong></p><p id="f452" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">即导入<code class="fe oo op oq of b">greppo</code>包并将<code class="fe oo op oq of b">base_layer</code>添加到地图中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="923e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你需要先从<code class="fe oo op oq of b">greppo</code>到<code class="fe oo op oq of b">import app</code>。这个<code class="fe oo op oq of b">app</code>对象将作为应用程序前端的接口，并为前端和后端之间的双向通信提供API。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/c0d1cebf7d8987dd6d444ba513f8637f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZh-0l2EpyzniAWrvCMF1A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">步骤1的结果。使用红色标记的控件进行切换。图片作者。</p></figure><p id="5f95" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要将一个<code class="fe oo op oq of b">base_layer</code>添加到您的应用程序地图中，只需使用带有所需参数的app API方法<code class="fe oo op oq of b">app.base_layer()</code>。参考<a class="ae lr" href="https://docs.greppo.io/" rel="noopener ugc nofollow" target="_blank">文档</a>了解哪些是必需的，哪些是可选的。<code class="fe oo op oq of b">base_layer</code>方法提供了两种方式来指定基础图块层。一种是使用<code class="fe oo op oq of b">name</code>和<code class="fe oo op oq of b">url</code>属性。另一种方法是使用一个<code class="fe oo op oq of b">provider</code>的名字。Greppo为此使用了<a class="ae lr" href="https://xyzservices.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> xyzservices </a>。有关供应商名称的列表，请点击此处查看此列表<a class="ae lr" href="https://xyzservices.readthedocs.io/en/stable/introduction.html" rel="noopener ugc nofollow" target="_blank">。注:证明人名称应完整，如<code class="fe oo op oq of b">CartoDB Positron</code>或<code class="fe oo op oq of b">OpenStreetMap Mapnik</code>所示。</a></p><p id="fda0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第二步:导入数据集并将其显示为叠加图。</strong></p><p id="f723" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用<code class="fe oo op oq of b">geopandas</code>，我们可以将矢量数据集作为<code class="fe oo op oq of b">GeoDataFrame</code>导入。然后可以使用<code class="fe oo op oq of b">app.vector_layer()</code>方法在网络应用程序的地图上显示出来。</p><p id="ef57" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里我导入了三个不同的数据集，每个数据集都有<code class="fe oo op oq of b">polygons </code>(意大利不同地区的边界)<code class="fe oo op oq of b">lines</code>(意大利的主要公路)和<code class="fe oo op oq of b">points</code>(意大利的主要城市)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="4708" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用方法<code class="fe oo op oq of b">app.vector_layer()</code>作为前端的API，我们可以显示矢量数据。您需要传入<code class="fe oo op oq of b">name</code>，其他参数是可选的。虽然，将<code class="fe oo op oq of b">color</code>或<code class="fe oo op oq of b">fillColor</code>传递给<code class="fe oo op oq of b">style</code>是区分和识别每一层的一个很好的练习。由于前端是基于<a class="ae lr" href="https://leafletjs.com/" rel="noopener ugc nofollow" target="_blank">活页</a>的，所以所有的样式都符合活页的规格，并且可以在<a class="ae lr" href="https://docs.greppo.io/map-components/vector-layer.html#styling-option-adopted-from-leaflet" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/817d0501f92691b450158e503ba63724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fy8xEkHSw1NKGhix7j1nFA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">步骤2的结果。使用红色标记的控件进行切换。</p></figure><p id="4982" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在这里找到所有关于vector_layer和样式的信息。注意:你也可以做一个Choropleth地图。相关文档可在<a class="ae lr" href="https://docs.greppo.io/map-components/vector-layer.html#choropleth" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="65d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第三步:显示应用内文本、应用标题和应用描述</strong></p><p id="0b7a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于有用的web应用程序，它需要携带一些文本来为用户提供一些指导和上下文。这些可以显示在组件旁边的侧边栏上。使用方法<code class="fe oo op oq of b">app.display()</code>可以在网络应用程序上显示降价文本。用同样的方法，可以设置app的<strong class="kx ir">标题</strong>和<strong class="kx ir">描述</strong>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="a708" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe oo op oq of b">app.display()</code>接受两个参数<code class="fe oo op oq of b">name</code>和<code class="fe oo op oq of b">value</code>。当<code class="fe oo op oq of b">value</code>包含要显示的文本时，<code class="fe oo op oq of b">name</code>必须是唯一的，并携带文本的标识符。如果<code class="fe oo op oq of b">name=’title’</code>传递的值是应用程序的标题，如果<code class="fe oo op oq of b">name=’description’</code>传递的值是应用程序的描述。如果没有这两者中的任何一个，应用程序将使用其默认标题和描述。鼓励设置app的标题和描述。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/4ff91e525c701fad69c8f3c4ce0fa8c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKievRGQTB40AVjaD8QGjw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">步骤3的结果。使用红色标记的控件进行切换。图片作者。</p></figure><p id="9517" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第四步:以图表形式显示数据</strong></p><p id="88a4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一个数据应用程序很难不用图表显示数据。Greppo还允许您将数据显示为图表。图表信息及其用法可在<a class="ae lr" href="https://docs.greppo.io/chart-components/index.html" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。这里，作为一个例子，给出了一个条形图，<code class="fe oo op oq of b">app.bar_chart()</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="af89" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">图表的必需参数是<code class="fe oo op oq of b">name</code>、<code class="fe oo op oq of b">x</code>和<code class="fe oo op oq of b">y</code>值。可以添加一个<code class="fe oo op oq of b">description</code>和一个<code class="fe oo op oq of b">color</code>来给应用程序用户一个更好的上下文。<code class="fe oo op oq of b">name</code>和<code class="fe oo op oq of b">description</code>与图表一起显示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/630d1605bc82fedde8e78a4362f30825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhS3hSF0Q0p6f2LJ4S-mtQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">步骤4的结果。具有数据、显示功能、图表和控件。图片作者。</p></figure><h1 id="0f79" class="lz ma iq bd mb mc nz me mf mg oa mi mj jw ob jx ml jz oc ka mn kc od kd mp mq bi translated">结论</h1><p id="16a3" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">让我们完整地看一遍我们在这里做了什么。我们的目标是使用Greppo创建一个地理空间web应用程序，显示一些GIS矢量数据，并添加组件，为应用程序的用户提供更好的环境。以下是该应用程序的完整代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="cdd1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是应用程序的输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/175277dc47f5759e803e45dccd077a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*roDG3MBZhff1om23mZmU1w.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最后的结果。图片作者。</p></figure><p id="29de" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以，我们有它。使用Greppo构建的完整网络应用程序，耗时不到5分钟。</p><p id="417b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个演示的所有文件都可以在这里找到:<a class="ae lr" href="https://github.com/greppo-io/greppo-demo/tree/main/vector-demo" rel="noopener ugc nofollow" target="_blank">https://github . com/GRE PPO-io/GRE PPO-demo/tree/main/vector-demo</a></p><blockquote class="ns nt nu"><p id="4bcf" class="kv kw nv kx b ky kz jr la lb lc ju ld nw lf lg lh nx lj lk ll ny ln lo lp lq ij bi translated">查看<a class="ae lr" href="https://github.com/greppo-io/greppo" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="iq"> GitHub资源库:此处</em></strong></a><strong class="kx ir"><em class="iq"/></strong>将在Greppo上得到最新更新。如果您的用例有错误、问题或功能请求，请联系<a class="ae lr" href="https://discord.gg/RNJBjgh8gz" rel="noopener ugc nofollow" target="_blank"> Discord channel </a>或在GitHub上提出问题。用Greppo造了什么东西？贴GitHub。</p></blockquote></div></div>    
</body>
</html>