<html>
<head>
<title>Manipulating Values in Polars DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理极坐标数据框中的值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/manipulating-values-in-polars-dataframes-1087d88dd436#2022-07-20">https://towardsdatascience.com/manipulating-values-in-polars-dataframes-1087d88dd436#2022-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7100" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用Polars中的<code class="fe ki kj kk kl b">various </code>方法来操作数据帧</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/5379b4fc7bdf0f65eea33f71496686e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_x091zDQpUoF0Zob"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">由<a class="ae lc" href="https://unsplash.com/@jruscello?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰西卡·鲁斯切洛</a>在<a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="b710" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">到目前为止，我已经谈论了如何使用Polars数据框架，以及为什么它是一个比Pandas更好的数据框架库。继续我们对Polars的探索，在本文中，我将向您展示如何操作Polars数据框架，特别是:</p><ul class=""><li id="caed" class="lz ma it lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated">如何更改每一列/行的值</li><li id="c3a2" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">如何合计每一列/行的值</li><li id="47dc" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">如何向现有数据框架添加新列/行</li></ul><p id="ed80" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">准备好了吗？我们走吧！</p><h1 id="38d4" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">创建示例数据帧</h1><p id="2b86" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">让我们使用元组列表创建一个Polars数据帧:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="bb56" class="no mo it kl b gy np nq l nr ns">import polars as pl</span><span id="3dd5" class="no mo it kl b gy nt nq l nr ns">matrix = [<br/>    (1, 2, 3),<br/>    (4, 5, 6),<br/>    (7, 8, 9),<br/>    (10, 11, 12),<br/>    (13, 14, 15),<br/>    (16, 17, 18)<br/>]</span><span id="9d47" class="no mo it kl b gy nt nq l nr ns">df = pl.DataFrame(matrix, columns=list('abc'))<br/>df</span></pre><p id="39a1" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">数据帧看起来像这样:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/0ed6781fa6476a0d4850e4092e3d3619.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*azYuKZkUXlwWQMN75L0Oqg.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="6319" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">让我们研究一些方法，您可以调用这些方法来操作数据帧中的值。</p><h2 id="bec5" class="no mo it bd mp nv nw dn mt nx ny dp mx lm nz oa mz lq ob oc nb lu od oe nd of bi translated">使用apply()方法</h2><p id="37c4" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated"><code class="fe ki kj kk kl b">apply()</code>方法可用于:</p><ul class=""><li id="c681" class="lz ma it lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated">数据帧中的单个列，或者</li><li id="34a8" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">整个数据帧</li></ul><h2 id="934a" class="no mo it bd mp nv nw dn mt nx ny dp mx lm nz oa mz lq ob oc nb lu od oe nd of bi translated">应用于列</h2><p id="e533" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">例如，假设您想要将'<strong class="lf iu"> a' </strong>列中的所有值乘以2。您可以执行以下操作:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="822c" class="no mo it kl b gy np nq l nr ns">df.select(<br/>    pl.col('a').<strong class="kl iu">apply</strong>(lambda x: x*2)<br/>)</span></pre><p id="6f7c" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">列'<strong class="lf iu"> a </strong>中的所有值现在将乘以2:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/fccbbe38e809f79aab6b28e7b878977c.png" data-original-src="https://miro.medium.com/v2/resize:fit:204/format:webp/1*3ACfOi-MXJKLsXClXj6y2A.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="37c5" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在上面的lambda函数中，<code class="fe ki kj kk kl b">x</code>将采用列<strong class="lf iu"> a </strong>的单个值。当应用于一个列时，<code class="fe ki kj kk kl b">apply()</code>方法逐个发送列的值。这为您提供了在决定如何更改值之前检查每个值的机会。例如，您可以只乘以那些大于或等于5的值:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="6c0d" class="no mo it kl b gy np nq l nr ns">df.select(<br/>    pl.col('a').apply(<strong class="kl iu">lambda x: x*2 if x&gt;=5 else x</strong>)<br/>)</span></pre><p id="c6a3" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这将产生以下输出:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/0f420475ed29fd19854cf91b97068148.png" data-original-src="https://miro.medium.com/v2/resize:fit:172/format:webp/1*ux7toG6D3qZ939UC7ZBwAQ.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><blockquote class="oi oj ok"><p id="5767" class="ld le ol lf b lg lh ju li lj lk jx ll om ln lo lp on lr ls lt oo lv lw lx ly im bi translated">一般来说，使用<code class="fe ki kj kk kl b"><em class="it">apply()</em></code>方法实现逻辑比使用表达式实现逻辑要慢，并且占用更多内存。这是因为表达式可以并行化和优化，表达式中实现的逻辑是用Rust实现的，这比用Python实现(例如用lambda函数实现)要快。因此，尽可能使用表达式，而不是使用<code class="fe ki kj kk kl b">apply()</code>函数。例如，早期的<code class="fe ki kj kk kl b">apply()</code>方法也可以用一个表达式重写:</p></blockquote><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="e8e4" class="no mo it kl b gy np nq l nr ns">    pl.col('a').apply(lambda x: x*2)<br/>    # rewritten as an expression<br/><strong class="kl iu">    pl.col('a') * 2</strong></span></pre></div><div class="ab cl op oq hx or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="im in io ip iq"><p id="d05c" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">请注意，结果只包含一列。如果您希望其余的列也出现在结果中，请使用<code class="fe ki kj kk kl b">select()</code>和<code class="fe ki kj kk kl b">exclude()</code>方法:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="c2be" class="no mo it kl b gy np nq l nr ns"><strong class="kl iu">q = (<br/>    df<br/>    .lazy()<br/>    .select(<br/>        [<br/></strong>            pl.col('a').apply(lambda x: x*2),<br/>         <strong class="kl iu">   pl.exclude('a')<br/>        ]<br/>    )<br/>)</strong></span><span id="f858" class="no mo it kl b gy nt nq l nr ns"><strong class="kl iu">q.collect()</strong></span></pre><p id="d510" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在结果包含了所有的列:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/bd2d5380a0df5e3054729453f0063cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:224/format:webp/1*LCe98T-VlZ3vvXFdglmaeg.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure></div><div class="ab cl op oq hx or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="im in io ip iq"><p id="566b" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果您想将所有列乘以2，使用<code class="fe ki kj kk kl b">pl.col(‘*’)</code>选择所有列:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="b40a" class="no mo it kl b gy np nq l nr ns">q = (<br/>    df<br/>    .lazy()<br/>    .select(<br/><strong class="kl iu">        pl.col('*').apply(lambda x: x*2)</strong><br/>    )<br/>)</span><span id="0a55" class="no mo it kl b gy nt nq l nr ns">q.collect()</span></pre><p id="88a4" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">所有列现在将乘以2:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/5ab126220948be56e93ad24ae887f41d.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/format:webp/1*lXNnYdu6RkaUyLtqtcyWcQ.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="2a7f" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果要将列'<strong class="lf iu"> a' </strong>乘以2，然后将结果存储为另一列，请使用<code class="fe ki kj kk kl b">alias()</code>方法:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="3c9d" class="no mo it kl b gy np nq l nr ns">q = (<br/>    df<br/>    .lazy()<br/>    .select(<br/>        [<br/>            pl.col('*'),<br/>            pl.col('a').apply(lambda x: x*2)<strong class="kl iu">.alias('x*2')</strong>,<br/>        ]<br/>    )<br/>)</span><span id="95d3" class="no mo it kl b gy nt nq l nr ns">q.collect()</span></pre><p id="7e19" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">结果现在会有一个额外的列:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/2912da91efb73371899b7c28537ca5e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*crz1hqGahgWiovgY5oiYPA.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><h2 id="3ab8" class="no mo it bd mp nv nw dn mt nx ny dp mx lm nz oa mz lq ob oc nb lu od oe nd of bi translated">使用map()方法</h2><p id="7eb5" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">另一个类似于<code class="fe ki kj kk kl b">apply()</code>方法的功能是<code class="fe ki kj kk kl b">map()</code>方法。与<code class="fe ki kj kk kl b">apply()</code>方法不同的是，<code class="fe ki kj kk kl b">map()</code>方法将一列的值作为单极性序列发送:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="c486" class="no mo it kl b gy np nq l nr ns">df.select(<br/>    pl.col('a').<strong class="kl iu">map</strong>(lambda x: x*2)<br/>)</span></pre><p id="d92f" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在上面的lambda函数中，<code class="fe ki kj kk kl b">x</code>是包含列<strong class="lf iu"> a </strong>的值的Polars序列。上述语句产生以下输出:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/699f32669129c1fdb5f812e806c5994d.png" data-original-src="https://miro.medium.com/v2/resize:fit:180/format:webp/1*6Hx5uo27_qBVH9f5iTIB-A.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><h2 id="7817" class="no mo it bd mp nv nw dn mt nx ny dp mx lm nz oa mz lq ob oc nb lu od oe nd of bi translated">应用于行</h2><p id="a8bd" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">注意到目前为止，数据帧中的<em class="ol">列</em>应用了<code class="fe ki kj kk kl b">apply()</code>方法。如果您想应用于数据帧中的<em class="ol">行</em>该怎么办？在这种情况下，直接调用dataframe上的<code class="fe ki kj kk kl b">apply()</code>方法。</p><p id="3196" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为了理解它是如何工作的，我编写了一个<code class="fe ki kj kk kl b">test</code>函数来打印出将<code class="fe ki kj kk kl b">apply()</code>函数应用于dataframe时得到的值:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="fc2d" class="no mo it kl b gy np nq l nr ns">def test(x):<br/>    print(x)<br/>    return x<br/>  <br/>df.apply(test)</span></pre><p id="4a32" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">它返回以下内容:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="40e0" class="no mo it kl b gy np nq l nr ns">(1, 2, 3)<br/>(4, 5, 6)<br/>(7, 8, 9)<br/>(10, 11, 12)<br/>(13, 14, 15)<br/>(16, 17, 18)</span></pre><p id="3b6c" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这意味着<code class="fe ki kj kk kl b">apply()</code>函数在应用于dataframe时，会将每一行的值作为一个元组发送给接收函数。这对于一些用例很有用。例如，假设您需要将一行中的所有数字除以2，如果它们的和大于10，那么您可以将lambda函数写成:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="1dd4" class="no mo it kl b gy np nq l nr ns">df.apply(lambda x: <strong class="kl iu">tuple([i // 2 for i in x]) if sum(x) &gt; 10 else x</strong>)</span></pre><p id="a912" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">结果会是这样的:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/952254b2ee28820215daf9ed09b0775b.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*L74Qcl5NnxSJC0ByvCrVFQ.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="977b" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果想复制数据帧中的所有列，也可以使用<code class="fe ki kj kk kl b">apply()</code>方法:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="8caa" class="no mo it kl b gy np nq l nr ns">df.apply(lambda x: x*2)</span></pre><p id="dd8d" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">数据帧现在有六列:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/48a910be5de33eedbd5259bff71350ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*OYLg0QVtezsxTJy34v_i6w.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><blockquote class="oi oj ok"><p id="93b0" class="ld le ol lf b lg lh ju li lj lk jx ll om ln lo lp on lr ls lt oo lv lw lx ly im bi translated">注意<code class="fe ki kj kk kl b">apply()</code>功能不能应用于LazyFrame。</p></blockquote><h1 id="daa9" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">对数据帧中的值求和</h1><p id="d3f0" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">通常，您需要按行或按列对数据帧中的所有值求和。</p><h2 id="9993" class="no mo it bd mp nv nw dn mt nx ny dp mx lm nz oa mz lq ob oc nb lu od oe nd of bi translated">按列</h2><p id="9aa0" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">合计每列值的最简单方法是在数据帧上使用<code class="fe ki kj kk kl b">sum()</code>方法:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="e36d" class="no mo it kl b gy np nq l nr ns">df.sum()</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/03f6c40155c5163bcf796ebf408f3b00.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/1*vSJ8kO_rwXQIKPFpA_0f2w.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="52e9" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">要将上述结果附加到现有数据帧，使用<code class="fe ki kj kk kl b">concat()</code>方法:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="4e6a" class="no mo it kl b gy np nq l nr ns">pl.<strong class="kl iu">concat</strong>([df, df.sum()])</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/27639bbd397fa390f7e124be8e8e0f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:226/format:webp/1*So3CPjy998K_TGffXb8zLw.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><h2 id="a2dd" class="no mo it bd mp nv nw dn mt nx ny dp mx lm nz oa mz lq ob oc nb lu od oe nd of bi translated">按行</h2><p id="d63c" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">要合计每行所有列的值，使用<code class="fe ki kj kk kl b">sum()</code>方法，并将<code class="fe ki kj kk kl b">axis</code>参数设置为<code class="fe ki kj kk kl b">1</code>:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="19fa" class="no mo it kl b gy np nq l nr ns">df.sum(<strong class="kl iu">axis=1</strong>)</span></pre><p id="c482" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">结果是一个<em class="ol"> Polars系列</em>:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/6901a04683b918f62b3a8511320f456d.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*6mreXrkMsMtzXWdtmW6bNA.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><blockquote class="oi oj ok"><p id="5892" class="ld le ol lf b lg lh ju li lj lk jx ll om ln lo lp on lr ls lt oo lv lw lx ly im bi translated">将Polars系列视为数据帧中的一列</p></blockquote><p id="f0b7" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您也可以使用<code class="fe ki kj kk kl b">select()</code>方法来选择您想要求和的列:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="31b0" class="no mo it kl b gy np nq l nr ns">df.<strong class="kl iu">select(pl.col('*'))</strong>.sum(axis=1)</span></pre><p id="4dd7" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">以下代码片段将系列作为新列添加到dataframe中:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="a8f8" class="no mo it kl b gy np nq l nr ns">df['sum'] = df.select(pl.col('*')).sum(axis=1)<br/>df</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/69dfa27c72a26160f1a3e3d37dcb4ed5.png" data-original-src="https://miro.medium.com/v2/resize:fit:324/format:webp/1*Vu2wL0xnx6vr0jzzwZj7Mw.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="c167" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果您不想使用<em class="ol">方括号索引</em>(Polars中不推荐使用)，请使用<code class="fe ki kj kk kl b">select()</code>方法:</p><pre class="kn ko kp kq gt nk kl nl nm aw nn bi"><span id="d840" class="no mo it kl b gy np nq l nr ns">df.<strong class="kl iu">select</strong>(<br/>    [<br/>        pl.col('*'),<br/>        df.select(pl.col('*')).sum(axis=1).alias('sum')<br/>    ]<br/>)</span></pre><div class="pg ph gp gr pi pj"><a href="https://weimenglee.medium.com/membership" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd iu gy z fp po fr fs pp fu fw is bi translated">加入媒介与我的介绍链接-李伟孟</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">阅读李维孟(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">weimenglee.medium.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px kw pj"/></div></div></a></div><blockquote class="oi oj ok"><p id="a9c0" class="ld le ol lf b lg lh ju li lj lk jx ll om ln lo lp on lr ls lt oo lv lw lx ly im bi translated">我将在即将到来的新加坡ML会议(2022年11月22-24日)上主持一个关于Polars的研讨会。如果你想在Polars数据框架上快速起步，请在<a class="ae lc" href="https://mlconference.ai/machine-learning-advanced-development/using-polars-for-data-analytics-workshop/" rel="noopener ugc nofollow" target="_blank">https://ml conference . ai/machine-learning-advanced-development/using-Polars-for-data-analytics-workshop/</a>上注册我的研讨会。</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi py"><img src="../Images/b1bb1beb7127f109628516f77a2b9338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*3mrWppY0VhWWEoBm5A4qHA.png"/></div></figure><h1 id="69b2" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">摘要</h1><p id="c9ba" class="pw-post-body-paragraph ld le it lf b lg nf ju li lj ng jx ll lm nh lo lp lq ni ls lt lu nj lw lx ly im bi translated">我希望这篇文章为您使用Polars数据框架增加了一些弹药。以下是何时使用<code class="fe ki kj kk kl b">apply()</code>和<code class="fe ki kj kk kl b">map()</code>方法的快速总结:</p><ul class=""><li id="6f66" class="lz ma it lf b lg lh lj lk lm mb lq mc lu md ly me mf mg mh bi translated">对表达式调用<code class="fe ki kj kk kl b">apply()</code>方法，将函数应用于数据帧中<strong class="lf iu"> <em class="ol">列</em> </strong>中的<strong class="lf iu"> <em class="ol">单个</em> </strong>值。</li><li id="c674" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">在表达式上调用<code class="fe ki kj kk kl b">map()</code>函数，将函数应用于数据帧中的<strong class="lf iu"> <em class="ol">列</em> </strong>。</li><li id="b273" class="lz ma it lf b lg mi lj mj lm mk lq ml lu mm ly me mf mg mh bi translated">在数据帧上调用<code class="fe ki kj kk kl b">apply()</code>方法，将函数应用于数据帧中的<strong class="lf iu"> <em class="ol">行</em> s </strong>。</li></ul><p id="85db" class="pw-post-body-paragraph ld le it lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">保存这篇文章，并在下次使用Polars数据框时用作快速参考！</p></div></div>    
</body>
</html>