<html>
<head>
<title>12 Beginner Concepts About Type Hints To Improve Your Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于类型提示的12个初学者概念，以改进您的Python代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/12-beginner-concepts-about-type-hints-to-improve-your-python-code-90f1ba0ac49#2022-10-03">https://towardsdatascience.com/12-beginner-concepts-about-type-hints-to-improve-your-python-code-90f1ba0ac49#2022-10-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4f0c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">就像单元测试一样，类型提示花费了开发人员的时间，但从长远来看是值得的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ac698b8f80d8cd974c0eb6c0c17881c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JH-fdb9mQj4u-hJn"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阿里安·达尔维什在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d82e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python是一种动态类型的编程语言。这意味着解释器只在代码运行时执行类型检查<strong class="lb iu">，并且变量类型允许在其生命周期内改变。</strong></p><p id="e1bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管Python一直保持动态类型，并且从未打算改变这一方向，但自从<a class="ae ky" href="https://peps.python.org/pep-0484/" rel="noopener ugc nofollow" target="_blank"> PEP 484 </a>以来，类型提示已经被引入，目的是将静态类型检查引入代码分析。</p><blockquote class="lv lw lx"><p id="795a" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">在本文中，我们将介绍类型提示，并回顾使用它们时应该熟悉的12个概念。T13】</p></blockquote><p id="b2a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章的最后，你应该对类型提示有一个总体的了解，它们是什么以及什么时候应该使用它们。您还将学习如何构建复杂类型和执行静态类型检查。</p><p id="b074" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">话虽如此，让我们深入研究一下一些代码💻</p><blockquote class="lv lw lx"><p id="49cc" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">新到中？你可以每月订阅5美元，解锁我写的不限数量的关于编程、MLOps和系统设计的文章，以帮助数据科学家(或ML工程师)编写更好的代码。</p></blockquote><div class="mc md gp gr me mf"><a href="https://medium.com/membership/@ahmedbesbes" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">加入我的介绍链接媒体-艾哈迈德贝斯</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">阅读Ahmed Besbes的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt ks mf"/></div></div></a></div></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="556c" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">1-类型注释:支持添加类型的新语法</h1><p id="51e9" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">使用Python注释执行类型提示(从<a class="ae ky" href="https://peps.python.org/pep-3107/" rel="noopener ugc nofollow" target="_blank"> PEP 3107 </a>开始引入)。它们用于向变量、参数、函数参数以及它们的返回值、类属性和方法添加类型。</p><blockquote class="lv lw lx"><p id="db82" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu"> <em class="it">添加类型提示没有运行时效果:这些只是提示，本身并不强制。如果你担心他们，一定要记住翻译总是忽略他们。</em>T19】</strong></p></blockquote><p id="b642" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">👉<br/>变量注释</strong>变量注释遵循以下语法:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="3313" class="od nc it nz b gy oe of l og oh"><strong class="nz iu"><em class="ly">&lt;variable_name&gt;: &lt;variable_type&gt; = &lt;variable_value&gt;</em></strong></span></pre><p id="d802" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用以下基本内置类型之一来执行类型提示:<code class="fe oi oj ok nz b">int</code>、<code class="fe oi oj ok nz b">float</code>、<code class="fe oi oj ok nz b">str</code>、<code class="fe oi oj ok nz b">bool</code>、<code class="fe oi oj ok nz b">bytes</code>、<code class="fe oi oj ok nz b">list</code>、<code class="fe oi oj ok nz b">tuple</code>、<code class="fe oi oj ok nz b">dict</code>、<code class="fe oi oj ok nz b">set</code>、<code class="fe oi oj ok nz b">frozenset</code>、<code class="fe oi oj ok nz b">None</code>。</p><p id="6a75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是一些入门示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="2991" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了构建更高级的类型，我们将使用<a class="ae ky" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">类型化</a>模块。继续阅读，了解更多。</p><p id="cdbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">👉函数注释</strong> <br/>你也可以给函数添加类型提示来指定它们的参数和返回值的类型。</p><p id="9e43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用前面的语法来指定参数的类型。</p><p id="06fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用箭头<code class="fe oi oj ok nz b">-&gt;</code>提示返回值。</p><p id="6f16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的例子中，<code class="fe oi oj ok nz b">type_x</code>、<code class="fe oi oj ok nz b">type_y</code>、<code class="fe oi oj ok nz b">type_z</code>、<code class="fe oi oj ok nz b">type_return</code>必须是有效的python表达式，比如内置类型或者使用类型模块的更复杂的类型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="3afc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">→如果一个函数不返回任何东西，可以将返回类型(箭头后)设置为<code class="fe oi oj ok nz b">None</code>。</p><p id="7e7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">👉你甚至可以在你的类中标注属性和方法。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="b2ae" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">2-使用mypy执行静态类型检查</h1><p id="2bd4" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">要检查python是否强制类型提示，请尝试运行以下脚本，该脚本声明一个类型为<code class="fe oi oj ok nz b">int</code>的变量<code class="fe oi oj ok nz b">x</code>，并在稍后更改其值以存储一个浮点数。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="d8a6" class="od nc it nz b gy oe of l og oh"># script.py</span><span id="3a97" class="od nc it nz b gy os of l og oh">x: int = 2</span><span id="ce01" class="od nc it nz b gy os of l og oh"># ...</span><span id="0e95" class="od nc it nz b gy os of l og oh">x = 3.5</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/671f250c0c3dd9b31d6824b75619a3ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FK7OZJ0txQG6lT2qBNRV0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="b3c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有错误。(不出所料)</p><p id="c8a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果你真的对你的代码很严格，并且仍然想检测这些类型的错误，你可以使用<strong class="lb iu"> <em class="ly"> mypy </em> </strong>，一个执行静态类型检查的工具。</p><p id="5eb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装它，只需运行<code class="fe oi oj ok nz b">pip install mypy</code>。</p><p id="8e45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，要分析您的代码，只需运行:<code class="fe oi oj ok nz b">mypy script.py</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/39b29aa8a1613b4dd075dc1f48523d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPPlEmFjFqP-CFG6HUXTTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="775a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个简单的例子中，mypy检测到一个错误:<strong class="lb iu">赋值中不兼容的类型，</strong>这正是我们想要强调的。</p><p id="f646" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过静态分析您的代码，mypy帮助您符合您定义的类型，提高您的代码质量，防止无声错误，并通过遵循最佳实践来标准化您的代码。</p><p id="1393" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解更多信息，请查看http://mypy-lang.org/的。</p><h1 id="1ba1" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">3—添加类型提示的好处</h1><blockquote class="lv lw lx"><p id="a109" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">如果解释器不强制执行，为什么还要写类型提示呢？</strong></p></blockquote><p id="bb1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我经常听到这句话。</p><p id="2816" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">的确，类型提示不会改变代码的运行方式:Python本质上是动态类型化的，并且不会很快改变。</p><p id="dcd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，从开发人员体验的角度来看，类型提示为您的代码库带来了多种好处。</p><p id="46f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我可以不假思索地想到以下优点:</p><ol class=""><li id="59be" class="ov ow it lb b lc ld lf lg li ox lm oy lq oz lu pa pb pc pd bi translated">使用类型提示，尤其是在函数中，通过提供信息签名来阐明关于参数类型和所产生结果类型的假设，从而记录您的代码</li><li id="276a" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu pa pb pc pd bi translated">通知类型消除了认知开销，使代码更容易阅读和调试。记住了输入和输出的类型，您就可以很容易地推理出您的对象以及它们是如何耦合的</li><li id="576e" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu pa pb pc pd bi translated">类型提示改善您的代码编辑体验:<br/>结合mypy，您的IDE依靠它们来静态分析您的代码，并帮助检测潜在的错误(例如，传递错误类型的参数，调用错误的方法，等等。)<br/>另外，根据变量的类型提示，为每个变量提供自动完成功能。</li></ol><div class="kj kk kl km gt ab cb"><figure class="pj kn pk pl pm pn po paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/eaf1bd70bfcd7e4258718f9a9001303f.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*tWVF2NtR3zVOFB-TBz-9dQ.png"/></div></figure><figure class="pj kn pp pl pm pn po paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/6c1c8334e180b7b659ced80517c96da9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*OLtFx1zBP2yJBAnzShDa0A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk pq di pr ps translated">mypy根据类型提示检测支持的类型操作和不兼容的类型—作者截图</p></figure></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/c727917f40febde0ee0a6cdba092d734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uu1YUDxvzvW18UfguFNwiA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">VSCode使用类型提示信息来提供相关的自动完成功能——作者截图</p></figure><p id="c470" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在接下来的部分中，我们将讨论类型模块中的高级类型。</p><h1 id="34cb" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">4-列表</h1><p id="7520" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">假设你想给你的函数传递一个有点复杂的参数，由…一个浮点数列表组成。你会如何注释它？</p><p id="788a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以尝试通过将<code class="fe oi oj ok nz b">list</code>类型与<code class="fe oi oj ok nz b">float</code>类型组合来编写类似的内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="7203" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不错的尝试。</p><p id="c74a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">遗憾的是，这不起作用，尽管写起来似乎很自然和直观。</p><p id="6574" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了支持这一点，您只需用从<a class="ae ky" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a>模块导入的<code class="fe oi oj ok nz b"><strong class="lb iu">L</strong>ist</code>类型替换内置的标准<code class="fe oi oj ok nz b">list</code>类型。</p><p id="07dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列表类型的有趣之处在于，它可以包含任何类型，而不仅仅是内置类型。我们自己的类型基本上可以和List结合。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="5075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果你有一个字符串列表，你应该这样输入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="5342" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">5—字典</h1><p id="2338" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">我喜欢使用python字典，因为它们很灵活。它们允许您使用不同类型的键和值。例如，您可以拥有一个包含字符串键和dict值的字典(在本例中，这表示一个嵌套的dict结构)</p><p id="91c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，作为这种灵活性的代价，并不总是清楚底层模式是什么:字典键是什么类型？字典值有哪些类型？</p><p id="74fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要控制字典中键和值的类型，可以使用类型模块中的Dict类型。</p><p id="95e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我用字符串键和字符串值处理字典。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="3301" class="od nc it nz b gy oe of l og oh"><strong class="nz iu">{"name": "Ahmed", "job": "ML engineer"}</strong></span></pre><p id="f8e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要建立这样一个字典结构的模型，可以向Dict传递两个参数，其中第一个是键的类型，第二个是值的类型。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="a08a" class="od nc it nz b gy oe of l og oh"><strong class="nz iu">from typing import Dict</strong></span><span id="c0cc" class="od nc it nz b gy os of l og oh"><strong class="nz iu">my_dict_type = Dict[str, str]</strong></span></pre><h1 id="f3a1" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">6 —联合</h1><blockquote class="lv lw lx"><p id="af0f" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><em class="it">从Python 3.10开始，</em> <code class="fe oi oj ok nz b"><em class="it">Union</em></code> <em class="it">被</em> <code class="fe oi oj ok nz b"><em class="it">|</em></code> <em class="it">取代，也就是说</em> <code class="fe oi oj ok nz b"><em class="it">Union[X, Y]</em></code> <em class="it">现在相当于</em> <code class="fe oi oj ok nz b"><em class="it">X | Y</em></code> <em class="it">。</em></p></blockquote><p id="abdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Union[X，Y](或X | Y)表示X或Y。</p><p id="5316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">示例</strong>👇</p><p id="32a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您的函数需要从缓存目录中读取一个文件并加载一个torch模型。这个缓存目录位置可以是一个字符串值(比如<code class="fe oi oj ok nz b">/home/cache</code>)或者是来自<a class="ae ky" href="https://docs.python.org/3/library/pathlib.html" rel="noopener ugc nofollow" target="_blank"> Pathlib </a>库中的一个路径对象。</p><p id="f74b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="f753" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">7-类型直接</h1><p id="3a20" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">如果您的Python字典有一个固定的模式，其中包含已知的字符串键和不同类型的值，该怎么办？</p><p id="cbe9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大概是这样的:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="e502" class="od nc it nz b gy oe of l og oh"><strong class="nz iu">d = {"name": "Ahmed", "interests": ["chess", "tennis"]}</strong></span></pre><p id="9c8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会怎么打？</p><p id="a160" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">❌使用<strong class="lb iu">字典</strong>和<strong class="lb iu">联合</strong>并不理想，因为我们丢失了关于什么键需要具有什么类型的值的信息。</p><p id="ad92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<strong class="lb iu"> TypedDict </strong>的✅允许你声明一个字典类型，期望它的所有实例都有一组特定的键，其中每个键都与一个一致类型的值相关联。</p><p id="ee75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个如何工作的例子👇</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/3e807b47b0509e85d35d4d4d1447e136.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tmmNp-_Nb4ZIp4CcFaChgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由作者提供—制作于<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">https://carbon.now.sh/</a></p></figure><h1 id="28b4" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">8 —可赎回</h1><p id="b3e5" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">Callable是当你想用一个函数作为参数时使用的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="a6f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以指定参数的类型和可调用函数的返回值。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="79f4" class="od nc it nz b gy oe of l og oh">Callable[[input_type_1, ...], return_type]</span></pre><p id="d6a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是带有附加类型提示的相同示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="e48e" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">9 —任何</h1><p id="102e" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated"><code class="fe oi oj ok nz b">Any</code>类型非常简单。事实上，写这个</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="2d68" class="od nc it nz b gy oe of l og oh">def bar(input: Any):<br/>    ...</span></pre><p id="1b9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相当于这样写:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="07eb" class="od nc it nz b gy oe of l og oh">def bar(input):<br/>    ...</span></pre><p id="c08a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oi oj ok nz b">Any</code>类型只是在这里明确声明bar函数打算接收任何输入类型作为参数。(可能是因为这个函数后面执行的内容不依赖于它的参数类型)。</p><blockquote class="lv lw lx"><p id="6916" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><em class="it">这个</em> <code class="fe oi oj ok nz b"><em class="it">Any</em></code> <em class="it">型到底有没有用？🤔</em></p></blockquote><p id="af37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">老实说，我不知道。</p><h1 id="5275" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">10-可选</h1><p id="a430" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">如果您的任何函数使用可选的参数，比如说，因为它有一个默认值，那么您可以使用类型模块中的可选类型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="5fd1" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">11 —序列</h1><p id="95a4" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">类型为<strong class="lb iu">序列</strong>的对象是任何可以被索引的东西:列表、元组、字符串、对象列表、元组列表的元组，等等。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="9f85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">⚠️:请注意，集合或字典不是序列类型。</p><h1 id="eaae" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">12元组</h1><p id="f7e1" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">元组类型的工作方式与列表类型略有不同。</p><p id="30f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你不在乎你的tuple的每个元素的类型，你可以继续使用<code class="fe oi oj ok nz b">tuple</code>内置类型。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="3869" class="od nc it nz b gy oe of l og oh"><strong class="nz iu">t: tuple = (1, 2, 3, ["cat", "dog"], {"name": "John"})</strong></span></pre><p id="a121" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果您想指定类型中每个元素的类型，请使用Tuple。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="05b7" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">结论</h1><p id="0205" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">类型提示在您的代码之上带来了一个额外的抽象层:它们有助于记录代码，阐明关于输入/输出的假设，并在静态代码分析(👋mypy)在上面执行。</p><p id="00d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在剩下的问题是:<em class="ly">我应该开始在我的项目中使用类型提示吗？</em></p><p id="a573" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你在一个已经实现了类型提示(和单元测试)的大型代码库上合作，那么如果你想编写现代python代码并提高代码质量，那么添加<br/>是很自然的事情，类型提示是一条可行之路。</p><p id="775b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，如果您使用的是旧版本的Python，如果您是编程语言的新手，或者如果性能确实是个问题，那么您可能应该避免添加类型提示。事实上，关于这最后一点，类型提示会在启动时引入一点开销。</p><h1 id="6431" class="nb nc it bd nd ne on ng nh ni oo nk nl jz op ka nn kc oq kd np kf or kg nr ns bi translated">资源</h1><ul class=""><li id="61f4" class="ov ow it lb b lc nt lf nu li pv lm pw lq px lu py pb pc pd bi translated"><a class="ae ky" href="https://betterprogramming.pub/twenty-type-hinting-techniques-and-tools-for-better-python-code-e877e0b0c679" rel="noopener ugc nofollow" target="_blank">https://better programming . pub/twenty-type-hinting-techniques-and-tools-for-better-python-code-e 877 e 0 b 0 c 679</a></li><li id="ee64" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu py pb pc pd bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=dgBCEB2jVU0" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=dgBCEB2jVU0</a></li><li id="0461" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu py pb pc pd bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=QORvB-_mbZ0" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=QORvB-_mbZ0</a></li><li id="af18" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu py pb pc pd bi translated"><a class="ae ky" href="https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html" rel="noopener ugc nofollow" target="_blank">https://mypy.readthedocs.io/en/stable/cheat_sheet_py3.html</a></li><li id="e810" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu py pb pc pd bi translated"><a class="ae ky" href="https://realpython.com/python-type-checking/" rel="noopener ugc nofollow" target="_blank">https://realpython.com/python-type-checking/</a></li><li id="23f2" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu py pb pc pd bi translated"><a class="ae ky" href="https://www.pythontutorial.net/python-basics/python-type-hints/" rel="noopener ugc nofollow" target="_blank">https://www . python tutorial . net/python-basics/python-type-hints/</a></li><li id="4649" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu py pb pc pd bi translated"><a class="ae ky" href="https://realpython.com/lessons/pros-and-cons-type-hints/" rel="noopener ugc nofollow" target="_blank">https://realpython.com/lessons/pros-and-cons-type-hints/</a></li><li id="8bea" class="ov ow it lb b lc pe lf pf li pg lm ph lq pi lu py pb pc pd bi translated"><a class="ae ky" href="https://bernat.tech/posts/the-state-of-type-hints-in-python/" rel="noopener ugc nofollow" target="_blank">https://bernat . tech/posts/the-state-of-type-hints-in-python/</a></li></ul></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="2514" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">新到中？您可以每月订阅5美元，并解锁各种主题的无限文章(技术、设计、创业……)您可以通过点击我的推荐链接<a class="ae ky" href="https://ahmedbesbes.medium.com/membership" rel="noopener">来支持我</a></h1><div class="mc md gp gr me mf"><a href="https://ahmedbesbes.medium.com/membership" rel="noopener follow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd iu gy z fp mk fr fs ml fu fw is bi translated">加入我的介绍链接媒体-艾哈迈德贝斯</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">阅读Ahmed Besbes的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">ahmedbesbes.medium.com</p></div></div><div class="mo l"><div class="pz l mq mr ms mo mt ks mf"/></div></div></a></div></div></div>    
</body>
</html>