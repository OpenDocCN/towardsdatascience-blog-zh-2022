<html>
<head>
<title>Simple Stepwise and Weighted Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单逐步加权回归模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-stepwise-and-weighted-regression-model-53a31d9e4746#2022-04-16">https://towardsdatascience.com/simple-stepwise-and-weighted-regression-model-53a31d9e4746#2022-04-16</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="2c9a" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">逐步加权回归</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/924e8b6b97ef1d2997513be2d2285107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OK2_FIzlZuZYF8fuPKDNQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><blockquote class="kz la lb"><p id="cc90" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">简介</strong></p></blockquote><p id="7d10" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">简单线性和多元线性回归是在工程、医学和其他科学领域广泛使用的统计技术。我们可以对模型进行很好的线性拟合，但同时我们需要找出模型可以解释多少变化。R是这种变化测量的度量，但是如果我们增加独立变量的数量，R的值也会增加。然而，我们的R的增加并不一定意味着模型变得更加健壮。如果数据集中存在多重共线性，我们需要找出调整后的R。我们之前已经讨论了如果模型在训练数据上过度拟合，惩罚对模型的影响。特别是这些被称为岭回归和套索回归。</p><div class="mc md gq gs me mf"><a rel="noopener follow" target="_blank" href="/simply-linear-and-polynomial-regression-9c9624774f5a"><div class="mg ab fp"><div class="mh ab mi cl cj mj"><h2 class="bd iv gz z fq mk fs ft ml fv fx it bi translated">简单线性和多项式回归</h2><div class="mm l"><h3 class="bd b gz z fq mk fs ft ml fv fx dk translated">使用Statsmodels、Polyfit、线性回归和多项式特征</h3></div><div class="mn l"><p class="bd b dl z fq mk fs ft ml fv fx dk translated">towardsdatascience.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt kt mf"/></div></div></a></div><p id="1003" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">在这篇文章中，我将通过逐步回归和加权回归分析，这不过是常规回归的扩展。此外，我将扩展度量标准，以检查除R以外的AIC和BIC回归模型的稳健性。</p><blockquote class="kz la lb"><p id="245e" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">逐步回归</strong></p></blockquote><p id="9820" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">逐步回归与常规回归相同，但处理方式不同。回归模型的主要目标之一是用自变量尽可能多地解释因变量的变化。为此，我们要增加R值。如前所述，向模型中添加越来越多的变量将有助于增加R值的过程。我们还可以使用其他一些指标来表明模型的稳健性。例如，AIC(代表由日本统计学家Hirotugo Akaike开发的Akaike信息标准)和BIC(代表贝叶斯信息标准)也被用作模型稳健性的标准。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mu"><img src="../Images/b38fdd90ea4e1f8ead4ae19130f16c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*v7jOkZCkDr_hiwA4dtdYdw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">AIC和BIC公式[1]</p></figure><p id="28df" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">这里，SSE是误差的平方和，n是记录数，k是模型中包含的变量数。实质上，AIC和BIC惩罚了给模型增加更多变量的行为。当开发一个模型时，目标是最小化AIC和BIC的值，而如果我们使用R作为度量，目标是增加它的值。</p><p id="390c" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">面临的挑战是找到一个最小化AIC/BIC或增加R的模型。如果数据集很小，我们可以找到所有可能的模型，但如果数据集很大，这种方法就不可行。它在计算上也很昂贵。我们只需要找出那些具有最高R值或最低AIC/BIC的模型。出于这个目的，我们可以从整个模型开始，随着我们一个接一个地去除独立变量，计算这些指标的值。如果数据中存在多重共线性，包含所有这些变量将导致较低的调整后R值。随着我们移除越来越多的变量，我们可能会发现某个模型产生了最高的R值。这种方法被称为逆向逐步回归。我们也可以用向前的方式进行逐步回归。这意味着我们可以从一个预测器开始，随着我们建立越来越多的模型，并同时确定这些指标，添加越来越多的预测器。</p><p id="03a8" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">出于演示的目的，我们将使用<em class="le"> CC0:公共领域</em>许可下的<a class="ae mv" href="https://www.kaggle.com/datasets/adityadesai13/used-car-dataset-ford-and-mercedes" rel="noopener ugc nofollow" target="_blank">二手车数据集</a>。我们将使用4个数字列(“里程”、“税”、“mpg”、“引擎大小”)来拟合汽车价格。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mw mx l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj my"><img src="../Images/c41813c8ed969f422272ceb7456ea0b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*9CFAtPQkWKOpWIVaOkx20Q.png"/></div></figure><p id="5b23" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">很明显，当我们从一个预测值开始并添加三个剩余的预测值时，R值增加，AIC/BIC值减少，表明模型更稳健。这意味着所有这些变量都是汽车价格的良好预测指标。如果有人只想使用AIC/BIC，有python库可以做到这一点。“RegscorePy”是一个能够执行该任务的python库。使用该库的AIC和BIC的值分别为109256.10676454737和109283.36883824323，这与我们使用statsmodel得到的值不同。然而，使用AIC/BIC的公式，我们获得了与“RegscorePy”相同的值。读者可以利用完整的笔记本并运行来检查这一点。</p><blockquote class="kz la lb"><p id="4234" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">加权回归</strong></p></blockquote><p id="c5a9" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">有时，在开发一个模型时，我们需要给某些数据更多的权重，以引入该数据对模型的重要性。例如，在我们的数据集中，我们可能会发现小的mpg值可能是不正确的。数据集中的最小mpg值是2.8，我们将从所有数据点中减去该值，这将有效地抑制那些不正确的值。在某些情况下，早期阶段收集的数据可能不正确。在这些情况下，我们可以对那些不正确的值给予较小的权重，而对较新的数据给予较大的权重。对于我们的数据，让我们应用这个加权模型。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mw mx l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">无权重线性回归()模型</p></figure><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mw mx l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">加权线性回归()模型</p></figure><p id="164d" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">有和没有加权的系数的值将是不同的。</p><blockquote class="kz la lb"><p id="2bcc" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">结论</strong></p></blockquote><p id="281f" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">在本文中，我们讨论了逐步回归和加权回归，并在Python中实现。目标是优化稳健性标准度量。一些可能使用R或调整后的R，而另一些可能使用AIC/BIC，对新术语进行更多的惩罚。无论标准是什么，这个度量都不是模型健壮性的唯一标准。还有其他检查也需要做。例如，检查残差分布和异方差在数据集中也很重要。读者可以查看我以前关于这些主题的文章。</p><p id="4d55" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">感谢阅读。</p><p id="c0f7" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated"><a class="ae mv" href="https://www.learningfromdata.net/simple-stepwise-and-weighted-regression" rel="noopener ugc nofollow" target="_blank">我的代码页</a></p><div class="mc md gq gs me mf"><a href="https://mdsohel-mahmood.medium.com/membership" rel="noopener follow" target="_blank"><div class="mg ab fp"><div class="mh ab mi cl cj mj"><h2 class="bd iv gz z fq mk fs ft ml fv fx it bi translated">用我的推荐链接加入媒体</h2><div class="mm l"><h3 class="bd b gz z fq mk fs ft ml fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mn l"><p class="bd b dl z fq mk fs ft ml fv fx dk translated">mdsohel-mahmood.medium.com</p></div></div><div class="mo l"><div class="mz l mq mr ms mo mt kt mf"/></div></div></a></div><p id="f325" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">参考</p><ol class=""><li id="4665" class="na nb iu lf b lg lh lj lk lz nc ma nd mb ne ly nf ng nh ni bi translated">信息标准和新闻，STAT 462，宾州州立大学(网址:【https://online.stat.psu.edu/stat462/node/199/ T2】)</li></ol></div></div>    
</body>
</html>