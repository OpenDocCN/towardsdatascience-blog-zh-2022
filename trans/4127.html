<html>
<head>
<title>How to Use UMAP For Much Faster And Effective Outlier Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用UMAP进行更快更有效的异常检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-umap-for-much-faster-and-effective-outlier-detection-e4608f336915#2022-09-13">https://towardsdatascience.com/how-to-use-umap-for-much-faster-and-effective-outlier-detection-e4608f336915#2022-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ceaf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们抓住那些高维离群值</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a87791ed7e0d3adab47f0598d1f5db27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VcPO-EiZlPD8zcLzwo8niQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/selective-focus-photo-of-a-red-tulip-flower-2480072/" rel="noopener ugc nofollow" target="_blank">乔·耶稣</a>拍摄</p></figure><h1 id="c19b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="e939" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们都使用过这些简单的技术——绘制散点图或KDE，离组最远的数据点是异常值。现在，告诉我——如果你要在比如说100维的数据集中发现异常值，你会如何使用这些方法？马上，视觉异常检测方法是不可能的。</p><p id="fc3c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，像局部离群因子或隔离森林这样的奇特机器学习算法浮现在脑海中，它们对高维数据中的离群点是有效的。</p><p id="9f04" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是使用ML方法检测异常值有很多注意事项。一种称为椭圆包络的技术使用协方差估计，但假设数据是正态分布的(这种情况很少发生)。局部离群因子比隔离森林快得多，但精度较低。</p><p id="318e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">那么，在处理如此常见的大规模、百万行数据集时，我们如何才能在离群点检测的速度和准确性方面表现出色呢？这就是UMAP的用武之地。</p><div class="ms mt gp gr mu mv"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">通过我的推荐链接加入Medium-BEXGBoost</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">获得独家访问我的所有⚡premium⚡内容和所有媒体没有限制。支持我的工作，给我买一个…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj ks mv"/></div></div></a></div><p id="03b8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">获得由强大的AI-Alpha信号选择和总结的最佳和最新的ML和AI论文:</p><div class="ms mt gp gr mu mv"><a href="https://alphasignal.ai/?referrer=Bex" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">阿尔法信号|机器学习的极品。艾总结的。</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">留在循环中，不用花无数时间浏览下一个突破；我们的算法识别…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">alphasignal.ai</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj ks mv"/></div></div></a></div></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="1041" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">什么是UMAP？</h1><p id="feeb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">UMAP(Uniform Manifold Approximation &amp; Projection)是2018年推出的一种降维算法。它结合了PCA和tSNE的最佳功能，可以快速扩展到大型数据集，并在速度上与PCA竞争，并且比tSNE更有效、更美观地将数据投影到低维空间:</p><div class="kj kk kl km gt ab cb"><figure class="nx kn ny nz oa ob oc paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/99b4599caf1de9139822b2530b4022c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*OMXhwgFxgwn5fLEkGrV_Pw.png"/></div></figure><figure class="nx kn ny nz oa ob oc paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/94a6cb75bec39465ec78980bbac7132f.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*GEeKKJET7WzzrGcWhL3H-A.png"/></div></figure><figure class="nx kn ny nz oa ob oc paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/bc254bfdafe0f930268e67d2bbc2df02.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*rlfn-CugxKhmZ8G7sLJQJQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk od di oe of translated">作者图片和UMAP文档</p></figure></div><p id="0448" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">UMAP python包有一个熟悉的Scikit-learn API。下面是将<a class="ae ky" href="https://www.kaggle.com/c/tabular-playground-series-sep-2021/data" rel="noopener ugc nofollow" target="_blank"> Kaggle TPS九月竞赛</a>数据投影到2D的示例代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="c52b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">UMAP的设计使得无论你将数据投影到哪个维度，它都尽可能地保留了变量和拓扑结构。但是这和异常检测有什么关系呢？</p><p id="ba47" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">好吧，因为我们知道UMAP即使在较低的维度上也能保留数据集的所有特性和属性，我们可以使用它首先将数据投影到一个较低的空间，然后使用任何其他异常值检测算法更快！在接下来的章节中，我们将使用上面的TPS九月数据来看一个例子。</p><blockquote class="oi oj ok"><p id="b05e" class="lr ls ol lt b lu mn ju lw lx mo jx lz om mp mc md on mq mg mh oo mr mk ml mm im bi translated">如果你想更多地了解UMAP及其令人敬畏的特色，我在以前的一篇文章中已经深入地讨论过了:</p></blockquote><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/beginners-guide-to-umap-for-reducing-dimensionality-and-visualizing-100-dimensional-datasets-ff5590fb17be"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">如何用UMAP以惊人的美丽方式分析100维数据</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">编辑描述</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="op l ng nh ni ne nj ks mv"/></div></div></a></div></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="a759" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">用纯隔离林设置基线</h1><p id="ea5f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们继续之前，让我们建立一个基准性能。首先，我们将为基准拟合一个CatBoostClassifier:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="45a6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的ROC AUC值为0.784。现在，让我们在输入缺失数据后，将隔离森林估计量用于数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="2132" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">尽管功能强大，隔离林只有几个参数需要调整。最重要的是<code class="fe oq or os ot b">n_estimators</code>，控制要建的树数。考虑到数据集的大小，我们将其设置为3000。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="02be" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">等待大约50分钟后，我们发现隔离林在数据中发现了2270个异常值。让我们从训练数据中删除这些值，并再次拟合分类器:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="94a5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们的性能略有下降，但这并不意味着我们要停止寻找异常值的努力。此时，我们并不真正知道这~2200个数据点是否都是数据中的异常值。我们也不知道我们是否用足够的树木建造了隔离林。最糟糕的是，我们不能再次尝试这个实验，因为它太耗时了。</p><p id="264a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这就是为什么我们将开始玩聪明。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="41d4" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">结合隔离森林的UMAP离群点检测</h1><p id="a5e5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们发现2270个异常值后，我们没有仔细检查它们是否是真正的异常值。传统的可视化方法不起作用，所以让我们先尝试将数据投影到2D，然后绘制一个散点图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl ou"><img src="../Images/b41c8fe02b490095382581e3b0bb669d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*utS0gTpSfjYPAJHCwuFGcg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="acb5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们可以立即看到离两个不同集群最远的单个点(它们以小尺寸显示，因为我们没有调整UMAP参数)。我们可以放心地将这些点归类为异常值，并相信我们从隔离林中获得的结果。</p><p id="bfff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们将把UMAP和隔离森林结合起来。为了尽可能最大限度地保留，我们将数据投影到5个维度。然后，我们将只安装500棵树的隔离林，因为这次我们的功能要少得多:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="ea02" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">整个转换和异常值检测只需三分之一的时间。但令人惊讶的是，这一次，Isolation Forest在95万个异常值中发现了大约16.3万个异常值。我们在犯错误吗？让我们在删除这些异常值后，通过再次拟合分类器来进行检查:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="797a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">3000棵树似乎不足以发现数据中的所有异常值。我们看到，即使在放弃160，000次观察后，我们仍然得到相同的结果。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="3810" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">摘要</h1><p id="acfd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是的，在从数据集中移除异常值后，我们没有获得显著的分数提高。事实上，就实用性而言，你可以说我们所有的努力完全是浪费。</p><p id="3ff8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，本文的目的是向您展示，当结合像UMAP这样的强大的降维技术时，离群点检测将变得更加节省时间/资源。如您所见，我们在隔离林中用更少的资源实现了更好的性能。</p><p id="1a33" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">离群值是ML世界中一个真实而严重的问题。您今天学到的技术一定会让您在面对如下场景时受益匪浅，尤其是当您的数据是海量和高维数据时:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/cdd725302e78ed9eb8aa9221d54f12c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*Yn2saMYfCHG_bmIL.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ow">图片来自Sklearn文档</strong></p></figure><p id="814e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以从<a class="ae ky" href="https://umap-learn.readthedocs.io/en/latest/outliers.html" rel="noopener ugc nofollow" target="_blank"> UMAP文档</a>中了解更多关于本文中的技术，其中包括一个使用digits数据的很棒的例子。</p><p id="5212" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢您的阅读！</p><div class="ms mt gp gr mu mv"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">通过我的推荐链接加入Medium。</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">获得独家访问我的所有⚡premium⚡内容和所有媒体没有限制。你可以给我买一个coffee☕，用你的…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="ne l"><div class="ox l ng nh ni ne nj ks mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a href="https://ibexorigin.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">每当Bex T .发布时收到电子邮件。</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">每当Bex T .发布时收到电子邮件。注册后，如果您还没有中型帐户，您将创建一个…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="ne l"><div class="oy l ng nh ni ne nj ks mv"/></div></div></a></div></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h2 id="d024" class="oz la it bd lb pa pb dn lf pc pd dp lj ma pe pf ll me pg ph ln mi pi pj lp pk bi translated">阅读更多来自我的故事…</h2><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/comprehensive-guide-to-deploying-any-ml-model-as-apis-with-python-and-aws-lambda-b441d257f1ec"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">使用Python和AWS Lambda将任何ML模型部署为API的综合指南</h2><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="pl l ng nh ni ne nj ks mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/25-advanced-pandas-functions-people-are-using-without-telling-you-b65fa442f0f4"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">人们在不告诉你的情况下使用的25种先进的熊猫功能</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">ExcelWriter，因式分解，分解，挤压，T，遮罩，idxmax，剪辑，…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="pm l ng nh ni ne nj ks mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/forget-roadmaps-here-is-how-to-dominate-the-data-science-stack-blazingly-fast-a49e62f2bcf"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">别管路线图了！以下是如何快速掌控数据科学堆栈的方法</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">以前所未有的方式学习新软件包</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="pn l ng nh ni ne nj ks mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/25-numpy-treasures-buried-in-the-docs-waiting-to-be-found-60d8e17931cd"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">埋藏在文件中等待被发现的25件宝贝</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">成为一名忍者</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="po l ng nh ni ne nj ks mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a href="https://ibexorigin.medium.com/28-weekly-machine-learning-tricks-and-resources-that-are-pure-gems-1-8e5259a93c94" rel="noopener follow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">28个每周机器学习技巧和资源，它们是纯粹的珍宝#1</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">一次学习一个片段的机器学习</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="ne l"><div class="pp l ng nh ni ne nj ks mv"/></div></div></a></div></div></div>    
</body>
</html>