<html>
<head>
<title>How to Connect to Airflow Workers on Cloud Composer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Cloud Composer上连接到气流工作者</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/connect-airflow-worker-gcp-e79690f3ecea#2022-05-20">https://towardsdatascience.com/connect-airflow-worker-gcp-e79690f3ecea#2022-05-20</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="93fd" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">在谷歌云平台上连接气流工作者</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/58e241f7b62dbadb3a4d02426fc6d577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rjxs4H8mvrsoXH91QbBBTQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@christinhumephoto?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">克里斯蒂安·休姆</a>在<a class="ae kz" href="https://unsplash.com/s/photos/computer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="be9c" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="b9e0" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">Cloud Composer是Google云平台上Apache Airflow的托管服务。换句话说，您可以在几秒钟内拥有一个高度可用的气流环境，然后您可以从GCP的用户界面进行管理。</p><p id="1093" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">显然，它需要连接到集群的气流工作者，以便执行某些任务，例如执行命令或检查工作者的各个方面。例如，如果您想要连接到Airflow数据库，那么一旦您连接到集群中的一个workers，那么就很容易做到。</p><p id="91d2" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的简短教程中，我们将详细介绍一个循序渐进的指南，你可以按照这个指南与谷歌云平台上的任何气流工作者建立联系。这非常简单，基本上可以通过四个简单的步骤来完成。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="7053" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤1:获取您的环境的项目路径和区域</h2><ul class=""><li id="e2f9" class="nb nc iu ly b lz ma mc md lj nd ln ne lr nf mo ng nh ni nj bi translated">从控制台上的Cloud Composer环境中，单击您想要连接的环境。</li><li id="79a1" class="nb nc iu ly b lz nk mc nl lj nm ln nn lr no mo ng nh ni nj bi translated">然后选择<code class="fe np nq nr ns b">ENVIRONMENT CONFIGURATION</code>选项卡</li><li id="6975" class="nb nc iu ly b lz nk mc nl lj nm ln nn lr no mo ng nh ni nj bi translated">从屏幕上出现的部分，我们将需要项目路径和环境的区域。</li><li id="2bf9" class="nb nc iu ly b lz nk mc nl lj nm ln nn lr no mo ng nh ni nj bi translated">前者可以在<code class="fe np nq nr ns b">GKE cluster</code>下找到(会是<code class="fe np nq nr ns b">projects/../../gke</code>的形式)</li></ul><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nt"><img src="../Images/60ace2b9e5cb799824e7a1e828f275b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ey_SqRtmkCOHkviWafZrKQ.png"/></div></div></figure><ul class=""><li id="0cd6" class="nb nc iu ly b lz mp mc mq lj nu ln nv lr nw mo ng nh ni nj bi translated">以及配置中<code class="fe np nq nr ns b">zone</code>条目下的区域</li></ul><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nx"><img src="../Images/16bb2139552079fcadaee55aa492f357.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*gPs5fTFHq0FhEbMTJf-VAQ.png"/></div></figure><ul class=""><li id="899e" class="nb nc iu ly b lz mp mc mq lj nu ln nv lr nw mo ng nh ni nj bi translated">请记下它们，因为我们将在后续步骤中使用它们</li></ul></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="f643" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤2:获取Kubernetes集群的凭证</h2><p id="cc9e" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在我们需要运行<code class="fe np nq nr ns b"><a class="ae kz" href="https://cloud.google.com/sdk/gcloud/reference/container/clusters/get-credentials" rel="noopener ugc nofollow" target="_blank">get-credentials</a></code>来检索运行Cloud Composer的Kubernetes集群的凭证。</p><pre class="kk kl km kn gu ny ns nz oa aw ob bi"><span id="9a53" class="la lb iu ns b gz oc od l oe of">gcloud container clusters get-credentials \<br/>    &lt;project-path&gt; \<br/>    --zone &lt;zone&gt;</span></pre><p id="1251" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">一旦您执行了上面的命令，一个带有适当凭证和端点信息的<code class="fe np nq nr ns b">kubeconfig</code>文件将会更新，该文件指向Google Kubernetes引擎中特定集群的<code class="fe np nq nr ns b">kubectl</code>。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="4ea2" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">步骤3:获取正在运行的Composer和Worker的名称空间</h2><p id="3e58" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">现在，我们需要检索正在运行的Cloud Composer实例的名称空间以及我们希望连接到的Airflow worker的名称。为此，我们需要运行以下命令。</p><pre class="kk kl km kn gu ny ns nz oa aw ob bi"><span id="8736" class="la lb iu ns b gz oc od l oe of">kubectl get pods --all-namespaces</span></pre><p id="70f7" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">该命令的输出将——很可能——包含大量用于气流调度器、气流工作器等的名称空间。</p><ul class=""><li id="f4a0" class="nb nc iu ly b lz mp mc mq lj nu ln nv lr nw mo ng nh ni nj bi translated">从输出中的<code class="fe np nq nr ns b">NAMESPACE</code>列，记下前缀为<code class="fe np nq nr ns b">composer-</code>的云组件实例的名称空间。</li><li id="0c30" class="nb nc iu ly b lz nk mc nl lj nm ln nn lr no mo ng nh ni nj bi translated">此外，请注意其中一个气流工作者的<code class="fe np nq nr ns b">NAME</code>(请注意，输出包含各种气流组件的大量条目，因此请确保选择其中一个气流工作者。名称应该有一个<code class="fe np nq nr ns b">airflow-worker-</code>前缀)。</li></ul></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="4684" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第四步:连接到气流工作者</h2><p id="e62b" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">最后，现在我们已经有了Cloud Composer名称空间和Airflow worker的名称，我们只需运行以下命令就可以连接到它:</p><pre class="kk kl km kn gu ny ns nz oa aw ob bi"><span id="512b" class="la lb iu ns b gz oc od l oe of">kubectl exec -itn &lt;composer-namespace&gt; &lt;worker-name&gt; -- /bin/bash</span></pre><p id="76b0" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">举个例子，</p><pre class="kk kl km kn gu ny ns nz oa aw ob bi"><span id="546e" class="la lb iu ns b gz oc od l oe of">kubectl exec -itn \<br/>    composer-1-10-0-airflow-1-10-15-5983e0fe \<br/>    airflow-worker-8d8c49c87-9v7c4 \<br/>    -- /bin/bash</span></pre><p id="ffbc" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">瞧啊。现在，您已连接到气流工作者。您现在可以运行气流命令(如<code class="fe np nq nr ns b">airflow --version</code>)，甚至可以通过运行<code class="fe np nq nr ns b">airflow shell</code>连接到气流数据库。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="f4cc" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">Cloud Composer是谷歌云平台上Apache Airflow的托管服务，是让数据工程师编写、执行和编排数据管道的最强大的服务之一。</p><p id="7886" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的短文中，我们探讨了连接到Cloud Composer集群上的Airflow Workers并执行某些命令甚至连接到Airflow数据库所需的步骤。</p><p id="a1a1" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">编码快乐！</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="og oh gq gs oi oj"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="ok ab fp"><div class="ol ab om cl cj on"><h2 class="bd iv gz z fq oo fs ft op fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="oq l"><h3 class="bd b gz z fq oo fs ft op fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="or l"><p class="bd b dl z fq oo fs ft op fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox kt oj"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">相关文章您可能也喜欢</strong></p><div class="og oh gq gs oi oj"><a rel="noopener follow" target="_blank" href="/run-airflow-docker-1b83a57616fb"><div class="ok ab fp"><div class="ol ab om cl cj on"><h2 class="bd iv gz z fq oo fs ft op fv fx it bi translated">如何使用Docker在本地运行气流</h2><div class="oq l"><h3 class="bd b gz z fq oo fs ft op fv fx dk translated">在本地机器上使用Docker运行Airflow的分步指南</h3></div><div class="or l"><p class="bd b dl z fq oo fs ft op fv fx dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox kt oj"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu oj"><a rel="noopener follow" target="_blank" href="/data-engineer-tools-c7e68eed28ad"><div class="ok ab fp"><div class="ol ab om cl cj on"><h2 class="bd iv gz z fq oo fs ft op fv fx it bi translated">数据工程师的工具</h2><div class="oq l"><h3 class="bd b gz z fq oo fs ft op fv fx dk translated">数据工程工具箱的基础</h3></div><div class="or l"><p class="bd b dl z fq oo fs ft op fv fx dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oz l ou ov ow os ox kt oj"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu oj"><a href="https://levelup.gitconnected.com/ebs-vs-efs-aws-7b3e41c093f7" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fp"><div class="ol ab om cl cj on"><h2 class="bd iv gz z fq oo fs ft op fv fx it bi translated">亚马逊网络服务中的EBS vs EFS</h2><div class="oq l"><h3 class="bd b gz z fq oo fs ft op fv fx dk translated">了解AWS中弹性块存储和弹性文件系统的区别</h3></div><div class="or l"><p class="bd b dl z fq oo fs ft op fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="os l"><div class="pa l ou ov ow os ox kt oj"/></div></div></a></div></div></div>    
</body>
</html>