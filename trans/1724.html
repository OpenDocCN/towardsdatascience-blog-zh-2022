<html>
<head>
<title>Data wrangling of Excel file produced by Wandb.ai</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Wandb.ai制作Excel文件的数据角力</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-wrangling-of-excel-file-produced-by-wandb-ai-68157d67dbde#2022-04-22">https://towardsdatascience.com/data-wrangling-of-excel-file-produced-by-wandb-ai-68157d67dbde#2022-04-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="af4e" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">最好保持真实。— <em class="iq">作者:连姆·尼森</em></p></blockquote><p id="eff5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">简而言之:使用VBA删除标题中包含特定单词的Excel列。</p><p id="fc06" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi ks translated"><span class="l kt ku kv bm kw kx ky kz la di"> W </span> andb.ai提供了一个中央仪表盘来跟踪您的超参数、系统指标和预测，以便您可以实时比较模型并分享您的发现。这使得研究人员可以根据记录的数据绘制图表；同时，它还绘制了一段时间内记录的默认值。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/f45ce3a4a1133bf161c856f2e29a5c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJlDoHusspSe7Ja1iaYdXg.jpeg"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">Wandb仪表盘(图片提供:【https://wandb.ai/site】T4)</p></figure><h1 id="1c53" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">动机</h1><p id="434b" class="pw-post-body-paragraph jq jr iq jt b ju mq jw jx jy mr ka kb kp ms ke kf kq mt ki kj kr mu km kn ko ij bi translated">随着大量信息被记录到Wandb中，利用所有这些信息来记录有意义的图表变得更加容易。</p><p id="55ca" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">当有人希望将这些图表的数据下载到Excel文件中进行进一步处理时，问题就出现了。尽管这些图表上的数据看起来很可爱，但在Excel中，潜在的支持数据却非常庞大。</p><p id="2918" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">昨晚我在做一个漂亮的科幻图表，这很棒，但后来我意识到我需要对这些数据做更多的处理。为此，我下载了Excel格式的图表数据，发现了大量的数据字段，大约有256个属性；其中一半以上是不需要的。所以<em class="js">我在wandb中搜索过滤器功能，但是在我写这篇文章的时候它还没有出现:(</em>希望它会在我的文章之后出现)。</p><p id="1f91" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">人们可以想到的一个修复方法是执行<strong class="jt ir"> Ctrl +F </strong>并找到您感兴趣的列，然后将它们移动到一个新的工作表中，但是我借此机会学习了一个方便的宏，值得与DataScience社区共享。</p><h1 id="181d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">解决</h1><h2 id="840a" class="mv lt iq bd lu mw mx dn ly my mz dp mc kp na nb mg kq nc nd mk kr ne nf mo ng bi translated">投稿:如果Excel中不必要的列的名称包含(' somethingThatIDontKnowYet ')，如何删除这些列？</h2><p id="6160" class="pw-post-body-paragraph jq jr iq jt b ju mq jw jx jy mr ka kb kp ms ke kf kq mt ki kj kr mu km kn ko ij bi translated">解决问题的步骤:</p><ol class=""><li id="a85c" class="nh ni iq jt b ju jv jy jz kp nj kq nk kr nl ko nm nn no np bi translated">在Excel文件的标题列中找到模式，这是进一步处理所不需要的。例如，我想删除后缀为<strong class="jt ir"> _steps、_MAX、</strong>和<strong class="jt ir"> _MIN的列。</strong></li></ol><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nq"><img src="../Images/10dd0ed8d15ae8ceec22e68b71c5cd04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sdojnUh66dFvfJjy3eObQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">导出的wandb Excel文件</p></figure><p id="4e80" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">2.一旦你确定了你想要删除的列中的<strong class="jt ir">‘文本’</strong>，下一步就是启动一些VBA命令来删除它。</p><p id="f73e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">对于<strong class="jt ir"> Windows 10 </strong>用户，是<strong class="jt ir"><em class="js">Ctrl+F11</em></strong><em class="js">。这将为您打开一个新的宏表。将wandb表中的所有数据复制到宏表中。然后右击宏表的任意单元格，选择<strong class="jt ir"><em class="js"/></strong>菜单项。</em></p><div class="lc ld le lf gt ab cb"><figure class="nr lg ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><img src="../Images/7e26fa7e85f59f3d42391284bcd34ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*m2bTccf7L0Q0MNTn1npAzg.png"/></div></figure><figure class="nr lg nx nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><img src="../Images/989a3a14e065f6c88ecf75fd3de06190.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*OytF5lbBWIrShlS8Kwye1A.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk ny di nz oa translated">右边的图像是一个宏表，当你按下(Ctrl+ F11)时就会出现。左图显示了右键单击任何工作表单元格后可以看到的菜单项。</p></figure></div><p id="2ead" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3.给你的宏命名。我称之为<em class="js"> DeleteSpecificCell </em>(应该是一个<em class="js">DeleteColumnsContaining</em>；大脑有自己有趣的做事方式😐).一旦你<strong class="jt ir">点击创建</strong>，一个VBA编辑器将会打开，如下图右侧所示。</p><p id="3cb7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在您的VBA编辑器中，您最初会看到两行:</p><pre class="lc ld le lf gt ob oc od oe aw of bi"><span id="ba7d" class="mv lt iq oc b gy og oh l oi oj"><strong class="oc ir">Sub DeleteSpecificCell()</strong></span><span id="6417" class="mv lt iq oc b gy ok oh l oi oj">    &lt;&lt;We will be writing code in here&gt;&gt;</span><span id="d542" class="mv lt iq oc b gy ok oh l oi oj"><strong class="oc ir">End Sub</strong></span></pre><p id="10cf" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在代码块中，编写:</p><pre class="lc ld le lf gt ob oc od oe aw of bi"><span id="d45b" class="mv lt iq oc b gy og oh l oi oj"><strong class="oc ir">Set MR = Range("A1:EI1")<br/>    For Each cell In MR<br/>        If InStrB(1, cell.Value, "step", vbBinaryCompare) &lt;&gt; 0 Then cell.EntireColumn.Delete<br/>    Next</strong></span></pre><p id="6043" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">代码块解释:</p><pre class="lc ld le lf gt ob oc od oe aw of bi"><span id="4006" class="mv lt iq oc b gy og oh l oi oj"># Underneath line represents the selection of columns in the workheet which will be considered while running macro <br/><strong class="oc ir">Set MR = Range("A1:EI1") </strong><br/>    <strong class="oc ir">For Each cell In MR</strong><br/>  # Underneath line tells macro to delete entire column where header contains "step" replace this with your identified text.<br/>        <strong class="oc ir">If InStrB(1, cell.Value, "step", vbBinaryCompare) &lt;&gt; 0 Then cell.EntireColumn.Delete<br/>    Next</strong></span></pre><div class="lc ld le lf gt ab cb"><figure class="nr lg ol nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><img src="../Images/ea911e67d4364843cfb95dc22cc31956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*EEa0O-wIuAmEgmKioz3Ypw.png"/></div></figure><figure class="nr lg om nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><img src="../Images/d1dd154aecf87d8b079011dc44bad475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fbzJYqEiaDGE-oRLWsDUmg.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk on di oo oa translated">右侧的图像显示了在执行上一步时，点击菜单中的<strong class="bd op">运行</strong>后出现的屏幕。左边的图片显示了VAB编辑器，一旦你为你的宏提供了一个名字，点击<strong class="bd op">创建</strong>按钮，这个编辑器就会打开。</p></figure></div><p id="d42d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3.瞧啊。！菜谱做好了。<strong class="jt ir">填写完数据后，按F5 </strong>键，返回宏表查看神奇之处。我能够将256列减少到65列，以便进一步处理。</p><p id="a068" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">这样，Wandb客户从此可以愉快地处理他们的数据。</p><p id="9c1d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">编码快乐！！</p><h1 id="22aa" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">参考:</h1><p id="c41d" class="pw-post-body-paragraph jq jr iq jt b ju mq jw jx jy mr ka kb kp ms ke kf kq mt ki kj kr mu km kn ko ij bi translated"><a class="ae lr" href="https://www.extendoffice.com/documents/excel/3086-excel-delete-columns-based-on-header.html#:~:text=Right%20click%20the%20column%20header,columns%20are%20deleted%20at%20once" rel="noopener ugc nofollow" target="_blank">https://www . extend office . com/documents/excel/3086-excel-delete-columns-based-on-header . html #:~:text = Right % 20 click % 20 column % 20 header，columns % 20被%20deleted%20at%20once </a>。</p></div></div>    
</body>
</html>