<html>
<head>
<title>How to Generate Synthetic Data for any Causal Inference Project in less than 10 Lines of Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用不到10行代码为任何因果推理项目生成合成数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-generate-synthetic-data-for-any-causal-inference-project-in-less-than-10-lines-of-code-158688a89349#2022-09-07">https://towardsdatascience.com/how-to-generate-synthetic-data-for-any-causal-inference-project-in-less-than-10-lines-of-code-158688a89349#2022-09-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="472a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如果99%的人接种了疫苗，1%的人出现反应，2%的人得病，你如何生成有代表性的合成数据？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ba275e511525fcaf730d70c9ba76ff6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Lj9FRRj-pcIWUqvX_4jOw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@mufidpwt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">穆菲德·马吉纳</a>在<a class="ae ky" href="https://unsplash.com/s/photos/vaccine?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="cb07" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="6372" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">在“原因之书”中，Judea Pearl使用了一个疫苗接种、反应、天花和死亡的例子来描述和解释“因果关系的阶梯”,这促使我用Python实现这个例子，但我无法找到一种方法来生成我需要开始使用的测试数据。</p><div class="mo mp gp gr mq mr"><a href="https://www.amazon.co.uk/Book-Why-Science-Cause-Effect/dp/0241242630" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">为什么之书:因果的新科学</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">购买由珀尔，朱迪亚，麦肯齐，达纳(ISBN: 9780241242636)所著的《为什么:因果的新科学》一书</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">www.amazon.co.uk</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ks mr"/></div></div></a></div><p id="616e" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">在我们深入研究合成数据生成之前，请考虑…</p><p id="f0d9" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/membership" rel="noopener">通过我的推荐链接</a>加入Medium(如果你使用此链接注册，我将收取一定比例的费用)。</p><p id="e35b" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">每当我发表新故事时，订阅一封免费电子邮件。</p><p id="2ecb" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/" rel="noopener">快速浏览我之前的文章</a>。</p><p id="232f" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated"><a class="ae ky" href="https://relentless-originator-3199.ck.page/5f4857fd12" rel="noopener ugc nofollow" target="_blank">下载我的免费战略数据驱动决策框架</a>。</p><p id="0545" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">访问我的数据科学网站— <a class="ae ky" href="https://www.the-data-blog.co.uk/" rel="noopener ugc nofollow" target="_blank">数据博客</a>。</p><h2 id="8b3e" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">背景</h2><p id="d203" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">Pearl提出了疫苗接种计划、反应(副作用)、疾病发展以及疾病和副作用导致的死亡之间的假设关系的因果图，如下所示…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/c73f31bf3a007eb276f39e67a2ebda05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*07DqJcBrO9uqpYUbp-RUDg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3a51" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">珀尔接着描述了一项假设调查的结果如下…</p><ol class=""><li id="5b3b" class="nm nn it lx b ly ng mb nh li no lm np lq nq mn nr ns nt nu bi translated">在100万名儿童中，990，000人(99%)接种了疫苗</li><li id="3317" class="nm nn it lx b ly nv mb nw li nx lm ny lq nz mn nr ns nt nu bi translated">在接种疫苗的人中，9900人(990000人中的1%)有反应</li><li id="6936" class="nm nn it lx b ly nv mb nw li nx lm ny lq nz mn nr ns nt nu bi translated">在那些有反应的人中，99人(9900人中的1%)死于该反应</li><li id="9038" class="nm nn it lx b ly nv mb nw li nx lm ny lq nz mn nr ns nt nu bi translated">在没有接种疫苗的人群中，有200人(10000人中的2%)感染了天花</li><li id="332c" class="nm nn it lx b ly nv mb nw li nx lm ny lq nz mn nr ns nt nu bi translated">在患天花的人中，40人(200人中的20%)死于这种疾病</li></ol><p id="e866" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">根据Pearl提出的因果影响图和假设调查的统计数据，我推测我的第一步是创建一个数据集，将调查表示为一只熊猫<code class="fe oa ob oc od b">DataFrame</code>,因此我在互联网上寻找创建数据的方法。</p><p id="9d58" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">我找到了scikit-learn库，用于生成“blob”和“分类”数据，我还找到了像<a class="ae ky" href="https://faker.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank"> faker </a>和<a class="ae ky" href="https://sdv.dev/SDV/" rel="noopener ugc nofollow" target="_blank"> SDV </a>这样的库，但我找不到任何东西来生成适合作为因果或概率模型输入的二进制数据集。</p><p id="c712" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">鉴于我在网上找不到任何合适的东西，并且我需要一些数据来开始我的因果推理之旅，我开始编写代码，可以自己创建任何合成的二进制数据集…</p><h2 id="cc71" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">程序性解决方案</h2><p id="9748" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">基本要求是-</p><ol class=""><li id="e1e6" class="nm nn it lx b ly ng mb nh li no lm np lq nq mn nr ns nt nu bi translated">创建一个具有正确行数和特征数的空白<code class="fe oa ob oc od b">DataFrame</code></li><li id="2e19" class="nm nn it lx b ly nv mb nw li nx lm ny lq nz mn nr ns nt nu bi translated">用代表假设调查的5个结果中的每一个的值更新<code class="fe oa ob oc od b">DataFrame</code></li></ol><p id="2c93" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">创造空的<code class="fe oa ob oc od b">DataFrame</code>非常简单</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ba563f6f8b13874e8a73c131778d7e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*ym29FOSv1_vDDdQCU93W_A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a9d2" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">下一步是实施这一规则——通过将990，000或99%的行的<code class="fe oa ob oc od b">Vaccination? = 0</code>更改为<code class="fe oa ob oc od b">Vaccination? = 1</code>，实现“在100万儿童中，990，000 (99%)接种了疫苗”。</p><p id="34b4" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">这被证明是非常困难的。我的第一个想法是使用<code class="fe oa ob oc od b">DataFrame.sample(990000)</code>进行采样并更新值，但是更新并没有应用到底层的<code class="fe oa ob oc od b">DataFrame</code>上，所以这是行不通的。</p><p id="47b0" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">经过一些实验，这是我想出的解决方案…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="37fe" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">…为了确保代码正常工作…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><pre class="kj kk kl km gt oh od oi oj aw ok bi"><span id="a423" class="kz la it od b gy ol om l on oo">1    990000<br/>0     10000<br/>Name: Vaccination?, dtype: int64</span></pre><p id="9324" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">到目前为止，一切顺利。下一步是实施这一规则——“在接种疫苗的人中，有9900人(99万人中的1%)出现反应”。这有点复杂，因为它需要两个阶段-</p><ol class=""><li id="7c07" class="nm nn it lx b ly ng mb nh li no lm np lq nq mn nr ns nt nu bi translated">选择<code class="fe oa ob oc od b">Vaccination? == 1</code>所在的行</li><li id="5fa9" class="nm nn it lx b ly nv mb nw li nx lm ny lq nz mn nr ns nt nu bi translated">为这些选定行中的9900行(或1%)设置<code class="fe oa ob oc od b">Reaction? = 1</code></li></ol><p id="9c9c" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">经过更多的反复试验，这是我开发的解决方案…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="947a" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">…为了测试它…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><pre class="kj kk kl km gt oh od oi oj aw ok bi"><span id="0c91" class="kz la it od b gy ol om l on oo">Vaccination?  Reaction?  Smallpox?  Death?<br/>1             0          0          0         980100<br/>0             0          0          0          10000<br/>1             1          0          0           9900<br/>dtype: int64</span></pre><p id="6236" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">现在，寻找解决方案的艰苦工作已经结束，实现所有5个规则的整个数据集只需几行代码就可以生成…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="8f9c" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">…为了验证解决方案…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/efa28828cb05819a43d71d00eab2af78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*O2T6ZBwTI-sPBqkRVfPhbQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="5ca5" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">面向对象编程(OOP)解决方案</h2><p id="6389" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">程序性解决方案为生成合成二进制数据集提供了一个体面的实现，该数据集将用作因果和概率项目的输入，但它可以重写为OOP解决方案，以减少代码重复并最大化代码重用…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="5f0e" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">为假设的天花例子创建我们的合成数据集变得非常直接…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/efa28828cb05819a43d71d00eab2af78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*O2T6ZBwTI-sPBqkRVfPhbQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4ce8" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">如果你想下载二进制数据生成器的完整版本，包括全面的文档，请前往GitHub 中的<a class="ae ky" href="https://gist.github.com/grahamharrison68/33c48217cb487d79c7456e9c2431a1c2" rel="noopener ugc nofollow" target="_blank">这个要点。</a></p><h1 id="5c99" class="oq la it bd lb or os ot le ou ov ow lh jz ox ka ll kc oy kd lp kf oz kg lt pa bi translated">结论</h1><p id="473e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">因果推理是一个热门话题，支持和告知机器学习和人工智能这一分支的图书馆和文章的数量正在呈指数增长。</p><p id="720b" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">然而，创建项目以测试因果推理解决方案的第一步是创建一些合成数据，并且没有库或文章为数据创建提供模板。</p><p id="6231" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">本文探讨了这个问题的背景，提供了一个生成合成数据的过程化解决方案，还提供了一个面向对象的解决方案，可以轻松地重用它来生成合成数据，以测试任何因果推理问题。</p><p id="a601" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">如果你喜欢这篇文章，请考虑…</p><p id="226d" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/membership" rel="noopener">通过我的推荐链接</a>加入媒体(如果你使用这个链接注册，我将收取一定比例的费用)。</p><div class="mo mp gp gr mq mr"><a href="https://grahamharrison-86487.medium.com/membership" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">通过我的推荐链接加入媒体-格雷厄姆哈里森</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">阅读格雷厄姆·哈里森(以及媒体上成千上万的其他作家)的每一个故事。增强您的数据知识…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">grahamharrison-86487.medium.com</p></div></div><div class="na l"><div class="pb l nc nd ne na nf ks mr"/></div></div></a></div><p id="23a0" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/subscribe" rel="noopener">每当我发表一个新故事时，订阅一封免费电子邮件</a>。</p><p id="3695" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/" rel="noopener">快速浏览一下我之前的文章</a>。</p><p id="04b1" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated"><a class="ae ky" href="https://relentless-originator-3199.ck.page/5f4857fd12" rel="noopener ugc nofollow" target="_blank">下载我的免费战略数据驱动决策框架</a>。</p><p id="e881" class="pw-post-body-paragraph lv lw it lx b ly ng ju ma mb nh jx md li ni mf mg lm nj mi mj lq nk ml mm mn im bi translated">访问我的数据科学网站— <a class="ae ky" href="https://www.the-data-blog.co.uk/" rel="noopener ugc nofollow" target="_blank">数据博客</a>。</p></div></div>    
</body>
</html>