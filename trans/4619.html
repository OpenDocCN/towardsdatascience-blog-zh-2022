<html>
<head>
<title>Three Common Data Analysis Operations with Three Common Tools</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用三种常用工具进行三种常用数据分析操作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-common-data-analysis-operations-with-3-common-tools-9288ce61a40f#2022-10-13">https://towardsdatascience.com/3-common-data-analysis-operations-with-3-common-tools-9288ce61a40f#2022-10-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0fc0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫，数据表和SQL</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/84e69e3b7c8f087d5d1dc2f2fbb04113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MZWd-Ae6XZu2jL5wcrZenA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杰克·亨特在<a class="ae ky" href="https://unsplash.com/s/photos/three?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a180" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们分析数据以提取见解，找到有价值的信息，或者发现仅仅通过浏览看不见的东西。数据分析过程的复杂程度取决于数据的特征和结构。</p><p id="0507" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，有一些基本操作是经常做的。这些可以被认为是数据分析的基础:</p><ul class=""><li id="31d9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">分组</li><li id="b904" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">过滤</li><li id="55af" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">整理</li></ul><p id="63fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将学习如何使用3种最常用的数据分析工具来完成这些操作:</p><ul class=""><li id="b4b0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">熊猫换蟒蛇</li><li id="a637" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">R的数据表</li><li id="6743" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">结构化查询语言</li></ul><p id="bcee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的目标不是比较这些工具，也不是将一个工具归类为优于其他工具。在您的数据科学职业生涯中，您可能需要使用它们中的任何一个或全部，因为这些工具被许多公司使用。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="81b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像往常一样，我们将通过做例子来学习，所以我们需要一个数据集来处理。我用模拟数据准备了一个销售数据集。你可以从我的GitHub页面上的<a class="ae ky" href="https://github.com/SonerYldrm/datasets" rel="noopener ugc nofollow" target="_blank">数据集</a>库中下载。叫做“销售_数据_与_商店”。以下是该数据集的前5行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/30f7fd78bf62419bb74a009ad47470cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Xqiit_4-2raUrM97DzJ0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">sales_data_with_stores(作者图片)</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="8622" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">分组</h1><p id="9e21" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在探索性数据分析中，通常根据一列或多列中的不同值或类别对数据点(即表格数据中的行)进行分组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/1cf2fc2983f45ea3bb35ab5d4bf44fdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MIk_w3_ftuB_Ord6.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f3b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过分组可以计算出一些东西:</p><ul class=""><li id="6be5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">各品牌平均汽车价格</li><li id="bc50" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">每月平均收入</li><li id="456f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">一周中销售量最高的一天</li></ul><p id="df0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到我们的数据集，我们可以找到每个商店上周的平均销售额，如下所示:</p><p id="63f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">熊猫</strong></p><p id="86f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用groupby和mean函数。首先，按照商店列对行进行分组。然后，我们选择要聚合的列，并应用相关的函数。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="e6e9" class="nu ms it nq b gy nv nw l nx ny">import pandas as pd</span><span id="6606" class="nu ms it nq b gy nz nw l nx ny">df = pd.read_csv("sales_data_with_stores.csv")</span><span id="769b" class="nu ms it nq b gy nz nw l nx ny">df.groupby("store")["last_week_sales"].mean()</span><span id="f4cd" class="nu ms it nq b gy nz nw l nx ny"># output<br/>store<br/>Daisy     66.544681<br/>Rose      64.520000<br/>Violet    99.206061<br/>Name: last_week_sales, dtype: float64</span></pre><p id="558e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据表</strong></p><p id="9e43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据表包的语法比熊猫简单一点。要执行的操作用逗号分隔在方括号中，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/a1d81c5bd5be3e20d6aaa90291947dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Rn_f6DCnXuX4bq0kMdASw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据表语法结构(图片由作者提供)</p></figure><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="5e87" class="nu ms it nq b gy nv nw l nx ny">library(data.table)</span><span id="7990" class="nu ms it nq b gy nz nw l nx ny">dt &lt;- fread("sales_data_with_stores.csv")</span><span id="79b8" class="nu ms it nq b gy nz nw l nx ny">dt[, mean(last_week_sales), store]</span><span id="a27e" class="nu ms it nq b gy nz nw l nx ny"># output<br/>    store       V1<br/>1: Violet 99.20606<br/>2:   Rose 64.52000<br/>3:  Daisy 66.54468</span></pre><p id="35b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> SQL </strong></p><p id="0ea8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们有一个名为sales的表，其中包含我们的数据集中的数据。我们使用select和group by语句如下:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="981c" class="nu ms it nq b gy nv nw l nx ny">SELECT<br/>   store,<br/>   AVG(last_week_sales)<br/>FROM sales<br/>GROUP BY store</span></pre><p id="1b77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出将与其他示例中的相同。</p><p id="4eba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在所有的例子中，聚集的列没有一个自解释的列名，这不是理想的情况，尤其是在与其他人一起工作时。让我们再做一系列例子，找出每个商店的平均产品价格和总库存数量。我们还将为聚合列分配名称。</p><p id="5cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫</p><p id="b00b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用agg函数。要聚合的列和聚合函数写在元组中，如下所示:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="4de4" class="nu ms it nq b gy nv nw l nx ny">df.groupby("store").agg(<br/>    <br/>    avg_price = ("price", "mean"),<br/>    total_stock = ("stock_qty", "sum")</span><span id="569e" class="nu ms it nq b gy nz nw l nx ny">)</span><span id="d23a" class="nu ms it nq b gy nz nw l nx ny"># output</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/f03aecc46f599fe0a0234281b7c873ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bn73mNBBKM3OdybOLSZL2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="23a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据表</strong></p><p id="c847" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">语法的结构是相同的，但是有一些小的改动。聚合写在前面带点的括号内。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="1766" class="nu ms it nq b gy nv nw l nx ny">dt[, <br/>   .(<br/>     avg_price = mean(price),<br/>     total_stock = sum(stock_qty)<br/>     ),<br/>   store<br/>   ]</span></pre><p id="730c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> SQL </strong></p><p id="531f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它与另一个SQL示例非常相似。我们只需要添加列名。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="d7c7" class="nu ms it nq b gy nv nw l nx ny">SELECT<br/>   store,<br/>   AVG(price) AS avg_price,<br/>   SUM(stock_qty) AS total_stock<br/>FROM sales<br/>GROUP BY store</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="6cdc" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated"><strong class="ak">过滤</strong></h1><p id="186e" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">过滤是数据分析中另一种常见的操作。大多数工具都提供了基于字符串、数字和日期值过滤原始数据的函数和方法。</p><p id="5762" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将做一个包含字符串和数字过滤器的例子。让我们选择数据点(即行),其中:</p><ul class=""><li id="7b12" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">商店是紫色的</li><li id="c23a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">产品组是PG1、PG3或PG5</li><li id="92a2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">上个月销售额超过100英镑</li></ul><p id="cceb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">熊猫</strong></p><p id="03d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们把过滤条件写在方括号内。在有多个条件的情况下，每个条件都写在括号内，并且条件用适当的逻辑运算符组合(例如&amp; for end，| for or logic)。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="308d" class="nu ms it nq b gy nv nw l nx ny">df[<br/>    (df["store"] == "Violet") &amp;<br/>    (df["product_group"].isin(["PG1","PG3","PG5"])) &amp; <br/>    (df["last_month_sales"] &gt; 100)<br/>]</span></pre><p id="642b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码的输出是一个数据帧，其中的行符合给定的一组条件。</p><p id="1616" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据表</strong></p><p id="da0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">逻辑也差不多。在这种情况下，我们使用and运算符组合多个条件。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="8328" class="nu ms it nq b gy nv nw l nx ny">dt[<br/>    store == "Violet" &amp;<br/>    product_group %in% c("PG1","PG3", "PG5") &amp;<br/>    last_month_sales &gt; 100<br/>  ]</span></pre><p id="429a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> SQL </strong></p><p id="b4ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">条件在where语句中指定。在这种情况下，我们使用and关键字来组合多个条件。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="2802" class="nu ms it nq b gy nv nw l nx ny">SELECT *<br/>FROM sales<br/>WHERE store = "Violet" AND<br/>      product_group in ("PG1", "PG3", "PG5") AND<br/>      last_month_sales &gt; 100</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="a20f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">整理</h1><p id="9de4" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">我们有时需要根据一列或多列中的值对行进行排序。例如，我们可能希望根据价格对产品进行降序排序。</p><p id="8bb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫</p><p id="20fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sort_values函数用于此任务。我们只需要编写将用于排序的列。默认情况下，Pandas按升序排序，但是可以使用ascending参数改变这种行为。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="81e5" class="nu ms it nq b gy nv nw l nx ny">df_sorted = df.sort_values(by="price", ascending=False)</span></pre><p id="5383" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据表</strong></p><p id="6384" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用了order函数。要从升序改为降序，我们只需要在列名前面加一个减号。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="35d0" class="nu ms it nq b gy nv nw l nx ny">dt_sorted &lt;- dt[order(-price)]</span></pre><p id="ef90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> SQL </strong></p><p id="e2be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">order by语句在SQL中用于对行进行排序。像data.table和Pandas一样，这些行按升序排序。我们可以使用desc关键字进行降序排序。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="2d6c" class="nu ms it nq b gy nv nw l nx ny">SELECT *<br/>FROM sales<br/>ORDER BY price DESC</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="c93b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经学习了如何使用数据科学生态系统中的3种常用工具进行3种基本的数据分析操作。我们已经讨论了简单的情况，但是所使用的函数和方法也能够完成更复杂的任务。在学习细节之前，最好先掌握基本知识。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="d63b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oc">你可以成为</em> <a class="ae ky" href="https://sonery.medium.com/membership" rel="noopener"> <em class="oc">媒介会员</em> </a> <em class="oc">解锁我的全部写作权限，外加其余媒介。如果你已经是了，别忘了订阅</em><a class="ae ky" href="https://sonery.medium.com/subscribe" rel="noopener"><em class="oc"/></a><em class="oc">如果你想在我发表新文章时收到电子邮件。</em></p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="50c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>