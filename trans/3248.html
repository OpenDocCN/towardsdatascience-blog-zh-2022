<html>
<head>
<title>McNemar’s Test to evaluate Machine Learning Classifiers with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python评估机器学习分类器的McNemar测试</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mcnemars-test-to-evaluate-machine-learning-classifiers-with-python-9f26191e1a6b#2022-07-19">https://towardsdatascience.com/mcnemars-test-to-evaluate-machine-learning-classifiers-with-python-9f26191e1a6b#2022-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/6b2abec2502afd981654ae6e4d6b7959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LyC7-IF8tQIgouh4"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">艾萨克·史密斯在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="3efc" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">了解如何使用Python通过显著性测试比较ML分类器</h2></div><h1 id="f153" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">介绍</h1><p id="0a7b" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在我的<a class="ae jd" href="https://medium.com/@marcellopoliti/hypotesis-testing-and-climate-change-7ef750ce149e" rel="noopener">上一篇文章</a>中，我谈到了使用统计工具正确比较不同模型的重要性，以便在选择阶段选择最佳模型。</p><p id="8f48" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在这篇文章中，我想特别关注一个统计测试，作为一名数据科学家或机器学习工程师，你需要知道这个测试。您可以使用此测试来确定两个分类器之间是否存在统计上的显著差异，以便您实际上可以只使用最好的一个。</p><h2 id="a428" class="mo kw jg bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">麦克内马试验</h2><p id="4557" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">当我们有匹配对时，需要比较两个分类器的性能时，可以使用McNemar测试。如果在两个分类器A和B之间有许多不同的预测，那么如果我们有许多数据，那么测试工作得很好。</p><p id="00fc" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">通过该测试，我们能够比较两个分类器在具有单个测试集的N个项目上的性能，这与您过去在<a class="ae jd" rel="noopener" target="_blank" href="/paired-t-test-to-evaluate-machine-learning-classifiers-1f395a6c93fa">配对t-test </a>中所做的相反。</p><h2 id="fbb2" class="mo kw jg bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">假设</strong></h2><ol class=""><li id="2b72" class="na nb jg lp b lq lr lt lu lw nc ma nd me ne mi nf ng nh ni bi translated">随机抽样调查</li><li id="e48c" class="na nb jg lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated">独立性ˌ自立性</li><li id="c048" class="na nb jg lp b lq nj lt nk lw nl ma nm me nn mi nf ng nh ni bi translated">相互排斥的群体</li></ol><h2 id="82e3" class="mo kw jg bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">相依表</h2><p id="c4d2" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">McNemar的测试旨在主要关注两个分类器之间的差异，因此关注他们以不同方式预测的情况。所以我们要做的第一件事就是去计算下面的值。</p><figure class="np nq nr ns gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi no"><img src="../Images/e8257383961b996e128c885d0cb9d3eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DWVh2uFYrL3LEBEEtJ9Crw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">列联表(图片由作者提供)</p></figure><ul class=""><li id="7bd5" class="na nb jg lp b lq mj lt mk lw nt ma nu me nv mi nw ng nh ni bi translated"><strong class="lp jh">n00</strong>:A和B误分类的项目数</li><li id="eaa9" class="na nb jg lp b lq nj lt nk lw nl ma nm me nn mi nw ng nh ni bi translated"><strong class="lp jh"> n01 </strong>:被A误分类但未被B误分类的项目数</li><li id="1a1c" class="na nb jg lp b lq nj lt nk lw nl ma nm me nn mi nw ng nh ni bi translated"><strong class="lp jh">n10</strong>:B误分类但A未误分类的项目数</li><li id="da6c" class="na nb jg lp b lq nj lt nk lw nl ma nm me nn mi nw ng nh ni bi translated"><strong class="lp jh">n11</strong>:A和B都正确分类的项目数</li><li id="3bd3" class="na nb jg lp b lq nj lt nk lw nl ma nm me nn mi nw ng nh ni bi translated"><strong class="lp jh">零张力</strong> : n01 = n10</li></ul><blockquote class="nx"><p id="2f9a" class="ny nz jg bd oa ob oc od oe of og mi dk translated">零假设:A和B的错误率相同。</p></blockquote><p id="3e88" class="pw-post-body-paragraph ln lo jg lp b lq oh kh ls lt oi kk lv lw oj ly lz ma ok mc md me ol mg mh mi ij bi translated">麦克纳玛检验<strong class="lp jh">基本上是成对卡方检验</strong>的一种形式，所以接下来我们需要使用以下公式计算X <strong class="lp jh"> </strong>值。</p><figure class="np nq nr ns gt is gh gi paragraph-image"><div class="gh gi om"><img src="../Images/3de505a74ace5a02f38677b99b9fbefd.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*PCJowl70K9sLeIm47lVsUw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">卡方(图片由作者提供)</p></figure><h2 id="6a73" class="mo kw jg bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated"><strong class="ak">示例</strong></h2><figure class="np nq nr ns gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi on"><img src="../Images/bf0f0350c028d69cd64ca9a272278a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mpdts0lXd9KxbBx3JfUh2w.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">列联表(图片由作者提供)</p></figure><p id="ce47" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp jh"> X = 7.55 </strong></p><p id="231b" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">假设我们希望显著性水平p = 0.05。如果<strong class="lp jh"> X &gt; X (0.05) </strong>(在双尾检验中)，我们可以拒绝无效假设。</p><p id="ee3d" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">所以我们用一个自由度= 1的卡方表。</p><figure class="np nq nr ns gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oo"><img src="../Images/4acece2d920d74b42ac842b14236d257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fS5xsSSyiy3zCxIGQxFYQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd op"> X表(来源:</strong><a class="ae jd" href="https://en.wikibooks.org/wiki/Engineering_Tables/Chi-Squared_Distibution" rel="noopener ugc nofollow" target="_blank">https://en . wikibooks . org/wiki/Engineering _ Tables/Chi-Squared _ distribution)</a></p></figure><p id="0ff4" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">由于<strong class="lp jh"> 7.55 &gt; 3.84，我们可以拒绝零假设</strong>并声明分类器A和B之间存在显著差异！</p><h2 id="97c5" class="mo kw jg bd kx mp mq dn lb mr ms dp lf lw mt mu lh ma mv mw lj me mx my ll mz bi translated">让我们编码</h2><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="oq or l"/></div></figure><h1 id="4940" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">最后的想法</h1><blockquote class="os ot ou"><p id="6e68" class="ln lo ov lp b lq mj kh ls lt mk kk lv ow ml ly lz ox mm mc md oy mn mg mh mi ij bi translated"><em class="jg">假设检验为做出关于感兴趣人群的数据决策提供了一个可靠的框架。它有助于研究人员成功地将数据从样本外推至更大的人群。</em></p></blockquote><p id="995a" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">比较一次在不同模型上得到的结果来选择哪一个是最好的，从来都不是一个好方法。统计测试允许我们客观地陈述一个模型是否表现得更好。每次你运行实验，统计测试是用来显示你所做的比以前存在的更好，去看看任何机器学习论文就知道了！</p><h1 id="9a54" class="kv kw jg bd kx ky kz la lb lc ld le lf km lg kn lh kp li kq lj ks lk kt ll lm bi translated">结束了</h1><p id="a5a2" class="pw-post-body-paragraph ln lo jg lp b lq lr kh ls lt lu kk lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><em class="ov">马赛洛·波利蒂</em></p><p id="bf98" class="pw-post-body-paragraph ln lo jg lp b lq mj kh ls lt mk kk lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><a class="ae jd" href="https://www.linkedin.com/in/marcello-politi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae jd" href="https://twitter.com/_March08_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae jd" href="https://march-08.github.io/digital-cv/" rel="noopener ugc nofollow" target="_blank"> CV </a></p></div></div>    
</body>
</html>