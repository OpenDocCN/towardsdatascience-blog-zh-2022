<html>
<head>
<title>Top 5 SQL DATE Functions You Should Know In 2022</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2022年你应该知道的五大SQL日期函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/top-5-sql-date-functions-you-should-know-in-2022-2180328ab940#2022-07-05">https://towardsdatascience.com/top-5-sql-date-functions-you-should-know-in-2022-2180328ab940#2022-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a556" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学</h2><div class=""/><div class=""><h2 id="c813" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">掌握SQL日期时间函数，赢得数据科学面试</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/d479b0e6a92510a2841f9ee76aa26a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4cRMgKhq3TpjJjmv-8Q6Q.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@ballaschottner?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">本斯·巴拉-肖特纳</a>在<a class="ae lh" href="https://unsplash.com/collections/4546015/time?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="fb52" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">使用SQL节省时间！</strong>⏰</p><p id="cbee" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在以数据为中心的世界中，使用时间戳将数据组织到毫秒级的细节。然而，这种详细程度并不总是有用的。相反，通常你只需要日期的一部分，比如年、月或日。</p><p id="8abb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，了解从日期时间变量中提取所需数据的不同方法非常重要。</p><p id="c703" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我在这里列出了5个最有用的SQL函数和例子，以帮助您理解日期-时间数据操作和分析。</p><p id="f83c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我把这篇文章写得很短，这样你就可以很快地完成它，掌握那些必须知道的、赢得面试的SQL技巧。🏆</p><p id="10b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以使用此索引快速导航到您最喜欢的部分。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="d9c4" class="mj mk it mf b gy ml mm l mn mo"><strong class="mf jd">· </strong><a class="ae lh" href="#dad0" rel="noopener ugc nofollow"><strong class="mf jd">DATE and TIME function</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#2d4e" rel="noopener ugc nofollow"><strong class="mf jd">EXTRACT()</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#0f53" rel="noopener ugc nofollow"><strong class="mf jd">DATEDIFF()</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#e11d" rel="noopener ugc nofollow"><strong class="mf jd">TIMESTAMPDIFF()</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#7727" rel="noopener ugc nofollow"><strong class="mf jd">MONTHNAME() and DAYNAME()</strong></a></span></pre><blockquote class="mp mq mr"><p id="1aaf" class="li lj ms lk b ll lm kd ln lo lp kg lq mt ls lt lu mu lw lx ly mv ma mb mc md im bi translated">📍注意:我使用的MySQL Workbench &amp;地震数据集来自<a class="ae lh" href="https://www.kaggle.com/datasets/usgs/earthquake-database" rel="noopener ugc nofollow" target="_blank">ka ggle</a><a class="ae lh" href="https://creativecommons.org/publicdomain/zero/1.0/" rel="noopener ugc nofollow" target="_blank">public</a>dataset&amp;现在可以在我的<a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/Dummy_Sales_Data_v1.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> Github </strong> </a> repo上免费获得，并有<a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/LICENSE.md" rel="noopener ugc nofollow" target="_blank"> MIT许可</a>！</p></blockquote><p id="d41b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将使用的数据集如下所示..</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/0743a512be49f30ed4f689fb10c60c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*6MapYyrBucu7wnHA4Tcixg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">地震数据集|作者图片</p></figure><p id="0f33" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是一个简单的2000 x 7数据集！</p><p id="c852" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">好了，我们开始吧…🚀</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="90e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们从最简单的部分开始——从日期时间变量中提取日期和时间。</p><h1 id="dad0" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">日期和时间功能</h1><p id="d070" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">这个函数只从日期时间变量中提取日期。</p><p id="024b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如上图所示，日期列包含格式为<code class="fe oa ob oc mf b"><strong class="lk jd">YYYY-MM-DD HH:MM:SS</strong></code>的日期和时间，而您只想提取日期部分，即月、日和年。</p><p id="a262" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这个问题，<code class="fe oa ob oc mf b"><strong class="lk jd">DATE()</strong></code>函数是最简单的解决方案。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="657b" class="mj mk it mf b gy ml mm l mn mo">SELECT Dates, <strong class="mf jd">DATE(Dates)</strong> as only_date<br/>FROM sql_practice.earthquakes;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/5e97c7cb046095f6574b8e7b8a63f877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*lJyaiF84vhmNRYLMvUMzOw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者从SQL | Image中的日期时间变量提取日期</p></figure><p id="3e02" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">同样，你也可以使用另一个有用的函数<code class="fe oa ob oc mf b"><strong class="lk jd"> TIME()</strong></code>只获取时间部分，即小时、分钟、秒</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="a9ce" class="mj mk it mf b gy ml mm l mn mo">SELECT Dates, <strong class="mf jd">TIME(Dates)</strong> as only_time<br/>FROM sql_practice.earthquakes;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/730fe0727a872ff2a877dac8579080f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*Vujf_T4lttQjrhA14WvpBQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者从SQL | Image中的日期时间列仅提取时间</p></figure><p id="a9d2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">嗯，正如它名字所暗示的，它非常简单和直接。</p><p id="6fab" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">深入研究日期-时间数据，接下来让我们看看如何从日期中只提取日、月或任何其他部分。</p><h1 id="2d4e" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">提取()</h1><p id="f9ec" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">它从给定的日期时间值中提取部分日期。</p><p id="21b8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在大多数访谈中，您会被要求按月或按周汇总数据，或者计算特定月份或季度的特定指标。💯</p><p id="9833" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe oa ob oc mf b">EXTRACT()</code>是为提取日期的不同部分提供最大灵活性的函数。它有最简单的语法，</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="5f36" class="mj mk it mf b gy ml mm l mn mo"><strong class="mf jd">EXTRACT(part_of_date, date-time column)</strong></span></pre><p id="584d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">到目前为止，MySQL支持使用该函数提取以下类型的日期部分。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="1aeb" class="mj mk it mf b gy ml mm l mn mo">SELECT Dates AS given_date, <br/>       EXTRACT(<strong class="mf jd">SECOND</strong> FROM Dates) as seconds_value,<br/>       EXTRACT(<strong class="mf jd">MINUTE</strong> FROM Dates) as minute_value,<br/>       EXTRACT(<strong class="mf jd">HOUR</strong> FROM Dates) as hour_value,<br/>       EXTRACT(<strong class="mf jd">DAY</strong> FROM Dates) as day_value,<br/>       EXTRACT(<strong class="mf jd">MONTH</strong> FROM Dates) as month_value,<br/>       EXTRACT(<strong class="mf jd">YEAR</strong> FROM Dates) as year_value,<br/>       EXTRACT(<strong class="mf jd">WEEK</strong> FROM Dates) as week_value,<br/>       EXTRACT(<strong class="mf jd">QUARTER</strong> FROM Dates) as quarter_value<br/>FROM sql_practice.earthquakes<br/>LIMIT 5;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi of"><img src="../Images/ba98ce532c63ecb55be22679d49a1443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oeaaKgxUmwTd8vpUsp1HUg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用MySQL中的MySQL | Image by Author提取日期部分</p></figure><p id="3493" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这样，您可以提取日期的基本和常用部分。MySQL还支持其他不常见的日期部分组合，例如</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="e3b1" class="mj mk it mf b gy ml mm l mn mo">SELECT Dates AS given_date, <br/>       EXTRACT(<strong class="mf jd">YEAR_MONTH</strong> FROM Dates) as year_month_value,<br/>       EXTRACT(<strong class="mf jd">DAY_HOUR</strong> FROM Dates) as day_hour_value,<br/>       EXTRACT(<strong class="mf jd">HOUR_MINUTE</strong> FROM Dates) as hour_minute_value,<br/>       EXTRACT(<strong class="mf jd">MINUTE_SECOND</strong> FROM Dates) as minute_second_value<br/>FROM sql_practice.earthquakes<br/>LIMIT 5;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/3c1cfc15afd3c5f86923c24d28ebb861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*ZFYmeaaKtNpWXSUezG7u1Q.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">MySQL摘录中的日期部分组合|作者图片</p></figure><p id="1c48" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面举个例子来了解一下<code class="fe oa ob oc mf b">EXTRACT()</code>函数在实际中是如何使用的。</p><p id="66ed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">🔸假设，你想知道每次地震发生在一天中的什么时间。日期列的时间戳高达秒级。</p><p id="eb78" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这里，你可以得到如下的时间。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="2ca6" class="mj mk it mf b gy ml mm l mn mo">SELECT Dates, <br/>       <strong class="mf jd">EXTRACT(HOUR FROM Dates)</strong> as hour_of_day<br/>FROM sql_practice.earthquakes;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/a508b5fa7737d8ff1d4828d7b2e056f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*-8LB_UxzEtTGkRNdDEGqVg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">提取一天中的某个小时|作者图片</p></figure><p id="eea3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当您想要汇总每周、每月或每季度的数据或了解数据的每月、每年趋势时，通常会使用此函数。</p><p id="184b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">🔸例如，您想获得1965年前三个月的每周地震总数。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="5062" class="mj mk it mf b gy ml mm l mn mo">SELECT <strong class="mf jd">EXTRACT(WEEK FROM Dates)</strong> as week_of_year,<br/>       COUNT(DISTINCT ID) as number_of_earthquakes<br/>FROM sql_practice.earthquakes<br/>WHERE Type LIKE 'Earthquake'<br/>AND <strong class="mf jd">EXTRACT(MONTH FROM Dates)</strong> &lt; 4<br/>AND <strong class="mf jd">EXTRACT(YEAR FROM Dates)</strong> = 1965<br/><strong class="mf jd">GROUP BY EXTRACT(WEEK FROM Dates)</strong>;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/70ba27d1f9710619b603a470c6502873.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*ZQaj-EYxSPN1PU_A5TxqHg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">每周汇总|作者图片</p></figure><p id="7485" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如你所见，列<em class="ms">由一年中的周数组成，最大地震发生在第五周。</em></p><p id="d9e6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是理解如何提取日期的不同部分以及如何在<code class="fe oa ob oc mf b">WHERE</code>和<code class="fe oa ob oc mf b">GROUP BY</code>子句中使用它们的经典示例。</p><p id="2dba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种类型的聚合问题经常在数据科学访谈中被问到。✅</p><p id="1f4e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，有时您需要根据两个事件计时之间的差异来过滤时间戳数据。</p><h1 id="0f53" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">DATEDIFF()</h1><p id="4612" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">它实际上是比较这两个日期，并返回它们之间的天数差。</p><p id="629a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它需要两个参数，</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="f997" class="mj mk it mf b gy ml mm l mn mo">DATE_DIFF(1st date, 2nd date)</span></pre><p id="f38a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">举个例子，</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="0166" class="mj mk it mf b gy ml mm l mn mo">SELECT <strong class="mf jd">DATEDIFF('1965-02-28', '1965-01-01')</strong> as DATEDIFF_output</span><span id="3571" class="mj mk it mf b gy oj mm l mn mo">-- Output<br/><strong class="mf jd">58</strong></span></pre><p id="304c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在<code class="fe oa ob oc mf b">DATEDIFF()</code>中，第一个日期应该总是大于第二个日期。如果相反，输出将是负数。</p><p id="f181" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">🔸在另一个例子中，假设您想要查看今天(【2022年7月3日)之前每场地震发生了多少天。为此，您可以使用另一个MySQL函数<code class="fe oa ob oc mf b">NOW()</code>，它基本上以时间戳格式返回今天的日期。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="1879" class="mj mk it mf b gy ml mm l mn mo">SELECT Dates,<br/>       <strong class="mf jd">DATEDIFF(NOW(), Dates)</strong> as DATEDIFF_Output<br/>FROM sql_practice.earthquakes</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/df19893f72ac7a62a9e893f26962dc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*L4Plslc4bpleG94BHg91OQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">SQL | Image中的DATEDIFF(按作者)</p></figure><p id="c9a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">嗯，这两个日期之间的差异以天数的形式返回，这对您来说可能太细了，因为<code class="fe oa ob oc mf b">DATEDIFF()</code>没有提供日期部分的灵活性，比如以月或年的形式获得两个日期之间的差异。</p><p id="ec2c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这就是下一个功能出现的时候。</p><h1 id="e11d" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">TIMESTAMPDIFF()</h1><p id="8af1" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">它提供了部分日期的灵活性，并让您在日、周、月、季度和年的两个日期之间有所不同。💯</p><p id="6f26" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它的语法略有不同，如下所示:</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="fdf4" class="mj mk it mf b gy ml mm l mn mo"><strong class="mf jd">TIMESTAMPDIFF(part of date, 1st date, 2nd date)</strong></span></pre><p id="9501" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中，<em class="ms">第一个日期应始终小于第二个日期</em>，日期的一部分可以是日、月、年、周中的任何内容</p><p id="6e98" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，截止到<code class="fe oa ob oc mf b">DATEDIFF()</code>的相同查询可以重写为:</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="5a6f" class="mj mk it mf b gy ml mm l mn mo">SELECT Dates,<br/>       <strong class="mf jd">TIMESTAMPDIFF(YEAR ,Dates, NOW())</strong> as TIMESTAMPDIFF_Output<br/>FROM sql_practice.earthquakes</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/7494606a2a0d832d939b7938b4131671.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*g-AFS95Cj23sPaEcw6nEVQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">MySQL中的timestamp diff |作者图片</p></figure><p id="cd7c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，今天和日期之间的差值以年数返回。</p><p id="0e53" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">🔸让我们举一个实际的例子—您想要查看从1965年1月2日起10天内发生的所有震级超过6级的地震。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="92c6" class="mj mk it mf b gy ml mm l mn mo">SELECT ID,<br/>       Latitude,<br/>       Longitude,<br/>       Magnitude,<br/>       Dates<br/>FROM sql_practice.earthquakes<br/>WHERE Type LIKE 'Earthquake'<br/>AND Magnitude &gt; 6<br/>AND Dates &gt;= '1965-01-02'<br/>AND <strong class="mf jd">TIMESTAMPDIFF(DAY, '1965-01-02', Dates) &lt;= 10</strong>;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi om"><img src="../Images/1942d14037d37afad8a7beb38416921f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*uHltxzY3DdMTJqRPD_eVsQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">过滤X天内发生的日期|按作者分类的图片</p></figure><p id="e233" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如你在上面的图片中看到的，两次地震的日期都是1月5日和10日，距离1月2日不到10天。</p><blockquote class="mp mq mr"><p id="247e" class="li lj ms lk b ll lm kd ln lo lp kg lq mt ls lt lu mu lw lx ly mv ma mb mc md im bi translated">根据包裹递送所用的时间选择记录，您需要找出运输日期和递送日期之间的差异<br/>或<br/>找出用户订阅特定服务的时间。</p></blockquote><p id="356c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这些是一些现实生活中的使用案例和常见的数据科学面试问题，可以使用<code class="fe oa ob oc mf b">TIMESTAMPDIFF()</code>或<code class="fe oa ob oc mf b">DATEDIFF()</code>解决。</p><p id="3508" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">🔸另一个关于<code class="fe oa ob oc mf b">DATEDIFF</code>或<code class="fe oa ob oc mf b">TIMESTAMPDIFF</code>的有趣例子是—</p><blockquote class="on"><p id="9ac7" class="oo op it bd oq or os ot ou ov ow md dk translated"><a class="ae lh" href="https://leetcode.com/problems/rising-temperature/" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> <em class="ox">温度上升</em> </strong>关于Leetcode </a>的问题</p></blockquote><p id="a11e" class="pw-post-body-paragraph li lj it lk b ll oy kd ln lo oz kg lq lr pa lt lu lv pb lx ly lz pc mb mc md im bi translated">您需要选择温度高于前一天的所有id。问题的输入是一个简单的表格，如下所示，</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="9e01" class="mj mk it mf b gy ml mm l mn mo"><strong class="mf jd">Input table name: </strong>Weather<br/>+----+------------+-------------+<br/>| id | recordDate | temperature |<br/>+----+------------+-------------+<br/>| 1  | 2015-01-01 | 10          |<br/>| 2  | 2015-01-02 | 25          |<br/>| 3  | 2015-01-03 | 20          |<br/>| 4  | 2015-01-04 | 30          |<br/>+----+------------+-------------+</span></pre><p id="a457" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我上一篇文章中提到，<strong class="lk jd"> </strong> <a class="ae lh" rel="noopener" target="_blank" href="/5-advanced-sql-concepts-you-should-know-in-2022-b50efe6c99#3ad5"> <strong class="lk jd"> 5高级SQL查询</strong> </a>这个问题可以结合<code class="fe oa ob oc mf b">SELF JOIN</code>和<code class="fe oa ob oc mf b">DATEDIFF()</code>一起使用来解决。💯</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="73c4" class="mj mk it mf b gy ml mm l mn mo">-- <strong class="mf jd">Query using DATEDIFF()</strong></span><span id="22d4" class="mj mk it mf b gy oj mm l mn mo">SELECT today.id FROM Weather AS today <br/>JOIN Weather AS yesterday<br/>ON today.temperature &gt; yesterday.temperature<br/>AND <strong class="mf jd">DATEDIFF(today.recordDate, yesterday.recordDate) = 1</strong></span><span id="8578" class="mj mk it mf b gy oj mm l mn mo"><strong class="mf jd">-- Query using TIMESTAMPDIFF()</strong></span><span id="d751" class="mj mk it mf b gy oj mm l mn mo"># Write your MySQL query statement below<br/>SELECT today.id FROM Weather AS today <br/>JOIN Weather AS yesterday<br/>ON today.temperature &gt; yesterday.temperature<br/>AND <strong class="mf jd">TIMESTAMPDIFF(DAY, yesterday.recordDate, today.recordDate) = 1</strong></span><span id="d227" class="mj mk it mf b gy oj mm l mn mo"><strong class="mf jd">Output:</strong> <br/>+----+<br/>| id |<br/>+----+<br/>| 2  |<br/>| 4  |<br/>+----+</span></pre><blockquote class="mp mq mr"><p id="d82b" class="li lj ms lk b ll lm kd ln lo lp kg lq mt ls lt lu mu lw lx ly mv ma mb mc md im bi translated"><strong class="lk jd">注意</strong>在<code class="fe oa ob oc mf b">TIMESTAMPDIFF </code>和<code class="fe oa ob oc mf b">DATEDIFF</code>语法中提及日期值的顺序。</p></blockquote><p id="3a09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，让我们看看如何获得日期和月份的名称，而不是它的编号。</p><h1 id="7727" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">月名()和日名()</h1><p id="2de0" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">顾名思义，<code class="fe oa ob oc mf b">MONTHNAME()</code>返回月份名称，<code class="fe oa ob oc mf b">DAYNAME()</code>返回给定日期的日期名称。</p><p id="2e7e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">🔸例如，从date获取今天的日期和月份名称。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="7881" class="mj mk it mf b gy ml mm l mn mo">SELECT NOW() AS given_date,<br/>       <strong class="mf jd">MONTHNAME</strong>(NOW()) AS month_name,<br/>       <strong class="mf jd">DAYNAME</strong>(NOW()) AS day_name;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/6a06e26b7de4f0e9dede7e23129b3744.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*03YV9AIq-v37OE1kah1BtA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者获取SQL | Image中的日期和月份</p></figure><p id="734d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当您需要按天或按月对列进行聚合，并且列中只有日期-时间值时，这很有用。</p><blockquote class="mp mq mr"><p id="b81f" class="li lj ms lk b ll lm kd ln lo lp kg lq mt ls lt lu mu lw lx ly mv ma mb mc md im bi translated"><strong class="lk jd">注</strong>:函数<code class="fe oa ob oc mf b"><strong class="lk jd">NOW()</strong></code>以<code class="fe oa ob oc mf b">YYYY-MM-DD HH:MM:SS</code>格式返回当前日期和时间，可以在上图第一栏看到。</p></blockquote><p id="6178" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">🔸例如，您想了解一周中哪一天发生的地震最多。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="3593" class="mj mk it mf b gy ml mm l mn mo">SELECT <strong class="mf jd">DAYNAME(Dates) AS day_name</strong>,<br/>       COUNT(DISTINCT ID) AS number_of_earthquakes<br/>FROM sql_practice.earthquakes<br/>WHERE Type LIKE 'Earthquake'<br/><strong class="mf jd">GROUP BY DAYNAME(Dates)</strong><br/>ORDER BY number_of_earthquakes DESC;</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/c0f5b1236fed23baeb485c82bdf129fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*3DuRGV8csOkbZPx43d4Bdw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按日期名称分组|按作者分组</p></figure><p id="231b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这就是你如何找出周四发生地震的最大次数。你可以使用<code class="fe oa ob oc mf b">MONTHNAME()</code>来获得类似的洞察力。</p><p id="656f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">仅此而已！</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="3a73" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望您能很快完成这篇文章，并发现它对在SQL中处理日期很有用。上面提到的函数涵盖了大量的操作，您将使用日期-时间值进行操作。</p><p id="ef68" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我在过去3年里一直在使用SQL，我发现这些概念经常成为数据分析师和数据科学家职位的面试问题。这些功能在处理实际项目时也非常有用。</p><blockquote class="on"><p id="6c3e" class="oo op it bd oq or os ot ou ov ow md dk translated"><em class="ox">对阅读介质上的无限故事感兴趣？？</em></p></blockquote><p id="1f20" class="pw-post-body-paragraph li lj it lk b ll oy kd ln lo oz kg lq lr pa lt lu lv pb lx ly lz pc mb mc md im bi translated">💡考虑<a class="ae lh" href="https://medium.com/@17.rsuraj/membership" rel="noopener"> <strong class="lk jd">成为媒体会员</strong></a><strong class="lk jd">无限访问媒体上的</strong>故事和每日有趣的媒体文摘。我会得到你的费用的一小部分，没有额外的费用给你。</p><p id="de57" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">💡请务必<a class="ae lh" href="https://medium.com/subscribe/@17.rsuraj" rel="noopener"> <strong class="lk jd">注册我的电子邮件列表</strong> </a>以免错过另一篇关于数据科学指南、技巧和提示、SQL和Python的文章。</p><p id="b413" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">感谢您的阅读！</strong></p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="df58" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="ms">不确定接下来要读什么？我为你挑选了另一篇文章— </em> </strong></p><div class="pf pg gp gr ph pi"><a rel="noopener follow" target="_blank" href="/5-advanced-sql-concepts-you-should-know-in-2022-b50efe6c99"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd jd gy z fp pn fr fs po fu fw jc bi translated">2022年你应该知道的5个高级SQL概念</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">立即掌握这些节省时间的高级SQL查询。</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">towardsdatascience.com</p></div></div><div class="pr l"><div class="ps l pt pu pv pr pw lb pi"/></div></div></a></div><p id="8d62" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">甚至更多的实用查询可以在这里查询，</p><div class="pf pg gp gr ph pi"><a rel="noopener follow" target="_blank" href="/5-practical-sql-queries-you-should-know-in-2022-11b428560a30"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd jd gy z fp pn fr fs po fu fw jc bi translated">2022年你应该知道的5个实用SQL查询</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">快速掌握这些省时又强大的SQL查询！</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">towardsdatascience.com</p></div></div><div class="pr l"><div class="px l pt pu pv pr pw lb pi"/></div></div></a></div><p id="f129" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">尽管如此，了解SQL的最佳实践还是很重要的！</p><div class="pf pg gp gr ph pi"><a rel="noopener follow" target="_blank" href="/5-most-useful-sql-best-practices-you-should-follow-ef753a50ad26"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd jd gy z fp pn fr fs po fu fw jc bi translated">您应该遵循的5个最有用的SQL最佳实践</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">避免经常犯的错误来改进你的代码！</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">towardsdatascience.com</p></div></div><div class="pr l"><div class="py l pt pu pv pr pw lb pi"/></div></div></a></div><blockquote class="on"><p id="ff1e" class="oo op it bd oq or pz qa qb qc qd md dk translated">你的免费会员故事吗？？</p></blockquote><p id="427c" class="pw-post-body-paragraph li lj it lk b ll oy kd ln lo oz kg lq lr pa lt lu lv pb lx ly lz pc mb mc md im bi translated">💡考虑<a class="ae lh" href="https://medium.com/@17.rsuraj/membership" rel="noopener"> <strong class="lk jd">成为中等会员</strong> </a>继续阅读<strong class="lk jd">！</strong></p></div></div>    
</body>
</html>