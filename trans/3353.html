<html>
<head>
<title>A Parquet File Is All You Need</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个拼花文件是你所需要的</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-parquet-file-is-all-you-need-962df86886bb#2022-07-26">https://towardsdatascience.com/a-parquet-file-is-all-you-need-962df86886bb#2022-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cc69" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">停止使用CSV并转向拼花地板</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c8d286835b872bda4f3b461cea85e58d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a2N0nS7Q9CqDVBeV4rrlcA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">塞尔维亚诺瓦奇的机械(图片由作者提供)</p></figure><p id="a8eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您是使用CSV文件存储数据的数据科学家吗？如果我告诉你有更好的方法呢？你听说过开源拼花文件格式吗？</p><p id="1653" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你能想象一个</p><ul class=""><li id="1626" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">驳船🦋</li><li id="16f2" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">更快的🏎️</li><li id="53d9" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">比较便宜的💸</li></ul><p id="f6c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">保存数据集的文件格式？</p><p id="50b0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">读了这篇文章，你就不需要再去想象了。</p><h1 id="0a56" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">问题是</h1><p id="5527" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">不要误解我。我喜欢CSV。</p><p id="88e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以用任何文本编辑器打开它们，检查它们并与他人分享。它们已经成为AI/ML社区中数据集的标准文件格式。</p><p id="bedb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，他们有一个小问题…</p><p id="3b71" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">CSV文件存储为行列表(也称为面向行)，这导致了两个问题:</p><ul class=""><li id="38dc" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">它们查询起来很慢:SQL和CSV不能很好地结合在一起。</li><li id="c17a" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">它们很难有效存储:CSV文件占用大量磁盘空间。</li></ul><p id="f982" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有CSV的替代品吗？</p><p id="a07f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">是啊！</p><h1 id="ae18" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">欢迎拼花文件</h1><p id="67d3" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">作为CSV面向行的格式的替代，我们有一个面向列的格式:Parquet。</p><p id="04da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Parquet是一种存储数据的开源格式，由Apache许可。</p><p id="df59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据工程师习惯于拼花地板。但是，可悲的是，数据科学家仍然落后。</p><h2 id="32e4" class="nf mj it bd mk ng nh dn mo ni nj dp ms lh nk nl mu ll nm nn mw lp no np my nq bi translated"><strong class="ak"> <em class="nr">拼花格式与CSV有何不同？</em> </strong></h2><p id="66c5" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">假设你有这个数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/0df6acc39b9eaa01bd306b502c175504.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/0*ILly9eHQW0pb8Qji.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">样本数据(图片由作者提供)</p></figure><p id="a462" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在内部，CSV文件根据其行存储数据</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/d54f401b70ec7110b5c5b5ae626d79dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/0*BBjiGB_1E26MIj41.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">CSV文件结构</p></figure><p id="40de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一方面，Parquet基于它的列存储数据。它还保存每一列的数据类型，这是成功的关键。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/268d05036ece5b8d4fd0cf19d96cb639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/0*V255R2RLFlwGmUN0.png"/></div></figure><h2 id="729c" class="nf mj it bd mk ng nh dn mo ni nj dp ms lh nk nl mu ll nm nn mw lp no np my nq bi translated">为什么列存储比行存储好？</h2><p id="2d69" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">2个技术原因和1个业务原因。</p><ul class=""><li id="0491" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">技术原因1。拼花文件比CSV文件小得多。<br/>在Parquet中，文件根据其数据类型(如整数、字符串、日期)逐列压缩。1TB的CSV文件变成了大约100GB(原始大小的10%)的拼花文件。</li><li id="5016" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">技术原因2:拼花文件查询起来要快得多。<br/>柱状数据的扫描和提取速度更快。<br/>例如，选择和聚合列子集的SQL查询不需要扫描其他列。这减少了I/O并提高了查询速度。</li><li id="0395" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">商业原因#3:拼花文件存储在云服务中更便宜。AWS S3或谷歌云存储等存储服务根据数据大小或扫描的数据量向您收费。拼花文件更轻，扫描速度更快，这意味着您可以用很少的成本存储相同的数据。</li></ul><h1 id="455a" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">…现在是蛋糕上的樱桃</h1><p id="ea8c" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">在Pandas中处理拼花文件就像处理CSV一样简单</p><h2 id="4479" class="nf mj it bd mk ng nh dn mo ni nj dp ms lh nk nl mu ll nm nn mw lp no np my nq bi translated">想要读取数据吗？</h2><p id="acdd" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">停止做:</p><p id="9f2d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nv nw nx ny b">pd.read_csv('file.csv')</code></p><p id="4454" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相反，做</p><p id="691c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nv nw nx ny b">pd.read_parquet('file.parquet')</code></p><h2 id="b9e1" class="nf mj it bd mk ng nh dn mo ni nj dp ms lh nk nl mu ll nm nn mw lp no np my nq bi translated">想要将数据保存到磁盘吗？</h2><p id="6101" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">停止做:</p><p id="cf07" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nv nw nx ny b">df.to_csv('my_file.csv')</code></p><p id="9091" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相反，做</p><p id="c571" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nv nw nx ny b">df.to_parquet('my_file.parquet')</code></p><h2 id="cc7b" class="nf mj it bd mk ng nh dn mo ni nj dp ms lh nk nl mu ll nm nn mw lp no np my nq bi translated">想要将您的旧CSV文件转换为拼花文件吗？</h2><p id="3fdc" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">简单。</p><p id="84a1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nv nw nx ny b">pd.read_csv('my_file.csv').to_parquet('my_file.parquet')</code></p><h1 id="29fc" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">想成为机器学习和数据科学的专家吗？</h1><p id="063f" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">🚀<a class="ae nz" href="https://datamachines.xyz/subscribe/" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">加入Datamachines时事通讯，了解ML和数据科学的真实世界。</strong> </a></p><p id="d5df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">➡️接上<a class="ae nz" href="https://twitter.com/paulabartabajo_" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">碎碎念</strong> </a> <strong class="la iu"> </strong>🐦，<a class="ae nz" href="https://www.linkedin.com/in/pau-labarta-bajo-4432074b/" rel="noopener ugc nofollow" target="_blank"><strong class="la iu">LinkedIn</strong></a><strong class="la iu"/>👔</p><p id="d3ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">💎<a class="ae nz" href="https://pau-labarta-bajo.medium.com/membership" rel="noopener"> <strong class="la iu">今天使用我的推荐链接</strong> </a> <strong class="la iu"> </strong>成为会员，可以无限制地访问我在媒体上发布的所有内容并支持我的写作。</p><div class="oa ob gp gr oc od"><a href="https://pau-labarta-bajo.medium.com/membership" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">成为一个媒体成员来阅读我在媒体上分享的一切。</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">你的会员费的一部分给了所有你喜欢阅读的作家。希望是我。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">pau-labarta-bajo.medium.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><p id="5bfc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">快乐学习🤗</p><p id="7df7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">避寒胜地</p></div></div>    
</body>
</html>