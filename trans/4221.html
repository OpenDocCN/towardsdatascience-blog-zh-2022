<html>
<head>
<title>The 5 Most Popular SQL Transforms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5种最流行的SQL转换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-5-most-popular-sql-transforms-ca1f977ef2b2#2022-09-20">https://towardsdatascience.com/the-5-most-popular-sql-transforms-ca1f977ef2b2#2022-09-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="64dc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">SQL生成器的用法分析</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ae03cf005c2fe36c79ec8ba9e1bfafcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eMlhgEyo8Id3P7OR"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="7cc5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="605b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在以前的帖子中，我提到过<a class="ae kv" href="https://app.rasgoml.com/sql" rel="noopener ugc nofollow" target="_blank"> SQL生成器</a>网站，它是分析师快速生成复杂SQL的有用工具。本周，我获得了数据，这样我们可以看看哪些是最受欢迎的转变。</p><h1 id="3415" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">基本分析</h1><p id="ed59" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">数据本身相当有限。由于该网站对所有人免费开放，因此没有可供分析的用户数据。我们只有某人点击“生成SQL”时的时间戳，以及它是什么类型的转换。</p><p id="0bc8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">截至本文发布时，该网站已有76个不同的转换。让我们快速浏览一下最流行的转换，并讨论一下SQL。</p><h2 id="84d9" class="mp kx iq bd ky mq mr dn lc ms mt dp lg lx mu mv li mb mw mx lk mf my mz lm na bi translated">#5:相关性(3%)</h2><p id="abaf" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我惊讶地看到<a class="ae kv" href="https://tinyurl.com/8uej86k5" rel="noopener ugc nofollow" target="_blank">相关性</a>进入了前5。这个转换从表中的数字列创建每一个可能的对，并运行<code class="fe nb nc nd ne b">CORR()</code> SQL函数。</p><p id="7887" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这相当简单，但是我认为为每一对列编写SQL是非常耗时和乏味的。因此，用户通过使用SQL生成器进行这种类型的转换来节省时间是有意义的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/67eef767ba5c77b751db2912ad84162b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_AVW-l468ebqRlaH_L9OQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">对于数字列，表结构(右)被自动分析，并且每个成对组合被构建到SQL(下)中</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="1528" class="mp kx iq bd ky mq mr dn lc ms mt dp lg lx mu mv li mb mw mx lk mf my mz lm na bi translated">#4:清洁(3%)</h2><p id="be28" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://tinyurl.com/kcfmjhbh" rel="noopener ugc nofollow" target="_blank"> clean </a>转换是估算、过滤、转换和重命名的组合。它允许您对数据的每一列进行一次或多次这样的转换。</p><p id="e5ad" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这个例子中，我使用Clean()混合并匹配了一些不同的转换:</p><ul class=""><li id="00eb" class="ni nj iq lq b lr mk lu ml lx nk mb nl mf nm mj nn no np nq bi translated">移除了<code class="fe nb nc nd ne b">Load_Datetime</code></li><li id="d5fb" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated">将<code class="fe nb nc nd ne b">Record_Deleted_Flag</code>转换为一个数字，并在不等于1的地方进行过滤</li><li id="bae8" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated">铸造订单和税收金额为<code class="fe nb nc nd ne b">FLOAT</code>并用0代替缺失</li><li id="572e" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated">将栏目<code class="fe nb nc nd ne b">Ref1</code>更名为<code class="fe nb nc nd ne b">MY_NEW_COLUMN_NAME</code></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/5a02473f28920d2716fdaaf105c19015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vpFHdbpth3uNBuZchIWWog.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">“清除”允许您同时应用删除、重命名、转换、估算和过滤器</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="aa79" class="mp kx iq bd ky mq mr dn lc ms mt dp lg lx mu mv li mb mw mx lk mf my mz lm na bi translated">第三:加入(4%)</h2><p id="32d1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://tinyurl.com/2gqekbk3" rel="noopener ugc nofollow" target="_blank">加入</a>如此受欢迎的事实也让我大吃一惊。我假设连接很常见并且很容易配置，但这可能是因为我在过去的20年里一直在编写SQL。</p><p id="cd12" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">除非您已经<a class="ae kv" href="https://docs.rasgoml.com/rasgo-docs/quickstart/connecting-your-database" rel="noopener ugc nofollow" target="_blank">将</a> Rasgo连接到您的数据仓库，否则SQL生成器将看不到您的真实数据库，这需要您在页面的右侧配置您的表结构。但是，您可以设置任意多的表，然后使用该界面来设置您的连接并为您编写SQL。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/46f417a691248d9099be1b555de4228f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHQWeLckhRv1nUs5vSsItQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">设置联接需要表定义</p></figure><h2 id="0660" class="mp kx iq bd ky mq mr dn lc ms mt dp lg lx mu mv li mb mw mx lk mf my mz lm na bi translated">第二名:支点(5%)</h2><p id="95d0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">事实上<a class="ae kv" href="https://tinyurl.com/2nqy35tn" rel="noopener ugc nofollow" target="_blank"> pivot </a>是第二流行的转换并不奇怪。众所周知，Pivot很难处理，尤其是因为每个RDBMS都决定使用稍微不同的语法。</p><p id="c6b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">然而，这仍然需要一些设置，因为您必须配置<code class="fe nb nc nd ne b">LIST_OF_VALS</code>，它是您希望作为列进行透视的唯一值。如果您省略这个参数，Rasgo将尝试为您查询不同的值<em class="nw"/>。(参见:将Rasgo连接到上面的数据仓库)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/797d94ba165e2dcf4018ca40e2649ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s5yCDQRjXT9JsCyEAL4Ibw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">如果Rasgo没有连接到您的数据仓库，则必须配置VALS列表。</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="e932" class="mp kx iq bd ky mq mr dn lc ms mt dp lg lx mu mv li mb mw mx lk mf my mz lm na bi translated">第一名:合计(17%)</h2><p id="9e9b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://tinyurl.com/2gmurrz2" rel="noopener ugc nofollow" target="_blank">聚合</a>是迄今为止最流行的转换，很容易看出为什么。该界面允许您轻松选择多种类型的聚合，并为您生成SQL。</p><p id="8f5a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">此外，一些RDBMS(我正看着你呢，BigQuery)忽略了添加流行的函数，如<code class="fe nb nc nd ne b">MEDIAN</code>和<code class="fe nb nc nd ne b">MODE</code>，这使得编写SQL变得混乱和乏味。</p><p id="3149" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">你自己试试吧！在SQL生成器中打开<a class="ae kv" href="https://tinyurl.com/2gmurrz2" rel="noopener ugc nofollow" target="_blank"> this example </a>，将dialect下拉菜单更改为BigQuery，并观察BigQuery SQL的生成。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/99a28d443b4347f8a49ce1071a0a453c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2yoNhHnmYED3KrbJOQpTg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Aggregate有一个易于使用的接口，这使它成为最流行的SQL转换</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="c68a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">关于帕累托原理的一个旁注</h1><p id="78ad" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">关于这些数据，最让我吃惊的一件事是所有的使用是如何分散的。经典的“80/20法则”在这里并不适用。</p><p id="d694" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">80/20规则，通常称为Pareto原则，表明80%的使用将占20%的转换。具体来说，这意味着76个SQL转换中的15个应该占使用量的80%。</p><p id="b287" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">实际上，SQL的用法似乎比这要多得多。我们看到前15个转换只占了50%的使用量。因此，我们有一个50/20规则，而不是80/20规则。</p><p id="27dc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">不幸的是，帕累托原则与“80/20法则”混淆了。事实上，帕累托法则只是告诉我们大多数事情并不是均匀分布的。80加20等于100是一个普遍的误解。如果你想了解帕累托原则，我强烈推荐<a class="ae kv" href="https://betterexplained.com/articles/understanding-the-pareto-principle-the-8020-rule/" rel="noopener ugc nofollow" target="_blank">我最喜欢的作家之一<a class="nx ny ep" href="https://medium.com/u/20ff95fabf37?source=post_page-----ca1f977ef2b2--------------------------------" rel="noopener" target="_blank">卡利德·阿扎德</a>的这个博客/视频</a>。</p><h1 id="3163" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="11c7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我从这一分析中看到两个要点:</p><ol class=""><li id="1979" class="ni nj iq lq b lr mk lu ml lx nk mb nl mf nm mj nz no np nq bi translated">SQL Generator更受欢迎的是自动化繁琐的SQL，而不是复杂的逻辑</li><li id="faa9" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nz no np nq bi translated">SQL的用法是多种多样的——换句话说，我们不可能只学了5样东西就突然成为专家。</li></ol><p id="1e19" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我希望你和我一样对此感兴趣。如果您对您认为常见的其他SQL转换有建议或意见，您可以在<a class="ae kv" href="https://locallyoptimistic.com/community/" rel="noopener ugc nofollow" target="_blank">local Optimistic</a>和<a class="ae kv" href="https://datatalks.club/" rel="noopener ugc nofollow" target="_blank"> DataTalks中找到我。俱乐部</a>。</p></div></div>    
</body>
</html>