<html>
<head>
<title>Know More about Your App Users through BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过BigQuery了解更多关于您的应用用户的信息</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/know-more-about-your-app-users-through-bigquery-4c0b6d67abfa#2022-04-10">https://towardsdatascience.com/know-more-about-your-app-users-through-bigquery-4c0b6d67abfa#2022-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9557" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">超越Firebase和Google Analytics的更加定制化的事件分析方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/12cc58c0ae88c2da4e29a7b96b5b4651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GQ5CxXUc5_HtNRse"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">罗宾·沃拉尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="719a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你正在运营一个Android应用程序业务，或者是一个应用程序业务的分析师，你可能会经常使用谷歌分析和Firebase。这些工具可帮助您监控应用性能，并让您深入了解应用用户。</p><p id="4522" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，GA和Firebase并不能回答所有的问题，即使回答了，它们也不能完美地捕捉到您想要的分析和呈现数据的方式。在这种情况下，将历史数据导出到数据仓库可能是值得的，然后您应该能够自己进行更高级的分析。由于BigQuery与GA和Firebase属于同一个谷歌生态系统，因此导出更加无缝。</p><p id="c0ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文讨论通过在BigQuery中运行简单查询来回答的示例业务问题。先决条件是一些基本的SQL技能，一个<a class="ae kv" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云账户</a>，和一个<a class="ae kv" href="https://firebase.google.com/" rel="noopener ugc nofollow" target="_blank"> Firebase </a>连接的应用；然后，您就可以自己进行这些查询了！</p><p id="dbef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一步是将Firebase数据导出到BigQuery中。一旦您完成了这一步，事件数据就会自动流向您的数据仓库，为数据争论和分析做好准备。要了解更多关于如何启用Firebase到BigQuery导出的信息，您可以参考这个<a class="ae kv" href="https://firebase.google.com/docs/projects/bigquery-export" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h1 id="0240" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">数据集</h1><p id="acf4" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">对于这个演示，我将使用来自Flood-it的示例游戏应用程序数据！，一款在Android和iOS平台上都有售的益智游戏。它是一个模糊的数据集，模拟GA和Firebase中的实际实现。</p><p id="c743" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以检查<a class="ae kv" href="https://developers.google.com/analytics/bigquery/app-gaming-demo-dataset" rel="noopener ugc nofollow" target="_blank">这个链接</a>以获得关于数据集及其模式的更多信息。</p><p id="fcd2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于用户标识符，请注意:“user_pseudo_id”用于标识演示数据中的单个用户。如果您想要跨多个应用程序、设备和分析提供商关联用户数据，您应该设置一个“<a class="ae kv" href="https://firebase.google.com/docs/analytics/userid" rel="noopener ugc nofollow" target="_blank"> user_id </a>”。</p><p id="a360" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们准备分析数据。</p><h1 id="e176" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Firebase和BigQuery可以回答的用户体验相关问题示例</h1><h2 id="5be0" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">有多少用户安装了该应用程序？</h2><p id="00ae" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">类似这样的查询可以揭示在特定时间段内有多少用户安装了该应用程序:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="ea3e" class="mp lt iq nc b gy ng nh l ni nj">SELECT COUNT(DISTINCT user_pseudo_id) as users_installed<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "first_open"<br/>AND _TABLE_SUFFIX BETWEEN '20180927' and '20181003'</span></pre><p id="c9fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于表是当天的格式(每天一个表)，所以可以使用通配符“*”在一个查询中组合几个表。使用这段代码时要非常小心，因为执行起来可能会非常昂贵，尤其是当你有很多数据的时候。切记始终使用“_TABLE_SUFFIX”来定义日期边界和限制数据。</p><p id="0c74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过运行这段代码，我们看到有<strong class="ky ir"> 321 </strong>个用户在指定的时间内安装了应用程序。</p><p id="8ef4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要获得用户安装的每日明细，您还可以运行以下代码:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="adf5" class="mp lt iq nc b gy ng nh l ni nj">SELECT<br/>  FORMAT_DATE('%Y-%m-%d', PARSE_DATE('%Y%m%d', event_date)) AS date,<br/>  COUNT(DISTINCT user_pseudo_id) as users_installed<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "first_open"<br/>  AND _TABLE_SUFFIX BETWEEN '20180927' and '20181003'<br/>GROUP BY date<br/>ORDER BY date</span></pre><p id="0f52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该查询产生以下结果:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="1fda" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">用户的人口统计特征是什么？</h2><p id="4be1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Firebase中提供了一些人口统计数据，例如位置和设备信息。</p><p id="0b2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，该查询给出了我们的用户所在的前10个国家，以及相应的百分比:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="0fb3" class="mp lt iq nc b gy ng nh l ni nj">WITH<br/>--Compute for the numerators<br/>country_counts AS (<br/>SELECT<br/>  geo.country,<br/>  COUNT(DISTINCT user_pseudo_id) AS users<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "first_open"<br/>  AND _TABLE_SUFFIX BETWEEN '20180927' and '20181003'<br/>  AND geo.country &lt;&gt; ""<br/>GROUP BY geo.country<br/>),<br/>--Compute for the denominators<br/>user_counts AS (<br/>SELECT<br/>  COUNT(DISTINCT user_pseudo_id)<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "first_open"<br/>  AND _TABLE_SUFFIX BETWEEN '20180927' and '20181003'<br/>),<br/>--Compute for the percentages<br/>percent AS (<br/>SELECT<br/>  country,<br/>ROUND(users / (SELECT * FROM user_counts), 4) AS percent_users<br/>FROM country_counts<br/>)</span><span id="ffb5" class="mp lt iq nc b gy nm nh l ni nj">SELECT * FROM percent<br/>ORDER BY percent_users DESC<br/>LIMIT 10</span></pre><p id="23f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们通过运行代码得到以下结果:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="fc30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由此，我们知道我们的用户群中有五分之二来自<strong class="ky ir">美国</strong>，而<strong class="ky ir">印度</strong>也有15%的良好表现。</p><p id="5d7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过运行以下查询，我们还可以了解他们玩游戏时使用的设备类型(手机还是平板电脑):</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="d9f8" class="mp lt iq nc b gy ng nh l ni nj">WITH<br/>device_counts AS (<br/>SELECT<br/>  device.category,<br/>  COUNT(DISTINCT user_pseudo_id) AS users<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "first_open"<br/>  AND _TABLE_SUFFIX BETWEEN '20180927' and '20181003'<br/>  AND device.category &lt;&gt; ""<br/>GROUP BY device.category<br/>),</span><span id="6568" class="mp lt iq nc b gy nm nh l ni nj">user_counts AS (<br/>SELECT<br/>  COUNT(DISTINCT user_pseudo_id)<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "first_open"<br/>  AND _TABLE_SUFFIX BETWEEN '20180927' and '20181003'<br/>),</span><span id="ab8e" class="mp lt iq nc b gy nm nh l ni nj">percent AS (<br/>SELECT<br/>  category,<br/>  ROUND(users / (SELECT * FROM user_counts), 4) AS percent_users<br/>FROM device_counts<br/>)</span><span id="10ca" class="mp lt iq nc b gy nm nh l ni nj">SELECT * FROM percent<br/>ORDER BY percent_users DESC</span></pre><p id="8b31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从这个例子中我们看到<strong class="ky ir"> 81% </strong>在用手机，而只有<strong class="ky ir"> 19% </strong>在用平板。</p><h2 id="f400" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">每天有多少用户在积极使用该应用？</h2><p id="0510" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">每日活跃用户(DAU)指标让您了解当前应用程序用户的参与度。如何衡量取决于你如何定义活跃用户。在本例中，我们将活动用户定义为一天中执行了任何“user_engagement”操作的用户。</p><p id="fab4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要计算指定时间段的DAU，只需运行以下查询:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="ae87" class="mp lt iq nc b gy ng nh l ni nj">WITH<br/>daily_user_count AS (<br/>SELECT<br/>  FORMAT_DATE('%Y-%m-%d', PARSE_DATE('%Y%m%d', event_date)) AS date,<br/>  COUNT(DISTINCT user_pseudo_id) AS active_users<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "user_engagement"<br/>  AND _TABLE_SUFFIX BETWEEN '20180901' and '20180930'<br/>GROUP BY date<br/>)</span><span id="ef27" class="mp lt iq nc b gy nm nh l ni nj">SELECT AVG(active_users) AS daily_active_users<br/>FROM daily_user_count</span></pre><p id="27d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">平均而言，9月份有<strong class="ky ir"> 496 </strong>名用户使用该应用。</p><h2 id="e76f" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">用户在该应用上的花费是多少？</h2><p id="23d6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们还可以通过运行以下查询来了解用户在应用内购买上的花费:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="4534" class="mp lt iq nc b gy ng nh l ni nj">SELECT SUM(user_ltv.revenue) AS revenue<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = "in_app_purchase"<br/>  AND geo.country = "United States"<br/>  AND _TABLE_SUFFIX BETWEEN '20180901' and '20180930'</span></pre><p id="11bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对美国用户来说，这只是5.94美元，并不多，但了解这一点后，我们可以制定更好的策略来追加销售应用内购买。</p><h2 id="316b" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">有多少用户遇到了应用崩溃？</h2><p id="7d00" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">为了防止流失和卸载，有必要监控不愉快的用户体验，如应用程序崩溃。</p><p id="75b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以通过查询“app_exception”事件来深入了解这一点:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="8ec6" class="mp lt iq nc b gy ng nh l ni nj">SELECT COUNT(DISTINCT user_pseudo_id) AS users<br/>FROM `firebase-public-project.analytics_153293282.events_*`,<br/>UNNEST(event_params) e<br/>WHERE event_name = 'app_exception'<br/>  AND _TABLE_SUFFIX BETWEEN '20180901' and '20180930'<br/>  AND e.key = 'fatal' AND e.value.int_value = 1</span></pre><p id="0237" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意UNNEST()函数。事件参数在BigQuery中存储为数组，因此需要首先取消嵌套。查看<a class="ae kv" href="https://medium.com/firebase-developers/how-to-use-select-from-unnest-to-analyze-multiple-parameters-in-bigquery-for-analytics-5838f7a004c2" rel="noopener">这篇文章</a>可以更深入地讨论BigQuery中的非嵌套事件参数。</p><p id="3327" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据这个查询，我们已经确定<strong class="ky ir"> 269 </strong>个用户在九月份遇到过崩溃。</p><h2 id="1394" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">有多少用户在卸载应用？</h2><p id="acd6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">App删除是一种不良结果，因此应定期监控。这个在Firebase中对应的事件名是“app_remove”。</p><p id="4424" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下查询输出了在9月份安装该应用程序的人群中，一周后仍在使用该应用程序的用户的百分比:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="edfc" class="mp lt iq nc b gy ng nh l ni nj">WITH<br/>--List of users who installed in Sept<br/>sept_cohort AS (<br/>SELECT DISTINCT user_pseudo_id,<br/>FORMAT_DATE('%Y-%m-%d', PARSE_DATE('%Y%m%d', event_date)) AS date_first_open,<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = 'first_open'<br/>AND _TABLE_SUFFIX BETWEEN '20180901' and '20180930'<br/>),</span><span id="7abb" class="mp lt iq nc b gy nm nh l ni nj">--Get the list of users who uninstalled<br/>uninstallers AS (<br/>SELECT DISTINCT user_pseudo_id,<br/>FORMAT_DATE('%Y-%m-%d', PARSE_DATE('%Y%m%d', event_date)) AS date_app_remove,<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = 'app_remove'<br/>AND _TABLE_SUFFIX BETWEEN '20180901' and '20181007'<br/>),</span><span id="1af6" class="mp lt iq nc b gy nm nh l ni nj">--Join the 2 tables and compute for # of days to uninstall<br/>joined AS (<br/>SELECT a.*,<br/>b.date_app_remove,<br/>DATE_DIFF(DATE(b.date_app_remove), DATE(a.date_first_open), DAY) AS days_to_uninstall<br/>FROM sept_cohort a<br/>LEFT JOIN uninstallers b<br/>ON a.user_pseudo_id = b.user_pseudo_id<br/>)</span><span id="7c48" class="mp lt iq nc b gy nm nh l ni nj">--Compute for the percentage<br/>SELECT<br/>COUNT(DISTINCT<br/>CASE WHEN days_to_uninstall &gt; 7 OR days_to_uninstall IS NULL THEN user_pseudo_id END) /<br/>COUNT(DISTINCT user_pseudo_id)<br/>AS percent_users_7_days<br/>FROM joined</span></pre><p id="abed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这告诉我们，9月份安装者的7天保留率在<strong class="ky ir">为76% </strong>，或者说<strong class="ky ir">有24% </strong>的9月份人群已经卸载了该应用。</p><p id="382b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个数字有多好？这可以通过对行业基准进行一些研究来回答，或者通过监控趋势如何随着时间的推移而发展。</p><p id="2747" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以将保留率的时间范围更改为最有用的时间范围，方法是将最终的“CASE WHEN”条件编辑为您想要的天数，而不是7天。</p><h2 id="2852" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">崩溃是否可能影响用户体验，导致他们卸载？</h2><p id="f646" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们可以进一步深入了解卸载该应用程序的用户，以确定删除它的可能原因。因为我们可以访问几个事件，所以我们可以查看它们并检查与卸载的相关性。</p><p id="8dca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，我们可能希望在卸载之前检查有多少卸载程序遇到了崩溃。我们不能断定这导致了他们的沮丧并导致他们移除应用程序，但只看数字可能会有所帮助。可以运行这样的查询:</p><pre class="kg kh ki kj gt nb nc nd ne aw nf bi"><span id="bb13" class="mp lt iq nc b gy ng nh l ni nj">WITH<br/>--List of users who installed in Sept<br/>sept_cohort AS (<br/>SELECT DISTINCT user_pseudo_id,<br/>FORMAT_DATE('%Y-%m-%d', PARSE_DATE('%Y%m%d', event_date)) AS date_first_open,<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = 'first_open'<br/>AND _TABLE_SUFFIX BETWEEN '20180901' and '20180930'<br/>),</span><span id="8304" class="mp lt iq nc b gy nm nh l ni nj">--Get the list of users who uninstalled<br/>uninstallers AS (<br/>SELECT DISTINCT user_pseudo_id,<br/>FORMAT_DATE('%Y-%m-%d', PARSE_DATE('%Y%m%d', event_date)) AS date_app_remove,<br/>FROM `firebase-public-project.analytics_153293282.events_*`<br/>WHERE event_name = 'app_remove'<br/>AND _TABLE_SUFFIX BETWEEN '20180901' and '20181007'<br/>),</span><span id="815c" class="mp lt iq nc b gy nm nh l ni nj">--Get the list of users who experienced crashes<br/>users_crashes AS (<br/>SELECT DISTINCT user_pseudo_id,<br/>FORMAT_DATE('%Y-%m-%d', PARSE_DATE('%Y%m%d', event_date)) AS date_crash,<br/>FROM `firebase-public-project.analytics_153293282.events_*`,<br/>UNNEST(event_params) e<br/>WHERE event_name = 'app_exception'<br/>AND _TABLE_SUFFIX BETWEEN '20180901' and '20181007'<br/>AND e.key = 'fatal' AND e.value.int_value = 1<br/>),</span><span id="b4f1" class="mp lt iq nc b gy nm nh l ni nj">--Join the 3 tables<br/>joined AS (<br/>SELECT a.*,<br/>b.date_app_remove,<br/>DATE_DIFF(DATE(b.date_app_remove), DATE(a.date_first_open), DAY) AS days_to_uninstall,<br/>c.date_crash<br/>FROM sept_cohort a<br/>LEFT JOIN uninstallers b<br/>ON a.user_pseudo_id = b.user_pseudo_id<br/>LEFT JOIN users_crashes c<br/>ON a.user_pseudo_id = c.user_pseudo_id<br/>)</span><span id="2376" class="mp lt iq nc b gy nm nh l ni nj">--Compute the percentage<br/>SELECT<br/>COUNT(DISTINCT<br/>CASE WHEN days_to_uninstall &lt;= 7 AND date_crash IS NOT NULL<br/>THEN user_pseudo_id END)<br/>/ COUNT(DISTINCT<br/>CASE WHEN days_to_uninstall &lt;= 7 THEN user_pseudo_id END)<br/>AS percent_users_crashes<br/>FROM joined</span></pre><p id="c9ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这表明只有2.4%的卸载程序经历了崩溃。看起来数量很少，但与非安装者进行比较可能有助于得出更合理的结论。此外，我们可以创建一个应用程序删除率模型来确定应用程序删除的预测因素。我不会在本文中涉及这些内容，因为这超出了范围，但是我推荐它作为一个强大的下一步。</p><h1 id="a6fb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="1a05" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这篇文章中，我们发现了BigQuery可以为您的应用分析带来的巨大可能性。我们提到了一些简单的查询，但随着您对Firebase中可用数据的了解越来越多，我鼓励您更深入地挖掘，亲自看看这个强大的资源如何帮助您发展应用业务。</p><p id="f519" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你喜欢这篇文章或者觉得它有用，请关注我的博客<a class="ae kv" href="https://medium.com/@noemiramiro" rel="noopener">获取更多关于营销分析和数据科学的资源。快乐学习！</a></p></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><p id="b0d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">参考资料:</p><p id="62bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Google Analytics 4游戏应用实施的BigQuery样本数据集。<em class="nu">谷歌分析样本数据集。</em>网上有:<a class="ae kv" href="https://developers.google.com/analytics/bigquery/app-gaming-demo-dataset" rel="noopener ugc nofollow" target="_blank">https://developers . Google . com/analytics/big query/app-gaming-demo-dataset</a>。许可信息:<a class="ae kv" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">知识共享署名4.0许可</a></p></div></div>    
</body>
</html>