<html>
<head>
<title>How to Easily Automate Emails with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python轻松实现电子邮件自动化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-automate-emails-with-python-8b476045c151#2022-06-08">https://towardsdatascience.com/how-to-easily-automate-emails-with-python-8b476045c151#2022-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="258f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python自动化枯燥的电子邮件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8991ebed748f3b5bf8489a50c04b1f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QxNl-6K4E2SfZcPq"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@onlineprinters?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在线打印机</a>拍摄</p></figure><p id="b808" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你知道大多数办公室工作的共同点吗？在大多数情况下，你必须定期发送电子邮件。</p><p id="a762" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不管你是程序员、数据科学家还是工程师，你都有可能每天都要阅读和回复电子邮件。这项活动并没有给我们的职业增加任何价值，然而它停止了我们的工作流程，占用了我们宝贵的时间。</p><p id="7388" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解决办法？用Python实现自动化！</p><p id="22bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我将向您展示如何使用Python自动发送电子邮件。我们将在本教程中使用Gmail，所以请确保您有一个Gmail帐户来测试这种自动化。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="b333" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">Table of Contents<br/></strong>1. <a class="ae ky" href="#62c7" rel="noopener ugc nofollow">Turn On 2-Step Verification</a><br/>2. <a class="ae ky" href="#bc59" rel="noopener ugc nofollow">Sending Email with Python</a><br/> - <a class="ae ky" href="#0c87" rel="noopener ugc nofollow">Import the libraries and set email sender and receiver</a><br/> - <a class="ae ky" href="#cbd8" rel="noopener ugc nofollow">Set the subject and body of the email</a><br/> - <a class="ae ky" href="#fe88" rel="noopener ugc nofollow">Add SSL</a><br/> - <a class="ae ky" href="#17a9" rel="noopener ugc nofollow">Log in and send the email</a><br/>3. <a class="ae ky" href="#c3f9" rel="noopener ugc nofollow">Schedule the Python Script to Run Monthly, Weekly, or Daily</a></span></pre><p id="e645" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mg">如果你不想看，你可以看我的视频！</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mh mi l"/></div></figure><h1 id="62c7" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">1.打开两步验证</h1><p id="332a" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">在我们开始编写代码之前，我们需要设置我们的Gmail帐户，以便能够在Python中使用它。</p><p id="ba01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">过去，我们可以通过打开“不太安全的应用程序访问”来轻松地使用Python连接到Gmail，但该选项不再可用。我们现在要做的是打开两步验证，以获得一个16个字符的密码，我们可以使用该密码使用Python登录Gmail。</p><p id="3465" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，进入你的<a class="ae ky" href="https://myaccount.google.com/" rel="noopener ugc nofollow" target="_blank"> Google账户</a>，选择你想在本教程中使用的账户，并在左侧面板选择“安全”选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/995b0d5a7dac33bd60b3e7b71c443381.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*754j5m_tFOcLMy-MjJbiSw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c5c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后向下滚动，直到找到“登录谷歌”部分这里我们需要点击“两步验证”</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/9dcad1ad1888ce9110f8b15b6156b21f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qvG2Fs6938uqi8XPEGVE0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e9e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这之后，我们会看到新的一页。我们必须点击“开始”</p><p id="0165" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谷歌会要求再次登录。然后我们必须输入一个电话号码，并点击“下一步”我们将获得一个代码来验证我们的电话号码。在我们引入代码之后，我们应该会看到下面的页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/7cd0aad39a8817083ec736b00d25bb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p74qfC4bptEuFAq7NsZyHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f218" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要点击“打开”</p><p id="2d0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一切设置正确，我们将看到一个新的页面，显示消息“两步验证开始”</p><p id="7848" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们需要转到“应用程序密码”部分，因此再次转到您的<a class="ae ky" href="https://myaccount.google.com/" rel="noopener ugc nofollow" target="_blank"> Google帐户</a>，点击“安全”，向下滚动直到您找到“登录Google”部分，然后选择“应用程序密码”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/32c3832039bccaff018a944b6575739d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0N8FNKLBjiNVEcFr4t2lw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0741" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要再次登录。之后，我们应该会看到下面的页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/043f8d39f6c7296c9b68289e490b20ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4nBA8l6LRICMCY75mxnPQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3dac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在“选择应用程序”下拉列表中，选择“其他(自定义名称)”并键入您想要的任何名称。我将我的命名为“Python ”,然后点击“生成”</p><p id="2374" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此之后，我们应该会看到一个新的页面，在一个黄色框中有16个字符的密码，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/4f9315433531699432bf82cefaadb4d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*W9wsfDSVCj10kp51iWX23w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="108d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">都弄好了！我们将使用这个16个字符的密码登录我们的Python Gmail帐户。</p><p id="c601" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以复制这个密码并将其粘贴到Python脚本的一个变量中，或者使用环境变量隐藏密码(我强烈推荐您这样做)。你可以按照我的指南<a class="ae ky" href="https://medium.com/geekculture/how-to-hide-passwords-and-secret-keys-in-your-python-scripts-a8904d5560ec" rel="noopener">在Windows和macOS上创建环境变量</a>。</p><h1 id="bc59" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">2.使用Python发送电子邮件</h1><p id="9ee3" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">一旦我们打开两步验证并有了16个字符的密码，我们就可以开始编写代码了。</p><h2 id="0c87" class="ma mb it bd mk nl nm dn mo nn no dp ms li np nq mu lm nr ns mw lq nt nu my nv bi translated">导入库并设置电子邮件发送者和接收者</h2><p id="d482" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">要使用Python发送电子邮件，我们需要使用以下内置的Python库。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9a2d" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">import</strong> smtplib<br/><strong class="lw iu">import</strong> ssl<br/><strong class="lw iu">from</strong> email.message <strong class="lw iu">import</strong> EmailMessage<br/><br/>email_sender = 'codelessearnmore@gmail.com'<br/>email_password = 'write-password-here'<br/>email_receiver = 'write-email-receiver-here'</span></pre><p id="8c6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们设置电子邮件发送者和密码(这是我们用来打开两步验证的电子邮件)以及电子邮件接收者。</p><p id="7026" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，电子邮件收件人不一定是Gmail帐户，也可以来自不同的电子邮件服务。</p><h2 id="cbd8" class="ma mb it bd mk nl nm dn mo nn no dp ms li np nq mu lm nr ns mw lq nt nu my nv bi translated">设置电子邮件的主题和正文</h2><p id="b44e" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">现在我们需要定义一个主题和一个主体。我们可以在这里写任何想写的东西。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8dda" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">subject</strong> = 'Check out my new video!'<br/><strong class="lw iu">body</strong> = """<br/>I've just published a new video on YouTube: https://youtu.be/2cZzP9DLlkg<br/>"""</span></pre><p id="a782" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我在正文中用三重引号写了多行。</p><p id="4b0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们实例化<code class="fe nw nx ny lw b">EmailMessage</code>类，并使用我们之前为电子邮件、主题和正文创建的变量。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="940d" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">em</strong> = EmailMessage()<br/><strong class="lw iu">em['From']</strong> = email_sender<br/><strong class="lw iu">em['To']</strong> = email_receiver<br/><strong class="lw iu">em['Subject']</strong> = subject<br/><strong class="lw iu">em</strong>.set_content(body)</span></pre><h2 id="fe88" class="ma mb it bd mk nl nm dn mo nn no dp ms li np nq mu lm nr ns mw lq nt nu my nv bi translated">添加SSL</h2><p id="2f7b" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">现在让我们使用SSL来增加一层安全性。SSL是保持互联网连接安全和保护在两个系统之间发送的任何敏感数据的标准技术。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="80ab" class="ma mb it lw b gy mc md l me mf">context = ssl.create_default_context()</span></pre><h2 id="17a9" class="ma mb it bd mk nl nm dn mo nn no dp ms li np nq mu lm nr ns mw lq nt nu my nv bi translated">登录并发送电子邮件</h2><p id="6704" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">最后，我们指定主机<code class="fe nw nx ny lw b">smtp.gmail.com</code>，通过端口<code class="fe nw nx ny lw b">465</code>连接，并使用上一步定义的<code class="fe nw nx ny lw b">context</code>登录并发送我们的电子邮件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz mi l"/></div></figure><p id="8580" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你！我们刚刚用Python发了一封电子邮件。进入<code class="fe nw nx ny lw b">email_receiver</code>收件箱查看我们发送的邮件。</p><p id="8547" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我收到的邮件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/9148a5629221dec190d75748d7209c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A2iw34DmaaljU1IPMk6HUg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="df76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在我的<a class="ae ky" href="https://github.com/ifrankandrade/automation" rel="noopener ugc nofollow" target="_blank"> Github </a>上查看我们在本指南中构建的脚本。</p><p id="c5b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>如果运行脚本后得到一个<code class="fe nw nx ny lw b">ssl.SSLCertVerificationError</code>，搜索一个名为<code class="fe nw nx ny lw b">Install Certificates.command</code>的文件并安装它。</p><p id="d6ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，进入“应用程序”，点击一个名为“Python 3。x”，并双击文件<code class="fe nw nx ny lw b">Install Certificates.command</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/57b9b99ef7abdc68e5f4b5af5530e6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Urzbs7VtxAECbLvumLELbQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fc97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦安装完成，在运行脚本时，您应该不会收到任何错误消息。</p><h1 id="c3f9" class="mj mb it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">3.安排Python脚本每月、每周或每天运行</h1><p id="630a" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">您可以使用macOS上的crontab和Windows上的任务调度器来安排每天或每周执行这个Python脚本。</p><p id="1f9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解如何做到这一点，请查看我下面的指南。</p><div class="oc od gp gr oe of"><a rel="noopener follow" target="_blank" href="/how-to-easily-automate-your-python-scripts-on-mac-and-windows-459388c9cc94"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">如何在Mac和Windows上轻松自动化您的Python脚本</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">使用crontab和任务调度器来自动化您的脚本并节省时间</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">towardsdatascience.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ks of"/></div></div></a></div></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="996e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自动化你的生活！<a class="ae ky" href="https://frankandrade.ck.page/44559e1ae7" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">加入我的10k+人电子邮件列表，获取我的免费自动化备忘单。</strong>T3】</a></p><p id="a5f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你用<a class="ae ky" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="oc od gp gr oe of"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="oo l"><div class="pb l oq or os oo ot ks of"/></div></div></a></div></div></div>    
</body>
</html>