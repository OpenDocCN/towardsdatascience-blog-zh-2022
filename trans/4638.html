<html>
<head>
<title>4 Advance Python Operations You May Have Forgotten</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你可能已经忘记的4个高级Python操作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-advance-python-operations-you-may-have-forgotten-58b0565b9f#2022-10-15">https://towardsdatascience.com/4-advance-python-operations-you-may-have-forgotten-58b0565b9f#2022-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ac5b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何在Python中使用熔化、透视、堆叠和分解</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9e2bd9ac1b43fccf0ede0303e7f5d3a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y8qSPaGs4PdLwNg11yiRfg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pic鸣谢:Unsplash</p></figure><p id="5287" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">默认情况下，数据不是可用的格式；数据科学专业人员必须将70–80%的时间花在数据清理和处理上，以使其能够用于生成有意义的见解。</p><p id="3529" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在数据操作过程中，数据科学家/分析师可能不得不进行各种类型的数据转换，有时我们会感到困惑，因为我们不知道python中是否存在执行所需转换的直接函数。</p><p id="1eab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇博客文章中，我们将看看4个高级python数据转换函数，它们将使您作为数据科学专业人员的生活变得更加轻松，并且将是您的数据操作函数库的一个巨大补充。</p><h2 id="dc54" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">1.在枢轴上转动</h2><p id="4015" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">pandas中的透视功能与excel中的透视操作功能相同。我们可以将数据集从长格式转换为宽格式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/a6b4a38019f8b6d96e2cb793d771dc7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aDcxCRE7ocnbiJf7NR3zhg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">长到宽格式(图片由作者提供)</p></figure><p id="b17f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们用一个例子来理解这个。想象一下，我们有一个跨国家的新冠肺炎病例数据集，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/f98163ef8dc5f3e2061e02e1195f71f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*Tx4p4-rT_IF9Z3clPhfQ2g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="ddd3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们希望将数据集转换成一种形式，使每个国家成为一列，新确诊病例成为与这些国家相对应的值。我们可以使用pivot函数来执行这种数据操作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/0177009a131c868cbf501a47c9d7234d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpgpXrCezvjDRVA82B0Hcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">枢纽功能(图片由作者提供)</p></figure><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="30ac" class="lu lv it mw b gy na nb l nc nd">### Pivot the dataset<br/>pivot_df = pd.pivot(df, index =['Date'], columns ='Country', values =['NewConfirmed'])</span><span id="a6eb" class="lu lv it mw b gy ne nb l nc nd">## renaming the columns  <br/>pivot_df.columns = df['Country'].sort_values().unique()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/eeb0bae0c2f1858930867e7b417f9880.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*t1S_Qi1sbrvk3-YiPVJ3CA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">透视后的数据集(作者提供的图片)</p></figure><p id="e787" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过重置索引，我们可以使新列与索引列数据处于相同的级别。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="8c83" class="lu lv it mw b gy na nb l nc nd">## reset the index to modify the column levels<br/>pivot_df = pivot_df.reset_index()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0e93242831865f29365d13bb7997c0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*8LsaxNUG19dejUMJfCsihg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">重置索引(图片由作者提供)</p></figure><div class="nh ni gp gr nj nk"><a href="https://medium.com/codex/dont-use-iterrows-for-loops-in-python-instead-use-these-6363395dcea2" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">你想在Python中运行快31倍的循环吗？</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">了解循环熊猫数据帧的最有效方法</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">medium.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ks nk"/></div></div></a></div><h2 id="ea1e" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated"><strong class="ak"> 2。融化</strong></h2><p id="7c66" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">Melt与pivot相反，它用于取消数据集的透视。它将数据从宽格式转换为长格式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/860062bb499a2ab33cd5b1bc4c020afe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KbZJ6aLm_0aoOg_ETkG4gA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">宽到长格式(图片由作者提供)</p></figure><p id="f727" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看如何取消我们在上面创建的宽格式新冠肺炎数据集的透视。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="cf51" class="lu lv it mw b gy na nb l nc nd">## The dataset is melted by setting the id column - a column that will not change.<br/>## and value column - columns we want to unpivot</span><span id="65ce" class="lu lv it mw b gy ne nb l nc nd">melted_df = pivot_df.melt(id_vars = 'Date', value_vars = ['US', 'India', 'China'])</span><span id="fab3" class="lu lv it mw b gy ne nb l nc nd"># we can rename the columns too<br/>melted_df.columns = ['Date', 'Country', 'NewConfirmed']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/4b1b7c86743742489e28aadfaf503993.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*IxOc6YgdbeZ_tyVYOj2yYg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/47e35594a040cc0ec02c189fd01aee75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8LsEV5hVHm9yA_dsPEqL1A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将数据从宽格式融合到长格式(图片由作者提供)</p></figure><h2 id="f925" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">3.堆</h2><p id="ff39" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">stack函数用于将多级列转换(或取消透视)为行。</p><p id="fd19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们来看几个例子！</p><p id="0fba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们选择透视新冠肺炎数据集而不重置索引，那么它看起来会像这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/eeb0bae0c2f1858930867e7b417f9880.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*t1S_Qi1sbrvk3-YiPVJ3CA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">透视后的数据集(作者提供的图片)</p></figure><p id="4002" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以使用stack函数将country列堆叠回行，如下所示。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="1020" class="lu lv it mw b gy na nb l nc nd">## stack the dataset<br/>stack_df = pivot_df.stack()</span><span id="9936" class="lu lv it mw b gy ne nb l nc nd">## reset the index and set column names<br/>stack_df = stack_df.reset_index()<br/>stack_df.columns = ['Date','Country','NewConfirmed']<br/>stack_df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/8be4d7ae31b53eb9731b559c60a88376.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*Iyf-sTuJmjhHpfTPRRZVjQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">堆叠数据集(按作者分类的图像)</p></figure><p id="083f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，你可能会想同样的转换也可以用融化函数来完成，你是对的。但这两者还是有区别的，stack函数更高级——它适用于多级列，而melt不能。例如，堆栈功能可以转换具有2个列级别的以下数据:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/54530b5766c1f34aaa680d18d99d1101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oG70il73qGYiRXb0WVmtsg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">堆叠数据集(按作者排列的图像)</p></figure><blockquote class="oe of og"><p id="612c" class="ky kz oh la b lb lc ju ld le lf jx lg oi li lj lk oj lm ln lo ok lq lr ls lt im bi translated">“-1”级别表示倒数第一列。</p></blockquote><h2 id="31dd" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">4.出栈</h2><p id="1117" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">解散堆叠与堆叠相反，它用于透视多级列数据集的一级/多级。</p><p id="2794" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看几个例子来更好地理解它！</p><p id="1482" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用unstack，我们可以透视数据集的列，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/315daff0b166269bfe4f79eb603d7269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hfwjy_RHM_2P-5p4lKtTww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">拆分数据集(按作者排列的图像)</p></figure><p id="e45e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">分解功能也可以处理多级列数据集，而熔化功能则不能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/c3143f8665b8925b5ecd2f4777a367a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pjCpvfHJHEF5CX8e6YQUQA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">拆分功能(图片由作者提供)</p></figure><blockquote class="oe of og"><p id="a8d8" class="ky kz oh la b lb lc ju ld le lf jx lg oi li lj lk oj lm ln lo ok lq lr ls lt im bi translated">枢轴/熔化功能是堆叠/分解功能的子集。透视/融合不适用于多层柱。</p></blockquote><div class="nh ni gp gr nj nk"><a href="https://medium.com/codex/9-python-concepts-you-should-not-skip-for-effective-data-science-a8606c58a53b" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">有效数据科学不应忽略的9个Python概念</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">你在数据科学面试中应该了解的9个概念</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">medium.com的</p></div></div><div class="nt l"><div class="om l nv nw nx nt ny ks nk"/></div></div></a></div><h2 id="2a30" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">结论</h2><p id="fed0" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在这篇博客中，我们研究了4种高级数据转换技术，将数据格式从长格式转换为宽格式，反之亦然。</p><p id="bd2c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Pivot/Melt适用于单级列数据集，而Stack/Unstack也可应用于任何复杂的多级列数据集。</p></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><h2 id="d6c0" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">谢谢你</h2><p id="bca0" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我希望这个故事对你有用。你可以在收件箱里看到我所有的帖子。 <a class="ae ou" href="https://anmol3015.medium.com/subscribe" rel="noopener"> <strong class="la iu"> <em class="oh">做到这里</em> </strong> <em class="oh">！</em>T9】</a></p><p id="7ede" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="oh">如果你自己喜欢体验媒介，可以考虑通过</em> <a class="ae ou" href="https://anmol3015.medium.com/membership" rel="noopener"> <strong class="la iu"> <em class="oh">注册会员</em> </strong> </a> <em class="oh">来支持我和其他几千位作家。它每个月只需要5美元，它极大地支持了我们，作家，你可以在媒体上看到所有精彩的故事。</em></p><h2 id="9dc0" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">你可能喜欢的故事！</h2><div class="nh ni gp gr nj nk"><a href="https://medium.com/codex/dont-use-loc-iloc-with-loops-in-python-instead-use-this-f9243289dde7" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">不要在Python中使用带循环的loc/iloc，而是使用这个！</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">以60倍的速度运行您的循环</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">medium.com</p></div></div><div class="nt l"><div class="ov l nv nw nx nt ny ks nk"/></div></div></a></div></div></div>    
</body>
</html>