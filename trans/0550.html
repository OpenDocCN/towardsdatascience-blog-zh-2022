<html>
<head>
<title>Read a Multi-Column PDF Using PyMuPDF in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的PyMuPDF读取多列PDF</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/read-a-multi-column-pdf-using-pymupdf-in-python-4b48972f82dc#2022-02-22">https://towardsdatascience.com/read-a-multi-column-pdf-using-pymupdf-in-python-4b48972f82dc#2022-02-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f094" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">NLP工具</h2><div class=""/><div class=""><h2 id="6166" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">逐步介绍OCR的奇妙世界(附图片)</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/b156b2fad32884c93f591cd1a020370a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*leU5H74kXxSJTrhK"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@kingjaizer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Jaizer Capangpangan </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="fdaa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">OCR或光学字符识别是用于从图像或文档中自动提取文本的技术。在这些图像和文档中找到的文本可以是任何键入的、手写的、显示在某种屏幕上的，或者可能是以上所有的！</p><p id="f3a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">OCR最初用作数据输入的高级形式，最常用于将纸质文物中的文本数字化，“以便它们可以被电子编辑、搜索、更紧凑地存储、在线显示，并用于机器处理，如认知计算、机器翻译、(提取的)文本到语音、关键数据和文本挖掘”[1]。例如，在我的工作中，我依靠OCR技术将非结构化和半结构化数据转换成足够清晰的格式，以便放入电子表格或数据库中。</p><p id="2db1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">OCR研究包括模式识别、人工智能和计算机视觉。[1]虽然有许多商业产品提供OCR服务，如Amazon Textract和ABBYY，但没有什么比用我们最喜欢的编程语言Python编写的免费解决方案更好的了。</p><p id="d290" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">今天，我们将与PyMuPDF(也称为fitz)一起尝试OCR。</p><p id="55b4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">快点，我们跳进去吧！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="4a6e" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">装置</h1><p id="438f" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">在我们启动jupyter笔记本之前，让我们确保我们的机器上已经安装了软件包。要安装pyMuPDF，请在终端中键入以下内容:</p><pre class="ks kt ku kv gt ni nj nk nl aw nm bi"><span id="0d32" class="nn mm it nj b gy no np l nq nr">pip install pymupdf</span></pre><p id="7167" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，让我们启动一个jupyter笔记本，键入以下内容来导入PyMuPDF包。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="d639" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，让我们设置全局变量。请确保将“replace _ this _ with _ your _ own _ path _ to _ file”替换为您的pdf文件的路径，或者您可以下载我在这里使用的示例文件<a class="ae lh" href="https://github.com/ecdedios/read-multicolumn-pdf-pymupdf/tree/main/data/in" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="c8d2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数字化pdf文件是可搜索的pdf文件。要确定pdf是否可搜索，请打开一个pdf文档，按下<code class="fe nu nv nw nj b">CTRL+F</code>并键入文档中出现的单词。如果程序能找到这个词，它就是可搜索的。否则，它可能是一个扫描的pdf。正如我们将在后面看到的，<strong class="lk jd"> <em class="nx"> pymupdf不支持扫描的pdf </em> </strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/e388cf4631cf6e365e46d571e9118f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0BKDlZn4Ky880qSTWpe5Ug.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">可搜索(数字化)pdf文档的示例。作者截图。</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/9eb8fad5218729689c0598962f23d061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ja3A86EUOwg5YnSyUeXAqg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">不可搜索(扫描)的pdf文档示例。作者截图。</p></figure><h1 id="b7a1" class="ml mm it bd mn mo nz mq mr ms oa mu mv ki ob kj mx kl oc km mz ko od kp nb nc bi translated">文本提取:“文本”</h1><p id="f302" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">使用PyMuPDF从可搜索的pdf中提取文本非常容易。在jupyter笔记本的单元格块中键入以下内容，然后观看神奇的事情发生:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="7a2e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们使用<code class="fe nu nv nw nj b">with fitz.open(DIGITIZED_FILE) as doc:</code>，这样我们就不用担心用<code class="fe nu nv nw nj b">close()</code>关闭文件。接下来，如果有多个页面，我们使用一个<code class="fe nu nv nw nj b">for</code>循环遍历pdf文档中的所有页面。文本的实际提取发生在代码块的核心部分，<code class="fe nu nv nw nj b">text = page.get_text()</code>。在我们的例子中，我们使用默认参数(“text”)。下面是<code class="fe nu nv nw nj b">print(text)</code>的结果:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/c4d60d3ab0f44fb7701468aa3cf3df5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l2OcSLlTH66LUt_s4VV2zQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者截图。</p></figure><p id="77d7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我们使用<code class="fe nu nv nw nj b">text = page.get_text("text")</code>，也会得到相同的结果。其他选择包括“块”和“词”有关get_text方法选项的完整列表，请访问<a class="ae lh" href="https://pymupdf.readthedocs.io/en/latest/textpage.html?highlight=get_text" rel="noopener ugc nofollow" target="_blank">文档</a>。[2]</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi of"><img src="../Images/2e4b0817e536bcafeab00acfb338b7d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fq69KQ2BySu9QZ2gIckF_Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">page.get_text()参数。作者截图。</p></figure><p id="172d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有趣的是，pyMuPDF成功地以自然阅读顺序阅读了文档，即使有两列。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/0c1f1b82d968deeaed92b89237c83b4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*WSq7X7EFubZWgmkGua-M_w.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyMuPDF从左到右阅读文档。作者截图。</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/1d8df5cd2fdcdea51a3b3015e1d005bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*dHnx8VenM0d96F2c685DoQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">PyMuPDF无缝地读取这两列。作者截图。</p></figure><h1 id="4b48" class="ml mm it bd mn mo nz mq mr ms oa mu mv ki ob kj mx kl oc km mz ko od kp nb nc bi translated">文本提取:“块”</h1><p id="b2fc" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">默认参数输出一个字符串。但是，其他参数返回不同的格式，如列表和元组。例如，<code class="fe nu nv nw nj b">page.get_text("blocks")</code>返回元组的<em class="nx">列表。让我们试一试:</em></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="288d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面，我们在<code class="fe nu nv nw nj b">page.get_text()</code>里面加了<code class="fe nu nv nw nj b">"blocks"</code>。结果如下:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/f944e520350c099ebc079631ce233f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hrtk6ESmHygRVhLvdGnXzg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者截图。</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/eca495099559a74faacbb7cce2049e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dg8oHn3va0ImL-TezExd3g.png"/></div></div></figure><p id="0f9a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据文档，的输出是:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/31b673c77d8975527185d9a9f81bd207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*egL0lTXA5X-HIWKw0InlkQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者截图。</p></figure><p id="0b8f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中前四项是边界框坐标，第五项是文本本身(用换行符或“\n”分隔多行)，第六项是块号，第七项是块类型(0表示文本，1表示图像)。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/c953ba99d316beafde998e91fa1d3a43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yafPe0tbiG5yiYMgWhw-4w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者截图。</p></figure><p id="17b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你需要知道页面上的什么地方，额外的信息是有益的。例如，如果您需要绘制边界框或高亮显示特定的块。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/a40aad3e978bea0cf465f645fb2d5bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dFx0A6Cwalv0uSMJ1_ph0g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者截图。</p></figure><h1 id="1d0c" class="ml mm it bd mn mo nz mq mr ms oa mu mv ki ob kj mx kl oc km mz ko od kp nb nc bi translated">文本提取:“单词”</h1><p id="d453" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">让我们试试“单词”参数，只是为了好玩:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="f92c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">结果显示，参数“words”返回一个元组的<em class="nx">列表，该列表逐字表示文本。</em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/2721ec9cbb938194d8975a1d3ef6068e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CV1p6fkqZPCNRQfaljT6gQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者截图。</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/3c21b302d741818c132f1fecaf26e4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SCJ5tfRvB-9djtvuH81-Ww.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">单词“sit”被标注为该页第一块的第三行中的第二个单词。作者截图。</p></figure><h1 id="1bcc" class="ml mm it bd mn mo nz mq mr ms oa mu mv ki ob kj mx kl oc km mz ko od kp nb nc bi translated">严重失败</h1><p id="33ac" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">如前所述，<strong class="lk jd"> <em class="nx"> pymupdf不适用于扫描的pdf </em> </strong>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/8ba57ea6c481120cadf4d26774b70260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJW4-JINB7tBQkdxOItN_g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者截图。</p></figure><p id="8e60" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">别担心！有一个包可以解决这个问题…</p><h1 id="910f" class="ml mm it bd mn mo nz mq mr ms oa mu mv ki ob kj mx kl oc km mz ko od kp nb nc bi translated">结论</h1><p id="9c0a" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">今天，我们看到了PyMuPDF的行动。这是一个有价值的工具。我已经用它自动搜索了数百个pdf文档，而不用打开Adobe Acrobat。</p><p id="3e5f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">可能性是无限的。</p><p id="e4c2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是扫描的pdf呢？！请继续关注我的下一篇文章，内容包括如何使用pytesseracT3阅读多列PDF。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="6240" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">谢谢你过来看我的帖子。希望PyMuPDF能像帮助我一样帮助你！你可以在<a class="ae lh" href="https://github.com/ecdedios" rel="noopener ugc nofollow" target="_blank"> Github </a>上这里找到我用<a class="ae lh" href="https://github.com/ecdedios/read-multicolumn-pdf-pymupdf/tree/main/data/in" rel="noopener ugc nofollow" target="_blank">的笔记本。</a></p><p id="64c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">敬请期待！</p><p id="28fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="nx">如果你想了解更多关于我从懒鬼到数据科学家的旅程，请查看下面的文章:</em></p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/from-slacker-to-data-scientist-b4f34aa10ea1"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jd gy z fp oy fr fs oz fu fw jc bi translated">从懒鬼到数据科学家</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">我的无学位数据科学之旅。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph lb ot"/></div></div></a></div><p id="05a8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="nx">如果你正在考虑改变方向，进入数据科学领域，现在就开始考虑重塑品牌:</em></p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/the-slackers-guide-to-rebranding-yourself-as-a-data-scientist-b34424d45540"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jd gy z fp oy fr fs oz fu fw jc bi translated">懒鬼将自己重塑为数据科学家指南</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">给我们其他人的固执己见的建议。热爱数学，选修。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pi l pe pf pg pc ph lb ot"/></div></div></a></div><p id="d3b8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以通过<a class="ae lh" href="https://twitter.com/ecdedios" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae lh" href="https://www.linkedin.com/in/ednalyn-de-dios/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="2678" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">参考</h1><p id="9f3f" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">[1]<a class="ae lh" href="https://en.wikipedia.org/wiki/Optical_character_recognition" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Optical_character_recognition</a></p><p id="cf1b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[2]<a class="ae lh" href="https://pymupdf.readthedocs.io/en/latest/textpage.html?highlight=get_text#" rel="noopener ugc nofollow" target="_blank">https://pymupdf.readthedocs.io/en/latest/textpage.html?highlight=get_text# </a></p></div></div>    
</body>
</html>