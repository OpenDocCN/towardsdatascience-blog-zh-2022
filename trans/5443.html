<html>
<head>
<title>Why I Prefer Probabilistic Forecasts — Hitting Time Probabilities</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我更喜欢概率预测——命中时间概率</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-i-prefer-probabilistic-forecasts-hitting-time-probabilities-726667b9c91d#2022-12-06">https://towardsdatascience.com/why-i-prefer-probabilistic-forecasts-hitting-time-probabilities-726667b9c91d#2022-12-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a1c6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">点位预测有利于决策。有了概率预测，你也可以做出正确的预测。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/14a174b7d5a733433abe90695c8a2f17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzCuyNC25q7K-kJto6AlpQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@aronvisuals?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿伦视觉</a>在<a class="ae ky" href="https://unsplash.com/s/photos/time?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="242e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="6fd6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在数据科学中，预测通常涉及创建预测未来事件的最佳模型。通常，“最佳”模型是最小化给定误差度量的模型，例如<em class="mn">均方误差</em> (MSE)。最终结果是一系列数值，描述了时间序列的预测轨迹。统计学家或计量经济学家称之为<em class="mn">点预测。</em></p><p id="c520" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">更传统的预测模型通常预测给定未来时期的整个概率分布。从现在开始，我们将这些<em class="mn">称为概率预测</em>。</p><p id="5e17" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">概率预测的一个好处是能够导出点预测和<em class="mn">区间预测。</em>将后者视为应用于预测的置信区间的时序模拟。</p><p id="85df" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">当然，一个点的预测更容易传达给非技术利益相关者。谁想处理所有可能的结果——给我一个衡量标准来作为我决策的依据！</p><p id="d776" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">现在，确实存在着过于复杂的解决方案最终被贵公司搁置的风险。然而，我们也不应该仅仅为了取悦我们的非技术终端用户而过多地降低复杂性。</p><p id="136b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">作为一个例子，让我们看看击中时间的问题。在你的标准数据科学课程中，这是一个相当不常见的话题。尽管如此，它还是很有用的。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="81e6" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">击中次数和击中时间概率</h1><p id="da76" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了我们的目的，我们用一个非常直观的定义:一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Hitting_time" rel="noopener ugc nofollow" target="_blank"> <em class="mn">击中时间</em> </a>仅仅是我们的时间序列第一次进入观察空间的某个子集。数学上，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/7cad0b770f0f7d6eaf046137dc223da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/0*f1Rsktmfn9toKNSZ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="9db2" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在哪里</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/fa6a3d642ffae1118032cad072b021cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:138/format:webp/0*ZJdXB-u4izRhm-Bz.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="e39d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">并且我们假设时间序列在实数中有实现。后者不是一个必要的要求，但使问题变得更加具体。</p><p id="9cdc" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们可以问的一个可能的问题是，当过程第一次超过给定的阈值时。我们感兴趣的子集是</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/ee60565c8eea9240a0dc5abf551da048.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/0*rf3GUA105d0jCMci.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="0ec2" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">有了<code class="fe ni nj nk nl b">C</code>利益的门槛。现在，当我们谈论击中时间<strong class="lt iu">概率</strong>时，我们想知道击中时间的概率分布，即</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/3392daa747d6d47abf503301b4754515.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/0*clDBGx8jiVfHZHsO.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="916f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于连续时间的时间序列，<code class="fe ni nj nk nl b">p</code>通常是一个概率密度..然而，由于数据科学中的大多数时间序列问题都是离散的，所以让我们也专注于这种情况。因此，<code class="fe ni nj nk nl b">p</code>是通常更容易处理的概率质量函数。</p><p id="b43b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">不幸的是，击中时间的概率很难分析计算，而且往往难以处理。</p><p id="a157" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">幸运的是，概率模型可以通过蒙特卡罗模拟来回答击中时间的问题。我们将在下面进一步研究这种方法。</p><p id="30c4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">起初，击中时间概率的想法可能看起来像一个很好的玩具问题，几乎没有实际意义。然而，请考虑一个简单的容量规划问题。由于需求增加，公司可能必须决定何时扩大运营能力。</p><p id="7cfa" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">一方面，这在某种程度上肯定可以用一个点预测来回答。只需选择您预测超过阈值的时间戳作为您的预测命中时间。如果一个分数预测首先就足够了，那么一个击球时间的“分数预测”肯定也能很好地工作。</p><p id="90ca" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">让我们看一个简单的例子:</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="c356" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">在野外击中时间的概率</h1><p id="37af" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了简单起见，我们使用古老的<a class="ae ky" href="https://www.kaggle.com/datasets/rakannimer/air-passengers" rel="noopener ugc nofollow" target="_blank">航空乘客</a>数据集。请记住，单个实验远远不足以得出任何概括的结论。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/4c828d62d8d23ff0971157b210a573a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ywcqAdGjpSl4C9cWPKljg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最辉煌的<em class="nq">航空乘客</em>数据集。(图片由作者提供)</p></figure><p id="582e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">虽然这些数据已经严重过时，但它足够简单，可以帮助我们快速地阐明观点。</p><h2 id="b5b3" class="nr la it bd lb ns nt dn lf nu nv dp lj ma nw nx ll me ny nz ln mi oa ob lp oc bi translated">命中时间点预测</h2><p id="e669" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先让我们考虑如何使用标准点预测来解决命中时间问题。最终，我们只能确定我们的预测何时达到某个阈值。</p><p id="15d1" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这里我选择了<strong class="lt iu">550</strong>T9】乘客的任意阈值。对于数据背后的虚构航空公司来说，这可能会为何时增加机队运力提供重要线索。</p><p id="b242" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于点预测方法，程序现在很简单:</p><ol class=""><li id="ce62" class="od oe it lt b lu mo lx mp ma of me og mi oh mm oi oj ok ol bi translated">拟合任意时间序列模型(这里我们将使用 SARIMAX (12，1，1，1)模型来捕捉趋势和年度季节性)。</li><li id="8c73" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">在足够长的时间范围内进行预测，以使时间序列超过给定的阈值。</li><li id="12cb" class="od oe it lt b lu om lx on ma oo me op mi oq mm oi oj ok ol bi translated">将预测第一次超过阈值的时间戳标记为您的击中时间。</li></ol><p id="06d8" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于<code class="fe ni nj nk nl b">statsmodels.tsa.sarimax.SARIMAX</code>，这看起来如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/68713c2371fa053d7e57e323a6a9f961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C28PQzgbSGjfqZ7gum3WKg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">C&gt;=550 的点预测和各自的预测击中时间。(图片由作者提供)</p></figure><p id="8b53" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">事后来看样本集，我们发现我们的击中时间预测晚了一年。在现实世界的应用程序中，迟到一年可能会对您的业务案例造成不利影响。</p><p id="34de" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">正如我们将看到的，概率变量给出了一个更完整的图像。不幸的是，我们不能以封闭的形式计算各自的概率质量函数。</p><h2 id="c306" class="nr la it bd lb ns nt dn lf nu nv dp lj ma nw nx ll me ny nz ln mi oa ob lp oc bi translated">命中时间概率的蒙特卡罗估计</h2><p id="5037" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">幸运的是，<code class="fe ni nj nk nl b">statsmodels</code> ' SARIMAX 提供了均值和标准差预测。由于预测分布是高斯分布，我们可以使用这个知识进行<a class="ae ky" href="https://en.wikipedia.org/wiki/Monte_Carlo_method" rel="noopener ugc nofollow" target="_blank">蒙特卡罗模拟</a>。从那里，我们可以估计每个月成为<code class="fe ni nj nk nl b">C=550</code>的命中时间的概率:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/ee2f2066db2f5b8ef680ca59843a88cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mVNa-RCwFSrvgnqhxwEwQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">击中次数(C&gt;=550)的概率质量函数(蒙特卡罗估计)。(图片由作者提供)</p></figure><p id="8b29" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这个看起来好多了。我们的模型预测，时间序列将最有可能在预测点预测前一年超过阈值。事后的数据也更加符合这一预测。</p><p id="5a8e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">此外，我们还看到，预测击中时间点(红线)也不是概率变量的期望值(紫线)。这是很重要的，因为实际时间序列的点预测实际上是概率预测的平均值。</p><p id="f437" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">然而，由于 SARIMAX 的潜在动力，这并不能转化为平均击球时间。</p><p id="ddde" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">最后，让我们看看我们的质量函数估计的累积分布函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/b78efefbca09b236d9fc62bf7260c9f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FF-T2HAV0MNzqK1WbHtnDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">击中时间概率的累积分布函数(蒙特卡罗估计)。(图片由作者提供)</p></figure><p id="717d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在这里，超过阈值的概率在第二年已经超过 60%，而不是第三年。点预报打击时间不合适的另一个原因。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="84ad" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">结论</h1><p id="c71f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">虽然使用点预测通常更方便，但在某些情况下，这种复杂性降低可能会太多。即使在这个相当简单的例子中,“简单”方法也已经落后一年了。</p><p id="3c87" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">当然，你特殊的击球时间问题可能会让你走上直路。但是，请记住，您只能在事后判断预测的质量。到那时，再转向上面讨论的更复杂但也更全面的方法显然为时已晚。</p><p id="87e7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">最终，概率性预测总是可以简化为单点预测。反之亦然，不幸的是事实并非如此。就我个人而言，我非常推荐概率路线，因为它还有许多其他优点。</p><p id="3843" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在以后的文章中，我计划提供更多关于其他优势的见解。如果您感兴趣，请随时订阅，以便在那时收到通知。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="916b" class="kz la it bd lb lc na le lf lg nb li lj jz nc ka ll kc nd kd ln kf ne kg lp lq bi translated">参考</h1><p id="c236" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">【1】</strong>Bas，Esra。<em class="mn">概率和随机过程基础</em>。斯普林格国际出版公司，2019 年。</p><p id="f706" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu">【2】</strong>汉密尔顿，詹姆斯·道格拉斯。<em class="mn">时间序列分析</em>。普林斯顿大学出版社，2020 年。</p><p id="9c12" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">Hyndman，Rob J .和 George Athanasopoulos。<em class="mn">预测:原理与实践</em>。OTexts，2018。</p><p id="e225" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu">数据集:</strong><a class="ae ky" href="https://www.kaggle.com/datasets/rakannimer/air-passengers" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/datasets/rakannimer/air-passengers</a>(在开放数据库许可证(ODbL) 1.0 下许可)</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="2af3" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><em class="mn">原载于 2022 年 12 月 6 日 https://www.sarem-seitz.com</em><em class="mn">的</em> <a class="ae ky" href="https://www.sarem-seitz.com/why-i-prefer-probabilistic-forecasts-hitting-time-probabilities/" rel="noopener ugc nofollow" target="_blank"> <em class="mn">。</em></a></p></div></div>    
</body>
</html>