<html>
<head>
<title>How to control colors with DAX Expressions in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Power BI 中使用 DAX 表达式控制颜色</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-control-colors-with-dax-expressions-in-power-bi-ef7e5c767eff#2022-12-06">https://towardsdatascience.com/how-to-control-colors-with-dax-expressions-in-power-bi-ef7e5c767eff#2022-12-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1ec9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们现在可以添加长期视觉效果的着色规则。但是，我们如何使用 DAX 表达式来控制这些颜色，并试图遵循 IBCS 规则呢？</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/42ee2e4f78c8643b26e3ec04d21d3e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9yxJ8mbNTgQLGW2o"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">Firmbee.com 在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kz" href="https://unsplash.com/@firmbee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">的照片</a></p></figure><h1 id="d84f" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">介绍</h1><p id="ce29" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">几周前，我发表了一篇关于信息设计的文章:</p><div class="mo mp gp gr mq mr"><a href="https://medium.com/cloud-workers/three-simple-rules-for-information-design-52db54864b47" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">信息设计的三个简单规则</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">我们知道那些花哨多彩的报道。现在，让我们探讨一下为什么这些都是不好的例子，以及我们如何能做得更好。</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf kt mr"/></div></div></a></div><p id="11b2" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">概括一下:</p><p id="f99d" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">IBCS 是一家为信息设计创造了一套规则的公司。</p><p id="740e" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">IBCS 帮助我们利用其规则来改进我们的报道。</p><p id="122b" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我把原来的 8 条成功法则浓缩成了 3 条简单易用的法则:</p><p id="ade0" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">1.你的信息是什么？</p><p id="e04c" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">2.使用一致的符号。</p><p id="6799" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">3.去掉不必要的东西。</p><p id="dc4f" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">信息设计的一个重要原则是在我们的报告中避免不必要的颜色。</p><p id="a519" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">例如:</p><p id="1f0b" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">当您想要显示数据的时间序列时，您希望如下图所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nl"><img src="../Images/89a675a37c57c822cf54b9faed40d9c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*df--K8kJVM3QNvWeUFWC-A.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 1 —时间序列的示例报告(作者提供的图表)</p></figure><p id="310f" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">如您所见，每个周期有三种不同的填充颜色:</p><ol class=""><li id="77d4" class="nm nn it lu b lv ng ly nh mb no mf np mj nq mn nr ns nt nu bi translated">实际周期是黑色的</li><li id="70f5" class="nm nn it lu b lv nv ly nw mb nx mf ny mj nz mn nr ns nt nu bi translated">所有过去的时期都是灰色的</li><li id="0a03" class="nm nn it lu b lv nv ly nw mb nx mf ny mj nz mn nr ns nt nu bi translated">所有未来期间都有对角线条纹</li></ol><p id="7eaf" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">这样做的原因是为了让用户容易发现实际数字，并能够快速区分过去和预测数据。</p><p id="73c4" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">不幸的是，我们不能在 Power BI 中为列视觉使用对角线条纹。</p><p id="1aa8" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">但是我们可以使用 DAX 来检测周期，并根据该列相对于实际周期的位置来选择颜色。</p><h1 id="81fd" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">准备</h1><p id="8d82" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">为了能够实现如下所示的解决方案，您需要一个包含两个附加列的日期表:</p><ul class=""><li id="ddf0" class="nm nn it lu b lv ng ly nh mb no mf np mj nq mn oa ns nt nu bi translated">年度指数</li><li id="4586" class="nm nn it lu b lv nv ly nw mb nx mf ny mj nz mn oa ns nt nu bi translated">蒙特辛德克斯</li></ul><p id="9248" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我在关于 Power BI 和 DAX 的第一篇文章中提到了这些专栏:</p><div class="mo mp gp gr mq mr"><a rel="noopener follow" target="_blank" href="/3-ways-to-improve-your-reporting-with-an-expanded-date-table-2d983d76cced"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">使用扩展的日期表格改进报告的 3 种方法</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">时间是最重要的报道维度。您可以使用一个好的日期表来扩展您的报告功能。</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="ob l nc nd ne na nf kt mr"/></div></div></a></div><p id="8313" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">此列计算从实际日期开始的周期数。</p><p id="ef5a" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">实际日期(<a class="ae kz" href="https://dax.guide/now/" rel="noopener ugc nofollow" target="_blank"> Now() </a>)在报告中的数据刷新期间进行评估。</p><p id="beb8" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">您可以在 DAX 日期表中使用以下表达式来添加这些列:</p><ul class=""><li id="a388" class="nm nn it lu b lv ng ly nh mb no mf np mj nq mn oa ns nt nu bi translated">" MonthIndex "，DATEDIFF(EOMONTH(Now()，0)，EOMONTH([Date]，0)，MONTH)</li><li id="5f07" class="nm nn it lu b lv nv ly nw mb nx mf ny mj nz mn oa ns nt nu bi translated">“YearIndex”，YEAR([Date]) — YEAR(Now())</li></ul><p id="40a1" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">如果使用存储在源系统中的日期表，可以在那里添加这些列。</p><p id="8a9f" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">在 SQL Server 中，可以使用以下语句设置这些列的值(变量@Today 包含语句à GETDATE()的执行日期):</p><pre class="kk kl km kn gt oc od oe bn of og bi"><span id="2ceb" class="oh lb it od b be oi oj l ok ol">UPDATE [dbo].[Date]<br/>SET [YearIndex] = DATEDIFF(yyyy, @Today, [Date]);<br/><br/>UPDATE [dbo].[Date]<br/>SET [MonthIndex] = DATEDIFF(mm, @Today, [Date]);</span></pre><p id="386c" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated"><strong class="lu iu">重要提示:</strong>以下示例中的数据有一个日期表，实际日期设置为 2012 年 3 月 9 日。</p><h1 id="f78d" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">Power BI 中的颜色</h1><p id="8abc" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们可以通过两种不同的方式在 DAX 表达式中使用颜色名称:</p><p id="0f1e" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">1.我们将鼠标悬停在 Power BI 中的调色板上，并写入颜色名称。<br/>例如:</p><p id="8481" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">a.黑色</p><p id="a2bb" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">b.灰色</p><p id="0a85" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">c.浅灰色</p><p id="e430" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">d.红色</p><p id="d399" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">e.蓝色</p><p id="e97d" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">2.或者，我们可以单击“更多颜色…”，选择一种颜色并记下该颜色的十六进制值。<br/>例如:</p><p id="b447" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">a.#000000 黑色</p><p id="6754" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">b.#FFFFFF à白色</p><p id="89ec" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">c.#DCDCDC à浅灰色</p><p id="ad86" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">d.#FF0000 红色</p><p id="6909" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">e.# 0000FF 蓝色</p><p id="b749" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">有了这些信息，我们可以创建 DAX 度量，它返回颜色名称或颜色代码。</p><h1 id="359c" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">概念验证</h1><p id="50c0" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">现在，我们想看看它是如何工作的。</p><p id="bae3" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我们创建一个柱形图，其中一个度量值和日历层次结构被分配给 X 轴。</p><p id="cd83" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">作为默认颜色，我们看到我们的列是蓝色的。但是我们想把这个换成灰色。</p><p id="40b6" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">第一步是创建一个固定颜色的基本测量:</p><pre class="kk kl km kn gt oc od oe bn of og bi"><span id="1d10" class="oh lb it od b be oi oj l ok ol">Dynamic Color PoC = "Grey"</span></pre><p id="45b5" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">然后，我们将此度量作为表达式分配给列:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi om"><img src="../Images/018b2cb5d1cb444aa7113ae5ef3ddd2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_TLXX6oEyG2jISCg2-bJw.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 2 —第一次测试(作者提供的图)</p></figure><p id="d77d" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">结果看起来像这样:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi on"><img src="../Images/e3cc877bf294e1a1530e3be89b9d993d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHwyPBLuIEY7Wh9VmEDeOQ.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 3 —第一次测试的结果(作者提供的数据)</p></figure><p id="8e30" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">如果我们将测量值更改为以下值:</p><pre class="kk kl km kn gt oc od oe bn of og bi"><span id="531d" class="oh lb it od b be oi oj l ok ol">Dynamic Color PoC = "Red"</span></pre><p id="7152" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我们得到以下结果:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi on"><img src="../Images/d7674e932a8cd46071c2e3a2edab8305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJArPSUAZQx3GKUCStYbpQ.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 4 —红色测试(作者提供的图片)</p></figure><p id="1f11" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">现在，我们知道了如何给柱形图分配颜色。</p><p id="7d5e" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我们可以进入下一步，给年份分配动态颜色。</p><h1 id="d681" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">控制每年的颜色</h1><p id="5c5f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我将通过每个步骤来构建解决方案。这样，你就很容易理解为什么这个解决方案会有效。</p><p id="568b" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">第一步是创建一个度量，看看如何使用日期表中的 YearIndex 列:</p><pre class="kk kl km kn gt oc od oe bn of og bi"><span id="6e50" class="oh lb it od b be oi oj l oo ol">Dynamic Colors =<br/>VAR ActualYearIndex = SELECTEDVALUE('Date'[YearIndex])<br/><br/>RETURN<br/>   ActualYearIndex</span></pre><p id="e38a" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">为了检查结果，我们向报告中添加了一个带有日期层次结构和两个度量值(带有要显示的值的度量值和新的动态颜色度量值)的矩阵。</p><p id="d626" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">结果显示在矩阵中，如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi op"><img src="../Images/6343f02abde5f96eac5277c9ab9d60ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*_QWKc02UVJfPdulBaMJ3Gw.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 5 —动态颜色测量，步骤 1(作者提供的图片)</p></figure><p id="4f61" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">如您所见，2021 年的 YearIndex 为 0，前一年为负数。下一年是正数。</p><p id="9a62" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">第二步是使用这个结果根据 YearIndex 设置颜色。</p><p id="a919" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">为了实现这一点，我们将动态颜色度量扩展为以下表达式:</p><pre class="kk kl km kn gt oc od oe bn of og bi"><span id="3ba1" class="oh lb it od b be oi oj l oo ol">Dynamic Color =<br/>VAR ActualYearIndex = SELECTEDVALUE('Date'[YearIndex])<br/>VAR YearColor = <br/>    SWITCH(TRUE<br/>          ,ActualYearIndex &lt; 0, "Grey"<br/>          ,ActualYearIndex = 0, "Black"<br/>          ,ActualYearIndex &gt; 0, "LightGrey"<br/>          )<br/><br/>RETURN<br/>    YearColor</span></pre><p id="1ca7" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">如您所见，我们使用<a class="ae kz" href="https://dax.guide/switch/" rel="noopener ugc nofollow" target="_blank">开关()</a>函数为每个 YearIndex 值分配一种颜色。</p><p id="d220" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">矩阵中的结果如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/b1000946b32941c1e63f274417de3c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*kY7hxk1Y0S5yRTdF7WWTZA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 6 —每年颜色矩阵(作者提供的图)</p></figure><p id="3396" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">柱形图中的结果如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi or"><img src="../Images/efa4450c791518c991671e4c874f2a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dbz8BoP5IiT3HL8SMZbxgA.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 7 —每年动态颜色的柱形图(由作者提供)</p></figure><p id="7e63" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">这是一个(几乎)完美的起点。</p><p id="ad45" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">但是当我们深入到月份级别时会发生什么呢？</p><p id="fb56" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">在这种情况下，颜色将继承与年份相同的颜色。</p><p id="bd95" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">但对于 2021 年，我们将在月份级别看到相同的配色方案。</p><p id="8a22" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我们希望三月是黑色，三月之前的几个月是灰色，三月之后的几个月都是浅灰色。</p><h1 id="6bfc" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">添加月份</h1><p id="cf8e" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">要将相同的动态逻辑添加到月级别，我们可以扩展现有逻辑来编写以下度量:</p><pre class="kk kl km kn gt oc od oe bn of og bi"><span id="a9b4" class="oh lb it od b be oi oj l oo ol">Dynamic Color =<br/>    VAR ActualYearIndex = SELECTEDVALUE('Date'[YearIndex])<br/>    VAR ActualMonthIndex = <br/>        IF( HASONEVALUE('Date'[MonthIndex])<br/>                        ,SELECTEDVALUE('Date'[MonthIndex])<br/>                        ,99<br/>                        )<br/>VAR YearColor =<br/>    SWITCH(TRUE<br/>            ,ActualYearIndex &lt; 0, "Grey"<br/>            ,ActualYearIndex = 0, "Black"<br/>            ,ActualYearIndex &gt; 0, "LightGrey"<br/>            )<br/><br/>VAR MonthColor =<br/>    SWITCH(TRUE<br/>            ,ActualMonthIndex &lt; 0, "Grey"<br/>            ,ActualMonthIndex = 0, "Black"<br/>            ,ActualMonthIndex &gt; 0, "LightGrey"<br/>            )<br/><br/>RETURN<br/>    IF(ActualMonthIndex = 99<br/>        ,YearColor<br/>        ,MonthColor)</span></pre><p id="2268" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">这里的关键是我们如何评估 ActualMonthIndex。</p><p id="6ee2" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我们使用<a class="ae kz" href="https://dax.guide/hasonevalue/" rel="noopener ugc nofollow" target="_blank"> HASONEVALUE() </a>函数来检查当前过滤上下文是只包含一个月还是包含多个月。</p><p id="57ec" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">在年份级别，此函数将返回 FALSE，因为实际筛选器上下文中包含多个值。</p><p id="e1af" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">在月级别，筛选器上下文只包含一个值。因此，该函数将返回 TRUE。</p><p id="59e7" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">剩余的测量使用相同的逻辑，但是两次。</p><p id="6884" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">月级别的柱形图如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi os"><img src="../Images/469ac9914af493f76bba4c03af8b7776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ensp6GMhfgfn0Y7JTEu7ow.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 8 —每月动态颜色的柱形图(由作者提供)</p></figure><p id="d361" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">当然，你可以使用除了黑色和灰色以外的颜色。</p><p id="ab34" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">但是考虑到有些用户不能区分那么多颜色。例如，请看下图:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/357285c428dd5b215d5235b44ac7c0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*9ZkgHq2a9MsjWi4U-PgnCw.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">图 9 —彩色和黑白(作者提供的图片)</p></figure><p id="6ceb" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">这里我添加了两个红色和绿色的矩形。<br/>然后我复制了这些矩形，并把它们转换成黑白图片。</p><p id="022b" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">如你所见，两个灰色矩形之间的差异不再那么大。</p><p id="9b1d" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">在为报表选择颜色时，您必须考虑这些影响。</p><h1 id="bb8a" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">结论</h1><p id="fb20" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">设计报告时，信息设计是一个重要因素。</p><p id="08f7" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我们需要避免陷入在报告中使用过多颜色的陷阱。</p><p id="fb58" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">权力 BI 诱惑我们使用太多的颜色，但我们需要知道我们在做什么。</p><p id="ff4d" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">例如，文章<a class="ae kz" href="https://learn.microsoft.com/en-us/power-bi/create-reports/desktop-report-themes" rel="noopener ugc nofollow" target="_blank">在 Power BI 桌面中使用报表主题— Power BI |微软学习</a>教你如何在 Power BI 中使用主题。</p><p id="86c0" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">但是即使是色盲主题也使用了很多不同的颜色。</p><p id="5080" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">然后，当你看到<a class="ae kz" href="https://learn.microsoft.com/en-us/power-bi/create-reports/desktop-report-themes#custom-report-theme-files-you-can-use-right-now" rel="noopener ugc nofollow" target="_blank">可下载的自定义主题</a>时，情况变得更糟。</p><p id="7f84" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">更不用说 YouTube 上的视频了，比如这个:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="704c" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">他开始做得很好，但是后来他用了那么多颜色，完全走错了方向。</p><p id="9f38" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">当我们将这个视频中的最终报告转换为黑白时，结果非常暗，尽管数据的对比度仍然可以。但是不同的酒吧不容易发现。</p><p id="eec3" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">请记住，典型的商业用户并不关心颜色，只要数据准确且易于使用。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ow"><img src="../Images/f2973fb5dcae1ad14921adb52ab7b030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9bNIdDSQTcOqQZZq"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@helloimnik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">你好我是 Nik </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="9fa1" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">参考</h1><p id="dfa8" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><a class="ae kz" href="https://www.ibcs.com/" rel="noopener ugc nofollow" target="_blank"> IBCS —国际商务交流标准</a>—IBCS 规则的网站，提供该规则手册的在线版本。</p><p id="ed2c" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我使用 Contoso 样本数据集，就像我以前的文章一样。你可以从微软<a class="ae kz" href="https://www.microsoft.com/en-us/download/details.aspx?id=18279" rel="noopener ugc nofollow" target="_blank">这里</a>免费下载 ContosoRetailDW 数据集。</p><p id="1521" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">Contoso 的数据可以在麻省理工学院的许可下自由使用，正如这里的<a class="ae kz" href="https://github.com/microsoft/Power-BI-Embedded-Contoso-Sales-Demo" rel="noopener ugc nofollow" target="_blank">所描述的</a>。</p><p id="5795" class="pw-post-body-paragraph ls lt it lu b lv ng ju lx ly nh jx ma mb ni md me mf nj mh mi mj nk ml mm mn im bi translated">我扩大了数据集，使 DAX 引擎工作更努力。<br/>在线销售表包含 7100 万行(而不是 1260 万行)，零售表包含 1850 万行(而不是 340 万行)。</p><div class="mo mp gp gr mq mr"><a href="https://medium.com/@salvatorecagliari/membership" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd iu gy z fp mw fr fs mx fu fw is bi translated">通过我的推荐链接加入 Medium-Salvatore Cagliari</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">阅读萨尔瓦托勒·卡利亚里的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="ox l nc nd ne na nf kt mr"/></div></div></a></div></div></div>    
</body>
</html>