<html>
<head>
<title>Boost Your Time Series Forecasts Combining Gradient Boosting Models with Prophet Features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将梯度增强模型与Prophet特征相结合，增强时间序列预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/boost-your-time-series-forecasts-combining-gradient-boosting-models-with-prophet-features-8e738234ffd#2022-04-07">https://towardsdatascience.com/boost-your-time-series-forecasts-combining-gradient-boosting-models-with-prophet-features-8e738234ffd#2022-04-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="eea2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用具有Prophet功能的LightGBM模型实现最先进的结果</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/018da01d4c32c1e2810f3a3ada89f483.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*734555kYf938OtHe"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">艾萨克·史密斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="74a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我的上一篇帖子中，我写了关于机器学习的时间序列预测。我重点解释了如何使用基于机器学习的方法进行时间序列预测，并取得良好的结果。这篇文章将使用更先进的技术来预测时间序列，并试图超越我在上一篇文章中创建的模型。如果你没有读过我之前的文章，我建议你读一读，因为这将是我之前模型的一个迭代。一如既往，你会在这个<a class="ae kv" href="https://github.com/unaiLopez/towards-data-science-posts-notebooks/blob/master/time%20series/Bike%20Sharing%20Demand%20Prediction%20Prophet%20%2B%20LightGBM.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a>中找到这个新帖子的代码。</p><h2 id="357b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">以前的帖子</h2><div class="ml mm gp gr mn mo"><a rel="noopener follow" target="_blank" href="/time-series-forecasting-with-machine-learning-b3072a5b44ba"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">基于监督机器学习的时间序列预测</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">使用监督机器学习模型的时间序列分析和预测</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc kp mo"/></div></div></a></div><h1 id="949b" class="nd lt iq bd lu ne nf ng lx nh ni nj ma jw nk jx md jz nl ka mg kc nm kd mj nn bi translated">新方法</h1><p id="d54a" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">除了前一篇文章中的所有特征工程，我们将使用Prophet提取新的有意义的特征，如季节性、置信区间、趋势等。</p><h2 id="d93c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">特征工程</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/c30b258ee7814e0de5b376e329ed430c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbN2ZcrKz7GHasi3WLTlsw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://docs.google.com/drawings/d/15XrdnvNu4gaY6-7N9z_K4sfhjO2ThRc1PrU60KKv-EA/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">特征工程图</a></p></figure><h2 id="05cd" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">时间数列预测法</h2><p id="2828" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">在我的上一篇文章中，我使用了一个具有一些滞后功能的LightGBM模型来预测未来7天某个城市的每小时自行车共享需求，效果非常好。然而，如果我们使用Prophet从我们的时间序列中提取新的特征，结果可以得到改善。其中一些特征是Prophet模型的实际预测、置信区间的上限和下限、每日和每周的季节性和趋势。对于其他类型的问题，Prophet也可以帮助我们提取描述节日效应的特征。</p><h2 id="bbd8" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">原始数据</h2><p id="f998" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">在本帖中，我们将重复使用之前LightGBM预测文章中使用的数据。我们的数据看起来像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/112ea4dda84c2abd89976f57a83c8328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k8-pR5lGMULihD8f.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">前一篇文章的丰富数据集</p></figure><h2 id="d49c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">用Prophet提取特征</h2><p id="3fed" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">我们特征工程的第一步非常简单。我们只需要像这样使用先知模型进行预测:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7af4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该函数将为我们返回一个数据框架，其中包含许多LightGBM模型的新特性:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/0be83d5b88a73b57dc4ef7e9a7320c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xTCXdjAGCtNAd7XnPdsoGw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Prophet显示了从第1列到第11列的数据帧</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/1874c7e23031c59721fe030b71dbdd25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IB1tej3qv8JxpEM_zGB7Lw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Prophet显示了从第11列到第20列的数据帧</p></figure><h2 id="ba18" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">具有Prophet功能的列车自动制动灯GBM</h2><p id="0dfc" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">一旦我们使用Prophet提取了新的特征，就该将我们的第一个数据框架与新的Prophet数据框架合并，并使用LightGBM进行一些滞后的预测。为此，我实现了一个非常简单的函数来处理所有的过程:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="4e20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦我们执行了上面的代码，我们将合并特征数据帧，创建滞后值，创建并训练LightGBM模型，使用我们训练的模型进行预测，并显示一个将我们的预测与实际情况进行比较的图。输出将如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/af8e4fc98eb00b50c7707e3f220a85ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znvzH2wS4F0FDFCXleUYjw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">具有滞后和先知特征的模型预测</p></figure><p id="e569" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">哇！如果我们仔细观察结果，我们可以将之前帖子中的最佳模型提高14%。在我们之前的帖子中，具有最佳功能工程的最佳LightGBM模型获得了32.736的MAE，现在我们获得了28.665的MAE。考虑到前一篇文章中的模型和特性工程已经切中要害，这是一个巨大的进步。</p><h1 id="cd26" class="nd lt iq bd lu ne nf ng lx nh ni nj ma jw nk jx md jz nl ka mg kc nm kd mj nn bi translated">结论</h1><p id="026b" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">正如我们在这篇文章中看到的，将监督机器学习方法与Prophet等统计方法结合起来，可以帮助我们取得非常令人印象深刻的结果。根据我在现实世界项目中的经验，在需求预测问题中很难得到比这些更好的结果。</p><h1 id="c8cf" class="nd lt iq bd lu ne nf ng lx nh ni nj ma jw nk jx md jz nl ka mg kc nm kd mj nn bi translated">参考</h1><div class="ml mm gp gr mn mo"><a href="https://facebook.github.io/prophet/docs/quick_start.html" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">快速启动</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">Prophet遵循sklearn模型API。我们创建一个Prophet类的实例，然后调用它的fit和predict…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">facebook.github.io</p></div></div><div class="mx l"><div class="nz l mz na nb mx nc kp mo"/></div></div></a></div><div class="ml mm gp gr mn mo"><a href="https://lightgbm.readthedocs.io/en/latest/" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd ir gy z fp mt fr fs mu fu fw ip bi translated">欢迎阅读LightGBM的文档！-light GBM 3.3.2.99文档</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">编辑描述</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">lightgbm.readthedocs.io</p></div></div></div></a></div></div></div>    
</body>
</html>