<html>
<head>
<title>Indoor Robot Localization with SLAM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于SLAM的室内机器人定位</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/indoor-robot-localization-with-slam-f8b447bcb865#2022-02-21">https://towardsdatascience.com/indoor-robot-localization-with-slam-f8b447bcb865#2022-02-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4227" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">在Raspberry Pi上使用RP LIDAR A1进行同步定位和制图(SLAM)导航，并使用MQTT进行远程“点云”可视化</em></h2></div><p id="c995" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在工厂或酒店，机器人越来越多地取代了人类。但是在不了解环境的情况下<strong class="ki ir">机器人如何在室内</strong>动态导航<strong class="ki ir"> </strong>？如果你已经有一张地图，那么你就知道你在哪里。否则，你需要<strong class="ki ir">生成地图(制图)，还要了解你在地图上的位置(定位)。想象一下，即使对一个人来说，在一个陌生的地方，这有多难。</strong></p><p id="2f99" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir"> SLAM(同步定位和地图绘制)</strong> <strong class="ki ir">算法使用LiDAR和IMU数据在</strong><strong class="ki ir"/><strong class="ki ir">中同时定位机器人，并生成周围</strong> <strong class="ki ir">地标</strong>的连贯地图，如建筑物、树木、岩石和其他世界特征，同时<strong class="ki ir">。</strong></p><p id="aedb" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">这个经典的<em class="lc">先有鸡还是先有蛋的问题</em>已经使用<strong class="ki ir">粒子滤波、扩展卡尔曼滤波(EKF)、协方差交叉和图形SLAM等方法近似解决了。</strong> SLAM可在GPS定位不可用的地方(如室内空间)实现精确测绘。</p><p id="f702" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">因此，<strong class="ki ir"> SLAM是用于自动驾驶汽车、机器人导航、</strong>机器人地图、虚拟现实和增强现实的核心算法。如果我们可以在RPi上进行机器人定位，那么就很容易制造出可以在室内自主行驶的移动汽车或步行机器人。</p><p id="89e3" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">首先来讨论一下<strong class="ki ir"> Graph SLAM </strong>做一个<strong class="ki ir">自定义实现。</strong>然后<strong class="ki ir">我们将尝试将RPi与RPLidar A1 M8集成，使用5V 3A电池运行，并与</strong> <strong class="ki ir">激光雷达点云地图</strong>的可视化一起进行SLAM，以辅助导航甚至生成楼层地图。最后使用MQTT将<strong class="ki ir">激光雷达点云地图</strong> <strong class="ki ir">在远程机器上可视化。</strong></p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="li lj l"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated"><strong class="ak">项目演示:</strong>与RPi集成的RPLidar A1部署了BreezySLAM</p></figure><h1 id="0402" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">图表猛击</h1><p id="20cb" class="pw-post-body-paragraph kg kh iq ki b kj mg jr kl km mh ju ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">假设2D世界中的一个机器人，试图从x向右移动10个单位到x’。由于运动不确定性，x' = x + 10可能不成立，但<strong class="ki ir">它将以x + 10为中心呈高斯分布。</strong>当x’接近x + 10时，高斯将达到峰值</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/941687793856600ec3675918e102e14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nczgaYsvE40F0_qP"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">图片由作者提供:机器人从x0到x1到x2的运动由两个高斯函数表征</p></figure><p id="0136" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如果x1与x0相差10个单位，卡尔曼滤波器将使用高斯函数(x1–x0–10)对不确定性进行建模。因此，仍然存在与位置&lt; 10 and &gt; 10相关联的概率。</p><p id="eec4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在x2处有另一个相似的高斯分布，具有更高的扩散。<strong class="ki ir">整条路线的总概率是两个高斯</strong>的乘积。我们可以去掉常数，因为我们只需要在给定x0的情况下，最大化位置x1的可能性。因此<strong class="ki ir">高斯的乘积变成了指数项的和</strong>，即约束只有x和sigma。</p><p id="ca87" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir"> Graph SLAM将约束条件建模为线性方程组(SLEs) </strong>，其中一个ω矩阵包含变量系数，一个ξ向量包含约束条件的极限值。<strong class="ki ir">每次在两个姿势之间进行观察时，在4个矩阵元素</strong> <strong class="ki ir">上进行“局部相加”(因为高斯的乘积变成了指数的和)。</strong></p><p id="f479" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">比方说，机器人从x0移动到x1，再到x2，它们相距5和-4个单位。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/4843bbe6c612e3775dfbd2ede772d5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JDL95_AF-t8N9XAT"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">图片作者:奥米加矩阵和Xi向量经过2次运动</p></figure><p id="d973" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">x的系数和RHS值被加到相应的单元上。考虑地标L0距离x1 9个单位。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/3f67374578fac1ab3c6302c3aa764870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F2_t3hlKHUbUvT1B"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">图片由作者提供:奥米加矩阵和Xi向量在考虑了地标L1之后</p></figure><p id="8e2b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">如上填写ω矩阵和ξ向量后，计算下面的等式<strong class="ki ir">以获得所有机器人位置的最佳估计值:</strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/0615f9b0cd15019d0f869cde7c808aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/0*RykzZHJHNFWqSig_"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">估计机器人的位置</p></figure><h1 id="38a2" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">自定义实现:Graph SLAM</h1><p id="e534" class="pw-post-body-paragraph kg kh iq ki b kj mg jr kl km mh ju ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">您需要更新2Dω矩阵和ξ矢量中的值，以考虑x和y方向上的运动和测量约束。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mt lj l"/></div></figure><p id="0355" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">自定义SLAM 实现的<strong class="ki ir">完整源代码和结果可以在IPython笔记本<a class="ae mu" href="https://github.com/AdroitAnandAI/SLAM-on-Raspberry-Pi/blob/main/Custom_SLAM_Landmark_Detection_Tracking.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</strong></p><p id="adc9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们可以看到SLAM的实际应用，如果部署在配备RPLidar A1 M8的<strong class="ki ir"> RaspberryPi上，使用5V 3A电池运行。</strong>见下面组装好的小工具。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/763198de829b8779a102d8a3f1297383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/1*g1bqb9k5xQnLnr5zb2n0nw.gif"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">作者图片:SLAM组装设备</p></figure><p id="3003" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">正如您在顶部的视频中所看到的，<strong class="ki ir">便携式装置被带到我家的各个房间，实时轨迹被传输到MQTT服务器，并存储在RPi的SD卡</strong>上。</p><p id="7d9f" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">你可以看到<strong class="ki ir">激光雷达点云地图</strong>的可视化和使用<a class="ae mu" href="https://github.com/simondlevy/PyRoboViz" rel="noopener ugc nofollow" target="_blank"> PyRoboViz </a>估计的机器人轨迹，如下图。在上面的视频中，你可以看到我穿过地板上的不同房间。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/7d265aa9a345f970bb967ed813c58309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/1*jDlWVn6nsHJHF4-uwKee5A.gif"/></div></figure><p id="13a5" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">有趣的是，我们可以使用MQTT 为实时可视化<strong class="ki ir">将<strong class="ki ir">实时可视化重新路由到远程机器。</strong>机器人的位置、角度和地图可以编码为字节数组，由MQTT客户端解码。</strong></p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mt lj l"/></div></figure><p id="1460" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">请注意，激光雷达地图中的<strong class="ki ir">高密度线性点云</strong>代表稳定的障碍物，如墙壁。因此，我们可以使用像霍夫变换这样的<strong class="ki ir">算法在这些线性点云<strong class="ki ir">上找到最佳拟合线</strong>来生成楼层地图。</strong></p><p id="2674" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">从3D激光雷达点云中，我们甚至可以使用来自Motion 技术的<strong class="ki ir">结构来构建周围的3D地图，</strong></p><ul class=""><li id="8587" class="mx my iq ki b kj kk km kn kp mz kt na kx nb lb nc nd ne nf bi translated">使用<strong class="ki ir">检测器</strong>如SIFT、SURF、ORB、Harris来查找特征，如角落、渐变、边缘等。</li><li id="7430" class="mx my iq ki b kj ng km nh kp ni kt nj kx nk lb nc nd ne nf bi translated">使用<strong class="ki ir">描述符</strong>如HOG对这些特征进行编码。</li><li id="606b" class="mx my iq ki b kj ng km nh kp ni kt nj kx nk lb nc nd ne nf bi translated">使用<strong class="ki ir">匹配器</strong>如FLANN在图像间映射特征。</li><li id="077d" class="mx my iq ki b kj ng km nh kp ni kt nj kx nk lb nc nd ne nf bi translated">使用<strong class="ki ir"> 3D三角测量</strong>重建3D点云。</li></ul><p id="16e9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们可以利用SLAM室内导航的想法<strong class="ki ir">在封闭的环境中部署自主移动机器人</strong>如机场、仓库或工厂。</p><p id="5ad4" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">此解决方案的源代码可从<a class="ae mu" href="https://github.com/AdroitAnandAI/SLAM-on-Raspberry-Pi" rel="noopener ugc nofollow" target="_blank">这里</a>获得</p><p id="8d68" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir"> <em class="lc">如果您有任何疑问或建议，可以在这里</em> </strong> 联系我  <a class="ae mu" href="https://www.linkedin.com/in/ananduthaman/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki ir"> <em class="lc"/></strong></a></p><h1 id="207f" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">参考</h1><p id="5721" class="pw-post-body-paragraph kg kh iq ki b kj mg jr kl km mh ju ko kp mi kr ks kt mj kv kw kx mk kz la lb ij bi translated">1.<strong class="ki ir">轻松实现满贯:</strong><a class="ae mu" href="https://github.com/simondlevy/BreezySLAM" rel="noopener ugc nofollow" target="_blank">https://github.com/simondlevy/BreezySLAM</a></p><p id="8e3e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">注:</strong>已联系Breezy SLAM的作者，<strong class="ki ir">华盛顿和李大学CSE系【Simon D. Levy教授，了解可视化期间的激光雷达扫描数据错误。我已经<strong class="ki ir">通过将激光雷达扫描代码分离为单独的线程</strong>修复了代码，并实现了线程间通信<strong class="ki ir">他确认了修复。</strong></strong></p><p id="8728" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">2.【https://github.com/simondlevy/PyRoboViz】激光雷达点云可视化:<a class="ae mu" href="https://github.com/simondlevy/PyRoboViz" rel="noopener ugc nofollow" target="_blank"/></p><p id="1224" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">3.<strong class="ki ir"> Udacity计算机视觉纳米度:</strong><a class="ae mu" href="https://www.udacity.com/course/computer-vision-nanodegree--nd891" rel="noopener ugc nofollow" target="_blank">https://www.udacity.com/course/computer-vision-nanodegree-nd 891</a></p><p id="0ba9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">4.<strong class="ki ir">Adafruit的激光雷达数据扫描码存根:</strong><a class="ae mu" href="https://learn.adafruit.com/remote-iot-environmental-sensor/code" rel="noopener ugc nofollow" target="_blank">https://learn . Adafruit . com/remote-IOT-environmental-sensor/code</a></p><p id="134b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">5.<strong class="ki ir">激光雷达距离估计:</strong>【https://en.wikipedia.org/wiki/Lidar T2】</p><p id="0783" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">6.<strong class="ki ir"> RPLIDAR A1 M8硬件规格:</strong><a class="ae mu" href="https://www.generationrobots.com/media/rplidar-a1m8-360-degree-laser-scanner-development-kit-datasheet-1.pdf" rel="noopener ugc nofollow" target="_blank">https://www . generation robots . com/media/RP lidar-A1 M8-360度-激光-扫描仪-开发-套件-数据表-1.pdf </a></p></div></div>    
</body>
</html>