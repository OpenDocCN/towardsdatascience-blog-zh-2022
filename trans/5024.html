<html>
<head>
<title>Baby Steps to Quantum Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">量子机器学习的一小步</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/baby-steps-to-quantum-machine-learning-796715c19d32#2022-11-08">https://towardsdatascience.com/baby-steps-to-quantum-machine-learning-796715c19d32#2022-11-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9211" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解与量子机器学习相关的基本概念并训练虹膜数据集的混合模型</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cdd216f0a72cfb80936e8003f7b6b071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U4frHkomysNHcAKC"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">特里·维里斯迪斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="677e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">量子机器学习是科技领域的下一步。在本文中，我们将了解机器学习中量子所涉及的基本概念。然后，我们将了解如何使用Iris数据集训练具有Keras和Pennylane的多类混合分类器。<a class="ae kv" href="https://github.com/divyanshuraj6815/QUANTUM-ML/blob/main/Quantum_Machine_Learning_(Iris_Dataset).ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">代号</strong> </a></p><h2 id="154f" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak">基本概念</strong></h2><p id="076a" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">量子化学中的表示可以用下图来理解，假设有3个能级，每个能级有2个电子，一个电子将有向上的自旋，而另一个将有向下的自旋。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/0fcc775e9d40d6a16a7f6fadd08bd02d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWJd0_G70c3A3mc1nCHgug.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">量子化学，再现(图片由作者提供)</p></figure><p id="2e4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二张图中，一个电子在第一能级自旋向下，一个电子在第三能级自旋向上。</p><p id="56a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在量子机器学习中，我们利用这个概念并定义电路，其中我们有几个功能，例如为一个能级提供X、Y和Z轴上的旋转，在能级之间打结，分裂等。</p><h2 id="ebdc" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak"> Q节点:</strong></h2><p id="31a9" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">一个Q节点由一个电路和一个在其上执行该电路的设备组成。</p><p id="df33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">设备:</strong></p><p id="bcef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个可以使用的设备列表(<a class="ae kv" href="https://pennylane.ai/plugins.html" rel="noopener ugc nofollow" target="_blank">https://pennylane.ai/plugins.html</a>)。通常使用“默认量子位”。对于用于训练Iris数据的混合模型，我们将使用“strawberryfields.fock”设备。这些设备被用作插件，因此请确保插件已安装。对于strawberryfields，运行以下命令进行安装:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="3c98" class="ls lt iq ms b gy mw mx l my mz">pip install PennyLane<strong class="ms ir">-</strong>SF</span></pre><p id="a540" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来定义设备:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="b68f" class="ls lt iq ms b gy mw mx l my mz">dev <strong class="ms ir">=</strong> qml<strong class="ms ir">.</strong>device("default.qubit", wires<strong class="ms ir">=</strong>num_modes)</span></pre><p id="8c86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">电路:</strong></p><div class="kg kh ki kj gt ab cb"><figure class="na kk nb nc nd ne nf paragraph-image"><img src="../Images/25080738a68ed5f7f9ab1687e3adeceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*8_DsBtaC7D6jrjWha4CmYg.png"/></figure><figure class="na kk ng nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/2180a83a6048ec5762121568ef3f747e.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*l3hUbYZJC5fJTfXI7avOrw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk nh di ni nj translated">电路图(左)，等效代码(右)，图片作者</p></figure></div><p id="968f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们定义了左图中给出的电路。有2根线，0和1。如果我们把它看作一个时间序列，首先在电线1上有一个X，</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="1a67" class="ls lt iq ms b gy mw mx l my mz">qml.PauliX (wires = 1)</span></pre><p id="1d90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么从导线0到1有一个交叉点，</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="5a9f" class="ls lt iq ms b gy mw mx l my mz">qml.CNOT (wires = [1, 0])</span></pre><p id="e834" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后在0号线有一个θ角的旋转。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="6415" class="ls lt iq ms b gy mw mx l my mz">qml.RY (theta, wires = 0)</span></pre><p id="a2be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出Z也沿着Z轴从线1出来。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="2c19" class="ls lt iq ms b gy mw mx l my mz">qml.PauliZ (wires = 0)</span></pre><p id="3661" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们沿着Z轴返回期望值。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="8889" class="ls lt iq ms b gy mw mx l my mz">qml.expval ()</span></pre><p id="571d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们知道了器件和电路，我们可以很容易地通过装饰器定义一个Q节点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/3b7f676ead0bd55369798299fe527fb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fqcRFAZu9YwrglBc5ec0YA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">q节点(图片作者提供)</p></figure><p id="72bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们从-π到π改变角度，看看电路函数值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/1891f536d464081fcf17312d4fb10422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N8_wPorsL7osc_PFCflRCg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">电路(theta) v/s [-π，π](图片由作者提供)</p></figure><p id="47fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，当我们试图优化电路时，从机器学习的角度来看，我们试图找到可以实现最小值(即-1)的权重值。给定随机权重作为电路的输入。一般来说，我们不知道这个图看起来像什么，因此我们使用优化器。</p><p id="9a44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">An <strong class="ky ir"> ansatz </strong>是<strong class="ky ir">一个电路的基本架构，即一组作用于特定子系统</strong>的门。该架构通过固定可训练参数来定义变分电路可以实现哪些算法。电路ansatz类似于神经网络的架构</p><h2 id="0e0e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">混合模型</h2><p id="657f" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">现在，我们已经了解了基础知识，让我们来定义混合模型的架构:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/4032cb4640bbe5e2c0b688ea3810203f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6NdS6HWU2gPGTmIuDiPZYA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">高层混合架构(图片由作者提供)</p></figure><p id="67ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">密集层:</strong></p><p id="1d7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虹膜数据集有4个特征，作为输入。之后，我们有2个14通道的密集层，它们将被馈送到数据编码层或电路。通过直接不将特征馈送到量子电路并使用密集层，我们允许输入更加灵活，并且能够知道应该将什么输入提供给电路。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/d3b045c025b0f628f16ac24d7080877c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EOBPDutrB48dP_0dxhm8EA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">密集层(图片由作者提供)</p></figure><p id="c752" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">量子层:</strong></p><p id="5261" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们将14个通道编码为一个电路，然后每个通道通过一个量子神经网络，该网络由Keras和Pennylane库定义。对于电路，我们有2条线和14个输入。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/8cff66b68efa8d9cb5c7f7b8c8e98f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDb5TT-Jl7-vicJ2cjCVQg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据编码层(图片由作者提供)</p></figure><p id="e2a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来自数据编码层的输出被馈入下面定义的量子神经网络。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/05890a364555da14ad2537eae785ae7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlg5-QROT-04LpYhWJeZWA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">量子神经网络(图片作者提供)</p></figure><p id="fb73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">输出:</strong></p><p id="38c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出是一个16维向量。3用于输出标签，13用于填充0。当我们处理量子机器学习时，电路的输出不可能是标签总数的一次性编码。因此，我们需要为它定义一个自定义的独热编码函数，它的维数将大于类的数量。</p><p id="dd67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，如果有3个类，一键编码将有8个维度，3个用于实际类，其余5个用0填充。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/adcf35ac5fdcce27654d163738f5d5d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zab8wnNFvajNSBLwqnk6WQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">标签的一个热编码(作者图片)</p></figure><p id="8e67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">整体模型架构如下所示:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="6e35" class="ls lt iq ms b gy mw mx l my mz">_________________________________________________________________<br/> Layer (type)                Output Shape              Param #   <br/>=================================================================<br/> dense (Dense)               (None, 14)                70        <br/>                                                                 <br/> dense_1 (Dense)             (None, 14)                210       <br/>                                                                 <br/> keras_layer (KerasLayer)    (None, 4)                 56        <br/>                                                                 <br/>=================================================================<br/>Total params: 336<br/>Trainable params: 336<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><p id="df9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些是经过30个时期训练后的结果。</p><div class="kg kh ki kj gt ab cb"><figure class="na kk np nc nd ne nf paragraph-image"><img src="../Images/ac93862a419a0c035da64e29d9fd3282.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*_rw4MqnBpuzZbTTfsW9HnA.png"/></figure><figure class="na kk np nc nd ne nf paragraph-image"><img src="../Images/577c450874e26b1efe5ceaf973317ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*QZFjMYezOf1ovhQi0pxx0A.png"/></figure></div><div class="ab cb"><figure class="na kk np nc nd ne nf paragraph-image"><img src="../Images/f643d5831a3cdf507d092501580961fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*bSAl65vT-Yr4wCXGqHDFrQ.png"/></figure><figure class="na kk np nc nd ne nf paragraph-image"><img src="../Images/59ac771d704fcf5a30da6a70fa755831.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*m0BJpRu-X7TvWKKyAArICA.png"/><p class="kr ks gj gh gi kt ku bd b be z dk nq di nr nj translated">训练和验证分割的准确性和损失图(图片由作者提供)</p></figure></div><p id="5dba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文着重于理解量子神经网络的功能及其背后的概念。量子机器学习在计算和学习能力方面优于现在使用的传统机器学习方法。在未来的博客中，我会写更多关于传统数据集的用例，如MNIST、CIFAR10等。让我知道你对此的想法。</p><p id="c374" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考文献:</strong></p><p id="6b95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://pennylane.ai/qml/demonstrations.html" rel="noopener ugc nofollow" target="_blank"> Pennylane演示</a></p><p id="df09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://arxiv.org/pdf/1806.06871v1.pdf" rel="noopener ugc nofollow" target="_blank">连续变量量子神经网络</a></p></div></div>    
</body>
</html>