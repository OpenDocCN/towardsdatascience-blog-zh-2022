<html>
<head>
<title>CLIP and PASTE: Using AI to Create Photo Collages from Text Prompts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">剪辑和粘贴:使用人工智能从文本提示创建照片拼贴</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clip-and-paste-using-ai-to-create-modern-collages-from-text-prompts-38de46652827#2022-06-09">https://towardsdatascience.com/clip-and-paste-using-ai-to-create-modern-collages-from-text-prompts-38de46652827#2022-06-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d8c4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用ML模型从照片中提取物体并重新排列以创建现代艺术</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b1053da175ba494d4cd019d8977584fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4EDV_2NM0-6PosE4nfETg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">来自剪辑和粘贴的样本照片拼贴画</strong>，图片由作者提供</p></figure><p id="1ba6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我之前的许多<a class="ae lv" href="https://robgon.medium.com/list/creating-fine-art-with-gans-73476c209de3" rel="noopener">帖子</a>中，我展示了如何使用人工智能模型从文本提示中创建新的艺术作品。对于这些项目，我至少使用了两个人工智能模型，一个是生成式对抗网络(GAN)等生成器来创建图像，另一个是多模态语言/图像模型，如OpenAI的对比语言-图像预训练(CLIP) [1]来指导生成器。</p><p id="cfd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个项目，我想看看我是否可以让CLIP从文本提示中组装现代照片拼贴画，而不使用人工智能模型作为生成器。我构建了一个自定义的图像生成器，它组装图像的各个部分，并使用CLIP反复分析和调整拼贴中的各个部分。我称这个系统为“剪辑和粘贴”，其中第二个缩写代表通过编辑在语义上组合的图片。</p><p id="e187" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图显示了剪切和粘贴的重要组成部分。我将简要讨论这些元素，然后在接下来的部分中描述细节。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/3722bc6a2f375c0b6bafc1b8f3eb687f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UviQrA086xj9BTfjLUERxg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">剪贴组件图，</strong>作者图</p></figure><p id="006c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个过程从一个文本提示开始，就像“企鹅从雪山上滑下”系统使用Python关键短语提取库[2]来提取关键词。然后，它从Wikimedia Commons [3]和OpenImages [4]中搜索与提示中的关键字匹配的图像。我使用维基媒体搜索API来寻找可能匹配的图片。对于OpenImages，我使用剪辑文本编码器，通过比较关键字和描述的嵌入来找到最佳文本匹配。接下来，该系统从Wikimedia Commons和OpenImages下载前100张图像，并通过剪辑图像编码器运行它们，再次将它们与关键字进行比较。该系统通过GRoIE [5]图像分割模型运行顶部图像，以从照片中创建剪切部分。剪切部分通过剪辑重新运行，以找到与关键字最匹配的图像部分。我构建了一个定制的图像合成器，它可以将图片随机组合成多个照片拼贴。布局通过剪辑运行，以找到最好的一个。该系统通过使用Pytorch中的Adam优化器[6]迭代地分析和合成拼贴来调整图像部分的位置。经过100次迭代后，显示最终图像。</p><p id="8518" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在下面的章节中了解这个系统的细节。请务必查看附录中更多生成的照片拼贴。你也可以使用Google Colab <a class="ae lv" href="https://colab.research.google.com/github/robgon-art/CLIPandPASTE/blob/main/CLIP_and_PASTE.ipynb" rel="noopener ugc nofollow" target="_blank">在这里</a>创建自己的。</p><h1 id="48fb" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">背景</h1><p id="1f1e" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">制作照片拼贴的艺术，也称为照片蒙太奇，可以追溯到100多年前。</p><blockquote class="mu mv mw"><p id="79d5" class="kz la mx lb b lc ld ju le lf lg jx lh my lj lk ll mz ln lo lp na lr ls lt lu im bi translated">拼贴通常被认为是一种典型的现代艺术手法。这个词来自法语动词<em class="it"> coller </em>，意思是“粘着”,最早用于描述巴勃罗·毕加索和乔治·布拉克的立体派创新，他们于1912年开始将剪报和其他材料粘在画布上。故事是这样的，从那时起，艺术家们就开始用剪贴的方式将我们周围的世界在画布上进行意想不到的、变革性的组合。——塞缪尔·赖利，<a class="ae lv" href="https://www.economist.com/1843/2019/07/24/stick-em-up-a-surprising-history-of-collage" rel="noopener ugc nofollow" target="_blank">《经济学家》</a></p></blockquote><p id="f9bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一些早期照片拼贴的样本，从左上按时间顺序顺时针展示。</p><div class="kj kk kl km gt ab cb"><figure class="nb kn nc nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/d2576926185c60370d675b6c66cd2a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/0*qIW3CHJpoYwVthHT.jpg"/></div></figure><figure class="nb kn nh nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/818ad092e4bcc02765180988a27141e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/0*D7FqrEBJ85Pd68PJ.jpg"/></div></figure></div><div class="ab cb"><figure class="nb kn ni nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/434aa39039ee6a573efeeb2f1ba3d52e.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/0*AdbJdeGmP3uBrFCO.jpeg"/></div></figure><figure class="nb kn nj nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/824d10126bb0ae83d7800537efe19047.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/0*U9s22CwjzI0VCLID"/></div></figure><figure class="nb kn nk nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/1ff06b8aa306c1da90c68c5b29a107fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/0*SAqsiUes3V0L7QkB.jpg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk nl di nm nn translated">从左上顺时针方向，<strong class="bd ky">带广告的静物</strong>，1913年，巴勃罗·毕加索，<strong class="bd ky">玻璃杯和瓶子(皮草)</strong>，乔治·布拉克，1914年，<strong class="bd ky">用菜刀切开德国最后一个魏玛啤酒肚文化时代</strong>，1919年，汉娜·霍奇，<strong class="bd ky">女孩、运动员和小丑拼贴画</strong>，1925年，亚历山大·罗德钦科，<strong class="bd ky">艺术评论</strong>，1920年，拉乌尔·豪斯曼</p></figure></div><p id="7dac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到艺术形式是如何发展的，从用颜料和铅笔画将剪报粘贴在画布上，到仅仅通过安排照片的剪切来制作作品。</p><h1 id="c048" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">系统详细信息</h1><p id="9356" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">以下是对“剪切和粘贴”中使用的组件和过程的描述。</p><h2 id="8bfb" class="no ly it bd lz np nq dn md nr ns dp mh li nt nu mj lm nv nw ml lq nx ny mn nz bi translated">关键短语提取</h2><p id="953d" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">与过去的项目不同，我使用KeyBERT [7]从文本中提取关键词和短语，我改用一个叫做Python关键短语提取(PKE)的包。在对这两个软件包做了一点试验后，我发现PKE似乎做得更好。例如，PKE允许我指定关键字的词性(名词、形容词和动词。)</p><p id="3324" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是两个系统中从“企鹅从雪山上滑下”中提取的关键短语和分数的比较。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="44fa" class="no ly it ob b gy of og l oh oi"><strong class="ob iu">KeyBERT<br/></strong>penguins skiing snowy, 0.9217<br/>penguins skiing, 0.8879<br/>skiing snowy, 0.6593<br/>skiing snowy mountain, 0.643<br/>penguins, 0.6079</span><span id="4511" class="no ly it ob b gy oj og l oh oi"><strong class="ob iu">PKE</strong><br/>penguins skiing, 0.5<br/>snowy mountain, 0.5</span></pre><p id="b1a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管KeyBERT想出了更多的候选关键词，但其中一些，如“企鹅在雪地里滑雪”是无意义的。然而，PKE系统似乎用两个同等权重的关键词“企鹅滑雪”和“雪山”抓住了提示的要点</p><p id="0091" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里看到我用于关键短语提取的Python代码<a class="ae lv" href="https://gist.github.com/robgon-art/e559ef395deda86b6b7186f1111e4543" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="4b8b" class="no ly it bd lz np nq dn md nr ns dp mh li nt nu mj lm nv nw ml lq nx ny mn nz bi translated">查找源图像</h2><p id="6fae" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">正如我在概述中提到的，我从Wikimedia Commons和OpenImages数据集收集拼贴图像。这两个来源都在知识共享署名共享开源许可下发布它们的图像。</p><p id="4847" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在维基共享资源中搜索图片，我在https://commons.wikimedia.org/w/api.php使用了API。</p><p id="c892" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是设置搜索参数的Python代码。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="a744" class="no ly it ob b gy of og l oh oi">s = requests.Session()<br/>url = "https://commons.wikimedia.org/w/api.php"<br/>params = {<br/>"action": "query",<br/>"generator": "images",<br/>"prop": "imageinfo",<br/>"gimlimit": 500,<br/>"titles": keyphrases,<br/>"iiprop": "url|dimensions",<br/>"format": "json"<br/>}<br/>results = s.get(url=url, params=params)</span></pre><p id="2a93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当结果出来时，我根据它们的尺寸过滤图像。我保留尺寸为512x512或更大的图像。</p><p id="aa58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在OpenImages数据集中搜索图片，我使用剪辑文本编码器来比较关键短语的嵌入和数据集中描述的嵌入。如果你想了解更多关于这个过程的信息，你可以在我的文章中阅读关于搜索设计专利的细节<a class="ae lv" rel="noopener" target="_blank" href="/using-openais-clip-to-search-for-design-patents-7fcc63d91033">这里</a>。</p><p id="23d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我获得了图像集合，我就通过CLIP Image Encoder将它们与整个提示的嵌入进行比较。以下是来自维基共享和OpenImages的顶级照片。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/f6d31fd8d5bf9f3d29d7e448f68e4db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzPf2pTm-baDZEy7F_5d6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">来源图片</strong>来自维基共享和开放图片</p></figure><p id="3896" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">图像分割</strong></p><p id="06d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用了一个称为GRoIE的人工智能模型进行图像分割，GRoIE代表通用感兴趣区域提取器[5]。该系统是由意大利帕尔马大学的莱昂纳多·罗西等人开发的。给定输入图像，GRoIE将提取并标记任何可辨别的前景对象。对于找到的每个对象，它会创建一个定义对象形状的遮罩图像。</p><p id="0ae8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，GRoIE模型通常在每个输入图像中找到并提取不止一个对象。例如，在这张照片中，它发现并隔离了两只企鹅。</p><div class="kj kk kl km gt ab cb"><figure class="nb kn ol nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/e33b17be97edf46ab352c95f3666c185.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*wlD6ecJEfbvcVgCR90AnfQ.png"/></div></figure><figure class="nb kn om nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/0c0e438144924cfef861e610de172802.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*9yqLAyMoJnejORX-whg1NA.png"/></div></figure><figure class="nb kn om nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ee1900c9a5142f06a895b79b4ea55af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8DLgQyfm8JnvPllUK4qkpA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk on di oo nn translated"><strong class="bd ky">使用GRoIE进行多对象提取</strong>，图片由作者提供</p></figure></div><p id="a60a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我提取了所有的对象之后，我再次运行CLIP来比较图像嵌入和来自提示的嵌入。原始图像在上面，提取的图像在下面。这些是从排名前五的图片中剪下的物品。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/e87432ad5558976e368b313dc02c996c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ZS8V1LDTBln4vb34d8JdQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">使用GRoIE </strong>进行图像分割，图像由作者提供</p></figure><p id="3d06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">创建背景颜色渐变</strong></p><p id="3a9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我可以用纯色，比如白色或黑色，来合成照片拼贴的剪影。但是为了增加背景的趣味性，我写了一点Python代码来创建带有五个控制点的垂直颜色渐变。然后，我使用CLIP分析结果图像，并使用Pytorch中的Adam optimizer [6]迭代调整颜色，以找到文本提示的最佳匹配。</p><blockquote class="mu mv mw"><p id="6c71" class="kz la mx lb b lc ld ju le lf lg jx lh my lj lk ll mz ln lo lp na lr ls lt lu im bi translated">我们提出Adam，这是一种有效的随机优化方法，只需要一阶梯度和很少的内存需求。该方法根据梯度的一阶和二阶矩的估计来计算不同参数的个体自适应学习率；Adam这个名字来源于自适应矩估计。迪德里克·金马和吉米·巴</p></blockquote><p id="4868" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你不会说数学，Adam方法会稍微调整参数，并注意每次迭代的结果是否会改善以及改善了多少。它根据每个参数对改善结果的贡献大小，以不同的速率改变参数。</p><p id="a9ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是在对25个参数(红、绿和蓝的5个控制点)使用CLIP和Adam 100次迭代后，得到的“企鹅在雪山上滑雪”的渐变。)</p><div class="kj kk kl km gt ab cb"><figure class="nb kn oq nd ne nf ng paragraph-image"><img src="../Images/bef1111235bf8f0cbdabd1c756560ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*WqPRKLLw9w-HnuRo4ryJ8A.png"/></figure><figure class="nb kn or nd ne nf ng paragraph-image"><img src="../Images/2f35e3adf7c77aa39ce24855f3571a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*UD2y-Anuz1n5pjQy3FuiwA.png"/><p class="ku kv gj gh gi kw kx bd b be z dk os di ot nn translated"><strong class="bd ky">使用剪辑创建背景渐变图片</strong>，图片作者</p></figure></div><p id="75eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">左边是参数值的图表，右边是合成的梯度图像。我不知道为什么它在中下区域显示紫色，但它看起来棒极了！</p><p id="7474" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一些使用这种方法的附加背景渐变。</p><div class="kj kk kl km gt ab cb"><figure class="nb kn ou nd ne nf ng paragraph-image"><img src="../Images/a2ad0121ba256691d71d398333a010b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*FzI-1BVnq-YYF3MQHc-liQ.png"/></figure><figure class="nb kn ou nd ne nf ng paragraph-image"><img src="../Images/f3ccd9890793a10b194313039a5a2dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*KWY6N5bnVrIno3bg9xsGiA.png"/></figure><figure class="nb kn ou nd ne nf ng paragraph-image"><img src="../Images/4bfaff85565545395270b88e957d5381.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*pt8RgBXe5lBst-8m95-LNg.png"/><p class="ku kv gj gh gi kw kx bd b be z dk on di oo nn translated"><strong class="bd ky">背景渐变为</strong>(左)<strong class="bd ky">城市上空的夕阳</strong>(中)<strong class="bd ky">海边的晴天</strong>(右)<strong class="bd ky">秋叶</strong>，图片作者</p></figure></div><p id="7469" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，创建一个只有15个参数的图像，在CLIP的指导下，是相当有表现力的。从文本生成颜色渐变的代码是<a class="ae lv" href="https://gist.github.com/robgon-art/920ac282f92f5f1ae1946458b0dfeb88" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><h2 id="f13b" class="no ly it bd lz np nq dn md nr ns dp mh li nt nu mj lm nv nw ml lq nx ny mn nz bi translated">寻找最佳拼贴布局</h2><p id="f8f7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">一旦系统有了背景图像和剪贴画，下一步就是有意义地排列对象。为了做到这一点，我创建了100个随机对象放置变量，然后通过CLIP运行它们，以查看哪个布局最匹配文本提示。我按大小对剪出的图片进行分类，将较大的图片放在背景，较小的放在前景。这样做可以减少遮挡较小图片的机会。</p><p id="cc94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是三种随机布局的示例。</p><div class="kj kk kl km gt ab cb"><figure class="nb kn ou nd ne nf ng paragraph-image"><img src="../Images/ced10a60bfbc55505670d7d0e149ea80.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*Csqsu91pqfOxHSNZTAByNQ.png"/></figure><figure class="nb kn ou nd ne nf ng paragraph-image"><img src="../Images/2834ca0f1bdf0f7eb269b28b1b9bc147.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*h5FKO8ftsJQ3JVe5-49j5g.png"/></figure><figure class="nb kn ou nd ne nf ng paragraph-image"><img src="../Images/6777bbc1f0b061d3e541919bbe471027.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*dEwMWfagFZXLt_LehVOtKg.png"/><p class="ku kv gj gh gi kw kx bd b be z dk on di oo nn translated"><strong class="bd ky">随机对象布局，</strong>作者图片</p></figure></div><p id="b371" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过CLIP运行所有100个布局后，右边的一个与“企鹅在雪山上滑雪”最匹配这很好，但它可以使用一点微调。</p><h2 id="3c9f" class="no ly it bd lz np nq dn md nr ns dp mh li nt nu mj lm nv nw ml lq nx ny mn nz bi translated">优化布局</h2><p id="ffdd" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">类似于创建背景渐变的方法，我再次使用Adam优化器来调整对象位置，以更好地匹配文本提示。这有效地颠倒了函数，允许优化器找到最佳解决方案。我使用了Edgar Riba等人编写的名为Kornia [8]的软件包，它在Pytorch中执行数学上可微分的图像处理例程。</p><p id="fe75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">系统对渐变中的对象和颜色的位置进行微小的调整，然后使用CLIP分析结果图像。然后，它会检查自己是朝着更好的解决方案前进，还是远离它。这个循环重复100次，以创建最终的图像。</p><p id="8b42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是“企鹅在雪山上滑雪”的第一、第五十和第一百次迭代的布局</p><div class="kj kk kl km gt ab cb"><figure class="nb kn ou nd ne nf ng paragraph-image"><img src="../Images/6777bbc1f0b061d3e541919bbe471027.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*dEwMWfagFZXLt_LehVOtKg.png"/></figure><figure class="nb kn ou nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/8130194df59f0bf49ad9db05adf0bce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*KM4d6xoWYKyrCs5iC1g6Sg.png"/></div></figure><figure class="nb kn ou nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/5a239c310ce043e0c74ca5e4abe6f5c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*qW4HVwLP2-9TdGaWZaG3NQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk on di oo nn translated"><strong class="bd ky">布局优化</strong>，作者图片</p></figure></div><p id="fa63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到系统如何将企鹅的身体滑过人类滑雪者的头部和胸部，组织背景中的雪的图片，并调整颜色梯度，将紫色移动到图像的顶部。</p><p id="6c99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是“企鹅在雪山上滑雪”的最终拼贴画</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/c8aec0cfe60be98801c8ab9b1ee8373a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qW4HVwLP2-9TdGaWZaG3NQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">企鹅从雪山上滑下</strong>，图片作者</p></figure><p id="eea9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好吧，这很酷(哈，双关语)。因为拼贴是使用参数组装的，所以可以以各种尺寸渲染，包括高分辨率。</p><p id="1362" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请务必在附录中查看更多的剪贴照片。</p><h1 id="92cd" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">讨论和未来方向</h1><p id="059b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">剪贴系统似乎工作得相当好。请注意，它高度依赖于从维基共享和OpenImages中找到合适的图像。如果它找不到与提示中的文字相匹配的图片，它会继续搜索找到的图片。</p><p id="85cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">未来的改进将增加图像缩放和旋转。如果有更多的参数需要控制，优化器可能会找到更好的布局。</p><h1 id="e869" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">源代码和Colabs</h1><p id="3128" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">这个项目的所有源代码都可以在<a class="ae lv" href="https://github.com/robgon-art/CLIPandPASTE" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。我在<a class="ae lv" href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener ugc nofollow" target="_blank"> CC BY-SA许可</a>下发布了源代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/6dc0b98edb69fa7659cbd12da47ecc49.png" data-original-src="https://miro.medium.com/v2/resize:fit:176/format:webp/0*oOmK-c2nuil7YJIZ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">知识共享署名共享</strong></p></figure><h1 id="3e8b" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">感谢</h1><p id="2adc" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我要感谢詹尼弗·林对这个项目的帮助。</p><h1 id="bfa6" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">参考</h1><p id="9d36" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">[1] <strong class="lb iu">剪辑</strong>由a .拉德福德等著，<a class="ae lv" href="https://cdn.openai.com/papers/Learning_Transferable_Visual_Models_From_Natural_Language_Supervision.pdf" rel="noopener ugc nofollow" target="_blank">从自然语言监督中学习可转移的视觉模型</a> (2021)</p><p id="3b1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] F. Boudin，<a class="ae lv" href="https://github.com/boudinfl/pke" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/>:一个开源的基于Python的关键短语抽取工具包</a> (2016)，COLING 2016论文集，第26届计算语言学国际会议:系统演示</p><p id="1a7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3] <a class="ae lv" href="https://commons.wikimedia.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">维基共享资源</strong> </a> (2004年至今)</p><p id="cd8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[4]<a class="ae lv" href="https://storage.googleapis.com/openimages/web/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">open images</strong></a>(2020)</p><p id="ef96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[5] <strong class="lb iu">格罗伊</strong>由l .罗西、A .卡利米和A .普拉蒂提出，<a class="ae lv" href="https://arxiv.org/pdf/2004.13665.pdf" rel="noopener ugc nofollow" target="_blank">一种新颖的感兴趣区域提取层实例分割</a> (2020)</p><p id="a769" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[6] D. P .金玛和j .巴雷，<strong class="lb iu">亚当</strong> : <a class="ae lv" href="https://arxiv.org/pdf/1412.6980.pdf" rel="noopener ugc nofollow" target="_blank">随机优化的一种方法</a> (2015)，学习表征国际会议<strong class="lb iu"> </strong> 2015</p><p id="d69a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[7] M. Grootendorst，<a class="ae lv" href="https://github.com/MaartenGr/KeyBERT" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> KeyBERT </strong>:用BERT </a>进行最小关键词提取(2020)</p><p id="650b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[8] E. Riba、D. Mishkin、D. Ponsa、E. Rublee和G. Bradski，<a class="ae lv" href="https://arxiv.org/pdf/1910.02190.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Kornia</strong>:py torch的开源可区分计算机视觉库</a> (2020)，计算机视觉应用冬季会议</p><h1 id="b09c" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">附录</h1><p id="26b3" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">这里有一些使用剪辑和粘贴来创建照片拼贴的例子。</p><h2 id="6070" class="no ly it bd lz np nq dn md nr ns dp mh li nt nu mj lm nv nw ml lq nx ny mn nz bi translated">波士顿天际线上的烟火</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/01e47bcba56f8584e5a880e2c3263397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eTDsl_hF5pR6Rl7eYBakrg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">波士顿天际线上的烟花</strong>，作者图片</p></figure><h2 id="4245" class="no ly it bd lz np nq dn md nr ns dp mh li nt nu mj lm nv nw ml lq nx ny mn nz bi translated">一只哈巴狗在用萨克斯管演奏的铜管乐队里</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/cb35745f4aea1327db007eea94cc4113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PhmpjYQvWdSKj7fdPrNsFA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">一只哈巴狗在铜管乐队中吹奏萨克斯管</strong>，图片由作者提供</p></figure><h2 id="cf19" class="no ly it bd lz np nq dn md nr ns dp mh li nt nu mj lm nv nw ml lq nx ny mn nz bi translated">与蝴蝶一起奔跑的抽象人</h2><p id="b8fb" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">这一个只用了两个图像剪切。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/8ef47837d518c1ea1bec3ce5396acb7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rbb09iWZM4NUPA7DxsQVTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">与蝴蝶一起奔跑的抽象男子</strong>，作者图片</p></figure></div><div class="ab cl ox oy hx oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="im in io ip iq"><p id="c957" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了无限制地访问Medium上的所有文章，<a class="ae lv" href="https://robgon.medium.com/membership" rel="noopener">成为</a>的会员，每月5美元。非会员每月只能看三个锁定的故事。</p></div></div>    
</body>
</html>