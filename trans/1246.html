<html>
<head>
<title>The Five Building Blocks of Markov Decision Processes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">马尔可夫决策过程的五个组成部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-five-building-blocks-of-markov-decision-processes-997dc1ab48a7#2022-03-29">https://towardsdatascience.com/the-five-building-blocks-of-markov-decision-processes-997dc1ab48a7#2022-03-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1295" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过掌握马尔可夫决策过程的基本原则来定义和交流您的强化学习模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fa890c5eb488c5dc9018f3919412f10e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FbIkYOqBIBgh_6lX"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@mourimoto?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Mourizal Zativa </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="ae35" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正确制定<strong class="li iu">马尔可夫决策过程</strong> (MDP)的能力对于成功的强化学习(RL)实践者是必不可少的。需要一个清晰的数学模型来(I)正确地编码它并训练解决算法，(ii)用统一的语言与利益相关者交流，以及(iii)明确抽象和简化。</p><p id="da32" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">MDP 作为一个框架来形式化顺序决策问题，其中随着时间的推移决策被分解成一系列子问题。在规范形式中，MDP 由一个<strong class="li iu">元组</strong> <code class="fe mc md me mf b">(S,A,R,P,γ)</code>描述。本文将详细阐述每个元素。</p><h1 id="6257" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">状态空间</h1><p id="c069" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">状态<code class="fe mc md me mf b">s∈S</code>包含计算决策、奖励和转换所需的所有信息；<em class="nd">状态空间</em>T2 是包含所有状态的集合。MDPs 的一个核心概念是决策完全基于系统的当前状态(无记忆属性)；过去的状态不应该成为决策的因素。一个常见的误解是，一个国家不能纳入<em class="nd">过去的信息</em>；这实际上是允许的(高阶马尔可夫模型，见 Salnikov 等人)。</p><p id="6a44" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在某些情况下，状态是一个简单的标量，例如代理在一维线上的位置。通常，状态将是一个<strong class="li iu">向量</strong>。考虑一个机械臂，其状态由三个关节的角度<code class="fe mc md me mf b">s=[x,y,z]</code>描述。股票投资组合状态可以用当前价格水平和每只股票的持有量<code class="fe mc md me mf b">s=[p_1,p_2,…,p_n,s_1,s_2,…,s_n]</code>来描述。一个大型仓库可能有 10，000 个条目状态，描述每个产品的数量。</p><p id="f072" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">没有必要停留在物理世界的边界。鲍威尔区分了三种状态成分:(一)物质，(二)信息，(三)知识。大纲如下。</p><blockquote class="ne nf ng"><p id="2381" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated"><strong class="li iu">一、身体</strong></p><p id="e030" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated">“身体的”这个词在这里可能用得有点不严格；想想卡车的位置，你银行账户上的钱，或者无人机的电池电量。它捕获系统或可用资源的物理属性。不幸的是，许多建模者将状态等同于物理属性，因此忽略了相关信息。</p><p id="f392" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated"><strong class="li iu">二。信息</strong></p><p id="458a" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated">除了直接从系统中获得的属性，我们还经常在决策中使用额外的信息。如果我们有一个股票投资组合，股票价格(市场数据)就是信息。对于一个风电场，它可能是风速和风向。</p><p id="f552" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated">信息也可以与过去或未来有关。过去的股票价格可能揭示相关的趋势，这些趋势不能仅仅从现在的价格中获得。如果我们有一个下周确认的大生产订单，这是本周起草生产计划时的相关信息。</p><p id="09e8" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated">这些类型的信息似乎与无记忆属性相冲突。然而:如果你知道世界末日是在下周四，你可能不会在周五完成那份报告，对吗？我们只是简单地包括我们知道的州的相关信息。</p><p id="d1e6" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated">重点是‘知道’。从蒙特卡洛模拟或建模者的知识中，我们可以得到许多代理人不知道的信息。应该从决策代理人的角度添加信息，决策代理人不具备透视技能。</p><p id="03a8" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated"><strong class="li iu">三。信念</strong></p><p id="bf71" class="lg lh nd li b lj lk ju ll lm ln jx lo nh lq lr ls ni lu lv lw nj ly lz ma mb im bi translated">我们可能不仅仅基于已知信息做出决策，还会基于不确定的信息或信念。我们现在可以测量出准确的风速，但在本周的其余时间里，我们要依靠天气预报。仓库可以利用销售预测模型。过去的股票价格可以用来预测未来的股票价格。对于信念，我们通常指的是捕捉某些知识的概率分布。</p></blockquote><p id="7269" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">作为指导方针，州政府应该包含<strong class="li iu">所有用于做出明智决策的相关数据</strong>——不多也不少。如果某些数据不影响决策、奖励或转换，则不应将其纳入状态。</p><div class="nk nl gp gr nm nn"><a href="https://wvheeswijk.medium.com/a-deep-dive-into-problem-states-498ad0746c98" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">对问题状态的深入探究</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">为你的马尔可夫决策过程定义适当的问题状态。了解高阶 MDP 和信念状态…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">wvheeswijk.medium.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ks nn"/></div></div></a></div><h1 id="026e" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">行动空间(A)</h1><p id="3d58" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">对于 MDPs 来说，不可或缺的是对系统进行某种程度的控制的能力。动作<code class="fe mc md me mf b">a∈A</code> —在某些域中也称为<em class="nd">决策</em>或<em class="nd">控制</em>—描述了代理的这种影响；动作空间<code class="fe mc md me mf b">A</code>包含所有(可行的)动作。至于状态，动作可以是简单的标量(<em class="nd">‘行权选项</em><code class="fe mc md me mf b"><em class="nd">a∈{0,1}</em></code><em class="nd">’</em>)，也可以是高维向量(<em class="nd">‘订单</em> <code class="fe mc md me mf b"><em class="nd">a_i</em></code> <em class="nd">产品类型</em><code class="fe mc md me mf b"><em class="nd">i</em></code><em class="nd">’</em>)。</p><p id="2038" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">对于<strong class="li iu">状态无关的</strong>动作，相同的动作空间<code class="fe mc md me mf b">A</code>适用于每个状态。对于很多问题来说，动作是<strong class="li iu">状态依赖的</strong> <em class="nd"> </em>(动作空间<code class="fe mc md me mf b">A(s)</code>):棋盘上的走法取决于当前的棋子及其位置，蓄水池不能排到负数。有时，假设动作空间是状态无关的(例如，在<a class="ae ky" rel="noopener" target="_blank" href="/a-minimal-working-example-for-deep-q-learning-in-tensorflow-2-0-e0ca8a944d5e">深度 Q 学习</a>中)并简单地屏蔽不可行的动作是方便的。</p><p id="e262" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">对于允许各种排列的基于向量的决策，动作空间的枚举可能会成为问题。此外，通常很难<strong class="li iu">评估行动是否可行</strong>。考虑原材料、优先关系、存储能力、机器可用性等有限的生产线的决策。仅仅验证一个时间表是否有效就构成了一个复杂的子问题。在这种情况下，我们需要使动作空间服从一组约束，例如，通过将动作问题公式化为数学程序<strong class="li iu"/>。一个额外的好处是，它大大增加了可以处理的行动空间的大小。</p><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/using-linear-programming-to-boost-your-reinforcement-learning-algorithms-994977665902"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">使用线性规划来提高你的强化学习算法</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">大而高维的动作空间往往是强化学习的计算瓶颈。制定…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="oc l ny nz oa nw ob ks nn"/></div></div></a></div><h1 id="7871" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">奖励函数(R)</h1><p id="567a" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">MDP 模型需要优化一些<em class="nd">目标</em>函数，通常是(贴现的)累积报酬。<em class="nd">奖励</em>功能<code class="fe mc md me mf b">R(s,a)</code>捕捉<strong class="li iu">直接奖励</strong>，与个体决策时刻相关的成本或贡献，依赖于状态<code class="fe mc md me mf b">s</code>和/或行动<code class="fe mc md me mf b">a</code>。有时回报是显而易见的，例如股票交易带来的金钱收益和损失。在其他情况下，需要更多的人工构造，例如赢得游戏或达到目标的奖励。然后，有必要将奖励与解决问题的目标结合起来。</p><p id="dfcc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">非零奖励不一定在每个时期发生，例如，它们可能仅在一集的结尾被接收(赢得/输掉一场游戏)。在 RL 中，我们经常求助于<strong class="li iu">奖励塑造</strong>，引入中间奖励来识别‘好’的行动，并指导算法。奖励塑造应该小心使用，因为它改变了原来的问题设置，并可能引入意想不到的行为。</p><h1 id="a0cd" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">转移函数(P)</h1><p id="a917" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">在 MDP 中，我们采取离散的时间步骤，从一个状态(<code class="fe mc md me mf b">s</code>)移动到下一个状态(<code class="fe mc md me mf b">s’</code>)。这个<em class="nd">转换函数</em>取决于(I)当前状态<code class="fe mc md me mf b">s</code>、( ii)动作<code class="fe mc md me mf b">a</code>和(iii)随机信息<code class="fe mc md me mf b">ω</code>。转换可以分解为确定性部分和随机部分，其中<code class="fe mc md me mf b">a</code>描述确定性部分，而<code class="fe mc md me mf b">ω</code>描述随机部分(尽管通常是混合，转换可能是完全确定性的或完全随机的)。</p><p id="ed00" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在 MDP 公式中，转移函数通常隐藏在看似简单的概率中<code class="fe mc md me mf b">P(s’|s,a)</code>。确实具有欺骗性，因为它通常是最难建模的组件。事实上，转换函数的范围可能从一个平凡的确定性函数(例如 GridWorld 中的一个步骤)到一个高度复杂的<a class="ae ky" rel="noopener" target="_blank" href="/need-help-making-decisions-ask-your-digital-twin-6e4cf328cb0">现实的数字孪生</a>表示，有许多不确定性需要建模。</p><p id="a2c7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">虽然转移函数是 MDP 的必要组成部分，但在 RL 中我们不一定要明确定义它。相反，我们可以<strong class="li iu">观察来自环境</strong>的转变 <strong class="li iu">。如果我们学习玩超级马里奥游戏，我们可能不知道实际的转换函数；我们只是试着移动，然后观察会发生什么。我们甚至可以利用真实世界的观察(例如，当控制取决于天气情况的风电场时)。在这种情况下，世界本身就是我们的过渡函数！</strong></p><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/what-are-post-decision-states-and-what-do-they-want-from-us-9e02105b7f40"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">什么是后决策状态？他们想从我们这里得到什么？</h2><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="od l ny nz oa nw ob ks nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/about-post-decision-states-again-5725e5c15d90"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">关于后决策状态</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">论强化学习中状态-动作对和决策后状态的(不那么)细微差别。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="oe l ny nz oa nw ob ks nn"/></div></div></a></div><h1 id="d615" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">折扣系数(γ)</h1><p id="9709" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated"><em class="nd">贴现因子</em> <code class="fe mc md me mf b">γ ∈ [0,1]</code>并不总是包含在 MDP 元组中，因为它对于有限范围是可选的。简而言之，它表明<strong class="li iu">未来奖励在多大程度上被纳入当前决策</strong>，其中<code class="fe mc md me mf b">γ=0</code>完全不考虑未来奖励，而<code class="fe mc md me mf b">γ=1</code>平等地权衡所有未来奖励。使用贴现率有各种各样的理由，主要的一个理由是确保无限期问题的价值函数收敛。</p><p id="ad03" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">任何设置<code class="fe mc md me mf b">γ&lt;1</code>都足以<strong class="li iu">保证(理论上的)收敛</strong>，但是精确的设置对于优化目的很重要。一个普遍的经验法则是，系统的不确定性越大，贴现率就越高，这反映了今天的行动对未来表现的影响有限。</p><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/why-discount-future-rewards-in-reinforcement-learning-a833d0ae1942"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">为什么强化学习要对未来的回报打折扣？</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">从数学，金融，生活，当然还有强化的角度讨论贴现率…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="of l ny nz oa nw ob ks nn"/></div></div></a></div><h1 id="6b48" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">摘要</h1><p id="ab89" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">马尔可夫决策过程由以下构件组成:</p><ul class=""><li id="1d3a" class="og oh it li b lj lk lm ln lp oi lt oj lx ok mb ol om on oo bi translated"><strong class="li iu">状态空间</strong>状态可以分为<strong class="li iu">物理</strong> -、<strong class="li iu">信息</strong> -和<strong class="li iu">信念</strong>属性，并且应该精确地包含前述目的所需的属性。</li><li id="2bc3" class="og oh it li b lj op lm oq lp or lt os lx ot mb ol om on oo bi translated"><strong class="li iu">动作空间</strong>T2——包含所有(可行)动作的集合。对于<strong class="li iu">依赖于状态的决策</strong> <code class="fe mc md me mf b">a(s)</code>，可能需要使动作空间服从一组约束，例如，使用数学编程。</li><li id="8488" class="og oh it li b lj op lm oq lp or lt os lx ot mb ol om on oo bi translated"><strong class="li iu">奖励功能</strong> <code class="fe mc md me mf b">R</code> —表示<code class="fe mc md me mf b">s</code>状态下<code class="fe mc md me mf b">a</code>动作时<strong class="li iu">直接奖励</strong>。在许多问题中，奖励不是自明的，需要<strong class="li iu">奖励塑造</strong>来完成解决问题的目标。不良的奖励功能可能会导致不良行为。</li><li id="d62b" class="og oh it li b lj op lm oq lp or lt os lx ot mb ol om on oo bi translated"><strong class="li iu">转移函数</strong> <code class="fe mc md me mf b">P</code> —控制系统随时间的<strong class="li iu">动态</strong>的函数，引导代理从状态<code class="fe mc md me mf b">s</code>到<code class="fe mc md me mf b">s’</code>。该转换通常包括确定性成分(动作<code class="fe mc md me mf b">a</code>)和随机成分(外部信息<code class="fe mc md me mf b">ω</code>)。<strong class="li iu">可以从外部环境中观察到</strong>转换，而无需对其进行显式建模。</li><li id="a0e1" class="og oh it li b lj op lm oq lp or lt os lx ot mb ol om on oo bi translated"><strong class="li iu">贴现因子</strong> <code class="fe mc md me mf b">γ</code> —定义未来奖励对当前决策的影响程度。当问题是无限时域的并且依赖于累积报酬目标函数时，贴现率<code class="fe mc md me mf b">γ&lt;1</code>对于<strong class="li iu">确保收敛</strong>是必要的。贴现率通常根据环境的不确定性来设定。</li></ul><p id="8fcd" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">每个构件都可能隐藏着巨大的挑战。MDP 的建模方式可能会显著影响求解算法的有效性。此外，在商业和学术环境中，定义清晰的 MDP 的能力对于统一交流问题抽象非常重要。</p><p id="e864" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">虽然 MDP 公式可能有点麻烦，但从长远来看，正确地使用它是值得的。</p><h2 id="dbea" class="ou mh it bd mi ov ow dn mm ox oy dp mq lp oz pa ms lt pb pc mu lx pd pe mw pf bi translated"><strong class="ak">参考文献</strong></h2><p id="d312" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">鲍威尔，W. B. (2019)。随机优化的统一框架。<em class="nd">欧洲运筹学杂志</em>，<em class="nd"> 275 </em> (3)，795–821。</p><p id="a257" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用高阶马尔可夫模型揭示网络中基于流的社区。<em class="nd"> Sci Rep </em> <strong class="li iu"> 6、</strong> 23194 (2016)。<a class="ae ky" href="https://doi.org/10.1038/srep23194" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1038/srep23194</a></p></div></div>    
</body>
</html>