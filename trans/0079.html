<html>
<head>
<title>Checklist — Behavioral Testing of NLP Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">清单 NLP 模型的行为测试</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/checklist-behavioral-testing-of-nlp-models-491cf11f0238#2022-02-03">https://towardsdatascience.com/checklist-behavioral-testing-of-nlp-models-491cf11f0238#2022-02-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="69a9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">确保你的 NLP 模型如预期的那样工作</h2></div><h1 id="3c63" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">动机</h1><p id="614c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在新数据上测试时，您的 NLP 模型不会抛出任何错误。是否意味着可以用于生产？</p><p id="b98d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">没必要。ML 系统可以<strong class="lc iu">运行完成而不抛出任何错误</strong>，但是仍然可以<strong class="lc iu">产生不正确的输出</strong>。因此，测试您的模型的行为以确保它如您所期望的那样工作是很重要的。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/797e9c425a8e377baa838bcc07f76df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TsZm8GvRB5FuVlDUZ5D8zQ.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><p id="ba60" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">但是，为您的 NLP 模型进行测试可能会很困难。一些困难来自于需要:</p><ul class=""><li id="1147" class="mr ms it lc b ld lw lg lx lj mt ln mu lr mv lv mw mx my mz bi translated">创建数据来测试您的模型</li><li id="de16" class="mr ms it lc b ld na lg nb lj nc ln nd lr ne lv mw mx my mz bi translated">知道测试什么以及如何创建测试</li></ul><p id="d194" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果您可以快速创建测试数据集并使用这些数据集测试您的模型，这不是很好吗？这就是清单派上用场的时候。</p><h1 id="7990" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">什么是检查表？</h1><p id="e061" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae nf" href="https://github.com/marcotcr/checklist" rel="noopener ugc nofollow" target="_blank"> Checklist </a>是一个开源的 Python 库，使得测试 NLP 模型变得容易。本库中的方法在文章<a class="ae nf" href="http://homes.cs.washington.edu/~marcotcr/acl20_checklist.pdf" rel="noopener ugc nofollow" target="_blank">超越准确性:带清单的 NLP 模型的行为测试</a>中有描述。</p><p id="5f12" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">清单特别关注行为测试。行为测试关注的是通过验证输出来测试系统的不同能力，而不需要任何内部结构的知识。</p><p id="bc5f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">要了解 Checklist 的工作原理，请从安装库开始:</p><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="3c81" class="nl kj it nh b gy nm nn l no np">pip install checklist</span></pre><p id="8dd2" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">将清单扩展添加到 Jupyter:</p><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="1fa7" class="nl kj it nh b gy nm nn l no np">jupyter nbextension install --py --sys-prefix checklist.viewer<br/>jupyter nbextension enable --py --sys-prefix checklist.viewer</span></pre><p id="0f5c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们还将下载一个空间模型用于本文:</p><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="6e3b" class="nl kj it nh b gy nm nn l no np">python -m spacy download en_core_web_sm</span></pre><h1 id="294f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">最低功能测试(MFT)</h1><p id="0164" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">最低功能测试(MFT)使用简单的例子来确保模型能够很好地执行特定的任务。例如，我们可能想要测试情绪模型在处理否定时的表现。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nq"><img src="../Images/844118853ef583a63f547ed040d0d73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uI9mkoZvjRrjTsXSYuDZ3A.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><p id="e615" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们看看<a class="ae nf" rel="noopener" target="_blank" href="/supercharge-your-python-string-with-textblob-2d9c08a8da05"> TextBlob </a>的情感模型如何处理否定。</p><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="cbc6" class="nl kj it nh b gy nm nn l no np">pip install textblob</span></pre><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="025c" class="nl kj it nh b gy nm nn l no np">0.3499999999999999</span></pre><p id="b10a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">情感得分是[-1.0，1.0]范围内的浮动值。由于上述文本的得分为正，因此该文本的情感被归类为正。</p><p id="2cfb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">看起来这个模型在这些例子中工作得很好。然而，我们需要创建更多的数据来测试该模型是否也适用于其他否定。幸运的是，Checklist 允许我们轻松地创建类似的测试数据。</p><h2 id="3a3b" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">创建数据</h2><p id="5fb6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们将使用 Checklist 的编辑器，使用一个模板和一个项目列表来创建多个示例。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="b626" class="nl kj it nh b gy nm nn l no np">['Staying at home is not a great option.',<br/> 'Staying at home is not a good option.']</span></pre><p id="6823" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们也可以使用<code class="fe oe of og nh b">{mask}</code>让 Checklist 填入适合句子的单词:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="3d54" class="nl kj it nh b gy nm nn l no np">['sleep is not a good option.', 'Rest is not a great option.']</span></pre><p id="0532" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在我们知道了 Checklist 的编辑器是如何工作的，让我们使用它来创建一些示例:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="bbbb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">相当酷！我们刚刚用几行代码创建了 200 个样本。</p><h2 id="aa8e" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">创建预测情绪的函数</h2><p id="cfe3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">接下来，我们将创建一个预测情绪的函数。请注意，该函数将返回句子情感是消极还是积极的概率，而不是分数。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="8259" class="nl kj it nh b gy nm nn l no np">array([[0.15, 0.85]])</span></pre><p id="f589" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">从上面的输出来看，模型表明文本有 15%的几率是负面的，而文本有 85%的几率是正面的。</p><p id="6d01" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">由于清单的测试需要一个返回元组<code class="fe oe of og nh b">(predictions, confidences)</code>的函数，我们将使用一个包装器在<code class="fe oe of og nh b">predict_proba</code>返回的置信度旁边添加预测。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="d78d" class="nl kj it nh b gy nm nn l no np">(array([1]), array([[0.15, 0.85]]))</span></pre><h2 id="dfe8" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">创建测试</h2><p id="450b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">既然我们已经创建了测试数据和预测功能，我们可以使用<code class="fe oe of og nh b">MFT</code>(最小功能测试)来创建测试。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="be50" class="nl kj it nh b gy nm nn l no np">Predicting 200 examples</span></pre><p id="7afb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">总结测试结果:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="0545" class="nl kj it nh b gy nm nn l no np">Test cases:      200<br/>Fails (rate):    115 (57.5%)<br/><br/>Example fails:<br/>0.0 Shipping is not an awful option.<br/>----<br/>0.5 Pinterest is not a time-consuming option.<br/>----<br/>0.5 Training is not an unfeasible option.<br/>----</span></pre><p id="bbf4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">哇哦。200 次测试有 57.5%失败。我们不知道 TextBlob 的情绪在没有测试的情况下有如此高的否定失败率。</p><p id="983e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">摘要还给出了一些失败测试的例子。要查看所有失败的测试，使用<code class="fe oe of og nh b">text.visual_summary()</code>。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oh"><img src="../Images/347f95fc793ba9ebf650219caa350c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BdpjsD9f434417gHXtvj1A.gif"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者 GIF</p></figure><h1 id="e531" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">不变性测试</h1><p id="70a8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">除了测试模型的功能，我们可能还想测试当输入的小部分稍微改变时，模型预测是否保持不变。这些测试被称为不变性测试(IV)。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oi"><img src="../Images/e9b86287cd29eae41b613d115b0d28ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T85XmjxaGE7Chimh5UBMhA.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><p id="ca4f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们为输入添加一些琐碎的元素，如标点符号、错别字、姓名和位置，看看情绪是否会发生变化。</p><p id="161a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">从创建玩具数据集开始:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="d521" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">把数据变成空间的<code class="fe oe of og nh b">Doc</code>:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="8b5e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">创建一个向数据集添加扰动的函数，然后创建不变性测试:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="7539" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">添加标点符号</h2><p id="bc76" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">理想情况下，如果在句末加上标点符号，句子的情绪应该不会改变。让我们使用<code class="fe oe of og nh b">Perturb.punctuation</code>测试 Textblob 是否对标点符号具有鲁棒性。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="a999" class="nl kj it nh b gy nm nn l no np">First sample before and after pertubation:<br/>The cake is great.<br/>The cake is great<br/><br/>Summary:<br/>Predicting 10 examples<br/>Test cases:      5<br/>Fails (rate):    0 (0.0%)</span></pre><p id="db9a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">酷！5 项测试全部通过。</p><h2 id="8a45" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">添加错别字</h2><p id="4bf1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果我们给一个句子加上错别字，情感会保持不变吗？让我们使用<code class="fe oe of og nh b">Perturb.add_typos</code>来找出答案。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="2fe2" class="nl kj it nh b gy nm nn l no np">First sample before and after pertubation:<br/>The cake is great.<br/>The cake isg reat.<br/><br/>Summary:<br/>Predicting 10 examples<br/>Test cases:      5<br/>Fails (rate):    1 (20.0%)<br/><br/>Example fails:<br/>0.9 The cake is great.<br/>0.5 The cake isg reat.</span></pre><p id="7d25" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">添加错别字会导致 20%的失败率。既然单词<code class="fe oe of og nh b">great</code>变成了<code class="fe oe of og nh b">reat</code>，那么句子的情绪变得既不积极也不消极也是有道理的。</p><h2 id="0893" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">更改名称</h2><p id="86eb" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">把<code class="fe oe of og nh b">Michael</code>改成<code class="fe oe of og nh b">Jackson</code>应该不会改变一句话的情调。让我们用<code class="fe oe of og nh b">Perturb.change_names</code>来测试一下。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="87d0" class="nl kj it nh b gy nm nn l no np">First sample before and after pertubation:<br/>Michael had fun traveling to Mexico<br/>Jackson had fun traveling to Mexico<br/>Jose had fun traveling to Mexico<br/>Shawn had fun traveling to Mexico<br/>Steven had fun traveling to Mexico<br/>Jackson had fun traveling to Mexico<br/>Noah had fun traveling to Mexico<br/>Chad had fun traveling to Mexico<br/>Bryan had fun traveling to Mexico<br/>Stephen had fun traveling to Mexico<br/>Derek had fun traveling to Mexico<br/><br/>Summary:<br/>Predicting 22 examples<br/>Test cases:      2<br/>Fails (rate):    0 (0.0%)</span></pre><p id="5a59" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">酷毙了。该模型对于名称的改变是鲁棒的。</p><h2 id="ca68" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">改变位置</h2><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="18c9" class="nl kj it nh b gy nm nn l no np">First sample before and after pertubation:<br/>Michael had fun traveling to Mexico<br/>Michael had fun traveling to Afghanistan<br/>Michael had fun traveling to Kenya<br/>Michael had fun traveling to Peru<br/>Michael had fun traveling to Morocco<br/>Michael had fun traveling to Mexico<br/>Michael had fun traveling to Canada<br/>Michael had fun traveling to Germany<br/>Michael had fun traveling to Algeria<br/>Michael had fun traveling to Indonesia<br/><br/>Summary:<br/>Predicting 11 examples<br/>Test cases:      1<br/>Fails (rate):    0 (0.0%)</span></pre><p id="7472" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">不错！当我们改变句子中的位置时，所有的测试也通过了。</p><h2 id="4c7c" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">改为相关名词</h2><p id="9149" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们也可以创建自定义的扰动函数。让我们创建一个函数，将每个句子的第一个名词变成一个相关名词(例如，将“椅子”换成“桌子”)。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="56f9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">然后将该函数添加到我们的<code class="fe oe of og nh b">IV</code>测试中:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="7fc4" class="nl kj it nh b gy nm nn l no np">First sample before and after pertubation:<br/>The cake is great.<br/>The game is great.<br/>The movie is great.<br/>The book is great.<br/>The food is great.<br/>The story is great.<br/><br/>Summary:<br/>Predicting 20 examples<br/>Test cases:      4<br/>Fails (rate):    0 (0.0%)</span></pre><p id="6963" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">不错！改变每个句子的第一个名词并不能改变他们的情绪。</p><h1 id="8d40" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">方向性期望测验</h1><p id="8e83" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在不变性测试中，我们期望扰动后的输出是相同的。然而，有时我们可能期望扰动后的输出变为<strong class="lc iu">变化</strong>。这就是方向性预期测试派上用场的时候了。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oj"><img src="../Images/bcfa55a51995088af0b3282671b6e116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZpYfo49PGAzXpXx6r-Mt3Q.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">作者图片</p></figure><h2 id="7f79" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">期待变化</h2><p id="c429" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">要了解方向性期望测试是如何工作的，首先要创建一个期望。在这里，我们期望原来的预测和它的否定是不一样的。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="965d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">接下来，向数据集添加求反:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="3bcb" class="nl kj it nh b gy nm nn l no np">[['The cake is great.', 'The cake is not great.'],<br/> ['Michael had fun traveling to Mexico',<br/>  "Michael didn't have fun traveling to Mexico"]]</span></pre><p id="fd82" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">使用<code class="fe oe of og nh b">DIR</code>测试我们的期望:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="4406" class="nl kj it nh b gy nm nn l no np">Predicting 6 examples<br/>Test cases:      3<br/>Fails (rate):    2 (66.7%)<br/><br/>Example fails:<br/>0.5 Anna hates party.<br/>0.1 Anna doesn't hate party.<br/><br/>----<br/>0.7 Michael had fun traveling to Mexico<br/>0.7 Michael didn't have fun traveling to Mexico</span></pre><p id="da89" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">啊哈。测试失败是因为<code class="fe oe of og nh b">Michael had fun traveling to Mexico</code>和它的否定有相同的情感。</p><h2 id="9f30" class="nl kj it bd kk nt nu dn ko nv nw dp ks lj nx ny ku ln nz oa kw lr ob oc ky od bi translated">期望单调递减</h2><p id="6d10" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你不仅期望预测是不同的，而且期望<strong class="lc iu">正的预测概率不上升</strong>(单调下降)，那该怎么办？这时候<code class="fe oe of og nh b">Expect.monotonic</code>就派上用场了。</p><p id="4e83" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们创建一个包含所有肯定句的新数据集:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="33c5" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">由于所有的句子都是肯定的，我们期望在加上否定之后肯定的预测概率会降低:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="508f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><code class="fe oe of og nh b">tolerange=0.1</code>表示如果预测概率上升小于 0.1，我们不认为测试失败</p><p id="97ad" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，让我们向数据集添加否定，并测试是否所有样本的情绪都降低了:</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nr ns l"/></div></figure><pre class="mc md me mf gt ng nh ni nj aw nk bi"><span id="da4c" class="nl kj it nh b gy nm nn l no np">First sample before and after pertubation:<br/>The cheesecake is great.<br/>The cheesecake is not great.<br/><br/>Summary:<br/>Predicting 8 examples<br/>Test cases:      4<br/>After filtering: 2 (50.0%)<br/>Fails (rate):    1 (50.0%)<br/><br/>Example fails:<br/>0.5 Anna loves party.<br/>0.8 Anna doesn't love party.</span></pre><p id="1b8e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">有意思。一个测试失败了，因为<code class="fe oe of og nh b">Anna doesn’t love party</code>比<code class="fe oe of og nh b">Anna loves party</code>更有可能是阳性的。</p><h1 id="3c02" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="a3d3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">恭喜你！您刚刚学习了如何使用检查表测试您的 NLP 模型。我希望这篇文章能给你动力去测试你自己的 NLP 模型，以确保它如你所愿的那样工作。</p><p id="f0c7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">随意发挥，并在这里叉这篇文章的源代码:</p><div class="ok ol gp gr om on"><a href="https://github.com/khuyentran1401/Data-science/blob/master/nlp/checklist/checklist_examples.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">数据科学/check list _ examples . ipynb at master khuyentran 1401/数据科学</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">收集有用的数据科学主题以及代码和文章-Data-science/check list _ examples . ipynb at master…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">github.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ml on"/></div></div></a></div></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><p id="ac14" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的数据科学工具。你可以在 LinkedIn 和 Twitter 上与我联系。</p><p id="ae9d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在 Medium 上关注我，了解我的最新数据科学文章，例如:</p><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/pytest-for-data-scientists-2990319e55e6"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">数据科学家 Pytest</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">适用于您的数据科学项目的 Pytest 综合指南</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pj l oy oz pa ow pb ml on"/></div></div></a></div><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/introduction-to-schema-a-python-libary-to-validate-your-data-c6d99e06d56a"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">模式介绍:验证数据的 Python 库</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">验证您的数据变得更加复杂！</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pk l oy oz pa ow pb ml on"/></div></div></a></div><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/deepdiff-recursively-find-and-ignore-trivial-differences-using-python-231a5524f41d"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">DeepDiff——使用 Python 递归查找并忽略细微差异</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">比较两个 Python 对象时出现有意义的断言错误</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pl l oy oz pa ow pb ml on"/></div></div></a></div><div class="ok ol gp gr om on"><a rel="noopener follow" target="_blank" href="/great-expectations-always-know-what-to-expect-from-your-data-51214866c24"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">远大的期望:永远知道从你的数据中可以期待什么</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">使用 Python 确保数据按预期工作</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">towardsdatascience.com</p></div></div><div class="ow l"><div class="pm l oy oz pa ow pb ml on"/></div></div></a></div></div></div>    
</body>
</html>