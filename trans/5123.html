<html>
<head>
<title>Why and how custom exceptions lead to cleaner, better code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自定义异常为什么以及如何产生更干净、更好的代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-and-how-custom-exceptions-lead-to-cleaner-better-code-2382216829fd#2022-11-15">https://towardsdatascience.com/why-and-how-custom-exceptions-lead-to-cleaner-better-code-2382216829fd#2022-11-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="62ff" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过创建您自己的自定义异常来清理您的代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/102c7103cfe904d3965ce6ad790a9422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vgsBobSdABi3Bytj"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由<a class="ae ky" href="https://unsplash.com/photos/52jRtc2S_VE" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@rojekilian" rel="noopener ugc nofollow" target="_blank">莎拉·基利安</a>拍摄)</p></figure><p id="2df5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">异常和错误之间有很大的区别；异常是故意的，而错误是意外的。这篇文章关注于创建你自己的异常，以及如何使用它们来清理你的代码，从而产生一个不容易出错的程序，一个更好的流程和更快的调试。我们来编码吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9ef5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">肮脏的方式</h1><p id="ed76" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">为了演示自定义异常是如何工作的，我们将想象我们正在构建一个网站。我们重点关注<strong class="lb iu">改进</strong>网站的<strong class="lb iu">登录功能</strong>，目前看起来是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="nb"> (userexists、redirect 和 show_popup 是在我们项目的其他地方定义的函数；他们做什么和如何工作与本文无关)</em></p></figure><p id="e1c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个相当简单的功能:</p><ol class=""><li id="e30d" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">我们传递电子邮件和密码</li><li id="56ff" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">检查是否存在与该电子邮件地址相关联的帐户。如果没有，显示弹出窗口并重定向到/注册页面</li><li id="8ef1" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">检查凭据是否有效。有效:显示弹出窗口。无效:显示弹出窗口和重定向</li></ol><p id="9bbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以像这样调用函数:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="d7af" class="nv md it nr b gy nw nx l ny nz">login_dirty(email='mike@bmail.com', password='my_pa$$word')</span></pre><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/a-complete-guide-to-using-environment-variables-and-files-with-docker-and-compose-4549c21dc6af"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">在 Docker 和 Compose 中使用环境变量和文件的完整指南</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">通过这个简单的教程，保持你的容器的安全性和灵活性</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="f017" class="nv md it bd me os ot dn mi ou ov dp mm li ow ox mo lm oy oz mq lq pa pb ms pc bi translated">现在的登录功能有什么问题？</h2><p id="0491" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">登录功能的问题是<strong class="lb iu">脏</strong>。<strong class="lb iu"> </strong>我跟这个的意思是，它对不该负责的事情负责。我通常把我的项目分成两部分:</p><ol class=""><li id="87dc" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">干净的代码</li><li id="a463" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">肮脏的代码</li></ol><p id="9d96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对我来说，区别在于干净的代码不知道你的业务逻辑。你可以从一个项目中提取“干净”的功能，并在完全不同的项目中使用它们。然而，脏代码包含业务逻辑；例如，当您无法登录时会发生什么。你被重定向了吗？是否显示弹出窗口？<strong class="lb iu">让我们通过删除带有自定义异常的所有业务逻辑，使我们的登录功能变得更好、更干净。</strong></p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/cython-for-data-science-6-steps-to-make-this-pandas-dataframe-operation-over-100x-faster-1dadd905a00b"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">6 个步骤使熊猫数据帧操作速度提高 100 倍</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">用于数据科学的 Cython:将 Pandas 与 Cython 结合起来，实现令人难以置信的速度提升</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="pd l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="721c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">干净的方式</h1><p id="5913" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们想要一个没有任何业务逻辑负担的登录功能。如果它不能登录一个用户，我们只需要发出信号，这是不可能的；我们代码的其他部分(脏的部分)可以决定如何处理它。</p><p id="eafc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你看我们函数时，有两件事可能出错:</p><ol class=""><li id="9737" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">电子邮件地址未知(即用户未注册)</li><li id="4aac" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">电子邮件-密码组合不正确</li></ol><p id="eb19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两件事就是阻止成功登录的<strong class="lb iu">异常</strong>:首先我们将编写一些代码，允许<strong class="lb iu">引发这些异常</strong>。然后我们将清理我们的函数和函数被调用的方式。</p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/why-is-python-so-slow-and-how-to-speed-it-up-485b5a84154e"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">Python 为什么这么慢，如何加速</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">看看 Python 的瓶颈在哪里</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="pe l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="5b7b" class="nv md it bd me os ot dn mi ou ov dp mm li ow ox mo lm oy oz mq lq pa pb ms pc bi translated">创建自定义例外</h2><p id="55ee" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">创建自定义异常比您想象的要容易:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="27dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你看到的，我们创建了一个新类，它继承了异常类。然后，为了给其他开发人员一个好消息，我们只重写 __str__ 方法。</p><p id="30f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以像在<code class="fe pf pg ph nr b">UserNotFoundException</code>中一样将参数传递给异常。这里我们做的事情和以前完全一样，只是我们需要使用 __init__ 方法将<code class="fe pf pg ph nr b">email</code>存储为一个属性。</p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/image-analysis-for-beginners-destroying-duck-hunt-with-opencv-e19a27fd8b6"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">用 OpenCV 破坏猎鸭——初学者的图像分析</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">编写代码，将击败每一个鸭子狩猎高分</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="pi l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="eb8d" class="nv md it bd me os ot dn mi ou ov dp mm li ow ox mo lm oy oz mq lq pa pb ms pc bi translated">2.清理登录功能</h2><p id="cdca" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">使用新的异常来看看这个函数看起来有多漂亮和干净:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="b2e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了看起来更好之外，功能更干净和纯粹；它只负责登录，如果不知道任何关于重定向和弹出窗口。这种逻辑应该被限制在项目中的几个地方，而不应该到处都是。自定义异常对此有很大帮助。</p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/docker-for-absolute-beginners-what-is-docker-and-how-to-use-it-examples-3d3b11efd830"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">面向绝对初学者的 Docker——什么是 Docker 以及如何使用它(+示例)</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">像管理应用程序一样管理您的基础架构</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="pj l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="a11c" class="nv md it bd me os ot dn mi ou ov dp mm li ow ox mo lm oy oz mq lq pa pb ms pc bi translated">3.调用我们的登录</h2><p id="27d5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在我们的 main.py 文件中，我们现在可以像这样调用登录函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="b1b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所看到的，当我们无法登录时会发生什么是非常清楚的。主要的好处是，如果您以后决定无效的凭据也应该被重定向；没有很多地方可以搜索，因为您的业务逻辑并没有遍布整个项目。</p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/virtual-environments-for-absolute-beginners-what-is-it-and-how-to-create-one-examples-a48da8982d4b"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">绝对初学者的虚拟环境——什么是虚拟环境，如何创建虚拟环境(+例子)</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">深入探究 Python 虚拟环境、pip 和避免纠缠依赖</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="pk l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b9e5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="5f42" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本文中，我希望展示为什么要使用定制异常:为了帮助保持对代码的业务逻辑的概述，它们有助于保持您的函数纯净/干净和可调试。您自己的异常很容易在整个项目中创建和使用。</p><p id="bff9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望一切都像我希望的那样清楚，但如果不是这样，请让我知道我能做些什么来进一步澄清。同时，看看我的其他关于各种编程相关主题的文章，比如:</p><ul class=""><li id="65aa" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu pl ni nj nk bi translated"><a class="ae ky" href="https://mikehuls.medium.com/why-is-python-so-slow-and-how-to-speed-it-up-485b5a84154e" rel="noopener">Python 为什么这么慢<strong class="lb iu">如何加速</strong>T3】</a></li><li id="1eab" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu pl ni nj nk bi translated"><a class="ae ky" href="https://mikehuls.medium.com/six-levels-of-python-decorators-1f12c9067b23" rel="noopener">找出<strong class="lb iu">巨蟒装饰者</strong>如何在 6 个关卡中工作</a></li><li id="2cb0" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu pl ni nj nk bi translated"><a class="ae ky" href="https://mikehuls.medium.com/create-and-publish-your-own-python-package-ea45bee41cdc" rel="noopener">创建并发布自己的<strong class="lb iu"> Python 包</strong> </a></li><li id="572d" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu pl ni nj nk bi translated"><a class="ae ky" href="https://mikehuls.medium.com/docker-for-absolute-beginners-what-is-docker-and-how-to-use-it-examples-3d3b11efd830" rel="noopener"> <strong class="lb iu"> Docker </strong>适合绝对初学者——Docker 是什么，怎么用(+举例)</a></li></ul><p id="b47e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码快乐！</p><p id="0238" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">—迈克</p><p id="a023" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">喜欢我正在做的事情吗？ <a class="ae ky" href="https://mikehuls.medium.com/membership" rel="noopener"> <em class="pm">跟我来！</em> </a></p><div class="oa ob gp gr oc od"><a href="https://mikehuls.medium.com/membership" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">通过我的推荐链接加入媒体-迈克·赫斯</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">阅读迈克·赫斯(以及媒体上成千上万的其他作家)的每一个故事。你的会员费直接支持麦克…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">mikehuls.medium.com</p></div></div><div class="om l"><div class="pn l oo op oq om or ks od"/></div></div></a></div></div></div>    
</body>
</html>