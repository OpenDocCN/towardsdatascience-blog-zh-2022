<html>
<head>
<title>Image Analytics for Everyone: Image Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向所有人的图像分析:图像分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-analytics-for-everyone-image-classification-a6e542fd07f2#2022-08-31">https://towardsdatascience.com/image-analytics-for-everyone-image-classification-a6e542fd07f2#2022-08-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc2c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用分类编辑照片集</h2></div><p id="59ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在过去的几年里，我拍了很多照片，但是没有时间编辑这些照片。我想根据类别将它们分类到子文件夹中。机器学习算法和图像嵌入能解决我的问题吗？</p><p id="cdbf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文将展示一种识别照片类别和对子文件夹中的图像进行排序的方法。我们将使用名为分类的监督方法。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/f349a0f3602a5fff310322efc9ff977b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qe2pru3CGmAwvP8Bg7QcmQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><h2 id="859b" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">什么是监督方法？</h2><p id="0f8c" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">监督方法使用一个模型，该模型根据为特定输出标记的输入数据进行训练。该模型被训练以检测输入数据和输出标签之间的关系，从而能够预测以前未见过的数据的标签。</p><p id="2e79" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">两种最著名的监督方法是分类和回归。在本文中，我们将了解分类。</p><h2 id="d726" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">什么是分类？</h2><p id="2e9d" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">分类是预测每个数据点的类别(也称为类别)的过程。分类模型是从输入变量映射到一个可用类的映射函数。分类模型通常在一组已经标记的数据点上训练。</p><p id="af32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，在我们的例子中，分类模型预测测试数据集中每个图像的类别。我们将在已经标记的图像上训练我们的模型——训练数据集。</p><p id="0bc3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下面的例子中，我们使用了最常见的分类模型之一，即<a class="ae ms" href="https://en.wikipedia.org/wiki/Logistic_regression" rel="noopener ugc nofollow" target="_blank">逻辑回归</a>，您不需要详细了解它。不过，如果你很好奇，你可以在这篇文章中了解更多关于<a class="ae ms" rel="noopener" target="_blank" href="/logistic-regression-detailed-overview-46c4da4303bc">的信息。</a></p><h2 id="a1af" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">示例:用橙色进行图像分类</h2><p id="486d" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">如前所述，我想对图像进行分类，将它们放入电脑的子文件夹中。为此，我将训练一个分类模型，用类别标记图像。</p><p id="b9db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了训练模型，我需要一组已经标记的图像。我们可以通过为每个类别选择几个例子并将其分类到子文件夹中来准备它们。好消息是，我们只需要制作一次训练集，以后可以重用它。</p><p id="88ad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我用5个子文件夹中的图片准备了一个训练数据集。文件夹被命名为:城市，食物，山脉，日落和冬天。文件夹的名称定义了类别。一旦我在这些图像上训练模型，它将总是将图像分类到那些类别中。你可以从<a class="ae ms" href="https://github.com/PrimozGodec/datasets/blob/master/image-analytics-collection/train-photos.zip" rel="noopener ugc nofollow" target="_blank">这里</a>下载我的训练数据集。</p><p id="778d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在演示中，我将使用Orange——我最喜欢的数据分析工具。在我之前的文章中阅读更多关于橙色的内容。</p><h2 id="0a01" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">模型训练和评估</h2><p id="529a" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">我将首先测试模型的准确性和可靠性。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mt"><img src="../Images/eff3b0a3207d825c332ebc9481bcf5fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O4ANSxZkUNryak_gDbGgCw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">导入图像会从电脑上的文件夹中载入照片。图像查看器显示具有所选属性的图像——在我的例子中是类别。(图片由作者提供)</p></figure><p id="900b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae ms" href="https://orangedatamining.com/widget-catalog/image-analytics/importimages/" rel="noopener ugc nofollow" target="_blank">导入图片</a>小工具从训练数据集中加载图片(<a class="ae ms" href="https://github.com/PrimozGodec/datasets/raw/master/image-analytics-collection/train-photos.zip" rel="noopener ugc nofollow" target="_blank">下载训练数据</a>)。由于图像被分类在多个文件夹中，小工具将文件夹名称作为一个类别分配给图像，我们可以在图片下方的<a class="ae ms" href="https://orangedatamining.com/widget-catalog/image-analytics/imageviewer/" rel="noopener ugc nofollow" target="_blank">图像查看器</a>中看到。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mu"><img src="../Images/01d6f21e7ad469500d6ae870aa1a93ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdGYr_Vs1G7GlPElWwvY8Q.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图像嵌入将向量表示分配给图像，并且测试和评分小部件在训练数据(作者的图像)上测试逻辑回归模型</p></figure><p id="9a50" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我用Inception v3嵌入器在图像嵌入小部件中嵌入图像，将图像转换成适合分类的向量表示。在我之前的文章中阅读更多关于<a class="ae ms" rel="noopener" target="_blank" href="/image-analytics-for-everyone-image-embeddings-with-orange-7f0b91fa2ca2">图像嵌入的内容。</a></p><p id="e84e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我在<a class="ae ms" href="https://orangedatamining.com/widget-catalog/evaluate/testandscore" rel="noopener ugc nofollow" target="_blank">测试和评分小部件</a>中执行交叉验证，以查看模型在训练图像上的准确性(类别已知)。交叉验证建立多个模型，使得每个训练图像被用作一次测试图像来测量准确度。我用的模型是逻辑回归。</p><p id="87b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我对这个模型感到满意，它的AUC为0.993，分类精度为0.929，这意味着该模型对92%的图像进行了正确分类。注意，数据集还包括一些可分为多个类别的边界图像。例如，我有一些日落的照片，也可以是自然的照片，这意味着一些错误的分类可能实际上并不是错误。</p><h2 id="cccb" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">用逻辑回归进行类别预测</h2><p id="f440" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">我测试了逻辑回归，发现它在前面部分足够准确。现在，我可以训练我将用来标记未标记的训练图像的模型。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mv"><img src="../Images/124ca94fd81c5da927d2de90df33dad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oLLGBepFijt9llfTuc2MkQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">我在上面分支中的标记训练数据上训练逻辑回归模型，并使用该模型对看不见的和未标记的测试数据进行预测(图片由作者提供)</p></figure><p id="cb19" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我在顶部分支中标记的训练图像上训练逻辑回归模型(与前一部分中使用的数据相同)。你可以看到我直接将图像嵌入连接到逻辑回归小部件。这样，模型就可以根据提供的数据进行训练。</p><p id="4909" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在底部的分支中，我加载了没有我想要分类的已知类别的测试图像，并用Inception-v3嵌入器将它们嵌入，与训练图像一样。我使用的图片你可以从<a class="ae ms" href="https://github.com/PrimozGodec/datasets/blob/master/image-analytics-collection/test-photos.zip" rel="noopener ugc nofollow" target="_blank">这里</a>下载。<a class="ae ms" href="https://orangedatamining.com/widget-catalog/evaluate/predictions" rel="noopener ugc nofollow" target="_blank">预测小工具</a>根据之前训练的逻辑回归模型给图像分配标签。</p><p id="46cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用<a class="ae ms" href="https://orangedatamining.com/widget-catalog/image-analytics/imageviewer" rel="noopener ugc nofollow" target="_blank">图像浏览器</a>来检查分配给图像的类别。他们似乎是有意义的，正确的。</p><p id="dafb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们已经对图像进行了分类，我们使用保存图像小部件将它们保存到文件夹结构中，这样每个文件夹就是一个类别。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mw"><img src="../Images/08a37d0b05e6314a2d559f220777a4d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tOmP78UsfrB9D3vzJumwpQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">保存一个模型并将图片分类到电脑中(图片由作者提供)</p></figure><p id="5c75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于预测小部件将预测(名为逻辑回归的列)作为元数据放置到数据表中，因此我们需要首先使用选择列小部件将属性设置为目标——保存图像小部件使用目标列作为子文件夹名称。<a class="ae ms" href="https://orangedatamining.com/widget-catalog/image-analytics/saveimages/" rel="noopener ugc nofollow" target="_blank">保存图像小工具</a>将根据预测的类别将图像分类到子文件夹中。</p><p id="9217" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还将<a class="ae ms" href="https://orangedatamining.com/widget-catalog/model/savemodel" rel="noopener ugc nofollow" target="_blank">保存模型小部件</a>连接到逻辑回归。通过这种方式，模型被保存起来以备后用，并且可以被重用。</p><h2 id="58f5" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">结论</h2><p id="a6fc" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">我们展示了一种可以在各种任务中使用的监督分析图像的方法。图像分类需要额外的工作来准备训练数据集，这导致了识别类别的自动管道，并且可以在未来多次使用。</p><p id="5d61" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要了解更多关于Orange中的图像分析，<a class="ae ms" href="https://youtube.com/playlist?list=PLmNPvQr9Tf-aRstY69vGAPO_c5RaceBhN" rel="noopener ugc nofollow" target="_blank">观看教程视频</a>或阅读Orange网站上的博客:<a class="ae ms" href="https://orangedatamining.com/blog/2017/04/03/image-analytics-clustering/%5D" rel="noopener ugc nofollow" target="_blank">图像分析:聚类</a>，<a class="ae ms" href="https://orangedatamining.com/blog/2018/05/09/clustering-of-monet-and-manet/" rel="noopener ugc nofollow" target="_blank">莫奈和马奈的聚类</a>，以及<a class="ae ms" href="https://orangedatamining.com/blog/2017/04/25/outliers-in-traffic-signs/" rel="noopener ugc nofollow" target="_blank">交通标志中的离群值</a>。</p><p id="d979" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你还没有阅读，请不要忘记阅读我的人人图像分析系列的第一篇博客。</p><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/image-analytics-for-everyone-image-embeddings-with-orange-7f0b91fa2ca2"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">面向所有人的图像分析:用Orange嵌入图像</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">什么是图像嵌入，如何在不编码的情况下用机器学习分析图像？</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no lo na"/></div></div></a></div><h2 id="61ca" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">文学</h2><ol class=""><li id="ba0c" class="np nq it kk b kl mn ko mo kr nr kv ns kz nt ld nu nv nw nx bi translated">demar，Janez，等,《橙色:Python中的数据挖掘工具箱》。<em class="ny">机器学习研究杂志</em>，2013，14.1:2349–2353。</li><li id="2022" class="np nq it kk b kl nz ko oa kr ob kv oc kz od ld nu nv nw nx bi translated">Godec，Primo等人通过深度模型和小规模机器学习的集成，通过可视化编程实现了图像分析的民主化。<em class="ny">自然通讯</em>，2019，10.1:1–7。</li><li id="8d7f" class="np nq it kk b kl nz ko oa kr ob kv oc kz od ld nu nv nw nx bi translated">逻辑回归。纽约:斯普林格出版社，2002年。</li><li id="1d51" class="np nq it kk b kl nz ko oa kr ob kv oc kz od ld nu nv nw nx bi translated">西蒙扬，卡伦；安德鲁·塞斯曼。用于大规模图像识别的非常深的卷积网络。<em class="ny"> arXiv预印本arXiv:1409.1556 </em>，2014年。</li><li id="9da1" class="np nq it kk b kl nz ko oa kr ob kv oc kz od ld nu nv nw nx bi translated">重新思考计算机视觉的盗梦空间架构。发表于:<em class="ny">IEEE计算机视觉和模式识别会议论文集</em>。2016.第2818–2826页。</li></ol><h2 id="d72d" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated">我的其他文章</h2><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/keyword-extraction-methods-the-overview-35557350f8bb"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">关键词提取方法—概述</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">关键词提取方法在文档中查找相关关键词。这篇文章总结了最常见的方法…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="oe l nl nm nn nj no lo na"/></div></div></a></div><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/documents-embeddings-and-text-classification-without-coding-e274b4e191e9"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">无需编码的文档嵌入和文本分类</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">什么是文档嵌入，如何在没有一行代码的情况下对文本进行分类？</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="of l nl nm nn nj no lo na"/></div></div></a></div><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/graph-embeddings-the-summary-cc6075aba007"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">图形嵌入——综述</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">本文介绍了什么是图嵌入，它们的用途，以及最常用的图嵌入的比较。</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="og l nl nm nn nj no lo na"/></div></div></a></div></div></div>    
</body>
</html>