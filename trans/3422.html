<html>
<head>
<title>Cyber Criminals vs Robots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络罪犯vs机器人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cyber-criminals-vs-robots-f60b8a86114a#2022-07-28">https://towardsdatascience.com/cyber-criminals-vs-robots-f60b8a86114a#2022-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="baf8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建网络入侵检测和防御的集成模型</h2></div><p id="eb31" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">除非另有说明，所有图片均为作者所有</em></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/8586b2205d60da4146054e2f783d527f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEVbq1xru7MBZhi06vyDSQ.jpeg"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated"><a class="ae ls" href="https://pixabay.com/illustrations/technology-sci-fi-futuristic-7111801/" rel="noopener ugc nofollow" target="_blank">链接</a> ⁷</p></figure><h1 id="6063" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">介绍</h1><p id="9c02" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">网络罪犯面对机器人会怎样？当他们使用机器人时会发生什么？随着人工智能的不断发展，网络安全的攻防策略将如何演变？人工智能和网络安全都年复一年地登上增长最快行业的排行榜。这两个领域在许多领域有重叠，而且毫无疑问在未来几年还会继续重叠。对于本文，我将范围缩小到一个特定的用例，入侵检测。入侵检测系统(IDS)是一种监控公司网络恶意活动的软件。我深入研究了人工智能在入侵检测系统中的作用，使用机器学习编写了我自己的IDS代码，并进一步演示了如何使用它来帮助威胁猎人。</p><h1 id="5217" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">问题定义</h1><p id="472d" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">最近，不到一半的公司在其入侵检测系统中利用机器学习。最常见的IDS仅仅依赖于一种叫做“签名匹配”的技术。基于签名的入侵检测发现“可能匹配特定已知攻击者IP地址、文件哈希或恶意域的序列和模式”；然而，它在检测未知攻击方面有很大的局限性。许多网络罪犯了解签名匹配是如何工作的，并将改变他们的行为以避免被发现。虽然签名匹配已被证明是有用的，但在不断变化的网络威胁环境中，它本身并不是一个解决方案。相反，签名匹配必须辅之以适应性更强的解决方案:机器学习。使用来自网络流量的特征，机器学习不仅检测以前发生过的攻击，而且它足够动态以检测全新的攻击。</p><p id="cfc8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我的入侵检测算法，我想关注的具体问题是优化精度和召回率。在入侵检测环境中，错误会给组织带来巨大的成本。误报可能会导致未被发现的系统漏洞，从而带来潜在的灾难性后果。过多的恶意样本误报警报会降低对系统的信心，并将关键安全人员引向死胡同，导致他们降低优先级，无法缓解实际攻击。量化和优化这种权衡是另一个独立的研究项目，可能因组织而异。在本文中，我假设假阴性比假阳性更糟糕，但尽量减少两者。在评估结果时，我试图根据组织的加权成本来量化这种关系，假设假阴性的成本是假阳性的两倍。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/45078314d88e298207403021ead4df88.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*GariirLKHPiSB1A5Blhkuw.png"/></div></figure><h1 id="da94" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">数据</h1><p id="412c" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">对于这个项目，我使用了⁴的NSL-KDD数据集，这是1999年KDD Cup数据集的改进版本。该数据由模拟美国空军局域网环境的局域网(LAN)中9周的原始tcpdump流量组成。该数据集中的特征是根据原始tcpdump设计的。大多数特性描述可以在<a class="ae ls" href="https://kdd.ics.uci.edu/databases/kddcup99/task.html" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae ls" href="https://www.aldapa.eus/res/gureKddcup/README.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>找到。每行代表给定时间点的网络流量样本，每个网络样本可以标记为“恶意”或“良性”,并分为攻击类别DoS(拒绝服务)、R2L(远程到本地)、U2R(用户到根)和探测。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/c2b810c774c3093d38cbcf211b914ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*JEv0kvPU3U7UhFj9cCAROQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">NSL-KDD数据预览</p></figure><h1 id="b524" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">相关著作</h1><p id="c23b" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">这个项目的灵感来自大卫·freeman⁴.的《机器学习安全》一书在网络流量分析一章中，Chio和Freeman探索了一种用于入侵检测的集成方法。最终的结果是一个在召回方面表现很好的系统，但是在precision⁵.方面却没有达到标准我的系统考虑并实现了他们的许多策略，对它们进行优化以提高精确度和召回率。他们的集合模型的结果，如下图所示，将作为基线。</p><p id="1d2b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">准确度</em> : 85% </strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/a9ed22ce654253470735cd074db925c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*AL8WUxXJL6gzPM_JO8pRwA.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">分类报告:Chio/Freeman模型</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/fa469b827f2c85c25be90c8643865290.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*N8GwKESptAsCMbBIkBBXVg.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">分类报告:Chio/Freeman模型</p></figure><h1 id="b005" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">方法学</h1><h2 id="520f" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">特征选择</h2><ol class=""><li id="f4f2" class="ng nh iq kh b ki ml kl mm ko ni ks nj kw nk la nl nm nn no bi translated">对连续、二元和标称列进行分类</li><li id="4c5e" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">删除只有1个值的所有要素。num_outbound_cmds只有一个唯一值，所以我将其从数据集中删除。</li><li id="eadf" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">根据属性类型验证数据(su_attempted应该是一个二进制属性，但有3个值)</li><li id="74ca" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">一次性编码分类变量</li></ol><h2 id="64b0" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">重采样</h2><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/65cfed3aad6e55bf6783ab07c1b89fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*Oef_u3FsNdGa3HdsHty0bA.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">培训:攻击类别分布</p></figure><p id="e989" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了最大限度地提高召回率，并创建一个适用于不常见和看不见的攻击的模型，我需要确保这些不常见的攻击在训练数据中得到更好的体现。如上所述，尽管恶意和良性标签分布相当均匀，但在我们的训练数据中，攻击类别的分布非常不均匀。为了增加一些少数类的表示并减少一些多数类的表示，我采用了一种结合过采样和undersampling⁵.的重采样方法</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/5cade46ed62b6af73514607e15d996b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*33Oe9_jxQlETMeyDFdYK2g.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">训练:重新采样的攻击类别分布</p></figure><p id="07c1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用不平衡学习中的SMOTE ⁰和RandomUnderSampler类，我现在有了一个平衡的训练集。</p><h2 id="eefb" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">预测攻击类别—多类建模</h2><p id="1506" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我专注于入侵检测；但是，识别正确的攻击类别将有助于威胁猎人进行入侵防御。我在训练数据上交叉验证了4个分类模型，比较了准确性。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/c22210ff51ee13cc0bee1262fc9fee30.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*camCE_w6pa_19ZPgecQ6XQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">多类别三重交叉验证</p></figure><p id="b7aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">树模型的表现比线性模型(逻辑回归)好得多，其中XGBoost的结果最好。</p><p id="2968" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在整个训练集上拟合XGBoost模型并预测测试结果，我得到以下结果:</p><p id="7e2c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">准确率</em> : 79% </strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/b60e9e5b6f9e45caa55cdf789f859e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*flAnKbyjAyS_c4P9DL1tFQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">XGBoost多分类器:多类结果</p></figure><p id="dfe1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">XGBoost在识别探测和拒绝服务攻击方面做得很好，但在R2L和U2R方面缺乏召回，这在初始训练集中较少出现。重采样有助于改善这种情况；然而，这些类的训练属性不足以代表测试数据。</p><p id="3745" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将攻击类别分为恶意攻击和良性攻击，以下是二进制结果:</p><p id="8d7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">T5精度 : 81% </strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/2d3e6b10d05d4587bfcf8095568def96.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*e0ZlLzqEenWTjgQob4U4FQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">分类报告:XGBoost多分类器</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/a991304252ec9f548e27bb8f17261fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*J0teLCzQ9xOWs9sZyhh_qg.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">混淆矩阵:XGBoost多分类器</p></figure><p id="60ee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">攻击类别的多类分类在识别攻击类别方面做得不错；然而，它识别恶意样本的召回率太低。我决定将重点更多地放在入侵检测而不是攻击分类上，但在选择算法时仍然重视上面的结果。我将把它作为前进的基线，并把它合并到仪表板中。</p><h2 id="4af1" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">入侵检测—二元分类</h2><p id="483c" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated"><strong class="kh ir">特征减少</strong></p><p id="8f33" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我决定通过SelectPercentile⁶减少特征的数量，执行ANOVA测试并返回特征的f值，以确定它们与目标向量的独立相关性。经过一些试验，我决定根据F值保留前33%的特性。</p><p id="d623" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">模型选择的指标</strong></p><p id="097a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我计划在入侵检测的上下文中优化精确度和召回率，所以在所有阈值下最大化模型的性能是很重要的。因此，受试者工作特征(ROC)曲线下面积(AUC)是在选择模型时最大化的合适指标。ROC曲线描绘了真阳性率(TRR)对假阳性率(FPR)。这条曲线下的区域将告诉我们随机选择的恶意示例比随机选择的良性示例得分更高的概率。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/61e5f79aee23e642fa8b371459bb5e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*05jLWskOYAbIjNDcmEV5Qg.png"/></div></figure><p id="dae3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在使用5重交叉验证比较不同模型的AUC后，森林模型优于其他模型，尤其是XGBoost。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/335811fd08faab1950606a300644ca53.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*gOa0An0Dzr5MnJG3L3u-lQ.png"/></div></figure><p id="7b02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面我建立了一个管道来标准化这些特性，用SelectPercentile减少它们，并使数据适合XGBoost分类器。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="ddc3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">阈值选择</strong></p><p id="8262" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将数据分为训练和验证，将模型拟合到训练数据，并绘制验证结果的ROC曲线。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/dc70651993128d999ee834d38608f652.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*Ag-4i3Pg4zZnemL43Q9mdQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">受试者工作特征曲线</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/f30287c8a6c282558358b29f6613e198.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*sdMORB-uQe8yluVq-B-BTA.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">ROC曲线(放大)</p></figure><p id="0dde" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请记住，我们的目标是最大限度地提高精确度和召回率，重点是召回率。这将最大限度地减少通过检测系统的攻击数量，而不会因为标记太多的误报而牺牲算法的完整性。如上所述，我可以调整阈值来提高真阳性率，而不会显著增加假阳性率。设置真阳性率为1的阈值意味着没有假阴性；因此，该模型会标记每一个恶意样本。为此，我选择了最佳阈值0.0050058886，创建了100%的验证召回率和98%的精确度。当预测恶意样本时，这意味着根据模型的预测概率，任何具有至少0.5%的恶意概率的样本都会被标记为恶意样本。</p><p id="6a79" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们来看看这个模型的测试结果。</p><p id="6e2d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">准确率</em> : 90% </strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/c9b61e425baf68248b6b1d1a788cb264.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*tv3Vtf9e2NFpF-7CywkWvg.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">分类报告:带阈值的XGBoost</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi od"><img src="../Images/31165b49245f679209f12775782e112d.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*HXs-USRskfpXZXswj4zLCQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">混淆矩阵:带阈值的XGBoost</p></figure><p id="3c78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，该模型的准确率比Chio/Freeman模型提高了5%，准确率提高了16%，召回率降低了6%。</p><p id="825d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想进一步探索在保持高精度的同时提高召回率的方法。想想网络攻击模式，许多攻击者会创建新的恶意软件，这些恶意软件要么与以前的版本略有不同，非常不同，要么是全新的零日漏洞利用。那么，机器学习算法如何标记这些没有在训练数据中表示的实例呢？我转向异常检测。在试验了许多不同的算法之后，我认为集群是最好的方法。</p><h2 id="9ff1" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">使聚集</h2><p id="78ca" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我的目标是用聚类模型来补充分类模型。理想情况下，聚类模型应该能够挑选出一些被分类模型错误标记的恶意样本。在这个模型中，更重要的是平衡精确度和召回率，因为只有当聚类的预测足够精确以覆盖分类器的预测时，聚类才能很好地补充分类。为了在这种情况下最大限度地提高精确度和召回率，我求助于F1分数。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/657cd52e81a363b29c727698802a928f.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*VtR02g2bkd1_tHieiNJ7fQ.png"/></div></figure><p id="d5d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我在2D向量空间中画出了训练集的类。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi of"><img src="../Images/6f327bbb2f86a0ea6569b1143eeccdfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WFfObZH_Ygb8_yFCgiTlZw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">实际的</p></figure><p id="2070" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">乍一看，这些聚类看起来没有很好地定义，但是我可以使用聚类来检测一些明显的异常值。</p><p id="d2bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我拟合了一个简单的2-聚类K-均值模型，使用主成分分析(PCA)来降低维度。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi of"><img src="../Images/7789fe35b3fcf5190604ae8fee062d23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJFBSUPQrKQl84RFsTRL4w.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">预测:2类K均值模型</p></figure><p id="763e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">双聚类模型在表示实际类方面做得很差。我的下一个方法是试验更多的集群，并优化一个策略，将它们映射回恶意或良性。</p><p id="ba80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在对集群数量和策略参数进行多次迭代后，我拟合了一个27集群模型。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi of"><img src="../Images/175d5283741900c62cad3d9cca73f4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oGLevFfTzcONRs2tyPHeJg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">预测:27簇模型</p></figure><p id="b138" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里的集群看起来比双集群模型更加集中和清晰。那么，我的策略是什么，我如何将这些集群映射到良性和恶意的类别标签？这两个问题只有一个答案:</p><p id="c033" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">受Chio和Freeman⁴的启发，这种聚类映射技术包括异常检测和恶意样本的多数类标记。</p><p id="5205" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">策略:</strong></p><ul class=""><li id="3f0e" class="ng nh iq kh b ki kj kl km ko og ks oh kw oi la oj nm nn no bi translated">如果群集中恶意流量的百分比大于95%，则群集中的所有实例都会被标记为恶意。</li><li id="5a0c" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la oj nm nn no bi translated">如果相对于总人口的群集大小小于0.1%，则群集中的所有实例都被标记为恶意实例。</li></ul><p id="e25e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这与Chio和Freeman的模型不同，因为它细化了群集数量、恶意流量百分比和相对群集大小的参数，以最大化F1分数。此外，我的方法只关注于标记恶意实例，而没有在逐簇basis⁴.上使用机器学习模型</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ok"><img src="../Images/feb96add64a38d3a75fc135532ec0275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mLKFYrnuTSruO0l-DIARZw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">前6个集群的集群映射表</p></figure><p id="3647" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来自该策略的每个恶意标签可以追溯到多数恶意聚类或离群点，这将在稍后的模型可解释性中有用。根据该策略映射聚类后，这里是2D向量空间中预测值与实际值的并排比较。</p><div class="ld le lf lg gt ab cb"><figure class="ol lh om on oo op oq paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><img src="../Images/e2abeee9b6d43e1af3af5fb62c31572e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*DzCkpWgeaXkjLjvVTJRnXw.png"/></div></figure><figure class="ol lh om on oo op oq paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><img src="../Images/5e56ce8df3c739a853a154e04df42831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*t8L5x5uUXAxEvLnzcXa9mg.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk or di os ot translated">k-均值映射预测与实际标签</p></figure></div><p id="409d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">映射后，预测和标签看起来几乎相同。</p><h2 id="be73" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">创建集成模型:结合分类和聚类</h2><p id="96fc" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我将XGBoost模型与K-Means模型相结合的方法是覆盖任何XGBoost将样本标记为良性，而K-Means方法将样本标记为恶意的情况。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="be89" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">估价</h2><p id="28a6" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">最终模型的结果如下:</p><p id="b8af" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">准确率</em> : 90% </strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/51ca70af01f7da8ef2a722b8c1ab0764.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*RsgMNGznnhY7fJq1-nO3zQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">分类报告:集合模型</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/f14111bca0b3eee8354513894a4b1ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*POeznFS8nZWKIkCdKAbIlw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">混淆矩阵:集合模型</p></figure><p id="3d4c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在XGBoost模型中增加聚类功能可以在保持精确度的同时提高恶意流量的召回率。算法以仅误标5次的小代价发现了109次新的恶意攻击；从而提高分类器性能，而不降低其完整性</p><p id="5494" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我将这个模型与我讨论过的其他基线模型进行比较之前，定义一个成本函数是很重要的。网络攻击的成本或影响本身是一个完整的研究领域，有许多变量。为了最终在未来扩展这项研究，我在本文中定义的成本函数是一个临时的启发。</p><p id="705c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基于未被发现的网络攻击比假警报更糟糕的逻辑，我假设假阴性的成本是假阳性的两倍。我假设一个组织的平均假警报成本是1000美元；因此，未被发现的网络攻击的平均成本是2000美元的两倍。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/df6ff63255b734aa6aed21ee2e7650a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*UME7vhG246sxi86VH3rVnQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">价值函数</p></figure><p id="bf5e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">结果</strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/aef7f8e58c6b63193872802ce989ad58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*lphTLGWVHcBG1O_V6JthdA.png"/></div></figure><p id="2ace" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从左到右，很明显，映射到二进制标签的XGBoost多类预测器具有97%的最高精度。不幸的是，这种模式在所有其他领域都表现不佳。将集合模型与Chio Freeman模型的主基线进行比较，精度提高了16%，表明入侵检测系统标记样本的置信度提高了。Chio Freeman模型仍然以97%的召回率优于其他模型，我的ensemble模型以92%的召回率紧随其后。我认为这方面仍有改进的余地。整体模型的F1分数优于其他模型，阈值化的XGBoost模型以0.91紧随其后。集合模型比Chio Freeman基线高出0.05。F1的高分实现了我优化精确度和召回率的目标。整体模型和阈值XGBoost模型在准确性上非常相似，二者的舍入准确性都为90%。最后，ensemble模型在加权成本方面优于其他模型，比第二好的模型便宜220，000美元，比Chio Freeman模型便宜540，000美元。</p><p id="65f2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">讨论</strong></p><p id="6369" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然我的模型通过实现最高的F1分数优化了精确度和召回率，但是我没有在入侵检测的上下文中优化这些指标的具体测量。请记住，我的成本函数是一个临时的启发。不同的攻击类别、网络架构、系统和组织有不同的成本。这些都应该是建模新成本函数的考虑因素。例如，探测攻击通常不会给组织造成很大损失，因为它们通常用于监视网络而不是破坏网络。此外，一次成功的拒绝服务攻击可能会让脸书损失300万美元，而当地一家咖啡连锁店只需2000美元。由于并非所有这些数据都是现成的，我的下一步将是研究每种攻击类别的平均成本，并将其包括在计算中。之后，我会调整误报的成本，考虑平均人工成本、错过实际攻击的机会成本，甚至可能是贬值的模型信心的成本。</p><h1 id="754a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">可解释性</h1><p id="86d9" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我的系统现在可以很好地识别攻击。下一步是以自动化的方式解释这些预测，帮助网络防御保护他们的基础设施。可解释的入侵检测系统可以为威胁猎人指出正确的方向。</p><p id="0a0a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<a class="ae ls" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> streamlit </a> python库，我创建了一个概念验证<a class="ae ls" href="https://shaeferd-network-traffic-prediction-detection-dashboard-wo3p21.streamlitapp.com/" rel="noopener ugc nofollow" target="_blank">仪表板</a>，展示了入侵检测系统如何通过标记攻击、按风险对攻击进行优先级排序以及向威胁猎人推荐具体的补救路径来充当入侵防御系统。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi oy"><img src="../Images/bba448a8fe481b59eb56b34a2236f075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*FNRjwn3pZwCSLcDWdEIx3A.gif"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">IDS仪表板</p></figure><h2 id="96e9" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated"><strong class="ak">口译模特</strong></h2><p id="3ce9" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">为了解释集成模型的恶意预测，我必须自动解释XGBoost分类器和K-Means聚类算法。</p><p id="ef4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb"> XGBoost </em>:对于XGBoost，一种选择是提取特征重要性，并潜在地用线性模型拟合数据，以帮助确定方向性。在像XGBoost这样复杂的森林模型中，这不是底层模型的最佳表示。XGBoost模型的完美解释是绘制决策树森林；然而，绘制一个完整的复杂的森林图是很难的，并且对于需要快速工作的安全团队来说也是不切实际的。我求助于软件包LIME(本地可解释的模型不可知解释),它近似了特定instance⁸.附近的模型行为我选择LIME是因为它将复杂的模型分解成易于理解的局部近似和估计。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="f5e4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我的IDS，LIME可以对标记为恶意的样本XGBoost给出本地解释。下表显示了标记特定样品时最重要的10个特征、特征权重和方向性。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi oz"><img src="../Images/6a3769348e7d4c8dd5e52b1e2f9ffcb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Cp4yDmhOyHkdqqz3.png"/></div></div></figure><p id="db26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了预测类别，我使用前面讨论的多类XGBoost模型。</p><p id="ae50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb"> K-Means </em>:为了解释K-Means模型，我首先识别预测的聚类。接下来，我绘制了每个聚类中心的热图，显示了所有特征的相对值，并突出显示了该样本的聚类。就绝对值而言，聚类中心向量中某个特征的高值被视为重要特征，并包含在特征值表中。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi pa"><img src="../Images/f2eda5fd7fcdc8c4bbeeb972d9e8208a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lmD6uFsGt8LfhZqx23nDyw.png"/></div></div></figure><p id="8c54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了预测类别，我采用每个集群中最常见的攻击类别，除非它是一个离群的集群。</p><h2 id="abac" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated"><strong class="ak">风险</strong></h2><p id="1ddb" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我将风险计算为XGboost模型预测样本是恶意的概率，标准化为1到10。我根据国家漏洞数据库的cvss v3.0版影响严重性mappings⁹.将这些风险分值映射到严重性</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/c8689b8041ca36ac7899050b55ebd25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*tsOzTojDLwgx_W-8T1T90g.png"/></div></figure><p id="e0be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将风险分值映射到测试人群的严重性会产生以下分布。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/f0adbff65519f6fc9b45224cbd0bf83a.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*eBe7vdsry0bBhZZpgtHBqw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">测试集的严重性分布</p></figure><p id="ab02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有许多严重程度标志，低是第二高的。仪表板为威胁猎人提供了按严重性过滤的选项，允许他们优先考虑更高严重性的标志。</p><h2 id="97e8" class="mu lu iq bd lv mv mw dn lz mx my dp md ko mz na mf ks nb nc mh kw nd ne mj nf bi translated">补救</h2><p id="900a" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">将入侵检测系统转变为入侵防御系统的最后一步是为威胁猎人指明正确的方向，并提供补救途径。通过查看条形图或热图中突出显示的重要特征，威胁猎人可能会对攻击是如何被检测到的以及问题的根源有一个大致的了解。除了这些图表之外，仪表板还提供了前3个最重要特征的值以及样本可能属于的攻击类别。对于每个攻击类别，我都提供了一个补救途径，这是威胁猎人或安全分析师在验证和补救每个攻击时应该采取的措施的建议。</p><p id="4639" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从开始到结束，仪表板允许任何威胁猎人快速检测攻击，确定它们的优先级，识别要调查的关键特征，预测所述攻击的类别，并为特定攻击提供补救策略。</p><p id="2c0d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我将通过几个例子来演示如何使用仪表板。</p><p id="9232" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">例#1 </em> </strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi pd"><img src="../Images/fb1442453c82c78a126f6e2e8653462c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xllkEW5hLSPfstXla3y0EQ.png"/></div></div></figure><p id="1e05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本例中，威胁猎人希望专注于关键攻击。他将严重性过滤为严重，并选择网络流量的标记样本。该样本的风险分值最高，为10分。这很可能是拒绝服务攻击，这对于威胁猎人来说是有意义的，因为他可以看到有255个连接到同一个目的IP地址(“dst_host_count”)。根据仪表板的建议，威胁猎人调查网络流量日志中的这些连接，确认它们来自已知的僵尸网络，并验证这是一种拒绝服务攻击。他立即通知事件响应和网络安全部门阻止这些连接并转移流量。</p><p id="f3ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">例二</em> </strong></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi pe"><img src="../Images/fae8ed31ffd97ca408a819b57bb58911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ddqVSsRCWKpgI1Vrakc5Q.png"/></div></div></figure><p id="11d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在处理完当天的高优先级问题后，安全分析师的任务是调查一些已经在队列中等待了一段时间的低优先级项目。他注意到这个样本是一个异常值，并希望进一步调查。根据仪表板的建议，他调查了哪些功能可能会导致该流量被标记。他认为失败的登录尝试增加了系统的怀疑。他监视该用户的活动，并注意到更多失败的登录尝试，这些尝试通常是在工作时间之外通过远程连接进行的。分析师与系统管理员合作，通过要求通过跳转服务器进行远程连接并添加双因素身份认证来加强服务器的安全性。失败的登录尝试次数在接下来的一周内逐渐减少。</p><p id="7cf9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">讨论</strong></p><p id="0841" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在指出仪表板和可解释性模型中需要改进的地方时，我想参考风险分值计算、多类别模型、补救路径协调以及构建生产就绪仪表板。</p><p id="ba0a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用了一种临时的启发式方法来衡量风险。这应根据行业标准进行调整，并根据攻击类别和主机系统进行不同的加权。此外，应该有更好的方法来量化K均值预测的风险。</p><p id="d2a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个下一步是改进预测攻击类别的多类XGBoost模型。我决定更多地关注入侵检测而不是攻击分类，但我最终还是在仪表板中加入了多类模型来帮助威胁猎人。改进模型的一个方法是从训练集中去掉良性样本，只标记恶意样本，因为我已经有了一个IDS。改进此模型可以以最少的工作获得最大的收益，并增加对仪表板预测类别和补救途径的信心。</p><p id="3b50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">说到这里，补救路径应该由主题专家来定义。虽然我尽我所知编写了补救措施，但我希望听取有经验的威胁分析师的意见，以完善建议并提供新的建议。</p><p id="68f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果是为组织构建，最后一步是在生产环境中设置仪表板。这将意味着建立一个ETL来从系统的网络流量中提取相关的特性，将其流式传输到仪表板，实时更新仪表板，并结合一个反馈回路来重新调整模型。</p><h1 id="db82" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="1a09" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">通过集成模型，我实现了优化精度和召回率的目标。使用结合了XGBoost和K-Means的高级集成，我能够在许多领域超越他人，包括我定义的加权成本指标。由于一些模型仍然比我的模型有优势，而且加权成本指标是一种主观的启发，我不能客观地声称我的模型整体上优于其他模型。尽管如此，这个模型确实实现了我的既定目标。</p><p id="4b21" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我相信这个项目的主要收获是，人工智能是一种有价值的工具，可以在入侵检测方面帮助网络安全团队。机器学习是针对IDS规避技术和这一领域中不断发展的威胁因素的强大解决方案。此外，这些模型可以与安全团队相互帮助。它们有能力检测大量人类无法自己模式化的威胁，为威胁猎人指明正确的方向，并融入用户反馈以适应新的场景。</p><p id="67c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么当网络罪犯面对机器人时会发生什么？这个问题应该重新定义。人工智能在检测大量威胁的能力方面非常出色，但它也有许多弱点，如模型退化、容易中毒和被黑客攻击，以及无法自动修复复杂或看不见的攻击。人类缺乏实时处理如此大量数据的能力，但拥有追踪和阻止一些最复杂的网络犯罪所需的创造力和商业头脑。机器学习模型可以填补网络响应团队的许多空白，反之亦然。入侵检测系统和威胁猎人相互补充，以创建一个更强大的系统。因此，问题应该是，“当网络罪犯面对电子人时会发生什么？”当人类和人工智能一起抵御网络犯罪时，威胁行为者可能不会喜欢这个答案。</p></div><div class="ab cl pf pg hu ph" role="separator"><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk"/></div><div class="ij ik il im in"><p id="8817" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://github.com/shaeferd/Network-Traffic-Prediction" rel="noopener ugc nofollow" target="_blank"> <em class="lb">链接到代码</em> </a></p><p id="bbae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://shaeferd-network-traffic-prediction-detection-dashboard-wo3p21.streamlitapp.com/" rel="noopener ugc nofollow" target="_blank">链接到仪表板</a></p><p id="1295" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="http://shaeferdrew.com" rel="noopener ugc nofollow" target="_blank">我的网站</a></p></div><div class="ab cl pf pg hu ph" role="separator"><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk"/></div><div class="ij ik il im in"><p id="a9f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">参考文献</em> </strong></p><ol class=""><li id="bd8b" class="ng nh iq kh b ki kj kl km ko og ks oh kw oi la nl nm nn no bi translated">费尔德曼，莎拉和菲利克斯·里克特。“检测安全入侵是2018年最热门的人工智能应用。”<em class="lb"> Statista信息图</em>，Statista，2019年4月5日，<a class="ae ls" href="https://www.statista.com/chart/17630/artificial-intelligence-use-in-business/." rel="noopener ugc nofollow" target="_blank">https://www . Statista . com/chart/17630/artificial-intelligence-use-in-business/。</a></li><li id="a6b8" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">雷塞克迈克尔。"基于特征和基于行为的入侵检测系统有什么区别？"<em class="lb"> Accedian </em>，Accedian，2022年6月29日，<a class="ae ls" href="https://accedian.com/blog/what-is-the-difference-between-signature-based-and-behavior-based-ids/." rel="noopener ugc nofollow" target="_blank">https://Accedian . com/blog/what-is-the-difference-based-and-behavior-based-ids/。</a></li><li id="e1b4" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">Mahbod Tavallaee等人，“KDD杯99数据集的详细分析”，<em class="lb">第二届IEEE安全和国防应用中的计算智能研讨会会议录</em>(2009):53–58。</li><li id="ecae" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">齐奥、克拉伦斯和大卫·弗里曼。<em class="lb">机器学习和安全:用数据和算法保护系统</em>。奥莱利媒体公司，2018年。</li><li id="b9d9" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">你好，克拉伦斯。"图书资源/NSL-KDD-分类. ipynb at Master Oreilly-ml sec/图书资源."<em class="lb"> GitHub </em>，Oreilly，<a class="ae ls" href="https://github.com/oreilly-mlsec/book-resources/blob/master/chapter5/nsl-kdd-classification.ipynb." rel="noopener ugc nofollow" target="_blank">https://GitHub . com/Oreilly-ml sec/book-resources/blob/master/chapter 5/nsl-KDD-classification . ipynb .</a></li><li id="c452" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">" sk Learn . feature _ selection . select percentile . "<em class="lb">sci kit</em>，Scikit-Learn，<a class="ae ls" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectPercentile.html." rel="noopener ugc nofollow" target="_blank">https://sci kit-Learn . org/stable/modules/generated/sk Learn . feature _ selection . select percentile . html .</a></li><li id="fab4" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated"><a class="ae ls" href="https://pixabay.com/illustrations/technology-sci-fi-futuristic-7111801/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/插图/科技-科幻-未来派-7111801/ </a></li><li id="cda1" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">"局部可解释的模型不可知解释(LIME). "<em class="lb">本地可解释的与模型无关的解释(Lime) — Lime 0.1文档</em>，GitHub，<a class="ae ls" href="https://lime-ml.readthedocs.io/en/latest/." rel="noopener ugc nofollow" target="_blank">https://lime-ml.readthedocs.io/en/latest/.</a></li><li id="12a2" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">“漏洞指标。”<em class="lb">https://nvd.nist.gov/vuln-metrics/cvss.</em>NVD<a class="ae ls" href="https://nvd.nist.gov/vuln-metrics/cvss." rel="noopener ugc nofollow" target="_blank">NVD</a></li><li id="084b" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">“击杀。”<em class="lb"> SMOTE —版本0.9.1 </em>，不平衡学习，<a class="ae ls" href="https://imbalanced-learn.org/stable/references/generated/imblearn.over_sampling.SMOTE.html." rel="noopener ugc nofollow" target="_blank">https://不平衡学习. org/stable/references/generated/imb Learn . over _ sampling . SMOTE . html</a></li><li id="3a6c" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">"随机抽样器"<em class="lb"> RandomUnderSampler —版本0.9.1 </em>，不平衡学习，<a class="ae ls" href="https://imbalanced-learn.org/stable/references/generated/imblearn.under_sampling.RandomUnderSampler.html." rel="noopener ugc nofollow" target="_blank">https://unbalanced-Learn . org/stable/references/generated/imb Learn . under _ sampling . RandomUnderSampler . html .</a></li><li id="3704" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">增长最快的工作部门:人工智能、数据科学和网络安全。<em class="lb">招聘能力</em>，招聘能力，2020年3月23日，<a class="ae ls" href="https://www.therecruitability.com/ai-data-science-and-cybersecurity-americas-fastest-growing-jobs-sectors/." rel="noopener ugc nofollow" target="_blank">https://www . therecruitability . com/ai-data-science-and-cyber security-Americas-fast-growth-jobs-sections/。</a></li><li id="bec7" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">“简化文档”<em class="lb">细流文档</em>，细流，<a class="ae ls" href="https://docs.streamlit.io/." rel="noopener ugc nofollow" target="_blank">https://docs.streamlit.io/.</a></li><li id="2618" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">" NSL-KDD数据集."<em class="lb">新不伦瑞克大学Est.1785 </em>，https://www.unb.ca/cic/datasets/nsl.html. UNB<a class="ae ls" href="https://www.unb.ca/cic/datasets/nsl.html." rel="noopener ugc nofollow" target="_blank"/></li></ol></div></div>    
</body>
</html>