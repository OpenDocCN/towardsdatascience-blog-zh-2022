<html>
<head>
<title>Predicting Essay Effectiveness through MLP + BERT</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过MLP +伯特预测论文有效性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-essay-effectiveness-through-mlp-bert-4e8e8d6562ad#2022-10-11">https://towardsdatascience.com/predicting-essay-effectiveness-through-mlp-bert-4e8e8d6562ad#2022-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9d9e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak"> <em class="ki">利用BERT的分类和数值特征改进模型</em> </strong></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/89e08b8346154a949558c7cdce42e74e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8e7lZ07WGNgWkngK"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@florianklauer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">弗洛里安·克劳耶</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="a364" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">有效写作一直是确保有效交流思想、批判性思维和说服力的关键。写作作为一种技能是在现代社会取得成功的必要条件。然而，尽管全球识字水平正在缓慢提高，但各国和社会人口群体之间的增长并不均衡。例如，多项研究表明，美国存在<a class="ae kz" href="https://en.wikipedia.org/wiki/Educational_inequality_in_the_United_States#:~:text=Disparities%20in%20academic%20access%20among,the%20student%20and%20their%20school." rel="noopener ugc nofollow" target="_blank">教育不平等</a>的例子。这种现象最终可能导致基尼系数不断扩大的恶性循环。</p><p id="b756" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">解决这个问题的一个办法是让学生评估自己的写作效果。通过开发自动指导，学生可以评估他们自己的写作效果，这使他们能够用更少的专用资源更高效地学习。这个解决方案可以是一个网络应用程序的形式，学生上传他们的议论文，并给出一个输出来评估论文的有效性</p><p id="e742" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这项比赛的目标是将学生写作中的议论文要素分为“有效”、“足够”或“无效”。</p><p id="9dda" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">数据集</strong></p><p id="df12" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">数据集由Kaggle通过佐治亚州立大学提供。本文中不会有数据分布。数据可以在<a class="ae kz" href="https://www.kaggle.com/competitions/feedback-prize-effectiveness/data" rel="noopener ugc nofollow" target="_blank">卡格尔</a>上找到。</p><p id="b320" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">数据探索</strong></p><p id="5475" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">从表面上看，所提供的数据集只包含一列文本语料库。然而，我们可以通过上下文知识设计多个特征，这将使我们的模型表现得更好。</p><p id="12e1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">引文</strong></p><p id="b041" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">每个大学生都知道引用对提高你的文章的有效性有多重要。因此，如果在文本正文中检测到任何“源”,我们创建一个标记真/假的特征。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lw"><img src="../Images/46cf823a47f3e4a61de8e59bacf54f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIhJFdl7m_IW_wZVncKhzw.png"/></div></div></figure><p id="f60a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">很明显，有效的文章有“源”在场。</p><p id="5d98" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">拼写错误</strong></p><p id="455f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">利用python库<a class="ae kz" href="https://pypi.org/project/tqdm/" rel="noopener ugc nofollow" target="_blank"> tqdm </a>识别最常见的拼写错误。我没有把它做成一个二元特征(是/没有拼写错误)，而是把它做成一个带有拼写错误数量的数字特征。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lx"><img src="../Images/779fe89afe1ebe5616fbe708ba53085c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N4qK5KDU6I3nu9fOnYFxwg.png"/></div></div></figure><p id="b6ce" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">虽然所有目标特征的中值分数大致相同，但显然无效文章的分布范围更广。</p><p id="dbfc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">字数</strong></p><p id="3866" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">与其他课程相比，有效的文章有相对较高的单词中位数</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lx"><img src="../Images/1e9c41ac35ab1d429e9fe903dc583526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBXuHS6PP1bTL1TcVWojVQ.png"/></div></div></figure><p id="221f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">极性和主观性</strong></p><p id="f1d0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">极性和主观性很大程度上源自python包<a class="ae kz" href="https://textblob.readthedocs.io/en/dev/" rel="noopener ugc nofollow" target="_blank"> textblob </a>，它提供了一个简单的NLP API。文本语料库的极性被评分在-1到1之间，其中-1表示负面情绪，+1表示正面情绪。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lx"><img src="../Images/ec914524cb5e8268ae72bca49b06ec2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xFT5u4RCpnefDmxZGnPkhw.png"/></div></div></figure><p id="7e28" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">文本语料库的主观性评分在0到1之间，其中0代表客观性，1代表主观性。基于数据集，与其他班级相比，有效论文通常倾向于具有稍高的中位数。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lx"><img src="../Images/2183228b92e2d568367faa095aff6e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3DU4Jc7S-FNDjvZ-FWmgzw.png"/></div></div></figure><p id="e08b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">数据建模</strong></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ly"><img src="../Images/c04a82c038893fd74204ae422dadc0f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99dun6B818yxrET5fIk6EA.png"/></div></div></figure><p id="93b4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">用橙色突出显示的是通过<a class="ae kz" href="https://github.com/georgian-io/Multimodal-Toolkit" rel="noopener ugc nofollow" target="_blank">多模态工具包</a>处理的工具包。数据预处理代码片段可以在下面找到。我对分类特征使用了<a class="ae kz" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" rel="noopener ugc nofollow" target="_blank">一键编码</a>，对数字特征使用了yeo-johnson变换，因为数字特征中的一些数据可能非常小或者是负数。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="lz ma l"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">默认变换是<a class="ae kz" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" rel="noopener ugc nofollow" target="_blank"> One Hot编码</a>和<a class="ae kz" href="https://statisticaloddsandends.wordpress.com/2021/02/19/the-box-cox-and-yeo-johnson-transformations-for-continuous-variables/" rel="noopener ugc nofollow" target="_blank"> yeo-johnson变换</a></p></figure><p id="efb3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">定义指标</strong></p><p id="3ada" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">因为这是一个多类、分类问题。使用准确度、F1分数和训练损失来评估结果。结果在准确性方面实现了边际增加(0.63到0.68)，而在F1方面实现了更高的增益(0.46到0.59)。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mb"><img src="../Images/6300f9a9bdb240a6dedc3aba30be9593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNdXq5Ka5UjDkOOZf7rZJg.png"/></div></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mc"><img src="../Images/088c5ebac4cdf97e19771744e2bee57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXkL028XhiMLMt1Mj286KA.png"/></div></div></figure><p id="9a97" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">损失函数表明存在收敛，但在10k步后达到稳态。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi md"><img src="../Images/c3e49267d10633d6b1964de97a638416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oNjM2GzZAnAdxkfp5Jm2yg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">不同训练的评估损失。</p></figure><p id="fc7f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">结论</strong></p><p id="d456" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在第一轮比赛中，我采用了一个普通的BERT模型，并在语料库上对它进行了训练。然而，结果并不一致，结果很差。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi me"><img src="../Images/ecd6e3fb22eee9063cf9dd37bcadc77a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eYOPdgBicJvz-lGUGEJClg.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">香草伯特模型的第一次迭代</p></figure><p id="ea95" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在第二次迭代中，我创建了额外的功能，为问题陈述提供了背景，很像教师在评估论文有效性时直观使用的评分标准或清单。这使得所有性能指标的模型性能都有了很大的提高。如果我们使用多类对数损失对其进行评估，结果将更容易解释，因为它输出了每类的概率。有关性能评估的更多信息，请参考我的github <a class="ae kz" href="https://github.com/kmt112/Predicting-Effective-Arguments_kaggle" rel="noopener ugc nofollow" target="_blank"> repo </a>，我在那里上传了EDA和建模笔记本。</p><p id="bfbc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">另一个可以实现的关键改进是将话语类型作为特征分析的一部分。如果不包含这个特性，它就类似于用反驳的方式来评估引导段落。</p><p id="213b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">消息来源</strong></p><p id="046a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">[1]数据集:<a class="ae kz" href="https://www.kaggle.com/competitions/feedback-prize-effectiveness" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/competitions/feedback-prize-effectiveness</a>。</p><p id="378c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">[2]造型:<a class="ae kz" href="https://github.com/georgian-io/Multimodal-Toolkit" rel="noopener ugc nofollow" target="_blank">https://github.com/georgian-io/Multimodal-Toolkit</a></p></div></div>    
</body>
</html>