<html>
<head>
<title>I Created Music From Data Using Python!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我用Python从数据中创造了音乐！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/i-created-music-from-data-using-python-adfc349f55f1#2022-08-04">https://towardsdatascience.com/i-created-music-from-data-using-python-adfc349f55f1#2022-08-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7153" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">阅读了解我如何将比特币的价格波动数据转化为音乐。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/54f76e5a834b4aed3f80476bea45c0ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GLICS0sUi0Y_NvMh4l4V6A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马塞拉·拉斯科斯基在<a class="ae ky" href="https://unsplash.com/s/photos/music?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="44f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> F </span>首先，下面是我在<a class="ae ky" href="https://www.youtube.com/watch?v=rPg0wXs1HFA&amp;ab_channel=STRXMOS" rel="noopener ugc nofollow" target="_blank">比特币数据发音</a>上的音乐视频链接。喜欢的话可以继续看下去！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="me mf l"/></div></figure></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="5f5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用可视化来讲述数据。这是最常见的方法。条形图、折线图等就是一些例子。存在几种类型的数据可视化技术，其中大多数都有一个共同点。它们是基于图像的，信息被转换成视觉语境。</p><p id="58f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然不是很流行，但我们可以将声音用于同样的目的，即数据可视化。对此有一个不同的术语——数据语音化。在这里，我们用声音或音乐来呈现信息。</p><h1 id="cbce" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">音乐元素</h1><p id="8b03" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">让我们来了解一下对音乐的一些基本理解，以及它的特别之处。我们把声音视为音乐或噪音。音乐可以被定义为令我们耳朵愉悦的有序而有规律的声波。噪音与此相反，刺耳无序。不可能将每种声音都归类为音乐或噪音，因为这部分有点主观，可以有不同的解释。</p><p id="59d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，为了使数据发音或音乐，我们需要从数据中产生有序的声波。以下是构成音乐的一些元素:</p><ol class=""><li id="86d5" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><strong class="lb iu">音高</strong>——(或频率)是每秒产生的振动次数。人类能够听到20Hz到20，000 Hz之间的声波。这是我们的听觉频谱。我们可以把这个频谱分成3个简单的部分:低音(20-250赫兹)，中音(250-4000赫兹)，高音(4000赫兹以上)。</li><li id="3670" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu">动态</strong>——(或振幅)是声波的高度，决定声音的响度。振幅较大的声音比较响亮，振幅较小的声音比较柔和。它是用分贝来衡量的。</li><li id="548d" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu">节拍</strong> —是每秒钟的节拍数(bpm)。bpm较高的音乐比较快，bpm较低的感觉比较慢。这决定了音乐应该有多快或多慢。</li><li id="f1aa" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu">音色</strong> —这只是音乐的音调或用来发出声音的乐器类型。比如长笛和吉他的音色就不一样。</li></ol><p id="610b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将数据值映射到音乐的一个或多个元素，用数据制作音乐成为可能。例如，您可以选择分配乐器在低数据值时以低音调演奏，在高数据值时以高音调演奏。通过将数据值映射到音乐元素，我们可以创建不同的音乐变体。虽然有几种可能的方法来映射这些值，但只有少数组合听起来确实不错。正是这一点使得数据发音有点棘手。</p><h1 id="5ea7" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">将数据映射到音乐元素</h1><h2 id="9f61" class="ny mo it bd mp nz oa dn mt ob oc dp mx li od oe mz lm of og nb lq oh oi nd oj bi translated">步骤1:下载数据</h2><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="6004" class="ny mo it ol b gy op oq l or os">import music21 as m21<br/>from midiutil import MIDIFile<br/>import yfinance as yf<br/>from datetime import datetime<br/>from sklearn.preprocessing import MinMaxScaler</span><span id="0d94" class="ny mo it ol b gy ot oq l or os">df = yf.download(tickers='BTC-USD', period = 'max', interval = '1d')<br/>df['days'] = np.arange(len(df))</span></pre><p id="ece1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe ou ov ow ol b">yfinance</code> python库可以轻松下载加密货币数据。下载完数据后，我将日期转换成一系列数字。</p><h2 id="a364" class="ny mo it bd mp nz oa dn mt ob oc dp mx li od oe mz lm of og nb lq oh oi nd oj bi translated">第二步:设置音乐时长</h2><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="a975" class="ny mo it ol b gy op oq l or os"># time data (in beats)</span><span id="c68f" class="ny mo it ol b gy ot oq l or os">music_duration = 120 #seconds<br/>tempo = 85 #bpm<br/>scaler = MinMaxScaler((0,music_duration*(tempo/60)))<br/>beats = scaler.fit_transform(df['days'].values.reshape(-1,1)).reshape(-1)</span></pre><p id="a781" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我选择音乐持续时间为120秒，速度为85。现在，我缩放数据的总长度以适合120秒的持续时间(根据速度调整)。</p><p id="3651" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">改变速度值会极大地改变最终的音乐。您可以尝试不同的速度值。</p><h2 id="5f92" class="ny mo it bd mp nz oa dn mt ob oc dp mx li od oe mz lm of og nb lq oh oi nd oj bi translated">第三步:操纵数值</h2><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="28a4" class="ny mo it ol b gy op oq l or os"># compress value</span><span id="198e" class="ny mo it ol b gy ot oq l or os">values = df.Close.values</span><span id="95a6" class="ny mo it ol b gy ot oq l or os"># map values optional<br/># scaler = MinMaxScaler((0,1))<br/># values = scaler.fit_transform(values.reshape(-1,1))</span></pre><p id="3b12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果数字出现巨大波动，你可以选择转换这些值(在这种情况下是比特币每日收盘价)，或者保持原样。</p><h2 id="ddb7" class="ny mo it bd mp nz oa dn mt ob oc dp mx li od oe mz lm of og nb lq oh oi nd oj bi translated">第四步:设置一个八度音域</h2><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="d529" class="ny mo it ol b gy op oq l or os"># octave range</span><span id="15df" class="ny mo it ol b gy ot oq l or os">octave_range = m21.scale.MajorScale('c').getPitches('c3','b4',direction='ascending')</span><span id="65e8" class="ny mo it ol b gy ot oq l or os">octave_range_midi = [x.midi for x in octave_range]</span></pre><p id="b914" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们选择音高的地方。我使用了从<code class="fe ou ov ow ol b">c3</code>到<code class="fe ou ov ow ol b">b5</code>音高的c大调音阶。为此，我们可以选择任何流行的音阶。这完全取决于你希望音乐听起来怎么样。要创建midi文件，您应该将音高记数法转换为midi音符编号。</p><h2 id="1be6" class="ny mo it bd mp nz oa dn mt ob oc dp mx li od oe mz lm of og nb lq oh oi nd oj bi translated">步骤5:将值映射到midi音符编号(音高)</h2><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="6097" class="ny mo it ol b gy op oq l or os"># map values to midi note numbers</span><span id="8a4a" class="ny mo it ol b gy ot oq l or os">scaler = MinMaxScaler((0,len(octave_range)-1))<br/>pitch = scaler.fit_transform(values.reshape(-1,1)).round().reshape(-1)<br/>pitch = [octave_range_midi[int(x)] for x in pitch]</span></pre><p id="9a3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我把比特币价格和midi音符号码对应起来。较低的价格对应于较低的音高，较高的价值对应于较高的音高。</p><h2 id="4a8e" class="ny mo it bd mp nz oa dn mt ob oc dp mx li od oe mz lm of og nb lq oh oi nd oj bi translated">步骤6:将值映射到速度</h2><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="592e" class="ny mo it ol b gy op oq l or os"># map values to velocity</span><span id="d0b3" class="ny mo it ol b gy ot oq l or os">scaler = MinMaxScaler((30,127))<br/>velocity = scaler.fit_transform(values.reshape(-1,1)).round().reshape(-1)<br/>velocity = [int(x) for x in velocity]</span></pre><p id="42fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">力度是弹奏一个音符时敲击按键的力度。类似地，我将较低的值映射到较低的速度，反之亦然。速度的范围是从0到127 (0为最低，127为最高)。因为速度为0时我们听不到任何声音，所以我选择了速度为30时的最小值。</p><h2 id="f740" class="ny mo it bd mp nz oa dn mt ob oc dp mx li od oe mz lm of og nb lq oh oi nd oj bi translated">步骤7:保存到midi</h2><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="698d" class="ny mo it ol b gy op oq l or os">track = 0<br/>time = 0<br/>channel = 0<br/>duration = 1   # In beats<br/>tempo = 85      # In BPM</span><span id="092b" class="ny mo it ol b gy ot oq l or os">MyMIDI = MIDIFile(1) <br/>MyMIDI.addTempo(track,time,tempo)</span><span id="8e8e" class="ny mo it ol b gy ot oq l or os">for i in range(len(df)):<br/>    MyMIDI.addNote(track, channel, pitch[i], beats[i], duration,<br/>                  velocity[i])</span><span id="c1a8" class="ny mo it ol b gy ot oq l or os">with open("bitcoin_c_major.mid", "wb") as output_file:<br/>    MyMIDI.writeFile(output_file)</span></pre><p id="4d74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了一个可以导入到任何数字音频工作站(DAW)的midi文件。我用<a class="ae ky" href="https://www.apple.com/logic-pro/" rel="noopener ugc nofollow" target="_blank"> Logic Pro </a>作为我的DAW。</p><h1 id="0079" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">数字音频工作站</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/71ebfd5a6d3e2013c8599f64d944fe4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E328XH2Mv1xTlzXTkkP-iw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DAW(图片由作者提供)</p></figure><p id="c9c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图是一个黎明的例子。您可以简单地导入midi文件，并选择任何乐器或合成器来播放音乐。为了给音乐添加更多的细节，我复制了同一个midi文件，并选择了不同音量的不同乐器。你可以发挥创造力来增加音乐的深度。我是80年代合成器乐器的粉丝，所以我在这个项目中使用了它们。</p><p id="78ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一些Github repos，我用来很好地理解数据发音的概念。你可以在这里找到链接<a class="ae ky" href="https://github.com/cirlabs/miditime" rel="noopener ugc nofollow" target="_blank"/>和<a class="ae ky" href="https://github.com/SYSTEMSounds/sonification-tutorials" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="b4c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊。现在你有了一首从数据中生成的<a class="ae ky" href="https://www.youtube.com/watch?v=rPg0wXs1HFA&amp;ab_channel=STRXMOS" rel="noopener ugc nofollow" target="_blank">音乐</a>。是不是很酷？我计划做一些像这样更有趣的项目，所以敬请关注。</p><p id="9c75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PS:我是一名数据科学家，而不是一名音乐家，所以我可能过于简化了一些音乐概念。</p></div><div class="ab cl mg mh hx mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="im in io ip iq"><p id="b273" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，干杯！</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="495a" class="ny mo it ol b gy op oq l or os"><strong class="ol iu">Want to Connect?</strong></span><span id="8483" class="ny mo it ol b gy ot oq l or os">Reach me at <a class="ae ky" href="https://www.linkedin.com/in/rohithteja/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="ae ky" href="https://twitter.com/rohithtejam" rel="noopener ugc nofollow" target="_blank">Twitter</a>, <a class="ae ky" href="https://github.com/rohithteja" rel="noopener ugc nofollow" target="_blank">GitHub</a> or just <a class="ae ky" href="https://www.buymeacoffee.com/rohithteja" rel="noopener ugc nofollow" target="_blank">Buy Me A Coffee</a>!</span></pre></div></div>    
</body>
</html>