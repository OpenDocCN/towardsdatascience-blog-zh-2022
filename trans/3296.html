<html>
<head>
<title>How to Use MATLAB to Create Two-Body Orbits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用MATLAB创建两体轨道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-matlab-to-create-two-body-orbits-7a1c2591a252#2022-07-22">https://towardsdatascience.com/how-to-use-matlab-to-create-two-body-orbits-7a1c2591a252#2022-07-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9c01" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一步一步的演练使用MATLAB来确定航天器如何在较大物体的重力影响下移动</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/d759a21edeca44ff577b7ac1d1426421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/1*TLWQbLS7z5CyRPzxoLSGnw.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">双体轨道动画[作者创作]</p></figure><p id="90e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">轨道力学(或天体动力学)涉及将牛顿运动定律和万有引力定律应用于航天器(如火箭和卫星)。任务规划者用它来预测宇宙飞船在重力、推力和其他力的影响下的运动。本文的题目是两体问题。这是天体动力学的一个子类，涉及一个航天器在一个单独的大质量物体的影响下，没有考虑其他的力。与更大的质量相比，航天器的质量也被认为是可以忽略的。这意味着大质量物体会影响航天器的运动，但航天器不会影响大质量物体的运动。实际上，感兴趣的物体不一定是航天器；可能是小行星，彗星，宇航员等等。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="eaa4" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">如何解决两体问题</h2><p id="ffc9" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">为了在两体系统中生成轨迹，必须推导航天器(相关质量)的运动方程。有大量的资源显示这个推导和最终的运动方程，所以你不必亲自动手。我在下面的文章中演示了这个过程。我鼓励你理解这些方程以及它们是如何得到的。然而，如果你不想这样做，只是想创建一个轨道，我提供了一个图表和所需的运动方程如下，供您参考。</p><div class="mv mw gp gr mx my"><a href="https://medium.com/illumination/astrodynamics-two-body-problem-ec2c5e148184" rel="noopener follow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">如何解决两体问题</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">通过推导两体系统的运动方程，学习轨道力学的基础知识</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">medium.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm ko my"/></div></div></a></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/11c14abe0d51f2ec028817fbbc378b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9t6of1rO7nC42fGb.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">两体问题图[作者创建]</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/59b7df0f9c3b98d425a05287c04ec72c.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/1*0I2XYhOpw8lAbcuV1D-dcw.gif"/></div></figure><p id="a9f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这些运动方程中，<em class="np"> μ </em>是主质量(行星、月球、恒星等)的引力参数。).<em class="np"> x </em>、<em class="np"> y </em>和<em class="np"> z </em>是定义航天器在惯性空间中位置的笛卡尔坐标。点代表时间导数，所以一个点代表速度，两个点代表加速度。我们将在本文的编码部分利用这些。</p><p id="d19d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">作为题外话，两体问题是轨道力学复杂领域的一个非常简化的版本。事实上，在设计任务时，人们必须考虑诸如大气阻力、<a class="ae nq" href="https://medium.com/illumination/deriving-the-effect-of-solar-radiation-pressure-on-orbits-150792f64d0b" rel="noopener">太阳辐射压力</a>、其他重力以及非球形物体的影响等干扰力。虽然不是最精确的方法，但两体问题可以用于航天器的初始任务规划，特别是如果它靠近一个单独的物体运行。当轨道远离大质量物体时，其他力将在航天器的运动中发挥更大的作用。这里不讨论额外的干扰力，但是记住它们是有好处的。</p><p id="3740" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了模拟轨道，我们将需要利用<a class="ae nq" rel="noopener" target="_blank" href="/numerical-integration-in-matlab-f41d187c1c15">数值积分</a>。如果你不知道这是什么，你仍然可以使用代码来创建你自己的轨道。为了对航天器的运动方程进行数值积分或求解，我们将使用MATLAB中的<code class="fe nr ns nt nu b">ode113</code>函数。这是一个内置函数，将一组要积分的导数(用户定义的函数)、感兴趣的时间间隔、初始条件和可选的数值积分容差作为输入。这组导数将是我们的状态向量<em class="np"> Y </em>的时间导数，它包括向量形式的航天器的位置和速度分量。状态向量及其时间导数如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3e1d3144deb8629857fa5dced0435864.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/1*HEB2O_QxeDUfqXxJLRJfQg.gif"/></div></figure><p id="f1e7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是对两体问题运动方程的数值积分过程的简要概述。让我们开始编写模拟地球轨道卫星轨迹的代码吧！</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h2 id="e1e2" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">用户定义的ODE函数</h2><p id="b4df" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">如前所述，为了创建我们的轨迹，我们需要对两体问题的运动方程进行数值积分。我们将使用<code class="fe nr ns nt nu b">ode113</code>来完成这项工作。这个MATLAB函数要求我们创建自己的函数，这个函数将被调用来进行数值积分。我们将定义这个函数，<code class="fe nr ns nt nu b">ODE2BP</code>。该函数使用地球引力参数<code class="fe nr ns nt nu b">mu</code>和之前的状态向量<code class="fe nr ns nt nu b">Y</code>来创建时间导数状态向量<code class="fe nr ns nt nu b">dYdt</code>。该函数返回这个新向量，它将被<code class="fe nr ns nt nu b">ode113</code>用来进行数值积分。注意:在MATLAB中，用户定义的函数必须放在脚本的末尾。</p><pre class="kj kk kl km gt nw nu nx ny aw nz bi"><span id="3d74" class="lx ly it nu b gy oa ob l oc od">% User-Defined ODE Function<br/>function dYdt = ODE2BP(t, Y)<br/>    mu = 3.986*10^5; % Earth's gravitational parameter [km^3/s^2]<br/>    x = Y(1); % [km]<br/>    y = Y(2); % [km]<br/>    z = Y(3); % [km]<br/>    vx = Y(4); % [km/s]<br/>    vy = Y(5); % [km/s]<br/>    vz = Y(6); % [km/s]<br/>    xddot = -mu/(x^2+y^2+z^2)^(3/2)*x; % [km/s^2]<br/>    yddot = -mu/(x^2+y^2+z^2)^(3/2)*y; % [km/s^2]<br/>    zddot = -mu/(x^2+y^2+z^2)^(3/2)*z; % [km/s^2]</span><span id="f104" class="lx ly it nu b gy oe ob l oc od">    dYdt = [vx;vy;vz;xddot;yddot;zddot]; % Y'<br/>end</span></pre><h2 id="fcba" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">数值积分</h2><p id="3a3f" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">接下来，我们完成定义<code class="fe nr ns nt nu b">ode113</code>的输入。这些输入之一是航天器的初始条件。这是本文开头的状态向量形式。注意位置和速度的分量按惯例以<em class="np">公里</em>和<em class="np">公里/秒</em>为单位。接下来，我们有一个以秒为单位的感兴趣的时间间隔。最后，有许多可选参数可以传递给<code class="fe nr ns nt nu b">ode113</code>。由于轨道力学要求精度，我在数值积分的时候一般会通过一个很小的相对公差。然后，我们将这些输入和上一节定义的函数一起传递给ODE求解器。该函数输出变量<code class="fe nr ns nt nu b">t</code>和<code class="fe nr ns nt nu b">Y</code>，它们是数值积分时间步长和每个时间步长的状态向量。然后，我们可以从输出中提取位置坐标<code class="fe nr ns nt nu b">x</code>、<code class="fe nr ns nt nu b">y</code>和<code class="fe nr ns nt nu b">z</code>的时间历史。</p><pre class="kj kk kl km gt nw nu nx ny aw nz bi"><span id="317c" class="lx ly it nu b gy oa ob l oc od">% Creating Inputs for Numerical Integration<br/>Y0 = [20000; 0; 0; 0; 2.9; 1.8]; % [x; y; z; vx; vy; vz] [km, km/s]<br/>tspan = [0 24*60*60]; % One day [s]<br/>options = odeset('RelTol', 1e-13); % Setting a tolerance</span><span id="6e87" class="lx ly it nu b gy oe ob l oc od">% Numerical Integration<br/>[t, Y] = ode113(@ODE2BP, tspan, Y0, options);</span><span id="1b25" class="lx ly it nu b gy oe ob l oc od">% Pulling Position Data from Output<br/>x = Y(:, 1); % [km]<br/>y = Y(:, 2); % [km]<br/>z = Y(:, 3); % [km]</span></pre><h2 id="0782" class="lx ly it bd lz ma mb dn mc md me dp mf ld mg mh mi lh mj mk ml ll mm mn mo mp bi translated">绘制轨迹</h2><p id="afb8" class="pw-post-body-paragraph ku kv it kw b kx mq ju kz la mr jx lc ld ms lf lg lh mt lj lk ll mu ln lo lp im bi translated">最后，我们可以使用<code class="fe nr ns nt nu b">x</code>、<code class="fe nr ns nt nu b">y</code>和<code class="fe nr ns nt nu b">z</code>变量来创建我们的航天器的轨迹。我们首先用标签、网格和一组相等的轴初始化图形(给出物理空间中轨道的真实表示)。接下来，我们可以使用MATLAB中的<code class="fe nr ns nt nu b">sphere</code>函数在我们的绘图原点创建一个地球的表示。最重要的是，可以使用<code class="fe nr ns nt nu b">plot3</code>功能绘制轨迹。</p><pre class="kj kk kl km gt nw nu nx ny aw nz bi"><span id="cfd3" class="lx ly it nu b gy oa ob l oc od">% Creating Figure<br/>figure; hold on<br/>title('Two-Body Trajectory', 'Interpreter', 'Latex')<br/>xlabel('x', 'Interpreter', 'Latex')<br/>ylabel('y', 'Interpreter', 'Latex')<br/>zlabel('z', 'Interpreter', 'Latex')<br/>axis equal<br/>grid minor<br/>view(30, 30)</span><span id="ff3c" class="lx ly it nu b gy oe ob l oc od">% Creating/Plotting Spherical Earth<br/>rm = 6378.14; % Radius of Earth [km]<br/>[xEarth, yEarth, zEarth] = sphere(25);<br/>surf(rm*xEarth,rm*yEarth,rm*zEarth, 'FaceColor', [0 0 1]);</span><span id="c770" class="lx ly it nu b gy oe ob l oc od">% Plotting Trajectory<br/>plot3(x, y, z, 'k')<br/>hold off</span></pre><p id="995a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上面的代码产生了以下图形:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/b90990c870ae23108795eea13bf53149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*RtwnPEH4Me37vYYIrH58hw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">二体轨道[作者创作]</p></figure><p id="9ad4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">用MATLAB创建两体轨道或轨迹的过程到此结束。玩具周围的初始条件和时间间隔，以创造自己独特的轨道！记住，这是对大多数天体动力学问题的过度简化。如果你想要一个更好的物理表述，你将需要包括扰动力。这可能是一个相当大的挑战，所以这就是为什么最好从简单的两体问题中学习，并从那里开始构建。如果你决定走得更远，祝你旅途顺利！</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="6929" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想制作一个类似于文章开头的视觉效果的动画，可以看看下面的文章。感谢您抽出时间阅读。如果你觉得这有用，请给我一个关注！谢谢！</p><div class="mv mw gp gr mx my"><a rel="noopener follow" target="_blank" href="/how-to-animate-plots-in-matlab-fa42cf994f3e"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">如何在MATLAB中制作动画</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">一种简单的数据动画制作方法</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="of l nj nk nl nh nm ko my"/></div></div></a></div></div></div>    
</body>
</html>