<html>
<head>
<title>How to Evaluate Any Tabular Synthetic Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何评估任何表格合成数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-evaluate-any-tabular-synthetic-dataset-8865b7ee0c23#2022-08-25">https://towardsdatascience.com/how-to-evaluate-any-tabular-synthetic-dataset-8865b7ee0c23#2022-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8d77" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一系列机制和测试，可用于从相似性和实用性角度评估任何表格合成数据集</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0efa24478afdb78628fe8e1fd2af0833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H9Ura110iklvqxf8"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@deepmind?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> DeepMind </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="e232" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">为什么是合成数据？</h1><p id="3866" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">合成数据的一些主要优势包括:</p><ul class=""><li id="abae" class="mk ml iq lq b lr mm lu mn lx mo mb mp mf mq mj mr ms mt mu bi translated"><strong class="lq ir">可扩展性</strong>:真实的训练数据是以线性方式收集的，而合成数据可以产生大量，这缓解了复杂的ML任务需要获取大量高质量训练数据的问题。</li><li id="11fb" class="mk ml iq lq b lr mv lu mw lx mx mb my mf mz mj mr ms mt mu bi translated"><strong class="lq ir">隐私</strong>:由于复杂的隐私要求，数据可用性仍然是一个挑战，尤其是在医疗保健领域。医疗保健研究人员通常很难获得用于次要目的的高质量个体水平数据(例如，测试新的假设，建立统计和ML模型)。使用合成数据可以<strong class="lq ir"> <em class="na">潜在地</em> </strong>解决这一挑战。</li></ul><p id="3f4b" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">但是，请注意，仅仅让数据“合成”并不能保证隐私。已经表明，合成数据生成并不总是和完全地保护每个人的隐私，尤其是使用非差别隐私数据生成技术。根据经验量化合成数据集的隐私性能也极其困难。单一的隐私度量只能解决某种攻击策略(例如:重新识别攻击、重构攻击或追踪攻击等)。).针对一种攻击表现较好的数据集并不一定意味着它可以抵御不同的攻击。</p><p id="ae4c" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">此外，很难估计攻击者可以获得的知识范围，我们需要假设他们可以获得哪些信息，以及他们试图获得哪些机密信息。更不用说，这些都是已知策略——攻击者可能采用的未知策略数不胜数。这意味着，能够根据经验量化合成数据集的一个(甚至多个)隐私度量的性能，并不足以说明数据集是完全隐私的。</p><p id="0e6d" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">也就是说，本文只关注合成数据集的效用性能。</p><h1 id="85d9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">高斯Copula和CTGAN数据生成器概述</h1><h2 id="27cb" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">高斯连接函数</h2><p id="3399" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">高斯Copula是一种用于数据综合的统计建模技术。</p><p id="e5e8" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">Copula允许我们将联合概率分布分解为变量的边际(根据定义，它们没有相关性)和一个将这些边际“耦合”在一起的函数。换句话说，Copula是一个“耦合”函数，或者是一个嵌入了相关信息的多元分布。因此，高斯连接函数是一个具有已知相关性的多元正态分布。</p><p id="652d" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">该数据生成器的高级流程如下:</p><ol class=""><li id="1760" class="mk ml iq lq b lr mm lu mn lx mo mb mp mf mq mj nq ms mt mu bi translated">学习每列的概率分布</li><li id="effe" class="mk ml iq lq b lr mv lu mw lx mx mb my mf mz mj nq ms mt mu bi translated">对它们应用标准正态的逆CDF变换(即，将列的分布转换为正态分布)</li><li id="dd0c" class="mk ml iq lq b lr mv lu mw lx mx mb my mf mz mj nq ms mt mu bi translated">了解这些新生成的随机变量的相关性，以构建copula模型</li><li id="6e91" class="mk ml iq lq b lr mv lu mw lx mx mb my mf mz mj nq ms mt mu bi translated">来自多元标准正态分布的样本，具有学习到的相关性</li></ol><h2 id="6ed8" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">CTGAN</h2><p id="4a0d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">条件表格生成对抗网络(CTGAN)是一种深度学习数据合成技术。顾名思义，这是一种基于GAN的方法。</p><p id="e9d0" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">一个普通的GAN由两个神经网络组成:一个作为生成器，接受一些输入并从中生成合成数据。然后，有第二个神经网络作为鉴别器，看看他们是否能区分真实数据和合成数据。来自鉴别器的结果被反馈到发生器，以帮助发生器产生更好的合成输出。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/e42b3310ebfbd6b2ff26126641326f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hs4enf7YhVrfCSzFBV0KqA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">非常高级的CTGAN架构概述。图片作者。</p></figure><p id="65f7" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">CTGAN与普通GAN的区别在于:</p><ol class=""><li id="bfe9" class="mk ml iq lq b lr mm lu mn lx mo mb mp mf mq mj nq ms mt mu bi translated"><strong class="lq ir">Conditional</strong>:CTGAN架构引入了一个条件生成器，它根据某个离散列生成行，并根据该特定离散列的每个类别的对数频率对训练数据进行采样，而不是随机采样训练数据以输入到生成器中，这可能不足以表示高度不平衡的分类列的小类别。这有助于GAN模型均匀地(不一定均匀地)探索所有可能的离散值。</li><li id="b918" class="mk ml iq lq b lr mv lu mw lx mx mb my mf mz mj nq ms mt mu bi translated"><strong class="lq ir">表格</strong>:与通常正态分布的图像像素值不同，表格数据中的连续变量可以遵循非高斯和/或复杂的多模态分布。为了解决这个问题，CTGAN使用特定于模式的规范化来表示连续列。</li></ol><p id="db45" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">关于CTGAN如何工作的详细描述，请参考他们在<a class="ae kv" href="https://arxiv.org/pdf/1907.00503.pdf" rel="noopener ugc nofollow" target="_blank">发表的论文</a>。</p><h1 id="938f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">合成数据的效用评估</h1><p id="946f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在我们生成一些合成数据后，自然的问题是刚刚生成的数据有多好。具体来说:</p><ul class=""><li id="c762" class="mk ml iq lq b lr mm lu mn lx mo mb mp mf mq mj mr ms mt mu bi translated">合成数据是否保持与真实数据的统计相似性？合成数据保留单变量和多变量分布吗？(即相似性度量)。</li><li id="14f9" class="mk ml iq lq b lr mv lu mw lx mx mb my mf mz mj mr ms mt mu bi translated">在一些计划任务中，用合成数据获得类似的结果并得出与真实数据相同的结论，这可能吗？(即效用度量)。</li></ul><p id="aec6" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">本文介绍了一系列机制和测试，可以用来评估任何表格合成数据，主要是从保留原始数据的统计属性(相似性)和ML功效(效用)的角度。</p><p id="a3c4" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">所有评估都是在来自UCI机器学习知识库的<a class="ae kv" href="https://archive.ics.uci.edu/ml/datasets/Sepsis+survival+minimal+clinical+records" rel="noopener ugc nofollow" target="_blank">败血症存活最小临床记录数据集</a> (110，204个实例x 4个属性)上进行的。我们使用来自<a class="ae kv" href="https://sdv.dev" rel="noopener ugc nofollow" target="_blank">综合数据仓库</a>实施的高斯Copula和CTGAN模型生成综合数据。</p><h2 id="28a8" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">个体分布</h2><p id="4d31" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">鉴于年龄分布在原始数据集中有多种模式，CTGAN在保持这一属性方面做得更好，而高斯Copula仅将分布转化为单一模式。</p><p id="c634" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">另一方面，高斯Copula比CTGAN更好地保持了性别和目标变量类别之间的比例。与高斯Copula相比，CTGAN更好地再现了集数的分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/2a0d2129fc6bce75dad977cd95545db7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GX77RDrx770pTCnOgRkE-A.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/ecc132e86c9234427b7faa4ba7e5870a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1JFjbt_5xRKjgh3v8_Yfw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/76c8b041adae3c5132c523f0b5d49f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IU9hVOxP1Kjk8kwpmaHp7Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">所有变量在三个数据集上的分布:真实数据集、高斯Copula合成数据集和CTGAN合成数据集。图片作者。</p></figure><h2 id="f936" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">缺少值</h2><p id="d8ad" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">所有变量最初都没有任何缺失值，来自CTGAN和高斯Copula的合成数据集能够重现这一点。</p><h2 id="c31e" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">K-S检验</h2><p id="f779" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">双样本Kolmogorov–Smirnov(K-S)用于检验两个样本是否来自同一分布。我们在真实和高斯Copula数据之间以及真实和CTGAN数据之间的所有变量上运行该测试。因为KS统计是两个CDF之间的最大距离，它越低，对我们的用例越好。</p><p id="7271" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">总体而言，与高斯Copula相比，CTGAN的所有变量的平均KS统计量略小。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/94309822bb83f02ccd0f1d7f72eca38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsEIbZAZER2Gx7q5lA5luA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">高斯Copula与真实数据以及CTGAN与真实数据的2样本K-S测试结果。图片作者。</p></figure><h2 id="8c7a" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">成对相关</h2><p id="5aeb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">到目前为止，我们已经逐列研究了数据集。现在，让我们来看看两两之间的关系。</p><p id="0279" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">高斯Copula的成对Pearsons相关性的热图似乎与同一性数据的热图更相似。为了验证这一点，我们计算了相关精度。先将相关系数离散化为6个等级:[-1，-0.5)(强负)，[-0.5，-0.3)(中负)，[-0.3，-0.1)(低负)，[-0.1，0.1)(无相关性)，[0.1，0.3)(低正)，[0.3，0.5)(中正)，[0.5，1)(强正)。然后，计算合成数据集和原始数据集分配相同相关级别的配对的百分比。</p><p id="359c" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">高斯Copula的关联精度远大于CTGAN (83% vs 67%)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/3674dc276f6cca653129deb6bb8fc872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r0XKnazwAGHm0LHx6EuO6A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">三个数据集之间成对相关的热图。图片作者。</p></figure><h2 id="5bce" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">ML功效</h2><p id="38ef" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">假设一方无法访问原始数据集，他们有可能解决基于合成数据的机器学习问题，并得出尽可能接近真实数据的见解吗？为了回答这个问题，我们使用合成数据集来训练XGBoost分类器，并使用它对原始数据进行预测。然后，将这个分数与我们在原始数据上训练XGBoost所获得的分数进行比较。</p><p id="19fc" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">与高斯Copula相比，CTGAN能够实现更接近我们用真实数据实现的预测性能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/f4af5d2216d8cb6d99e9b9bc2b35f290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1XStTMKOMOan793UnL3AA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">XGBoost分类器的AUROC在合成数据上进行训练，并在真实数据上进行评估，与我们在真实数据上训练分类器的结果进行比较。</p></figure><h2 id="9d37" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">检测能力</h2><p id="2936" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了评估区分真实实例和合成实例的难度，我们将两个数据集混在一起，并使用标志来指示数据是真实的还是合成的。然后训练一个试图预测这个标志的ML模型。预测标记越容易，真实数据和合成数据之间的区别就越明显。</p><p id="fc0d" class="pw-post-body-paragraph lo lp iq lq b lr mm jr lt lu mn ju lw lx nb lz ma mb nc md me mf nd mh mi mj ij bi translated">对于这个测试，我们将XGBoost和逻辑回归训练为检测器。与高斯Copula数据相比，CTGAN合成数据对XGBoost和Logistic回归提出了更难区分的挑战，因为它们对应的检测器的AUROC更低。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/06d5b8c702fc102481ba2a5f52eb0bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B0qQBSS1e2tlLLsif9VLaQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">XGBoost和逻辑回归检测器的AUROC性能，尝试区分真实和合成实例。图片作者。</p></figure><h2 id="6ac5" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">结论</h2><p id="11b3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">对于这个特定的脓毒症公共数据集，从个体变量评估的角度来看，CTGAN和高斯Copula是不分上下的。然而，高斯Copula具有令人惊讶的更好的成对相关准确性，而CTGAN实现了更好的ML功效，并且更不可能被检测到。</p></div></div>    
</body>
</html>