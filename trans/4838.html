<html>
<head>
<title>Dealing with Dates in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python处理日期</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dealing-with-dates-in-python-1b4069a07a0f#2022-10-27">https://towardsdatascience.com/dealing-with-dates-in-python-1b4069a07a0f#2022-10-27</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="d36c" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">使用Python实现自动化</h2><div class=""/><div class=""><h2 id="ba26" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">这篇文章是关于可以对日期时间变量执行的操作。</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/2d71ea3ebd11887d0d2a2fbe1580482f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_kJ_WPbxb3aIrBiXRm5SlQ.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">在<a class="ae li" href="https://unsplash.com/s/photos/calendar?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae li" href="https://unsplash.com/@esteejanssens?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">埃斯特·扬森斯</a>拍摄的照片</p></figure><p id="5fc4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">你在处理日期时间对象的时候会纠结吗？嗯，不得不承认我经常纠结。我总是需要做大量的搜索来为我的用例找到合适的方法。然后，我决定写这篇文章，作为给我亲爱的读者和我自己的文档。</p><h1 id="80cf" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">背景</h1><p id="a2fc" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">当我开发自动报告准备或Excel文件组合的工具时，我必须能够从文件名或文件夹中识别信息。通常，系统生成的文件或定期报告将根据固定模式命名，并存储在相同的文件夹中。</p><p id="aaa6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">文件名通常是报告名称、报告日期或期间以及文件扩展名的组合，例如，名为<em class="nc">“用电报告2022 _ Q4 _ ww43 . xlsx”</em>的定期报告和名为<em class="nc">“工具申请报告2022 10 21 . CSV”</em>的每日报告。为了检索正确的文件，我们需要根据报告自动化工具运行的时间来计算文件名中的日期或周期。</p><p id="dae2" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">因此，本文的结构如下:</p><ol class=""><li id="99c4" class="nd ne iu ll b lm ln lp lq ls nf lw ng ma nh me ni nj nk nl bi translated"><a class="ae li" href="#5c35" rel="noopener ugc nofollow">解析并格式化日期时间(<em class="nc">str ptime</em>vs<em class="nc">strftime</em>)</a></li><li id="86cc" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated"><a class="ae li" href="#bd8b" rel="noopener ugc nofollow">提取年/月/日信息</a></li><li id="8abc" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated"><a class="ae li" href="#0289" rel="noopener ugc nofollow">从日期</a>开始计算世界周</li><li id="4bd1" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated"><a class="ae li" href="#014a" rel="noopener ugc nofollow">从日期开始计算星期几</a></li><li id="5e99" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated"><a class="ae li" href="#6ba1" rel="noopener ugc nofollow">将日期时间对象转换为周期</a></li><li id="1b99" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated"><a class="ae li" href="#a8f4" rel="noopener ugc nofollow">计算数据时间间隔</a></li></ol><blockquote class="nr"><p id="5efc" class="ns nt iu bd nu nv nw nx ny nz oa me dk translated">我们开始吧！</p></blockquote></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="a386" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">解析日期时间意味着我们将包含日期的字符串对象转换成日期时间对象。例如，当我们用正则表达式或其他方法从报表<em class="nc">“工具申请报告20221021 . CSV”</em>中获取日期时，日期“20221021”将是一个字符串变量。</p><p id="faf3" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在我们解析它之后，它将成为一个DateTime对象，并被写成ISO格式(YYYY-MM-DD)，2022–10–21。然后，我们可以将其格式化为特定的格式，比如2022年10月21日。请注意，DateTime对象在我们格式化后将变成一个string对象。</p><blockquote class="nr"><p id="12b3" class="ns nt iu bd nu nv oi oj ok ol om me dk translated">迷惑？放心吧！</p></blockquote><p id="1768" class="pw-post-body-paragraph lj lk iu ll b lm on ke lo lp oo kh lr ls op lu lv lw oq ly lz ma or mc md me in bi translated">从下面的例子中你会有一个更清晰的画面。</p><h1 id="5c35" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">1.解析和格式化日期时间</h1><h2 id="f59e" class="os mg iu bd mh ot ou dn ml ov ow dp mp ls ox oy mr lw oz pa mt ma pb pc mv ja bi translated">解析日期时间</h2><p id="2a29" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">DateTime库中有两种方法可以解析日期:</p><ul class=""><li id="6f3d" class="nd ne iu ll b lm ln lp lq ls nf lw ng ma nh me pd nj nk nl bi translated"><code class="fe pe pf pg ph b">datetime.fromisoformat()</code></li><li id="e955" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me pd nj nk nl bi translated"><code class="fe pe pf pg ph b">datetime.strptime()</code></li></ul><p id="574e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">让我们看看他们有什么不同！</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="f0bf" class="os mg iu ph b gz pm pn l po pp">import datetime as dt</span><span id="1c50" class="os mg iu ph b gz pq pn l po pp">my_date1 = "2022-07-01"<br/>print(my_date1)<br/>print(type(my_date1))</span><span id="39a2" class="os mg iu ph b gz pq pn l po pp">my_date2 = "01-07-2022"<br/>print(my_date2)<br/>print(type(my_date2))</span><span id="e667" class="os mg iu ph b gz pq pn l po pp">my_date3 = "01July2022"<br/>print(my_date3)<br/>print(type(my_date3))</span></pre><p id="cb59" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">好的，我创建了3个不同的日期作为变量，现在它们是字符串对象。现在让我们将它们解析成DateTime对象。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="47b4" class="os mg iu ph b gz pm pn l po pp">my_date1a = dt.datetime.fromisoformat(my_date1)<br/>print(type(my_date1a))</span><span id="5276" class="os mg iu ph b gz pq pn l po pp">my_date3a = dt.datetime.fromisoformat(my_date3)<br/>print(type(my_date3a))</span></pre><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pr"><img src="../Images/29e9274ac4eb9edc2e2c3eaf47d8b24c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8SOZf9sq6WGleiqi5sXJw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">图片作者。</p></figure><p id="e7c7" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">对于第一种方法<code class="fe pe pf pg ph b">datetime.fromisoformat()</code>，就像方法名一样，它只能解析ISO格式的日期YYYY-MM-DD，就像在名为<code class="fe pe pf pg ph b">my_date1</code>的变量中一样。因此，当我们试图在<code class="fe pe pf pg ph b">my_date3</code>中对其他日期时间格式使用该方法时，它将返回一个<em class="nc">值错误</em>。<code class="fe pe pf pg ph b">my_date1a</code>变量是我们通过解析<code class="fe pe pf pg ph b">my_date1</code>变量得到的DateTime对象。</p><p id="b1be" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">下面是一个用<code class="fe pe pf pg ph b">datetime.strptime()</code>方法解析日期的例子。对于这种方法，我们必须根据日期格式指定<strong class="ll je">格式代码</strong>来解析日期。您可以在<a class="ae li" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" rel="noopener ugc nofollow" target="_blank"> strftime()和strptime()行为</a>中了解更多关于格式代码的信息。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="1adf" class="os mg iu ph b gz pm pn l po pp"># my_date2 = "01-07-2022"<br/>my_date2a = dt.datetime.strptime(my_date2, "%d-%m-%Y")<br/>print(type(my_date2a))<br/>print(my_date2a)</span><span id="d010" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output</strong>:<br/># &lt;class 'datetime.datetime'&gt;<br/># 2022-07-03 00:00:00</span></pre><p id="2572" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">让我们看另一个不同日期格式的例子。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="162e" class="os mg iu ph b gz pm pn l po pp"># my_date3 = "01July2022"<br/>my_date3a = dt.datetime.strptime(my_date3, "%d%B%Y")<br/>print(type(my_date3a))<br/>print(my_date3a)</span><span id="8fcb" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># &lt;class 'datetime.datetime'&gt; <br/># 2022-07-01 00:00:00</span></pre><p id="02c5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">使用<code class="fe pe pf pg ph b">strptime()</code>方法解析日期是通过用各自的格式代码替换日、月和年。如上例所示，%d表示日，%m表示月数字，%B表示月的全名，%Y表示带有世纪的年。</p><p id="991b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果你是新手，现在看起来可能很复杂，但是我向你保证，一旦你熟悉了格式代码，你就会变得很棒。记住，你可以随时参考<a class="ae li" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" rel="noopener ugc nofollow" target="_blank"> strftime()和strptime()行为</a>。😉</p><h2 id="7791" class="os mg iu bd mh ot ou dn ml ov ow dp mp ls ox oy mr lw oz pa mt ma pb pc mv ja bi translated">格式化日期时间</h2><p id="2135" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">在我们将string对象解析成DateTime对象后，它将以ISO格式显示。如果您希望它是其他形式，我们必须使用<code class="fe pe pf pg ph b">datetime.strftime()</code>方法来格式化日期。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="b432" class="os mg iu ph b gz pm pn l po pp"># my_date3a: 2022-07-01 00:00:00<br/>my_format_date = dt.datetime.strftime(my_date3a, "%B %d, %Y")<br/>print(my_format_date)</span><span id="6668" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># July 01, 2022</span></pre><p id="14e6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">请注意，在我们格式化日期之后，它将变成一个字符串。</p><p id="3191" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在我们将字符串解析成DateTime对象后，我们可以从中获得信息。</p><h1 id="bd8b" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">2.提取年/月/日信息</h1><p id="4464" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated"><em class="nc">注意:下面的例子使用了第一节例子中的变量。</em></p><p id="e17e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">要获取年、月和日信息，我们只需使用下面DateTime对象中的相应属性。</p><ul class=""><li id="81f4" class="nd ne iu ll b lm ln lp lq ls nf lw ng ma nh me pd nj nk nl bi translated"><code class="fe pe pf pg ph b">datetime_object.year</code></li><li id="f5b1" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me pd nj nk nl bi translated"><code class="fe pe pf pg ph b">datetime_object.month</code></li><li id="d5ae" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me pd nj nk nl bi translated"><code class="fe pe pf pg ph b">datetime_object.day</code></li></ul><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="1b7a" class="os mg iu ph b gz pm pn l po pp"># my_date3a: 2022-07-01 00:00:00</span><span id="1caa" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Get Year Info<br/></strong>my_date3a.year</span><span id="b25a" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output: <br/></strong># 2022</span><span id="13a1" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Get Month Info<br/></strong>my_date3a.month</span><span id="8588" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output: <br/></strong># 7</span><span id="6960" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Get Day Info<br/></strong>my_date3a.day</span><span id="e286" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output: </strong><br/># 1</span></pre><p id="dcf6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">简单吧？😄</p><p id="0c21" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">但是，我们无法从格式化的日期中提取上述信息。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="02c8" class="os mg iu ph b gz pm pn l po pp"># my_format_date = "July 01, 2022"<br/>my_format_date.month</span></pre><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ps"><img src="../Images/69cf18510162ff9684385163342bd81f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KqqSzDQFJvAnT2wtZ5qPPQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">图片作者。</p></figure><p id="8fe4" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">它将返回一个属性错误。这是因为当我们将日期格式化为其他格式时，它会再次变成string对象。我们只能从日期时间对象返回日期时间属性。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="7b32" class="os mg iu ph b gz pm pn l po pp">print(type(my_date3a))<br/>print(type(my_format_date))</span><span id="5262" class="os mg iu ph b gz pq pn l po pp">Output:<br/>&lt;class 'datetime.datetime'&gt; <br/>&lt;class 'str'&gt;</span></pre><blockquote class="pt pu pv"><p id="f570" class="lj lk nc ll b lm ln ke lo lp lq kh lr pw lt lu lv px lx ly lz py mb mc md me in bi translated">要知道strftime()的乘积是string对象，而strptime()的乘积是DateTime对象。</p></blockquote></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><h1 id="0289" class="mf mg iu bd mh mi pz mk ml mm qa mo mp kj qb kk mr km qc kn mt kp qd kq mv mw bi translated">3.从日期开始计算世界周</h1><p id="84fa" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated"><em class="nc">注意:在本节中，我们将使用新的变量作为示例。</em></p><p id="5330" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">首先，我用不同的日期创建两个新的string对象，然后将它们解析成DateTime对象。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="7d23" class="os mg iu ph b gz pm pn l po pp">import datetime as dt</span><span id="6966" class="os mg iu ph b gz pq pn l po pp">my_date_str_1 = "2022-07-01"<br/>my_date_1 = dt.datetime.strptime(my_date_str_1, "%Y-%m-%d")<br/>print(my_date_1)</span><span id="7586" class="os mg iu ph b gz pq pn l po pp">my_date_str_2 = "2022-07-03"<br/>my_date_2 = dt.datetime.strptime(my_date_str_2, "%Y-%m-%d")<br/>print(my_date_2)</span><span id="3690" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># 2022-07-01 00:00:00 <br/># 2022-07-03 00:00:00</span></pre><p id="065b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们将使用<code class="fe pe pf pg ph b">isocalendar()</code>方法从DateTime对象中获取世界周信息。这是因为DateTime对象没有世界周属性。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="8911" class="os mg iu ph b gz pm pn l po pp">print(my_date_1.isocalendar())<br/>print(my_date_2.isocalendar())</span><span id="67fe" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># datetime.IsoCalendarDate(year=2022, week=26, weekday=5) <br/># datetime.IsoCalendarDate(year=2022, week=26, weekday=7)</span></pre><p id="27a6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated"><code class="fe pe pf pg ph b">isocalendar()</code>方法将返回一个包含ISO年份、周数和工作日的元组。工作日将以数字形式返回。我们可以返回相应索引的值。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="ecd9" class="os mg iu ph b gz pm pn l po pp">print("Date 1: 2022-07-01")<br/>print("Year:", my_date_1.isocalendar()[0])<br/>print("World Week Number: ", my_date_1.isocalendar()[1])<br/>print("Weekday: ", my_date_1.isocalendar()[2])</span><span id="3d06" class="os mg iu ph b gz pq pn l po pp">print("Date 2: 2022-07-03")<br/>print("Year:", my_date_2.isocalendar()[0])<br/>print("World Week Number: ", my_date_2.isocalendar()[1])<br/>print("Weekday: ", my_date_2.isocalendar()[2])</span><span id="7afe" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># Date 1: 2022-07-01 <br/># Year: 2022 <br/># World Week Number:  26 <br/># Weekday:  5 <br/># Date 2: 2022-07-03 <br/># Year: 2022 <br/># World Week Number:  26 <br/># Weekday:  7</span></pre><p id="19ef" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">这就是我们如何得到星期数，以及年份和工作日。</p><h1 id="014a" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">4.从日期开始计算星期几</h1><p id="f325" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated"><em class="nc">注意:以下示例使用第3节示例中的变量。</em></p><p id="def9" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">有多种方法可以从日期中返回星期几信息。其中一种方法是通过<code class="fe pe pf pg ph b">isocalendar()</code>，如前一节所示。另一种方法是使用如下所示的<code class="fe pe pf pg ph b">weekday()</code>方法。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="e0d6" class="os mg iu ph b gz pm pn l po pp">print("Date 1: 2022-07-01")<br/>print("Weekday: ", my_date_1.weekday())</span><span id="cab3" class="os mg iu ph b gz pq pn l po pp">print("Date 2: 2022-07-03")<br/>print("Weekday: ", my_date_2.weekday())</span><span id="2002" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># Date 1: 2022-07-01 <br/># Weekday:  4 <br/># Date 2: 2022-07-03 <br/># Weekday:  6</span></pre><p id="ef8b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">嗯，2022年7月1日是星期五。<code class="fe pe pf pg ph b">isocalendar()</code>方法不遵循python索引规则。所以实际上，<code class="fe pe pf pg ph b">isocalendar()</code>和<code class="fe pe pf pg ph b">weekday()</code>方法都在星期一开始计数，但是<code class="fe pe pf pg ph b">isocalendar()</code>使用从1开始的索引，而weekday()是从0开始的python函数。提到的两种方法以数字形式返回星期几。还有一种方法，你能猜出来吗🤔？</p><p id="a747" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">是<code class="fe pe pf pg ph b">strftime()</code>法。</p><p id="c818" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们可以通过用相应的格式代码格式化日期来获得工作日的名称。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="f061" class="os mg iu ph b gz pm pn l po pp">date_weekday_1 = dt.datetime.strftime(my_date_1, "%a")<br/>print(date_weekday_1)</span><span id="dd93" class="os mg iu ph b gz pq pn l po pp">date_weekday_2 = dt.datetime.strftime(my_date_2, "%a")<br/>print(date_weekday_2)</span><span id="3080" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># Fri <br/># Sun</span></pre><p id="1ea2" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们可以通过使用如上例所示的“%a”格式代码来格式化星期几的缩写名称，或者通过使用如下例所示的“%A”格式代码来返回星期几的全名。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="55bf" class="os mg iu ph b gz pm pn l po pp">date_weekday_1 = dt.datetime.strftime(my_date_1, "%A")<br/>print(date_weekday_1)</span><span id="781c" class="os mg iu ph b gz pq pn l po pp">date_weekday_2 = dt.datetime.strftime(my_date_2, "%A")<br/>print(date_weekday_2)</span><span id="1c18" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:<br/></strong># Friday <br/># Sunday</span></pre><p id="d7d0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们也可以用数字的形式返回工作日。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="ecf0" class="os mg iu ph b gz pm pn l po pp">date_weekday_1 = dt.datetime.strftime(my_date_1, "%w")<br/>print(date_weekday_1)</span><span id="e424" class="os mg iu ph b gz pq pn l po pp">date_weekday_2 = dt.datetime.strftime(my_date_2, "%w")<br/>print(date_weekday_2)</span><span id="78d6" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># 5 <br/># 0</span></pre><p id="d749" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">有趣的事实是，当你使用<code class="fe pe pf pg ph b">strftime()</code>方法时，计数从周日开始，指数从0开始，正如<a class="ae li" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" rel="noopener ugc nofollow" target="_blank">文档</a>所示。</p><p id="e70d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">为了更好地理解，我合并了下面的比较表，以显示从上面显示的日期开始以数字形式返回工作日的几种方法之间的差异。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj qe"><img src="../Images/bf5a82df39bcb990da6d01fbe4dc86ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hWKS26yaTvHQfPBXXhShVA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">将星期几作为起始日期的数字返回的方法之间的差异。图片作者。</p></figure></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><h1 id="6ba1" class="mf mg iu bd mh mi pz mk ml mm qa mo mp kj qb kk mr km qc kn mt kp qd kq mv mw bi translated">5.将日期时间对象转换为周期</h1><p id="cd5d" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated"><em class="nc">注意:在本节中，我们将使用新的变量作为示例。</em></p><p id="47b5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们已经学习了返回年、月、日、世界周数和工作日的方法和属性。如果大家还记得我在本文开头给出的报告名称的例子<em class="nc">《用电报告2022 _ Q4 _ ww43 . xlsx》</em>，还有一条信息我们还没有得到，那就是季度。</p><p id="9e6d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">为了从日期中获取季度，我们必须使用<code class="fe pe pf pg ph b">pandas</code>库和DateTime库。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="fc57" class="os mg iu ph b gz pm pn l po pp">import pandas as pd<br/>import datetime as dt<br/># pandas.Timestamp.to_period</span><span id="b20d" class="os mg iu ph b gz pq pn l po pp">date_1 = '2022-10-21'<br/>timestamp_1 = pd.Timestamp(date_1)</span></pre><p id="90cd" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">首先，我们将日期创建为字符串对象，然后将其转换为时间戳。之后，我们可以将时间戳转换成句点。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="bde7" class="os mg iu ph b gz pm pn l po pp">year_period = timestamp_1.to_period(<em class="nc">freq</em>='Y')<br/>month_period = timestamp_1.to_period(<em class="nc">freq</em>='M')<br/>week_period = timestamp_1.to_period(<em class="nc">freq</em>='W')<br/>quarter_period = timestamp_1.to_period(<em class="nc">freq</em>='Q')</span><span id="b1e2" class="os mg iu ph b gz pq pn l po pp">print("Year: ", year_period)<br/>print("Month: ", month_period)<br/>print("Week: ", week_period)<br/>print("Quarter: ", quarter_period)</span><span id="d125" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># Year:  2022 <br/># Month:  2022-10 <br/># Week:  2022-10-17/2022-10-23 <br/># Quarter:  2022Q4</span></pre><p id="477a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">很简单吧？</p><p id="abfc" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">根据<a class="ae li" href="https://pandas.pydata.org/docs/reference/api/pandas.Timestamp.to_period.html" rel="noopener ugc nofollow" target="_blank"> pandas的官方文档</a>，对于<code class="fe pe pf pg ph b">pandas.Timestamp.to_period()</code>方法只有4种输出类型。在前面的部分中，我们分别得到年、月和周。然后，该方法返回日期的特定时间段。例如，2022Q4指的是2022年的第四季度。</p><p id="1498" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">只检索“Q4”而不是“2022Q4”还需要一个步骤。<code class="fe pe pf pg ph b">quarter_period</code>变量现在是一个周期对象。所以，我们需要将它转换成一个string对象，然后返回最后两个字符串以得到“Q4”。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="768a" class="os mg iu ph b gz pm pn l po pp">print(str(quarter_period))[-2:]</span></pre></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="a76e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">除此之外，我们可以定义一个python函数来表示每个月的季度。当您的组织有自己的财政年度计算方法时，此方法也适用。例如，第一季度可能在11月、12月和1月。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="qf qg l"/></div></figure><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="a453" class="os mg iu ph b gz pm pn l po pp"><strong class="ph je"># Output:</strong><br/># Q4</span></pre><p id="08e6" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">上面显示了当您的组织不遵循标准的季度定义时，如何返回季度。您可以根据组织的季度定义修改条件。</p><h1 id="a8f4" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">6.计算数据时间间隔</h1><p id="a9b7" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated"><em class="nc">注意:在本节中，我们将使用新的变量作为示例。</em></p><p id="975f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">日期时间间隔有两种计算方式:</p><ol class=""><li id="fac4" class="nd ne iu ll b lm ln lp lq ls nf lw ng ma nh me ni nj nk nl bi translated">计算两个日期之间的间隔</li><li id="7fb7" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated">给日期加上/减去一个时间间隔</li></ol><p id="ca9f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">让我们一个一个来看！</p><p id="c6f1" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在此之前，让我们为示例创建一些日期。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="55ef" class="os mg iu ph b gz pm pn l po pp">import datetime as dt</span><span id="762f" class="os mg iu ph b gz pq pn l po pp">my_date1 = dt.datetime.fromisoformat("2022-07-01")<br/>my_date2 = dt.datetime.fromisoformat("2022-07-05")</span></pre><h2 id="aaff" class="os mg iu bd mh ot ou dn ml ov ow dp mp ls ox oy mr lw oz pa mt ma pb pc mv ja bi translated">计算两个日期之间的间隔</h2><p id="9097" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">计算两次约会的间隔真的很简单。我们只需要减去一个日期。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="3246" class="os mg iu ph b gz pm pn l po pp">print(my_date2 - my_date1)</span><span id="7fb4" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># datetime.timedelta(days=4)</span></pre><p id="fa6d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">输出将是一个<em class="nc"> timedelta </em>，它指的是两个DateTime对象之间的差异。</p><h2 id="5ac1" class="os mg iu bd mh ot ou dn ml ov ow dp mp ls ox oy mr lw oz pa mt ma pb pc mv ja bi translated">给日期加上/减去一个时间间隔</h2><p id="85c1" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">另一个例子是给日期加上或减去一个时间间隔。</p><pre class="kt ku kv kw gu pi ph pj pk aw pl bi"><span id="6f63" class="os mg iu ph b gz pm pn l po pp">from datetime import timedelta</span><span id="068c" class="os mg iu ph b gz pq pn l po pp">print(my_date2 - timedelta(<em class="nc">days</em>=10))<br/>print(my_date2 + timedelta(<em class="nc">days</em>=10))<br/>print(my_date2 - timedelta(<em class="nc">seconds</em>=10))<br/>print(my_date2 + timedelta(<em class="nc">seconds</em>=10))</span><span id="5786" class="os mg iu ph b gz pq pn l po pp"><strong class="ph je"># Output:</strong><br/># 2022-06-25 00:00:00 <br/># 2022-07-15 00:00:00<br/># 2022-07-04 23:59:50 <br/># 2022-07-05 00:00:10</span></pre><p id="916c" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我们将使用日期时间库中的<a class="ae li" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" rel="noopener ugc nofollow" target="_blank"> timedelta类来执行该操作。这个类允许我们在日期上加/减天数、秒数或微秒数。</a></p><h1 id="0417" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">结论</h1><p id="2e83" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">总之，已经展示了将字符串对象解析为日期时间对象以及将日期时间对象格式化为特定格式的方法。然后，讨论了从日期中获取年、月、日、世界周以及工作日的方法。</p><p id="257b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">给出了将日期时间对象转换成周期的方法，如一年、一年中的一个月以及一年中的一个季度。对于有自己的财政年度计算方法的组织，条件语句可用于返回正确的季度。</p><p id="f594" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">最后，解释DateTime间隔的两种计算类型，它计算两个日期之间的间隔，并给日期加上/减去一个时间间隔。</p><p id="f43a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">用我展示的所有方法和例子，你能用今天的日期(26/10/2022)重新创建下面的文件名吗？😎在评论里落下你的答案吧！</p><ul class=""><li id="f390" class="nd ne iu ll b lm ln lp lq ls nf lw ng ma nh me pd nj nk nl bi translated"><em class="nc">《2022年用电报告_ Q4 _ ww43 . xlsx》</em></li><li id="f1ce" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me pd nj nk nl bi translated"><em class="nc">“工具征用报告2022 10 21 . CSV”</em></li></ul><p id="dc69" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">在文章底部回答。自己先试一下再查答案！😉</p></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="704f" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我希望您喜欢阅读这篇文章，并希望它能帮助您更多地了解如何在Python中处理DateTime对象。谢谢！😊</p><h1 id="1caf" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">保持联系</h1><p id="cef2" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">在YouTube<a class="ae li" href="https://www.youtube.com/channel/UCiMtx0qbILP41Ot-pkk6eJw" rel="noopener ugc nofollow" target="_blank">上订阅</a></p><h1 id="36e7" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">边注</h1><p id="ca12" class="pw-post-body-paragraph lj lk iu ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me in bi translated">在<a class="ae li" rel="noopener" target="_blank" href="/report-automation-tips-with-python-783a9cd58e23">使用Python的报告自动化技巧</a>中，我解释了一些关于报告自动化的技巧。看看吧！</p><h1 id="d1dc" class="mf mg iu bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">参考</h1><ol class=""><li id="4518" class="nd ne iu ll b lm mx lp my ls qh lw qi ma qj me ni nj nk nl bi translated"><a class="ae li" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank"> Python的DateTime模块文档</a></li><li id="b1dc" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated"><a class="ae li" href="https://pandas.pydata.org/docs/reference/api/pandas.Timestamp.to_period.html" rel="noopener ugc nofollow" target="_blank">熊猫。Timestamp.to_period文档</a></li><li id="5364" class="nd ne iu ll b lm nm lp nn ls no lw np ma nq me ni nj nk nl bi translated"><a class="ae li" href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" rel="noopener ugc nofollow" target="_blank"> strftime()和strptime()行为</a></li></ol></div><div class="ab cl ob oc hy od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="in io ip iq ir"><p id="29c0" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">谢谢你，祝贺你读到最后😊！</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj qk"><img src="../Images/4e5ac42ea08dba95c161841e4e604c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ND-vEAES5N5c95bytbhNtw.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@alexas_fotos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Alexas_Fotos </a>在<a class="ae li" href="https://unsplash.com/s/photos/thanks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="bd54" class="os mg iu bd mh ot ou dn ml ov ow dp mp ls ox oy mr lw oz pa mt ma pb pc mv ja bi translated">回答:</h2><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="qf qg l"/></div></figure><p id="875d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">希望你做对了！😊</p></div></div>    
</body>
</html>