<html>
<head>
<title>10 Sklearn Gems Buried In the Docs Waiting To Be Found</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">埋藏在文档中等待被发现的10颗Sklearn宝石</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/10-sklearn-gems-buried-in-the-docs-waiting-to-be-found-ad95a8fabdfd#2022-07-05">https://towardsdatascience.com/10-sklearn-gems-buried-in-the-docs-waiting-to-be-found-ad95a8fabdfd#2022-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f80" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">隐藏的宝藏</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9c45073c71bf0be4c2bb3b3f53fe1d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZvR50cZJEDdKqIRrCpqNKg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/closeup-photo-of-purple-gemstones-1121123/" rel="noopener ugc nofollow" target="_blank">乔尼·卢</a></p></figure><h1 id="5210" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">动机</h1><p id="ed4b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我<em class="mn">讨厌</em> Sklearn。我上的“ML入门”课对支持向量机的解释非常糟糕，以至于我以此为基础来评价整个库。在那之后的几个月里，我放弃了这门课程，永远离开了曼梯·里。</p><p id="9257" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我一点也不知道Sklearn会成为我在庞大的数据科学堆栈中最喜欢的库。我也不知道我会为此写22篇文章。这是我第23次。最后一个的<a class="ae ky" rel="noopener" target="_blank" href="/19-hidden-sklearn-features-you-were-supposed-to-learn-the-hard-way-5293e6ff149">和之前的</a><a class="ae ky" href="https://ibexorigin.medium.com/6-sklearn-mistakes-that-silently-tell-you-are-rookie-f1fe44779a4d" rel="noopener">的</a>都是飞天成功。成千上万的人读过它们。</p><p id="2d4f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我写这篇文章的目的是一样的——向你展示这个图书馆比你想象的要棒得多。这一次，您将了解我发现并立即添加到我的工具箱中的一些最新的、被低估的Sklearn特性。</p><p id="28aa" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这篇文章将比我上一篇类似的功能汇编实用得多，我的上一篇类似的功能汇编更侧重于边缘情况。尽情享受吧！</p><div class="mt mu gp gr mv mw"><a rel="noopener follow" target="_blank" href="/19-hidden-sklearn-features-you-were-supposed-to-learn-the-hard-way-5293e6ff149"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">19个隐藏的Sklearn特性你应该通过艰苦的方式来学习</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">但是我给出了捷径</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">towardsdatascience.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk ks mw"/></div></div></a></div></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="e691" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">1️.功能变压器</h1><p id="a5b0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尽管Sklearn有许多预处理转换器可以放入管道中，但它们不足以用于任何可以想象的预处理场景。即使您有一个不在管道内的单独步骤，原子的单一调用管道的整体思想也会崩溃。</p><p id="bf82" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这就是为什么你应该把你所有的自定义函数包装在<code class="fe nx ny nz oa b">FunctionTransformer</code>里面，这样可以把它们转换成一个Sklearn兼容的转换器。唯一的要求是该函数接受一个特征数组(X)和一个可选的目标数组，并在预处理后返回它们。</p><h2 id="fe85" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><h2 id="8b08" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="fab9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">功能变压器</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.FunctionTransformer.html#sklearn.preprocessing.FunctionTransformer" rel="noopener ugc nofollow" target="_blank">链接</a></p><div class="mt mu gp gr mv mw"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">通过我的推荐链接加入Medium-BEXGBoost</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">获得独家访问我的所有⚡premium⚡内容和所有媒体没有限制。支持我的工作，给我买一个…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nf l"><div class="op l nh ni nj nf nk ks mw"/></div></div></a></div><p id="c443" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">获得由强大的AI-Alpha信号选择和总结的最佳和最新的ML和AI论文:</p><div class="mt mu gp gr mv mw"><a href="https://alphasignal.ai/?referrer=Bex" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">阿尔法信号|机器学习的极品。艾总结的。</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">留在循环中，不用花无数时间浏览下一个突破；我们的算法识别…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">alphasignal.ai</p></div></div><div class="nf l"><div class="oq l nh ni nj nf nk ks mw"/></div></div></a></div></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="fea3" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">2️.用户定义的变压器</h1><p id="294d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在最后一节的基础上，您不能在一个简单的函数中执行一些定制的数据清理步骤。</p><p id="ca13" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">例如，清理过程中最常见的操作之一是缩放倾斜要素，使其呈正态分布。通常，人们使用像<code class="fe nx ny nz oa b">PowerTransformer</code>或<code class="fe nx ny nz oa b">np.log</code>这样的对数变压器，但是它们有一个缺点。如果某个要素包含零，对数将无法处理它们并引发错误。</p><p id="a95a" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">作为一种变通方法，人们在特征向量上加1，然后进行变换。如果他们需要原始向量，他们会调用该要素的指数函数并减去1-问题就解决了。</p><p id="4e4c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">当然，这个操作不是内置在Sklearn中的，并且您不能在一个简单的Python函数中执行它。这就是你用定制变形金刚优雅地解决这个难题的地方。下面是一个完全符合我描述的转换器:</p><h2 id="fa07" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="e4af" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">该类应该从<code class="fe nx ny nz oa b">BaseEstimator</code>和<code class="fe nx ny nz oa b">TransformerMixin</code>类继承，使其能够插入到管道中。编写的代码越少，数据泄露的可能性就越小。</p><p id="bd33" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果您想了解关于这种方法的更多信息，我有一篇关于这种类型的定制转换器的单独文章，包括FunctionTransformer:</p><div class="mt mu gp gr mv mw"><a rel="noopener follow" target="_blank" href="/how-to-write-powerful-code-others-admire-with-custom-sklearn-transformers-34bc9087fdd"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">如何用自定义Sklearn变形金刚写出别人佩服的强大代码</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">编辑描述</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">towardsdatascience.com</p></div></div><div class="nf l"><div class="or l nh ni nj nf nk ks mw"/></div></div></a></div><h2 id="060d" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="a0af" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> BaseEstimator </strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.BaseEstimator.html#sklearn.base.BaseEstimator" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="5e93" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu">变压器混频器</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.base.TransformerMixin.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="5681" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">3️.转换目标回归器</h1><p id="4c5d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有时，即使是目标数组也需要额外的预处理步骤，这是不能包含在管道中的。一个典型的场景是缩放数字目标，使它们呈正态分布。你在管道之外这样做，经常不止一次。</p><p id="8945" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果有一个管道也能处理目标数组，那不是很好吗？原来是有的！(仅用于回归)。</p><p id="b9a0" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">TransformedTargetRegressor是一个类，它既接受功能上的回归器管道，也接受目标数组的单独预处理函数或转换器。</p><h2 id="0ad7" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="e4e5" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><code class="fe nx ny nz oa b">regressor</code>参数接受以它们结尾的回归变量或管道。它还有<code class="fe nx ny nz oa b">transformer</code>参数，您可以为它传递一个要应用到目标上的transformer类。如果transformer是一个函数，比如<code class="fe nx ny nz oa b">np.log</code>，你可以把它传递给<code class="fe nx ny nz oa b">func</code>参数。</p><p id="4513" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">然后，调用<code class="fe nx ny nz oa b">fit</code>将转换特性和目标数组，并拟合回归量。在文档中了解更多信息。</p><h2 id="b70c" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="351d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">转换目标进度器</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.TransformedTargetRegressor.html#sklearn.compose.TransformedTargetRegressor" rel="noopener ugc nofollow" target="_blank">环节</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="40bd" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">4️.HTML估计器表示</h1><p id="9208" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你的管道由几个步骤或者子管道组成，它们的IPython显示会让你眼睛出血。如果你不小心在Jupyter中显示它们，看起来会是这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="37b7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">幸运的是，Sklearn提供了估算器的HTML表示，使它们更加用户友好，让我们看得开心:</p><h2 id="c83d" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl os"><img src="../Images/af000e4066751d7a4cedd68a3f6315ca.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ksGzeuAWrfPr_pjm4MLncw.png"/></div></figure><p id="6b71" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">通过将display config设置为<code class="fe nx ny nz oa b">diagram</code>，您可以在IPython中获得管道的交互式HTML表示。</p><h2 id="d958" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="feb0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> sklearn.set_config </strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.set_config.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="1b30" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu">sk learn . utils . estimator _ html _ repr</strong>—<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.utils.estimator_html_repr.html" rel="noopener ugc nofollow" target="_blank">链接</a></p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="ecb7" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">5️.正交判别分析</h1><p id="8a14" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在Kaggle <a class="ae ky" href="https://www.kaggle.com/c/instant-gratification/overview" rel="noopener ugc nofollow" target="_blank">即时满足竞赛</a>中，一个二次判别分析分类器甚至在没有超参数调整的情况下也取得了令人印象深刻的0.965 ROC AUC分数，超过了大多数基于树的模型，包括XGBoost和LightGBM。</p><p id="8b18" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">那么，如果这种算法可以胜过最先进的模型，为什么你以前从未听说过它呢？嗯，它的用例是有限的。用于训练QDA的要素应严格服从正态分布，从而便于QDA计算和拟合分布周围的椭球形状。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/52d2a663f13e788e4a66c113efbfba9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/0*zzl1hjB4SZ-8_WFp.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自Sklearn用户指南</p></figure><p id="656b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">QDA的另一个优势是它非常快，在百万行数据集上训练它只需要几秒钟:</p><h2 id="3ee5" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="020d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在这本<a class="ae ky" href="https://www.kaggle.com/cdeotte/pseudo-labeling-qda-0-969/notebook" rel="noopener ugc nofollow" target="_blank">笔记本</a>中，Chris Deotte展示了他如何通过组合512个QDA模型获得0.965的ROC AUC分数。</p><p id="2aff" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在上个月的<a class="ae ky" href="https://www.kaggle.com/c/tabular-playground-series-sep-2021/overview" rel="noopener ugc nofollow" target="_blank"> TPS竞赛(9月)</a>中，我也设法获得了0.8左右的ROC AUC，而表现最好的解决方案大约为0.81。2%的差异是您可能要考虑的最精确的基于树的模型和运行速度极快的模型之间的权衡，前者速度慢得多，后者以较低的精确度为代价。</p><h2 id="fdb8" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="cb8f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">方差分析</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis.html#sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis" rel="noopener ugc nofollow" target="_blank">环节</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="0872" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">6️.投票分类器/回归器</h1><p id="5df9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在一个单独的项目中，你经常会得到几个性能相似的模型。这就是投票组合可以集体使用这些模型来进一步提高性能的地方。投票分类器将几个分类器的多数投票作为最终预测。如果类是概率或预测是连续的，则预测是平均的。</p><p id="807f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这种方法非常有效的原因是概率论中固有的。简而言之，当组合时，具有0.6、0.7、0.8准确度的三个分类器最终将优于具有0.8准确度的三个分类器。如果你不相信我，请阅读来自MLWave的这篇文章。</p><p id="dccc" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">Sklearn提供了两个方便的类来实现这个操作。您需要传递一个分类器或回归器列表，它会处理剩下的事情。</p><h2 id="969d" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="c939" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我将<code class="fe nx ny nz oa b">voting</code>设置为soft，表示我希望预测是概率。还有一个<code class="fe nx ny nz oa b">weights</code>参数，您可以使用它为更精确的模型分配不同的系数。查看文档了解更多细节。</p><h2 id="13f5" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="064f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">投票分类器</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingClassifier.html#sklearn.ensemble.VotingClassifier" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="0a62" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> VotingRegressor </strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingRegressor.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="8fd7" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">7️.堆叠分类器/回归器</h1><p id="e281" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">另一种比投票更强大的集合方法是<strong class="lt iu">堆叠</strong>。</p><p id="ffc7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">假设你有五个模型。要堆叠它们的输出，您需要将它们逐一拟合到训练数据中，并生成预测。您将有五个预测集，这些预测集与定型集的目标数组组合成一个数据集。</p><p id="2704" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">然后，您选择一个最终的、完全不同的模型来训练这个“预测数据集”，并在保留集上进行预测。</p><p id="725a" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">堆叠背后的想法是，您选择的1级模型应该尽可能多样化。不同的模型从不同的角度学习训练集中的信息，覆盖了整个信息空间。换句话说，像树、线性模型、表面拟合、基于邻居的模型、贝叶斯模型和高斯模型这样的各种模型最大化了训练潜力，并且它们的组合输出减少了偏差并防止了过度拟合。</p><p id="c84d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在Kaggle表格竞赛中，大多数获胜的解决方案都是几个模型叠加在一起。</p><h2 id="b374" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="e817" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">尽管听起来很复杂，但使用Sklearn，你很快就会掌握它的窍门。实现就像投票分类器/回归器一样直观。欲了解更多信息，请阅读本文或文档。</p><h2 id="d7d2" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="f64e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">堆叠分类器</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingClassifier.html#sklearn.ensemble.StackingClassifier" rel="noopener ugc nofollow" target="_blank">环节</a>。</p><p id="2e04" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu">堆栈回归器</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingRegressor.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="506d" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">8️.LocalOutlierFactor</h1><p id="e659" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">离群点是机器学习中的一个严重问题。它们会使模型的目标函数产生偏差，并可能导致过于乐观或悲观的结果。</p><p id="b30b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于小型玩具数据集来说，发现异常值不成问题。真正的挑战始于拥有超过50–100个要素的数据集。您需要一种既快速又准确地检测高维离群值的算法。即便如此，对于包含数百个要素和数百万行的数据集，原始算法可能需要数小时才能运行。</p><p id="3a2e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这就是你需要结合一个降维算法和一个健壮的离群点检测器的地方。最近喜欢上的一个组合是<strong class="lt iu"> UMAP </strong>和<strong class="lt iu">localooutlierfactor</strong>。</p><p id="4c87" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">UMAP在降低数据集的维度并尽可能多地保留信息方面表现出色。至于LocalOutlierFactor，它是一种基于邻居的算法，旨在快速处理大型数据集。</p><h2 id="6bd5" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="c704" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果这个演示不完全可以理解，我有一篇关于这个主题的单独文章来深入讨论它:</p><div class="mt mu gp gr mv mw"><a rel="noopener follow" target="_blank" href="/tricky-way-of-using-dimensionality-reduction-for-outlier-detection-in-python-4ee7665cdf99"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">Python中使用降维进行离群点检测的巧妙方法</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">编辑描述</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">towardsdatascience.com</p></div></div><div class="nf l"><div class="ou l nh ni nj nf nk ks mw"/></div></div></a></div><h2 id="e381" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="458d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">local outlierfactor</strong>—<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.LocalOutlierFactor.html#sklearn.neighbors.LocalOutlierFactor" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="44f5" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">9️.量化变压器</h1><p id="e91d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有时，你会遇到像下面这样的疯狂分布，简单的对数变换，或者定标器不能满足它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有罕见分布的合成生成数据-按作者</p></figure><p id="a122" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果你有这样的双峰，三峰，或<em class="mn"> n </em>峰分布，你最好的选择是<code class="fe nx ny nz oa b">QuantileTransformer</code>使它们尽可能正态分布。它使用稳健的统计指标，如四分位数和中位数来确定分布的中心和比例。</p><h2 id="e0bd" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl os"><img src="../Images/a9f317533979ddf1636e1c46a6eacbb4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*u_G0PdWRdxjxDN4dTI8rTg.png"/></div></figure><h2 id="33d5" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="5185" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">量化器</strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.QuantileTransformer.html#sklearn.preprocessing.QuantileTransformer" rel="noopener ugc nofollow" target="_blank">环节</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="7ebc" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">1️0️.PCA + tSNE/UMAP</h1><p id="da76" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">更多的数据不一定意味着更好的模型。有些数据集太大了，即使不完全使用它们，你也能做得很好。但是如果你不愿意将一部分数据放在一边，我建议使用降维技术将数据投影到一个较低的空间。</p><p id="e2fb" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">不能保证模型性能的提高，但是从长远来看，您可以在更小的数据集上运行更多的实验，因为您将使用更少的RAM，并且计算时间将会更短。</p><p id="5f5e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">但问题是，如果数据集中有许多特征，质量降维可能需要太长时间。你不会第一次就做对，所以更多的实验会更加昂贵。这就是为什么Sklearn文档建议将降维算法和PCA(主成分分析)结合起来。</p><p id="78b4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">主成分分析对任意维数都能快速工作，是第一阶段简化的理想选择。建议使用PCA将数据投影到合理的维数，如30–50，然后使用其他算法进一步降低维数。</p><p id="91fd" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">下面是PCA和tSNE的组合:</p><h2 id="39dc" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">💻演示</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">300个维度的综合生成数据—按作者</p></figure><p id="a6cd" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在一个包含100万行和大约300个要素的合成数据集上，将数据投影到前30个维度，然后投影到2D，需要4.5个小时。不幸的是，结果并不乐观:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl os"><img src="../Images/14f4f8f422e9b4eabb944a9b72022f91.png" data-original-src="https://miro.medium.com/v2/format:webp/1*W9u1hqj0rLnAre_m7uHccA.png"/></div></figure><p id="3f92" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这就是为什么我建议使用UMAP。它比tSNE快得多，并且更好地保留了数据的本地结构:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl os"><img src="../Images/96712eeca3896b32fdf174a2f5237fe7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*MWb5hJNwIocEgKQkZLbd0Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">300维合成数据的UMAP投影</p></figure><p id="1b06" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">UMAP设法找到了目标类之间的明显区别，并且比tSNE快20倍。</p><h2 id="efd2" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">📚证明文件</h2><p id="9165" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> PCA </strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="1d0f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> tSNE </strong> — <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html#sklearn.manifold.TSNE" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="07f2" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> UMAP </strong> — <a class="ae ky" href="https://umap-learn.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="b7b7" class="kz la it bd lb lc ns le lf lg nt li lj jz nu ka ll kc nv kd ln kf nw kg lp lq bi translated">摘要</h1><p id="4680" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有趣的事实是——我仍然不知道支持向量机及其工作原理。并且没有立即学习它们的计划。评判我吧，但我只关心树木。</p><p id="221b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">感谢您的阅读！</p><div class="mt mu gp gr mv mw"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">用我的推荐链接加入Medium，无限学习。</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">作为一个媒体会员，你的会费的一部分归我，这样我会更有动力去写更多的故事来帮助你和其他人…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nf l"><div class="ov l nh ni nj nf nk ks mw"/></div></div></a></div><h2 id="02ed" class="ob la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated"><strong class="ak">我的更多故事……</strong></h2><div class="mt mu gp gr mv mw"><a href="https://ibexorigin.medium.com/28-weekly-machine-learning-tricks-and-resources-that-are-pure-gems-1-8e5259a93c94" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">28个每周机器学习技巧和资源，它们是纯粹的珍宝#1</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">一次学习一个片段的机器学习</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nf l"><div class="ow l nh ni nj nf nk ks mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a rel="noopener follow" target="_blank" href="/18-non-cliché-datasets-for-beginner-data-scientists-to-build-a-strong-portfolio-c59743b2a829"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">18个非陈词滥调数据集，供初学数据科学家构建强大的投资组合</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">从微生物学到体育的独特数据集</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">towardsdatascience.com</p></div></div><div class="nf l"><div class="ox l nh ni nj nf nk ks mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a rel="noopener follow" target="_blank" href="/in-depth-spacy-tutorial-for-beginners-in-nlp-2ba4d961328f"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">NLP初学者的深入空间教程</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">学习Scikit-学习自然语言处理</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">towardsdatascience.com</p></div></div><div class="nf l"><div class="oy l nh ni nj nf nk ks mw"/></div></div></a></div><div class="mt mu gp gr mv mw"><a href="https://ibexorigin.medium.com/in-depth-guide-to-building-custom-sklearn-transformers-for-any-data-preprocessing-scenario-33450f8b35ff" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">为任何数据预处理场景构建定制Sklearn转换器的深入指南</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">在Sklearn做好每一件事，大家都会开心</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="nf l"><div class="oz l nh ni nj nf nk ks mw"/></div></div></a></div></div></div>    
</body>
</html>