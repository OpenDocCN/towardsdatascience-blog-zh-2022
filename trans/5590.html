<html>
<head>
<title>Google Analytics in R: Review of 2022</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌分析:2022 年回顾</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/google-analytics-in-r-review-of-2022-52d6bf4c1bb7#2022-12-16">https://towardsdatascience.com/google-analytics-in-r-review-of-2022-52d6bf4c1bb7#2022-12-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="15b0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何通过 R 中的 googleAnalyticsR 包为您的博客或网站分析和可视化通用分析(UA)和 Google 分析 4 (GA4)数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0552b02ff9eb424986b8eb11196df80a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cT3nyl2R85crAAoV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@pawel_czerwinski?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">帕韦尔·切尔文斯基</a>拍摄</p></figure><h1 id="c79a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="27fb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi mn translated"><span class="l mo mp mq bm mr ms mt mu mv di"> It </span>快到年底了，这意味着是时候做一个统计和 R 的回顾，回顾过去的一年。</p><p id="58a4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">今年的回顾会比往年短得多，因为在那些<a class="ae ky" href="https://statsandr.com/tags/review/" rel="noopener ugc nofollow" target="_blank">以前的回顾</a>中已经有很多例子了。</p><p id="24a5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，2022 年 9 月初，我从通用分析(被称为 UA)转移到谷歌分析 4(被称为 GA4)。你可能知道如果你经常使用谷歌分析；2023 年 7 月 1 日，标准通用分析属性将停止处理新的点击。这意味着，如果您想在此日期后继续使用它，您将需要转移到 GA4。</p><p id="faea" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">今年，我将简要介绍不同的指标以及如何分析您的 Google Analytics (GA)数据。然而，这篇文章也许会对那些已经迁移到(或将迁移到)GA4 并且仍然想从 UA 和 GA4 分析 GA 数据的人有所帮助。</p><p id="2196" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我不得不承认，将两者的数据结合起来是相当耗时的，特别是因为 UA 和 GA4 的度量和维度是不同的。所以如果你还没有搬家，我建议你在一年的年底或年初搬家。这将避免您必须从两个 GA IDs 获取数据，然后必须在 r 中组合这两个数据。</p><p id="abf4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">像往常一样，我在 R 中分析我的 GA 数据，这要感谢来自<a class="ae ky" href="https://code.markedmondson.me/googleAnalyticsR/" rel="noopener ugc nofollow" target="_blank"> Mark Edmondson </a>的惊人的<code class="fe nb nc nd ne b">{googleAnalyticsR}</code>包。</p><p id="7e98" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，下面给出的实际数字对您来说不是很有用。每个博客和网站都不一样，所以每个受众都不一样。这篇帖子更多的是说明在 R 中分析 GA 数据的过程(今年，也是为了说明合并来自两个 GA IDs 的 GA 数据的过程)，而不是展示我的数字。</p><h1 id="12be" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">先决条件</h1><p id="1c71" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，您必须指定要分析数据的 GA ID。我的如下:</p><pre class="kj kk kl km gt nf ne ng bn nh ni bi"><span id="52c0" class="nj la it ne b be nk nl l nm nn">ga_id &lt;- c("208126346", "250795226")</span></pre><p id="b521" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">您将在 GA 帐户的管理部分找到您的。</p><h1 id="ab89" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分析学</h1><p id="95e5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这一节中，我将展示一些在分析 GA 数据时可能有用的可视化工具。如果你使用了其他有趣的可视化工具，请在文章末尾随意评论。</p><p id="2a71" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，我在这篇文章中关注的是页面浏览量指标，但是您也可以编辑我的代码来显示其他指标。查看 UA 的可用指标<a class="ae ky" href="https://ga-dev-tools.web.app/dimensions-metrics-explorer/" rel="noopener ugc nofollow" target="_blank">和 GA4 </a>的可用指标<a class="ae ky" href="https://developers.google.com/analytics/devguides/reporting/data/v1/api-schema" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="ca18" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">一段时间内的页面访问量</h1><p id="a5c5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">先说过去一年的浏览量演变，那么从 2021 年 12 月 16 日到 2022 年 12 月 15 日。</p><pre class="kj kk kl km gt nf ne ng bn nh ni bi"><span id="c9b8" class="nj la it ne b be nk nl l nm nn">library(googleAnalyticsR)</span></pre><pre class="no nf ne np nq aw nr bi"><span id="341c" class="ns la it ne b gy nt nu l nv nn"># set date range<br/>start_date &lt;- as.Date("2021-12-16")<br/>end_date &lt;- as.Date("2022-12-15")</span><span id="7d54" class="ns la it ne b gy nw nu l nv nn"># extract data from both IDs<br/>dat1 &lt;- google_analytics(ga_id[1],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "pageviews",<br/>  dimensions = "date",<br/>  anti_sample = TRUE # avoid sampling<br/>)</span><span id="df24" class="ns la it ne b gy nw nu l nv nn">dat2 &lt;- ga_data(ga_id[2],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "screenPageViews",<br/>  dimensions = "date",<br/>  limit = -1 # return all data (no limit)<br/>)</span><span id="81fb" class="ns la it ne b gy nw nu l nv nn"># combine data from both IDs<br/>library(dplyr)<br/>dat &lt;- full_join(dat1, dat2, by = "date")<br/>dat$page_views &lt;- rowSums(select(dat, pageviews, screenPageViews),<br/>  na.rm = TRUE<br/>)<br/></span><span id="7a59" class="ns la it ne b gy nw nu l nv nn"># scatter plot with a trend line<br/>library(ggplot2)<br/>dat %&gt;%<br/>  ggplot(aes(x = date, y = page_views)) +<br/>  geom_point(size = 1L, color = "gray") + # change size and color of points<br/>  geom_smooth(color = "steelblue", alpha = 0.25) + # change color of smoothed line and transparency of confidence interval<br/>  theme_minimal() +<br/>  labs(<br/>    y = "Page views",<br/>    x = "",<br/>    title = "Evolution of daily page views",<br/>    subtitle = paste0(format(start_date, "%b %d, %Y"), " to ", format(end_date, "%b %d, %Y")),<br/>    caption = "Data: Google Analytics data of statsandr.com"<br/>  ) +<br/>  theme(plot.margin = unit(c(5.5, 17.5, 5.5, 5.5), "pt")) + # to avoid the plot being cut on the right edge<br/>  scale_y_continuous(labels = scales::comma) # better y labels</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/9a9bd91d8fc4146818f24da572ecabce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9cl5eoZEjqjiZblq.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="615d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">正如您在上面的代码中看到的，我们需要:</p><ul class=""><li id="bcb1" class="ny nz it lt b lu mw lx mx ma oa me ob mi oc mm od oe of og bi translated">从两个不同的 id 中提取数据:这是用 UA 的<code class="fe nb nc nd ne b">google_analytics()</code>和 GA4 的<code class="fe nb nc nd ne b">ga_data()</code>完成的(每个函数都有自己的参数)</li><li id="6ed6" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">连接来自两个 id 的数据(用一个<code class="fe nb nc nd ne b">full_join()</code>连接，因为即使在移动到 GA4 之后，UA 上仍然有一些点击，所以我需要保留全年来自两个 id 的数据)</li><li id="eac8" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">合计两个 id 的度量(用<code class="fe nb nc nd ne b">rowSums()</code>)</li></ul><p id="b837" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这个过程将对每个可视化重复进行。</p><p id="fe94" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">从上面的图中，我们看到页面浏览量遵循一个周期性的演变过程(在夏季有所下降)。这一趋势遵循与去年相同的模式，但今年最后一个季度的增幅在 2022 年更大。</p><p id="d8d4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，似乎总有一些日子的页面浏览量低于其他日子。这实际上是周末。在<a class="ae ky" href="https://statsandr.com/blog/review-of-2022/#page-views-per-day-of-week" rel="noopener ugc nofollow" target="_blank">部分</a>中可以看到更多相关信息。还要注意页面浏览量超过 5000 的异常值<a class="ae ky" href="https://statsandr.com/blog/outliers-detection-in-r/" rel="noopener ugc nofollow" target="_blank">的存在。那天没有发布任何帖子，所以它可能来自一个分享给大量观众的旧帖子。</a></p><p id="6bd1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">最后，将所有天数相加，总浏览量为 938，630。去年是 876280，所以 2022 年增长了 7.12%。</p><h1 id="6554" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">每月和每年的页面访问量</h1><p id="fcfb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">比较前几年每月的页面浏览量也是有用的。下面是两种不同类型的可视化。</p><pre class="kj kk kl km gt nf ne ng bn nh ni bi"><span id="ff15" class="nj la it ne b be nk nl l nm nn"># set new date range to include previous years<br/>start_date_launch &lt;- as.Date("2019-12-16")</span></pre><pre class="no nf ne np nq aw nr bi"><span id="b831" class="ns la it ne b gy nt nu l nv nn"># extract data from both IDs<br/>dat1 &lt;- google_analytics(ga_id[1],<br/>  date_range = c(start_date_launch, end_date),<br/>  metrics = "pageviews",<br/>  dimensions = "date",<br/>  anti_sample = TRUE # avoid sampling<br/>)</span><span id="98da" class="ns la it ne b gy nw nu l nv nn">dat2 &lt;- ga_data(ga_id[2],<br/>  date_range = c(start_date_launch, end_date),<br/>  metrics = "screenPageViews",<br/>  dimensions = "date",<br/>  limit = -1 # return all data (no limit)<br/>)</span><span id="bd46" class="ns la it ne b gy nw nu l nv nn"># combine data from both IDs<br/>dat &lt;- full_join(dat1, dat2, by = "date")<br/>dat$page_views &lt;- rowSums(select(dat, pageviews, screenPageViews),<br/>  na.rm = TRUE<br/>)<br/></span><span id="f4f8" class="ns la it ne b gy nw nu l nv nn"># add year and month columns to dataframe<br/>dat$month &lt;- format(dat$date, "%m")<br/>dat$year &lt;- format(dat$date, "%Y")</span><span id="b482" class="ns la it ne b gy nw nu l nv nn"># page views by month by year using dplyr then graph using ggplot2 barplot<br/>dat %&gt;%<br/>  filter(year != 2019) %&gt;% # remove 2019 because there are data for December only<br/>  group_by(year, month) %&gt;%<br/>  summarize(page_views = sum(page_views)) %&gt;%<br/>  ggplot(aes(x = month, y = page_views, fill = year)) +<br/>  geom_bar(position = "dodge", stat = "identity") +<br/>  theme_minimal() +<br/>  labs(<br/>    y = "Page views",<br/>    x = "Month",<br/>    title = "Page views per month and year",<br/>    subtitle = paste0(format(start_date_launch, "%b %d, %Y"), " to ", format(end_date, "%b %d, %Y")),<br/>    caption = "Data: Google Analytics data of statsandr.com",<br/>    fill = "" # remove legend title<br/>  ) +<br/>  theme(legend.position = "top") + # change legend position<br/>  scale_y_continuous(labels = scales::comma) # better y labels</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/169b757f6a87988c1e46918bb3a96931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IG64MpBertY0MOMK.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="3c89" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">另一种可能性如下:</p><pre class="kj kk kl km gt nf ne ng bn nh ni bi"><span id="1ae5" class="nj la it ne b be nk nl l nm nn">dat2 &lt;- dat</span></pre><pre class="no nf ne np nq aw nr bi"><span id="c548" class="ns la it ne b gy nt nu l nv nn">library(lubridate)<br/>dat2$day &lt;- day(dat2$date)<br/>dat2$day_month &lt;- as.Date(paste0(dat2$month, "-", dat2$day), format = "%m-%d")</span><span id="dbcb" class="ns la it ne b gy nw nu l nv nn">dat2 %&gt;%<br/>  filter(year != 2019 &amp; page_views &lt; 7500) %&gt;% # remove 2019 and outliers<br/>  ggplot(aes(x = day_month, y = page_views, color = year)) +<br/>  geom_point(size = 1L, alpha = 0.25) + # change size and alpha of points<br/>  geom_smooth(se = FALSE) + # remove confidence interval<br/>  theme_minimal() +<br/>  labs(<br/>    y = "Page views",<br/>    x = "",<br/>    title = "Evolution of daily page views",<br/>    subtitle = paste0(format(start_date_launch, "%b %d, %Y"), " to ", format(end_date, "%b %d, %Y")),<br/>    caption = "Data: Google Analytics data of statsandr.com",<br/>    color = "" # remove legend title<br/>  ) +<br/>  theme(legend.position = "top") + # change legend position<br/>  scale_y_continuous(labels = scales::comma) + # better y labels<br/>  scale_x_date(date_labels = "%b") # show only months</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/f385690985aabd2cab71e4d5bc2a71e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*O1wzvVl-sIWSYM44.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="c04e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">从上面的两个图中，我们看到，与 2020 年至 2021 年相比，该博客在页面浏览量方面的全球表现更好(除了 2021 年第一季度的表现更好)。</p><p id="ce06" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，3 年之间的比较是好的，但如果用更多的年份来比较，这些图将很快变得不可读！</p><h1 id="3b62" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">表现最佳的页面</h1><p id="6f18" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果您有兴趣了解表现最佳的页面(仍以页面浏览量计):</p><pre class="kj kk kl km gt nf ne ng bn nh ni bi"><span id="8a38" class="nj la it ne b be nk nl l nm nn"># extract data from both IDs<br/>dat1 &lt;- google_analytics(ga_id[1],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "pageviews",<br/>  dimensions = "pageTitle",<br/>  anti_sample = TRUE # avoid sampling<br/>)</span></pre><pre class="no nf ne np nq aw nr bi"><span id="bf45" class="ns la it ne b gy nt nu l nv nn">dat2 &lt;- ga_data(ga_id[2],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "screenPageViews",<br/>  dimensions = "pageTitle",<br/>  limit = -1 # return all data (no limit)<br/>)</span><span id="1851" class="ns la it ne b gy nw nu l nv nn"># combine data from both IDs<br/>dat &lt;- full_join(dat1, dat2, by = "pageTitle")<br/>dat$page_views &lt;- rowSums(select(dat, pageviews, screenPageViews),<br/>  na.rm = TRUE<br/>)</span><span id="f5c3" class="ns la it ne b gy nw nu l nv nn">## Create a table of the most viewed posts<br/>library(lubridate)<br/>library(reactable)<br/>library(stringr)<br/></span><span id="5fa7" class="ns la it ne b gy nw nu l nv nn">most_viewed_posts &lt;- dat %&gt;%<br/>  mutate(Title = str_sub(pageTitle, start = 1, end = -nchar(" - Stats and R"))) %&gt;% # remove blog site in pageTitle<br/>  count(Title, wt = page_views, sort = TRUE) %&gt;%<br/>  mutate(Title = str_trunc(Title, width = 30)) # keep maximum 30 characters</span><span id="3b14" class="ns la it ne b gy nw nu l nv nn"># plot<br/>top_n(most_viewed_posts, n = 7, n) %&gt;% # edit n for more or less pages to display<br/>  ggplot(., aes(x = reorder(Title, n), y = n)) +<br/>  geom_bar(stat = "identity", fill = "steelblue") +<br/>  theme_minimal() +<br/>  coord_flip() +<br/>  labs(<br/>    y = "Page views",<br/>    x = "Page title",<br/>    title = "Top performing pages",<br/>    subtitle = paste0(format(start_date, "%b %d, %Y"), " to ", format(end_date, "%b %d, %Y")),<br/>    caption = "Data: Google Analytics data of statsandr.com"<br/>  ) +<br/>  scale_y_continuous(labels = scales::comma) # better y labels</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/29d69a157200529d69ad70d6978bb5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nd3oFzdXblxJC6Hx.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="f76d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">表现最佳的帖子与去年非常相似，即:</p><ol class=""><li id="be69" class="ny nz it lt b lu mw lx mx ma oa me ob mi oc mm om oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/descriptive-statistics-in-r/" rel="noopener ugc nofollow" target="_blank">R 中的描述性统计</a></li><li id="c820" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm om oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/outliers-detection-in-r/" rel="noopener ugc nofollow" target="_blank">R 中的离群点检测</a></li><li id="d0d3" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm om oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/correlation-coefficient-and-correlation-test-in-r/" rel="noopener ugc nofollow" target="_blank">R 中的相关系数和相关检验</a></li><li id="331f" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm om oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank">R 中的方差分析</a></li><li id="a6da" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm om oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/chi-square-test-of-independence-in-r/" rel="noopener ugc nofollow" target="_blank">R 中独立性的卡方检验</a></li></ol><p id="cc5f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">由于它们是几年来阅读量最大的帖子，我已经通过<a class="ae ky" href="https://statsandr.gumroad.com/" rel="noopener ugc nofollow" target="_blank"> Gumroad </a>提供下载。</p><h1 id="245a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">按国家列出的页面浏览量</h1><p id="3ab8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">了解你的读者来自哪个国家也很有用，特别是对于电子商务或者除了写文章以外还销售实体产品的博客。</p><pre class="kj kk kl km gt nf ne ng bn nh ni bi"><span id="430d" class="nj la it ne b be nk nl l nm nn"># extract data from both IDs<br/>dat1 &lt;- google_analytics(ga_id[1],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "pageviews",<br/>  dimensions = "country",<br/>  anti_sample = TRUE # avoid sampling<br/>)</span></pre><pre class="no nf ne np nq aw nr bi"><span id="1415" class="ns la it ne b gy nt nu l nv nn">dat2 &lt;- ga_data(ga_id[2],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "screenPageViews",<br/>  dimensions = "country",<br/>  limit = -1 # return all data (no limit)<br/>)</span><span id="ba72" class="ns la it ne b gy nw nu l nv nn"># combine data from both IDs<br/>dat &lt;- full_join(dat1, dat2, by = "country")<br/>dat$page_views &lt;- rowSums(select(dat, pageviews, screenPageViews),<br/>  na.rm = TRUE<br/>)</span><span id="c39a" class="ns la it ne b gy nw nu l nv nn"># table<br/>countries &lt;- dat %&gt;%<br/>  mutate(Country = str_trunc(country, width = 30)) %&gt;% # keep maximum 30 characters<br/>  count(Country, wt = pageviews, sort = TRUE)</span><span id="3006" class="ns la it ne b gy nw nu l nv nn"># plot<br/>top_n(countries, n = 10, n) %&gt;% # edit n for more or less countries to display<br/>  ggplot(., aes(x = reorder(Country, n), y = n)) +<br/>  geom_bar(stat = "identity", fill = "steelblue") +<br/>  theme_minimal() +<br/>  coord_flip() +<br/>  labs(<br/>    y = "Page views",<br/>    x = "Country",<br/>    title = "Top performing countries",<br/>    subtitle = paste0(format(start_date, "%b %d, %Y"), " to ", format(end_date, "%b %d, %Y")),<br/>    caption = "Data: Google Analytics data of statsandr.com"<br/>  ) +<br/>  scale_y_continuous(labels = scales::comma) + # better y labels<br/>  theme(plot.margin = unit(c(5.5, 7.5, 5.5, 5.5), "pt")) # to avoid the plot being cut on the right edge</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/ffced28296846db9105a1a6f9fe802f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CoH2e4ciOeA7mQdy.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="261a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">对于 Stats 和 R 来说，大多数读者来自美国，很大程度上是因为第二大国家(英国)在页面浏览量方面相差甚远。</p><p id="11bf" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这一趋势与去年相同，只是:</p><ul class=""><li id="7fe0" class="ny nz it lt b lu mw lx mx ma oa me ob mi oc mm od oe of og bi translated">英国已经超过印度，而</li><li id="94b5" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated">比利时(曾在 2020 年和 2021 年分别排名第三和第六)现在仅列第八。由于我来自比利时，这表明这个博客这些年来吸引了越来越多的国际读者(而来自我的国家的读者相应地越来越少)。</li></ul><h1 id="e2ef" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">每周每天的页面浏览量</h1><p id="f9da" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如在关于每日页面浏览量演变的章节中所讨论的(查看此<a class="ae ky" href="https://statsandr.com/blog/review-of-2022/#page-views-over-time" rel="noopener ugc nofollow" target="_blank">章节</a>)，似乎有些日子的表现一直比其他日子差。</p><p id="2999" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">下面的情节将展示这些日子是什么:</p><pre class="kj kk kl km gt nf ne ng bn nh ni bi"><span id="9b34" class="nj la it ne b be nk nl l nm nn"># extract data from both IDs<br/>dat1 &lt;- google_analytics(ga_id[1],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "pageviews",<br/>  dimensions = c("date"),<br/>  anti_sample = TRUE # avoid sampling<br/>)</span></pre><pre class="no nf ne np nq aw nr bi"><span id="531e" class="ns la it ne b gy nt nu l nv nn">dat2 &lt;- ga_data(ga_id[2],<br/>  date_range = c(start_date, end_date),<br/>  metrics = "screenPageViews",<br/>  dimensions = c("date"),<br/>  limit = -1 # return all data (no limit)<br/>)</span><span id="fbda" class="ns la it ne b gy nw nu l nv nn"># combine data from both IDs<br/>dat &lt;- full_join(dat1, dat2, by = "date")<br/>dat$page_views &lt;- rowSums(select(dat, pageviews, screenPageViews),<br/>  na.rm = TRUE<br/>)<br/># find day of week<br/>dat$weekday &lt;- wday(dat$date, label = TRUE, abbr = TRUE)</span><span id="8d1f" class="ns la it ne b gy nw nu l nv nn">## Reordering dat$weekday so Monday is first<br/>dat$weekday &lt;- factor(dat$weekday,<br/>  levels = c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")<br/>)</span><span id="35fc" class="ns la it ne b gy nw nu l nv nn"># boxplot<br/>library(scales)<br/>dat %&gt;%<br/>  ggplot(aes(x = weekday, y = page_views)) +<br/>  geom_boxplot(fill = "steelblue", outlier.colour = alpha(0.25)) +<br/>  geom_jitter(alpha = 0.25) + # adds transparency<br/>  theme_minimal() +<br/>  labs(<br/>    y = "Page views",<br/>    x = "",<br/>    title = "Page views per day of week",<br/>    subtitle = paste0(format(start_date, "%b %d, %Y"), " to ", format(end_date, "%b %d, %Y")),<br/>    caption = "Data: Google Analytics data of statsandr.com"<br/>  ) +<br/>  scale_y_continuous(labels = scales::comma) # better y labels</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/8494ece7f71df8793a60601c0a16e4d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SmRADFlJ-ZAvsh5L.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="5a9d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">正如一个技术博客所预期的那样，一周内的读者比周末多得多。</p><h1 id="e110" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">感谢信</h1><p id="e731" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">感谢所有今年来到 Stats and R 的读者。你让这段旅程变得无比丰富。对于明年和未来的许多年，我将继续写我熟悉和感兴趣的话题。敬请关注！</p><p id="f814" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">感谢阅读。我希望这篇文章能帮助你在 R 中分析你的 Google Analytics 数据，或者帮助你结合你的 Universal Analytics 和 Google Analytics 4 数据。有关 R 中 GA 数据的可视化或汇总的更多示例，另请参见往年的<a class="ae ky" href="https://statsandr.com/tags/review/" rel="noopener ugc nofollow" target="_blank">评论</a>。</p><p id="2164" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p><h1 id="be65" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关文章</h1><ul class=""><li id="5728" class="ny nz it lt b lu lv lx ly ma on me oo mi op mm od oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/statsandr-is-2-years-old/" rel="noopener ugc nofollow" target="_blank"> Stats 和 R 都 2 岁了！</a></li><li id="bb8f" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/track-blog-performance-in-r/" rel="noopener ugc nofollow" target="_blank">如何跟踪你的博客在 R？</a></li><li id="9011" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/how-to-keep-up-to-date-with-the-latest-r-news/" rel="noopener ugc nofollow" target="_blank">如何让自己了解最新的 R 新闻？</a></li><li id="32f4" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/7-benefits-of-sharing-your-code-in-a-data-science-blog/" rel="noopener ugc nofollow" target="_blank">为什么我有一个数据科学博客？分享代码的 7 个好处</a></li><li id="c771" class="ny nz it lt b lu oh lx oi ma oj me ok mi ol mm od oe of og bi translated"><a class="ae ky" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">R 中的图形与 ggplot2 </a></li></ul></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="2dd1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="ox">原载于 2022 年 12 月 16 日 https://statsandr.com</em><a class="ae ky" href="https://statsandr.com/blog/review-of-2022/" rel="noopener ugc nofollow" target="_blank"><em class="ox"/></a><em class="ox">。</em></p></div></div>    
</body>
</html>