<html>
<head>
<title>BentoML: Create an ML Powered Prediction Service in Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BentoML:在几分钟内创建一个 ML 驱动的预测服务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bentoml-create-an-ml-powered-prediction-service-in-minutes-23d135d6ca76#2022-02-17">https://towardsdatascience.com/bentoml-create-an-ml-powered-prediction-service-in-minutes-23d135d6ca76#2022-02-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="90b9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用 Python 封装和部署您的 ML 模型</h2></div><h1 id="2e94" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">动机</h1><p id="5138" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">您刚刚建立了一个机器学习模型来预测客户属于哪个群体。该模型似乎在细分客户方面做得很好。您决定将这个模型交给您的团队成员，以便他们可以在您的模型之上开发 web 应用程序。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi lw"><img src="../Images/583dde90f27890f1136cba991cc8004a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxPlfd5nl8I8N8tnj0WieQ.png"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="7302" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">等等，但是你如何将这个模型发送给你的团队成员呢？如果你的团队成员可以<strong class="lc iu">使用你的模型而不用设置任何环境或者弄乱你的代码</strong>，那不是很好吗？这时候 BentoML 就派上用场了。</p><p id="71c7" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">随意发挥，并在这里叉这篇文章的源代码:</p><div class="mr ms gp gr mt mu"><a href="https://github.com/khuyentran1401/customer_segmentation/tree/bentoml_demo" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">GitHub—khuyentran 1401/客户 _ bentoml _ demo 的细分</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">数据是从 Kaggle 下载的。</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">github.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni mg mu"/></div></div></a></div><h1 id="aa73" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">BentoML 是什么？</h1><p id="33b1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae nj" href="https://github.com/bentoml/BentoML" rel="noopener ugc nofollow" target="_blank"> BentoML </a>是一个 Python 开源库，使用户能够在几分钟内创建一个机器学习驱动的预测服务，这有助于弥合数据科学和 DevOps 之间的差距。</p><p id="2dd6" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">要使用将在本文中使用的 BentoML 版本，请键入:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="f5c3" class="np kj it nl b gy nq nr l ns nt">pip install bentoml==1.0.0a4</span></pre><p id="a96d" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">为了理解 BentoML 是如何工作的，我们将使用 BentoML 来服务于一个根据新客户的个性对其进行细分的模型。</p><h1 id="f4cf" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">保存处理器</h1><p id="05f4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">从从 Kaggle 下载<a class="ae nj" href="https://www.kaggle.com/imakash3011/customer-personality-analysis" rel="noopener ugc nofollow" target="_blank">客户个性分析</a>数据集开始。接下来，我们将处理数据。</p><p id="afa9" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">由于我们稍后将使用<code class="fe nu nv nw nl b">StandardScaler</code>和<code class="fe nu nv nw nl b">PCA</code>来处理新数据，我们将把这些 scikit-learn 的变形金刚保存到 BentoML 的本地模型商店。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="75a0" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">运行上面的代码后，模型将保存在<code class="fe nu nv nw nl b">~/bentoml/models/</code>下。您可以通过运行以下命令来查看本地存储的所有模型:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="396c" class="np kj it nl b gy nq nr l ns nt">$ bentoml models list</span></pre><p id="9353" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">输出:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="4b55" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">请注意，该模型是用特定的标签进行版本化的。如果我们保存另一个同名的模型，您应该会看到一个不同的标签。</p><p id="0d93" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">这非常好，因为对模型进行版本控制将允许您在不同的模型之间来回切换。</p><p id="f93c" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated"><em class="nz">找到完整的代码读取并处理数据</em> <a class="ae nj" href="https://github.com/khuyentran1401/customer_segmentation/blob/bentoml_demo/src/process_data.py" rel="noopener ugc nofollow" target="_blank"> <em class="nz">这里</em> </a> <em class="nz">。</em></p><h1 id="c715" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">保存模型</h1><p id="d7c3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">接下来，我们将在处理后的数据集上训练<code class="fe nu nv nw nl b">KMeans</code>模型。我们将使用如上所示的相同方法来保存模型。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="9ef9" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated"><em class="nz">在这里</em>  <em class="nz">找到关于训练和保存模型</em> <a class="ae nj" href="https://github.com/khuyentran1401/customer_segmentation/blob/bentoml_demo/src/segment.py" rel="noopener ugc nofollow" target="_blank"> <em class="nz">的完整代码。</em></a></p><h1 id="bcc9" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">创建服务</h1><p id="dd42" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在我们有了模型，让我们加载最新的处理器和模型，并在<code class="fe nu nv nw nl b">bentoml_app_pandas.py</code>中用该模型创建一个服务。</p><p id="aa9d" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated"><code class="fe nu nv nw nl b">function_name</code>告诉 BentoML 模型运行时将使用哪个函数。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="264f" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated"><code class="fe nu nv nw nl b">function_name</code>的默认值为<code class="fe nu nv nw nl b">predict</code>。由于<code class="fe nu nv nw nl b">customer_segmentation_kmeans</code>是一个估计量，我们保持<code class="fe nu nv nw nl b">function_name</code>的默认值。由于<code class="fe nu nv nw nl b">scaler</code>和<code class="fe nu nv nw nl b">pca</code>是变压器，所以我们把<code class="fe nu nv nw nl b">function_name</code>设为<code class="fe nu nv nw nl b">transform</code>。</p><p id="32b7" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">然后用处理器和模型创建一个服务:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="8353" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">定义服务后，我们可以用它来创建一个 API 函数:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="f797" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">装饰器<code class="fe nu nv nw nl b">@service.api</code>声明函数<code class="fe nu nv nw nl b">predict</code>是一个 API，其输入是一个<code class="fe nu nv nw nl b">PandasDataFrame</code>，输出是一个<code class="fe nu nv nw nl b">NumpyNdarray</code>。</p><p id="bd69" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">现在让我们通过运行<code class="fe nu nv nw nl b">bentoml serve</code>在调试模式下测试服务。由于<code class="fe nu nv nw nl b">bentoml_app_pandas.py</code>在<code class="fe nu nv nw nl b">src</code>目录下，我们运行:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="dd11" class="np kj it nl b gy nq nr l ns nt">$ bentoml serve src/<!-- -->bentoml_app_pandas.py:service --reload</span></pre><p id="b384" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">输出:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="acab" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">我们现在可以通过访问<a class="ae nj" href="http://127.0.0.1:5000" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000 </a>并点击“试用”按钮来与 API 进行交互:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi oa"><img src="../Images/fe5c7fb5fe8efc8210e50a8646b98c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gsFwFoaCc7RqTPWwtcNjg.png"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="e5f0" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">插入以下值:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="0230" class="np kj it nl b gy nq nr l ns nt">[{"Income": 58138, "Recency": 58, "NumWebVisitsMonth": 2, "Complain": 0,"age": 64,"total_purchases": 25,"enrollment_years": 10,"family_size": 1}]</span></pre><p id="0a4d" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">…请求体应该给你一个值<code class="fe nu nv nw nl b">1</code>。这意味着模型预测具有这些特征的客户属于分类 1。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ob"><img src="../Images/006652e9f76c05d46afd97f0b753ab55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*yoa7BCkJjjr9IuwUzW85-Q.gif"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者 GIF</p></figure><h2 id="e6a1" class="np kj it bd kk oc od dn ko oe of dp ks lj og oh ku ln oi oj kw lr ok ol ky om bi translated">用 pydantic 创建数据模型</h2><p id="9f5a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了确保用户将具有正确数据类型的正确值插入到 API 中，我们可以使用 pydantic 创建一个自定义数据模型:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="271e" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">现在，您应该在请求主体下看到默认值。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi on"><img src="../Images/331391e460150a545f8b48dd87df184b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*6eQdlONSzafIOcT6r9kSAQ.png"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="cd06" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated"><em class="nz">在这里</em>  <em class="nz">可以找到关于创建 API </em> <a class="ae nj" href="https://github.com/khuyentran1401/customer_segmentation/blob/bentoml_demo/src/bentoml_app.py" rel="noopener ugc nofollow" target="_blank"> <em class="nz">的完整代码。</em></a></p><h1 id="4b98" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">制作便当</h1><p id="ce65" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在确保一切看起来不错之后，我们可以开始将模型、服务和依赖项放入便当中。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi oo"><img src="../Images/d957b87abbb43bf9fa254ba3b0ddbabf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_gi8bLO6NmSXKY-x5D9jg.png"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="a8e7" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">要构建 Bentos，首先在项目目录中创建一个名为<code class="fe nu nv nw nl b">bentofile.yaml</code>的文件:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="845d" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">关于上述文件的详细信息:</p><ul class=""><li id="0389" class="op oq it lc b ld mm lg mn lj or ln os lr ot lv ou ov ow ox bi translated"><code class="fe nu nv nw nl b">include</code>部分告诉 BentoML 在便当中包含哪些文件。在这个文件中，我们包括了<code class="fe nu nv nw nl b">bentoml_app.py</code>和我们之前保存的所有处理器。</li><li id="d2ea" class="op oq it lc b ld oy lg oz lj pa ln pb lr pc lv ou ov ow ox bi translated"><code class="fe nu nv nw nl b">python</code>部分告诉 BentoML 服务依赖于哪些 Python 包。</li></ul><p id="14e6" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">现在我们准备好做便当了！</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="c223" class="np kj it nl b gy nq nr l ns nt">$ bentoml build</span></pre><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/883d532196993dab786ff51ce9d89568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*VxXEGqpddQDN_KGF3zNrcA.png"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="0b08" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">构建好的便当会保存在<code class="fe nu nv nw nl b">~/bentoml/bentos/&lt;model-name&gt;/&lt;tag&gt;</code>目录下。目录中的文件应该类似于下图:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="6cf4" class="np kj it nl b gy nq nr l ns nt">.<br/>├── README.md<br/>├── apis<br/>│   └── openapi.yaml<br/>├── bento.yaml<br/>├── env<br/>│   ├── conda<br/>│   ├── docker<br/>│   │   ├── Dockerfile<br/>│   │   ├── entrypoint.sh<br/>│   │   └── init.sh<br/>│   └── python<br/>│       ├── requirements.lock.txt<br/>│       ├── requirements.txt<br/>│       └── version.txt<br/>├── models<br/>│   ├── customer_segmentation_kmeans<br/>│   │   ├── cs5htpv3ncng3lg6<br/>│   │   │   ├── model.yaml<br/>│   │   │   └── saved_model.pkl<br/>│   │   └── latest<br/>│   ├── pca<br/>│   │   ├── latest<br/>│   │   └── sa4bx5f3ngf6flg6<br/>│   │       ├── model.yaml<br/>│   │       └── saved_model.pkl<br/>│   └── scaler<br/>│       ├── latest<br/>│       └── sawshnv3ngf6flg6<br/>│           ├── model.yaml<br/>│           └── saved_model.pkl<br/>└── src<br/>    └── src<br/>        └── bentoml_app.py</span></pre><p id="0b4c" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">相当酷！我们刚刚用几行代码创建了一个包含模型、服务、处理器、Python 需求和 docker 文件的文件夹！</p><h1 id="7f2b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">部署到 Heroku</h1><p id="c541" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在你已经有了制作好的便当，你可以把它打包成<a class="ae nj" href="https://docs.bentoml.org/en/latest/concepts/containerize_bentos.html#containerize-bentos-page" rel="noopener ugc nofollow" target="_blank"> Docker images </a>或者部署到 Heroku。因为我想为我的 API 创建一个公共链接，所以我将把它部署到 Heroku 容器注册中心。</p><p id="71bf" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">从安装<a class="ae nj" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>开始，然后在命令行上登录一个 Heroku 帐户:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="de3a" class="np kj it nl b gy nq nr l ns nt">$ heroku login</span></pre><p id="57f9" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">登录 Heroku 容器注册表:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="ad5b" class="np kj it nl b gy nq nr l ns nt">$ heroku container:login</span></pre><p id="8d49" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">创建 Heroku 应用程序:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="6c27" class="np kj it nl b gy nq nr l ns nt">$ APP_NAME=bentoml-her0ku-<strong class="nl iu">$(</strong>date +%s | base64 | tr '[:upper:]' '[:lower:]' | tr -dc _a-z-0-9<strong class="nl iu">)</strong><br/>heroku create $APP_NAME</span></pre><p id="aab3" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">接下来，转到您最新构建的便当下的 docker 目录。要查看您的便当的目录，运行:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="f9cd" class="np kj it nl b gy nq nr l ns nt">$ bentoml list -o json<br/>[<br/>  {<br/>    "tag": "customer_segmentation_kmeans:4xidjrepjonwswyg",<br/>    "service": "src.bentoml_app:service",<br/>    "path": "/home/khuyen/bentoml/bentos/customer_segmentation_kmeans/4xidjrepjonwswyg",<br/>    "size": "29.13 KiB",<br/>    "creation_time": "2022-02-16 17:15:01"<br/>  }<br/>]</span></pre><p id="d6ee" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">由于我最新的便当在<code class="fe nu nv nw nl b">~/bentoml/bentos/customer_segmentation_kmeans/4xidjrepjonwswyg</code>，我将运行:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="975c" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">将便当打包并推送到上面创建的 Heroku 应用程序:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="293c" class="np kj it nl b gy nq nr l ns nt">$ heroku container:push web --app $APP_NAME  --context-path=../..</span></pre><p id="a552" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">发布应用程序:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="de35" class="np kj it nl b gy nq nr l ns nt">$ heroku container:release web --app $APP_NAME</span></pre><p id="d9a3" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">新应用程序现在应该会列在<a class="ae nj" href="https://dashboard.heroku.com/apps" rel="noopener ugc nofollow" target="_blank"> Heroku 仪表盘</a>中:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/a185099c840e1292f3611d10a08ace9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*5az3H_dnTtChHoM_GMh0FQ.png"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="65bb" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">单击应用程序的名称，然后单击“打开应用程序”打开您的 API 的应用程序:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/7709c9d362259e46648b56905838115d.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*I4egOGqVIEMCV6kXHMj_DA.png"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="518e" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">我的 API 服务的公共链接是<a class="ae nj" href="https://bentoml-her0ku-mty0ndg3mza0ngo.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://bentoml-her0ku-mty0ndg3mza0ngo.herokuapp.com</a>。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/4824e33a97c30379264ee9a9681c41bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*D-SgFdF7yQKpHJCI5vtWSw.png"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者图片</p></figure><p id="0b1e" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">现在，您可以使用公共链接通过示例数据进行预测请求:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="f79a" class="np kj it nl b gy nq nr l ns nt">2</span></pre><p id="f6a5" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">就是这样！现在，您可以将此链接发送给团队的其他成员，以便他们可以构建一个基于机器学习的 web 应用程序。<strong class="lc iu">无需安装和设置</strong>即可使用您的机器学习模型。多酷啊。</p><p id="0a82" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">如果您喜欢自己创建一个简单的 UI，下一节将向您展示如何使用 Streamlit 来实现。</p><h1 id="b76a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">使用 Streamlit 为您的服务构建 UI</h1><p id="8338" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果您希望您的经理或利益相关者尝试您的模型，使用<a class="ae nj" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>为您的模型构建一个简单的 UI 可能是个好主意。</p><p id="f7b4" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">在文件<code class="fe nu nv nw nl b">streamlit_app.py</code>中，我从用户那里获得输入，然后使用这些输入进行预测请求。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="cfe0" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">运行 Streamlit 应用程序:</p><pre class="lx ly lz ma gt nk nl nm nn aw no bi"><span id="022f" class="np kj it nl b gy nq nr l ns nt">$ streamlit run src/streamlit_app.py</span></pre><p id="d4d9" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">然后去<a class="ae nj" href="http://localhost:8501" rel="noopener ugc nofollow" target="_blank"> http://localhost:8501 </a>。您应该会看到如下所示的 web 应用程序:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi on"><img src="../Images/507a70442a31aef3526c94dc0084a636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/1*N_d36Qnw-sISy8qH3_v9iw.gif"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">作者 GIF</p></figure><p id="cffb" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">这款应用现在玩起来更直观了。</p><h1 id="5450" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="1dd1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">恭喜你！您刚刚学习了如何使用 BentoML 为您的机器学习模型创建 API 端点。有了 BentoML，您的队友可以使用您的模型，而无需设置环境或修改代码。多酷啊。</p></div><div class="ab cl ph pi hx pj" role="separator"><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm"/></div><div class="im in io ip iq"><p id="27de" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的数据科学工具。你可以通过<a class="ae nj" href="https://www.linkedin.com/in/khuyen-tran-1401/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae nj" href="https://twitter.com/KhuyenTran16" rel="noopener ugc nofollow" target="_blank"> Twitter </a>与我联系。</p><p id="fed4" class="pw-post-body-paragraph la lb it lc b ld mm ju lf lg mn jx li lj mo ll lm ln mp lp lq lr mq lt lu lv im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在 Medium 上关注我，了解我的最新数据科学文章，例如:</p><div class="mr ms gp gr mt mu"><a rel="noopener follow" target="_blank" href="/orchestrate-a-data-science-project-in-python-with-prefect-e69c61a49074"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">用 Prefect 编制 Python 中的数据科学项目</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">用几行代码优化您的数据科学工作流程</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">towardsdatascience.com</p></div></div><div class="nd l"><div class="po l nf ng nh nd ni mg mu"/></div></div></a></div><div class="mr ms gp gr mt mu"><a rel="noopener follow" target="_blank" href="/introduction-to-dvc-data-version-control-tool-for-machine-learning-projects-7cb49c229fe0"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">DVC 介绍:机器学习项目的数据版本控制工具</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">就像 Git 一样，但是有数据！</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">towardsdatascience.com</p></div></div><div class="nd l"><div class="pp l nf ng nh nd ni mg mu"/></div></div></a></div><div class="mr ms gp gr mt mu"><a rel="noopener follow" target="_blank" href="/pytest-for-data-scientists-2990319e55e6"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">数据科学家 Pytest</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">适用于您的数据科学项目的 Pytest 综合指南</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">towardsdatascience.com</p></div></div><div class="nd l"><div class="pq l nf ng nh nd ni mg mu"/></div></div></a></div><div class="mr ms gp gr mt mu"><a rel="noopener follow" target="_blank" href="/introduction-to-schema-a-python-libary-to-validate-your-data-c6d99e06d56a"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd iu gy z fp mz fr fs na fu fw is bi translated">模式介绍:验证数据的 Python 库</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">验证您的数据变得更加复杂！</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">towardsdatascience.com</p></div></div><div class="nd l"><div class="pr l nf ng nh nd ni mg mu"/></div></div></a></div><h1 id="678f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">参考</h1><p id="279c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">阿卡什·帕特尔。2021–08–22.客户个性分析。<br/> CC0:公共领域。检索自<a class="ae nj" href="https://www.kaggle.com/imakash3011/customer-personality-analysis/" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/imakash 3011/customer-personality-analysis/</a></p></div></div>    
</body>
</html>