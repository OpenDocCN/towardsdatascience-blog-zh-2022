<html>
<head>
<title>How to Build a Web App with Data Ingested through Versatile Data Kit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用通过多功能数据工具包获取的数据构建Web应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-a-web-app-with-data-ingested-through-versatile-data-kit-ddae43b5f62d#2022-05-23">https://towardsdatascience.com/how-to-build-a-web-app-with-data-ingested-through-versatile-data-kit-ddae43b5f62d#2022-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="daf3" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据库，网络应用</h2><div class=""/><div class=""><h2 id="3d15" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">关于如何构建Web应用程序的分步教程，结合了Streamlit Python库和多功能数据工具包。</h2></div><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj kr"><img src="../Images/0ae82a81e072f3d784040bb4b6641ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ODTuF-zQLx5OJ-YI"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae lh" href="https://unsplash.com/@bugsster?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Taras Shypka </a>拍摄</p></figure><p id="4990" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在过去的几个月里，我参与了一个非常有趣的项目，叫做多功能数据工具包(VDK)。VDK是一个非常强大的框架，用于在数据库中接收不同格式的数据，包括CSV文件、JSON对象，甚至REST API服务提供的数据。</p><p id="5f23" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">VDK兼容几种类型的数据库，包括但不限于sqlite、Trino DB、Impala、Postgres和Snowflake。</p><p id="051b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">VDK由VMware实施，是一款开源软件。更多信息可以参考官方<a class="ae lh" href="https://github.com/vmware/versatile-data-kit" rel="noopener ugc nofollow" target="_blank"> VDK Github库</a>。</p><p id="fa31" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我以前的文章中，我描述了VDK的不同方面，包括:</p><ul class=""><li id="102e" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/an-overview-of-versatile-data-kit-a812cfb26de7">如何开始使用VDK </a></li><li id="0c35" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/from-raw-data-to-a-cleaned-database-a-deep-dive-into-versatile-data-kit-ab5fd992a02e">VDK和Trino DB如何组合</a></li><li id="484c" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/using-versatile-data-kit-to-ingest-and-process-data-from-rest-api-6e3e0660b791">如何从REST API摄取数据</a>。</li></ul><p id="ba62" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我将描述如何使用通过VDK存储的数据来构建一个基于Streamlit的web应用程序，Streamlit是一个流行的Python库，用于快速轻松地构建网站。</p><p id="a767" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以在页面底部找到与本文中描述的示例相关的完整代码。</p><p id="547b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要配置环境以使用VDK，您可以参考以前的文章。</p><p id="43fa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">文章组织如下:</p><ul class=""><li id="3020" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">VDK概况</li><li id="7838" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">场景的定义</li><li id="dbbc" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">VDK的数据接收</li><li id="ecba" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">VDK的数据处理</li><li id="d01f" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">构建Streamlit应用程序。</li></ul><h1 id="e0b4" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">1 VDK概述</h1><p id="9cbb" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">通用数据工具包(VDK)是一个框架，允许您开发，部署，运行和管理数据作业。<strong class="lk jd">数据作业是一种数据处理工作量。</strong>您可以定义两种类型的数据作业:</p><ul class=""><li id="14c9" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><strong class="lk jd">摄取作业</strong>，将不同来源的数据推送到数据湖。通常，通过接收作业，您接收由数据提供者提供的原始数据。</li><li id="f616" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><strong class="lk jd">处理已经包含在数据湖中的作业</strong>，您可以在其中操作您的数据。这个想法是建立精选的数据集，你可以用它来做进一步的分析。</li></ul><p id="8403" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">关于VDK的更多细节，你可以阅读我以前的一篇文章，题为<a class="ae lh" rel="noopener" target="_blank" href="/an-overview-of-versatile-data-kit-a812cfb26de7">多功能数据工具包概述</a>。</p><h1 id="f651" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">2场景的定义</h1><p id="582d" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">此场景的目标是构建一个显示美国天然气价格和温度之间关系的应用程序。</p><p id="46bd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该应用程序使用VDK来摄取和处理以下两个CSV数据集:</p><ul class=""><li id="62be" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="https://datahub.io/core/natural-gas" rel="noopener ugc nofollow" target="_blank">1997-2020年天然气价格</a></li><li id="d7f8" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">【1910年至2020年美国气候极端指数</li></ul><p id="ce06" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">天然气价格数据集包含5，953条记录，由美国能源信息管理局(EIA)提供。每个记录包含天然气的每日价格。对于每条记录，以下信息可用:</p><ul class=""><li id="6aee" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">日期(每天提供)</li><li id="c72d" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">价格(美元)</li></ul><p id="4a4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下表显示了数据集的摘录:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj np"><img src="../Images/9efd21d2384fb74575ef8e31fc36fdac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0okKEbPEnuCG6UPd3wdi1Q.png"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><p id="a7df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">美国极端气候指数数据集包含112条记录。对于每条记录，可以下载许多参数。数据分析师选择以下信息:</p><ul class=""><li id="97f5" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">日期(每年提供一次)</li><li id="c401" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">远高于正常的最低温度百分比</li><li id="13f8" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">远低于正常的最低温度百分比。</li></ul><p id="af7d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下表显示了数据集的摘录:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj nq"><img src="../Images/c74f1fe25cb44e6a9462a53ba5c9dba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZADc53g8oU60S53e-pGgw.png"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><p id="d28a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要运行此示例，您需要:</p><ul class=""><li id="1dbc" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">多功能数据工具包</li><li id="1cf4" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">Trino DB</li><li id="856d" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">Trino的多功能数据工具包插件</li><li id="ca38" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">细流</li></ul><p id="1b42" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有关如何为Trino安装多功能数据套件、Trino DB、Streamlit和多功能数据套件插件的更多详细信息，请参考<a class="ae lh" href="https://github.com/vmware/versatile-data-kit/tree/main/examples/life-expectancy" rel="noopener ugc nofollow" target="_blank">此链接</a>。</p><h1 id="dd20" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">3 VDK的数据接收</h1><p id="f5b1" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">数据摄取上传到CSV文件的数据库输出中，如前一节所述。对于每个数据集，通过以下步骤执行数据接收:</p><ul class=""><li id="8624" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">删除现有的表(如果有)</li><li id="98cf" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">创建新表格</li><li id="da97" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">直接从CSV获取表格值。</li></ul><p id="01b4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">前面的所有步骤构成了一个数据摄取作业。</p><p id="00bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要访问CSV文件，此示例需要有效的互联网连接才能正常工作。例如，我只考虑第一个数据集(天然气价格)，但对于其他数据集，过程是相同的。</p><h2 id="0c06" class="nr mt it bd mu ns nt dn my nu nv dp nc lr nw nx ne lv ny nz ng lz oa ob ni iz bi translated">3.1删除现有表格</h2><p id="152a" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我将这一步写成一个SQL命令，如果表存在的话，就删除它:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="5441" class="nr mt it od b gz oh oi l oj ok">DROP TABLE IF EXISTS natural_gas_prices</span></pre><h2 id="1572" class="nr mt it bd mu ns nt dn my nu nv dp nc lr nw nx ne lv ny nz ng lz oa ob ni iz bi translated">3.2创建新表</h2><p id="8400" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">现在，我定义了一个新步骤，该步骤创建了一个新表，其中将包含CSV文件:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="447c" class="nr mt it od b gz oh oi l oj ok">CREATE TABLE natural_gas_prices (<br/>   Date varchar,<br/>   Price double<br/>)</span></pre><h2 id="35e5" class="nr mt it bd mu ns nt dn my nu nv dp nc lr nw nx ne lv ny nz ng lz oa ob ni iz bi translated">3.3摄取值</h2><p id="699b" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">为了从CSV获取值，我定义了一个Python脚本，它将CSV文件作为熊猫数据帧读取，然后通过VDK提供的<code class="fe ol om on od b">send_tabular_data_for_ingestion()</code>方法获取它:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="f993" class="nr mt it od b gz oh oi l oj ok">def run(job_input: IJobInput):</span><span id="33b0" class="nr mt it od b gz oo oi l oj ok">   url = "https://datahub.io/core/natural-gas/r/daily.csv"<br/>   df = pd.read_csv(url)</span><span id="a3f2" class="nr mt it od b gz oo oi l oj ok">   job_input.send_tabular_data_for_ingestion(<br/>       df.itertuples(index=False),<br/>       destination_table="natural_gas_prices",<br/>       column_names=df.columns.tolist(),<br/>   )</span></pre><h1 id="92e8" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">4 VDK的数据处理</h1><p id="724a" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">数据处理包括两个步骤:</p><ul class=""><li id="4b84" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">用天然气价格的平均值构建年度视图<code class="fe ol om on od b">natural_gas_prices</code></li><li id="8197" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">合并两个表，前一个和<code class="fe ol om on od b">climate_extremes_index</code>。</li></ul><h2 id="440b" class="nr mt it bd mu ns nt dn my nu nv dp nc lr nw nx ne lv ny nz ng lz oa ob ni iz bi translated">4.1建筑年景</h2><p id="7c34" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">要构建年度视图，只需操作<code class="fe ol om on od b">natural_gas_prices</code>表，如下所示:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="6923" class="nr mt it od b gz oh oi l oj ok">CREATE TABLE average_gas_price_by_year AS</span><span id="9252" class="nr mt it od b gz oo oi l oj ok">(SELECT extract(YEAR from CAST(Date AS date)) AS Year,<br/>   avg(Price) AS Price<br/>   FROM natural_gas_prices.  <br/>   GROUP BY extract(YEAR from CAST(Date AS date))<br/>)</span></pre><p id="4997" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，我创建了一个新表，名为<code class="fe ol om on od b">average_gas_price_by_year</code>。</p><p id="b4ef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下表显示了生成的表的示例:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div class="gi gj op"><img src="../Images/dce3d4c36b2d6ba8ea7b129269dafc2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*YrnWWBuChnkZCYnWBfCnvg.png"/></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><h2 id="2732" class="nr mt it bd mu ns nt dn my nu nv dp nc lr nw nx ne lv ny nz ng lz oa ob ni iz bi translated">4.2合并两个表</h2><p id="914d" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">最后一步，我合并了两个表<code class="fe ol om on od b">climate_extremes_index</code>(从第二个CSV文件中提取的表)和<code class="fe ol om on od b">average_gas_price_by_year</code>。值在区间[0，1]中被归一化，从而使它们之间的比较成为可能。</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="2dd1" class="nr mt it od b gz oh oi l oj ok">CREATE TABLE merged_tables AS</span><span id="0b3d" class="nr mt it od b gz oo oi l oj ok">(SELECT Year,</span><span id="7586" class="nr mt it od b gz oo oi l oj ok">(Price / (SELECT max(Price) FROM average_gas_price_by_year)) AS NormPrice,</span><span id="c83e" class="nr mt it od b gz oo oi l oj ok">(MuchAboveNormal / (SELECT max(MuchAboveNormal) FROM climate_extremes_index WHERE CAST(climate_extremes_index.Date AS integer) IN (SELECT Year from average_gas_price_by_year))) AS NormTemperatureMuchAboveNormal,</span><span id="d4b5" class="nr mt it od b gz oo oi l oj ok">(MuchBelowNormal / (SELECT max(MuchBelowNormal) FROM climate_extremes_index WHERE CAST(climate_extremes_index.Date AS integer) IN (SELECT Year from average_gas_price_by_year))) AS NormTemperatureMuchBelowNormal</span><span id="899b" class="nr mt it od b gz oo oi l oj ok">FROM average_gas_price_by_year INNER JOIN climate_extremes_index</span><span id="ceaf" class="nr mt it od b gz oo oi l oj ok">ON average_gas_price_by_year.Year = CAST(climate_extremes_index.Date AS integer)</span><span id="a775" class="nr mt it od b gz oo oi l oj ok">)</span></pre><p id="5474" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在前面的查询中，对于select中的每个字段，除了<code class="fe ol om on od b">Year</code>，我按照最大值对字段进行规范化。为了获得字段的最大值，我构建了另一个内部查询。</p><h1 id="f186" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">5构建Streamlit应用</h1><p id="fb3d" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">现在我已经准备好构建最终的应用程序了。首先，我导入所有需要的库:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="0642" class="nr mt it od b gz oh oi l oj ok">import altair as alt<br/>import numpy as np<br/>import pandas as pd<br/>import streamlit as st<br/>import trino</span></pre><p id="1512" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将使用<code class="fe ol om on od b">altair</code>构建一些图表，并使用<code class="fe ol om on od b">trino</code>连接到Trino服务器。</p><p id="c01c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我连接到服务器:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="74da" class="nr mt it od b gz oh oi l oj ok">conn = trino.dbapi.connect(<br/>   host="localhost",<br/>   port=8080,<br/>   user="root",<br/>   catalog="mysql",<br/>   http_scheme="HTTP",<br/>   verify=True,<br/>   schema="energy",</span><span id="6051" class="nr mt it od b gz oo oi l oj ok">)</span></pre><p id="6557" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我写了一篇减价文，题目是:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="3ef5" class="nr mt it od b gz oh oi l oj ok">st.markdown("# Does the Natural Gas Price in the US depend on the temparature?")</span></pre><p id="cf9c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，我从数据库中读取数据:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="b3fe" class="nr mt it od b gz oh oi l oj ok">df = pd.read_sql_query(f"SELECT Year, NormPrice, NormTemperatureMuchAboveNormal, NormTemperatureMuchBelowNormal FROM merged_tables",conn,)</span></pre><p id="b6c1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我制作了这张图表:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="bf16" class="nr mt it od b gz oh oi l oj ok">palette = ["#ff9494", "#ff5252", "#8B0000"]</span><span id="03fd" class="nr mt it od b gz oo oi l oj ok">indicators = ["NormPrice", <br/>"NormTemperatureMuchAboveNormal",<br/>"NormTemperatureMuchBelowNormal",<br/>]</span><span id="1188" class="nr mt it od b gz oo oi l oj ok">price_bar = (alt.Chart(df)<br/>   .mark_bar(size=30)<br/>   .encode(x="Year:O", y="NormPrice:Q", color=alt.value("#8B0000"))<br/>)</span><span id="1b41" class="nr mt it od b gz oo oi l oj ok">temp_list = ["MuchAboveNormal", "MuchBelowNormal"]<br/>temp_type = st.selectbox("Select Temperature", temp_list, key="temp_type")</span><span id="dbc6" class="nr mt it od b gz oo oi l oj ok">temp_line = (<br/>   alt.Chart(df)<br/>   .mark_line()<br/>   .encode(x="Year:O", y=f"NormTemperature{temp_type}:Q", color=alt.value("#ff9494"))</span><span id="dc64" class="nr mt it od b gz oo oi l oj ok">)</span><span id="338b" class="nr mt it od b gz oo oi l oj ok">c = (price_bar + temp_line).properties(height=350, width=800)<br/>st.altair_chart(c)</span></pre><p id="3d9c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我从终端运行应用程序:</p><pre class="ks kt ku kv gu oc od oe of aw og bi"><span id="94f8" class="nr mt it od b gz oh oi l oj ok">streamlit run dashboard.py</span></pre><p id="c092" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下图显示了最终输出:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj oq"><img src="../Images/22503c388ec262c0d986889629e63d0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hGFnCmGarHH5z9usiJEYhQ.png"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><h1 id="20a1" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">摘要</h1><p id="2a74" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">在本文中，我描述了如何将VDK与Streamlit集成来构建一个Web应用程序。首先，我在VDK下载、消化和处理数据，然后我在Streamlit中构建了Web应用程序。</p><p id="dee2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在<a class="ae lh" href="https://github.com/vmware/versatile-data-kit/tree/main/examples/energy" rel="noopener ugc nofollow" target="_blank"> VDK官方Github库</a>中的examples一节下找到这个例子的完整代码。</p><p id="8195" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于多功能数据工具包的问题或疑问，您可以直接加入他们的<a class="ae lh" href="https://join.slack.com/t/versatiledata-rgg2437/shared_invite/zt-tvnl62c3-qP0EUYJZJxb6Ws_eQWyDtQ" rel="noopener ugc nofollow" target="_blank">公共slack workspace </a>或<a class="ae lh" href="mailto:join-versatiledatakit@groups.vmware.com?subject=Invite%20me%20to%20the%20VDK%20mailing%20list" rel="noopener ugc nofollow" target="_blank">他们的邮件列表</a>或<a class="ae lh" href="https://twitter.com/intent/follow?screen_name=VDKProject" rel="noopener ugc nofollow" target="_blank">在Twitter上关注他们</a>。</p><h1 id="00a6" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">相关文章</h1><div class="or os gq gs ot ou"><a rel="noopener follow" target="_blank" href="/an-overview-of-versatile-data-kit-a812cfb26de7"><div class="ov ab fp"><div class="ow ab ox cl cj oy"><h2 class="bd jd gz z fq oz fs ft pa fv fx jc bi translated">多功能数据工具包概述</h2><div class="pb l"><h3 class="bd b gz z fq oz fs ft pa fv fx dk translated">开始使用多功能数据工具包，这是一个使数据工程师工作更高效的框架</h3></div><div class="pc l"><p class="bd b dl z fq oz fs ft pa fv fx dk translated">towardsdatascience.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi lb ou"/></div></div></a></div><div class="or os gq gs ot ou"><a rel="noopener follow" target="_blank" href="/using-versatile-data-kit-to-ingest-and-process-data-from-rest-api-6e3e0660b791"><div class="ov ab fp"><div class="ow ab ox cl cj oy"><h2 class="bd jd gz z fq oz fs ft pa fv fx jc bi translated">使用通用数据工具包从REST API获取和处理数据</h2><div class="pb l"><h3 class="bd b gz z fq oz fs ft pa fv fx dk translated">关于如何使用通用数据工具包(VDK)从REST API获取数据的教程，以及一些关于如何安装…</h3></div><div class="pc l"><p class="bd b dl z fq oz fs ft pa fv fx dk translated">towardsdatascience.com</p></div></div><div class="pd l"><div class="pj l pf pg ph pd pi lb ou"/></div></div></a></div><div class="or os gq gs ot ou"><a rel="noopener follow" target="_blank" href="/from-raw-data-to-a-cleaned-database-a-deep-dive-into-versatile-data-kit-ab5fd992a02e"><div class="ov ab fp"><div class="ow ab ox cl cj oy"><h2 class="bd jd gz z fq oz fs ft pa fv fx jc bi translated">从原始数据到干净的数据库:对多功能数据工具包的深入研究</h2><div class="pb l"><h3 class="bd b gz z fq oz fs ft pa fv fx dk translated">使用通用数据工具包(VMware最近发布的一个框架)和Trino DB的完整示例</h3></div><div class="pc l"><p class="bd b dl z fq oz fs ft pa fv fx dk translated">towardsdatascience.com</p></div></div><div class="pd l"><div class="pk l pf pg ph pd pi lb ou"/></div></div></a></div></div></div>    
</body>
</html>