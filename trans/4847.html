<html>
<head>
<title>Data Processing Automation with inotifywait</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用inotifywait实现数据处理自动化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-processing-automation-with-inotifywait-663aba0c560a#2022-10-27">https://towardsdatascience.com/data-processing-automation-with-inotifywait-663aba0c560a#2022-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a6ab" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在拥有生产就绪的MLOps平台之前实现自动化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fcb703de2552865a4b870def03c08680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EC93G62cp4yjcCbY"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动创作者</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e4cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当在集群或任何其他类型的共享处理系统中工作时，一个很快出现的问题是如何容易地共享数据处理工具。所有用户都有自己的环境、库，并且软件的功能可以秘密地依赖于. bashrc中定义的一些路径。如果编写一些有价值的数据处理工具却不能与真正需要它们的人共享，那就太遗憾了。</p><p id="e3b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，你真的不希望人们每次需要时都要求你为他们处理，是吗？</p><p id="8e46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很明显，答案是使用MLOps平台，以及像特性库这样的工具。然而，当一个还没有到位时，建立一个需要时间，甚至更糟的是，从零开始建立它。在这种情况下，我们在等待的同时有什么可以做的吗？</p><div class="lv lw gp gr lx ly"><a href="https://www.featurestore.org/what-is-a-feature-store" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">ML的特性库——什么是特性库？</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">‍As:作为起点，你需要考虑在机器学习或MLOps中，为了使用模型，使…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.featurestore.org</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="cb7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何事情都比花大量时间运行来自公司的所有请求的流程，而不是进一步开发您的数据处理或新功能/项目要好。</p><p id="86ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">节省时间的解决方案显然是自动化，但您不必运行完整的MLOps管道就可以开始享受自动化的好处。</p><h1 id="a7e0" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">什么是inotifywait？</h1><p id="b925" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">inotifywa是一个用于linux的cli工具，它只做一件事:监听目录中发生的事件，并在一个事件发生时打印一条消息。它基于一个名字相似的工具:<code class="fe nk nl nm nn b">inotify</code>，但是<code class="fe nk nl nm nn b">inotifywait</code>可以递归地监听子文件夹，而前者则不能。</p><p id="9a59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样。倾听事件，并在事件发生时写下一些东西。然而，这足以开启有用的自动化。</p><p id="1894" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，每次它监听一个目录或其中一个子目录上的新事件时，都会打印一条消息，其中包含事件发生的路径、触发事件的文件的文件名以及事件类型。然后，在bash中，您可以读取这样的消息，并根据事件类型决定一个动作。例如，您可以运行一个数据处理脚本，该脚本在目录中新创建的文件上运行。</p><h1 id="787e" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">安装inotifywait</h1><p id="d45e" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">inotifywait通常不是发行版默认设置的一部分，而是inotify-tools 的一部分。它的安装依赖于linux发行版，可以从<a class="ae ky" href="https://docs.rockylinux.org/books/learning_rsync/06_rsync_inotify/" rel="noopener ugc nofollow" target="_blank">源</a>或<a class="ae ky" href="https://ubuntu.pkgs.org/20.04/ubuntu-universe-amd64/inotify-tools_3.14-8_amd64.deb.html" rel="noopener ugc nofollow" target="_blank">包</a> <a class="ae ky" href="https://src.fedoraproject.org/rpms/inotify-tools" rel="noopener ugc nofollow" target="_blank">管理器</a>中完成。只需选择最适合您的使用案例和发行版的选项。</p><p id="2dcc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，它总是需要管理员权限才能安装。</p><h1 id="3dcd" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">一个例子</h1><p id="4048" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">让我们看看如何使用inotifywait递归地监视目录，并发出文件创建的所有事件。换句话说，每当文件夹中的文件创建完成时，它都会打印一些内容。<em class="no"> Complete </em>在这里很重要，因为我们不希望事件在开始写文件时被触发，而是在结束时被触发。</p><pre class="kj kk kl km gt np nn nq nr aw ns bi"><span id="a2e0" class="nt mo it nn b gy nu nv l nw nx">$ inotifywait <!-- -->-m /path/to/target/folder -e close_write -r |<br/>    while read dir action file; do<br/>        python data_processing.py ${dir}/${file}<br/>    done</span></pre><p id="0b09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们一点一点来看。首先，我们启动inotifywait来监控在<code class="fe nk nl nm nn b">-m</code>之后指定的目录，由于<code class="fe nk nl nm nn b">-r</code>的原因，递归地进行监控。<code class="fe nk nl nm nn b">-e close_write</code>表示发出所有且仅发出文件创建类型的事件。</p><p id="c64d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，<code class="fe nk nl nm nn b">inotifywait</code>监听该文件夹，每次在其中或其子文件夹中创建新文件时，它都会写入3条信息:事件发生的目录路径、事件类型和文件名。本例中的事件类型只有<code class="fe nk nl nm nn b">close_write</code>，但是我们可以指定多个参数到-e，用逗号分隔。查看<a class="ae ky" href="https://linux.die.net/man/1/inotifywait" rel="noopener ugc nofollow" target="_blank"> inotifywait手册</a>了解更多关于事件类型的信息。我们可以用文件名来处理文件。</p><p id="f920" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">脚本的第二部分，<code class="fe nk nl nm nn b">while read dir action file</code>读取来自inotifywait的行(因为它在管道之前)，并将每行的三个部分分配给bash变量<code class="fe nk nl nm nn b">$dir, $action, $file</code>。最后，我们可以使用这些变量来启动我们的数据处理工具。</p><p id="e1bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们假设我们有一个新工具，它运行一些文本规范化规则，然后用附加信息(如词性标记)注释文本。这些转换对于团队中的其他人或者其他团队执行的一些下游任务是必需的。</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/implementing-part-of-speech-tagging-for-english-words-using-viterbi-algorithm-from-scratch-9ded56b29133"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">从零开始用Viterbi算法实现英语单词的词性标注</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">词类是句子结构和意义的有用线索。以下是我们识别它们的方法。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="ny l mj mk ml mh mm ks ly"/></div></div></a></div><p id="afac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以要求有新文本数据的人将它们添加到受监控的目录中，这个简单的脚本会在它们被添加到文件夹后立即处理它们。</p><p id="a817" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与目前市场上提供的相比，它看起来像是自动化的原始形式，但是如果团队还没有进行MLOps，那么它可能是一个合理的选择。</p><h1 id="f313" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">结论</h1><p id="4a8b" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">在我们快节奏的工作环境中，做得好的自动化是生产力的关键，你的工作是(一种)软件工程师或数据科学家。当它起作用时，它完成工作，而你可以把你宝贵的精神能量花在新的挑战性任务上。</p><p id="3251" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，正确地完成自动化本身需要大量的工作，如果没有合适的自动化框架就更是如此。</p><p id="9326" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，几十年来在操作系统工具方面的工作给了我们大量的工具来设置简单的自动化，这些工具可以在准备“真正的东西”时使用。是这些工具中的一种，你对它的使用只受你想象力的限制。</p><p id="8767" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="no">感谢您的阅读！</em></p><h1 id="7b6d" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">更多来自我</h1><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/3-common-bug-sources-and-how-to-avoid-them-182f9974d2ab"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">3种常见的错误来源以及如何避免它们</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">有些编码模式更容易隐藏bug。编写高质量的代码并了解我们的大脑是如何工作的有助于…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="nz l mj mk ml mh mm ks ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/parse-dont-validate-f559372cca45"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">解析，不验证| Python模式</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">验证数据就像看门人一样，将数据解析成有意义的数据类型，为原始数据增加了有价值的信息</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="oa l mj mk ml mh mm ks ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/machine-translation-evaluation-with-cometinho-c89880731409"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">使用Cometinho进行机器翻译评估</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">着眼于性能，减少模型大小、节省计算时间和金钱的实用建议</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="ob l mj mk ml mh mm ks ly"/></div></div></a></div></div></div>    
</body>
</html>