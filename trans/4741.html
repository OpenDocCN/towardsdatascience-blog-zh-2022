<html>
<head>
<title>Take on Three Common Excel Tasks in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中承担三个常见的Excel任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/take-on-three-common-excel-tasks-in-python-639d6f4a5b2f#2022-10-21">https://towardsdatascience.com/take-on-three-common-excel-tasks-in-python-639d6f4a5b2f#2022-10-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d100" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让迁移到Python变得稍微容易一点</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dddb3b57d36ce44299a7befe7296e706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MDrue1aBVInc4Tca"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@microsoft365?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">微软365 </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="c1dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从Excel迁移到Python可能会令人望而生畏——但不一定如此！本教程将指导你完成你在Excel中习惯的三个常见任务，并向你展示如何用Python和Pandas来完成它们。</p><p id="8628" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程结束时，您将学会如何:</p><ul class=""><li id="0b88" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">写IF()函数在熊猫、</li><li id="abf3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">复制文本到列的功能，以及</li><li id="8461" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">向数据中添加汇总行</li></ul><p id="bffd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将假设您知道如何使用Pandas读取Excel文件。如果你还没到那一步，不要担心，看看这个教程。为了使事情简单一点，让我们假设我们正在使用下面的数据框架:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">加载样本熊猫数据帧</p></figure><h1 id="2ae5" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">编写IF函数</h1><p id="de56" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们先来看看熊猫里的IF()函数怎么写。有很多方法可以解决这个问题，但是让我们来看看如何使用列表理解来完成这个任务。</p><p id="1200" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看下面的理解，它检查总数是否超过100，并基于此指定一个新列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="9082" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们编写了一个list comprehension，它循环遍历我们的Total列，如果值超过100，则返回Yes，否则返回No。</p><h1 id="0551" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">文字分列</h1><p id="be07" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">在这一节中，让我们探索如何复制文本到列特性。该功能允许您根据分隔符将文本分成多列。谢天谢地，熊猫让这变得很容易！</p><p id="24e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="eb59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们根据分隔符<code class="fe ni nj nk nl b">', '</code>将位置列分成两列。让我们来看看这是如何工作的:</p><ol class=""><li id="7be1" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nm mb mc md bi translated">我们一次分配两列(注意我们是如何使用双方括号的)</li><li id="c5f1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nm mb mc md bi translated">然后，我们应用string split()函数来拆分文本</li><li id="3739" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu nm mb mc md bi translated">我们使用<code class="fe ni nj nk nl b">expand=True</code>参数让Pandas知道我们想要将结果列表分成多列</li></ol><h1 id="0ef7" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">添加汇总行</h1><p id="8ed3" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">在这最后一节中，让我们看看如何向我们的Pandas数据帧添加一个总计行。我们可以通过使用<code class="fe ni nj nk nl b">.loc</code>访问器来分配一个新行。我们可以将单词Total分配给Name列，并将Total列中的值相加:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="212f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，这样做时，我们实际上是在修改原始数据帧。最好将它用于报告层，记住这可能会对下游产生更多影响。</p><h1 id="1b6f" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">结论</h1><p id="2ff6" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">在本教程中，您学习了如何使用Pandas在Python中复制三个常见的Excel函数。您首先学习了如何复制IF函数。然后，您学习了如何使用文本转列功能。最后，您学习了如何向数据中添加汇总行。</p></div></div>    
</body>
</html>