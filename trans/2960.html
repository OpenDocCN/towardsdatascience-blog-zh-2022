<html>
<head>
<title>How to Group-By Pandas DataFrames to Compute the Mean</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对熊猫数据帧进行分组以计算平均值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-groupby-mean-fd34885a3d72#2022-06-28">https://towardsdatascience.com/pandas-groupby-mean-fd34885a3d72#2022-06-28</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="05c8" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">用分组表达式计算熊猫的平均值</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/d967f9ea3c1a43bc907c6acb25ab56bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZyCB_gMP3XTnY443gA5cA.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">Diana Polekhina 在<a class="ae kz" href="https://unsplash.com/s/photos/measure?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="ff1e" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">当使用pandas数据框架时，我们通常需要为特定的组计算某些度量。实现这一点的典型方法是通过传统的分组表达式，然后是我们需要计算的相关计算。</p><p id="b5b8" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在今天的简短教程中，我们将展示如何对pandas数据帧执行分组操作，以计算每组的平均值。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="8b6f" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">首先，让我们在pandas中创建一个示例数据框架，我们将在本文中使用它来演示一些概念，并理解为了获得目标结果我们需要遵循什么步骤。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="9518" class="la lb iu nc b gz ng nh l ni nj">import pandas as pd </span><span id="5290" class="la lb iu nc b gz nk nh l ni nj">df = pd.DataFrame(<br/>    [ <br/>        (1, 'B', 121, 10.1, True),<br/>        (2, 'C', 145, 5.5, False),<br/>        (3, 'A', 345, 4.5, False),<br/>        (4, 'A', 112, 3.0, True),<br/>        (5, 'C', 105, 2.1, False),<br/>        (6, 'A', 435, 7.8, True),<br/>        (7, 'B', 521, 9.1, True),<br/>        (8, 'B', 322, 8.7, True),<br/>        (9, 'C', 213, 5.8, True),<br/>        (10, 'B', 718, 9.1, False),<br/>    ],<br/>    columns=['colA', 'colB', 'colC', 'colD', 'colE']<br/>)</span><span id="47d2" class="la lb iu nc b gz nk nh l ni nj">print(df)<br/><strong class="nc iv">   colA colB  colC  colD   colE<br/></strong><em class="nl">0     1    B   121  10.1   True<br/>1     2    C   145   5.5  False<br/>2     3    A   345   4.5  False<br/>3     4    A   112   3.0   True<br/>4     5    C   105   2.1  False<br/>5     6    A   435   7.8   True<br/>6     7    B   521   9.1   True<br/>7     8    B   322   8.7   True<br/>8     9    C   213   5.8   True<br/>9    10    B   718   9.1  False</em></span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="1ae6" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用mean()方法</h2><p id="c52e" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">我们这里的第一个选项是对感兴趣的列执行<code class="fe nm nn no nc b">groupby</code>操作，然后使用我们想要执行数学计算的列分割结果，最后调用<code class="fe nm nn no nc b">mean()</code>方法。</p><p id="3cc3" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">现在让我们假设对于列<code class="fe nm nn no nc b">colB</code>中出现的每个值，我们想要计算列<code class="fe nm nn no nc b">colC</code>的平均值。下面的表达式将为我们解决这个问题。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="d9b4" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; df.groupby('colB')['colC'].mean()<br/>colB<br/>A    297.333333<br/>B    420.500000<br/>C    154.333333<br/>Name: colC, dtype: float64</span></pre><p id="3fc0" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">结果将是一个熊猫系列，包含列<code class="fe nm nn no nc b">colB</code>中出现的每个值的<code class="fe nm nn no nc b">colC</code>的平均值。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="03a0" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用agg()方法</h2><p id="2b05" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">同样，我们可以使用<code class="fe nm nn no nc b">agg()</code>方法来为指定的操作执行聚合——在我们的例子中是平均值计算。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="7863" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; df.groupby('colB')['colC'].agg('mean')<br/>colB<br/>A    297.333333<br/>B    420.500000<br/>C    154.333333<br/>Name: colC, dtype: float64</span></pre><p id="d3f9" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">结果将与我们之前展示的方法完全相同。</p></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="bb0f" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">计算中位数</h2><p id="6879" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">同样，您可以使用相同的策略来计算其他指标，如计算组的中位数、计数或总和。</p><p id="1918" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">在下面的例子中，我们使用了与本教程第一部分中展示的相同的方法来计算列<code class="fe nm nn no nc b">colB</code>中出现的每个值的<code class="fe nm nn no nc b">colC</code>的中值。</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="dd92" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; df.groupby('colB')['colC'].median()<br/>colB<br/>A    345.0<br/>B    421.5<br/>C    145.0<br/>Name: colC, dtype: float64</span></pre><p id="bb8d" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">同样，您可以使用其他方法，如<code class="fe nm nn no nc b">count()</code>和<code class="fe nm nn no nc b">sum()</code>来计算相应的指标。</p><p id="c426" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">这同样适用于涉及<code class="fe nm nn no nc b">agg()</code>方法的第二种方法:</p><pre class="kk kl km kn gu nb nc nd ne aw nf bi"><span id="4622" class="la lb iu nc b gz ng nh l ni nj">&gt;&gt;&gt; df.groupby('colB')['colC'].agg('median')<br/>colB<br/>A    345.0<br/>B    421.5<br/>C    145.0<br/>Name: colC, dtype: float64</span></pre></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><h2 id="78f3" class="la lb iu bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph lw lx iu ly b lz ma jv mb mc md jy me lj mf mg mh ln mi mj mk lr ml mm mn mo in bi translated">在今天的文章中，我们讨论了pandas中最常执行的操作之一，它要求我们对感兴趣的数据帧执行分组操作。</p><p id="a31e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated">此外，我们展示了如何计算有用的指标，例如感兴趣的组的平均值和中值。当然，这只是您可以计算的度量值的一个示例—实际上，可以使用相同的方法来计算计数、总和等。</p><div class="np nq gq gs nr ns"><a href="https://levelup.gitconnected.com/how-to-group-by-pandas-dataframes-to-compute-sum-82a6bd890cbf" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何对熊猫数据帧分组以计算总和</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">使用Group By表达式聚合pandas数据框架中的列值</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">levelup.gitconnected.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><a class="ae kz" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="ly iv">成为会员</strong> </a> <strong class="ly iv">阅读介质上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="np nq gq gs nr ns"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph lw lx iu ly b lz mp jv mb mc mq jy me lj mr mg mh ln ms mj mk lr mt mm mn mo in bi translated"><strong class="ly iv">相关文章你可能也喜欢</strong></p><div class="np nq gq gs nr ns"><a rel="noopener follow" target="_blank" href="/pandas-in-notin-ff2415f1e3e1"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何使用“在”和“不在”筛选熊猫数据帧</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">理解相当于SQL“in”和“not in”表达式的熊猫</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/us-market-bank-holidays-pandas-fbb15c693fcc"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">Python中的美国市场银行假日</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">使用熊猫用Python计算纽约证券交易所市场银行假日</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oj l od oe of ob og kt ns"/></div></div></a></div></div><div class="ab cl mu mv hy mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="in io ip iq ir"><div class="kk kl km kn gu ns"><a rel="noopener follow" target="_blank" href="/make-class-iterable-python-4d9ec5db9b7a"><div class="nt ab fp"><div class="nu ab nv cl cj nw"><h2 class="bd iv gz z fq nx fs ft ny fv fx it bi translated">如何在Python中创建用户定义的可重复项</h2><div class="nz l"><h3 class="bd b gz z fq nx fs ft ny fv fx dk translated">展示了如何在Python中创建用户定义的迭代器并使用户定义的类可迭代</h3></div><div class="oa l"><p class="bd b dl z fq nx fs ft ny fv fx dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="ok l od oe of ob og kt ns"/></div></div></a></div></div></div>    
</body>
</html>