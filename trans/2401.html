<html>
<head>
<title>High scalable fast search with Haystack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Haystack实现高可扩展性快速搜索</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/high-scalable-fast-search-with-haystack-8b7bb103df8e#2022-05-25">https://towardsdatascience.com/high-scalable-fast-search-with-haystack-8b7bb103df8e#2022-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5816" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Elasticsearch和GPU将您的FAQ搜索放在类固醇上</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a55a4eeedfdf8dd8928016a631f76c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uFn9_YltzzZBXIk7dlaiKg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用Haystack的嵌入式单词搜索来确保安全(照片由<a class="ae ky" href="https://unsplash.com/@rutpratheep?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Rutpratheep Nilpechr </a>拍摄)</p></figure><p id="ae8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" rel="noopener" target="_blank" href="/creating-autocomplete-search-forms-e8bc3f2c1669">之前的帖子</a>中，我们创建了一个简单的“字符串匹配搜索”来查找德语/英语翻译。从比喻的意义上来说，我们也可以把这个翻译表称为一种FAQ。FAQ搜索据说具有以下积极特征:</p><ul class=""><li id="c32d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">在推理时非常快</li><li id="4b93" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">很好地控制答案</li></ul><p id="6e23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然也有令人沮丧的地方:</p><ul class=""><li id="5a2b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">概括:只有与FAQ中现有问题相似的问题才能得到回答</li></ul><p id="b311" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于纯粹的好奇，我们现在想为我们的翻译器尝试一种比简单的字符串搜索更高级的技术。为此，我们将使用Haystack的认知搜索。</p><p id="cf98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">解决方案:</strong></p><p id="5faf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Haystack是使用单词嵌入功能的首选:</p><div class="mj mk gp gr ml mm"><a href="https://haystack.deepset.ai/overview/intro" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">干草堆文档</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">如果您已经想开始安装Haystack并构建您的第一个系统，请查看入门…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">haystack.deepset.ai</p></div></div></div></a></div><p id="38dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用Google Colab的GPU来弹性地改进Haystack search (ElasticSearch，如果我应该直呼其名的话)</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">你也可以在<a class="ae ky" href="https://colab.research.google.com/drive/1VYzia-KKeMe0ozg5BEfi865gzaZIrAK8#scrollTo=RM4YjMvOkJX0" rel="noopener ugc nofollow" target="_blank"> Colab </a>上找到完整的代码(图片由作者提供)</p></figure><p id="57d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看这项先进技术的成果。虽然我们将主要关注这篇文章中的结果，但请随意查看我的Github资源库中的完整代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/bb00f3a91cbc2937859e16a4f4cbb769.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*xVrYK9ndTGrx-AekogQAuA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Haystack向我们展示了这个问题的前三个答案(图片由作者提供)</p></figure><blockquote class="my mz na"><p id="e2be" class="kz la nb lb b lc ld ju le lf lg jx lh nc lj lk ll nd ln lo lp ne lr ls lt lu im bi translated">如果您想了解更多关于单词相似性的知识，您可能会发现这篇文章很有帮助:</p></blockquote><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/chatbot-a-complete-pycharm-app-part-2-of-3-distance-metric-46462a9ad4e4"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">聊天机器人:一个完整的PyCharm应用程序(第2部分，共3部分:距离度量)</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">Chatterbot、Django、Python和PyCharm都统一在这个随时可用的聊天机器人应用程序中</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="nf l"><div class="ng l nh ni nj nf nk ks mm"/></div></div></a></div><p id="5928" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还记得我们在<a class="ae ky" href="https://medium.com/p/e8bc3f2c1669/edit" rel="noopener">简单字符串搜索</a>中搜索“absorption”时，我们得到的是“Vollkostenrechnung”这个单词的正确德语翻译吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/5ee5e1382b1fd5945f5f9757ed2ac67a.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*f8DwL9uxRfN4XupBvtVIVw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="2e40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Haystack，我们得到了相同的结果(得分最高的前1个答案)。Haystack的嵌入式单词搜索的一个明显的优点是，我们现在可以用自然语言查询我们的翻译。我们可以问一个完整的句子，仍然可以得到答案。通过我们的简单搜索，如果我们问“吸收在德语中是什么意思？”我们不会得到答案:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/1a52a628aeebc8681cef329c48b4bdbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*K4pGlQNPRLQW4rn-ebANEA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="17fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管训练数据仍然只基于英语/德语词汇，但Haystack从中获得了更多。就是草堆后面嵌入魔法这个词。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/ad7756bc2998c7ee06894b2583a3018d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hlSZLtBs8WKXdIZx-UeCIw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">嵌入相似性基于问题(图片由作者提供)</p></figure><p id="d056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这也是为什么Haystack将“边际贡献会计”列为第二，将“标准成本会计”列为第三。它们与“吸收”并不相同，但它们确实包含“成本核算”一词，因此被判定为相似。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/93a0d580db34c69a4a154ac28429360b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*htYJKRWsMjQaV-SxAzCRXw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为了更好地理解单词嵌入，请看<a class="ae ky" href="http://projector.tensorflow.org/" rel="noopener ugc nofollow" target="_blank">http://projector.tensorflow.org/</a>(图片由作者提供)</p></figure><p id="8061" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们尝试另一个例子，现在更精确地检查结果(详细说明“全部”而不是“最小”):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="4667" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“所有细节”将告诉我们更多的嵌入背景，并给出以下输出:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="fbef" class="nu nv it nq b gy nw nx l ny nz">Inferencing Samples: 100%|██████████| 1/1 [00:00&lt;00:00, 62.73 Batches/s]</span><span id="7948" class="nu nv it nq b gy oa nx l ny nz">Query: What are accruals?<br/>Answers:<br/>[   &lt;Answer {'answer': 'Rückstellungen', 'type': 'other', 'score': 0.6129861828861322, 'context': 'Rückstellungen', 'offsets_in_document': None, 'offsets_in_context': [{'start': 0, 'end': 14}], 'document_id': 'd8dd4582c851b70968837d0ddc24b010', 'meta': {'answer': 'Rückstellungen', 'query': 'accruals'}}&gt;,<br/>    &lt;Answer {'answer': 'Rabatt', 'type': 'other', 'score': 0.5722656545690049, 'context': 'Rabatt', 'offsets_in_document': None, 'offsets_in_context': [{'start': 0, 'end': 6}], 'document_id': '9bf6c46ce95bdab52a72ab1bf7333f8c', 'meta': {'answer': 'Rabatt', 'query': 'allowance'}}&gt;,<br/>    &lt;Answer {'answer': 'Abgrenzungen', 'type': 'other', 'score': 0.5675899718102981, 'context': 'Abgrenzungen', 'offsets_in_document': None, 'offsets_in_context': [{'start': 0, 'end': 12}], 'document_id': '6251dfe668dd12ac323b626bf66d010d', 'meta': {'answer': 'Abgrenzungen', 'query': 'accruals and deferrals'}}&gt;]</span></pre><p id="60b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个答案是我们所期望的:“应计”的意思是“Rueckstellungen”。第三个答案也是合适的，因为“应计和递延”代表“Abgrenzungen”。但是，Haystack从哪里得到答案2(“津贴”，在德语中是“拉巴特”的意思)？在我们的字符串搜索中，当我们搜索“应计”时，我们只找到两个匹配项:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/1eebbc4de9406be188c82f9ae8da2e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*atKdG0z-bUT2NFwQEIZ6yw.png"/></div></figure><p id="bcb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“应计项目”中绝对没有接近“拉巴特”的字符串:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/58796fd35767e5646a7bf49be18cfc4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*zCIIvuy7tAMJPYBDoRXdtA.png"/></div></figure><p id="4641" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但人们可以认为，“备抵义务”也可以被视为“应计项目”。也许这就是为什么Haystack将“备抵”排在第二位，甚至排在“应计和递延”(前3位)之前。</p><p id="4bd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们已经提到的，我们的翻译器是提供一个精确的翻译搜索单词。换句话说，它是一个100%的问答映射。因此，这个上下文中的字符串搜索——原则上可能很简单——对于明确的“词汇词典”来说是一个很好的解决方案。这是否意味着Haystack对所有FAQ任务都没用？不，一点也不！我们只需要转向真正的FAQ任务(而不是词汇词典)。还记得艾萨克(<strong class="lb iu"> I </strong>智能<strong class="lb iu"> S </strong>解决方案为<strong class="lb iu"> A </strong>管理和<strong class="lb iu"> A </strong>分析<strong class="lb iu"> C </strong>沟通)，我们的聊天机器人回答常见问题吗？多亏了Haystack(链接如下)，我们将显著改进Isaac的FAQ功能。</p><p id="3714" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">总结:</strong></p><p id="08e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你，你现在已经了解了简单字符串搜索与使用Elasticsearch和Haystack的认知搜索相比的优缺点。在下一篇文章中，我们将利用这些知识来改进我们聊天机器人的FAQ功能。</p><p id="9025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此之前，非常感谢您的阅读！希望这篇文章对你有帮助。请随时在<a class="ae ky" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ky" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室</a>与我联系。</p><div class="mj mk gp gr ml mm"><a href="https://jesko-rehberg.medium.com/membership" rel="noopener follow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">通过我的推荐链接加入Medium-Jesko Rehberg</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">阅读杰斯科·雷伯格(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">jesko-rehberg.medium.com</p></div></div><div class="nf l"><div class="od l nh ni nj nf nk ks mm"/></div></div></a></div><p id="9cbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在我的<a class="ae ky" href="https://github.com/DAR-DatenanalyseRehberg/HaystackFAQSearch" rel="noopener ugc nofollow" target="_blank"> Github </a>资源库中找到完整的代码和文件。请随时在<a class="ae ky" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ky" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室</a>与我联系。</p></div></div>    
</body>
</html>