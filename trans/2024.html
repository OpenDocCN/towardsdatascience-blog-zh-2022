<html>
<head>
<title>NeuralProphet: Forecasting Energy Demand</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经营养:预测能源需求</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/neuralprophet-energy-demand-forecasting-4c6ca21df532#2022-05-08">https://towardsdatascience.com/neuralprophet-energy-demand-forecasting-4c6ca21df532#2022-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="720f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">经典预测技术和深度学习模型之间的差距</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/71456a6c58d0c80ceca1a5b605996eab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ykKb1xNcvIPZa52h612hfg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">网络图片— By <a class="ae kv" href="https://unsplash.com/@jjying" rel="noopener ugc nofollow" target="_blank"> JJying </a></p></figure><h1 id="2614" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="44b7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本文中，使用NeuralProphet(由Meta AI)来预测能源需求。随着电力需求的增加，预测能源需求极其重要。提前知道需要多少电力对碳排放、能源成本和政策决策有重大影响。</p><p id="4de7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2021年11月30日，Meta AI(原脸书)发布了NeuralProphet。NeuralProphet的建立是为了弥合经典预测技术和深度学习模型之间的差距。在本文中，我将展示NeuralProphet框架，并评估它相对于其他预测技术的性能。</p><h1 id="5b6b" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">加载数据</h1><p id="043b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们将使用的数据集包含澳大利亚维多利亚州的电力需求数据。维多利亚是670万人的家园。该数据集具有从2015年1月1日到2020年10月6日的每日数据点。这给了我们足够的样本来获取数据集中的任何季节性和趋势。这个数据集可以在<a class="ae kv" href="https://www.kaggle.com/datasets/aramacus/electricity-demand-in-victoria-australia" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="5614" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在下面的单元格中，我们将这个数据集加载到pandas中进行预处理。与Prophet类似，NeuralProphet需要一个用于日期/时间戳的“ds”列和一个用于数据值的“y”列。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="6224" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">然后我们可以使用Matplotlib来可视化数据。在第一张图中，我们可以看到所有的数据点。数据中似乎有一些年度季节性。能源需求通常每年都会增加，直到6月份，然后在一年的剩余时间里减少。</p><p id="e576" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">第二张图简单显示了前100天的数据。我们可以看到，每天的能源需求并不一致。如果数据中有任何周季节性，从这个图中很难识别。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/3d70c0de71b28caf97d794bdb917737d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*qzSsalgVlk2ifG6H2F1Zfw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">能源数据图—按作者</p></figure><p id="1f00" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在下一个单元中，我们只是为模型创建一个验证和测试集。我们可以使用NeuralProphet的内置。split_df()函数，但是我发现这在验证和测试集中重复了行。为此，我们将使用简单的索引。</p><p id="f6db" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">请注意，验证和测试集应该总是包含最新的数据点。这确保了我们不会根据未来的数据进行训练，也不会根据过去的数据进行预测。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/b737c9517b9fc980eaed67181a6bda0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*hwxIqfE9kFyY9_ypM83f5A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">拆分数据图-按作者</p></figure><h1 id="8b14" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">定义模型</h1><p id="b3c0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">NeuralProphet使用与Prophet非常相似的API。如果你之前用过Prophet，那么用NeuralProphet会很直观。</p><p id="0d6c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在下面的单元格中，我们简单地定义了一个模型，并使这个模型适合数据。我们使用“D”将预测频率设置为每天一次，并使用plot-all在训练期间实时可视化模型性能。我们做的另一个改动是指定澳大利亚的假日。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/e67fa3aeec690423c2ae867eebc11587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9J3kBbW3cBRDlhxz1unZtA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型损失图—作者</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/05512d1551553580a41c9e78ec112d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CxQhkRL0OpP63s-95XB_eg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型指标—按作者</p></figure><p id="3b38" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">从上面的图表中我们可以看到，模型正被数据过度拟合。该模型尽可能低地适合训练数据，但是我们希望该模型很好地适合看不见的数据(即验证集)。</p><p id="67f1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">查看上面的度量图，我们可以看到最佳参数大约在25-30个时期达到，然后模型开始过度拟合。我们可以通过指定一些纪元来解决这个问题。完整的可调模型参数列表可在<a class="ae kv" href="https://neuralprophet.com/html/forecaster.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/2089032661f51d43cf671e2f6b841899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W0BqnRhqVBeEFKvtKeqVNA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型指标—按作者</p></figure><p id="4d39" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">通过指定历元的数量，我们显著降低了验证RMSE。即使改变一个参数也能显著改善我们的模型(如上图)。这表明，使用参数调整和翻译领域知识的模型可以提高其性能。</p><h1 id="de0e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">模型评估</h1><p id="0cee" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在我们尝试从我们的模型中榨出每一盎司的性能之前，让我们看看如何评估我们的模型。</p><p id="6b01" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在下一个单元格中，我们只是做了一个与验证集长度相同的预测。然后我们可以用。plot()函数。这给出了一个不错的可视化预测，但没有提供性能指标，我们也不能非常清楚地看到预测。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/dd6e8e59f21257515a269a25e6a355eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwgfHVHROfLhiLQYYpWAzg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">预测图—按作者</p></figure><p id="3cb8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了解决内置绘图的局限性，我使用Matplotlib构建了一个定制的绘图。下面的单元格用真实标签绘制预测，并在绘图标题中显示模型指标。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/0269440b98db328e9f83ecde4cf89b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*_BD31TUARMi1ChmD2_o1Ww.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自定义预测图-按作者</p></figure><p id="9d08" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，我们可以看看模型参数。这可以让我们了解数据的季节性模式和趋势。</p><p id="8ac3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在第一个和第二个图中，我们可以看到2018年的能源需求出现了峰值。然后，需求在2019年和2020年下降并稳步上升。这让我们了解到能源需求是如何随时间变化的。</p><p id="e48f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在第三张图中，我们看到了每年的季节性。我们可以看到，4月和10月能源需求最低，7月能源需求最高。这是有道理的，因为七月是澳大利亚一年中最冷的月份。有趣的是，最热的月份是二月，此时我们会看到能源需求的小高峰。这可能表明，在最热的月份，人们用电来调节空调。</p><p id="d5f5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">第四幅图显示了每周的季节性。这表明周六和周日的能耗最低。</p><p id="28b7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">最后，我们有相加事件的图。这张图显示了我们添加的澳大利亚假期的效果。我们可以看到，在节假日，能源需求通常低于平时。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/82401bee5bb2ca57d67eae08e3ce2bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bm47czGRqia9tBexROaoA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型参数图-按作者</p></figure><h1 id="c5db" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">添加AR-Net(自回归)</h1><p id="c820" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Prophet中的一个新功能是AR-Net(自动回归神经网络)。这允许NeuralProphet在进行预测时使用先前时间步骤的观察结果。在我们的例子中，这意味着模型可以使用前一天的能源需求来进行预测。</p><p id="bcdd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在创建NeuralProphet模型时，可以通过为n_lags参数设置适当的值来启用AR-Net。我们还增加了checkpoints_range，因为我们正在对数据进行短期预测。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/2788862bc81c44285b052286ff5e600f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZzYpHn5kSa0QjBX8OH2cQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">AR-Net模型指标—按作者</p></figure><p id="8aae" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以从上面的指标中看到，验证RMSE再次下降。这是我们通过简单地调整两个参数而获得的另一个显著的模型性能增益。</p><p id="5576" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果我们使用与之前相同的代码，则只能进行一次预测。从文档中不清楚当AR-Net启用时如何进行“运行”预测，因此我们可以使用下面的代码来实现这一点。如果有人知道一个内置的方法来做到这一点，请让我知道！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="4db1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">然后，我们可以使用下面的代码块来绘制我们的预测。我们可以从图中看到，模型开始在外围点上加快速度。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/c56a510ff80744db2521d0981ab78af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*fh2OKJyTp-5EMVMkFFQEVA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">预测图-按作者</p></figure><p id="aa00" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果我们接着绘制模型组件，我们可以看到显示了一个额外的图。该图显示了每个滞后项对预测的影响程度。在我们的例子中，我们可以看到最近几天对模型来说是最重要的。在大多数时间序列问题中，情况往往如此。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/b58eeafcb088c810f7bbd41decf085f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ot3s8_bAGjm3gQ8xCM7RGw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型参数图-按作者</p></figure><h1 id="e5dd" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">超参数调谐</h1><p id="d713" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">到目前为止，我们已经能够手动改进我们的验证RMSE。这很好，但是我们只调整了几个参数。其他参数呢？请考虑下面列出的可调参数及其默认值。</p><blockquote class="nb nc nd"><p id="3b2b" class="lo lp ne lq b lr mk jr lt lu ml ju lw nf mm lz ma ng mn md me nh mo mh mi mj ij bi translated">NeuralProphet(growth='linear '，changepoints=None，n_changepoints=10，changepoints_range=0.9，trend_reg=0，trend_reg_threshold=False，yearly _ seasonality = ' auto '，weekly _ seasonality = ' auto '，seasonality _ mode = ' additive '，seasonality _ reg = 0，n_forecasts=1，n_lags=0，num_hidden_layers=0，d_hidden=None，ar_reg=None，learning_rate=None，epochs</p></blockquote><p id="daa4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">手动输入这些参数的所有可能组合将花费大量的时间和精力。我们可以通过实现超参数调整来解决这个问题。在这个实现中，我们只是测试参数网格中所有可能的参数组合。这意味着随着更多参数的增加，可能的组合数量呈指数增长。</p><p id="4e99" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">使用贝叶斯优化来更有效地搜索参数空间可能会改善这一点，但是添加这一功能超出了本文的范围。在下面的单元格中，我们正在创建一个参数网格，然后使用所有可能的参数组合来训练模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="75af" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，我们将创建一个Pandas数据框架来存储每个模型训练周期的最低RMSE值。然后，我们可以根据验证RMSE值进行排序，以了解哪些参数组合效果较好。还存储了训练RMSE分数和验证分数最低的时期。</p><p id="f5f8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这样做是为了确保模型不会过度适应验证集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9f51a992cc25bb2c041ca98e25904ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*Y6kGiKJuUGLCZzX92ZKxpQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最佳模型参数—按作者</p></figure><p id="48da" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">查看上面的结果，我们可以看到第一行和第二行似乎超出了验证集。另一方面，第三行显示了在训练集和验证集上相似的RMSE分数。</p><p id="6c72" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在下面的单元格中，我们将重新输入运行良好的高评分模型参数。我们可以启用progress plot来查看关于模型训练的更多信息，并且如果需要，我们可以手动进行任何进一步的更改。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/9ee144b04ab8bc9adba080b5c3d784a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fj8CnVuOawq-S0aq0BJsHA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">训练图—按作者</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/86348cfa9b594d808ed30f3659965527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*grB735nLH0WPUOaThARHEQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型分数—按作者</p></figure><p id="9eb9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们进一步降低了RMSE！随着我们改进模型性能，做出改进变得越来越困难。也就是说，我们追求进步而不是完美，并将尽可能地改进。</p><p id="893a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">然后，可以用我们在本文前面所做的相同方式绘制预测图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/a0aba09f13561811fb0b065beba581fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*aH_Kbbop08LwOp7nkcURVg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最佳模型预测—按作者</p></figure><h1 id="ae80" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">模型性能比较</h1><p id="8abb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在下一个单元格中，我将比较NeuralProphet模型和其他常见的预测策略。</p><ul class=""><li id="4217" class="nl nm iq lq b lr mk lu ml lx nn mb no mf np mj nq nr ns nt bi translated">预测最后值</li><li id="f601" class="nl nm iq lq b lr nu lu nv lx nw mb nx mf ny mj nq nr ns nt bi translated">指数平滑法</li><li id="e0bf" class="nl nm iq lq b lr nu lu nv lx nw mb nx mf ny mj nq nr ns nt bi translated">萨里玛</li><li id="da31" class="nl nm iq lq b lr nu lu nv lx nw mb nx mf ny mj nq nr ns nt bi translated">神经先知</li></ul><p id="602c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以使用sklearn手动计算每个模型的RMSE值。我们可以简单地通过参数<code class="fe nz oa ob oc b">squared=False</code>从均方误差函数中得到RMSE。</p><p id="084f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">首先，如果我们只预测前一天的能源需求，我们可以计算RMSE。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="6c31" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，我们可以使用指数平滑来计算预测模型。此模型类型使用过去观测值的加权平均值，随着观测值变老，权重呈指数衰减。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="85d6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，我们可以用一个SARIMA模型来拟合数据。这个模型的首字母缩略词代表“季节性自回归综合移动平均线”，并按照其名称计算其预测。关于这种型号的信息，请点击这里查看这篇伟大的文章<a class="ae kv" href="https://medium.com/@BrendanArtley/time-series-forecasting-with-arima-sarima-and-sarimax-ee61099e78f6" rel="noopener">。</a></p><p id="5ace" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这个模型稍微复杂一点，我们将把训练分成代码块。首先，使用autoarima找到最佳模型参数。这实际上是一个用于ARIMA模型的超参数调整包。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="bcd0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">最后，我们可以用NeuralProphet模型进行预测。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="c7d6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在所有的预测都完成了，我们可以比较测试数据集上的RMSE分数。</p><p id="647b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">最后一个值和指数平滑法产生的误差最高，SARIMA的误差次之，NeuralProphet的误差最好。我很惊讶萨里玛的预测与神经原这么接近。更进一步，看看这些模型在其他时间序列任务上的表现会很有趣。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/a143828cdb833a5be4f634b820c812be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*cw1I7ojeVaQtHQsiA545kg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模型比较图—作者</p></figure><h1 id="ce1e" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结束语</h1><ul class=""><li id="728c" class="nl nm iq lq b lr ls lu lv lx oe mb of mf og mj nq nr ns nt bi translated">这篇文章的代码可以在这里找到。</li><li id="579b" class="nl nm iq lq b lr nu lu nv lx nw mb nx mf ny mj nq nr ns nt bi translated">NeuralProphet是一个非常直观的框架，仍处于早期开发阶段。如果你想为这个项目做贡献，你可以在<a class="ae kv" href="https://github.com/ourownstory/neural_prophet" rel="noopener ugc nofollow" target="_blank"> Github </a>上这样做。你也可以加入<a class="ae kv" href="https://join.slack.com/t/neuralprophet/shared_invite/zt-sgme2rw3-3dCH3YJ_wgg01IXHoYaeCg" rel="noopener ugc nofollow" target="_blank"> Slack </a>上的NeuralProphet社区！</li><li id="6551" class="nl nm iq lq b lr nu lu nv lx nw mb nx mf ny mj nq nr ns nt bi translated">我在本文中没有包括外生变量，但我认为这些变量会提高模型的性能。来自NeuralProphet模型的预测可以用作LGBM/XGBoost模型的输入特征。这可能会产生一个非常预测。</li></ul><h2 id="3a0c" class="oh kx iq bd ky oi oj dn lc ok ol dp lg lx om on li mb oo op lk mf oq or lm os bi translated">参考</h2><ol class=""><li id="0b56" class="nl nm iq lq b lr ls lu lv lx oe mb of mf og mj ot nr ns nt bi translated"><a class="ae kv" href="https://www.sciencedirect.com/book/9780128146453/energy-for-sustainable-development" rel="noopener ugc nofollow" target="_blank">能源促进可持续发展——MD . Hasanuzzaman，Nasrudin Abd Rahim——2017年3月4日</a></li><li id="9e63" class="nl nm iq lq b lr nu lu nv lx nw mb nx mf ny mj ot nr ns nt bi translated"><a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0169716119300367?via%3Dihub" rel="noopener ugc nofollow" target="_blank">统计手册—让-玛丽·杜福尔，朱利安·内维斯—2019年5月1日</a></li></ol></div></div>    
</body>
</html>