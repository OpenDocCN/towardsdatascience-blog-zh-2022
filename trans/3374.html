<html>
<head>
<title>4 Quick Tricks For Better Plots in Matplotlib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Matplotlib中更好的绘图的4个快速技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-quick-tricks-for-better-plots-in-matplotlib-1efd82acd780#2022-07-26">https://towardsdatascience.com/4-quick-tricks-for-better-plots-in-matplotlib-1efd82acd780#2022-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="03e6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">轻松添加箭头、多轴、渐变填充等</h2></div><p id="607c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们开始用matplotlib之类的工具学习数据可视化方法时，为了便于编码，我们通常从最简单的图开始。然而，当我们开始与他人分享我们的可视化时，定制我们的情节以精心制作我们的信息并使一切更具视觉吸引力是很重要的。</p><p id="5a3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以插入几行代码，使我们的情节更具功能性，并帮助数据向我们的观众讲述一个故事，而不是创建复杂的代码并花费数小时来使情节看起来“恰到好处”。</p><p id="3776" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有4个快速提示，可以为基本matplotlib折线图和条形图增加重点、功能和视觉吸引力:</p><h1 id="5573" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">1.用颜色强调条形图</h1><p id="ec84" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">我们的目标是制作能够讲述一个故事的独立情节，无论你是否在那里展示幻灯片。在分享图表之前，你应该思考<em class="mb">“我想让我的观众从中得出什么结论？”</em>和<em class="mb">“我真的希望他们注意到数据的哪一部分？”</em>为了帮助实现这一点，我们可以使用<strong class="kk iu">列表</strong>来定制条形图中的大量可调参数。什么是<code class="fe mc md me mf b">color='blue'</code>可以变成<code class="fe mc md me mf b">color=['blue', 'red', ...]</code>,每个条目指示如何处理我们图中的每个条。</p><p id="25a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，一个简单的条形图看起来像这样:</p><figure class="mg mh mi mj gt mk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/ce727b78069205d240abeb12148c031b.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*WdMHUNI12M7p73rqgGKRvA.png"/></div></div></figure><p id="d7ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，如果我们想引起对第三个条的注意(例如)，我们可以通过将<code class="fe mc md me mf b">color</code>、<code class="fe mc md me mf b">edgecolor</code>和<code class="fe mc md me mf b">linewidth</code>输入更改为列表来实现:</p><figure class="mg mh mi mj gt mk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/08922d72e001f29e7c6255ef01e7d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*rcQVcK6xY2lfwLQifkYqxQ.png"/></div></figure><h1 id="831f" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">2.用箭头强调线图</h1><p id="b0ec" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">线形图很难突出重点。对于线图，最简单的通常是最好的——添加一个指向特定数据点的箭头是吸引观众眼球的好方法。虽然matplotlib有一个特定的<a class="ae mv" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.arrow.html" rel="noopener ugc nofollow" target="_blank">箭头函数</a>，但是要让箭头“恰到好处”地显示出来却非常不灵活，而且非常具有挑战性。更简单快捷的方法是使用<a class="ae mv" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.annotate.html?highlight=annotate#matplotlib.axes.Axes.annotate" rel="noopener ugc nofollow" target="_blank">注释功能</a>。在这里，我们得到了许多非常直观的功能。我们的两个主要变量<code class="fe mc md me mf b">xytext</code>和<code class="fe mc md me mf b">xy</code>分别告诉箭头<strong class="kk iu">从哪里开始</strong>和<strong class="kk iu">从哪里结束</strong>。<code class="fe mc md me mf b">xytext</code>也是放置文本的箭头末端，我们应该选择给箭头加标签(但我们不是必须这样！).</p><p id="c2ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用<code class="fe mc md me mf b">arrowprops=dict()</code>来调整箭头属性，其中我们可以使用标准键，如<code class="fe mc md me mf b">color</code>、<code class="fe mc md me mf b">linewidth</code>等等。那会让你得到简单的直线，但是事情会变得更有趣。我们可以用<code class="fe mc md me mf b">arrowstyle</code>(此处完整列出<a class="ae mv" href="https://matplotlib.org/stable/gallery/text_labels_and_annotations/fancyarrow_demo.html" rel="noopener ugc nofollow" target="_blank">)调整箭头的形状，也可以偏离直线箭头路径。<code class="fe mc md me mf b">connectionstyle</code>有三种主要口味</a></p><ul class=""><li id="c7d4" class="mw mx it kk b kl km ko kp kr my kv mz kz na ld nb nc nd ne bi translated"><code class="fe mc md me mf b">arc3</code>-以弧度设置曲率的弯曲路径(<code class="fe mc md me mf b">rad</code>)。玩正负<code class="fe mc md me mf b">rad</code>值，把你的曲线从凹变成凸。在直线连接的折线图中，给箭头路径增加一点曲率肯定有助于引起注意。</li><li id="ee0c" class="mw mx it kk b kl nf ko ng kr nh kv ni kz nj ld nb nc nd ne bi translated"><code class="fe mc md me mf b">angle</code> —以指定角度绘制的线段(<code class="fe mc md me mf b">angleA</code>、<code class="fe mc md me mf b">angleB</code>)。这个方法足够聪明，可以让你选择的任何角度在你的文本和<code class="fe mc md me mf b">xy</code>坐标之间建立联系。</li><li id="df64" class="mw mx it kk b kl nf ko ng kr nh kv ni kz nj ld nb nc nd ne bi translated"><code class="fe mc md me mf b">bar</code>-尽管整个箭头可以基于一个共同的角度，但线段之间保持90度弯曲。通过在这里玩<code class="fe mc md me mf b">fraction</code>，我们改变了<strong class="kk iu">转弯</strong>相对于端点的位置。在下面的代码中尝试负值，看看会发生什么！</li></ul><p id="ecdf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">考虑到你可以创建大量不同种类的箭头，最好试验一下这些参数来得到你想要的。这里有一个例子，6个不同的箭头应用于我们的绘图，以帮助可视化什么是可能的。</p><figure class="mg mh mi mj gt mk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/5c7ba2a00ea9441bf473510fe1fa6cf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*pqEXgyk31QMqWlG9vVe1Kg.png"/></div></figure><h1 id="3ae0" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">3.添加辅助Y轴</h1><p id="f585" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">将多列数据叠加在一个图上可以得出它们之间关系的结论。但是，两列在相同的数值范围内操作的情况很少见，这会导致其中一行在轴附近徘徊时出现缩放问题。为了构建一个辅助y轴，我们使用<code class="fe mc md me mf b">twinx()</code>函数创建一个共享相同x轴的辅助y轴。该次轴将自动定位在最右侧，并根据输入到该<code class="fe mc md me mf b">ax</code>项目的数据自动缩放。重要的是使用<code class="fe mc md me mf b">color</code>来帮助我们的观众理解哪个情节与每个轴相关联。为了更好地理解这一点，可以使用我们刚刚学过的技巧来添加箭头。</p><figure class="mg mh mi mj gt mk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/9e296b8c14b12ac267c6751d0c09cfbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*8CwPEKMuaGVhnAAapROFdw.png"/></div></figure><p id="b95a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">旁注:添加一个辅助y轴也可以很容易地在本地熊猫中完成，使用<code class="fe mc md me mf b">secondary_y = True</code>属性，产生几乎相同的结果。如果你好奇的话，这里的代码是<a class="ae mv" href="https://gist.github.com/bamattis/7ff2faa50ff5d884edad37350e8667ce" rel="noopener ugc nofollow" target="_blank">这里是</a>，结果图是<a class="ae mv" href="https://github.com/bamattis/Blog/blob/main/MatplotLib_Tips/pandas_lines.png" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><h1 id="5063" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">4.添加填充颜色</h1><p id="276c" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">我们还可以通过填充线条下方的区域来增加线条图的重点和总体视觉吸引力。这是一个使用<code class="fe mc md me mf b">fill_between()</code>函数的快速加法，在这里我们指出我们希望它填充的x范围，以及我们希望填充的两条“线”。在这种情况下，我们想要填充数据和图形底部之间的空间(在这种情况下y=0)。用<code class="fe mc md me mf b">plt.axis()</code>设置绘图区域以匹配您的数据也是一个好主意，否则颜色不会继续填充您的数据范围之外，在您的绘图中留下难看的白色区域。</p><figure class="mg mh mi mj gt mk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nk"><img src="../Images/1e16aceb9911866c41e6b4ab45f449d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NsShnZi_9ivhkQEBujotDw.png"/></div></div><p class="nl nm gj gh gi nn no bd b be z dk translated">定义和不定义绘图区以匹配数据的线形图填充-按作者排列的图像</p></figure><p id="391e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以把极限推得更远一点——把我们的填充变成颜色渐变。在这种情况下，我们必须发挥创造力。对于添加渐变来说是很棒的，但是传统上它是在我们的整个绘图区域添加渐变。为了克服这一点，我们用<code class="fe mc md me mf b">imshow()</code>添加一个渐变，然后用<code class="fe mc md me mf b">fill_between()</code>将上面的<strong class="kk iu">都涂成白色。<code class="fe mc md me mf b">imshow()</code>起步有点棘手，我在之前的一篇文章中对此进行了更深入的探讨，链接<a class="ae mv" rel="noopener" target="_blank" href="/custom-matplotlib-colormaps-for-danger-zone-plots-62310983eb67">此处</a>。然而，简单的版本让我们设置我们在X中使用的颜色图的范围——这里我们选择使用带有<code class="fe mc md me mf b">[[0.8, 0.8],[0,0]]</code>的<code class="fe mc md me mf b">cm.Blues</code>颜色图底部80%的垂直颜色渐变。(类似的水平梯度可以这样实现:<code class="fe mc md me mf b">X=[[0,0.8][0,0.8]]</code>)。</strong></p><p id="3106" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还设置了<code class="fe mc md me mf b">imshow()</code>填充的<code class="fe mc md me mf b">extent</code>，有效地设置了渐变图像填充的边界框。我们可以手动设置这些值，或者对我们的数据序列使用<code class="fe mc md me mf b">min()</code>和<code class="fe mc md me mf b">max()</code>函数。这些可以简单地增加以进一步向下扩展绘图区域。最后，我们在<code class="fe mc md me mf b">fill_between()</code>函数中设置绘图区域的上限，因为我们现在从我们的数据到绘图的顶部(这里定义为<code class="fe mc md me mf b">df.b.max()+0.5</code>)。</p><figure class="mg mh mi mj gt mk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/035e1e805982aca457eb4e77a3b49779.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*KmB-dZ7hcRS9k7vLF9Bw7Q.png"/></div></figure><h1 id="4daf" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">额外学分</h1><p id="aec1" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">根据我们所学的内容，我们现在可以将我们的方法结合起来，使用一个次轴连接两个线图，同时还可以添加填充并用箭头标注重要的点。</p><figure class="mg mh mi mj gt mk"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/3016602f26780780581c6ea4a85559a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*RFzK2_u8QjPnakNWdK9taA.png"/></div></figure><h1 id="6b17" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">结论</h1><p id="42c6" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">通过对代码进行一些快速调整，我们可以为matplotlib图增加重点和视觉吸引力。强调的情节让我们的数据自己说话，能瞬间带动别人关注我们 认为值得关注的<strong class="kk iu"> <em class="mb">数据点。幸运的是，我们只用几行代码就可以达到这个目标！</em></strong></p><p id="dd94" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">像往常一样，整个代码走查笔记本可以从我的github 中找到<a class="ae mv" href="https://github.com/bamattis/Blog/tree/main/MatplotLib_Tips" rel="noopener ugc nofollow" target="_blank">。如果你觉得这个有用，请跟我来！ 欢呼声此起彼伏，快乐的编码声此起彼伏。</a></p><p id="b226" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mb">作者生成的所有图像</em></p></div></div>    
</body>
</html>