<html>
<head>
<title>How to Remove Sensitive Data You Accidentally Uploaded To Github</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何删除你不小心上传到Github的敏感数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/remove-file-from-git-history-ce404d7463d3#2022-05-17">https://towardsdatascience.com/remove-file-from-git-history-ce404d7463d3#2022-05-17</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="e055" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">如何避免它们进入那里？—这是一个非常简单的处理方法。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/75cc9e733437079af36dfc79d8415dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cipx3LOg6cQEqucQuQa-SA.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://www.pexels.com/photo/shallow-focus-photo-of-man-holding-floor-brush-ceramic-figurine-434163/" rel="noopener ugc nofollow" target="_blank">像素</a>的<a class="ae kz" href="https://www.pexels.com/photo/shallow-focus-photo-of-man-holding-floor-brush-ceramic-figurine-434163/" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>拍摄</p></figure><p id="f083" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我经常遇到这种事。</p><p id="f754" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我创建存储库，并且我知道我需要将我的密钥存储在一个环境文件中。但是我总是提交我的更改，而不把它们添加到gitignore文件中。</p><p id="e483" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">结果，我们的秘密都在网上了！</p><p id="d04c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，即使您将环境文件添加到gitignore，它也不会从历史中消失。</p><p id="937a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">严重程度可能会有所不同，这取决于您上传的信息以及重置它的难度。然而，这是可以预防的！因此，我们应该始终阻止此类敏感数据进入云中。</p><p id="a113" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是，如果你不小心按到了什么东西，下面是正确清除的方法。</p><div class="lw lx gq gs ly lz"><a rel="noopener follow" target="_blank" href="/github-automated-testing-python-fdfe5aec9446"><div class="ma ab fp"><div class="mb ab mc cl cj md"><h2 class="bd iv gz z fq me fs ft mf fv fx it bi translated">如何使用GitHub动作在每次提交时运行Python测试？</h2><div class="mg l"><h3 class="bd b gz z fq me fs ft mf fv fx dk translated">自动化枯燥的工作，并通过CI管道确保代码质量。</h3></div><div class="mh l"><p class="bd b dl z fq me fs ft mf fv fx dk translated">towardsdatascience.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn kt lz"/></div></div></a></div><h1 id="da07" class="mo mp iu bd mq mr ms mt mu mv mw mx my ka mz kb na kd nb ke nc kg nd kh ne nf bi translated">正确删除GitHub中的秘密文件。</h1><p id="7574" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">当您提交一个机密文件(例如。env)，它成为git历史的一部分。移除文件并重新提交不会清除它。稍后将它添加到gitignore也不会有帮助。</p><p id="3398" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以前，人们使用git-filter-branch来挖掘分支模型。相信我；你不会想进去的。</p><p id="f60b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果你不同意，这里有关于<a class="ae kz" href="https://git-scm.com/docs/git-filter-branch" rel="noopener ugc nofollow" target="_blank"> git-filter-branch文档</a>的警告信息。</p><blockquote class="nl"><p id="e4b0" class="nm nn iu bd no np nq nr ns nt nu lv dk translated">git filter-branch 有太多的缺陷，可能会导致不明显的历史重写——Git filter分支文档的混乱</p></blockquote><p id="85cf" class="pw-post-body-paragraph la lb iu lc b ld nv jv lf lg nw jy li lj nx ll lm ln ny lp lq lr nz lt lu lv in bi translated">幸运的是，我们有一个更简单的选择。它叫做<a class="ae kz" href="https://rtyley.github.io/bfg-repo-cleaner/" rel="noopener ugc nofollow" target="_blank"> BFG回购清道夫。</a></p><p id="e45c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">BFG是一个社区维护的公用事业。是用Java写的。所以确保你已经在电脑上准备好了。</p><h2 id="6008" class="oa mp iu bd mq ob oc dn mu od oe dp my lj of og na ln oh oi nc lr oj ok ne ol bi translated">如何不删除Git中的秘密文件？</h2><p id="6757" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">让我们为这个演练创建一个示例repo。</p><p id="ca77" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我创建了一个只有一个文件的回购。它是一个. env文件，里面有一个密钥。有了它，我做了第一次承诺。现在。env文件应该在历史记录中。</p><pre class="kk kl km kn gu om on oo op aw oq bi"><span id="209d" class="oa mp iu on b gz or os l ot ou">$ mkdir testrepo<br/>$ cd testrepo/<br/>$ echo "SECRET_KEY=039jrad8932" &gt; .env<br/>$ git init</span><span id="3aa6" class="oa mp iu on b gz ov os l ot ou">$ git add .<br/>$ git commit -m 'initial commit'</span></pre><p id="66d3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们在GitHub(或者Bitbucket等)上创建一个云仓库。)并将我们的代码上传到那里。</p><pre class="kk kl km kn gu om on oo op aw oq bi"><span id="ef60" class="oa mp iu on b gz or os l ot ou">$ git remote add origin <a class="ae kz" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank">git@github.com</a>:&lt;Your-Repo&gt;.git<br/>$ git branch -M main<br/>$ git push -u origin main</span></pre><p id="52c3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">哎呀，我们的秘密在网上！如果您访问您的远程回购，您可以看到。环境文件。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ow"><img src="../Images/85f9eeff7a022eef79f9a425bf194fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6UNYDnS74ZlsiC8GH8pC9Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://thuwarakesh.medium.com" rel="noopener">作者截图。</a></p></figure><p id="0a3b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">让我们移除它，重新提交并推动它。并且刷新云回购看看效果。</p><pre class="kk kl km kn gu om on oo op aw oq bi"><span id="fd03" class="oa mp iu on b gz or os l ot ou">$ rm .env<br/>$ git add .env<br/>$ git commit -m 'remove secret'<br/>$ git push origin main</span></pre><p id="c4b3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">唷！现在没了。</p><p id="f4f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">不，还没有。它仍然在提交历史中。任何能接触到回购协议的人都可以看到。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj ox"><img src="../Images/4c4b37adfbeb7352dd44318f74bb3eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*cx29dMj3vZV7ta-xKAyMrA.gif"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://thuwarakesh.medium.com" rel="noopener">作者录制的屏幕录像。</a></p></figure><p id="35be" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">没用！</p><div class="lw lx gq gs ly lz"><a rel="noopener follow" target="_blank" href="/python-project-structure-best-practices-d9d0b174ad5d"><div class="ma ab fp"><div class="mb ab mc cl cj md"><h2 class="bd iv gz z fq me fs ft mf fv fx it bi translated">让您的Python项目结构更优雅的7种方法</h2><div class="mg l"><h3 class="bd b gz z fq me fs ft mf fv fx dk translated">以下是易于管理、可伸缩且易于理解的python项目结构的最佳实践。</h3></div><div class="mh l"><p class="bd b dl z fq me fs ft mf fv fx dk translated">towardsdatascience.com</p></div></div><div class="mi l"><div class="oy l mk ml mm mi mn kt lz"/></div></div></a></div><h2 id="8c67" class="oa mp iu bd mq ob oc dn mu od oe dp my lj of og na ln oh oi nc lr oj ok ne ol bi translated">用BFG删除Git上的秘密文件。</h2><p id="d589" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">以下是去除它们的正确方法。正如我前面提到的，你需要BFG。BFG需要Java。</p><p id="a13d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以使用以下命令确认您的计算机上是否安装了Java。如果没有，请<a class="ae kz" href="https://www.java.com/en/download/help/download_options.html" rel="noopener ugc nofollow" target="_blank">按照这个文档来安装它。</a></p><p id="5467" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你可以从他们的<a class="ae kz" href="https://rtyley.github.io/bfg-repo-cleaner/" rel="noopener ugc nofollow" target="_blank">官方页面</a>下载BFG jar文件。</p><p id="61a8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">第一步:</strong>要从所有分支的历史中删除文件，首先，您需要创建我们的远程存储库的镜像克隆。</p><pre class="kk kl km kn gu om on oo op aw oq bi"><span id="45eb" class="oa mp iu on b gz or os l ot ou">$ git clone --mirror git://&lt;Your-Repo&gt;.git</span></pre><p id="bd7b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">什么是镜像回购？</p><p id="da0c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">假设您进入新克隆的存储库。你看不到你的普通文件。相反，您会看到Git用来管理存储库的文件和文件夹。我们称这样的仓库为裸回购。但是镜像回购，除了裸回购内容之外，还有你的文件、分支、历史等的完整副本。，在里面。</p><p id="2c7e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">第二步:</strong>下面是从历史中删除文件的代码。确保从克隆的存储库之外运行这段代码。</p><pre class="kk kl km kn gu om on oo op aw oq bi"><span id="2820" class="oa mp iu on b gz or os l ot ou">java -jar bfg.jar <strong class="on iv">--delete-files .env &lt;Your-repo&gt;.git</strong></span></pre><p id="f4f2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">上面的代码将在终端上打印一些有用的信息。它会通知您是否有任何与您的标准匹配的文件、分支和提交会受到影响，等等。</p><p id="1c61" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你的文件没有被删除。它只从git历史中删除。因此，在永久删除它们之前，您需要查看屏幕上的信息。</p><p id="f8f8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">第三步:</strong>您可以运行下面的代码，当您完成评审时，将它从所有分支和提交中永久删除。这个命令需要在存储库中运行。</p><pre class="kk kl km kn gu om on oo op aw oq bi"><span id="b03e" class="oa mp iu on b gz or os l ot ou">$ cd &lt;Your-Repo&gt;.git # if you're still outside the repo directory. </span><span id="4f95" class="oa mp iu on b gz ov os l ot ou">$ git reflog expire --expire=now --all &amp;&amp; git gc --prune=now --aggressive</span><span id="26fc" class="oa mp iu on b gz ov os l ot ou">$ git push</span></pre><p id="df48" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您现在刷新远程存储库页面，您将看不到机密文件。不在文件区。甚至在提交时也没有。</p><p id="8371" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们刚刚从网上删除了我们的秘密。</p><h1 id="2382" class="mo mp iu bd mq mr ms mt mu mv mw mx my ka mz kb na kd nb ke nc kg nd kh ne nf bi translated">最后的想法</h1><p id="bf46" class="pw-post-body-paragraph la lb iu lc b ld ng jv lf lg nh jy li lj ni ll lm ln nj lp lq lr nk lt lu lv in bi translated">推送敏感文件，如。用密码包围是我经常犯的错误。</p><p id="106a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">BFG可能不是你犯错误的通行证。后果可能是灾难性的。但这是为了营救。</p><p id="d79b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，我想说的是，尽管BFG删除了所有分支和提交历史中的文件，但它不会影响你的最后一次提交。这种提交也被称为头部。</p><p id="44fb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">BFG假设最后一次提交发生在生产中。改变那里的任何东西都可能使你的部署失败。</p><p id="2432" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">BFG的文件说，“你需要解决这个问题，BFG帮不了你。”</p><p id="4279" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">此外，如果其他人有您的存储库的本地副本，您仍然有风险。</p><div class="lw lx gq gs ly lz"><a rel="noopener follow" target="_blank" href="/3-ways-to-deploy-machine-learning-models-in-production-cdba15b00e"><div class="ma ab fp"><div class="mb ab mc cl cj md"><h2 class="bd iv gz z fq me fs ft mf fv fx it bi translated">在生产中部署机器学习模型的3种方式</h2><div class="mg l"><h3 class="bd b gz z fq me fs ft mf fv fx dk translated">部署ML模型，并使它们对用户或项目的其他组件可用。</h3></div><div class="mh l"><p class="bd b dl z fq me fs ft mf fv fx dk translated">towardsdatascience.com</p></div></div><div class="mi l"><div class="oz l mk ml mm mi mn kt lz"/></div></div></a></div></div><div class="ab cl pa pb hy pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="in io ip iq ir"><blockquote class="ph pi pj"><p id="089e" class="la lb pk lc b ld le jv lf lg lh jy li pl lk ll lm pm lo lp lq pn ls lt lu lv in bi translated">朋友，感谢你的阅读！在<a class="ae kz" href="https://www.linkedin.com/in/thuwarakesh/" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv"><em class="iu">LinkedIn</em></strong></a><em class="iu"/><a class="ae kz" href="https://twitter.com/Thuwarakesh" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv"><em class="iu">Twitter</em></strong></a><em class="iu">，以及</em><a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener"><strong class="lc iv"><em class="iu">Medium</em></strong></a><em class="iu">上跟我打招呼。</em></p><p id="f53f" class="la lb pk lc b ld le jv lf lg lh jy li pl lk ll lm pm lo lp lq pn ls lt lu lv in bi translated"><em class="iu">还不是中等会员？请使用此链接</em> <a class="ae kz" href="https://thuwarakesh.medium.com/membership" rel="noopener"> <strong class="lc iv"> <em class="iu">成为会员</em> </strong> </a> <em class="iu">因为，在不为你额外付费的情况下，我为你引荐赚取一小笔佣金。</em></p></blockquote></div></div>    
</body>
</html>