<html>
<head>
<title>3 Types of Data Cleaning You Must Know in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中你必须知道的3种数据清理类型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-types-of-data-cleaning-you-must-know-in-python-1ab6986a8b1d#2022-10-12">https://towardsdatascience.com/3-types-of-data-cleaning-you-must-know-in-python-1ab6986a8b1d#2022-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="308a" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">计算机编程语言</h2><div class=""/><div class=""><h2 id="c68a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">数据清洗是数据分析中枯燥却又至关重要的一步</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/33a5c9a9e6c380a4e49fcc4ce00f9057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZBBPWj_TtplNqzf5so-6A.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://www.pexels.com/photo/shallow-focus-photo-of-man-holding-floor-brush-ceramic-figurine-434163/" rel="noopener ugc nofollow" target="_blank">pix abay拍摄的照片</a></p></figure><p id="6718" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据清理是最耗时的任务之一！</p><p id="693a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我必须承认，真实世界的数据总是混乱的，很少是干净的。它包含不正确或缩写的列名、缺失的数据、不正确的数据类型、单个列中的信息过多等等。</p><p id="ee4d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在处理数据之前解决这些问题非常重要。最终，干净的数据总是能提高生产力，让你创造最好的，准确的洞察力。</p><p id="5cb9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，我列出了在使用Python处理数据时必须知道的3种类型的数据清理。</p><p id="1d04" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了举例，我使用的是由<a class="ae lh" href="https://www.kaggle.com/datasets/pavlofesenko/titanic-extended" rel="noopener ugc nofollow" target="_blank"> Pavlo Fesenko </a>创建的Titanic数据集的扩展版本，该数据集可以根据<a class="ae lh" href="https://creativecommons.org/licenses/by-sa/3.0/" rel="noopener ugc nofollow" target="_blank"> CC许可</a>免费获得。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi me"><img src="../Images/06bc90170219ab1b3f5637e8d9ddcce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DF2hfcMzB-doCUHHTJB7w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://www.kaggle.com/datasets/pavlofesenko/titanic-extended" rel="noopener ugc nofollow" target="_blank">泰坦尼克号数据集</a> |作者图片</p></figure><p id="5d14" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它是一个简单的数据集，有1309行和21列。我在下面展示了大量关于如何从这些数据中获得最佳收益的例子。</p><p id="12da" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们开始吧..🚀</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="5ef7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，导入pandas并在pandas DataFrame中读取这个csv文件。使用<code class="fe mm mn mo mp b">.info()</code>方法获得关于数据集大小、列及其各自数据类型的完整概述是一个很好的实践。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="5825" class="mu mv it mp b gy mw mx l my mz">df = pd.read_csv("Complete_Titanic_Extended_Dataset.csv")<br/>df.info()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi na"><img src="../Images/14479ec627af2bfa44c5a440490aadcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*0U4QnV77_Xg1ym8YnAPMRA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">df.info()获得数据集|按作者分类的图像的概述</p></figure><p id="21a6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们从最简单的清洁步骤开始，这可能会节省一些内存和时间，以及你继续进行处理。</p><h1 id="cd37" class="nb mv it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">移除未使用和不相关的列</h1><p id="bb55" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">您可以注意到，该数据集包含21列，您很少会将它们全部用于数据分析任务。因此，请仅选择所需的列。</p><p id="08e4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">举个例子，假设你不需要列<code class="fe mm mn mo mp b">PassengerId</code>、<code class="fe mm mn mo mp b">SibSp</code>、<code class="fe mm mn mo mp b">Parch</code>、<code class="fe mm mn mo mp b">WikiId</code>、<code class="fe mm mn mo mp b">Name_wiki</code>和<code class="fe mm mn mo mp b">Age_wiki</code>。</p><p id="bcac" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您需要做的就是创建这些列名的列表，并在如下所示的<code class="fe mm mn mo mp b"><strong class="lk jd">df.drop()</strong></code>函数中使用它。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="bab9" class="mu mv it mp b gy mw mx l my mz"><strong class="mp jd">columns_to_drop = ['PassengerId', 'SibSp', <br/>                   'Parch', 'WikiId', <br/>                   'Name_wiki', 'Age_wiki']</strong></span><span id="88a9" class="mu mv it mp b gy nx mx l my mz"><strong class="mp jd">df.drop(columns_to_drop, inplace=True, axis=1)</strong><br/>df.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/6413ffd210275c3dd8df4de9349c5e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rc-ebb43Qg_mHtDL-NLk6w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">仅保留相关列|作者图片</p></figure><p id="8610" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当您使用<code class="fe mm mn mo mp b">.info()</code>方法中的参数<code class="fe mm mn mo mp b"><strong class="lk jd">memory_usage = "deep"</strong></code>检查内存消耗时，您会注意到这个新创建的数据集只消耗了834 KB，而原始数据帧消耗了1000 KB。</p><p id="b388" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这些数字在这里可能看起来很小，但在处理大数据集时会非常大。</p><blockquote class="nz"><p id="6b8c" class="oa ob it bd oc od oe of og oh oi md dk translated">所以删除不相关的列节省了17%的内存！！</p></blockquote><p id="2e3c" class="pw-post-body-paragraph li lj it lk b ll oj kd ln lo ok kg lq lr ol lt lu lv om lx ly lz on mb mc md im bi translated">使用方法<code class="fe mm mn mo mp b">.drop()</code>删除列的一个小缺点是，当您使用<code class="fe mm mn mo mp b">inplace = True</code>时，它会改变原始数据帧。如果您仍然对原始数据帧感兴趣，您可以将<code class="fe mm mn mo mp b">df.drop()</code>输出(不替换)赋给另一个变量，如下所示。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="7ad2" class="mu mv it mp b gy mw mx l my mz">df1 = df.drop(columns_to_drop, axis=1)</span></pre><p id="375a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">或者，当您希望删除大量的列而只保留4–5列时，可能会出现这种情况。在这种情况下，不要使用<code class="fe mm mn mo mp b">df.drop()</code>,而应该使用具有选定列数的<code class="fe mm mn mo mp b">df.copy()</code>。</p><p id="53c9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，如果您想只使用数据集中的姓名、性别、年龄和幸存列，您可以使用如下所示的<code class="fe mm mn mo mp b">df.copy()</code>对原始数据集进行子集化。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="bb44" class="mu mv it mp b gy mw mx l my mz"><strong class="mp jd">df1 = df[["Name","Age","Sex","Survived"]].copy()</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/326c0c099149f01980caa065ead6a87a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*7CJAZCIdGCVbTAd1WNYO6Q.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用列列表的子集数据集|按作者分类的图像</p></figure><p id="ffce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据您的任务的实际需求，您可以使用上述任何一种方法来只选择相关的列。</p><p id="4216" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上图中，您可能会注意到，Age和Survived列中的一些值丢失了。在继续之前需要解决这个问题。</p><h1 id="0ecb" class="nb mv it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">处理缺失值或nan</h1><p id="fe7b" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">在几乎所有的数据集中，你需要处理丢失的值，这是数据清理的棘手部分之一。如果你想利用这些数据进行机器学习，你应该知道，大多数模型不接受缺失数据。</p><blockquote class="op oq or"><p id="3ac9" class="li lj os lk b ll lm kd ln lo lp kg lq ot ls lt lu ou lw lx ly ov ma mb mc md im bi translated">但是如何找到缺失的数据呢？？</p></blockquote><p id="f19d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有多种方法可以找出数据集中的哪一节、哪一列缺少值。下面是四种常用于查找缺失数据的技术。</p><h2 id="4f20" class="mu mv it bd nc ow ox dn ng oy oz dp nk lr pa pb nm lv pc pd no lz pe pf nq iz bi translated">的方法。信息()</h2><p id="c079" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">这是了解任何列中是否有缺失值的简单方法之一。当您使用<code class="fe mm mn mo mp b">df.info()</code>时，您可以看到如下数据框<code class="fe mm mn mo mp b">df </code>的快速概览。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/42f6579700fca935b1618f96970027ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*dFhvNADmtZHZqzuC3BihCA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">df.info()获取作者的DataFrame | Image概览</p></figure><p id="7ac9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面红框中显示的列名是多个值缺失的地方。理想情况下，该数据集中的每一列都应该包含1309个值，但是该输出显示大多数列包含小于1309的值。</p><p id="2849" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您还可以可视化这些缺失的值。</p><h2 id="36dc" class="mu mv it bd nc ow ox dn ng oy oz dp nk lr pa pb nm lv pc pd no lz pe pf nq iz bi translated">缺失数据的热图</h2><p id="c796" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">这是可视化缺失数据的常用方法之一。您可以通过将数据编码为布尔值(即<code class="fe mm mn mo mp b">1</code>或<code class="fe mm mn mo mp b">0</code>)来创建数据的热图，并且您可以使用熊猫函数<code class="fe mm mn mo mp b">.isna()</code>来创建热图。</p><blockquote class="op oq or"><p id="da30" class="li lj os lk b ll lm kd ln lo lp kg lq ot ls lt lu ou lw lx ly ov ma mb mc md im bi translated">熊猫里的<code class="fe mm mn mo mp b">.isna()</code>是什么？？</p></blockquote><p id="e84b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">方法<code class="fe mm mn mo mp b">isna()</code>返回一个DataFrame对象，对于<code class="fe mm mn mo mp b">NaN</code>，所有的值都被替换为布尔值True，否则为False。</p><p id="b555" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你所需要做的就是输入一行代码，如下所示。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="cb01" class="mu mv it mp b gy mw mx l my mz">import seaborn as sns<br/><strong class="mp jd">sns.heatmap(df.isna())</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ca"><img src="../Images/02aca3c8d609deed1fb5bf68c18575fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3YNZLQwI0I68059y6su81w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">缺失值热图|作者图片</p></figure><p id="8a59" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上图中的X轴显示所有的列名，而Y轴代表索引号或行号。右侧的图例告诉您用于表示缺失数据的布尔值。</p><p id="2c09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这有助于您了解数据在特定列的哪个部分或哪个索引号之间丢失。</p><p id="95a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">好吧，如果列名不容易阅读，你可以创建它的转置版本，如下所示。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="d31a" class="mu mv it mp b gy mw mx l my mz"><strong class="mp jd">sns.heatmap(df.isna().transpose())</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ph"><img src="../Images/85393a81733b27e053405a52145955dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KsIcSiJFfJVUinUPSbw6g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">缺失值热图|作者图片</p></figure><p id="d77c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当要素或列的数量较少时，此类热图非常有用。如果有大量的功能，您可以始终对其进行子集化。</p><p id="44a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是，请记住，如果数据集很大，可视化需要时间来创建。</p><p id="4140" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">尽管热图可以让您了解丢失数据的位置，但它不会告诉您丢失数据的数量。你可以用下一种方法得到它。</p><h2 id="5eb2" class="mu mv it bd nc ow ox dn ng oy oz dp nk lr pa pb nm lv pc pd no lz pe pf nq iz bi translated">缺失数据占总数据的百分比</h2><p id="db7c" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">没有直接的方法可以得到它，但是你能使用的就是<code class="fe mm mn mo mp b">.isna()</code>方法和下面的一段代码。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="1c9c" class="mu mv it mp b gy mw mx l my mz">import numpy as np<br/>print("Amount of missing values in - ")<br/>for column in df.columns:<br/>    percentage_missing = <strong class="mp jd">np.mean(df[column].isna())</strong><br/>    print(f'{column} : {round(percentage_missing*100)}%')</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/c411ddefd8d230af0f2025a5bb7f22b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*QVuBkvLiaTSGjv25s2W1tA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">熊猫数据框|作者图片中缺失值的百分比</p></figure><p id="db77" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">通过这种方式，您可以看到各个列中缺少多少百分比值。这在处理这些缺失值时会很有用。</p><blockquote class="op oq or"><p id="3c70" class="li lj os lk b ll lm kd ln lo lp kg lq ot ls lt lu ou lw lx ly ov ma mb mc md im bi translated">我找到了丢失的数据，但是接下来呢？？</p></blockquote><p id="872b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">没有处理缺失数据的标准方法。唯一的方法是查看单个列、其中缺失值的数量以及该列在未来的重要性。</p><p id="14f8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">根据以上观察，您可以使用以下3种方法中的任何一种来处理缺失数据。</p><ol class=""><li id="1e01" class="pj pk it lk b ll lm lo lp lr pl lv pm lz pn md po pp pq pr bi translated"><strong class="lk jd">删除记录</strong> —当特定列缺少值或<code class="fe mm mn mo mp b"><strong class="lk jd">NaN</strong></code>时，删除索引处的整个记录。请注意，如果提到的列有大量缺失值，这种技术可以大大减少数据集中的记录数量。</li><li id="c297" class="pj pk it lk b ll ps lo pt lr pu lv pv lz pw md po pp pq pr bi translated"><strong class="lk jd">删除专栏或功能</strong> —这需要对特定的专栏进行深入研究，以了解其在未来的重要性。只有当您确信该特征不提供任何有用的信息时，才能这样做，例如，该数据集中的<code class="fe mm mn mo mp b">PassengerId</code>特征。</li><li id="d38c" class="pj pk it lk b ll ps lo pt lr pu lv pv lz pw md po pp pq pr bi translated"><strong class="lk jd">估算缺失数据</strong>—在这种技术中，您可以用同一列的平均值、中值或众数替换缺失值或<code class="fe mm mn mo mp b">NaN</code>。</li></ol><p id="f674" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所有这些处理缺失数据的方法都是一个很好的讨论主题，我将在下一篇文章中介绍。</p><p id="d4b4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了缺失数据之外，数据的另一个常见问题是数据类型不正确，需要解决这个问题才能获得高质量的数据。</p><h1 id="5655" class="nb mv it bd nc nd ne nf ng nh ni nj nk ki nl kj nm kl nn km no ko np kp nq nr bi translated">更正数据类型</h1><p id="160d" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">在使用不同的Python库时，您会注意到需要特定的数据类型来完成特定的转换。因此，每一列的数据类型都应该是正确的，适合于将来的使用。</p><p id="b950" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当您在pandas中使用<code class="fe mm mn mo mp b">read_csv</code>或任何其他<code class="fe mm mn mo mp b">read_</code>函数将数据放入DataFrame时，pandas将通过观察存储在其中的值来猜测每一列的数据类型。</p><p id="87c7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了少数几列，这个猜测几乎对所有的列都是正确的。并且您需要手动更正这些列的数据类型。</p><p id="9788" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，在Titanic dataset中，您可以使用下面的<code class="fe mm mn mo mp b"><strong class="lk jd">.info()</strong></code>来查看列数据类型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/7fc5ecaa54c75c2c3a1ce0fe7176b4ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*7c-Vu4N7JtYnNaOsPZY6qA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">熊猫数据框|作者图片中的数据类型不正确</p></figure><p id="44c0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面的输出中，列Age和Survived的数据类型为<code class="fe mm mn mo mp b">float64</code>，但是Age应该始终是一个整数，而Survived应该只有两种类型的值——Yes或No。</p><p id="54e8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了更好地理解它，让我们看看这些列中随机的5个值。</p><pre class="ks kt ku kv gt mq mp mr ms aw mt bi"><span id="2a35" class="mu mv it mp b gy mw mx l my mz">df[["Name","Sex","Survived","Age"]].sample(5)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi px"><img src="../Images/64dd8b5aad267fb08a55b0b805316f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*KPlBcR6BwVA0e14BR26MKA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">示例5行|作者图片</p></figure><p id="515e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了缺少的值之外，幸存的列有两个值— <code class="fe mm mn mo mp b">0.0</code> &amp; <code class="fe mm mn mo mp b">1.0</code> —理想情况下，这两个值应该分别是<code class="fe mm mn mo mp b">0</code>和<code class="fe mm mn mo mp b">1</code>的布尔值<code class="fe mm mn mo mp b">No</code> &amp; <code class="fe mm mn mo mp b">Yes</code>。另外,“年龄”列包含十进制格式的值。</p><p id="b230" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在继续之前，您可以使用正确的列类型来解决此问题。根据您的pandas版本，您可能需要在更正数据类型之前处理丢失的值。</p><p id="0791" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了上面的数据清理步骤，根据您的使用情况，您可能还需要下面的一些数据清理方法。</p><ol class=""><li id="00f7" class="pj pk it lk b ll lm lo lp lr pl lv pm lz pn md po pp pq pr bi translated"><strong class="lk jd">替换列中的值</strong> —有时数据集中的列包含True-False、Yes-No等值，这些值可以很容易地替换为<code class="fe mm mn mo mp b">1</code> &amp; <code class="fe mm mn mo mp b">0</code>以使数据集可用于机器学习应用程序。</li><li id="008f" class="pj pk it lk b ll ps lo pt lr pu lv pv lz pw md po pp pq pr bi translated"><strong class="lk jd">去除异常值</strong> —异常值是与其他观察值显著不同的数据点。然而，丢弃离群值并不总是一个好主意。需要仔细评估这些显著不同的数据点。</li><li id="8b03" class="pj pk it lk b ll ps lo pt lr pu lv pv lz pw md po pp pq pr bi translated"><strong class="lk jd">删除重复项</strong> —当记录中所有列的所有值都相同时，可以认为数据是重复的。熊猫数据框方法<code class="fe mm mn mo mp b"><strong class="lk jd">.drop_duplicates()</strong></code>对于删除重复非常方便。</li></ol><p id="c0cf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">仅此而已！</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="0127" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望这篇文章对你有用，让你耳目一新。数据清理是最耗时的任务之一，通常需要创造性的方法来处理不同类型的数据问题。</p><p id="1a4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你喜欢阅读这样令人惊叹的文章，请订阅<a class="ae lh" href="https://medium.com/subscribe/@17.rsuraj" rel="noopener"> <strong class="lk jd">我的邮件列表</strong> </a>！</p><p id="ded5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">作为一个免费用户，你只能阅读3个故事，但作为一个媒体成员，你可以访问媒体上的所有内容。所以，<a class="ae lh" href="https://medium.com/@17.rsuraj/membership" rel="noopener"> <strong class="lk jd">加入Medium </strong> </a>使用我下面的推荐链接，它也将支持我作为一个作家，因为Medium与我分享你的一小部分费用。✅</p><div class="py pz gp gr qa qb"><a href="https://medium.com/@17.rsuraj/membership" rel="noopener follow" target="_blank"><div class="qc ab fo"><div class="qd ab qe cl cj qf"><h2 class="bd jd gy z fp qg fr fs qh fu fw jc bi translated">加入我的推荐链接- Suraj Gurav媒体</h2><div class="qi l"><h3 class="bd b gy z fp qg fr fs qh fu fw dk translated">立即访问媒体！！是时候加入Medium了，可以无限制地访问每篇文章，阅读所有内容…</h3></div><div class="qj l"><p class="bd b dl z fp qg fr fs qh fu fw dk translated">medium.com</p></div></div><div class="qk l"><div class="ql l qm qn qo qk qp lb qb"/></div></div></a></div><p id="9f62" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">感谢您的阅读！</strong></p></div></div>    
</body>
</html>