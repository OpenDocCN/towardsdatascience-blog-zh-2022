<html>
<head>
<title>A Super-Fast Way to Loop in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种超快速的Python循环方式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-super-fast-way-to-loop-in-python-6e58ba377a00#2022-05-10">https://towardsdatascience.com/a-super-fast-way-to-loop-in-python-6e58ba377a00#2022-05-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dcf1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你觉得Python慢吗？这里有一个在Python中快速循环的方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9c6df219f5883acd436e8d2eefb3f609.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZFttCGuPsIXMrT7402paag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自Shutterstock，授权给Frank Andrade</p></figure><p id="f4da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">众所周知，Python是一种缓慢的编程语言。虽然Python比其他语言慢是事实，但是有一些方法可以加速我们的Python代码。</p><p id="00d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">怎么会？简单，优化你的代码。</p><p id="b7d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们编写消耗很少内存和存储的代码，我们不仅可以完成工作，还可以让我们的Python代码运行得更快。</p><p id="5061" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里有一个快速也是超快速的Python循环方法，这是我在<a class="ae lu" href="https://medium.com/p/38c7866f5cb5" rel="noopener">上的一门Python课程</a>中学到的(我们从未停止学习！).</p><h1 id="23fb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">平均循环</h1><p id="dbbc" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">假设我们想对从1到100000000的数字求和(我们可能永远不会这样做，但这个大数字将有助于我阐明我的观点)。</p><p id="0185" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">典型的方法是创建一个变量<code class="fe ms mt mu mv b">total_sum=0</code>，在一个范围内循环，并在每次迭代中用<code class="fe ms mt mu mv b">i</code>增加<code class="fe ms mt mu mv b">total_sum</code>的值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="07a1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就完成了工作，但是需要大约6.58秒。</p><p id="d6ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然现在看起来没那么慢，但是当你在范围内的数字上加更多的0时，它会变得更慢。</p><p id="3f08" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们加速吧！</p><h1 id="112c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用内置函数进行循环的更快方法</h1><p id="08a2" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在Python中循环的更快方法是使用内置函数。</p><p id="c8a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的例子中，我们可以用<code class="fe ms mt mu mv b">sum</code>函数替换for循环。此函数将对数字范围内的值求和。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="34a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的代码耗时0.84秒。这比我们之前使用的循环快多了！这就是为什么我们应该选择内置函数而不是循环。</p><p id="cdc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但仍有改进的空间。</p><h1 id="b3a3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用Numpy的超快速循环方式</h1><p id="9b28" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">几周前，在我参加的<a class="ae lu" href="https://medium.com/p/ca54b6619e68" rel="noopener">数据科学课程中，我了解到要成为一名更好的数据科学家，我应该遵循的软件工程实践之一就是优化我的代码。</a></p><p id="08bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过向量化操作来优化循环。这比它们的纯Python对等物快一/两个数量级(特别是在数值计算中)。</p><p id="2a03" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">矢量化是我们可以通过NumPy得到的东西。Numpy是一个具有高效数据结构的库，用于保存矩阵数据。它主要是用C写的，所以速度是你可以信赖的。</p><p id="4454" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们尝试使用Numpy方法<code class="fe ms mt mu mv b">.sum</code>和<code class="fe ms mt mu mv b">.arange</code>来代替Python函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="fa9d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可以在0.22秒内完成工作。这比以前的方法要快得多。</p><p id="48da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是为什么应该尽可能在循环中使用向量运算的原因。</p><h1 id="2a54" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用更多的计算来测试循环和数字</h1><p id="9876" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">到目前为止，我们已经看到了Numpy的一个简单应用，但是如果我们不仅有一个for循环，还有一个if条件和更多的计算要做呢？</p><p id="ed17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Numpy的表现明显优于loops。</p><p id="1f21" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们有一组随机的考试分数(从1到100)，我们想要获得那些没有通过考试的人的平均分数(score &lt;70).</p><p id="e796" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Here’s how we’d do this with a for loop.</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="4c45" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">That takes approximately 15.7 seconds. Not bad, but we can get faster results with Numpy.</p><p id="ef94" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Here’s how we’d do this with Numpy.</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="5cd6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">The code above takes about 0.78 seconds. That’s way faster and the code is straightforward!</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="ff44" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Learning Data Science with Python? <a class="ae lu" href="https://frankandrade.ck.page/26b76e9130" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">)通过加入我的10k+人的电子邮件列表来获得我的免费Python for Data Science备忘单。</strong>T3】</a></p><p id="a5f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你用<a class="ae lu" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="nf ng gp gr nh ni"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw ks ni"/></div></div></a></div></div></div>    
</body>
</html>