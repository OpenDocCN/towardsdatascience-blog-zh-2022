<html>
<head>
<title>Pandas Sidetable Simplifies the Exploratory Data Analysis Process</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pandas Sidetable简化了探索性数据分析过程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-sidetable-simplifies-the-exploratory-data-analysis-process-417b42eebed6#2022-09-27">https://towardsdatascience.com/pandas-sidetable-simplifies-the-exploratory-data-analysis-process-417b42eebed6#2022-09-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f95d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫的实用附加产品</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3ab4f402df4af481faf024cd7a9ef113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4aHGjGi7oNr8tVS60ao_hg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/ja/@vidarnm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">维达尔·诺德里-马西森</a>在<a class="ae ky" href="https://unsplash.com/s/photos/buddy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="36cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/chris1610/sidetable" rel="noopener ugc nofollow" target="_blank"> Sidetable </a>是由<a class="ae ky" href="https://twitter.com/chris1610" rel="noopener ugc nofollow" target="_blank"> Chris Moffitt </a>创建的开源pandas实用程序库。它为pandas数据框架创建汇总表，这在探索性数据分析中非常有用。</p><p id="4fa0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sidetable所做的也可以在熊猫身上实现，但是它简化了这个过程。您只需一行代码就可以获得数据的大致情况。</p><p id="2a96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在撰写本文时，sidetable有5个功能，并且正在改进中。因此，我们可以期待更多的即将到来。我们将为每个函数做一些示例，以理解它做什么以及它如何有助于有效的探索性数据分析。</p><p id="aa5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以按如下方式安装sidetable:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="84e9" class="ma mb it lw b gy mc md l me mf"># terminal<br/>$  python -m pip install -U sidetable</span><span id="3020" class="ma mb it lw b gy mg md l me mf"># jupyter notebook<br/>!pip install sidetable</span></pre><p id="734a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装后，您可以导入sidetable并将其用作pandas数据帧上的访问器。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a839" class="ma mb it lw b gy mc md l me mf">import pandas as pd<br/>import sidetable</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="d7ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用我用模拟数据创建的销售数据集。你可以从我的GitHub页面上的<a class="ae ky" href="https://github.com/SonerYldrm/datasets" rel="noopener ugc nofollow" target="_blank">数据集</a>库中下载。我们将在本文中使用的数据集称为商店销售数据。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3da4" class="ma mb it lw b gy mc md l me mf">sales = pd.read_csv(<br/>  "sales_data_with_stores.csv",<br/>   usecols = ["store", "product_group", "product_code", "cost",  <br/>              "price", "last_week_sales"]<br/>)</span><span id="1e68" class="ma mb it lw b gy mg md l me mf">sales.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/7965323e529b6049088608b54bcee839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PzSug1W6BvobrcSsZOBFbQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="ce7c" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated"><strong class="ak">类固醇的价值统计</strong></h1><p id="b52d" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">假设我们想从产品组的角度获得一个概述，并寻找以下问题的答案:</p><ul class=""><li id="8d0b" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">存在多少个产品组？</li><li id="1f3c" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">就每个产品组包含的产品数量而言，每个产品组的规模有多大？</li><li id="ae1e" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">整个投资组合的累积覆盖率是多少？</li></ul><p id="2377" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过使用<strong class="lb iu"> freq </strong>函数的一行代码找到所有这些问题的答案。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="79b9" class="ma mb it lw b gy mc md l me mf">sales.stb.freq(["product_group"])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/2ee5cd5084d07441370b88542e240f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XigpQc2AuUdl-1t6fMNPNg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="8c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有6个产品组，我们可以看到每个组包含多少产品。此外，结果表具有累积值。例如，PG4、PG5和PG6占我们整个产品组合的85%。</p><p id="d67a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上表基于数据帧中的行数。比方说，我们希望看到销售的分布情况。这可以通过使用freq函数的value参数轻松完成。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="67df" class="ma mb it lw b gy mc md l me mf">sales.stb.freq(["product_group"], value="last_week_sales")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/9ace081b32ad88bef4789b58be930f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkGQChXlcl1O2bUdqH1SEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="4ac7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就产品数量而言，PG3是第三大产品组，但其销售额最高。这对我们的分析是一个有价值的见解。</p><p id="b22a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可能希望进一步分析，并分别查看每个商店产品组的表现。我们需要做的就是在Python列表中编写产品组和存储列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8d0f" class="ma mb it lw b gy mc md l me mf">sales.stb.freq(["product_group", "store"], value="last_week_sales")</span></pre></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="9c00" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">一次6个问题</h1><ul class=""><li id="d3eb" class="nl nm it lb b lc ng lf nh li ob lm oc lq od lu nq nr ns nt bi translated">有多少观察值(即行数)？</li><li id="b520" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">有多少独特的价值？</li><li id="5a6b" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">最常值？</li><li id="6510" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">最频繁值有多少次观察？</li><li id="6d56" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">最不频繁的值？</li><li id="771e" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">最不频繁值有多少个观察值？</li></ul><p id="3925" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<strong class="lb iu"> counts </strong>函数，用一行代码就可以回答所有这些问题。</p><p id="c99b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，我们获得所有列的结果。但是，这些问题通常针对分类列。因此，如果我们只需要分类列的数据，我们可以使用exclude参数排除数值列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6c51" class="ma mb it lw b gy mc md l me mf">sales.stb.counts(exclude="number")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/ed75be6e9ad3c3094c446c5a6d8cd1b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIDB0xvE2PJMCTIJl04m7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="b802" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们对store列做一个快速的结果检查:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fe04" class="ma mb it lw b gy mc md l me mf">sales["store"].value_counts()</span><span id="f3b6" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu"># output</strong><br/>Daisy     470<br/>Violet    330<br/>Rose      200<br/>Name: store, dtype: int64</span></pre><p id="cee1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最常见的值是daisy，它有470个观察值，这就是上面的sidetable所示。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="76d9" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">缺少值</h1><p id="c6a1" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">用熊猫寻找缺失的价值观并不是一件复杂的事情。isna和sum函数可以一起使用来查找每列中缺失值的数量。sidetable增加的是丢失值的百分比。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5b4a" class="ma mb it lw b gy mc md l me mf">sales.stb.missing()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/b34c2d57e66d1c89fef74dd6325b5155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P8cAoDyP2p0c08mZkvEqCQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="44bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">缺失函数提供了数据帧中缺失值的快速概览。</p><p id="6fd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果只需要包含缺失值的列，请将clip_0参数的值设置为True。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="eaea" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">汇总值的小计</h1><p id="bd69" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">Sidetable使得向groupby函数的结果添加小计变得非常简单。对于某些任务，小计可能会派上用场。让我们做有和没有小计的例子来看看区别。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="cf85" class="ma mb it lw b gy mc md l me mf">sales_filtered = sales[sales["product_group"].isin(["PG1", "PG2"])]</span><span id="f26d" class="ma mb it lw b gy mg md l me mf">sales_filtered.groupby(["store", "product_group"]).agg(<br/>    total_sales = ("last_week_sales", "sum")<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/940af15384ee937a4541e8333a49869b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prWUS52fYBVl-mN6KXvJ3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不带小计(图片由作者提供)</p></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3a55" class="ma mb it lw b gy mc md l me mf">sales_filtered.groupby(["store", "product_group"]).agg(<br/>    total_sales = ("last_week_sales", "sum")<br/>).stb.subtotal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/90d3961d0140b7663bfa40008cd3793b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziileElbTNArDHcNUFII4Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带小计(图片由作者提供)</p></figure><p id="da79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要注意的是，如果在groupby函数的输出中将分组显示为列(即，将as_index参数的值设置为False)，则不会计算小计。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><h1 id="c043" class="mp mb it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">用多级列索引展平数据帧</h1><p id="41fb" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">假设给我们一个数据帧，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/5363bef6c74276f8b4405b677edf2028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YpmjRU4aR1tNy4knPYrFGQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="ba12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们检查列名:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5e7c" class="ma mb it lw b gy mc md l me mf">df.columns</span><span id="e6d9" class="ma mb it lw b gy mg md l me mf"><strong class="lw iu"># output</strong><br/>MultiIndex([('total_sales', 'PG1'),<br/>            ('total_sales', 'PG2')],<br/>           names=[None, 'product_group'])</span></pre><p id="f63c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它是一个多索引，每个列名是一个元组。我们可以通过使用sidetable的<strong class="lb iu">展平</strong>功能来展平列名。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9dec" class="ma mb it lw b gy mc md l me mf">df.stb.flatten()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/d239dd2bd923e8262b32dacaf8a84530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NwJhm75qMqnLhoWA-XI8dA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="6163" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它看起来更好，更容易工作。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="1663" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Sidetable是探索性数据分析中非常实用的工具。我们在本文中所做的操作并不复杂，但是简化它们并没有坏处。Sidetable允许用一行代码执行所有这些操作。</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="5629" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oj">你可以成为</em> <a class="ae ky" href="https://sonery.medium.com/membership" rel="noopener"> <em class="oj">媒介会员</em> </a> <em class="oj">解锁我的全部写作权限，外加其余媒介。如果你已经是了，别忘了订阅</em><a class="ae ky" href="https://sonery.medium.com/subscribe" rel="noopener"><em class="oj"/></a><em class="oj">如果你想在我发表新文章时收到电子邮件。</em></p><p id="aa1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>