<html>
<head>
<title>Spatial Data Science: Reproducibility and Version Tracking with Git</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">空间数据科学:使用Git的再现性和版本跟踪</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/spatial-data-science-reproducibility-and-version-tracking-with-git-cd0b47d9ba52#2022-07-30">https://towardsdatascience.com/spatial-data-science-reproducibility-and-version-tracking-with-git-cd0b47d9ba52#2022-07-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ab2f862c77dc8451e1b47dd1d7ac6673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_h3LPvGRBF1cYqsuszewTw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者和里尼(2022)</p></figure><div class=""/><div class=""><h2 id="ccd9" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">空间模型构建器和Git:开发中的分析、跟踪和文档</h2></div><h1 id="b3b1" class="kx ky ji bd kz la lb lc ld le lf lg lh ko li kp lj kr lk ks ll ku lm kv ln lo bi translated">简介—文档</h1><p id="d440" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">文档是典型GIS工作流中的常见问题。点击哪些按钮？先用哪个工具，再用什么？我们的模式发生了什么变化？为什么有人做了什么事之后这就不管用了。更不用说软件版本和机器环境的差异了。当我们的工作必须对报告负责时，这变得非常必要。或者，在我们离开团队时进行交接，并培训接替我们的人。给定一组数据和环境，我们工作的可重复性是一个很大的保证。我们应该如何记录我们的空间数据过程？</p><p id="8e3d" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">在这篇文章中，我将讨论一些我们可以用来确保可重复性的工具。这些工具是模型构建器、git &amp; Python和Notebook (Jupyter，以前称为iPykernel)。如果你不做python或者任何编程，那么model builder是一个非常好的入门；一个非常简单的工具，说明设计过程。这个我先讨论一下。</p><p id="9605" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated"><em class="mq">注意:这个系列是空间数据科学的一部分:Sutan的系列，请查看下面的元文章以获得更多空间数据科学文章</em></p><div class="is it gp gr iu mr"><a href="https://medium.com/rekayasa-data-spasial/spatial-data-science-the-series-81344a3ead29" rel="noopener follow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd jj gy z fp mw fr fs mx fu fw jh bi translated">空间数据科学:系列</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">Sutan Mufti撰写的关于空间数据科学的系列文章。</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">medium.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ja mr"/></div></div></a></div><h1 id="463d" class="kx ky ji bd kz la lb lc ld le lf lg lh ko li kp lj kr lk ks ll ku lm kv ln lo bi translated">模型生成器——制作空间模型的图形用户界面工具</h1><p id="9b9a" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果你不使用编程语言，那么这是一个完美的工具。</p><p id="c10d" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">如果我们将问题的范围限制在分析部分，那么我认为model builder是一个非常方便的解决方案。模型构建器是一个关于我们的空间数据过程的图形模型；我们拖放流程，并在流程上画箭头。因为它不需要用户了解任何编程语言，所以它对每个人来说都很容易使用并且非常容易理解。</p><p id="bdd3" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">让我们创建一个简单的模型:<strong class="lr jj">首先我们缓冲一个特征，然后我们用另一个特征</strong>裁剪缓冲结果。请看下图。让我们把它命名为<strong class="lr jj">简单_模型。</strong></p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/687cd4b6514cc1b3b3c5ea086f567256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*05QoH-HKm0BOstjD4mTCEg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">带模型构建器的QGIS中的模型示例(作者，2022)</p></figure><p id="0978" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">首先，输入进入缓冲区，缓冲过程的输出用另一个特征进行剪裁。当然，这非常简单，但是在实际项目中，这可能会变得复杂。这很有帮助，因为它非常直观地展现了正在发生的事情。然后，我们可以将模型保存到我们的目录中。</p><p id="d216" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">我创建的模型基本上是一堆文本文件。QGIS只是渲染这些文本，这样我们就有了图形表示。下图显示了我们保存模型时的文本表示。嗯，它实际上是用UTF-8编码的，但我们现在不关心它。<strong class="lr jj">重要的是模型(来自模型构建器)基本上是一个文本文件</strong>。请注意，这种文本表示对于我将在下面讨论的版本跟踪非常重要。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/7da20e3d6021581b6cf8b9e96f24103c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkYf36Bbchui1JVH7r7ZzA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">名为simple_model的已保存模型的“实际”外观(作者，2022)</p></figure><h2 id="8298" class="nm ky ji bd kz nn no dn ld np nq dp lh ly nr ns lj mc nt nu ll mg nv nw ln nx bi translated">开发模型—添加变更</h2><p id="257e" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果我们做了改变，那么这些文字也会改变。一些新的行将被创建或删除，这取决于我们做什么。这就带来了识别什么已经改变以及何时改变的问题。因此，跟踪什么发生了变化是一个明智的措施，这可以用git来完成。</p><h1 id="ea6c" class="kx ky ji bd kz la lb lc ld le lf lg lh ko li kp lj kr lk ks ll ku lm kv ln lo bi translated">版本跟踪— Git</h1><p id="f2b6" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">现在我更想开发这个模型，并添加一些功能，因为我收到了一些反馈。我需要改变模型，这需要改变模型的文本文件。比方说，该模型显然将用于识别脆弱城市中的河流洪水危险区，我需要完成更多的流程。因此，我对模型做了一些修改。我做的一些改变:</p><ul class=""><li id="3121" class="ny nz ji lr b ls ml lv mm ly oa mc ob mg oc mk od oe of og bi translated">更改输入和输出属性名称；从默认名称<code class="fe oh oi oj ok b">input_geometry</code>和<code class="fe oh oi oj ok b">clip_feature</code>到<code class="fe oh oi oj ok b">the_river</code>和<code class="fe oh oi oj ok b">the_city</code>；诸如此类。</li><li id="df8a" class="ny nz ji lr b ls ol lv om ly on mc oo mg op mk od oe of og bi translated">添加<code class="fe oh oi oj ok b">difference</code>叠加过程来消除琐碎的区域。</li></ul><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/08c2fc209abafb6022d2a2df55cc4841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*61OlQFUKLQZiaP_A9IvIJA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们模型中的附加过程(作者，2022)</p></figure><p id="5a31" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">我添加了这两个改动，但是我的队友怎么知道我改了什么？此外，如果我的团队成员对模型做了其他事情，我怎么知道他做了什么？一封电子邮件就足够了，但它不如git有效。</p><p id="7f50" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">Git是一个命令行工具，用来控制我们代码中的变化。由于它是一个命令行工具，我们将使用终端或命令提示符。我们键入命令，然后单击enter执行。不要害怕，如果我们给一点时间，它不是那么复杂！基本命令是</p><ul class=""><li id="4163" class="ny nz ji lr b ls ml lv mm ly oa mc ob mg oc mk od oe of og bi translated"><code class="fe oh oi oj ok b">git log</code>显示更改的内容、更改者和时间</li><li id="b70f" class="ny nz ji lr b ls ol lv om ly on mc oo mg op mk od oe of og bi translated"><code class="fe oh oi oj ok b">git show</code>显示所做的实际更改</li><li id="bd95" class="ny nz ji lr b ls ol lv om ly on mc oo mg op mk od oe of og bi translated"><code class="fe oh oi oj ok b">git add</code>添加已更改但尚未提交的文件</li><li id="ed70" class="ny nz ji lr b ls ol lv om ly on mc oo mg op mk od oe of og bi translated">正式提交更改！git记录这个变化。</li></ul><h2 id="bb2f" class="nm ky ji bd kz nn no dn ld np nq dp lh ly nr ns lj mc nt nu ll mg nv nw ln nx bi translated">更改日志</h2><p id="baa2" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">每次我在模型中做小的改动，我都会用git创建一个日志。在这里，如果我执行<code class="fe oh oi oj ok b">git log</code>，它将显示我对来自我的消息/便笺做了什么。下图显示了我已经完成的3次提交。您可以看到是谁做的，什么时候做的，以及消息。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/e0aee1e183809c179beea6b19aef5a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wuCR_cSDN3UZvCLDC_glCw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">记录发生了哪些变化(作者，2022)</p></figure><h2 id="5923" class="nm ky ji bd kz nn no dn ld np nq dp lh ly nr ns lj mc nt nu ll mg nv nw ln nx bi translated">显示更改的内容</h2><p id="0c52" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">如果我想看到一个特定的提交/更改，我可以执行<code class="fe oh oi oj ok b">git show</code>，后跟提交id的第一个字符，例如<code class="fe oh oi oj ok b">git show 75fb8</code>。看下图。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/cb16fd573b6f4573d35a850bbca6e54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJFyvrKShQJuKa2WF4Jn_Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">展示改变了什么(作者，2022)</p></figure><p id="f7ff" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">红线是删除的行，绿线是新的/插入的行。这里我可以告诉大家，我把<code class="fe oh oi oj ok b">input_vector</code>改成了<code class="fe oh oi oj ok b">the_river</code>，把<code class="fe oh oi oj ok b">clip_feature</code>改成了<code class="fe oh oi oj ok b">the_city</code>。谁干的？git日志显示是我；但是如果我们和队友一起工作，我们可以看到其他人可能会改变这一点。</p><h2 id="cd40" class="nm ky ji bd kz nn no dn ld np nq dp lh ly nr ns lj mc nt nu ll mg nv nw ln nx bi translated">还原更改</h2><p id="fed3" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">比方说，经过几次反馈后，我们反对琐碎的区域差分程序；所以我们必须重新做我们的改变！这很烦人，但我们如何后退一步？我们使用<code class="fe oh oi oj ok b">git revert</code>来提交。让我们恢复我们的提交id <code class="fe oh oi oj ok b">fac543</code>并后退一步。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/a2ada72836fd297c4820b4a2527572f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fpiNrlH4E79jrkfDNDe5Vg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">恢复更改(作者，2022)</p></figure><p id="e10c" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">现在，您可以看到使用提交id <code class="fe oh oi oj ok b">0c018b6</code>完成了恢复，消息描述了恢复操作及其恢复的提交id。当我看到发生了什么变化时，这个模型又回到了以前的版本！</p><h2 id="ce53" class="nm ky ji bd kz nn no dn ld np nq dp lh ly nr ns lj mc nt nu ll mg nv nw ln nx bi translated">分支和协作</h2><p id="93a8" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">开发模型通常需要迭代和模块化特性。这些功能是模块化的，可以由其他团队成员开发。有了git，我们可以同时一起处理相同的文件，进行修改，并跟踪每个人都做了什么。这是通过分支实现的；从初始模型创建分支；最重要的是，将这些分支合并成一个具有丰富功能的单一模型。</p><p id="bd84" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">我们可以创建代表相同模型的分支，允许在这些分支上进行相应的更改。每个团队成员将并行处理他们的分支。当团队成员完成他们的工作时，我们将分支合并到一个模型中，每个团队成员都开发了这个模型的特性。</p><p id="d01e" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">下图显示了如何制作分支并将其合并回初始模型。它只是一个名为“somebranch”的单独分支；我在那里开发了一些模型，然后将其合并回初始模型。<code class="fe oh oi oj ok b">*</code>代表我所做的一个提交，后面是提交id。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ou"><img src="../Images/25a389264e67771e1c27912031b89567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_eSQz3oLrWDYw8Ob7_1-1g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">git中的分支(作者，2022)</p></figure><p id="303e" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">如果我们已经开发了一个稳定的模型，那么我们可以创建一个稳定版本的分支来保持它。稳定的分支不会被编辑，只是保留下来，让你知道它工作得很好。当一个开发阶段再次开始时，从稳定分支中创建另一个分支，然后重复。</p><h1 id="20e5" class="kx ky ji bd kz la lb lc ld le lf lg lh ko li kp lj kr lk ks ll ku lm kv ln lo bi translated">结论</h1><p id="bce2" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">这就对了。使用模型构建器可以实现分析的自动化和形式化。模型构建器创建算法的直观图形表示，确保再现性。git可以跟踪开发中的变化。Git还允许协同工作环境和控制模型的版本。</p><p id="0dce" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">这样，模型的文档可以随着模型开发的时间一起进行。更改可以并行进行，并且所有更改都会被记录。</p><h2 id="3205" class="nm ky ji bd kz nn no dn ld np nq dp lh ly nr ns lj mc nt nu ll mg nv nw ln nx bi translated">不足之处</h2><ul class=""><li id="c6da" class="ny nz ji lr b ls lt lv lw ly ov mc ow mg ox mk od oe of og bi translated">git和模型构建器相当复杂。建立直觉并使之自然需要数月的练习。你需要投入时间去真正享受它，一开始并不好玩。我认为一旦你习惯了，它就会有回报。</li><li id="7596" class="ny nz ji lr b ls ol lv om ly on mc oo mg op mk od oe of og bi translated">在传统的典型GIS工作流中，单击按钮并保存项目文件，使用git是不合适的。项目文件，如。qgz或者。mxd包含布局配置、层顺序等琐碎信息。这对于结果信息来说是不重要的。</li><li id="1572" class="ny nz ji lr b ls ol lv om ly on mc oo mg op mk od oe of og bi translated">为了更复杂的方法，我们牺牲了点击按钮的便利性。通常要花更多的时间来写东西并使之正式化。虽然word文档可能足够方便，但它不一定是可复制的。在这里，有了模型和git，我们甚至可以使用Docker来形式化模型，并确保机器的环境需要理解linux OS和bash脚本！但是，什么是码头工人和巴什，我说的对吗？另一篇文章的故事。</li></ul><p id="fe86" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">最终，它的价值是要付出代价的。它的价值取决于每个团队；但是大多数时候，我发现这样做是值得的，尤其是当事情需要谨慎和复杂的时候。有这样的保证肯定感觉很好。</p><h2 id="db62" class="nm ky ji bd kz nn no dn ld np nq dp lh ly nr ns lj mc nt nu ll mg nv nw ln nx bi translated">注意</h2><p id="77a5" class="pw-post-body-paragraph lp lq ji lr b ls lt kj lu lv lw km lx ly lz ma mb mc md me mf mg mh mi mj mk im bi translated">对于那些熟悉编程尤其是python的人，我最初想把Jupyter Notebook和Python脚本与<code class="fe oh oi oj ok b">pyqgis</code>、<code class="fe oh oi oj ok b">arcpy</code>或<code class="fe oh oi oj ok b">shapely</code>放在一起。然而，在我重复了这篇文章之后，对于一篇单独的文章来说，这似乎是一个太多的主题了；此外，它与那些不写剧本的人没有关系。我认为Git已经够可怕的了，因为它已经使用了终端，但是我希望这篇文章可以作为那些想要解决文档问题的人的入门和第一个参考。我呼吁人们更多地使用终端。</p><p id="6dcd" class="pw-post-body-paragraph lp lq ji lr b ls ml kj lu lv mm km lx ly mn ma mb mc mo me mf mg mp mi mj mk im bi translated">因此，下一篇文章将讨论笔记本和脚本如何改进这些文档过程。这更有趣，也是我一直做的事情。我很少在ArcGIS / QGIS中进行空间分析，因为我无法有效地控制文档。</p></div></div>    
</body>
</html>