<html>
<head>
<title>Which models require normalized data?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">哪些模型需要规范化数据？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/which-models-require-normalized-data-d85ca3c85388#2022-06-12">https://towardsdatascience.com/which-models-require-normalized-data-d85ca3c85388#2022-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="997d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于需要预处理数据的模型的简要概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/143caf137c058d0a620cc54cba8ccba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uiLU04hG9IKT4y1Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c977" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据预处理是每个机器学习项目的重要组成部分。应用于数据的一个非常有用的转换是规范化。有些型号要求它必须正常工作。让我们看看其中的一些。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="26eb" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">什么是正常化？</h1><p id="b4fc" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">标准化是一个与变量缩放比例相关的通用术语。缩放将一组变量转换为一组具有相同数量级的新变量。它通常是线性变换，因此不会影响特征的相关性或预测能力。</p><p id="78a1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为什么我们需要规范化我们的数据？因为有些模型对特征的数量级很敏感。例如，如果一个特征的数量级等于1000，而另一个特征的数量级等于10，则一些模型可能“认为”第一个特征比第二个特征更重要。这显然是一种偏见，因为数量级并没有给我们任何关于预测能力的信息。因此，我们需要通过转换变量，使它们具有相同的数量级来消除这种偏差。这就是缩放变换的作用。</p><p id="3672" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此类转换可以是标准化(将每个变量转换为0–1区间)和标准化(将每个变量转换为0均值和单位方差变量)。我在另一篇文章中广泛地谈到了这些转变。根据我的经验，标准化工作得更好，因为如果有异常值，它不会收缩变量的概率分布，例如，标准化会收缩。因此，我将在整篇文章中谈论标准化。</p><h1 id="e463" class="mb mc it bd md me mz mg mh mi na mk ml jz nb ka mn kc nc kd mp kf nd kg mr ms bi translated">需要规范化的模型</h1><p id="e0c3" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我们来看看一些需要在训练前进行缩放的模型。对于下面的例子，我将使用Python代码和scikit-learn的Pipeline对象，它在应用模型之前执行一系列转换，并返回一个可以像模型本身一样调用的对象。</p><p id="8b4c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将要使用的缩放函数是标准化函数，由<em class="ne"> StandardScaler </em>对象执行。</p><h1 id="8be6" class="mb mc it bd md me mz mg mh mi na mk ml jz nb ka mn kc nc kd mp kf nd kg mr ms bi translated">线性模型</h1><p id="602b" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">除了线性回归，所有的线性模型实际上都需要归一化。Lasso、Ridge和Elastic Net回归是强大的模型，但它们需要标准化，因为所有变量的惩罚系数都是相同的。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="77b0" class="nk mc it ng b gy nl nm l nn no">lasso = make_pipeline(StandardScaler(), Lasso()) </span><span id="d183" class="nk mc it ng b gy np nm l nn no">ridge = make_pipeline(StandardScaler(), Ridge()) </span><span id="03c6" class="nk mc it ng b gy np nm l nn no">en = make_pipeline(StandardScaler(), ElasticNet())</span></pre><p id="39c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">逻辑回归也需要标准化，以避免在训练阶段出现梯度消失的问题。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ee68b59bc2f143b9d42f922b808ba2b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Byp_NtvAb_vEX43C.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逻辑回归。作者图片</p></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="0ce8" class="nk mc it ng b gy nl nm l nn no">logistic = make_pipeline(StandardScaler(), LogisticRegression())</span></pre><p id="53ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您在没有预先规范化的情况下训练线性回归，则不能使用系数作为要素重要性的指标。如果您需要执行要素重要性(例如，用于降维目的)，则必须提前对数据集进行规范化，即使您使用的是简单的线性回归。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="6883" class="nk mc it ng b gy nl nm l nn no">lr = make_pipeline(StandardScaler(), LinearRegression())</span></pre><h1 id="0032" class="mb mc it bd md me mz mg mh mi na mk ml jz nb ka mn kc nc kd mp kf nd kg mr ms bi translated">支持向量机</h1><p id="1f07" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">支持向量机是基于距离的强大模型。他们试图在特征的向量空间中找到一个超平面，该超平面能够根据目标变量的值线性地分离训练记录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/b8a82cb7480369dcb88711622a1e30c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/0*ScgOPgkJ-XEmDChW.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">SVM的例子。作者图片</p></figure><p id="ce78" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">经过一些修改，SVM甚至可以用于非线性函数和回归目的。</p><p id="788b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于距离对要素的数量级非常敏感，因此也有必要对SVM应用缩放变换。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="e538" class="nk mc it ng b gy nl nm l nn no">svm_c = make_pipeline(StandardScaler(), LinearSVC()) # For classification </span><span id="1140" class="nk mc it ng b gy np nm l nn no">svm_r = make_pipeline(StandardScaler(), LinearSVR()) # For regression</span></pre><h1 id="3d45" class="mb mc it bd md me mz mg mh mi na mk ml jz nb ka mn kc nc kd mp kf nd kg mr ms bi translated">k近邻</h1><p id="c55f" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">KNN是一种非常流行的基于距离(通常是欧几里德距离)的算法。预测考虑了要素空间中给定点的k个最近邻。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/04420deb3ea4662be84f59b5305372a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R2xsolyrijOjXqbh.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k-最近邻。作者图片</p></figure><p id="b5a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就像SVM一样，即使是KNN也需要使用规范化数据。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="3a85" class="nk mc it ng b gy nl nm l nn no">knn_c = make_pipeline(StandardScaler(), KNeighborsClassifier()) # For classification </span><span id="9e8b" class="nk mc it ng b gy np nm l nn no">knn_r = make_pipeline(StandardScaler(), KNeighborsRegressor()) # For regression</span></pre><h1 id="299d" class="mb mc it bd md me mz mg mh mi na mk ml jz nb ka mn kc nc kd mp kf nd kg mr ms bi translated">神经网络</h1><p id="bd0a" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">最后，神经网络对特征的数量级非常敏感。激活函数总是需要归一化的数据，否则训练阶段将遭受消失梯度问题，就像逻辑回归一样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ea4eeceb8fe20b2226a8feef9157f6a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/0*JB1B_wpR0WL_u6QO.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">神经网络。作者图片</p></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="e7f5" class="nk mc it ng b gy nl nm l nn no">nn_c = make_pipeline(StandardScaler(), MLPClassifier()) # For classification </span><span id="a167" class="nk mc it ng b gy np nm l nn no">nn_r = make_pipeline(StandardScaler(), MLPRegressor()) # For regression</span></pre><h1 id="5c1d" class="mb mc it bd md me mz mg mh mi na mk ml jz nb ka mn kc nc kd mp kf nd kg mr ms bi translated">结论</h1><p id="f20c" class="pw-post-body-paragraph ky kz it la b lb mt ju ld le mu jx lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">缩放是一个非常重要的预处理变换，它可以极大地影响训练阶段。如果执行不当，模型的结果肯定是不可靠的。这就是为什么当模型需要时，使用适当的规范化技术是很重要的。</p><p id="ea15" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你对我在这篇文章中谈到的模型感兴趣，我在我的<a class="ae my" href="http://yourdatateacher.com/supervised-machine-learning-in-python-online-course/" rel="noopener ugc nofollow" target="_blank">Python中的监督机器学习</a>在线课程中广泛地谈到了它们。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="e3d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ne">原载于2022年6月12日</em><a class="ae my" href="https://www.yourdatateacher.com/2022/06/13/which-models-require-normalized-data/" rel="noopener ugc nofollow" target="_blank"><em class="ne">【https://www.yourdatateacher.com】</em></a><em class="ne">。</em></p></div></div>    
</body>
</html>