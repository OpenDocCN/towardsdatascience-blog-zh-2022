<html>
<head>
<title>How to Use an API Without Coding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在不编码的情况下使用 API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-an-api-without-coding-44a324a7c560#2022-11-23">https://towardsdatascience.com/how-to-use-an-api-without-coding-44a324a7c560#2022-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7695" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对于没有任何编码经验的用户，这是一个使用 Google Sheets 连接到任何 API 的无代码方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8bd2d7aa0a7caae2a559b861d92a07af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3Ism2dtpz4elm_kc"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">约纳斯·勒普在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="f56f" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在计算机科学中，应用编程接口(API)是几个程序相互通信的一种方式。</p><p id="7ef5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果你的编码经验有限，可能你自己都没用过。然而，你可以确定你的智能手机或电脑上的应用程序正在使用 API。</p><p id="a19d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">即使你是一个人，你也可以找到许多有趣的 API，它们可以提高你的生产力，带来一些乐趣或者只是解决你的一些日常问题。</p><p id="d902" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在本文中，我将分享两种方法来连接并自动从 API 获取数据，而无需使用 Google Sheets 编写代码。</p><p id="15ff" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">💌新文章免费直入你的收件箱:<a class="ae kv" href="https://www.samirsaci.com/#/portal/signup" rel="noopener ugc nofollow" target="_blank">时事通讯</a></p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="1458" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果你喜欢观看，可以看看这个教程的视频版本</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="4f24" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">如何不用编码连接一个 API？</h1><h2 id="d084" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">最终解决方案</h2><p id="4b1a" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">最终的解决方案将看起来像下面的动画 GIF。通过电子表格软件(Google Sheets 或 Excel)中的一个简单公式，你可以从任何 API 中提取数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1d6ceb19f82968288cb59459aa9b9860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*96YNZF1GNe1iwDsbAl2__w.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">演示—(图片由作者提供)</p></figure><h2 id="9c8e" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">例子</h2><p id="9854" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">在本文中，我将使用一个非常酷的 API FruityVice 来提供关于水果的信息。</p><p id="5b3f" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">查看<a class="ae kv" href="https://www.fruityvice.com/" rel="noopener ugc nofollow" target="_blank">文档</a>了解更多信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/e2e768963cea9a5bb75d1f8f3c56a3a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*Hb6R4vbC-g68cWYubeWXDg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="bb6c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在第一栏中，您可以找到我们想要了解的水果清单。我们调用 API 来获取:</p><ul class=""><li id="a11c" class="nm nn iq lf b lg lh lj lk lm no lq np lu nq ly nr ns nt nu bi translated">第一列中的姓氏</li><li id="3a3a" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">第二栏是脂肪含量</li><li id="272a" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">第三列中的糖量</li></ul><p id="b7eb" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">然后，我们只需要放一个公式来调用单元格 B2 中的 API，并沿着列拖动它以获得完整的范围。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="387e" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">履行</h1><h2 id="f243" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">调用 API，获得响应并过滤</h2><p id="59d0" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">为了调用 API，您需要按照下面的语法向 API 发送 get 请求。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/be48031690a59a4a5f0754b286509239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_L67NtrJ8jCNZ9Awz4Wx9Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">API 调用—(图片由作者提供)</p></figure><p id="39ed" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">它不需要任何 API 键，因此我以它为例:</p><ul class=""><li id="4052" class="nm nn iq lf b lg lh lj lk lm no lq np lu nq ly nr ns nt nu bi translated">蓝色部分是网站的地址:你可以去那里查看文档</li><li id="dac2" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">红色部分将让您访问 API</li><li id="2e93" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">橙色部分是您需要唯一输入参数的地方:英文水果名称</li></ul><p id="4360" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">它将以 JSON 格式返回一个响应，</p><pre class="kg kh ki kj gt ob oc od bn oe of bi"><span id="f30d" class="og mc iq oc b be oh oi l oj ok">{<br/> “genus”: “Musa”,<br/> “name”: “Banana”,<br/> “id”: 1,<br/> “family”: “Musaceae”,<br/> “order”: “Zingiberales”,<br/> “nutritions”: {<br/> “carbohydrates”: 22,<br/> “protein”: 1,<br/> “fat”: 0.2,<br/> “calories”: 96,<br/> “sugar”: 17.2<br/> }<br/> }</span></pre><p id="d22c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们需要理解 API 响应的构造方式来提取我们想要的信息，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/15d9b02adfd3a7b249b62ff39de8dc78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ngZaO1MY8rRXDEqS-LrWNw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">API JSON 响应—(图片由作者提供)</p></figure><p id="5103" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们感兴趣的是，</p><ul class=""><li id="73bf" class="nm nn iq lf b lg lh lj lk lm no lq np lu nq ly nr ns nt nu bi translated">【家庭】:水果</li><li id="95f8" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">“营养/脂肪”:脂肪量</li><li id="413b" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">“营养/糖”:糖的数量</li></ul><h2 id="98f2" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">添加一个函数来读取 JSON: importJSON</h2><p id="caf1" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">为了执行查询和解析 JSON，我们将在<a class="ae kv" href="https://gist.github.com/paulgambill/cacd19da95a1421d3164?ref=hackernoon.com" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>中导入一个由<strong class="lf ir"> paulgambil </strong>共享的函数。<em class="om">(请为这个非常有用的功能:D 给他一颗星)</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/5a759ee1845830f0391cda1ab701bab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Ro6OOY1NWl4j11tIzNDU-w.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按照步骤操作—(图片由作者提供)</p></figure><ul class=""><li id="86c4" class="nm nn iq lf b lg lh lj lk lm no lq np lu nq ly nr ns nt nu bi translated">从 GitHub 库中获取代码并复制它</li><li id="e998" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">转到谷歌表单的扩展菜单</li><li id="0e50" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">创建一个新脚本，并将其命名为 importJSON.gs</li></ul><p id="49df" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在你的函数<em class="om"> importJSON </em>可用了。</p><h2 id="ed83" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">解析 API JSON 响应</h2><p id="a972" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated"><strong class="lf ir">编写查询<br/> </strong>现在可以开始编写单元格中的公式 B2、</p><pre class="kg kh ki kj gt ob oc od bn oe of bi"><span id="8436" class="og mc iq oc b be oh oi l oj ok">=importJSON("https://www.fruityvice.com/api/fruit/"&amp;A2;"/family,/nutritions/fat,/nutritions/sugar"; "noHeaders,Truncate")</span></pre><pre class="on ob oc od bn oe of bi"><span id="30c9" class="og mc iq oc b be oh oi l oj ok">- We take the fruit name in the cell A2<br/>/family, nutritions/fat, nutritions/sugar: specify the three information we want to get from the API response</span></pre><p id="15dc" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">拖动公式<br/> </strong>，拖动到列尾后，函数 importJSON 会自动粘贴右边单元格中的值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1d6ceb19f82968288cb59459aa9b9860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*96YNZF1GNe1iwDsbAl2__w.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">整个过程—(图片由作者提供)</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="7454" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">你可以在我的 Youtube 频道上找到更多的生产力技巧和 google sheets 教程</p><div class="oo op gp gr oq or"><a href="https://youtube.com/@productivedata" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd ir gy z fp ow fr fs ox fu fw ip bi translated">生产数据</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">在这个频道，我分享了如何使用数据分析、python 或任何其他编程语言来自动化无聊的技巧…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">youtube.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf kp or"/></div></div></a></div></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="298d" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">后续步骤</h1><p id="0304" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">关注我的媒体，获取更多与数据分析和供应链管理相关的文章</p><h2 id="8bcc" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">从 URL 导入表</h2><p id="d6f6" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">在这个简短的教程中，我分享了另一种从 URL 中提取数据的方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><h2 id="6754" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">为什么不 Excel？</h2><p id="35f1" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">Excel 有自己的函数来执行名为 WEBSERVICE 的 API 查询。但是没有内置函数解析 JSON 响应，所以你得想办法只用 Excel 公式来做(我个人不会)。</p><p id="3928" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">因此，我更愿意使用 Google Sheets。</p><h2 id="07dd" class="mt mc iq bd md mu mv dn mh mw mx dp ml lm my mz mn lq na nb mp lu nc nd mr ne bi translated">用例</h2><p id="9deb" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">既然您可以使用 Google sheets 查询任何 API，那么您可以:</p><ul class=""><li id="14a1" class="nm nn iq lf b lg lh lj lk lm no lq np lu nq ly nr ns nt nu bi translated">使用距离矩阵或地理编码 API 计算位置之间的距离</li><li id="6cd1" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">使用谷歌翻译 API 翻译任何单词</li><li id="91ec" class="nm nn iq lf b lg nv lj nw lm nx lq ny lu nz ly nr ns nt nu bi translated">从像 pixabay 这样的股票服务中获取任何带有图片的图像</li></ul><h1 id="f000" class="mb mc iq bd md me pg mg mh mi ph mk ml jw pi jx mn jz pj ka mp kc pk kd mr ms bi translated">关于我</h1><p id="24c5" class="pw-post-body-paragraph ld le iq lf b lg nf jr li lj ng ju ll lm nh lo lp lq ni ls lt lu nj lw lx ly ij bi translated">让我们在<a class="ae kv" href="https://www.linkedin.com/in/samir-saci/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>和<a class="ae kv" href="https://twitter.com/Samir_Saci_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上连线，我是一名<a class="ae kv" href="https://www.samirsaci.com/about/" rel="noopener ugc nofollow" target="_blank">供应链工程师</a>，正在使用数据分析来改善物流运营并降低成本。</p><p id="5724" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果你对数据分析和供应链感兴趣，可以看看我的网站</p><div class="oo op gp gr oq or"><a href="https://samirsaci.com" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd ir gy z fp ow fr fs ox fu fw ip bi translated">Samir Saci |数据科学与生产力</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">专注于数据科学、个人生产力、自动化、运筹学和可持续发展的技术博客</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">samirsaci.com</p></div></div><div class="pa l"><div class="pl l pc pd pe pa pf kp or"/></div></div></a></div></div></div>    
</body>
</html>