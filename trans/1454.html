<html>
<head>
<title>An Introduction to Exceedance Probability Forecasting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超越概率预测导论</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-exceedance-probability-forecasting-4c96c0e7772c#2022-04-10">https://towardsdatascience.com/an-introduction-to-exceedance-probability-forecasting-4c96c0e7772c#2022-04-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="15cb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python预测时间序列中极值出现的概率</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1d0199f7b4073b042c5ef17f38750fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ovcJA2hKoASQ8Sle"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让-丹尼尔·卡拉姆在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="089b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">超越概率预测</strong>是估计一个时间序列在预定义的未来时期内超过预定义阈值的概率的问题。</p><p id="3ea4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在前一篇<a class="ae ky" href="https://vcerq.medium.com/6-time-series-predictive-tasks-you-should-know-about-b899fb83b6bf" rel="noopener">文章</a>中，我简要描述了时间序列数据出现的6个问题，包括超越概率预测。在这里，我将更深入地研究这项任务。在一些基本的定义之后，我将解释为什么这个问题很重要，以及如何使用Python在你自己的时间序列中应用它。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/504e14dd65dea6ba904095c4e40b997f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MKLVzhFPsRVr6YkKxU0zOg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:海浪高度时间序列。预测它是否超过预定义的阈值(红色虚线)对于确保海上作业的安全非常重要。图片作者。</p></figure><p id="5208" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">超越概率预测与许多领域相关，例如经济学。央行依赖于对通胀率是否会超过某个阈值的估计。如果这种可能性很高，那么央行可能会通过提高利率来应对。</p><p id="b1fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">本质上，这个问题在极端值(即分布的尾部)高度相关的情况下很重要。</strong>另一个例子如图1所示，与海洋数据分析相关。短期预测海浪高度对于估算发电量非常重要。但是大浪会对海上作业的安全造成威胁(例如船只的安全通行)，因此预测大浪非常重要。</p><p id="7763" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">概率输出是可取的，因为它携带更多的信息来支持决策，特别是当风险很高时。虽然很可能不会下雨，但预报“有10%的可能性会下雨”比简单地说“不会下雨”更能提供信息。厌恶风险的人可能热衷于拿一把雨伞。</strong></p><h1 id="c2d3" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">把手放在某物或者某人身上</h1><p id="543c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">有两种主要方法可用于解决超越概率问题:二元分类或预测集合。让我们对这两个选项进行概述和编码。</p><h2 id="3b07" class="na me it bd mf nb nc dn mj nd ne dp mn li nf ng mp lm nh ni mr lq nj nk mt nl bi translated">二元分类</h2><p id="cb89" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">超越与二元事件有关。因此，<strong class="lb iu">模拟超越概率最自然的方法是将问题框架化为二元分类</strong>问题。解释变量代表最近过去的观察，以及你可能有的任何额外变量。目标变量是二进制的，指示事件是否发生，即是否超过阈值。然后，我们可以使用概率分类器(如逻辑回归)来估计超标概率。</p><p id="d335" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个Python模型可以做到这一点。我将使用一个与波高相关的时间序列，你可以在这里得到<a class="ae ky" href="https://data.gov.ie/dataset/smartbay-ireland-cork-buoy-wave/resource/e58ebc3e-edcc-4bb8-9cc2-112da4465477" rel="noopener ugc nofollow" target="_blank"/>。您可以在图1中看到部分时间序列。为了简洁起见，我将跳过基本的时间序列预处理。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">脚本1:为超标概率预测创建二元分类模型的代码模型</p></figure><p id="8fd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从读取数据和转换<em class="no"> pd的时间序列开始。Series </em> type)转换成一组我们可以输入学习算法的观察值(第8-21行)。然后，我们将数据分为训练和测试(第24行)，并将阈值设置为第95个<em class="no">百分点(第27行)。我们任意设置阈值，但是这个值强烈依赖于数据集。使用阈值创建二元响应变量(第30-31行)，然后训练分类器(第34-35行)。最后，我们在第38行中检索检验观测值的超越概率。</em></p><h2 id="066d" class="na me it bd mf nb nc dn mj nd ne dp mn li nf ng mp lm nh ni mr lq nj nk mt nl bi translated">预测集合</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4d1505000c7a65ec383228109b72c08f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AyKWdOD2ZY2bmA85"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@kazuend?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> kazuend </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="cb23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类方法的替代方法是使用预测集合。本质上，我们训练几个预测模型来预测时间序列的未来值。然后，<strong class="lb iu">我们可以通过计算预测值超过阈值的模型的比率来估计超过概率。</strong></p><p id="8607" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于集合的方法在与环境科学相关的领域中很常见，例如气象学或水文学。在这些领域中，通过改变初始条件来建立不同的模型。在机器学习中，我们可以做到这一点，例如，通过使用不同的学习算法或不同的训练集。</p><p id="9ace" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个创建预测集合的模型。在这种情况下，我们将使用随机森林，它在不同的训练集上训练几个决策树。这是上一个脚本的延续，所以我将直接开始创建模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">剧本2:剧本1的延续。为超越概率预测创建回归预测集合的代码模型</p></figure><p id="0b4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们创建预测集合(第1-8行)。请注意，我们现在使用数字响应变量来表示序列的下一个值。然后(第11-12行)，我们检索每个系综成员的数值预测(在这种情况下，是一棵树)。最后，在第15行计算超越概率。</p><h2 id="f840" class="na me it bd mf nb nc dn mj nd ne dp mn li nf ng mp lm nh ni mr lq nj nk mt nl bi translated">评估预测</h2><p id="d8fc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们可以使用AUC(ROC曲线下面积)或Brier评分等指标来评估每种方法。这些衡量概率预测的准确性。请看下面的脚本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">脚本3:评估概率预测的准确性</p></figure><h1 id="6425" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">每种方法的优缺点</h1><p id="7997" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">根据输入数据集，这些方法中的一种可能会执行得更好。但是，除了性能之外，还有其他方面需要考虑，使这些策略中的一个相对于另一个更可取。</p><p id="b372" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相对于分类器，通过集成采用回归方法具有两个主要优点。第一个是<strong class="lb iu">集成模型</strong>,因为集合的预测不仅可以用于估计超越概率，还可以用于估计时间序列的未来值。第二个优点是<strong class="lb iu">阈值</strong> <strong class="lb iu">灵活性</strong>因为这个参数不是事先固定的。分类方法在训练期间固定阈值，并且不能为了推断而改变。另一方面，回归模型遵循关于阈值的懒惰方法。因此，在给定时刻，我们可以使用相同的模型来估计不同阈值的超越概率。这使我们能够绘制如图2所示的超越概率曲线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/59d24741105392510e2263147f2366f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o7Qp8oGZwcS74plXtKmS3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:超越概率曲线，给出了不同阈值的超越概率。图片作者。</p></figure><p id="32a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，众所周知，集成方法的计算量<strong class="lb iu">很大</strong>，这阻碍了它们在许多领域的应用。</p><h1 id="050b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">扩展ˌ扩张</h1><h2 id="bc2e" class="na me it bd mf nb nc dn mj nd ne dp mn li nf ng mp lm nh ni mr lq nj nk mt nl bi translated">峰值超过阈值(POT)</h2><p id="e98f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">超越概率预测的一个相关问题是峰值超过阈值分析。但是，峰值超过阈值方法的目标不是试图预测超出事件，而是研究超出阈值的观测值的统计特性。</p><h2 id="362d" class="na me it bd mf nb nc dn mj nd ne dp mn li nf ng mp lm nh ni mr lq nj nk mt nl bi translated">超越一个门槛</h2><p id="b0dd" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">虽然超越概率预测通常指二元事件(无论超越是否发生)，但也可以定义多个阈值。</p><p id="41e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这方面的一个例子是在定量交易中使用的三重屏障方法。股票市场交易者可能对根据价格变动预测买入、卖出或持有信号感兴趣。在预测价格回报方面超过正阈值可以用作买入信号；相反(预测价格回报低于负阈值)可以代表卖出触发。如果没有一个阈值被满足，那么交易者应该持有当前的头寸。</p><h1 id="701d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">外卖</h1><ul class=""><li id="8aed" class="nq nr it lb b lc mv lf mw li ns lm nt lq nu lu nv nw nx ny bi translated">超越概率预测是估计一个时间序列在一个预先定义的未来时期内超越一个预先定义的阈值的概率的过程；</li><li id="ee5b" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">这个问题与极端值对预测很重要的情况有关；</li><li id="0986" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">解决这一任务有两种主要方法:二元分类模型或预测集合。各有利弊。</li></ul><h2 id="96c5" class="na me it bd mf nb nc dn mj nd ne dp mn li nf ng mp lm nh ni mr lq nj nk mt nl bi translated">进一步阅读</h2><p id="e205" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">[1]泰勒、詹姆斯·w .和余克明。"利用自回归logit模型预测金融风险管理的超越概率."<em class="no">《英国皇家统计学会杂志:A辑(社会中的统计学)</em>179.4(2016):1069–1092。</p><p id="9484" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] Méndez，Fernando J .等人，“使用与时间相关的峰值超过阈值(pot)模型对极端显著波高的长期可变性进行估计。”<em class="no">地球物理研究杂志:海洋</em> 111。C7 (2006年)。</p></div></div>    
</body>
</html>