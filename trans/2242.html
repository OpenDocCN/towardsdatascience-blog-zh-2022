<html>
<head>
<title>5 Different Ways To Save Your Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保存机器学习模型的5种不同方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-different-ways-to-save-your-machine-learning-model-b7996489d433#2022-05-18">https://towardsdatascience.com/5-different-ways-to-save-your-machine-learning-model-b7996489d433#2022-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="922f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">简化重用模型的过程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e57e65cb37b42f8bc7e479a330075223.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gY7bB8qDMsUrPY4V"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@thefredyjacob?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">弗雷迪·雅各布</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="ce21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存经过训练的机器学习模型是机器学习工作流程中的一个重要步骤:它允许您在将来重用它们。例如，您很可能必须比较模型，以确定投入生产的冠军模型——在模型经过培训后保存模型会使这一过程更容易。</p><p id="1eb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种方法是在每次需要使用模型时对其进行训练，这可能会极大地影响生产率，尤其是在模型需要长时间训练的情况下。</p><p id="6a76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本帖中，我们将介绍5种不同的方法来保存你训练过的模型。</p><h1 id="62f4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">头号泡菜</h1><p id="dee6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Pickle是Python中最流行的序列化对象的方法之一；你可以用Pickle把你训练好的机器学习模型序列化，保存到一个文件里。稍后或在另一个脚本中，您可以反序列化该文件以访问定型模型并使用它进行预测。</p><p id="c23a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我创建的用于保存模型管道的实用函数，我还将在培训管道中演示它的功能:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="3098" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看这在我们的培训管道脚本中是如何工作的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="b3e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以看到我们在第50行调用了<code class="fe mu mv mw mx b">save_pipeline</code>实用函数。</p><p id="880e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了加载管道，我创建了另一个名为<code class="fe mu mv mw mx b">load_pipeline</code>的实用函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="211d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的预测脚本中，我们将管道加载到一个名为<code class="fe mu mv mw mx b">_fraud_detection_pipe</code>的变量中:我们现在可以使用这个变量作为我们训练的管道对象的实例来进行预测。让我们看看剧本的其余部分…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="762c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="my">注</em> </strong> <em class="my">:第14行加载训练好的模型。</em></p><h1 id="2045" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">#2工作库</h1><p id="a543" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Joblib是pickle的替代工具，我们可以用它来保存[和加载]我们的模型。它是SciPy生态系统的一部分，在携带大型NumPy数组的对象上更有效——在这个<a class="ae ky" href="https://stackoverflow.com/questions/12615525/what-are-the-different-use-cases-of-joblib-versus-pickle#:~:text=joblib%20is%20usually,zlib%20or%20lz4." rel="noopener ugc nofollow" target="_blank"> StackOverflow讨论</a>中了解更多关于Joblib的好处。</p><blockquote class="mz"><p id="d0a7" class="na nb it bd nc nd ne nf ng nh ni lu dk translated">“Joblib是一套工具，用于在Python中提供轻量级流水线操作。特别是:函数的透明磁盘缓存和惰性重求值(memoize模式)简单易行的并行计算。”<br/> — <strong class="ak">来源</strong> : <a class="ae ky" href="https://joblib.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> Joblib文档</a></p></blockquote><p id="58f3" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">为了用Joblib保存我们的模型，我们只需要对我们的<code class="fe mu mv mw mx b">save_pipeline()</code>函数进行修改。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="1e25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们有重要的<code class="fe mu mv mw mx b">joblib</code>而不是<code class="fe mu mv mw mx b">pickle</code>，在第16行，我们用<code class="fe mu mv mw mx b">joblib</code>序列化了我们的模型管道。</p><p id="ca2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="my">注</em> </strong> <em class="my">:有兴趣的读者可以在我的</em><a class="ae ky" href="https://github.com/kurtispykes/fraud-detection-project" rel="noopener ugc nofollow" target="_blank"><em class="my">GitHub</em></a><em class="my">上看到完整代码。</em></p><h1 id="fc8e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第三名JSON</h1><p id="a8b7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">另一种保存模型的方法是使用JSON。与Joblib和Pickle不同，JSON方法不一定会直接保存拟合的模型，而是保存构建模型所需的所有参数——当需要完全控制保存和恢复过程时，这是一个好方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="a566" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="my">注</em> </strong> <em class="my">:有兴趣的读者不妨详细了解一下</em> <a class="ae ky" href="https://medium.com/geekculture/inheritance-getting-to-grips-with-oop-in-python-2ec35b52570#:~:text=the%20super()%20function.-,The%20super()%20function,-The%20super()" rel="noopener"> <em class="my">继承</em> </a> <em class="my">来了解我们是如何构建这个类的。</em></p><p id="909f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以在我们的<code class="fe mu mv mw mx b">MyLogisticRegression</code>实例上调用<code class="fe mu mv mw mx b">save_json()</code>方法来保存参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="dc0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在另一个脚本中调用它，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="6411" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用所有这些数据来重现之前构建的模型。</p><h1 id="45b9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第四名PMML</h1><p id="5efb" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">预测模型标记语言(PMML)是从业者用来保存他们的机器学习模型的另一种格式。它比Pickle健壮得多，因为PMML模型不依赖于创建它们的类——这与Pickle模型不同。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="0e7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以如下加载模型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="6984" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第五名Tensorflow Keras</h1><p id="bd51" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Tensorflow Keras可用于将Tensorflow模型保存到<code class="fe mu mv mw mx b">SavedModel</code>或<code class="fe mu mv mw mx b">HDF5</code>文件。</p><p id="f384" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们建立一个简单的模型，并用Tensorflow Keras保存它—首先，我们将从生成一些训练数据开始。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="fb62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们建立一个序列模型:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="6ad0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面代码的第16行，我们在顺序模型实例上使用了<code class="fe mu mv mw mx b">save()</code>方法，并传递了一个路径到我们想要保存模型的目录。</p><p id="30d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了加载模型，我们简单地在<code class="fe mu mv mw mx b">models</code>对象上使用了<code class="fe mu mv mw mx b">load_model()</code>方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="1ccf" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">包裹</h1><p id="0781" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们讨论了保存机器学习模型的5种不同方法。记录用于构建模型的Python版本以及所用库的版本也很重要-这些数据将简化重新创建模型构建环境的过程，以便日后可以重现它们。</p><p id="4c7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="my">感谢阅读。</em></p><p id="732e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">联系我:</strong><br/><a class="ae ky" href="https://www.linkedin.com/in/kurtispykes/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a><br/><a class="ae ky" href="https://twitter.com/KurtisPykes" rel="noopener ugc nofollow" target="_blank">Twitter</a><br/><a class="ae ky" href="https://www.instagram.com/kurtispykes/" rel="noopener ugc nofollow" target="_blank">insta gram</a></p><p id="69b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并希望支持我的写作，可以考虑成为一名灵媒。每月支付5美元，你就可以无限制地阅读媒体上的故事。如果你使用<a class="ae ky" href="https://kurtispykes.medium.com/membership" rel="noopener">我的注册链接</a>，我会收到一小笔佣金。</p><p id="d150" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">已经是会员了？<a class="ae ky" href="https://kurtispykes.medium.com/subscribe" rel="noopener">订阅</a>在我发布时得到通知。</p><div class="no np gp gr nq nr"><a href="https://kurtispykes.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">每当Kurtis Pykes发表文章时都收到一封电子邮件。</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">每当Kurtis Pykes发表文章时都收到一封电子邮件。通过注册，您将创建一个中型帐户，如果您还没有…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">kurtispykes.medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div></div></div>    
</body>
</html>