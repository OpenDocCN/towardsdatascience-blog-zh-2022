<html>
<head>
<title>How to Build a Bayesian Ridge Regression Model with Full Hyperparameter Integration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立全超参数整合的贝叶斯岭回归模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-a-bayesian-ridge-regression-model-with-full-hyperparameter-integration-f4ac2bdaf329#2022-02-23">https://towardsdatascience.com/how-to-build-a-bayesian-ridge-regression-model-with-full-hyperparameter-integration-f4ac2bdaf329#2022-02-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="75d2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们如何处理控制正则化强度的超参数？</h2></div><p id="c19e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博文中，我们将描述一种贝叶斯岭回归算法，其中代表正则化强度的超参数被完全积分。在<a class="ae lc" href="https://github.com/rnburn/bbai" rel="noopener ugc nofollow" target="_blank"><em class="lb">【github.com/rnburn/bbai】</em></a><em class="lb">有一个实现。</em></p><p id="2345" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设<strong class="kh ir"> θ </strong> = (σ，<strong class="kh ir"> w </strong>)表示具有权重<strong class="kh ir"> w </strong>和方差σ的正态分布误差的线性回归模型的参数。</p><p id="504d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果<strong class="kh ir"> X </strong>表示具有p个回归量<br/>和n行的满秩n×p矩阵，则<strong class="kh ir"> θ </strong>指定可能的<br/>目标值<strong class="kh ir"> y </strong>的概率分布</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/ec11d6bebc9e483d7761302a93c0a0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjgbAebQOcEBqSJuWois9A@2x.png"/></div></div></figure><p id="2ffc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们观察到<strong class="kh ir"> y </strong>并假设<strong class="kh ir"> y </strong>是由未知参数的线性模型产生的。贝叶斯推理方法寻求量化我们对给定观测值的未知参数<strong class="kh ir"> θ </strong>的信念。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/8a97bb7bf1667a0a82d0e89279f3575e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dx1iOuM9hAHcyDERfC4F0g@2x.png"/></div></div></figure><p id="d296" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">应用贝叶斯定理，我们可以将概率改写为</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/5132775cd4206995a3ea5e88d627946b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*micV_ZRGAv6uAiCwBDIEag@2x.png"/></div></div></figure><p id="e0a7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们指的是</p><ul class=""><li id="c6c1" class="lp lq iq kh b ki kj kl km ko lr ks ls kw lt la lu lv lw lx bi translated">P( <strong class="kh ir"> θ </strong> | <strong class="kh ir"> y </strong>)作为后验分布</li><li id="06db" class="lp lq iq kh b ki ly kl lz ko ma ks mb kw mc la lu lv lw lx bi translated">P( <strong class="kh ir"> y </strong> | <strong class="kh ir"> θ </strong>)作为似然函数</li><li id="ec14" class="lp lq iq kh b ki ly kl lz ko ma ks mb kw mc la lu lv lw lx bi translated">P( <strong class="kh ir"> θ </strong>)先验分布</li></ul><p id="9c99" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">先验分布描述了我们在观察到<strong class="kh ir"> y </strong>之前对<strong class="kh ir"> θ </strong>的信念，后验分布描述了我们在观察到<strong class="kh ir"> y </strong>之后更新的信念。</p><p id="3d11" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设先验分布可以表示为</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/cae263551e672b33721a0970b3d45654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eXApF2cfAZlRGJ4DcEqwCg@2x.png"/></div></div></figure><p id="996b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中h(⋅，η) <strong class="kh ir"> </strong>表示由我们称之为超参数η参数化的概率分布族<br/>。</p><p id="3a6c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">传统的贝叶斯线性回归方法使用了所谓的<em class="lb">共轭先验</em>。一族先验h(⋅，η)是共轭的，如果后验也属于该族</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/d738efe6328fa7aabf1cd0f8010d08c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_bgQ1rvU5kOzbpqHw3o_w@2x.png"/></div></div></figure><p id="1bd3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">共轭先验在数学上是方便的，因为连续观测可以被视为对分布族的参数进行连续更新，但是要求h(⋅η是共轭的是一个强假设。</p><p id="83ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:关于与其他贝叶斯算法的更详细的比较，请参见附录A。</p><p id="3dcc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将描述一种算法，其中</p><ol class=""><li id="3d85" class="lp lq iq kh b ki kj kl km ko lr ks ls kw lt la md lv lw lx bi translated">先验被选择为收缩<strong class="kh ir"> w </strong>，反映了先前的假设，即<strong class="kh ir"> w </strong>不是<br/>预测性的，并且对于其他参数近似为<em class="lb">非信息性的</em>。</li><li id="d90c" class="lp lq iq kh b ki ly kl lz ko ma ks mb kw mc la md lv lw lx bi translated">我们在超参数上完全积分，因此不需要任意选择η。</li></ol><p id="e5b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们首先考虑一下，先验无信息意味着什么。</p><h1 id="3e0e" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">如何挑选无信息的前科？</h1><p id="fcea" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">注意:这里对非信息先验的介绍紧跟Box &amp; Tiao的书<a class="ae lc" href="https://onlinelibrary.wiley.com/doi/book/10.1002/9781118033197" rel="noopener ugc nofollow" target="_blank">统计分析中的贝叶斯推断</a>的第2章。</p><p id="b1be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设<strong class="kh ir"> y </strong>是均值为0但方差未知的正态分布产生的数据。设σ表示标准差，ℓ表示似然函数</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/9e53eba6151b56b2bc9da5c3d31894af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EAj3oTHDTC4jiLqfgLRy_Q@2x.png"/></div></div></figure><p id="c62d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们在σ上施加统一的先验，使得后验概率为</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/34f5700c7a587bc4b929b5d3c1fca1af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aC-T9TwnhoiHW18U-OyYOg@2x.png"/></div></div></figure><p id="953b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">累积分布函数是</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/202ed12ce0166c7f685dee018d96c8f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ay_BWDAndRtJEQUYcD6k9g@2x.png"/></div></div></figure><p id="0b32" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中N是某个归一化常数。</p><p id="9940" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是现在让我们假设我们用方差来代替标准差。将u=σ代入累积分布函数，我们得到</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/975492bb1dbbc403492b06be326d2b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mgZW1HC5kaDNJQWwzZz2UA@2x.png"/></div></div></figure><p id="e8d6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们看到选择σ上的一致先验等价于选择不适当的先验</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/ae44b9d81e313801ff04816089589fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JpLixHuIIJZIXqhkk9xNng@2x.png"/></div></div></figure><p id="3ae0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">超方差。一般来说，如果u=φ(θ <strong class="kh ir"> ) </strong>是参数化似然函数的另一种方式，其中φ是某种单调的一对一函数。那么u上的一致先验等价于选择一个先验</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/9125c61e8a8ab30eaf3a22ddf8225946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zVopJQbQnnJyc1vrudNnGg@2x.png"/></div></div></figure><p id="10b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">超过θ。</p><p id="e24a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，如果选择对参数化敏感，什么时候使用统一的先验有意义呢？</p><p id="0094" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们考虑观察值<strong class="kh ir"> y </strong> ^⊤ <strong class="kh ir"> y </strong>的变化是如何影响可能性的。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/33d8dfc9df6cda5b0170fe92d1268674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*0LQzX6IhcBqLW_xUTCgASQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">具有零均值、<br/> n=10和不同的<strong class="bd ng"> y </strong> ^⊤ <strong class="bd ng"> y </strong>值的正态分布数据的标准差的似然函数。</p></figure><p id="25a0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们从图中看到的，随着<strong class="kh ir"> y </strong> ^⊤ <strong class="kh ir"> y </strong>的增加，似然函数的形状发生了变化:它变得不那么尖锐并且更加分散。</p><p id="3730" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意，我们可以将似然函数改写为</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/aee340f7e760bdd7561e7f2b25ba87e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KWHIvZLfgeB3mMwUApzxzA@2x.png"/></div></div></figure><p id="3121" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在哪里</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/1c84a93ae1ca956c2399059ffd804c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BbehrckkKk-qgGbUdEiS8Q@2x.png"/></div></div></figure><p id="7cff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，在参数log σ中，可能性具有以下形式</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/09d27997d2344946bd1cfabea4d53a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jHfORtUhd2ir3LcHWPeZg@2x.png"/></div></div></figure><p id="498a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在哪里</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/42e9fe19f3a4e9df963d9f568145129a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ysAOjksaCW7uLEdLHfLLkA@2x.png"/></div></div></figure><p id="c334" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们说似然函数是对数σ中的<em class="lb">数据转换</em>,因为除了位置和观察值仅用于移动曲线之外，关于似然曲线的一切都是已知的。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/b84cbad8ef95e658fd37f1a534cb561e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*2vKl5BBFY_Jf5L2-9gWm7Q.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">均值为零、<br/> n=10、<strong class="bd ng"> y </strong> ^⊤ <strong class="bd ng"> y </strong>不同值的正态分布数据的对数标准差的似然函数。</p></figure><p id="bd16" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当似然函数是参数中的转换数据时，对非信息先验使用统一函数是有意义的。在观察数据之前，我们没有理由选择一个参数范围[a，b]而不是另一个相同宽度的范围[t + a，t + b],因为如果观察到的数据平移t，它们相对于似然曲线的位置是相等的。</p><p id="ff95" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们回到挑选我们的前科。</p><h1 id="0bb8" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">挑选正则化贝叶斯线性回归先验</h1><p id="c972" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">对于参数σ，我们使用无信息先验</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/8b02895473c7727f55afc2c8060be896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mbIBANh4PwSgRkpQngzmg@2x.png"/></div></div></figure><p id="1c90" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这相当于在参数log σ上使用统一的先验。对于<strong class="kh ir"> w </strong>，我们想要一个收缩权重的信息先验，反映权重不可预测的先验信念。让η表示控制<br/>收缩程度的超参数。然后我们使用协方差矩阵为(σ/λ_η) <strong class="kh ir"> I </strong>的球形正态分布</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/c8a93546d92a28eb4d3d7b2de344a4ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25guNxURjVHRFLzVS19_9g@2x.png"/></div></div></figure><p id="f8c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，我们还没有描述η如何参数化λ，我们还将对η进行积分，因此我们另外有一个η的先验(称为超先验),因此</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/ae93c61a4fe9cf14dea687c73d53f249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8hEWoxM8udPNTz6s69ISQ@2x.png"/></div></div></figure><p id="8eb7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的目标是先验P(η)是无信息的。所以我们想知道:在什么参数化中，P( <strong class="kh ir"> y </strong> |η)会被数据翻译吗？</p><h1 id="38ca" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">收缩先验如何参数化？</h1><p id="b45a" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">在考虑如何参数化λ之前，我们先来刻画一下λ的似然函数。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/97cca92778632c3790c14840f42cea36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hng7CuOIMNGq6f4PCUllFg@2x.png"/></div></div></figure><p id="e4c0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">展开被积函数，我们有</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/7977120c6532e9f803fff9bfb8fc13c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JKkkc2wsmg6fo_vIJBk17w@2x.png"/></div></div></figure><p id="a8ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在哪里</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/8b015168b0c890ec47b788abd721f8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0CmOLauoQSzqYTg1ytPGg@2x.png"/></div></div></figure><p id="7947" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/71b2fb82c8ec0690935f582dc9564b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OguPCRyzW-p6XlVN0s9jHg@2x.png"/></div></div></figure><p id="ce3c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意#1与<strong class="kh ir"> w </strong>无关，因此关于<strong class="kh ir"> w </strong>的积分等同于在非标准化高斯上的积分。</p><p id="c523" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:回想一下归一化高斯积分的公式</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/b7e097adf8e59180589668a12fb2a7a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I68Lxpbtzr6iBb3YsWvlsQ@2x.png"/></div></div></figure><p id="5715" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/978b8144972ecf4548e56c1e21b01971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TErm5T17gCZMI6iWBbgK1w@2x.png"/></div></div></figure><p id="45b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来让我们考虑σ上的积分。</p><p id="2d95" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">放</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/d23d19ce71bb84e432352855ffe421df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZTaeGYsSeuesWhKpSBAaMQ@2x.png"/></div></div></figure><p id="0068" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们可以重写</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/5a2ca42a02b6cab72034c22218fbc6a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*817N2k5MyAMdRSDTwDv3Sw@2x.png"/></div></div></figure><p id="c5db" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在改变变量之后，我们可以把关于σ的积分表示为伽马函数的一种形式。</p><p id="6bd4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">考虑一个积分</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/471e2460717ea50740d623b2e91f6de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pve3NBj0RvSeiqoTtHLjMg@2x.png"/></div></div></figure><p id="37ce" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">放</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/002924f4fb518d0d3c376be2fcbe41b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3lf8-jpXLVerHxYcIOpA8A@2x.png"/></div></div></figure><p id="6071" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/7f37e7ec3b338abd6061ebe0fda9d69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Xu6rJKFNDyN1kmIXZz8zQ@2x.png"/></div></div></figure><p id="251e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/54ac4725b73c163ccd72e165875b3382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7kXGERcRPoAM0WQIUv3Nuw@2x.png"/></div></div></figure><p id="461d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中γ表示伽马函数</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/0923d2f88a805d7725c1665468c009c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3EcpMAY9gFceJskk-_n5w@2x.png"/></div></div></figure><p id="73fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以写</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/ca41fce96eca97f06dca38f6d5843059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zmgvO_sqcjulEQxdj0-sdw@2x.png"/></div></div></figure><p id="979d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设<strong class="kh ir"> U </strong>、<strong class="kh ir">σ</strong>和<strong class="kh ir"> V </strong>表示<strong class="kh ir"> X </strong> <br/>的奇异值分解，从而</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/fa396aef021dcf226a17711ad96ea19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o9WKwIFiBk1fpoVfDe1WVQ@2x.png"/></div></div></figure><p id="2de8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让ξ₁，ξ₂，…表示<strong class="kh ir">σ</strong>的非零对角线元素。放<strong class="kh ir">λ</strong>=<strong class="kh ir">σ</strong>^⊤<strong class="kh ir">σ</strong>。那么<strong class="kh ir">λ</strong>是一个对角矩阵，有ξ₁，ξ₂，…和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/e8509d572e54da7a395fce1d092b1028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PC5Gv-F5WZge95DWsjnBQ@2x.png"/></div></div></figure><p id="cdd6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:为了实现我们的算法，我们将只需要矩阵<strong class="kh ir"> V </strong>和<strong class="kh ir">σ</strong>的非零对角元素，这可以通过部分奇异值分解来有效地计算。参见LAPACK函数<a class="ae lc" href="http://www.netlib.org/lapack/explore-html/d1/d7e/group__double_g_esing_gad8e0f1c83a78d3d4858eaaa88a1c5ab1.html" rel="noopener ugc nofollow" target="_blank"> gesdd </a>。</p><p id="056c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">放</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/ff67909b5fe384669e50507d35b875a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2xreODZTRCl-BZOAV-j3w@2x.png"/></div></div></figure><p id="95d5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们可以把h和g改写成</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/337f590f43c8ef13854a8786c2d74f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RlTTv6Z67YhPrYBSDgIz1Q@2x.png"/></div></div></figure><p id="75c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/b6d2beec88c402f391611d228eadfeb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M_V1PUpveNo5v_PwFFYcSg@2x.png"/></div></div></figure><p id="67ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们采用术语</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/fc57f367ab8cef70cd724b2105cd73c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6tkzplN3d5e6guozrP1Uyg@2x.png"/></div></div></figure><p id="7a32" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">放</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/433aab513b02d7f41bd92e1e7230f5bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mhpJuYyVWgVb0OuR5rPsow@2x.png"/></div></div></figure><p id="e194" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么r是范围从0到1的单调递增函数，<br/>我们可以认为r是特征向量的平均收缩因子。</p><p id="03e1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们通过用平均值替换单个特征向量收缩来进行近似:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/e2f39cef65b683569b02303148b1e20f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHssg06BEyfOr49eXkaHFg@2x.png"/></div></div></figure><p id="c7e9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将近似值代入似然性，我们就得到</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/715040ee1ce0664a47c05e4f0c45ca72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5zGmIu1WTZO4772DmoidPA@2x.png"/></div></div></figure><p id="b7e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到近似的可能性可以表示为</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/7d5d0519c8484862fd2b0ffe1ccb07e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFctgOMCcdVqdJhOmNhgcQ@2x.png"/></div></div></figure><p id="d38d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，这种可能性大约是对数r(λ)中的数据转换。</p><p id="b65b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，如果我们<br/>让η代表平均收缩率，我们可以获得近似无信息先验</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/9dc23297d9ca612c01ff837853e43e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o6XWF37ShYFKN58X2-xQKA@2x.png"/></div></div></figure><p id="8682" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并使用超级优先级</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/45e68faf11430f51b2c10fb1dc1a94f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bSWCjmtqXNb8cQYsPeovJQ@2x.png"/></div></div></figure><p id="d5a1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:为了求r的倒数，我们可以使用一个标准的求根算法。</p><p id="074a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对r(λ)求导得到</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/981d920691511d212180bf9e9bb6f0ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hXlYnpYl5otUpoNf2uETvA@2x.png"/></div></div></figure><p id="f637" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">利用导数和牛顿算法的变体，我们可以快速迭代得到r⁻ (η)的解。</p><h1 id="7195" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">做预测</h1><p id="3cb8" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">拟合贝叶斯模型的结果就是后验分布P( <strong class="kh ir"> θ </strong> | <strong class="kh ir"> y </strong>)。让我们考虑在给定一个新的数据点<strong class="kh ir"> x </strong>的情况下，如何使用该分布进行预测。</p><p id="b58c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将从计算预期目标值开始</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/eb5b0f4ae7ebdd63609e662a837aacd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlEmkk3YZK6LihjWywoBAA@2x.png"/></div></div></figure><p id="8372" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/de64b21414cbfa55e8a7e68179f87d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5_Pm13o6VRkAyIU7fgqhPw@2x.png"/></div></div></figure><p id="34c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:为了计算包含η的表达式的期望值，我们需要对后验分布P(η| <strong class="kh ir"> y </strong>)进行积分。我们没有积分的解析形式，但是我们可以用一个<a class="ae lc" href="https://en.wikipedia.org/wiki/Adaptive_quadrature" rel="noopener ugc nofollow" target="_blank">自适应积分</a>来高效精确地积分。</p><p id="bdec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了计算方差，我们有</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/394e6ea7237565ae6f411ac90fda177e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s0m8TGG3xm2QLVMQZmaOlw@2x.png"/></div></div></figure><p id="8922" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/27cadadb76237ce80d6dbf046e592121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7NiKAWkhwmF5tXCD3Sb-rQ@2x.png"/></div></div></figure><p id="053a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从E[σ | <strong class="kh ir"> y </strong> ]开始，回想一下</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/1c28b3afcb620da09387f38cc39b4b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8JODEtnAo8IcC44whC2oA@2x.png"/></div></div></figure><p id="c5d5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/5044d29ad1b040f07665d9d836533e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vCbSXfAFJnkyVTePlhlUSA@2x.png"/></div></div></figure><p id="3c76" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/be8aa080ab2f4c6a1bf33c9c51595c81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KvnfRIBNAyfnuIKU6byxIg@2x.png"/></div></div></figure><p id="da26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:伽玛函数具有属性</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/ddfadf2fc02838dabdfb09f2ab504dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_q3-1by7MA9rvPBBhHstw@2x.png"/></div></div></figure><p id="ed2e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/de21b1b9bdc7583bf2a1c7fab6cecead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhLLEca48slD1LQcCuIeUg@2x.png"/></div></div></figure><p id="5253" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">和</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/3a83605a7c213b1ea35679ba59308230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rAm647OvbxYAp98Or-yygg@2x.png"/></div></div></figure><p id="9fb0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/4467e61134627fed3182259cf48af244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Yq3arlaMQ3BwbR4wTF5ww@2x.png"/></div></div></figure><p id="a310" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于e[<strong class="kh ir">w</strong>w<strong class="kh ir">^t|</strong>y]，我们有</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/3649c2d253b91d5d04087581b07f841b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TR9vL-QKB6p6ggDq2ydUBA@2x.png"/></div></div></figure><h1 id="4f60" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">算法概述</h1><p id="ccec" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">我们已经看到，计算关于预测的统计数据涉及对后验分布P(η| <strong class="kh ir"> y </strong>)的积分。我们将简要地勾画出计算这种积分的算法。我们描述它只是为了计算<strong class="kh ir"> w </strong>的期望值。其他期望值可以通过简单的修改来计算。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/b8218bd1e6f7cc1f8f3cbc731b2bdd73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1Y4nx92kYdehWWDtN8_jA@2x.png"/></div></div></figure><p id="ba88" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">过程SHRINK-INVERSE应用牛顿算法用r和r '求根来计算r⁻。</p><p id="38c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了计算超参数后验积分，我们利用自适应求积算法。在不同的求值点上，用加权和来近似积分。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/d01e0a72721eb89c455c00b2c4afe62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouuKRns4DobEb3eGj-s2Mg@2x.png"/></div></div></figure><p id="eb77" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一般来说，使用的评估点数越多，近似值就越精确。自适应求积算法比较不同细化级别的积分近似值，以逼近误差，并增加评估点数，直到达到所需的容差。</p><p id="40a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:我们省略了所使用的求积算法的细节，仅在较高层次上进行描述。有关具体求积算法的更多信息，请参考<a class="ae lc" href="https://en.wikipedia.org/wiki/Gauss%E2%80%93Hermite_quadrature" rel="noopener ugc nofollow" target="_blank">高斯-埃尔米特求积法</a>和<a class="ae lc" href="https://en.wikipedia.org/wiki/Tanh-sinh_quadrature" rel="noopener ugc nofollow" target="_blank">双曲正切法</a>。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/89e7c43bf550551463b0bbbe91f2b494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPbfMtO6fVBwTl5uKMW8GQ@2x.png"/></div></div></figure><h1 id="3544" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">实验结果</h1><p id="efc2" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">为了更好地理解算法在实践中是如何工作的，我们将设置一个小的<br/>实验数据集，并将贝叶斯算法的模型拟合与普通最小二乘法(OLS)和岭回归模型拟合进行比较，以便最小化数据集的留一交叉验证(LOOCV)的误差。</p><p id="761d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">实验的全部源代码可以在github.com/rnburn/bbai/example/03-bayesian.py的T2获得。</p><h2 id="2d23" class="nh mf iq bd mg ni nj dn mk nk nl dp mo ko nm nn mq ks no np ms kw nq nr mu ns bi translated">生成数据集</h2><p id="e1c4" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">我们将从设置数据集开始。对于设计矩阵，我们将使用均值为零的高斯和协方差矩阵<strong class="kh ir"> K </strong>随机生成一个20乘10的矩阵<strong class="kh ir"> X </strong>，其中</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/7ffd86911d65d51369e738c363b510a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HxNHvGQYnK2KeCqzhjMUdg@2x.png"/></div></div></figure><p id="a5d8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将从具有单位方差的球形高斯中生成具有10个元素的权重向量，并且我们将重新调整权重，使得信号方差等于1。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/6c55022472f94efd56674c813a096570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3k6KTPLaHN83u3x3ox1LcQ@2x.png"/></div></div></figure><p id="9b77" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那我们就开始吧</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/3071d12da1c5a998ee235c7b7c196510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nmezUB4sF8rtn2iyAJJzIQ@2x.png"/></div></div></figure><p id="7f57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<strong class="kh ir"> ε </strong>是从具有单位方差的高斯分布中提取的20个元素的向量。</p><p id="d473" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是设置数据集的Python代码。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="a407" class="nh mf iq bd mg ni nj dn mk nk nl dp mo ko nm nn mq ks no np ms kw nq nr mu ns bi translated">拟合模型</h2><p id="f17d" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">现在，我们将拟合贝叶斯岭回归模型、OLS模型和具有正则化强度设置的岭回归模型，以便最小化LOOCV的均方误差。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="c39b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用以下等式来测量每个模型的样本外误差方差</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/a2af9340ff3d5782292b0bad7b6ec86f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xq2wxGURUVuKt4agW8IZrw@2x.png"/></div></div></figure><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="b2ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样做给了我们</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">模型的样本外性能</p></figure><p id="e4b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到贝叶斯和岭回归模型都能够防止过度拟合，并获得更好的样本外结果。</p><p id="45e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们将比较贝叶斯模型和OLS模型的估计噪声方差。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="ac9b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这给了我们</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">σ的模型估计</p></figure><h1 id="ee5b" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">结论</h1><p id="dce0" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">当将贝叶斯方法应用于岭回归时，我们需要解决:我们如何处理控制正则化强度的超参数？</p><p id="0f19" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一种选择是使用点估计，其中超参数的值被选择来优化一些度量(例如，可能性或交叉验证)。但是这种方法违背了使用概率分布表示参数可信度的贝叶斯方法，特别是如果可能性在超参数的特定值附近不是很强的峰值。</p><p id="0877" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通常使用的另一种选择是应用超参数先验的已知分布(例如半柯西分布)。这种方法给出了超参数的后验分布，并且在实践中可以很好地工作，但是先验分布的选择有些武断。</p><p id="7d5a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博客文章中，我们展示了一种不同的方法，我们选择了一个超参数先验分布，以便近似无信息。我们开发了在给定非信息先验的情况下计算标准预测统计的算法，并且我们通过一个小例子证明了它比使用选择的超参数的点估计来优化留一交叉验证更有利。</p><h1 id="78d3" class="me mf iq bd mg mh mi mj mk ml mm mn mo jw mp jx mq jz mr ka ms kc mt kd mu mv bi translated">附录A:与其他贝叶斯算法的比较</h1><p id="17e8" class="pw-post-body-paragraph kf kg iq kh b ki mw jr kk kl mx ju kn ko my kq kr ks mz ku kv kw na ky kz la ij bi translated">这里，我们将对scikit-learn的<a class="ae lc" href="https://scikit-learn.org/stable/modules/linear_model.html#bayesian-ridge-regression" rel="noopener ugc nofollow" target="_blank">贝叶斯岭回归</a>算法做一个简单的比较。</p><p id="cddb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Scikit-learn的算法利用共轭先验，因此仅限于使用伽马先验，这需要四个任意选择的小值超参数。此外，它需要参数α和λ的初始值，然后根据数据进行更新。</p><p id="8339" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">算法的性能可能对这些参数值的选择很敏感，scikit-learn的文档提供了一个曲线拟合<a class="ae lc" href="https://scikit-learn.org/stable/auto_examples/linear_model/plot_bayesian_ridge_curvefit.html" rel="noopener ugc nofollow" target="_blank">示例</a>，其中默认值表现不佳。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nv"><img src="../Images/2e661a3ea18216bbf1f681d2bfda5111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ApxrpYULBMkGW9Sbd-e9gg.png"/></div></div></figure><p id="4034" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相比之下，我们提出的算法不需要初始参数；并且因为超参数被积分，表现差的值对后验概率质量贡献很小。</p><p id="05fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，我们的方法处理曲线拟合的例子，不需要任何调整。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/faaec380a3034a82a3cab0bebbb25efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*hh7FMoSy5wrLnpfcW3da9g.png"/></div></figure><p id="9da4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完整的曲线拟合对比示例可在github.com/rnburn/bbai/blob/master/example/04-curve-fitting的<a class="ae lc" href="https://github.com/rnburn/bbai/blob/master/example/04-curve-fitting.ipynb" rel="noopener ugc nofollow" target="_blank">获得。</a></p><p id="0455" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">本帖最初发表于</em><a class="ae lc" href="https://buildingblock.ai/bayesian-ridge-regression" rel="noopener ugc nofollow" target="_blank"><em class="lb">buildingblock.ai/bayesian-ridge-regression</em></a><em class="lb">。</em></p></div></div>    
</body>
</html>