<html>
<head>
<title>Clean a ‘Numeric’ ID Column in Pandas Dataframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">清理熊猫数据框中的“数字”ID 列</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clean-a-numeric-id-column-in-pandas-dataframe-fbe03c11e330#2022-03-03">https://towardsdatascience.com/clean-a-numeric-id-column-in-pandas-dataframe-fbe03c11e330#2022-03-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="95fb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫初学者的一段方便的代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6cff62e9623d38cdf53bcaac793b38c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pu9WcqRIoIZroxHfntrpyQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/photos/disinfectant-spray-trigger-5093503/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>提供</p></figure><p id="b917" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据科学家，在您的数据科学之旅中，您一定至少遇到过一次这样的问题:您将数据导入到 Pandas dataframe 中，ID 列显示为一个数字(整数或浮点)变量。原始 ID 列中可能有前导零，但由于数据类型为数字，它们已被删除。</p><p id="2723" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个常见的问题，几乎总是需要在进行数据管理和分析任务之前进行处理。如果您计划以后将 ID 字段用作与其他表连接的键，这一点尤其重要。那么如何在 Python 中修复呢？</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="1b09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个简单的例子。我们有一个样本数据框架，显示了 2020 年 10 月每个县的房屋销售价格中值。在此数据框架中，我们有一个 ID 字段— FIPS，它是美国每个县的唯一 5 位地理标识符</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/54903f275a343cac557f66b54d3b1b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25RMnoLZijtPqfGuvwkyjA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8dbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FIPS 字段应该是一个五位数的代码，应该作为字符串导入；相反，它显示为没有意义的浮点类型。我们需要将它改为字符串类型，并添加回前导零。我们可以通过两种方式做到这一点:</p><h2 id="cad7" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">方法 1:</h2><p id="4332" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">使用这种方法，我们首先将 FIPS 字段从<code class="fe nb nc nd ne b">float</code>类型更改为<code class="fe nb nc nd ne b">integer</code>类型，然后将其更改为<code class="fe nb nc nd ne b">string</code>。我们可以使用 Pandas 的<code class="fe nb nc nd ne b">DataFrame.astype()</code>方法来改变数据类型。</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="72d1" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].fillna(0).astype(int).astype(str)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/6be1dbcfa4bf27d69592aa356b08cc8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNM8m2gpfNE4_caFYGL4UA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="536e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 FIPS 字段更改为<code class="fe nb nc nd ne b">string</code>类型后，我们可以添加前导零，使其成为一个五位数代码。我们可以用熊猫的方法来做。</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="f43b" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].str.zfill(5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/43566e3bc7ae4137f4d6688eaae58cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*lbEx0M0-GVARsZUv1VK_-w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="8654" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">方法二:</h2><p id="d089" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">清理 FIPS 字段的另一种方法是首先将其数据类型更改为<code class="fe nb nc nd ne b">string</code>，然后使用 Python 中的<code class="fe nb nc nd ne b">regex</code>(正则表达式)来搜索和替换字符串中的某些模式，以便删除小数位。以下代码使用<code class="fe nb nc nd ne b">regex</code>从 FIPS 列的字符串中删除“. 0”部分。</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="0775" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].astype(str).replace('\.0', '', regex=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/20546df529e65276a4753875f7850c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VR--ydy5yrB-i1IX-a5YgA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3eda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们使用<code class="fe nb nc nd ne b">zfill()</code>将前导零添加回 FIPS 字段，使其成为一个五位数代码。</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="ed59" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].str.zfill(5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/931f522abf096e3e1d8764296ea79c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*YC8BTwIF2PA-hKsqntljHg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="728c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以选择使用以下代码将所有“00nan”替换为“00000”或其他值，但这是可选的。</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="bf03" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].replace('00nan', '00000')</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="1a83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想指出的一点是，在方法 1 中，请确保在使用<code class="fe nb nc nd ne b">astype(int)</code>更改数据类型之前，使用<code class="fe nb nc nd ne b">fillna(0)</code>将 FIPS 列中所有缺失的值替换为 0。这是因为如果您的 ID 列(即 FIPS)有缺失值，那么<code class="fe nb nc nd ne b">astype(int)</code>将无法工作。</p><p id="e2b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果您使用下面的代码试图将 FIPS 从<code class="fe nb nc nd ne b">float</code>直接更改为<code class="fe nb nc nd ne b">integer</code>，您将得到如下所示的回溯错误:</p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="ad5f" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].astype(int)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/a760fc5dbced07d4f6cba1928a846147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1-AwcuNXPgt2vStVtYT6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="847c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总之，通过使用以下两种方法之一，可以很容易地清除带有前导零的“数字”ID 列。这是一个非常常见并且看起来很容易解决的问题，但是对于 python 初学者来说却很难解决。因此，我希望这篇简短的教程和代码对您有所帮助，尤其是对于那些刚刚开始数据科学和 python 之旅的人。感谢阅读！</p><p id="0bd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">方法一:</strong></p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="040a" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].fillna(0).astype(int).astype(str)<br/>df['FIPS'] = df['FIPS'].str.zfill(5)</span></pre><p id="7ca1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">方法二:</strong></p><pre class="kj kk kl km gt nf ne ng nh aw ni bi"><span id="08d6" class="md me it ne b gy nj nk l nl nm">df['FIPS'] = df['FIPS'].astype(str).replace('\.0', '', regex=True)<br/>df['FIPS'] = df['FIPS'].str.zfill(5)</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="51fc" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">数据源:</h2><p id="bcad" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated"><a class="ae ky" href="https://www.redfin.com/news/data-center/" rel="noopener ugc nofollow" target="_blank"> Redfin 数据中心</a> : Redfin 月度房市数据——县级。这是由全国房地产经纪公司<a class="ae ky" href="https://www.redfin.com/news/data-center/" rel="noopener ugc nofollow" target="_blank"> <em class="ns"> Redfin </em> </a> <em class="ns">，</em>提供的一个开放数据集，你可以免费下载，并注明出处供你自己使用。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="2883" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以通过这个<a class="ae ky" href="https://medium.com/@insightsbees/membership" rel="noopener">推荐链接</a>注册 Medium 会员(每月 5 美元)来获得我的作品和 Medium 的其他内容。通过这个链接注册，我将收到你的一部分会员费，不需要你额外付费。谢谢大家！</p></div></div>    
</body>
</html>