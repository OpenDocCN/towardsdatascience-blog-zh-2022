<html>
<head>
<title>The Bible under the NLP eye (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NLP眼中的圣经(上)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-bible-under-the-nlp-eye-part-1-416dbfd79444#2022-04-14">https://towardsdatascience.com/the-bible-under-the-nlp-eye-part-1-416dbfd79444#2022-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d4c2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有趣的数据科学项目的第一部分，学习更多关于文本处理、NLP技术以及从文本语料库中提取有意义的信息。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b508f800d8838d928d3b91471402f7a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IR49x_z17lPsfCQi_NcfTw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://unsplash.com/@debrupas" rel="noopener ugc nofollow" target="_blank"> Pascal Debrunner </a>在<a class="ae ky" href="https://unsplash.com/photos/_JedZkjoUFw" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="400a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于复活节即将来临，我想到了一个有趣的数据科学项目，将NLP技术应用于圣经。圣经可以从古腾堡计划<a class="ae ky" href="https://www.gutenberg.org/cache/epub/1581/pg1581.txt" rel="noopener ugc nofollow" target="_blank">https://www.gutenberg.org/cache/epub/1581/pg1581.txt</a>(<a class="ae ky" href="https://www.gutenberg.org/policy/license.html" rel="noopener ugc nofollow" target="_blank">古腾堡许可</a>)免费下载文本格式</p><p id="752c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">《杜埃-兰斯圣经》是从拉丁文圣经翻译成英文的，总共有74本。圣经的第一部分是旧约，共46卷，讲述了以色列人的历史(摩西五经)，善恶之分(智慧书)，以及先知书。第二部分是新约，28本书，讲述了基督和他的门徒的历史以及地球的未来，直到天启。这部分的主要书籍是马可福音、马太福音、路加福音、约翰福音和启示录。</p><p id="8a59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个项目希望温和地介绍NLP世界，带领读者经历每一步，从清理原始输入数据到获取和理解书籍的显著特征。在这第一部分中，我们将处理:数据清理，从语料库中提取数据，以及Zipf定律。</p><h2 id="8a62" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">开始前</h2><p id="642d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这是两篇文章中用到的所有包:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6d32" class="lv lw it mu b gy my mz l na nb">import re<br/>import nltk<br/>nltk.download('stopwords')<br/>from nltk.corpus import stopwords<br/>import glob<br/>import string<br/>import gensim<br/>from gensim.corpora import Dictionary<br/>from gensim.utils import simple_preprocess<br/>from gensim.models import CoherenceModel, Phrases, LdaModel<br/>from gensim.models.ldamulticore import LdaMulticore<br/>import pandas as pd<br/>from num2words import num2words<br/>import numpy as np<br/>from wordcloud import WordCloud<br/>from sklearn.feature_extraction.text import CountVectorizer<br/>import seaborn as sbn <br/>from matplotlib.pyplot as plt<br/>from scipy.stats import hmean<br/>from scipy.stats import norm</span></pre><p id="d99d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此您可以提前安装，只需导入一次。</p><h2 id="9c99" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">预处理</h2><p id="159a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">预处理是第一件事——我们应该牢记在心！在这里，原始输入文件被清理，书籍被细分为单个文件。我进行了一次简单的手工清理，取出了每本书的介绍、书名和简介，以及最后的古腾堡末日免责声明。在这一步之后，每本书都从图案<code class="fe nc nd ne mu b">Book_name Chapter 1</code>开始，伴随着诗句、数字和文本。</p><p id="1056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图1显示了我是如何将所有的书分成单个文件的。使用<code class="fe nc nd ne mu b">.readlines()</code>将输入文件作为单个字符串读取。旧约全书在<code class="fe nc nd ne mu b">old_books</code>中，<code class="fe nc nd ne mu b">multinames</code>列表表示所有有多个版本的书籍(如<code class="fe nc nd ne mu b">The First Book of Kings, The First Book of Paralipomenon </code>等)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:开始打扫卫生，收集书籍的索引。这些索引有助于以后保存每本书。</p></figure><p id="903b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于以<code class="fe nc nd ne mu b">Chapter</code>开始的每一行，我们提取<code class="fe nc nd ne mu b">book_name</code>。对于<code class="fe nc nd ne mu b">multinames</code>的书，我们在每章的开头都有模式<code class="fe nc nd ne mu b">1 Book_Name Chapter 1</code>，所以我们从<code class="fe nc nd ne mu b">val.split()[1]</code>行中提取下一个单词。第一次出现的<code class="fe nc nd ne mu b">Book_Name Chapter 1</code>标记了书的起始索引。当<code class="fe nc nd ne mu b">current_book_name</code>不同于存储的<code class="fe nc nd ne mu b">tmp_book</code>名称时，检索结束索引。因此，字典<code class="fe nc nd ne mu b">books_idx</code>包含图书名称、起始索引和结束索引(例如<code class="fe nc nd ne mu b">{"Genesis":[0, 5689], "Exodus":[5689, 10258], ... }</code>)。从索引中，我们可以选择原始<code class="fe nc nd ne mu b">lines</code>中的所有书籍，并将它们保存到一个<code class="fe nc nd ne mu b">txt</code>文件中</p><p id="78a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果没有不同的说明，输入文本已经以这种方式被清除，并作为字符串存储在<code class="fe nc nd ne mu b">data</code>列表中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:输入书籍的清洁。每本书都要清理数字诗句模式、名称和章节号、标点符号、新行、停用词。</p></figure><p id="5903" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于每本书来说，诗句的数字模式<code class="fe nc nd ne mu b">NUMBER:NUMBER. text</code>都被移除了<code class="fe nc nd ne mu b">re</code>以及与数字组合<code class="fe nc nd ne mu b">\d{1,}</code>匹配的正则表达式<code class="fe nc nd ne mu b">r"\d{1,}\:\d{1,}\.</code>、半列<code class="fe nc nd ne mu b">\:</code>和最后一个点<code class="fe nc nd ne mu b">\.</code>。同样，图案<code class="fe nc nd ne mu b">Book_name Chapter NUMBER</code>被移除。最后，所有的文本都被转换成小写，标点符号以及停用词被删除。</p><h2 id="0ca3" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">获得一个初步的想法:wordcloud</h2><p id="860d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">对圣经中的主题和反复出现的词语有一个初步的概念是一个完美的起点。Wordcloud以人类可理解的方式显示文本中出现最频繁的单词。所有的圣经书籍都可以压缩在一个<code class="fe nc nd ne mu b">big_string</code>中，生成一个单词云<code class="fe nc nd ne mu b">WordCloud(width=IMAGE_WIDTH, height=IMAGE_HEIGHT, max_font_size=FONT_SIZE).generate(big_string)</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3:从所有的书籍中创建一个单词云。WordCloud的输入参数是一个字符串</p></figure><p id="12c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图4显示了所有书籍的文字云。话题可以立刻被发现，还有<code class="fe nc nd ne mu b">lord</code>、<code class="fe nc nd ne mu b">god</code>、<code class="fe nc nd ne mu b">come</code>、<code class="fe nc nd ne mu b">son</code>、<code class="fe nc nd ne mu b">isreal</code>、<code class="fe nc nd ne mu b">king</code>等关键词</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/f4c531f39ec69752294a59ba28523a5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQNIaboyOrsiD8VzHlv0gg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4:所有圣经书籍中的文字云。作者图片</p></figure><p id="0b90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以做得更多，为每本书提取一个词云。图5显示了旧约的前三本书《创世纪》、《出埃及记》和《利未记》中的文字云的比较。我们可以清楚地认识到主要元素和差异。《创世纪》以<code class="fe nc nd ne mu b">earth</code>和<code class="fe nc nd ne mu b">god</code>开始，其中<code class="fe nc nd ne mu b">said</code>到<code class="fe nc nd ne mu b">Abraham</code>不吃树上的果子。从那里我们可以定义亚伯拉罕的其他后代，比如<code class="fe nc nd ne mu b">Joseph</code>、<code class="fe nc nd ne mu b">Isaac</code>、<code class="fe nc nd ne mu b">Brethren</code>。在《出埃及记》中，主角是<code class="fe nc nd ne mu b">Moses</code>和<code class="fe nc nd ne mu b">Egypt pharao</code>。最后，在利未记中，主题是<code class="fe nc nd ne mu b">holocaust</code>，所以我们会有<code class="fe nc nd ne mu b">sacrifice</code>、<code class="fe nc nd ne mu b">blood</code>、<code class="fe nc nd ne mu b">victim</code>、<code class="fe nc nd ne mu b">flesh</code>和<code class="fe nc nd ne mu b">offer</code>这样的词</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/727156ab8adb2c9674a14aad969ea9a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C3Pr-OOfbnkcTF60mbk71g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:旧约前三卷中的字云比较。作者图片</p></figure><p id="bfe7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将留给你们去分析和观察福音书的词汇云的不同，并欣赏福音书、创世纪和启示录(这是最后一本圣经，可能是在基督后100年写的)之间的音调差异。</p><h2 id="cad2" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">数字符号</h2><p id="344d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">因为圣经来自口头传统，所以有许多重复出现的模式。此外，还有很多象征意义。每个词在特定的上下文中都有它的含义。这同样适用于数字。数字被用来表达一个概念——例如“七倍多”或“七十七倍”通常被用来表示“很多”——并构成了一个独特而有趣的有待发现的特征。此外，在文本中查找数字是学习正则表达式的好方法，也是获取数字的小技巧。</p><p id="25cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任务是在文本中找到简单的英文数字。第一种简单的方法是将整数转换成字符串，将文本分割成空格以得到一个分割列表，并计算每个分割列表出现的次数。图6总结了这种方法。首先，我们用<code class="fe nc nd ne mu b">num2words</code>将数字转换成字符串，并存储在一个列表中。在数据被清理(如上)后，我们可以计算每本书的每个数字出现的次数。在Google Colab笔记本上，这个过程对于100k个号码来说大约需要12秒。到目前为止还不错，但是，我们可以立即看到，最终的字典充满了大多数数字的0出现。此外，大多数找到的数字都在0到20之间。这是由于我们如何分割字符串以及如何将一些数字转换成字符串(例如，我们可能在数字列表中有<code class="fe nc nd ne mu b"> twenty-one </code>，但在文本中应该是<code class="fe nc nd ne mu b">twenty-one </code>)</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:在文本中查找文字数字的第一种方法</p></figure><p id="c237" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用Python模块<code class="fe nc nd ne mu b">re</code>并构建一个正则表达式来改进这种方法。我不想教你如何创建一个正则表达式，有大量的源代码，记住如何创建一个正则表达式通常是没有用的。我想把我们的注意力集中在如何处理这个过程上。</p><p id="7380" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的想法是创建一个正则表达式，它可以匹配给定书籍中的所有数字。正则表达式的核心部分可能类似于<code class="fe nc nd ne mu b">\b(numb1|numb2|numb3)\b</code>。图7显示了对包含以下数字<code class="fe nc nd ne mu b">one, twenty thousand, three thousand thirty four, three thousand five hundred forty five</code>的字符串的测试。因此，我们可以构建一个包含数字的正则表达式，并像<code class="fe nc nd ne mu b">re.findall(regex, test_text)</code>一样对测试字符串运行它。超级简单，但是结果非常错误，因为找到的数字是<code class="fe nc nd ne mu b">one, twenty, three, thirty four, three, five, forty five</code>。正如您所看到的，regex是如何在找到匹配后立即停止的。这不是我们想要的。我们可以做一些更隐蔽的事情，颠倒正则表达式的顺序，在开头使用“罕见”的数字，在结尾使用小的“频繁”的数字。如您所见，结果是正确的，返回了我们想要的数字。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:用正则表达式获取文字数字。记住:在正则表达式中，顺序是非常重要的！</p></figure><p id="bd52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个方案，我们现在可以在圣经中查找数字，对从<code class="fe nc nd ne mu b">num2words</code>转换来的数字增加一点预处理，如图8所示。正则表达式在2秒内创建，而运行匹配位需要1分30秒。在这种情况下，最终的字典<code class="fe nc nd ne mu b">match_dict</code>将包含比我们之前的方法更重要和有用的信息，因为每本书都将记录正确的数字，避免大量的0值。然而，创建这样的正则表达式是很痛苦的，而且当我们必须运行匹配过程时，效率不是很高。https://www.rexegg.com/regex-trick-numbers-in-english.html来帮忙了</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8:使用逆序/非频繁数字顺序创建一个正则表达式</p></figure><p id="dad4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图9示出了我们可以创建正则表达式来匹配简单的英文数字，通过简单地使用字面数字构造，例如<code class="fe nc nd ne mu b">f(?:ive|our)</code>并且定义从0到万亿中的万亿的数字，而不用在存储器中存储任何东西或者额外的过程。正则表达式的创建过程大约需要300微秒，而匹配过程大约需要4秒钟！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9:寻找数字的正则表达式，利用简单的英语规则</p></figure><p id="8a91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，最后一种方法是成功的方法。它更容易移植，不需要对数字进行额外的处理，而且比我们的第一种方法计算效率更高，可以返回完全正确的信息。</p><p id="b8ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们分析最终的匹配词典，我们可以看到<code class="fe nc nd ne mu b">Numbers</code>是——不出所料——拥有最多数字的书，632本。第二本书是<code class="fe nc nd ne mu b">Genesis</code>，508，而<code class="fe nc nd ne mu b">Apocalypse</code>有323个数字，比《新约》中的任何一本书都多，其中<code class="fe nc nd ne mu b">seven </code>重复了76次，<code class="fe nc nd ne mu b">one</code>重复了72次。圣经中的最高数字是800'000，它出现在撒母耳记下第二卷，24:9(旧约):</p><blockquote class="nj nk nl"><p id="6cd8" class="kz la nm lb b lc ld ju le lf lg jx lh nn lj lk ll no ln lo lp np lr ls lt lu im bi translated">约押将百姓的总数奏告于王，以色列拿刀的勇士有八十万，犹大拿刀的勇士有五十万。</p></blockquote><p id="7ff2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从输出字典中，我们可以通过<code class="fe nc nd ne mu b">pandas.DataFrame</code>比较所有结果，并以直方图显示它们(图10):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10:从输出字典创建一个熊猫数据帧。选择主要帐簿并创建直方图</p></figure><p id="f14c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以比较圣经的主要书籍，即<code class="fe nc nd ne mu b">Genesis</code>、<code class="fe nc nd ne mu b">Exodus</code>、撒母耳记下第一、二卷(<code class="fe nc nd ne mu b">1Kings</code>、<code class="fe nc nd ne mu b">2Kings</code>、<code class="fe nc nd ne mu b">Psalms</code>、<code class="fe nc nd ne mu b">Isaias</code>、福音书:<code class="fe nc nd ne mu b">Mark</code>、<code class="fe nc nd ne mu b">Matthew</code>、<code class="fe nc nd ne mu b">Luke</code>、<code class="fe nc nd ne mu b">John</code>和最后一卷<code class="fe nc nd ne mu b">Apocalypse</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/5bfe64de7efdc7f4a60119c1ca8730b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKi3NQ4i4ivm-RYgxoRA2A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11:比较主要圣经书籍中常见数字的直方图。作者图片</p></figure><p id="84cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">10、1、7、2、3、4和6是圣经中常用的数字。特别有趣的是注意到<code class="fe nc nd ne mu b">seven</code>在<code class="fe nc nd ne mu b">Genesis</code>(第一本书)和<code class="fe nc nd ne mu b">Apocalpyse</code>(最后一本书)中的使用</p><h2 id="e4d6" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">齐夫定律</h2><p id="a5af" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">以美国语言学家乔治·金斯利·齐普夫命名的齐普夫定律将单词的出现频率和它们的排名联系起来。特别地，在文本语料库中，任何词的频率与其频率排名成反比。或多或少，出现频率最高的单词是第二高的单词的两倍，第三高的单词的三倍，依此类推。将该定律转换到对数-对数域，结果是作为单词等级和单词频率的函数的线性图。从这里，让我们看看圣经文集是如何与齐夫定律相关联的。</p><p id="c16c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图12显示了如何计算每本圣经的词频和排名。首先，我们启动<code class="fe nc nd ne mu b">sklearn.feature_extraction.text.CountVectorizer()</code>来统计每本书出现的所有单词。最终的矩阵计数<code class="fe nc nd ne mu b">all_df</code>可以转换成一个<code class="fe nc nd ne mu b">pandas.DataFrame</code>，对所有出现的单词<code class="fe nc nd ne mu b">tf = np.sum(all_df, axis=0)</code>求和，并从<code class="fe nc nd ne mu b">cvev.get_feature_names()</code>中检索单词。最终的数据帧<code class="fe nc nd ne mu b">term_freq_df</code>将把单词作为索引和一列，这是语料库中单词的总计数。从那里可以在对数尺度上比较词的分布与Zipf定律。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图12:根据圣经语料库计算并绘制齐夫定律</p></figure><p id="e0c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图13显示了最终的绘图结果。圣经稍微偏离了Zipf的线性。这并不奇怪。事实上，在《圣经》中有许多在自然语言中很少使用的重复词语。有趣的是,<code class="fe nc nd ne mu b">chin</code>这个词只用了一次，在撒母耳记下第二卷20:9:</p><blockquote class="nj nk nl"><p id="a700" class="kz la nm lb b lc ld ju le lf lg jx lh nn lj lk ll no ln lo lp np lr ls lt lu im bi translated">约阿布对阿玛撒说:我的兄弟，愿天主拯救你。他用右手抓住阿玛萨的下巴亲吻他。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/7271a97df557152be50301472c2db80b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wc22p_5neUjvtk0lYPUvWQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图13:圣经语料库与Zipf的预期行为略有不同。作者图片</p></figure><p id="5dad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这里，我们可以更深入地了解圣经中的用词，以便看到主要书籍之间的差异。首先，整部圣经中反复出现的主要词汇是:</p><ul class=""><li id="0e8e" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated"><code class="fe nc nd ne mu b">lord</code>出现8377次</li><li id="79b5" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe nc nd ne mu b">god</code>出现5720次</li><li id="601c" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated"><code class="fe nc nd ne mu b">man</code>出现2999次</li></ul><p id="45bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有趣的是，<code class="fe nc nd ne mu b">David</code>比<code class="fe nc nd ne mu b">christ</code>或<code class="fe nc nd ne mu b">Jesus</code>用的次数多，分别是1162、992和1028，而<code class="fe nc nd ne mu b">children</code>这个词用了1915次。</p><p id="ad62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们可以检查一下新约和旧约在用词上的差异。表1显示了旧约(<code class="fe nc nd ne mu b">Old T%</code>)和新约(<code class="fe nc nd ne mu b">New T%</code>)中单词出现的百分比。我们可以看到<code class="fe nc nd ne mu b">lord</code>、<code class="fe nc nd ne mu b">Israel</code>、<code class="fe nc nd ne mu b">king</code>、<code class="fe nc nd ne mu b">people</code>在旧约中的主要用法，以及它们在新约中对<code class="fe nc nd ne mu b">god</code>、<code class="fe nc nd ne mu b">Jesus</code>、<code class="fe nc nd ne mu b">christ</code>、<code class="fe nc nd ne mu b">father</code>和<code class="fe nc nd ne mu b">man</code>的翻译/转化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表1:旧约(旧T %)和新约(新T %)出现的百分比比较。</p></figure><p id="c0ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过研究单词的出现来探索这种术语上的差异。图14示出了如何将旧/新约的单词出现与总比率和旧/新类别比率的正态累积分布函数的调和平均值相关联。这是什么意思？我们可以立即找到独特的词汇，这些词汇是旧约全书和新约全书的主要特征:</p><ul class=""><li id="fff4" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">首先我们计算一个单词率，即单词出现次数，<code class="fe nc nd ne mu b">term_freq_df[0</code>表示总出现次数<code class="fe nc nd ne mu b">term_freq_df['total']</code> → <code class="fe nc nd ne mu b">old_rate</code></li><li id="2f5f" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">类似地，我们计算特定类别的单词率，即使用<code class="fe nc nd ne mu b">term_freq_df[0].sum()</code> → <code class="fe nc nd ne mu b">old_freq_pct</code>细分单词的出现</li><li id="aa91" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">我们计算<code class="fe nc nd ne mu b">old_rate</code>和<code class="fe nc nd ne mu b">old_freq_pct</code>之间的类调和平均值</li><li id="b1e8" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">从这里我们计算出<code class="fe nc nd ne mu b">old_rate</code>和<code class="fe nc nd ne mu b">old_freq_pct</code> → <code class="fe nc nd ne mu b">old_rate_normcdf</code>和<code class="fe nc nd ne mu b">old_freq_pct_normcdf</code>的正态累积分布函数</li><li id="52a6" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">最后，我们计算出<code class="fe nc nd ne mu b">old_rate_normcdf</code>和<code class="fe nc nd ne mu b">old_freq_pct_normcdf</code>之间的调和平均值，以给给定类别的唯一和特定的单词更多的权重</li></ul><p id="6c57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法主要来自于<a class="ae ky" href="https://medium.com/@rickykim78" rel="noopener">里奇金</a>的惊人文章</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图14:计算旧约/新约单词出现率的调和平均值的normcdf</p></figure><p id="30aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你画出<code class="fe nc nd ne mu b">old_normcdf_hmean</code>和<code class="fe nc nd ne mu b">new_normcdf_hmean</code>，你会看到图15，它在左上角突出了所有独特的和主要在旧约中使用的词，在右下角突出了在新约中特别使用的词。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f32fd1c98f780133d57205db53fac595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2gkE8UMicbRdJjKi0kEJ6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图15:旧约和新约的谐音。左上角突出了独特和具体的话，主要用于旧约，而右下侧的话，特点是新约。作者图片</p></figure><p id="b38e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这里我们可以立即看到《旧约》和《新约》之间的语气对比，表2。在《旧约》中，更普遍的“战争”术语是<code class="fe nc nd ne mu b">valiant</code>和<code class="fe nc nd ne mu b">convenient</code>，故事的特点是“农村”社会。新约强调新的信仰，突出了<code class="fe nc nd ne mu b">angels</code>、<code class="fe nc nd ne mu b">charity</code>和<code class="fe nc nd ne mu b">faith</code>的概念</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表2:描述以下特征的特定术语</p></figure><p id="613f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为最后一件事，上面的分析可以适用于所有四部福音书，突出了每部福音书的特征词。福音书写于不同的时代，最古老的是马可福音，其次是马太福音、路加福音和约翰福音。接下来会有不同的写作风格，以及每种风格中使用的更具体的词语。约翰福音似乎是最“天主教”的福音，用的术语指的是现在的教会:<code class="fe nc nd ne mu b">flesh</code>、<code class="fe nc nd ne mu b">glorify</code>、<code class="fe nc nd ne mu b">paraclete</code>、<code class="fe nc nd ne mu b">truth</code>。我们将在下一篇文章中回到这个话题:)</p><p id="5c1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天是一切:)</p><h2 id="f42b" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">第一部分的结论</h2><p id="d7b3" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">让我们回顾一下今天的内容:</p><ul class=""><li id="c3e2" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">我们学习了如何预处理原始文本输入，为NLP分析做好准备，并将其保存到不同的文件中</li><li id="d4b0" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">为了初步理解我们的数据，我们从这里开始运行<code class="fe nc nd ne mu b">WordCloud</code>,我们能够识别圣经书籍中不同的主题</li><li id="25f6" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">我们看到了如何处理一个正则表达式问题，用简单的英语找到一系列数字，以及如何优化最终的解决方案</li><li id="5afc" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">最后，我们对照圣经语料库测试了齐夫定律，并扩展了这一分析，为四部福音书中的每一部定义了独特的词汇</li></ul><p id="bacc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下次我们将运行主题建模、单词嵌入和文本嵌入以及文本相似性。敬请期待:)</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><p id="2e45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">通过我的推荐链接加入Medium，支持我的写作和项目:</em></p><div class="oo op gp gr oq or"><a href="https://stefanobosisio1.medium.com/membership" rel="noopener follow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">通过我的推荐链接加入Medium—Stefano Bosisio</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">stefanobosisio1.medium.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ks or"/></div></div></a></div><p id="9b01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">如果有任何问题或意见，请随时给我发电子邮件:stefanobosisio1@gmail.com或直接在Medium这里。</em></p></div></div>    
</body>
</html>