<html>
<head>
<title>How to Convert a CSV file into an XLSX one with Python and Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python和熊猫把CSV文件转换成XLSX文件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-convert-a-csv-file-into-an-xlsx-one-with-python-and-pandas-27aabc279d69#2022-08-09">https://towardsdatascience.com/how-to-convert-a-csv-file-into-an-xlsx-one-with-python-and-pandas-27aabc279d69#2022-08-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6e99" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Python转换文件的示例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0d5e1fa621cf70c90f08f4091e81000e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGElibzwzjvaO_5I60xg9g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历克斯·丘马克在<a class="ae ky" href="https://unsplash.com/s/photos/python?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="12ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">ython是一种非常灵活的编程语言。有人会说这是“万事通，无所不能”；但是，在我看来，它在许多任务中提供帮助的能力——从“基本编程”到机器学习——是Python的真正力量。</p><p id="2a65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几天前，我想分析一些可以从网站上下载的数据，以便用Tableau做一些练习。不幸的是，当我试图下载excel格式的数据时——这是Tableau可以接受的格式之一——我收到了一条错误消息。所以我试着下载CSV格式的数据，没有任何问题。</p><p id="4ec3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实是，Tableau甚至接受CSV文件，但我们必须做一些调整，我更喜欢使用XLSX文件。所以问题是:我如何将CSV文件转换成XLSX？嗯，我会用Python！因此，在本文中，我们将看到如何做到这一点。</p><h1 id="c194" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">数据的来源</h1><p id="4ae1" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我想分析欧洲的粮食产量，我发现粮农组织网站给了我们一些数据(链接<a class="ae ky" href="https://www.fao.org/faostat/en/#data/QCL" rel="noopener ugc nofollow" target="_blank">此处</a>)可以下载使用。但是当我试图下载XLXS中的数据时，出现了错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/712a12189059dc10da5f2e31e9d87398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cLn172lW-Mqf6cngsUJPxA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">粮农组织网站的错误。图片作者。</p></figure><p id="eaca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，我已经尝试了我能做的任何事情:我试了几次重新下载数据，改变选择，改变电脑，等等…但是我仍然得到同样的错误。所以，我试着用CSV格式下载它们，然后…砰！第一时间下载数据。</p><p id="772d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，现在，我遇到了将CSV文件转换成XLSX文件以加载到Tableau中的问题。让我们看看我是怎么做的。</p><h1 id="53f3" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">用熊猫将CSV转换为XLSX</h1><p id="f400" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">因为我们处理的是CSV，所以我们可以像往常一样打开熊猫:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="7dae" class="nh mf it nd b gy ni nj l nk nl">import pandas as pd</span><span id="7d70" class="nh mf it nd b gy nm nj l nk nl">#opening data<br/>grain = pd.read_csv('grain.csv')</span><span id="2b44" class="nh mf it nd b gy nm nj l nk nl">#showing head<br/>grain.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/e21446c33c72cc2ec679afff1beca5ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LXVdrhve-3ht9j3rv4TN4A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">下载的数据帧。图片作者。</p></figure><p id="718d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们稍微研究一下数据，我们会发现有些国家的产值为0吨。因此，在保存Tableau的数据之前，因为我们使用Python，所以删除这些行可能是个好主意。我们可以用下面的代码来实现:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="9302" class="nh mf it nd b gy ni nj l nk nl">#selecting rows with 'Value'!=0<br/>grain = grain.loc[grain['Value']!=0]</span></pre><p id="5721" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们终于准备好将CVS转换成XLSX我们可以通过下面的代码轻松做到这一点:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="1777" class="nh mf it nd b gy ni nj l nk nl">#saving to xlsx<br/>grain.to_excel('grain_excel.xlsx')</span></pre><p id="b9f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，我们简单地将文件保存在XLSX中，将其命名为“grain_excel.xlsx”。</p><h1 id="77f5" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">概括代码</h1><p id="3b2e" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">假设我们只想转换文件，而不清理数据；我们可以创建这样一个简单的脚本:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="c225" class="nh mf it nd b gy ni nj l nk nl">import pandas as pd</span><span id="6ccc" class="nh mf it nd b gy nm nj l nk nl">#opening data<br/>open_data = pd.read_csv('input_file.csv')</span><span id="02bf" class="nh mf it nd b gy nm nj l nk nl">#saving to xlsx<br/>open_data.to_excel('output_file.xlsx')</span></pre><p id="e719" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码只是打开一个你需要命名为“input_file.csv”的CSV文件，返回一个Excel文件，命名为“output_file.xlsx”。您可以将此代码另存为”。py”文件，并在需要时运行它。就这么简单。</p><h1 id="cb41" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="6c86" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我们已经看到，如果我们需要，将CSV文件转换成XLSX文件是多么容易。熊猫是一个非常强大的库，可以帮助我们完成这个简单的任务。</p><p id="0e65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，如果我们需要多次做这样的转换，我们可能会创建一个通用的”。py”转换器文件，这样我们就可以在任何需要的时候运行它，它可以非常快速轻松地完成工作。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="8dfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nv">我们一起连线吧！</em></p><p id="9349" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://federicotrotta.medium.com/" rel="noopener">T3】中型T5】</a></p><p id="5566" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.linkedin.com/in/federico-trotta/" rel="noopener ugc nofollow" target="_blank"> <em class="nv"> LINKEDIN </em> </a> <em class="nv">(向我发送连接请求)</em></p><p id="bcd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://twitter.com/F_Trotta90" rel="noopener ugc nofollow" target="_blank">推特</a></p><p id="c062" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nv">如果你愿意，你可以</em> <a class="ae ky" href="https://federicotrotta.medium.com/subscribe" rel="noopener"> <em class="nv">订阅我的邮件列表</em> </a> <em class="nv">这样你就可以一直保持更新了！</em></p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="f07d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑成为会员:你可以免费支持我和其他像我一样的作家。点击 <a class="ae ky" href="https://federicotrotta.medium.com/membership" rel="noopener"> <em class="nv">这里的</em> </a> <em class="nv">成为会员。</em></p></div></div>    
</body>
</html>