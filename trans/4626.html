<html>
<head>
<title>How I Automated a Tedious Task with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何用Python自动完成一项乏味的任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-automated-a-tedious-task-with-python-3c48f492575#2022-10-14">https://towardsdatascience.com/how-i-automated-a-tedious-task-with-python-3c48f492575#2022-10-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ed58" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">仅使用内置模块</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8a140cd58160c8e6bedf9082ae5665e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOkKVoTg0nQHEDF-f49txA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="e03e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python让你的生活更轻松。对于各种各样的任务，从构建高度复杂的机器学习管道到组织计算机中的文件，都有一个实用的Python解决方案。</p><p id="a1cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以我愿意称Python为“每个人的语言”。</p><p id="0266" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">回到Python这次是如何帮助我的，我有一个包含不同对象图像的文件夹列表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/d5c76b59d2cb8a7fb98c98ebfa76df96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ci876gsrlE-PIgXQrXzzpA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="013b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有超过100个文件夹，每个文件夹都有不同数量的图像。我需要做的是将每个对象的图像分成训练(75%)和验证(25%)文件夹。</p><p id="884b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">新的结构如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/438f28ae3304ef81ba816b7975927c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BOmvkT9Pa-htej3NgAe7Kw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/3478d6360fcd5caf93d7924973ec0e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_wJE4sU7dFlvZyhGo756w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="9138" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为第一步，我创建了培训和验证文件夹。然后，我将所有的子文件夹(如手风琴、飞机等)复制到这两个文件夹中。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c44d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">完成任务的步骤</h1><p id="cd40" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">任务是从训练文件夹中移除25%的图像，从验证文件夹中移除75%的图像。重要的是不要删除相同的文件夹，这样训练和验证文件夹中的图像就不同了。</p><p id="35ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不太友好和繁琐的方法是手动删除这些文件夹中的图像。这是绝对不可能的。我肯定有几种不同的实际方法来完成这项任务，但我们将使用Python。</p><p id="ae47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以将任务分为以下三个步骤:</p><ul class=""><li id="5540" class="mz na it la b lb lc le lf lh nb ll nc lp nd lt ne nf ng nh bi translated">获取图像的文件路径</li><li id="4597" class="mz na it la b lb ni le nj lh nk ll nl lp nm lt ne nf ng nh bi translated">确定要删除的内容</li><li id="02c0" class="mz na it la b lb ni le nj lh nk ll nl lp nm lt ne nf ng nh bi translated">删除它们</li></ul><p id="a70f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从第一步开始。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8817" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">文件路径</h1><p id="9f33" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">我们将使用Python的<a class="ae nn" href="https://docs.python.org/3/library/os.html" rel="noopener ugc nofollow" target="_blank"> os </a>模块来处理与路径相关的任务。listdir函数返回给定路径下文件夹中所有文件的列表。我们提供train文件夹的路径，并获得其中所有子文件夹的列表。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="7c0e" class="nt md it np b gy nu nv l nw nx">import os<br/>train_base_path = "Data/train/"<br/>train_object_list = os.listdir(train_base_path)</span><span id="b7a9" class="nt md it np b gy ny nv l nw nx">print(train_object_list[:5]) # check the first 5<br/><strong class="np iu"># output</strong><br/>['gerenuk', 'hawksbill', 'headphone', 'ant', 'butterfly']</span></pre><p id="cdc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了访问这些子文件夹中的图像，我们需要创建每个子文件夹的路径，这可以使用join方法来完成。让我们为训练对象列表中的第一个文件夹执行此操作。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="af35" class="nt md it np b gy nu nv l nw nx">folder_path = os.path.join(train_base_path, train_object_list[0])</span><span id="00d7" class="nt md it np b gy ny nv l nw nx">print(folder_path)<br/><strong class="np iu"># output</strong><br/>Data/train/gerenuk</span></pre><p id="3f63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一步是访问该文件夹中的图像，这可以使用listdir函数来完成。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="c9d0" class="nt md it np b gy nu nv l nw nx">image_list = os.listdir(folder_path)</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="21b5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">确定要删除的图像</h1><p id="5b0f" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">上一步中创建的图像列表包含指定文件夹中所有图像的名称。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="19ef" class="nt md it np b gy nu nv l nw nx">image_list[:5]</span><span id="61e5" class="nt md it np b gy ny nv l nw nx"><strong class="np iu"># output</strong><br/>['image_0019.jpg',<br/> 'image_0025.jpg',<br/> 'image_0024.jpg',<br/> 'image_0018.jpg',<br/> 'image_0020.jpg']</span></pre><p id="6e70" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一步是确定将从训练和验证文件夹中删除哪些图像。根据文件名的不同，有不同的方法来处理这个步骤。</p><p id="b80d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的例子中，所有的图像文件都用一个从0001开始的4位数来命名，但是它们没有被排序。我们可以通过以下步骤完成这项任务:</p><ul class=""><li id="9ff5" class="mz na it la b lb lc le lf lh nb ll nc lp nd lt ne nf ng nh bi translated">用Python的len函数求图片数。</li></ul><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="d365" class="nt md it np b gy nu nv l nw nx"># find the number of images<br/>number_of_images = len(image_list)</span></pre><ul class=""><li id="ddef" class="mz na it la b lb lc le lf lh nb ll nc lp nd lt ne nf ng nh bi translated">通过将图像总数乘以0.75并将其转换为整数，计算要在训练文件夹中使用的图像数。我们可以使用int函数，但它会截断浮点数(即24.8到24)。如果要对浮点数进行四舍五入(即24.8到25)，可以使用数学库中的ceil函数。</li></ul><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="9d48" class="nt md it np b gy nu nv l nw nx"># number of images in train<br/>number_of_images_train = int(number_of_images * 0.75)</span><span id="3c42" class="nt md it np b gy ny nv l nw nx"># to round up<br/>import math<br/>number_of_images_train = math.ceil(number_of_images * 0.75)</span></pre><ul class=""><li id="32f6" class="mz na it la b lb lc le lf lh nb ll nc lp nd lt ne nf ng nh bi translated">使用内置排序功能对图像列表中的图像名称进行排序。</li></ul><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="45d6" class="nt md it np b gy nu nv l nw nx">image_list.sort()</span></pre><ul class=""><li id="0f0b" class="mz na it la b lb lc le lf lh nb ll nc lp nd lt ne nf ng nh bi translated">使用序列中的图像数量确定要从序列文件夹中删除的图像，以对图像列表进行切片。</li></ul><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="846e" class="nt md it np b gy nu nv l nw nx">remove_from_train = image_list[number_of_images_train:]</span></pre><p id="7e3b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果序列中的图像数量为20，则“从序列中移除”列表包含图像列表中前20个项目之后的项目。因此，前20个项目将在train文件夹中。我们也可以使用这个值从验证文件夹中删除图像。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0e2b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">从训练和验证文件夹中删除图像</h1><p id="faf6" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">我们已确定要从训练和验证文件夹中删除的图像。为了移除它们，我们需要首先构建到图像的路径。然后，可以使用操作系统模块的删除功能删除该映像。</p><p id="d481" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于remove from train列表中的每个图像名称，可以按如下方式创建图像的文件路径:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="13e4" class="nt md it np b gy nu nv l nw nx">for image in remove_from_train:<br/>            <br/>            file_path_to_remove = os.path.join(</span><span id="5612" class="nt md it np b gy ny nv l nw nx">                train_base_path, <br/>                train_object_list[0], <br/>                image</span><span id="899f" class="nt md it np b gy ny nv l nw nx">            )</span></pre><p id="4989" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是图像文件路径示例:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="8441" class="nt md it np b gy nu nv l nw nx">'Data/train/metronome/image_0024.jpg'</span></pre><p id="9cf3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一步是删除该路径下的图像:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="0e82" class="nt md it np b gy nu nv l nw nx">os.remove(file_path_to_remove)</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c20f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">把它放在一起</h1><p id="4e78" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">所有这些步骤都将针对训练和验证文件夹中的每个子文件夹进行。因此，我们需要将它们放入一个循环中。</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="1a50" class="nt md it np b gy nu nv l nw nx">train_base_path = "Data/train/"<br/>validation_base_path = "Data/validation/"</span><span id="79ce" class="nt md it np b gy ny nv l nw nx">train_object_list = os.listdir(train_base_path)</span><span id="ff2e" class="nt md it np b gy ny nv l nw nx">for subfolder in train_object_list:<br/>    <br/>    if subfolder != ".DS_Store":</span><span id="3a1e" class="nt md it np b gy ny nv l nw nx">        print(subfolder)<br/>        subfolder_path = os.path.join(train_base_path, subfolder)</span><span id="72c4" class="nt md it np b gy ny nv l nw nx">        image_list = os.listdir(subfolder_path)<br/>        image_list.sort()</span><span id="5fcd" class="nt md it np b gy ny nv l nw nx">        number_of_images = len(image_list)<br/>        number_of_images_train = int(number_of_images * 0.75)</span><span id="ba51" class="nt md it np b gy ny nv l nw nx">        remove_from_train = image_list[number_of_images_train:]<br/>        remove_from_validation = image_list[:number_of_images_train]<br/>        <br/>        # remove from train<br/>        for image in remove_from_train:<br/>            <br/>            file_path_to_remove = os.path.join(<br/>                train_base_path, <br/>                subfolder, <br/>                image<br/>            )<br/>            os.remove(file_path_to_remove)<br/>            <br/>        # remove from validation<br/>        for image in remove_from_validation:<br/>            <br/>            file_path_to_remove = os.path.join(<br/>                validation_base_path, <br/>                subfolder, <br/>                image<br/>            )<br/>            os.remove(file_path_to_remove)</span></pre><p id="7e89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我把if条件换成一个看不见的文件夹名”。DS_Store”。即使我检查了隐藏文件，我也找不到它。如果你知道如何解决这种情况，请告诉我。</p><p id="477f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们检查前5个对象的训练和验证文件夹中的图像数量:</p><pre class="kj kk kl km gt no np nq nr aw ns bi"><span id="3573" class="nt md it np b gy nu nv l nw nx">for subfolder in train_object_list[:5]:<br/>    <br/>    subfolder_path_train = os.path.join(train_base_path, subfolder)<br/>    subfolder_path_validation = os.path.join(validation_base_path,<br/>                                             subfolder)<br/>    <br/>    train_count = len(os.listdir(subfolder_path_train))<br/>    validation_count = len(os.listdir(subfolder_path_validation))<br/>    <br/>    print(subfolder, train_count, validation_count)</span><span id="29bd" class="nt md it np b gy ny nv l nw nx"><strong class="np iu"># output</strong><br/>gerenuk 25 9<br/>hawksbill 75 25<br/>headphone 31 11<br/>ant 31 11<br/>butterfly 68 23</span></pre><p id="ccaa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看起来我们的脚本已经准确地完成了工作。</p><p id="54de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python在自动化日常任务方面非常有效，比如组织文件和文件夹、发送电子邮件等等。如果您经常做这样的任务，我强烈建议让Python为您做这些工作。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="7e8f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nz">你可以成为</em> <a class="ae nn" href="https://sonery.medium.com/membership" rel="noopener"> <em class="nz">媒介会员</em> </a> <em class="nz">解锁我的全部写作权限，外加其余媒介。如果你已经是了，别忘了订阅</em><a class="ae nn" href="https://sonery.medium.com/subscribe" rel="noopener"><em class="nz"/></a><em class="nz">如果你想在我发表新文章时收到电子邮件。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b351" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>