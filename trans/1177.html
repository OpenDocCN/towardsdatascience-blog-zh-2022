<html>
<head>
<title>Plotly Callbacks: Create Exciting Interactive Plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Plotly 回调:创建令人兴奋的互动情节</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/are-you-still-creating-boring-static-plots-its-time-to-move-on-384f49b60d16#2022-03-26">https://towardsdatascience.com/are-you-still-creating-boring-static-plots-its-time-to-move-on-384f49b60d16#2022-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5510" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在 Plotly Dash 中开始回调</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/92fdd2f7d61059f8fd060a34751577bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEyCt5N2P5sYs8hutA_EnA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Pic 鸣谢:Jason Coudriet (Unsplash)</p></figure><p id="f8fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设您想展示不同级别(地区、州、国家、年份)的零售商销售额。你会怎么做？您会创建 4-5 个不同的静态图，还是希望创建一个可以通过交互式绘图完成所有这些工作的静态图？如果你想选择第二种选择，那么这篇博客会对你有所帮助。</p><h2 id="0d10" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><strong class="ak">可能与 Plotly 破折号！</strong></h2><p id="1828" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们可以使用 Plotly dash 在 python 中轻松创建交互式绘图。使用 Plotly Dash，我们不必学习 Javascript 来为我们的情节添加交互性，我们可以使用 python 来完成。Dash 是开源的，使用该框架构建的应用程序可以在 web 浏览器上查看。</p><h2 id="fe52" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">增加互动性！</h2><p id="05b4" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">向图中添加交互性需要两步:</p><ol class=""><li id="2ef3" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">创建布局，您将在其中添加下拉列表、绘图、按钮、滑块等元素。</li><li id="cbf5" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">创建回调，将下拉菜单、滑块等连接到您的绘图。回调增加了情节的互动性。</li></ol><p id="36d3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们通过几个例子来理解这一点:</p><h1 id="6901" class="nd ls iq bd lt ne nf ng lw nh ni nj lz jw nk jx mc jz nl ka mf kc nm kd mi nn bi translated"><strong class="ak">例 1:基本回调</strong></h1><p id="c506" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在这个例子中，我们将看看基本的回调功能。我们将创建一个包含课程评级(优秀、一般、低于一般)的下拉列表，并在下拉列表下方打印与评级(5、3、1)相对应的数值。当我们改变下拉列表中的选择时，打印的值将根据选择进行更新(如下所示)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/a8221c73706d801e42945ec9d33f7e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/1*Zg1yzdfrGJ8dDpXSL0RVjg.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><p id="6ad3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 1.1 安装&amp;导入包</strong></p><p id="0990" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们从安装所需的包开始。我们需要 dash 包来初始化应用程序和设置回调，dash-html-组件创建布局，dash-core-组件创建下拉菜单，图表等。您可以使用 Anaconda Spyder，一个 python 开发环境<strong class="kx ir">、</strong>来运行代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">安装所需的软件包</p></figure><p id="26b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下面的代码中，我们将导入已安装的软件包。输入和输出将用于创建我们的回调。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="2280" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 1.2 创建布局</strong></p><p id="e8bb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在布局中，我们可以定义想要展示的所有元素。在本例中，我们希望在布局中显示一个标题、一个下拉列表和一个文本输出(使用 div 组件)。</p><p id="c1d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">布局是使用 html 创建的。Div 组件，它是一种包装布局元素的包装器。Div 组件有两个参数:</p><ol class=""><li id="3391" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">id:div 组件的唯一标识符。</li><li id="87b7" class="mp mq iq kx b ky my lb mz le na li nb lm nc lq mu mv mw mx bi translated">children:用于设置布局组件的参数。在这个参数中，我们设置了布局的标题、下拉菜单和文本输出。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="232c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在 dropdown 函数中，我们将唯一标识符“id”设置为“dropdown”，“options”设置为与这些标签对应的标签和值的列表，“value”设置为 5，这是下拉菜单的默认选择。</p><p id="2844" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下拉列表下面，我们设置 Div 组件，它将返回与下拉列表的选择相对应的值。下面我们来详细了解一下回调的情况。</p><p id="dd95" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 1.3 创建回调</strong></p><p id="e272" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本节中，我们将了解输出如何根据下拉列表的选择而变化。</p><p id="1ab7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">回调是使用@app.callback()初始化的，后面跟着一个函数，该函数在下拉列表(输入组件)的选择发生变化时被触发。破折号回调具有以下参数:</p><ol class=""><li id="a3a2" class="mp mq iq kx b ky kz lb lc le mr li ms lm mt lq mu mv mw mx bi translated">Output: Output 函数指向布局中的组件，该组件被回调函数(basic_callback())返回的对象调用/更新。</li></ol><p id="9a37" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">output 函数有两个参数——1)component _ id:它定义了我们希望用函数 basic_callback 更新的组件的 id。我们希望使用 Div 组件更新文本，因此我们将组件 id 设置为 Div 组件的 id ' output-text '。2) component_property 定义组件的属性，该属性将根据 basic_callback()返回的对象进行更新。在本例中，html 的 children 属性。Div(我们布局的一部分)将用对应于下拉选择的值进行更新。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="963b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.输入:这用于定义组件，其值的变化将触发回调。输入函数也将 component_id 和 component_property 作为参数。我们希望回调基于 dropdown 值的变化而被触发，所以我们将 component_property 设置为 dropdown 的' value '属性。请注意，输入是在列表中定义的。</p><p id="984a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">输入函数的 component 属性被设置为下拉列表的“value ”,作为函数 basic_callback 中的一个参数。basic_callback 函数将下拉列表值返回给 html 的 children 属性。使用回调的输出函数。</p><blockquote class="nr ns nt"><p id="c4d9" class="kv kw nu kx b ky kz jr la lb lc ju ld nv lf lg lh nw lj lk ll nx ln lo lp lq ij bi translated">如果你想了解更多关于 Plotly dash 的知识，那么你可以看看这个课程，它将带你从基础到高级:【https://bit.ly/311k37f T2】</p></blockquote><h1 id="b247" class="nd ls iq bd lt ne nf ng lw nh ni nj lz jw nk jx mc jz nl ka mf kc nm kd mi nn bi translated"><strong class="ak">示例 2:基于图形的回调</strong></h1><p id="634b" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在这个例子中，我们将学习如何将一个滑块和一个下拉菜单连接到一个图表/绘图。该图将显示世界不同国家的人均国内生产总值和预期寿命多年来的变化情况。图表将根据滑块(年份)和下拉列表(洲)的选择变化进行更新，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/388594ec56f53b6787816628fce53548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3x5RotTxG3zoYG00ltN0cg.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><h2 id="d7b5" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">2.1 创建布局</h2><p id="59ed" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们在下面的代码中创建了一个带有滑块、下拉菜单和图形组件的布局。我们回调函数的输出将被返回给 graph 组件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><h2 id="318f" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated"><strong class="ak"> 2.2 创建回调</strong></h2><p id="f5a5" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在这一步中，我们创建了一个回调函数，它有两个对应于滑块和下拉菜单的输入组件和一个对应于图形的输出组件。</p><p id="7a66" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在回调中，我们根据滑块和下拉菜单的输入过滤数据集，并更新散点图。plot 对象(fig)返回到图形(dcc.graph)的 figure 属性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="ab18" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你觉得这个故事有用，那么你可以通过分享掌声和评论来表达你的喜欢。想了解数据科学领域的发展动态可以关注我。</p></div><div class="ab cl oa ob hu oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ij ik il im in"><p id="22d5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以通过下面的故事了解更多关于 Dash 的知识:</p><div class="oh oi gp gr oj ok"><a rel="noopener follow" target="_blank" href="/dash-for-beginners-create-interactive-python-dashboards-338bfcb6ffa4"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ir gy z fp op fr fs oq fu fw ip bi translated">Dash for 初学者:创建交互式 Python 仪表盘</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">Dash 是什么？</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">towardsdatascience.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy kp ok"/></div></div></a></div></div></div>    
</body>
</html>