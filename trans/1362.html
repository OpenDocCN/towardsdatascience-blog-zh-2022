<html>
<head>
<title>How To Fix ValueError: Unknown label type: 'continuous' In scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何修复值错误:未知标签类型:scikit-learn中的“连续”</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/valueerror-sklearn-fix-4a5fe105536a#2022-04-05">https://towardsdatascience.com/valueerror-sklearn-fix-4a5fe105536a#2022-04-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="7c2c" class="pw-subtitle-paragraph jv it iu bd b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dk translated">了解是什么导致了scikit中连续变量的value error-learn以及如何消除它</h2></div><figure class="ko kp kq kr gu ks gi gj paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gi gj kn"><img src="../Images/dbaf924c42c2f11a608ef0f9ac8f766d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uFGSRJPdUfs78taZMbVb8g.jpeg"/></div></div><p class="kz la gk gi gj lb lc bd b be z dk translated">照片由<a class="ae ld" href="https://unsplash.com/@federicagiusti?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Federica Giusti </a>在<a class="ae ld" href="https://unsplash.com/s/photos/numbers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="ca7a" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">介绍</h2><p id="26a7" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">刚接触机器学习和Python编程的人在尝试使用<code class="fe jr js jt ju b">scikit-learn</code>包训练模型时可能会遇到一些麻烦。</p><p id="85c4" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">最常报告的问题之一与目标变量的类型有关，当观察到不适当的值时，可能会触发特定的错误。其中一个错误是<code class="fe jr js jt ju b">ValueError: Unknown label type: 'continuous'</code>,其完整的回溯共享如下。</p><pre class="ko kp kq kr gu my ju mz na aw nb bi"><span id="c321" class="le lf iu ju b gz nc nd l ne nf">Traceback (most recent call last):<br/>  File "test.py", line 14, in &lt;module&gt;<br/>    clf.fit(train_X, train_Y)<br/>  File "/usr/local/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py", line 1347, in fit<br/>    check_classification_targets(y)<br/>  File "/usr/local/lib/python3.7/site-packages/sklearn/utils/multiclass.py", line 183, in check_classification_targets<br/>    raise ValueError("Unknown label type: %r" % y_type)<br/>ValueError: Unknown label type: 'continuous'</span></pre><p id="cd68" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">在今天的简短教程中，我们将尝试重现该错误，理解为什么会出现这个异常，并最终展示如何处理它。</p></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="2148" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">重现错误</h2><p id="2174" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">首先，让我们创建一些样本数据，我们将使用这些数据来训练一个带有<code class="fe jr js jt ju b">scikit-learn</code>的示例逻辑回归模型。注意<strong class="mc iv">目标变量是连续的</strong>。</p><pre class="ko kp kq kr gu my ju mz na aw nb bi"><span id="a37c" class="le lf iu ju b gz nc nd l ne nf">import numpy as np<br/>from sklearn.linear_model import LogisticRegression<br/></span><span id="82dd" class="le lf iu ju b gz nn nd l ne nf">train_X = np.array([<br/>    [100, 1.1, 0.8],  <br/>    [200, 1.0, 6.5],  <br/>    [150, 1.3, 7.1],  <br/>    [120, 1.2, 3.0],  <br/>    [100, 1.1, 4.0],  <br/>    [150, 1.2, 6.8],<br/>])</span><span id="c964" class="le lf iu ju b gz nn nd l ne nf">train_Y = np.array([1.0, 2.1, 5.6, 7.8, 9.9, 4.5])</span><span id="0610" class="le lf iu ju b gz nn nd l ne nf">clf = LogisticRegression()<br/>clf.fit(train_X, train_Y)</span></pre><p id="ef69" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">现在，如果我们尝试执行上述代码片段，标准输出会报告以下错误:</p><pre class="ko kp kq kr gu my ju mz na aw nb bi"><span id="4abb" class="le lf iu ju b gz nc nd l ne nf">Traceback (most recent call last):<br/>  File "test.py", line 14, in &lt;module&gt;<br/>    clf.fit(train_X, train_Y)<br/>  File "/usr/local/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py", line 1347, in fit<br/>    check_classification_targets(y)<br/>  File "/usr/local/lib/python3.7/site-packages/sklearn/utils/multiclass.py", line 183, in check_classification_targets<br/>    raise ValueError("Unknown label type: %r" % y_type)<br/>ValueError: Unknown label type: 'continuous'</span></pre><p id="2dfd" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">本质上，错误告诉我们目标变量的类型是连续的，这与我们试图拟合的特定模型不兼容(即<code class="fe jr js jt ju b">LogisticRegression</code>)。</p></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="6b24" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">消除错误</h2><p id="593e" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">对于许多初学者来说，<strong class="mc iv">逻辑回归实际上用于分类</strong>而不是回归的事实是一个惊喜。我认为这是完全可以理解的，因为新来的人可能会对车型名称感到困惑。</p><p id="7ae6" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">分类器(即应该执行分类的模型)期望标签(也称为目标变量)是分类的而不是连续的(这是模型在执行回归时的期望)。</p><p id="8fdb" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">因此，在使用逻辑回归(或几乎任何分类器)时，您的第一个选择是执行<strong class="mc iv">标签编码</strong>。但是请注意，这可能不是最合适的解决方案，答案实际上取决于您的特定用例！所以对此要有所保留。</p><p id="20d3" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">在标签编码之前，我们可以使用<code class="fe jr js jt ju b">utils.multiclass.type_of_target</code>方法验证目标变量的类型。</p><pre class="ko kp kq kr gu my ju mz na aw nb bi"><span id="ac1a" class="le lf iu ju b gz nc nd l ne nf">&gt;&gt;&gt; import utils<br/>&gt;&gt;&gt; print(<!-- -->utils.multiclass.type_of_target(train_Y)<!-- -->)<br/>'continuous'</span></pre><p id="a186" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">现在，我们可以使用<code class="fe jr js jt ju b">scikit-learn</code>中的<code class="fe jr js jt ju b"><a class="ae ld" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" rel="noopener ugc nofollow" target="_blank">LabelEncoder</a></code>来执行标签编码，以便规范化目标变量。</p><pre class="ko kp kq kr gu my ju mz na aw nb bi"><span id="98c9" class="le lf iu ju b gz nc nd l ne nf">from sklearn import preprocessing</span><span id="141e" class="le lf iu ju b gz nn nd l ne nf">label_encoder = preprocessing.LabelEncoder()<br/>train_Y = label_encoder.fit_transform(train_Y)</span></pre><p id="a849" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">现在我们可以验证新编码的目标变量是多类类型:</p><pre class="ko kp kq kr gu my ju mz na aw nb bi"><span id="1ea8" class="le lf iu ju b gz nc nd l ne nf">&gt;&gt;&gt; import utils<br/>&gt;&gt;&gt; print(<!-- -->utils.multiclass.type_of_target(train_Y)<!-- -->)<br/>'multiclass'</span></pre><p id="6eeb" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">现在，我们可以使用编码的目标变量来训练我们的逻辑回归模型，没有任何问题:</p><pre class="ko kp kq kr gu my ju mz na aw nb bi"><span id="7ae4" class="le lf iu ju b gz nc nd l ne nf">from sklearn import preprocessing<br/>from sklearn.linear_model import LogisticRegression</span><span id="6367" class="le lf iu ju b gz nn nd l ne nf"># Label encoding<br/>label_encoder = preprocessing.LabelEncoder()<br/>train_Y = label_encoder.fit_transform(train_Y)</span><span id="d0fd" class="le lf iu ju b gz nn nd l ne nf"># Model training<br/>clf = LogisticRegression()<br/>clf.fit(train_X, train_Y)</span></pre><p id="d9cb" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">但是在使用标签编码之前，您可能仍然需要考虑逻辑回归是否适合您的特定用例。如果您想要对数据执行回归，那么您可能必须探索一些替代选项。</p><p id="04a3" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">要了解更多关于机器学习环境中分类和回归问题之间的区别，请务必阅读我在Medium上的一篇旧文章，分享如下。</p><div class="no np gq gs nq nr"><a href="https://medium.com/analytics-vidhya/regression-vs-classification-29ec592c7fea" rel="noopener follow" target="_blank"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">机器学习中的回归与分类</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">在机器学习的背景下讨论回归和分类问题的区别</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kx nr"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><h2 id="78f3" class="le lf iu bd lg lh li dn lj lk ll dp lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">最后的想法</h2><p id="f311" class="pw-post-body-paragraph ma mb iu mc b md me jz mf mg mh kc mi ln mj mk ml lr mm mn mo lv mp mq mr ms in bi translated">在今天的简短教程中，我们讨论了由<code class="fe jr js jt ju b">scikit-learn</code>分类器引发的<code class="fe jr js jt ju b">ValueError: Unknown label type: 'continuous'</code>错误，这些分类器根据特定模型预期的标签类型，在提供的目标变量中观察到无效值。</p><p id="3c3a" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated">我们重现了这个错误，讨论了最初为什么会出现这个错误以及如何消除它。</p></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><p id="1b77" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated"><a class="ae ld" href="https://gmyrianthous.medium.com/membership" rel="noopener"> <strong class="mc iv">成为会员</strong> </a> <strong class="mc iv">阅读媒介上的每一个故事。你的会员费直接支持我和你看的其他作家。你也可以在媒体上看到所有的故事。</strong></p><div class="no np gq gs nq nr"><a href="https://gmyrianthous.medium.com/membership" rel="noopener follow" target="_blank"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">通过我的推荐链接加入Medium-Giorgos Myrianthous</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">gmyrianthous.medium.com</p></div></div><div class="oa l"><div class="og l oc od oe oa of kx nr"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><p id="676e" class="pw-post-body-paragraph ma mb iu mc b md mt jz mf mg mu kc mi ln mv mk ml lr mw mn mo lv mx mq mr ms in bi translated"><strong class="mc iv">相关文章你可能也喜欢</strong></p><div class="no np gq gs nq nr"><a rel="noopener follow" target="_blank" href="/scikit-learn-vs-sklearn-6944b9dc1736"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">Scikit-Learn和Sklearn有区别吗？</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">Python中的scikit-learn与sklearn</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="oh l oc od oe oa of kx nr"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><div class="ko kp kq kr gu nr"><a rel="noopener follow" target="_blank" href="/predict-vs-predict-proba-scikit-learn-bdc45daa5972"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">scikit-learn中的predict()和predict_proba()有什么区别？</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">如何对数据集使用predict和predict_proba方法来执行预测</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="oi l oc od oe oa of kx nr"/></div></div></a></div></div><div class="ab cl ng nh hy ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="in io ip iq ir"><div class="ko kp kq kr gu nr"><a rel="noopener follow" target="_blank" href="/training-vs-testing-vs-validation-sets-a44bed52a0e1"><div class="ns ab fp"><div class="nt ab nu cl cj nv"><h2 class="bd iv gz z fq nw fs ft nx fv fx it bi translated">培训vs测试vs验证集</h2><div class="ny l"><h3 class="bd b gz z fq nw fs ft nx fv fx dk translated">在机器学习的背景下讨论训练、测试和验证数据之间的差异</h3></div><div class="nz l"><p class="bd b dl z fq nw fs ft nx fv fx dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="oj l oc od oe oa of kx nr"/></div></div></a></div></div></div>    
</body>
</html>