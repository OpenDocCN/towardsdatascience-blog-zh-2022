<html>
<head>
<title>Cross-Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">交叉验证</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cross-validation-705644663568#2022-04-14">https://towardsdatascience.com/cross-validation-705644663568#2022-04-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="05d8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">它是什么，为什么使用它？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d48b4983e01aaf743b860b5e7846cf4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dG5bGgRgpopzbaLg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@jeroendenotter?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">耶鲁安穴獭</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="13d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回归和分类机器学习模型旨在从数据中包含的变量预测值或类。每个模型都有自己的算法来尝试识别数据中包含的模式，从而做出准确的预测。</p><p id="a5da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">模型除了要准确，还必须是通才，能够解释以前从未见过的数据，并得出适当的结果。评估模型泛化能力的一种方法是应用交叉验证。</p><h1 id="fc97" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">但是什么是交叉验证呢？</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/b1ce2bea3893ce5180eedbf3095d5f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xdyTNs_iyPzuiILF"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@lamunix?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">市政府</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="6909" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">交叉验证是一种用于获得模型整体性能评估的技术。有几种交叉验证技术，但它们基本上都是将数据分成训练和测试子集。</p><p id="04c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">顾名思义，训练子集将在训练过程中用于计算模型的超参数。为了计算模型的泛化能力，在训练阶段之后，使用测试模型。</p><p id="7cd5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用来自测试数据集的真实标签和由经过训练的模型对测试数据做出的预测来计算模型的性能度量，例如准确度(分类)和均方根绝对误差(回归)。</p><p id="755f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">交叉验证技术有很多种，在这篇文章中我将讨论其中的三种:<strong class="ky ir">保持</strong>、<strong class="ky ir"> K-Fold </strong>和<strong class="ky ir">留一法。</strong></p><h1 id="ea73" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">维持交叉验证</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/01b0fc72deac9ab3a0e2f4aee6dc7f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GoN9QfY5eqw_D2Bj"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@coffeegeek?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">咖啡极客</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="842a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可能最著名的交叉验证技术是拒绝验证。该技术包括将整个数据集分成两组，没有重叠:训练集和测试集。根据项目的不同，这种分离可以是混排数据，也可以是保持数据的排序。</p><p id="ca42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在项目和研究中通常会看到70/30的分割，其中70%的数据用于训练模型，其余30%用于测试和评估模型。但是，这个比率不是一个规则，它可能会根据项目的特殊性而变化。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/3295b357a89591abb22c87cd40c08025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gY_JIOSY9padVi8Zms4Eiw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">应用于数据集的维持交叉验证示例-按作者分类的图像</p></figure><p id="9042" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Python中，使用scikit-learn库中的<code class="fe mn mo mp mq b">train_test_split</code> <a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank">函数</a>可以轻松完成维持交叉验证。</p><p id="953d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<a class="ae kv" href="https://archive.ics.uci.edu/ml/datasets/breast+cancer+wisconsin+(diagnostic)" rel="noopener ugc nofollow" target="_blank">乳腺癌数据集</a>和70/30分割，我们得到:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h1 id="b4fd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">k倍交叉验证</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/a56407cba164958882adf10f73b7a297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yhc55Z3S9qT676Hy"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@tsbcreative?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安迪·霍尔</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="9096" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在将数据分成训练集和测试集之前，K-Fold交叉验证将整个数据分成K个大小近似的独立子集。只有这样，每个子集才会被分成训练集和测试集。</p><p id="571f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个子集用于训练和测试模型。在实践中，这种技术产生K个不同的模型和K个不同的结果。K倍交叉验证的最终结果是每个子集的单个指标的平均值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/238072d26d1cc316c1704b2782bb5b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S6YufnpPinCHf_MkqxDDvA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">应用于数据集的三重交叉验证示例-按作者分类的图像</p></figure><p id="863e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">值得注意的是，由于K倍将原始数据划分为更小的子集，因此必须考虑数据集的大小和K个子集。如果数据集很小或者K的数量太大，那么产生的子集可能会变得非常小。</p><p id="c986" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这可能导致只有少量数据用于训练模型，从而导致性能不佳，因为算法由于缺乏信息而无法理解和学习数据中的模式。</p><p id="4ce0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Python也有一种简单的方法来执行K-Fold分割，即使用来自<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn库</a>的<code class="fe mn mo mp mq b">Kfold</code>。</p><p id="8382" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用与之前相同的数据集，K = 3，我们得到:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="e364" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基本上，维持交叉验证与一折交叉验证相同。</strong></p><h1 id="85eb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">留一交叉验证</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/014dba0445994215a60baf7a4cdd2321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C8C_NrUdutsIluWS"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">威尔·梅尔斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="d4d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">留一交叉验证包括创建多个训练和测试集，其中测试集仅包含原始数据的一个样本，而训练集包含原始数据的所有其他样本。对原始数据集中的所有样本重复此过程。</p><p id="c72d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种类型的验证通常非常耗时，因为如果使用的数据包含<em class="mv"> n </em>个样本，算法将不得不训练(使用<em class="mv"> n-1 </em>个样本)并评估模型<em class="mv"> n </em>次。</p><p id="6e24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从积极的一面来看，这种技术，在本文所见的所有技术中，是模型中用于训练的样本量最大的一种，这可能会产生更好的模型。此外，不需要打乱数据，因为所有可能的训练/测试集的组合都将被生成。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/936c7723fb68ccdf9d5500f3644da361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Si773HvZYTHVLFdWkei_9g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">应用于数据集的留一交叉验证示例-按作者分类的图像</p></figure><p id="f698" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<code class="fe mn mo mp mq b">LeaveOneOut</code>在<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.LeaveOneOut.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn库</a>也可以进行留一交叉验证</p><p id="dfa5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用乳腺癌数据集，我们有:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="84c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与维持类似，留一交叉验证也是一种特殊类型的K-Fold，其中K的值等于数据集的样本数。</p><h1 id="0446" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">性能比较</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/323773fe9d8bfc257fc600ca464c6f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*elPkTKcgdgSgDc0P"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@sabrituzcu?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sabri Tuzcu </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2420" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了显示每种交叉验证的性能差异，这三种技术将与简单的决策树分类器一起使用，以预测乳腺癌数据集中的患者是良性(1类)还是恶性(0类)肿瘤。为了进行比较，将使用70/30分割、3折和留一的维持。</p><p id="7957" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用的代码可以在我的github页面找到:<a class="ae kv" href="https://github.com/alerlemos/medium/blob/main/cross_validation/cross_validation_examples.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/alerlemos/medium/blob/main/cross _ validation/cross _ validation _ examples . ipynb</a></p><p id="dc6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">获得的结果如下表所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/cd1aedbb64f0972fb0ecb80dc7de2c95.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*TDtyVBfZKsFmUGAvSDA_AA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">每种交叉验证技术获得的结果</p></figure><p id="5894" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如预期的那样，与其他两种技术相比，留一法的运行时间要长得多，尽管它使用了更多的数据来训练模型，但总体而言它并不是最佳性能。</p><p id="e12c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">解决这个特定问题的最佳技术是维持交叉验证，其中70%的数据用于培训，30%用于测试模型。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/2d1aabe239cafa842dc3ae1f512e74db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mUl4EoFcx9weDtkn"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1522" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读，希望对您有所帮助。</p><p id="d703" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">欢迎任何意见和建议。</p><p id="e1d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请随时通过我的Linkedin联系我，并查看我的GitHub。</p><p id="b948" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.linkedin.com/in/alexandre-rosseto-lemos/" rel="noopener ugc nofollow" target="_blank">领英</a></p><p id="f63d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/alerlemos" rel="noopener ugc nofollow" target="_blank"> Github </a></p></div></div>    
</body>
</html>