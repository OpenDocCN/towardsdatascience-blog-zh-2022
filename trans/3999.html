<html>
<head>
<title>3 Common Modeling Mistakes In Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的3个常见建模错误</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-common-modeling-mistakes-in-machine-learning-4551829a8fd1#2022-09-06">https://towardsdatascience.com/3-common-modeling-mistakes-in-machine-learning-4551829a8fd1#2022-09-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7761" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索可能妨碍模型性能的简单缺陷</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/244a365419cf0a47dc53061d53c6b922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D51iBMlDphO6ehRF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</p></figure><p id="27a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">建模可以说是机器学习任务中最有趣的部分。</p><p id="ebb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，您可以使用经过精心处理和转换的数据来构建一个可以生成预测的模型。</p><p id="0482" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管与数据预处理和特征工程相比，模型构建所需的时间更少，但很容易做出看似无害的决定，从而导致模型性能不佳。</p><p id="29bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们探讨一些常见的错误，这些错误不利于用户训练和调整一个可靠的模型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="bcc6" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">典型的例子</h2><p id="5084" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">与数据预处理和特征工程相比，建模阶段相对容易执行。</p><p id="a497" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，让我们使用Scikit学习包中的一个玩具数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="62bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们正在寻找创建一个梯度推进分类器，可以用这些数据生成预测。用于定型和调整模型的代码可能如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="3da7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅通过这个片段，我们就可以:</p><ul class=""><li id="0bb0" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated">具有不同超参数值的测试模型</li><li id="dd1c" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">实施交叉验证分割策略以避免过度拟合</li><li id="af71" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated">使用性能最佳的模型生成预测</li></ul><p id="4a18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用这么少的代码做了这么多的工作。这就是Scikit学习包的强大之处。</p><p id="2e88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从表面上看，这种方法似乎完美无缺，但是存在一些缺陷，可能会影响模型的性能。让我们来看看机器学习任务中常见的几个错误。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="60be" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">错误1:没有使用基线模型</h2><p id="aeda" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在建模阶段，许多人急于直接使用会带来更多复杂性的算法。毕竟，复杂性通常与有效性联系在一起。</p><p id="ee44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可惜，多不一定好。复杂模型产生与简单算法相同的性能(如果不是更差的话)是很常见的。</p><p id="8ef0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有可能感兴趣的算法的基本假设不适合数据。也许用来训练模型的数据集一开始就没有太多的预测能力。</p><p id="0a38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了说明这种情况，能够将调优模型的结果放在上下文中是很重要的。用户可以通过建立基线模型来恰当地评估他们复杂模型的性能。</p><p id="8358" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基线模型是一个简单的模型，作为一个复杂的模型建立方法是否真正获益的指示器。</p><p id="7eb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，在准备好数据后立即构建复杂的模型可能很诱人，但是您构建的第一个模型应该始终是基线模型。</p><blockquote class="nq nr ns"><p id="322f" class="kz la nt lb b lc ld ju le lf lg jx lh nu lj lk ll nv ln lo lp nw lr ls lt lu im bi translated">要快速了解基线模型，请查看以下文章:</p></blockquote><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/baseline-models-your-guide-for-model-building-1ec3aa244b8d"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">基线模型:您的模型构建指南</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">机器学习项目中的一个必要组成部分</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ks oa"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="e3a9" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">错误2:使用小范围的超参数</h2><p id="b4fb" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">超参数调优的一个常见缺陷是只探索小范围的超参数值。</p><p id="9417" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">超参数调整应使用户能够确定产生最佳结果的超参数值。然而，只有当被测试的值的范围足够大时，这个过程才能达到它的目的。</p><p id="4102" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果值甚至不在搜索空间中，调优过程如何识别最佳超参数值？</p><p id="3a00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在前面的例子中，<code class="fe op oq or os b">learning_rate</code>超参数的搜索空间仅包括0.1和10之间的3个值。如果最佳值超出此范围，则在调整过程中不会被检测到。</p><p id="c414" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于许多机器学习算法，模型性能严重依赖于某些超参数。因此，用小范围的值来调优模型是不可取的。</p><p id="d99b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户可以选择使用更小范围的超参数值，因为更大数量的值将需要更多的计算，并将导致更长的运行时间。</p><p id="8f4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这种情况，最好不要使用较小范围的值，而是切换到需要较少时间和计算量的超参数调优方法。</p><p id="2de7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网格搜索是一种有效的超参数调整方法，但也有其他合适的替代方法。</p><blockquote class="nq nr ns"><p id="02a2" class="kz la nt lb b lc ld ju le lf lg jx lh nu lj lk ll nv ln lo lp nw lr ls lt lu im bi translated">如果您有兴趣探索超参数调整的其他替代方法，请查看以下文章:</p></blockquote><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/grid-search-vs-random-search-vs-bayesian-optimization-2e68f57c3c46"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd iu gy z fp of fr fs og fu fw is bi translated">网格搜索VS随机搜索VS贝叶斯优化</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">哪种超参数调优方法最好？</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="ot l ol om on oj oo ks oa"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="5233" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">错误3:使用错误的评估标准</h2><p id="6d9a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">看到一个评分很高的模特总是很开心。不幸的是，基于错误的评估度量训练的模型是无用的。</p><p id="0027" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用户在使用默认值<code class="fe op oq or os b">scoring</code>参数的同时执行网格搜索并不罕见。网格搜索中默认的评分标准是准确性，这在很多情况下并不理想。</p><p id="0d00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，对于不平衡的数据集，精度度量是一个很差的评估度量。精确度、召回率或f1值可能更合适。</p><p id="0012" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说，即使像f-1分数这样的稳健指标也可能不理想。f-1分数同等地权衡精确度和召回率。然而，在许多应用中，假阴性可能比假阳性更有害，反之亦然。</p><p id="b765" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，用户可以根据业务案例定制自己的评估指标。这样，用户将能够调整他们的模型，以实现所需类型的性能。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="bfe4" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">纠正以前的错误</h2><p id="bb9d" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">这里有一个用代码解决这些错误的简单例子。</p><p id="49c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们可以创建一个基线模型，它将被用来衡量训练模型的性能。具有默认参数的简单K-最近邻模型就足够了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="0e2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以继续使用GridSearchCV对象来训练和调整梯度增强分类器。这一次，我们将考虑更大范围的<code class="fe op oq or os b">learning_rate</code>超参数值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="b2d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，不使用准确性作为评估度量，让我们假设我们想要考虑精确度和召回率，同时对召回率给予更大的权重(即，更多地惩罚假阴性)。</p><p id="b65d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个解决方案是在Scikit Learn中用<code class="fe op oq or os b">make_scorer</code>包装器创建一个自定义指标，这使我们能够在网格搜索中使用f-beta分数(beta=2)作为评估指标。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7bd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">利用改进的超参数搜索空间和评估度量，我们现在可以执行网格搜索并调整梯度推进分类器。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="6b48" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">结论</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/4ec3807dbcebd1da13aa3556b10052f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ILpZpKyV-A8Kavm-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@prateekkatyal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>拍摄的照片</p></figure><p id="aa1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习任务的建模阶段比预处理和特征工程阶段耗时少得多，但在此阶段仍然容易出错，这可能会妨碍整体模型性能。</p><p id="129d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢天谢地，Python强大的机器学习框架完成了大部分繁重的工作。只要您将优化模型的结果与基线联系起来，考虑各种超参数值，并使用适合应用的评估指标，您的模型就更有可能产生令人满意的结果。</p><p id="f9f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我祝你在数据科学的努力中好运！</p></div></div>    
</body>
</html>