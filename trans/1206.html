<html>
<head>
<title>A Deep Dive into the Variance-Covariance Matrices of Classical Linear Regression Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入探究经典线性回归模型的方差-协方差矩阵</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-deep-dive-into-the-variance-covariance-matrices-of-classical-linear-regression-models-4322b2cdc8e6#2022-03-28">https://towardsdatascience.com/a-deep-dive-into-the-variance-covariance-matrices-of-classical-linear-regression-models-4322b2cdc8e6#2022-03-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/66c7bdbfc808e495ff60a474864551fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-TbfyG4hQldybtelNhBVA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">拟合系数的方差-协方差矩阵(图片由作者提供)</p></figure><div class=""/><div class=""><h2 id="17a5" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">关于如何构造方差-协方差矩阵以及何时对报告的数据持怀疑态度的教程</h2></div><p id="ffd4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我写这篇文章是基于一个主题，我希望对于那些有数学倾向的人，以及那些想知道什么是标准误差或者它们来自哪里的人来说，阅读这篇文章是一种享受。</p><p id="816b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">作为概念的快速复习:<strong class="kw jg">方差</strong>是随机变量围绕其均值(也称为其期望值)的“扩散”或变化的度量，而<strong class="kw jg">协方差</strong>度量两个随机变量之间的相关性。</p><p id="066f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">标准误差</strong>就是误差的标准偏差，其中“误差”有不同的含义，这取决于它是用于回归变量系数的上下文中，还是用于模型整体预测的上下文中。我们很快就会谈到这一点。</p><p id="e130" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">方差-协方差矩阵</strong>是一个方阵，即它具有相同数量的行和列。沿着矩阵主对角线的元素，即从左上到右下的元素，包含方差，而所有其他元素包含协方差。因此，回归模型的拟合系数的<strong class="kw jg">方差-协方差矩阵包含拟合模型的系数估计沿其主对角线的方差，并且包含非对角线元素中的系数估计之间的成对协方差。</strong></p><p id="a063" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">类似地，回归模型的误差项的<strong class="kw jg">方差-协方差矩阵包含每个误差项沿其主对角线的方差以及其他地方所有误差项对之间的协方差。</strong></p><p id="a1ee" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" rel="noopener" target="_blank" href="/an-illustrated-guide-to-the-variance-covariance-matrices-used-in-regression-analysis-3eb5a5dd2cff">在我之前的文章</a>中，我们直观地感受到了为什么拟合模型的系数或误差项表现出方差，以及这些矩阵在回归建模中扮演的角色。</p><p id="32b0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在本文中，我们将使用<strong class="kw jg"> C </strong>经典<strong class="kw jg"> L </strong>线性<strong class="kw jg"> R </strong>回归<strong class="kw jg"> M </strong>模型(CLSR)作为工具，展示系数估计的方差-协方差矩阵和误差的方差-协方差矩阵的公式是如何从 CLSR 模型及其解的基本假设中自然出现的。尽管我介绍的材料是针对线性模型的，但总体概念方法贯穿于许多其他普遍使用的回归模型。</p><p id="1287" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">本文是关于方差-协方差矩阵的两个系列文章的第 2 部分:</p><p id="817d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">第 1 部分:<a class="ae lq" rel="noopener" target="_blank" href="/an-illustrated-guide-to-the-variance-covariance-matrices-used-in-regression-analysis-3eb5a5dd2cff">回归分析中使用的方差-协方差矩阵图解指南</a> <br/> <strong class="kw jg">第 2 部分:深入探究经典线性回归模型的方差-协方差矩阵</strong></p><p id="9be1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们将在本文中遇到一些非常简单的线性代数(阅读:矩阵和矩阵上的运算)。</p><p id="d79f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">首先，我们将快速(重新)熟悉一些基本的线性代数概念。</p><h1 id="4676" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">线性代数简明入门</h1><p id="0309" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><strong class="kw jg">矩阵乘法:</strong>如果<strong class="kw jg"> <em class="mo"> A </em> </strong>的列数等于<strong class="kw jg"> <em class="mo"> B </em> </strong>的行数，则两个矩阵<strong class="kw jg"> <em class="mo"> A </em> </strong>和<strong class="kw jg"> <em class="mo"> B </em> </strong>可以相乘。得到的矩阵的维数是<strong class="kw jg"> <em class="mo"> A </em> </strong>的行数乘以<strong class="kw jg"> <em class="mo"> B </em> </strong>的列数。下图说明了该产品的操作。为了简单起见，我们去掉了矩阵<strong class="kw jg"><em class="mo"/></strong>的列下标。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mp"><img src="../Images/37154803014f3011247915682834480e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OC9SX5DWImBq-L3oIeS0eg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"> X </strong>和<strong class="bd mu"> <em class="mv"> β </em> </strong>的矩阵乘法(图片由作者提供)</p></figure><p id="f781" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">矩阵的转置:</strong>矩阵的转置产生于矩阵的行和列的互换。就好像矩阵被翻转过来了。这里是回归矩阵<strong class="kw jg"> <em class="mo"> X </em> </strong>和它的转置<strong class="kw jg"><em class="mo">X’</em></strong>(读作<strong class="kw jg"> <em class="mo"> X </em> </strong> <em class="mo">质数</em>):</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/c84303d9caf43e9f4d04221030766f4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUfCNJBPBEEro6idtEzUQQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归矩阵 X 的转置 X’(图片由作者提供)</p></figure><p id="8416" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg"><em class="mo">X '</em>和<em class="mo"> X </em> : </strong>大小为<em class="mo"> (k x n) </em>的<strong class="kw jg"> <em class="mo"> X' </em> </strong>与大小为<em class="mo"> (n x k) </em>的<em class="mo"/>相乘得到大小为<em class="mo"> (k x 正如我们将很快看到的，矩阵<strong class="kw jg"><em class="mo">X’X</em></strong>在回归分析中随处可见。</em></p><p id="1299" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们重温一下我在上一篇关于方差-协方差矩阵的文章中看到的汽车数据集:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/bb1bec16202b003fb5001d05d002afdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*8GcJ3au4tMekHqlznPRD2Q.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">汽车数据集的子集(来源:<a class="ae lq" href="https://archive.ics.uci.edu/ml/datasets/automobile" rel="noopener ugc nofollow" target="_blank">加州大学欧文分校</a>)</p></figure><p id="8a5b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们将创建一个回归矩阵<strong class="kw jg"> <em class="mo"> X </em> </strong>，包含以下 3 个回归变量:</p><p id="0002" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">城市 _MPG <br/>发动机 _ 尺寸<br/>整备质量</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi my"><img src="../Images/3d32588be362c5c9ffb59fc7e9fa1717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*9joYnC4_w307PSQJBYXtkg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归矩阵<strong class="bd mu"> <em class="mv"> X </em> </strong>(图片作者提供)</p></figure><p id="7416" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">下面是<strong class="kw jg"><em class="mo">X</em></strong><em class="mo">’</em>的样子:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/bf9c889a8af73f774fd1cc71af0a01d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yxd0JnBWJHTbYkfm1L-AMQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归矩阵 X 的转置(图片来自作者)</p></figure><p id="5695" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这是我们汽车数据集中 205 号样本的<strong class="kw jg"> <em class="mo"> X'X </em> </strong>矩阵。可以看到，<strong class="kw jg"><em class="mo">X</em></strong><em class="mo">'</em><strong class="kw jg"><em class="mo">X</em></strong>是一个<em class="mo">(3×3)</em>矩阵:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/e9b15fc99bbc2a7f44c76fea9736c306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqEhMCxLcruwbKpYzolcdg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"> <em class="mv"> X'X </em> </strong>用于自动数据集中大小为 20 的样本(图片由作者提供)</p></figure><p id="bf31" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">以下是一些与转置操作相关的有用恒等式:</p><ul class=""><li id="7c06" class="nb nc jf kw b kx ky la lb ld nd lh ne ll nf lp ng nh ni nj bi translated">两个矩阵乘积的<strong class="kw jg">转置</strong>是单个矩阵按<em class="mo">逆序</em>:<br/>(<strong class="kw jg">AB</strong>)' =<strong class="kw jg"><em class="mo">B</em></strong><em class="mo">'</em><strong class="kw jg"><em class="mo">A</em></strong><em class="mo">'</em></li><li id="7a54" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp ng nh ni nj bi translated">转置矩阵的<strong class="kw jg">转置返回原始矩阵:(<strong class="kw jg"><em class="mo">X</em></strong>')' =<strong class="kw jg"><em class="mo">X</em></strong></strong></li></ul><p id="8d07" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">单位矩阵:</strong>单位矩阵沿主对角线(从左上到右下)包含 1，在所有其他元素中包含 0。通常表示为<strong class="kw jg"><em class="mo">I</em></strong><em class="mo">_ n</em>(<strong class="kw jg"><em class="mo">I</em></strong>下标<em class="mo"> n </em>或简称为<strong class="kw jg"> <em class="mo"> I </em> </strong> <em class="mo"> </em>，是一个维数为<em class="mo">(n×n)</em>的方阵。单位矩阵在概念上是数字<em class="mo"> 1 </em>的多维版本。<strong class="kw jg"><em class="mo">I</em></strong><em class="mo">_ n</em>具有以下属性:</p><ul class=""><li id="c54a" class="nb nc jf kw b kx ky la lb ld nd lh ne ll nf lp ng nh ni nj bi translated"><strong class="kw jg"><em class="mo">I</em></strong><em class="mo">_ n</em>的任意次方等于<strong class="kw jg"><em class="mo">I</em></strong><em class="mo">_ n .例如对于</em><strong class="kw jg"><em class="mo">I</em></strong><em class="mo">=</em><strong class="kw jg"><em class="mo">I</em></strong></li><li id="3ae0" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp ng nh ni nj bi translated">任意矩阵的<strong class="kw jg"> <em class="mo"> Z </em> </strong>的大小<em class="mo">(m×n)</em>乘以<strong class="kw jg"><em class="mo">I</em></strong><em class="mo">_ n</em>返回<strong class="kw jg"><em class="mo"/></strong>Z .<strong class="kw jg"><em class="mo">子</em> </strong> <em class="mo"> = </em> <strong class="kw jg"/></li><li id="4367" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp ng nh ni nj bi translated"><strong class="kw jg"> <em class="mo">的逆 I </em> </strong> <em class="mo"> _n </em>是<strong class="kw jg"> <em class="mo"> I </em> </strong> <em class="mo"> _n </em>。这在概念上类似于知道<em class="mo"> 1 </em>除以<em class="mo"> 1 </em>等于<em class="mo"> 1。</em></li><li id="84ef" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp ng nh ni nj bi translated">任何大小为<em class="mo">(n×n)</em>的可逆方阵<strong class="kw jg"> <em class="mo"> Z </em> </strong>乘以其逆矩阵的乘积<strong class="kw jg"><em class="mo">I</em></strong><em class="mo">_ n</em>。最后一个性质将我们带到下一个概念——矩阵的逆。</li></ul><p id="aa19" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">矩阵的逆:</strong>矩阵的逆在概念上是标量数的逆的多维等价形式<em class="mo"> N. </em>矩阵的逆是用一个有点复杂的公式计算的，我们现在跳过这个公式。在回归分析中，关于矩阵的逆矩阵，需要记住以下几点:</p><ul class=""><li id="8b00" class="nb nc jf kw b kx ky la lb ld nd lh ne ll nf lp ng nh ni nj bi translated"><strong class="kw jg"> <em class="mo"> X </em> </strong>的倒数用上标-1 表示为<strong class="kw jg"><em class="mo">x</em></strong><em class="mo">【^(-1】</em>即<strong class="kw jg"> <em class="mo"> X </em> </strong>。</li><li id="442e" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp ng nh ni nj bi translated">只有“可逆”矩阵才有逆。在标量世界中，零没有有意义的倒数。1/0 = ?？。矩阵也是同样的概念。</li><li id="e2de" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp ng nh ni nj bi translated">方阵的逆矩阵<strong class="kw jg"><em class="mo">x</em></strong><em class="mo">^(-1)</em>乘以<strong class="kw jg"> <em class="mo"> X </em> </strong>等于<strong class="kw jg"><em class="mo">I</em></strong><em class="mo">_ n</em>。即<strong class="kw jg"><em class="mo">x</em></strong><em class="mo">【^(-1】</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">=</em><strong class="kw jg"><em class="mo">I .</em></strong>正如在标量世界里，<em class="mo"> 1/n </em>乘以<em class="mo"> n </em>就是<em class="mo"> 1 </em>。</li></ul></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="6c94" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">现在让我们将这些概念应用于手头的主题，即线性回归模型的协方差矩阵的推导。</p><h1 id="9198" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">回归模型的方差-协方差矩阵的公式</h1><p id="8a9d" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们将从线性回归模型的方程开始，如下所示:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/1835a39d95e6afbe8f6307a90111cf50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*dSAYs2eJbWhSUu0gGAO7xw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性回归模型(图片来自作者)</p></figure><p id="17e8" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上式中，<strong class="kw jg"> <em class="mo"> y </em> </strong>为因变量，<strong class="kw jg"> <em class="mo"> X </em> </strong>为回归变量的矩阵，<strong class="kw jg"> <em class="mo"> β </em> </strong>为回归系数的向量<em class="mo"> β_1，β_2，β_3，…，β_k </em>包含各系数的<em class="mo">种群水平</em>值(包括截距<em class="mo"> β_1 </em> <strong class="kw jg"> ) </strong><strong class="kw jg"><em class="mo"/></strong>是<strong class="kw jg"> <em class="mo"> y </em> </strong>的观测值与<strong class="kw jg"> <em class="mo"> y </em> </strong>的建模值之差。误差项反映了所有未建模或无法建模的影响。</p><p id="70c4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们假设<strong class="kw jg"> <em class="mo"> X </em> </strong>的第一列是为回归的截距<em class="mo"> β_1 </em>保留位置的 1 的列。</p><p id="2f6c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这是矩阵形式:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1b23fa9b26eb49c0f3daf989322446c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*e8S5HuOz17CatvaPcScKzA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性回归模型的矩阵形式(图片由作者提供)</p></figure><p id="a92e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在大小为<em class="mo"> n </em>的样本上求解(也称为“拟合”)该模型，产生了<strong class="kw jg">β<em class="mo">β</em>β</strong>的估计值，我们将其表示为<strong class="kw jg">β_ cap。 </strong>因此，拟合后的模型看起来是这样的:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/d5820c4c9f0a5c3d6daf8f6c8a3aa12d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*52OEk83yaXvRd_64OEw7qQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">拟合线性模型(图片由作者提供)</p></figure><p id="bd2c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上式中，<strong class="kw jg"> <em class="mo"> e </em> </strong>是<strong class="kw jg">残差</strong>(又名<strong class="kw jg">残差</strong>)的向量。残差<strong class="kw jg"> <em class="mo"> e </em> </strong>是<strong class="kw jg"> <em class="mo"> y </em> </strong>的观测值与拟合模型预测的值<strong class="kw jg"> <em class="mo"> y_cap </em> </strong>之差。</p><p id="4f6f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">如果使用最小平方最小化技术拟合模型，即所谓的<strong class="kw jg">O</strong>rdinary<strong class="kw jg">L</strong>east<strong class="kw jg">S</strong>quares(OLS ),我们寻求最小化以下残差平方和，也称为<strong class="kw jg">R</strong>ESI dual<strong class="kw jg">S</strong>um of<strong class="kw jg">S</strong>quares(RSS):</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/b7b223fb34bf1272a6cbefafab862ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YLDvxgQdztozPU2Xd0LVQA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">残差平方和(图片由作者提供)</p></figure><p id="2482" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上式中，<strong class="kw jg"><em class="mo">X</em></strong><em class="mo">_ I</em>是回归矩阵<strong class="kw jg"> <em class="mo"> X </em> </strong>的第<em class="mo">行。</em></p><p id="f736" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">现在，我们将推导出一个基于矩阵的公式，用于表示<strong class="kw jg"> S </strong>方的<strong class="kw jg"> R </strong> esidual <strong class="kw jg"> S </strong> um。</p><p id="cb0d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们重新检查等式(1)中的误差项<strong class="kw jg"> <em class="mo">、ϵ </em> </strong>的向量。对于大小为<em class="mo"> n </em>，<strong class="kw jg"> <em class="mo">的样本，ϵ </em> </strong> <em class="mo"> </em>是大小为<em class="mo">(n×1)</em>的列向量:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/bee7e8c138a4f1d780d9a2e878b7dce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/1*hQNC9wPHCECoWHgrfaA8sw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归误差向量(图片由作者提供)</p></figure><p id="f065" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">每个<em class="mo"> ϵ_i </em>都是一个随机变量，它有一个取决于<strong class="kw jg"><em class="mo"/></strong>的特定均值(也称为<strong class="kw jg">期望</strong>),以及一个取决于<strong class="kw jg"><em class="mo"/></strong>的围绕该均值的特定方差。</p><p id="8a93" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg"> <em class="mo"> ϵ </em> </strong>的条件期望的列向量表示为<em class="mo">e(</em><strong class="kw jg"><em class="mo">ϵ</em></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)</em>:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/6df32b20c1645c940d9e2c1a6de072ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*46k0DDwD5cLNKpG1cj_F3w.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归误差的条件期望(图片由作者提供)</p></figure><p id="45ff" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">从<strong class="kw jg"><strong class="kw jg"><em class="mo">中减去<em class="mo">e(</em></em></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)</em><em class="mo">【ϵ</em></strong>得出以下结果:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/214072689642ca4eac0a1254e79d750d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*Fi1OP1QAjN6XgZFZLNlbUQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">平均居中误差项(图片由作者提供)</p></figure><p id="d879" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">转置这个以平均值为中心的列向量会产生下面的行向量:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/63018673e758215b0dcfd8637e25e2fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*coImuUq8JqHfrlOJhJol3A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">平均居中误差项的转置(图片由作者提供)</p></figure><p id="1c52" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">接下来，让我们乘(<strong class="kw jg"><em class="mo"/></strong><em class="mo">—e(</em><strong class="kw jg"><em class="mo">【ϵ】</em></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)</em>)‘同(<strong class="kw jg"><em class="mo"/></strong><em class="mo">—e(</em><strong class="kw jg"><em class="mo"/></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x 注意，(<strong class="kw jg"><em class="mo">【ϵ】</em></strong><em class="mo">—e(</em><strong class="kw jg"><em class="mo">【ϵ】</em></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)</em>'是大小为<em class="mo">(1x n)</em><strong class="kw jg"><em class="mo">【ϵ</em></strong><em class="mo">—e(</em><strong class="kw jg">)遂积(<strong class="kw jg"><em class="mo">【ϵ】</em></strong><em class="mo">—e(</em><strong class="kw jg"><em class="mo">【ϵ】</em></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)’(<strong class="kw jg"><em class="mo"/></strong><em class="mo">—e(</em><strong class="kw jg"><em class="mo"/>)下图举例说明了(<strong class="kw jg"><em class="mo"/></strong><em class="mo">—e(</em><strong class="kw jg"><em class="mo">ϵ</em></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)</em>)'与(<strong class="kw jg"><em class="mo">【ϵ</em></strong><em class="mo">—e(</em></strong></em></strong></em></strong></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/dc19fb9b8b3bdac303dc457e6211a2bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64sZggE2gZxDEhLS1GXvAg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">求解程序为(<strong class="bd mu"><em class="mv"/></strong><em class="mv">—e(</em><strong class="bd mu"><em class="mv">ϵ</em></strong><em class="mv">|</em><strong class="bd mu"><em class="mv">x</em></strong><em class="mv">)’(<strong class="bd mu"><em class="mv"/></strong><em class="mv">—e(</em></em></p></figure><p id="96eb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上述过程的第三步是我们取第二步中所示的两个矩阵的乘积。</p><p id="6e82" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这里我们得到一个重要的洞察:最后一步的求和是(<em class="mo"> n-k) </em>乘以随机变量<strong class="kw jg"> <em class="mo"> ϵ </em> </strong> <em class="mo">的条件方差。</em>由此，我们得出了以下重要结果:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/815b8291a6f6f6ad921a57905d5987fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*A0roqnuQCQWyKLgUMcOrSw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归误差的条件方差(图片由作者提供)</p></figure><p id="fa5f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">现在，线性回归中的一个主要假设如下:</p><blockquote class="of og oh"><p id="9512" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated">对于回归变量向量<strong class="kw jg"> x </strong> _i 的任何给定值，误差项的平均值与<strong class="kw jg"> x </strong> _i 不相关</p></blockquote><p id="9c10" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这种假设被称为回归模型的<strong class="kw jg">均值独立性</strong> <em class="mo"> </em>属性。它暗示以<strong class="kw jg"> <em class="mo"> X </em> </strong>为条件，<strong class="kw jg"><em class="mo"/></strong>的均值为零。均值独立意味着在上述方差公式中，术语<em class="mo">e(</em><strong class="kw jg"><em class="mo">【ϵ|x】</em></strong><em class="mo">)</em>是<strong class="kw jg"> <em class="mo"> 0 </em> </strong>其中<strong class="kw jg"> <em class="mo"> 0 </em> </strong>是一个大小为<em class="mo">【n×1】</em>的列矩阵，只包含零<em class="mo">。</em>因此，上述<strong class="kw jg"> <em class="mo"> ϵ </em> </strong>的误差方差公式简化为:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/87010b90e5f1bd4bbece7d8a8dc84eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*4G6uSN9nzjYfCbMDJpazRQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">误差项的条件方差(图片由作者提供)</p></figure><p id="9f18" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们重新看看等式(4)中所示的推导。在第一步中，我们将通过用<strong class="kw jg"><em class="mo">0</em></strong><em class="mo">【ϵ|x</em><em class="mo">】替换<em class="mo"><strong class="kw jg"><em class="mo"/>来应用我们的均值独立性假设。同样，在最后一步中，我们将<em class="mo">e(ϵ_i</em><strong class="kw jg"><em class="mo">| x</em></strong><em class="mo">)</em>用<em class="mo"> 0 </em> <strong class="kw jg"> <em class="mo"> </em> </strong>代替求和中的所有<em class="mo"> i </em>。做这两个替换得到了另一个重要的回归模型</strong>误差项平方和的<strong class="kw jg">公式:</strong></em></em></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a0a2ab72f094c64843addebae9453b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*3hGnUy7Z_RvGLcragqngTg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归误差平方和的公式(图片由作者提供)</p></figure><p id="8920" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">注意，在这些推导中，我们没有假设模型是线性的。到目前为止，我们只做了一个假设，即<strong class="kw jg">意味着独立</strong>。</p><p id="40d2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们现在要做第二个假设:</p><blockquote class="of og oh"><p id="fc04" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated">拟合模型的残差<strong class="kw jg"> e </strong>是误差项<strong class="kw jg"> ϵ </strong>的无偏估计量。</p></blockquote><p id="26ad" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这个假设允许我们使用<strong class="kw jg">残差平方和</strong>来<strong class="kw jg">估计误差平方和</strong>。换句话说:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6f970cbfd3408eb7f613b55296ba2e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*tk66-LA6GPnTA9q8KWGtow.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"> <em class="mv"> e'e </em> </strong>作为回归误差平方和的无偏估计量(图片由作者提供)</p></figure><p id="4b57" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们再次回顾一下线性回归模型。为了使用<strong class="kw jg">O</strong>d<strong class="kw jg">L</strong>东<strong class="kw jg"> S </strong>平方(OLS)估计技术在大小为<em class="mo"> n </em>的样本上拟合模型，我们需要最小化等式(3)给出的残差平方和。我们还表明，等式(3)的 L.H.S .上的求和可以使用残差转置乘以自身的矩阵乘积来估计，即<strong class="kw jg"> <em class="mo"> e'e。</em>T11】</strong></p><p id="395b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们还知道拟合模型的方程可以写成:<strong class="kw jg"><em class="mo">y</em></strong><em class="mo">=</em><strong class="kw jg"><em class="mo">xβ_ cap</em></strong><em class="mo">+</em><strong class="kw jg"><em class="mo">e</em></strong>，或者，就<strong class="kw jg"> <em class="mo"> e 而言，e =</em></strong><em class="mo">(</em><strong class="kw jg"><em class="mo">y</em></strong><em class="mo">———</em> 因此，我们需要最小化以下内容，以便使用最小二乘法拟合线性模型:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/88d7599fa13af957fa004c02333a4fef.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*FwP9JRworeCaRLeFNXp5QA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="2d9f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">为此，我们将采用上述方程的偏导数，并将其设置为零矩阵<strong class="kw jg"> <em class="mo"> 0 </em> </strong>，如下所示:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi op"><img src="../Images/b394ac0a9581514a7ccb3c69caedec07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKQWbTvY-y94sYBn77f7Tg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">残差平方和的偏导数 w . r . t .<strong class="bd mu"><em class="mv">β_ cap</em></strong><em class="mv">(图片由作者提供)</em></p></figure><p id="abcb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">由于<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>是一个大小为<em class="mo">【k×1】</em>的向量，上述矩阵方程分解为<em class="mo"> k </em>变量中的<em class="mo"> k </em>个方程，很容易求解得到<strong class="kw jg"><em class="mo">β_ cap</em></strong>=<em class="mo">【β_ 1 _ cap，β_ 2 _ cap…β_ k _ 1 我们实际上不会求解这个 k 方程系统。相反，我们将直接陈述最终结果，即最小化残差平方和的<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>的值:</em></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/d1a6997b5075262179eca50c4b15c1bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*2waZCSsi22NRvjJwSj1i1A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"><em class="mv"/></strong><em class="mv">【图片由作者提供】</em>的最小二乘估计量</p></figure><p id="c0be" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上述简洁的封闭形式的方程在单线中给出了使用 OLS 技术拟合的线性回归模型的最小二乘估计量。</p><p id="e6ef" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们回忆一下，我们的目标是得出回归系数<strong class="kw jg"> <em class="mo"> β </em> </strong> <em class="mo">的方差-协方差矩阵的公式。</em>为此，我们将遵循格林(2018)建议的方法，并将等式(9)中的<strong class="kw jg"> <em class="mo"> y </em> </strong>替换为<strong class="kw jg"><em class="mo">xβ</em></strong><em class="mo">+</em><strong class="kw jg"><em class="mo">ϵ</em></strong>，如下所示:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi or"><img src="../Images/98307b06866cfc843b6b33166aa3e1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*8RsH1tuGPSlZctQk-oFxcQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">用<strong class="bd mu"><em class="mv">xβ</em></strong><em class="mv">+</em><strong class="bd mu"><em class="mv">ϵ</em></strong><em class="mv">(图片由作者提供)</em></p></figure><p id="25b2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们在右侧蓝色括号内分配术语:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi os"><img src="../Images/df752e23b9edfeafbf3bc330f3deef02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*ahAX-sXINu2j8lJUdiTfhw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">分发术语(图片由作者提供)</p></figure><p id="5882" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们将这两个术语重新着色如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/f94df253e2fed7a79d9583fe852015d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*CioSyPvtnbrYmhMgo3gTHA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="6ba0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上式第一项中的灰色位是一个矩阵与其自身的乘积，它等于单位矩阵<strong class="kw jg"> <em class="mo"> I </em> </strong>。而我们知道<strong class="kw jg"><em class="mo">Iβ</em></strong><em class="mo">=</em><strong class="kw jg"><em class="mo">β</em></strong>。我们将用占位符矩阵<strong class="kw jg"> <em class="mo"> A </em> </strong>替换第二项中的品红色位。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/c660e789577bcf58bff9f740e25c3b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*ZEEVzGfKBQfTz2Xo_pRdyg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="abdb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们记住这个结果。</p><p id="bfc7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们回忆一下<strong class="kw jg"> <em class="mo"> β </em> </strong>的最小二乘估计的方差，即<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>就是我们所追求的。</p><p id="ecce" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在本文的前面部分，我们已经看到<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>是一个随机变量。任何随机变量<strong class="kw jg"> <em class="mo"> Z </em> </strong>的方差都可以表示为其均值减去后的值的平方的期望值。</p><p id="1dd9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mo">由此，Var(</em><strong class="kw jg"><em class="mo">Z</em></strong><em class="mo">)= E[(</em><strong class="kw jg"><em class="mo">Z</em></strong><em class="mo">——</em><strong class="kw jg"><em class="mo">Z _ bar</em></strong><em class="mo">)]</em>。</p><p id="c513" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们知道<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>的均值就是系数<strong class="kw jg"> <em class="mo"> β的总体水平值。</em> </strong>由于<strong class="kw jg"><em class="mo"/></strong>和<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>是<em class="mo">(k×1)</em>列向量，我们可以通过取<strong class="kw jg"> <em class="mo"> (β — β_cap) </em> </strong>与其转置<strong class="kw jg"> <em class="mo"> (β和β_ cap)’</em>相乘的期望来简洁地表达方差公式</strong></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/12c2817cf625f3dd2e8d767d140af121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*qvLA7fAltRRoKCVtkttMTA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"> <em class="mv"> β_cap </em> </strong> <em class="mv">(图片由作者提供)</em></p></figure><p id="48ea" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">矩阵<strong class="kw jg"><em class="mo">(β-β_ cap)</em></strong>的大小为<em class="mo"> (k x 1) </em>，它的转置矩阵<strong class="kw jg"><em class="mo">(β-β_ cap)’</em></strong>的大小为<em class="mo"> (1 x k) </em>，因此它们的乘积是一个大小为<em class="mo"> (k x k) </em>的方阵，这正是我们想要的协方差矩阵。</p><p id="9516" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在上面的方差方程中，让我们用<em class="mo">(</em><strong class="kw jg"><em class="mo">【β】</em></strong><em class="mo">+</em><strong class="kw jg"><em class="mo">【aϵ</em></strong><em class="mo">)</em>替换<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>，并将结果表达式简化如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ow"><img src="../Images/9a342814c27055c7fea001e0c18b6690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rsRWDWxL56W5TCufn_r1cQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="ab4e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们检查最后一行。中心术语<em class="mo">e(</em><strong class="kw jg"><em class="mo"/></strong><em class="mo">)</em><strong class="kw jg"><em class="mo">| x</em></strong><em class="mo"/>值得做一些解释。</p><p id="5b1b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mo">e(</em><strong class="kw jg"><em class="mo">【ϵϵ'】</em></strong><em class="mo">)</em><strong class="kw jg"><em class="mo">| x</em></strong><em class="mo"/>是<strong class="kw jg"> <em class="mo">的条件期望ϵϵ' </em> </strong>给定<strong class="kw jg"> <em class="mo"> X </em> </strong>。我们知道<strong class="kw jg"><em class="mo"/></strong>是一个大小为<em class="mo">(n×1)</em>的列向量，因此它的转置是一个大小为<em class="mo">(1×n)</em>的行向量。因此，他们的乘积<strong class="kw jg"> <em class="mo"> ϵϵ' </em> </strong>是一个大小为<em class="mo">(n×n)</em>的方阵，如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ox"><img src="../Images/a5a0d7e0a1b44c97ef9ce6ec3611376e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33dFE-HNCjjYe3V_hyLcGw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">模型误差项的条件方差-协方差矩阵(图片由作者提供)</p></figure><p id="79ae" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">由于假设误差项的均值为零，包含<em class="mo">e(ϵ_i*ϵ_i)</em><strong class="kw jg"><em class="mo">| x</em></strong><em class="mo">】</em>的对角元素实际上是误差项 <em class="mo"> ϵ_i </em>和<em class="mo">t81】的</em> <strong class="kw jg"> <em class="mo"> |X </em> </strong> <em class="mo">的条件方差非对角元素</em></p><p id="5729" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们现在将做出两个重要的假设:</p><blockquote class="of og oh"><p id="793d" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated"><strong class="kw jg">同方误差</strong></p><p id="2384" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated">线性回归模型的误差项是同伦齐次的，即它们具有恒定的条件方差。于是，E(ϵ_i*ϵ_j) <strong class="kw jg"> |X </strong> ]是某个常数<em class="jf"> σ </em>当 i = j 时</p><p id="57ba" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated">这个假设使得沿着误差的方差-协方差矩阵的主对角线的所有期望项具有某个恒定值<em class="jf"> σ </em>。</p><p id="618a" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated"><strong class="kw jg">非相关误差</strong></p><p id="193f" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated">线性回归模型的误差项彼此不相关。因此，当 I 不等于 j 时，E(ϵ_i*ϵ_j) <strong class="kw jg"> |X </strong> ] = 0</p><p id="f583" class="ku kv mo kw b kx ky kg kz la lb kj lc oi le lf lg oj li lj lk ok lm ln lo lp ij bi translated">这种假设使得不沿着误差方差-协方差矩阵的主对角线的所有期望项的值为零。</p></blockquote><p id="e44e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">根据这两个假设，误差的方差-协方差矩阵如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oy"><img src="../Images/1892e3a62866de7499b70591efa8c816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJc9mYRE3dDHjaQK_XS7WQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">同方差和不相关假设下回归模型误差项的方差-协方差矩阵(图片由作者提供)</p></figure><p id="6376" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们现在将等式(10)中的<em class="mo">e(</em><strong class="kw jg"><em class="mo"/></strong><em class="mo">)</em><strong class="kw jg"><em class="mo">| x</em></strong><em class="mo">】</em>替换为<em class="mo"/><strong class="kw jg"><em class="mo">I</em></strong>，以获得最小二乘估计量的方差的以下等式:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/fb8a84d805d2fd8e832203904ecd7d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*BbSyfoMc26vU6yTX4eGLiQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="007b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">为了简化上面的等式，我们将使用标识<em class="mo">(</em><strong class="kw jg"><em class="mo">AB</em></strong><em class="mo">)' =</em><strong class="kw jg"><em class="mo">B</em></strong><em class="mo">'</em><strong class="kw jg"><em class="mo">A</em></strong><em class="mo">'</em>来简化 R.H.S .上的灰色位。我们将使用标识<strong class="kw jg"><em class="mo">a</em></strong><em class="mo">【^(-1】</em><strong class="kw jg"><em class="mo">a</em></strong><em class="mo">=</em><strong class="kw jg"><em class="mo">I</em></strong>和<strong class="kw jg"><em class="mo">ia</em></strong><em class="mo">=</em><strong class="kw jg"><em class="mo">ai</em></strong><em class="mo">=</em><strong class="kw jg"/></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pa"><img src="../Images/88f0fe2640cd2e013b7acb7aa50586e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qpFQwrIbPPiP5zKT_aO41A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">OLS 估计量的方差-协方差矩阵的推导(图片由作者提供)</p></figure><p id="9218" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">等式(11)是统计建模领域的基本结果之一。</p><p id="d417" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">正如我们所看到的，拟合回归系数的方差-协方差矩阵是数据样本中所有回归变量的值和假设为常数的回归误差项的方差的函数。</p><p id="2a18" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在等式(11)中，虽然我们知道<strong class="kw jg"> <em class="mo"> X </em> </strong>，但是总体水平方差<em class="mo"> σ </em>不是一个已知量。<em class="mo"> </em>然而，样本方差<em class="mo"> s </em>，即拟合模型的残差的<strong class="kw jg">方差，形成了<em class="mo"> σ的无偏估计。</em>根据我们之前计算残差方差的工作，特别是等式<em class="mo"> (5) </em>和<em class="mo"> (7) </em>，我们有:</strong></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/ba1f7bee5fcd2d7cfa4db6ddc615d29d.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*BdQM19E2iFJQA-J_yki8ig.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">残差的方差公式(图片由作者提供)</p></figure><p id="cb94" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">其中，通常，<strong class="kw jg"> <em class="mo"> e'e </em> </strong>是拟合模型的残差向量与其自身的转置的乘积，<em class="mo"> n </em>是样本大小，<em class="mo"> k </em>是包括截距在内的回归变量的数量。你可能想验证一下在 R.H.S .上的方程是否产生一个标量。残差向量<strong class="kw jg"> <em class="mo"> e </em> </strong>是大小为<em class="mo">(n×1)</em><strong class="kw jg"><em class="mo">e</em></strong><em class="mo">'</em>的大小为<em class="mo">(1×n)</em>，因此，<strong class="kw jg"><em class="mo">e</em></strong><em class="mo">'</em><strong class="kw jg"><em class="mo">e</em></strong>的大小为<em class="mo"> (1)</em></p><p id="2383" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">因此，我们得到了拟合的 OLS 回归模型的系数的方差-协方差矩阵的以下无偏估计值<em class="mo">:</em></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pc"><img src="../Images/1189acceec9e5722fffbb358ccbcbb9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWi3kw6e82GwbuTrWGqlxA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">对拟合的 OLS 回归模型系数的方差-协方差矩阵的估计(图片由作者提供)</p></figure><p id="c695" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">如果模型有<em class="mo"> k </em>个包含截距的回归变量，那么方差-协方差矩阵就是大小为<em class="mo">(k×k)</em>的方阵。这可以通过注意到<strong class="kw jg"><em class="mo">×T43【是大小为<em class="mo">(n×k)</em>的矩阵来确认，因此<strong class="kw jg"><em class="mo">×T48】</em></strong>的大小为<em class="mo">(k×n)</em>，因此乘积<strong class="kw jg">×T53】×T54】×T55’<strong class="kw jg">×T57】是大小为<em class="mo">(k×k)的方阵 s </em>作为该矩阵的比例因子。</strong></strong></em></strong></p><p id="e593" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">与任何方差-协方差矩阵一样，位于该矩阵主对角线上的元素包含<strong class="kw jg"><em class="mo"/></strong>中的<em class="mo"> k </em>回归变量在<strong class="kw jg"><em class="mo"/></strong>中各自总体均值周围的方差，而非对角线元素包含<strong class="kw jg"><em class="mo">β_ cap</em></strong><em class="mo">_ I</em></p><h1 id="ec11" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">回归系数估计的置信区间</h1><p id="af3c" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">方差-协方差矩阵的每个对角元素的平方根是标准偏差，即<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>中各个回归系数估计值的<strong class="kw jg">标准误差</strong>。</p><p id="a445" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这些标准误差可以直接插入回归系数估计值周围的(1-α)100%置信区间的公式中，如下所示:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/3e8e078e2d1516e296b36de32a59ef92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*Y58etoD2etRvPk25RYoWTA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归系数置信区间公式(图片由作者提供)</p></figure><p id="2117" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上式中，<em class="mo"> β_cap_i </em>为拟合模型的第<em class="mo">与第</em>回归系数的估计值(亦称平均值)。方括号内的<em class="mo"> t </em>值是从具有<em class="mo"> (n-k) </em>自由度的双边<em class="mo">学生 t </em>分布返回的临界值，其中<em class="mo"> n </em>是样本大小，<em class="mo"> k </em>是包括截距在内的回归系数的数量。<em class="mo"> se_i_i </em>是等式(12)中<strong class="kw jg"> <em class="mo"> β_cap </em> </strong>的方差-协方差矩阵中第<em class="mo">个</em>对角元素的平方根。</p><h1 id="94b4" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">回归系数方差-协方差矩阵公式的基本假设</h1><p id="bd2b" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">等式(12)中呈现的方差-协方差矩阵的公式来自我们在推导过程中逐步做出的以下 5 组假设:</p><ol class=""><li id="b801" class="nb nc jf kw b kx ky la lb ld nd lh ne ll nf lp pe nh ni nj bi translated"><strong class="kw jg">误差的均值独立</strong>:模型的误差项是均值独立的:<em class="mo">e(</em><strong class="kw jg"><em class="mo">ϵ</em></strong><em class="mo">|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)= 0</em></li><li id="24cb" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp pe nh ni nj bi translated"><strong class="kw jg">线性形式</strong>:回归模型有一个线性形式:y =<strong class="kw jg"><em class="mo">xβ</em></strong><em class="mo">+</em><strong class="kw jg"><em class="mo">ϵ</em></strong></li><li id="7d8b" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp pe nh ni nj bi translated">拟合模型的残差<strong class="kw jg"> <em class="mo"> e </em> </strong>是误差项<strong class="kw jg"> <em class="mo"> ϵ </em> </strong>的无偏估计。</li><li id="101a" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp pe nh ni nj bi translated"><strong class="kw jg">同方误差</strong>:模型的误差是同方误差:<em class="mo">e(ϵ_i*ϵ_j|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)=σ</em>(一个常数)当<em class="mo"> i = j，</em>并且，</li><li id="199b" class="nb nc jf kw b kx nk la nl ld nm lh nn ll no lp pe nh ni nj bi translated"><strong class="kw jg">不相关误差</strong>:模型的误差彼此不相关:<em class="mo">e(ϵ_i*ϵ_j|</em><strong class="kw jg"><em class="mo">x</em></strong><em class="mo">)= 0</em>当<em class="mo"> i！= j </em></li></ol><h2 id="6223" class="pf ls jf bd lt pg ph dn lx pi pj dp mb ld pk pl md lh pm pn mf ll po pp mh pq bi translated">何时对方差-协方差矩阵持怀疑态度</h2><p id="8ec8" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">如果违反了上述一组假设，则前面的一组推导不再成立，并且等式(12)不能用于计算模型的方差-协方差矩阵。如果我们选择仍然使用等式(12)来计算方差-协方差矩阵，则矩阵中的方差和协方差值将是不准确的。因此，从矩阵计算的系数的<strong class="kw jg">标准误差将是不正确的</strong>，并且<strong class="kw jg">我们将最终报告错误的回归系数置信区间</strong>。</p><p id="6fdc" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">对于给定的数据集，前三个假设(均值独立性、线性形式和残差作为误差项的无偏估计)决定了线性回归模型的可行性。假设(4)和(5)仅描述了模型误差方差的行为。虽然，假设(1)到(5)一起导致线性 OLS 回归模型的方差-协方差矩阵的公式，如果(1)到(3)被满足，但是(4)和/或(5)不被满足，线性回归模型仍然是手边数据集的可行模型。但是在这种情况下，不应该报告使用等式(12)的系数估计的标准误差和置信区间。</p><p id="a017" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">当您使用统计建模软件包(如 statsmodels)构建和拟合线性 OLS 模型时，软件通常会使用等式(12)中给出的公式报告标准误差，因此它还会使用这些标准误差报告回归系数估计值的(1-α)100%置信区间。如果使用 OLS 技术拟合模型，假设(2)和(3)-线性形式和残差作为误差项的无偏估计-将被纳入 OLS 技术。</p><p id="ddb5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">重要的是验证拟合模型满足假设(1)、(4)和(5)——误差项的均值独立性、同方差性和不相关性。但是，如果他们不满意，那么我们就不应该依赖统计软件包报告的标准误差和置信区间。</p><p id="2bd1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">作为等式(12)的示例，让我们使用它来计算拟合在机动车辆数据集上的线性 OLS 模型的方差-协方差矩阵。</p><p id="84ab" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">首先，我们将从整个数据集中随机选择 50 个样本来拟合模型。我们将使用<strong class="kw jg"> statsmodels </strong>包来构建和拟合模型，如下所示:</p><pre class="mq mr ms mt gt pr ps pt pu aw pv bi"><span id="2d62" class="pf ls jf ps b gy pw px l py pz"><strong class="ps jg">import </strong>pandas <strong class="ps jg">as </strong>pd<br/><strong class="ps jg">from </strong>patsy <strong class="ps jg">import </strong>dmatrices<br/><strong class="ps jg">import </strong>numpy <strong class="ps jg">as </strong>np<br/><strong class="ps jg">import </strong>scipy.stats<br/><strong class="ps jg">import </strong>statsmodels.api <strong class="ps jg">as </strong>sm<br/><strong class="ps jg">import </strong>matplotlib.pyplot <strong class="ps jg">as </strong>plt</span><span id="ecd7" class="pf ls jf ps b gy qa px l py pz"><em class="mo">#Read the automobiles dataset into a Pandas DataFrame<br/></em>df = pd.read_csv(<strong class="ps jg">'automobile_uciml_3vars.csv'</strong>, header=0)</span><span id="e08d" class="pf ls jf ps b gy qa px l py pz">SAMPLE_SIZE = 50</span><span id="c3a3" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg"><em class="mo">#Select a random sample of size SAMPLE_SIZE</em></strong><em class="mo"><br/></em>df_sample = df.<strong class="ps jg">sample</strong>(<strong class="ps jg">n</strong>=SAMPLE_SIZE)</span><span id="9c44" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg"><em class="mo">#Setup the model expression in Patsy syntax</em></strong><em class="mo"><br/></em>model_expr = 'City_MPG ~ Curb_Weight + Engine_Size'</span><span id="6751" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg"><em class="mo">#Carve out the X and y matrices using Patsy<br/></em></strong>y_train, X_train = <strong class="ps jg">dmatrices</strong>(model_expr, df_sample, <strong class="ps jg">return_type</strong>=<strong class="ps jg">'</strong>dataframe<strong class="ps jg">'</strong>)</span><span id="cb39" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg"><em class="mo">#Build an OLS regression model using Statsmodels<br/></em></strong>olsr_model = sm.<strong class="ps jg">OLS</strong>(<strong class="ps jg">endog</strong>=y_train, <strong class="ps jg">exog</strong>=X_train)</span><span id="38ba" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg"><em class="mo">#Fit the model on (y, X)<br/></em></strong>olsr_results = olsr_model.<strong class="ps jg">fit</strong>()</span><span id="26c4" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg"><em class="mo">#Print the training summary of the fitted model<br/></em>print</strong>(olsr_results.<strong class="ps jg">summary</strong>())</span></pre><p id="696d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们看到以下培训输出:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qb"><img src="../Images/6e4cfb67758f4666016d3ce78d3076fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qDy3S4DHIMTH85Hi4F5KQw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">OLSR 模式的培训总结(图片由作者提供)</p></figure><p id="ef9c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">可以看出，statsmodels 报告的系数的标准误差如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/648307c57a559d41fabf92c40eff5a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*rzvBMJD737FvoO4vkDhgNw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Statsmodels 报告的标准误差(图片由作者提供)</p></figure><p id="aeaf" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">它们的(1–0.05)100%置信区间如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi qd"><img src="../Images/4ade204eb338df3ec57d152d2e460461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sPzJLYHtCUTJSlb_kUOX5A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">statsmodels 报告的 95%置信区间(图片由作者提供)</p></figure><p id="24bc" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们使用等式(12)手动计算拟合系数的方差-协方差矩阵。</p><p id="96e5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">为了使用等式(12)，我们需要计算<em class="mo"> s </em>，这是残差的方差。使用公式<em class="mo">(</em><strong class="kw jg"><em class="mo">e</em></strong><em class="mo">'</em><strong class="kw jg"><em class="mo">e</em></strong><em class="mo">)/(n-k)</em>计算如下:</p><pre class="mq mr ms mt gt pr ps pt pu aw pv bi"><span id="0007" class="pf ls jf ps b gy pw px l py pz">e=np.<strong class="ps jg">array</strong>(olsr_results.<strong class="ps jg">resid</strong>)</span><span id="bab1" class="pf ls jf ps b gy qa px l py pz">#reshape it to (50 x 1)<br/>e=e.<strong class="ps jg">reshape</strong>(e.<strong class="ps jg">shape</strong>[0],1)</span><span id="3fd7" class="pf ls jf ps b gy qa px l py pz">e_prime = np.<strong class="ps jg">transpose</strong>(e)</span><span id="0bb5" class="pf ls jf ps b gy qa px l py pz">resid_variance = np.matmul(e_prime,e)/(50-3)[0]</span><span id="cef6" class="pf ls jf ps b gy qa px l py pz">print('Variance of residuals='+str(resid_variance[0][0]))</span></pre><p id="d1c3" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们得到以下输出:</p><pre class="mq mr ms mt gt pr ps pt pu aw pv bi"><span id="0185" class="pf ls jf ps b gy pw px l py pz">Variance of residuals=<strong class="ps jg">25.074639949635987</strong></span></pre><p id="60b0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">方差-协方差矩阵使用等式(12)计算如下:</p><pre class="mq mr ms mt gt pr ps pt pu aw pv bi"><span id="7302" class="pf ls jf ps b gy pw px l py pz">X=np.<strong class="ps jg">array</strong>(X_train)</span><span id="0f40" class="pf ls jf ps b gy qa px l py pz">X_prime = np.<strong class="ps jg">array</strong>(np.<strong class="ps jg">transpose</strong>(X))</span><span id="ccd7" class="pf ls jf ps b gy qa px l py pz">coeff_covs_matrix = np.<strong class="ps jg">linalg</strong>.<strong class="ps jg">inv</strong>(np.<strong class="ps jg">matmul</strong>(X_prime, X))*resid_variance</span><span id="00a5" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg">print</strong>('Variance-Covariance Matrix of coefficient estimates=\n'+<strong class="ps jg">str</strong>(coeff_covs_matrix))</span></pre><p id="b677" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们得到以下输出:</p><pre class="mq mr ms mt gt pr ps pt pu aw pv bi"><span id="2412" class="pf ls jf ps b gy pw px l py pz">Variance-Covariance Matrix of coefficient estimates=<br/>[[ 1.39215336e+01 -7.68038461e-03  5.11395679e-02]<br/> [-7.68038461e-03  5.77116102e-06 -5.62371161e-05]<br/> [ 5.11395679e-02 -5.62371161e-05  7.23625275e-04]]</span></pre><p id="415f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">主对角线元素的平方根是拟合系数的标准误差:</p><pre class="mq mr ms mt gt pr ps pt pu aw pv bi"><span id="cfea" class="pf ls jf ps b gy pw px l py pz">coeff_std_errors = np.<strong class="ps jg">sqrt</strong>(coeff_covs_matrix)</span><span id="6452" class="pf ls jf ps b gy qa px l py pz"><strong class="ps jg">print</strong>('Standard errors of coefficient estimates=\n'+<strong class="ps jg">str</strong>(coeff_std_errors))</span></pre><p id="0ff2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们看到以下输出:</p><pre class="mq mr ms mt gt pr ps pt pu aw pv bi"><span id="9ee8" class="pf ls jf ps b gy pw px l py pz">Standard errors of coefficient estimates=<br/>[[<strong class="ps jg">3.73115714e+00</strong>            nan 2.26140593e-01]<br/> [           nan <strong class="ps jg">2.40232409e-03</strong>            nan]<br/> [2.26140593e-01            nan <strong class="ps jg">2.69002839e-02</strong>]]</span></pre><p id="f2ff" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">主要的对角线元素是:</p><p id="fe0a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mo"/><strong class="kw jg"><em class="mo">3.731</em></strong><em class="mo">15714、</em><strong class="kw jg"><em class="mo">0.002</em></strong><em class="mo">40232409、</em><strong class="kw jg"><em class="mo">0.0269</em></strong><em class="mo">【002839】</em></p><p id="721a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这些值与训练摘要中 Statsmodels 报告的标准误差相匹配:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/648307c57a559d41fabf92c40eff5a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*rzvBMJD737FvoO4vkDhgNw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Statsmodels 报告的标准误差(图片由作者提供)</p></figure></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><h1 id="8690" class="lr ls jf bd lt lu qe lw lx ly qf ma mb kl qg km md ko qh kp mf kr qi ks mh mi bi translated">参考文献、引文和版权</h1><h2 id="e17b" class="pf ls jf bd lt pg ph dn lx pi pj dp mb ld pk pl md lh pm pn mf ll po pp mh pq bi translated">数据集</h2><p id="2666" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><a class="ae lq" href="https://archive.ics.uci.edu/ml/datasets/automobile" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg">汽车数据集</strong> </a> <strong class="kw jg">引用:</strong> Dua，d .和 Graff，C. (2019)。UCI 机器学习知识库[http://archive . ics . UCI . edu/ml]。加州欧文:加州大学信息与计算机科学学院。<a class="ae lq" href="https://gist.github.com/sachinsdate/fd97d74979c4febf6746c153ea1b7668" rel="noopener ugc nofollow" target="_blank"> <strong class="kw jg">下载链接</strong> </a></p><h2 id="01a3" class="pf ls jf bd lt pg ph dn lx pi pj dp mb ld pk pl md lh pm pn mf ll po pp mh pq bi translated">纸质和图书链接</h2><p id="e170" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">威廉·h·格林，<a class="ae lq" href="https://www.pearson.com/us/higher-education/program/Greene-Econometric-Analysis-8th-Edition/PGM334862.html" rel="noopener ugc nofollow" target="_blank"> <em class="mo">计量经济分析</em> </a>，第 8 版<em class="mo">，</em> 2018，<em class="mo">培生</em></p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="b02b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mo">如果你喜欢这篇文章，请关注我的</em><a class="ae lq" href="https://timeseriesreasoning.medium.com" rel="noopener"><strong class="kw jg"><em class="mo">Sachin Date</em></strong></a><em class="mo">获取关于回归、时间序列分析和预测主题的提示、操作方法和编程建议。</em></p></div></div>    
</body>
</html>