<html>
<head>
<title>Microsoft Data Scientist SQL Interview Questions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微软数据科学家SQL面试问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/microsoft-data-scientist-sql-interview-questions-172baceb5fce#2022-02-09">https://towardsdatascience.com/microsoft-data-scientist-sql-interview-questions-172baceb5fce#2022-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2b64" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">我们将回顾一个示例面试问题，以帮助您准备申请微软数据科学家的职位，该问题选自最近的数据分析师面试</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/0c39fe8f06bf97801c1dbb0289956019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zxAoFVkIXEsMAwi35AT9HA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图片</p></figure><p id="846c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">微软的数据分析师角色可以设计和构建数据模型，为他们的团队提供有意义的数据和模型。下面是一个真实世界的例子，你可能会在微软的面试中遇到。下面，我们将向您展示如何分解出现的问题，逐步完成用于解决问题的逻辑，并讨论如何优化解决方案以获得更好的性能。</p><h1 id="6379" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">Microsoft Data Scientist SQL面试问题中测试的概念</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/21273a29be73836dd1ae1370ef7a5366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJ4TLZPWPc_4Eo0K0ZaZGw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="4b86" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">以下Microsoft数据科学家访谈问题中测试的主要概念包括:</p><ul class=""><li id="e0a0" class="ml mm iq kz b la lb ld le lg mn lk mo lo mp ls mq mr ms mt bi translated">聚合函数—求和/计数/分组依据</li><li id="3d41" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls mq mr ms mt bi translated">连接</li><li id="fc76" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls mq mr ms mt bi translated">限制</li></ul><h1 id="2022" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">微软数据科学家SQL面试问题</h1><p id="7d80" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated"><strong class="kz ir">员工项目预算</strong></p><p id="ffe4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据项目中分配给每个员工的预算金额，找出前五个最昂贵的项目。排除员工数为0的项目。假设每个员工只参与一个项目。输出应该是项目标题和分配给每个员工的预算(即预算与员工的比率)。首先显示预算与员工比率最高的前5个项目。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/67fa308d49be44a67d1842b4bcb45ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSFY76fPJEHuuTjz0I2msg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="0b9a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">* *请注意，此问题已在StrataScratch平台上更新，<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">请点击此处</a>。在这篇文章和视频中，我们讨论这个问题的另一个版本。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="2d10" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">数据集</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nh"><img src="../Images/f4116f5d35cce036b4341f7b283a9865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*csnMHt9KLiS-lD2JZg_o-g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="a1b3" class="ni lu iq bd lv nj nk dn lz nl nm dp md lg nn no mf lk np nq mh lo nr ns mj nt bi translated">假设</h2><p id="8c23" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">从上述问题中得到线索，作出以下初步假设:</p><ol class=""><li id="223b" class="ml mm iq kz b la lb ld le lg mn lk mo lo mp ls nu mr ms mt bi translated">一个项目可以有多个员工，但是每个员工只能参与一个项目</li><li id="1d7c" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls nu mr ms mt bi translated">只有前5名的结果需要显示，所以结果需要按成本排序，然后限制在5个最昂贵的项目</li></ol><p id="3c07" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们的数据集提供了以下细分:</p><ul class=""><li id="0474" class="ml mm iq kz b la lb ld le lg mn lk mo lo mp ls mq mr ms mt bi translated">id —每个项目的个人id</li><li id="f1a5" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls mq mr ms mt bi translated">标题—项目的名称</li><li id="ee79" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls mq mr ms mt bi translated">预算——每个项目的总成本</li><li id="dc97" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls mq mr ms mt bi translated">emp_id —雇员id的整数值</li><li id="a9ec" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls mq mr ms mt bi translated">project_id —每个项目的唯一id，与ms_projects表中的id值相同</li></ul><p id="536d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在查看ms_projects中的预算列时，可以看到我们正在处理整数，因此也假设我们正在处理整数除法。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nv"><img src="../Images/caa13b20f95dd6bc47424e482260c565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6r6x9QYu0iuqDVdp2pZhjw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="3e70" class="ni lu iq bd lv nj nk dn lz nl nm dp md lg nn no mf lk np nq mh lo nr ns mj nt bi translated">方法</h2><p id="c01e" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">所需的SELECT语句需要返回项目的标题(这样就很容易识别)和项目中每个员工的预算。选择的开始很简单:</p><pre class="kh ki kj kk gt nw nx ny nz aw oa bi"><span id="edb0" class="ni lu iq nx b gy ob oc l od oe">SELECT title AS project,</span></pre><p id="f0e0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">但是现在我们必须决定如何返回每个员工的项目成本。对于这种方法，我们将使用整数除法。首先，我们将测试每个项目可能有多名员工的理论。为了测试这一点，我们使用COUNT()函数。将它放入一个快速查询中(这里显示的连接将在下面进一步解释)，结果显示这个假设是正确的:</p><pre class="kh ki kj kk gt nw nx ny nz aw oa bi"><span id="98d0" class="ni lu iq nx b gy ob oc l od oe">SELECT title AS project, COUNT(emp_id) AS emps_per_project<br/>   FROM ms_projects p<br/>   INNER JOIN ms_emp_projects e<br/>       ON p.id = e.project_id<br/>   GROUP BY 1, budget</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi of"><img src="../Images/95fc1571f033bb1aad1d37964bd2e1c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*br_-v8PnVVwg6xJd_A8aNw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="6685" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了计算每个项目的雇员成本，我们将ms_projects的预算列除以每个项目的雇员总数。这是使用COUNT(emp_id)完成的:</p><pre class="kh ki kj kk gt nw nx ny nz aw oa bi"><span id="e268" class="ni lu iq nx b gy ob oc l od oe">SELECT title AS project, budget/COUNT(emp_id) AS budget_emp_ratio<!-- --> </span></pre><p id="e580" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了收集这个SELECT语句所需的所有列，ms_projects和ms_emp_projects <a class="ae kw" href="https://www.stratascratch.com/blog/how-to-join-3-or-more-tables-in-sql/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">表必须连接在一起</a>。</p><p id="df55" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">与上面的解决方案非常相似，为了产生期望的结果，必须在这个查询中使用一个JOIN语句。这里，我们将对ms_projects和ms_emp_projects进行内部连接，其中ms_emp_projects中的project_id列相当于ms_projects中的id列:</p><pre class="kh ki kj kk gt nw nx ny nz aw oa bi"><span id="4f08" class="ni lu iq nx b gy ob oc l od oe">SELECT title AS project, budget/COUNT(emp_id) AS budget_emp_ratio<br/>FROM ms_projects p<br/>INNER JOIN ms_emp_projects e<br/>	ON p.id = e.project_id</span></pre><p id="112e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">由于COUNT()是一个聚合函数，因此必须在项目标题和预算中与GROUP BY子句结合使用。</p><pre class="kh ki kj kk gt nw nx ny nz aw oa bi"><span id="782b" class="ni lu iq nx b gy ob oc l od oe">SELECT title AS project, budget/COUNT(emp_id) AS budget_emp_ratio<br/>FROM ms_projects p<br/>INNER JOIN ms_emp_projects e<br/>	ON p.id = e.project_id<br/>GROUP BY 1, budget</span></pre><p id="06a7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">以下是当前查询的结果:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi og"><img src="../Images/dcc9f852775ab73b590ec15b8a860b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18pUKiy12DqrCDoFPKCGPw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="6ffc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，由于我们的<a class="ae kw" href="https://www.stratascratch.com/blog/microsoft-data-scientist-position-guide/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">微软数据科学家</a>的采访问题是询问前5个最昂贵的项目，我们将它们按降序排列，并添加了一个限制子句，因此结果集中只返回前5行。</p><pre class="kh ki kj kk gt nw nx ny nz aw oa bi"><span id="8f95" class="ni lu iq nx b gy ob oc l od oe">SELECT title AS project, budget/COUNT(emp_id) AS budget_emp_ratio<br/>	FROM ms_projects p<br/>	INNER JOIN ms_emp_projects e<br/>		ON p.id = e.project_id<br/>	GROUP BY 1, budget<br/>	ORDER BY 2 DESC<br/>	LIMIT 5</span></pre><p id="3b23" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">以下是最终结果:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi of"><img src="../Images/275bae8be29713aae4bf1fb20bf1714d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txU3oxB3RTj3jar8stSR0g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10301-expensive-projects?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="59ec" class="ni lu iq bd lv nj nk dn lz nl nm dp md lg nn no mf lk np nq mh lo nr ns mj nt bi translated">最佳化</h2><p id="3ade" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">通常，受访者会被问及解决方案是否可以优化。如果不是，什么使解决方案最优？这里的查询已经过优化，所以我们将集中讨论为什么没有改进建议:</p><ol class=""><li id="380e" class="ml mm iq kz b la lb ld le lg mn lk mo lo mp ls nu mr ms mt bi translated">该解决方案符合预期</li><li id="94ee" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls nu mr ms mt bi translated">使用的连接方法</li><li id="b5a6" class="ml mm iq kz b la mu ld mv lg mw lk mx lo my ls nu mr ms mt bi translated">限制返回的结果</li></ol><p id="0589" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们这里的解决方案提供的结果符合摘要的要求:不多也不少。在优化过程中首先要问的问题之一是当前的解决方案是否能产生预期的和准确的结果。</p><p id="134b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">接下来，这里使用的连接方法是内部连接。内部联接检查被联接的两个表，并且只返回左侧表中的联接条件在右侧得到满足的行。这排除了不必要的数据，并处理空条目，因此在以后的查询中不需要考虑它们。如果在这个实例中使用了左连接，优化建议应该是将连接方法改为INNER。为什么？左连接实际上执行两个连接:首先完成一个内连接；然后，对于表中参数左侧的其余行，如果在右侧没有匹配项，则向结果集中添加一行，该行包含左侧行的数据，并在右侧插入NULL值。这不仅需要额外的时间来运行查询，还必须在查询本身中考虑空值。因此，这里内部连接是正确的方法。</p><p id="06e1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，限制查询返回的结果不仅满足赋值的参数，还节省了处理时间。需要注意的是，只有首先使用ORDER BY子句对结果进行排序时，限制结果才是最佳的。这是因为，如果不首先对结果进行排序，内置的postgreSQL查询优化器在生成查询计划时就没有排序约束，这意味着您的查询将产生无序的、不可预测的结果。</p><h2 id="2138" class="ni lu iq bd lv nj nk dn lz nl nm dp md lg nn no mf lk np nq mh lo nr ns mj nt bi translated">结论</h2><p id="e07c" class="pw-post-body-paragraph kx ky iq kz b la mz jr lc ld na ju lf lg nb li lj lk nc lm ln lo nd lq lr ls ij bi translated">现在，您已经看到如何将常见的<a class="ae kw" href="https://www.stratascratch.com/blog/sql-interview-questions-you-must-prepare-the-ultimate-guide/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> SQL面试问题</a>分解为基本概念、用于解决方案的逻辑以及可用于优化结果的技术。我们主要关注连接和聚合函数，这是作为数据科学家或分析师在日常生活中使用的。您还看到了如何使用COUNT和ORDER BY来组织数据。在许多情况下，您会看到多个从中提取和组织数据的表，所以熟悉连接及其不同的技术是必须的。如果你喜欢这篇文章，看看我们以前的文章“<a class="ae kw" href="https://www.stratascratch.com/blog/microsoft-sql-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> <em class="oh">微软SQL面试问题</em> </a>”和“<a class="ae kw" href="https://www.stratascratch.com/blog/microsoft-data-science-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> <em class="oh">微软数据科学面试问题</em> </a>”，它们可以帮助你准备更多在面试中经常出现的概念。</p></div><div class="ab cl oi oj hu ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="ij ik il im in"><p id="e1bc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="oh">原载于</em><a class="ae kw" href="https://www.stratascratch.com/blog/microsoft-data-scientist-sql-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"><em class="oh">https://www.stratascratch.com</em></a><em class="oh">。</em></p></div></div>    
</body>
</html>