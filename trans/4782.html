<html>
<head>
<title>How to Easily Create a PDF File with Python (in 3 Steps)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python轻松创建PDF文件(3步)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-create-a-pdf-file-with-python-in-3-steps-a70faaf5bed5#2022-10-25">https://towardsdatascience.com/how-to-easily-create-a-pdf-file-with-python-in-3-steps-a70faaf5bed5#2022-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d224" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Python和HTML模板在几分钟内创建PDF文件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6b168adc03f0a4e08b439ce3a69e1248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JU2z3AxRNXV__ad12GXc5w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自Shutterstock，授权给Frank Andrade</p></figure><p id="ed2d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PDF可能是我们在电脑上能找到的最常见的文件类型之一。</p><p id="243b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们使用pdf格式的简历、报告、发票，应有尽有！</p><p id="598d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建PDF文件的常用方法是将Word文件另存为。但是我们也可以使用Python创建一个pdf文件。</p><p id="2092" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">专业人士？如果您计划使用同一个模板创建多个pdf，您可以使用Python！但是首先，我们将了解如何使用Python创建PDF文件。</p><p id="f62d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本教程中，我们将首先创建一个简单的PDF文件，然后我们将创建一个更高级的文件，如下图所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/7dd675d5e45b4ceeb03ec8a96d6b7821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lh79xwiyRunQONixrjfX9Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="09da" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">如何用Python轻松创建PDF文件</h1><p id="2c03" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">用Python创建PDF文件有不同的方法，但我发现使用HTML模板是最简单的方法。</p><p id="1883" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用此选项，我们可以在几分钟内创建基本和高级pdf！</p><h2 id="40e4" class="ms lw it bd lx mt mu dn mb mv mw dp mf lh mx my mh ll mz na mj lp nb nc ml nd bi translated">安装库</h2><p id="6d94" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">要创建PDF文件，我们需要安装以下库:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="6e7a" class="ms lw it nf b gy nj nk l nl nm">pip install pdfkit<br/>pip install jinja2</span></pre><p id="79d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们使用<code class="fe nn no np nf b">pdfkit</code>库之前，我们需要安装<code class="fe nn no np nf b">wkhtmltopdf</code>。安装步骤取决于您的操作系统:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="50c2" class="ms lw it nf b gy nj nk l nl nm"><em class="nq"># macOS (you need to install brew first)</em><br/>brew install homebrew/cask/wkhtmltopdf</span><span id="2983" class="ms lw it nf b gy nr nk l nl nm"><em class="nq"># Ubuntu</em><br/>sudo apt-get install wkhtmltopdf</span></pre><p id="4ddf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你用的是Windows，你可以在这里下载安装程序<a class="ae ns" href="https://wkhtmltopdf.org/downloads.html" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="50a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们用Python创建一个简单的PDF。</p><h2 id="4460" class="ms lw it bd lx mt mu dn mb mv mw dp mf lh mx my mh ll mz na mj lp nb nc ml nd bi translated">步骤1:创建一个带有占位符的HTML模板</h2><p id="e18e" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">首先，我们需要创建一个HTML文档，稍后我们将使用它作为模板。</p><p id="199a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了创建这个HTML文档，我们将使用一个名为<a class="ae ns" href="https://html-online.com/editor/" rel="noopener ugc nofollow" target="_blank"> HTML编辑器</a>的网站。在这个网站上，我们可以在左边的可视化编辑器中键入文本，并在右边的源代码编辑器中生成它的HTML代码。</p><p id="db5d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我在编辑器中引入的文本(这个文件可以在我的<a class="ae ns" href="https://github.com/ifrankandrade/automation/tree/main/PDF/1.basic-pdf" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/5ac31885a5121203abb3d7290bc4c643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*96-Po3yxrh5ik2jXjwPyZg.png"/></div></div></figure><p id="9bb8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意我用<code class="fe nn no np nf b">{{}}</code>创建的占位符。稍后我们将使用Python在这些花括号中引入值。</p><p id="ef80" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是由HTML编辑器生成的HTML代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="e25c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要复制这段HTML代码，在我们的工作目录中创建一个HTML文件，然后将代码粘贴到它上面。</p><h2 id="724a" class="ms lw it bd lx mt mu dn mb mv mw dp mf lh mx my mh ll mz na mj lp nb nc ml nd bi translated">步骤2:为每个占位符创建一个Python变量</h2><p id="8a0c" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">首先我们导入jinja2和pdfkit。我有一个名为<code class="fe nn no np nf b">{{today_date}}</code>的占位符，所以我也导入<code class="fe nn no np nf b">datetime</code>来获得今天的日期。</p><p id="d38f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们为HTML文档中的每个占位符创建一个Python变量，并创建一个将占位符与Python变量配对的字典。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9772" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，我将每个Python变量命名为占位符，但是它们可以有不同的名称。</p><h2 id="14ec" class="ms lw it bd lx mt mu dn mb mv mw dp mf lh mx my mh ll mz na mj lp nb nc ml nd bi translated">步骤3:为我们的模板创建一个环境并导出PDF</h2><p id="eb40" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">现在是时候使用jinja2为我们的模板创建一个环境了。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="236c" class="ms lw it nf b gy nj nk l nl nm">template_loader = jinja2.FileSystemLoader(‘./’)<br/>template_env = jinja2.Environment(loader=template_loader)</span></pre><p id="d1cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们指定使用哪个模板。在我的例子中，我将HTML文件命名为<code class="fe nn no np nf b">basic-template.hmtl</code>。在这之后，我们呈现我们在步骤2中创建的字典。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="be02" class="ms lw it nf b gy nj nk l nl nm">template = template_env.get_template(‘basic-template.html’)<br/>output_text = template.render(context)</span></pre><p id="1302" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将<code class="fe nn no np nf b">wkhtmltopdf</code>添加到<code class="fe nn no np nf b">pdfkit</code>配置中。为此，我们需要指定安装<code class="fe nn no np nf b">wkhtmltopdf </code>的路径。</p><p id="7ad1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是您需要运行的命令来获得这个路径。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="f981" class="ms lw it nf b gy nj nk l nl nm"><em class="nq"># macOS/Linux</em><br/>&gt;&gt;&gt; which wkhtmltopdf<br/>'/usr/local/bin/wkhtmltopdf'</span><span id="cc2d" class="ms lw it nf b gy nr nk l nl nm"><em class="nq"># Windows</em><br/>&gt;&gt;&gt; where wkhtmltopdf<br/>'C:\Program Files\wkhtmltopdf'</span></pre><p id="4618" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们使用<code class="fe nn no np nf b">.from_string()</code>方法导出PDF文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9238" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，我给<code class="fe nn no np nf b">.from_string()</code>方法添加了一个CSS参数。这是可选的，但我发现有必要将PDF中段落的字体变大。</p><p id="4cb8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在工作目录中创建了一个<code class="fe nn no np nf b">style.css</code>文件，并编写了下面的代码。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="ed3a" class="ms lw it nf b gy nj nk l nl nm">p { font-size: 24px; }<br/>li { font-size: 24px; }</span></pre><p id="e654" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样。这是我们用Python生成的PDF。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/9381260cf66be775bdb43ce7661eb11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vxL2r54Z1zgWEzd12a3kCg.png"/></div></div></figure><p id="0c2d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们写的代码和本教程使用的文件可以在我的<a class="ae ns" href="https://github.com/ifrankandrade/automation/blob/main/PDF/1.basic-pdf/basic-pdf.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><p id="45fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在要生成一个更高级的PDF，就像下面的发票，我们需要下载一个HTML模板并创建一些占位符。<a class="ae ns" href="https://youtu.be/1IYtkkEOuoU" rel="noopener ugc nofollow" target="_blank">在这个视频教程</a>里，我展示了怎么做。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/7dd675d5e45b4ceeb03ec8a96d6b7821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lh79xwiyRunQONixrjfX9Q.png"/></div></div></figure></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="472f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用Python自动化您的生活！<a class="ae ns" href="https://frankandrade.ck.page/44559e1ae7" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">加入我的10k+人电子邮件列表，获取我的免费自动化备忘单。</strong> </a></p><p id="df5a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑报名成为一名媒体成员。每月5美元，让您可以无限制地访问数以千计的Python指南和数据科学文章。如果你使用<a class="ae ns" href="https://frank-andrade.medium.com/membership" rel="noopener">我的链接</a>注册，我会赚一小笔佣金，不需要你额外付费。</p><div class="oe of gp gr og oh"><a href="https://frank-andrade.medium.com/membership" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">通过我的推荐链接加入媒体——弗兰克·安德拉德</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">frank-andrade.medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div></div></div>    
</body>
</html>