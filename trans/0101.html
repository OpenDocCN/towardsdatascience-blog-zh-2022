<html>
<head>
<title>Arrows in Python Plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python图中的箭头</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/arrows-in-python-plots-51fb27d3077b#2022-02-04">https://towardsdatascience.com/arrows-in-python-plots-51fb27d3077b#2022-02-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8976" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">matplotlib图中箭头和文本注释的介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5f1a1e7e07d9e0237d1ecb7677764998.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nl3XIdqCBZ9YHM7aAqeioA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@kalebtapp?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">卡莱布·塔普</a>在<a class="ae ky" href="https://unsplash.com/s/photos/arrow?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="2ec7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是(或者说，幸运的是)，数据科学已经发展到不仅仅是构建ML模型。哈佛商业评论最近发表了一篇关于领先的数据科学家做什么的文章。令人惊讶的是，关键技能是<em class="lv">沟通</em>，而不是统计模型的经验。</p><p id="f836" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是一名数据科学家，你现在应该知道讲故事是你的谋生之道。每一双利益相关者的眼睛都在关注你能把故事卖得多好。你得到了他们关注的短暂窗口，如果你失去了这个窗口，你就失去了机会。相信我，要打动观众并不容易，尤其是你是计算机科学出身的。但好的一面是，讲故事的艺术是可以逐渐学会的。</p><blockquote class="lw"><p id="7acb" class="lx ly it bd lz ma mb mc md me mf lu dk translated">也许故事只是有灵魂的数据。— <a class="ae ky" href="https://www.goodreads.com/quotes/556598-maybe-stories-are-just-data-with-a-soul" rel="noopener ugc nofollow" target="_blank">布琳·布朗</a></p></blockquote><p id="b7b8" class="pw-post-body-paragraph kz la it lb b lc mg ju le lf mh jx lh li mi lk ll lm mj lo lp lq mk ls lt lu im bi translated">如果你想擅长与听众交流你的分析，那么第一步就是学会如何尽可能直观地展示你的数据。最近的研究发现，一张图片比一堆冗长的文字要长得多。</p><blockquote class="lw"><p id="74cc" class="lx ly it bd lz ma mb mc md me mf lu dk translated">一幅画最大的价值是当它迫使我们注意到我们从未期望看到的东西。约翰·图基</p></blockquote><p id="50f2" class="pw-post-body-paragraph kz la it lb b lc mg ju le lf mh jx lh li mi lk ll lm mj lo lp lq mk ls lt lu im bi translated">像注释图表这样简单的方法可以创造奇迹。本文尝试在一个情节中引入箭头和文本注释。所以，事不宜迟，我们来学习吧。</p><p id="54b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下代码读取2019年NYC列表，并打印街区及其在数据集中找到的相应列表计数。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="8b72" class="mq mr it mm b gy ms mt l mu mv"># Read data<br/>df = pd.read_csv(‘/kaggle/input/new-york-city-airbnb-open-data/AB_NYC_2019.csv’)</span><span id="87eb" class="mq mr it mm b gy mw mt l mu mv"># Get the count of the listings by neighbourhood.<br/>nbr_freq = df.neighbourhood_group.value_counts()<br/>print(nbr_freq)</span></pre><p id="983b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以得出结论:<strong class="lb iu">曼哈顿</strong>的房源数量最多(21661)，而<strong class="lb iu">斯塔滕岛</strong>的房源数量最少(373)。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="5caf" class="mq mr it mm b gy ms mt l mu mv">Manhattan        21661<br/>Brooklyn         20104<br/>Queens            5666<br/>Bronx             1091<br/>Staten Island      373<br/>Name: neighbourhood_group, dtype: int64</span></pre><p id="ba31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看如何用Staten Island中的列表数来注释Staten Island对应的栏。我们已经使用了<code class="fe mx my mz mm b">annotate</code>函数将文本添加到图表中。函数中使用的参数有:</p><ul class=""><li id="219d" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><code class="fe mx my mz mm b">xy</code>-要标注的点(在图中)的XY坐标</li><li id="f8b8" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><code class="fe mx my mz mm b">xycoords</code>—<code class="fe mx my mz mm b">xy</code>参数的坐标系</li><li id="2ea9" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><code class="fe mx my mz mm b">horizontalalignment</code>—<code class="fe mx my mz mm b">xy</code>位置的文本水平对齐。</li></ul><p id="9d76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前我们已经将<code class="fe mx my mz mm b">xycoords</code>设置为<code class="fe mx my mz mm b">data</code>。它的意思是<code class="fe mx my mz mm b">xy</code>将使用数据的轴作为它的坐标系。因此，在这种情况下，<code class="fe mx my mz mm b">x</code>被设置为<strong class="lb iu">斯塔滕岛</strong>和<code class="fe mx my mz mm b">y</code>为2000。你可以在这里了解其他坐标系<a class="ae ky" href="https://matplotlib.org/stable/tutorials/text/annotations.html#sphx-glr-tutorials-text-annotations-py" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="8b41" class="mq mr it mm b gy ms mt l mu mv">import matplotlib.pyplot as plt<br/>import random</span><span id="6dc0" class="mq mr it mm b gy mw mt l mu mv"># Define figure size<br/>plt.figure(figsize=(10,5))</span><span id="4567" class="mq mr it mm b gy mw mt l mu mv"># Random colors for each plot bar<br/>my_colors = [‘r’, ‘g’, ‘b’, ‘k’, ‘y’] #red, green, blue, black, etc.<br/>random.shuffle(my_colors)</span><span id="87b7" class="mq mr it mm b gy mw mt l mu mv"># Plot the histogram<br/>plt.bar(nbr_freq.index, nbr_freq.values, color=my_colors)</span><span id="12f7" class="mq mr it mm b gy mw mt l mu mv"># Get current axis<br/>ax = plt.gcf().gca()</span><span id="667c" class="mq mr it mm b gy mw mt l mu mv">ax.annotate(‘373 listings’, xy=(“Staten Island”, 2000),<br/> <!-- -->verticalalignment<!-- -->=’top’, <!-- -->horizontalalignment<!-- -->=’center’)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/69cac78fbedb50a15dfb1b5185abeb57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WnHBDxqp45QjoLar_s0ycA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="7dc8" class="mq mr it bd np nq nr dn ns nt nu dp nv li nw nx ny lm nz oa ob lq oc od oe of bi translated">添加简单箭头</h2><p id="564b" class="pw-post-body-paragraph kz la it lb b lc og ju le lf oh jx lh li oi lk ll lm oj lo lp lq ok ls lt lu im bi translated">现在我们明白了如何在情节中放置文本，让我们给它添加更多的噱头。我们可以给情节添加一些形状(比如箭头),让它更吸引人。以下脚本添加了三个新参数来实现这一点。</p><ul class=""><li id="5c92" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated"><code class="fe mx my mz mm b">xytext</code> —放置文本的XY坐标。</li><li id="ca8c" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><code class="fe mx my mz mm b">textcoords</code>—<code class="fe mx my mz mm b">xytext</code>的坐标系</li><li id="9c25" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated"><code class="fe mx my mz mm b">arrowprops</code> —用于在<code class="fe mx my mz mm b">xy</code>和<code class="fe mx my mz mm b">xytext</code>之间绘制箭头的属性(dict)</li></ul><p id="cebe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于下图，将<code class="fe mx my mz mm b">textcoords</code>设置为<code class="fe mx my mz mm b">axes fraction</code>。这意味着<code class="fe mx my mz mm b">xytext</code>的位置是图左下方轴的分数。你可以在这里阅读关于<code class="fe mx my mz mm b">textcoords</code> <a class="ae ky" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.annotate.html" rel="noopener ugc nofollow" target="_blank">的不同坐标系。<code class="fe mx my mz mm b">xytext</code>元组值(0.94，0.8)通过计算轴在两个方向上的分数来放置文本。`</a></p><p id="3503" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mx my mz mm b">arrowprops</code> dict包含许多预定义的键来创建定制形状的箭头。这里使用的一个这样的键是<code class="fe mx my mz mm b">shrink</code>，它定义了从两端收缩的箭头长度的分数。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="5615" class="mq mr it mm b gy ms mt l mu mv">ax.annotate(‘Lowest listings’, <br/>            xy=(“Staten Island”, 1000),<br/>            xycoords=’data’,<br/>            xytext=(0.94, 0.8), <br/>            textcoords=’axes fraction’,<br/>            arrowprops=dict(facecolor=’black’, shrink=0.05),<br/>            horizontalalignment=’right’,<br/>            verticalalignment=’top’)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/19efbebb7a94a6abea7fa52f99902333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rf7AJB3rl_OTE0UbX_iskQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="8e83" class="mq mr it bd np nq nr dn ns nt nu dp nv li nw nx ny lm nz oa ob lq oc od oe of bi translated">添加花式箭头</h2><p id="9f30" class="pw-post-body-paragraph kz la it lb b lc og ju le lf oh jx lh li oi lk ll lm oj lo lp lq ok ls lt lu im bi translated"><strong class="lb iu">使用</strong><code class="fe mx my mz mm b"><strong class="lb iu">FancyArrowPatch</strong></code><strong class="lb iu">——</strong>如果你需要添加一个更复杂的箭头，那么你需要使用<code class="fe mx my mz mm b">FancyArrowPatch</code>。要使用<code class="fe mx my mz mm b">FancyArrowPatch</code>，你必须在<code class="fe mx my mz mm b">arrowprops</code>字典中定义<code class="fe mx my mz mm b">arrowstyle </code>键。<code class="fe mx my mz mm b">arrowstyle</code>键决定箭头的形状。您可以添加其他键值来自定义箭头的颜色和宽度。<code class="fe mx my mz mm b">lw</code>就是一个用来调整箭头宽度的例子。您可以在官方文档中探索更多选项。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="4077" class="mq mr it mm b gy ms mt l mu mv">ax.annotate(‘1091 listings’,<br/>            xy=(“Bronx”, 1500),<br/>            xytext=(“Staten Island”, 5000), <br/>            va=’center’,<br/>            ha=’center’,<br/>            arrowprops={‘arrowstyle’: ‘-|&gt;’})</span><span id="e158" class="mq mr it mm b gy mw mt l mu mv">ax.annotate(‘20104 listings’,<br/>            xy=(1.5, 18000),<br/>            xytext=(“Bronx”, 18000), <br/>            va=’center’,<br/>            ha=’right’,<br/>            arrowprops={‘arrowstyle’: ‘-|&gt;’, ‘lw’: 4})</span><span id="8d1e" class="mq mr it mm b gy mw mt l mu mv">ax.annotate(‘5666 listings’,<br/>            xy=(2.5, 0),<br/>            xytext=(2.5, 6200),<br/>            va=’center’,<br/>            ha=’center’,<br/>            arrowprops={‘arrowstyle’: ‘&lt;-&gt;’})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/06c6dd998881c056c7df5e5bc7bfa41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jZEbT54UY7Klg_cHWfGDMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="babf" class="mq mr it bd np nq nr dn ns nt nu dp nv li nw nx ny lm nz oa ob lq oc od oe of bi translated">定义<code class="fe mx my mz mm b"><em class="ol">ConnectionStyle</em></code></h2><p id="fa8e" class="pw-post-body-paragraph kz la it lb b lc og ju le lf oh jx lh li oi lk ll lm oj lo lp lq ok ls lt lu im bi translated">我们可以通过在<code class="fe mx my mz mm b">arrowprops</code>中定义<code class="fe mx my mz mm b">ConnectionStyle</code> param来控制箭头的形状。<code class="fe mx my mz mm b">connectionstyle</code>可以是三个<code class="fe mx my mz mm b">angle/angle3</code>、<code class="fe mx my mz mm b">arc</code>或<code class="fe mx my mz mm b">bar</code>中的任何一个。在下面三个示例的第一个中，<code class="fe mx my mz mm b">connectionstyle</code>是<code class="fe mx my mz mm b">angle3</code>。简单来说，<code class="fe mx my mz mm b">angle3</code>用于在<code class="fe mx my mz mm b">xy</code>和<code class="fe mx my mz mm b">xytext</code>之间创建一条简单的<a class="ae ky" href="https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Quadratic_B%C3%A9zier_curves" rel="noopener ugc nofollow" target="_blank">二次贝塞尔曲线</a>。起点和终点的斜率分别为<code class="fe mx my mz mm b">angleA</code>和<code class="fe mx my mz mm b">angleB</code>。另一种有趣的连接方式是弧线，在下面的第三个例子中使用。你可以在这里玩不同的<code class="fe mx my mz mm b">conntectionStyle</code><a class="ae ky" href="https://matplotlib.org/stable/gallery/userdemo/connectionstyle_demo.html" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="0272" class="mq mr it mm b gy ms mt l mu mv"># angleA = 0 <br/># angleB = 90<br/>ax.annotate('1091 listings', xy=("Bronx", 1500),<br/>            xytext=("Staten Island", 5000), <br/>            va='center', <br/>            ha='center',<br/>            arrowprops={'arrowstyle': '-|&gt;', 'connectionstyle': 'angle3,angleA=0,angleB=90'})</span><span id="a7bc" class="mq mr it mm b gy mw mt l mu mv"># angleA = 0 <br/># angleB = 90<br/># rad = 5<br/>ax.annotate('5666 listings', xy=("Queens", 6000),<br/>            xytext=("Staten Island", 10000), <br/>            va='center', <br/>            ha='center',<br/>            arrowprops={'arrowstyle': '-&gt;', 'ls':'dashed', 'connectionstyle': 'angle,angleA=0,angleB=90,rad=5'})</span><span id="ff16" class="mq mr it mm b gy mw mt l mu mv"># angleA = 0 <br/># angleB = 90<br/># rad = 0.3<br/>ax.annotate('20104 listings', xy=(1.3, 20300),<br/>            xytext=("Bronx", 16000), <br/>            va='center', <br/>            ha='center',<br/>            arrowprops={'arrowstyle': '-|&gt;', 'connectionstyle': 'arc3,rad=0.3'})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/f897ef805317b9a0412720865773fe8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2bggJNQJ4Dv1tL5tjQHsEw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5b49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看吧！向图表添加箭头是多么容易。我计划很快再写一篇关于互动情节的文章。敬请期待！</p><p id="b46b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">参考文献<br/></strong>【1】:<em class="lv">数据科学家到底做什么，据35数据科学家</em>-<strong class="lb iu"/><a class="ae ky" href="https://hbr.org/2018/08/what-data-scientists-really-do-according-to-35-data-scientists" rel="noopener ugc nofollow" target="_blank">https://HBR . org/2018/08/What-Data-Scientists-Really-Do-据-35-data-scientists </a></p><p id="a1ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]: <em class="lv">纽约市Airbnb开放数据</em> ( <a class="ae ky" href="https://creativecommons.org/publicdomain/zero/1.0/" rel="noopener ugc nofollow" target="_blank"> CCO:公共领域</a>)<a class="ae ky" href="https://www.kaggle.com/dgomonov/new-york-city-airbnb-open-data" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/dgomonov/New-York-City-Airbnb-Open-Data</a></p><p id="d532" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里找到上面例子的python脚本<a class="ae ky" href="https://www.kaggle.com/pratishgupta915/notebook5c8f15c527" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><p id="c7b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你真的喜欢这篇文章，你可以在这里阅读另一篇关于<strong class="lb iu">决策树</strong>T10】的文章。和平！</p></div></div>    
</body>
</html>