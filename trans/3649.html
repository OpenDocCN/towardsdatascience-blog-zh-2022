<html>
<head>
<title>Seaborn Heatmap for Visualising Data Correlations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于可视化数据相关性的Seaborn热图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/seaborn-heatmap-for-visualising-data-correlations-66cbef09c1fe#2022-08-14">https://towardsdatascience.com/seaborn-heatmap-for-visualising-data-correlations-66cbef09c1fe#2022-08-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="51f5" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据可视化| Seaborn</h2><div class=""/><div class=""><h2 id="a2b5" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用一个简单的热图直观地展示各种特征之间的相互关系</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/53730f5beca3e94c107d67b913412122.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DyiD26jxRPn3tncx"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@moino007?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> DDP </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="cd3b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">热图是创建美丽图形的伟大工具，可以为我们提供趋势方面的见解，并允许我们轻松识别数据集中的潜在异常值。</p><p id="dd9f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本教程中，我们将了解热图的用途之一——关联矩阵热图。相关矩阵允许我们确定数据集中的要素之间的相关程度，以及这种相关是正相关还是负相关。</p><p id="6211" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python中有许多数据可视化库，但是最流行和最容易使用的是Seaborn库。<a class="ae lh" href="https://seaborn.pydata.org/generated/seaborn.heatmap.html" rel="noopener ugc nofollow" target="_blank">只需一次函数调用和一个数据集，我们就能轻松创建热图。</a></p><h1 id="e7ed" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">资料组</h1><p id="f1b5" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">我们在本教程中使用的数据集是一个训练数据集的子集，该数据集用作Xeek和FORCE 2020 <em class="nb"> (Bormann等人，2020) </em>举办的机器学习竞赛的一部分。它是在挪威政府的NOLD 2.0许可下发布的，详细信息可以在这里找到:<a class="ae lh" href="https://data.norge.no/nlod/en/2.0/" rel="noopener ugc nofollow" target="_blank">挪威开放政府数据许可(NLOD) 2.0 </a>。</p><p id="921f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">完整的数据集可通过以下链接获得:<a class="ae lh" href="https://doi.org/10.5281/zenodo.4351155" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.5281/zenodo.4351155</a>。</p><p id="451c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">竞赛的目的是利用测井测量从现有的标记数据预测岩性。完整的数据集包括来自挪威海的118口井。</p><h1 id="5354" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">Seaborn热图视频教程</h1><p id="3193" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">我还在我的YouTube频道上发布了这个教程的视频版本，它用另一个数据例子进行了更详细的描述。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="2208" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">导入库和数据</h1><p id="9ba1" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">对于本教程，我们将导入三个库。<a class="ae lh" href="https://pandas.pydata.org" rel="noopener ugc nofollow" target="_blank"> Pandas </a>用于加载我们的数据，而<a class="ae lh" href="https://seaborn.pydata.org/index.html" rel="noopener ugc nofollow" target="_blank"> seaborn </a>用于可视化我们的数据。</p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="52ff" class="nj mf it nf b gy nk nl l nm nn">import pandas as pd<br/>import seaborn as sns</span></pre><p id="36ea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦库被导入，我们就可以开始加载数据了。这是通过使用<code class="fe no np nq nf b">pd.read_csv()</code>并传入文件的相对位置及其名称来完成的。</p><p id="3a64" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后我们提取数据的一个子集。这让我们可以看到我们真正感兴趣的特性。在这种情况下:井径(CALI)、体积密度(RHOB)、伽马射线(GR)、中子孔隙度(NPHI)、光电因子(PEF)和声波压缩慢度(DTC)。</p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="1c60" class="nj mf it nf b gy nk nl l nm nn">well_data = pd.read_csv('data/Xeek_Well_15-9-15.csv')<br/>well_data = well_data[['CALI', 'RHOB', 'GR', 'NPHI', 'PEF', 'DTC']]</span></pre><p id="de25" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦数据加载完毕，我们可以通过调用<code class="fe no np nq nf b">well_data.head()</code>来查看数据集的前五行</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/6c19627f8790a80cbb7c016e0b86a085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*_y4y7cR6tREbYvWelxrRjA.png"/></div></figure><h1 id="cb41" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">创建关联热图</h1><p id="92fc" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">现在，数据已经成功加载，我们可以开始创建我们的第一个热图。</p><p id="2034" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们首先需要创建一个相关矩阵。这很容易通过在我们的数据帧上调用<code class="fe no np nq nf b">.corr()</code>方法来实现。</p><p id="913b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">相关矩阵为我们提供了每个特征相互之间的相关程度的指示。返回值将介于-1和+1之间，较高的相关性倾向于这些端点，较差的相关性倾向于0。</p><p id="ea67" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，我们可以使用<code class="fe no np nq nf b">sns.heatmap()</code>并传递相关矩阵(<code class="fe no np nq nf b">corr</code>)来调用seaborn热图。</p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="e068" class="nj mf it nf b gy nk nl l nm nn">corr = well_data.corr()<br/>sns.heatmap(corr)</span></pre><p id="df39" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们得到的是第一张热图。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/7f89536d37519c367a24a2f82418a78f.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*cR-7zBmFLqwGMLeMO0eLrQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用Seaborn和相关矩阵生成的初始热图。图片由作者提供。</p></figure><p id="2589" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然而，它不是非常实用或视觉上吸引人。默认选择的颜色让人很难理解什么是高度相关的，什么不是。尽管我们有肤色歧视。</p><h1 id="5553" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">更改Seaborn热图颜色</h1><p id="5c0a" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">通过为<code class="fe no np nq nf b">cmap</code>参数提供调色板，我们可以很容易地改变热图的颜色。你可以在这里找到全套调色板<a class="ae lh" href="https://seaborn.pydata.org/tutorial/color_palettes.html" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="08b5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因为我们对以0为中心的高值和低值都感兴趣，所以我强烈推荐使用不同的配色方案。</p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="cee0" class="nj mf it nf b gy nk nl l nm nn">sns.heatmap(corr, cmap='RdBu')</span></pre><p id="e9e6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我们运行它时，我们得到了下面的热图。趋向暗红色的数值负相关，趋向深蓝的数值正相关。颜色越浅，值越接近0。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/101670b01ce6f9b65a0f4b06ff32d42b.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*iQKCdsC3yroVcjCpCOu9QQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">指定自定义颜色图后，相关矩阵的Seaborn热图。图片由作者提供。</p></figure><p id="12b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我们看一下图右侧的颜色条，我们可以看到它从顶部的1开始，下降到底部的-0.8左右。</p><p id="5767" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以通过使用<code class="fe no np nq nf b">vmin</code>和<code class="fe no np nq nf b">vmax</code>参数并将它们分别设置为-1和+1来控制这个范围，使其相等。</p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="ba6e" class="nj mf it nf b gy nk nl l nm nn">sns.heatmap(corr, cmap='RdBu', vmin=-1, vmax=1)</span></pre><p id="5113" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">返回的热图现在具有在正值和负值之间平衡的颜色值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/75347908688c5fc24365642c64a4de33.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*2qbRkRCHCCP6GRI4FQxMFw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">为色彩映射表指定vmin和vmax值后，Seaborn heatmap用于关联矩阵。图片由作者提供。</p></figure><h1 id="a262" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">向Seaborn热图添加数字</h1><p id="3e99" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">如果我们在颜色条上查找某个特定细胞的颜色，我们可能得不到准确的读数。然而，如果我们将数字添加到热图中，我们可以立即看到数值，并且仍然保留颜色的变化。</p><p id="68cb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要将数字添加到热图中，我们只需添加<code class="fe no np nq nf b">annot=True.</code></p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="147e" class="nj mf it nf b gy nk nl l nm nn">sns.heatmap(corr, cmap='RdBu', vmin=-1, vmax=1, annot=True)</span></pre><p id="9853" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们得到的是一个很好的注释热图。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/619759d69d2758efe93719f21da5b357.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*RCWoi9CG9VMDvgkBOcgfIw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">将数字添加到每个单元格后的Seaborn热图。图片由作者提供。</p></figure><p id="5363" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">需要注意的一点是，当我们这样做时，文本的颜色会根据单元格的颜色自动改变。所以没有必要指定任何字体颜色。</p><h2 id="e811" class="nj mf it bd mg nw nx dn mk ny nz dp mo lr oa ob mq lv oc od ms lz oe of mu iz bi translated">在Seaborn热图上自定义注释字体属性</h2><p id="f62f" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">如果我们想要控制注释的字体大小和字体粗细，我们可以调用<code class="fe no np nq nf b">annot_kws</code>并传入一个字典。在这个例子中，我将<code class="fe no np nq nf b">fontsize</code>改为11，并将<code class="fe no np nq nf b">fontweight</code>设为粗体。</p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="38db" class="nj mf it nf b gy nk nl l nm nn">sns.heatmap(corr, cmap='RdBu', vmin=-1, vmax=1, annot=True, <br/>            annot_kws={'fontsize':11, 'fontweight':'bold'})</span></pre><p id="1114" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这使得我们的数字更加突出。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/22f8fbdf35094310b2bec3ef9fe5072a.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*2fZ-8NqrQOYnDw-RGsiPCA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">更改注记属性后的Seaborn热点图。图片由作者提供。</p></figure><h2 id="2a7e" class="nj mf it bd mg nw nx dn mk ny nz dp mo lr oa ob mq lv oc od ms lz oe of mu iz bi translated">使热图单元格成为真正的正方形</h2><p id="1151" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">最后一个例子很简单，但是如果我们希望每个单元格都是正方形而不是矩形，我们可以传入<code class="fe no np nq nf b">square</code>参数并将其设置为<code class="fe no np nq nf b">True</code>。</p><pre class="ks kt ku kv gt ne nf ng nh aw ni bi"><span id="1d55" class="nj mf it nf b gy nk nl l nm nn">sns.heatmap(corr, cmap='RdBu', vmin=-1, vmax=1, annot=True, <br/>            annot_kws={'fontsize':11, 'fontweight':'bold'},<br/>           square=True)</span></pre><p id="5ff3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我们执行这段代码时，我们得到了一个比例很好的热图。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/ea333afea145950d167771d450576679.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*EO9viOpcaGCYL45gnzey_w.png"/></div></figure><h1 id="c415" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">摘要</h1><p id="8fbe" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">热图是直观总结表格数据的好方法。只需看一眼颜色，我们就可以轻松识别数据集中的趋势和异常值。在Python中创建热图非常容易，尤其是当我们使用Seaborn库时。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><p id="2ec1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="nb">感谢阅读。在你走之前，你一定要订阅我的内容，把我的文章放到你的收件箱里。</em> <a class="ae lh" href="https://andymcdonaldgeo.medium.com/subscribe" rel="noopener"> <strong class="lk jd"> <em class="nb">你可以在这里做！</em></strong></a><strong class="lk jd"><em class="nb"/></strong><em class="nb">或者，您也可以</em> <a class="ae lh" href="https://fabulous-founder-2965.ck.page/2ca286e572" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> <em class="nb">注册我的简讯</em> </strong> </a> <em class="nb">免费将更多内容直接发送到您的收件箱。</em></p><p id="ad44" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其次，你可以通过注册成为会员来获得完整的媒介体验，并支持我和成千上万的其他作家。它每个月只花你5美元，你可以完全接触到所有令人惊叹的媒体文章，也有机会用你的写作赚钱。如果你用 <a class="ae lh" href="https://andymcdonaldgeo.medium.com/membership" rel="noopener"> <strong class="lk jd"> <em class="nb">我的链接</em> </strong> </a> <strong class="lk jd"> <em class="nb">，</em> </strong> <em class="nb">报名，你直接用你的一部分费用支持我，不会多花你多少钱。如果你这样做了，非常感谢你的支持！</em></p><h1 id="6be8" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">参考</h1><p id="61c5" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">博尔曼，彼得，奥桑德，彼得，迪里布，法哈德，曼拉尔，投降，&amp;迪辛顿，彼得。(2020).机器学习竞赛FORCE 2020井测井和岩相数据集[数据集]。芝诺多。<a class="ae lh" href="http://doi.org/10.5281/zenodo.4351156" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.4351156</a></p></div></div>    
</body>
</html>