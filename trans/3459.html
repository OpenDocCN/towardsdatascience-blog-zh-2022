<html>
<head>
<title>cGAN: Conditional Generative Adversarial Network — How to Gain Control Over GAN Outputs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">cGAN:条件生成对抗网络——如何获得对GAN输出的控制</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cgan-conditional-generative-adversarial-network-how-to-gain-control-over-gan-outputs-b30620bd0cc8#2022-08-01">https://towardsdatascience.com/cgan-conditional-generative-adversarial-network-how-to-gain-control-over-gan-outputs-b30620bd0cc8#2022-08-01</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="dbd5" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">神经网络</h2><div class=""/><div class=""><h2 id="9465" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">用一个详细的Python例子解释cGAN架构</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/f254cb4e047568a02c13cc88a3008cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6FBNJtsAmkKBdgfMamxEXA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">条件生成对抗网络。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><h1 id="0829" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">介绍</h1><p id="0c09" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">你尝试过生成性对抗网络(GANs)吗？如果是这样，你可能遇到过这样的情况，你想让你的GAN产生一个<strong class="md je">特定类型的数据</strong>，但是对GAN的输出没有足够的控制。</p><p id="55f8" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">例如，假设你使用了一系列花卉图像来训练一个能够制作花卉假像的GAN。虽然您可以使用您的模型生成一个随机的花的图像，但您不能指示它创建一个图像，比如说，一朵郁金香或一朵向日葵。</p><p id="f207" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">有条件的GAN (cGAN)允许我们用类标签等附加信息来调节网络。这意味着在训练过程中，我们将图像和它们的实际标签(玫瑰、郁金香、向日葵等)一起传递给网络。)来了解它们之间的区别。这样，我们就能够要求我们的模型生成特定花朵的图像。</p><h1 id="3514" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">内容</h1><p id="6dde" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">在本文中，我将带您了解以下内容:</p><ul class=""><li id="151a" class="nc nd iu md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated">条件GAN (cGAN)在机器学习算法领域中的地位</li><li id="cdc4" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">cGAN和cDCGAN架构及其组件概述</li><li id="c72c" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">Python示例向您展示了如何使用Keras / Tensorflow从头开始构建条件DCGAN</li></ul><h1 id="80be" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated"><strong class="ak">机器学习算法宇宙内的条件甘(cGAN)</strong></h1><p id="1d64" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">虽然大多数类型的神经网络都是受监督的，但有些(如自动编码器)是自我监督的。由于这一点以及它们对机器学习的独特方法，我在我的ML宇宙图中给神经网络赋予了它们自己的类别。</p><p id="f642" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">由于条件性GAN是GAN的一种类型，您可以在生成性对抗性网络子类别下找到它。点击👇在下面的<strong class="md je">交互式图表</strong>中，找到cGAN并揭示隐藏在ML每个分支下的其他算法。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nq nr l"/></div><p class="le lf gk gi gj lg lh bd b be z dk translated">机器学习算法分类。由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>创建的互动图表。</p></figure><p id="3e0d" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><strong class="md je"> <em class="ns">如果你喜欢数据科学和机器学习</em> </strong> <em class="ns">，请</em> <a class="ae li" href="https://bit.ly/3sItbfx" rel="noopener ugc nofollow" target="_blank"> <em class="ns">订阅</em> </a> <em class="ns">获取我的新文章邮件。如果你不是中等会员，可以在这里加入</em><a class="ae li" href="https://bit.ly/36Mozgu" rel="noopener ugc nofollow" target="_blank"><em class="ns"/></a><em class="ns">。</em></p><h1 id="faf9" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated"><strong class="ak">cGAN架构及其组件概述</strong></h1><h2 id="c026" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">我们如何调节GAN？</h2><p id="89e6" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">让我们首先提醒自己一个基本的<a class="ae li" rel="noopener" target="_blank" href="/gans-generative-adversarial-networks-an-advanced-solution-for-data-generation-2ac9756a8a99">生成对抗网络</a>架构。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oe"><img src="../Images/038e6e10dbeaad5f35c77e3232249255.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKUo2QtHasnr8-RiqeJ_YA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">基本GAN模型架构。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="0a7b" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">如您所见，我们有两个主要组件:</p><ul class=""><li id="a080" class="nc nd iu md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated"><strong class="md je">生成器模型</strong> —生成与问题域相似的新数据(即假数据)。</li><li id="901a" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><strong class="md je">鉴别器模型</strong> —尝试识别所提供的示例是假的(来自生成器)还是真的(来自实际的数据域)。</li></ul><p id="6607" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">在条件性GAN的情况下，<strong class="md je">我们希望对发生器和鉴别器都进行条件化</strong>，以便它们知道自己处理的是哪种类型。</p><p id="30b6" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">假设我们使用GAN创建包含伦敦和马德里房价的合成数据。为了使它有条件，我们需要告诉生成器每次生成哪个城市的数据。我们还需要通知鉴别器传递给它的例子是伦敦的还是马德里的。</p><p id="9b0c" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">因此，有条件的GAN模型架构如下所示:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj of"><img src="../Images/f72261594cff1bde10c89ddac02953d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yO9fLGCR9mOgTVWUKiYQSQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">条件GAN (cGAN)模型架构。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="f05c" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">请注意，我们可以根据多种类型的输入来调节gan。例如，我们还可以在其他图像上调节网络，以便为图像到图像转换创建GAN(例如，将白天的图像转换为夜间的图像)。</p><h2 id="35ce" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated"><strong class="ak">条件深度卷积GAN (cDCGAN) </strong></h2><p id="5fa9" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">与之前的flower示例一样，我们可能希望对<a class="ae li" rel="noopener" target="_blank" href="/deep-convolutional-gan-how-to-use-a-dcgan-to-generate-images-in-python-b08afd4d124e">深度卷积GAN </a>进行调整，以便我们可以要求模型生成特定类型的图像。</p><p id="715f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">下面是一个条件DCGAN的模型架构图。请注意，除了生成器和鉴别器包含额外的层，如<a class="ae li" rel="noopener" target="_blank" href="/convolutional-neural-networks-explained-how-to-successfully-classify-images-in-python-df829d4ba761">卷积</a>和<a class="ae li" rel="noopener" target="_blank" href="/transposed-convolutional-neural-networks-how-to-increase-the-resolution-of-your-image-d1ec27700c6a">转置卷积</a>之外，高级架构与前面的示例基本相同。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj og"><img src="../Images/91b9b3ec5e59ca69664a7be55d2d0306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GAEHmW30RXtcf8MineB49w.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">条件深度卷积生成对抗网络。图片来自<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>。</p></figure><div class="kt ku kv kw gu ab cb"><figure class="oh kx oi oj ok ol om paragraph-image"><a href="https://solclover.com/membership"><img src="../Images/63320331b74bd98eea6402472b4209ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*qkXay39OnVc2IosW6rkxtw.png"/></a></figure><figure class="oh kx oi oj ok ol om paragraph-image"><a href="https://www.linkedin.com/in/saulius-dobilas/"><img src="../Images/60fb21d1cb2701bfb6b71f61c99403e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vabxOXtQ4T034N_mscHSmQ.png"/></a></figure></div><h1 id="4bb8" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">Python示例</h1><p id="4c2f" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">在本例中，我将向您展示如何构建上图所示的cDCGAN。它将使我们能够生成类似于MNIST数据集中的“假”手写数字。</p><p id="59f7" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">由于我们正在构建一个有条件的GAN，我们将能够指定希望生成器每次生成哪个数字(0–9)。</p><h2 id="3d8a" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">设置</h2><p id="6bb6" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我们需要获得以下数据和库:</p><ul class=""><li id="70f3" class="nc nd iu md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated"><a class="ae li" href="https://www.tensorflow.org/api_docs/python/tf/keras/datasets/mnist/load_data" rel="noopener ugc nofollow" target="_blank"> MNIST手写数字数据</a>(版权由Yann LeCun和Corinna Cortes根据<a class="ae li" href="https://creativecommons.org/licenses/by-sa/3.0/" rel="noopener ugc nofollow" target="_blank">知识共享署名-分享3.0许可证持有</a>；数据的原始来源:<a class="ae li" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank">MNIST数据库</a></li><li id="6de2" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>用于数据操作</li><li id="de5d" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">用于一些基本可视化的<a class="ae li" href="https://matplotlib.org/stable/api/index.html" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>和<a class="ae li" href="https://graphviz.org/" rel="noopener ugc nofollow" target="_blank"> Graphviz </a></li><li id="63e4" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated"><a class="ae li" href="https://www.tensorflow.org/api_docs/python/tf" rel="noopener ugc nofollow" target="_blank">神经网络的Tensorflow/Keras </a></li></ul><p id="f295" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">让我们导入库:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><p id="1247" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">上面的代码打印了本例中使用的包版本:</p><pre class="kt ku kv kw gu oo op oq or aw os bi"><span id="d4fd" class="nt lk iu op b gz ot ou l ov ow">Tensorflow/Keras: 2.7.0<br/>numpy: 1.21.4<br/>matplotlib: 3.5.1<br/>graphviz: 0.19.1</span></pre><p id="7622" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">接下来，我们加载MNIST数字数据，这在Keras数据集中是可用的。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><p id="a383" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">上面的代码显示了前十位数字及其标签。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ox"><img src="../Images/56f09dffcfe2751fb20231536d8baa43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bM8S0KrryrxoX9BBNG5slw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">MNIST训练数据集中的前十个数字。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><h2 id="0f7a" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated">创建有条件的DCGAN模型</h2><p id="dfc6" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">完成数据准备后，让我们定义和组装我们的模型。请注意，我们将使用<strong class="md je"> Keras Functional API </strong>，这比顺序API给了我们更多的灵活性，允许我们创建复杂的网络架构。</p><p id="2a53" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们将<strong class="md je">从发电机开始:</strong></p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oy"><img src="../Images/d0f39de2820abd309891b95e07446ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4OmNVIJPIwKSpr9Y-86gw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">发电机模型图。图片来自<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>。</p></figure><p id="836f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">我们有<strong class="md je">两个输入</strong>到一个发电机模型。第一个是100节点的潜在向量，它是我们模型的种子，第二个是标签(0–9)。</p><p id="ddb0" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">潜在向量和标签在通过网络的其余部分之前被整形和连接，转置卷积层将数据放大到所需的大小(28 x 28像素)。</p><p id="0c9f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">接下来，让我们定义一个<strong class="md je">鉴别器模型:</strong></p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oz"><img src="../Images/5fc8f15e098462a56b8d87454a2e3f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfmnSq1h0zNdtGWKb5He8w.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">鉴别器模型图。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="0068" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">鉴频器也有两个独立的输入。一个是标签，另一个是图像——要么是来自MNSIT数据集的真实图像，要么是由生成器模型创建的虚假图像。</p><p id="4f39" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">输入被组合并通过网络传递。卷积层和最大池层在输出层进行预测(真实/虚假)之前提取要素并减小大小。</p><p id="2943" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">让我们<strong class="md je">结合生成器和鉴别器</strong>来创建一个条件深度卷积对抗网络(cDCGAN)。下面代码中的一个关键细节是我们<strong class="md je">使鉴别器模型不可训练</strong>。我们这样做是因为我们希望使用真实和虚假(生成)数据的组合来分别训练鉴别器。稍后您将看到我们是如何做到这一点的。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pa"><img src="../Images/b85b475e0ae288db4cbb9b2c1db1d7e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBXJh3sBKPItHQb8H55jKQ.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">cDCGAN模型图。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="45a2" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">注意生成器和鉴别器如何使用相同的标签作为输入。</p><h2 id="cb71" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated"><strong class="ak">为发生器和鉴别器准备输入</strong></h2><p id="64a9" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我们将创建三个简单的函数来帮助我们为这两个模型采样/生成数据。</p><ul class=""><li id="cc26" class="nc nd iu md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated">第一个函数从训练数据中采样真实图像和标签；</li><li id="1d0f" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">第二个函数从潜在空间中提取随机向量，以及随机标签作为生成器的输入；</li><li id="cc34" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">最后，第三个函数将潜在变量和标签传递到生成器模型中，以生成假的示例。</li></ul><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><h2 id="4955" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated"><strong class="ak">模型培训和评估</strong></h2><p id="31e3" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">最后两个函数将帮助我们训练模型并显示中间结果(以指定的时间间隔)，因此我们可以观察生成器如何随着时间的推移而改进。</p><p id="7522" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">让我们先创建一个函数来显示中期结果:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><p id="d14c" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">最后，让我们定义训练函数:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><p id="a7fe" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">现在我们可以调用我们的训练函数，喝点茶，让计算机完成剩下的工作😃</p><pre class="kt ku kv kw gu oo op oq or aw os bi"><span id="cd28" class="nt lk iu op b gz ot ou l ov ow">train(gen_model, dis_model, gan_model, data, y_train, latent_dim)</span></pre><h2 id="a637" class="nt lk iu bd ll nu nv dn lp nw nx dp lt mk ny nz lv mo oa ob lx ms oc od lz ja bi translated"><strong class="ak">结果</strong></h2><p id="cba2" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">当生成器和鉴别器相互竞争，我们可以跟踪他们的进展。</p><p id="40db" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">以下是生成器创建手写数字的一些早期尝试:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pb"><img src="../Images/d0671af41ec526969cebf0b9a9f99773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hX9I6lY1hkv_x3DzfonHVw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">生成器创建手写数字的早期尝试。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="e9df" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">时代5的一些进展:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pc"><img src="../Images/40c27b4841b98d64b791a814441746a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKVeWN_ur9x3xF9W7RLN0Q.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">第5纪元对生成器结果的改进。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="700f" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">通过Epoch 10的假图像，生成器在整个训练过程中继续变得更好，如下所示:</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pd"><img src="../Images/9d050eec2bd11d95a1a4d0aff88346c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s07ZuEFL6txhH1LGMGNFuA.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">通过Epoch 10改进了生成器结果。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="efec" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">模型训练完成后，我们可以保存发电机部分以备将来使用。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><p id="5de4" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">下面是一个示例，说明我们如何加载模型并让它生成带有特定标签的图像:</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="on nr l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj pe"><img src="../Images/8662ddf7b6a9a67b83b2fd5d8923db44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ENXC6W6b6mkFQpTTGMlbaw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">用我们的cDCGAN模型生成的“假”手写数字。图片由<a class="ae li" href="https://solclover.com/" rel="noopener ugc nofollow" target="_blank">作者</a>提供。</p></figure><p id="0a6c" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">正如您所看到的，结果并不完美，但我们可以通过更长时间地训练模型来进一步改进它们。</p><h1 id="2594" class="lj lk iu bd ll lm ln lo lp lq lr ls lt kj lu kk lv km lw kn lx kp ly kq lz ma bi translated">结束语</h1><p id="7cda" class="pw-post-body-paragraph mb mc iu md b me mf ke mg mh mi kh mj mk ml mm mn mo mp mq mr ms mt mu mv mw in bi translated">我希望我的解释和例子足够清楚。无论哪种方式，如果您有任何问题或建议，请不要犹豫留下评论。上面Python代码的完整Jupyter笔记本可以在我的<a class="ae li" href="https://github.com/SolClover/Art054_NN_cGAN" rel="noopener ugc nofollow" target="_blank"> <strong class="md je"> GitHub库</strong> </a>找到。</p><p id="604a" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">此外，请随时查看我在Medium/TDS上的其他GAN和神经网络文章:</p><ul class=""><li id="f11a" class="nc nd iu md b me mx mh my mk ne mo nf ms ng mw nh ni nj nk bi translated">生成对抗网络:<a class="ae li" rel="noopener" target="_blank" href="/gans-generative-adversarial-networks-an-advanced-solution-for-data-generation-2ac9756a8a99">干</a>，<a class="ae li" rel="noopener" target="_blank" href="/deep-convolutional-gan-how-to-use-a-dcgan-to-generate-images-in-python-b08afd4d124e"> DCGAN </a></li><li id="e703" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">卷积网络:<a class="ae li" rel="noopener" target="_blank" href="/convolutional-neural-networks-explained-how-to-successfully-classify-images-in-python-df829d4ba761"> DCN </a>，<a class="ae li" rel="noopener" target="_blank" href="/transposed-convolutional-neural-networks-how-to-increase-the-resolution-of-your-image-d1ec27700c6a">转置CNN </a></li><li id="21c2" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">经常出现的网络:<a class="ae li" rel="noopener" target="_blank" href="/rnn-recurrent-neural-networks-how-to-successfully-model-sequential-data-in-python-5a0b9e494f92"> RNN </a>，<a class="ae li" rel="noopener" target="_blank" href="/lstm-recurrent-neural-networks-how-to-teach-a-network-to-remember-the-past-55e54c2ff22e"> LSTM </a>，<a class="ae li" rel="noopener" target="_blank" href="/gru-recurrent-neural-networks-a-smart-way-to-predict-sequences-in-python-80864e4fe9f6"> GRU </a></li><li id="47d8" class="nc nd iu md b me nl mh nm mk nn mo no ms np mw nh ni nj nk bi translated">自动编码器:<a class="ae li" rel="noopener" target="_blank" href="/autoencoders-ae-a-smart-way-to-process-your-data-using-unsupervised-neural-networks-9661f93a8509"> AE </a>，<a class="ae li" rel="noopener" target="_blank" href="/denoising-autoencoders-dae-how-to-use-neural-networks-to-clean-up-your-data-cd9c19bc6915"> DAE </a>，<a class="ae li" rel="noopener" target="_blank" href="/vae-variational-autoencoders-how-to-employ-neural-networks-to-generate-new-images-bdeb216ed2c0"> VAE </a>，<a class="ae li" rel="noopener" target="_blank" href="/sparse-autoencoder-neural-networks-how-to-utilise-sparsity-for-robust-information-encoding-6aa9ff542bc9"> SAE </a></li></ul><p id="95c2" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">如果你想收到我即将发表的关于机器学习和神经网络的文章，请用你的电子邮件订阅，一旦我发表了这些文章，它们就会马上到达你的收件箱。</p><p id="a3df" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated">干杯！🤓<br/> <strong class="md je">索尔·多比拉斯</strong></p></div><div class="ab cl pf pg hy ph" role="separator"><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk pl"/><span class="pi bw bk pj pk"/></div><div class="in io ip iq ir"><p id="6028" class="pw-post-body-paragraph mb mc iu md b me mx ke mg mh my kh mj mk mz mm mn mo na mq mr ms nb mu mv mw in bi translated"><em class="ns">我加入媒体的个性化链接:</em></p><div class="pm pn gq gs po pp"><a href="https://bit.ly/3J6StZI" rel="noopener  ugc nofollow" target="_blank"><div class="pq ab fp"><div class="pr ab ps cl cj pt"><h2 class="bd je gz z fq pu fs ft pv fv fx jd bi translated">通过我的推荐链接加入Medium索尔·多比拉斯</h2><div class="pw l"><h3 class="bd b gz z fq pu fs ft pv fv fx dk translated">阅读索尔·多比拉斯和媒体上成千上万的其他作家的每一个故事。你的会员费直接支持索尔…</h3></div><div class="px l"><p class="bd b dl z fq pu fs ft pv fv fx dk translated">solclover.com</p></div></div><div class="py l"><div class="pz l qa qb qc py qd lc pp"/></div></div></a></div></div></div>    
</body>
</html>