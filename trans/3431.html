<html>
<head>
<title>Customer Segmentation with Python (Implementing STP Framework - Part 2/5)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python进行客户细分(实现STP框架——第2/5部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/customer-segmentation-with-python-implementing-stp-framework-part-2-689b81a7e86d#2022-07-29">https://towardsdatascience.com/customer-segmentation-with-python-implementing-stp-framework-part-2-689b81a7e86d#2022-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="48aa" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python实现k-means聚类的分步指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/36f849854d413973c6a7e64f1e6ca7e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4dz3EKG4mZ_koU0b"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">艾萨克·史密斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3e23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的<a class="ae ky" href="https://medium.com/@analyticsoul/5c2d93066f82" rel="noopener">上一篇文章</a>中，我们开始了实施流行的STP营销框架的旅程，在这篇文章中，我们将通过使用最流行的无监督机器学习算法之一“k-means聚类”来克服分层分割的局限性，从而继续我们的旅程。</p><p id="2cb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">整个笔记本和数据集都可以在<a class="ae ky" href="https://deepnote.com/workspace/asish-biswas-a599-b6cca607-3c12-4ae6-b54d-32861e7e9438/project/Analytic-School-8e6c85bd-e8c9-4387-ba40-0b94fb791066/%2Fnotebooks%2Fcustomer_segmentation.ipynb" rel="noopener ugc nofollow" target="_blank"> Deepnote笔记本</a>中获得。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="36a4" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">Table of contents</strong></span><span id="1734" class="ma mb it lw b gy mg md l me mf">  ∘ <a class="ae ky" href="#2740" rel="noopener ugc nofollow">Introduction</a><br/>  ∘ <a class="ae ky" href="#99d8" rel="noopener ugc nofollow">Implementing K-Means Clustering</a><br/>  ∘ <a class="ae ky" href="#9494" rel="noopener ugc nofollow">Observations</a><br/>  ∘ <a class="ae ky" href="#2617" rel="noopener ugc nofollow">Visualize our customer segments</a><br/>  ∘ <a class="ae ky" href="#b70d" rel="noopener ugc nofollow">Conclusion</a></span></pre><h2 id="2740" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">介绍</h2><p id="911c" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">分层聚类对于小型数据集非常有用，但是随着数据集大小的增长，计算需求也会快速增长。因此，层次聚类是不实际的，在行业中，平面聚类比层次聚类更受欢迎。在这篇文章中，我们将使用k-means聚类算法来划分我们的数据集。</p><p id="8a80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有许多无监督聚类算法，但k-means是最容易理解的。K-means聚类可以将未标记的数据集分割成预定数量的组。输入参数“k”代表我们希望在给定数据集中形成的聚类或组的数量。然而，我们必须小心选择“k”的值。如果“k”太小，那么质心就不会位于簇内。另一方面，如果我们选择‘k’太大，那么一些集群可能会过度分裂。</p><p id="684a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我推荐下面这篇文章来学习更多关于k-means聚类的知识:</p><div class="nd ne gp gr nf ng"><a rel="noopener follow" target="_blank" href="/understanding-k-means-clustering-in-machine-learning-6a6e67336aa1"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd iu gy z fp nl fr fs nm fu fw is bi translated">理解机器学习中的K-均值聚类</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">K-means聚类是最简单和最流行的无监督机器学习算法之一。</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">towardsdatascience.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu ks ng"/></div></div></a></div><h2 id="99d8" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">实现K均值聚类</h2><p id="4f6f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">k均值算法的工作方式是:</p><ol class=""><li id="508b" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">我们选择我们想要的集群数量“k”</li><li id="576b" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">随机指定簇质心</li><li id="3c67" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">直到聚类停止变化，重复以下步骤:<br/> i .将每个观察值分配给质心最近的聚类<br/> ii。通过取每个聚类中点的平均向量来计算新的质心</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/1156ee462eb2f9928ab6780a69af9eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/1*lPcP9mUtfq9sApyWtPIvQg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://commons.wikimedia.org/wiki/File:K-means_convergence.gif" rel="noopener ugc nofollow" target="_blank">https://commons . wikimedia . org/wiki/File:K-means _ convergence . gif</a></p></figure><p id="7fe2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">k-means算法的局限性在于，您必须预先决定您期望创建多少个聚类。这需要一些领域知识。如果您没有领域知识，您可以应用“肘法”来确定“k”(聚类数)的值。<br/>这种方法本质上是一种蛮力方法，在这种方法中，对于某个“k”值(例如2-10)，计算每个聚类成员与其质心之间的平方距离之和，并根据平方距离绘制“k”。随着簇数量的增加，平均失真将会减少，这意味着簇质心将会向每个数据点移动。在图中，这将产生一个肘状结构，因此命名为“肘法”。我们将选择距离突然减小的“k”值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="om ol l"/></div></figure><p id="4ed8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们在上面的图表中看到的，这条线僵硬地下降，直到我们到达第4类的数字，然后下降更加平稳。这意味着我们的肘在4，这是我们的最佳集群数量。这也符合我们在<a class="ae ky" href="https://medium.com/p/5c2d93066f82" rel="noopener">上一篇文章</a>中所做的层次聚类的输出。</p><p id="c736" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们对4个集群执行k-means聚类，并在我们的数据帧中包含段号。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on ol l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo ol l"/></div></figure><h2 id="9494" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">观察</h2><p id="00a7" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">太好了，我们已经把客户分成了4组。现在让我们试着去了解每一组的特点。首先，让我们通过聚类来查看每个特征的平均值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op ol l"/></div></figure><p id="14f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我的一些观察:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/e0d29ab9d5e18878d6b459837506ba10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-cbytuN__9LBgRyLda9jvg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="04f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据以上观察，我感觉第1和第4部分比第2和第3部分富裕，收入更高，职业更好。<br/>最好给每个组分配合适的名称。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="664f" class="ma mb it lw b gy mc md l me mf">1: 'well-off'<br/>2: 'fewer-opportunities'<br/>3: 'standard'<br/>4: 'career-focused'</span></pre><p id="5fe8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看看每个细分市场的客户数量:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or ol l"/></div></figure><h2 id="2617" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">可视化我们的客户群</h2><p id="d73e" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">年龄与收入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ol l"/></div></figure><p id="2287" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">教育与收入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ot ol l"/></div></figure><h2 id="b70d" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">结论</h2><p id="e4b1" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们在“年龄与收入”散点图中观察到，高收入(富裕)的高年龄客户是分开的，但其他三个细分市场没有那么明显。</p><p id="6ded" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第二个观察‘学历vs收入’小提琴情节中，我们看到没有学历的客户收入较低，毕业的客户收入较高。但是其他部分不是那么可分的。</p><p id="2eb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据这些观察，我们可以得出结论，k-means在将数据分成簇方面做得不错。然而，结果并不令人满意。在下一篇文章中，我们将把k-means和主成分分析结合起来，看看我们如何能取得更好的结果。</p><p id="c72a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和以前一样，全部代码和所有支持数据集都可以在<a class="ae ky" href="https://deepnote.com/workspace/asish-biswas-a599-b6cca607-3c12-4ae6-b54d-32861e7e9438/project/Analytic-School-8e6c85bd-e8c9-4387-ba40-0b94fb791066/%2Fnotebooks%2Fcustomer_segmentation.ipynb" rel="noopener ugc nofollow" target="_blank"> Deepnote笔记本</a>中获得。</p></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="2930" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pb">感谢阅读！如果你喜欢这篇文章一定要</em> <strong class="lb iu"> <em class="pb">鼓掌(最多50！)</em> </strong> <em class="pb">和咱们</em> <strong class="lb iu"> <em class="pb">连上</em></strong><em class="pb"/><a class="ae ky" href="https://www.linkedin.com/in/asish-biswas/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="pb">LinkedIn</em></strong></a><em class="pb">和</em> <strong class="lb iu"> <em class="pb">关注我上媒</em> </strong> <em class="pb">保持更新我的新文章</em></p><p id="0ed6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pb">通过此</em> <a class="ae ky" href="https://analyticsoul.medium.com/membership" rel="noopener"> <em class="pb">推荐链接</em> </a> <em class="pb">加入Medium，免费支持我。</em></p><div class="nd ne gp gr nf ng"><a href="https://analyticsoul.medium.com/membership" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd iu gy z fp nl fr fs nm fu fw is bi translated">通过我的推荐链接加入Medium—Asish bis was</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">阅读阿西什·比斯瓦斯(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">analyticsoul.medium.com</p></div></div><div class="np l"><div class="pc l nr ns nt np nu ks ng"/></div></div></a></div></div></div>    
</body>
</html>