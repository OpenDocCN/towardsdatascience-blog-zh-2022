# 因果关系和人工智能想象

> 原文：[https://towardsdatascience.com/causality-counterfactuals-and-ai-imagination-7a0c10cec6ae#2022-11-13](https://towardsdatascience.com/causality-counterfactuals-and-ai-imagination-7a0c10cec6ae#2022-11-13)

## 因果关系如何帮助推进机器“想象”的状态？

在过去的几个月里，有大量的媒体报道了文本到图像建模的惊人进展。这些模型可以基于用户输入的文本提示生成人类级别的艺术品，并且是新一波艺术图像生成算法的一部分。

![](../Images/b519b7b098d871242b982ff96d03b14f.png)

图 1:由稳定扩散模型生成的样本图像。在 [CreativeML Open RAIL-M](https://github.com/CompVis/stable-diffusion/blob/main/LICENSE) 下许可的稳定扩散模型输出。

很难不对机器从简单的句子中变出如此细节的能力印象深刻——如图 1 所示。

我们可以推测图像生成模型的工作方式如下。我们有一组数据(在[稳定扩散](https://stability.ai/blog/stable-diffusion-public-release)~ 50 亿张图像的情况下)，根据这些数据，我们学习一组规则——一个数学函数——它们精确地描述了底层数据。在图 2 中可以看到一个非常简单的例子。

![](../Images/e4abf25dfb5bee8f884f26493556171f.png)

图 2:二维(X 和 Y)的简单曲线拟合。作者创建的图像。

为了“想象”新的实例，我们简单地使用我们的函数来预测函数最初没有显示的数据点，例如，图 2 中没有显示 X 值 5，但是使用曲线，我们可以将相应的 Y 估计为 20。

这就是所有机器学习模型如何根据看不见的数据生成预测。文本到图像模型，如稳定扩散，以及它的表兄弟 DALLE 和 Imagen，也不例外。该算法将从数十亿个参数*的学习维度空间中进行采样，解释文本提示以指导在空间中的何处进行搜索，然后返回从未见过的图像。魔法。

# 为什么因果关系很重要？

挑战在于，这些生成式人工智能模型与我们对世界的理解不同。他们非常擅长重新创造普通场景的新视图，但不理解工作中的因果关系。

![](../Images/907c465e903db4bca404644a880638f0.png)

图 3:稳定扩散生成的图像，展示了当模型缺乏对因果关系的理解时，简单的场景是如何失败的。由作者使用[稳定扩散](https://huggingface.co/spaces/stabilityai/stable-diffusion)生成的图像。

如果不理解世界内部相互作用的因果关系，这些模型就无法“想象”我们认为微不足道的情景。

# 那么，因果关系在哪里呢？

因果模型采取了不同的方法。上面的文本到图像模型“想象”来自新文本提示的看不见的数据实例，而因果模型允许我们探索两种非常人性化的行为:

*   **策划** *(干预):*给定某个场景，我该怎么做？
*   **反思** *(反事实):*基于所发生的事情，我本可以做些什么不同的事情？

你会注意到，这些类型的“想象”与文本对图像模型的创造能力是非常不同的。事实上，因果关系的世界区分了这些不同的类型，如下面图 4 所示的朱迪亚·珀尔的因果关系阶梯。

![](../Images/e9f84a04f51a37faf0a874b4df899311.png)

图 4:朱迪亚·珀尔的因果阶梯。作者创建的图像。

稳定扩散等深度学习模型执行的任务位于梯子上的“看见”级别。这些模型能够回答诸如“如果我在文本提示中看到‘猫’这个词怎么办？”。

因果模型能让我们爬得更高。他们让我们接触到**干预**，帮助回答*计划*类型的问题，以及**反事实**，让我们*反思*之前的见解。

干预和反事实为我们提供了回答机器学习模型之前无法解决的问题的超能力。

让我们用一个例子来说明这些在现实世界中是如何应用的。假设我们有一大堆关于音乐家的数据。我们希望根据各种不同的功能来预测他们在 6 个月内的销售记录。因此，我们确定了一个**因果图**，它显示了这些特征之间的关系，以及这些特征对唱片销售的影响。请看图 5，这是一个虚构的例子**。

![](../Images/3c703b4b4632b033817cfb97a07c8003.png)

图 5:如何估计给定艺术家的音乐销量的因果图示例。作者创建的图像。

虽然创建的图表过于简化，但它确实展示了使用因果技术的好处。因果图明确地告诉我们已经编码到我们的模型中的假设，使它比其他方法更容易解释:

*   从“唱片公司营销支出”指向“6 个月创纪录销售额”的箭头表明，我们认为这两者之间存在某种因果关系。在这种情况下，营销支出会带来更大的销售额。

# 介于中间的

一旦我们有了因果图，我们就可以进行干预来想象一个新的场景。我们可以问“一个艺人获得 10 个小时的电台播放时间会有什么影响？”并在 6 个月内看到对销售的后续影响。这种干预将新值强加到“广播播放”特征中，将其设置为 10 小时。

事实上，这是一种干预，意味着我们不会简单地寻找其他有 10 小时广播剧的艺术家，并比较相似之处。干预意味着将广播剧的价值限制在 10 小时，防止抖音的营销支出和使用影响广播剧。

![](../Images/e31aec75aa848eea109ec84b33c7110f.png)

图 6:应用将广播播放时间设置为 10 小时的干预，并显示它如何改变原始因果图。作者创建的图像。

通过隔离广播剧的影响，我们可以计算***，只要我们有足够的数据，如果一个艺术家得到 10 个小时的播放时间，6 个月内唱片销售的合理无偏估计。

# 反事实

传统的机器学习模型学习训练时输入给它们的数据的表示。

然后，应用于模型的巧妙技术允许用户塑造和塑造数据表示。在稳定扩散的情况下，这些是模型学习与数据表示的不同区域相关联的文本提示，即，如果文本提示包含单词“cat”，则模型被限制为从数据表示的“cat 部分”中挑选。

因果模型也允许这些行为，但也可以改变底层的数据表示，而不是简单地塑造它。这个**允许因果模型用于回答真正的反事实问题****** 。

反事实是关于替代现实的问题，作为人类，我们一直在使用它们，它们是以下方面的基础:

*   *现代医学:*“是扑热息痛让我退烧的吗？”
*   *警察工作:*“如果受害者早一个小时离开，他们会活下来吗？”
*   *你的网飞狂欢:*“如果我没有看 8 小时的《欧扎克》，我会感到如此内疚吗？”

反事实为我们提供了一种“想象”不同结果的新技术——这是其他机器学习工具无法做到的。让我们考虑一个例子:“如果泰勒·斯威夫特的电台播放时间减半至 1000 小时，她的销量会是多少？”。

![](../Images/c01adbc7e663664adaa5a3445d00d82f.png)

图 7:泰勒·斯威夫特改变电台播放时间的影响的反事实例子。作者创建的图像。

请注意，反事实还包括干预(将泰勒的广播剧设置为 1000 小时)，但尽管前面的干预问题对任何艺术家都是通用的，但反事实是特定于个人的，泰勒在抖音的广告支出和使用仍是他们的原始价值。

# 结论

虽然最新和最伟大的生成式人工智能模型可以创建令人惊叹的图像，但在人工智能中实现类似人类的想象力还有很长的路要走。

在我们寻求机器想象力的过程中，因果关系可以提供许多强大的工具，为我们提供提前计划的方法，同时反思以前的事件。

# 附录

*一个很酷的网站是[https://losslandscape.com/](https://losslandscape.com/)，在那里你可以查看这些深度学习模型探索以获得可行解决方案的维度空间的真实世界示例。我相信你也可以把它们当作非功能性食品来卖。

* *我们不会在这篇文章中讨论如何构建因果图。现在假设这超越了天堂，进入了我们的集体意识。或者，请随意阅读该主题，这篇关于数据科学的文章给出了[合理的介绍](/causal-discovery-6858f9af6dcb#:~:text=Causal%20discovery%20aims%20to%20infer,causal%20model%20that%20describes%20it.)。而[这篇论文](https://www.its.caltech.edu/~fehardt/papers/Eberhardt_IJDSA2017.pdf)更有深度。

* * *可以使用随机对照试验来计算干预，其中概率干预确定您是否接受治疗或安慰剂，或者通过以巧妙的方式分割数据集来消除其他特征的影响。如果你有兴趣了解更多这方面的知识，请留下你的评论，我会在上面写一篇博客！

* * * *对于那些目前尖叫，你可以从传统的基于 ML 的模型计算反事实；这是真的。然而，我区分了这些反事实，以及那些通过使用“真正的反事实”可能存在因果关系的反事实。基于相关性的反事实估计假设一个因果图结构，其中每个数据点对目标都有因果影响，称为[星形图](https://en.wikipedia.org/wiki/Star_(graph_theory))。

这样做的结果是，如果数据生成过程的真正因果结构偏离了这一点(即，您的要素交互并不完全相互独立)，您将无法计算代表性的反事实。这就是误导性的反例。