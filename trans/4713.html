<html>
<head>
<title>Paper: ‘EpiLPS: A Fast and Flexible Bayesian Tool for Estimation of the Time-Varying Reproduction Number’</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">论文:“EpiLPS:估计时变再生数的快速灵活的贝叶斯工具”</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/paper-epilps-a-fast-and-flexible-bayesian-tool-for-estimation-of-the-time-varying-reproduction-c9280017ab64#2022-10-19">https://towardsdatascience.com/paper-epilps-a-fast-and-flexible-bayesian-tool-for-estimation-of-the-time-varying-reproduction-c9280017ab64#2022-10-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4378" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何平滑流行病曲线并灵活估计时变再生数</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/594cfdd47f57b3ef00c60ff577d1034e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6Jd0HRLiOROb2Dyn.PNG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><h1 id="2dda" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><p id="2dc1" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi mm translated">我的一位同事(也是朋友)最近在PLoS计算生物学上发表了一篇题为“EpiLPS:一种快速灵活的估计时变繁殖数的贝叶斯工具”的研究论文。</p><p id="2767" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">我没有分享我没有参与的研究论文的习惯。尽管如此，我还是想为这一次破例，因为我坚信这篇论文中开发的方法值得被了解，尤其是对任何从事流行病学工作的人。</p><p id="ad40" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">下面是这篇文章背后的动机，以及对模拟和真实数据(美国住院数据)的说明。更多信息可以在<a class="ae na" href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010618" rel="noopener ugc nofollow" target="_blank">的论文</a>和相关的<a class="ae na" href="https://epilps.com/" rel="noopener ugc nofollow" target="_blank">网站</a>上找到。</p><h1 id="b22a" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">动机</h1><p id="8361" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">epi LPS(<a class="ae na" href="https://statsandr.com/blog/paper-epilps-a-fast-and-flexible-bayesian-tool-for-estimation-of-the-time-varying-reproduction-number/#ref-gressani2022epilps" rel="noopener ugc nofollow" target="_blank">Gressani et al . 2022</a>)是时变再生数Rt的灵活贝叶斯推断的方法论；在时间t时由受感染病原体产生的继发性病例的平均数量。这是一个关键的流行病学参数，可告知传染病的传播潜力，可由公共卫生当局用于评估干预措施的有效性，并为未来的控制策略提出方向。</p><p id="1c77" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">这一指标在新型冠状病毒疫情期间广受欢迎，媒体广泛报道，因为其含义易于直观理解。简而言之，当R &lt; 1, the signal is encouraging as the epidemic is under control and will eventually vanish. On the contrary, a value of R &gt; 1意味着疾病持续传播，感染正在目睹扩张性影响。因此，拥有一个强大而可靠的工具来根据传染病数据计算繁殖数是至关重要的。</p><p id="aec7" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">来自哈瑟尔特大学(比利时)、莱顿大学(荷兰)和伯尔尼大学(瑞士)的EpiPose团队的一组研究人员最近开发了一种新方法，用于根据给定序列间隔分布的发病率时间序列数据(从感染者出现症状到继发病例出现症状之间经过的时间)来估计瞬时再生数。他们将他们的方法称为EpiLPS，用于“<strong class="ls iu">Epi</strong>demiology modeling with<strong class="ls iu">L</strong>apla cian-<strong class="ls iu">P</strong>-<strong class="ls iu">S</strong>plines”，因为拉普拉斯近似和P样条平滑器是形成所提出的方法的主干的关键成分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/64d607c9ac7d96665418316bc1d93862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BBKCNb47g2xaeCiA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="05fb" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">EpiLPS模型假设观察到的报告病例(按报告日期或症状发作日期)受负二项分布支配。因此，与泊松模型相反，它允许考虑过度分散的特征。流行病曲线在第一步中用P样条(其中潜在变量的后验估计通过拉普拉斯近似计算)平滑，并且在第二步中使用更新方程模型作为再生数和通过“插入”方法估计的样条系数之间的桥梁。</p><p id="c3c5" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">作者还解释了EpiLPS和EpiEstim之间的主要区别，epi estim是一种由<a class="ae na" href="https://statsandr.com/blog/paper-epilps-a-fast-and-flexible-bayesian-tool-for-estimation-of-the-time-varying-reproduction-number/#ref-cori2013new" rel="noopener ugc nofollow" target="_blank">柯里等人(2013 </a>)开发的用于实时估计Rt的成熟方法，并在不同的流行病情景下对这两种方法进行了广泛的比较。</p><p id="86ad" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">EpiLPS的一个有趣特性是，用户可以选择完全“无采样”路径，其中模型超参数固定在其<em class="nb">最大后验概率</em> (LPSMAP)或基于Metropolis-adjusted Langevin算法(LPSMALA)的完全随机路径(LPSMALA)。说到效率，拉普拉斯近似和B样条求值的例程已经用C++编写，并通过<a class="ae na" href="https://www.rcpp.org/" rel="noopener ugc nofollow" target="_blank"> Rcpp包</a>集成到R中，因此底层算法可以在可忽略的时间内执行。</p><p id="cd24" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">下面，我们提供一个简短的例子，说明如何使用EpiLPS例程来估计rt。</p><h1 id="9f7c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">入门指南</h1><p id="3d9a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">EpiLPS包可从CRAN获得(参见<a class="ae na" href="https://cran.r-project.org/web/packages/EpiLPS/index.html" rel="noopener ugc nofollow" target="_blank">https://cran.r-project.org/web/packages/EpiLPS/index.html</a>),并可通过输入以下命令从R控制台安装:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="06f6" class="nh kz it nd b gy ni nj l nk nl">install.packages("EpiLPS")</span></pre><p id="f5cf" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">然后，可以按如下方式加载该包:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="88ee" class="nh kz it nd b gy ni nj l nk nl">library("EpiLPS")</span></pre><p id="d449" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">EpiLPS包的结构相当简单，因为它包含几个例程:</p><ul class=""><li id="5f98" class="nm nn it ls b lt mv lw mw lz no md np mh nq ml nr ns nt nu bi translated">函数<code class="fe nv nw nx nd b">epilps()</code>是拟合再现数的核心程序。</li><li id="6b0c" class="nm nn it ls b lt ny lw nz lz oa md ob mh oc ml nr ns nt nu bi translated">通过<code class="fe nv nw nx nd b">plot.epilps()</code>，用户可以绘制估计的流行曲线和Rt。</li><li id="fb34" class="nm nn it ls b lt ny lw nz lz oa md ob mh oc ml nr ns nt nu bi translated">最后，开发了两个辅助程序<code class="fe nv nw nx nd b">episim()</code>和<code class="fe nv nw nx nd b">perfcheck()</code>来基本上再现相关论文的模拟结果。</li></ul><h1 id="cbd5" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">模拟的例子</h1><p id="49ef" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">一组流行病数据可以用<code class="fe nv nw nx nd b">episim()</code>程序模拟，方法是指定一个序列区间分布，并在一组可用的模式中选择真实的繁殖数曲线(这里我们选择模式5，对应于一条相当波动的曲线)。</p><p id="b192" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">按照<code class="fe nv nw nx nd b">endepi</code>选项中的规定，模拟疫情将持续40天。通过设置选项<code class="fe nv nw nx nd b">plotsim = TRUE</code>，程序返回一个总结事件时间序列的图形、一个指定序列间隔分布的条形图以及真实的基本再生数曲线。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="cb6c" class="nh kz it nd b gy ni nj l nk nl">set.seed(1234)</span><span id="d1e8" class="nh kz it nd b gy od nj l nk nl">SI &lt;- c(0.344, 0.316, 0.168, 0.104, 0.068)<br/>simepidemic &lt;- episim(<br/>  serial_interval = SI,<br/>  Rpattern = 5,<br/>  plotsim = TRUE,<br/>  verbose = TRUE,<br/>  endepi = 40<br/>)</span><span id="9d16" class="nh kz it nd b gy od nj l nk nl">## Chosen scenario: 5 'Wiggly then stable Rt'.<br/>## Incidence of cases generated from a Poisson distribution. <br/>## Total number of days of epidemic: 40.</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4ae1287b9d82293cf85f42c071dabb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a-c-jJPUmue1Ze7l.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="65a2" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">如果您想了解生成的事件时间序列的概况，只需输入:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="20d8" class="nh kz it nd b gy ni nj l nk nl">simepidemic$y</span><span id="857d" class="nh kz it nd b gy od nj l nk nl">##  [1]  10   6  15  24  37  43  54  46  47  28  20   8  10  10   3   5   3   4   6<br/>## [20]   6  15  21  44  75 135 217 329 409 453 487 457 443 297 290 255 246 246 339<br/>## [39] 395 573</span></pre><h2 id="41e1" class="nh kz it bd la oe of dn le og oh dp li lz oi oj lk md ok ol lm mh om on lo oo bi translated">平滑流行病曲线和估计Rt</h2><p id="60d6" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">现在让我们使用<code class="fe nv nw nx nd b">epilps()</code>例程来平滑流行病曲线并估计再生数。</p><p id="c73e" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">我们将通过LPSMAP(一种完全无采样的方法)和LPSMALA(一种完全随机的方法，依赖于具有朗之万动态的MCMC算法)来实现这一点，其中我们指定长度为10000的链和大小为4000的老化。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="1817" class="nh kz it nd b gy ni nj l nk nl">LPSMAP_fit &lt;- epilps(<br/>  incidence = simepidemic$y,<br/>  serial_interval = SI,<br/>  tictoc = TRUE<br/>)</span><span id="be58" class="nh kz it nd b gy od nj l nk nl">## Inference method chosen: LPSMAP. <br/>## CI for LPSMAP computed via lognormal posterior approx. of Rt.Total number of days: 40. <br/>## Mean Rt discarding first 7 days: 1.327.<br/>## Mean 95% CI of Rt discarding first 7 days: (1.164,1.527) <br/>## Elapsed real time (wall clock time): 0.229 seconds.</span><span id="e2f6" class="nh kz it nd b gy od nj l nk nl">LPSMALA_fit &lt;- epilps(<br/>  incidence = simepidemic$y, serial_interval = SI,<br/>  method = "LPSMALA", chain_length = 10000, burn = 4000<br/>)</span><span id="cfa9" class="nh kz it nd b gy od nj l nk nl">## Inference method chosen: LPSMALA with chain length 10000 and warmup 4000.<br/>## MCMC acceptance rate: 56.41%. <br/>## Geweke z-score &lt; 2.33 for:  32 / 33  variables. <br/>## Total number of days: 40. <br/>## Mean Rt discarding first 7 days: 1.326.<br/>## Mean 95% CI of Rt discarding first 7 days: (1.117,1.555). <br/>## Timing of routine not requested.</span></pre><p id="e5a2" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">执行后，每个例程在控制台中打印用户请求的方法的简要摘要。</p><p id="84c7" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">对于LPSMALA，总结了链长、接受率(应该在57%左右)等基本信息。从打印输出可以看出，模拟流行病的平均再生数约为1.32。</p><p id="0caf" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">比方说，我们现在可以使用<code class="fe nv nw nx nd b">LPSMALA_fit</code>对象和<code class="fe nv nw nx nd b">plot()</code>例程来获得平滑的流行病曲线和估计的再生数(默认情况下，可信区间为5%的显著性水平，但这可以由用户更改)。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="a058" class="nh kz it nd b gy ni nj l nk nl">days &lt;- seq(8, 40)</span><span id="bb55" class="nh kz it nd b gy od nj l nk nl">#--- Smoothed epidemic curve<br/>gridExtra::grid.arrange(<br/>  plot(LPSMALA_fit,<br/>    plotout = "epicurve", incibars = TRUE, themetype = "light",<br/>    epicol = "darkgreen", cicol = rgb(0.3, 0.73, 0.3, 0.2),<br/>    epititle = "Smoothed epidemic curve", titlesize = 13, barwidth = 0.25<br/>  ),</span><span id="74dc" class="nh kz it nd b gy od nj l nk nl">  #--- Estimated reproduction number<br/>  plot(LPSMALA_fit,<br/>    plotout = "rt", theme = "light", rtcol = "black",<br/>    titlesize = 13, Rtitle = "Estimated R (LPSMALA)"<br/>  ),<br/>  nrow = 1, ncol = 2<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fcf5febecfb67532203b2f90950bf186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YbgmFgndN-A2MCAD.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="ba07" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">该图可以通过多种方式定制:</p><ul class=""><li id="dd41" class="nm nn it ls b lt mv lw mw lz no md np mh nq ml nr ns nt nu bi translated">用户可以在<code class="fe nv nw nx nd b">themetype</code>下指定主题。可用选项有<code class="fe nv nw nx nd b">gray</code>(默认)、<code class="fe nv nw nx nd b">classic</code>、<code class="fe nv nw nx nd b">light</code>和<code class="fe nv nw nx nd b">dark</code>。</li><li id="d270" class="nm nn it ls b lt ny lw nz lz oa md ob mh oc ml nr ns nt nu bi translated">其他选择，如是否显示发病率柱、可信区间包络的颜色、平滑流行病曲线的颜色和估计再生数也是可用的。</li></ul><p id="4056" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">上图是在<code class="fe nv nw nx nd b"><a class="ae na" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">ggplot2</a></code> <a class="ae na" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">包</a>中生成的，但是还有另一种直接从<code class="fe nv nw nx nd b">LPSMAP_fit</code>和<code class="fe nv nw nx nd b">LPSMALA_fit</code>对象中提取信息的方法。事实上，可以提取并绘制每天的估计再现数值及其相关可信区间。</p><p id="403e" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">下面，我们进行练习并绘制分别用LPSMAP和LPSMALA获得的估计Rt，并将其与真实的基本再生数曲线进行比较。合身度挺好的。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="610a" class="nh kz it nd b gy ni nj l nk nl">par(mfrow = c(1, 2))</span><span id="bec3" class="nh kz it nd b gy od nj l nk nl">#--- LPSMAP vs target R<br/>plot(days, sapply(days, simepidemic$Rtrue),<br/>  type = "l", lwd = 2, ylim = c(0, 4),<br/>  ylab = "Estimated R", xlab = "Time"<br/>)<br/>polygon(<br/>  x = c(days, rev(days)), y = c(<br/>    LPSMAP_fit$epifit$R95CI_low[8:40],<br/>    rev(LPSMAP_fit$epifit$R95CI_up[8:40])<br/>  ),<br/>  col = rgb(0.23, 0.54, 1, 0.3), border = NA<br/>)<br/>lines(days, LPSMAP_fit$epifit$R_estim[8:40], type = "l", col = "cornflowerblue", lwd = 2)<br/>lines(days, sapply(days, simepidemic$Rtrue), type = "l", lwd = 2)</span><span id="77b7" class="nh kz it nd b gy od nj l nk nl">grid(nx = 10, ny = 10)<br/>legend("topright",<br/>  lty = c(1, 1), lwd = c(2, 2),<br/>  col = c("black", "blue", rgb(0.23, 0.54, 1, 0.3)),<br/>  c("Target R", "LPSMAP", "LPSMAP 95% CI"), bty = "n", cex = 0.9<br/>)</span><span id="5294" class="nh kz it nd b gy od nj l nk nl">#--- LPSMALA vs target R<br/>plot(days, sapply(days, simepidemic$Rtrue),<br/>  type = "l", lwd = 2, ylim = c(0, 4),<br/>  ylab = "Estimated R", xlab = "Time"<br/>)<br/>polygon(<br/>  x = c(days, rev(days)), y = c(<br/>    LPSMALA_fit$epifit$R95CI_low[8:40],<br/>    rev(LPSMALA_fit$epifit$R95CI_up[8:40])<br/>  ),<br/>  col = rgb(1, 0.23, 0.31, 0.3), border = NA<br/>)<br/>lines(days, LPSMALA_fit$epifit$R_estim[8:40], type = "l", col = "red", lwd = 2)<br/>lines(days, sapply(days, simepidemic$Rtrue), type = "l", lwd = 2)</span><span id="658a" class="nh kz it nd b gy od nj l nk nl">grid(nx = 10, ny = 10)<br/>legend("topright",<br/>  lty = c(1, 1), lwd = c(2, 2),<br/>  col = c("black", "red", rgb(1, 0.23, 0.31, 0.3)),<br/>  c("Target R", "LPSMALA", "LPSMALA 95% CI"), bty = "n", cex = 0.9<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e01bcbd2d347b7322dc49ada9e92ebf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ESL5DIXxBz7P8kWb.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="6faa" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">例如，您可以通过键入以下内容来访问上周疫情的结果:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="1578" class="nh kz it nd b gy ni nj l nk nl"># Estimated R of the last week (with LPSMAP)<br/>round(tail(LPSMAP_fit$epifit[, 1:4], 7), 3)</span><span id="573e" class="nh kz it nd b gy od nj l nk nl">##    Date R_estim R95CI_low R95CI_up<br/>## 34   34   0.708     0.663    0.756<br/>## 35   35   0.724     0.676    0.775<br/>## 36   36   0.809     0.755    0.868<br/>## 37   37   0.971     0.908    1.039<br/>## 38   38   1.205     1.135    1.279<br/>## 39   39   1.461     1.384    1.541<br/>## 40   40   1.671     1.557    1.794</span><span id="526b" class="nh kz it nd b gy od nj l nk nl"># Estimated mean number of cases of the last week (with LPSMAP)<br/>round(tail(LPSMAP_fit$epifit[, 5:7], 7))</span><span id="1b34" class="nh kz it nd b gy od nj l nk nl">##    mu_estim mu95CI_low mu95CI_up<br/>## 34      284        225       357<br/>## 35      254        202       319<br/>## 36      248        196       312<br/>## 37      267        211       338<br/>## 38      319        253       404<br/>## 39      411        325       520<br/>## 40      552        394       774</span></pre><h1 id="635e" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">美国住院数据</h1><p id="664a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">为了说明真实数据上的EpiLPS，我们从<code class="fe nv nw nx nd b">COVID19</code>包中下载了美国在2021年9月1日至2022年9月1日期间的住院数据，并应用<code class="fe nv nw nx nd b">epilps()</code>例程来估计再生数。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="244a" class="nh kz it nd b gy ni nj l nk nl">install.packages("COVID19")<br/>library("COVID19")</span><span id="5a52" class="nh kz it nd b gy od nj l nk nl"># Get data and specify serial interval distribution<br/>USADat &lt;- COVID19::covid19(<br/>  country = "US", level = 1, start = "2021-09-01",<br/>  end = "2022-09-01", verbose = FALSE<br/>)</span><span id="b824" class="nh kz it nd b gy od nj l nk nl">si &lt;- c(0.344, 0.316, 0.168, 0.104, 0.068)</span><span id="4290" class="nh kz it nd b gy od nj l nk nl">inciUSA &lt;- USADat$hosp<br/>dateUSA &lt;- USADat$date</span></pre><p id="0c2b" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">我们使用带有LPSMAP(默认)方法的<code class="fe nv nw nx nd b">epilps()</code>例程，绘制平滑的流行病曲线和具有95%可信区间的估计再生数。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="a5ea" class="nh kz it nd b gy ni nj l nk nl">epifit &lt;- epilps(incidence = inciUSA, serial_interval = si, K = 20)</span><span id="e2ad" class="nh kz it nd b gy od nj l nk nl">## Inference method chosen: LPSMAP. <br/>## CI for LPSMAP computed via lognormal posterior approx. of Rt.Total number of days: 366. <br/>## Mean Rt discarding first 7 days: 0.994.<br/>## Mean 95% CI of Rt discarding first 7 days: (0.983,1.005) <br/>## Timing of routine not requested.</span><span id="24eb" class="nh kz it nd b gy od nj l nk nl">gridExtra::grid.arrange(<br/>  plot(epifit,<br/>    dates = dateUSA, datelab = "3m",<br/>    plotout = "epicurve", incibars = FALSE, themetype = "light",<br/>    epicol = "darkgreen", cicol = rgb(0.3, 0.73, 0.3, 0.2),<br/>    epititle = "USA smoothed epidemic curve", titlesize = 13<br/>  ),<br/>  plot(epifit,<br/>    dates = dateUSA, datelab = "3m",<br/>    plotout = "rt", theme = "light", rtcol = "black",<br/>    titlesize = 13, Rtitle = "USA Estimated R"<br/>  ),<br/>  nrow = 1, ncol = 2<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1b86bc3db3ad5b0bd8afa1172f153f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wW817_jFB7zFkKHU.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者的情节</p></figure><p id="f89c" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">感谢阅读。我希望你会像我一样发现本文中开发的方法很有用。如果您碰巧在自己的研究中使用它，请随时联系我和作者。</p><p id="ff77" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p><h1 id="293e" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">参考</h1><p id="5f64" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">柯里，安妮，尼尔·M·费格森，克利斯朵夫·弗雷泽和西蒙·柯西梅兹。2013."一个新的框架和软件来估计流行病期间随时间变化的繁殖数."美国流行病学杂志178(9):1505–12。</p><p id="fd37" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">Gressani，Oswaldo，Jacco Wallinga，Christian L Althaus，Niel Hens和Christel Faes。2022." EpiLPS:一种快速灵活的估计时变再生数的贝叶斯工具."<em class="nb"> PLoS计算生物学</em> 18 (10): e1010618。<a class="ae na" href="https://doi.org/10.1371/journal.pcbi.1010618" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1371/journal.pcbi.1010618</a></p><h1 id="0625" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">相关文章</h1><ul class=""><li id="96e2" class="nm nn it ls b lt lu lw lx lz op md oq mh or ml nr ns nt nu bi translated">比利时的新冠肺炎:结束了吗？</li><li id="35a2" class="nm nn it ls b lt ny lw nz lz oa md ob mh oc ml nr ns nt nu bi translated"><a class="ae na" href="https://statsandr.com/blog/a-package-to-download-free-springer-books-during-covid-19-quarantine/" rel="noopener ugc nofollow" target="_blank">新冠肺炎隔离期间免费下载斯普林格书籍的套装</a></li><li id="8de4" class="nm nn it ls b lt ny lw nz lz oa md ob mh oc ml nr ns nt nu bi translated"><a class="ae na" href="https://statsandr.com/blog/covid-19-in-belgium/" rel="noopener ugc nofollow" target="_blank">比利时的新冠肺炎</a></li><li id="e700" class="nm nn it ls b lt ny lw nz lz oa md ob mh oc ml nr ns nt nu bi translated"><a class="ae na" href="https://statsandr.com/blog/paper-semi-markov-modeling-for-cancer-insurance/" rel="noopener ugc nofollow" target="_blank">论文:“癌症保险的半马尔可夫模型”</a></li><li id="8c67" class="nm nn it ls b lt ny lw nz lz oa md ob mh oc ml nr ns nt nu bi translated"><a class="ae na" href="https://statsandr.com/blog/top-r-resources-on-covid-19-coronavirus/" rel="noopener ugc nofollow" target="_blank">新冠肺炎冠状病毒100大资源</a></li></ul></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><p id="89bd" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated"><em class="nb">原载于2022年10月19日</em><a class="ae na" href="https://statsandr.com/blog/paper-epilps-a-fast-and-flexible-bayesian-tool-for-estimation-of-the-time-varying-reproduction-number/" rel="noopener ugc nofollow" target="_blank"><em class="nb">https://statsandr.com</em></a><em class="nb">。</em></p></div></div>    
</body>
</html>