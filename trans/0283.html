<html>
<head>
<title>Markov Chains: Multi-Step Transitions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">马尔可夫链:多步转移</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/markov-chains-multi-step-transitions-6772114bcc1d#2022-02-11">https://towardsdatascience.com/markov-chains-multi-step-transitions-6772114bcc1d#2022-02-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8d46" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Chapman-Kolmogorov方程理解马尔可夫链中的多步转移</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/88573137e9c523e868be559045bccd59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yfDGXQ7t-p4yeJ-Q"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">沃洛季米尔·赫里先科在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="b515" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="a028" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我以前的文章中，我们介绍了<a class="ae ky" href="https://en.wikipedia.org/wiki/Markov_property" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">马尔可夫属性</strong> </a>的概念，并将其发展为解释一个<a class="ae ky" href="https://en.wikipedia.org/wiki/Markov_chain" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">马尔可夫链</strong> </a> <strong class="lt iu">。</strong>我建议现在的读者在阅读这篇文章之前先浏览一下那篇文章:</p><div class="mn mo gp gr mp mq"><a rel="noopener follow" target="_blank" href="/markov-chains-simply-explained-dc77836b47e3"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd iu gy z fp mv fr fs mw fu fw is bi translated">马尔可夫链简单地解释了</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">马尔可夫性和马尔可夫链的直观而简单的解释</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">towardsdatascience.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne ks mq"/></div></div></a></div><p id="3e4a" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">然而，在坚果壳中，马尔可夫性质是当转移到下一个状态<strong class="lt iu">的概率仅取决于当前状态</strong>时。系统是<a class="ae ky" href="https://en.wikipedia.org/wiki/Memorylessness" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">无记忆</strong> </a> <strong class="lt iu">。</strong>马尔可夫链是有限状态空间下马尔可夫性质下的时间离散变迁的<strong class="lt iu">序列。</strong></p><p id="d6af" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">在本文中，我们将讨论Chapman-Kolmogorov方程以及如何使用它们来计算给定马尔可夫链的多步转移概率。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="d899" class="kz la it bd lb lc nr le lf lg ns li lj jz nt ka ll kc nu kd ln kf nv kg lp lq bi translated">马尔可夫链和转移矩阵</h1><p id="860d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">考虑以下状态空间为<strong class="lt iu"> {A，B，C} </strong>的马尔可夫链:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/726ad42bd4e516d6aea740ec6c276052.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vD0UrnDmbbKDghmAXnzM5A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的图像。</p></figure><p id="563c" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">这个马尔可夫链有如下关联的<a class="ae ky" href="https://en.wikipedia.org/wiki/Stochastic_matrix" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">转移矩阵</strong> </a> <strong class="lt iu"> : </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/0e9eb16404d90703c17c03509d74f796.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*YZX83bGaFLzy9L8NChgWgw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者在LaTeX中生成的矩阵。</p></figure><p id="1d6e" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">这些值告知我们从状态<em class="ny"> i </em>(行)移动到状态<em class="ny"> j </em>(列)的<strong class="lt iu">概率。</strong>然而，这些概率仅针对<strong class="lt iu">单步过渡</strong>。比如说，分两步从<strong class="lt iu">状态</strong> <strong class="lt iu"> B到状态A的概率是多少？</strong>我们可以通过参考马尔可夫链图来解决这个问题:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/d04d3586e5fd8a1a23179bbdddb89e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*OSJLJSWCCHXSzFAG4yCLWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LaTeX中生成的方程。</p></figure><p id="a948" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">然而，当状态空间变大，我们需要计算两个以上的转换时，这种方法变得越来越困难。有一种更简单、更通用的方法来表达多步跃迁，使用T <strong class="lt iu">和Chapman-Kolmogorov方程</strong>，我们接下来将深入探讨。</p><h1 id="18cc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">查普曼-柯尔莫哥洛夫方程</h1><p id="937e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以使用以下公式概括多步转换:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/738fdc5aac524460c0fc3f378729e666.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*zcaQBSVxgPu2yN7BWqjwdw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LaTeX中生成的方程。</p></figure><p id="4e56" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">也就是我们刚刚在时间<strong class="lt iu"> <em class="ny"> m </em> </strong>处于状态<strong class="lt iu"> <em class="ny"> i </em> </strong>时，在时间<strong class="lt iu"> <em class="ny"> n </em> </strong>进入状态<strong class="lt iu"> <em class="ny"> j </em> </strong>的概率。这个方程可以用<strong class="lt iu">查普曼-科尔莫戈罗夫方程求解:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/87e2d2abc021ba27f350069fd44f2f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*b7LbIzt418_ioXZ1K-K0Bw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LaTeX中生成的方程。</p></figure><p id="0ade" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">其中<strong class="lt iu"> <em class="ny"> l </em> </strong>为介于<strong class="lt iu"> <em class="ny"> m </em> </strong>和<strong class="lt iu"> <em class="ny"> n之间的整数值，P </em> </strong>为状态间转移的概率，<strong class="lt iu"> <em class="ny"> k </em> </strong>为只能占用<strong class="lt iu">状态空间中的值的索引变量。</strong></p><p id="b96c" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">让我们通过一个例子来实现上面马尔可夫链的<strong class="lt iu"> </strong> Chapman-Kolmogorov方程。我们希望分两步<strong class="lt iu">从状态B到状态A:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/5421d58098f73d61b4b07f050ce67823.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*HxiEs3Ckz8NVO5c1Cj3RtQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LaTeX中生成的方程。</p></figure><p id="97cc" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">我们得到了<strong class="lt iu">和上面一样的概率！</strong></p><blockquote class="od oe of"><p id="a131" class="lr ls ny lt b lu nf ju lw lx ng jx lz og nh mc md oh ni mg mh oi nj mk ml mm im bi translated">我将当前时间设置为零。这是允许的，因为状态的历史与马尔可夫链无关，所以将当前时间设置为零不会失去表达式的通用性。</p></blockquote><p id="8d2a" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">直觉上，我们只是<strong class="lt iu">将</strong>两步转换分解为<strong class="lt iu">一组一步转换</strong>，因为我们知道它们的概率。然后，我们将它们结合起来计算两步跃迁概率。</p><blockquote class="od oe of"><p id="f4e8" class="lr ls ny lt b lu nf ju lw lx ng jx lz og nh mc md oh ni mg mh oi nj mk ml mm im bi translated">如果我们想分三步计算转换，那么<strong class="lt iu"> l </strong>的值可以是<strong class="lt iu"> 1或2 </strong>。因此，我们必须应用两次查普曼-科尔莫戈罗夫方程<strong class="lt iu"/>来表达一步转换公式。这个过程被称为<strong class="lt iu">递归</strong>，因为我们不断地向后计算概率。</p></blockquote><h1 id="6cb0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">多步转移矩阵</h1><p id="1c9c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">转移矩阵是一个正方形矩阵，其中每个单元给出了在一步<strong class="lt iu">中从状态<strong class="lt iu"><em class="ny"/></strong>到<strong class="lt iu"> <em class="ny"> j </em> </strong>的概率。</strong>解读上面的<strong class="lt iu"> </strong> Chapman-Kolmogorov方程，可以看到，从状态<strong class="lt iu"> <em class="ny"> i </em> </strong>到<strong class="lt iu"> <em class="ny"> j </em> </strong>中的<strong class="lt iu">两步</strong>等于转移矩阵<strong class="lt iu">的平方</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/52cb3ee60feec64941e4b760a5c68138.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*2nsv135z7-n79Uq74pmy1g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LaTeX中生成的方程。</p></figure><p id="169a" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">请注意，对于从B到A的<strong class="lt iu">条目(1，0) </strong>(我使用的是从零开始的索引)，我们得到的概率是<strong class="lt iu"> 0.25，</strong>正是我们上面得到的<strong class="lt iu">相同结果</strong>！</p><p id="28af" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nh mc md me ni mg mh mi nj mk ml mm im bi translated">因此，要得到多步转移概率，你所要做的就是<strong class="lt iu">将一步转移矩阵本身乘以你需要的转移次数！</strong></p><h1 id="3765" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="8bf1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本文中，我们展示了如何使用Chapman-Kolmogorov方程推导出<strong class="lt iu">马尔可夫链</strong>的<strong class="lt iu">多步转移概率</strong>。在我的下一篇文章中，我们将看到当<strong class="lt iu">转换的数量变大并趋于无穷大时会发生什么！</strong></p><h1 id="dea2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">和我联系！</h1><ul class=""><li id="ca40" class="ok ol it lt b lu lv lx ly ma om me on mi oo mm op oq or os bi translated">要在媒体上阅读无限的故事，请务必在这里注册！  <em class="ny"> </em>💜</li><li id="9786" class="ok ol it lt b lu ot lx ou ma ov me ow mi ox mm op oq or os bi translated"><a class="ae ky" href="/subscribe/@egorhowell" rel="noopener ugc nofollow" target="_blank">T49<em class="ny">T51】😀</em></a></li><li id="b8dc" class="ok ol it lt b lu ot lx ou ma ov me ow mi ox mm op oq or os bi translated"><a class="ae ky" href="https://www.linkedin.com/in/egor-howell-092a721b3/" rel="noopener ugc nofollow" target="_blank"> <em class="ny">领英</em> </a> <em class="ny"> </em>👔</li><li id="a7a0" class="ok ol it lt b lu ot lx ou ma ov me ow mi ox mm op oq or os bi translated"><a class="ae ky" href="https://twitter.com/EgorHowell" rel="noopener ugc nofollow" target="_blank"> <em class="ny">推特</em> </a> <em class="ny"> </em> 🖊</li><li id="fb18" class="ok ol it lt b lu ot lx ou ma ov me ow mi ox mm op oq or os bi translated"><a class="ae ky" href="https://github.com/egorhowell" rel="noopener ugc nofollow" target="_blank"><em class="ny">github</em></a><em class="ny"/>🖥</li><li id="87b0" class="ok ol it lt b lu ot lx ou ma ov me ow mi ox mm op oq or os bi translated"><a class="ae ky" href="https://www.kaggle.com/egorphysics" rel="noopener ugc nofollow" target="_blank"><em class="ny"/></a><em class="ny"/>🏅</li></ul><blockquote class="od oe of"><p id="72f1" class="lr ls ny lt b lu nf ju lw lx ng jx lz og nh mc md oh ni mg mh oi nj mk ml mm im bi translated">(所有表情符号都是由<a class="ae ky" href="https://openmoji.org/" rel="noopener ugc nofollow" target="_blank"> OpenMoji </a>设计的——开源的表情符号和图标项目。许可证:<a class="ae ky" href="https://creativecommons.org/licenses/by-sa/4.0/#" rel="noopener ugc nofollow" target="_blank"> CC BY-SA 4.0 </a></p></blockquote></div></div>    
</body>
</html>