<html>
<head>
<title>A Deep Dive into Curve Fitting for ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深入探讨ML的曲线拟合</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-deep-dive-into-curve-fitting-for-ml-7aeef64755d2#2022-05-17">https://towardsdatascience.com/a-deep-dive-into-curve-fitting-for-ml-7aeef64755d2#2022-05-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="68d1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">曲线拟合是所有机器学习的基础问题</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/4dcab335ff2d2a7ddb99cff00d182ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*anCjxBSj4tHG11Vi"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kw" href="https://unsplash.com/@osmanrana?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">奥斯曼·拉纳</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ee7e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">曲线拟合是机器学习中最具理论挑战性的部分之一，主要是因为它对最终结果有多么重要。虽然在处理具有少量要素的相对简单的数据集时，这可能不会带来挑战，但在更复杂的项目中，不恰当的拟合更有可能出现。</p><p id="9386" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">将<a class="ae kw" rel="noopener" target="_blank" href="/the-curse-of-dimensionality-50dc6e49aa1e">维度的诅咒</a>加入其中，曲线拟合从可能的直观变成不可能的不可及。然而，过度拟合(或欠拟合)会导致模型拙劣，需要投入额外的资源来重做整个过程。</p><p id="7a08" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">不幸的是，大多数在线教程除了提供常用函数的例子之外，并没有更深入的研究。关于如何思考曲线拟合的内容很少。</p><h1 id="f9dd" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">欠拟合和过拟合</h1><p id="eb25" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">首先，曲线拟合是一个优化问题。每次的目标都是找到一条<em class="mq">正确</em>匹配数据集的曲线。不恰当的做法有两种——欠拟合和过拟合。</p><p id="8bd2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">几乎每个人都更容易理解不合身。每当函数勉强捕捉到数据在散点图中分布的复杂性时，就会发生这种情况。通常情况下，这些最容易在二维空间中可视化，但曲线拟合通常必须在更多空间中完成。</p><p id="4046" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">拟合不足的问题很明显。具有这种曲线的模型会做出错误的预测，因为它试图在很大程度上简化一切。例如，它可能只从几十个数据点中捕获几个。</p><p id="158d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">过度拟合有点复杂。直觉上，你似乎想通过完美地拟合曲线来最大化模型的准确性。在现实世界中，过度拟合会导致在测试模型时出现大量错误。</p><p id="5f7a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有许多潜在的方法可以理解为什么过度拟合是一个问题。一种是认为任何数据集都是不完整的。除非您获取了所有现有的数据点，否则将会有一些未知数，这些未知数将具有一些可预测的但不完全相同的分布。一个过度拟合的模型会很好地学习这些模式，以至于它会期望它们在未来是相同的。</p><p id="8e78" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，人们可能会认为过度拟合使模型更接近决定论，而不是让它具有随机性。合适的合身程度介于合身不足和合身过度之间。</p><h1 id="eaad" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">四种情况</h1><p id="f967" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">所有的曲线拟合(至少对于机器学习来说)都可以根据手头问题的先验知识分为四类:</p><ol class=""><li id="3000" class="mr ms iq kz b la lb ld le lg mt lk mu lo mv ls mw mx my mz bi translated"><strong class="kz ir">完全知晓</strong>。不存在拟合问题，因为如果f(x)已知，则无需任何猜测即可应用。所有未来的数据都会整齐地落在曲线上。</li><li id="0404" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated"><strong class="kz ir">未知，但结构已知</strong>。在这种情况下，曲线可以是已知的，例如直线，但是没有关于其他参数的数据可用。</li><li id="f42f" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated"><strong class="kz ir">未知，但能猜到</strong>。在二维数据中，有时我们什么也没有，但由于费用相对简单，我们可以对曲线应该是什么作出合理的假设。</li><li id="b1b8" class="mr ms iq kz b la na ld nb lg nc lk nd lo ne ls mw mx my mz bi translated"><strong class="kz ir">未知</strong>。模型函数f(x)是完全未知的，没有任何猜测，参数是神秘的。</li></ol><p id="0c76" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">每一种情况都带来了越来越严峻的挑战。相对而言，你很少会遇到第一种情况，主要是在教程或其他教学材料中。我们与机器学习的大多数接触都将发生在场景二和场景三之间。</p><p id="b4f4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">场景#2和#3将有相似的基本部分。对于前者，正确地猜测参数值将定义拟合的良好程度。对于后者，每个猜测都必须带有相关的参数值，这些参数值的组合将定义良好性。</p><p id="e9be" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要记住的一件重要的事情是，每当试图猜测一个函数时，你应该应用奥卡姆剃刀(即，从两条同样拟合的曲线中，你应该选择参数最少的一条)。通常，您应该尝试以尽可能少的参数结束。任何超过这个数字的函数，但同样适合，都是过度复杂的。</p><h1 id="8785" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">评估拟合优度</h1><p id="8453" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">无论你面对哪种情况，一旦你有了某种拟合，你必须评估选择的曲线是否好。有几种方法可以用来感受这种美好。</p><p id="b425" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在可以通过二维平面上的散点图表示的简单模型中，目视检查通常就足够了。您必须使用所选编程语言中可用的任何库来绘制图形(例如，Python的<em class="mq"> Matplotlib </em>)。</p><p id="ded4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于相对简单的曲线，简单地在散点图上画出东西，并画出函数，可能会揭示足够多的优点。然而，这样的评估容易出现人为错误，也许还有点自欺欺人。</p><p id="1e9c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">残差图是一个更好的选择。事实上，这可能是拟合优度可视化的最佳选择。如果剩余图看起来不错，那么它很可能也很合适。这些图中的模式也暗示了线性(随机分布)或非线性回归(成形分布)。</p><p id="3626" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，有一些评估拟合优度的数学方法。在大多数教程中，你会发现最常用的是<em class="mq"> R的平方</em>测试。它将在大多数机器学习包和库中可用(例如，Python的<em class="mq"> sklearn.metrics </em>)，允许你做出简单的估计。</p><p id="da53" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mq"> R的平方</em>可以理解为线性模型所解释的方差。换句话说，1将意味着一个完美的匹配，随着数字的下降，优度也在下降。虽然它很受欢迎，但它仍然会把你引入歧途。</p><p id="b5cb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有些情况下，曲线拟合得很好，但数据包含大量无法解释的可变性。在其他情况下，分布可能是有偏的而不是随机的，导致<em class="mq"> R的平方</em>很高。</p><p id="0098" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mq">简化的卡方值</em>或多或少是拟合优度测量的黄金标准。虽然有点复杂，但大多数编程语言包和库都有方法或函数，可以让你插入值并完成它。</p><p id="3075" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">由<em class="mq">简化的卡方</em>产生的结果比用<em class="mq"> R的平方</em>产生的结果稍微复杂一些，因为前者可以产生任何数。接近1的结果，拟合良好。如果在1以上，还有提升空间。如果低于1，则模型可能过拟合(或者误差可能太大)。</p><h1 id="238b" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="a26c" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">所有的曲线拟合问题都是一种平衡行为，即找到一个性能相当好的函数，但既不太好也不太差。从某种意义上说，每当必须选择一条初始曲线时，几乎总会涉及一些猜测。然而，关键的一步是在以后评估它的优点。</p><p id="ad98" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">评估拟合优度可以省去以后的麻烦。对于较小和不太复杂的模型来说，视觉检查可能是值得的，但数学方法不太容易自欺欺人。</p><p id="1f1c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mq"> R的平方</em>是估计拟合优度的一个很好的尝试，主要用于数据相对不复杂的线性模型。对于其他的一切，我会使用<em class="mq">简化的卡方</em>。还有许多其他方法来评估拟合优度，然而，我概述的两种方法是最常用的。</p></div></div>    
</body>
</html>