<html>
<head>
<title>Goodbye Boring PLAXIS Output with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 告别枯燥的 PLAXIS 输出</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/goodbye-boring-plaxis-output-with-python-fc5c8b26cdb2#2022-12-03">https://towardsdatascience.com/goodbye-boring-plaxis-output-with-python-fc5c8b26cdb2#2022-12-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="233d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">PLAXIS 自动化系列</h2><div class=""/><div class=""><h2 id="226f" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">逐步走向自动化的指南</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b11007479aa6f7b7c6a5e7ddc70f54f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*71TTPkOJaZrLAD9z4EEoDw.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">米卡·鲍梅斯特在<a class="ae le" href="https://unsplash.com/s/photos/programming-number?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1468" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果您像我一样经常使用 PLAXIS，您一定会问这样一个问题:我究竟为什么需要不断重复这个复制和粘贴操作来提取结果？</p><p id="b74d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">毫无疑问，PLAXIS 是一个强大的有限元软件。作为岩土工程师，我们希望专注于分析，在后处理上花费更少的时间。由于开源社区开发的模块，Python 为自动化输出提取和可视化提供了最广泛的可能性。一些常见模块包括:</p><ul class=""><li id="a6bd" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">熊猫</li><li id="a2ee" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">Xlsxwriter</li><li id="0269" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">Matplotlib</li><li id="0221" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">海生的</li></ul><p id="0a38" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">本教程的最终目标是向您展示如何使用 Python 脚本从 PLAXIS 2D 的结构元素中提取输出。这可以通过以下四个步骤来完成。</p><ol class=""><li id="c009" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mp mh mi mj bi translated">使用 IDE 打开 PLAXIS 输出</li><li id="1d45" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mp mh mi mj bi translated">将外部模块安装到 PLAXIS 环境中</li><li id="a86f" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mp mh mi mj bi translated">从 PLAXIS 提取孔板结果</li><li id="e8dd" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mp mh mi mj bi translated">导出为 excel 电子表格</li></ol><p id="7d3b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">本教程要求读者已经安装了 VS 代码和 PLAXIS 环境。如果您不熟悉这个页面，请按照下面文章中的说明进行操作。我们开始吧！</p><div class="mq mr gp gr ms mt"><a href="https://medium.com/@philip.studio11/start-using-python-to-automate-plaxis-35a5297321e7" rel="noopener follow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ja gy z fp my fr fs mz fu fw iz bi translated">开始使用 Python 来自动化 PLAXIS</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">PLAXIS 是一个有限元建模软件，岩土工程师一定会在某个时候碰到它</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ky mt"/></div></div></a></div><h1 id="cb04" class="ni nj iq bd nk nl nm nn no np nq nr ns kf nt kg nu ki nv kj nw kl nx km ny nz bi translated">PLAXIS 示例模型</h1><p id="cad2" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">我用的是宾利官方网站发布的 PLAXIS 2D 车型，如下图所示。</p><p id="93b4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在链接中，下载来自 V22.01 的命令日志文件。据作者所知，Python 命令从 V21 到 V22 有了显著的变化。因此，请确保安装了 PLAXIS V22 或更高版本(V22.01 和 V22.02)，以确保本教程中的 Python 脚本能够正常工作。</p><div class="mq mr gp gr ms mt"><a href="https://communities.bentley.com/products/geotech-analysis/w/wiki/45557/plaxis-2d-tutorial-03-submerged-construction-of-an-excavation" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd ja gy z fp my fr fs mz fu fw iz bi translated">普拉西斯 2D 教程 03:挖掘的水下施工</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">本课说明了 PLAXIS 在分析开挖水下结构中的应用。大多数的…</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">communities.bentley.com</p></div></div><div class="nc l"><div class="of l ne nf ng nc nh ky mt"/></div></div></a></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi gj"><img src="../Images/2116788e1ed894d3af33101a8bdf205d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qyqBYinK7iF-QA65EQ35nw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图</p></figure><p id="79ec" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">使用“运行命令…”运行命令后，您应该能够看到以下几何图形。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi og"><img src="../Images/91b65be01c9b6a0f395678b7228f1045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*_6scW16PijvqmcRFblJEIw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 PLAXIS</p></figure><p id="f438" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">本例模拟了由地下连续墙(板单元)组成的开挖结构。我们的目标是提取板元素的结果。</p><p id="4406" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">计算模型，我们准备使用 Python 提取结果。</p><h1 id="e32c" class="ni nj iq bd nk nl nm nn no np nq nr ns kf nt kg nu ki nv kj nw kl nx km ny nz bi translated">步骤 1:使用 IDE 打开 PLAXIS 输出</h1><p id="f067" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">与第一个教程不同，这次我们将打开一个刚刚下载的 PLAXIS 文件，因此启动服务器的代码需要稍微修改一下。您需要将计算出的模型保存在首选的工作目录中。</p><p id="07c6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我的 PLAXIS 文件的位置:</p><p id="93c7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">c:\ Users \ phtsang \ Desktop \ Current _ Projects \ LinkedIn \ Blog _ 2 \ discovery</p><p id="9276" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我将首先创建一个名为“open_output.py”的空 python 脚本。</p><p id="b9a6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">之后，我们将下面的代码写入 python 文件。该代码与第一个教程中的代码非常相似，但这次我们将打开一个现有的 PLAXIS 文件。为此，我们进行了以下三项更改:</p><ol class=""><li id="b4fe" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mp mh mi mj bi translated">由于这次我们需要打开一个 PLAXIS 文件，因此需要指定文件的工作目录，该目录存储为“FILE_PATH”。</li><li id="77dc" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mp mh mi mj bi translated">然后，我们使用 PLAXIS 命令“s_i.open(FILE_PATH)”打开文件。</li><li id="ea24" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mp mh mi mj bi translated">为了打开 PLAXIS 输出，我们编写“g_i.view(g_i.Phases[1])”，这允许我们查看 Phase_1 的计算结果。</li></ol><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="0519" class="om nj iq oi b be on oo l op oq">from plxscrpting.easy import *<br/>import subprocess, time<br/>import os<br/><br/><br/>###############################################<br/>PLAXIS_PATH = r'C:\Program Files\Bentley\Geotechnical\PLAXIS 2D CONNECT Edition V22\\Plaxis2DXInput.exe'  # Specify PLAXIS path on server.<br/>FILE_PATH = r'C:\Users\phtsang\Desktop\Current_Projects\LinkedIn\Blog_2\\Excavation'  # Specify PLAXIS file location and name<br/>PORT_i = 10000  # Define a port number.<br/>PORT_o = 10001<br/>PASSWORD = 'SxDBR&lt;TYKRAX834~'  # Define a password.<br/><br/><br/>subprocess.Popen([PLAXIS_PATH, f'--AppServerPassword={PASSWORD}', f'--AppServerPort={PORT_i}'], shell=False)  # Start the PLAXIS remote scripting service.<br/>time.sleep(5)  # Wait for PLAXIS to boot before sending commands to the scripting service.<br/><br/><br/># Start the scripting server.<br/># global g_i, s_i<br/>s_i, g_i = new_server('localhost', PORT_i, password=PASSWORD)<br/>s_o, g_o = new_server('localhost', PORT_o, password=PASSWORD)<br/><br/><br/>s_i.open(FILE_PATH)<br/><br/><br/>g_i.gotostages()<br/>g_i.view(g_i.Phases[1])</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi or"><img src="../Images/90156d959e60b0c875dd53d729e6c131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ju66UdTK603uhfOeoElFgQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 VS 代码</p></figure><p id="cf50" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了测试上面的代码是否正常工作，我们将在终端中运行“open_output.py ”,如下所示。输入“python open_output.py ”,然后单击输入。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/2b53b94f6ec24c771f81e95cc38006f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhdHUKcHipUgZU52uSFh_w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 VS 代码</p></figure><p id="ba4e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">PLAXIS 2D 输入和输出应用程序应自动打开。从输出应用程序中，您应该看到“服务器在端口 10001 上活动”。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ot"><img src="../Images/23c37ac69e1125fc4bf740acea5b6714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qjRp-clgxWemwmyl8GsAYw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 PLAXIS</p></figure><p id="600a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们已经连接了 PLAXIS API，我们准备进入下一步。</p><h1 id="a23e" class="ni nj iq bd nk nl nm nn no np nq nr ns kf nt kg nu ki nv kj nw kl nx km ny nz bi translated">步骤 2:将外部模块安装到 PLAXIS 环境中</h1><p id="0b8e" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">当使用 PLAXIS 脚本环境时，通常使用 Python 模块来扩展 Python 脚本的功能。因为我们的目标是从 PLAXIS 提取结果并导出到 excel 电子表格，所以我们需要两个外部模块:</p><ul class=""><li id="6cb9" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">熊猫</li><li id="4d73" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">Xlsxwriter</li></ul><p id="ceb4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这些模块可以通过 PLAXIS 命令提示符窗口安装，如下所示。在继续之前，确保您已经在 PLAXIS 输入打开的情况下完成了步骤 1。</p><p id="ad77" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">进入菜单选项<em class="ou">专家&gt; Python &gt;命令提示符。</em>这将打开 Windows 命令提示符，并将 PLAXIS 设置为当前环境。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/f2981dc2cf259c092fd14f6be8fefef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8Hmbn8942VibNjdScWhlA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 PLAXIS</p></figure><p id="19a7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">将目录切换到 PLAXIS Python 分发文件夹。这可以通过以下命令完成:</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="3f78" class="om nj iq oi b be on oo l op oq">pushd C:\ProgramData\Bentley\Geotechnical\PLAXIS Python Distribution V2\python\Lib\site-packages</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ow"><img src="../Images/a6d3eb965a3bb80bfa3377ab9a3d2798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FUWGnLnBTQiqQtVWmZG2VA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 PLAXIS</p></figure><p id="67d5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在命令提示符下，您现在可以使用下面示例中显示的命令安装任何新的 Python 模块。</p><p id="bde9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">例如，如果你想安装<em class="ou">熊猫</em>模块:</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="854e" class="om nj iq oi b be on oo l op oq">python -m pip install pandas</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ox"><img src="../Images/ca4fdeeb39aa6df88b01b826bafa2367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYMWJsR4xvqxzh_ceEMvtA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 PLAXIS</p></figure><p id="9285" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">另外，安装<em class="ou"> xlsxwriter </em>模块:</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="5dc5" class="om nj iq oi b be on oo l op oq">python -m pip install xlsxwriter</span></pre><p id="9bed" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们已经安装了所有需要的模块。然后，我们可以使用 Python 脚本从 PLAXIS 中提取结果。</p><h1 id="673e" class="ni nj iq bd nk nl nm nn no np nq nr ns kf nt kg nu ki nv kj nw kl nx km ny nz bi translated">步骤 3:从 PLAXIS 中提取平板结果</h1><p id="4de7" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">我们的主要目标步骤 3 是在最后阶段(第三挖掘阶段[阶段 5])提取板单元(地下连续墙)的四种结果类型。我们将提取的结果类型有:</p><ul class=""><li id="2d2b" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">y 坐标</li><li id="9a12" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">剪(羊毛)</li><li id="2993" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">弯矩</li><li id="fc70" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">轴向力</li></ul><p id="d417" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在第 4 步中，我们将把结果导出到 excel 电子表格中，表格中的列如下所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oy"><img src="../Images/41b0d53392a480bc7d241dd39edd8b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8VdfJ502Y_g6yikRzxZMnA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 excel</p></figure><p id="a491" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我们创建一个空的 python 文件，并将其命名为“output_plate.py”。</p><h2 id="5e78" class="oz nj iq bd nk pa pb dn no pc pd dp ns lo pe pf nu ls pg ph nw lw pi pj ny iw bi translated">导入模块和战略服务器</h2><p id="839b" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">我们需要确保 API 已连接，并导入我们之前安装的模块。</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="fb8e" class="om nj iq oi b be on oo l op oq">from plxscripting.easy import *<br/>import subprocess, time<br/>import math<br/>import pandas as pd<br/>import os<br/>import xlsxwriter<br/><br/><br/>###############################################<br/>PORT_i = 10000  # Define a port number.<br/>PORT_o = 10001<br/>PASSWORD = 'SxDBR&lt;TYKRAX834~'  # Define a password.<br/><br/><br/><br/># Start the scripting server.<br/>s_i, g_i = new_server('localhost', PORT_i, password=PASSWORD)<br/>s_o, g_o = new_server('localhost', PORT_o, password=PASSWORD)</span></pre><h2 id="59ea" class="oz nj iq bd nk pa pb dn no pc pd dp ns lo pe pf nu ls pg ph nw lw pi pj ny iw bi translated">定义文件名</h2><p id="e170" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">因为我们需要将结果导出到 excel，所以我们需要指定导出文件的位置及其名称。</p><p id="1a2b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">文件位置:确保工作目录后有双斜杠(\\)</p><p id="9da8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">文件名:可以是您想要的任何名称</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="ee9f" class="om nj iq oi b be on oo l op oq">EXCEL_PATH=r'C:\Users\phtsang\Desktop\PLAXIS_V22\Script\\'<br/>EXCEL_NAME='plate_output.xlsx'<br/><br/>FILENAME=EXCEL_PATH+EXCEL_NAME</span></pre><h2 id="db1b" class="oz nj iq bd nk pa pb dn no pc pd dp ns lo pe pf nu ls pg ph nw lw pi pj ny iw bi translated">输入定义</h2><p id="a590" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">之后，我们将输入我们想要提取的结构元素和相应的相位。在这种情况下:“板块 _1”和“第三挖掘阶段[阶段 _5]”。</p><p id="9e2f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面的代码是查找模型中现有的板元素和阶段，并将它们存储为列表。</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="ffed" class="om nj iq oi b be on oo l op oq">plate_input=['Plate_1'] # Input by user<br/>phase_input=['Third excavation stage [Phase_5]'] # Input by user<br/><br/>###############################################<br/>#Exisiting model element:<br/><br/>plate=[plt for plt in g_o.Plates[:]] # Loop through the plate object in existing model<br/>phase=[p for p in g_o.Phases[:]] # Loop through all available phases</span></pre><p id="86ff" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这里有两个重要的概念:</p><p id="ea83" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> For 循环</strong>:查找 PLAXIS 中现有元素的动作需要 For 循环。这是编程中非常常见的命令。例如在“板块”中，我们有:</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="a80c" class="om nj iq oi b be on oo l op oq">for plt in g_o.Plates[:]</span></pre><p id="2fd1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这一行意味着我们正在遍历“g_o.Plates[:]”中的所有 plate 元素(这是 PLAXIS 存储对象的方式)，并将其命名为“plt”。</p><p id="062f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">列表</strong>:正如在第一个教程中提到的，在一个用方括号[ ]表示的列表中存储值是很常见的。与第一个教程相比，语法略有变化，因为它被简化了。</p><p id="f882" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这一行:</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="4862" class="om nj iq oi b be on oo l op oq">plate=[plt for plt in g_o.Plates[:]]</span></pre><p id="439a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">可以扩展为:</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="90ea" class="om nj iq oi b be on oo l op oq">plate=[]<br/><br/>for plt in g_o.Plates[:]<br/><br/>   plate.append(plt) </span></pre><p id="a70d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">两个代码会给出相同的结果，但是第一个代码更简洁，这是 Python 中常用的。</p><p id="3da4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">到目前为止，您的脚本应该是这样的:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pk"><img src="../Images/4b40d5f9624ba4ca49b6d3b6fdb00ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aiy3O-EkVY-3i0JvC3Y4rw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 VS 代码</p></figure><h1 id="e1e0" class="ni nj iq bd nk nl nm nn no np nq nr ns kf nt kg nu ki nv kj nw kl nx km ny nz bi translated">结果提取</h1><p id="acf8" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">经过上述预处理后，我们可以开始提取车牌结果。为此，我们将定义一个函数来提取结果，调用的是“get_plate()”。这里有几个要点:</p><p id="fc4b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">y 坐标=结果类型。盘子。Y</p><p id="8623" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">剪切=结果类型。板材. Q2D</p><p id="9b29" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">弯矩=结果类型。Plate.M2D</p><p id="b0e5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">轴向力=结果类型。Plate.Nx2D</p><ul class=""><li id="01b9" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">接下来的几行将创建目标电子表格中指定的列名。</li><li id="5605" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">然后结果被存储为“结果”。这里我介绍一种新的数据类型，在 Python 中称为<strong class="lh ja">字典</strong>，用花括号{ }表示。当您想要创建一个表时，Dictionary 特别有用，它包含一个键-值对。例如:</li></ul><p id="e86c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">“y”是字典的<strong class="lh ja">键</strong></p><p id="92fb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">plateY 是字典的<strong class="lh ja">值</strong>。值的数组可以存储到指定的键中。</p><ul class=""><li id="75e4" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">一旦创建了字典，下一行将把字典转换成数据帧。Dataframe 是我们在 Python 中最常用的数据结构之一。可以解释为 excel 中的表格。这是通过运行命令:" pd。数据框架(结果)”</li><li id="9451" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">我还使用 Y 坐标以降序对结果进行排序</li></ul><p id="09c2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">确保缩进是正确的，如下图所示。</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="3e91" class="om nj iq oi b be on oo l op oq">def get_plate(plate_o,phase_o):<br/><br/>    plateY=g_o.getresults(plate_o,phase_o,g_o.ResultTypes.Plate.Y, "node")<br/>    plateQ=g_o.getresults(plate_o,phase_o,g_o.ResultTypes.Plate.Q2D, "node")<br/>    plateM=g_o.getresults(plate_o,phase_o,g_o.ResultTypes.Plate.M2D, "node")<br/>    plateAxial=g_o.getresults(plate_o,phase_o,g_o.ResultTypes.Plate.Nx2D, "node")    <br/><br/>    phasename=str(phase_o.Identification).split('[')[0]<br/>    col1='Shear [kN]'+'_'+phasename<br/>    col2='Bending Moment [kNm/m]'+'_'+phasename<br/>    col3='Axial Force [kN]'+'_'+phasename<br/><br/>    results = {'Y': plateY, col1: plateQ,col2: plateM,col3: plateAxial}<br/><br/><br/>    plateresults=pd.DataFrame(results)<br/>    plateresults = plateresults.sort_values(by=['Y'],ascending=False)<br/><br/><br/>    return plateresults</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/e5521e903039b702ba6916a1795ce8de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SP3WDl1fiROLec94b4ylRg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 VS 代码</p></figure><h1 id="4a14" class="ni nj iq bd nk nl nm nn no np nq nr ns kf nt kg nu ki nv kj nw kl nx km ny nz bi translated">步骤 4:导出为 Excel 电子表格</h1><p id="6b2c" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">最后，我们将把创建的数据框架导出到 excel。</p><p id="77c8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们创建一个函数，叫它“export_excel()”。</p><ul class=""><li id="12e8" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">writer 是使用我们安装的 xlsxwriter 模块导出 excel</li><li id="b496" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">名称&amp; sheet_name 是我创建格式为“Plate_1_Phase 5”的工作表名称的位置。</li><li id="d584" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">然后，我使用我们在前面创建的函数“get_plate()”来生成数据帧并存储为“结果”。它应该是一个数据帧，然后可以使用 pandas 命令“results.to_excel()”导出到 excel。</li></ul><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="94ac" class="om nj iq oi b be on oo l op oq">def export_excel(plate_input,phase_input,filename):<br/>    writer = pd.ExcelWriter(filename, engine='xlsxwriter')<br/><br/><br/>    name=str(phase[5].Identification).split(' [')[1]<br/>    name=name.split(']')[0]<br/>    sheet_name = "%s_%s" % (plate[0].Name, name)<br/>    results = get_plate(plate[0], phase[5])<br/>    results.to_excel(writer,sheet_name=sheet_name,index=False)<br/>    writer.save()<br/><br/><br/>export_excel(plate_input,phase_input,FILENAME)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/5eaf04e2d4e6bfa5cc5656d9b39df1b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hxjZWLrFUpFDn0Hp3d58ag.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 VS 代码</p></figure><p id="088d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">使用以下命令运行脚本。</p><pre class="kp kq kr ks gt oh oi oj bn ok ol bi"><span id="4c75" class="om nj iq oi b be on oo l op oq">(PLAXIS) C:\Users\phtsang\Desktop\PLAXIS_V22\Script&gt;python output_plate.py</span></pre><p id="6147" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您将看到我们寻找的结果已经自动提取出来，如命令窗口所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/14311e2bb3306629cd2abb3d2c164c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RTDsWbfWPnCN-namPDa7vQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 PLAXIS</p></figure><p id="9aec" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，如果您在之前指定的位置打开 excel 电子表格，您可以看到我们已经提取了所需的 Y 坐标、剪力、弯矩和轴向力。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi po"><img src="../Images/0a88ab3fcb4ffee8c82ab13c139ad143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRRo73srRZR65TVkC4pt_A.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者截图自 excel</p></figure><p id="d3e4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">干得好！您刚刚使用 Python 脚本从 PLAXIS 中提取了结果。</p><h1 id="19b1" class="ni nj iq bd nk nl nm nn no np nq nr ns kf nt kg nu ki nv kj nw kl nx km ny nz bi translated">结论</h1><p id="8b3d" class="pw-post-body-paragraph lf lg iq lh b li oa ka lk ll ob kd ln lo oc lq lr ls od lu lv lw oe ly lz ma ij bi translated">这就是关于使用 Python 提取 PLAXIS 输出的第二个教程的全部内容。现在，您应该能够从 PLAXIS 中提取单个结构元素的输出。在以后的教程中，我将展示如何提取多个结构元素和不同结构类型(如界面和嵌入梁)的结果。</p><p id="6201" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果你喜欢阅读这类内容，请随时关注我的页面。我将继续发布这一系列关于用 Python 自动化 PLAXIS 的教程。除此之外，我还热衷于分享关于如何使用 Python 来自动化工程中的工作流的知识。</p></div></div>    
</body>
</html>