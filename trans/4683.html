<html>
<head>
<title>Step Up Your Game in Making Beautiful Choropleth Maps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在制作美丽的Choropleth地图中加强你的游戏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/step-up-your-game-in-making-beautiful-choropleth-maps-ab7d3428b3ab#2022-10-18">https://towardsdatascience.com/step-up-your-game-in-making-beautiful-choropleth-maps-ab7d3428b3ab#2022-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c579" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Python制作不同类型地图的指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e18d9a285ebe6d1b1fef47096c79f865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VwAwCB-IPVhNjWqNVyH4eg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">JOSHUA COLEMAN 在<a class="ae ky" href="https://unsplash.com/s/photos/maps-color?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a6ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> C </span> horopleth地图是混合空间数据和统计数据的结果。一个简单的例子是显示全球新冠肺炎病例数量的地图。我们广泛使用choropleth地图来传递属于社会经济数据、气候变量等的信息。典型的情况是，2D的choropleth图带有1D色带(可以是离散的或连续的)。还有一些鲜为人知的弦线图，如<a class="ae ky" href="https://sites-formations.univ-rennes2.fr/mastersigat/MaplibreGL/maps/Choropleth3DMap.html" rel="noopener ugc nofollow" target="_blank"> 3D </a>弦线图和<a class="ae ky" href="https://www.joshuastevens.net/cartography/make-a-bivariate-choropleth-map/" rel="noopener ugc nofollow" target="_blank">二元</a>弦线图(带有2D色带)。在本文中，我将重点介绍最常见的类型，即带有1D色条的2D地图。</p><h1 id="cc8c" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">必需品</h1><p id="3c35" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">首先，让我们通过一些必要的事情，然后再进入策划。正如你可能已经猜到的，有许多方法可以制作choropleth地图。这是我们需要的一些东西—</p><ol class=""><li id="0c62" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated">Python库的选择——我们有用于地理空间可视化的库，如Plotly、Geopandas、Folium等。Plotly对初学者友好，但我推荐geopandas，因为它对输出可视化有更好的控制。</li><li id="67dc" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">统计数据——我们感兴趣的绘制变量，如温度。</li><li id="9b4a" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">Shapefiles这些文件保存不同地区的几何数据，如城市、州、国家等。</li><li id="c6d3" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">地图投影的选择。</li></ol><p id="2731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将展示一些不同分辨率的choropleth地图示例——全球、州/地区和城市级别。</p><h1 id="b5ae" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">全球一级</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/2992df8e98e8cda1e78a31d8fa54f49f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MZPzo8QCfDRvkRMr-FpfEg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">2021年世界人口分布图(图片由作者提供)</p></figure><p id="1422" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于上面的choropleth地图，我使用了<a class="ae ky" href="https://plotly.github.io/plotly.py-docs/generated/plotly.express.choropleth.html" rel="noopener ugc nofollow" target="_blank"> Plotly Express </a>，这是一种生成地图的简单方法。这里的统计变量是<a class="ae ky" href="https://data.worldbank.org/indicator/SP.POP.TOTL?end=2021&amp;start=2021" rel="noopener ugc nofollow" target="_blank">世界人口</a>，对于shapefile，我使用了<a class="ae ky" href="https://public.opendatasoft.com/explore/dataset/world-administrative-boundaries/export/" rel="noopener ugc nofollow" target="_blank">世界行政边界</a>数据集。下面是复制地图的代码—</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b4de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我喜欢在绘图之前合并数据集和shapefile，因为这很方便。正如您所看到的，代码非常短，很容易理解。如果我们想将地图的分辨率更改为区域级别，我们对代码所做的主要更改是在<code class="fe ns nt nu nv b">scope</code>参数处。</p><p id="8fee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用Geopandas库来检查区域级别的地图。</p><h1 id="1efa" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">区域一级</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/15ae0a8d296168c9fa186a67dd89d87d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FtW_5IknIR5hP8QLVQ6vVg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国各州农产品出口的Choropleth地图(图片由作者提供)</p></figure><p id="1e9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的choropleth地图是使用Geopandas库制作的。它显示了美国各州不同的农产品出口。你可以在这里下载我们的形状文件。代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="8a22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个代码有点重，尽管它很容易理解，因为它使用Matplotlib引擎来绘图。如前所述，我在绘图前合并了数据集和shapefile。我使用了不同的技术来控制彩条的大小、标签和位置。Plotly也是如此；因为我更习惯于使用Matplotlib，所以我更喜欢这样。</p><h2 id="d9e3" class="nx mf it bd mg ny nz dn mk oa ob dp mo li oc od mq lm oe of ms lq og oh mu oi bi translated">县级</h2><p id="5fd8" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">让我们看看另一个美国县级的地区级choropleth地图。我们遵循与上面相同的过程，但包括美国县形状文件。下面是choropleth地图，显示了美国不同县的失业率。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/b2ba6577055e1e2dc96ee81eb0abcf84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LH1YIfbizTW6YaNokOU0tQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国各县显示失业率的Choropleth地图(图片由作者提供)</p></figure><p id="558b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="9c78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码略有不同，因为我在这里包括了县和州的shapefiles。我用灰色表示县的边界线，用黑色表示州的边界线，以显示不同州和县之间清晰的分界线。</p><h1 id="44ff" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">城市层面</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/96b9c86b069c2f954ec546cef0e0cb70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KFvG4S6Fct2vG4IN1pOw1A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">巴黎Choropleth地图(图片由作者提供)</p></figure><p id="b677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，显示了巴黎市及其不同的行政区。这些颜色代表每个区的周长。我添加了一个背景图，为可视化添加更多的细节和背景。该图的代码如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b0b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该代码与前面的代码相似，稍微增加了一点，就是使用<code class="fe ns nt nu nv b">contextily</code>库制作的背景图。你可以为地图选择不同的地形风格(点击<a class="ae ky" href="https://contextily.readthedocs.io/en/latest/intro_guide.html" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><h1 id="4578" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="df5e" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">有不同的方法生成choropleth图。我在本文中展示了一些简单的方法。使用geopandas和plotly进行绘图很简单。我可能对geopandas有偏见，因为我花了更多的时间使用它，但我根据情况使用两个库。</p><h2 id="f53f" class="nx mf it bd mg ny nz dn mk oa ob dp mo li oc od mq lm oe of ms lq og oh mu oi bi translated">注意:</h2><p id="54d7" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">本文中使用的所有数据集都有免费使用许可。以下链接:</p><ol class=""><li id="7e1c" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated">世界银行数据(知识共享署名4.0 <a class="ae ky" href="https://datacatalog.worldbank.org/public-licenses#cc-by" rel="noopener ugc nofollow" target="_blank">许可</a></li><li id="9b03" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">Shapefile数据(<a class="ae ky" href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="noopener ugc nofollow" target="_blank">开放政府许可v3.0 </a>)</li><li id="5317" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">Plotly数据集(麻省理工学院<a class="ae ky" href="https://github.com/plotly/datasets/blob/master/LICENSE" rel="noopener ugc nofollow" target="_blank">许可</a></li></ol></div><div class="ab cl ol om hx on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="im in io ip iq"><p id="6e9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，干杯！</p><pre class="kj kk kl km gt os nv ot ou aw ov bi"><span id="e6c6" class="nx mf it nv b gy ow ox l oy oz"><strong class="nv iu">Want to Connect?</strong></span><span id="674e" class="nx mf it nv b gy pa ox l oy oz">Reach me at <a class="ae ky" href="https://www.linkedin.com/in/rohithteja/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>, <a class="ae ky" href="https://twitter.com/rohithtejam" rel="noopener ugc nofollow" target="_blank">Twitter</a>, <a class="ae ky" href="https://github.com/rohithteja" rel="noopener ugc nofollow" target="_blank">GitHub</a> or <a class="ae ky" href="https://rohithteja.github.io/" rel="noopener ugc nofollow" target="_blank">Website</a>!</span></pre></div></div>    
</body>
</html>