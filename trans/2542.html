<html>
<head>
<title>Improving the Named Entity Recognition (NER) model with patent texts | SpaCy, Prodigy and a bit of magic 🪄</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用专利文本改进命名实体识别(NER)模型| SpaCy、Prodigy和一点神奇的🪄</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/improving-the-ner-model-with-patent-texts-spacy-prodigy-and-a-bit-of-magic-44c86282ea99#2022-06-02">https://towardsdatascience.com/improving-the-ner-model-with-patent-texts-spacy-prodigy-and-a-bit-of-magic-44c86282ea99#2022-06-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jo jp jq"><p id="6fb7" class="jr js jt ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ij bi translated"><strong class="ju ir">命名实体识别</strong>(<strong class="ju ir">NER</strong>)——是<a class="ae kq" href="https://en.wikipedia.org/wiki/Information_extraction" rel="noopener ugc nofollow" target="_blank">信息提取</a>的一个子任务，寻求定位 <a class="ae kq" href="https://en.wikipedia.org/wiki/Named_entity" rel="noopener ugc nofollow" target="_blank"> <strong class="ju ir">命名实体</strong> </a> <strong class="ju ir"> …并将其<strong class="ju ir">分类到预定义的类别</strong>中，如人名、组织、地点、<a class="ae kq" href="https://en.wikipedia.org/wiki/Medical_classification" rel="noopener ugc nofollow" target="_blank">医疗代码</a>、时间表达式、数量、货币值、百分比等。</strong></p><p id="847c" class="jr js jt ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ij bi translated">… NER也简称为实体识别、实体分块和实体提取。</p></blockquote><p id="1915" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">简而言之，我们识别文本中有意义的实体，并根据类别对它们进行分类。</p><h2 id="dd04" class="ku kv iq bd kw kx ky dn kz la lb dp lc kr ld le lf ks lg lh li kt lj lk ll lm bi translated">为什么有用？</h2><p id="bdd8" class="pw-post-body-paragraph jr js iq ju b jv ln jx jy jz lo kb kc kr lp kf kg ks lq kj kk kt lr kn ko kp ij bi translated">它在许多方面都有帮助:</p><ul class=""><li id="9379" class="ls lt iq ju b jv jw jz ka kr lu ks lv kt lw kp lx ly lz ma bi translated"><strong class="ju ir"> HR </strong>(通过汇总简历加快招聘过程)</li><li id="047f" class="ls lt iq ju b jv mb jz mc kr md ks me kt mf kp lx ly lz ma bi translated"><strong class="ju ir">医疗保健</strong>(从实验室报告中提取重要信息)</li><li id="0c7a" class="ls lt iq ju b jv mb jz mc kr md ks me kt mf kp lx ly lz ma bi translated"><strong class="ju ir">推荐引擎【Booking.com】查看这个故事！)</strong></li></ul><h2 id="abf5" class="ku kv iq bd kw kx ky dn kz la lb dp lc kr ld le lf ks lg lh li kt lj lk ll lm bi translated">如何改进？</h2><p id="6791" class="pw-post-body-paragraph jr js iq ju b jv ln jx jy jz lo kb kc kr lp kf kg ks lq kj kk kt lr kn ko kp ij bi translated">拥有最受欢迎的实体类别的数据集已经存在，比如组织或品牌。但是定制数据集呢？通常，人们手动注释数据集，这可能是昂贵的，时间长，并且质量仍然取决于初始数据。</p><p id="9f2e" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">在这篇文章中，我提出了另一种方法。我使用已经分类的文本，其中充满了相关术语，来训练特定领域的NER管道。</p><h1 id="eba3" class="mg kv iq bd kw mh mi mj kz mk ml mm lc mn mo mp lf mq mr ms li mt mu mv ll mw bi translated">专利数据集</h1><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi mx"><img src="../Images/3969918b2ffd0853722e8c4ddf6db641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OM_YmCEDO9hLw3-V"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">由<a class="ae kq" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·温克勒</a>在<a class="ae kq" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="4089" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">专利，准确地说是专利的文本，是提供专利发明高度具体信息的文件。换句话说，它根据其<strong class="ju ir">领域中的功能来描述发明。这意味着专利将包含特定于该领域的术语，文本的简洁有助于数据检索的方便。</strong></p><p id="92cf" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">例如，其中一个来源是谷歌专利，它提供对国际专利分类数据库的访问:</p><div class="nn no gp gr np nq"><a href="https://www.google.com/patents/sitemap/en/Sitemap.html" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">专利网站地图</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">按国际专利分类的专利(61，837，450)</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">www.google.com</p></div></div></div></a></div><p id="7364" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">但更重要的是<strong class="ju ir">版权免费。根据</strong> <a class="ae kq" href="http://www.uspto.gov/news/media/ccpubguide.jsp" rel="noopener ugc nofollow" target="_blank"> <strong class="ju ir"> USPTO </strong> </a></p><blockquote class="jo jp jq"><p id="913e" class="jr js jt ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ij bi translated">除了37 CFR 1.71(d) &amp; (e)和1.84(s)中反映的有限例外情况外，<strong class="ju ir">专利的文本和图纸通常不受版权限制</strong>。</p></blockquote><p id="1846" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">这意味着我们可以自由地使用这些文本来训练我们的模型，而不用担心版权问题，这对构建商业系统至关重要。</p><p id="3eb1" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">对于实验，我选择了专利的<strong class="ju ir">【G06K】</strong><em class="jt">(数据识别/数据呈现)</em> <strong class="ju ir"> <em class="jt"> </em> </strong>小节，而<strong class="ju ir">G06</strong>——是<em class="jt">计算/计算</em>小节。这样的文本应该有助于训练对特定于数据分析领域的技术实体的识别，例如计算机视觉、信号处理等。</p><div class="nn no gp gr np nq"><a href="https://www.google.com/patents/sitemap/en/Sitemap/G06/G06K.html" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">G06K -数据的识别；数据的呈现；记录载体；处理记录载体…</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">更多主题在“G06K -数据的识别；数据的呈现；记录载体；处理记录载体”…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">www.google.com</p></div></div></div></a></div><h1 id="77c9" class="mg kv iq bd kw mh mi mj kz mk ml mm lc mn mo mp lf mq mr ms li mt mu mv ll mw bi translated">提取术语</h1><p id="ce6f" class="pw-post-body-paragraph jr js iq ju b jv ln jx jy jz lo kb kc kr lp kf kg ks lq kj kk kt lr kn ko kp ij bi translated">由于专利文本是特定于其领域的，我们需要从中提取每个频繁命名的实体。为此，我们可以使用，例如，<a class="ae kq" href="https://www.cs.upc.edu/~nlp/wikicorpus/" rel="noopener ugc nofollow" target="_blank"> Wikicorpus </a>。在项目的存储库中，您会发现已经策划好的名为<code class="fe nz oa ob oc b">manyterms.lower.txt</code>的列表。</p><p id="5b09" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">要从文本中提取相关术语，我们可以使用<a class="ae kq" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html" rel="noopener ugc nofollow" target="_blank"> scikit中的<code class="fe nz oa ob oc b">CountVectorizer</code>-learn</a>。通过这种方式，我们可以去除比某个阈值频率低的术语，并分别留下具有更多提及和更多句子的术语来训练。</p><figure class="my mz na nb gt nc"><div class="bz fp l di"><div class="od oe l"/></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">利用计数向量机从专利文本中抽取实体</p></figure><h1 id="53c9" class="mg kv iq bd kw mh mi mj kz mk ml mm lc mn mo mp lf mq mr ms li mt mu mv ll mw bi translated">模特培训</h1><p id="2c7f" class="pw-post-body-paragraph jr js iq ju b jv ln jx jy jz lo kb kc kr lp kf kg ks lq kj kk kt lr kn ko kp ij bi translated">提取潜在术语后，我们可以开始训练模型。这里我使用了SpaCy库,因为准备NER管道很简单，而且有全面的文档。但在此之前，我们需要以适当的格式制作数据集。</p><p id="3e5b" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">这里我使用库的<code class="fe nz oa ob oc b">PhraseMatcher</code>类从预定义的维基列表中查找实体。</p><figure class="my mz na nb gt nc"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="acd3" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">然后，用自定义标签<strong class="ju ir"><em class="jt">TECH</em></strong><em class="jt"/>和<em class="jt"> </em>标注每个实体，并以SpacCy格式保存。</p><figure class="my mz na nb gt nc"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="200f" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">当训练和评估时。布景准备好了，我们可以开始训练模特了。由于SpaCy是为生产量身定制的，所以配置非常广泛。然而，对于一个简单的例子，基本的就足够了。为此，只需进入<a class="ae kq" href="https://spacy.io/usage/training#quickstart" rel="noopener ugc nofollow" target="_blank">网站</a>，选择型号并下载<code class="fe nz oa ob oc b">base-config.cfg</code>。</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi of"><img src="../Images/a19d5d59c397da0d9504ffa52a8dbf91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ckJp_LmSbAH7DAyRUc0RFg.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">我们使用的配置选项|截图来自<a class="ae kq" href="https://spacy.io/usage/training#quickstart" rel="noopener ugc nofollow" target="_blank"> spacy.io </a></p></figure><p id="b0fd" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">之后，使用以下命令初始化完整配置:</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi og"><img src="../Images/227a26915cd423658e9d4ddfe7028696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dvb5ypg8ba9d9svzDPP9zw.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">配置初始化命令</p></figure><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oh"><img src="../Images/dabb454ec583bfe871ac48eb203e18c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJP1Ra6_7x0AgoxjoKGQ-g.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">作者图片|配置初始化后的输出</p></figure><p id="1be0" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">在这个命令之后，spacy填充所有其他配置参数，并为训练做准备。现在我们可以运行一个命令来训练:</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oi"><img src="../Images/0638ae513f5658b2a1954aac328ac679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rbf16M3103EWOEoHwpFh_Q.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">带参数的训练命令</p></figure><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi oj"><img src="../Images/c1defaca5e3b455786d3a2622e39ecf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MxwrR9h8L3QBpyyntsERTA.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图片作者|培训期间输出</p></figure><p id="b825" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">瞧，我们的NER模特训练好了！现在我们可以看到结果了。</p><blockquote class="jo jp jq"><p id="ed26" class="jr js jt ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ij bi translated"><strong class="ju ir">重要注意事项！</strong>经过训练的NER模型将不仅从预先标记的训练数据中学习标记实体<strong class="ju ir">。</strong>它将学习根据给定的上下文查找和识别实体。</p></blockquote><p id="042c" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">只需加载<code class="fe nz oa ob oc b">model-best</code>并运行所需的文本输入来运行测试。SpaCy提供了一个很好的可视化NER标签，在Jupyter笔记本内支持。</p><figure class="my mz na nb gt nc"><div class="bz fp l di"><div class="od oe l"/></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">对文本样本运行模型推理的代码</p></figure><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ok"><img src="../Images/8d38beaefa29940c75f90ffec9aaa5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1x4p81L1gInXClax0p_GNQ.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图片由作者|以上代码输出</p></figure><h1 id="f78a" class="mg kv iq bd kw mh mi mj kz mk ml mm lc mn mo mp lf mq mr ms li mt mu mv ll mw bi translated">额外收获:主动学习，天赋异禀</h1><blockquote class="jo jp jq"><p id="d49b" class="jr js jt ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ij bi translated">⚠️ <a class="ae kq" href="https://prodi.gy/docs" rel="noopener ugc nofollow" target="_blank"> Prodigy </a>是业内广泛使用的付费脚本注释工具，由SpaCy团队开发并集成到他们的NLP库中。这不是创建NER模型的关键部分，但对一些人来说还是有帮助的。⚠️</p></blockquote><p id="2faf" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">完美是无止境的，因此我们可以用Prodigy进一步改进我们的NER模型。<strong class="ju ir"> </strong>它的<strong class="ju ir"> </strong>很酷的一个特点就是主动学习。简而言之，这意味着我们可以根据手动标记的数据来调整模型。然而，由于我们的模型已经训练好了，我们只需要一堆带注释的例子，而不是整个数据集。</p><p id="3f27" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">如何选择例子？这就是为什么神童是有用的。<strong class="ju ir">自动给出模型置信度最低的测试集中的例子。</strong></p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ol"><img src="../Images/82f206fd46671f125a51fca4a2d2de9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QxFlb3Fo8lAhQjqGqH-LkA.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图片由作者提供|使用Prodigy运行主动学习的命令</p></figure><p id="e954" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">该命令将打开注释窗口。在这里，我们可以检查标签并修复它们。</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi om"><img src="../Images/2cdc7bae949e95952d515f1b1f8c4c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nnLkkXbXnsdEobuhRju0A.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">图片作者| Prodigy注释窗口</p></figure><p id="6c24" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">这些注释会自动保存到prodigy数据集。在完成对几个例子的注释之后，我们现在可以对模型进行微调了。由于与SpaCy的集成，我们可以直接从prodigy运行我们的模型的训练。</p><figure class="my mz na nb gt nc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi on"><img src="../Images/1bf41d9f31c14f55d802f766b263d411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VR5oPAcKcfDN7bxZJfoP2w.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">使用prodigy注释数据运行模型调整的命令</p></figure><h1 id="9d5e" class="mg kv iq bd kw mh mi mj kz mk ml mm lc mn mo mp lf mq mr ms li mt mu mv ll mw bi translated">结果</h1><p id="b446" class="pw-post-body-paragraph jr js iq ju b jv ln jx jy jz lo kb kc kr lp kf kg ks lq kj kk kt lr kn ko kp ij bi translated">就是这样！我们训练了NER模型，它现在可以识别和标记特定领域的实体。利用专利数据集可以快速准备数据，而无需人工管理。</p><p id="ae22" class="pw-post-body-paragraph jr js iq ju b jv jw jx jy jz ka kb kc kr ke kf kg ks ki kj kk kt km kn ko kp ij bi translated">完整的代码和解析的数据可以在这里找到:</p><div class="nn no gp gr np nq"><a href="https://github.com/kinivi/patent_ner_linking" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd ir gy z fp nv fr fs nw fu fw ip bi translated">GitHub-kini VI/patent _ ner _ linking:📰命名实体识别(NER)和实体链接(EL)</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">📰专利数据库上的命名实体识别(NER)和实体链接(EL)</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot nh nq"/></div></div></a></div><h2 id="b1ad" class="ku kv iq bd kw kx ky dn kz la lb dp lc kr ld le lf ks lg lh li kt lj lk ll lm bi translated">附言</h2><p id="5d02" class="pw-post-body-paragraph jr js iq ju b jv ln jx jy jz lo kb kc kr lp kf kg ks lq kj kk kt lr kn ko kp ij bi translated">NER是创建实体链接的关键步骤，它允许在被认可的实体之间创建层级和连接。在这种情况下，模型验证同样复杂。<em class="jt">但这将在我的下一篇文章中描述</em>😉</p></div></div>    
</body>
</html>