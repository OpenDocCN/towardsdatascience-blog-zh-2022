<html>
<head>
<title>Bird Species Classification with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习的鸟类分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bird-species-classification-with-machine-learning-914cbc0590b#2022-05-27">https://towardsdatascience.com/bird-species-classification-with-machine-learning-914cbc0590b#2022-05-27</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><h2 id="0e8f" class="ip iq ir bd b dl is it iu iv iw ix dk iy translated" aria-label="kicker paragraph">数据科学</h2><div class=""/><div class=""><h2 id="2a5f" class="pw-subtitle-paragraph jx ja ir bd b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dk translated">根据基因和位置预测鸟的种类</h2></div><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj kp"><img src="../Images/99b33172e238413a7a5b732150755f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KSpjMuNzB8H4jnFt"/></div></div><p class="lb lc gk gi gj ld le bd b be z dk translated">照片由<a class="ae lf" href="https://unsplash.com/@cifilter?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">香农·波特</a>在<a class="ae lf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="6dd3" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">像鸟一样？比如数据科学？</p><p id="a143" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">你会喜欢这个挑战的！</p><h2 id="c147" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">问题陈述</h2><blockquote class="mu mv mw"><p id="7467" class="lg lh mx li b lj lk kb ll lm ln ke lo my lq lr ls mz lu lv lw na ly lz ma mb ik bi translated">科学家们已经确定，一种已知的鸟类应该分为3个不同的独立物种。这些物种是该国特定地区特有的，必须尽可能精确地跟踪和估计它们的数量。</p><p id="5b0c" class="lg lh mx li b lj lk kb ll lm ln ke lo my lq lr ls mz lu lv lw na ly lz ma mb ik bi translated">因此，一个非盈利的保护协会承担了这项任务。他们需要能够根据野外工作人员在野外观察到的特征，记录他们遇到了哪些物种。</p><p id="434d" class="lg lh mx li b lj lk kb ll lm ln ke lo my lq lr ls mz lu lv lw na ly lz ma mb ik bi translated">使用某些遗传特征和位置数据，你能预测已经观察到的鸟的种类吗？</p><p id="4b10" class="lg lh mx li b lj lk kb ll lm ln ke lo my lq lr ls mz lu lv lw na ly lz ma mb ik bi translated">这是一个初级水平的练习比赛，你的目标是根据属性或位置预测鸟类的种类。"</p><p id="d8d6" class="lg lh mx li b lj lk kb ll lm ln ke lo my lq lr ls mz lu lv lw na ly lz ma mb ik bi translated"><a class="ae lf" href="https://bitgrit.net/competition/16" rel="noopener ugc nofollow" target="_blank">来源</a></p></blockquote><p id="ec83" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">你现在有了一个明确的目标。</p><h2 id="4c14" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">目标🥅</h2><p id="1e0a" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">根据属性或位置预测鸟的种类(A、B或C)</p><p id="79c4" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">现在让我们来看看数据</p><h2 id="8cef" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">数据<a class="ae lf" href="https://emojipedia.org/floppy-disk/" rel="noopener ugc nofollow" target="_blank">💾</a></h2><p id="c39c" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">通过<a class="ae lf" href="https://bitgrit.net/register" rel="noopener ugc nofollow" target="_blank">注册</a>获得本次<a class="ae lf" href="https://bitgrit.net/competition/16" rel="noopener ugc nofollow" target="_blank">数据科学竞赛</a>的数据。</p><pre class="kq kr ks kt gu ng nh ni nj aw nk bi"><span id="e462" class="mc md ir nh b gz nl nm l nn no">📂 <strong class="nh jb">train</strong><br/>├── training_target.csv<br/>├── training_set.csv<br/>└── solution_format.csv</span><span id="f1bd" class="mc md ir nh b gz np nm l nn no">📂 <strong class="nh jb">test</strong><br/>└── test_set.csv</span></pre><p id="b30d" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">数据被方便地分成训练和测试数据集。</p><p id="2d44" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">在每一次训练和测试中，你会得到位置1到3的鸟的数据。</p><p id="e93a" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">下面来看看<code class="fe nq nr ns nh b">training_set.csv</code>的前五行</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="nt nu l"/></div></figure><p id="c8a5" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated"><code class="fe nq nr ns nh b">training_set</code>和<code class="fe nq nr ns nh b">training_target</code>可以与<code class="fe nq nr ns nh b">‘id’</code>柱连接。</p><p id="4410" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">下面是给定列的数据字典</p><pre class="kq kr ks kt gu ng nh ni nj aw nk bi"><span id="aa3c" class="mc md ir nh b gz nl nm l nn no"><strong class="nh jb">species</strong>     : animal species (A, B, C)<br/><strong class="nh jb">bill_length</strong> : bill length (mm)<br/><strong class="nh jb">bill_depth</strong>  : bill depth (mm)<br/><strong class="nh jb">wing_length</strong> : wing length (mm)<br/><strong class="nh jb">mass</strong>        : body mass (g)<br/><strong class="nh jb">location</strong>    : island type (Location 1, 2, 3)<br/><strong class="nh jb">sex</strong>         : animal sex (0: Male; 1: Female; NA: Unknown)</span></pre><p id="9f30" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">然后，看着<code class="fe nq nr ns nh b">solution_format.csv</code></p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="nt nu l"/></div></figure><p id="3cca" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">现在你对目标有了一个想法，对给你的数据有了一些了解，是时候动手了。</p><p id="9bbb" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated"><strong class="li jb">本文代码→ </strong> <a class="ae lf" href="https://deepnote.com/workspace/benthecoder-1aa3f71b-c5ea-44d1-ba14-b7fe4c5507d7/project/article-notebooks-a605a3e6-1564-47b2-94e7-842290ba7692/%2Fbird-classification.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="li jb">深注</strong> </a></p></div><div class="ab cl nv nw hv nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ik il im in io"><h2 id="1655" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">加载库</h2><p id="c03d" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">接下来，我们加载一些用于可视化和机器学习的基本库。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="oc nu l"/></div></figure><h2 id="37dc" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">缺少数据帮助函数</h2><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="oc nu l"/></div></figure><h2 id="ce1f" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">加载数据</h2><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="od nu l"/></div></figure><p id="5bfb" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">首先，我们使用<code class="fe nq nr ns nh b">read_csv</code>函数加载训练和测试数据。</p><p id="58b8" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们还将<code class="fe nq nr ns nh b">training_set.csv</code>(包含特征)与` training_target.csv `(包含目标变量)合并，形成训练数据。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="oe nu l"/></div></figure><p id="13bf" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">在这里，我手动保存了列名，包括数字和分类，还保存了目标列。</p><p id="ab29" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">这使我可以很容易地引用我以后想要的列</p><h1 id="8d0b" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">探索性数据分析</h1><p id="af33" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">有趣的部分到了，可视化数据。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="oq nu l"/></div></figure><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="or nu l"/></div></figure><p id="9732" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">从<code class="fe nq nr ns nh b">info</code>函数中，似乎有丢失的值，我们可以看到位置和性别应该是分类的，所以我们稍后必须进行一些数据类型转换。</p><h2 id="4c55" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">数字列</h2><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="os nu l"/></div></figure><p id="58e1" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">绘制数值变量的直方图，我们看到</p><ul class=""><li id="8364" class="ot ou ir li b lj lk lm ln lp ov lt ow lx ox mb oy oz pa pb bi translated">bill_depth在15和19左右达到峰值</li><li id="1b83" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb oy oz pa pb bi translated">比尔的长度在39岁和47岁左右达到顶峰</li><li id="f5a6" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb oy oz pa pb bi translated">翼长峰值在190°和216°左右</li><li id="ecde" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb oy oz pa pb bi translated">质量是右偏的</li></ul><h2 id="c82e" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">分类列</h2><p id="311c" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">让我们首先想象一下我们的目标类。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="ph nu l"/></div></figure><p id="74be" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们看地点和物种似乎是为了它们各自的地点和物种(loc2 &amp;物种C，loc3 &amp;物种A)。</p><p id="fea3" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们也看到雌性鸟比雄性鸟稍微多一点。</p><p id="3578" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">根据物种图，我们手里似乎有一个不平衡的职业，因为物种<code class="fe nq nr ns nh b">B</code>比物种<code class="fe nq nr ns nh b">A</code>和<code class="fe nq nr ns nh b">C</code>少得多</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pi nu l"/></div></figure><p id="a12d" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated"><em class="mx">为什么这是一个问题？</em></p><p id="85e5" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">模型会偏向于样本量较大的类。</p><p id="1897" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">发生这种情况是因为分类器具有关于具有更多样本的类的更多信息，因此它学习如何更好地预测那些类，而它在较小的类中保持较弱。</p><p id="8403" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">在我们的例子中，物种<code class="fe nq nr ns nh b">A</code>和<code class="fe nq nr ns nh b">C</code>将比其他职业更容易被预测到。</p><p id="3e78" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">这里有一篇关于如何处理这个问题的很棒的文章。</p><h1 id="3554" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">缺少值</h1><p id="62d3" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">使用助手功能，似乎有大量的<code class="fe nq nr ns nh b">bill_length</code>和<code class="fe nq nr ns nh b">wing_length</code>数据丢失</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pj nu l"/></div></figure><p id="f93c" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们还可以使用热图来可视化该列中缺失的数据。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pk nu l"/></div></figure><h2 id="0d95" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">估算分类值</h2><p id="b4a1" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">先看看我们的分类变量里有多少缺失变量。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pi nu l"/></div></figure><p id="f71d" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">让我们使用简单的估算器来处理它们，用最频繁的值替换它们。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pl nu l"/></div></figure><p id="f298" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">如您所见，通过<code class="fe nq nr ns nh b">most_frequent</code>策略，缺失值被估算为1.0，这是最常见的。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="oe nu l"/></div></figure><h2 id="43f0" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">估算数字列</h2><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pl nu l"/></div></figure><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pm nu l"/></div></figure><h1 id="bbae" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">特征预处理和工程</h1><p id="4ff1" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">我们必须将分类特征转换成数字格式，包括目标变量。</p><p id="d63e" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">让我们使用<a class="ae lf" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn的标签编码器</a>来完成这项工作。</p><p id="1dfa" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">这里有一个使用<code class="fe nq nr ns nh b">LabelEncoder()</code>标签列的例子</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pn nu l"/></div></figure><p id="5c2b" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">通过首先拟合它，我们可以看到映射看起来像什么。</p><p id="b0fe" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">使用<code class="fe nq nr ns nh b">fit_transform</code>直接为我们转换</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="po nu l"/></div></figure><p id="46a9" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">对于其他包含字符串变量(非数字)的列，我们也进行同样的编码</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pl nu l"/></div></figure><p id="3c75" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们还将分类特征转换成<code class="fe nq nr ns nh b">pd.Categorical</code>数据类型</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pl nu l"/></div></figure><p id="2502" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">这是变量的当前数据类型。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pp nu l"/></div></figure><p id="83c3" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">现在，我们通过将一些变量除以另一个变量来形成比率，从而创建一些额外的特征。</p><p id="5d30" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们不知道它们是否有助于提高模型的预测能力，但试试也无妨。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pl nu l"/></div></figure><p id="105b" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">这是目前火车场景的样子</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="oq nu l"/></div></figure><h1 id="e745" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">构建模型</h1><h2 id="6d15" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">列车测试分离</h2><p id="5f87" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">现在该建立模型了，我们先把它拆分成X(特征)和y(目标变量)，再拆分成训练集和评估集。</p><p id="60ff" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">训练是我们训练模型的地方，评估是我们在使模型适合测试集之前测试模型的地方。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="po nu l"/></div></figure><p id="2760" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们使用<code class="fe nq nr ns nh b"><a class="ae lf" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank">train_test_split</a></code>将我们的数据分成训练集和评估集。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pq nu l"/></div></figure><h2 id="0540" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">决策树分类器</h2><p id="0d6e" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">对于本文，我们选择一个简单的基线模式，即<a class="ae lf" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html" rel="noopener ugc nofollow" target="_blank">决策树分类器</a></p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="po nu l"/></div></figure><p id="987b" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">一旦我们适应了训练集，我们就可以根据评估数据进行预测。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="po nu l"/></div></figure><h1 id="e934" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">模型性能</h1><p id="5585" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">让我们看看简单的决策树分类器是如何工作的。</p><p id="7f6c" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">对于不平衡的数据集，99%的准确率可能毫无意义，因此我们需要更合适的指标，如精度、召回率和混淆矩阵。</p><h2 id="2967" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">混淆矩阵</h2><p id="4f99" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">让我们为我们的模型预测创建一个混淆矩阵。</p><p id="030e" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">首先，我们需要获得标签编码器给出的类名和标签，这样我们的图就可以显示标签名。</p><p id="85c7" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">然后我们绘制一个非标准化和标准化的混淆矩阵。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pr nu l"/></div></figure><p id="8454" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">混淆矩阵告诉我们，它预测了更多的A类和C类，这并不奇怪，因为我们有更多的样本。</p><p id="0b14" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">它还表明，该模型预测了更多的A类，而它应该是B/C类。</p><h2 id="9945" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">分类报告</h2><p id="91eb" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated"><a class="ae lf" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html" rel="noopener ugc nofollow" target="_blank">分类报告</a>测量来自分类算法的预测质量。</p><p id="2818" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">它告诉我们有多少预测是对的/错的</p><p id="1437" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">更具体地说，它使用真阳性、假阳性、真阴性和假阴性来计算精确度、召回率和f1值</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="ps nu l"/></div></figure><p id="4734" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">有关这些指标的详细计算，请查看<a class="ae lf" rel="noopener" target="_blank" href="/multi-class-metrics-made-simple-part-ii-the-f1-score-ebe8b2c2ca1">简化的多级指标，第二部分:由<a class="pt pu ep" href="https://medium.com/u/57ee515c83c5?source=post_page-----914cbc0590b--------------------------------" rel="noopener" target="_blank"> Boaz Shmueli </a>撰写的F1分数</a></p><p id="5bcc" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">直观上，<a class="ae lf" href="https://en.wikipedia.org/wiki/Precision_and_recall#Precision" rel="noopener ugc nofollow" target="_blank">精度</a>是分类器不将一个阴性(错误)样本标记为阳性(正确)的能力，<a class="ae lf" href="https://en.wikipedia.org/wiki/Precision_and_recall#Recall" rel="noopener ugc nofollow" target="_blank">召回</a>是分类器找到所有阳性(正确)样本的能力。</p><p id="f213" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">从<a class="ae lf" href="https://scikit-learn.org/stable/modules/model_evaluation.html#classification-report" rel="noopener ugc nofollow" target="_blank">文档</a>中，</p><ul class=""><li id="059e" class="ot ou ir li b lj lk lm ln lp ov lt ow lx ox mb oy oz pa pb bi translated"><code class="fe nq nr ns nh b">"macro"</code>简单地计算二进制指标的平均值，对每个类别赋予相等的权重。在非频繁类仍然重要的问题中，宏平均可能是突出其性能的一种方法。另一方面，所有类都同等重要的假设通常是不正确的，因此宏平均会过度强调不经常出现的类的典型低性能。</li><li id="6db5" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb oy oz pa pb bi translated"><code class="fe nq nr ns nh b">"weighted"</code>通过计算二进制指标的平均值来说明类别不平衡，在二进制指标中，每个类别的分数根据其在真实数据样本中的存在情况进行加权。</li></ul><p id="a841" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">没有单一的最佳指标，这取决于您的应用。应用程序以及与不同类型的错误相关的实际成本将决定使用哪种度量标准。</p><h1 id="bf3a" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">特征重要性</h1><p id="341f" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">让我们也画出特性的重要性，看看哪些特性更重要。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pv nu l"/></div></figure><p id="ca09" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">从特征重要性来看，<code class="fe nq nr ns nh b">mass</code>似乎最擅长预测物种，其次是<code class="fe nq nr ns nh b">bill_length</code>。</p><p id="763f" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">其他变量在分类器中似乎不重要。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pw nu l"/></div></figure><p id="606b" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">我们看到特征重要性是如何在我们的决策树分类器的可视化中使用的。</p><p id="4e4f" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">在根节点中，如果质量低于大约4600，那么它检查<code class="fe nq nr ns nh b">bill_length</code>，否则它检查<code class="fe nq nr ns nh b">bill_depth</code>，然后在叶子处它预测类。</p><h1 id="905c" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">根据测试数据进行预测</h1><p id="a82a" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">首先，我们执行相同的预处理+特征生成</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="px nu l"/></div></figure><p id="c1a0" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">然后，我们可以使用我们的模型进行预测，并连接ID列以形成解决方案文件。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="py nu l"/></div></figure><p id="8d6a" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">请注意，物种值是数值，我们必须将其转换回字符串值。有了fit早期的标签编码器，我们可以做到这一点。</p><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pm nu l"/></div></figure><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="pz nu l"/></div></figure><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="qa nu l"/></div></figure><h1 id="5303" class="of md ir bd me og oh oi mh oj ok ol mk kg om kh mn kj on kk mq km oo kn mt op bi translated">保存预测文件。</h1><figure class="kq kr ks kt gu ku"><div class="bz fq l di"><div class="po nu l"/></div></figure></div><div class="ab cl nv nw hv nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ik il im in io"><h1 id="93c7" class="of md ir bd me og qb oi mh oj qc ol mk kg qd kh mn kj qe kk mq km qf kn mt op bi translated">后续步骤</h1><p id="3adc" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">基础模型不足以做出好的预测；下面是改进给定方法的一些后续步骤。</p><ol class=""><li id="af40" class="ot ou ir li b lj lk lm ln lp ov lt ow lx ox mb qg oz pa pb bi translated">更多特征预处理和工程</li><li id="59e8" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb qg oz pa pb bi translated">使用交叉验证来更好地衡量性能。</li><li id="74a1" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb qg oz pa pb bi translated">测试其他算法，如KNN，SVM，XGBoost，Catboost等。</li><li id="c6b9" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb qg oz pa pb bi translated"><a class="ae lf" href="https://discord.com/invite/H5UTQs32Bn" rel="noopener ugc nofollow" target="_blank"> <strong class="li jb">加入bitgrit discord服务器</strong> </a> <strong class="li jb"> </strong>与其他数据科学家讨论挑战</li></ol><h2 id="5b12" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">超棒的Kaggle笔记本</h2><p id="97e9" class="pw-post-body-paragraph lg lh ir li b lj nb kb ll lm nc ke lo lp nd lr ls lt ne lv lw lx nf lz ma mb ik bi translated">这里有3个笔记本作为参考，告诉你如何在这次挑战中提升自己的水平</p><ol class=""><li id="9d53" class="ot ou ir li b lj lk lm ln lp ov lt ow lx ox mb qg oz pa pb bi translated"><a class="ae lf" href="https://www.kaggle.com/code/vbmokin/data-science-for-tabular-data-advanced-techniques" rel="noopener ugc nofollow" target="_blank">表格数据的数据科学:高级技术</a></li><li id="0f83" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb qg oz pa pb bi translated"><a class="ae lf" href="https://www.kaggle.com/code/janiobachmann/credit-fraud-dealing-with-imbalanced-datasets" rel="noopener ugc nofollow" target="_blank">信用欺诈—处理不平衡的数据集</a></li><li id="a794" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb qg oz pa pb bi translated"><a class="ae lf" href="https://www.kaggle.com/code/erikbruin/house-prices-lasso-xgboost-and-a-detailed-eda" rel="noopener ugc nofollow" target="_blank">房价:Lasso，XGBoost，以及详细的EDA </a></li></ol></div><div class="ab cl nv nw hv nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ik il im in io"><h1 id="651c" class="of md ir bd me og qb oi mh oj qc ol mk kg qd kh mn kj qe kk mq km qf kn mt op bi translated">感谢阅读！</h1><h2 id="083f" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">喜欢这篇文章吗？这里有三篇文章你可能会喜欢:</h2><ul class=""><li id="03a9" class="ot ou ir li b lj nb lm nc lp qh lt qi lx qj mb oy oz pa pb bi translated"><a class="ae lf" rel="noopener" target="_blank" href="/predicting-rain-with-machine-learning-2acf80017c44">用机器学习预测降雨</a></li><li id="bde1" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb oy oz pa pb bi translated"><a class="ae lf" rel="noopener" target="_blank" href="/using-data-science-to-predict-viral-tweets-615b0acc2e1e">利用数据科学预测病毒性推文</a></li><li id="3999" class="ot ou ir li b lj pc lm pd lp pe lt pf lx pg mb oy oz pa pb bi translated">40个有用的熊猫片段。在数据分析工作中派上用场的熊猫片段</li></ul><h2 id="1a70" class="mc md ir bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt ix bi translated">数据L <em class="qk">许可</em></h2><blockquote class="mu mv mw"><p id="72f8" class="lg lh mx li b lj lk kb ll lm ln ke lo my lq lr ls mz lu lv lw na ly lz ma mb ik bi translated"><em class="ir">数据由</em><a class="ae lf" href="https://creativecommons.org/share-your-work/public-domain/cc0/" rel="noopener ugc nofollow" target="_blank"><em class="ir">CC-0</em></a><em class="ir">授权按照</em> <a class="ae lf" href="http://pal.lternet.edu/data/policies" rel="noopener ugc nofollow" target="_blank"> <em class="ir">帕尔默站【LTER】数据策略</em> </a> <em class="ir">和</em> <a class="ae lf" href="https://lternet.edu/data-access-policy/" rel="noopener ugc nofollow" target="_blank"> <em class="ir"> LTER数据访问策略获取I类数据</em> </a> <em class="ir">。</em></p></blockquote></div><div class="ab cl nv nw hv nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ik il im in io"><p id="2a15" class="pw-post-body-paragraph lg lh ir li b lj lk kb ll lm ln ke lo lp lq lr ls lt lu lv lw lx ly lz ma mb ik bi translated">喜欢我的写作吗？<strong class="li jb">用我的<a class="ae lf" href="https://benedictxneo.medium.com/membership" rel="noopener"> <strong class="li jb">推荐链接</strong> </a>加入Medium </strong>，你将直接支持我🤗</p><div class="ql qm gq gs qn qo"><a href="https://benedictxneo.medium.com/membership" rel="noopener follow" target="_blank"><div class="qp ab fp"><div class="qq ab qr cl cj qs"><h2 class="bd jb gz z fq qt fs ft qu fv fx ja bi translated">立即获取无限的故事</h2><div class="qv l"><h3 class="bd b gz z fq qt fs ft qu fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="qw l"><p class="bd b dl z fq qt fs ft qu fv fx dk translated">benedictxneo.medium.com</p></div></div><div class="qx l"><div class="qy l qz ra rb qx rc kz qo"/></div></div></a></div></div></div>    
</body>
</html>