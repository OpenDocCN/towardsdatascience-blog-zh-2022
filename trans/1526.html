<html>
<head>
<title>Dickey Fuller Direct Estimation — Speed up to 50x Test Statistic Computation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Dickey Fuller直接评估—测试统计计算速度提高50倍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dickey-fuller-direct-estimation-speed-up-to-50x-test-statistic-computation-af3cb28b9803#2022-04-13">https://towardsdatascience.com/dickey-fuller-direct-estimation-speed-up-to-50x-test-statistic-computation-af3cb28b9803#2022-04-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c37c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过相关系数直接估计Dickey-Fuller检验统计量，避免不必要的回归和矩阵求逆。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/61ebd6b19d30273193065e61f7809f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kdspkh-aKZc4L71CYH51zg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="a1a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Dickey-Fuller检验可能是时间序列分析中最著名的平稳性(单位根)检验。测试的计算程序依赖于具体统计公式的线性回归结果。然而，线性回归需要矩阵求逆，这可能是计算密集型的，甚至是数值不稳定的。</p><p id="08c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个故事中，我们将探索OLS(普通最小二乘法)背后的数学，并使用这样的分析来推导Dickey-Fuller检验统计量的闭合形式表达式(使用1个时滞和一个常数)。所得表达式仅使用相关系数，没有矩阵求逆或计算密集型操作。这可以将计算速度提高50倍。</p><h2 id="dc26" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">目录</h2><ul class=""><li id="e69b" class="mn mo it la b lb mp le mq lh mr ll ms lp mt lt mu mv mw mx bi translated">封闭形式表达式推导</li><li id="96de" class="mn mo it la b lb my le mz lh na ll nb lp nc lt mu mv mw mx bi translated">封闭形式的表达式结果</li><li id="fd8d" class="mn mo it la b lb my le mz lh na ll nb lp nc lt mu mv mw mx bi translated">健全性检查</li><li id="ecb2" class="mn mo it la b lb my le mz lh na ll nb lp nc lt mu mv mw mx bi translated">转速试验</li><li id="9a29" class="mn mo it la b lb my le mz lh na ll nb lp nc lt mu mv mw mx bi translated">p值</li><li id="2000" class="mn mo it la b lb my le mz lh na ll nb lp nc lt mu mv mw mx bi translated">最后的话</li></ul><h2 id="bf2c" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">封闭形式表达式推导</h2><p id="be40" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">如果你想跳过数学细节，滚动到下一节，没有伤害。</p><p id="163d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于那些还在这里的人，让我们首先正式阐明这个问题。最多一个滞后和一个常数的Dickey-Fuller检验(非扩充)自回归模型规格为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/4fa0b8d3e4e9d8555756e8fe100588dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-8hwfMKNS72UxSxdY8ouQ@2x.jpeg"/></div></div></figure><p id="6b2b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用ε i.i.d，该等式可以转换为时间序列增量显式的形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6b368c32647da176db26e018f161f1c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6yVY5nq5BnnA_3ETfDZryw@2x.jpeg"/></div></div></figure><p id="89cc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过OLS估计α、β及其方差。</p><p id="6df0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">迪基-富勒检验统计量定义为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a609c289beb927969ee9774ded19071f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*odoQYMusipzd4ZZ7Ny0MbQ@2x.jpeg"/></div></figure><p id="8997" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以用数值方法进行OLS回归，得到β和它的方差，然后就到此为止。这将涉及计算量很大的矩阵求逆和矩阵乘法。所以我们不会这么做。</p><p id="cd14" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以走的另一条路是做数学。似乎现在我大部分时间都在电脑上捣鼓数字，几乎没有时间在黑板上做实际的数学运算。在这种情况下，做数学确实会有回报。</p><p id="30ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们将用矩阵和向量来表示我们的回归</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/0e15ae1155c5d73b1a9964aad8aa305b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EXMs9ZVQ7noJuPV8POov5A@2x.jpeg"/></div></figure><p id="1525" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中<em class="nk"> S </em> _d是由<em class="nk"> S </em>的差组成的维度为<em class="nk"> T </em>的向量，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/51718672f89270ad5bd1265459eb5387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*9pX6W94zPW5CfiGK9g6-4Q@2x.jpeg"/></div></figure><p id="b02a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">并且<em class="nk"> X </em>是一个<em class="nk"> T </em> x2矩阵</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/85e9f707f47fc7861cf3d5f5bfb0c44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*125NzTQP3ExatTCj_AUqpw@2x.jpeg"/></div></figure><p id="70cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">设<em class="nk"> S </em> _L为滞后时间序列<em class="nk"> S </em>的<em class="nk"> T </em>维向量，则以下关系成立:</p><ul class=""><li id="bdcb" class="mn mo it la b lb lc le lf lh nl ll nm lp nn lt mu mv mw mx bi translated"><em class="nk"> S </em> _L的含义:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/3fcef5b2ea215d1eaec5dc1c5edca7c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*ToiE0_9LWLHccZg_kfV6Qg@2x.jpeg"/></div></figure><ul class=""><li id="0adc" class="mn mo it la b lb lc le lf lh nl ll nm lp nn lt mu mv mw mx bi translated"><em class="nk"> S </em> _L的方差:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/e7796cbacb57f27a0f20e0af3224f189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0PcKUvIXpiPTeRKL6d2h1g@2x.jpeg"/></div></div></figure><ul class=""><li id="6431" class="mn mo it la b lb lc le lf lh nl ll nm lp nn lt mu mv mw mx bi translated"><em class="nk">S</em>d的意思是:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/f2afc681472a1456a634a455fa0893c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r6_HF-0qgC87z01KzXexfQ@2x.jpeg"/></div></div></figure><ul class=""><li id="7ff5" class="mn mo it la b lb lc le lf lh nl ll nm lp nn lt mu mv mw mx bi translated"><em class="nk"> S </em> _d的方差:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/8ee1d8bca8e1fac02be3297b409c1962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKyKX8aXv1rrz8QCc2MUtg@2x.jpeg"/></div></div></figure><ul class=""><li id="fa18" class="mn mo it la b lb lc le lf lh nl ll nm lp nn lt mu mv mw mx bi translated"><em class="nk"> S </em> _L和<em class="nk"> S </em> _d的协方差:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/d4da9a8257d4f1bb1d04944ca53d1032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmFqUj2OHbxQu9oGaEftNw@2x.jpeg"/></div></div></figure><p id="2aab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，我们不使用贝塞尔校正，因为由此产生的方程会有更多的项。当有疑问时，就去寻找能产生最佳数学表达式的结果。你可以自己试试，按照下面的步骤使用贝塞尔的方差修正。</p><p id="d4e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">矩阵形式的OLS估计量为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/21b8a17f141404a49c50f9ab6fae2763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJSozwv8l4PBAoLo1Rmh2g@2x.jpeg"/></div></div></figure><p id="0808" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中T上标表示矩阵转置。我们有</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/72bd9c6a98c11e535c69ec80013042c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qfTS_2QQkF5JNK_mdExihg@2x.jpeg"/></div></div></figure><p id="4078" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它的反义词:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/3d308c37ad11a4d5b5a04f4316dd3e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r_3-c42pWJnnC7YY8C0tnw@2x.jpeg"/></div></div></figure><p id="614a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">和</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6127e8ca30987e8b44256517c6c83268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhJl_rhOBItFRwSGPBP9Ig@2x.jpeg"/></div></div></figure><p id="ef8e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/644220b8614a33f824bb8174774edaf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRBGtJqWPhqit9Oo7wYtPQ@2x.jpeg"/></div></div></figure><p id="4ac3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">即</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6798eb61c0dcae266868eef7ce2a65db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n7zkDPXnpMiIdntWQxJFJQ@2x.jpeg"/></div></div></figure><p id="e9f6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中，ρ是滞后序列和差异序列之间的皮尔逊相关系数，以及</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/bbe486e900cff11c05f7631d23f5bbf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v4pMrSYBCiU-HmbLuLnkkg@2x.jpeg"/></div></div></figure><p id="a6d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，即使我们对方差使用贝塞尔校正，α和β的结果也将保持不变。</p><p id="660a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们需要得到β的方差。根据OLS，我们得到δ的协方差矩阵为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/0354dfc5e7074d3419f10dcbd3298253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b1QTI9RVVZ9_YPqPQtZk3A@2x.jpeg"/></div></div></figure><p id="9792" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么β的方差为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/9289d46c357634353c55758b0b4105e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2GTMxEg887X0iEYCw9l-g@2x.jpeg"/></div></div></figure><p id="fc86" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在哪里</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/999225c8ca5327f576a4732bdbe83f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTOB0d2QaG-i_XGwS-0Yiw@2x.jpeg"/></div></div></figure><p id="7feb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">是回归残差的方差。注意，我们在分母中使用了<em class="nk"> T </em> -2，而不是<em class="nk"> T </em>，因为在OLS，残差只有<em class="nk"> T </em> -2个自由度，因为这两个约束成立:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/3714914fe795524231c1be32466cb992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*peGgb0mhpx3linMyKnkhZw@2x.jpeg"/></div></div></figure><p id="c236" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">即，通过构造，残差的平均值为零，回归量和残差之间的协方差为零。</p><p id="25e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，展开残差方差的等式，注意时间序列差异的估计为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/83c9211ae4f54ed38fa7a24936671f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cXPnTE-7BkHZP5mnR-k-Tw@2x.jpeg"/></div></div></figure><p id="39e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们知道:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/76077b5118a2a7d7ee600f70509e376e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0iOoYiqA0gTD0Lx9XNAeBA@2x.jpeg"/></div></div></figure><p id="3d34" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们使用贝塞尔对方差的修正，这个结果会更混乱。</p><p id="65c0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么我们可以将β的方差表示为</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/db850f3226087e1cc5c48b3ad22b1afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G1_sfB-BgHGi3UUMOHl_mQ@2x.jpeg"/></div></div></figure><p id="855e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，经过我们所有的努力，我们可以写出Dickey-Fuller检验统计量的封闭形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/4714c732019eff6dbc02110fbca2ee5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QdD34Ehy38N0K6GqfY2H2w@2x.jpeg"/></div></div></figure><h2 id="4256" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">封闭形式的表达式结果</h2><p id="fb3f" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">Dickey-Fuller检验统计量的封闭表达式的结果是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/4714c732019eff6dbc02110fbca2ee5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QdD34Ehy38N0K6GqfY2H2w@2x.jpeg"/></div></div></figure><p id="7300" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中<em class="nk"> T </em> +1是我们数据的样本量，ρ是滞后时间序列(样本量<em class="nk"> T </em>)和差分时间序列(样本量<em class="nk"> T </em>)之间的相关系数。</p><p id="465d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们唯一需要计算的是相关系数，这比计算OLS更有效。这在优化例程和时间序列的实时分析中变得很方便，因为每一毫秒都很重要。</p><h2 id="7314" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">健全性检查</h2><p id="13aa" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在本节中，我们将把我们的结果与从Statsmodels (Python)库中获得的结果进行比较。让我们为Dickey-Fuller检验统计量定义我们的函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="c944" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用带有标准正态增量(布朗运动)的AR(1)单位根过程进行测试:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="0615" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们得到我们的直接Dickey-Fuller估计和OLS方法(Statsmodels)的相对平均误差的估计，即| DF _ stat models—DF _ direct |/| DF _ direct |。这正是下一个函数要完成的。它用随机布朗运动运行“n_tests ”,并返回一个有差异的数组。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="1951" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行测试和绘图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/277365e965cbdfbe4b4847a013cf5896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NvWs_6SXlM1ho_Cd_-xppA.png"/></div></div></figure><p id="96c7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，您的结果会有所不同，因为这个测试是随机的。但对于样本量为10，000的时间序列，相对平均误差约为1%。所以我们的理智检查确实是成功的。然而，在某些试验中，这两种估计方法之间存在微小的差异，这是由于估计方法中的单位根过程引起的数值不稳定性。然而，考虑到计算效率的提高，这是我们可以忍受的。</p><h2 id="9ae7" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">速度测试</h2><p id="3560" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">现在是最精彩的部分。在本节中，我们将比较OLS方法(Statsmodels)和Dickey-Fuller检验的直接估计的速度。下面的代码对这两个函数(方法)中的任何一个进行时间测试。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="7dcf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对100到100，000的样本大小范围进行测试，并绘制:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/269bd01215beaf8605486846f94ebfa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CjNY1oQkJzxohaqAqC0S7w.png"/></div></div></figure><p id="0b26" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，对于大样本量的时间序列，速度提高了约50倍，但即使对于较小的样本量，速度也提高了约10倍。所以，的确，做数学得到了回报。</p><h2 id="72b1" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">p值</h2><p id="4e69" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在本节中，我们将编写一个类来获取Dickey-Fuller测试直接估计的p值。没有p值的统计工具是不完整的。我们将使用上面描述(和编码)的AR(1)单位根过程进行蒙特卡罗模拟。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="3939" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，在这个类中，我们使用了前面章节中的“get_DF”函数和“get_unit_root_proc”。</p><p id="b1e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，我们使用DFProbTable对象来获得T=500的P值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="3807" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">最后的话</h2><p id="821c" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">至少可以说，这个故事中的数学有点长，但最终，我们得到了一个值得的结果。这里提出的Dickey-Fuller统计量公式不仅有助于优化计算效率，而且有助于以另一种方式理解统计量。</p><p id="cac0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有一个教训需要吸取:有时作为数据科学家，在没有太多底层数学知识的情况下，使用库和建模一切是非常容易的。然而，深入研究数学是一个好主意，不仅仅是作为学习练习，也是获得新的不同见解的一种方式。一知半解是一件危险的事情。</p><h2 id="3333" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">参考</h2><p id="2f17" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">[1] M. L. de Prado，D. Leinweber，<a class="ae oc" href="http://..." rel="noopener ugc nofollow" target="_blank">协整和子集相关套期保值方法的进展</a> (2012)，《投资策略杂志》，第1卷第2期，第67–115页</p><p id="4f12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[2]<a class="ae oc" href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf" rel="noopener ugc nofollow" target="_blank">https://web . Stanford . edu/~ mrosenfe/SOC _ meth _ proj 3/matrix _ OLS _ NYU _ notes . pdf</a></p><p id="b930" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[3]<a class="ae oc" href="http://web.vu.lt/mif/a.buteikis/wp-content/uploads/PE_Book/3-2-OLS.html" rel="noopener ugc nofollow" target="_blank">http://web . vu . lt/MIF/a . buteikis/WP-content/uploads/PE _ Book/3-2-ols . html</a></p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="d712" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望这个故事对你有用。如果我错过了什么，请让我知道。如果你想知道更多这样的故事，请关注我。</p><div class="ok ol gp gr om on"><a href="https://medium.com/subscribe/@diego-barba" rel="noopener follow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">每当迭戈·巴尔巴出版时，就收到一封电子邮件。</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">每当迭戈·巴尔巴出版时，就收到一封电子邮件。通过注册，您将创建一个中型帐户，如果您还没有…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">medium.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ks on"/></div></div></a></div><p id="87bb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">喜欢这个故事吗？通过我的推荐链接成为媒体会员，可以无限制地访问我的故事和许多其他内容。</p><div class="ok ol gp gr om on"><a href="https://medium.com/@diego-barba/membership" rel="noopener follow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">通过我的推荐链接加入Medium-Diego Barba</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">medium.com</p></div></div><div class="ow l"><div class="pc l oy oz pa ow pb ks on"/></div></div></a></div></div></div>    
</body>
</html>