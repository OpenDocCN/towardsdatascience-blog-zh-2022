<html>
<head>
<title>5 Easy SQL Tricks to Clean Dirty Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">清理脏数据的5个简单SQL技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-easy-sql-tricks-to-clean-dirty-data-dc423a0ab3e9#2022-07-08">https://towardsdatascience.com/5-easy-sql-tricks-to-clean-dirty-data-dc423a0ab3e9#2022-07-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="fd8a" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学</h2><div class=""/><div class=""><h2 id="4469" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">立即掌握它— SQL查询清理数据并为分析做好准备</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/0898aff0c22cd3f1d6d32cfd7f243d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AMOdMndzIVHuUUqS"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@4themorningshoot?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">奥利弗·黑尔</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><blockquote class="li"><p id="b46b" class="lj lk it bd ll lm ln lo lp lq lr ls dk translated">"没有数据是干净的，但大多数是有用的."</p><p id="c88f" class="lj lk it bd ll lm lt lu lv lw lx ls dk translated">—迪安·阿博特</p></blockquote><p id="3a1a" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg mh mi mj mk ml mm mn mo mp mq mr ms ls im bi translated">真实世界的数据几乎总是杂乱无章的。作为数据科学家或分析师，你需要发现数据的真相。要做到这一点，数据必须整洁，没有错误。因此，第一步是清理数据。✅</p><p id="6313" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">因此，我总结了5个技巧，你可以用来清理SQL中杂乱的数据。</p><p id="67bb" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">这是一个快速阅读，你可以用你的咖啡来完成它，并掌握一些清理脏数据的有趣技巧。🏆</p><p id="e37b" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">使用这个索引，您可以轻松地导航到您最喜欢的部分。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="2337" class="nd ne it mz b gy nf ng l nh ni"><strong class="mz jd">· </strong><a class="ae lh" href="#8ad1" rel="noopener ugc nofollow"><strong class="mz jd">Find Missing Values in Your Data</strong></a><strong class="mz jd"><br/>· </strong><a class="ae lh" href="#6314" rel="noopener ugc nofollow"><strong class="mz jd">Flag Certain Records</strong></a><strong class="mz jd"><br/>· </strong><a class="ae lh" href="#22de" rel="noopener ugc nofollow"><strong class="mz jd">Clean Up Messy Values </strong></a><strong class="mz jd"><br/>· </strong><a class="ae lh" href="#fc62" rel="noopener ugc nofollow"><strong class="mz jd">Bucket Values into Segments or Bins</strong></a><strong class="mz jd"><br/>· </strong><a class="ae lh" href="#74b8" rel="noopener ugc nofollow"><strong class="mz jd">Correct Data Types</strong></a></span></pre><blockquote class="nj nk nl"><p id="b975" class="ly lz nm ma b mb mt kd md me mu kg mg nn mv mj mk no mw mn mo np mx mr ms ls im bi translated"><em class="it">📍注意:我使用的是SQLite和一个自己创建的</em><a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/Dummy_Sales_Data_v1.csv" rel="noopener ugc nofollow" target="_blank"><em class="it">Dummy _ Sales _ Data</em></a><em class="it">使用</em><a class="ae lh" rel="noopener" target="_blank" href="/faker-an-amazing-and-insanely-useful-python-library-b313a60bdabf"><em class="it">Faker</em></a><em class="it">创建的，你可以在我的</em><a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/Dummy_Sales_Data_v1.csv" rel="noopener ugc nofollow" target="_blank"><strong class="ma jd"><em class="it">Github</em></strong></a><em class="it">repo下免费获得</em><a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/LICENSE.md" rel="noopener ugc nofollow" target="_blank"><em class="it">MIT license</em></a><em class="it">！！</em></p></blockquote><p id="7a22" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">好的，我们开始吧…🚀</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="8ad1" class="nx ne it bd ny nz oa ob oc od oe of og ki oh kj oi kl oj km ok ko ol kp om on bi translated">查找数据中缺失的值</h1><p id="6cf9" class="pw-post-body-paragraph ly lz it ma b mb oo kd md me op kg mg mh oq mj mk ml or mn mo mp os mr ms ls im bi translated">缺失值的问题在许多现实生活的数据集中相当普遍。缺失值可能会使数据分析或机器学习模型的结果产生偏差，或者降低模型的准确性，或者只是使数据分析变得困难。</p><p id="7b4b" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">使用这些现成的查询来找出数据中缺少的值，并检查是否有任何模式与数据相关联。</p><ul class=""><li id="b124" class="ot ou it ma b mb mt me mu mh ov ml ow mp ox ls oy oz pa pb bi translated"><strong class="ma jd">特定列中缺少数据</strong></li></ul><p id="efce" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">例如，找出<code class="fe pc pd pe mz b">Product_Category</code>丢失的<code class="fe pc pd pe mz b">OrderIDs</code>。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="86b6" class="nd ne it mz b gy nf ng l nh ni">SELECT OrderID,<br/>       Sales_Manager,<br/>       Product_Category,<br/>       Shipping_Address<br/>FROM Dummy_Sales_Data_v1<br/>WHERE <strong class="mz jd">Product_Category IS NULL</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/e32abb5921fc4402e252a7b26900bf0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*rikRbhwQJO_orVG_yOjY5w.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者查找数据|图像中缺少的值</p></figure><p id="c436" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">此外，当某些列有缺失值时，您可以发现数据集是否遵循任何趋势。</p><ul class=""><li id="8698" class="ot ou it ma b mb mt me mu mh ov ml ow mp ox ls oy oz pa pb bi translated"><strong class="ma jd">与缺失数据相关的模式</strong></li></ul><p id="3add" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">例如，在我们的例子中，当列<code class="fe pc pd pe mz b">Product_Category</code>中的值丢失时，让我们尝试找出数据是否遵循任何特定的模式。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="4642" class="nd ne it mz b gy nf ng l nh ni">SELECT Shipping_Address,<br/>       OrderID,<br/>       Quantity,<br/>       Product_Category<br/>FROM Dummy_Sales_Data_v1<br/>WHERE <strong class="mz jd">Product_Category IS NULL</strong><br/>GROUP BY Shipping_Address, OrderID, Quantity</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/373d728fa6f5488c6e7ae603097d4471.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*f-0xae6VibRohoBoLNs3tA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">与SQL | Image中缺失数据相关的模式(按作者)</p></figure><p id="6d57" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">这样，您可以检查，当<code class="fe pc pd pe mz b">Product_Category<strong class="ma jd"> </strong></code>丢失时，数据是否遵循特定的模式。您可以在<code class="fe pc pd pe mz b">WHERE</code>子句中传递任意数量的列，并获得与那些缺失值相关联的模式。</p><p id="bde1" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">此外，当列有特定值时，您总是可以发现数据中的模式，而不是丢失值，如下所示。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="2646" class="nd ne it mz b gy nf ng l nh ni">SELECT Shipping_Address,<br/>       OrderID,<br/>       Quantity<br/>FROM Dummy_Sales_Data_v1<br/>WHERE <strong class="mz jd">Product_Category LIKE 'Healthcare'</strong><br/>GROUP BY Shipping_Address, OrderID, Quantity<br/>ORDER BY Quantity DESC</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/2c8711521d97f1916303bf3ac70def7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*RKw92fcrTHXq-w9WunSkBw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">数据模式|作者图片</p></figure><p id="bc0c" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">在本例中，您找到了与<code class="fe pc pd pe mz b">Healthcare</code>产品相关的数量和送货地址模式，并清楚地看到了订单<code class="fe pc pd pe mz b">Quantity</code>的前5个送货地址。</p><h1 id="6314" class="nx ne it bd ny nz pi ob oc od pj of og ki pk kj oi kl pl km ok ko pm kp om on bi translated">标记某些记录</h1><p id="3089" class="pw-post-body-paragraph ly lz it ma b mb oo kd md me op kg mg mh oq mj mk ml or mn mo mp os mr ms ls im bi translated">另一个最佳实践是创建一个简单的二进制列来标记一些记录。这可以在执行数据分析的后期阶段使用。</p><p id="9f44" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">例如，假设您希望将所有记录标记为<code class="fe pc pd pe mz b">Dirty_Data</code>，如果数据集中缺少<code class="fe pc pd pe mz b">Delivery_Time</code>。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="9ac9" class="nd ne it mz b gy nf ng l nh ni">SELECT OrderID,<br/>       Sales_Manager,<br/>       Shipping_Address,<br/>       Delivery_Time,<br/>       <strong class="mz jd">CASE WHEN Delivery_Time IS NULL THEN 1<br/>            ELSE 0<br/>       END AS Dirty_data</strong><br/>FROM Dummy_Sales_Data_v1</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pn"><img src="../Images/79643829c0abb41f4497435c8f92990b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*JwpWZDCj_4FmonaQLEyNXQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者标记SQL | Image中的缺失值</p></figure><p id="2196" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">一个新列<code class="fe pc pd pe mz b">Dirty_Data</code>被添加到输出中，其值为<code class="fe pc pd pe mz b">0</code>和<code class="fe pc pd pe mz b">1</code>。当这个输出作为excel或任何编辑器输出时，它肯定会使进一步的任务变得容易，例如找出<code class="fe pc pd pe mz b">Delivery_Time</code>丢失的订单。</p><p id="2b34" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">这样，您可以包含尽可能多的不同条件来定义脏数据并对其进行标记。</p><p id="7922" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">接下来，让我们看看如何清理比需求粒度更大的数据。</p><h1 id="22de" class="nx ne it bd ny nz pi ob oc od pj of og ki pk kj oi kl pl km ok ko pm kp om on bi translated">清理混乱的价值观</h1><p id="29fc" class="pw-post-body-paragraph ly lz it ma b mb oo kd md me op kg mg mh oq mj mk ml or mn mo mp os mr ms ls im bi translated">清理粒度值的最好方法之一是将其标准化。✅</p><p id="80e2" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">通常，列值的粒度比所需的更细。在这种情况下，在更高的层次上对它们进行标准化更有意义。</p><p id="1614" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">例如，中的<code class="fe pc pd pe mz b"><strong class="ma jd">shipping address</strong></code>列包含国家名称，这些名称可以标准化为地区名称，如欧洲、北美等，如下面的查询所示。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="0080" class="nd ne it mz b gy nf ng l nh ni">SELECT OrderID,<br/>       Shipping_Address,<br/>       <strong class="mz jd">CASE WHEN Shipping_Address IN ('Germany','UK') THEN 'Europe'<br/>            ELSE 'Other'<br/>       END AS region</strong><br/>FROM Dummy_Sales_Data_v1</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi po"><img src="../Images/5a459dd88b9e6774d2d0132a65acd11e.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*uNzFkUQX73PpVt5SaObZVw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用CASE-WHEN | Image by Author标准化值</p></figure><p id="0b42" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">因此，国家级别的发货地址信息是细粒度的，所以您在地区级别对其进行了标准化。</p><p id="614f" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">为了简单起见，我在<code class="fe pc pd pe mz b">CASE</code>中只使用了一个<code class="fe pc pd pe mz b">WHEN</code>语句，然而，我们可以通过使用多个<code class="fe pc pd pe mz b">WHEN</code>语句随时在<code class="fe pc pd pe mz b">region</code>列中创建更多的值。</p><p id="6e02" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">更进一步，让查询稍微复杂一点，您可以跨多个记录分析数据。</p><h1 id="fc62" class="nx ne it bd ny nz pi ob oc od pj of og ki pk kj oi kl pl km ok ko pm kp om on bi translated">将值存储到段或箱中</h1><p id="dd96" class="pw-post-body-paragraph ly lz it ma b mb oo kd md me op kg mg mh oq mj mk ml or mn mo mp os mr ms ls im bi translated">这是SQL中<code class="fe pc pd pe mz b"><strong class="ma jd">CASE</strong></code>语句的经典用例。<code class="fe pc pd pe mz b">CASE</code>语句是SQL处理if-then逻辑的方式。</p><p id="94cc" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">你可以从我的最新文章——<a class="ae lh" rel="noopener" target="_blank" href="/5-advanced-sql-concepts-you-should-know-in-2022-b50efe6c99#2f01"><strong class="ma jd">2022年你应该知道的5个高级SQL概念</strong> </a> <strong class="ma jd">中更深入地洞察<code class="fe pc pd pe mz b">CASE</code>的说法。</strong></p><div class="pp pq gp gr pr ps"><a rel="noopener follow" target="_blank" href="/5-advanced-sql-concepts-you-should-know-in-2022-b50efe6c99"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd jd gy z fp px fr fs py fu fw jc bi translated">2022年你应该知道的5个高级SQL概念</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">立即掌握这些节省时间的高级SQL查询。</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">towardsdatascience.com</p></div></div><div class="qb l"><div class="qc l qd qe qf qb qg lb ps"/></div></div></a></div><p id="65b5" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">让我们看看，如何使用它将值存储到存储箱中。</p><p id="78cc" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">假设您想根据值将<code class="fe pc pd pe mz b">Shipping_Cost</code>分为低<em class="nm">、中</em>和高<em class="nm"/>。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="4645" class="nd ne it mz b gy nf ng l nh ni">SELECT OrderID,<br/>       Shipping_Cost,<br/><strong class="mz jd">       CASE WHEN Shipping_Cost &lt; 25 THEN 'Low'<br/>            WHEN Shipping_Cost BETWEEN 25 AND 32 THEN 'Medium'<br/>            WHEN Shipping_Cost &gt; 32 THEN 'High'<br/>       END AS cost_range</strong><br/>FROM Dummy_Sales_Data_v1</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/1948bdaa3897a03a82ff15bf96954c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*NbxaOX_DuWF3qJqDqTeH1g.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">将值存储到垃圾箱中SQL |按作者分类的图像</p></figure><p id="8fe7" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">结果，一个新的列<code class="fe pc pd pe mz b">cost_range</code>被创建，根据列<code class="fe pc pd pe mz b">shipping_cost</code>包含值<em class="nm">低、中、高</em>。</p><p id="3cc8" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">嗯，这些箱子是用来分类运输成本的。但是，如果您想按照<code class="fe pc pd pe mz b">cost_range</code>按升序(<em class="nm">从低到高</em>)或降序(<em class="nm">从高到低</em>)对记录进行排序，这些箱子不起作用。见下文，</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="f518" class="nd ne it mz b gy nf ng l nh ni">SELECT OrderID,<br/>       Shipping_Cost,<br/>       CASE WHEN Shipping_Cost &lt; 25 THEN 'Low'<br/>            WHEN Shipping_Cost BETWEEN 25 AND 32 THEN 'Medium'<br/>            WHEN Shipping_Cost &gt; 32 THEN 'High'<br/>       END AS cost_range<br/>FROM Dummy_Sales_Data_v1<br/><strong class="mz jd">ORDER BY cost_range DESC</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/20675879b7f5eeb0506a3b7c841b421c.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*xyEY5uu0WEJEImXo3LKobw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">SQL | Image中按作者降序排序的框</p></figure><p id="2a09" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">记录按<code class="fe pc pd pe mz b">cost_range</code>降序排列，介质在最上面，这是不正确的。❌</p><p id="2a60" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">正确的输出应该是顶部有高电平的行，后面是中电平和低电平的行。为了得到正确的结果，你需要聪明地命名你的箱子。✅</p><p id="6a1e" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">最简单的方法之一是，使用如下所示的数字。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="05dc" class="nd ne it mz b gy nf ng l nh ni">SELECT OrderID,<br/>  Shipping_Cost,<br/>  CASE WHEN Shipping_Cost &lt; 25 THEN <strong class="mz jd">'1. Low'</strong><br/>       WHEN Shipping_Cost BETWEEN 25 AND 32 THEN <strong class="mz jd">'2. Medium'</strong><br/>       WHEN Shipping_Cost &gt; 32 THEN <strong class="mz jd">'3. High'</strong><br/>  END AS cost_range<br/>FROM Dummy_Sales_Data_v1<br/>ORDER BY cost_range DESC</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qi"><img src="../Images/df53e16b9c852c790e9fca747e66dfee.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*V-UHb2YMh_UrJdH3p0VZTw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">SQL | Image中按作者降序排列的记录</p></figure><p id="862d" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">现在，你答对了。这里，请注意使用3，2，1对值进行重新排序。🎯</p><p id="2a39" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">接下来，不正确的列数据类型可能会成为数据提取和分析的一个重大障碍。让我们看看如何在SQL中处理它。</p><h1 id="74b8" class="nx ne it bd ny nz pi ob oc od pj of og ki pk kj oi kl pl km ok ko pm kp om on bi translated">正确的数据类型</h1><p id="bd55" class="pw-post-body-paragraph ly lz it ma b mb oo kd md me op kg mg mh oq mj mk ml or mn mo mp os mr ms ls im bi translated">在现实世界中，有时，列的数据类型没有准确地分配，或者最初分配的数据类型不再适用于您的任务。</p><p id="3e25" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">例如，日期-时间列通常存储为文本列，或者具有浮点值的列被赋予数据类型integer。</p><p id="3499" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">如果数据类型不正确，只提取数据类型可能不会有任何问题，但是，如果您希望连接两个表，并且两个表中公共列的数据类型不同，查询将返回错误。</p><p id="5c8c" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">❓那有什么解决办法..</p><blockquote class="li"><p id="7d2b" class="lj lk it bd ll lm lt lu lv lw lx ls dk translated">CAST函数！！！</p></blockquote><p id="4edc" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg mh mi mj mk ml mm mn mo mp mq mr ms ls im bi translated">在SQL中，<code class="fe pc pd pe mz b"><strong class="ma jd">CAST</strong></code>函数用于显式地将给定的数据类型转换为SQL数据库中的不同数据类型。它有最简单的语法，</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="c3ee" class="nd ne it mz b gy nf ng l nh ni">CAST(column_name AS new_data_type)</span></pre><p id="1c9f" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">其中<code class="fe pc pd pe mz b">column_name</code>是要更改其数据类型的列的名称。</p><p id="e13c" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">关于<code class="fe pc pd pe mz b">CAST</code>的一个有趣的事实是，它可以跨不同的数据库管理系统移植，比如微软SQL Server、MySQL、Oracle，并且在每一个系统上都可以工作。💯</p><p id="9faa" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">让我们快速浏览一个例子。</p><p id="9ac6" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">假设，您想要将<code class="fe pc pd pe mz b">Shipment_Cost</code>转换为float值，该值最初存储为整数。</p><pre class="ks kt ku kv gt my mz na nb aw nc bi"><span id="486b" class="nd ne it mz b gy nf ng l nh ni">SELECT Shipping_Cost,<br/>       <strong class="mz jd">CAST(Shipping_Cost AS REAL)</strong> AS Shipping_Cost_float<br/>FROM Dummy_Sales_Data_v1</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/5f9986686687320ad7951cac4765287d.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*wOE6wtTji22JA_IQ_qwA0A.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">要浮动的整数|按作者排序的图像</p></figure><p id="be72" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">很简单！</p><p id="2bd7" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">但是，它也有一些局限性。您不能简单地将列从一种数据类型转换为另一种数据类型。🚩</p><p id="05ff" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">例如，日期列不能转换为浮点型。两种数据类型——现有的和新的——本质上应该是相似的。</p><p id="f4db" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated"><strong class="ma jd">微软</strong>提供了一个有趣的图表，可以作为快速参考，了解哪些数据类型是相互兼容的，你可以从这里下载。</p><blockquote class="li"><p id="251f" class="lj lk it bd ll lm lt lu lv lw lx ls dk translated"><a class="ae lh" href="https://www.microsoft.com/en-us/download/details.aspx?id=35834" rel="noopener ugc nofollow" target="_blank">微软SQL Server数据类型转换图</a></p></blockquote><div class="qk ql qm qn qo ps"><a href="https://www.microsoft.com/en-us/download/details.aspx?id=35834" rel="noopener  ugc nofollow" target="_blank"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd jd gy z fp px fr fs py fu fw jc bi translated">SQL Server数据类型图表</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">阐释了SQL Server系统提供的数据类型所允许的所有显式和隐式数据类型转换。</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">www.microsoft.com</p></div></div><div class="qb l"><div class="qp l qd qe qf qb qg lb ps"/></div></div></a></div><p id="3681" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">仅此而已！🏆</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="552c" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">希望你很快看完这篇文章，觉得耳目一新，很有用。</p><p id="10d2" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">我使用SQL已经3年了，通过实践我发现了这些技巧。你可以随时让我知道，你还做了什么来清理数据。这些概念在实际项目中非常有用。</p><blockquote class="li"><p id="ad4e" class="lj lk it bd ll lm lt lu lv lw lx ls dk translated"><em class="qq">对阅读介质上的无限故事感兴趣？？</em></p></blockquote><p id="2eea" class="pw-post-body-paragraph ly lz it ma b mb mc kd md me mf kg mg mh mi mj mk ml mm mn mo mp mq mr ms ls im bi translated">💡考虑<a class="ae lh" href="https://medium.com/@17.rsuraj/membership" rel="noopener"> <strong class="ma jd">成为媒体会员</strong></a><strong class="ma jd">访问媒体上无限的</strong>故事和每日有趣的媒体文摘。我会得到你的费用的一小部分，没有额外的费用给你。</p><p id="3b08" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated">💡请务必<a class="ae lh" href="https://medium.com/subscribe/@17.rsuraj" rel="noopener"> <strong class="ma jd">注册我的电子邮件列表</strong> </a>以免错过另一篇关于数据科学指南、技巧和提示、SQL和Python的文章。</p><p id="3fa0" class="pw-post-body-paragraph ly lz it ma b mb mt kd md me mu kg mg mh mv mj mk ml mw mn mo mp mx mr ms ls im bi translated"><strong class="ma jd">感谢您的阅读！</strong></p></div></div>    
</body>
</html>