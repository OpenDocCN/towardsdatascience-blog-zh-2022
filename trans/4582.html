<html>
<head>
<title>A Collection of Must-Know Techniques for Working with Time Series Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中处理时间序列数据的必备技巧集合</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-collection-of-must-know-techniques-for-working-with-time-series-data-in-python-7c01d199b184#2022-10-12">https://towardsdatascience.com/a-collection-of-must-know-techniques-for-working-with-time-series-data-in-python-7c01d199b184#2022-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7c3a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何轻松操作和可视化日期时间格式的时间序列数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/af5eda2a45d4eaef82e1206ee0c5cb6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zv9LJcQ_M7EeMGp4eRwATQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">xsIJciJN的插图来自<a class="ae ky" href="https://en.ac-illust.com/clip-art/1891396" rel="noopener ugc nofollow" target="_blank">illustrtac</a></p></figure><p id="d212" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">起初，处理时间序列数据可能会令人生畏。时间序列值不是您需要考虑的唯一信息。时间戳还包含信息，尤其是关于值之间关系的信息。</p><blockquote class="lv"><p id="fa24" class="lw lx it bd ly lz ma mb mc md me lu dk translated">时间戳还包含信息，尤其是关于值之间关系的信息。</p></blockquote><p id="c63a" class="pw-post-body-paragraph kz la it lb b lc mf ju le lf mg jx lh li mh lk ll lm mi lo lp lq mj ls lt lu im bi translated">与常见的数据类型相比，时间戳有一些独特的特征。虽然乍一看它们像一个字符串，但它们也有数字方面。</p><p id="6776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将为您提供以下处理时间序列数据的必备技巧:</p><p id="bfaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如何处理日期时间格式</strong> <br/> ∘ <a class="ae ky" href="#bc83" rel="noopener ugc nofollow">读取日期时间格式</a> <br/> ∘ <a class="ae ky" href="#8fa5" rel="noopener ugc nofollow">将字符串转换为日期时间格式</a> <br/> ∘ <a class="ae ky" href="#768c" rel="noopener ugc nofollow">将Unix时间转换为日期时间格式</a> <br/> ∘ <a class="ae ky" href="#02a0" rel="noopener ugc nofollow">创建日期范围</a> <br/> ∘ <a class="ae ky" href="#6dbf" rel="noopener ugc nofollow">更改日期时间格式</a> <br/> <strong class="lb iu">如何合成并分解日期时间</strong> <br/> ∘ <a class="ae ky" href="#850c" rel="noopener ugc nofollow">分解日期时间</a> <br/> ∘ 填充缺失值 <br/> ∘ <a class="ae ky" href="#2ac8" rel="noopener ugc nofollow">用常数值填充缺失值</a> <br/> ∘ <a class="ae ky" href="#9bbc" rel="noopener ugc nofollow">用最后一个值填充缺失值</a> <br/> ∘ <a class="ae ky" href="#976f" rel="noopener ugc nofollow">用线性插值填充缺失值</a> <br/> <strong class="lb iu">如何对时间序列执行运算</strong> <br/> ∘ <a class="ae ky" href="#6f87" rel="noopener ugc nofollow">获取最小值和最大值</a> <br/> ∘ <a class="ae ky" href="#c224" rel="noopener ugc nofollow">求差</a> <br/> ∘ <a class="ae ky" href="#c3c8" rel="noopener ugc nofollow">累积</a><a class="ae ky" href="#c3c8" rel="noopener ugc nofollow"> 两个时间戳之间的时间差</a> <br/> <strong class="lb iu">如何过滤时间序列</strong> <br/> ∘ <a class="ae ky" href="#0ad5" rel="noopener ugc nofollow">过滤特定时间戳上的时间序列</a> <br/> ∘ <a class="ae ky" href="#4c8c" rel="noopener ugc nofollow">过滤时间范围上的时间序列</a> <br/> <strong class="lb iu">如何对时间序列进行重采样</strong> <br/> ∘ <a class="ae ky" href="#2bf9" rel="noopener ugc nofollow">下采样</a> <br/> ∘ <a class="ae ky" href="#7efb" rel="noopener ugc nofollow">上采样</a> <br/> <strong class="lb iu"> 绘制时间线 <br/> ∘ <a class="ae ky" href="#f323" rel="noopener ugc nofollow">设置时间序列的x轴限值</a> <br/> ∘ <a class="ae ky" href="#1f87" rel="noopener ugc nofollow">设置时间序列的x轴刻度</a></strong></p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="9ad5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于本文，我们将使用一个最小的虚构数据集。它有三列:<code class="fe mr ms mt mu b">date</code>、<code class="fe mr ms mt mu b">cat_feature</code>和<code class="fe mr ms mt mu b">num_feature</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/94a3839a11047ca072ff06ab7636006c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwqDsGv8Ofdx72ubkPfUQw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">虚构的最小时间序列数据集作为pandas DataFrame加载(图片由作者提供)</p></figure><h1 id="d611" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">如何处理日期时间格式</h1><p id="18cd" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">时间序列数据的基本部分是时间戳。如果这些时间戳采用<a class="ae ky" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" rel="noopener ugc nofollow" target="_blank"> Datetime </a>格式，您可以应用各种操作，我们将在本节中讨论。</p><h2 id="bc83" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">读取日期时间格式</h2><p id="b8d4" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">默认情况下，当从CSV文件中读取时，pandas将时间戳列作为字符串读入DataFrame。要将时间戳列作为<a class="ae ky" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" rel="noopener ugc nofollow" target="_blank"> datetime </a>对象(数据类型为<code class="fe mr ms mt mu b">datetime64[ns]</code>)直接读取，可以使用<code class="fe mr ms mt mu b">parse_date</code>参数，如下所示。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="1c5e" class="nt mx it mu b gy oj ok l ol om">import pandas as pd</span><span id="49fe" class="nt mx it mu b gy on ok l ol om">df = pd.read_csv("example.csv", <br/>                 <strong class="mu iu">parse_dates = ["date"]</strong>) </span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/94a3839a11047ca072ff06ab7636006c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwqDsGv8Ofdx72ubkPfUQw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">虚构的最小时间序列数据集作为pandas DataFrame加载(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/4dd0a76440f0f3cf9608bd26ebdd762c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5K0KJepZ-h0nBDQap7cZLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间戳的数据类型为datetime64[ns](图片由作者提供)</p></figure><h2 id="8fa5" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">将字符串转换为日期时间</h2><p id="29d0" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">要将字符串转换成<code class="fe mr ms mt mu b">datetime64[ns]</code>格式，可以使用<code class="fe mr ms mt mu b"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.to_datetime.html" rel="noopener ugc nofollow" target="_blank">.to_datetime()</a></code>方法。如果在导入过程中不能使用<code class="fe mr ms mt mu b">parse_dates</code>参数，这很方便。可以查一下相关的<code class="fe mr ms mt mu b"><a class="ae ky" href="https://strftime.org/" rel="noopener ugc nofollow" target="_blank">strftime</a> </code>格式。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="b26f" class="nt mx it mu b gy oj ok l ol om"># By default the date column is imported as string<br/>df = pd.read_csv("example.csv")</span><span id="2785" class="nt mx it mu b gy on ok l ol om"># Convert to datetime data type<br/>df["date"] = pd.to_datetime(df["date"], <br/>                            <strong class="mu iu">format = "%Y-%m-%d %H:%M:%S.%f"</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/94a3839a11047ca072ff06ab7636006c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwqDsGv8Ofdx72ubkPfUQw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">虚构的最小时间序列数据集作为pandas DataFrame加载(图片由作者提供)</p></figure><h2 id="768c" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">将Unix时间转换为日期时间格式</h2><p id="755b" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">如果您的时间戳列是Unix时间，那么您可以通过使用<code class="fe mr ms mt mu b">unit</code>参数，使用<code class="fe mr ms mt mu b"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.to_datetime.html" rel="noopener ugc nofollow" target="_blank">.to_datetime()</a></code>方法将其转换为人类可读的格式。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="29dd" class="nt mx it mu b gy oj ok l ol om"># Convert from unix<br/>df["date"] = pd.to_datetime(df["date_unix"], <br/>                                 <strong class="mu iu">unit = "s"</strong>)</span><span id="4d7b" class="nt mx it mu b gy on ok l ol om"># Convert to unix<br/>df["date_unix"] = df["date"]<strong class="mu iu">.view('int64')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/2f18e722356750f201f2b56194e55897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QoIluoEFhg2i9Ye_BL3F2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间戳转换为unix(图片由作者提供)</p></figure><h2 id="02a0" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">创建日期范围</h2><p id="0433" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">如果要创建一个日期范围，有两种选择:</p><ul class=""><li id="512b" class="oo op it lb b lc ld lf lg li oq lm or lq os lu ot ou ov ow bi translated">用开始日期和结束日期定义日期范围</li><li id="0682" class="oo op it lb b lc ox lf oy li oz lm pa lq pb lu ot ou ov ow bi translated">用开始日期、频率(例如，每天、每月等)定义日期范围。)，以及周期数。</li></ul><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="e573" class="nt mx it mu b gy oj ok l ol om">df["date"] = pd.date_range(start = "2022-01-01", <br/>                           end = "2022-12-31")</span><span id="2798" class="nt mx it mu b gy on ok l ol om">df["date"] = pd.date_range(start = "2022-01-01", <br/>                           periods = 365, <br/>                           freq = "D")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/81dd00766fed6d48898efffc5f35e246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EL9My5mBfHp8-_5R_TGSw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫系列的一系列日期(图片由作者提供)</p></figure><h2 id="6dbf" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">更改日期时间格式</h2><p id="1933" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">要更改时间戳格式，您可以使用<code class="fe mr ms mt mu b"><a class="ae ky" href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior" rel="noopener ugc nofollow" target="_blank">.strftime()</a></code>方法。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="1b05" class="nt mx it mu b gy oj ok l ol om"># Example: Change "2022-01-01" to "January 1, 2022"<br/>df["date"] = df["date"].dt.strftime("%b %d, %Y")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/a587e00ddc0cbd3c256c0b3a1c8f998a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qG-bDG5k_8Or9kzGh7DNGg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用strftime更改了datetime格式(图片由作者提供)</p></figure><h1 id="7b61" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">如何合成和分解日期时间</h1><p id="02d8" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">时间戳由许多东西组成，比如日期或时间，或者更细粒度的东西，比如小时或分钟。这一节将讨论如何将日间数据类型分解成它的组成部分，以及如何从包含时间戳组成部分的不同列组成一个<a class="ae ky" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" rel="noopener ugc nofollow" target="_blank">日期时间</a>数据类型。</p><h2 id="850c" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">分解日期时间</h2><p id="9348" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">当您有日期和时间戳时，您可以将它们分解成它们的组成部分，如下所示。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="2098" class="nt mx it mu b gy oj ok l ol om"># Splitting date and time<br/>df["dates"] = df["date"].dt.date<br/>df["times"] = df["date"].dt.time</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/d1938cd79abfbb4ec28580fa783a6b16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fU13rHTrrRjsMnkXPltJHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间戳分解为日期和时间(图片由作者提供)</p></figure><p id="16e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以将它分解成更小的组件，如下所示。您可以在<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DatetimeIndex.html" rel="noopener ugc nofollow" target="_blank"> pandas DatetimeIndex文档</a>中找到更多可能的组件。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="ed95" class="nt mx it mu b gy oj ok l ol om"># Creating datetimeindex features<br/>df["year"] = df["date"].dt.year<br/>df["month"] = df["date"].dt.month<br/>df["day"] = df["date"].dt.day<br/># etc.</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/6d40abf40dcee36be16fde16ee4ff551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yz4fhgDMEk2Mb5gEYs-R8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间戳分解为年、月和日(图片由作者提供)</p></figure><h2 id="99bb" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">将多个列组合成一个日期时间</h2><p id="b02f" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">如果您想从年、月和日等组成部分组装一个日期列，也可以使用<code class="fe mr ms mt mu b"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.to_datetime.html" rel="noopener ugc nofollow" target="_blank">.to_datetime()</a></code>方法。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="d1c4" class="nt mx it mu b gy oj ok l ol om">df["date"] = pd.to_datetime(df[["year", "month", "day"]])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/b19f389b3118568745e31ad892fdf83c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdKUk8SVV59byVXfDmg4zg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将多个列组合成一个日期时间(图片由作者提供)</p></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="55f1" class="mw mx it bd my mz pc nb nc nd pd nf ng jz pe ka ni kc pf kd nk kf pg kg nm nn bi translated">如何填充缺失值</h1><p id="9a07" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">无论是处理数值、分类还是时间序列数据，填充缺失值都是一项挑战。本节将探讨三种方法来填充时间序列数据中的缺失值。</p><h2 id="2ac8" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">用常数值填充缺失值</h2><p id="7faa" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">一种方法是使用<code class="fe mr ms mt mu b">.fillna()</code>方法用常量值填充缺失值。通常，这样的常数值可以是时间序列的平均值或异常值，如-1或999。然而，用常数值填充缺失值通常是不够的。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="cd2c" class="nt mx it mu b gy oj ok l ol om">df["num_feature"] = df["num_feature"].fillna(0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/2c768cb66c5c6ba6c149f4f39be7945c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LvRVfPw0pFRCEYPmgSJifA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用常数值填充缺失值(图片由作者通过<a class="ae ky" href="https://www.kaggle.com/code/iamleonie/intro-to-time-series-forecasting#Data-Preprocessing" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>提供)</p></figure><h2 id="9bbc" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">用最后一个值填充缺失值</h2><p id="6810" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">另一种方法是使用<code class="fe mr ms mt mu b">.ffill()</code>方法用最后一个可用的值来填充缺失的值。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="5a55" class="nt mx it mu b gy oj ok l ol om">df["num_feature"] = df["num_feature"].ffill()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/2a3d70987056302cc3c22d5e50f3fd22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuMMIv4PNvZ4dVa0ZFujSA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用最后一个值填充缺失值(图片由作者通过<a class="ae ky" href="https://www.kaggle.com/code/iamleonie/intro-to-time-series-forecasting#Data-Preprocessing" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>提供)</p></figure><h2 id="976f" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">用线性插值填充缺失值</h2><p id="deea" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">处理缺失值的一个好方法通常是用<code class="fe mr ms mt mu b">.interpolate()</code>方法对缺失值进行线性插值。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="6983" class="nt mx it mu b gy oj ok l ol om">df["num_feature"] = df["num_feature"].interpolate()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/55fc895864e4c1f98606477b6fce38a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bc3aGdFb8bBcBb1nWWmoyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用线性插值填充缺失值(图片由作者通过<a class="ae ky" href="https://www.kaggle.com/code/iamleonie/intro-to-time-series-forecasting#Data-Preprocessing" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>提供)</p></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="4b82" class="mw mx it bd my mz pc nb nc nd pd nf ng jz pe ka ni kc pf kd nk kf pg kg nm nn bi translated">如何对时间序列执行操作</h1><p id="b54d" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">您可以对时间序列数据执行各种操作，这将在本节中讨论。</p><h2 id="6f87" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">获取最小值和最大值</h2><p id="c7d6" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">在许多情况下，了解时间序列的开始或结束日期会很有帮助。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="fc3c" class="nt mx it mu b gy oj ok l ol om">df["date"].min()<br/>df<!-- -->["date"].max()</span></pre><h2 id="c224" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">区别</h2><p id="5700" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">差分是指取时间序列中两个连续值的差。为此，您可以使用<code class="fe mr ms mt mu b">.diff()</code>方法。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="c869" class="nt mx it mu b gy oj ok l ol om">df["num_feature_diff"] = df["num_feature"].diff()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/34238f2d518f04de56a07fae27795bd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*jVOwnFhQSBOlNxtfr7Jo1g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间序列数据的差异(图片由作者提供)</p></figure><h2 id="c3c8" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">累积</h2><p id="3e9e" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">与差分相反的是用<code class="fe mr ms mt mu b">.cumsum()</code>方法累加时间序列的值。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="47c9" class="nt mx it mu b gy oj ok l ol om">df["num_feature_cumsum"] = df["num_feature"].cumsum()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/651f2c6ea10b1d8ffcd6bf62f333098f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*wlJayoAxLa6g4X9Yf_lRiA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间序列数据的累积(图片由作者提供)</p></figure><h2 id="c5a9" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">获取滚动平均值</h2><p id="414a" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">有时你需要时间序列的滚动平均值。您可以使用<code class="fe mr ms mt mu b">.rolling()</code>方法，它接受一个在滚动窗口中要考虑的值的数量的参数。在下面的例子中，我们取三个值的平均值。所以前两行是空的，第三行是前三行的平均值。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="a8bc" class="nt mx it mu b gy oj ok l ol om">df["num_feature_mean"] = df["num_feature"].rolling(3).mean()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/7ae2b637652d9a4f071b663e72d2b31f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*5HaVzvGLudkGovdrqTNI_A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间序列数据的滚动平均值(图片由作者提供)</p></figure><h2 id="fd85" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">计算两个时间戳之间的时间差</h2><p id="f594" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">有时候你需要计算两个时间戳之间的时间差。例如，如果您可能需要计算特定日期的时差。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="9545" class="nt mx it mu b gy oj ok l ol om">df["time_since_start"] = df["date"] - df["date"].min()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/4abe0fd46fa5d442147f0d72c824ce5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*Ovyb7yhLkZJit4t7o5CZ9Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间戳和第一个时间戳的时间差(图片由作者提供)</p></figure><p id="1a63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者想知道时间戳是否是等距离分布的。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="31ed" class="nt mx it mu b gy oj ok l ol om">df["timestamp_difference"] = df["date"].diff()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/c5affbaad3f50daaea764bc258815214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*UKrA38EgmKLyJdznUQs-CA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间戳之间的时间差(图片由作者提供)</p></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="00c3" class="mw mx it bd my mz pc nb nc nd pd nf ng jz pe ka ni kc pf kd nk kf pg kg nm nn bi translated">如何过滤时间序列</h1><p id="59ab" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">处理时间序列数据时，您可能需要在特定时间对其进行过滤。要过滤时序数据，<strong class="lb iu">必须将日期列设置为索引</strong>。一旦有了时间戳索引，就可以在特定的日期甚至特定的时间范围内填写。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="63f4" class="nt mx it mu b gy oj ok l ol om">df = df.set_index(["date"])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/bdb951fefdd191a30537a837f843c4b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xVa9YZI1XZ3f_4sljIdeDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">以时间戳为索引的时间序列数据的数据框架(图片由作者提供)</p></figure><h2 id="0ad5" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">根据特定时间戳过滤时间序列</h2><p id="e474" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">当您将时间戳设置为熊猫数据帧的索引时，您可以使用<code class="fe mr ms mt mu b">loc</code>轻松过滤特定的时间戳。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="a034" class="nt mx it mu b gy oj ok l ol om">df.loc["2020-03-30"]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/efc1450d6c6f5afa9b8d3a325a4d1c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KoNBIAaC-QcqqHXwHnrySg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">过滤的某一日期的tme系列(图片由作者提供)</p></figure><h2 id="4c8c" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">按时间范围过滤时间序列</h2><p id="1aa5" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">与上面过滤特定时间戳的例子类似，当时间戳被设置为pandas数据帧的索引时，您也可以使用<code class="fe mr ms mt mu b">loc</code>过滤时间范围。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="d7e1" class="nt mx it mu b gy oj ok l ol om">df.loc["2020-04-10":"2020-04-15"]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/8ec8b84c0e25b335f38bc1f5f0cfca41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9yS36KtDiMnMWlFUya0OQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在某一日期范围内过滤的tme系列(图片由作者提供)</p></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="7104" class="mw mx it bd my mz pc nb nc nd pd nf ng jz pe ka ni kc pf kd nk kf pg kg nm nn bi translated">如何对时间序列进行重采样</h1><p id="ff72" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">重采样可以提供数据的附加信息。有两种类型的重采样:</p><h2 id="2bf9" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">向下采样</h2><p id="bf44" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">下采样是指降低采样频率(例如，从几秒到几个月)。可以用<code class="fe mr ms mt mu b">.resample()</code>的方法。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="8ef7" class="nt mx it mu b gy oj ok l ol om">upsampled = df.resample("M")["num_feature"].mean()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/3bc9de6752aa3057fb8df99e75511e0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*NsuD_uGSX5uCd8t9qkluXw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每月重新采样(缩减采样)值系列(图片由作者提供)</p></figure><h2 id="7efb" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">上采样</h2><p id="a6b2" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">上采样是指增加采样频率(例如，从几个月到几天)。同样，你可以使用<code class="fe mr ms mt mu b">.resample()</code>方法。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="b14e" class="nt mx it mu b gy oj ok l ol om">upsampled.resample("D").interpolate(method = "linear")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/2d013bf68654c072568a6527adb8cb29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*AjVssV2uz_jBKbCcXTNosg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一系列每日重采样(上采样)值(图片由作者提供)</p></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="45cc" class="mw mx it bd my mz pc nb nc nd pd nf ng jz pe ka ni kc pf kd nk kf pg kg nm nn bi translated">如何绘制时间序列</h1><p id="1244" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">本节将讨论如何使用Matplotlib和Seaborn可视化数字和分类时间序列数据。除了<code class="fe mr ms mt mu b">pyplot</code>模块，我们将使用<code class="fe mr ms mt mu b">dates</code>模块探索不同的可视化技术。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="94d6" class="nt mx it mu b gy oj ok l ol om">import matplotlib.pyplot as plt<br/>import matplotlib.dates as mdates<br/>import seaborn as sns</span></pre><p id="ed6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了直观显示时间序列的时间顺序，图中的x轴通常表示时间，y轴表示值。</p><h2 id="d83e" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">绘制一段时间内的数字数据</h2><p id="bb70" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">大多数时间序列数据是数字的，例如温度或股票价格数据。要可视化数字时间序列数据，可以使用折线图。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="0eab" class="nt mx it mu b gy oj ok l ol om">sns.lineplot(data = df, <br/>             x = "date", <br/>             y = "num_feature")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/713c7905e48e8826944e776aead42952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPlr_4vrLwGVJeMiWTjHpQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数字时间序列数据的折线图(图片由作者提供)</p></figure><h2 id="6415" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">绘制一段时间内的分类数据</h2><p id="1b35" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">有时时间序列数据可以是分类的，例如，跟踪不同事件的发生。</p><p id="9180" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在绘制数据之前，您可以对分类列进行标签编码，例如，通过使用<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" rel="noopener ugc nofollow" target="_blank"> LabelEncoder </a>或简单的字典，如下所示。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="cc8f" class="nt mx it mu b gy oj ok l ol om"># Label encode the categorical column<br/>enum_dict = {}<br/>for i, cat in enumerate(df.cat_feature.unique()):<br/>    enum_dict[cat] = i</span><span id="b82b" class="nt mx it mu b gy on ok l ol om">df["cat_feature_enum] = df["cat_feature"].replace(enum_dict)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/1ac4946acc89aa0f37428ec149ba736c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*g1UsTuUjLeukrAQj1Gxc_A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将编码特征“cat_feature”标注为“cat_feature_enum”(图片由作者提供)</p></figure><p id="a5b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要可视化分类时间序列数据，可以使用散点图。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="6261" class="nt mx it mu b gy oj ok l ol om">fig, ax = plt.subplots(figsize=(8, 4))</span><span id="d039" class="nt mx it mu b gy on ok l ol om">sns.scatterplot(data = df,<br/>                x = "date", <br/>                y = "cat_feature_enum", <br/>                hue = "cat_feature",<br/>                marker = '.',<br/>                linewidth = 0,<br/>                )</span><span id="8042" class="nt mx it mu b gy on ok l ol om">ax.set_yticks(np.arange(0, (len(df.cat_feature.unique()) + 1), 1))<br/>ax.set_yticklabels(df.cat_feature.unique())<br/>ax.get_legend().remove() # remove legend - it's not necessary here</span><span id="46bd" class="nt mx it mu b gy on ok l ol om">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/e75fa5cfef650413986672de88c56ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wHRLc_kzDL-F54rgbhhX0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有散点图的分类时间序列数据的事件图(图片由作者提供)</p></figure><p id="a382" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也可以试试<a class="ae ky" href="https://matplotlib.org/stable/gallery/lines_bars_and_markers/eventplot_demo.html" rel="noopener ugc nofollow" target="_blank"> Matplotlib的eventplot演示</a>。</p><h2 id="56cb" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">绘制时间表</h2><p id="89b4" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">为了绘制时间线，我们将使用上一节的标签编码分类值和<code class="fe mr ms mt mu b">vlines</code>。</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="5836" class="nt mx it mu b gy oj ok l ol om">fig, ax = plt.subplots(figsize=(8, 4))</span><span id="0880" class="nt mx it mu b gy on ok l ol om">ax.vlines(df["date"], 0, df["cat_feature_enum"])</span><span id="61a4" class="nt mx it mu b gy on ok l ol om">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/a7f84d64b392500968cb3e3e91804ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*szHq_k-IbBEIHiQqFC7piw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有vlines的分类时间序列数据的时间线图(图片由作者提供)</p></figure><h2 id="f323" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">设置时间序列的X轴限制</h2><p id="85f0" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">当您想要设置时间序列图的x轴界限时，范围必须是<code class="fe mr ms mt mu b">datetime64[ns]</code>数据类型。</p><p id="7bd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可以使用时间序列的最小和最大时间戳:</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="ecb0" class="nt mx it mu b gy oj ok l ol om">ax.set_xlim([df.date.min(), df.date.max()])</span></pre><p id="794b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者您可以指定一个自定义范围，如下所示:</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="bf0c" class="nt mx it mu b gy oj ok l ol om">ax.set_xlim(np.array(["2020-04-01", "2020-04-30"],<br/>                      dtype="datetime64"))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/4052780200835ba40373adb4b053234f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjw9jXaPRnPD4p2B0X_CFg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">调整后的x轴范围(图片由作者提供)</p></figure><h2 id="1f87" class="nt mx it bd my nu nv dn nc nw nx dp ng li ny nz ni lm oa ob nk lq oc od nm oe bi translated">设置时间序列的X刻度</h2><p id="9f80" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">为了提高数据可视化的可读性，您可以在特定的时间间隔(例如，每周、每月、每年等)添加主要和次要x刻度。)</p><pre class="kj kk kl km gt of mu og oh aw oi bi"><span id="f50a" class="nt mx it mu b gy oj ok l ol om">ax.xaxis.set_major_locator(mdates.MonthLocator())<br/>ax.xaxis.set_major_formatter(mdates.DateFormatter("%b %d"));<br/>ax.xaxis.set_minor_locator(mdates.DayLocator())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/1b4f24d207d49543b9f4d97e6effc9fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHXMnAEeURGkdtdxs6hAcQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义x轴刻度(图片由作者提供)</p></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="43ae" class="mw mx it bd my mz pc nb nc nd pd nf ng jz pe ka ni kc pf kd nk kf pg kg nm nn bi translated">结论</h1><p id="e386" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">当您不熟悉<a class="ae ky" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" rel="noopener ugc nofollow" target="_blank">日期时间</a>数据类型时，开始处理时间序列数据可能会很有挑战性。如您所见，<a class="ae ky" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" rel="noopener ugc nofollow" target="_blank">日期时间</a>数据类型有许多实用的内置方法，可以轻松操作时间序列数据。本文讨论了从操作时间序列值的时间戳和有价值的操作到可视化时间序列数据的所有内容。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ed51" class="mw mx it bd my mz pc nb nc nd pd nf ng jz pe ka ni kc pf kd nk kf pg kg nm nn bi translated">喜欢这个故事吗？</h1><p id="ae97" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated"><em class="pk">以下是我其他时间序列分析和预测文章的合集:</em></p><div class="pl pm gp gr pn"><div role="button" tabindex="0" class="ab bv gv cb fp po pp bn pq ks ex"><div class="pr l"><div class="ab q"><div class="l di"><img alt="Leonie Monigatti" class="l de bw ps pt fe" src="../Images/61f354281722566e5c755e2cf181514f.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*TTIl4oynrJyfIkLbC6fumA.png"/><div class="fb bw l ps pt fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated">莉奥妮·莫尼加蒂</p></div></div><div class="pw px gw l"><h2 class="bd iu vn oo fp vo fr fs qv fu fw is bi translated">时间序列分析和预测</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi vp au vq vr vs se vt an eh ei vu vv vw el em eo de bk ep" href="https://medium.com/@iamleonie/list/time-series-analysis-and-forecasting-ff223343e5b3?source=post_page-----7c01d199b184--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="vx l fo"><span class="bd b dl z dk">6 stories</span></div></div></div><div class="qj dh qk fp ab ql fo di"><div class="di qb bv qc qd"><div class="dh l"><img alt="Hierarchical time series forecasting" class="dh" src="../Images/4bb5c99058251c4c4d0c2dbd429c6a49.png" width="194" height="194" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*CmvIoCBjwqFAtcuKfFZDqQ@2x.jpeg"/></div></div><div class="di qb bv qe qf qg"><div class="dh l"><img alt="GIF created with Matplotlib and imageio" class="dh" src="../Images/abc6639dcdc3f96a50cebc7d09560695.png" width="194" height="194" loading="lazy" data-original-src="https://miro.medium.com/v2/da:true/resize:fill:388:388/1*LMtJAdt9SffpKRQPyhckGA.gif"/></div></div><div class="di bv qh qi qg"><div class="dh l"><img alt="A time series with lines indicating trend and variance for time series analysis. The last three data points are in a contrast color to indicate that they are predicted values from the time series forecasting model" class="dh" src="../Images/ac9f4944cc2d98de3172e5cc0f2daac2.png" width="194" height="194" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*41Vdmjh7lCeD2bpHbI1JEw.png"/></div></div></div></div></div><p id="b6ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pk">如果你想把我的新故事直接发到你的收件箱，请务必订阅</em><a class="ae ky" href="https://medium.com/subscribe/@iamleonie" rel="noopener"><em class="pk"/></a><em class="pk">！</em></p><p id="e677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pk">成为媒介会员，阅读更多来自我和其他作家的故事。报名时可以使用我的</em> <a class="ae ky" href="https://medium.com/@iamleonie/membership" rel="noopener"> <em class="pk">推荐链接</em> </a> <em class="pk">支持我。我将收取佣金，不需要你额外付费。</em></p><div class="pl pm gp gr pn qp"><a href="https://medium.com/@iamleonie/membership" rel="noopener follow" target="_blank"><div class="qq ab fo"><div class="qr ab qs cl cj qt"><h2 class="bd iu gy z fp qu fr fs qv fu fw is bi translated">通过我的推荐链接加入Medium—Leonie Monigatti</h2><div class="qw l"><h3 class="bd b gy z fp qu fr fs qv fu fw dk translated">阅读Leonie Monigatti(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接…</h3></div><div class="qx l"><p class="bd b dl z fp qu fr fs qv fu fw dk translated">medium.com</p></div></div><div class="qy l"><div class="qz l ra rb rc qy rd ks qp"/></div></div></a></div><p id="c115" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pk">在</em> <a class="ae ky" href="https://twitter.com/helloiamleonie" rel="noopener ugc nofollow" target="_blank"> <em class="pk"> Twitter上找我</em></a><em class="pk"/><a class="ae ky" href="https://www.linkedin.com/in/804250ab/" rel="noopener ugc nofollow" target="_blank"><em class="pk">LinkedIn</em></a><em class="pk">和</em><a class="ae ky" href="https://www.kaggle.com/iamleonie" rel="noopener ugc nofollow" target="_blank"><em class="pk">Kaggle</em></a><em class="pk">！</em></p></div></div>    
</body>
</html>