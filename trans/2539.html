<html>
<head>
<title>5 Practical SQL Queries You Should Know In 2022</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2022年你应该知道的5个实用SQL查询</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-practical-sql-queries-you-should-know-in-2022-11b428560a30#2022-06-02">https://towardsdatascience.com/5-practical-sql-queries-you-should-know-in-2022-11b428560a30#2022-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d6b8" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学</h2><div class=""/><div class=""><h2 id="eb0b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">快速掌握这些省时且强大的SQL查询</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/14899f4278a4b23df27b09f700ea3625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSoLGNhAyRONIjza-MSxMQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@luiscortestamez?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">路易斯·科尔特斯</a>在<a class="ae lh" href="https://unsplash.com/s/photos/five?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8bb1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> SQL无处不在！</strong>💯</p><p id="0740" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">SQL或结构化查询语言是任何数据专业人员的必备工具，如数据工程师、分析师或数据科学家或任何与数据打交道的人。</p><p id="f1b8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了有效地获得干净和所需的数据，了解不同的SQL查询和操作符是绝对必要的。因此，我列出了5个SQL查询，并附有例子和解释，你应该在2022年知道。</p><p id="9d48" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我把这篇文章写得很短，这样您就可以快速地完成它，并掌握最有用、最省时的SQL技巧。🏆</p><p id="2432" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您可以使用此索引快速导航到您最喜欢的部分。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="ae91" class="mj mk it mf b gy ml mm l mn mo"><strong class="mf jd">· </strong><a class="ae lh" href="#87df" rel="noopener ugc nofollow"><strong class="mf jd">How to Find Duplicate Values in SQL</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#3b2c" rel="noopener ugc nofollow"><strong class="mf jd">How to avoid duplicates and select unique rows</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#d55a" rel="noopener ugc nofollow"><strong class="mf jd">How to display Nth row in the data table</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#f65c" rel="noopener ugc nofollow"><strong class="mf jd">How to compute the cumulative total</strong></a><strong class="mf jd"><br/>· </strong><a class="ae lh" href="#4750" rel="noopener ugc nofollow"><strong class="mf jd">How to select words where a specific letter is at specific position</strong></a></span></pre><blockquote class="mp mq mr"><p id="2048" class="li lj ms lk b ll lm kd ln lo lp kg lq mt ls lt lu mu lw lx ly mv ma mb mc md im bi translated">📍注意:我使用的是SQLite DB浏览器和自己创建的<a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/Dummy_Sales_Data_v1.csv" rel="noopener ugc nofollow" target="_blank"> Dummy_Sales_Data </a>，你可以在我的<a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/Dummy_Sales_Data_v1.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> Github </strong> </a> repo上免费获得！</p></blockquote><p id="5521" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">好了，我们开始吧…🚀</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="b6a8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，让我向您展示数据是怎样的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/d9dfce1c43b8e82b8f2a3877d29833b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRPrnLn48nDyv8HyZn8Tlg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">虚拟销售数据|作者图片</p></figure><p id="5c5a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是一个简单的9999 x 11数据集，是我在文章<a class="ae lh" rel="noopener" target="_blank" href="/faker-an-amazing-and-insanely-useful-python-library-b313a60bdabf"> <strong class="lk jd"> Faker:一个令人惊叹且极其有用的Python库</strong> </a> <strong class="lk jd">中创建的。</strong>📚</p><p id="18ee" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">📚您可以使用这个<a class="ae lh" href="https://github.com/17rsuraj/data-curious/blob/master/TowardsDataScience/TDS.sqlite3" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> SQLite数据库</strong> </a>来跟踪本文中的查询。</p><h1 id="87df" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">如何在SQL中查找重复值</h1><p id="4968" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">在数据集中发现重复主要是关于质量检查和数据验证。</p><p id="3ccb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在处理数据处理任务时，您可能会在数据集中遇到重复的行。如果没有提前处理好，这些重复的值会打乱整个计算。</p><p id="8db0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">SQL提供了一个简单的解决方案，使用<code class="fe oa ob oc mf b"><strong class="lk jd">GROUP BY</strong></code>和<code class="fe oa ob oc mf b"><strong class="lk jd">HAVING</strong></code>来识别和消除重复值。✅</p><p id="9eb3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在进入查询之前，非常重要的一步是定义重复项。</p><p id="b61b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">📌您需要定义哪些值/列的组合可以被认为是重复的。这完全取决于您的数据集和您正在执行的任务。</p><p id="7e81" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，在我们的数据集中查找单个列<em class="ms"> Sales_Manager </em>中的重复值。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="d961" class="mj mk it mf b gy ml mm l mn mo">SELECT Sales_Manager, COUNT(*)<br/>FROM Dummy_Sales_Data_v1<br/><strong class="mf jd">GROUP BY</strong> Sales_Manager<br/><strong class="mf jd">HAVING COUNT(*)&gt;1</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/7f3b585403064db3920842d56b25027d.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*pn87jKcqZbyQxlG6EhGloQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">单列重复|按作者排序的图像</p></figure><p id="6f39" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面代码的最后一行，<code class="fe oa ob oc mf b"><strong class="lk jd">HAVING COUNT(*)&gt;1</strong></code> <strong class="lk jd"> </strong>我们指定了识别重复项的条件。这意味着，每当列中的特定值在数据集中出现不止一次时，它就是重复的。</p><p id="04de" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们看另一个场景..</p><p id="84c9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">考虑到列<em class="ms"> Sales_Manager </em>、<em class="ms"> Shipping_Address </em>、Status中的值组合重复，作为重复行。</p><p id="ac4b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里应用了相同的逻辑，只是您需要在SELECT语句和GROUP BY子句中提到所有的列名。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="7586" class="mj mk it mf b gy ml mm l mn mo">SELECT <strong class="mf jd">Sales_Manager,<br/>       Shipping_Address,<br/>       Status,</strong><br/>       COUNT(*)<br/>FROM Dummy_Sales_Data_v1<br/>GROUP BY <strong class="mf jd">Sales_Manager,<br/>         Shipping_Address,<br/>         Status</strong><br/>HAVING COUNT(*)&gt;1</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/a773c28f0c6cfb63beb44544bd4fd30c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*xTXlHhaZeVyG5dbkPMyrjg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用SQL | Image by Author在数据集中查找重复的行</p></figure><p id="6af9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里，生成最后一列— <em class="ms"> COUNT(*) </em>只是为了提供信息。即使不包括该列，查询仍然有效。</p><p id="8fd2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用该查询可以回答的另一个有趣的问题是—特定记录在数据集中出现了多少次。</p><p id="e1d6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">同时，这个查询也可以用来了解数据集中有多少以及哪些是不重复的记录。你所需要做的就是简单地让having子句中的<code class="fe oa ob oc mf b">COUNT(*)</code>等于1，作为<code class="fe oa ob oc mf b"><strong class="lk jd">HAVING COUNT(*)=1</strong></code> <strong class="lk jd"> </strong>。</p><p id="af94" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在识别出重复行之后，您可能希望只保留重复行的一个外观。下一个查询解释了如何做到这一点。</p><h1 id="3b2c" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">如何避免重复并选择唯一的行</h1><p id="2917" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">一旦确定了重复的行，并且希望每行只出现一次，就在select语句中使用<code class="fe oa ob oc mf b"><strong class="lk jd">DISTINCT</strong></code>,如下所示。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="63d9" class="mj mk it mf b gy ml mm l mn mo">SELECT <strong class="mf jd">DISTINCT</strong> Sales_Manager,<br/>                Shipping_Address,<br/>                Status<br/>FROM Dummy_Sales_Data_v1<br/>GROUP BY Sales_Manager,<br/>         Shipping_Address,<br/>         Status</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi of"><img src="../Images/a83ad9db84d36edaba72053d59122511.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*zyYtpQa5sTdlYRqyaBspmw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用DISTINCT | Image by Author在数据集中选择唯一的行</p></figure><p id="c309" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于<code class="fe oa ob oc mf b">DISTINCT</code>使得查询只返回唯一的记录，所以它有时会被错误地用来隐藏错误查询(比如不正确的SQL连接)产生的重复记录。</p><blockquote class="mp mq mr"><p id="047f" class="li lj ms lk b ll lm kd ln lo lp kg lq mt ls lt lu mu lw lx ly mv ma mb mc md im bi translated">📌最好的办法是在你使用<code class="fe oa ob oc mf b">DISTINCT</code>的时候提一个评论，并在那里提到使用<code class="fe oa ob oc mf b">DISTINCT</code>的原因。</p></blockquote><p id="abbe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">实现这一点的另一种方法是定义一个或多个标准，这通常是计算的形式，例如包括某一列的最小值、最大值。</p><p id="e375" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，只保留重复行的一个外观，其中<em class="ms"> Shipping_Cost </em>最小。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="b9af" class="mj mk it mf b gy ml mm l mn mo">SELECT Sales_Manager,<br/>       Shipping_Address,<br/>       Status,<br/>       <strong class="mf jd">min(Shipping_Cost)</strong><br/>FROM Dummy_Sales_Data_v1<br/>GROUP BY Sales_Manager,<br/>         Shipping_Address,<br/>         Status</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/5cc59cecf5d42c652c482f689bd7c872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*1qW-ZIXY_mpL3rxHOcdXXA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者选择SQL | Image中的唯一行</p></figure><p id="c994" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe oa ob oc mf b">DISTINCT</code>的主要目的是返回唯一的记录。然而，几乎90%的时候，我发现<code class="fe oa ob oc mf b">GROUP BY</code>更方便，因为我总是想做一些其他的计算。</p><p id="13f5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">转到下一个有趣的问题..</p><h1 id="d55a" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">如何显示数据表中的第n行</h1><p id="eece" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">有时，您需要从数据集中选择特定行号的一条记录或从特定行号开始的多条记录。</p><p id="2fa4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这个场景中，SQL提供了一个非常有用的函数——<code class="fe oa ob oc mf b"><strong class="lk jd">OFFSET()</strong></code>——它在返回输出之前跳过指定的行数。</p><p id="081e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe oa ob oc mf b">OFFSET</code>可与<code class="fe oa ob oc mf b">LIMIT</code>(返回指定的行数)一起使用，以返回第n行或从第n行开始的行数。</p><p id="894b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，让我们使用OFFSET和LIMIT从数据集中返回第2行。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="55d1" class="mj mk it mf b gy ml mm l mn mo">SELECT *<br/>FROM Dummy_Sales_Data_v1<br/><strong class="mf jd">LIMIT 1<br/>OFFSET 1</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/ac7c8cc1b8dcbe254ddbdb069a6e41a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yk3Nj1dHXsmedk7xQLnacQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">使用偏移和限制|作者图像在SQL中选择第n行</p></figure><p id="605b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因为我们想只提取第2行，即我们想跳过1行。这就是为什么<code class="fe oa ob oc mf b">OFFSET 1</code>用于跳过1行，而<code class="fe oa ob oc mf b">LIMIT 1</code>只返回1行作为输出。</p><p id="498f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">❓:这也是一个常见的面试问题，要求候选人显示数据集中最高的2到6个价格，即不显示最高价格，而是从第二高的价格开始的5个最高价格。</p><p id="fb43" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我向你展示如何使用<code class="fe oa ob oc mf b">OFFSET</code> &amp; <code class="fe oa ob oc mf b">LIMIT</code>来实现这一点。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="b8a0" class="mj mk it mf b gy ml mm l mn mo">SELECT *<br/>FROM Dummy_Sales_Data_v1<br/><strong class="mf jd">ORDER BY UnitPrice DESC</strong><br/><strong class="mf jd">LIMIT 5</strong><br/><strong class="mf jd">OFFSET 1</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/6090ea8d06525ce0315098b863f9f8fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HeuubZ-fUamNeojboz7iwQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按作者显示数据集|图像中的第n个最高价格</p></figure><p id="e216" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">查询只会返回上图中红色圈出的部分。</p><p id="7d79" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">逻辑很简单→我们使用<code class="fe oa ob oc mf b">ORDER BY</code>按降序排列价格，使用<code class="fe oa ob oc mf b">OFFSET</code>跳过输出中的1行，使用<code class="fe oa ob oc mf b">LIMIT</code>只返回5行。</p><p id="740c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">✅用这种方法你可以保持你的代码整洁，易于解释和展示你有效地实现不同命令的能力。</p><p id="1979" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，让我们看一个有趣的工具来跟踪您的业务KPI..</p><h1 id="f65c" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">如何计算累计总数</h1><p id="f553" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">累计总计(也称为运行总计)是指特定列中下一个单元格之前的一列的所有单元格中的值的总和。</p><p id="23ce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简而言之，列的第5行中的累积总计是同一列的第1行到第5行中所有值的总和。</p><p id="3048" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">累积总计显示随着时间或其他序列增长的数据总和。</p><p id="72f8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">跟踪KPI的进度是非常流行和有用的，因为它可以用作跟踪KPI是否达标的指标。💯</p><p id="c4fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，了解可以在这种情况下使用的SQL查询是非常重要的。在SQL中，可以使用窗口函数<code class="fe oa ob oc mf b"><strong class="lk jd">OVER()</strong></code>轻松计算累计总数，如下所示。</p><p id="9037" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我们的数据集中，让我们获得订单<em class="ms">交付</em>到<em class="ms">意大利</em>的<em class="ms">数量</em>的累计总数，其中<em class="ms">销售经理</em>是<em class="ms">玛利亚</em>。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="f681" class="mj mk it mf b gy ml mm l mn mo">SELECT Sales_Manager,<br/>    OrderDate,<br/>    Quantity,<br/>    <strong class="mf jd">SUM(Quantity)<br/>    OVER (ORDER BY OrderDate) as Cumulative_total_order</strong><br/>FROM Dummy_Sales_Data_v1<br/>WHERE Sales_Manager = 'Maria'<br/>AND Product_Category = 'Healthcare'<br/>AND Status = 'Delivered'<br/>AND Shipping_Address = 'Italy'<br/>ORDER BY OrderDate</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6e8d96310ce990bb6fbc8204d1840848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*kHBTPPTBhwYRsOxXIm3vfg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">SQL | Image中按作者的累计总数</p></figure><p id="8bd5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如上图所示，第2行第4列的值<code class="fe oa ob oc mf b">70</code>实际上是第3列前两行的<code class="fe oa ob oc mf b">29</code>和<code class="fe oa ob oc mf b">41</code>的相加。同样的逻辑一直延续到最后。</p><p id="653a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">📌窗口函数<code class="fe oa ob oc mf b">OVER()</code>创建一个由<em class="ms"> OrderDate </em>排列的整个数据集的临时窗口，<code class="fe oa ob oc mf b">SUM(Quantity)</code>仅应用于该临时窗口。</p><p id="a9fa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如上图所示，第7行第4列的值<code class="fe oa ob oc mf b">459</code>是<code class="fe oa ob oc mf b">326 + 74 + 59</code>的结果。这是因为，我们在订单日期上创建了一个临时窗口，对于第7-8行，订单日期是相同的。</p><p id="f6f7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是最后一个非常有用的命令，可以有效地选择数据。</p><h1 id="4750" class="ne mk it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">如何选择特定字母在特定位置的单词</h1><p id="dd58" class="pw-post-body-paragraph li lj it lk b ll nv kd ln lo nw kg lq lr nx lt lu lv ny lx ly lz nz mb mc md im bi translated">有时，在提取数据时，您所知道的只是某一列中文本值的特定位置上的字符、字母或数字。您需要提取所有符合这个标准的行。</p><p id="3f95" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">SQL操作符<code class="fe oa ob oc mf b"><strong class="lk jd">LIKE</strong></code>在这种情况下非常方便。它在<code class="fe oa ob oc mf b"><strong class="lk jd">WHERE</strong></code>子句中用于搜索列中的指定模式。</p><p id="c8a5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">只有两个通配符你应该记住。</p><p id="1c86" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">1️⃣ <code class="fe oa ob oc mf b"><strong class="lk jd">%</strong></code>(百分号):表示零到多个字符</p><p id="110c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">2️⃣ <code class="fe oa ob oc mf b"><strong class="lk jd">_</strong></code>(下划线符号):恰好表示一个字符</p><p id="baa7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，让我们看看这是如何处理实际查询的。</p><p id="f86a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设，您希望获得数据集中产品类别和销售经理的唯一组合，其中<em class="ms"> Product_Category </em>中值的最后一个字符是<code class="fe oa ob oc mf b"><strong class="lk jd">e</strong></code>，而<em class="ms"> Sales_Manager </em>中值的第二个字符是<code class="fe oa ob oc mf b"><strong class="lk jd">a</strong></code>。</p><pre class="ks kt ku kv gt me mf mg mh aw mi bi"><span id="2a47" class="mj mk it mf b gy ml mm l mn mo">SELECT DISTINCT Product_Category,<br/>                Sales_Manager<br/>FROM Dummy_Sales_Data_v1<br/>WHERE Product_Category <strong class="mf jd">LIKE '%e'</strong><br/>AND Sales_Manager <strong class="mf jd">LIKE '_a%'</strong></span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/e2bcb31140c29049cb0afb296bae0aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*pi7wsOWiBJLTMaiLeyEUFA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">SQL中的通配符LIKE运算符|按作者排序的图像</p></figure><p id="803e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以上结果正是你想要的。在上述SQL查询的倒数第二行中，<code class="fe oa ob oc mf b"><strong class="lk jd">LIKE ‘%e’</strong></code> <strong class="lk jd"> </strong>用于提取值中有多个字符但以e结尾的所有产品类别。</p><p id="9e28" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">类似地，带有<code class="fe oa ob oc mf b"><strong class="lk jd">LIKE ‘_a%’</strong></code> <strong class="lk jd"> </strong>的SQL查询的最后一行用于获取销售经理列中的所有值，这些值从开始就只有一个字符(仅由一个下划线符号<code class="fe oa ob oc mf b"><strong class="lk jd">_</strong></code>表示)，然后是字符<code class="fe oa ob oc mf b"><strong class="lk jd">a</strong></code>，在<code class="fe oa ob oc mf b"><strong class="lk jd">a</strong></code>之后有零个或多个字符(由百分号<code class="fe oa ob oc mf b"><strong class="lk jd">%</strong></code>表示)。</p><p id="528b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">实现这个查询无疑展示了您在SQL的<code class="fe oa ob oc mf b">LIKE</code>操作符中使用通配符的熟练程度。</p><p id="a1a8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">仅此而已！</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="080e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">希望你很快看完这篇文章，觉得耳目一新，很有用。</p><p id="20f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我在过去的3年里一直在使用SQL，我发现这些技巧非常省时，而且在一段时间内非常有效。此外，我发现其中一些问题是很好的面试问题。</p><blockquote class="ok"><p id="0915" class="ol om it bd on oo op oq or os ot md dk translated">对阅读介质上的无限故事感兴趣？？</p></blockquote><p id="f87c" class="pw-post-body-paragraph li lj it lk b ll ou kd ln lo ov kg lq lr ow lt lu lv ox lx ly lz oy mb mc md im bi translated">💡考虑<a class="ae lh" href="https://medium.com/@17.rsuraj/membership" rel="noopener"> <strong class="lk jd">成为媒体会员</strong></a><strong class="lk jd">访问媒体上无限的</strong>故事和每日有趣的媒体文摘。我会得到你的费用的一小部分，没有额外的费用给你。</p><p id="eeb5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">💡不要忘记<a class="ae lh" href="https://medium.com/subscribe/@17.rsuraj" rel="noopener"> <strong class="lk jd">注册我的电子邮件列表</strong> </a>来接收我文章的第一份拷贝。</p><p id="478a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">感谢您的阅读！</strong></p></div></div>    
</body>
</html>