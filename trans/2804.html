<html>
<head>
<title>How to Create and Visualize Complex Radar Charts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建和可视化复杂的雷达图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-and-visualize-complex-radar-charts-f7764d0f3652#2022-06-18">https://towardsdatascience.com/how-to-create-and-visualize-complex-radar-charts-f7764d0f3652#2022-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b4d8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Matplotlib中的多种刻度和标签调整创建高级且高度灵活的极坐标图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d37a6dac26ca6d28e9f0789919895586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_WQi-tDe9yynZW_M18zILg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="bfd4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi lu translated">adar图表，也称为极坐标图、蜘蛛图或网状图，是在一张图片中清晰地可视化大量维度或特征(如<a class="ae md" rel="noopener" target="_blank" href="/best-practices-for-visualizing-your-cluster-results-20a3baac7426">聚类结果</a>)的好方法。</p><p id="b0cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用Python编写雷达图可能非常棘手。幸运的是，已经有关于它们的全面的操作指南<a class="ae md" href="https://matplotlib.org/stable/gallery/specialty_plots/radar_chart.html" rel="noopener ugc nofollow" target="_blank">教程</a>和<a class="ae md" rel="noopener" target="_blank" href="/how-to-make-stunning-radar-charts-with-python-implemented-in-matplotlib-and-plotly-91e21801d8ca">文章</a>。<strong class="la iu">然而</strong>，细节决定成败。想象你的数据有<strong class="la iu">不同的小数位数</strong>或者你的<strong class="la iu">变量名</strong>很长<strong class="la iu"/>。现有的解决方案将无法可视化这些情况。这就是我写这篇文章的原因。</p><h2 id="9ad6" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">TL；博士；医生</h2><ul class=""><li id="d334" class="mx my it la b lb mz le na lh nb ll nc lp nd lt ne nf ng nh bi translated">当前的解决方案不支持多尺度，并且缺乏对标签的正确可视化</li><li id="b307" class="mx my it la b lb ni le nj lh nk ll nl lp nm lt ne nf ng nh bi translated">所提出的解决方案在彼此的顶部创建了几个轴，以提供多个刻度</li><li id="e2dd" class="mx my it la b lb ni le nj lh nk ll nl lp nm lt ne nf ng nh bi translated">如何使用这个解决方案的几个代码示例可以在<a class="ae md" href="https://colab.research.google.com/drive/1YftqOtPkJGIKbPqBQtjyZgikx20G7Z0M?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>找到</li></ul><h1 id="a580" class="nn mf it bd mg no np nq mj nr ns nt mm jz nu ka mp kc nv kd ms kf nw kg mv nx bi translated">你将从这篇文章中学到什么</h1><ul class=""><li id="ba75" class="mx my it la b lb mz le na lh nb ll nc lp nd lt ne nf ng nh bi translated">当前解决方案失败的案例</li><li id="c107" class="mx my it la b lb ni le nj lh nk ll nl lp nm lt ne nf ng nh bi translated">如何创建具有多种比例和更好的标签格式的高级雷达图</li><li id="a545" class="mx my it la b lb ni le nj lh nk ll nl lp nm lt ne nf ng nh bi translated">这种方法背后的概念以及针对高级用户的简单解决方案</li><li id="06fa" class="mx my it la b lb ni le nj lh nk ll nl lp nm lt ne nf ng nh bi translated">一个(初学者友好的)扩展版本，有几个例子</li></ul><p id="ced5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个解决方案都有一个代码片段。本文中使用的示例数据是由<a class="ae md" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_wine.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn包</a>提供的<a class="ae md" href="https://archive.ics.uci.edu/ml/datasets/Wine" rel="noopener ugc nofollow" target="_blank">葡萄酒数据集</a> (CC BY 4.0参见来源)。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h1 id="1ad6" class="nn mf it bd mg no of nq mj nr og nt mm jz oh ka mp kc oi kd ms kf oj kg mv nx bi translated">当现有解决方案失败时</h1><p id="5293" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">如开头所述，我们可以找到经典雷达图绘制情况的现有解决方案。然而，有些情况下这些解决方案会失败。在我们讨论可能的解决方案之前，我会告诉你为什么这些解决方案会失败。</p><h2 id="c74f" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated"><strong class="ak">我们使用的示例数据集</strong></h2><p id="efd2" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">以下代码片段加载葡萄酒数据集，应用经典聚类(<em class="on"> k-means </em>)方法，并将聚类数作为新列(<em class="on"> cluster </em>)添加回数据框。在最后一行中，我们通过<em class="on">聚类</em>列对数据进行分组，并通过每个<em class="on">聚类</em>计算每个<em class="on">特征</em>的<em class="on">平均值</em>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段1。创建示例数据。</p></figure><p id="ade5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以使用这两个数据框了(图1)。<em class="on">数据</em>数据框(表1)包含每行的相关聚类，而<em class="on">结果</em>数据框(表2)是聚类特征的汇总(每个聚类的每个特征的平均值)。通过查看不同的值，我们可以看到，该数据集具有不同的标度(例如，灰分值与脯氨酸值的比较)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/13177aca1a26256e1723bb7aaf405e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_rkhnmWrxMV-WCUk9MzugQ@2x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图一。表格摘录(图片由作者提供)。</p></figure><h2 id="fa37" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">Plotly</h2><p id="42c1" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">交互式图形库Plotly提供了用极坐标图可视化数据的选项。以下代码片段基于他们的<a class="ae md" href="https://plotly.com/python/polar-chart/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段2。用Plotly创建雷达图。</p></figure><p id="3a14" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">代码的结果如下面的图2所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/79279bbffc2226e67afe1afbb24dc1d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z_nZXoak3Wo121ExlvFjcQ@2x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图二。Plotly的问题(图片由作者提供)。</p></figure><p id="5f93" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所见，不同的集群破坏了剧情(我们看不到它们的结尾)。这个问题的解决方案是改变第15行中的<em class="on">范围</em>参数。</p><p id="bcb7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">然而</strong>，我们的例子数据有<strong class="la iu">不同的尺度</strong>。列<em class="on">灰分</em>(图1表2)的平均值约为2.3，而<em class="on">脯氨酸</em>的平均值约为1.100。所以即使我们增加范围，脯氨酸的值仍然会破坏曲线。如果我们将整个图放在脯氨酸的适当范围内，其他变量(因为它们的尺度小得多)将不会清晰地可视化，因为它们的尺度小得多(见图3)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/88cd2755ebd75ca23f38b5360ac6000a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUYT9J0_mDA8uI3C4XR-rQ@2x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3。Plotly的问题(脯氨酸的调整范围)(图片由作者提供)。</p></figure><p id="d1d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">plot ly<a class="ae md" href="https://github.com/plotly/plotly.js/issues/3086" rel="noopener ugc nofollow" target="_blank">意识到</a>当数据具有不同比例时，绘图崩溃的问题，但实现需要赞助。除了这个缺点之外，Plotly的优点是，围绕圆的特征标签清晰可见。</p><h2 id="c9ac" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">Matplotlib</h2><p id="d025" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">Matplotlib还提供了极坐标图<a class="ae md" href="https://matplotlib.org/stable/gallery/specialty_plots/radar_chart.html" rel="noopener ugc nofollow" target="_blank">解决方案</a>。然而，他们的例子也只支持一种尺度。下面的代码片段利用了它们定义的类。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段3。用Matplotlib创建雷达图。</p></figure><p id="2b8e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们运行代码片段，我们可以看到他们的解决方案(图4)没有正确定位标签而没有重叠，只有<em class="on">脯氨酸</em>值(因为比例)清晰可见。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/d344a1e83755166385f0ddc6dffaf49c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hbk7Hc7kSpGqqvTig1dpuQ@2x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4。Matplotlib提供的极坐标图解决方案的问题(图片由作者提供)。</p></figure><h1 id="6144" class="nn mf it bd mg no np nq mj nr ns nt mm jz nu ka mp kc nv kd ms kf nw kg mv nx bi translated">解决方案</h1><p id="bd23" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">这个解决方案的核心灵感来源于stackexchange 上的一个<a class="ae md" href="https://datascience.stackexchange.com/questions/6084/how-do-i-create-a-complex-radar-chart" rel="noopener ugc nofollow" target="_blank">答案。主要思想是为每个变量创建一个axes对象。每个轴对象通过提供的最小-最大值获取并绘制其比例。为了确保图表的正确可视化，除了第一个对象及其副本之外，所有轴对象都被设置为不可见，以便只有它们的绘制刻度值保持可见。</a></p><p id="7d2d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一个轴对象负责绘制网格，其副本绘制图表线并填充区域。为了确保<em class="on">rgrid</em>、标签以及绘制的线条和区域的正确定位，必须采取这种解决方法。</p><h2 id="0e49" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">简单的解决方案</h2><p id="3b1e" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">下面的代码片段展示了一个简单的解决方案。它可用于绘制雷达图，无需任何附加格式。高级Matplotlib用户可以轻松地修改/扩展代码，以格式化特定的部分，如网格。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段4。简单的解决方案。</p></figure><p id="cc15" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的代码片段展示了如何将上面的代码用于我们的示例数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段5。对示例数据应用简单的解决方案。</p></figure><p id="9f1b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的<em class="on"> ComplexRadar </em>类需要每个变量的范围作为元组(min，max)。当然，我们可以手动为每个变量创建一个元组，但我也想向您展示如何更加自动化地完成这项工作。第<code class="fe ou ov ow ox b">3–5</code>行通过使用。describe()函数并把它们放在一个列表中(<code class="fe ou ov ow ox b">line 8</code>)。结果如下所示(图5)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/6be0c59e51b7f82c63fa7a54be515d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WowMvlQz9-EFiGAckM31Qw@2x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5。普通解决方案结果(图片由作者提供)。</p></figure><p id="a5bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如您所看到的，雷达图可以处理几个轴(每个轴对应一个变量)，并负责清楚地放置变量的标签(多亏了<em class="on"> textwrap </em>模块)。</p><blockquote class="oz pa pb"><p id="6c06" class="ky kz on la b lb lc ju ld le lf jx lg pc li lj lk pd lm ln lo pe lq lr ls lt im bi translated">如果你的每个变量都有一个相似的范围，你可以用一个(最小，最大)元组乘以变量的个数。例子:<code class="fe ou ov ow ox b">ranges =[(1,10)]*len(df.columns)</code></p></blockquote><h2 id="142b" class="me mf it bd mg mh mi dn mj mk ml dp mm lh mn mo mp ll mq mr ms lp mt mu mv mw bi translated">扩展版本</h2><p id="90b5" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">基于上面的普通版本，我还创建了一个扩展版本。扩展版本使用字典来配置/样式化图中的每个对象，以在可视化方面提供更大的灵活性。这个版本也是在本文的特色图片中创建不同可视化效果的版本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段6。扩展解决方案。</p></figure><p id="0d9e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的代码片段显示了如何使用扩展版本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo op l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段7。对示例数据应用扩展解决方案。</p></figure><p id="f597" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">主要的变化是引入了一个可选的<em class="on"> format_cfg </em>字典。这一个可以被用来样式化和格式化极坐标图的不同部分。上面的示例代码在第<code class="fe ou ov ow ox b">10–16</code>行显示了如何设置不同的参数。要了解哪些选项可用，可以查看源文件，我将链接放在该文件的相关部分。</p><p id="b37e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面代码的结果可以在下面的图6中看到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/a5a88d73087914450665fbc1867294d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nlhgosW8ylwn3Aeu1z3yKA@2x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6。使用扩展代码片段的结果(图片由作者提供)。</p></figure><blockquote class="oz pa pb"><p id="947c" class="ky kz on la b lb lc ju ld le lf jx lg pc li lj lk pd lm ln lo pe lq lr ls lt im bi translated">如果你对进一步的例子感兴趣(例如，如何在特色图片中创建图表)，请查看我的<a class="ae md" href="https://colab.research.google.com/drive/1YftqOtPkJGIKbPqBQtjyZgikx20G7Z0M?usp=sharing" rel="noopener ugc nofollow" target="_blank"> colab笔记本</a>。</p></blockquote></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h1 id="813e" class="nn mf it bd mg no of nq mj nr og nt mm jz oh ka mp kc oi kd ms kf oj kg mv nx bi translated">结论</h1><p id="a344" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated">创建雷达图可能相当具有挑战性。现有的解决方案可能有助于简单的任务。但是，当您必须处理不同的比例和标签格式时，需要进行大量的调整和变通。本文希望通过提供管理复杂需求的解决方案，为您节省大量时间(和精力)。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h1 id="e3c9" class="nn mf it bd mg no of nq mj nr og nt mm jz oh ka mp kc oi kd ms kf oj kg mv nx bi translated">来源</h1><p id="0ebf" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh ok lj lk ll ol ln lo lp om lr ls lt im bi translated"><a class="ae md" href="http://archive.ics.uci.edu/ml/datasets/Wine" rel="noopener ugc nofollow" target="_blank"> UCI机器学习知识库:葡萄酒数据集</a>。<a class="ae md" href="https://creativecommons.org/licenses/by/4.0/legalcode" rel="noopener ugc nofollow" target="_blank">知识共享署名4.0国际</a> (CC BY 4.0)许可”。</p><p id="77d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae md" href="https://datascience.stackexchange.com/questions/6084/how-do-i-create-a-complex-radar-chart" rel="noopener ugc nofollow" target="_blank">https://data science . stack exchange . com/questions/6084/how-do-I-create-a-complex-radar-chart</a></p></div></div>    
</body>
</html>