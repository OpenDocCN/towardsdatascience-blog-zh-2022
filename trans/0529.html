<html>
<head>
<title>The Key Feature Behind Lakehouse Data Architecture</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Lakehouse 数据架构背后的关键特性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-key-feature-behind-lakehouse-data-architecture-c70f93c6866f#2022-02-21">https://towardsdatascience.com/the-key-feature-behind-lakehouse-data-architecture-c70f93c6866f#2022-02-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7595" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解现代表格格式及其当前状态</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bc5f603f9789f2c511ba5153581227e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tdQKkgct-Y2Ef6CT_rh3Ig.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通常的表格格式疑点— ' <em class="ky">帽衫'(胡迪)</em>、冰山、三角洲【图片由作者提供】</p></figure><p id="1b3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Data Lakehouse 是由<a class="ae lv" href="https://databricks.com/wp-content/uploads/2020/12/cidr_lakehouse.pdf" rel="noopener ugc nofollow" target="_blank"> Databricks 论文</a>于 2020 年 12 月提出的下一代架构。Data Lake 可以使用 Parquet 或 ORC 等开放格式运行，并利用云对象存储，但缺乏数据仓库的丰富管理功能，如 ACID 事务、数据版本控制和模式实施。今天，就现代表格格式而言，我们比以往有更多的选择。他们都旨在解决这些问题，并为湖屋架构提供动力。让我们了解一下这些表格格式给表格带来了什么…😉</p><h1 id="af1d" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">为什么？拼花不够吗？🤔</h1><p id="a0d8" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">数据湖以最高的成本提供了良好的灵活性。您可以在 lake 中加载(几乎)您想要的任何内容(视频、图像、JSON、CSV 等)，但是治理丢失了。我们在数据湖中错过的最想要的特性是<strong class="lb iu"> ACID </strong>事务。让我们通过几个例子来理解这一点:</p><ul class=""><li id="0b93" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">托米奇:交易要么成功，要么失败。这意味着任何读取器或写入器都不会看到任何可能导致数据处于损坏状态的部分成功的事务。</li><li id="8039" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">一致性:从读者的角度来看，如果一个列有惟一的值，那么无论在数据源上做什么操作(对值的约束)，这个值都会被保留。如果提交了一组事务:2 个读者将看到相同的数据。</li><li id="9591" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu"> I </strong>解决方案:如果两个并发的事务正在更新同一个数据源，那么将会一个接一个地进行。</li><li id="c157" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">可维护性:一旦事务被提交，它将保留在系统中，即使紧接着发生崩溃。</li></ul><p id="1406" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们过去在单个数据库上拥有的东西，但是在分布式系统(在数据湖设置中)上，一切都在对象存储上，读取器和写入器之间没有隔离，它们直接在数据文件上工作，并且我们几乎没有帮助我们实现 ACID 事务的元数据。</p><p id="5d87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">湖边小屋的建筑采用了这种 ACID 范式，需要一种现代的表格格式。</p><h1 id="2de3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">三大现代表格格式📑</h1><p id="b153" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">你可能已经猜到了，现代的表格格式大量使用<code class="fe nh ni nj nk b">metadata</code>文件来实现 ACID。有了这些功能，他们可以实现不同的功能，例如:</p><ul class=""><li id="e830" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">时间旅行</li><li id="0dbc" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">并发读/写</li><li id="0f2c" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">模式演变和模式实施</li></ul><p id="e615" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，存储始终独立于计算引擎，因此您可以在您喜欢的云提供商上插入任何存储模型。比如:AWS S3，Azure 博客存储，GCP 云存储。</p><h2 id="b4d0" class="nl lx it bd ly nm nn dn mc no np dp mg li nq nr mi lm ns nt mk lq nu nv mm nw bi translated">阿帕奇胡迪</h2><p id="ba39" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><a class="ae lv" href="https://hudi.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇胡迪</a>于 2016 年在优步创立，更专注于流媒体流程。它有内置的数据流，事务模型是基于时间线的。这一个包含了在不同时刻对表的所有操作。时间轴可以通过帽衫提交时间提供时间旅行。</p><ul class=""><li id="037f" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">➕支持不同的数据接收引擎:Spark、Flink、Hive</li><li id="1aa8" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">➕非常适合流式处理</li><li id="a8d6" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">➕支持很多阅读引擎:AWS 雅典娜，AWS 红移，…</li></ul><h2 id="0e93" class="nl lx it bd ly nm nn dn mc no np dp mg li nq nr mi lm ns nt mk lq nu nv mm nw bi translated">阿帕奇冰山</h2><p id="b140" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><a class="ae lv" href="https://iceberg.apache.org/" rel="noopener ugc nofollow" target="_blank">阿帕奇冰山</a>始于 2017 年的网飞。事务模型是基于快照的。快照是文件和元数据文件的完整列表。它还提供乐观并发控制。时间旅行基于快照 id 和时间戳。</p><ul class=""><li id="e87c" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">➕它有伟大的设计和抽象，使更多的潜力:不依赖于火花，多种文件格式的支持。</li><li id="9435" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">➕ It 在管理大型表上的元数据方面表现出色(例如:在+10k 分区上更改分区名)</li><li id="fcf5" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">➕支持很多阅读引擎:AWS 雅典娜，AWS 红移，雪花…</li><li id="e1da" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">➖缺失和数据突变仍然是初步的</li></ul><h2 id="799d" class="nl lx it bd ly nm nn dn mc no np dp mg li nq nr mi lm ns nt mk lq nu nv mm nw bi translated">三角洲湖</h2><p id="71f7" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><a class="ae lv" href="https://delta.io/" rel="noopener ugc nofollow" target="_blank"> Delta Lake </a>，2019 年开源，由 data bricks(Apache Spark 的创造者)打造。毫不奇怪，它与 Spark 深度集成，可用于读写。它现在是 Databricks 的主要产品，它的某些部分(如 Delta Engine)不是开源的。其他产品，如<a class="ae lv" href="https://delta.io/sharing/" rel="noopener ugc nofollow" target="_blank"> Delta sharing </a>听起来很有前途。</p><ul class=""><li id="00d3" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">➕它得到了 Databricks 的支持，data bricks 是目前数据领域的顶级公司之一</li><li id="2ae8" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">➖确实紧抓星火不放(尽管根据他们公布的<a class="ae lv" href="https://databricks.com/blog/2021/12/01/the-foundation-of-your-lakehouse-starts-with-delta-lake.html" rel="noopener ugc nofollow" target="_blank">路线图</a>这将在 2022 年改变)</li></ul><h2 id="a70b" class="nl lx it bd ly nm nn dn mc no np dp mg li nq nr mi lm ns nt mk lq nu nv mm nw bi translated">高级摘要📓</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/33e6a0633b02c49252165ff6c89e9a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3nHcqAy4PigNEb3qz0NIA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">高级功能 as 19 . 02 . 2022[图片由作者提供]</p></figure><h1 id="6b1d" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">一般兴趣是什么？Github 一览👀</h1><p id="21ed" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">由于所有项目都是开源的，评估兴趣和增长的一个很好的数据源是查看 Github 本身。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/34b5f735f32c28a1e6959a6db0343748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8n9DBnhVb2UUqn-KnuzpFQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Github 将历史设定为 2022 年 2 月 19 日，由 star-history.com 生成[图片由作者提供]</p></figure><p id="b284" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，在主流数据用户的眼中，这些表格格式仍然非常年轻。大部分的吸引力出现在过去的两年里，当<em class="nz">湖边小屋</em>的概念开始出现的时候。</p><p id="061d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个有趣的见解是查看当前提交、拉请求和问题的数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/bcc96ac661727ffef2ec6e03430328d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1lte9hFlKF2yC5D7c7ZLtw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Github 公开数据截至 2022 年 2 月 19 日[图片由作者提供]</p></figure><p id="9eb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所述，三角洲生态系统的一些功能不是开源的——这解释了与牵引相比提交数量低的原因。</p><h1 id="3040" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">每个人都是赢家，因为未来是互操作性⚙️</h1><p id="1b70" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">无论你选择哪种格式，也无论谁将赢得最终的比赛，它都在朝着正确的方向前进:我们需要在数据格式方面更加开放的标准，以实现互操作性和用例。</p><p id="2a16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很高兴看到计算和阅读引擎普遍采用所有这些格式。例如，AWS 红移在 2020 年 9 月<a class="ae lv" href="https://aws.amazon.com/about-aws/whats-new/2020/09/amazon-redshift-spectrum-adds-support-for-querying-open-source-apache-hudi-and-delta-lake/" rel="noopener ugc nofollow" target="_blank"/>增加了对德尔塔湖和阿帕奇胡迪的支持。最近，雪花<a class="ae lv" href="https://www.snowflake.com/blog/expanding-the-data-cloud-with-apache-iceberg/" rel="noopener ugc nofollow" target="_blank">宣布支持阿帕奇冰山</a>。</p><p id="c028" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一件好事是它们都有开源社区的支持。互操作性至关重要，因此支持这些格式的计算引擎越多，我们就越不需要选择锁定我们的东西。</p><h1 id="6d27" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">迈赫迪·瓦扎又名迈赫迪欧·🧢</h1><p id="9217" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">感谢阅读！🤗 🙌如果你喜欢这个，<strong class="lb iu">请在</strong>跟我来🎥<a class="ae lv" href="https://www.youtube.com/channel/UCiZxJB0xWfPBE2omVZeWPpQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Youtube </strong> </a>，<strong class="lb iu"> </strong> ✍️ <a class="ae lv" href="https://medium.com/@mehdio" rel="noopener"> <strong class="lb iu">中</strong> </a>，或者🔗<a class="ae lv" href="https://linkedin.com/in/mehd-io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> LinkedIn </strong> </a>了解更多数据/代码内容！</p><p id="6f6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">支持我写作</strong> ✍️通过加入媒介通过这个<strong class="lb iu"> </strong> <a class="ae lv" href="https://mehdio.medium.com/membership" rel="noopener"> <strong class="lb iu">链接</strong> </a></p></div></div>    
</body>
</html>