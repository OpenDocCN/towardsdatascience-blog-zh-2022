<html>
<head>
<title>A Detailed Guide for Building Hardware Accelerated MLOps Pipelines in SageMaker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 SageMaker 中构建硬件加速 MLOps 流水线的详细指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-detailed-guide-for-building-hardware-accelerated-mlops-pipelines-in-sagemaker-5d32459665b3#2022-12-13">https://towardsdatascience.com/a-detailed-guide-for-building-hardware-accelerated-mlops-pipelines-in-sagemaker-5d32459665b3#2022-12-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1e06" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何在 SageMaker 中实施英特尔人工智能分析工具包硬件加速库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a16cb7b6ecfc97c5c526ea455df6fe1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBxwa9GYkrktAQ3FqhBBqw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://www.freepik.com/free-vector/magic-school-composition-with-outdoor-scenery-silhouette-ancient-castle-teacher-growing-plant-with-spell_14657754.htm#query=wizard&amp;position=14&amp;from_view=search&amp;track=sph" rel="noopener ugc nofollow" target="_blank">图像来源</a></p></figure><p id="d0d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SageMaker 是 AWS 云上的一个完全托管的机器学习服务。这个平台背后的动机是为了方便在托管 AWS 云服务的基础上构建强大的机器学习管道。不幸的是，导致它简单的抽象使得它很难定制。本文将解释如何将定制的训练和推理代码注入到预先构建的 SageMaker 管道中。</p><p id="47c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的主要目标是在 SageMaker 管道中启用<a class="ae kv" href="https://www.intel.com/content/www/us/en/developer/tools/oneapi/ai-analytics-toolkit.html#gs.kjcg0z" rel="noopener ugc nofollow" target="_blank">英特尔人工智能分析工具包</a>加速软件。AWS 可能会为这些加速包构建公开可用的映像，但同时也欢迎您使用这些模板。</p><h2 id="444b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">为什么要用 Daal4py 优化 XGBoost？</h2><p id="b4d1" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">虽然基准测试超出了本教程的范围，但是其他应用程序已经看到了将 XGBoost 模型转换为 daal4py 格式的明显好处。<a class="ae kv" href="https://github.com/oneapi-src/predictive-asset-health-analytics" rel="noopener ugc nofollow" target="_blank">预测性资产维护 AI 参考套件</a>显示，daal4py 中可用的英特尔优化提供了额外的预测时间加速，与使用案例研究数据集上经过调整的超参数训练的 XGBoost 模型的股票 XGBoost 0.81 相比，总体速度提高了 2.94 倍至 3.75 倍。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/c708ac3e62bb9724e71d5fbe310ba44d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHoPBda3PjQh23U0aBCNQQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图一。XGBoost 和 Daal4py 模型在推理过程中的基准— <a class="ae kv" href="https://github.com/oneapi-src/predictive-asset-health-analytics/tree/main/src" rel="noopener ugc nofollow" target="_blank">图片来源</a></p></figure><p id="219d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样值得注意的是，使用 daal4py 预测没有观察到准确性下降。</p><p id="a16a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mr">本教程是关于使用英特尔人工智能分析工具包构建硬件优化的 SageMaker 端点系列的一部分。你可以在这里</em>   <em class="mr">找到整个系列</em> <a class="ae kv" href="https://github.com/eduand-alvarez/ai-kit-sagemaker-templates" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="mr">的代码。</em></strong></a></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="27eb" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">创建 SageMaker 项目</h2><p id="eda2" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">启动 SageMaker 项目非常简单。</p><ol class=""><li id="43bf" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr ne nf ng nh bi translated">首先在 AWS 中导航到 SageMaker 服务，并从导航面板中选择<strong class="ky ir">入门</strong>。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/fe8d46c0f62f5ee46e09509d77a62a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1UvkTeIYYrfX95nay8hwfg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图二。SageMaker 入门页面—作者图片</p></figure><p id="81b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.您需要<strong class="ky ir">配置一个 SageMaker 域</strong>来启动 Studio。我们将在本教程中使用<strong class="ky ir">快速设置</strong>选项。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/4074c10e291872359794f4578ce24374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sgf_LkXmh4AedWzy1TAEcQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图二。SageMaker 域配置—作者图片</p></figure><p id="6659" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.从导航面板中选择<strong class="ky ir">工作室</strong>，打开<strong class="ky ir">工作室</strong>会话。</p><p id="0c52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.在<strong class="ky ir"> SageMaker Resources </strong>选项卡中，点击<strong class="ky ir"> Create project </strong>并选择<em class="mr"> MLOps 模板用于模型构建、培训和部署。</em>该模板提供了配置和启动 ML 生命周期管理服务所需的所有代码。我们将编辑该模板的各个方面，以适应我们的自定义训练和推理代码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/c3ddcdb2298f8680cc52e85904321036.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N_cv6v_H4EiNA81NzjFb7A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 4。SageMaker 项目创建—作者图片</p></figure><p id="0511" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.您需要克隆这两个项目存储库。一个对应模型建立，一个是模型部署。CodeCommit 将管理存储库，一个类似于 GitHub 的版本控制服务。</p><p id="5862" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">5.我们将把我们的客户流失数据集下载到 AWS S3 存储桶中。我们将在脚本中指向这个桶。要下载数据，在 SageMaker 项目的任何目录下创建一个笔记本，并在 Jupyter 单元格中执行以下代码。</p><pre class="kg kh ki kj gt nl nm nn bn no np bi"><span id="4f7f" class="nq lt iq nm b be nr ns l nt nu">!aws s3 cp s3://sagemaker-sample-files/datasets/tabular/synthetic/churn.txt ./<br/>import os<br/>import boto3<br/>import sagemaker<br/>prefix = 'sagemaker/DEMO-xgboost-churn'<br/>region = boto3.Session().region_name<br/>default_bucket = sagemaker.session.Session().default_bucket()<br/>role = sagemaker.get_execution_role()<br/>RawData = boto3.Session().resource('s3')\<br/>.Bucket(default_bucket).Object(os.path.join(prefix, 'data/RawData.csv'))\<br/>.upload_file('./churn.txt')<br/>print(os.path.join("s3://",default_bucket, prefix, 'data/RawData.csv'))</span></pre><p id="ade5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">6.我们需要做一些修改来使 SageMaker 模板适应我们的客户流失解决方案。我们这个客户流失模型的目标是预测用户将来是否会退订某项服务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/fde0d64d8811ddfa2b7c2afc23971140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I326xcgGn3FP3jqTuj-imA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 5。模型构建存储库的文件结构—按作者分类的图像</p></figure><p id="82b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们回顾一下我们将使用的主要文件夹和文件。这些脚本的改编版本可以在<a class="ae kv" href="https://github.com/eduand-alvarez/ai-kit-sagemaker-templates/tree/main/xgboost-daal4py" rel="noopener ugc nofollow" target="_blank"> GitHub Repo </a>中找到。出于时间考虑，您可以随意复制回购中的代码来更新<strong class="ky ir"> pipeline.py、preprocess.py、evaluate.py、</strong>和<strong class="ky ir">code build-spec build . yml .</strong></p><ul class=""><li id="7373" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr nw nf ng nh bi translated"><strong class="ky ir"> pipelines </strong>文件夹包含编排和执行我们的模型构建管道的各种组件的 python 脚本。您需要将该目录中的“鲍鱼”文件夹重命名为“customer_churn”</li><li id="f2ec" class="mz na iq ky b kz nx lc ny lf nz lj oa ln ob lr nw nf ng nh bi translated"><strong class="ky ir"> evaluate.py </strong>脚本根据验证数据集评估我们的模型。在这个例子中，我们使用 MSE，但是您可以将它修改为其他合适的度量。</li><li id="5455" class="mz na iq ky b kz nx lc ny lf nz lj oa ln ob lr nw nf ng nh bi translated"><strong class="ky ir"> preprocess.py </strong>脚本执行各种数据处理和特征工程步骤，如一键编码和标准化。您可以通过注入额外的处理步骤来适应您的解决方案。</li><li id="3920" class="mz na iq ky b kz nx lc ny lf nz lj oa ln ob lr nw nf ng nh bi translated"><strong class="ky ir"> pipeline.py </strong>脚本协调您的整个 SageMaker 模型构建管道。它加载机器映像，指定计算实例，并从适当的数据源中提取数据。理解这个脚本的来龙去脉可能需要一些时间，但是一旦掌握了窍门，就相对简单了。首先编辑以下内容:<br/> - S3 位置(第 95 行)<br/> -自定义映像 URI(第 121 行)—构建自定义映像的步骤在本文中有详细讨论:<a class="ae kv" href="https://medium.com/@eduand-alvarez/guide-to-implementing-custom-accelerated-ai-libraries-in-sagemaker-with-oneapi-and-docker-97547692cb6e" rel="noopener"> <strong class="ky ir">使用 oneAPI 和 Docker </strong> </a> <strong class="ky ir">在 SageMaker 中实现自定义加速 AI 库的指南。</strong> <br/> -你的管道名称(第 70 行)</li><li id="ce06" class="mz na iq ky b kz nx lc ny lf nz lj oa ln ob lr nw nf ng nh bi translated"><strong class="ky ir">code build-spec build . yml</strong>在将变更推送到<strong class="ky ir"> CodeCommit </strong> Repo 时配置您的构建。</li></ul><p id="0d16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">7.一旦我们完成了对这四个文件的编辑并配置了我们的定制培训/服务映像，我们就可以将我们的更改推送到我们的 repo 中。由于我们的模板预先配置了 CI/CD，这将自动执行管道并训练一个模型。</p><ul class=""><li id="5ff1" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr nw nf ng nh bi translated">从侧面导航面板中选择<strong class="ky ir"> GIT </strong>选项卡，选择您已修改的文件以添加到暂存区并提交，然后将更改推送到远程存储库。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/708d8282674401feab24f076bbcf61d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*ZnHFbrWBhBJ5Bp8-BCIQZg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 6。提交和推送 Git 面板—作者图片</p></figure><ul class=""><li id="dc91" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr nw nf ng nh bi translated">要检查您的 CI/CD 自动化是否正确触发了构建，您可以转到<strong class="ky ir"> AWS CodeCommit </strong>并从导航面板中选择 build history。您应该看到一个带有“进行中”状态的构建运行。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/82495be7fd81cdb636cbd1338e22642a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PxK8de-nTTuXYD8AyZpIVg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 6。代码提交构建历史</p></figure><ul class=""><li id="648b" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr nw nf ng nh bi translated">转到<strong class="ky ir"> SageMaker 资源</strong>并选择您的项目。从<strong class="ky ir">管道</strong>页签，可以查看管道执行的状态；您将发现一个成功的作业，它是在我们克隆模板 repos 时自动执行的。您还应该看到一个处于执行状态的管道，您可以双击它来查看关于您的执行的更多细节。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/a231635129d404ba022b836e4c2e1b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lmWDjsWCRuGTVSs33d8hw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 7。管道执行仪表板—按作者分类的图像</p></figure><ul class=""><li id="4c70" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr nw nf ng nh bi translated">您可以使用可视化图形表示来监控管线的进度。单击节点将打开一个执行元数据面板，其中包括输入、输出和执行日志。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/1c5b9967cca0bdf3340df30c176d8ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K_GHdHSUpnfNW93rU0ayBg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 8。管道图界面—作者图片</p></figure><p id="d0df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">成功完成管道后，将创建一个模型。您可以在模型组项目选项卡中访问您的模型。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="c740" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak">端点和推理作业</strong></h2><p id="ae1a" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">SageMaker 端点由您的管道自动创建，负责处理推理组件。</p><ol class=""><li id="6683" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr ne nf ng nh bi translated">由于我们的模型批准条件被设置为“手动”，我们将不得不手动批准我们的模型。当一个模型被批准时，这将调用一个<strong class="ky ir">云生成栈</strong>，它创建一个<strong class="ky ir"> SageMaker 模型</strong>、<strong class="ky ir"> SageMaker 端点配置</strong>和<strong class="ky ir"> SageMaker 推理端点</strong>。所有这些组件都可以在中央 SageMaker AWS 控制台中进行跟踪。负责这种自动化的代码可以在我们在本教程开始时克隆的模型部署 repo 中找到。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/df036b39adf5c18ec0509a6bbaf01e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6EThptb7Z38XcKXzaGwmpg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 9。模型批准控制台—作者图片</p></figure><p id="794a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.在 sagemaker 中检查端点构建的状态。导航至 SageMaker <strong class="ky ir">推理</strong>并选择<strong class="ky ir">端点</strong>。您可以在<strong class="ky ir"> CloudWatch </strong>上选择 View Logs 来查看来自您的端点的事件数据(图 11)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/6e2873ae34f37afc18d492764b58812d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E7VWdOiL2RKctmVHD0ZLyw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 10。使用 CloudWatch 来诊断问题，并检查端点 ping 测试是否成功。作为端点 ping 测试的一部分，我们正在加载我们的模型。成功的 ping 指示一个健康的端点。—作者图片</p></figure><p id="13ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另一个很好的 QC 点是检查您的端点是否在端点仪表板中标记为“运行中”(图 12)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/9d7ab5402e1dcfade77e231a7d959c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvW27RtPA2CNukP9rZifEA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 11。SageMaker 终端管理仪表板—作者图片</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="ba45" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">设置 Lambda 函数来处理 API 请求</h2><p id="7d67" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">AWS Lambda 函数阻止我们设置专用服务器来监控请求和执行像格式化和端点调用这样的小段代码。这有很大的好处，比如只在功能被触发时为计算机付费，而不是专用服务器，后者将向我们收取预留或按需费用。</p><p id="d730" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为这个特定教程构建 lambda 函数的步骤将在本文中详细讨论:<a class="ae kv" href="https://medium.com/@eduand-alvarez/guide-to-building-aws-lambda-functions-from-ecr-images-to-manage-sagemaker-inference-endpoints-4980a9b92290" rel="noopener"> <strong class="ky ir">从 ECR 图像构建 AWS Lambda 函数以管理 SageMaker 推理端点的指南。</strong> </a></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="1348" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">使用 API 网关构建 REST API</h2><p id="b1d0" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">配置 REST API 将允许我们向 SageMaker 端点发送 HTTP 协议请求。以下步骤概述了如何使用<strong class="ky ir"> AWS API 网关</strong>实现这一点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/00044ad35d9b0d6375a61ccfbf67ab56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*92QT3Fp1_L06w9XQJFzfow.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 12。REST API 架构图——作者图片</p></figure><ol class=""><li id="46a4" class="mz na iq ky b kz la lc ld lf nb lj nc ln nd lr ne nf ng nh bi translated">导航到<strong class="ky ir"> API 网关</strong>，并从<strong class="ky ir"> REST API 部分选择<strong class="ky ir">“构建”</strong>。</strong></li></ol><p id="298b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.选择<strong class="ky ir"> REST </strong>、<strong class="ky ir"> New API </strong>，在<strong class="ky ir"> API 设置</strong>部分填写您的姓名和端点类型。完成后，点击<strong class="ky ir">创建</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/8f18ff4d9d860c5ab6c1af7a9297d601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nBpTvzs_Hf9Ml9ToeWm1vw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 13。REST API 配置设置—按作者分类的图像</p></figure><p id="aa82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.转到<strong class="ky ir">动作</strong>下拉菜单并选择<strong class="ky ir">创建资源。</strong>完成后，点击<strong class="ky ir">创建资源。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/267810e3ecf524457ef7519c4bfd0405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dsXpmsmjeHdrcYNLOjTzjg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 14。资源创建配置-按作者分类的图像</p></figure><p id="2bf9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.转到<strong class="ky ir">动作</strong>下拉菜单，选择<strong class="ky ir">创建方法</strong>。选择发布。检索您在上一节中配置的 lambda 函数的名称，并提供与其余资源相同的区域。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/fa8606e21137b6a3dbfdad369200f2d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b-L1I1Ug73s6YR7dcYjjPw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 15。发布请求配置-按作者分类的图像</p></figure><p id="ed25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在创建网关时，会提示您一个 API 架构图。</p><p id="785f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">5.您可以通过点击<strong class="ky ir">动作</strong>选项卡并选择<strong class="ky ir">部署 API </strong>选项来部署 API。这将为您提供一个链接，您可以使用它向您的模型端点发送<strong class="ky ir"> Post </strong>请求。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/73d045eca843d5d4e1e03b168ad677f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0jENEApdeYqEX34NnxCBrw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 16。调用用于向您的 API 发送请求的 URL 按作者排序的图像</p></figure><h2 id="0472" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">测试您的新 API</h2><p id="e335" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在 https://web.postman.co/<a class="ae kv" href="https://web.postman.co/" rel="noopener ugc nofollow" target="_blank">创建一个免费的邮递员账户</a></p><p id="bf0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用 Postman 创建 REST API 请求来测试我们的新 API。</p><p id="6147" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在 Postman 中创建新的测试，粘贴您从 REST API 创建的链接，选择<strong class="ky ir"> Body </strong>作为输入类型，选择<strong class="ky ir"> POST </strong>作为请求类型，并提供输入数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/c21641a31cf157453106d483df7c725b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RsK0xig0gU_PNaSqn0_s5Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 17。邮递员测试仪表板-作者图片</p></figure><p id="9fd2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您已经完成了本教程中的所有步骤，您应该会从您的 API 得到一个“真实”的响应。</p><h2 id="3cf2" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论和讨论</h2><p id="bb02" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">恭喜你！您已经使用 oneAPI 硬件加速库在 SageMaker 上构建了一个定制的 MLOps 管道。使用本教程中的信息，您可以在 SageMaker 中构建端到端的机器学习管道，并利用 daal4py 等硬件优化的机器学习库。</p><p id="5da8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在未来的文章中，我们打算发布计算机视觉和自然语言处理硬件优化的 SageMaker 管道的代码和演练。</p><h2 id="fe97" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak">来源:</strong></h2><ul class=""><li id="7337" class="mz na iq ky b kz ml lc mm lf op lj oq ln or lr nw nf ng nh bi translated">从 ECR 图像构建 AWS Lambda 函数以管理 SageMaker 推断端点的指南|<a class="ae kv" href="https://medium.com/@eduand-alvarez/guide-to-building-aws-lambda-functions-from-ecr-images-to-manage-sagemaker-inference-endpoints-4980a9b92290" rel="noopener">https://medium . com/@ edu and-Alvarez/guide-to-Building-AWS-Lambda-Functions-from-ECR-Images-to-Manage-sage maker-Inference-Endpoints-4980 a9b 92290</a></li><li id="698c" class="mz na iq ky b kz nx lc ny lf nz lj oa ln ob lr nw nf ng nh bi translated">使用 oneAPI 和 Docker 在 SageMaker 中实现自定义加速 AI 库的指南|<a class="ae kv" href="https://medium.com/@eduand-alvarez/guide-to-implementing-custom-accelerated-ai-libraries-in-sagemaker-with-oneapi-and-docker-97547692cb6e" rel="noopener">https://medium . com/@ edu and-Alvarez/guide-to-Implementing-Custom-Accelerated-AI-Libraries-in-SageMaker-with-oneAPI-and-Docker-97547692 CB 6 e</a></li><li id="83d0" class="mz na iq ky b kz nx lc ny lf nz lj oa ln ob lr nw nf ng nh bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/your-algorithms-inference-code.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/sage maker/latest/DG/your-algorithms-inference-code . html</a></li><li id="914f" class="mz na iq ky b kz nx lc ny lf nz lj oa ln ob lr nw nf ng nh bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/how-it-works-training.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/sage maker/latest/DG/how-it-works-training . html</a></li></ul></div></div>    
</body>
</html>