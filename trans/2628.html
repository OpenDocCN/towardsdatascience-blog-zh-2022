<html>
<head>
<title>How to tokenize text and pad sequences in Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Tensorflow中标记文本和填充序列</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-tokenize-and-pad-sequences-in-tensorflow-fcbbf2e8b3b5#2022-06-07">https://towardsdatascience.com/how-to-tokenize-and-pad-sequences-in-tensorflow-fcbbf2e8b3b5#2022-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b79b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">用于标记化和填充文本序列的现成模板</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi kj"><img src="../Images/51ba19269958510293e71d6ee4addc35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*CG79FFAh9A1dbB1z.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/es/@bradyn?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Bradyn Trollip </a>在<a class="ae kv" href="https://unsplash.com/s/visual/862f3a1f-89c2-45c9-b19e-39c58a023ad2?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4b03" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">在本文中，我们将了解如何提取填充并将其应用于令牌序列，以使用Tensorflow训练深度学习模型。</p><p id="fc92" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我在之前的一篇文章中已经谈到了这个主题，我在那里谈到了<a class="ae kv" href="https://medium.com/mlearning-ai/convert-texts-into-tensors-for-deep-learning-74b0cf48d416" rel="noopener">如何将文本转换为深度学习任务的张量</a>，但在这种情况下，重点将是如何正确格式化Tensorflow的令牌序列。</p><p id="521e" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">这种方法对于为我们的模型提供统一长度的序列(事实上是填充的)令牌序列是必不可少的。让我们看看怎么做。</p><h1 id="25a7" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">数据集</h1><p id="ddce" class="pw-post-body-paragraph kw kx it ky b kz mk ju lb lc ml jx le lf mm lh li lj mn ll lm ln mo lp lq lr im bi translated">我们将使用Sklearn提供的数据集<em class="mp"> 20newsgroups </em>，快速访问大量文本数据。出于演示的目的，我将只使用10个文本的样本，但该示例可以扩展到任何数量的文本。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/1a7bc5d3ecca0bdf015bfe22cc445b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ctojmgmx4u8au_rg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集的示例。图片作者。</p></figure><p id="c957" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我们不会对这些文本应用预处理，因为Tensorflow标记化过程会自动为我们删除标点符号。</p><h1 id="ab72" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">什么是标记化？</h1><p id="1370" class="pw-post-body-paragraph kw kx it ky b kz mk ju lb lc ml jx le lf mm lh li lj mn ll lm ln mo lp lq lr im bi translated">标记化意味着把一个句子简化成构成它的符号。所以如果我们有一个像<em class="mp">这样的句子，“嗨，我叫安德鲁。”</em>它的标记化版本将只是["Hello "，" my "，" name "，" is "，" Andrew "，]. "].注意，默认情况下，标记化包括标点符号。</p><p id="3a5f" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">应用标记化是将我们的单词转换为机器学习模型可以处理的数值的第一步。</p><p id="3c21" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">通常，应用<em class="mp">就足够了。split() </em>在Python中对一个字符串执行简单的标记化。但是，有几种标记化方法可以应用。Tensorflow为此提供了一个非常有趣的API，允许您定制这种逻辑。我们很快就会看到。</p><h1 id="2b82" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">什么是填充？</h1><p id="e0f5" class="pw-post-body-paragraph kw kx it ky b kz mk ju lb lc ml jx le lf mm lh li lj mn ll lm ln mo lp lq lr im bi translated">一旦句子被标记化，Tensorflow将返回与每个标记相关联的数值。这个通常叫做<em class="mp"> word_index </em>，是一个由word和index组成的字典，{word: index}。每个遇到的单词都有编号，该编号用于识别该单词。</p><p id="e3d6" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated"><strong class="ky iu">深度学习模型通常需要统一大小的输入</strong>。这意味着不同长度的句子对我们的模型来说是有问题的。这就是填充发挥作用的地方。</p><p id="cd7c" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">我们来看两个句子及其索引序列(不包括标点符号):</p><ul class=""><li id="aecf" class="mx my it ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">嗨，我叫安德鲁:[43，3，56，6]</li><li id="4dc0" class="mx my it ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">嗨，我是一名分析师，我在深度学习项目中使用tensor flow:[43，11，9，34，2，22，15，4，5，8，19，10，26，27]</li></ul><p id="fd86" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">第一个(4个元素)比第二个(14个元素)短。如果我们以这种方式将序列输入到我们的模型中，会给我们带来一些误差。<strong class="ky iu">因此，序列必须被标准化，以使它们具有相同的长度</strong>。</p><p id="2b94" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">对一个序列应用填充意味着使用一个预定义的数值(通常为0) <strong class="ky iu">使较短的序列达到与最大长度</strong>的序列相同的长度。所以我们会有这个:</p><ul class=""><li id="76b0" class="mx my it ky b kz la lc ld lf mz lj na ln nb lr nc nd ne nf bi translated">嗨，我叫安德鲁:[0，0，0，0，0，0，0，0，0，0，43，3，56，6]</li><li id="9c15" class="mx my it ky b kz ng lc nh lf ni lj nj ln nk lr nc nd ne nf bi translated">嗨，我是一名分析师，我在深度学习项目中使用tensor flow:[43，11，9，34，2，22，15，4，5，8，19，10，26，27]</li></ul><p id="7f9b" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">现在两个序列长度相同。我们可以决定如何填充——是在序列之前还是之后插入零，直接使用Tensorflow的<em class="mp"> pad_sequences </em>方法。</p><h1 id="b802" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">应用标记化和填充</h1><p id="45b7" class="pw-post-body-paragraph kw kx it ky b kz mk ju lb lc ml jx le lf mm lh li lj mn ll lm ln mo lp lq lr im bi translated">现在，让我们在从数据语料库中提取句子后，将标记化和填充下面的代码应用于数据语料库。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nl"><img src="../Images/27b2a20ec29cc6788357171da209d3a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3Fv0jOnVsqCJRQ-wBcJ0g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">应用于示例短语的标记化和填充。图片作者。</p></figure><p id="94f3" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">注意，代码中有<em class="mp"> post </em>作为填充模式。这意味着在序列之后插入零，因此在标记值之后而不是之前拉伸向量。</p><p id="c13e" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">以下是如何将标记化和填充应用于文本，以将其传递给Tensorflow上的神经网络。如果您有任何问题或顾虑，请留下评论，我一定会跟进。</p><p id="f0df" class="pw-post-body-paragraph kw kx it ky b kz la ju lb lc ld jx le lf lg lh li lj lk ll lm ln lo lp lq lr im bi translated">下次见！👋</p></div></div>    
</body>
</html>