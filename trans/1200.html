<html>
<head>
<title>How to Build Your Own GPT-J Playground</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立自己的 GPT J 游乐场</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-your-own-gpt-j-playground-733f4f1246e5#2022-03-28">https://towardsdatascience.com/how-to-build-your-own-gpt-j-playground-733f4f1246e5#2022-03-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7626" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用 Streamlit、拥抱脸和 AWS 创建您自己的文本生成应用程序</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bbc773b090ba28b5eefa1ee1a693fe2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qKebBMDE77__-7Qx"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">蒂埃里·勒迈特在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="1237" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">这是怎么回事？</h1><p id="64e9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">当<a class="ae kv" href="https://openai.com/" rel="noopener ugc nofollow" target="_blank"> OpenAI </a>为其 GPT-3 模型发布<a class="ae kv" href="https://gpt3demo.com/apps/openai-gpt-3-playground" rel="noopener ugc nofollow" target="_blank">游乐场时，社区很快创建了各种令人印象深刻的演示，其中许多可以在</a><a class="ae kv" href="https://github.com/elyase/awesome-gpt3" rel="noopener ugc nofollow" target="_blank">棒极了的 GPT-3 Github repo </a>中找到。</p><p id="2616" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">但是如果我们想创建我们自己的文本生成平台呢？GPT-3 是专有的，使用 API 来生成文本会让我们付出代价。这也意味着我们必须将我们的数据发送到 OpenAI。理想情况下，我们想做的是在我们控制的环境中托管一个开源文本生成模型和一个游乐场应用程序。</p><p id="e71e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">看起来我们很幸运。2021 年，<a class="ae kv" href="https://www.eleuther.ai/" rel="noopener ugc nofollow" target="_blank"> Eleuther AI </a>创造了 GPT-J，一个开源的文本生成模型，与 GPT-3 竞争。当然，该模型在 Hugging Face (HF)模型中心上<a class="ae kv" href="https://huggingface.co/EleutherAI/gpt-j-6B" rel="noopener ugc nofollow" target="_blank">可用，这意味着我们可以利用亚马逊 SageMaker </a>中的<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/hugging-face.html" rel="noopener ugc nofollow" target="_blank"> HF 集成来轻松部署该模型。为了创建一个与模型交互的 web 界面，我们可以使用</a><a class="ae kv" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>，它允许我们只使用 Python 就能编写 web 应用程序:)</p><p id="1d64" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">那我们开始吧！教程的完整代码可以在这个<a class="ae kv" href="https://github.com/marshmellow77/gptj-playground" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="b28f" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">部署 GPT J 模型</h1><p id="ff2d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">拥抱脸的人已经让在亚马逊 SageMaker 上部署像 GPT-J 这样的 6B 参数模型变得非常容易，几乎没有任何不便。来自 HF 团队的 Philipp Schmid 在他的<a class="ae kv" href="https://www.philschmid.de/deploy-gptj-sagemaker" rel="noopener ugc nofollow" target="_blank">博客文章</a>中概述了这个过程——所有需要的就是 24 行代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在 SageMaker 上部署 GPT-J 的代码(信用:<a class="ae kv" href="https://www.philschmid.de/deploy-gptj-sagemaker" rel="noopener ugc nofollow" target="_blank">https://www.philschmid.de/deploy-gptj-sagemaker</a></p></figure><p id="5e0d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">一旦我们在 SM 笔记本中运行此代码，将需要几分钟时间来部署端点。终端准备就绪时，SM 控制台会告诉我们:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/b3b2536aec85ee6306b5825df19918a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RcKw0NKGV71gYpKD1keieA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="94cc" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">创建 web 界面</h1><h2 id="09af" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">设置 EC2</h2><p id="6343" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一旦模型部署在 SageMaker 端点上，我们就可以在笔记本上运行推理请求。但是为什么就此打住呢？借助 Streamlit 的力量，我们可以轻松创建自己的 GPT J 游乐场！</p><p id="5142" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们需要的只是一台服务器，我们可以在其中托管 Streamlit 应用程序并访问 SM 端点。如果我们选择在与端点相同的帐户中的 EC2 实例上这样做，我们可以通过 SM 提供的 API 访问端点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/34164e2dcf4679c4ed04d65fff74f57d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5duE42271gW-pLR0Kopfw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="b55c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们需要做的只是提供一个小型 EC2 实例，例如 t3.medium，因为它将只托管 web 应用程序。一旦实例启动并运行，我们就安装<a class="ae kv" href="https://docs.conda.io/en/latest/miniconda.html" rel="noopener ugc nofollow" target="_blank"> miniconda </a>并通过 pip install 安装所需的库:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="9067" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为了连接到我们的端点，我们还需要将我们的凭证从 EC2 传递到 SageMaker。有很多方法可以做到这一点，更多信息请查看<a class="ae kv" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html" rel="noopener ugc nofollow" target="_blank"> AWS 文档</a>。在本教程中，我将使用一个<a class="ae kv" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html#shared-credentials-file" rel="noopener ugc nofollow" target="_blank">共享凭证文件</a>。</p><h2 id="2541" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">创建简化应用程序</h2><p id="58f2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在我们可以开发我们的 Streamlit 应用程序，这非常简单。让我们首先定义一个方法来处理模型有效负载和响应的预处理和后处理:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="f076" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们需要一个文本字段，我们可以在其中输入提示，调用我们的<em class="nr"> generate_text() </em>方法，并显示模型响应:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="49d1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">就是这样！非常简单，不是吗？</p><h2 id="4925" class="ne kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">测试应用程序</h2><p id="8030" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们测试一下这个设置！我们可以使用<em class="nr">streamlit run&lt;python-script&gt;</em><a class="ae kv" href="https://docs.streamlit.io/knowledge-base/using-streamlit/how-do-i-run-my-streamlit-script" rel="noopener ugc nofollow" target="_blank">命令</a>开始运行 streamlit 应用程序。这将在端口 8501 上开始运行应用程序，因此我们需要确保端口 8501 没有被阻塞(在 EC2 实例上，这意味着需要更新相应的安全组，以允许到端口 8501 的流量通过)。一旦应用程序启动并运行，我们就可以通过<em class="nr">http://&lt;EC2-IP-ADDRESS&gt;:8501 访问它。</em></p><p id="8082" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们将看到一个文本框，我们可以在那里输入我们的提示和一个<em class="nr">运行</em>按钮，将调用我们的 GPT-J 模型。让我们在文本框中输入一个提示，然后运行模型。几秒钟后，它应该返回生成的文本:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/d11c5c5245e5ffe92002b6aa60cce1f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VXNOXlqJyZKZOcfnfcCeMg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="bebc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">就这样——我们刚刚在自己的 playground 应用程序中用 GPT-J 模型生成了第一个文本！</p><h1 id="5863" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="0366" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">有许多方法可以改善这个游乐场，其中一些是:</p><ul class=""><li id="e105" class="nt nu iq lq b lr mk lu ml lx nv mb nw mf nx mj ny nz oa ob bi translated">新生成的文本可以用作模型的新提示。这将使我们能够继续就同一主题编写文本。</li><li id="c586" class="nt nu iq lq b lr oc lu od lx oe mb of mf og mj ny nz oa ob bi translated">防止模型在句子中间停止。</li><li id="bc4f" class="nt nu iq lq b lr oc lu od lx oe mb of mf og mj ny nz oa ob bi translated">引入参数来影响生成的文本，例如<em class="nr">温度</em>和<em class="nr">最高温度</em>。你可以在这篇博文的<a class="ae kv" href="https://huggingface.co/blog/how-to-generate" rel="noopener ugc nofollow" target="_blank">中找到更多关于这些参数和文本生成的信息。</a></li></ul><p id="3de6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我希望你觉得这个教程有用，如果你有任何问题或意见，请联系我们。</p><p id="d447" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"><em class="nr">【2022 年 5 月 11 日编辑:我现在已经发表了一篇</em> </strong> <a class="ae kv" rel="noopener" target="_blank" href="/how-to-use-gpt-j-for-almost-any-nlp-task-cb3ca8ff5826?source=your_stories_page-------------------------------------"> <strong class="lq ir"> <em class="nr">的博文</em> </strong> </a> <strong class="lq ir"> <em class="nr">讲述了如何使用这个 GPT-J 游乐场的应用来完成(几乎)任何 NLP 任务。】</em> </strong></p></div></div>    
</body>
</html>