<html>
<head>
<title>What is Cosine Similarity? How to Compare Text and Images in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">余弦相似度是什么？如何在Python中比较文本和图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-is-cosine-similarity-how-to-compare-text-and-images-in-python-d2bb6e411ef0#2022-02-07">https://towardsdatascience.com/what-is-cosine-similarity-how-to-compare-text-and-images-in-python-d2bb6e411ef0#2022-02-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="24fe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">机器学习的伟大工具</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/152e341604b6893b9a81def696d59e8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VQiIKRzorHZGcbJTXRN3Kg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内森·杜姆劳在<a class="ae ky" href="https://unsplash.com/s/photos/similar?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="72e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在构建机器学习应用程序时，计算相似性非常有用。如果您需要根据内容的相似程度对文档进行聚类，或者如果您正在构建一个模型来匹配图像，您将需要一种方法来确定哪些相似哪些不相似。使用数字数据很容易做到这一点，但是我们如何确定文档或图像的相似性呢？</p><p id="0c0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">余弦相似度</strong>是一种计算两个向量相似度的方法，取点积并除以每个向量的大小，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/33c1a1c6c8fcb4704b942f6a3b87b3ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IhpY-6LYV75983THCpWo-w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用python，我们实际上可以将文本和图像转换成矢量，并应用同样的逻辑！Scikit-learn、PIL和Numpy使这一过程更加简单。在本文中，我将通过几个例子展示如何使用余弦相似性，以及如何使用python计算余弦相似性。</p><p id="3cc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">与文本数据的余弦相似度</strong></p><p id="d7b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将文本转换为向量的过程在自然语言处理中非常常见。有许多不同的方法来矢量化文本，本文很好地解释了其中一些方法。每种方法都有优点和缺点，但它们本质上都实现了相同的结果:将文本转换成数字。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/922058201a8651be69bbba49f0b7785c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lXbNUYsFUtIiLQ5AKoUCA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://www.educative.io/profile/view/6547532599525376" rel="noopener ugc nofollow" target="_blank"> Edpresso团队</a>在<a class="ae ky" href="https://www.educative.io" rel="noopener ugc nofollow" target="_blank"> Educative.io </a>上拍摄</p></figure><p id="b924" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在python中尝试一下——首先，我们需要加载我们的文本数据，并使用sklearn的文本计数矢量器来创建这个向量。对于这个例子，我想比较两个相似的段落，所以我将使用“蜜蜂”维基百科页面的第一段和蜜蜂电影的第一行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lz"><img src="../Images/6a0044fe016e784f9e58ce317dd696d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OiHr5qmTzszWJKywq5o4dw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者Jupyter笔记本截图</p></figure><p id="b800" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经得到了这些文本向量，我们可以使用一种叫做<strong class="lb iu">术语频率逆文档频率</strong> (TFIDF)的计算方法来比较每个文本向量的相似性和差异。我知道这听起来很混乱，但这基本上是一种衡量某个单词相对于文档中其他所有单词的独特性的方法。这是在0-1的范围内计算的，最常用的词接近0，最独特的词接近1。这是我们的bee文档的样子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="7135" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们有了这个数据框架，我们只需要运行余弦相似度函数，我们就会得到结果</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ma"><img src="../Images/9ab9af18f7e8e17e932c5b12a45c8bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*BVejOPJXbfs4mPB1WkxPuQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者Jupyter笔记本截图</p></figure><p id="c54a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着根据余弦相似度，蜜蜂电影的第一行与“蜜蜂”维基百科页面的第一段只有19%的相似度。乍一看，这似乎很低，但是让我们将第一个文档与其他文档进行比较，看看有什么不同。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/9b2077957d67c59fdb5dbb6f9edc410c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*hYU-LsjmLxKCBw-j5Vzkmg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者Jupyter笔记本截图</p></figure><p id="fadc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个文档只有7.6%的相似性，这是有道理的，因为单词“Bee”在第三个文档中甚至没有出现过一次。</p><p id="63d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于较大的文档，这一过程可以很容易地放大，从而减少计算中的统计误差。如果两个50个单词的文档有50%相似，这可能是因为一半的单词是“the”、“to”、“a”等。但是，当你在1000字的文档中有50%的相似性时，你可能在处理剽窃。余弦相似度对于分析文本非常有用-作为一名数据科学家，您可以选择什么%被视为太相似或不够相似，并查看该临界值如何影响您的结果。</p><p id="2a9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有其他确定文本相似性的方法，如<a class="ae ky" href="https://en.wikipedia.org/wiki/Jaccard_index" rel="noopener ugc nofollow" target="_blank"> Jaccard的索引</a>，这很方便，因为它没有考虑重复的单词。</p><p id="a221" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">与图像的余弦相似度</strong></p><p id="c766" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你大概能猜到，这个过程和上面那个很像。幸运的是，我们不必做所有的NLP的东西，我们只需要上传图像，并将其转换为RGB值的数组。多亏了PIL和Numpy，这个过程非常简单！对于这个例子，我将比较两张狗的图片，然后比较一只狗和一只青蛙，以显示得分差异。</p><p id="7347" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我将要比较的两张狗的照片:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/45fd46064b8e0fc6198f497a26d3c96f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*97Jxul-bw9FiVu2NHJgjPA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左图由<a class="ae ky" href="https://www.pexels.com/@bruzewalker" rel="noopener ugc nofollow" target="_blank">布鲁诺塞尔韦拉</a>在<a class="ae ky" href="https://www.pexels.com" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄，右图由<a class="ae ky" href="https://www.pexels.com/@click-instant2021" rel="noopener ugc nofollow" target="_blank">凯文罗哈斯</a>在<a class="ae ky" href="https://www.pexels.com" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><p id="f988" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是我用来上传图片并将其转换成矢量的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="24d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了向您展示计算余弦相似性的另一种方法，我将使用Scipy和spatial.distance函数。余弦距离和余弦相似度的计算几乎相同，只有一个微小的差异。John R. Ladd的这篇文章很好地解释了这种差异以及它们与欧氏距离的关系，但对于这个例子，我们需要知道的是</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi md"><img src="../Images/e643d018813d862489cb592c29154375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rl1z0W8jqnEfecWnjqdFHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b8a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们知道了这一点，我们可以使用Scipy计算余弦距离，然后将其转换为余弦相似度。我是这样做的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi me"><img src="../Images/5c2938fa18da51f65bb314f6fa57b84a.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*_vdBpyTf2ypWxd6bzzTAVw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者Jupyter笔记本截图</p></figure><p id="fc8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着这些狗的照片有81%相似，这是有道理的，只要看着它们，你就可以知道它们有基本相同的主题和调色板。如果我们拍一张完全不同的照片，并与第一张狗的照片进行比较，会怎么样呢？大概是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mf"><img src="../Images/690457874d913ec15d72e6c1dd696c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDwLHbXU0RI3mmpz6P_BPQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左图由<a class="ae ky" href="https://www.pexels.com/@bruzewalker" rel="noopener ugc nofollow" target="_blank">布鲁诺·塞尔韦拉</a>在<a class="ae ky" href="https://www.pexels.com" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄，右图由<a class="ae ky" href="https://www.pexels.com/@1138093" rel="noopener ugc nofollow" target="_blank">格莱布·科罗夫科</a>在<a class="ae ky" href="https://www.pexels.com" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lx ly l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/ea19376d59523447eb6fdc96f6482797.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*kd9ZApvpXBIUnGm8UjvsSg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者Jupyter笔记本截图</p></figure><p id="264d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如所料，这两幅图像明显不如前两幅相似。30%仍然相对较高，但这可能是因为它们都在左上角有大面积的黑暗区域，以及一些小的颜色相似性。就像文本示例一样，您可以确定什么是“足够相似”的临界值，这使得余弦相似性非常适合聚类和其他排序方法。</p><p id="a9ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也可以使用HSL值而不是RGB，或者将图像转换为黑白，然后进行比较，这可能会产生更好的结果，具体取决于您正在处理的图像类型。无论你是想建立一个人脸检测算法，还是一个能从青蛙图像中准确分类狗图像的模型，余弦相似度都是一个方便的计算方法，可以真正改善你的结果！</p><p id="341a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结论</strong></p><p id="e85c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章很好地介绍了余弦相似性以及使用它来比较数据的几种方法。作为数据科学家，我们有时会忘记数学的重要性，所以我相信学习一些理论并理解我们的代码如何以及为什么工作总是有好处的。希望你能从这些例子中得到一些概念，并制作出你自己的酷项目！</p><p id="6dc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣了解更多关于余弦相似性的知识，我强烈推荐<a class="ae ky" href="https://www.youtube.com/watch?v=m_CooIRM3UI&amp;t=372s&amp;ab_channel=codebasics" rel="noopener ugc nofollow" target="_blank">这段youtube视频</a>。或者如果你想了解更多关于自然语言过程的知识，你可以看看我的<a class="ae ky" rel="noopener" target="_blank" href="/building-a-sentiment-analysis-model-using-yelp-reviews-and-ml-ensemble-methods-80e45db6d0c7">关于情感分析的文章</a>。我也很乐意在未来讨论更多类似的主题，如果您有兴趣了解更多关于某个函数、方法或概念的信息，请告诉我。</p><p id="8b5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读！</p></div><div class="ab cl mh mi hx mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="im in io ip iq"><p id="aff0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">想从我这里得到更多？</strong></p><ol class=""><li id="1b61" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated"><a class="ae ky" href="https://bench-5.medium.com/" rel="noopener">在Medium上跟随我</a></li><li id="ce4a" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">通过使用<a class="ae ky" href="https://bench-5.medium.com/membership" rel="noopener">我的推荐链接</a>注册媒体来支持我的写作</li><li id="37d7" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">在<a class="ae ky" href="https://www.linkedin.com/in/benchamblee/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae ky" href="https://twitter.com/Bench__5" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系</li></ol></div></div>    
</body>
</html>