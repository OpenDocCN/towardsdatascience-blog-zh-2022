<html>
<head>
<title>Managing Molecules for Computational Chemistry with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python管理计算化学的分子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-molecules-for-computational-chemistry-fdffe7075cad#2022-05-13">https://towardsdatascience.com/visualizing-molecules-for-computational-chemistry-fdffe7075cad#2022-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4af6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从“微笑”到3D</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f2674df796cf3a42f1d0c9bd9c934377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHSfRS2Ge_e739niOKvviQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">演职员表:<a class="ae ky" href="https://www.pexels.com/@maria-gulyaeva-1259102/" rel="noopener ugc nofollow" target="_blank">玛利亚·古利亚耶娃</a>，免pexels.com版税</p></figure><p id="559f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">化学中的微笑…不，我们不会谈论上面图片中的那个。由于失败的实验，这些微笑通常很少在实验室或计算机模拟中出现。我们要讲一些和计算化学相关的东西。简而言之，计算化学是化学的一个分支，它使用计算机工具来辅助复杂的化学研究，如药物设计。自从阿尔法折叠和量子计算的出现，这个领域开始了新的复兴。</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/quantum-landscape-for-protein-discovery-62c0c86fc27e"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">蛋白质折叠的量子景观</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">量子计算如何有希望开发治疗神经退行性疾病的药物等等</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="1403" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> SMILES </strong>(简化分子输入行输入系统)是一种基于行符号中字符的符号，使用短ASCII字符串描述化合物的结构。大多数分子编辑器可以导入微笑字符串，并将其转换回二维图形(尽管分子在现实中是3D的)。这种方法非常有用，因为它允许你利用基于<strong class="lb iu">字符串操作和自然语言处理</strong>的最新<strong class="lb iu">机器学习</strong>工具。下面的图片展示了几个从化学结构到微笑表达的编码例子(例如CC(=)…。):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/61e19f1b4e852414053435a01b027471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikr0yFs5DEWfgBlqF6WcZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">CC(=O)OC1=CC=CC=C1C(=O)O和CNC[C@@H](C1=CC(=C(C=C1)O)O)O(作者图片)</p></figure><ul class=""><li id="61a2" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">乙醇CCO</li><li id="a419" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">乙酸CC(=O)O</li></ul><p id="d8f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，大多数编辑器——如ChemDraw——将SMILES符号转换成2D图，即使分子实际上是3D的。幸运的是，角色中的信息允许在更先进的工具中重建完整的3D表示，这是本文的主题。</p><p id="8ff8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在大多数3D文件格式中，有。pdb(蛋白质数据库文件)或更简单的。摩尔。鉴于它与Python库如<a class="ae ky" href="https://www.rdkit.org/" rel="noopener ugc nofollow" target="_blank"> RDKit </a>和免费工具如<a class="ae ky" href="https://pymol.org/2/" rel="noopener ugc nofollow" target="_blank"> PyMol </a>的通用性，我们在这里描述。mol文件格式。让我们首先探索如何将SMILES符号转换成. mol文件格式，然后研究. mol文件中的内容，最后用<a class="ae ky" href="https://pymol.org/2/" rel="noopener ugc nofollow" target="_blank"> PyMol </a>可视化结果。</p><p id="baff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码片段从<a class="ae ky" href="https://www.rdkit.org/" rel="noopener ugc nofollow" target="_blank"> RDKIT包</a>中导入一些库，在上图的2D a中绘制，最终将分子保存到一个. mol文件中。运行这段代码的CoLab笔记本在<a class="ae ky" href="https://colab.research.google.com/drive/1Wv5LoVmwjV2qtVBMCkbWB-1NQzc_OEBw?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>可以找到。</p><p id="9693" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nc">关键是功能化学。molfromselles()</em>”这是在读一个Smiles符号。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="cbe8" class="ni nj it ne b gy nk nl l nm nn">from rdkit import Chem</span><span id="f95f" class="ni nj it ne b gy no nl l nm nn">from rdkit.Chem import AllChem</span><span id="1eb9" class="ni nj it ne b gy no nl l nm nn">from rdkit.Chem import Draw</span><span id="f844" class="ni nj it ne b gy no nl l nm nn">from rdkit.Chem.Draw import IPythonConsole<br/># Convert SMILE into .mol</span><span id="79ac" class="ni nj it ne b gy no nl l nm nn">my_mol=Chem.MolFromSmiles('NC(=N)N1CCC[C@H]1Cc2onc(n2)c3ccc(Nc4nc(cs4)c5ccc(Br)cc5)cc3')</span><span id="bf3f" class="ni nj it ne b gy no nl l nm nn">my_mol_with_H=Chem.AddHs(my_mol)</span><span id="4800" class="ni nj it ne b gy no nl l nm nn">AllChem.EmbedMolecule(my_mol_with_H)</span><span id="fdd5" class="ni nj it ne b gy no nl l nm nn">AllChem.MMFFOptimizeMolecule(my_mol_with_H)</span><span id="5cc6" class="ni nj it ne b gy no nl l nm nn">my_embedded_mol = Chem.RemoveHs(my_mol_with_H)<br/></span><span id="9180" class="ni nj it ne b gy no nl l nm nn">#Save the molecule into an image</span><span id="1625" class="ni nj it ne b gy no nl l nm nn">Draw.MolToFile(my_mol,'molecule.png')</span><span id="2c1a" class="ni nj it ne b gy no nl l nm nn">#Save molecular rapresentation in mol files</span><span id="f7ed" class="ni nj it ne b gy no nl l nm nn">fout = Chem.SDWriter('./charged_test.mol')</span><span id="3918" class="ni nj it ne b gy no nl l nm nn">fout.write(my_embedded_mol)</span><span id="0c76" class="ni nj it ne b gy no nl l nm nn">fout.close()</span></pre><p id="58a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一个Python库，你可以想象这可以很容易地与Python中的机器学习、自然语言处理和其他AI库相结合。</p><p id="a92e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答。mol文件格式是一个文本ASCII文件，以空格分隔的方式包含以下几个元素:</p><ul class=""><li id="dea3" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated">原子列表，每个原子都有其特定的元素标识。</li><li id="44e4" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">一个键的列表，指定它们连接的原子以及键的多重性(单键、双键、三键)</li><li id="997d" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">每个原子的2D或3D空间坐标</li><li id="e8f7" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">计算分子中的原子和键的数量。</li><li id="98fd" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">与原子或键相关的属性</li><li id="7139" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated">与整个结构相关的属性。</li></ul><p id="50d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些通常以列或块的形式表示，如下图所示。第一列是原子的3D坐标，然后是原子符号，然后是属性，最后是键值。如果你想知道更多关于这种结构的细节，请查看罗伯特·贝尔福德的“MOL文件剖析”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/0bc18a9fe34a506bedbd11547b23e37a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XjzU44Qr1A-nK1loC4QjdA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Mol文件格式结构，图片作者</p></figure><p id="8abe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">产生的。使用RDKIT通过代码获得的mol可以用PyMol可视化为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/5425ac0c8147467d606d81a3a0fb60d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NvDsPW0PPJaqfoe8ZitIwg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图来自作者PyMol。</p></figure></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="387b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总之，我们在这里介绍了一些简单的方法，既可以在Python脚本中使用，也可以使用可视化工具从SMILES符号中恢复3D分子结构。这是为了证明使用SMILES符号仍然很方便，即使它看起来不那么可读。药物的图形表示也可以用于机器学习的环境中，尽管在如何在3D空间中定向分子方面出现了许多问题。尽管对人类来说准备起来很麻烦，但它可以利用我们已经从机器学习中的自然语言处理中获得的所有进步，包括如<a class="ae ky" href="https://www.frontiersin.org/articles/10.3389/fchem.2019.00895/full" rel="noopener ugc nofollow" target="_blank">所示的许多最近的作品</a>。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="fe08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">参考文献</strong></p><p id="b3b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">皮摩尔| pymol.org</p><p id="569a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.rdkit.org/docs/Overview.html" rel="noopener ugc nofollow" target="_blank">快速工具包</a></p><p id="a6d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://perkinelmerinformatics.com/products/research/chemdraw/" rel="noopener ugc nofollow" target="_blank">化学绘图</a></p><p id="3904" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://chem.libretexts.org/Courses/University_of_Arkansas_Little_Rock/ChemInformatics_(2017):_Chem_4399_5399/2.2:_Chemical_Representations_on_Computer:_Part_II/2.2.2:_Anatomy_of_a_MOL_file" rel="noopener ugc nofollow" target="_blank">解剖一个MOL文件</a></p><p id="51dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【张等.化学前沿2020“sp vec:一种基于Word2vec的药物-靶标相互作用预测特征表示方法”</p><p id="0068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/tutorials/pdbintro.html" rel="noopener ugc nofollow" target="_blank">解剖PDB文件</a></p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h1 id="61c4" class="ny nj it bd nz oa ob oc od oe of og oh jz oi ka oj kc ok kd ol kf om kg on oo bi translated">想连接就连接</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/0bf7aae9aa9a13147bdf9119c6f33370.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/0*4ifjdVMgDmqkLrW0"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://twitter.com/Dr_Alex_Crimi" rel="noopener ugc nofollow" target="_blank">@ Dr _ Alex _克里米</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/37f743ab64124e944b4ccfb48ba6bbc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/0*l0h8GAbvrMJ1MyNe"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.instagram.com/dr.alecrimi/" rel="noopener ugc nofollow" target="_blank">@ Alec rimi博士</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/1eb200215e8bc9a7b20c3041493e99c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/0*_ROpVjailyNwRDfl.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.youtube.com/alecrimi" rel="noopener ugc nofollow" target="_blank">亚历山德罗·克里米——YouTube</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/8b777f17c33927c8bf43ac341b137560.png" data-original-src="https://miro.medium.com/v2/resize:fit:120/0*GCXzM0Qx1e-8lfLQ"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历克斯·亚乌·克里米|脸书</p></figure></div></div>    
</body>
</html>