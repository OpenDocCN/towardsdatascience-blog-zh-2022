<html>
<head>
<title>5 Things to Know Before Using Snowflake’s Native Data Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用雪花的原生数据分类之前要知道的 5 件事</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-things-to-know-before-using-snowflakes-native-data-classification-30f4e1d2ac06#2022-11-30">https://towardsdatascience.com/5-things-to-know-before-using-snowflakes-native-data-classification-30f4e1d2ac06#2022-11-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8ed8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解雪花的 PII 检测功能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cf3e54717b7b21be5cb5d2e3d6e12027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NS3AbMOKCxD1PVZV"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@freegraphictoday?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">absolute vision</a>拍摄</p></figure><p id="c761" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在当今世界，数据收集和处理受到监管，组织别无选择，只能遵守这些法规。因此，公司开始重新思考他们设计信息系统、数据存储和业务流程的方式，同时考虑到隐私问题。</p><p id="8557" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实施数据保护原则的一个基本要素是<strong class="ky ir">数据分类。</strong></p><h1 id="cd38" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是数据分类？</h1><p id="9927" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">数据分类通常被定义为<strong class="ky ir">将</strong> <strong class="ky ir">数据</strong>组织成<strong class="ky ir">组类别</strong>的过程，以帮助公司更有效地使用和保护数据。数据分类有助于我们了解我们在语义方面拥有什么，以便更好地保护它。</p><p id="1fbe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，这个组件通常是一个<strong class="ky ir">难以解决的问题</strong>…一些公司采用手工方式，另一些公司使用 ML 来自动分类他们的数据集。无论哪种方式，解决这个问题都是<strong class="ky ir">昂贵的</strong>并且<strong class="ky ir">可能是无效的</strong>取决于数据存储的方式和位置。</p><h1 id="c181" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">雪花拯救世界</h1><p id="b9a9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您的数据堆栈中存在雪花，您可能希望利用其固有的<a class="ae kv" href="https://docs.snowflake.com/en/user-guide/governance-classify-concepts.html" rel="noopener ugc nofollow" target="_blank">数据分类特性</a>。在扫描和分析了数据仓库对象(表、视图等)的内容和元数据之后..)，该特征将确定适当的<a class="ae kv" href="https://docs.snowflake.com/en/user-guide/governance-classify-concepts.html#classification-categories" rel="noopener ugc nofollow" target="_blank">语义和隐私类别</a>。它将帮助您发现&amp;标记 PII 数据，并显著降低管理和保护您的数据的复杂性和成本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/496c53a586c6f1860aeb40faf0e70825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJx_p4Ftl87kgu3Trc1dAw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">文本到图像使用<a class="ae kv" href="https://www.midjourney.com/" rel="noopener ugc nofollow" target="_blank">中途</a>:北极熊在云端保护数据库</p></figure></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="0048" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，在您决定使用雪花的原生数据分类功能之前，有几件重要的事情您应该考虑:</p><h2 id="2486" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated"><strong class="ak"> 1。数据类型</strong></h2><p id="c74b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">虽然您可以对半结构化数据(带有 JSON 对象的变量类型列)进行分类，但是该特性仅限于分析具有单一数据类型的变量，例如:varchar 或 number。如果您的表不包含任何 JSON 字段，这应该不是什么大问题。但是，如果您非常依赖雪花存储和查询半结构化数据的能力，您应该记住它不能与数据分类功能结合使用。您将需要考虑一个多步骤的过程，其中(1)您展平您的列，并确保它是受<a class="ae kv" href="https://docs.snowflake.com/en/user-guide/governance-classify-concepts.html#supported-objects-and-column-data-types" rel="noopener ugc nofollow" target="_blank">支持的数据类型</a>之一，然后(2)您运行分类。</p><h2 id="c72a" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">2.综合</h2><p id="8be7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">说到流程，第二点是关于找到您需要/想要执行数据分类的正确步骤。很可能，您已经建立了数据管道，为不同环境中的许多数据库提供数据。那么，具体到哪一点，您会对数据进行分类呢？也许，在将数据转储到数据仓库之后，您可能会想。</p><p id="9034" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果是，这个阶段的数据质量是否足够好，可以高置信度地进行可靠分类？数据量呢？也许在数据被清理和建模之后，在更下游的地方进行分类会更好，对吗？在这种情况下，您将如何处理法规遵从性、治理和安全性？永远不会到达业务/指标层的数据怎么办？在开始对数据进行分类之前，您需要彻底回答这些问题。</p><h2 id="1188" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">3.自动化和可扩展性</h2><p id="2920" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在他们的<a class="ae kv" href="https://www.snowflake.com/blog/data-classification-available-in-public-preview/" rel="noopener ugc nofollow" target="_blank">博客</a>中，Snowflake 描述了原生数据分类特性，好像它将移除所有手动过程。这可能是定制数据集的理想场景中的情况，然而，真实世界的用例却大不相同；数据仓库通常包含多个环境、数据库和数据共享。事实上，雪花提供了三个<a class="ae kv" href="https://docs.snowflake.com/en/user-guide/governance-classify-using.html#use-stored-procedures-to-classify-all-tables-in-a-schema" rel="noopener ugc nofollow" target="_blank">存储过程</a>；第一个用于对模式中的所有表进行分类，第二个用于对数据库中的所有表进行分类，第三个用于使用标记对分类的对象列应用分类结果。手动触发的(甚至是预定的)存储过程在自动化、可伸缩性和监控方面根本达不到预期。尤其是因为没有简单的方法来分类新的或改变的对象。</p><p id="73cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与上面提到的博客文章相比，Snowflake 的文档建议了一个<a class="ae kv" href="https://docs.snowflake.com/en/user-guide/governance-classify-using.html#classification-workflow" rel="noopener ugc nofollow" target="_blank">工作流</a>，用户可以选择手动检查分类输出，并根据需要进行修改。这种方法的问题是它很难扩展；这不仅是因为它需要人工关注，还因为缺少一个方便审查和批准过程的用户界面。您需要构建自己的工具来弥合这一差距。</p><h2 id="198e" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">4.表演</h2><p id="c13b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">绩效评估是多方面的，但我将只讨论一个方面；全表扫描。</p><p id="3bfc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要分析表/视图中的列，需要运行以下函数:</p><pre class="kg kh ki kj gt nj nk nl nm aw nn bi"><span id="2c1b" class="mx lt iq nk b gy no np l nq nr">EXTRACT_SEMANTIC_CATEGORIES('<em class="ns">&lt;object_name&gt;</em>' [,<em class="ns">&lt;max_rows_to_scan&gt;</em>])</span></pre><p id="df75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了对象名(如表名)，它还带有一个可选参数&lt;<strong class="ky ir"><em class="ns">max _ rows _ to _ scan&gt;</em></strong>，代表样本大小。如果您没有明确地将它设置为 0 到 10000 之间的一个数字，它将默认为 10000 行。起初，我认为样本大小对性能(查询运行时间)有重要影响，但在对该特性进行实验后不久，我意识到无论我设置的样本大小是大是小，每次调用函数时，雪花都会执行全表扫描。样本大小将主要影响分类结果的准确性，而不是性能。如果您计划频繁运行分类过程，您应该评估性能。如果您发现分类很慢，您可以投入更多的计算能力来加快速度，或者使用像<a class="ae kv" href="https://docs.snowflake.com/en/sql-reference/constructs/sample.html#sample-tablesample" rel="noopener ugc nofollow" target="_blank">基于分数的行采样</a>这样的技术来绕过全表扫描。</p><h2 id="b200" class="mx lt iq bd lu my mz dn ly na nb dp mc lf nc nd me lj ne nf mg ln ng nh mi ni bi translated">5.展开性</h2><p id="bbcf" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一旦<em class="ns">EXTRACT _ SEMANTIC _ CATEGORIES</em>函数运行分类算法，下一步就是将生成的结果作为<a class="ae kv" href="https://docs.snowflake.com/en/user-guide/governance-classify-sql.html#category-tag-values-and-mappings" rel="noopener ugc nofollow" target="_blank">标签</a>应用于目标对象列。</p><p id="50cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">截至本文发布之日，可用的分类标签如下所示:</p><pre class="kg kh ki kj gt nj nk nt bn nu nv bi"><span id="f471" class="nw lt iq nk b be nx ny l nz nr">{<br/>  "name": [<br/>    "PRIVACY_CATEGORY",<br/>    "SEMANTIC_CATEGORY"<br/>  ],<br/>  "allowed_values": [<br/>    [<br/>      "IDENTIFIER",<br/>      "QUASI_IDENTIFIER",<br/>      "SENSITIVE",<br/>      "INSENSITIVE"<br/>    ],<br/>    [<br/>      "EMAIL",<br/>      "GENDER",<br/>      "PHONE_NUMBER",<br/>      "IP_ADDRESS",<br/>      "URL",<br/>      "US_STATE_OR_TERRITORY",<br/>      "PAYMENT_CARD",<br/>      "US_SSN",<br/>      "AGE",<br/>      "LAT_LONG",<br/>      "COUNTRY",<br/>      "NAME",<br/>      "US_POSTAL_CODE",<br/>      "US_CITY",<br/>      "US_COUNTY",<br/>      "DATE_OF_BIRTH",<br/>      "YEAR_OF_BIRTH",<br/>      "IBAN",<br/>      "US_PASSPORT",<br/>      "MARITAL_STATUS",<br/>      "LATITUDE",<br/>      "LONGITUDE",<br/>      "US_BANK_ACCOUNT",<br/>      "VIN",<br/>      "OCCUPATION",<br/>      "ETHNICITY",<br/>      "IMEI",<br/>      "SALARY",<br/>      "US_DRIVERS_LICENSE",<br/>      "US_STREET_ADDRESS"<br/>    ]<br/>  ]<br/>}</span></pre><p id="1e8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些标签已经为您定义好了，并且存储在雪花型<strong class="ky ir">只读</strong>共享数据库的核心模式中。这意味着，如果您想要通过使用<a class="ae kv" href="https://docs.snowflake.com/en/sql-reference/stored-procedures/associate_semantic_category_tags.html" rel="noopener ugc nofollow" target="_blank"><em class="ns">ASSOCIATE _ SEMANTIC _ CATEGORY _ TAGS</em></a>存储过程来自动应用标签，您将受限于这个可用标签列表。鉴于许多<strong class="ky ir">标识符</strong>和<strong class="ky ir">准标识符</strong>是<strong class="ky ir">关注美国的</strong>，你可能需要考虑定义你自己的标签列表。但是，真正的挑战是弄清楚这个新列表将如何与原列表一起工作。因此，您将经历额外的步骤，例如创建和设置标签:</p><pre class="kg kh ki kj gt nj nk nt bn nu nv bi"><span id="b0db" class="nw lt iq nk b be nx ny l nz nr">CREATE [ OR REPLACE ] TAG [ IF NOT EXISTS ] ...<br/>ALTER TABLE ... MODIFY COLUMN ... SET TAG</span></pre><h1 id="d376" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后的想法</h1><p id="23e0" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">总而言之，设计和构建数据分类解决方案并不是一件容易的事情。Snowflake 提供了一个很好的起点，它已经通过调用一个函数抽象出了许多挑战。但是，不要指望它会自动扫描您的整个数据仓库，并使用标签显示任何 PII。数据工程师仍然需要设计端到端的流程；包括但不限于构建一些工具来促进手动审查过程以及对数据量、预算和使用模式的优化。上面列出的五点可能没有涵盖 Snowflake 中 PII 分类特性产品化的所有方面。所以，如果你有不同的东西要补充，或者如果你认为某些方面可以用更好的方法来解决，请写下评论并分享你的想法。</p></div></div>    
</body>
</html>