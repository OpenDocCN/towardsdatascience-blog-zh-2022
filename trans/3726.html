<html>
<head>
<title>Error Handling in SQL — Part 13 Learn SQL Server Management Studio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL中的错误处理—第13部分了解SQL Server Management Studio</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/error-handling-in-sql-part-13-learn-sql-server-management-studio-94afb4cd1672#2022-08-18">https://towardsdatascience.com/error-handling-in-sql-part-13-learn-sql-server-management-studio-94afb4cd1672#2022-08-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fdf7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">实现这些简单的错误处理步骤来加强你的脚本</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/edce34c3c244fcf624ea265bd2a272c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/0*DUm1usOmvyc5UT6u"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">迈克尔·泽兹奇在<a class="ae ku" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="1ee4" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">在最后几集里…</h1><p id="1943" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">你好。欢迎来到SQL和SQL Server Studio系列教程的第13期。我的目标很简单:让你熟悉和适应这个工具和语言。“这有什么关系？”我知道你在问。事实证明，好奇心和副业往往是被新项目选中甚至获得新工作的关键。事实上，您已经使用了一个重要的工具，比如SQL Server Studio，并且编写了一些SQL查询，这将会给您一个清晰的开端。</p><ul class=""><li id="5d61" class="mj mk it lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated"><strong class="lp iu">在第1集</strong>中，我将向您展示<strong class="lp iu">如何设置我们的环境和本地服务器</strong> — <a class="ae ku" rel="noopener" target="_blank" href="/getting-started-with-sql-server-management-studio-part-1-step-by-step-setup-63428650a1e0">第1部分逐步设置SQL Server Studio </a></li><li id="9f38" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">在第2集</strong>中，我们将讲述<strong class="lp iu">如何创建数据库、表</strong>、<strong class="lp iu">和</strong>关于<strong class="lp iu">命名约定的重要注释— </strong> <a class="ae ku" rel="noopener" target="_blank" href="/getting-started-with-sql-server-management-studio-5cd24bb1a87c">第2部分数据库、表&amp;命名约定</a></li><li id="6e66" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">在第三集</strong>中，我们介绍了<strong class="lp iu"> CRUD操作</strong>和<strong class="lp iu">主键和外键</strong> — <a class="ae ku" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-3-crud-operations-primary-foreign-keys-9d884b32ad70">第三部分CRUD操作，主键&amp;外键</a></li><li id="314d" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">在第4集</strong>中，我们讨论了<strong class="lp iu">模式&amp;的主要规范化步骤</strong> — <a class="ae ku" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-4-schemas-normalization-80bcd6a5258">第4部分模式&amp;规范化</a></li><li id="c949" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">在第5集</strong>中，我们覆盖了<strong class="lp iu">存储过程&amp;调度</strong>，这是一个真正的野兽。我怎么强调这将如何促进和自动化你的日常(数据)生活都不为过。<a class="ae ku" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-5-stored-procedures-scheduling-88fd9788d314">第五部分存储过程&amp;调度</a></li><li id="1e35" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">在第6集</strong>中，我们介绍了用于ETL 的<strong class="lp iu"> SSIS包，并回顾了如何在两个数据库之间以及一个数据库和Excel之间导入和导出数据。<a class="ae ku" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-6-ssis-packages-9438dbc90437">第六部SSIS套餐简介</a></strong></li><li id="2d2b" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">在第7集中，我们<strong class="lp iu">将SQL Studio连接到PowerBI </strong>并构建我们的第一个视觉效果。<a class="ae ku" href="http://part%207%20connect%20to%20powerbi%20%26%20first%20visuals/" rel="noopener ugc nofollow" target="_blank">第7部分连接到PowerBI &amp;第一视觉效果</a>。</li><li id="23bc" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">在第8集</strong>中，我们<strong class="lp iu">利用SQL视图</strong>的强大功能，这是一个简单的轻量级工具，用于组合和检索复杂的表。你不会相信没有他们你怎么活下去。<a class="ae ku" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-8-leverage-the-views-206fbcef3957">第8部分利用观点</a></li><li id="33f1" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">在第9集中，我们利用临时表，在存储过程中临时存储和检索数据。找出中间结果并以表格形式缓存数据以备后用是非常有用的。在<a class="ae ku" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-9-temporary-tables-f69aee616833">第九部分临时表格</a>中了解更多信息</li><li id="edbc" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">第10集探讨了如何使用存储过程和调度任务将SQL数据导出为CSV文件并通过电子邮件发送。<a class="ae ku" rel="noopener" target="_blank" href="/learn-sql-server-management-studio-part-10-export-tables-by-email-as-csv-29bf2d990656">第10部分通过电子邮件以CSV格式导出SQL查询数据</a></li><li id="5aab" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">第11集</strong>跳入云端，在Azure Cloud中设置服务器和数据库。</li><li id="89cd" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated"><strong class="lp iu">第12集</strong>回顾了对相似数据行进行排序的简便方法，并通过窗口排序功能仅选择一行。</li></ul><p id="f95d" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">别忘了回来😉。</p><h1 id="c1d3" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">期待什么？</h1><p id="c54a" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">数据处理并不总是胆小的人的任务。因为它可以有许多形状和形式，所以记录本身的值有时会取意外的值。或者流程中的某个步骤可能会失败。每当它是存储过程的一部分时，我们可能希望忽略错误并继续前进到下一步。</p><p id="0b1f" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">为此，我们将调用TRY…CATCH语句。这类似于其他编程语言中的异常处理。这可能会解决一些错误，甚至可能会触发一个警报到您的邮箱来通知您。事不宜迟…</p><h1 id="bf37" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">开始—表创建</h1><p id="3a32" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们假设您已经设置好了SQL Server Studio环境。如果你需要任何帮助，请查看上面提到的第一集。</p><p id="ac40" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">让我们首先创建一个新表‘employee compensation’:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="8346" class="nh kw it nd b gy ni nj l nk nl">CREATE TABLE EmployeeCompensation</span><span id="5a48" class="nh kw it nd b gy nm nj l nk nl">(Name nvarchar(max), Salary int)</span></pre><p id="6116" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">现在让我们用一些数据填充它:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="2edc" class="nh kw it nd b gy ni nj l nk nl">INSERT INTO [dbo].[EmployeeCompensation]</span><span id="4ae5" class="nh kw it nd b gy nm nj l nk nl">VALUES ('Max', 1000)</span></pre><p id="afeb" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">让我们运行一个快速选择来验证我们是好的:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="d1ff" class="nh kw it nd b gy ni nj l nk nl">SELECT * FROM [dbo].[EmployeeCompensation]</span></pre><p id="bca5" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">这应该会返回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/1db5798f3b1e454ee2a833dc163ca433.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*otQgh7SUK9R5LgZVsQYrXQ.png"/></div></figure><h1 id="e8bb" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">测试错误</h1><p id="8e15" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">除以0会导致错误，因为这是未定义的。对于我们的例子来说，这是一个完美的罪魁祸首:</p><p id="f7e5" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">自己尝试一下:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="a6b5" class="nh kw it nd b gy ni nj l nk nl">INSERT INTO [dbo].[EmployeeCompensation]</span><span id="7390" class="nh kw it nd b gy nm nj l nk nl">VALUES ('Carl', 1/0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/3a6a5289b9dd9ffaae8a42d36d33e109.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*EL1roBN6wWro6r2tHG5lhw.png"/></div></figure><p id="07ea" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">可怜的卡尔拿不到任何薪水。这也终止了我们的声明。让我们用TRY…CATCH来覆盖我们的查询。</p><h1 id="ab4c" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">错误处理—语法</h1><p id="69e9" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">TRY…CATCH语法很简单，语法如下:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="f16f" class="nh kw it nd b gy ni nj l nk nl"><strong class="nd iu">BEGIN TRY</strong></span><span id="f2e2" class="nh kw it nd b gy nm nj l nk nl">  &lt;SQL query&gt;</span><span id="210e" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END TRY</strong><br/></span><span id="344f" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">BEGIN CATCH</strong></span><span id="c499" class="nh kw it nd b gy nm nj l nk nl">  &lt;SQL query&gt;</span><span id="9809" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END CATCH</strong></span></pre><p id="479f" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">在我们的示例中，这可以转化为:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="ae88" class="nh kw it nd b gy ni nj l nk nl"><strong class="nd iu">BEGIN TRY</strong></span><span id="aedd" class="nh kw it nd b gy nm nj l nk nl">   INSERT INTO</span><span id="c747" class="nh kw it nd b gy nm nj l nk nl">   [dbo].[EmployeeCompensation]</span><span id="b5fb" class="nh kw it nd b gy nm nj l nk nl">   VALUES ('Carl', 1/0)</span><span id="955e" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END TRY</strong></span><span id="756c" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">BEGIN CATCH</strong></span><span id="a263" class="nh kw it nd b gy nm nj l nk nl">  <strong class="nd iu">BEGIN</strong></span><span id="9de5" class="nh kw it nd b gy nm nj l nk nl">    EXEC msdb.dbo.sp_send_dbmail</span><span id="dd57" class="nh kw it nd b gy nm nj l nk nl">    @profile_name= '&lt;Your DB Email Account&gt;',</span><span id="7f9e" class="nh kw it nd b gy nm nj l nk nl">    @recipients= '&lt;youremail@email.com&gt;',</span><span id="5b33" class="nh kw it nd b gy nm nj l nk nl">    @subject = 'Error Process ABC - insertion error',</span><span id="f499" class="nh kw it nd b gy nm nj l nk nl">    @body =  'Hi, there was an error on Process ABC.',</span><span id="7b46" class="nh kw it nd b gy nm nj l nk nl">    @body_format = 'HTML'</span><span id="27f9" class="nh kw it nd b gy nm nj l nk nl">  <strong class="nd iu">END</strong></span><span id="602e" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END CATCH</strong></span></pre><p id="3872" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated"><strong class="lp iu">脚本的逐步纲要:</strong></p><ol class=""><li id="6e39" class="mj mk it lp b lq ml lt mm lw mn ma mo me mp mi np mr ms mt bi translated">我们首先尝试将值插入到EmployeeCompensation表中。</li><li id="c077" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi np mr ms mt bi translated">因为整数是1/0，这将引发一个错误。</li><li id="0eb8" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi np mr ms mt bi translated">在我们的例子中，我们将它嵌套在一个TRY语句中。这会导致SQL脚本触发CATCH部分，在这种情况下，它会向选定的邮箱发送一封警告电子邮件。电子邮件可以定制我们选择的标题和正文。</li></ol><p id="a603" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">当我们运行该脚本时，我们没有抛出错误，而是被告知有一封电子邮件已经排队并正在发往我们的邮箱:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/0665a3305d049a0c5264c7abec3d2a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*oIKTGL--R2YYcedSTL__PQ.png"/></div></figure><h1 id="3e10" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">获得关于错误的更多信息</h1><p id="f07a" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">这个错误已经被避免了…但是在这个设置下，在真实的场景中，我们不知道到底发生了什么。</p><p id="4c83" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">要是我们能对错误本身有所了解就好了。这可以帮助我们复制它，并调试或处理我们的脚本对此类错误场景的更好响应。</p><p id="4065" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">谢天谢地，有一个特殊的功能可以利用。它的名字不会让很多人感到惊讶:ERROR_MESSAGE()</p><p id="3742" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">它所做的是返回错误信息，通常是纯文本的，易于阅读。让我们测试一下，我们可以在CATCH块中添加下面一行:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="7ee9" class="nh kw it nd b gy ni nj l nk nl">PRINT(ERROR_MESSAGE()</span></pre><p id="6f31" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">我们可以将它嵌入到我们的脚本中:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="3fbd" class="nh kw it nd b gy ni nj l nk nl"><strong class="nd iu">BEGIN TRY</strong></span><span id="0bed" class="nh kw it nd b gy nm nj l nk nl">  INSERT INTO</span><span id="c0b7" class="nh kw it nd b gy nm nj l nk nl">  [dbo].[EmployeeCompensation]</span><span id="8673" class="nh kw it nd b gy nm nj l nk nl">  VALUES ('Carl', 1/0)</span><span id="7b80" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END TRY</strong></span><span id="f78a" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">BEGIN CATCH<br/>  </strong>PRINT(ERROR_MESSAGE())</span><span id="4b9f" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">  BEGIN</strong></span><span id="16e4" class="nh kw it nd b gy nm nj l nk nl">  EXEC msdb.dbo.sp_send_dbmail</span><span id="9ab1" class="nh kw it nd b gy nm nj l nk nl">  @profile_name= '&lt;Your DB Email Account&gt;',</span><span id="82ce" class="nh kw it nd b gy nm nj l nk nl">  @recipients= '&lt;youremail@email.com&gt;',</span><span id="53da" class="nh kw it nd b gy nm nj l nk nl">  @subject = 'Error Process ABC - insertion error',</span><span id="5143" class="nh kw it nd b gy nm nj l nk nl">  @body =  'Hi, there was an error on Process ABC.',</span><span id="681c" class="nh kw it nd b gy nm nj l nk nl">  @body_format = 'HTML'</span><span id="6cfa" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">  END</strong></span><span id="45ae" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END CATCH</strong></span></pre><p id="0394" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated"><strong class="lp iu">输出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/cd758479a441728a9b8013d7b22be010.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*zw3pr-wVBGcL_lzW3HWsJA.png"/></div></figure><ul class=""><li id="f1d7" class="mj mk it lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">未调整任何数据</li><li id="b8c6" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">我们获得了一个可读的错误信息</li><li id="5f3d" class="mj mk it lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">发送了一封电子邮件</li></ul><h1 id="24b0" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">最后的调整</h1><p id="7444" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们在电子邮件正文中发送错误消息，而不是在输出窗口中打印错误消息。这将提供个性化的信息，也留下了到底哪里出错的痕迹。</p><p id="6f44" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">这可以通过在我们的脚本中添加以下内容来实现:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="2963" class="nh kw it nd b gy ni nj l nk nl">DECLARE @body nvarchar(max)</span><span id="bc3d" class="nh kw it nd b gy nm nj l nk nl">SET @body = 'This is the error ' + ERROR_MESSAGE()</span></pre><p id="96c6" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">同时，我们可以删除PRINT(ERROR_MESSAGE())语句，因为这里不再需要它了。我们脚本的最后一部分应该是这样的:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="ef13" class="nh kw it nd b gy ni nj l nk nl"><strong class="nd iu">BEGIN TRY</strong></span><span id="eb7e" class="nh kw it nd b gy nm nj l nk nl">INSERT INTO</span><span id="d781" class="nh kw it nd b gy nm nj l nk nl">[dbo].[EmployeeCompensation]</span><span id="19b9" class="nh kw it nd b gy nm nj l nk nl">VALUES ('Carl', 1/0)</span><span id="2bc0" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END TRY</strong></span><span id="880a" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">BEGIN CATCH<br/>  BEGIN</strong></span><span id="723a" class="nh kw it nd b gy nm nj l nk nl">    DECLARE @body nvarchar(max)</span><span id="b2ed" class="nh kw it nd b gy nm nj l nk nl">    SET @body = 'This is the error ' + ERROR_MESSAGE()<br/>    EXEC msdb.dbo.sp_send_dbmail</span><span id="6c7d" class="nh kw it nd b gy nm nj l nk nl">    @profile_name= '&lt;Your DB Email Account&gt;',</span><span id="26e1" class="nh kw it nd b gy nm nj l nk nl">    @recipients= '&lt;youremail@email.com&gt;',</span><span id="03b3" class="nh kw it nd b gy nm nj l nk nl">    @subject = 'Error Process ABC - insertion error',</span><span id="4a32" class="nh kw it nd b gy nm nj l nk nl">    @body =  @body,</span><span id="6ed9" class="nh kw it nd b gy nm nj l nk nl">    @body_format = 'HTML'</span><span id="ba6a" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END</strong></span><span id="3c5a" class="nh kw it nd b gy nm nj l nk nl"><strong class="nd iu">END CATCH</strong></span></pre><p id="a40a" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">一封警告邮件应该已经在路上了，里面有关于错误的详细信息。</p><h1 id="5ffc" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">最后的话</h1><p id="af4f" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们现在理解了一个新的SQL语句，TRY…CATCH。通过处理错误，这有助于使许多流程更加健壮。然后，它还可以帮助我们修复一些不可预见的事件。警报通知将确保我们了解问题，并获得一些关于拒绝内容及其原因的有价值的见解。</p><p id="10a8" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">我希望你觉得这篇文章有用，让我知道你的想法，或者如果有我应该涵盖的主题。与此同时，请随时订阅并关注我。下次见！</p><h1 id="4f0e" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">快乐编码🎉！</h1></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><p id="cca4" class="pw-post-body-paragraph ln lo it lp b lq ml ju ls lt mm jx lv lw mz ly lz ma na mc md me nb mg mh mi im bi translated">感谢阅读！喜欢这个故事吗？<a class="ae ku" href="https://medium.com/@maximegodfroid/membership" rel="noopener"> <strong class="lp iu">加入媒介</strong> </a>可完整访问我的所有故事。或者通过<a class="ae ku" href="http://ko-fi.com/maximegodfroid" rel="noopener ugc nofollow" target="_blank"> <strong class="lp iu">我的ko-fi页面</strong> </a>用提示支持我</p></div></div>    
</body>
</html>