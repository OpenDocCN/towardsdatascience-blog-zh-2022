<html>
<head>
<title>SIR Model-Informed Probabilistic Estimation of Infectious-Disease Spread</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于SIR模型的传染病传播概率估计</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sir-model-informed-probabilistic-estimation-of-infectious-disease-spread-ec9d4a35453e#2022-09-29">https://towardsdatascience.com/sir-model-informed-probabilistic-estimation-of-infectious-disease-spread-ec9d4a35453e#2022-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dd60" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用Pymc3推断龙格-库塔积分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/18b55baaef7a1a15c03e5f408cd4fafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xEHwQKbWnhV1CI5QJXnpPA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">布莱恩·阿萨尔拍摄的图片</p></figure><p id="8af4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">机器学习方法在流行病学研究中发挥了重要作用。对这个领域感兴趣的数据科学家是幸运的，因为他们不必从头开始寻找数据驱动的解决方案。相反，他们会被一些经过充分研究的数学模型所引导。</p><p id="018b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章解释了如何使用<a class="ae kv" href="https://docs.pymc.io/en/v3/index.html" rel="noopener ugc nofollow" target="_blank"> Pymc3 </a>(一个用于贝叶斯统计建模的Python包)来构建贝叶斯推断，以预测由最基本的流行病学模型(例如SIR模型)提供的疾病传播。该实现也可以通过类似实现的<a class="ae kv" href="https://www.tensorflow.org/probability" rel="noopener ugc nofollow" target="_blank">张量流概率</a>来完成。请查看<a class="ae kv" href="https://colab.research.google.com/drive/13Ka-KV4HQMMRpdVYNJ3s_BkXg8ns8TnK#scrollTo=a-4vhzjAVc5P" rel="noopener ugc nofollow" target="_blank">笔记本</a>获取完整的python代码。</p><h1 id="f180" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">SIR模型</h1><p id="5b65" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Compartmental_models_in_epidemiology#The_SIR_model" rel="noopener ugc nofollow" target="_blank"> SIR模型</a>可能是最简单的房室模型，并衍生出许多变体。它描述了整个种群中三个基本区间的动态:易感个体、传染性个体和被移除的个体，正如该模型的名称所示。该模型值得一章，这篇文章不会深入到各种参考资料中很好解释的细节。取而代之的是，我们在这一节只做一个简单的介绍。</p><p id="50b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SIR模型通过一个常微分方程(ODE)给出了不同人群的动态，假设整个人群为常数N，忽略了流行病期间的出生率和死亡率。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/67017c746dad406836b36a284682e9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/format:webp/1*FWwhAkYEUg2a-bBtPR5LNg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者:SIR模特</p></figure><p id="4724" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">两个参数β和γ代表感染率和清除率。它们的比率是基本再生数，其值决定了流行病的渐近行为。一旦给出这两个参数，SIR模型所描述的流行病的动力学将被确定。</p><h1 id="1f5d" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">资料组</h1><p id="6608" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">以下模型化中使用的数据集是通过SIR模型的简单模拟生成的合成数据集。它包含在流行病的前30天期间易感个体、感染个体和被移除个体的人口。总人口为10000人，最初有10名感染者，9990名易感者，0名被清除者。我们想训练一个模型，预测未来30天的疫情。</p><p id="926a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了显示以下模型化的能力，只考虑了100个数据点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/d5c535bfd92905cc746882122421a150.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*SUimf3_W9GFiyfOnvEAgDQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:SIR人群数据集</p></figure><h1 id="798e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">SIR模型通知模型化</h1><h2 id="22a1" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">模型化的目标</h2><p id="109b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">分室模型应该指导机器学习方法来模拟流行病的发展。此外，对于给定的初始状态，如果我们知道β和γ的值，就可以得到SIR群的未来粒子数。因此，模型化的主要目标变成学习SIR模型的两个参数。</p><p id="7856" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同时，当我们记录不同群体的人口时，不确定性是不可避免的。因此，我们将建立一个SIR动态和贝叶斯推理的网络来学习两个相关参数中的后一个。</p><h2 id="d8c3" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">龙格-库塔法</h2><p id="e781" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">由ODE给定的SIR模型在被投入网络之前应该被离散化。在这里，我们将使用经典的四阶<a class="ae kv" href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods" rel="noopener ugc nofollow" target="_blank">龙格-库塔</a>积分，这是一种涉及逐次逼近求解微分方程的数值方法，其形式为dy/dx=f(x，y)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/6baa18aaad30bd239da3782bd279dba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*CXgEoHqrAdYGJ0vQKQOcpA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者:四阶<a class="ae kv" href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods" rel="noopener ugc nofollow" target="_blank">龙格-库塔</a></p></figure><h2 id="206a" class="mr lt iq bd lu ms mt dn ly mu mv dp mc lf mw mx me lj my mz mg ln na nb mi nc bi translated">推理</h2><ol class=""><li id="683d" class="ne nf iq ky b kz mk lc ml lf ng lj nh ln ni lr nj nk nl nm bi translated">将β和γ的先验设置为[0，1]中的均匀分布；</li><li id="9f9e" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">给定SIR的初始状态(用y0表示)，使用Runge-Kutta方法获得未来时刻的状态序列。</li><li id="153f" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">给每个实例添加一个项式泊松噪声。</li><li id="efc3" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">做贝叶斯推断得到β和γ的后验概率。</li></ol><p id="9077" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们不会在这篇文章中提供详细的代码。请读者阅读<a class="ae kv" href="https://colab.research.google.com/drive/13Ka-KV4HQMMRpdVYNJ3s_BkXg8ns8TnK#scrollTo=o22Tu93XJFTT" rel="noopener ugc nofollow" target="_blank">笔记本</a>，欢迎提问。</p><h1 id="c3bb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结果</h1><p id="587f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在100个数据点上训练，参数收敛到以0.6和0.3为中心的正态分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d1fbf87a488a9b29a5bfd2fffd6b2963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*A7kxf-Ol9LNpnYaJNwU4Zw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:参数跟踪图</p></figure><p id="60c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们可以预测接下来30天的SIR数量。我们可以在图中看到，流行病趋于渐近平衡。幸运的是，我们最终几乎不再看到新的病例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/a4ca340ce578775aae6316456972466e.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*w4m9vcfbTJpPPw3Jv9cz_g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片:30天后疫情动态</p></figure><h1 id="f1dd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="47f6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这篇文章中，我们将一个数学模型插入到贝叶斯推理中，并将其应用于传染病传播用例。当模型被一些背景知识告知时，小数据集似乎足以用于参数的收敛。</p><p id="8ea0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们要指出，合成数据集只是一个理想的情况，有些不真实的简化。一个有趣的下一步将是在真实数据集上测试该模型，例如大城市的covid案例。</p></div></div>    
</body>
</html>