<html>
<head>
<title>Deriving a Formula for the Length of a Tennis Game</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推导网球比赛时长的公式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deriving-a-formula-for-the-length-of-a-tennis-game-9b5a4a1a92dd#2022-03-03">https://towardsdatascience.com/deriving-a-formula-for-the-length-of-a-tennis-game-9b5a4a1a92dd#2022-03-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/541181a240c3fc8fd1bb2143c43c34b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7AFAFwEN3-U-dn3otEPwA.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Jeffery Erhunse 在 Unsplash 上的照片</p></figure><div class=""/><div class=""><h2 id="837b" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">使用基于点数的建模方法得出每场比赛的预期点数</h2></div><p id="8874" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在变得兴奋和深入二项变量和几何级数的本质之前，让我们从头开始。为什么？为什么我们会关心如何写一个网球比赛长度的方程？</p><p id="6e8f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当谈到能够为一场网球比赛的持续时间写一个“封闭形式的方程”时，答案可能是我们<em class="lr">不在乎(除了只想掸掉数学蜘蛛网上的灰尘)。在计算机和模拟的时代，不需要没有用的数值帮助就能解决这个问题。但是能够将网球比赛的持续时间与发球方在任何给定的点<em class="lr">获胜的概率<code class="fe ls lt lu lv b">p</code>联系起来的想法是</em>有用的。</em></p><p id="1908" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">网球目前是:</p><ul class=""><li id="c986" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">随着比赛变得越来越长，非常长的比赛越来越频繁，显然陷入了一点危机。</li><li id="247f" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">预示着新一批更高的球员，更高的球员带来更凶猛的发球，并在任何特定的比赛中给发球球员更多的统治力。</li></ul><p id="2117" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">思考以上两件事是我如何在业余时间琢磨这个想法的。下面是一个使用“基于点的建模”的演练，演示如何在一场给定的网球比赛中推导出预期点数的公式，然后用 python 进行了一点模拟，以确保我没有在所有<code class="fe ls lt lu lv b">p</code>和<code class="fe ls lt lu lv b">n</code>飞来飞去的时候走错地方。</p><h2 id="3cf0" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">基于点的建模基础</h2><p id="0238" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">给定服务器赢得一分的概率<code class="fe ls lt lu lv b">p</code>(因此返回者的<code class="fe ls lt lu lv b">(1-p)</code>获胜)，如果我们玩<code class="fe ls lt lu lv b">n</code>分，我们可以将服务器赢得<code class="fe ls lt lu lv b">x</code>分的概率写为:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/fff72fce9d27b55c3bdeba2bde565658.png" data-original-src="https://miro.medium.com/v2/format:webp/1*JufgM-lqONeGQDX06PueoQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="f986" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这只是一个陈述，概率遵循二项式分布，因为每个点都被视为二元结果(或者伯努利随机变量，如果你觉得有趣的话)。一场网球比赛可以被认为是围绕着一些标准的各种分数的集合，例如:</p><ul class=""><li id="b3a4" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">一旦一个玩家得到 4 分，他们就赢得了比赛</li><li id="c026" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">如果两个玩家都是 3 分，那么你需要得到 2 分(平手)</li></ul><p id="aabb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以用下图描绘一场网球比赛的结构:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/ea9ad4a18e3dcdc74fc34106c71e560e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*PlVccXYG0-X3FNJB49Z0qw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图片由作者使用<a class="ae jd" href="https://app.diagrams.net/" rel="noopener ugc nofollow" target="_blank">https://app.diagrams.net/</a></p></figure><p id="aefe" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们通过几个例子来解释这个图表。如果服务器赢了每一分，那么我们沿着上面的对角线——我们玩 4 分，并且以概率<code class="fe ls lt lu lv b">p</code>服务器赢了每一分。按照上面的格式写下来:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/3f14863dbcce4f91f6058b230d8b89fb.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1JzRBQZUxMn1OzzrhEEK1A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="55bf" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">…在这里，我介绍了上面的<code class="fe ls lt lu lv b">p(4,0)</code>符号，表示游戏以服务器赢得 4 分和返回者赢得 0 分而结束的概率。</p><p id="f839" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">类似地，如果服务器赢了 4 分，返回者赢了 1 分，那么我们沿着对角线向上，但是在某一点我们向下倾斜，因为返回者赢了一分。重要的是，<strong class="kx jh">这种下降不会发生在最后的</strong>时刻，即服务器赢得 4 分，然后<em class="lr">返回者赢得他们的分，因为在这种情况下，游戏已经结束了。因此，我们需要消除发生这种情况的场景——当服务器连续赢得 4 分时。</em></p><p id="9273" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是<a class="ae jd" href="https://en.wikipedia.org/wiki/Inclusion%E2%80%93exclusion_principle" rel="noopener ugc nofollow" target="_blank">包含-排除原则</a>的一个应用，在整个过程中都很重要——假设我们没有平手，一旦一个玩家赢得 4 分，游戏就结束了。同样，如果你想想象一下，那么你可以说我们正在模拟一个马尔可夫链，我们已经达到了一个“吸收状态”——即一个玩家达到 4 分，我们不再“过渡”到其他状态，因为游戏已经结束。</p><p id="3a95" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用上面的符号，我们最终得到:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/d8d77a7f0889a1e5a2f8b134d90e81de.png" data-original-src="https://miro.medium.com/v2/format:webp/1*PpgAj8JRSjO131TJWmwFMQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="63ca" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">…这里的<code class="fe ls lt lu lv b">(4, 4)</code>减法是去除 1 个状态，在该状态下，发球方连续赢得 4 分，然后<em class="lr">和</em>发球方赢得他们的。</p><h2 id="246a" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">将获胜概率转化为游戏持续时间</h2><p id="e164" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">在上面我们已经关注了<em class="lr">概率</em>，但是我们在这里关心的是一场游戏的<em class="lr">持续时间</em>。事实上，当我们有一个给定的服务器赢得分数的概率<code class="fe ls lt lu lv b">p</code>时，我们关心的是<em class="lr">期望的</em>游戏持续时间。为了计算这一点，我们真的需要求和:</p><ul class=""><li id="ef5e" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">在<code class="fe ls lt lu lv b">x</code>点数后游戏结束的概率</li><li id="d281" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">次数<code class="fe ls lt lu lv b">x</code> -玩的点数</li></ul><p id="748d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于<code class="fe ls lt lu lv b">x</code>的每个值。我们可以把它写成下面的等式:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/6d7ce18c9c48de80b69e8e7393977b1e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*LWpXHMx4naeOqm65NIeT2w.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="afec" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们有:</p><ul class=""><li id="a60f" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">“赢得爱情”(发球者或回球者)的概率乘以 4 点</li><li id="3a12" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">“赢到 15 分”(发球方或回球方)的概率乘以 5 分</li><li id="956a" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">等等。等等。等等。</li><li id="fd9e" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">一些“包罗万象”的术语，指的是更复杂的平分，因为它涉及一些潜在的来回(将在后面讨论)。</li></ul><p id="2137" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">考虑到每场比赛至少要有 4 分，我们可以将它改写为:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/3f41ab9157bed2d2dbb7678770e224f0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*PwRvJWTw4B1XAUjFuoknnA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="5ce0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">…其中<code class="fe ls lt lu lv b">p(n)</code>表示在<code class="fe ls lt lu lv b">n</code>点后游戏结束的概率。在上文中，我们只是重新考虑了一些因素，因此我们没有“概率乘以点数”，而是“概率乘以额外的点数”——额外点数是指每场比赛最低 4 点以上的点数。我们现在可以依次讨论这些术语。</p><h2 id="fa70" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">打了 5 分(多打了 1 分)</h2><p id="c20c" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">正如我们在上面看到的，我们有一个游戏“赢到 15 分”的概率公式。现在需要做的就是把服务器赢的概率加到 15，返回者赢的概率加到 15。这里我们可以利用二项分布是对称的这一事实；</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/17b1456cb5fd240d5460ca4f06cfaea8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1HsYwZedc_mDtBEIKD6ffw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="dad4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后我们得到 5 分后游戏结束的概率:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/c6147563a405c51ee8f885eff92ad13a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*qE2EhqyZRFNPabCthywg0A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="8ffe" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这里，我们利用了对称性的事实来折叠二项式系数，即<code class="fe ls lt lu lv b">(5,1) = (5,4)</code>和<code class="fe ls lt lu lv b">(4,4) = (4,0)</code></p><h2 id="204f" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">打了 6 分(多打了 2 分)</h2><p id="d7a1" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">与上面非常相似，我们可以计算出我们打 6 分并且比赛结束的概率，然后我们将它乘以 2，因为我们在网球比赛中比最低的 4 分多打了 2 分:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/1553d55ed14804a96af8b4a75de257a9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*VyPA2nDl5rrijKNGUriJsQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><h2 id="4318" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">两点</h2><p id="1f89" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">与前一个例子不同，使用“平分”,我们需要计算 2 个分量，而前一个例子中我们只需要计算 1 个分量——在该状态下结束的概率。这两个组件是:</p><ul class=""><li id="4c3b" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">在打完<code class="fe ls lt lu lv b">n</code>分后以那种状态结束的概率(就像以前一样)。</li><li id="d57e" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">玩的点数</li></ul><p id="1020" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以按顺序拍摄。</p><h2 id="9d99" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">平手的概率</h2><p id="9669" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">这一点相对简单，因为平分的概率只是每个玩家赢得 3 分的情况下玩 6 分的概率——直接来自二项式分布:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/2424b0a2e50dda0223933e3472a88151.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Rn0SHafZmznND7y5GxmKqg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><h2 id="1b02" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">点数打成平手</h2><p id="c875" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">这是最难的部分。一旦我们打成平手，我们知道我们将在一场比赛的最低 4 分的基础上再多打 4 分。换句话说，我们能玩的最低分是 8 分——6 分平手，2 分如果平手被直接“解决”。然而，如果我们来回一点，我们可能会玩得更多(先取得优势，然后回到平手等)。就像之前一样，我们需要把事情分成游戏结局:</p><ul class=""><li id="b22e" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">如果服务器赢了。</li><li id="dfa0" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">如果返回者获胜。</li></ul><h2 id="8c77" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">如果服务器赢了，额外加分</h2><p id="9d40" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">如果服务器以平手获胜，我们可以将期望的额外点数表述为:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/4c0d5e1ae7771b956ffbf706faf61eaf.png" data-original-src="https://miro.medium.com/v2/format:webp/1*EXrEm6o_TJ0YnTggyD2cNg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="cdef" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是什么意思？</p><ul class=""><li id="6f49" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated"><code class="fe ls lt lu lv b">p(n+2,n)</code>是返回者有 n 分，服务器多 2 分的概率。从平手开始，比赛就结束了，因为从平手开始，再赢 2 分就足以赢得比赛。</li><li id="0b73" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe ls lt lu lv b">[4 + 2n]</code>是额外的分数，例如，如果我们立即“解决”平分，即<code class="fe ls lt lu lv b">n=0</code>，那么我们有 4 个额外的分数。</li><li id="49ce" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">然后，我们对所有可能的<code class="fe ls lt lu lv b">n</code>求和，即<code class="fe ls lt lu lv b">n=0</code>是如果立即解决平分，<code class="fe ls lt lu lv b">n=1</code>是如果我们来回一次，<code class="fe ls lt lu lv b">n=2</code>是如果我们来回两次等等。等等。</li></ul><p id="0422" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们首先需要进入<code class="fe ls lt lu lv b">p(n+2, n)</code>——我们可以这样写:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/e378c50059e07f26a282333b3a7861bb.png" data-original-src="https://miro.medium.com/v2/format:webp/1*p0AVDUpEBNFZ2TZjwktkiQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="beef" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了解决这个问题，我们可以去掉所有不依赖于<code class="fe ls lt lu lv b">j</code>的东西，并利用二项式系数的<a class="ae jd" href="https://en.wikipedia.org/wiki/Binomial_coefficient#Sums_of_binomial_coefficients" rel="noopener ugc nofollow" target="_blank">和公式:</a></p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/9ebe12ddb4c84e38aad122070603a97d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*bZisQYr4APn0CK_QiQaF3A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="cd1a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这留给我们以下等式:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/49e90f747f853cae5fe2b7a0f4a5bef8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Zkqvb8GUEeHYgNEimm5YRA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="1fab" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将这个代入上面的等式，我们得到:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/f026c62b27644b492e0f742f4fbba59f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1eIdLMjBFaml5lmuz6vS0A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="1b2b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">…我们在上面的结果中进行了替换，并去掉了<code class="fe ls lt lu lv b">[4+2n]</code>括号，将<code class="fe ls lt lu lv b">p^2</code>移到求和之外，因为它不依赖于<code class="fe ls lt lu lv b">n</code>。这意味着我们现在有两个术语:</p><ul class=""><li id="c81e" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">4(如果我们打成平手，所打的最少额外杆数)乘以服务器赢平手的概率。</li><li id="f363" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated"><code class="fe ls lt lu lv b">2n</code>(来回的加分)乘以来回<code class="fe ls lt lu lv b">n</code>轮后平手结束的概率。</li></ul><p id="a34d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">查看这些表达式，我们会发现它们都是几何级数，但形式略有不同。第一项是以下形式的标准几何级数:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/b78484f814b4e3a82434482281fb5de8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*tAru6Jllsb_xLlyF8qMBeg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="67fc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">…最后，我根据我们的情况进行了替换:<code class="fe ls lt lu lv b">r=2p(1-p)</code>。第二个系列的形式为:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/044ecef30982899d51fb867d257e2f68.png" data-original-src="https://miro.medium.com/v2/format:webp/1*szdHQYsXEjyVlR4yaQeepw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="e977" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以先解决这个问题，如果我们对之前的“标准”几何级数进行微分，我们会得到:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/e662b4cb82914f54b85454b7661287f0.png" data-original-src="https://miro.medium.com/v2/format:webp/1*zQagN2YqRL530mtmJad6wA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="80a8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还可以区分该系列的解决方案，以获得:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/c106b88b57e53de69968e6ffc097f023.png" data-original-src="https://miro.medium.com/v2/format:webp/1*DLhCnb9UqiyhLXuZL7963w.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="69d3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后我们可以乘以<code class="fe ls lt lu lv b">r</code>得到我们感兴趣的量:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/3e1923b196c0fb8874834fe78613d272.png" data-original-src="https://miro.medium.com/v2/format:webp/1*8VIeQ_j-01vU7h-rtEfEzA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="12e0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">代入我们的情况<code class="fe ls lt lu lv b">r=2p(1-p)</code>，我们得出:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/9a7ff9d780f3c7e99a85a6c8942a6c41.png" data-original-src="https://miro.medium.com/v2/format:webp/1*SzRZA7VnmWYv4cLs7RRrsQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="88ce" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们有了构建模块，我们可以将它们放在一起，以获得预期的额外分数:</p><ul class=""><li id="131c" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">一旦我们进入平手</li><li id="47fa" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">如果服务器赢了</li></ul><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/dbd2feb224ac8acb5b2d08d95167b75c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*AgaOGAal1vWa6LwYALaVvA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="8e62" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">换句话说，这表明我们增加了 4 个点乘以服务器赢得平分的概率，再加上 2 个额外的点乘以服务器最终赢得平分的“来回”的预期持续时间。虽然有点拗口，但是能够用英语陈述这个等式总是很好的——即使它不是“简单”的英语。</p><h2 id="2a04" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">如果返回者获胜，则加分</h2><p id="0240" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">我们已经完成了服务器案例的所有繁重工作，返回器几乎完全相同，除了我们将几个<code class="fe ls lt lu lv b">p</code>转换为<code class="fe ls lt lu lv b">(1-p)</code>。为返回器添加的额外点数的表达式为:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/f4d0a1ece210cece33c5098c2385911a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*gGJuG99ONJWRJIoNwb3z_Q.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><h2 id="1f62" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">把所有的放在一起</h2><p id="b244" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">现在我们已经计算了所有的组件，是时候把它们放在一起了。在所有的推导和替换之后提醒我们自己:</p><ul class=""><li id="f8d3" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">4 个基点</li><li id="92db" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">5 个总点数乘以 1 个额外点数后游戏结束的概率</li><li id="6b90" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">在 6 个总点数乘以这 2 个额外点数后游戏结束的概率</li><li id="88b5" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">我们打成平手并且服务器获胜的概率乘以与之相关的额外分数</li><li id="3fec" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">我们进入平手和返回者获胜的概率乘以与此相关的额外分数</li></ul><p id="eda1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在是丑陋的部分:</p><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/8588b175bbebf79e8880dce747a2e988.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ft4yx7A3w4p1Mlbw5TI5pA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><h2 id="3793" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">我们的函数在图形上是什么样的？</h2><p id="d18b" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">现在我们有了方程，让我们:</p><ul class=""><li id="e2b3" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">用 python 写出来</li><li id="7af9" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">将输出与模拟游戏持续时间进行比较</li><li id="1532" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">尝试产生一些有趣的结果</li></ul><p id="35f9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是上述公式在 python 中的实现:</p><figure class="ni nj nk nl gt is"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="46b1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么它看起来如何呢——让我们画出<code class="fe ls lt lu lv b">p</code>的不同值的<code class="fe ls lt lu lv b">game_length</code>的输出。从上面的公式中可以看出:</p><ul class=""><li id="4031" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">有了<code class="fe ls lt lu lv b">p=0</code>或<code class="fe ls lt lu lv b">p=1</code>，我们会期望<code class="fe ls lt lu lv b">game_length</code>输出 4——这个游戏只能因爱而赢或输</li><li id="6863" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">随着<code class="fe ls lt lu lv b">p</code>的到来，游戏的预期长度会增加，因为有更多的额外积分可以玩</li></ul><figure class="ni nj nk nl gt is"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/25ed013d77825ee09e580f4b1bb5a050.png" data-original-src="https://miro.medium.com/v2/format:webp/1*acOexIleBZ7VMJyUhRM4eQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="8fe9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们可以看到:</p><ul class=""><li id="47da" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">正如所料，在极端情况下，我们最终最多打了 4 分。</li><li id="1548" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">随着游戏变得更加平衡(<code class="fe ls lt lu lv b">p</code>接近 50%)，那么预期的游戏持续时间增加到 6.75 的峰值。</li><li id="2b8e" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">预期游戏持续时间的增加是由于游戏“赢到 30 分”的概率增加，但尤其是进入平手，这总体上支配了额外的游戏时间。</li></ul><p id="ee02" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由此得出了一个很好的结论。如果人们真的担心整个网球比赛的长度，那么有一个简单的建议——删除平分，并用“突然死亡”点代替。事实上，这是过去 4 年来在下一代 ATP 总决赛中测试过的东西。</p><h2 id="5b3d" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">使用 python 进行检查</h2><p id="36fa" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">现在，让我们模拟网球比赛，看看我们的公式的输出如何与它们生成的比赛长度分布进行比较。为了模拟网球比赛，我们将使用我编写的轻量级<a class="ae jd" href="https://github.com/mjam03/tennisim" rel="noopener ugc nofollow" target="_blank"> tennisim </a>包。</p><figure class="ni nj nk nl gt is"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="ni nj nk nl gt is gh gi paragraph-image"><div class="ab gu cl nm"><img src="../Images/b947415c91bfb2f3b5e4243ed838ef67.png" data-original-src="https://miro.medium.com/v2/format:webp/1*kDryoJirkhp7k5rIdTcebQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="e9b0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上图显示了不同的<code class="fe ls lt lu lv b">p</code>值在我们运行模拟时游戏长度的分布情况。具体到左上角的图表，我们有:</p><ul class=""><li id="4cc0" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">模拟 100 个游戏并记录它们的平均长度</li><li id="6237" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">重复了 1000 次</li><li id="93c4" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">将这些值绘制成一个分布，并在我们推导出的方程值上标记为垂直红线</li></ul><p id="680e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">鉴于红线似乎正好位于每个分布的中间，那么我们可以说情况看起来相当不错。</p><h2 id="ba75" class="mk ml jg bd mm mn mo dn mp mq mr dp ms le mt mu mv li mw mx my lm mz na nb nc bi translated">结论</h2><p id="a23e" class="pw-post-body-paragraph kv kw jg kx b ky nd kh la lb ne kk ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">正如开始提到的，<em class="lr">需要</em>来表达一场网球比赛的长度，因为一个封闭形式的方程是最小的。这一点通过以下事实得到了证明:</p><ul class=""><li id="26d5" class="lw lx jg kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">“暴力破解”和模拟数百万场网球比赛只需要很少的代码</li><li id="2365" class="lw lx jg kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">100，000 场游戏需要&lt; 1 second to simulate (using  【T1】  on my mac)</li></ul><p id="3c09" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Nevertheless sometimes it’s fun to see if it can be done as well as provide some useful insights as to <em class="lr">为什么</em>游戏越平衡时间越长。</p><p id="c2bc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如上图之一所示，<strong class="kx jh">更长预期游戏的真正驱动因素是进入平手</strong>。杜斯相对于<code class="fe ls lt lu lv b">4</code>的最短持续时间增加的额外 4 个镜头，以及如果你来回移动的话<em class="lr">甚至更多</em>的潜力是真正推动期望更高的原因。如果真的担心网球比赛的长度，那么取消平局可能是保留其他驱动比赛长度的方面(抢七局，现有的设置结构)的一种方式，同时缩短比赛——因此比赛。</p></div></div>    
</body>
</html>