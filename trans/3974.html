<html>
<head>
<title>How to Set Up Ingress Controller in AWS EKS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在自动气象站EKS设置入口控制器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-set-up-ingress-controller-in-aws-eks-d745d9107307#2022-09-03">https://towardsdatascience.com/how-to-set-up-ingress-controller-in-aws-eks-d745d9107307#2022-09-03</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="3c5d" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">以正确的方式在AWS EKS上部署入口控制器。</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/28d9b9f59d155d1d3948f602800d5623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xi_9HiGrnHyG_dBwMa4dUg.jpeg"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/es/@andreazanenga?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">安德里亚·扎能加</a>在<a class="ae kw" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><blockquote class="kx ky kz"><p id="f839" class="la lb lc ld b le lf js lg lh li jv lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">特征图像突出了大规模编排的重要性，这是承诺，也是选择Kubernetes的众多原因之一！</p></blockquote><h1 id="daa3" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">先决条件</h1><p id="1b99" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">本文中的一般指南适用于那些对Kubernetes、Helm和AWS云解决方案有相当了解的人。此外，请记住，这里介绍的方法是我为我的公司建立Kubernetes集群的尝试，您可以随时决定偏离这一方法以适应您的用例或偏好。</p><p id="98e6" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">说完这些，让我们直接开始吧。</p><h1 id="5fdf" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">那么，入口控制器到底是什么？</h1><p id="8290" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">与Kubernetes中负责将当前状态带入所需状态的其他"<a class="ae kw" href="https://kubernetes.io/docs/concepts/architecture/controller/" rel="noopener ugc nofollow" target="_blank">控制器</a>一样，入口控制器负责创建集群的入口点，以便<a class="ae kw" href="https://kubernetes.io/docs/concepts/services-networking/ingress/" rel="noopener ugc nofollow" target="_blank">入口</a>规则可以将流量路由到定义的<a class="ae kw" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank">服务</a>。</p><p id="bc32" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">简而言之，如果您将网络流量发送到端口80或443，入口控制器将根据入口规则确定该流量的目的地。</p><blockquote class="mx"><p id="ab42" class="my mz ir bd na nb nc nd ne nf ng lw dk translated">你必须有一个<a class="ae kw" href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers" rel="noopener ugc nofollow" target="_blank">入口控制器</a>来满足一个入口。仅创建入口资源没有效果[ <a class="ae kw" href="https://kubernetes.io/docs/concepts/services-networking/ingress/#prerequisites" rel="noopener ugc nofollow" target="_blank">来源</a> ]。</p></blockquote><p id="19e7" class="pw-post-body-paragraph la lb ir ld b le nh js lg lh ni jv lj mr nj lm ln mt nk lq lr mv nl lu lv lw ik bi translated">举个实际的例子，如果您定义一个入口规则来路由所有到达前缀为<code class="fe nm nn no np b">/</code>的<code class="fe nm nn no np b">example.com</code>主机的流量。除非您的入口控制器能够根据定义的入口规则区分流量的目的地并对其进行路由，否则此规则将不起作用。</p><p id="823a" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">现在，让我们看看入口控制器在AWS之外是如何工作的。</p><h1 id="71b9" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">其他入口控制器是如何工作的？</h1><p id="fed7" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">我所知道的所有其他入口控制器都是这样工作的:你将控制器公开为一个<a class="ae kw" href="https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer" rel="noopener ugc nofollow" target="_blank">负载平衡器服务</a>，它将负责处理流量(SSL卸载、路由等)。).</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nq"><img src="../Images/39a1d8e69033ecebd4d1dd9f5c6a03fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UYY23HyPO3YrhYG9smr2sQ.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">入口控制器如何在Kubernetes的世界中工作(图片由作者提供)</p></figure><p id="7cdc" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">这样做的结果是，创建了一个负载平衡器后，集群中将会有以下内容:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">使用kubectl获取服务信息</p></figure><p id="da9d" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">这里有一个命令来验证您的负载平衡器服务是否就绪。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">使用AWS CLI描述负载平衡器</p></figure><h1 id="ffed" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">这种做法有什么问题？</h1><p id="d7fe" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">负载平衡器服务对于其他云提供商来说可能是理想的，但对于AWS来说不是，这是一个关键原因。创建该服务后，如果您转到EC2控制台的Load Balancer选项卡，您会看到负载平衡器的类型是“classic”(AWS称之为“legacy”负载平衡器)，并要求立即迁移，原因如下所述。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nt"><img src="../Images/2f6b53abd2b1cc10b8d7dd5552b175da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cddAaRsk0U6izyxhkbN4jQ.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">取自AWS控制台(图片由作者提供)</p></figure><p id="b09f" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">由于经典负载平衡器<a class="ae kw" href="https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/migrate-classic-load-balancer.html" rel="noopener ugc nofollow" target="_blank">已于2022年8月15日</a>达到其寿命终点，您不应该在AWS平台内部使用它。因此，您永远不要将任何<a class="ae kw" href="https://kubernetes.io/docs/concepts/services-networking/service/" rel="noopener ugc nofollow" target="_blank">服务</a>公开为负载均衡器，因为任何这种类型的服务都会产生一个“经典的”负载均衡器。他们推荐较新版本的负载平衡器(应用程序、网络或网关)。</p><p id="04d3" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">避免“经典”负载平衡器是我们选择AWS支持的替代解决方案的主要原因，因为它让我们能够利用Kubernetes工作负载。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nu"><img src="../Images/9738f5e6a904c3771d557c7d0be594c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bpGmrT49j-AJbYnOK6DJYQ.jpeg"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@cdx2?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> C D-X </a>在<a class="ae kw" href="https://unsplash.com/s/photos/technology?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="4875" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">那么还有什么选择呢？</h1><p id="888e" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">当我第一次观察到，与其他入口控制器(HAProxy，Nginx等)不同，我感到震惊。)，AWS负载平衡器控制器不会公开Kubernetes集群内部的负载平衡器服务。入口控制器是CKA考试的基本主题之一[ <a class="ae kw" href="https://github.com/cncf/curriculum/blob/master/CKA_Curriculum_v1.24.pdf" rel="noopener ugc nofollow" target="_blank">来源</a> ]。</p><p id="b9ae" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">但是，仅仅因为AWS对其他入口控制器的支持很差，您就不想失去Kubernetes的任何丰富功能，直接进入特定于供应商的产品，并成为供应商锁定的产品；至少，我知道我不想。</p><blockquote class="kx ky kz"><p id="94cb" class="la lb lc ld b le lf js lg lh li jv lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我个人的偏好是有一个受管理的Kubernetes控制平面，带有我自己的自管理节点，但是当然，你可以在这里自由选择你自己的设计！</p></blockquote><p id="37fd" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">这里的替代方法是使用<a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/" rel="noopener ugc nofollow" target="_blank">AWS入口控制器</a>，如果您在其他地方运行Kubernetes，它将允许您拥有相同的工作负载和资源，只是有一点点配置差异，如下所述。</p><h1 id="5eaa" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">但是Ingress控制器在AWS的世界里是如何工作的呢？</h1><p id="8cad" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">入口控制器在AWS EKS内部工作，将入口资源“分组”在一个名称下，使它们可以从单个AWS应用负载平衡器访问和路由。您应该通过您在集群中创建的每个入口中的注释来指定“分组”,或者是通过IngressClassParams 指定<a class="ae kw" href="https://github.com/aws/eks-charts/blob/3798fa6ce1350eed02e8b6c15b19a2e7c5a79078/stable/aws-load-balancer-controller/templates/ingressclass.yaml#L35" rel="noopener ugc nofollow" target="_blank">,或者是通过</a><a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/guide/ingress/annotations/#group.name" rel="noopener ugc nofollow" target="_blank">。我不知道你怎么想，但我更喜欢前者！</a></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nv"><img src="../Images/d024ce16b6f2ca5820d710272d2a559a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ig_nWLtln7ybZO_yrQHUCg.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">入口控制器如何在AWS的Kubernetes世界中工作(图片由作者提供)</p></figure><p id="473d" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">“入口组”不是一个有形的物体，也没有任何花哨的功能。它只是一组入口资源<a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/guide/ingress/annotations/#group.name" rel="noopener ugc nofollow" target="_blank">以同样的方式</a>进行注释(如前所述，您可以通过<a class="ae kw" href="https://gist.github.com/meysam81/d7d630b2c7e8075270c1319f16792fe2#file-aws-load-balancer-values-yml-L20" rel="noopener ugc nofollow" target="_blank">在Ingres class</a>中传递“group”名称来跳过对每个入口的注释)。这些入口资源共享一个组名，并且可以被假设为一个单元，共享相同的ALB作为边界来管理流量、路由等。</p><p id="abfe" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">上面提到的最后一部分是AWS内部和外部的入口资源之间的差异。因为尽管在Kubernetes的世界里，你不需要处理所有这些分组，但是当你使用AWS EKS时，这种方法是可行的！</p><p id="e467" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">我对实现这一点和管理配置并不感到不舒服，特别是因为Nginx、HAProxy和其他入口控制器都有自己的调整和配置注释集，例如，要重写Nginx入口控制器中的路径，您可以使用<code class="fe nm nn no np b">nginx.ingress.kubernetes.io/rewrite-target</code>注释[ <a class="ae kw" href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#rewrite" rel="noopener ugc nofollow" target="_blank">源</a>。</p><p id="e4f9" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">这里要提到的最后一个重要注意事项是，您的服务不再是<code class="fe nm nn no np b">ClusterIPs</code>，而是<code class="fe nm nn no np b">NodePorts</code>，这使得它们在集群中的每个工作节点上发布服务(如果pod不在一个节点上，<code class="fe nm nn no np b">iptables</code>重定向流量)<a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/guide/ingress/annotations/#target-type" rel="noopener ugc nofollow" target="_blank">源</a>。您将负责管理安全组，以确保节点可以在临时端口范围[ <a class="ae kw" href="https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html" rel="noopener ugc nofollow" target="_blank"> source </a> ]上进行通信。但是如果你<a class="ae kw" href="https://eksctl.io/" rel="noopener ugc nofollow" target="_blank">使用</a> <code class="fe nm nn no np b"><a class="ae kw" href="https://eksctl.io/" rel="noopener ugc nofollow" target="_blank">eksctl</a></code> <a class="ae kw" href="https://eksctl.io/" rel="noopener ugc nofollow" target="_blank">来创建你的集群</a>，它会照顾到所有这些以及更多。</p><p id="bda7" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">现在，让我们开始部署控制器，以便能够创建一些入口资源。</p><h1 id="80b9" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">部署AWS入口控制器有哪些步骤？</h1><p id="e2e8" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">您首先需要在集群中安装控制器，以便任何入口资源能够工作。</p><p id="088b" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">这个“控制者”就是负责与AWS的API对话来创建你的目标群体的人。</p><ol class=""><li id="2fed" class="nw nx ir ld b le lf lh li mr ny mt nz mv oa lw ob oc od oe bi translated">要安装控制器，您可以使用Helm或直接从T5试一试<a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/deploy/installation/" rel="noopener ugc nofollow" target="_blank">。</a></li></ol><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">安装AWS负载平衡器控制器CRDs</p></figure><blockquote class="kx ky kz"><p id="18ed" class="la lb lc ld b le lf js lg lh li jv lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">注意:将您的安装锁定到一个特定的版本，并在测试和QA之后升级，这始终是一个最佳实践。</p></blockquote><p id="50c3" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">2.第二步是安装控制器本身，这仍然可以用Helm来完成。我提供我的自定义值；因此，您可以在下面看到安装文件和值文件。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">使用Helm安装AWS负载平衡器控制器</p></figure><p id="d3a1" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">现在我们已经完成了控制器的安装，让我们创建一个入口资源来接收来自万维网的流量！</p><blockquote class="kx ky kz"><p id="67cc" class="la lb lc ld b le lf js lg lh li jv lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">注意:最初安装控制器时，没有创建任何负载平衡器服务，也没有创建任何类型的AWS负载平衡器，只有在创建第一个入口资源时，才会创建负载平衡器。</p></blockquote><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj of"><img src="../Images/08e75bf4bd4be479bed34c10749f4ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jUd6v-YZ2Ck9Vzp1u_qoYg.jpeg"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">照片由<a class="ae kw" href="https://unsplash.com/@frantic?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">亚历克斯·科特利亚斯基</a>在<a class="ae kw" href="https://unsplash.com/s/photos/technology?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="df98" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">空谈不值钱，给我看看代码！</h1><p id="59f5" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">好吧，好吧！以上步骤全部满足后，这里就是完整的Nginx栈。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">Kubernetes上完整的Nginx堆栈</p></figure><p id="afc4" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">下面是一些值得一提的注意事项。</p><ul class=""><li id="2a1a" class="nw nx ir ld b le lf lh li mr ny mt nz mv oa lw og oc od oe bi translated">如果你的<code class="fe nm nn no np b">target-type</code>是一个<code class="fe nm nn no np b">instance</code>，你必须有一个<code class="fe nm nn no np b">NodePort</code>类型的服务。因此，负载平衡器会将流量发送到实例的公开节点端口。如果你更感兴趣的是将流量直接发送到你的pod，你的VPC CNI必须支持这个[<a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/guide/ingress/annotations/#target-type" rel="noopener ugc nofollow" target="_blank">source</a>。</li><li id="0de0" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated">AWS负载平衡器控制器使用您在入口资源上看到的注释来设置目标组、侦听器规则、证书等。您可以指定的内容列表包括但不限于健康检查(由目标组完成)、负载平衡器侦听器规则的优先级等等。阅读<a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/guide/ingress/annotations/" rel="noopener ugc nofollow" target="_blank">参考文件</a>以获得可能实现的功能的完整概述。</li><li id="173f" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated">ALB从来自<a class="ae kw" href="https://aws.amazon.com/certificate-manager/" rel="noopener ugc nofollow" target="_blank"> ACM </a>的<code class="fe nm nn no np b">tls</code>部分定义的配置中获取证书信息，您需要做的就是确保这些证书存在并且<a class="ae kw" href="https://docs.aws.amazon.com/acm/latest/userguide/managed-renewal.html" rel="noopener ugc nofollow" target="_blank">没有过期</a>。</li></ul><p id="5fe3" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">应用上述定义，您将在集群中得到以下内容:</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nr ns l"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">获取Nginx入口资源</p></figure><h1 id="6e72" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">结论</h1><p id="9e1d" class="pw-post-body-paragraph la lb ir ld b le mp js lg lh mq jv lj mr ms lm ln mt mu lq lr mv mw lu lv lw ik bi translated">在AWS这样的云解决方案中管理Kubernetes有其挑战性。我认为，他们有很好的营销理由来实施这种挑战，因为他们希望你尽可能多地购买他们的产品，而使用像Kubernetes这样的云不可知工具对这一目标没有太大帮助！</p><p id="a7cf" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">在本文中，我解释了如何设置AWS入口控制器，以便能够在AWS EKS内部创建入口资源。</p><p id="8262" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">作为最后一个建议，如果你打算用AWS EKS来管理你的Kubernetes集群，我强烈推荐你用<code class="fe nm nn no np b"><a class="ae kw" href="https://eksctl.io/" rel="noopener ugc nofollow" target="_blank">eksctl</a></code>来试试，因为它会让你的生活变得更加轻松。</p><p id="c248" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">祝你今天休息愉快，<a class="ae kw" href="https://meysam.io" rel="noopener ugc nofollow" target="_blank">敬请关注</a>，保重！</p><h1 id="27d0" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">参考</h1><ul class=""><li id="4c88" class="nw nx ir ld b le mp lh mq mr om mt on mv oo lw og oc od oe bi translated"><a class="ae kw" href="https://kubernetes.io/docs" rel="noopener ugc nofollow" target="_blank">https://kubernetes.io/docs</a></li><li id="e9a4" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated"><a class="ae kw" href="https://helm.sh" rel="noopener ugc nofollow" target="_blank"> https://helm.sh </a></li><li id="9897" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated"><a class="ae kw" href="https://aws.amazon.com/eks/" rel="noopener ugc nofollow" target="_blank">https://aws.amazon.com/eks/</a></li><li id="5074" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated"><a class="ae kw" href="https://eksctl.io" rel="noopener ugc nofollow" target="_blank"> https://eksctl.io </a></li><li id="7d41" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated"><a class="ae kw" href="https://github.com/cncf/curriculum" rel="noopener ugc nofollow" target="_blank">https://github.com/cncf/curriculum</a></li><li id="27ea" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated"><a class="ae kw" href="https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.4/" rel="noopener ugc nofollow" target="_blank">https://kubernetes-sigs . github . io/AWS-load-balancer-controller/v 2.4/</a></li><li id="7e04" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated"><a class="ae kw" href="https://github.com/aws/eks-charts" rel="noopener ugc nofollow" target="_blank">https://github.com/aws/eks-charts</a></li><li id="618a" class="nw nx ir ld b le oh lh oi mr oj mt ok mv ol lw og oc od oe bi translated"><a class="ae kw" href="https://artifacthub.io" rel="noopener ugc nofollow" target="_blank"> https://artifacthub.io </a></li></ul></div><div class="ab cl op oq hv or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ik il im in io"><p id="0180" class="pw-post-body-paragraph la lb ir ld b le lf js lg lh li jv lj mr ll lm ln mt lp lq lr mv lt lu lv lw ik bi translated">如果你喜欢这篇文章，看看我的其他内容，你可能也会觉得有帮助。</p><div class="ow ox gq gs oy oz"><a href="https://medium.com/skilluped/what-is-iptables-and-how-to-use-it-781818422e52" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd is gz z fq pe fs ft pf fv fx iq bi translated">什么是iptables，如何使用？</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">管理系统端口的防火墙界面</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">medium.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn kq oz"/></div></div></a></div><div class="ow ox gq gs oy oz"><a href="https://medium.com/skilluped/stop-writing-mediocre-docker-compose-files-26b7b4c9bd14" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd is gz z fq pe fs ft pf fv fx iq bi translated">停止编写平庸的Docker-Compose文件</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">带有可操作提示的备忘单</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">medium.com</p></div></div><div class="pi l"><div class="po l pk pl pm pi pn kq oz"/></div></div></a></div><div class="ow ox gq gs oy oz"><a href="https://medium.com/amerandish/clean-architecture-simplified-223f45e1a10" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd is gz z fq pe fs ft pf fv fx iq bi translated">简化的简洁架构</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">以友好的方式解释清洁建筑是如何工作的</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">medium.com</p></div></div><div class="pi l"><div class="pp l pk pl pm pi pn kq oz"/></div></div></a></div><div class="ow ox gq gs oy oz"><a href="https://medium.com/amerandish/a-tmux-a-beginners-guide-7c129733148" rel="noopener follow" target="_blank"><div class="pa ab fp"><div class="pb ab pc cl cj pd"><h2 class="bd is gz z fq pe fs ft pf fv fx iq bi translated">Tmux:初学者指南</h2><div class="pg l"><h3 class="bd b gz z fq pe fs ft pf fv fx dk translated">将您的单个终端变成多个终端。</h3></div><div class="ph l"><p class="bd b dl z fq pe fs ft pf fv fx dk translated">medium.com</p></div></div><div class="pi l"><div class="pq l pk pl pm pi pn kq oz"/></div></div></a></div></div></div>    
</body>
</html>