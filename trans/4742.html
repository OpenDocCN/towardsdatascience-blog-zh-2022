<html>
<head>
<title>Negative R2: Where Did You Go Wrong?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">否定R2:你错在哪里？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/negative-r2-where-did-you-go-wrong-9d4f2aa84cfb#2022-10-21">https://towardsdatascience.com/negative-r2-where-did-you-go-wrong-9d4f2aa84cfb#2022-10-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="e468" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">理论系列</h2><div class=""/><div class=""><h2 id="b7c3" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">统计例子</h2></div><p id="70cb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最近，我进行了一项机器学习任务，并在我的维持测试集上获得了一个负面的R2评分指标。</p><p id="b510" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">“等等！R2不是…方形的吗？不是应该在0和1之间吗？我到底做了什么？”</p><p id="1b00" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最初，我非常关心我的机器学习任务的状态。在谷歌搜索了几分钟后，我仍然只是略微担心我的机器学习任务的状态。无论如何，我很好地回顾了负R2值意味着什么，以及它是如何意外获得的。这篇文章提供了对统计数字的数学来源的更深入的了解，以帮助阐明这一结果的意义。</p><p id="4cfa" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">接收到负的R2值表明模型的预测值比使用平均值作为预测值时表现更差。你自己的谷歌搜索可能会产生类似的陈述。在这里，我用一个数据例子来解释为什么。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/3d2f9a30381b52499278f162185d9ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*2Rn-a5RX9iYURnkYeiOnsQ.png"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><h1 id="ac11" class="lz ma it bd mb mc md me mf mg mh mi mj ki mk kj ml kl mm km mn ko mo kp mp mq bi translated">为什么用R2？</h1><p id="7f1d" class="pw-post-body-paragraph kr ks it kt b ku mr kd kw kx ms kg kz la mt lc ld le mu lg lh li mv lk ll lm im bi translated">R2是决定系数，由投入解释的结果中的变化比例。在预测连续结果的回归任务中，它经常被用作性能指标。</p><p id="a8c1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在经典线性回归中，R2的值介于0和1之间。这篇文章提供了一个很好的基于证据的解释。然而，简而言之，当包含截距时，该证明适用于普通最小二乘(OLS)建模方法。如果您使用非线性模型(正如我们数据科学社区中的许多人所做的那样)，请将这些约束抛之脑后。现在我们的决定系数范围从负无穷大变为1。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/8c0c94c765145b2ed9b1d2da81d0c5dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*MwQ7OzRIfQgR0blHhnygYw.png"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分类的表格</p></figure><p id="79bd" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">事实上，对于R2是否应该用于非线性模型，有一些合理的争论。这一论点是基于这样一个事实，即R2并不是一个常规可靠的模型拟合预测器，这一点由Spiess &amp; Neumeyer在2010年的一篇期刊论文<a class="ae mw" href="https://bmcpharma.biomedcentral.com/articles/10.1186/1471-2210-10-6" rel="noopener ugc nofollow" target="_blank">中证明。</a></p><p id="5159" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">顺便说一句，R2作为OLS的拟合优度也不是固有的有用指标，至少在通过评估模型残差确定线性假设有效之前是如此。</p><p id="5a3b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在任何情况下，虽然R2不应被用作唯一的性能指标，但不可否认的是，R2可以与其他指标一起用于评估模型性能，如MAE(平均绝对误差)、MSE(均方误差)、RMSE(均方根误差)或可能的调整R2。</p><h1 id="2360" class="lz ma it bd mb mc md me mf mg mh mi mj ki mk kj ml kl mm km mn ko mo kp mp mq bi translated">什么是R2？</h1><p id="18fc" class="pw-post-body-paragraph kr ks it kt b ku mr kd kw kx ms kg kz la mt lc ld le mu lg lh li mv lk ll lm im bi translated">在经典回归中，目标是预测结果。这个结果变量的变化可以用3个值来表示:SSR、SSE和SST。这些是样本中方差的平方和。平方项使我们不必处理负值的复杂情况。SSR、SSE和SST的不同别名变得特别容易混淆，所以请注意我已经尽了最大努力在一个地方编译了一些常见的替代命名约定。接下来，我将只使用下表中左边两列的缩写。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi my"><img src="../Images/e727b10e6c23f70a9a421598f05c497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*Fd-0VS9qc9tPmYEFmZo6WA.png"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">R2境内的数量(按作者分列)</p></figure><p id="7aaf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在OLS模型中，SSR + SSE = SST。一直都是。</p><p id="2853" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这些统计数据相关的原因是因为决定系数是SSE和SST的函数。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/f705e4b7aface69740ffba7178974814.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/0*IZAz4zYznVChaaP4"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><p id="eb38" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">使用n个观察值的样本，我们可以计算紫色SSE值，作为观察值I的真实结果(yᵢ)和拟合/预测结果(ŷᵢ)之间的平方差之和</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/103d5cfe55f30a14df8a0d0e7314e962.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/0*exbkvtvGlKTkbysN"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><p id="a674" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">使用n个观测值，我们还可以将蓝色SST值计算为真实结果(yᵢ)和结果样本平均值(ȳ).)之间的平方差之和</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/a01fc5284db5c6c48e5a788e01ef843e.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/0*2ctDAbJe7Ec4D_qT"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><p id="2caf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">计算出SSE和SST之后，我们就可以计算出我们想要的指标，R2。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/61b333fb46385f402138a89da6ff7ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/0*4Ps8pdab6tRB69b5"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><h1 id="2b31" class="lz ma it bd mb mc md me mf mg mh mi mj ki mk kj ml kl mm km mn ko mo kp mp mq bi translated">R2反面例子</h1><p id="db5d" class="pw-post-body-paragraph kr ks it kt b ku mr kd kw kx ms kg kz la mt lc ld le mu lg lh li mv lk ll lm im bi translated">让我们使用一个有10个观察值的玩具数据集。每个观察值都有一个模型的拟合/预测估计值，并且每个观察值都有真实的结果，如下表所示。不提供实际型号有两个原因:</p><p id="7c94" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">a)我编的。</p><p id="54a2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">b)该性能指标可以应用于几乎任何模型的拟合值，因此它与为什么R2可以取负值的问题无关。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi na"><img src="../Images/b8b595f2b96c1fcce6b874b2e9ef577e.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/0*3pZoROKOajjsQ7gv"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分类的表格</p></figure><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/7721bbfd0c4422ddf668425439434c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/0*YuNUuApNGocMuIgr"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><p id="b724" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">注意拟合值的平均值和真实值的平均值是相同的，5。在中心趋势相同的情况下，也许这个模型是对观察结果的合理预测？</p><p id="7cdd" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">表格中的值绘制如下。假设黑点代表真实的结果值。蓝点代表我们模型结果的预测值(即拟合值)。每个观察值的总变化量可以按上述方法划分。为清晰起见，下图中只显示了一个观察值。总变化(由SST解释)分为两个量，由模型拟合(SSR)解释的变化和由拟合值中的误差(SSE)解释的变化。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/94625438c545b00391f89626e0d6b120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r3-IoQSjrGIQq1nG"/></div></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><p id="b227" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">对于每个指标，SSE和SST，都有差异，这些差异的平方显示在相应的列中。该模型的SSE误差平方和为86.5，而SST误差平方和为67.5。</p><p id="f808" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因为SST &lt; SSE，这表明如果我们放弃我们的模型，只预测平均真实值(5.0)作为每个点的预测统计，该估计将比我们当前的模型产生的拟合值表现得更好。虽然这不是一个理想的结果，但这意味着这种表现不一定是误判的结果。对于具有截距的OLS模型，R2介于0和1之间的原因是，如果无法获得更好的拟合，其截距将取平均值，其β系数将取值为0。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/8b23e2ee5bb6cbf258c394a634454fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/0*GZ9OwUF9Z9NiEkZ4"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">作者的玩具数据</p></figure><p id="1676" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">从上证综指和SST计算R2后，我们得到一个四舍五入的R2指标-0.28，这确实是负的，因为模型性能低于仅使用样本均值获得的性能。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ni"><img src="../Images/2b3c2f24190c9f22d91f87ab97ce3bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NDaWutD4TX2nwdda"/></div></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">按作者分列的数字</p></figure><p id="119c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">总之，我们已经解释了决定系数的来源，解释了为什么在某些情况下它可以呈现负值，并且举例说明了如何计算具有负值的玩具数据集。</p><p id="cf5d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果我们回到我的机器学习任务，它提供了之前令人担忧的负面R2结果，似乎我只需要稍微担心一下，因为我的模型在技术上确实起作用了……它只是一个糟糕的模型。好吧，祝我下次好运。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="1047" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果您对其他性能指标或统计量有任何疑问，请在下面发表评论！</p><p id="7571" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">一如既往，继续坚持下去，尽管最近有负面表现模式的失败。</p><blockquote class="nq nr ns"><p id="6927" class="kr ks nt kt b ku kv kd kw kx ky kg kz nu lb lc ld nv lf lg lh nw lj lk ll lm im bi translated">"失败是走向伟大的另一块垫脚石。"――奥普拉·温弗瑞</p></blockquote></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="6209" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">凯特·沃尔报道:</p><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/level-up-with-python-quickly-produce-pdfs-with-stunning-visuals-d6750c9c7be2"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jd gy z fp of fr fs og fu fw jc bi translated">使用Python升级:快速生成具有惊人视觉效果的pdf</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">使用Matplotlib制作业务分发手册/电子邮件/传单</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo lt oa"/></div></div></a></div><div class="nx ny gp gr nz oa"><a rel="noopener follow" target="_blank" href="/probability-for-data-scientists-the-capable-chi-squared-distribution-abced58fa157"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jd gy z fp of fr fs og fu fw jc bi translated">数据科学家的概率:有效卡方分布</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">分布函数的交互式可视化</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">towardsdatascience.com</p></div></div><div class="oj l"><div class="op l ol om on oj oo lt oa"/></div></div></a></div></div></div>    
</body>
</html>