<html>
<head>
<title>A Simple Explanation of Causal Inference in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中因果推理的简单解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-explanation-of-causal-inference-in-python-357509506f31#2022-09-12">https://towardsdatascience.com/a-simple-explanation-of-causal-inference-in-python-357509506f31#2022-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2410" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何用Python构建端到端因果推理模型的直白解释</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2a7b583b05700a06bb1a1fc6f0744cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qa1_rBA2gdrQt1Xl0tumLw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@cdd20?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">愚木混株 cdd20</a> on <a class="ae ky" href="https://unsplash.com/s/photos/question-mark?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></p></figure><h2 id="dbf3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">背景</h2><p id="f0b2" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">当我完成一个商业机器学习分类项目时，我第一次对因果关系感兴趣，客户在演示后问的第一件事是…</p><blockquote class="mo"><p id="8005" class="mp mq it bd mr ms mt mu mv mw mx mn dk translated">"为什么会发生这种情况，潜在的原因是什么？"</p></blockquote><p id="90cd" class="pw-post-body-paragraph lv lw it lx b ly my ju ma mb mz jx md li na mf mg lm nb mi mj lq nc ml mm mn im bi translated">我的第一次尝试是围绕着人工修改分类模型的输入数据，但是效果不是很好。</p><p id="1053" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">接下来，我在Google、Medium和Towards Data Science上搜索关于“因果推理”的文章，我确实找到了一些，但它们很复杂，往往不完整，也不能推广到我自己的数据集。</p><p id="0579" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">这促使我探索更广泛的文献和目前可用的各种因果库的文档，这篇文章提出了一个因果推理模型，这是该研究的结果。</p><h2 id="60ff" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">你将学到什么</h2><blockquote class="mo"><p id="8361" class="mp mq it bd mr ms mt mu mv mw mx mn dk translated">到本文结束时，您将能够生成表示任何因果推理场景的测试数据，用Python代码构建一个因果模型，然后运行“假设”针对模型的查询。</p></blockquote><p id="aa22" class="pw-post-body-paragraph lv lw it lx b ly my ju ma mb mz jx md li na mf mg lm nb mi mj lq nc ml mm mn im bi translated">在我们深入因果推理模型之前，请考虑…</p><p id="f0d9" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/membership" rel="noopener">通过我的推荐链接</a>加入Medium(如果你使用此链接注册，我将收取一定比例的费用)。</p><p id="e35b" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/subscribe" rel="noopener">每当我发表一个新故事时，订阅一封免费电子邮件</a>。</p><p id="2ecb" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/" rel="noopener">快速浏览我之前的文章</a>。</p><p id="232f" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><a class="ae ky" href="https://relentless-originator-3199.ck.page/5f4857fd12" rel="noopener ugc nofollow" target="_blank">下载我的免费战略数据驱动决策框架</a>。</p><p id="0545" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">访问我的数据科学网站— <a class="ae ky" href="https://www.the-data-blog.co.uk/" rel="noopener ugc nofollow" target="_blank">数据博客</a>。</p><h2 id="d0e1" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">入门指南</h2><p id="8128" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们需要做的第一件事是导入代码中需要的所有库…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="1a2a" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">我们需要的第二件事是一个假设的场景来建模-</p><ul class=""><li id="8452" class="nk nl it lx b ly nd mb ne li nm lm nn lq no mn np nq nr ns bi translated">在100万名儿童中，990，000人(99%)接种了疫苗</li><li id="a206" class="nk nl it lx b ly nt mb nu li nv lm nw lq nx mn np nq nr ns bi translated">在接种疫苗的人中，9900人(990000人中的1%)有反应</li><li id="01f4" class="nk nl it lx b ly nt mb nu li nv lm nw lq nx mn np nq nr ns bi translated">在那些有反应的人中，99人(9900人中的1%)死于该反应</li><li id="36cd" class="nk nl it lx b ly nt mb nu li nv lm nw lq nx mn np nq nr ns bi translated">在没有接种疫苗的人群中，有200人(10000人中的2%)感染了天花</li><li id="1214" class="nk nl it lx b ly nt mb nu li nv lm nw lq nx mn np nq nr ns bi translated">在患天花的人中，40人(200人中的20%)死于这种疾病</li></ul><p id="1ff8" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">我们需要的下一件事是一些测试数据来表示场景的“观察”。要快速构建一百万行代表因果场景的测试数据，请阅读本文…</p><div class="ny nz gp gr oa ob"><a rel="noopener follow" target="_blank" href="/how-to-generate-synthetic-data-for-any-causal-inference-project-in-less-than-10-lines-of-code-158688a89349"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">如何用不到10行代码为任何因果推理项目生成合成数据</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">如果99%的人接种了疫苗，1%的人出现反应，2%的人得病，你如何生成有代表性的合成数据？</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">towardsdatascience.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op ks ob"/></div></div></a></div><p id="8326" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">…查看源代码和对<code class="fe oq or os ot b">BinaryDataGenerator</code>类的解释…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="9f45" class="kz la it ot b gy oy oz l pa pb">(1000000, 4)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/0599487b8c3512010065634d20128c16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*KDVP0rkgIp5r21A4w_tNtg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cdec" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">这个网格是一百万行测试数据的总结。第一行是说100万“观察”中的980，100人接种了疫苗，没有反应，没有感染天花，没有死亡等。</p><h2 id="a1ce" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">进退两难</h2><p id="89ca" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">从下面的总结中，我们可以看到疫苗项目的一个反直觉的结果…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="b01b" class="kz la it ot b gy oy oz l pa pb">Deaths caused by Vaccination: 99<br/>Deaths caused by Smallpox: 40</span></pre><p id="10cb" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">疫苗导致的死亡比疾病还多！那么，为了拯救生命，疫苗项目应该取消吗？</p><p id="48d5" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">为了解决这个问题，我们需要问这样一个问题:“如果我们没有实施疫苗计划，会发生什么？”。这是一个反事实的问题，也就是说，它要求我们想象一个不同的世界，在那里我们做出了不同的关键选择，并找出这会产生什么影响。</p><p id="a898" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">我将在未来的文章中详细讨论反事实，但现在足以说反事实使这成为一个不太适合机器学习技术的因果推理模型，因为它是因果关系而不是相关性。</p><p id="d380" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">本文的剩余部分将解释如何使用Python代码来解决这个问题，这些代码已经被编写得易于遵循和理解…</p><h2 id="3322" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第一步:因果图</h2><p id="bb0e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">在《为什么》一书中，Pearl认为因果推理引擎的关键组成部分之一是“因果模型”,它可以是因果图、结构方程、逻辑陈述等。但是在因果图上珍珠被“强烈销售”。</p><div class="ny nz gp gr oa ob"><a href="https://www.amazon.co.uk/Book-Why-Science-Cause-Effect/dp/0241242630" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">为什么之书:因果的新科学</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">购买由珀尔，朱迪亚，麦肯齐，达纳(ISBN: 9780241242636)所著的《为什么:因果的新科学》一书</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">www.amazon.co.uk</p></div></div><div class="ok l"><div class="pd l om on oo ok op ks ob"/></div></div></a></div><p id="efc7" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">目前，大多数的库和文章都称之为“有向无环图”(DAGs它们本质上是一样的。</p><p id="63e1" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">作为一名数据科学家，我的直觉是，通过识别和解决数据中的模式，问题是可以解决的，当然，有算法可以从数据中构建因果图，现在我们有100万行测试数据(我们的“观察”)，我们可以轻松地尝试这一点…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/27a839d1c7e28b94b2c371bda70a8461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XCQnSmF4AplJ1rAZzNWHfQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7f3d" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">结果不是很满意！</p><p id="3162" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">根据NOTEARS算法结果天花导致疫苗接种反应，死亡导致天花和反应，反应导致疫苗接种！(更多关于NOTEARS不合适的信息可以在<a class="ae ky" href="https://www.causalens.com/research-paper/unsuitability-of-notears-for-causal-graph-discovery/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="15e8" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">我尝试了几个公开可用的库，得到了类似的结果，那么我们如何创建因果推断图呢？</p><p id="7f6a" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">嗯，Pearl提出了一个强有力的案例，因果图需要领域专业知识，不能简单地从数据中推断出来，这确实有直观的意义。</p><p id="ff31" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">如果我们要收集一只小公鸡啼叫和太阳升起的观察结果，那么肯定会有相关性，但是关于小公鸡的啼叫不会导致太阳升起的知识不能仅仅从数据中凭直觉得出。</p><p id="011b" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">根据天花图，我们知道疫苗接种先于反应，而时间知识会帮助我们纠正这个图，但是就像公鸡在太阳升起前啼叫一样，即使这样也帮不了我们！</p><p id="e1d8" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">那么我们需要的是通过与领域专家互动、向他们学习和提问而获得的领域知识(然后接受批判性的挑战！)来建立有效的因果图。</p><p id="1ba4" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">以下是Python代码…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/8f01671c1fe1f28f1acaa26456d1bb90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ul6zwldGJc1dh6UpG6mNDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7398" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">这看起来好多了！</p><h2 id="53a3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤2:条件概率表</h2><p id="39cc" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">接下来需要的是一组条件概率表(CPT ),描述图中节点之间转移的概率。</p><p id="d27d" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">这听起来很复杂，但这些概率都可以在我们的100万行数据(代表假设观察)中获得，并且<code class="fe oq or os ot b">pgmpy</code>库可以在一行代码中完成所有必要的计算，并增加一行代码来验证模型...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="5266" class="kz la it ot b gy oy oz l pa pb">True</span></pre><p id="5c43" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">...并且CPT可以容易地打印出来...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="4053" class="kz la it ot b gy oy oz l pa pb">+-----------------+------+<br/>| Vaccination?(0) | 0.01 |<br/>+-----------------+------+<br/>| Vaccination?(1) | 0.99 |<br/>+-----------------+------+<br/>+--------------+-----------------+-----------------+<br/>| Vaccination? | Vaccination?(0) | Vaccination?(1) |<br/>+--------------+-----------------+-----------------+<br/>| Reaction?(0) | 1.0             | 0.99            |<br/>+--------------+-----------------+-----------------+<br/>| Reaction?(1) | 0.0             | 0.01            |<br/>+--------------+-----------------+-----------------+<br/>+--------------+-----------------+-----------------+<br/>| Vaccination? | Vaccination?(0) | Vaccination?(1) |<br/>+--------------+-----------------+-----------------+<br/>| Smallpox?(0) | 0.98            | 1.0             |<br/>+--------------+-----------------+-----------------+<br/>| Smallpox?(1) | 0.02            | 0.0             |<br/>+--------------+-----------------+-----------------+<br/>+----------+-------------+-------------+-------------+-------------+<br/>| Reaction?| Reaction?(0)| Reaction?(0)| Reaction?(1)| Reaction?(1)|<br/>+----------+-------------+-------------+-------------+-------------+<br/>| Smallpox?| Smallpox?(0)| Smallpox?(1)| Smallpox?(0)| Smallpox?(1)|<br/>+----------+-------------+-------------+-------------+-------------+<br/>| Death?(0)| 1.0         | 0.8         | 0.99        | 0.5         |<br/>+----------+-------------+-------------+-------------+-------------+<br/>| Death?(1)| 0.0         | 0.2         | 0.01        | 0.5         |<br/>+----------+-------------+-------------+-------------+-------------+</span></pre><p id="1ed7" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">完整的模型，即因果推断图加上条件概率表可以更容易地可视化如下…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/369c560cad248a5c608e35552199ebf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3cudHcHgSkjbEG6DI-V2eA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="a1db" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">为了完善我们的理解…</p><ul class=""><li id="675c" class="nk nl it lx b ly nd mb ne li nm lm nn lq no mn np nq nr ns bi translated">顶部的表格显示，人口接种疫苗的概率为99%</li><li id="61a7" class="nk nl it lx b ly nt mb nu li nv lm nw lq nx mn np nq nr ns bi translated">左边的表格显示，如果接种疫苗= 0，反应概率为0%，如果接种疫苗= 1，反应概率为1%</li><li id="a064" class="nk nl it lx b ly nt mb nu li nv lm nw lq nx mn np nq nr ns bi translated">右边的表格是说，如果接种疫苗= 0，天花的概率是2%，如果接种疫苗= 1，天花的概率是0%</li><li id="6585" class="nk nl it lx b ly nt mb nu li nv lm nw lq nx mn np nq nr ns bi translated">下表显示，如果天花= 1，反应= 0，死亡概率为20%，如果天花= 0，反应= 1，死亡概率为1%</li></ul><p id="c9cb" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">注意:在这个例子中，最后一列没有意义；它是由<code class="fe oq or os ot b">.fit()</code>添加的，以确保所有的值都存在，但是在同一行中没有reaction = 1和天花= 1的数据。</p><h2 id="8ed1" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤3:查询模型</h2><p id="1281" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated"><strong class="lx iu">基本查询</strong></p><p id="185d" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">首先，我们需要一个简单的助手函数来对模型执行查询…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="cf11" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">第一个查询将使用模型显示发生的死亡总数…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="7129" class="kz la it ot b gy oy oz l pa pb">+-----------+---------------+<br/>| Death?    |   phi(Death?) |<br/>+===========+===============+<br/>| Death?(0) |        0.9999 |<br/>+-----------+---------------+<br/>| Death?(1) |        0.0001 |<br/>+-----------+---------------+<br/>Number of deaths: 139</span></pre><p id="ed52" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">下一个问题是问一个反事实的问题——“如果没有疫苗接种计划，会发生什么？”也就是说，如果我们将<code class="fe oq or os ot b">Vaccination?</code>的证据改为0，会对变量<code class="fe oq or os ot b">Death?</code>产生什么影响？...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="9ea5" class="kz la it ot b gy oy oz l pa pb">+-----------+---------------+<br/>| Death?    |   phi(Death?) |<br/>+===========+===============+<br/>| Death?(0) |        0.9960 |<br/>+-----------+---------------+<br/>| Death?(1) |        0.0040 |<br/>+-----------+---------------+<br/>Number of deaths: 4000.0<br/>Lives saved by vaccine program: 3861</span></pre><p id="b38f" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">现在我们有问题的答案了！尽管疫苗接种导致99人死亡，但疫苗接种计划挽救了3，861人的生命(如果你想看到答案的验证，请查阅“为什么之书”第44页，其中仅使用概率就解决了问题)。</p><p id="154f" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><strong class="lx iu">更复杂的查询</strong></p><p id="b182" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">但如果我们想回答一个更复杂的问题，比如“如果疫苗接种率是50%，而不是99%，会发生什么？”。</p><p id="76ef" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">基本的<code class="fe oq or os ot b">query()</code>方法只能接受关于特征概率为1或0的参数，50 / 50问题要求条件概率表中的“疫苗接种？”当前包含的99 / 1被替换。</p><p id="8311" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">同样，这听起来很复杂，但是非常简单…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="96a5" class="kz la it ot b gy oy oz l pa pb">+-----------------+------+<br/>| Vaccination?(0) | 0.01 |<br/>+-----------------+------+<br/>| Vaccination?(1) | 0.99 |<br/>+-----------------+------+</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="60f3" class="kz la it ot b gy oy oz l pa pb">+-----------------+-----+<br/>| Vaccination?(0) | 0.5 |<br/>+-----------------+-----+<br/>| Vaccination?(1) | 0.5 |<br/>+-----------------+-----+</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><pre class="kj kk kl km gt ou ot ov ow aw ox bi"><span id="8946" class="kz la it ot b gy oy oz l pa pb">+-----------+---------------+<br/>| Death?    |   phi(Death?) |<br/>+===========+===============+<br/>| Death?(0) |        0.9980 |<br/>+-----------+---------------+<br/>| Death?(1) |        0.0021 |<br/>+-----------+---------------+<br/>Number of deaths: 2050</span></pre><p id="69e9" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">50%的疫苗接种方案仍可挽救2050条生命，但相比挽救了3861条生命的100%疫苗接种方案，将失去1811条生命。</p><h2 id="650f" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h2><p id="22dc" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">因果推理是机器学习和人工智能中的一个热门话题，吸引了越来越多的文章和库。</p><p id="386c" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">然而，这些文章通常很复杂，很难理解，而且没有一个库像监督学习的<code class="fe oq or os ot b">scikit-learn</code>一样成为因果推理的“首选”。</p><p id="cea5" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">当然，人类直觉上擅长因果推理。我们能够想象如果我们在过去做出不同的决定，今天会是什么样子，我们可以将这种历史经验应用于想象的未来状态，但机器学习算法不擅长这项任务。</p><p id="dece" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">本文通过展示一个简单、直接的例子，说明了如何用Python构建因果模型(因果推断图和条件概率表)以及如何针对该模型执行基本和更复杂的查询，从而打破了因果推断的一些复杂性。</p><p id="3ba8" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">在以后的文章中，我将探索反事实、“do”操作符、混淆以及这个迷人的新兴主题的其他方面。</p><p id="d312" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">同时，如果你喜欢这篇文章，请考虑…</p><p id="226d" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/membership" rel="noopener">通过我的推荐链接</a>加入Medium(如果你使用这个链接注册，我将收取一定比例的费用)。</p><div class="ny nz gp gr oa ob"><a href="https://grahamharrison-86487.medium.com/membership" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">通过我的推荐链接加入媒体-格雷厄姆哈里森</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">阅读格雷厄姆·哈里森(以及媒体上成千上万的其他作家)的每一个故事。增强您的数据知识…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">grahamharrison-86487.medium.com</p></div></div><div class="ok l"><div class="ph l om on oo ok op ks ob"/></div></div></a></div><p id="7508" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">每当我发表新故事时，订阅一封免费电子邮件。</p><p id="3695" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><a class="ae ky" href="https://grahamharrison-86487.medium.com/" rel="noopener">快速浏览我之前的文章</a>。</p><p id="04b1" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated"><a class="ae ky" href="https://relentless-originator-3199.ck.page/5f4857fd12" rel="noopener ugc nofollow" target="_blank">下载我的免费战略数据驱动决策框架</a>。</p><p id="e881" class="pw-post-body-paragraph lv lw it lx b ly nd ju ma mb ne jx md li nf mf mg lm ng mi mj lq nh ml mm mn im bi translated">访问我的数据科学网站— <a class="ae ky" href="https://www.the-data-blog.co.uk/" rel="noopener ugc nofollow" target="_blank">数据博客</a>。</p></div></div>    
</body>
</html>