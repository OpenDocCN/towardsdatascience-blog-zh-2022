<html>
<head>
<title>COVID-19 Outcome Predictions from Wastewater</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">废水的新冠肺炎结果预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/covid-19-outcome-predictions-from-wastewater-fcc19400e144#2022-05-19">https://towardsdatascience.com/covid-19-outcome-predictions-from-wastewater-fcc19400e144#2022-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c062" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用CDC的废水数据预测病例、住院和死亡。使用pandas窗口和相关性。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb719979d0261d69261bdf8522703ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CtY-cY1Tw6wz2mM_3nAegg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@marcinjozwiak?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Marcin Jozwiak </a>在<a class="ae kv" href="https://unsplash.com/s/photos/sewage?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="2d7d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">摘要</h1><p id="26b7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">全美50，000多项废水测试与来自同一地点和同一时间段的新冠肺炎结果(病例、住院、死亡)相匹配。分析所得数据集的新型冠状病毒RNA水平和结果之间的相关性，显示与所有三项指标呈正相关。</p><h1 id="b422" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">背景</h1><p id="140e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在之前的数据工程项目中，我<a class="ae kv" rel="noopener" target="_blank" href="/sars-cov-2-wastewater-data-enhanced-9717d8197f98">增强了</a>CDC<a class="ae kv" href="https://www.cdc.gov/healthywater/surveillance/wastewater-surveillance/wastewater-surveillance.html" rel="noopener ugc nofollow" target="_blank">国家废水监测系统</a>的废水测试。该项目的目标是将新冠肺炎疫苗接种和疾病结果信息添加到每个废水测试中，以便特定测量的新型冠状病毒RNA水平可以与该时间范围内该位置的疾病结果相关联。</p><p id="5fe9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">例如，考虑2021年1月19日在密苏里州斯科特县的处理厂进行的水测试，发现每毫升390.0份来自新型冠状病毒的N2基因。(这基本上是完整的NWSS数据集包含的信息，每天和每个提交数据的水处理厂都会重复多次。)</p><p id="6be2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我增强了NWSS数据集，在该行中添加了1月9日该县的疫苗接种率(因为疫苗至少需要10天才能发挥作用)、1月26日的已知病例率(水试验后7天)、2月9日新冠肺炎患者的医院和ICU利用率(水样本后14天)以及2月16日的新增新冠肺炎死亡人数(21天后)。</p><p id="0c85" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">该数据工程项目是成功的，下一步是使用增强的NWSS数据进行分析。例如，废水新型冠状病毒核糖核酸的水平能预测14天后新冠肺炎医院的入院人数吗？如果是，这种相关性有多强？我目前的项目，在这里报告，开始了这种分析。</p><p id="c943" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">注意:这项分析，以及我之前的项目，即<a class="ae kv" rel="noopener" target="_blank" href="/sars-cov-2-wastewater-data-enhanced-9717d8197f98">增强了</a>NWSS数据集，是建立在详细的废水测试结果之上的，这些结果可以通过签署数据使用协议从CDC获得。要获取该受限数据集，请联系列在<a class="ae kv" href="https://data.cdc.gov/Public-Health-Surveillance/NWSS-Public-SARS-CoV-2-Wastewater-Metric-Data/2ew6-ywp6" rel="noopener ugc nofollow" target="_blank">公共数据</a>页面上的数据所有者。</p><h1 id="dbce" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">缺失的医院价值观</h1><p id="0b04" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这项工作的第一步是解决医院信息的一个问题。我从CovidActNow.org的<a class="ae kv" href="https://covidactnow.org/" rel="noopener ugc nofollow" target="_blank">获得医院数据，但是同样的问题在许多医院数据来源中是常见的。医院通常每周只报告一次入院人数、床位数和ICU使用率。其他六天，这些值为空。当然，在缺少数据的日子里，仍然有人在医院，所以null/NaN不能解释为零。解决方案是使用可用数据来估计每周报告之间的住院数据。</a></p><p id="205e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">熊猫窗口功能实现了这个功能:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="2f95" class="mu kx iq mq b gy mv mw l mx my"># Sort by county then date.</span><span id="6019" class="mu kx iq mq b gy mz mw l mx my">CovidDF = CovidDF.sort_values(["fips", "covid_facts_date"], ascending=[True, True])</span><span id="fbee" class="mu kx iq mq b gy mz mw l mx my"># Create new columns for ICU, beds and admits with the rolling average over 10 days.</span><span id="b321" class="mu kx iq mq b gy mz mw l mx my">CovidDF["metrics.icuCapacityRatioRolling10"] = CovidDF["metrics.icuCapacityRatio"].rolling(10, min_periods=1, center=True, closed='both').mean()</span><span id="f44e" class="mu kx iq mq b gy mz mw l mx my">CovidDF["metrics.bedsWithCovidPatientsRatioRolling10"] = CovidDF["metrics.bedsWithCovidPatientsRatio"].rolling(10, min_periods=1, center=True, closed='both').mean()</span><span id="c1fa" class="mu kx iq mq b gy mz mw l mx my">CovidDF["metrics.weeklyCovidAdmissionsPer100kRolling10"] = CovidDF["metrics.weeklyCovidAdmissionsPer100k"].rolling(10, min_periods=1, center=True, closed='both').mean()</span></pre><h1 id="0129" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">早期疫苗接种值</h1><p id="3364" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">CovidActNow数据还有另一项需要清理。(对于所有的数据源来说，需要各种清理和修复是很常见的。)许多早期日期的疫苗接种字段是空的。但在这种情况下，与住院治疗不同，缺失值是已知的——它们为零，因为疫苗在那些日期不存在。</p><p id="a482" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">熊猫。DataFrame.loc()通过明确地将疫苗出现在美国之前的所有日子的所有疫苗计数设置为零来解决这个问题。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="e7f9" class="mu kx iq mq b gy mv mw l mx my"># First vaccines on 14 December 2020.</span><span id="cb0d" class="mu kx iq mq b gy mz mw l mx my">CovidDF.loc[CovidDF["covid_facts_date"] &lt;= "2020-12-13", "actuals.vaccinationsInitiated"] = 0.0<br/>CovidDF.loc[CovidDF["covid_facts_date"] &lt;= "2020-12-13", "actuals.vaccinationsCompleted"] = 0.0<br/>CovidDF.loc[CovidDF["covid_facts_date"] &lt;= "2020-12-13", "metrics.vaccinationsInitiatedRatio"] = 0.0<br/>CovidDF.loc[CovidDF["covid_facts_date"] &lt;= "2020-12-13", "metrics.vaccinationsCompletedRatio"] = 0.0</span><span id="f137" class="mu kx iq mq b gy mz mw l mx my"># First boosters on 16 August 2021.</span><span id="9b1b" class="mu kx iq mq b gy mz mw l mx my">CovidDF.loc[CovidDF["covid_facts_date"] &lt;= "2021-08-15", "actuals.vaccinationsAdditionalDose"] = 0.0<br/>CovidDF.loc[CovidDF["covid_facts_date"] &lt;= "2021-08-15", "metrics.vaccinationsAdditionalDoseRatio"] = 0.0</span></pre><h1 id="4d63" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">一致性测试类型</h1><p id="8343" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">NWSS数据集包含各种废水处理厂提交的水质检测报告。大多数，但不是全部，在原始废水中寻找新型冠状病毒的N1或N2基因。我排除了不支持这种测试的行。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0290" class="mu kx iq mq b gy mv mw l mx my">RawDF = RawDF.query("pcr_target == 'sars-cov-2' ")<br/>RawDF = RawDF.query("pcr_gene_target == 'n1' or pcr_gene_target == 'n2' or pcr_gene_target == 'n1 and n2 combined'  ")<br/>RawDF = RawDF.query("sample_matrix == 'raw wastewater' ")</span></pre><h1 id="e879" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">一致的RNA检测单位</h1><p id="a883" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一个稍微棘手的问题是，检测到的基因拷贝数以三种不同的方式报告:每升拷贝数、每毫升拷贝数和每升拷贝数的对数基数10。我创建了两个新列:一列表示标准化的一致单位(每毫升的拷贝数)，另一列根据需要转换标准化的基因计数。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="8918" class="mu kx iq mq b gy mv mw l mx my">RawDF["pcr_target_units_norm"] = "copies/ml wastewater"</span><span id="418e" class="mu kx iq mq b gy mz mw l mx my">RawDF.loc[RawDF["pcr_target_units"] == "copies/l wastewater", "pcr_target_avg_conc_norm"] = (RawDF["pcr_target_avg_conc"] / 1000)</span><span id="0ee0" class="mu kx iq mq b gy mz mw l mx my">RawDF.loc[RawDF["pcr_target_units"] == "log10 copies/l wastewater", "pcr_target_avg_conc_norm"] = ((10 ** RawDF["pcr_target_avg_conc"]) / 1000)</span></pre><h1 id="20a3" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">完成的数据集</h1><p id="47df" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">初始NWSS数据集中有61，526行(将FIPS县扩展为每行一行后)。仅选择原废水中的N1或N2基因测试后有53，521行，仅选择具有有效基因计数(非NaN，非负)的行后有53，503行。与初始数据集行相比，具有可用数据的行的比例相当高。</p><p id="46f1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">废水样本中的RNA浓度因多种原因而异——使用下水道系统的人数、当时雨水对废水的稀释、使用的采样方法以及该地区有多少人患有新冠肺炎。一项测试显示X个RNA基因拷贝，而另一项测试显示2X个拷贝，这一事实并不意味着第二项测试一定会发现更多的疾病。然而，NWSS数据集包含了在多个地点、多个月内进行的多次水质测试，因此这些变化往往会随着时间和地理位置的变化而变得平缓。</p><h1 id="6057" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结果</h1><p id="69da" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我使用简单的Spearman等级相关进行分析。如果两个变量作为有序对精确地相互跟踪，则它们的相关性为1.0。在这种情况下，1.0的相关性意味着所有水样中RNA水平的有序列表完美地预测了其他变量的有序列表，例如住院治疗。</p><p id="8098" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以下是斯皮尔曼相关性:</p><ul class=""><li id="9137" class="nb nc iq lq b lr mk lu ml lx nd mb ne mf nf mj ng nh ni nj bi translated">新型冠状病毒基因拷贝数和新冠肺炎试验阳性率(7天后)= 0.491。</li><li id="3058" class="nb nc iq lq b lr nk lu nl lx nm mb nn mf no mj ng nh ni nj bi translated">人均基因拷贝数和新冠肺炎病例密度(7天后)= 0.541。</li><li id="075c" class="nb nc iq lq b lr nk lu nl lx nm mb nn mf no mj ng nh ni nj bi translated">基因拷贝和人均新冠肺炎医院入院人数(14天后)n= 0.377。</li><li id="4583" class="nb nc iq lq b lr nk lu nl lx nm mb nn mf no mj ng nh ni nj bi translated">新冠肺炎患者的基因拷贝数与医院床位的比率(14天后)= 0.490。</li><li id="5987" class="nb nc iq lq b lr nk lu nl lx nm mb nn mf no mj ng nh ni nj bi translated">基因拷贝数和人均新冠肺炎死亡数(21天后)= 0.282。</li></ul><p id="a0d9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在废水中检测到的新型冠状病毒和该地理区域中新冠肺炎病流行的多种测量之间存在一致的正相关。</p><p id="f1d1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">对于所有的相关数，95%的置信值非常接近，因为样本量很大。例如，入院相关系数为0.377，95%置信区间为0.3695至0.3845。</p><h1 id="8083" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">未来的工作</h1><p id="e1e6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最新的完整NWSS数据集来自2022年2月初。此时(5月初)，数据集中缺少三个月的数据，因此分析中也缺少这些数据。一旦NWSS发布了新的数据集，这里显示的软件应该重新运行，结果得到验证——也许会加强或削弱相关性。</p><p id="e6cc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我计算了上述变量之间的标准等级相关性。增强的数据集还可以接受更高级的统计分析，可能是<a class="ae kv" href="https://en.wikipedia.org/wiki/Approximate_Bayesian_computation" rel="noopener ugc nofollow" target="_blank">近似贝叶斯计算</a>或考虑大规模(50，000+)样本集和多种结果测量的测试。</p><p id="2481" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我的熊猫源代码允许轻松调整“前瞻”值。例如，可以对21天后的住院和28天后的死亡进行相同的分析。有趣的是用不同的前瞻间隔进行实验，看看哪个在废水RNA和新冠肺炎结果之间产生最强的相关性。</p><h1 id="8b37" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">了解更多信息</h1><p id="5de6" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="https://covid.cdc.gov/covid-data-tracker/#wastewater-surveillance" rel="noopener ugc nofollow" target="_blank">https://covid . CDC . gov/covid-data-tracker/#废水监控</a> (NWSS仪表板)</p><p id="4331" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">https://data.cdc.gov/browse<a class="ae kv" href="https://data.cdc.gov/browse" rel="noopener ugc nofollow" target="_blank"/>(所有CDC数据集的主页)</p><p id="34f7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">https://en.wikipedia.org/wiki/Correlation<a class="ae kv" href="https://en.wikipedia.org/wiki/Correlation" rel="noopener ugc nofollow" target="_blank">(斯皮尔曼和皮尔逊相关)</a></p></div></div>    
</body>
</html>