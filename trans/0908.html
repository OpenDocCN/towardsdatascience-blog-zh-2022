<html>
<head>
<title>DIY your Own Video Editor with Screen Recording</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用屏幕录制 DIY 你自己的视频编辑器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/diy-your-own-video-editor-with-screen-recording-eb6046f5cea7#2022-03-10">https://towardsdatascience.com/diy-your-own-video-editor-with-screen-recording-eb6046f5cea7#2022-03-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bf85" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">简化屏幕录制、视频编辑和格式转换的简单 Python 解决方案</h2></div><p id="5e75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们中的许多人使用记录器软件来捕捉屏幕活动作为视频文件。不同的录像机可能支持不同的视频格式，如<em class="lb"> AVI </em>、<em class="lb"> MP4 </em>、<em class="lb"> GIF </em>等。输出的视频通常不是我们想要的。也许我们需要另一个编辑器来裁剪和修剪视频，或者将它们转换成我们需要的格式。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/9bdd607f08a51e0a9c3c94f91f7f91cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ohFdZY_rtuK9EomPqATbPQ.gif"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">和平:作者的形象</p></figure><p id="b99f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了简化这个过程，本文介绍了一个简单的 Python 解决方案，它是一个高度可定制的 DIY 工具，具有所有这些功能，即屏幕录制、简单的视频编辑和格式转换。</p><p id="9e69" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在接下来的几节中，作者将带您了解如何创建这样的工具。本文中的所有代码都可以在我的<a class="ae ls" href="https://github.com/steveyx/screengrab-video" rel="noopener ugc nofollow" target="_blank"> git 库</a>中找到。</p><h1 id="6d24" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">屏幕录制</h1><p id="243f" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">python 库，即<em class="lb"> Pynput </em>、<em class="lb"> PyAutoGUI </em>和<em class="lb"> OpenCV </em>用于记录屏幕活动。</p><h2 id="894f" class="mq lu iq bd lv mr ms dn lz mt mu dp md ko mv mw mf ks mx my mh kw mz na mj nb bi translated">选择要录制的区域</h2><p id="b2bb" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">这里使用的<em class="lb"> Pynput </em>是帮助用户通过鼠标点击(左键)选择屏幕上的一个区域。它记录鼠标点击事件中的鼠标位置。</p><p id="a5bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以使用左上角点(<em class="lb"> x </em>、<em class="lb"> y </em>)、宽度<em class="lb"> w </em>和高度<em class="lb"> h、</em>定义一个选中的矩形区域，如下图所示。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/22dfe5166efe4d10bb6ab1ac25a6766a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*AwkMywlWNASouwx8c_L1rw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">选定的矩形区域(图片由作者提供)</p></figure><p id="c019" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给定按下和释放事件上的鼠标位置，下面的函数返回所选区域的参数，即<em class="lb"> x </em>、<em class="lb"> y </em>、<em class="lb"> w </em>和<em class="lb"> h </em>。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="2496" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您需要捕获整个屏幕，您可以使用下面的 PyAutoGui 命令来获取该区域。</p><pre class="ld le lf lg gt nf ng nh ni aw nj bi"><span id="71e4" class="mq lu iq ng b gy nk nl l nm nn">wh = pyautogui.size()<br/>region = [0, 0, wh.width, wh.height]</span></pre><h2 id="1856" class="mq lu iq bd lv mr ms dn lz mt mu dp md ko mv mw mf ks mx my mh kw mz na mj nb bi translated">记录该地区的屏幕活动</h2><p id="71d9" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated"><a class="ae ls" href="https://pyautogui.readthedocs.io/en/latest/roadmap.html" rel="noopener ugc nofollow" target="_blank"> <em class="lb"> PyAutoGUI </em> </a>是一个跨平台的鼠标键盘控件和一个简单的 API。PyAutoGUI 获取单独的截图或帧，其中区域是上面选择的矩形。</p><p id="c6d8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">然后用 OpenCV </em>将连续截图保存为视频。它支持不同的视频格式，如<em class="lb"> AVI </em>和<em class="lb"> MP4。</em>也可以设置其他参数，例如每秒帧数(fps)。在 OpenCV 中，将图像从 BRG(蓝红绿)转换到 RGB(红绿蓝)颜色模型也是必要的。</p><p id="cebe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该屏幕录制功能的代码如下:</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="f2fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面显示了一个录制视频的示例。这个视频包含了该地区所有的荧屏活动。有必要移除不需要的片段。以下部分将介绍如何编辑该视频，即视频修剪和裁剪。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi no"><img src="../Images/f1d5e9f552f3c1ddbfc3ef22dd648b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Mg05dXBbPwEwS_NrJHQELA.gif"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">录制屏幕的示例视频</p></figure><h1 id="7d4f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">视频编辑</h1><p id="d257" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated"><em class="lb"> MoviePy </em>是一个流行的视频编辑 Python 模块。它支持基本操作(如修剪、裁剪、连接、标题插入)、视频处理或创建高级效果。它可以读写最常见的视频格式，包括<em class="lb"> GIF </em>。</p><ul class=""><li id="fc00" class="np nq iq kh b ki kj kl km ko nr ks ns kw nt la nu nv nw nx bi translated">视频修剪</li></ul><p id="360a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用以下命令来修剪上面视频中不想要的片段:</p><pre class="ld le lf lg gt nf ng nh ni aw nj bi"><span id="703a" class="mq lu iq ng b gy nk nl l nm nn">clips = [<br/>    [(0, 2), (0, 8)], <br/>    [(0, 24), (0, 32)]<br/>]<br/>video = VideoFileClip("test_recording.mp4")<br/>clipped = [video.subclip(*clip) for clip in clips]<br/>final_clip = concatenate_videoclips(clipped)</span></pre><p id="3c46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中 clips 是要保留在视频中的两个视频片段(0m2s-0m8s)和(0m24s，0m32s)。运行完这几行代码后，这两段之外的其他剪辑将被删除。</p><ul class=""><li id="abe5" class="np nq iq kh b ki kj kl km ko nr ks ns kw nt la nu nv nw nx bi translated">视频裁剪</li></ul><p id="0758" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给定一个具有两个对角位置(即左上角和右下角)的矩形，可以使用下面的 MoviePy 命令来完成对视频的裁剪。</p><pre class="ld le lf lg gt nf ng nh ni aw nj bi"><span id="da08" class="mq lu iq ng b gy nk nl l nm nn">x1, y1 = (10, 240)<br/>x2, y2 = (610, 680) <br/>cropped = vfx.crop(video, x1=x1, y1=y1, x2=x2, y2=y2)</span></pre><ul class=""><li id="6765" class="np nq iq kh b ki kj kl km ko nr ks ns kw nt la nu nv nw nx bi translated">格式转换</li></ul><p id="ca30" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb"> MoviePy </em>可以将视频导出为<em class="lb"> GIF </em>图片或<em class="lb"> MP4 </em>等文件格式，如下所示:</p><pre class="ld le lf lg gt nf ng nh ni aw nj bi"><span id="0c72" class="mq lu iq ng b gy nk nl l nm nn">video.write_gif("saved.gif", fps=10)<br/>video.write_videofile("saved.mp4", fps=10)</span></pre><p id="0289" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，经过修剪和裁剪后，视频如下图所示:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/b28f02c17e06156a9911afdaabb11d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*TQq4wazYjjmyJR5363o06w.gif"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">编辑后的视频:作者提供的图片</p></figure><h2 id="1e86" class="mq lu iq bd lv mr ms dn lz mt mu dp md ko mv mw mf ks mx my mh kw mz na mj nb bi translated">从图像创建视频</h2><p id="6dd8" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">使用 MoviePy，我们还可以为一系列图像创建一个视频。</p><p id="f0b9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们有 30 张同样大小的图片，名字分别是<em class="lb"> img_0.png </em>、<em class="lb"> img_1.png </em>、…、<em class="lb"> img_29.png </em>。要将这些图像连接成标题为 Peace 的顶部 GIF 图片，我们只需运行下面这段代码。</p><pre class="ld le lf lg gt nf ng nh ni aw nj bi"><span id="434a" class="mq lu iq ng b gy nk nl l nm nn">images = ["images/img_{}.png".format(i) for i in range(30)]<br/>clips = [ImageClip(m).set_duration(1) for m in images]<br/>concat_clip = concatenate_videoclips(clips, method="compose")<br/>concat_clip.write_gif(out_filename, fps=1)</span></pre><p id="7bf9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码中，每个图像剪辑的持续时间设置为 1 秒，对应的 fps=1。</p><h1 id="20fb" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="7307" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">本文介绍了一个简单的 DIY 视频编辑工具的解决方案，带有额外的屏幕录制功能。该工具基于开源 Python 库 Pynput、PyAutoGui、OpenCV 和 MoviePy 构建。你可以在方便的时候使用它。</p><p id="4f86" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了进一步定制您的工具，更多的 MoviePy 或 OpenCV 功能，如对象检测和跟踪等。可能会添加。</p><p id="3edd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读。请随意发表评论。如果你喜欢这篇文章或这个 DIY 工具，请分享给你的朋友，并关注我。</p><h1 id="eed8" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">参考</h1><ol class=""><li id="8375" class="np nq iq kh b ki ml kl mm ko nz ks oa kw ob la oc nv nw nx bi translated"><a class="ae ls" href="https://pynput.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://pynput.readthedocs.io/en/latest/</a></li><li id="e04b" class="np nq iq kh b ki od kl oe ko of ks og kw oh la oc nv nw nx bi translated"><a class="ae ls" href="https://pyautogui.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://pyautogui.readthedocs.io/en/latest/</a></li><li id="ce2f" class="np nq iq kh b ki od kl oe ko of ks og kw oh la oc nv nw nx bi translated"><a class="ae ls" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank">https://opencv.org/</a></li><li id="3004" class="np nq iq kh b ki od kl oe ko of ks og kw oh la oc nv nw nx bi translated"><a class="ae ls" href="https://zulko.github.io/moviepy/" rel="noopener ugc nofollow" target="_blank">https://zulko.github.io/moviepy/</a></li></ol></div></div>    
</body>
</html>