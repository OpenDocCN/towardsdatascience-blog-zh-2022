<html>
<head>
<title>EEG 101 using OpenBCI Ultracortex</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用OpenBCI Ultracortex的脑电图101</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/eeg-101-using-openbci-ultracortex-fbeb0202d0c5#2022-09-04">https://towardsdatascience.com/eeg-101-using-openbci-ultracortex-fbeb0202d0c5#2022-09-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f924" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<em class="kl">open BCI</em>—<em class="kl">ultra cortex Mark IV EEG耳机演示EEG(脑电图)<strong class="jp ir"> </strong>信号中的数据采集、数据滤波和去噪技术的教程。</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/a0cfb2ce7c467daf45bc012108594a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iKfrTclRrz6p4n3f6g4wJw.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图:1 (A)直接从Ultracortex Mark EEG耳机收集的未滤波EEG数据(B)带通滤波器(&gt; 1Hz和&lt;50 Hz) ( C)Denoising with Fast Fourier Transform(FFT).</p></figure><h1 id="60e4" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">Modus Operandi</h1><p id="d0f5" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">I have recorded live EEG※ from my own scalp using an <em class="kl"> Ultracortex Mark IV EEG耳机</em> :) Ultracortex耳机共有16个通道，但在本教程中，我们将仅使用8个通道(图2)。电极按照<em class="kl">国际10–20系统</em>放置，这使我们能够测量大脑皮层中潜在的电活动。</p><p id="d32b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di"> E </span>电极放置:<em class="kl"> Fp1 </em>和Fp2，测量额叶前部皮层的活动，<em class="kl"> C3 </em>和<em class="kl"> C4 </em>，来自顶叶的<em class="kl"> P7 </em> / <em class="kl"> T5 </em>和<em class="kl"> P8 </em> / <em class="kl"> T6 </em>，颞侧的<em class="kl"> O1 </em>和<em class="kl"> O2 </em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mo"><img src="../Images/37b11b139560da4abb681fea14c08e41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yyrcvEQvuvH3b0nEpYeamQ.jpeg"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图2:使用基于国际10–20系统的Cyton板(8通道)收集EEG数据。</p></figure><p id="78df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Ultracortex Mark IV※可用于湿电极和干电极。它也可以被配置成作为有源电极或无源电极工作。但是对于这个实验的范围，我使用了<em class="kl">干电极和无源电极</em>的组合以及<em class="kl"> Cyton生物传感板</em> ※以<em class="kl"> 250赫兹(采样频率)</em>采样信号。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="72ae" class="lc ld iq bd le lf mw lh li lj mx ll lm ln my lp lq lr mz lt lu lv na lx ly lz bi translated">数据收集</h1><p id="0224" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在<em class="kl"> Python (Python 3.8.0: CPython实现)</em>中，我们将使用<a class="ae nb" href="https://brainflow.readthedocs.io/en/stable/UserAPI.html" rel="noopener ugc nofollow" target="_blank"> BrainFlow用户API </a> ※ (BoardShim类)进行数据收集，使用Scipy(信号类)进行数据过滤和去噪技术。这两个软件包都可以通过pip安装在终端中，如下所示:</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="8a89" class="nh ld iq nd b gy ni nj l nk nl">pip install brainflow</span><span id="b7a7" class="nh ld iq nd b gy nm nj l nk nl">pip install scipy</span></pre><p id="5b03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们开始编码吧！！(<a class="ae nb" href="https://github.com/pareeknikhil/EEG/blob/master/UltraCortex/src/collection.py" rel="noopener ugc nofollow" target="_blank"> Github: collection.py </a>)</p><ol class=""><li id="4cf6" class="nn no iq jp b jq jr ju jv jy np kc nq kg nr kk ns nt nu nv bi translated">库导入</li></ol><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="b90a" class="nh ld iq nd b gy ni nj l nk nl">import time<br/>import argparse<br/>import numpy as np<br/>import pandas as pd</span><span id="9d74" class="nh ld iq nd b gy nm nj l nk nl">from brainflow.board_shim import BoardShim, BrainFlowInputParams</span></pre><p id="ed24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.串行端口和板ID配置</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="9803" class="nh ld iq nd b gy ni nj l nk nl">parser = argparse.ArgumentParser()</span><span id="0859" class="nh ld iq nd b gy nm nj l nk nl">parser.add_argument('--serial-port', type=str,<br/>        help='serial port', required=False, default='/dev/ttyUSB0')</span><span id="f4c3" class="nh ld iq nd b gy nm nj l nk nl">parser.add_argument('--board-id', type=int,<br/>        help='board id, check docs to get a list of supported<br/>        boards', required=False, default=0) ## Cyton board ID = 0)</span><span id="ec39" class="nh ld iq nd b gy nm nj l nk nl">args = parser.parse_args()</span></pre><p id="7c86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.用于加载配置的BrainflowInput参数API</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="f12a" class="nh ld iq nd b gy ni nj l nk nl">params = BrainFlowInputParams()<br/>params.serial_port = args.serial_port<br/>board = BoardShim(args.board_id, params)</span></pre><p id="e277" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.记录实时脑电图数据流(时间间隔= 1秒)</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="ac19" class="nh ld iq nd b gy ni nj l nk nl">board.prepare_session()<br/>board.start_stream()<br/>time.sleep(1)<br/>data = board.get_board_data(250*1) ## (250 Hz @ 1sec) ##<br/>board.stop_stream()<br/>board.release_session()</span></pre><p id="2d34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di"> N </span>注意:<code class="fe nw nx ny nd b">get_board_data()</code>方法获取最新的板卡数据，并从环形缓冲区中删除这些数据。其他方法如<code class="fe nw nx ny nd b"><strong class="jp ir">get_current_board_data()</strong></code> <strong class="jp ir"> </strong>如果没有足够的数据，则获取指定数量或更少的数据，并且不从环形缓冲区中移除数据。</p><p id="52e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.获取Cyton板所有活动EEG通道的列表</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="a61d" class="nh ld iq nd b gy ni nj l nk nl">eeg_channels = BoardShim.get_eeg_channels(args.board_id)<br/>eeg_names = BoardShim.get_eeg_names(args.board_id)</span></pre><p id="e877" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mf translated">注:Cyton板有24个通道来捕捉所有生物传感活动(体温、心跳等)。但在我们目前的设置中，我们使用的是8通道EEG配置:Fp1、Fp2、C1、C2、P7、P8、O1和O2。</p><p id="62f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.将脑电图数据存储到CSV文件中</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="3f9d" class="nh ld iq nd b gy ni nj l nk nl">df = pd.DataFrame(np.transpose(data[:,1:]))<br/>df_eeg = df[eeg_channels]<br/>df_eeg.columns = eeg_names</span><span id="971a" class="nh ld iq nd b gy nm nj l nk nl">df_eeg.to_csv('data.csv', sep=',', index = False)</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nz"><img src="../Images/d4b623bb0a477860c4c040f6d5d35fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RG8VF03WXEu7eWQVR_rs-A.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图3:熊猫数据框架的前10行数据。</p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="783a" class="lc ld iq bd le lf mw lh li lj mx ll lm ln my lp lq lr mz lt lu lv na lx ly lz bi translated">数据分解</h1><p id="29a2" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">EEG信号可以分解成多个频段，每个频段都有独特的功能特征，如图4所示。这些子带的范围从被称为以0.1赫兹振荡的德尔塔波的极低频到被称为以40赫兹振荡的伽马波的高频。我们过滤掉其余的频率。※</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oa"><img src="../Images/79bfd1fd2fbf14598cb623a8ab29805a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYTxPLLJ-CwZMlluSILzLA.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图4:脑电图中感兴趣的频谱(频域)。</p></figure><p id="274d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本教程中，我们将使用带通滤波器对数据进行滤波，这也是信号处理中最常用的滤波器。重要的是要注意，在应用滤波器后，信号会被<em class="kl">衰减</em>，即当频率成分被移除时，信号强度会有<em class="kl">强度降低</em>。人们可以在图1中观察到同样的情况；原始EEG和带通数据之间的幅度差异(V)。</p><p id="13bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di"> N </span>注:为了简化计算，我们将只对其中一个通道进行预处理，即使用带通滤波器对Fp2(前额叶皮层—右侧)进行预处理，并将其分解为各种其他子带。</p><p id="a25f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们开始编码吧！！(<a class="ae nb" href="https://github.com/pareeknikhil/EEG/blob/master/UltraCortex/src/bands.py" rel="noopener ugc nofollow" target="_blank"> Github: bands.py </a>)</p><ol class=""><li id="cd20" class="nn no iq jp b jq jr ju jv jy np kc nq kg nr kk ns nt nu nv bi translated">库导入</li></ol><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="1bc9" class="nh ld iq nd b gy ni nj l nk nl">import pandas as pd<br/>import matplotlib.pyplot as plt</span><span id="24e1" class="nh ld iq nd b gy nm nj l nk nl">from scipy.signal import butter, lfilter, lfilter_zi</span></pre><p id="ed56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.定义带通滤波方法</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="8d04" class="nh ld iq nd b gy ni nj l nk nl">def butter_bandpass(lowcut, highcut, fs, order=5):<br/>    nyq = 0.5 * fs<br/>    low = lowcut / nyq<br/>    high = highcut / nyq<br/>    b, a = butter(order, [low, high], btype='band')<br/>    return b, a</span><span id="2933" class="nh ld iq nd b gy nm nj l nk nl">def butter_bandpass_filter(data, lowcut, highcut, fs, order=5):<br/>    b, a = butter_bandpass(lowcut, highcut, fs, order=order)<br/>    zi = lfilter_zi(b, a) * data[0]<br/>    y, _ = lfilter(b, a, data, zi=zi)<br/>    return y</span></pre><p id="97ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.分解频带(α、β、δ、θ、γ)</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="4cfd" class="nh ld iq nd b gy ni nj l nk nl">sampling_frequency = 250</span><span id="c72d" class="nh ld iq nd b gy nm nj l nk nl">df = pd.read_csv('data.csv')</span><span id="0dc9" class="nh ld iq nd b gy nm nj l nk nl">delta = butter_bandpass_filter(data = df.Fp2, lowcut = 0.1, highcut<br/>    = 4 , fs = sampling_frequency, order = 3)</span><span id="93aa" class="nh ld iq nd b gy nm nj l nk nl">theta = butter_bandpass_filter(data = df.Fp2, lowcut = 4, highcut<br/>    = 8, fs = sampling_frequency, order = 3)</span><span id="11b0" class="nh ld iq nd b gy nm nj l nk nl">alpha = butter_bandpass_filter(data = df.Fp2, lowcut = 8, highcut<br/>    = 13, fs = sampling_frequency, order = 3)</span><span id="860f" class="nh ld iq nd b gy nm nj l nk nl">beta = butter_bandpass_filter(data = df.Fp2, lowcut = 13, highcut<br/>    = 32, fs = sampling_frequency, order = 3)</span><span id="9865" class="nh ld iq nd b gy nm nj l nk nl">gamma = butter_bandpass_filter(data = df.Fp2, lowcut = 32, highcut<br/>    = 50, fs = sampling_frequency, order = 3)</span></pre><p id="3319" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.数据可视化(图5:脑电波分解)</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="fe6d" class="nh ld iq nd b gy ni nj l nk nl">fig = plt.figure(1)</span><span id="d119" class="nh ld iq nd b gy nm nj l nk nl">plt.subplot(6,1,1)<br/>plt.plot(df.Fp2, linewidth=2)</span><span id="5dbe" class="nh ld iq nd b gy nm nj l nk nl">plt.subplot(6,1,2)<br/>plt.plot(delta, linewidth=2)</span><span id="dc4e" class="nh ld iq nd b gy nm nj l nk nl">plt.subplot(6,1,3)<br/>plt.plot(theta, linewidth=2)</span><span id="50e3" class="nh ld iq nd b gy nm nj l nk nl">plt.subplot(6,1,4)<br/>plt.plot(alpha, linewidth=2)</span><span id="4e27" class="nh ld iq nd b gy nm nj l nk nl">plt.subplot(6,1,5)<br/>plt.plot(beta, linewidth=2)</span><span id="889f" class="nh ld iq nd b gy nm nj l nk nl">plt.subplot(6,1,6)<br/>plt.plot(gamma, linewidth=2)</span><span id="d3cb" class="nh ld iq nd b gy nm nj l nk nl">plt.show()</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/2afb89613ac40d8256b6b9cbdc094e0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*lZbGpGy_teDO-8e_qlEFkg.jpeg"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图5:单个波形在不同频率下进行滤波，以展示其频率构成。</p></figure><p id="f8f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di"> N </span>注:随着滤波器阶数的增加，滚降也会降低，从而大幅削减阻带频率，但更高的阶数也会在滤波数据中引入延迟。与当前值(即3)相比，通过将上述代码中的顺序更改为1，可以看到相同的情况。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="d6b0" class="lc ld iq bd le lf mw lh li lj mx ll lm ln my lp lq lr mz lt lu lv na lx ly lz bi translated">用FFT对数据去噪</h1><p id="425b" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">FFT是信号处理中最受欢迎的算法之一，是数字通信、音频和图像压缩以及卫星电视中的一个重要组成部分。在本教程中，我们将利用快速傅立叶变换(FFT)算法从EEG数据的原始结构中提取噪声数据。</p><p id="902e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在收集EEG时，有许多假象频率被引入到波形中，这些假象频率不是由人脑活动直接产生的，因此降低了数据结构的锐度。FFT帮助我们从草地(原始脑电图波形)中去除杂草(噪声)。由于数字(CPU、GPU)或生理假象(呼吸、脉搏和眨眼)，这些微弱的频率很可能是在收集EEG时被拾取的。</p><p id="1d4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di"> F </span>人们也可以将FFT理解为信号从时域到频域的变换。</p><p id="d18f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将通过FFT算法传递上一步过滤后的EEG(带通滤波器),并希望找到EEG中最显著的频率成分。稍后，我们将过滤掉功率较低的频率(或“弱”频率)。我们将使用频率的功率谱密度(PSD)度量特定频率在给定EEG波形中对其形状的贡献有多重要。</p><p id="9e2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们开始编码吧！！(<a class="ae nb" href="https://github.com/pareeknikhil/EEG/blob/master/UltraCortex/src/denoise.py" rel="noopener ugc nofollow" target="_blank">Github:noise . py</a>)</p><ol class=""><li id="f315" class="nn no iq jp b jq jr ju jv jy np kc nq kg nr kk ns nt nu nv bi translated">库导入</li></ol><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="bec8" class="nh ld iq nd b gy ni nj l nk nl">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from scipy.signal import iirnotch, freqz, filtfilt</span></pre><p id="baa7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.使用带通滤波器(包括陷波滤波器)</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="33c7" class="nh ld iq nd b gy ni nj l nk nl">df = pd.read_csv('data.csv')<br/>band_pass_eeg = butter_bandpass_filter(data = df.Fp2, lowcut = 1,<br/>                  highcut = 50, fs = 250, order = 3)</span><span id="b0d3" class="nh ld iq nd b gy nm nj l nk nl">b_notch, a_notch = iirnotch(w0=59.9250936329588, Q=20, fs=250)<br/>filtered_eeg = filtfilt(b_notch, a_notch, band_pass_eeg)</span></pre><p id="cdc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.计算傅立叶系数(复数值):</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="8f4c" class="nh ld iq nd b gy ni nj l nk nl">number_of_points = len(filtered_eeg)</span><span id="525b" class="nh ld iq nd b gy nm nj l nk nl">fhat = np.fft.fft(filtered_eeg, number_of_points)<br/>PSD = fhat * np.conj(fhat) / number_of_points<br/>freq = (1/(0.004*number_of_points))*np.arange(number_of_points)<br/>L = np.arange(1,np.floor(number_of_points/2),dtype='int')</span></pre><p id="3cb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.用PSD滤除噪声</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="7995" class="nh ld iq nd b gy ni nj l nk nl">indices = PSD &gt; 150<br/>PSDclean = PSD * indices<br/>fhat = indices * fhat<br/>ffilt = np.fft.ifft(fhat)</span></pre><p id="8ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.数据可视化(图6:降噪和噪声数据的功率密度)</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="67a0" class="nh ld iq nd b gy ni nj l nk nl">fig,axs = plt.subplots(3,1)</span><span id="5703" class="nh ld iq nd b gy nm nj l nk nl">data_points = np.arange(number_of_points)</span><span id="1427" class="nh ld iq nd b gy nm nj l nk nl">plt.sca(axs[0])<br/>plt.plot(data_points,band_pass_eeg, color='k',linewidth=1.5,<br/>               label='Bandpass filter')<br/>plt.xlim(data_points[0],data_points[-1])<br/>plt.legend()</span><span id="17b3" class="nh ld iq nd b gy nm nj l nk nl">plt.sca(axs[1])<br/>plt.plot(data_points,ffilt,color='b',linewidth=2,<br/>           label='FFT Filtered')<br/>plt.xlim(data_points[0],data_points[-1])<br/>plt.legend()</span><span id="0b69" class="nh ld iq nd b gy nm nj l nk nl">plt.sca(axs[2])<br/>plt.plot(freq[L][3:75],PSD[L[3:75],color= 'r',linewidth=2,<br/>            label='Noisy')</span><span id="eedf" class="nh ld iq nd b gy nm nj l nk nl">plt.plot(freq[L][3:75],PSDclean[L][3:75],color='b',linewidth=1.5,<br/>            label='Filtered')<br/>plt.legend()<br/>plt.xticks(freq[L][3:75:5])</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oc"><img src="../Images/9b7c23d2276d30108553863900326132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1-4VdHuP4Tfxyz-AgEjuQ.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图6 —(A)来自带通滤波器的数据,( B)通过FFT后的数据,( C)噪声和干净数据的PSD。</p></figure><p id="3060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管我们有嘈杂的数据，但在<strong class="jp ir">θ</strong>、<strong class="jp ir">α</strong>和<strong class="jp ir">β</strong>光谱中有一些清晰的峰值，这是显而易见的，因为我在收集我的大脑数据时处于完全警觉状态:)(图6 — (C))。</p><p id="3e51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们选择功率的截止值为150，因此强度小于150的所有频率都将从信号中截止。去除噪底后，信号更加清晰锐利。</p><p id="594f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di"> F </span>最后注意:预处理EEG数据时需要小心，因为它可能会改变事件相关电位的时间结构，可能无法绘制出准确的大脑反应。过滤会改变你的数据，因此，根据一般经验，<em class="kl">过滤越少越好</em>。</p><blockquote class="od oe of"><p id="b5fb" class="jn jo kl jp b jq jr js jt ju jv jw jx og jz ka kb oh kd ke kf oi kh ki kj kk ij bi translated">我想衷心感谢<a class="oj ok ep" href="https://medium.com/u/92f4fdfa4e17?source=post_page-----fbeb0202d0c5--------------------------------" rel="noopener" target="_blank"> Titiksha Bhardwaj </a>在本教程中设计了以上所有的视觉效果。没有她，这样有见地的插图是不可能的。谢谢:)</p></blockquote><p id="8602" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">※参考文献:</p><ol class=""><li id="08c4" class="nn no iq jp b jq jr ju jv jy np kc nq kg nr kk ns nt nu nv bi translated">定义<a class="ae nb" href="https://en.wikipedia.org/wiki/Electroencephalography" rel="noopener ugc nofollow" target="_blank">脑电图</a>(维基)</li><li id="2b5a" class="nn no iq jp b jq ol ju om jy on kc oo kg op kk ns nt nu nv bi translated"><a class="ae nb" href="https://en.wikipedia.org/wiki/10%E2%80%9320_system_(EEG)" rel="noopener ugc nofollow" target="_blank">10–20脑电图采集国际系统</a>(维基)</li><li id="8b70" class="nn no iq jp b jq ol ju om jy on kc oo kg op kk ns nt nu nv bi translated"><a class="ae nb" href="https://github.com/OpenBCI/Ultracortex" rel="noopener ugc nofollow" target="_blank"> OpenBCI — UltraCortex耳机</a>设置</li><li id="df88" class="nn no iq jp b jq ol ju om jy on kc oo kg op kk ns nt nu nv bi translated"><a class="ae nb" href="https://docs.openbci.com/Cyton/CytonLanding/" rel="noopener ugc nofollow" target="_blank"> OpenBCI Cyton </a>生物传感板</li><li id="3b14" class="nn no iq jp b jq ol ju om jy on kc oo kg op kk ns nt nu nv bi translated"><a class="ae nb" href="https://brainflow.readthedocs.io/en/stable/UserAPI.html" rel="noopener ugc nofollow" target="_blank">人才流动—用户应用编程接口</a></li><li id="d8dc" class="nn no iq jp b jq ol ju om jy on kc oo kg op kk ns nt nu nv bi translated"><a class="ae nb" href="https://asp-eurasipjournals.springeropen.com/track/pdf/10.1186/s13634-019-0606-8.pdf" rel="noopener ugc nofollow" target="_blank">脑电信号的频谱信息</a>(EURASIP-信号处理进展杂志)</li><li id="9adb" class="nn no iq jp b jq ol ju om jy on kc oo kg op kk ns nt nu nv bi translated"><a class="ae nb" href="http://databookuw.com/" rel="noopener ugc nofollow" target="_blank">用Python去噪</a> (databook.uw — Steve Brunton —华盛顿大学)</li></ol></div></div>    
</body>
</html>