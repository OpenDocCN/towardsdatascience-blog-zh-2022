<html>
<head>
<title>Remote View your Computer Vision Models Running on AWS Panorama</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">远程查看在AWS Panorama上运行的计算机视觉模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/remote-view-your-computer-vision-models-running-on-aws-panorama-32922369ecf#2022-05-07">https://towardsdatascience.com/remote-view-your-computer-vision-models-running-on-aws-panorama-32922369ecf#2022-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="811e" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">监控全景应用程序</h2><div class=""/><div class=""><h2 id="cf71" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">SkyLine简介:从工作站查看Panorama应用程序输出的库</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/7a8fbfe1ce69ead5ba294c605312f157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vLsXUmuRTxrxDobj"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@elisasch?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Elisa Schmidt </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="95b5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">实时智能视频分析应用开发和边缘设备部署是一项复杂的任务。在过去的几年中，行业参与者构建了支持这一活动的平台。著名的例子包括<a class="ae le" href="https://www.nvidia.com/en-us/autonomous-machines/intelligent-video-analytics-platform/" rel="noopener ugc nofollow" target="_blank">英伟达Metropolis </a>、<a class="ae le" href="https://www.intel.com/content/www/us/en/developer/tools/openvino-toolkit/overview.html" rel="noopener ugc nofollow" target="_blank">英特尔的OpenVINO </a>和<a class="ae le" href="https://aws.amazon.com/panorama/" rel="noopener ugc nofollow" target="_blank"> AWS Panorama </a>。虽然这些解决方案使视频分析应用程序开发的某些方面更加简单，但在生产中部署视频分析应用程序之前，仍有许多问题需要处理。这篇文章介绍了SkyLine，它是开源工具系列<a class="ae le" href="https://github.com/Neosperience/backpack" rel="noopener ugc nofollow" target="_blank">中的第一款</a>，可以简化AWS Panorama应用程序的开发。</p><p id="3c51" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">AWS Panorama是一个机器学习设备和软件框架，允许您在edge上部署视频分析应用程序。有关部署Panorama应用程序的详细介绍和分步指南，请参考<a class="ae le" rel="noopener" target="_blank" href="/deploy-an-object-detector-model-at-the-edge-on-aws-panorama-9b80ea1dd03a"> <em class="mb">在AWS Panorama的边缘部署对象检测器模型</em> </a>。</p><p id="b08a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">AWS Panorama框架简化了视频分析应用程序开发的许多方面，包括摄像机连接管理、视频解码、帧提取、模型优化和加载、显示输出管理、应用程序的无线部署以及其他功能。尽管如此，一些任务仍然具有挑战性，包括当模型不按预期工作时的诊断任务。</p><h1 id="de0b" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">天际线介绍</h1><p id="ad7e" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">获得有关Panorama应用程序正确功能的视觉反馈的唯一可用方法是将显示器物理连接到设备的HDMI端口。显示器将显示部署在设备上的单个应用程序的输出视频流。然而，实际接触设备并不总是可行的。SkyLine允许将任何Panorama应用程序的输出视频重新流式传输到外部服务，例如，传输到<a class="ae le" href="https://docs.aws.amazon.com/kinesisvideostreams/latest/dg/what-is-kinesis-video.html" rel="noopener ugc nofollow" target="_blank"> AWS Kinesis视频流</a>。这个特性对于远程监控应用程序非常方便。</p><h2 id="3413" class="mz md iq bd me na nb dn mi nc nd dp mm lo ne nf mo ls ng nh mq lw ni nj ms iw bi translated">SkyLine是如何工作的？</h2><p id="6811" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">SkyLine实例化一个头部带有<code class="fe nk nl nm nn b"><a class="ae le" href="https://gstreamer.freedesktop.org/documentation/app/appsrc.html" rel="noopener ugc nofollow" target="_blank">appsrc</a></code>元素的<a class="ae le" href="https://gstreamer.freedesktop.org/documentation/application-development/introduction/basics.html" rel="noopener ugc nofollow" target="_blank"> GStreamer管道</a>。一个<a class="ae le" href="https://docs.opencv.org/4.5.5/dd/d43/tutorial_py_video_display.html" rel="noopener ugc nofollow" target="_blank"> OpenCV </a> <code class="fe nk nl nm nn b"><a class="ae le" href="https://docs.opencv.org/4.5.5/dd/d43/tutorial_py_video_display.html" rel="noopener ugc nofollow" target="_blank">VideoWriter</a></code>被配置为向<code class="fe nk nl nm nn b">appsrc</code>写入:它不是将连续的帧保存到视频文件，而是流式传输到输出接收器。当打开<code class="fe nk nl nm nn b">VideoWriter</code>实例时，用户应该指定输出流的帧宽和帧高以及帧速率。您可以手动设置这些参数，或者让SkyLine根据输入尺寸和向其输入新帧的频率来推断这些参数。如果使用这种自动配置功能，一些帧(默认为100帧)将在流传输开始时被丢弃，因为SkyLine将使用它们来计算帧速率的统计数据并测量帧尺寸。这是天际线的“热身”。如果您发送不同大小的帧，SkyLine将调整输入的大小，但这会带来性能损失。您还需要以每秒帧数参数中指定的频率向SkyLine发送新帧。如果帧以不同的频率发送，视频片段在Kinesis视频流中就会不同步，您将无法流畅地重播视频。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/3eeffc68313647db458bcd1e47e3021b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*q_5X7-6bJxIl45XF"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Josh Redd 在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="25aa" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nk nl nm nn b">SkyLine</code>是处理GStreamer管道状态机的抽象基类。具体实现<code class="fe nk nl nm nn b">KVSSkyLine</code>向<a class="ae le" href="https://aws.amazon.com/kinesis/video-streams/" rel="noopener ugc nofollow" target="_blank">亚马逊Kinesis视频流</a>服务发送帧。很容易扩展SkyLine来支持其他服务，特别是如果已经有了一个GStreamer插件。</p><h1 id="f5af" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">将SkyLine集成到全景应用程序中</h1><h2 id="6d28" class="mz md iq bd me na nb dn mi nc nd dp mm lo ne nf mo ls ng nh mq lw ni nj ms iw bi translated">配置Docker容器</h2><p id="7047" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">SkyLine依赖于自定义编译的外部库。所有这些库必须在应用程序的docker容器中正确编译和配置，以使<code class="fe nk nl nm nn b">SkyLine</code>工作。这些库包括:</p><ul class=""><li id="2c06" class="np nq iq lh b li lj ll lm lo nr ls ns lw nt ma nu nv nw nx bi translated">GStreamer 1.0安装了标准插件包、libav、工具和开发库；</li><li id="5c58" class="np nq iq lh b li ny ll nz lo oa ls ob lw oc ma nu nv nw nx bi translated">OpenCV 4.2.0，用GStreamer支持和Python绑定编译；</li><li id="6afc" class="np nq iq lh b li ny ll nz lo oa ls ob lw oc ma nu nv nw nx bi translated">numpy(通常由Panorama应用程序的基本docker映像安装)。</li></ul><p id="8600" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果您想使用<code class="fe nk nl nm nn b">KVSSkyLine</code>(将视频流传输到Amazon Kinesis视频流的<code class="fe nk nl nm nn b">SkyLine</code>实现)，它还需要以下库:</p><ul class=""><li id="9484" class="np nq iq lh b li lj ll lm lo nr ls ns lw nt ma nu nv nw nx bi translated">亚马逊Kinesis视频流(KVS)制作商SDK编译有GStreamer插件支持；</li><li id="b145" class="np nq iq lh b li ny ll nz lo oa ls ob lw oc ma nu nv nw nx bi translated">环境变量<code class="fe nk nl nm nn b">GST_PLUGIN_PATH</code>配置为指向KVS生产商SDK GStreamer插件编译后的二进制文件所在的目录；</li><li id="19a8" class="np nq iq lh b li ny ll nz lo oa ls ob lw oc ma nu nv nw nx bi translated">环境变量<code class="fe nk nl nm nn b">LD_LIBRARY_PATH</code>包括KVS制作商SDK编译的第三方开源依赖；</li><li id="fb80" class="np nq iq lh b li ny ll nz lo oa ls ob lw oc ma nu nv nw nx bi translated"><code class="fe nk nl nm nn b">boto3</code>(通常由Panorama应用程序的基本docker映像安装)。</li></ul><p id="679b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在SkyLine的源代码库中，examples文件夹中提供了一个<a class="ae le" href="https://github.com/Neosperience/backpack/blob/master/examples/Dockerfile" rel="noopener ugc nofollow" target="_blank">样例Dockerfile </a>，展示了如何在任何容器中正确安装这些库和SkyLine。在大多数情况下，只需要将示例中的相关部分复制到应用程序的docker文件中。请注意，第一次编译docker容器时，可能需要一个小时来正确编译所有的库。</p><h2 id="49f8" class="mz md iq bd me na nb dn mi nc nd dp mm lo ne nf mo ls ng nh mq lw ni nj ms iw bi translated">为KVSSkyLine设置AWS IAM权限</h2><p id="bdf2" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated"><code class="fe nk nl nm nn b">KVSSkyLine</code>使用包装在GStreamer sink元素中的Amazon Kinesis Video Streams(KVS)Producer库，将处理后的帧发送到KVS服务。KVS生产者需要AWS证书。它可以使用与Panorama应用程序角色关联的凭据，但您必须明确配置它。<code class="fe nk nl nm nn b">KVSSkyLine</code>需要权限来执行以下操作:</p><pre class="kp kq kr ks gt od nn oe of aw og bi"><span id="024b" class="mz md iq nn b gy oh oi l oj ok">kinesisvideo:DescribeStream<br/>kinesisvideo:GetStreamingEndpoint<br/>kinesisvideo:PutMedia</span></pre><p id="1613" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果<code class="fe nk nl nm nn b">KVSSkyLine</code>需要在第一次使用时自动创建Kinesis视频流，那么还应该包含<code class="fe nk nl nm nn b">kinesisvideo:CreateStream</code>动作。允许<code class="fe nk nl nm nn b">KVSSkyLine</code>向Kinesis视频流写入数据的示例策略如下所示:</p><pre class="kp kq kr ks gt od nn oe of aw og bi"><span id="8702" class="mz md iq nn b gy oh oi l oj ok">{<br/>    "Version": "2012-10-17",<br/>    "Statement": [<br/>        {<br/>            "Effect": "Allow",<br/>            "Action": [<br/>                "kinesisvideo:DescribeStream",<br/>                "kinesisvideo:CreateStream",<br/>                "kinesisvideo:GetDataEndpoint",<br/>                "kinesisvideo:PutMedia"<br/>            ],<br/>            "Resource": [<br/>                "*"<br/>            ]<br/>        }<br/>    ]<br/>}</span></pre><h2 id="f192" class="mz md iq bd me na nb dn mi nc nd dp mm lo ne nf mo ls ng nh mq lw ni nj ms iw bi translated">设置凭据</h2><p id="bf0b" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">有两种类型的AWS安全凭证:静态和临时。前者永远不会过期，如果发生泄漏，您应该手动使它们失效并重新配置应用程序。因此，强烈建议不要在生产环境中使用它们。静态AWS凭证的示例包括IAM用户的访问密钥Id和秘密访问密钥对。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ol"><img src="../Images/5fad6b3f0d42c32275b5ff412f5fc189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4vYvkW-ZE4BZmvmJ"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@mangelinka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安吉拉·梅伦科娃</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="3640" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">临时凭据在预定义的时间段后过期。在泄漏的情况下，它们只能在有效期内使用，通常在几个小时的量级。临时凭据可以在过期之前续订，以便延长其使用期限，或者可以在过期后更换为新凭据。这个过程需要来自使用这种类型的凭证的应用程序的额外协调。临时凭证的示例包括AWS访问密钥Id、秘密访问密钥和会话令牌。</p><p id="df8d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们提供不同的选项来为凭证提供在<code class="fe nk nl nm nn b">kvs</code>模块中提供的<code class="fe nk nl nm nn b">KVSCredentialsHandler</code>子类。如果您想使用静态凭证进行测试，<a class="ae le" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html" rel="noopener ugc nofollow" target="_blank">在您的AWS帐户中创建一个IAM用户</a>，并<a class="ae le" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach-detach.html" rel="noopener ugc nofollow" target="_blank">为该用户附加一个类似上面的策略</a>。您应该将该用户配置为对AWS资源进行编程访问，并获得用户的<a class="ae le" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html" rel="noopener ugc nofollow" target="_blank"> AWS访问密钥和密钥对</a>:在应用程序代码中创建一个<code class="fe nk nl nm nn b">KVSInlineCredentialsHandler</code>或<code class="fe nk nl nm nn b">KVSEnvironmentCredentialsHandler</code>实例，以便在GStreamer管道定义中直接或作为环境变量将这些凭证传递给KVS生产者插件。但是，由于这些凭据不会过期，因此不建议在生产环境中使用此配置。即使在开发和测试环境中，您也应该采取适当的安全措施来保护这些凭证:不要在源代码中硬编码它们。相反，使用AWS Secret Manager或类似的服务向您的应用程序提供这些参数。</p><p id="9e15" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nk nl nm nn b">KVSSkyLine</code>也可以使用<a class="ae le" href="https://docs.aws.amazon.com/panorama/latest/dev/permissions-application.html" rel="noopener ugc nofollow" target="_blank"> Panorama应用程序角色</a>将应用程序的凭证传递给KVS生产者。这些凭据是临时的，这意味着它们将在几个小时内过期，用户应该在过期前更新它们。生成器库需要文本文件中的临时凭据。<code class="fe nk nl nm nn b">KVSFileCredentialsHandler</code>管理凭证的更新，并定期用新凭证更新文本文件。如果您希望使用这种方法，请将类似于上面示例的策略附加到您的应用程序角色。请记住，如果在<code class="fe nk nl nm nn b">KVSFileCredentialsHandler</code>刷新凭证后Panorama应用程序——KVS集成仍然工作，请始终对其进行测试。让您的应用程序运行几个小时，并定期检查它是否继续向KVS传输视频。在更新凭证时，您还可以在应用程序的CloudWatch日志中找到诊断信息。</p><h2 id="1db9" class="mz md iq bd me na nb dn mi nc nd dp mm lo ne nf mo ls ng nh mq lw ni nj ms iw bi translated">环境变量</h2><p id="cbdf" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">需要两个环境变量让GStreamer找到KVS生产者插件。这些变量的名字是<code class="fe nk nl nm nn b">GST_PLUGIN_PATH</code>和<code class="fe nk nl nm nn b">LD_LIBRARY_PATH</code>。他们指向KVS生产商GStreamer插件及其第三方依赖项的文件夹。在提供的示例Dockerfile文件中，这些变量的正确值被写入容器中一个名为<code class="fe nk nl nm nn b">/panorama/.env</code>的小配置文件。您应该将该文件的路径传递给<code class="fe nk nl nm nn b">KVSSkyLine</code>，或者确保这些环境变量包含正确的值。</p><h1 id="f685" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">用法示例</h1><p id="e218" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">当初始化一个<code class="fe nk nl nm nn b">KVSSkyLine</code>实例时，您应该传递创建您的流的AWS区域名、流名和凭证处理程序实例。如果您想要手动配置帧速率和帧的尺寸，您也应该在这里设置它们。当两个参数都指定时，SkyLine跳过预热阶段，直接将第一帧发送给KVS。当您准备好发送帧时，调用打开GStreamer管道的<code class="fe nk nl nm nn b">start_streaming</code>方法。在这个方法被调用后，您需要定期向调用<code class="fe nk nl nm nn b">put</code>方法的流发送新的帧，发送频率在帧速率中指定或者由<code class="fe nk nl nm nn b">KVSSkyLine</code>推断。您可以在同一个<code class="fe nk nl nm nn b">KVSSkyLine</code>实例上停止和重新启动流式传输。</p><p id="962a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">以下示例使用由Panorama应用程序承担的IAM应用程序角色的临时凭据:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="om on l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><code class="fe nk nl nm nn b">KVS</code>天际线用法举例</p></figure><p id="0326" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果一切正常，你可以在AWS控制台的<a class="ae le" href="https://console.aws.amazon.com/kinesisvideo/home" rel="noopener ugc nofollow" target="_blank"> Kinesis视频流页面</a>上观看重新流过的视频。当然，你可以在将图像发送到SkyLine之前对其进行修改:根据深度学习模型的推理结果在其上绘制注释。</p><h1 id="c70c" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">释文</h1><p id="f73c" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated"><em class="mb">注释</em>和<em class="mb">注释驱动</em>提供了一种在不同渲染后端绘制注释的统一方式。目前，实现了两个注释驱动程序:</p><ul class=""><li id="bc2e" class="np nq iq lh b li lj ll lm lo nr ls ns lw nt ma nu nv nw nx bi translated"><code class="fe nk nl nm nn b">PanoramaMediaAnnotationDriver</code>允许您在<code class="fe nk nl nm nn b">panoramasdk.media</code>对象上绘制，并且</li><li id="08ca" class="np nq iq lh b li ny ll nz lo oa ls ob lw oc ma nu nv nw nx bi translated"><code class="fe nk nl nm nn b">OpenCVImageAnnotationDriver</code>允许你在一个OpenCV图像(numpy数组)上绘制对象。</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/32ebe4b883e73004577e1ecf6fc6d158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C-kmqUh2Cb_qHcip"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@lucasgwendt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢卡斯·乔治·温迪特</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="2e6b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">该库可以绘制两种类型的注释:标签和框。</p><h2 id="aa30" class="mz md iq bd me na nb dn mi nc nd dp mm lo ne nf mo ls ng nh mq lw ni nj ms iw bi translated">使用注释</h2><p id="b4b7" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">根据可用的后端，您可以在视频帧处理循环开始时创建一个或多个注释驱动程序实例。在处理单个帧的过程中，您需要在python集合中收集要在该帧上绘制的所有注释(例如，在<code class="fe nk nl nm nn b">list</code>中)。当处理完成时，您在任意数量的驱动程序上调用<code class="fe nk nl nm nn b">render</code>方法，传递相同的注释集合。注释中使用的所有坐标都被标准化为<code class="fe nk nl nm nn b">[0; 1)</code>范围。</p><p id="035d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">示例用法:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="om on l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">背包注释的用法示例</p></figure><h1 id="9f32" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">刊后语</h1><p id="2d1e" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">即使SkyLine是一个有用的工具，它的使用可能会引起两个问题，您应该仔细考虑。我们不鼓励在生产环境中使用SkyLine:它是一种开发辅助工具或调试工具。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/6928bdaca0abb6944555a14d6fbce1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L-i9f6e6JStovyIG"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">格雷格·罗森克在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2f8f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">第一个问题是技术性的。目前，Panorama应用程序中的应用程序代码不能直接访问板载GPU因此，SkyLine完成的所有视频编码都在设备的CPU上运行。这种行为可能会降低设备的速度:使用SkyLine传输单个输出流可能需要设备10–30%的CPU容量。</p><p id="531d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">第二个问题与数据保护有关。Panorama设备旨在保护正在处理的视频流。它有两个以太网接口，将摄像机网络(通常是闭路局域网)与设备的互联网接入分开。使用SkyLine，您可以将视频流从受保护的闭路摄像机网络传输到公共互联网。在使用SkyLine之前，您应该仔细检查您的应用程序和摄像机网络的数据保护要求。此外，根据<a class="ae le" href="https://aws.amazon.com/compliance/shared-responsibility-model/" rel="noopener ugc nofollow" target="_blank"> AWS共享责任模型</a>的要求，您有责任对SkyLine使用的所有AWS凭证保密。</p><h1 id="3987" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">从这里去哪里？</h1><p id="fa06" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated"><code class="fe nk nl nm nn b">SkyLine</code>是<code class="fe nk nl nm nn b">Backpack</code>的一部分，后者是一套更广泛的工具，旨在帮助AWS Panorama上的软件开发。其他组件将在以后的帖子中介绍，请继续关注我们，获取最新信息。</p><p id="500c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nk nl nm nn b">Backpack</code>是开源的，在GitHub 上<a class="ae le" href="https://github.com/Neosperience/backpack" rel="noopener ugc nofollow" target="_blank">可用。您可以在基于ARM64的系统上构建并运行</a><a class="ae le" href="https://github.com/Neosperience/backpack/blob/master/examples/Dockerfile" rel="noopener ugc nofollow" target="_blank">示例docker容器</a>。例如，假设您已经<a class="ae le" href="https://github.com/aws-samples/aws-panorama-samples/blob/main/docs/EnvironmentSetup.md" rel="noopener ugc nofollow" target="_blank">在t4g类型EC2实例上设置了Panorama测试实用程序</a>。在这种情况下，您可以在EC2实例上使用以下命令在该容器中构建和启动一个shell:</p><pre class="kp kq kr ks gt od nn oe of aw og bi"><span id="c96d" class="mz md iq nn b gy oh oi l oj ok">$ git clone <a class="ae le" href="https://github.com/Neosperience/backpack.git" rel="noopener ugc nofollow" target="_blank">https://github.com/Neosperience/backpack.git</a><br/>$ cd backpack/examples<br/>$ docker build . -t my_backpack_example:1.0<br/>$ docker run -it my_backpack_example:1.0 bash</span></pre><p id="bb9c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">该容器也可以在装有新的M1 ARM芯片的MacBook Pro上构建和执行。</p><p id="d260" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">backpack库用docstrings进行了广泛的文档化。您可以在线阅读<a class="ae le" href="https://s3.eu-west-1.amazonaws.com/github-ci.experiments.neosperience.com/Neosperience/backpack/docs/index.html" rel="noopener ugc nofollow" target="_blank">详细的API文档</a>或使用容器外壳中的<code class="fe nk nl nm nn b">python3</code>解释器；</p><pre class="kp kq kr ks gt od nn oe of aw og bi"><span id="b5bf" class="mz md iq nn b gy oh oi l oj ok">root@my_backpack_example:/# python3<br/>&gt;&gt;&gt; import backpack.skyline, backpack.kvs, backpack.annotation<br/>&gt;&gt;&gt; help(backpack.skyline)<br/>&gt;&gt;&gt; help(backpack.kvs)<br/>&gt;&gt;&gt; help(backpack.annotation)</span></pre><p id="cd5c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您还可以尝试在<code class="fe nk nl nm nn b">Backpack</code>中找到的其他<code class="fe nk nl nm nn b">SkyLine</code>实现。例如，<code class="fe nk nl nm nn b">RTSPSkyLine</code>允许您在应用程序容器中托管RTSP服务器，并通过RTSP客户端直接连接到Panorama设备以监控您的应用程序。</p><p id="0e86" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我知道你是如何使用<code class="fe nk nl nm nn b">SkyLine</code>的，你希望看到哪些新特性，并关注未来关于<code class="fe nk nl nm nn b">Backpack</code>其他组件的帖子。</p></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><p id="866a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">2022年6月20日更新</strong>:<code class="fe nk nl nm nn b">backpack</code>库的遥视模块更名为<code class="fe nk nl nm nn b">skyline</code>。</p><h1 id="ca66" class="mc md iq bd me mf mg mh mi mj mk ml mm kf mn kg mo ki mp kj mq kl mr km ms mt bi translated">关于作者</h1><p id="138f" class="pw-post-body-paragraph lf lg iq lh b li mu ka lk ll mv kd ln lo mw lq lr ls mx lu lv lw my ly lz ma ij bi translated">Janos Tolgyesi是一名AWS社区构建者，在Neosperience担任机器学习解决方案架构师。他在ML technologies工作了五年，在AWS infrastructure工作了八年。他喜欢构建东西，让它成为边缘的<a class="ae le" href="https://www.neosperience.com/solutions/people-analytics/" rel="noopener ugc nofollow" target="_blank">视频分析应用</a>或基于点击流事件的<a class="ae le" href="https://www.neosperience.com/solutions/user-insight/" rel="noopener ugc nofollow" target="_blank">用户分析器</a>。你可以在<a class="ae le" href="https://twitter.com/jtolgyesi" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae le" href="/@janos.tolgyesi" rel="noopener ugc nofollow" target="_blank"> Medium </a>和<a class="ae le" href="http://linkedin.com/in/janostolgyesi" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上找到我。</p><p id="4f8f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">背包的开源项目得到了<a class="ae le" href="https://www.neosperience.com" rel="noopener ugc nofollow" target="_blank">新科学</a>的支持。</p><p id="33d9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我要特别感谢<a class="ow ox ep" href="https://medium.com/u/6550450171ac?source=post_page-----32922369ecf--------------------------------" rel="noopener" target="_blank">卢卡·比安奇</a>校对这篇文章。</p></div></div>    
</body>
</html>