<html>
<head>
<title>How to Create a PDF Report for Your Data Analysis in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中为您的数据分析创建PDF报告</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-a-pdf-report-for-your-data-analysis-in-python-2bea81133b#2022-10-25">https://towardsdatascience.com/how-to-create-a-pdf-report-for-your-data-analysis-in-python-2bea81133b#2022-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a5ca" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">作为数据分析的一部分，使用FPDF图书馆自动生成PDF</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c5b0dc46a503c292752544589d2a32d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bOHwjKOGyF6SAPB240qYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用Python和FPDF自动生成数据分析报告的PDF(图片由作者提供)</p></figure><p id="f005" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦你完成了数据分析，你需要考虑如何传达结果。沟通一部分是决定您将以何种文件格式提供您的数据分析报告。我确信大多数利益相关者更喜欢PDF文件而不是iPython笔记本。</p><p id="7e97" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文将讨论如何在数据分析工作流程中自动生成PDF，包括:</p><ul class=""><li id="03b9" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><a class="ae md" href="#2220" rel="noopener ugc nofollow">如何创建PDF文件</a> : <a class="ae md" href="#9b3b" rel="noopener ugc nofollow">布局和放置文本</a>和<a class="ae md" href="#4aad" rel="noopener ugc nofollow">页眉页脚</a></li><li id="32d0" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><a class="ae md" href="#6619" rel="noopener ugc nofollow">如何向PDF文件添加文本</a> : <a class="ae md" href="#607b" rel="noopener ugc nofollow">样式文本</a>和<a class="ae md" href="#d470" rel="noopener ugc nofollow">换行和分页符</a></li><li id="92c7" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><a class="ae md" href="#52e9" rel="noopener ugc nofollow">如何将Matplotlib图作为图像添加到PDF文件中</a></li><li id="dfe0" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><a class="ae md" href="#c1f8" rel="noopener ugc nofollow">如何将熊猫数据帧作为表格添加到PDF文件中</a></li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="ce5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于本教程，我们将使用<code class="fe mq mr ms mt b">fpdf</code>库[1]。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="8405" class="my mz it mt b gy na nb l nc nd">from fpdf import FPDF</span></pre><p id="a80b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然<strong class="la iu">库没有被积极维护，并且自2012年</strong> [1]以来没有更新过，但是它对于大多数用例来说都是简单易用的。如果您对PDF生成有更复杂的需求，您可以查看类似于<a class="ae md" href="https://pypi.org/project/PyPDF2/" rel="noopener ugc nofollow" target="_blank"> PyPDF2 </a>、<a class="ae md" href="https://pypi.org/project/reportlab/" rel="noopener ugc nofollow" target="_blank"> ReportLab </a>或<a class="ae md" href="https://pypi.org/project/weasyprint/" rel="noopener ugc nofollow" target="_blank"> WeasyPrint </a>的替代方案。</p><h1 id="2220" class="ne mz it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">如何创建PDF文件</h1><p id="b305" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">用Python中的<code class="fe mq mr ms mt b">fpdf</code>库[1]生成PDF非常简单。要创建一个空的PDF文档，您需要创建一个类<code class="fe mq mr ms mt b">FPDF</code>的实例，添加一个空白页，并用下面三行代码保存它。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="7376" class="my mz it mt b gy na nb l nc nd">pdf = FPDF()<br/>pdf.add_page()<br/>pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5969eb07081016f79ffdc24c39d15064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k53HjeKjit84ej4R54l9RQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用Python FPDF中的三行代码创建的空PDF文档(图片由作者提供)</p></figure><p id="9be3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">默认页面为纵向模式的A4格式，页边距为1cm。</strong>您可以使用<code class="fe mq mr ms mt b">add_page()</code>方法的参数定义自定义页面配置。</p><h2 id="9b3b" class="my mz it bd nf oa ob dn nj oc od dp nn lh oe of np ll og oh nr lp oi oj nt ok bi translated">布局和放置文本</h2><p id="c237" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">接下来，让我们了解文档的布局。</p><p id="fc7c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以使用<code class="fe mq mr ms mt b">cell()</code>方法添加文本单元格。为了展示最终的布局，我们将设置参数<code class="fe mq mr ms mt b">border = 1</code>，它显示单元格的边框。当您实现所需的设计时，您可以将参数值设置回0。</p><p id="723b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用<code class="fe mq mr ms mt b">w</code>和<code class="fe mq mr ms mt b">h</code>参数，您可以定义文本单元格的宽度和高度。一个<code class="fe mq mr ms mt b">w = 0</code>将产生一个横跨整个页面宽度的文本单元格。</p><p id="818a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe mq mr ms mt b">ln</code>参数定义了该单元格之后的位置:</p><ul class=""><li id="6572" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">0:在当前单元格的右侧</li><li id="b2ac" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">1:到下一行的开头</li><li id="cdc1" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">2:在当前单元格下方</li></ul><p id="c1cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在单元格之间创建空间，可以使用<code class="fe mq mr ms mt b">set_xy()</code>方法为下一个元素指定一个特定的位置，或者使用<code class="fe mq mr ms mt b">ln()</code>方法创建垂直空间。</p><p id="f093" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面你可以看到一些单元格及其布局的例子。您可以通过单元格名称找到相应的代码。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="ea96" class="my mz it mt b gy na nb l nc nd"># Margin<br/>m = 10 <br/># Page width: Width of A4 is 210mm<br/>pw = 210 - 2*MARGIN <br/># Cell height<br/>ch = 50</span><span id="5427" class="my mz it mt b gy ol nb l nc nd">pdf = FPDF()<br/>pdf.add_page()<br/>pdf.set_font('Arial', '', 12)</span><span id="622a" class="my mz it mt b gy ol nb l nc nd">pdf.cell(w=0, h=ch, txt=<strong class="mt iu">"Cell 1"</strong>, border=1, ln=1)</span><span id="abf6" class="my mz it mt b gy ol nb l nc nd">pdf.cell(w=(pw/2), h=ch, txt=<strong class="mt iu">"Cell 2a"</strong>, border=1, ln=0)<br/>pdf.cell(w=(pw/2), h=ch, txt=<strong class="mt iu">"Cell 2b</strong>", border=1, ln=1)</span><span id="d57e" class="my mz it mt b gy ol nb l nc nd">pdf.cell(w=(pw/3), h=ch, txt=<strong class="mt iu">"Cell 3a"</strong>, border=1, ln=0)<br/>pdf.cell(w=(pw/3), h=ch, txt=<strong class="mt iu">"Cell 3b</strong>", border=1, ln=0)<br/>pdf.cell(w=(pw/3), h=ch, txt=<strong class="mt iu">"Cell 3c"</strong>, border=1, ln=1)</span><span id="a8a3" class="my mz it mt b gy ol nb l nc nd">pdf.cell(w=(pw/3), h=ch, txt=<strong class="mt iu">"Cell 4a"</strong>, border=1, ln=0)<br/>pdf.cell(w=(pw/3)*2, h=ch, txt=<strong class="mt iu">"Cell 4b"</strong>, border=1, ln=1)</span><span id="e1ad" class="my mz it mt b gy ol nb l nc nd">pdf.set_xy(x=10, y= 220) # or use pdf.ln(50)<br/>pdf.cell(w=0, h=ch, txt=<strong class="mt iu">"Cell 5</strong>", border=1, ln=1)</span><span id="01fa" class="my mz it mt b gy ol nb l nc nd">pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/405ad44279e206aad10985b53174d8c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VQqUHv25DGwoCufiprnF8Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建包含单元格的PDF布局(图片由作者提供)</p></figure><h2 id="4aad" class="my mz it bd nf oa ob dn nj oc od dp nn lh oe of np ll og oh nr lp oi oj nt ok bi translated">页眉和页脚</h2><p id="71b7" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">您还可以指定PDF文档中每页显示的页眉和页脚。为此，您需要在自定义类中覆盖<code class="fe mq mr ms mt b">header()</code>和<code class="fe mq mr ms mt b">footer()</code>方法。不要忘记使用自定义类的实例，而不是<code class="fe mq mr ms mt b">FPDF</code>类。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="9623" class="my mz it mt b gy na nb l nc nd"># Custom class to overwrite the header and footer methods<strong class="mt iu"><br/>class PDF(FPDF):</strong><br/>    def __init__(self):<br/>        super().__init__()<br/>    <strong class="mt iu">def header(self):</strong><br/>        self.set_font('Arial', '', 12)<br/>        self.cell(0, 10, 'Header', 1, 1, 'C')<br/>    <strong class="mt iu">def footer(self):</strong><br/>        self.set_y(-15)<br/>        self.set_font('Arial', '', 12)<br/>        self.cell(0, 10, 'Footer', 1, 0, 'C')</span><span id="ec0d" class="my mz it mt b gy ol nb l nc nd">pdf = <strong class="mt iu">PDF() </strong># Instance of custom class<br/>pdf.add_page()<br/>pdf.set_font('Arial', '', 12)<br/>pdf.cell(w=0, h=255, txt = "Body", border = 1, ln = 1, align = 'C')</span><span id="c20c" class="my mz it mt b gy ol nb l nc nd">pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/67873922eea7fdc6f120e8ab5a7df054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ObyOpbOOCpLN3HSOl4nwFw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用Python生成的PDF文档的页眉、正文和页脚(图片由作者提供)</p></figure><h1 id="6619" class="ne mz it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">如何向PDF文件添加文本</h1><p id="ac59" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">现在您已经了解了如何布局PDF文档，让我们用一些内容填充单元格。</p><h2 id="607b" class="my mz it bd nf oa ob dn nj oc od dp nn lh oe of np ll og oh nr lp oi oj nt ok bi translated">样式文本</h2><p id="82a6" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated"><code class="fe mq mr ms mt b">fpdf</code>库为你提供了基本的文本样式:</p><ul class=""><li id="9483" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">使用<code class="fe mq mr ms mt b">set_font()</code>方法，您可以设置字体、字体大小和强调(常规、粗体、斜体)。</li><li id="35ff" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">在<code class="fe mq mr ms mt b">cell</code>方法中，您可以用<code class="fe mq mr ms mt b">align</code>参数定义文本对齐。</li><li id="b0d4" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">要填充单元格的背景，您需要用<code class="fe mq mr ms mt b">set_fill_color()</code>方法定义一种颜色，并在<code class="fe mq mr ms mt b">cell()</code>方法中定义<code class="fe mq mr ms mt b">fill = True</code>。</li><li id="a94c" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated">要改变单元格文本的颜色，可以用<code class="fe mq mr ms mt b">set_text_color()</code>方法定义一种颜色。</li></ul><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="31e8" class="my mz it mt b gy na nb l nc nd">pdf = FPDF()<br/>pdf.add_page()</span><span id="58c2" class="my mz it mt b gy ol nb l nc nd">pdf.set_font('Arial', <strong class="mt iu">''</strong>, 16)<br/>pdf.cell(w=0, h=10, txt="This is <strong class="mt iu">regular</strong> text.", ln=1)</span><span id="75a6" class="my mz it mt b gy ol nb l nc nd">pdf.set_font('Arial', <strong class="mt iu">'B'</strong>, 16)<br/>pdf.cell(w=0, h=10, txt="This is <strong class="mt iu">bold</strong> text.", ln=1)</span><span id="6da8" class="my mz it mt b gy ol nb l nc nd">pdf.set_font('Arial', <strong class="mt iu">'I'</strong>, 16)<br/>pdf.cell(w=0, h=10, txt="This is <strong class="mt iu">italic</strong> text.", ln=1)</span><span id="7c30" class="my mz it mt b gy ol nb l nc nd">pdf.set_font('Arial', '', 16) # Reset text back to regular</span><span id="5d9f" class="my mz it mt b gy ol nb l nc nd">pdf.cell(w=0, h=10, txt="This is <strong class="mt iu">left</strong> aligned text.", ln=1,   <br/>         <strong class="mt iu">align='L'</strong>)<br/>pdf.cell(w=0, h=10, txt="This is <strong class="mt iu">center</strong> aligned text.", ln=1,<br/>         <strong class="mt iu">align='C'</strong>)<br/>pdf.cell(w=0, h=10, txt="This is <strong class="mt iu">right</strong> aligned text.", ln=1,<br/>         <strong class="mt iu">align='R'</strong>)</span><span id="7563" class="my mz it mt b gy ol nb l nc nd">pdf.<strong class="mt iu">set_fill_color</strong>(r= 0, g= 128, b = 0)<br/>pdf.cell(w=0, h=10, txt="This is text with <strong class="mt iu">filled</strong> background.", ln=1,<br/>         <strong class="mt iu">fill=True</strong>)</span><span id="7ef9" class="my mz it mt b gy ol nb l nc nd">pdf.<strong class="mt iu">set_text_color</strong>(r= 0, g= 128, b = 0)<br/>pdf.cell(w=0, h=10, txt="This is <strong class="mt iu">colored</strong> text.", ln=1)</span><span id="bfe6" class="my mz it mt b gy ol nb l nc nd">pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/780aacdc2dce9794e13fe6df704acf38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6SPUJtVMACcxLmyzsrIhQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">生成的PDF中不同样式的文本:左对齐、居中对齐、右对齐、粗体和斜体文本、字体和背景颜色(图片由作者提供)</p></figure><h2 id="d470" class="my mz it bd nf oa ob dn nj oc od dp nn lh oe of np ll og oh nr lp oi oj nt ok bi translated">分行符和分页符</h2><p id="fb40" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">如果你需要一段更长的文本，<code class="fe mq mr ms mt b">cell()</code>方法是不够的，因为它不允许换行或分页，正如你在下面看到的。</p><p id="9b34" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，您应该使用<code class="fe mq mr ms mt b">multi_cell()</code>方法，它可以处理换行符和分页符。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="a093" class="my mz it mt b gy na nb l nc nd">import lorem # Use this package to showcase long texts</span><span id="2d73" class="my mz it mt b gy ol nb l nc nd">pdf = FPDF()<br/>pdf.add_page()<br/>pdf.set_font('Arial', '', 16)</span><span id="6ffb" class="my mz it mt b gy ol nb l nc nd">pdf.cell(w=0, h=50, txt="This and the below cells are regular cells." , border=1, ln=1)</span><span id="c343" class="my mz it mt b gy ol nb l nc nd">pdf.cell(w=0, h=50, txt="Example: " + lorem.text(), border=1, ln=1)</span><span id="6a40" class="my mz it mt b gy ol nb l nc nd">pdf.<strong class="mt iu">multi_cell</strong>(w=0, h=50, txt="This and the below cells are multi cells.", border=1, )</span><span id="093a" class="my mz it mt b gy ol nb l nc nd">pdf.<strong class="mt iu">multi_cell</strong>(w=0, h=5, txt="Example: " + lorem.text(), border=1, )</span><span id="1d52" class="my mz it mt b gy ol nb l nc nd">pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0a01b9a47a544aad714fa6028f304b69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfPEnNddXv-SgM4HYiQ2gg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对于带有换行符和分页符的较长文本，使用multi_cells，而不是常规单元格(图片由作者提供)</p></figure><h2 id="f99f" class="my mz it bd nf oa ob dn nj oc od dp nn lh oe of np ll og oh nr lp oi oj nt ok bi translated">模板</h2><p id="5221" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">根据到目前为止您所学的一切，您现在可以创建一个简单的模板，如下所示。我们将在下面的例子中使用它。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="48a8" class="my mz it mt b gy na nb l nc nd"># cell height<br/>ch = 8</span><span id="b561" class="my mz it mt b gy ol nb l nc nd">class PDF(FPDF):<br/>    def __init__(self):<br/>        super().__init__()<br/>    def header(self):<br/>        self.set_font('Arial', '', 12)<br/>        self.cell(0, 8, 'Header', 0, 1, 'C')<br/>    def footer(self):<br/>        self.set_y(-15)<br/>        self.set_font('Arial', '', 12)<br/>        self.cell(0, 8, f'Page {self.page_no()}', 0, 0, 'C')</span><span id="f4e2" class="my mz it mt b gy ol nb l nc nd">pdf = PDF()<br/>pdf.add_page()<br/>pdf.set_font('Arial', 'B', 24)<br/>pdf.cell(w=0, h=20, txt="Title", ln=1)</span><span id="b993" class="my mz it mt b gy ol nb l nc nd">pdf.set_font('Arial', '', 16)<br/>pdf.cell(w=30, h=ch, txt="Date: ", ln=0)<br/>pdf.cell(w=30, h=ch, txt="01/01/2022", ln=1)<br/>pdf.cell(w=30, h=ch, txt="Author: ", ln=0)<br/>pdf.cell(w=30, h=ch, txt="Max Mustermann", ln=1)</span><span id="f4d0" class="my mz it mt b gy ol nb l nc nd">pdf.ln(ch)<br/>pdf.multi_cell(w=0, h=5, txt=lorem.paragraph())</span><span id="0141" class="my mz it mt b gy ol nb l nc nd">pdf.ln(ch)<br/>pdf.multi_cell(w=0, h=5, txt=lorem.paragraph())</span><span id="d6fb" class="my mz it mt b gy ol nb l nc nd">pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/991e71b6f8b207615911630f955f38e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t20xjFdZidW14lwewrOWUQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用Python生成的PDF模板(图片由作者提供)</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="f4cc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于下面的例子，我们将使用一个小的虚构数据集。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="16ca" class="my mz it mt b gy na nb l nc nd">import pandas as pd</span><span id="71a2" class="my mz it mt b gy ol nb l nc nd">df = pd.DataFrame(<br/>          {'feature 1' : ['cat 1', 'cat 2', 'cat 3', 'cat 4'],<br/>           'feature 2' : [400, 300, 200, 100]<br/>          })</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/3f7749f242ba6df8a8d5f6e9ed09244b.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*VGFMEbnrTa5RqzZpF8XbDQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">虚构数据集导入为熊猫数据帧(图片由作者提供)</p></figure><h1 id="52e9" class="ne mz it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">如何将Matplotlib图作为图像添加到PDF文件中</h1><p id="3c41" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">除了文本，您可能需要在PDF报告中添加绘图。</p><p id="0e33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要将图添加到PDF报告中，首先需要将Matplotlib图保存为图像(例如，PNG文件)。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="0dc3" class="my mz it mt b gy na nb l nc nd">import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="5374" class="my mz it mt b gy ol nb l nc nd">fig, ax = plt.subplots(1,1, figsize = (6, 4))</span><span id="52e8" class="my mz it mt b gy ol nb l nc nd">sns.barplot(data =  df, x = 'feature 1', y = 'feature 2')<br/>plt.title("Chart")</span><span id="3fd5" class="my mz it mt b gy ol nb l nc nd">plt.<strong class="mt iu">savefig</strong>('./example_chart.png', <br/>           transparent=False,  <br/>           facecolor='white', <br/>           bbox_inches="tight")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/5f48a8342a521789c8c431c999dc2d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*wjAHYj_m7M0vVbvMR-4zrA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Matplotlib绘图保存为PNG文件(图片由作者提供)</p></figure><p id="3d31" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦您的Matplotlib绘图被保存为图像，您就可以使用<code class="fe mq mr ms mt b">image()</code>方法将其添加到报告中。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="5576" class="my mz it mt b gy na nb l nc nd">pdf = PDF()<br/>pdf.add_page()<br/>pdf.set_font('Arial', 'B', 24)<br/>pdf.cell(w=0, h=20, txt="Title", ln=1)</span><span id="7c68" class="my mz it mt b gy ol nb l nc nd">pdf.set_font('Arial', '', 16)<br/>pdf.cell(w=30, h=ch, txt="Date: ", ln=0)<br/>pdf.cell(w=30, h=ch, txt="01/01/2022", ln=1)<br/>pdf.cell(w=30, h=ch, txt="Author: ", ln=0)<br/>pdf.cell(w=30, h=ch, txt="Max Mustermann", ln=1)</span><span id="1f61" class="my mz it mt b gy ol nb l nc nd">pdf.ln(ch)<br/>pdf.multi_cell(w=0, h=5, txt=lorem.paragraph())</span><span id="ea4c" class="my mz it mt b gy ol nb l nc nd"><strong class="mt iu">pdf.image('./example_chart.png', <br/>          x = 10, y = None, w = 100, h = 0, type = 'PNG')</strong></span><span id="8b3c" class="my mz it mt b gy ol nb l nc nd">pdf.ln(ch)<br/>pdf.multi_cell(w=0, h=5, txt=lorem.paragraph())</span><span id="3c94" class="my mz it mt b gy ol nb l nc nd">pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5029cba8b957b1fc36e6c223e40b3bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sGij-avbzHcN1sO57_vUDg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用Python将Matplotlib绘图添加到PDF报告中(图片由作者提供)</p></figure><h1 id="c1f8" class="ne mz it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">如何将熊猫数据帧作为表格添加到PDF文件中</h1><p id="7b77" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">不幸的是，没有简单的方法可以用<code class="fe mq mr ms mt b">FPDF</code>库将熊猫数据帧添加到PDF报告中。尽管将pandas数据帧作为表格添加到PDF报告需要一些简单的编码，但这也并不困难:通过使用带有<code class="fe mq mr ms mt b">border=1</code>的<code class="fe mq mr ms mt b">cell()</code>方法并有效利用<code class="fe mq mr ms mt b">ln</code>参数，您可以迭代数据帧来创建表格。</p><pre class="kj kk kl km gt mu mt mv mw aw mx bi"><span id="9fa8" class="my mz it mt b gy na nb l nc nd">pdf = PDF()<br/>pdf.add_page()<br/>pdf.set_font('Arial', 'B', 24)<br/>pdf.cell(w=0, h=20, txt="Title", ln=1)</span><span id="958d" class="my mz it mt b gy ol nb l nc nd">pdf.set_font('Arial', '', 16)<br/>pdf.cell(w=30, h=ch, txt="Date: ", ln=0)<br/>pdf.cell(w=30, h=ch, txt="01/01/2022", ln=1)<br/>pdf.cell(w=30, h=ch, txt="Author: ", ln=0)<br/>pdf.cell(w=30, h=ch, txt="Max Mustermann", ln=1)</span><span id="23f0" class="my mz it mt b gy ol nb l nc nd">pdf.ln(ch)<br/>pdf.multi_cell(w=0, h=5, txt=lorem.paragraph())</span><span id="4814" class="my mz it mt b gy ol nb l nc nd">pdf.image('./example_chart.png', x = 10, y = None, w = 100, h = 0, type = 'PNG', link = '')</span><span id="9347" class="my mz it mt b gy ol nb l nc nd">pdf.ln(ch)<br/>pdf.multi_cell(w=0, h=5, txt=lorem.paragraph())</span><span id="485e" class="my mz it mt b gy ol nb l nc nd">pdf.ln(ch)</span><span id="346c" class="my mz it mt b gy ol nb l nc nd"><strong class="mt iu"># Table Header<br/>pdf.set_font('Arial', 'B', 16)<br/>pdf.cell(w=40, h=ch, txt='Feature 1', border=1, ln=0, align='C')<br/>pdf.cell(w=40, h=ch, txt='Feature 2', border=1, ln=1, align='C')</strong></span><span id="7a35" class="my mz it mt b gy ol nb l nc nd"><strong class="mt iu"># Table contents<br/>pdf.set_font('Arial', '', 16)<br/>for i in range(0, len(df)):<br/>    pdf.cell(w=40, h=ch, <br/>             txt=df['feature 1'].iloc[i], <br/>             border=1, ln=0, align='C')<br/>    pdf.cell(w=40, h=ch, <br/>             txt=df['feature 2'].iloc[i].astype(str), <br/>             border=1, ln=1, align='C')</strong></span><span id="5032" class="my mz it mt b gy ol nb l nc nd">pdf.output(f'./example.pdf', 'F')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c5b0dc46a503c292752544589d2a32d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bOHwjKOGyF6SAPB240qYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫数据框架作为Python中的表格添加到PDF报告中(图片由作者提供)</p></figure><p id="98ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从技术上讲，你也可以<a class="ae md" href="https://stackoverflow.com/questions/33155776/export-pandas-dataframe-into-a-pdf-file-using-python" rel="noopener ugc nofollow" target="_blank">将你的pandas DataFrame转换成Matplotlib表格，将其保存为图像，并将该表格作为图像插入PDF </a>。但我试过了，所以你不必这样做:它不是很漂亮。</p><h1 id="34f6" class="ne mz it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">结论</h1><p id="3c01" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">尽管批评家说有比<code class="fe mq mr ms mt b">fpdf</code>库更好的选择，但它使用起来很简单。</p><p id="7b21" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文向您展示了:</p><ul class=""><li id="4fc3" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><a class="ae md" href="#2220" rel="noopener ugc nofollow">如何创建PDF文件</a> : <a class="ae md" href="#9b3b" rel="noopener ugc nofollow">布局和放置文本</a>和<a class="ae md" href="#4aad" rel="noopener ugc nofollow">页眉和页脚</a></li><li id="0590" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><a class="ae md" href="#6619" rel="noopener ugc nofollow">如何向PDF文件添加文本</a> : <a class="ae md" href="#607b" rel="noopener ugc nofollow">样式文本</a>和<a class="ae md" href="#d470" rel="noopener ugc nofollow">换行和分页符</a></li><li id="d35c" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><a class="ae md" href="#52e9" rel="noopener ugc nofollow">如何将Matplotlib图作为图像添加到PDF文件中</a></li><li id="e58c" class="lu lv it la b lb me le mf lh mg ll mh lp mi lt lz ma mb mc bi translated"><a class="ae md" href="#c1f8" rel="noopener ugc nofollow">如何将熊猫数据帧作为表格添加到PDF文件中</a></li></ul><p id="8215" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面您可以复制生成以下PDF的模板代码，并根据您的需要进行调整。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c5b0dc46a503c292752544589d2a32d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bOHwjKOGyF6SAPB240qYQ.png"/></div></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="op oq l"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="755b" class="ne mz it bd nf ng or ni nj nk os nm nn jz ot ka np kc ou kd nr kf ov kg nt nu bi translated">喜欢这个故事吗？</h1><p id="ae97" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated"><em class="ow">如果你想把我的新故事直接发到你的收件箱，</em> <a class="ae md" href="https://medium.com/subscribe/@iamleonie" rel="noopener"> <em class="ow">订阅</em> </a> <em class="ow">！</em></p><p id="e677" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ow">成为媒介会员，阅读更多其他作家和我的故事。报名时可以用我的</em> <a class="ae md" href="https://medium.com/@iamleonie/membership" rel="noopener"> <em class="ow">推荐链接</em> </a> <em class="ow">支持我。我将收取佣金，不需要你额外付费。</em></p><div class="ox oy gp gr oz pa"><a href="https://medium.com/@iamleonie/membership" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">通过我的推荐链接加入Medium—Leonie Monigatti</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">阅读Leonie Monigatti(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><p id="c115" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ow">在</em> <a class="ae md" href="https://twitter.com/helloiamleonie" rel="noopener ugc nofollow" target="_blank"> <em class="ow">上找我</em></a><em class="ow"/><a class="ae md" href="https://www.linkedin.com/in/804250ab/" rel="noopener ugc nofollow" target="_blank"><em class="ow">LinkedIn</em></a><em class="ow"/><a class="ae md" href="https://www.kaggle.com/iamleonie" rel="noopener ugc nofollow" target="_blank"><em class="ow">ka ggle</em></a><em class="ow">！</em></p><h1 id="0fcc" class="ne mz it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">参考</h1><p id="5342" class="pw-post-body-paragraph ky kz it la b lb nv ju ld le nw jx lg lh nx lj lk ll ny ln lo lp nz lr ls lt im bi translated">[1]“Python的FPDF”，“<a class="ae md" href="https://pyfpdf.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">PyFPDF</a>”<a class="ae md" href="https://pyfpdf.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://pyfpdf.readthedocs.io/en/latest/</a>(2022年10月22日访问)</p></div></div>    
</body>
</html>