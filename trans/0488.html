<html>
<head>
<title>The No-Nonsense Guide to the Random Effects Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机效应回归模型实用指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-no-nonsense-guide-to-the-random-effects-regression-model-be899ce415a5#2022-02-19">https://towardsdatascience.com/the-no-nonsense-guide-to-the-random-effects-regression-model-be899ce415a5#2022-02-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bc16" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">和Python教程，帮助您在真实数据集上使用RE模型</h2></div><p id="2b00" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">随机效应回归模型</strong>用于估计个人特定特征的效应，如内在不可测量的毅力或敏锐度。在<strong class="kh ir">面板数据</strong>研究中经常遇到这种个体特异性的影响。与<a class="ae lb" rel="noopener" target="_blank" href="/understanding-the-fixed-effects-regression-model-d2fccc2cc27e"> <strong class="kh ir">固定效应回归</strong> </a>模型一起，随机效应模型是研究个体特异性特征对面板数据集响应变量影响的常用技术。</p><p id="92d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文是面板数据分析系列文章的第三部分:</p><ol class=""><li id="1db2" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/how-to-build-a-pooled-ols-regression-model-for-panel-data-sets-a78358f9c2a">如何为面板数据集构建混合OLS回归模型</a></li><li id="e886" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/understanding-the-fixed-effects-regression-model-d2fccc2cc27e">了解固定效应回归模型</a></li><li id="94c8" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated"><strong class="kh ir">随机效应回归模型的实用指南</strong></li></ol><p id="4088" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于那些读过我关于<a class="ae lb" rel="noopener" target="_blank" href="/understanding-the-fixed-effects-regression-model-d2fccc2cc27e">固定效应模型</a>和<a class="ae lb" rel="noopener" target="_blank" href="/how-to-build-a-pooled-ols-regression-model-for-panel-data-sets-a78358f9c2a">混合OLS模型</a>的文章的人来说，这篇文章的前10%可能感觉像是对概念的修正。</p><p id="1ce0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们从简单地(重新)了解面板数据开始。</p><h1 id="aee7" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">什么是面板数据集？</h1><p id="2432" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">面板数据集包含关于<strong class="kh ir">一组唯一可识别的个体或“事物”</strong>的数据，这些个体或“事物”在一段时间内被主动<strong class="kh ir">跟踪</strong>。每个个体或“事物”被称为一个<strong class="kh ir">单元</strong>。可以被认为是跟踪单元的例子有个人、家庭、树、车辆、公司和国家。通常，对于每个单元，在每个时间段测量一个或多个<strong class="kh ir">参数</strong>(又名<strong class="kh ir">回归变量</strong>或<strong class="kh ir">效应</strong>)。属于一个单位(一个国家)的一组数据点称为<strong class="kh ir">组</strong>。</p><p id="87bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果所有单元被跟踪相同数量的时间段，该数据面板被称为<strong class="kh ir">平衡面板</strong>。否则称为<strong class="kh ir">不平衡</strong>面板。如果在整个研究过程中跟踪同一组单元，则称之为<strong class="kh ir">固定面板</strong>，但如果在研究过程中单元发生变化，则称之为<strong class="kh ir">旋转面板</strong>。</p><p id="c7b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">面板数据通常来源于已知的纵向研究，如T2、弗雷明汉心脏研究、T4、T5、T6、T7或T9英国家庭面板调查。</p><h1 id="855f" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">世界银行面板数据集</h1><p id="5121" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在本文中，我们将使用来自世界银行的面板数据集，其中包含七个国家的人均GDP年同比增长率数据。这些数据是从1992年到2014年采集的。以下是该面板数据集的外观:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mn"><img src="../Images/621aedc8a1a98a14c4c7976de2866e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*leYcxnKRL1uXIwHD-PrYUw.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">a专家组数据集(来源:<a class="ae lb" href="https://databank.worldbank.org/metadataglossary/world-development-indicators/series" rel="noopener ugc nofollow" target="_blank">世界发展指标</a>数据<a class="ae lb" href="https://www.worldbank.org/en/about/legal/terms-of-use-for-datasets" rel="noopener ugc nofollow" target="_blank"> CC BY 4.0 license </a>)(图片由作者提供)</p></figure><p id="01cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的数据集中，单位是一个国家，有<strong class="kh ir">两个变量</strong> : GDP增长和GCF增长。因此，我们在<strong class="kh ir"> 23个时间段</strong> (1992年至2014年)内跟踪<strong class="kh ir"> 7个单位</strong>中每个单位的2个变量。这导致创建了7组数据。世界银行数据集是<strong class="kh ir">固定的</strong>和<strong class="kh ir">平衡的。</strong></p><h1 id="2552" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">回归目标</h1><p id="a9a2" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">我们的目标是研究总资本形成年同比增长对GDP年同比增长的影响。</p><p id="d9c2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们的<strong class="kh ir">因变量</strong>或<strong class="kh ir">反应变量</strong> <strong class="kh ir"> <em class="nd"> y </em> </strong>就是<em class="nd"> Y-o-Y %的人均GDP增长率</em>。</p><p id="5685" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">自变量</strong>或<strong class="kh ir">解释变量</strong> <strong class="kh ir"> <em class="nd"> X </em> </strong>为<em class="nd">年-年资本形成总额增长率</em>。</p><p id="117f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将从直观地考察GDP增长和GCF增长之间的关系开始。</p><p id="cf67" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创建一个<strong class="kh ir"> <em class="nd"> y </em> </strong>对<strong class="kh ir"> <em class="nd"> X </em> </strong>的散点图，看看数据是什么样子的。</p><p id="f0e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将从导入所有需要的Python包开始，包括我们稍后将用来构建随机效果模型的包。</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="0340" class="nj lr iq nf b gy nk nl l nm nn"><strong class="nf ir">import </strong>pandas <strong class="nf ir">as </strong>pd<br/><strong class="nf ir">import </strong>scipy.stats <strong class="nf ir">as </strong>st<br/><strong class="nf ir">import </strong>statsmodels.api <strong class="nf ir">as </strong>sm<br/><strong class="nf ir">import </strong>statsmodels.formula.api <strong class="nf ir">as </strong>smf<br/><strong class="nf ir">from </strong>matplotlib <strong class="nf ir">import </strong>pyplot <strong class="nf ir">as </strong>plt<br/><strong class="nf ir">import </strong>seaborn <strong class="nf ir">as </strong>sns</span></pre><p id="7e0c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们将数据集加载到熊猫数据框中。数据集可以在 这里下载<a class="ae lb" href="https://gist.github.com/sachinsdate/c40651e9e4bc13a696780462209f1992" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">。</strong></a></p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="3180" class="nj lr iq nf b gy nk nl l nm nn">df_panel = pd.<strong class="nf ir">read_csv</strong>('wb_data_panel_2ind_7units_1992_2014.csv', <strong class="nf ir">header</strong>=0)</span></pre><p id="8b65" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用Seaborn绘制所有7个国家在所有时间段的人均GDP增长与每个国家总资本形成增长的关系图:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="b29d" class="nj lr iq nf b gy nk nl l nm nn">colors = [<strong class="nf ir">'blue'</strong>, <strong class="nf ir">'red'</strong>, <strong class="nf ir">'orange'</strong>, <strong class="nf ir">'lime'</strong>, <strong class="nf ir">'yellow'</strong>, <strong class="nf ir">'cyan'</strong>, <strong class="nf ir">'violet'</strong>]</span><span id="e77d" class="nj lr iq nf b gy no nl l nm nn">sns.<strong class="nf ir">scatterplot</strong>(<strong class="nf ir">x</strong>=df_panel[<strong class="nf ir">'</strong>GCF_GWTH_PCNT<strong class="nf ir">'</strong>], <br/>                <strong class="nf ir">y</strong>=df_panel[<strong class="nf ir">'</strong>GDP_PCAP_GWTH_PCNT<strong class="nf ir">'</strong>],<br/>                <strong class="nf ir">hue</strong>=df_panel[<strong class="nf ir">'</strong>COUNTRY<strong class="nf ir">'</strong>],<br/>                <strong class="nf ir">palette</strong>=colors).<br/>                <strong class="nf ir">set</strong>(<strong class="nf ir">title</strong>='Y-o-Y % Change in per-capita GDP versus Y-o-Y % Change in Gross capital formation')</span><span id="dee6" class="nj lr iq nf b gy no nl l nm nn">plt.<strong class="nf ir">show</strong>()</span></pre><p id="9c80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到下面的情节:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi np"><img src="../Images/41eb58f129c90b118ef8a02c02f00c12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbLM6t3sEfdbdPMaW5_JJg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">国内生产总值同比增长%与总资本形成同比增长%的国家散点图(图片由作者提供)</p></figure><p id="f6b0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">GDP和GCF增长之间的关系似乎是线性的，尽管数据中也有相当多的<a class="ae lb" rel="noopener" target="_blank" href="/heteroscedasticity-is-nothing-to-be-afraid-of-730dd3f7ca1f"> <strong class="kh ir">异方差</strong> </a>。</p><p id="0133" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为一个工作假设，让我们假设以下线性函数形式的关系:</p><p id="78cc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="nd"> y= </em> </strong> Y-o-Y %人均国内生产总值增长率，以及，</p><p id="d97b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="nd"> X= </em> </strong> Y-o-Y资本形成总额增长率</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d1e78bfd08ee6b1eac1c6d43c445f2e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*xQkDykmvoVveWgG5GtnnTA.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">国家I的线性模型(图片由作者提供)</p></figure><p id="9062" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上述方程是一个矩阵方程，如变量的<strong class="kh ir">粗体</strong>字体所示。假设每组有<em class="nd"> T </em>个时间段，每单位有<em class="nd"> k </em>个回归变量，每单位有<em class="nd"> n </em>个回归变量，方程中每个矩阵变量的维数如下:</p><ul class=""><li id="438b" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">y</em></strong><em class="nd">_ I</em>是单元<em class="nd"> i </em>的响应变量。它是一个大小为<em class="nd">【T×1】</em>的向量。</li><li id="1cef" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>是大小<em class="nd">【T X k】</em>的回归变量矩阵。</li><li id="3713" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">β</em></strong><em class="nd">_ I</em>是大小为<em class="nd">【k×1】</em>的系数矩阵，包含<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I .</em>中k个回归变量系数的总体(真)值</li><li id="d4b5" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【t×1】</em>的矩阵，包含模型的误差项，每个<em class="nd"> T </em>时间段一个误差项。误差项定义为观察值和“模拟”值之间的差异。</li></ul><p id="4715" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是这个方程的矩阵形式:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ns"><img src="../Images/fcda214ab06da0ecb094b6a315178a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tMqCLM16TdllAGj_zxHiDg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">国家I的线性回归模型的矩阵形式(图片由作者提供)</p></figure><p id="1887" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在世界银行面板数据集中，<em class="nd"> T=23，k=1 </em>和<em class="nd"> n=7 </em>。</p><p id="74fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上述回归模型中，错误术语<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em>产生的原因如下:</p><ul class=""><li id="8f56" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la nr li lj lk bi translated">测量误差，</li><li id="5721" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated">实验装置中的随机噪声，</li><li id="1558" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated">由于一个或相关解释变量的意外或故意遗漏而引入的错误，</li><li id="3f0a" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated">回归模型选择不正确或模型中回归变量或响应变量的函数形式选择不正确。</li><li id="c8d4" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated">由于我们无法测量特定单元的某些特性而引入的误差。在国家数据面板中，这种特定单位的影响可能是该国在不同环境条件下促进或抑制GDP增长的<strong class="kh ir">社会经济结构</strong>，以及该国数百年来演变的<strong class="kh ir">企业和政府决策的文化方面</strong>。</li></ul><p id="179a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">特定单位的影响本质上是不可测量的(一些作者更愿意称之为<strong class="kh ir">不可观察的影响</strong>)。</p><p id="8495" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们仍然需要找到一种方法来测量它们对响应变量的影响，因为如果我们从回归分析中完全忽略它们，它们的影响将以一种不受控制的方式泄漏到误差项中(并因此泄漏到训练模型的残余误差中)，并使我们的模型次优。</p><p id="0d57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们将从重新陈述单元(即国家)的回归模型等式开始<em class="nd"> i </em>如下:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/e2784d90f41499db8c5b34cf984a6804.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*XKT6GST0BBlhkS7-5mPxkw.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">国家I的线性模型的一般形式(图片由作者提供)</p></figure><p id="6bf8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的等式中:</p><ul class=""><li id="4fcd" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la nr li lj lk bi translated"><strong class="kh ir"> <em class="nd"> y </em> </strong> <em class="nd"> _i </em>是一个大小为<em class="nd">【T x 1】</em>的矩阵，包含国家<em class="nd"> i </em>的<em class="nd"> T </em>观察值。</li><li id="9a12" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【T X k】</em>的矩阵，包含<em class="nd"> k </em>回归变量的值，所有这些值都是可观察的和相关的。</li><li id="36f6" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">β</em></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【k x 1】</em>的矩阵，包含<em class="nd"> k </em>回归变量的回归系数的总体(真)值。</li><li id="8386" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【T x m】</em>的矩阵，包含所有变量的(理论)值(数量为<em class="nd"> m </em>)和无法直接观察到的效应。</li><li id="cc40" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【m×1】</em>的矩阵，包含<em class="nd"> m </em>个不可观测变量的回归系数的(理论)总体值。</li><li id="8f6c" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">ε</em></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【T×1】</em>的矩阵，包含对应于国家<em class="nd"> i </em>的<em class="nd"> T </em>观测值的误差项。</li></ul><p id="c452" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是矩阵乘法和加法的样子:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nu"><img src="../Images/caeea183e3bbf96c09399c0530cb88b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*61SuFzhAhfzXJr3lw_wzBw.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">矩阵格式的国家I线性模型的一般形式(图片由作者提供)</p></figure><p id="ded9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有特定于单元的效应都被假设为由术语<strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I .</em>矩阵<strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em>及其系数向量<strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I</em>是纯理论术语，因为它们所代表的内容实际上无法观察和测量。</p><p id="a5fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的目标是找到一种方法来估计<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em>对<strong class="kh ir"><em class="nd"/></strong>y的影响，即<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I对</em> <strong class="kh ir"> <em class="nd"> y </em>的影响</strong></p><p id="4463" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了简化估算，我们将把所有国家特有的不可观测效应的影响合并到一个变量中，对于国家<em class="nd"> i </em>，我们称之为<strong class="kh ir"><em class="nd">z</em></strong><em class="nd">_ I</em>。<strong class="kh ir"><em class="nd">z</em></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【T×1】</em>的矩阵，因为它只包含一个变量<em class="nd"> z_i </em>，并且它有<em class="nd"> T </em>行对应于<em class="nd"> T </em>个“测量值”，每一个值为<em class="nd">z _ I .</em></p><p id="4f2b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于<strong class="kh ir"><em class="nd">z</em></strong><em class="nd">_ I</em>不可直接观测，为了衡量<strong class="kh ir"> <em class="nd"> z_i </em> </strong>的效果，我们需要将省略<strong class="kh ir"> <em class="nd"> z_i </em> </strong>的效果形式化。为此，我们将求助于统计学中的一个概念，称为<strong class="kh ir">省略变量偏差</strong>。</p><h2 id="abea" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">省略可变偏差</h2><p id="2107" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在面板数据集上训练模型时，如果我们从模型中遗漏掉<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em>，就会造成所谓的<strong class="kh ir">遗漏变量偏差</strong>。可以看出，如果在不考虑<strong class="kh ir"> <em class="nd"> z_i </em> </strong>的情况下对回归模型进行估计，那么模型系数<strong class="kh ir"><em class="nd"/></strong><em class="nd"/>的估计值<strong class="kh ir"><em class="nd">β</em></strong><em class="nd">_ cap _ I</em>会有如下偏差:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi og"><img src="../Images/d058043b4fcbd04dc98f8fa2310de796.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVJbdB0b0ZJzHeymGR023g.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">省略变量偏差:由于省略变量<strong class="bd oh"><em class="oi">z</em></strong><em class="oi">_ I【图片由作者提供】</em>而在<strong class="bd oh"><em class="oi">β</em></strong><em class="oi">_ I的估计中引入的偏差</em></p></figure><p id="2526" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上式中可以看出，估计值<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ cap _ I</em>中引入的偏差是<strong class="kh ir">正比于省略变量<strong class="kh ir"> <em class="nd"> z </em> </strong> <em class="nd"> _i </em>与解释变量<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>之间的协方差</strong>。这表明了建立两种回归模型的动机:</p><ol class=""><li id="5983" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated"><strong class="kh ir">固定效应模型</strong>，其中协方差非零，即单位特定效应与回归变量相关，以及，</li><li id="5488" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">一个<strong class="kh ir">随机效应模型</strong>，其中协方差项为零，即<strong class="kh ir">单位特定效应独立于回归变量</strong>。</li></ol><p id="d9fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在以前的文章中，我们看到了如何构建固定效果模型。在本文中，我们将重点关注<strong class="kh ir">随机效应模型</strong>，并将其性能与有限元模型和<a class="ae lb" rel="noopener" target="_blank" href="/how-to-build-a-pooled-ols-regression-model-for-panel-data-sets-a78358f9c2a">混合OLS回归模型</a>进行比较。</p><h1 id="ecfc" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">随机效应模型</h1><p id="aae3" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">为了理解<strong class="kh ir">随机效应模型</strong>的结构，从FE模型的结构开始，并将其与re模型的结构进行对比是很有用的。那么，让我们简单回顾一下<strong class="kh ir">固定效果模型</strong>的结构。</p><p id="556a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">固定效应模型的关键假设是，不可观察的效应与模型的回归变量相关。在省略变量偏差一节中，我们看到这种相关性的存在将导致协方差项非零，进而导致偏差与该协方差的绝对值成比例。为了应对这种偏差，固定效应模型采用了将单位特定偏差项<em class="nd"> c_i </em>引入回归方程的方法，如下所示:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/682927a025c0480533911208b86ade86.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*_i5ksOqCOVh2UFJw59m9zg.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">固定效应回归模型(图片由作者提供)</p></figure><p id="866f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，我们已经用<strong class="kh ir"><em class="nd"/></strong><em class="nd"/><em class="nd">_ I</em>替换了术语<strong class="kh ir"><em class="nd">z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I</em>，它是一个大小为<em class="nd">【T x1】</em>的矩阵，其中每个元素都有相同的值<em class="nd"> c_i. </em></p><p id="adf0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nd"> c_i </em>的<em class="nd">估计值</em>，即(我们称之为<em class="nd"> c_cap_i) </em>是一个具有一定概率分布的随机变量，其均值为<em class="nd"> c_i. </em>在固定效应模型中，我们假设所有单位特定效应的估计值具有相同的常方差<em class="nd"> σ。</em>假设正态分布<em class="nd"> c_cap_i也很方便(尽管不是必需的)</em>因此，我们有:</p><p id="345b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nd"> c_cap_i ~ N(c_i，σ ) </em></p><p id="1cd6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下图说明了三个单元的<em class="nd"> c_i </em>的分布:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ok"><img src="../Images/fb3e05e5ce9b3a44afdf599f74e18e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddtalc-ueg5rg0LoMJIHhg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">面板数据集中三个不同单位的单位特异性效应c_i的概率分布(图片由作者提供)</p></figure><p id="4c43" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们来看看随机效应模型的动机。</p><p id="b52d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果单位特定效应与回归变量不相关，则该效应完全成为误差项<strong class="kh ir"><em class="nd"/></strong>的一部分。<em class="nd">我们不能再使用我们在固定效应模型中使用的策略来补偿它的缺失</em>，即我们不能再假设一个独特的、单位特定的效应<em class="nd"> c_i </em>的存在，其效应将补偿由于从模型中省略所有未观察到的变量<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em>而引入的偏差。</p><p id="7903" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们需要一种不同的方式来考虑单位特定的影响，为此，我们求助于一种巧妙的建模方法。</p><p id="f264" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回忆以下回归方程:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/e2784d90f41499db8c5b34cf984a6804.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*XKT6GST0BBlhkS7-5mPxkw.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">国家I的线性模型的一般形式(图片由作者提供)</p></figure><p id="cc1f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回想一下，术语<strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I</em>产生特定于单元的效果。<strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I</em>恰好是一个具有某种均值和方差的随机变量。</p><p id="a87f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在随机效应模型中，我们假设所有单元的<strong class="kh ir">单元特定效应<strong class="kh ir">根据某个未知概率分布分布在公共平均值</strong>周围。此外，该<strong class="kh ir">公共平均值在数据面板中的所有时间段</strong>内保持不变。</strong></p><p id="3b0e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在符号方面，这些假设产生了下面的<a class="ae lb" rel="noopener" target="_blank" href="/3-conditionals-every-data-scientist-should-know-1916d48b078a">条件期望</a>对于术语<strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I</em>，这意味着捕捉所有不可观察的特定于单元的效应:</p><p id="56df" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nd">E(</em><strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I |</em><strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I)=α</em></p><p id="dd15" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们从模型的回归方程的R.H.S .中加减这个期望值:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ol"><img src="../Images/e531d4b6973ccc86cb37c16b59fe2504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QC1C1It0g38rE4pmNZZ6fg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">图片作者)</p></figure><p id="a275" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上式中，术语(<em class="nd"/><strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I—E(</em><strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I |</em><strong class="kh ir"><em class="nd">X</em></strong><em class="nd">我们将用术语<strong class="kh ir"><em class="nd">μ</em></strong><em class="nd">_ I .</em>来表示这种变化</em></p><p id="bac9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们已经假设上式中的黄色项(即所有单位特定效应的期望值)具有常量值<em class="nd"> α </em>，即<em class="nd">E(</em><strong class="kh ir"><em class="nd">Z</em></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I |</em><strong class="kh ir"><em class="nd">X<em class="nd"/></em></strong></p><p id="9dad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们得出随机效应回归模型的以下方程:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi om"><img src="../Images/1ffa8c37398684dcd0e841122a136334.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*p3zvYFPvdo9yFWHHzEyqxA.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">第一单元的随机效应模型(图片由作者提供)</p></figure><p id="b92d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上述等式表明了以下观点:</p><p id="6139" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在估计模型的参数时，如果我们忽略特定于单元的效果<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em><strong class="kh ir"><em class="nd">γ</em></strong><em class="nd">_ I</em>，我们将引入两种情况:</p><ol class=""><li id="c591" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">常数<em class="nd"> α </em>捕捉所有单位特效的平均值。这个平均值不随时间变化，它有效地取代了回归模型的截距项。</li><li id="621d" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">误差项<strong class="kh ir"><em class="nd">μ</em></strong><em class="nd">_ I</em>，其大小与常数均值周围单位特定效应的方差成正比。</li></ol><p id="ed78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这个角度来看，我们有理由将<strong class="kh ir"><em class="nd"/></strong><em class="nd">_ I</em>与误差项<strong class="kh ir"><em class="nd">ϵ</em></strong><em class="nd">_ I</em>组合在一起，形成<strong class="kh ir">一个复合误差项</strong>，我们在括号中显示了该误差项。</p><p id="18de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个复合误差项是随机效应回归模型的定义特征。正如我们将很快看到的，复合误差项的各个分量需要作为re模型估计过程的一部分进行估计。</p><p id="28a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是单位<em class="nd"> i </em>和特定时间段<em class="nd"> t </em>的随机效应模型方程:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6e456fa2df1a306ede10bf0f92bde661.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*M_CMtzYP7CUtiG7I0q_rSw.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">t时段单位I的随机效应回归模型(图片由作者提供)</p></figure><p id="a486" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的等式中:</p><ul class=""><li id="4e8f" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la nr li lj lk bi translated"><em class="nd"> y_i_t </em>是单位(国家)<em class="nd"> i </em>在时间段(年份)<em class="nd"> t </em>的响应变量的值(在WB数据集中的GDP增长百分比)。</li><li id="1745" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"> <em class="nd"> x </em> </strong> <em class="nd"> _i_t </em>是一个大小为<em class="nd">【1 x k】</em>的行向量，假设有k个回归变量(WB数据面板的<em class="nd"> k=1 </em>)。<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I _ T</em>是我们前面看的大小为<em class="nd">【T X k】</em>的<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>回归矩阵中的第<em class="nd">T</em>行。</li><li id="b577" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><strong class="kh ir"><em class="nd">β</em></strong><em class="nd">_ I</em>是一个大小为<em class="nd">【k×1】</em>的列向量。在世界银行的数据集中，只有一个回归变量:%总资本形成增长率。</li><li id="5140" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><em class="nd"> α </em>是共同偏倚(所有单位特异性效应的平均值)。它形成了线性回归模型的截距。</li><li id="ecce" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><em class="nd"> μ_i是</em>由单位I的单位特定效应引入的方差。请注意，它缺少时间下标t，因为在数据面板中假设它在所有时间段内都是常数(也称为时间不变量)。</li><li id="8bfe" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la nr li lj lk bi translated"><em class="nd"> ϵ_i_t </em>是在时间段<em class="nd"> t </em>内为单元<em class="nd"> i </em>引入的所有其他来源的误差的余额。</li></ul><p id="ee52" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是上述等式的矩阵形式:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oo"><img src="../Images/06a2a7d614b8a58f9fc63a667ae9bc64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Cg2blyQGI1bLy-Mp9g7gg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">时间周期t内单元I的随机效应回归模型(矩阵格式，图片由作者提供)</p></figure><h2 id="d462" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">随机效应模型中复合误差项的特征</h2><p id="4181" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">RE模型的综合误差项有几个重要特征，决定了如何估算这些误差。</p><ol class=""><li id="7378" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">与<a class="ae lb" rel="noopener" target="_blank" href="/understanding-the-fixed-effects-regression-model-d2fccc2cc27e">固定效应模型</a>一样，<strong class="kh ir">误差</strong> <em class="nd"> ϵ_i_t </em> <strong class="kh ir">是一个随机变量，它被假定为以某种未知的(但通常被假定为正态的)概率分布围绕平均值0</strong>波动。因此，误差的条件期望为零:<em class="nd"><br/>e(ϵ_i_t|</em><strong class="kh ir"><em class="nd">x</em></strong><em class="nd">_ I)= 0对于所有单位I和时间段t </em></li><li id="c860" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">假定<strong class="kh ir">误差项</strong><em class="nd">【ϵ_i_t】</em><strong class="kh ir">在数据面板中的所有单位和所有时间段的零均值附近具有恒定方差<em class="nd"> σ _ϵ </em> </strong> <em class="nd"> </em>。从概率论中，我们知道随机变量的方差是以均值为中心的随机变量的平方的期望值。由于误差项的平均值为零，它只是误差平方的期望值，取决于该单元的其余回归变量值:<br/><em class="nd">e(ϵ_ I _ t |</em><strong class="kh ir"><em class="nd">x</em></strong><em class="nd">_ I)=σ_ϵ</em></li><li id="5682" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated"><strong class="kh ir">误差项</strong> <em class="nd"> ϵ_i_t </em> <strong class="kh ir">跨不同单位</strong> <em class="nd"> i </em> <strong class="kh ir">和</strong> <em class="nd"> j </em> <strong class="kh ir">或不同时间段</strong> <em class="nd"> t </em> <strong class="kh ir">和</strong> <em class="nd"> s </em>(假设模型指定正确):<br/><em class="nd">e(ϵ_i_t*ϵ_j_s|</em><strong class="kh ir"><em class="nd">x</em></strong>=j或者t！= s </li><li id="dc5b" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated"><strong class="kh ir">特定于单元的效果</strong> <em class="nd"> μ_i </em> <strong class="kh ir">围绕零均值波动，并且它们具有恒定方差</strong><em class="nd">σ_ u:<br/>E(μ_ I |</em><strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I)= 0</em>和<em class="nd">E(μ_ I |</em><strong class="kh ir"><em class="nd">X</em></strong></li><li id="6dcd" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated"><strong class="kh ir">特定于单元的效果</strong> <em class="nd"> μ_i </em> <strong class="kh ir">与误差</strong><em class="nd">ϵ_i_t:<br/>e(μ_j*ϵ_i_t|</em><strong class="kh ir"><em class="nd">x</em></strong><em class="nd">_ I)= 0对于所有I，j，t </em></li></ol><h1 id="2bf7" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">随机效应回归模型的估计</h1><p id="3450" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">RE模型的估计涉及以下两件事:</p><ol class=""><li id="695f" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">方差分量的估计<em class="nd"> σ _ϵ </em>和<em class="nd"> σ _u </em>与复合残差<em class="nd">(</em><strong class="kh ir"><em class="nd">μ</em></strong><em class="nd">+</em><strong class="kh ir"><em class="nd">ϵ</em></strong><em class="nd">)。</em></li><li id="c7ed" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">回归系数<strong class="kh ir"> <em class="nd"> β </em> </strong>和公共偏差<em class="nd"> α </em>的估计(我们形成回归模型的截距项)。</li></ol><p id="5e6a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nd"> σ _ϵ </em>和<em class="nd"> σ _u </em>的估计也为我们提供了一种估计随机效应模型能够解释的<strong class="kh ir"> <em class="nd"> y </em> </strong>中总方差分数的方法，如下所示:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi op"><img src="../Images/35c288a6d27d0a6a120e34d06dc0a547.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*1FgYuBLm57MvDwpnu6SZAQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">随机效应模型能够解释的总方差在<strong class="bd oh"> <em class="oi"> y </em> </strong>中的分数(图片由作者提供)</p></figure><p id="3618" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随机效应模型的估计过程通过以下一系列步骤进行:</p><h2 id="41bc" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤1:混合OLSR回归模型的估计</h2><p id="5d1a" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">随机效果模型具有复合误差项<em class="nd">(</em><strong class="kh ir"><em class="nd">μ</em></strong><em class="nd">+</em><strong class="kh ir"><em class="nd">ϵ</em></strong><em class="nd">)。</em>在这一步中，我们将为估计与组件<strong class="kh ir"><em class="nd"/></strong>和<strong class="kh ir"><em class="nd"/></strong>相关的方差<em class="nd"> σ _ϵ </em>和<em class="nd"> σ _u </em>做准备。<strong class="kh ir"> <em class="nd"> </em> </strong>稍后将需要这些方差估计来估计模型的系数。</p><p id="170f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们将训练一个<a class="ae lb" rel="noopener" target="_blank" href="/how-to-build-a-pooled-ols-regression-model-for-panel-data-sets-a78358f9c2a"> <strong class="kh ir">汇集了OLS回归模型</strong> </a> <strong class="kh ir"> </strong>模型的面板数据集。混合OLSR模型基本上是一个OLS回归模型，建立在面板数据组的扁平化版本上。</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/aaab1cf6bf1aa2d565b750754e254581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*9-TmxV4aPfKw1eVhriIlWQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">面板数据集的扁平化版本(图片由作者提供)</p></figure><p id="b0ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在世界银行数据集的情况下，我们在GCF_GWTH_PCNT上回归GDP_PCAP_GWTH_PCNT:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi or"><img src="../Images/5641eb90b225eff5ab90197da00607a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p3H_loIyydh6-xGjpVlzvg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">汇集的OLSR数据模型(图片由作者提供)</p></figure><p id="8556" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们真正感兴趣的是经过训练的PLSR模型的残差<strong class="kh ir"><em class="nd">【ϵ】</em></strong><em class="nd"/>。在下一步中，我们将使用这些误差来估计随机效应模型的方差分量。</p><h2 id="862d" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤2:方差分量σ _ϵ和σ _ <em class="oi"> u </em>的估计</h2><p id="5533" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated"><em class="nd"> σ _ ϵ </em>和<em class="nd"> σ _ μ </em>是误差分量<strong class="kh ir"> <em class="nd"> μ </em> </strong>和<strong class="kh ir"> <em class="nd"> ϵ.的方差</em> </strong>为了估计方差，我们将使用样本方差的公式:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi os"><img src="../Images/6c08c81849ded0bbd5189a90d73c2847.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*oPxz2qTTpeujmuKi9ABIkQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">随机变量<strong class="bd oh"> <em class="oi"> W </em> </strong>与均值w_bar的样本方差公式(图片由作者提供)</p></figure><p id="fa22" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以看出，方差<em class="nd"> σ _ ϵ </em>就是固定效应模型的误差项<strong class="kh ir"> <em class="nd"> ϵ </em> </strong>的方差。因此，为了估计这个方差，我们将在面板数据集上训练一个固定效应模型，如我在关于<a class="ae lb" rel="noopener" target="_blank" href="/understanding-the-fixed-effects-regression-model-d2fccc2cc27e"> <strong class="kh ir">固定效应模型</strong> </a>的文章中所示。然后，我们使用拟合模型的残差来计算<em class="nd"> σ _ ϵ </em>，如下所示:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/5e0ea1780fe1fa4eeedf8e417765ed16.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*Y2XEBwc6Kxuz0EBMkHNgbQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">剩余误差<em class="oi">方差的计算公式(图片由作者提供)</em></p></figure><p id="e724" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上式中，<em class="nd"> ϵ_i_t </em>为训练好的有限元模型在<em class="nd"> t </em>时刻单元<em class="nd"> i </em>的残差。请注意，我们没有对每个误差进行去均值处理(即减去均值),因为拟合的OLSR模型(实际上是有限元模型)的残差均值为零。</p><p id="eb44" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的公式中，内部求和是单元<em class="nd"> i </em>的残差的平方和。外部求和对数据面板中的所有<em class="nd"> n </em>单元执行内部求和。</p><p id="0574" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在分母中，我们通过固定效应模型使用的组数<em class="nd"> (n) </em>和每个组中的回归变量数(<em class="nd"> k) </em>向下调整了总自由度(<em class="nd"> nT </em>)。</p><p id="00b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">计算<em class="nd"> σ _u </em>的程序有点复杂，σ _u是单位效应的方差。在面板数据回归的文献中至少有三个不同的公式。我们不会深入这些公式的细节和基本原理，而是简单陈述最容易理解的公式:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/d57dc23e76aa430066842ebf0d53fdf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*2YcHcZs_GDPBixQpiF_y0Q.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">与随机效应回归模型的复合误差项相关的方差之间的关系<em class="oi">(图片由作者提供)</em></p></figure><p id="458c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上式中，<em class="nd"> σ _pooled </em>是在面板数据集上训练的<a class="ae lb" rel="noopener" target="_blank" href="/how-to-build-a-pooled-ols-regression-model-for-panel-data-sets-a78358f9c2a"> Pooled OLSR模型</a>的残差方差。回想一下，我们在步骤1中拟合了这个模型。我们已经看到如何估计<em class="nd"> σ _ ϵ.</em>因此，知道了<em class="nd"> σ _pooled </em>和<em class="nd"> σ _ ϵ </em>，我们就可以用上面的公式来估算<em class="nd"> σ _u </em>。</p><p id="461b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在接下来的两步中，我们将进一步为估计系数<strong class="kh ir"> <em class="nd"> β </em> </strong>和公共偏差<em class="nd"> α做准备。</em></p><h2 id="22d5" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤3:估计特定群体的平均数</h2><p id="cf0f" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在这一步，我们将计算数据面板中每组<em class="nd"> i </em>(即每个单元<em class="nd"> i </em>)的响应<strong class="kh ir"><em class="nd">y</em></strong><em class="nd">_ I</em>和回归变量<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>的平均值。由于我们的数据面板是平衡的，每个组包含相同数量的<em class="nd"> T </em>时间段。因此，计算组<em class="nd"> i </em>的平均值需要对组<em class="nd"> i </em>的响应值<strong class="kh ir"> <em class="nd"> y </em> </strong>的所有值求和(或对组<em class="nd"> i </em>的回归变量<strong class="kh ir"><em class="nd">x _ k</em></strong><em class="nd"/>的所有值求和)，然后除以<em class="nd"> T </em></p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/61981cd5de932069e018a18608e960a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*aeP7QdkXCE49NF5nRwpz3w.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">每个单元I的<strong class="bd oh"> X </strong>和<strong class="bd oh"> y </strong>值的组特定平均值(图片由作者提供)</p></figure><p id="050b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下图说明了比利时的计算方法:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ow"><img src="../Images/a2f476b94104e7da6f0ca63605177001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCKmGgQ_RGKpLm--Ngsf4g.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">计算世界银行数据面板的特定群体平均值(图片由作者提供)</p></figure><p id="9ee5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">许多文本使用以下符号表示这种方法:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/79248fa7c6032a68f4fc48a7dadca1c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*-RWBfzkuc8FuZuLwNigc0g.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">聚合值的点符号(图片由作者提供)</p></figure><p id="c9a0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点的位置表示在其上执行聚合的矩阵维数。在上面的例子中，聚合是在时间维度上执行的。</p><p id="1bdb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下表包含WB数据集的特定组均值:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oy"><img src="../Images/6803ba19cd491edb6415275cb3d44c08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mS4F4LuwsjWhJ7R6kc-f0Q.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">世界银行面板数据组的<strong class="bd oh"> X </strong> _i和<strong class="bd oh"> y </strong> _i的分组均值(图片由作者提供)</p></figure><p id="4d54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是这些值相互对比时的样子:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oz"><img src="../Images/57a58552b2d7e45a3749081d0bb25e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDP4ttVaFaPJ33LlSlEHxA.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated"><strong class="bd oh"> y </strong> _i对<strong class="bd oh"> X </strong> _i的分组均值(图片由作者提供)</p></figure><p id="2367" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将在下一步中使用这些组方法。</p><h2 id="2ada" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤4:居中(减去平均值)数据面板的计算</h2><p id="ccc9" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在此步骤中，我们使用在步骤3中计算的各个组特定平均值，对每个单元的所有<strong class="kh ir"><em class="nd">y</em></strong><em class="nd">_ I</em>和<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>值进行去平均。但是，我们没有将数据集集中在特定组的原始平均值周围，而是将其集中在平均值的缩放版本周围，其中缩放因子<em class="nd"> θ </em>体现了特定单元随机效应的贡献。以下是对中<strong class="kh ir"><em class="nd">y</em></strong><em class="nd">_ I</em>和<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>值的公式:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/17837e9323a40b94e1260fe1fe30b38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*adk5tDaKMgG4o9xJsFw7lw.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">每个单元I的<strong class="bd oh"> y </strong> _i和<strong class="bd oh"> X </strong> _i的对中(图片由作者提供)</p></figure><p id="b0c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">比例因子<em class="nd"> θ </em>可以用两个方差分量<em class="nd"> σ _ϵ </em>和<em class="nd"> σ _u </em>表示如下:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/283a61c7eb812301648ea05fd8097225.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*tV7WKQz11R6QLH18s3bnLg.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated"><em class="oi"> θ的估算(图片由作者提供)</em></p></figure><h2 id="d344" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤5:使用减去平均值的数据面板估计随机效应模型系数<strong class="ak"><em class="oi">β</em></strong><em class="oi">_ I</em></h2><p id="9bec" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">最后，我们估计随机效应模型的系数<strong class="kh ir"><em class="nd">β</em></strong><em class="nd">_ I</em>。我们通过在我们在步骤4中构建的均值减去数据面板(<strong class="kh ir"> <em class="nd"> y </em> </strong> * <strong class="kh ir"> <em class="nd">，X </em> </strong> <em class="nd"> *) 【T71)上拟合OLSR模型来做到这一点。在时间<em class="nd"> t </em>时，单元<em class="nd"> i </em>的模型方程如下:</em></p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/ef288abda37cc72023464ba9725a762b.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*gvnRPiUM-SAhP1xRv9Xs_A.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">(图片由作者提供)</p></figure><p id="5706" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就完成了随机效应模型的估算程序。</p></div><div class="ab cl pd pe hu pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="ij ik il im in"><h1 id="0947" class="lq lr iq bd ls lt pk lv lw lx pl lz ma jw pm jx mc jz pn ka me kc po kd mg mh bi translated">如何使用Python和statsmodels实现随机效应回归模型</h1><p id="c7f9" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">现在，我们将使用上文概述的5步程序，说明在世界银行数据集上构建和训练随机效应回归模型的程序。</p><p id="dbcf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文的开始，我们已经导入了所有需要的包，并将世界银行数据集加载到Pandas数据框架中。</p><p id="dec0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们列出所有代码，包括我们将在后面步骤中使用的公共变量定义:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="a014" class="nj lr iq nf b gy nk nl l nm nn">colors_master = [<strong class="nf ir">'blue'</strong>, <strong class="nf ir">'red'</strong>, <strong class="nf ir">'orange'</strong>, <strong class="nf ir">'lime'</strong>, <strong class="nf ir">'yellow'</strong>, <strong class="nf ir">'cyan'</strong>, <strong class="nf ir">'violet'</strong>, <strong class="nf ir">'yellow'</strong>, <strong class="nf ir">'sandybrown'</strong>, <strong class="nf ir">'silver'</strong>]<br/><br/><em class="nd">#Define the units (countries) of interest<br/></em>unit_names = [<strong class="nf ir">'Belgium'</strong>, <strong class="nf ir">'CzechRepublic'</strong>, <strong class="nf ir">'France'</strong>, <strong class="nf ir">'Ireland'</strong>, <strong class="nf ir">'Portugal'</strong>, <strong class="nf ir">'UK'</strong>, <strong class="nf ir">'USA'</strong>]</span><span id="35ee" class="nj lr iq nf b gy no nl l nm nn">unit_names.<strong class="nf ir">sort</strong>()<br/><br/>colors = colors_master[:<strong class="nf ir">len</strong>(unit_names)]<br/><br/>unit_col_name=<strong class="nf ir">'COUNTRY'<br/></strong>time_period_col_name=<strong class="nf ir">'YEAR'<br/><br/></strong><em class="nd">#Define the y and X variable names<br/></em>y_var_name = <strong class="nf ir">'GDP_PCAP_GWTH_PCNT'<br/></strong>X_var_names = [<strong class="nf ir">'GCF_GWTH_PCNT'</strong>]<br/><br/><strong class="nf ir"><em class="nd">#Load the panel data set of World Bank published development indicators into a Pandas Dataframe</em></strong><em class="nd"><br/></em>df_panel = pd.read_csv(<strong class="nf ir">'wb_data_panel_2ind_7units_1992_2014.csv'</strong>, <strong class="nf ir">header</strong>=0)</span><span id="9470" class="nj lr iq nf b gy no nl l nm nn"><strong class="nf ir"><em class="nd">#Setup the variables that we will use in later steps to calculate the variance components</em></strong><em class="nd"><br/><br/></em><strong class="nf ir"><em class="nd">#n=number of groups</em></strong><em class="nd"><br/></em>n=len(unit_names)<br/><br/><strong class="nf ir"><em class="nd">#T=number of time periods per unit</em></strong><em class="nd"><br/></em>T=df_panel.shape[0]/n<br/><br/><strong class="nf ir"><em class="nd">#N=total number of rows in the panel data set</em></strong><em class="nd"><br/></em>N=n*T<br/><br/><strong class="nf ir"><em class="nd">#k=number of regression variables of the Pooled OLS model</em></strong><em class="nd"><br/></em>k=len(X_var_names)+1</span><span id="1fcd" class="nj lr iq nf b gy no nl l nm nn">plot_against_X_index=0<br/><br/><strong class="nf ir"><em class="nd">#Use Seaborn to plot GDP growth over all time periods and across all countries versus gross</em></strong><em class="nd"><br/># capital formation growth:<br/></em>sns.<strong class="nf ir">scatterplot</strong>(<strong class="nf ir">x</strong>=df_panel[X_var_names[plot_against_X_index]], <strong class="nf ir">y</strong>=df_panel[y_var_name], <strong class="nf ir">hue</strong>=df_panel[unit_col_name], palette=colors).<strong class="nf ir">set</strong>(<strong class="nf ir">title</strong>= 'Y-o-Y % Change in per-capita GDP versus Y-o-Y % Change in Gross capital formation')</span><span id="741b" class="nj lr iq nf b gy no nl l nm nn">plt.<strong class="nf ir">show</strong>()</span></pre><p id="de75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据集可以在 这里下载<a class="ae lb" href="https://gist.github.com/sachinsdate/c40651e9e4bc13a696780462209f1992" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">。</strong></a></p><h2 id="707e" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤1:估计混合OLSR回归模型</h2><p id="3540" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在这一步中，我们将使用statsmodels在panel数据集上构建和训练一个合并的OLS回归模型:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="1414" class="nj lr iq nf b gy nk nl l nm nn"><strong class="nf ir">#Carve out the pooled y and pooled X matrices</strong><br/>grouped_y=df_panel_group_means[y_var_name]<br/>grouped_X=df_panel_group_means[X_var_names]</span><span id="7446" class="nj lr iq nf b gy no nl l nm nn"><strong class="nf ir">#Add the placeholder for the regression intercept</strong><br/>grouped_X = sm.add_constant(grouped_X)</span><span id="30d2" class="nj lr iq nf b gy no nl l nm nn"><strong class="nf ir">#Build and train an OLSR model on the entire dataset</strong><br/>pooled_olsr_model = sm.OLS(endog=pooled_y, exog=pooled_X)<br/>pooled_olsr_model_results = pooled_olsr_model.fit()</span><span id="ff72" class="nj lr iq nf b gy no nl l nm nn">print(<strong class="nf ir">'=============== Pooled OLSR Model ==============='</strong>)<br/>print(pooled_olsr_model_results.summary())</span></pre><p id="6260" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到以下输出:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi pp"><img src="../Images/5620a891c6ba6aed8d7bf4fee9d67ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y54eYyBudNFzTBlZbWY78Q.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">集合OLSR模型的训练总结(图片由作者提供)</p></figure><p id="99e4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们对该模型的残差感兴趣，如下所示:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="e269" class="nj lr iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>('residuals of the \'Pooled OLSR\' model:')<br/><strong class="nf ir">print</strong>(pooled_olsr_model_results.<strong class="nf ir">resid</strong>)</span></pre><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/817ef42cf82a3e93fd6d3c42625448c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*7YONbvuEKMGBFwIVCBzawQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">混合OLSR模型的残差(图片由作者提供)</p></figure><h2 id="9ff6" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤2:方差分量σ _ϵ和σ _ <em class="oi"> u </em>的计算</h2><p id="4253" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">为了计算<em class="nd"> σ _ϵ </em>，我们将在这个数据集上拟合固定效应模型。</p><p id="4b29" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在面板数据集上建立和拟合LSDV(带虚拟变量的最小二乘)模型，以便我们可以访问它的SSE。</p><p id="90b9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建虚拟变量，每个国家一个。</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="f9a0" class="nj lr iq nf b gy nk nl l nm nn">df_dummies = pd.<strong class="nf ir">get_dummies</strong>(df_panel[unit_col_name])</span></pre><p id="8cb0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将假人数据框与面板数据集连接起来。</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="39a9" class="nj lr iq nf b gy nk nl l nm nn">df_panel_with_dummies = df_panel.<strong class="nf ir">join</strong>(df_dummies)</span></pre><p id="964a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">构建LSDV模型的回归方程。请注意，我们省略了一个虚拟变量，以避免7个虚拟变量之间完全多重共线。回归模型的截距将包含被忽略的美国虚拟变量的系数值。</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="b077" class="nj lr iq nf b gy nk nl l nm nn">lsdv_expr = y_var_name + <strong class="nf ir">' ~ '<br/></strong>i = 0<br/><strong class="nf ir">for </strong>X_var_name <strong class="nf ir">in </strong>X_var_names:<br/>    <strong class="nf ir">if </strong>i &gt; 0:<br/>        lsdv_expr = lsdv_expr + <strong class="nf ir">' + ' </strong>+ X_var_name<br/>    <strong class="nf ir">else</strong>:<br/>        lsdv_expr = lsdv_expr + X_var_name<br/>    i = i + 1<br/><strong class="nf ir">for </strong>dummy_name <strong class="nf ir">in </strong>unit_names[:-1]:<br/>    lsdv_expr = lsdv_expr + <strong class="nf ir">' + ' </strong>+ dummy_name<br/><br/>print(<strong class="nf ir">'Regression expression for OLS with dummies=' </strong>+ lsdv_expr)</span></pre><p id="3d85" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">建立和训练LSDV模型。</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="7f2f" class="nj lr iq nf b gy nk nl l nm nn">lsdv_model = smf.<strong class="nf ir">ols</strong>(<strong class="nf ir">formula</strong>=lsdv_expr, <strong class="nf ir">data</strong>=df_panel_with_dummies)<br/>lsdv_model_results = lsdv_model.<strong class="nf ir">fit</strong>()</span></pre><p id="207f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打印出培训总结。</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="05de" class="nj lr iq nf b gy nk nl l nm nn">print(<strong class="nf ir">'============= OLSR With Dummies ============='</strong>)<br/>print(lsdv_model_results.summary())</span></pre><p id="5865" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到以下输出:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi pr"><img src="../Images/08e031dfc66f551d9b41e2431ade4346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QbHRE31XIJp9epXd1dqglg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">固定效果(LSDV)模型训练总结(图片由作者提供)</p></figure><p id="2fe3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">计算并打印<em class="nd"> σ _ϵ </em>:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="c996" class="nj lr iq nf b gy nk nl l nm nn">sigma2_epsilon = lsdv_model_results.<strong class="nf ir">ssr</strong>/(n*T-(n+k+1))<br/>print(<strong class="nf ir">'sigma2_epsilon = ' </strong>+ <strong class="nf ir">str</strong>(sigma2_epsilon))</span></pre><p id="318f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到<em class="nd"> σ _ϵ: </em>的如下值</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="dacf" class="nj lr iq nf b gy nk nl l nm nn">sigma2_epsilon = <strong class="nf ir">2.359048222628497</strong></span></pre><p id="9d04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">计算<em class="nd"> σ _pooled: </em></p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="86c8" class="nj lr iq nf b gy nk nl l nm nn">sigma2_pooled = pooled_olsr_model_results.<strong class="nf ir">ssr</strong>/(n*T-(k+1))<br/>print(<strong class="nf ir">'sigma2_pooled</strong> <strong class="nf ir">= ' </strong>+ <strong class="nf ir">str</strong>(sigma2_pooled))</span></pre><p id="d126" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到<em class="nd"> σ _pooled的以下值:</em></p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="02ae" class="nj lr iq nf b gy nk nl l nm nn">sigma2_pooled = <strong class="nf ir">2.4717633611733136</strong></span></pre><p id="1c92" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">计算<em class="nd"> σ _u: </em></p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="18a7" class="nj lr iq nf b gy nk nl l nm nn">sigma2_u = sigma2_pooled - sigma2_epsilon<br/>print(<strong class="nf ir">'sigma2_u = ' </strong>+ <strong class="nf ir">str</strong>(sigma2_u))</span></pre><p id="093f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到以下值:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="65b3" class="nj lr iq nf b gy nk nl l nm nn">sigma2_u = <strong class="nf ir">0.11271513854481663</strong></span></pre><h2 id="9e88" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤3:估计特定组的平均值</h2><p id="5087" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">计算数据面板中各组(即每个单元<em class="nd"> i </em>)的<strong class="kh ir"><em class="nd">y</em></strong><em class="nd">_ I</em>和<strong class="kh ir"><em class="nd">X</em></strong><em class="nd">_ I</em>值的平均值如下:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="a4ea" class="nj lr iq nf b gy nk nl l nm nn">df_panel_group_means = df_panel.<strong class="nf ir">groupby</strong>(unit_col_name).<strong class="nf ir">mean</strong>()</span><span id="e545" class="nj lr iq nf b gy no nl l nm nn"><strong class="nf ir">print</strong>(df_panel_group_means)</span></pre><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ps"><img src="../Images/4a8815c2db6deaf8308459acc08cc0ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yfgYbaP47sjzAm7Jc8sjTQ.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">WB数据面板的分组均值(图片由作者提供)</p></figure><p id="8a6e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的分组数据面板中，年份列可以忽略。</p><p id="d8be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们为这个数据帧添加一个存储回归截距的列。我们将在步骤5中使用该列来估计公共偏置<em class="nd"> α </em>:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="e4ba" class="nj lr iq nf b gy nk nl l nm nn">df_panel_group_means[<strong class="nf ir">'const'</strong>] = 1.0</span></pre><h2 id="588d" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤4:计算居中(减去平均值)的数据面板</h2><p id="e799" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在这一步中，我们将使用在第2步中计算的相应组特定平均值的缩放版本，对每个单元的所有<strong class="kh ir"> <em class="nd"> y </em> </strong> <em class="nd"> _i </em>和<strong class="kh ir"> <em class="nd"> X </em> </strong> <em class="nd"> _i </em>值进行去平均。</p><p id="000f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们来计算<em class="nd"> θ </em>:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="ee37" class="nj lr iq nf b gy nk nl l nm nn">theta = 1 - math.<strong class="nf ir">sqrt</strong>(sigma2_epsilon/(sigma2_epsilon + T*sigma2_u))<br/>print(<strong class="nf ir">'theta = ' </strong>+ <strong class="nf ir">str</strong>(theta))</span></pre><p id="0bf1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们得到以下值:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="4131" class="nj lr iq nf b gy nk nl l nm nn">theta = 0.30975991786766044</span></pre><p id="cd46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">准备数据集，用于将y<strong class="kh ir"><em class="nd">y</em></strong>和X  列居中:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="7d2f" class="nj lr iq nf b gy nk nl l nm nn">pooled_y_with_unit_name = pd.<strong class="nf ir">concat</strong>([df_panel[unit_col_name], pooled_y], <strong class="nf ir">axis</strong>=1)</span><span id="5939" class="nj lr iq nf b gy no nl l nm nn">pooled_X_with_unit_name = pd.<strong class="nf ir">concat</strong>([df_panel[unit_col_name], pooled_X], <strong class="nf ir">axis</strong>=1)</span></pre><p id="af5e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<em class="nd"> θ- </em>缩放的组特定平均值，将每个<strong class="kh ir"> <em class="nd"> X </em> </strong>值居中:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="e87e" class="nj lr iq nf b gy nk nl l nm nn">unit_name = ''<br/>for row_index, row <strong class="nf ir">in </strong>pooled_X_with_unit_name.<strong class="nf ir">iterrows</strong>():<br/>    for column_name, cell_value <strong class="nf ir">in </strong>row.<strong class="nf ir">items</strong>():<br/>        if column_name == unit_col_name:<br/>            unit_name = <br/>                pooled_X_with_unit_name.<strong class="nf ir">at</strong>[row_index, column_name]<br/>        else:<br/>            pooled_X_group_mean = <br/>                df_panel_group_means.<strong class="nf ir">loc</strong>[unit_name][column_name]<br/>            pooled_X_with_unit_name.<strong class="nf ir">at</strong>[row_index, column_name] = <br/>                pooled_X_with_unit_name.<strong class="nf ir">at</strong>[<br/>                row_index, column_name] - theta*pooled_X_group_mean</span></pre><p id="03c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<em class="nd"> θ- </em>缩放的组特定平均值将每个<strong class="kh ir"> <em class="nd"> y </em> </strong>值居中:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="895f" class="nj lr iq nf b gy nk nl l nm nn">unit_name = ''<br/>for row_index, row <strong class="nf ir">in </strong>pooled_y_with_unit_name.<strong class="nf ir">iterrows</strong>():<br/>    for column_name, cell_value <strong class="nf ir">in </strong>row.<strong class="nf ir">items</strong>():<br/>        if column_name == unit_col_name:<br/>            unit_name = <br/>                pooled_y_with_unit_name.at[row_index, column_name]<br/>        else:<br/>            pooled_y_group_mean = <br/>                df_panel_group_means.<strong class="nf ir">loc</strong>[unit_name][column_name]<br/>            pooled_y_with_unit_name.<strong class="nf ir">at</strong>[row_index, column_name] = <br/>                pooled_y_with_unit_name.<strong class="nf ir">at</strong>[<br/>                row_index, column_name] - theta*pooled_y_group_mean</span></pre><h2 id="1288" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">步骤5:使用减去平均值的数据面板估计随机效应模型系数β_i</h2><p id="6020" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">最后，让我们在<code class="fe pt pu pv nf b">pooled_X_with_unit_name</code>和<code class="fe pt pu pv nf b">pooled_X_with_unit_name.</code>上构建和训练RE模型</p><p id="cfe9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">雕刻出<strong class="kh ir"> <em class="nd"> y </em> </strong>和<strong class="kh ir"> <em class="nd"> X </em> </strong>矩阵:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="0c62" class="nj lr iq nf b gy nk nl l nm nn">re_y=pooled_y_with_unit_name[<strong class="nf ir">list</strong>(pooled_y_with_unit_name.columns[1:])]</span><span id="8fc4" class="nj lr iq nf b gy no nl l nm nn">re_X=pooled_X_with_unit_name[<strong class="nf ir">list</strong>(pooled_X_with_unit_name.columns[1:])]</span></pre><p id="1e1e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">建立和训练OLS回归模型:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="9d6c" class="nj lr iq nf b gy nk nl l nm nn">re_model = sm.<strong class="nf ir">OLS</strong>(<strong class="nf ir">endog</strong>=re_y, <strong class="nf ir">exog</strong>=re_X)</span><span id="3cfd" class="nj lr iq nf b gy no nl l nm nn">re_model_results = re_model.<strong class="nf ir">fit</strong>()</span></pre><p id="0ee9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打印培训总结:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="fe1c" class="nj lr iq nf b gy nk nl l nm nn"><strong class="nf ir">print</strong>(re_model_results.<strong class="nf ir">summary</strong>())</span></pre><p id="4980" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到以下输出:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi pw"><img src="../Images/9af9c2d9353a3864c3718d70f8b6b188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cloTjxZDSTFBs-MVTzE2Pg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">随机效应回归模型的训练总结(图片由作者提供)</p></figure><p id="666f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就完成了随机效应回归模型的估计过程。</p><h1 id="dac8" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">检验随机效应的显著性</h1><p id="0a6c" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">回想一下<em class="nd"> σ _u </em>估计为<strong class="kh ir"> 0.112723 </strong>和<em class="nd"> σ _ϵ </em>估计为<strong class="kh ir"> 2.35905 </strong>。因此，可归因于单位特定随机效应的总方差的分数为:</p><p id="6c12" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">0.112723/(0.112723+2.35905)=</strong>0.04560即约4%。</p><p id="5da7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">小规模的随机效应给出了第一个提示，即随机效应模型可能不适合这个数据集，而固定效应模型可能会提供更好的拟合。</p><p id="1954" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用<strong class="kh ir"> Breusch-Pagan LM测试</strong>来测试随机效应的显著性。</p><p id="6579" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">breu sch-Pagan LM检验的零假设是单位方差</strong> <em class="nd"> σ _u </em> <strong class="kh ir">为零</strong> <em class="nd">。</em></p><p id="84a3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">测试统计如下:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div class="gh gi px"><img src="../Images/0a861796eb77eed268942e96ed629c58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*CFfIV5wNf7xeYBY4iXW8UQ.png"/></div><p class="mz na gj gh gi nb nc bd b be z dk translated">检验随机效应显著性的LM检验的检验统计量<em class="oi"> σ _u(图片由作者提供)</em></p></figure><p id="a970" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在LM检验的零假设下，检验统计量是卡方(1)分布的。</p><p id="76bb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分母中的嵌套求和是我们在步骤1中拟合的混合OLSR模型的残差平方和。分子中的总和是来自混合OLSR模型的残差的分组均值的总和。请注意<em class="nd"> ϵ </em>上的横条，它表明这是平均残差，以及“<em class="nd"> i </em>”下标后的“点”,它表明该平均值是每组中所有时间段的集合。数据面板中有对应于<em class="nd"> n个</em>单元的<em class="nd"> n个</em>组。因此，分子中的总和从1到n。</p><p id="2db3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们计算一下世界银行数据集的这个统计值:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="bae4" class="nj lr iq nf b gy nk nl l nm nn"><strong class="nf ir">#Concatenate the unit names column to the Dataframe containing the residuals from the Pooled OLSR model<br/></strong>df_pooled_olsr_resid_with_unitnames = pd.<strong class="nf ir">concat</strong>([df_panel[unit_col_name],pooled_olsr_model_results.<strong class="nf ir">resid</strong>], <strong class="nf ir">axis</strong>=1)</span><span id="83c3" class="nj lr iq nf b gy no nl l nm nn">df_pooled_olsr_resid_group_means = df_pooled_olsr_resid_with_unitnames.<strong class="nf ir">groupby</strong>(unit_col_name).<strong class="nf ir">mean</strong>()</span><span id="c788" class="nj lr iq nf b gy no nl l nm nn">ssr_grouped_means=(df_pooled_olsr_resid_group_means[0]**2).<strong class="nf ir">sum</strong>()</span><span id="6393" class="nj lr iq nf b gy no nl l nm nn">ssr_pooled_olsr=pooled_olsr_model_results.<strong class="nf ir">ssr</strong></span><span id="d692" class="nj lr iq nf b gy no nl l nm nn">LM_statistic = (n*T)/(2*(T-1))*math.<strong class="nf ir">pow</strong>(((T*T*ssr_grouped_means)/ssr_pooled_olsr - 1),2)<br/><br/>print(<strong class="nf ir">'BP LM Statistic='</strong>+str(LM_statistic))</span></pre><p id="22e8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到以下输出:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="b235" class="nj lr iq nf b gy nk nl l nm nn">LM Statistic=<strong class="nf ir">3.4625558219208075</strong></span></pre><p id="3af1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们打印出α= 0.05时的临界卡方值:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="b5a7" class="nj lr iq nf b gy nk nl l nm nn">alpha=0.05<br/>chi2_critical_value=st.<strong class="nf ir">chi2</strong>.<strong class="nf ir">ppf</strong>((1.0-alpha), 1)<br/>print(<strong class="nf ir">'chi2_critical_value='</strong>+<strong class="nf ir">str</strong>(chi2_critical_value))</span></pre><p id="a1c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到以下输出:</p><pre class="mo mp mq mr gt ne nf ng nh aw ni bi"><span id="e4f5" class="nj lr iq nf b gy nk nl l nm nn">chi2_critical_value=<strong class="nf ir">3.841458820694124</strong></span></pre><p id="c97c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在α= 0.05时，LM检验的检验统计量(<strong class="kh ir"> 3.46256 </strong>)小于<strong class="kh ir"> 3.84146 </strong>的卡方(1)临界值，这意味着在α= 0.05时随机效应不显著。(不要把这个<em class="nd"> α </em>和象征RE模型平均单位特效的那个搞混了！)</p><h1 id="cbe3" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">混合OLSR、固定效应和随机效应模型的性能比较</h1><p id="d063" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在WB数据集上比较三个模型的性能将是有用的。对于合并的OLSR和有限元模型，我们将利用从<a class="ae lb" rel="noopener" target="_blank" href="/how-to-build-a-pooled-ols-regression-model-for-panel-data-sets-a78358f9c2a">相应的</a> <a class="ae lb" rel="noopener" target="_blank" href="/understanding-the-fixed-effects-regression-model-d2fccc2cc27e">文章</a>中获得的这些模型的结果。</p><h2 id="18f1" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">系数比较</h2><p id="5fcf" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">我们发现三种模型估计的GCF_GWTH_PCNT回归变量的系数大致相同:</p><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi py"><img src="../Images/c0bd51b544c17cb1dc843d6edf23db83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iIFEUXOAR52FDbMRi1oJbA.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">GCF_GWTH_PCNT的系数(图片由作者提供)</p></figure><h2 id="fae3" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">拟合优度度量的比较</h2><figure class="mo mp mq mr gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi pz"><img src="../Images/7820405b8596de0933dafa9c90c0a988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NqitdhKgST_mOV3xrACj_g.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">混合OLSR、固定效应和随机效应模型的拟合优度比较(图片由作者提供)</p></figure><p id="5d81" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到，在固定效应模型中，调整后的R平方(在考虑了由于包含回归变量而导致的自由度减少后的R平方)比混合OLSR模型从0.619略微提高到0.639，而随机效应模型在调整R平方方面几乎没有比混合OLSR模型提高。</p><p id="cbd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">FE模型还产生了对数似然性从-300.29到-292.91的小幅增加，以及AIC评分从604.6到601.8的相应小幅改善(降低)。与有限元模型相比，RE模型进一步提高了AIC得分，达到597.1。</p><p id="f047" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以看出，有限元模型在拟合优度方面总体上优于混合模型(尽管差距很小)，而随机模型的性能却并非如此。误差项方差中随机效应的微小贡献(4%)以及LM检验确定的其不显著性进一步证明了这一点。</p></div><div class="ab cl pd pe hu pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="ij ik il im in"><p id="0a0e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是本文中使用的完整源代码:</p><figure class="mo mp mq mr gt ms"><div class="bz fp l di"><div class="qa qb l"/></div></figure></div><div class="ab cl pd pe hu pf" role="separator"><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi pj"/><span class="pg bw bk ph pi"/></div><div class="ij ik il im in"><h1 id="a7e6" class="lq lr iq bd ls lt pk lv lw lx pl lz ma jw pm jx mc jz pn ka me kc po kd mg mh bi translated">参考文献、引文和版权</h1><h2 id="cb4c" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">数据集</h2><p id="d792" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated"><a class="ae lb" href="https://databank.worldbank.org/metadataglossary/world-development-indicators/series" rel="noopener ugc nofollow" target="_blank">世界发展指标</a>数据来自世界银行<a class="ae lb" href="https://www.worldbank.org/en/about/legal/terms-of-use-for-datasets" rel="noopener ugc nofollow" target="_blank"> CC BY 4.0 license </a>。<a class="ae lb" href="https://gist.github.com/sachinsdate/c40651e9e4bc13a696780462209f1992" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">下载链接</strong> </a></p><h2 id="f215" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">纸质和图书链接</h2><p id="f968" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">以下两本书基本上涵盖了面板数据分析领域，大多数从业者无需进一步研究:</p><p id="5d6a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">巴蒂·h·巴尔塔吉，<a class="ae lb" href="https://link.springer.com/book/10.1007/978-3-030-53953-5" rel="noopener ugc nofollow" target="_blank"> <em class="nd">面板数据的计量经济分析</em> </a>，第6版，<em class="nd">施普林格</em></p><p id="3656" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">威廉·h·格林，<a class="ae lb" href="https://www.pearson.com/us/higher-education/program/Greene-Econometric-Analysis-8th-Edition/PGM334862.html" rel="noopener ugc nofollow" target="_blank"> <em class="nd">计量经济分析</em> </a>，第8版<em class="nd">，</em> 2018，<em class="nd">培生</em></p><p id="eede" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您是Stata用户，您可能会发现以下来自Hun Myoung Park的领域介绍和教程非常有用:<em class="nd"> </em> <a class="ae lb" href="https://www.iuj.ac.jp/faculty/kucc625/method/panel/panel_iuj.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="nd">面板数据建模实用指南:使用Stata的逐步分析</em> </a></p><h2 id="8b71" class="nj lr iq bd ls nv nw dn lw nx ny dp ma ko nz oa mc ks ob oc me kw od oe mg of bi translated">形象</h2><p id="9273" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">本文中的所有图片版权归<a class="ae lb" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener ugc nofollow" target="_blank"> CC-BY-NC-SA </a>所有，除非图片下面提到了不同的来源和版权。</p></div></div>    
</body>
</html>