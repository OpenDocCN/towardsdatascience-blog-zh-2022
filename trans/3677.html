<html>
<head>
<title>How I build a Real-time BigQuery Pipeline for Cost Saving and Capacity Planning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建实时BigQuery管道以节省成本和规划容量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-build-a-real-time-bigquery-pipeline-for-cost-saving-and-capacity-planning-15712c97f058#2022-08-16">https://towardsdatascience.com/how-i-build-a-real-time-bigquery-pipeline-for-cost-saving-and-capacity-planning-15712c97f058#2022-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="46fa" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">BigQuery中的成本和资源管理</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7df6f69a13dbb82e93998a7c7a22bcd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*addSXvxgby0QWsfy"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">摩根·豪斯尔在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="20b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> C </span>当数据工程师使用基于云的大数据堆栈时，成本和资源控制是一个重要问题。如果没有这方面的知识，您可能很容易面临极高的云服务账单，或者收到组织对缓慢环境的投诉。除了包含节省成本的技巧和诀窍的备忘单之外，另一个最佳实践是实施监控和警报，以实现以下目标:</p><ul class=""><li id="dcb9" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">发现组织中任何人执行的昂贵/繁重的查询。数据仓库可以在整个组织中共享，包括那些不一定理解SQL但仍然试图寻找信息的人。一个警告是警告他们低质量的查询，数据工程师可以帮助他们良好的SQL实践。</li><li id="60b0" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">在早期阶段发现昂贵/繁重的预定查询。如果一个预定的查询是非常昂贵的，这将是有风险的。有适当的警报可以防止月底的高额账单。</li><li id="a7f3" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">了解资源利用率，更好地进行容量规划。</li></ul><p id="40ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个云提供商都有不同的规则，在本文中，我们将重点关注BigQuery。我将讨论如何评估查询作业以及如何在GCP建立实时警报系统。无论你是管理资源的工程师还是收到账单的经理，这都是适合你的文章！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="414c" class="mz na it bd nb nc nd dn ne nf ng dp nh li ni nj nk lm nl nm nn lq no np nq nr bi translated">三个维度—成本、时段、持续时间</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/719d81985e47d1fac448c8c7e8dcb9b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*m0D4Nai5hI0Bxrsc_zSnIw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">BQ查询的3个维度</p></figure><p id="707b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从三个角度评估查询——成本、时段和持续时间。</p><p id="24a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="nt">成本</em> </strong></p><p id="c90e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数组织，尤其是初创公司，都在节约成本上下了很大功夫。相信我，这本身就是一个有趣的话题。每次我通过优化查询来省钱时，我都会超级兴奋，就好像我从谷歌赚了钱一样。如果查询是一个预定的查询，好处甚至会被放大。值得注意的是，BigQuery提供了2个<a class="ae ky" href="https://cloud.google.com/bigquery/pricing#flat-rate_pricing" rel="noopener ugc nofollow" target="_blank">定价模型</a>不同的成本节约策略。Google有一篇<a class="ae ky" href="https://cloud.google.com/blog/products/data-analytics/choosing-bigquery-pricing" rel="noopener ugc nofollow" target="_blank">文章</a>可以帮助你选择定价模式。</p><p id="2dc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://cloud.google.com/bigquery/pricing#on_demand_pricing" rel="noopener ugc nofollow" target="_blank">按需定价</a>:你为每个查询处理的字节数付费(每TB 5美元)。您可以通过减少查询处理的字节数来直接降低成本。<strong class="lb iu">成本监控和警报对于按需定价模型非常重要，因为技术上没有成本上限。</strong></p><p id="71f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按需定价适用于数据量可预测的工作负载(例如报告工作负载)。这里有一些示例警报规则，用于查找昂贵的计划作业和不可预测的昂贵的临时请求。<strong class="lb iu">如果临时请求的成本太高，您可能希望将临时请求转移到具有统一费率定价的项目中。</strong></p><ul class=""><li id="d9dc" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated">&gt; X美元/查询</li><li id="ce12" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">&gt; X美元/用户/天</li><li id="0e50" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">&gt; X美元/工作/天</li><li id="2782" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi translated">&gt; X美元(特别/月)</li><li id="d345" class="me mf it lb b lc mn lf mo li mp lm mq lq mr lu mj mk ml mm bi">…..</li></ul><p id="334b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://cloud.google.com/bigquery/pricing#flat-rate_pricing" rel="noopener ugc nofollow" target="_blank">统一价格</a>:您需要为专用的查询处理能力付费，以槽位为单位(2000美元/月/100个槽位)。这里监控成本不太重要，因为每个月都是一样的。但是您可以通过使用更少的槽来提高查询的运行效率，从而降低成本。在这种情况下，监控您的插槽使用情况更有意义。</p><p id="eddc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">统一费率定价适用于具有SLA或临时请求的工作负载，这些工作负载需要成本可预测性和容量保证。通过<a class="ae ky" href="https://cloud.google.com/bigquery/docs/reservations-intro" rel="noopener ugc nofollow" target="_blank"> BigQuery Reservations </a>，可以在组织之间共享插槽。例如，具有高服务级别协议的项目a保留1000个时隙，具有临时请求的项目b保留300个时隙。如果目前没有太多的特别请求，projectA可以从projectB借用插槽，反之亦然。但是当projectA运行时，BigQuery会自动且无中断地抢占已经与其他项目共享的槽。并且您不关心临时请求扫描了多少数据。</p><p id="8846" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">资源—时间段和持续时间</strong></p><p id="1c76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论您选择哪种定价模式，插槽数量都将是固定的。(2K用于按需定价模式，X用于统一费率定价，具体取决于您购买的插槽数量)。那么什么是插槽，为什么我们需要监控它呢？</p><blockquote class="nu nv nw"><p id="686a" class="kz la nt lb b lc ld ju le lf lg jx lh nx lj lk ll ny ln lo lp nz lr ls lt lu im bi translated">BigQuery <a class="ae ky" href="https://cloud.google.com/bigquery/docs/slots" rel="noopener ugc nofollow" target="_blank">槽</a>是BigQuery用来执行SQL查询的虚拟CPU。BigQuery根据查询的大小和复杂程度，自动计算每个查询需要多少个槽。</p></blockquote><p id="f758" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果同时运行太多复杂的查询，查询需求将超过您承诺的槽。BigQuery不会对额外的槽收费，但是您的单个工作单元会排队。您可以在查询作业的<a class="ae ky" href="https://cloud.google.com/bigquery/docs/query-plan-explanation" rel="noopener ugc nofollow" target="_blank">执行细节</a>中找到它们的性能。每个作业都分为几个阶段:等待、读取、计算和写入。等待阶段的高峰时间意味着BigQuery可能会耗尽存储槽。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/4a3ae837abbc75c24a73ade7aa0e7e4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZNrIhKcQjvQiVFpS.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://cloud.google.com/bigquery/docs/query-plan-explanation" rel="noopener ugc nofollow" target="_blank"> BQ作业执行详情</a></p></figure><p id="31f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">容量规划需要监控插槽使用情况。<strong class="lb iu">如果你看到太多的查询在排队，你可能会想改变你的定价模式，或者购买更多的插槽，或者考虑如何让你的查询更有效。</strong>值得从BigQuery查看<a class="ae ky" href="https://cloud.google.com/bigquery/docs/best-practices-performance-compute" rel="noopener ugc nofollow" target="_blank">优化查询计算</a>页面。</p><p id="8ff9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好，我们知道什么是插槽。但是我们应该如何设置警报规则呢？我们可以从简单的东西开始—基于插槽容量的硬编码值。假设我们固定了1000个插槽。如果一个查询使用超过500个槽，那么它肯定是一个危险信号，需要进一步调查。</p><p id="836d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这可能会导致许多误报，因为我们需要另一个维度:<strong class="lb iu">时间。</strong>如果一个查询平均使用600个槽，但是只运行了10秒，我们要不要报警？而vice visa，如果一个查询运行30分钟却平均只用了50个槽呢？</p><p id="47f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这完全取决于你的团队的SRE战略。我推荐<a class="ae ky" href="https://sre.google/books/" rel="noopener ugc nofollow" target="_blank">谷歌SRE图书</a>学习SRE原则和最佳实践。经验法则是<strong class="lb iu">警报应该是可操作的。</strong></p><p id="9882" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个图中，我可视化了3个查询及其时间/时隙使用情况。绿色查询使用了很多槽，但是运行速度很快。黄色查询需要很长时间，但只使用了几个时间段。红色查询介于两者之间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/11b365e5aeb75c46913fbd013ddf6884.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*DgrF_M1IDwVyuMMWwvLIBQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有不同资源使用的查询(由<a class="oc od ep" href="https://medium.com/u/2adc5a07e772?source=post_page-----15712c97f058--------------------------------" rel="noopener" target="_blank">高</a>创建)</p></figure><p id="25b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">比方说，我的警报策略是找出占用太多空间太长时间的查询，因为它们可能会妨碍关键工作负载。找到阈值的一个技巧是对历史作业及其时间和插槽信息有一个整体的了解(我将在下一节讲述如何做到这一点)。在下面的例子中，我的阈值是(持续时间&gt; 30分钟，时间段&gt; 500)。一个保守的团队也可能会考虑黄区。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/a2896f7faa5b8321b842a06ff59349ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CZmdYkMmGwBW5iDzpaaZNg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">BQ资源阈值(由<a class="oc od ep" href="https://medium.com/u/2adc5a07e772?source=post_page-----15712c97f058--------------------------------" rel="noopener" target="_blank">高</a>创建)</p></figure><p id="5b91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看阈值的另一个方法是使用查询的<em class="nt">区域，</em>，即<em class="nt"> totalSlotMs=duration*slot。</em>这是查询在其整个执行时间内消耗的槽总数，以毫秒为单位。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/33a55af8499c689d929eee3c467d06f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*4SnG2kPvpXCvG2kYhtfPWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于totalSlotMs的BQ资源阈值(由<a class="oc od ep" href="https://medium.com/u/2adc5a07e772?source=post_page-----15712c97f058--------------------------------" rel="noopener" target="_blank">高</a>创建)</p></figure><p id="c0e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好吧！我们已经学习了如何从三个不同的维度衡量一个查询，以及如何定义阈值。接下来，我们将看到如何从BigQuery中检索信息。</p><h2 id="f053" class="mz na it bd nb nc nd dn ne nf ng dp nh li ni nj nk lm nl nm nn lq no np nq nr bi translated">监控BigQuery作业的实时管道</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/2064db2b72ee1884c2fc173ac0397167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hEG3gl1dmgguRSph8BPGpg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">接收BQ警报的实时系统(由<a class="oc od ep" href="https://medium.com/u/2adc5a07e772?source=post_page-----15712c97f058--------------------------------" rel="noopener" target="_blank">高</a>创建)</p></figure><p id="47ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">BigQuery为监控查询提供了不同的选项，例如通过<a class="ae ky" href="https://cloud.google.com/bigquery/docs/information-schema-intro" rel="noopener ugc nofollow" target="_blank"> INFORMATION_SCHEMA </a>或<a class="ae ky" href="https://cloud.google.com/bigquery/docs/admin-resource-charts" rel="noopener ugc nofollow" target="_blank"> BigQuery监控图表</a>。本文关注的是<a class="ae ky" href="https://cloud.google.com/bigquery/docs/reference/auditlogs/" rel="noopener ugc nofollow" target="_blank"> BigQuery审计日志</a>，它是实时管道的最佳数据源。流水线包含3个阶段。</p><p id="f073" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> LogsRouter —将BigQuery数据访问日志路由到PubSub </strong></p><p id="54d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">云审计日志是一个日志集合，提供对与您使用包括BigQuery在内的GCP服务相关的运营问题的洞察。每个数据访问作业都流入审计日志。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/46295b09903a1b39e4fbd1a3cff0a420.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_XvDamO8ndTmQ_H0XfG7w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">BigQuery数据访问日志示例(由<a class="oc od ep" href="https://medium.com/u/2adc5a07e772?source=post_page-----15712c97f058--------------------------------" rel="noopener" target="_blank">高</a>创建)</p></figure><p id="745f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以通过<a class="ae ky" href="https://cloud.google.com/logging/docs/export/configure_export_v2" rel="noopener ugc nofollow" target="_blank">接收器</a>将日志路由到不同的<a class="ae ky" href="https://cloud.google.com/logging/docs/export/configure_export_v2#supported-destinations" rel="noopener ugc nofollow" target="_blank">目的地</a>，比如云存储、发布/订阅和大查询。其中，发布/订阅是最好的选择，因为它天生适合实时用例。在接收器中，您可以包含一个与您想要包含的日志条目相匹配的过滤器。否则，发布/订阅主题将被不相关的消息过载。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">接收器过滤器示例</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/ccb3586220a5c6a2e81a2297d5290cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M70SuRB94oFwyRvmYw4t9g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">接收器过滤器示例</p></figure><p id="23c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> PubSub—将日志路由到云函数进行处理</strong></p><p id="a25d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PubSub本质上是一个队列。我们需要像cloud function这样的订阅者来消费日志并处理它们。创建主题后，可以点击“触发云函数”按钮，用任何编程语言创建云函数。这多容易啊！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/d810329aeef2babc885ea4a28b067967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z4xLvy2zWqu4MqmJEBTq0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建云功能的按钮</p></figure><p id="93f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">云功能—处理日志并发送警报</strong></p><p id="f1fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个过滤后的日志都会触发一个云函数，日志以JSON格式呈现，如上例所示。您可以在这里查看最新的审计日志模式<a class="ae ky" href="https://cloud.google.com/logging/docs/reference/audit/bigquery/rest/Shared.Types/AuditData" rel="noopener ugc nofollow" target="_blank"/>。我们将利用<code class="fe ol om on oo b">JobStatistics</code>部分进行警报。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/e0045a72b65200753b3afd68fc2da622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*thQdibmS4gt0vAideVZ1KA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作业统计示例</p></figure><p id="607a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一段解析BigQuery审计日志的示例代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">解析BigQuery审计日志的示例代码(由<a class="oc od ep" href="https://medium.com/u/2adc5a07e772?source=post_page-----15712c97f058--------------------------------" rel="noopener" target="_blank">高</a>创建)</p></figure><p id="36d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据阈值，警报区域中的作业将被发送到您在团队中拥有的任何通信渠道。在我的团队中，我们使用<a class="ae ky" href="https://sentry.io/welcome/" rel="noopener ugc nofollow" target="_blank"> Sentry </a>作为集中的问题跟踪和监控平台。每个有问题的作业都被发送给Sentry，然后Sentry会以更好的格式发送给Slack。这是我们最终的结果！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/bbde3c58e581beac3f73e885a11ce011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NjSGW9zU-hAR_FmPWruwkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过哨兵(由<a class="oc od ep" href="https://medium.com/u/2adc5a07e772?source=post_page-----15712c97f058--------------------------------" rel="noopener" target="_blank">高</a>创建)在空闲时收到的示例警报</p></figure><h2 id="bc1d" class="mz na it bd nb nc nd dn ne nf ng dp nh li ni nj nk lm nl nm nn lq no np nq nr bi translated">结论</h2><p id="e4c0" class="pw-post-body-paragraph kz la it lb b lc or ju le lf os jx lh li ot lk ll lm ou lo lp lq ov ls lt lu im bi translated">一如既往，我希望这篇文章对你有用，并能给你启发。一旦有了合适的基础设施，您就有很大的空间来尝试不同的监控和警报策略。干杯！</p><h2 id="0db2" class="mz na it bd nb nc nd dn ne nf ng dp nh li ni nj nk lm nl nm nn lq no np nq nr bi translated">参考</h2><div class="ow ox gp gr oy oz"><a href="https://cloud.google.com/blog/products/data-analytics/bigquery-audit-logs-pipelines-analysis" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd iu gy z fp pe fr fs pf fu fw is bi translated">BigQuery审计日志管道和分析|谷歌云博客</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">使用BigQuery审计日志对各种角色的BigQuery生成的日志事件进行深入监控和分析…</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">cloud.google.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ks oz"/></div></div></a></div></div></div>    
</body>
</html>