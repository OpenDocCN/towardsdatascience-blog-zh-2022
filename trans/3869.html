<html>
<head>
<title>5 Ways to use a Seaborn Heatmap (Python Tutorial)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Seaborn热图的5种方法(Python教程)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-ways-to-use-a-seaborn-heatmap-python-tutorial-c79950f5add3#2022-08-29">https://towardsdatascience.com/5-ways-to-use-a-seaborn-heatmap-python-tutorial-c79950f5add3#2022-08-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="824c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用热图显示混乱矩阵、时间序列变化、温度变化、相关矩阵和SHAP相互作用值</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ede5888a6451487bceef9b5bef25f4a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B8m3aVg6TDlPQKGVRqqKRQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(来源:<a class="ae ky" href="https://www.flaticon.com/free-icon/statistics_2920323" rel="noopener ugc nofollow" target="_blank"> flaticon </a>)</p></figure><p id="7a2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">热图可以让您的数据栩栩如生。百搭又抢眼。在许多情况下，它们可以突出显示数据中的重要关系。具体来说，我们将讨论如何使用它们来观想:</p><ul class=""><li id="6fcf" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">用于模型准确性的<strong class="lb iu">混淆矩阵</strong></li><li id="4bec" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">显示组间<strong class="lb iu">运动的时序数据</strong></li><li id="b025" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">显示<strong class="lb iu">温度变化的时间序列数据</strong></li><li id="3a5d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">一个<strong class="lb iu">相关矩阵</strong></li><li id="9af4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">平均值<strong class="lb iu"> SHAP相互作用值</strong></li></ul><p id="3378" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此过程中，您将了解到定制热图的不同方法。我们将讨论创建它们的代码，你可以在<a class="ae ky" href="https://github.com/conorosully/medium-articles/blob/master/src/seaborn_heatmap.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到完整的项目。</p><p id="682f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，您可以观看此视频进行概述:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><h1 id="9a77" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">什么是热图？</h1><p id="2df9" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">让我们从讨论什么是热图以及为什么它们如此有用开始。你可以在<strong class="lb iu">图1 </strong>中看到一个例子。y轴上是变量1。在这种情况下，变量1可以采用不同的4个值。即“V1-1”是变量1的第一个值。类似地，我们在y轴上有变量2。还有第三个变量。这是每个单元格内的值。每个单元格的颜色由该变量的值决定。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/0b3f89b1b6894cf323fce72af2d79ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5rXFpjSndFsmCKjYiN2GNw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:示例热图(来源:作者)</p></figure><p id="6b66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，使用热图，我们能够可视化2D平面上3个变量之间的关系。这些关系可能很复杂。这就是使用颜色的原因。它可以突出关系的重要方面，使它们更容易理解。</p><p id="91e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们应该记住，热图仍然是有限的。变量1和变量2需要是<strong class="lb iu">离散的</strong>或<strong class="lb iu">分类的</strong>。或者，如果它们是连续的，我们需要能够将它们分组。另一方面，变量3需要是一个<strong class="lb iu">连续的</strong>变量。希望在我们讨论下面的5个热图时，这一点会很清楚。</p><h1 id="7844" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">1)混淆矩阵</h1><p id="43bf" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们的第一张热图，在图2 中，是混乱矩阵的可视化。这来自于一个用来预测一段文字语言的模型。y轴给出了文本的实际语言。x轴给出了模型预测的语言。对角线上的数字给出了正确预测的次数。非对角线给出了错误预测的数量。例如，英语(eng)被错误地预测为德语(deu) 11次。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/6053db070436431e607c86ce7aacc94e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c5rYPcg3NwEblZqhPrapAA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:相关矩阵(来源:作者)</p></figure><p id="d31b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你的目标变量有很多类时，像这样可视化一个混乱矩阵是很有用的。它可以突出模型哪里出了问题。例如，我们看到该模型最常混淆葡萄牙语(por)和西班牙语(spa) (124次)或西班牙语和葡萄牙语(84次)。这是有道理的，因为在所有的语言中，这两种语言在词汇上是最相似的。</p><h2 id="3d34" class="nj mm it bd mn nk nl dn mr nm nn dp mv li no np mx lm nq nr mz lq ns nt nb nu bi translated">热图代码</h2><p id="a512" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">要创建此热图，我们首先要导入下面的包。热图函数来自seaborn包(第6行)。我们将对所有5个热图使用相同的包。确保您已经安装了它们。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="e440" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一个2D阵列用于填充下面的热图。这些给出了正确和错误预测的数量。您可以看到第一个子阵列(第2行)对应于<strong class="lb iu">图2 </strong>中热图第一行的值。所有热图都是使用类似于此图的2D阵列填充的。如果您需要将此代码用于另一个热图，您可以用您的2D阵列替换此混淆矩阵。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="0f6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们已经对2D数组进行了硬编码。下面的文章将带你了解我们是如何得到这些数字的。总而言之，我们已经使用NLP技术建立了一个神经网络。然后，我们使用这个模型来预测测试数据集中的文本语言。你在上面看到的数字来自这些预测。</p><div class="nw nx gp gr ny nz"><a rel="noopener follow" target="_blank" href="/deep-neural-network-language-identification-ae1c158f6a7d"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">深度神经网络语言识别</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">使用DNN和字符三元组对一段文本的语言进行分类</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div><p id="3c6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这个2D数组，我们创建一个熊猫数据帧(<strong class="lb iu"> <em class="oo"> conf_matrix_df </em> </strong>)。我们使用不同的语言作为列名和行名。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="f985" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们使用seaborn heatmap函数(第5–9行)来可视化这个数据帧。除了<strong class="lb iu"> <em class="oo"> conf_matrix_df，</em> </strong>我们还传递了几个参数。<strong class="lb iu"> <em class="oo"> cmap </em> </strong>给出配色方案。将此设置为“冷温”会为我们提供红色和蓝色单元格。将<strong class="lb iu"> <em class="oo">不能</em> </strong>设置为true会给出每个单元格中的数字。没有它，我们就只有颜色。<strong class="lb iu"> <em class="oo"> fmt </em> </strong>定义了颜色的格式。在创建其他热图时，我们将看到这些参数的一些变化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="2752" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一个参数是<strong class="lb iu">T23】VMAX。</strong>这定义了色标的最大值。如果您没有为此参数传递值，它将默认为热图中的最大值。在这种情况下，它是正确的法语(fra)预测数(即4999)。我们将该值设置为200，因为这样更容易区分不正确的预测。你可以在<strong class="lb iu">图3 </strong>中看到我们的意思。此热图是使用<strong class="lb iu"> <em class="oo"> vmax </em> </strong>的默认值创建的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/357502878335afe490780f6cf8506451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IKklPpJZn_ne5R8ilAE3eg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3:没有vmax的关联矩阵(来源:作者)</p></figure><h1 id="a871" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">2)群体间的运动</h1><p id="875b" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们的第二张热图展示了我们如何可视化分类变量随时间的变化。具体来说，我们显示了美国城市的空气质量指数(AQI)。y轴表示2010年的空气质量指数水平，x轴表示2016年的水平。单元格值给出了从一个级别移动到另一个级别的城市的数量。例如，我们可以看到20个城市从不健康(敏感人群)水平改善到中等水平。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/2fd645faf22ba5051f14b5f34d5912bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fWr-l7NvsNCgpGuZd1y-2A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4:一段时间内的空气质量指数水平(来源:作者)</p></figure><p id="0bc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AQI是0到500之间的值。数值越高，空气污染程度越高。空气质量指数是使用4种不同的污染物计算的——二氧化氮(NO2)、二氧化硫(SO2)、一氧化碳(CO)和臭氧(O3)。具体来说，为了得到最终的空气质量指数，我们取这4种污染物的最大空气质量指数。在<strong class="lb iu">图5 </strong>中，您可以看到不同关注级别的AQI范围。我们在热图中使用了这些级别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/df13f7683f80cb63ff5a15b49b9b0a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*sUlcaCf5F-E7EaDqAVD4DQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:空气质量指数水平(来源:<a class="ae ky" href="https://www.airnow.gov/aqi/aqi-basics/" rel="noopener ugc nofollow" target="_blank"> AirNow </a></p></figure><p id="ce2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建热图，我们首先加载数据集(第2行)。你可以在<a class="ae ky" href="https://www.kaggle.com/datasets/sogun3/uspollution" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上找到这个数据集。每天都有读数。我们只对阅读的年份感兴趣。因此，我们创建了一个包含阅读年份的列(第5–6行)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="78fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个x轴和y轴上的变量最初是连续变量的例子。如前所述，我们需要对这个变量进行分组。下面的<strong class="lb iu"> <em class="oo"> aqiGroup </em> </strong>函数就是用来做这个的。它将根据AQI值返回一个级别。它使用与图5 中<strong class="lb iu">相同的范围。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="17eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了得到最终的2D矩阵，我们需要做一些数据处理。我们首先使用4种污染物的值计算AQI值(第2行)。然后对于每个城市，我们计算每一年的最大AQI(第5行)。因此，您在热图中看到的数值实际上是基于2010年和2016年的最大AQI值。最后，我们使用<strong class="lb iu"> <em class="oo"> aqiGroup </em> </strong>函数对AQI值进行分组(第8行)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="a2c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到了2016年(第2-3行)和2010年(第6-7行)的所有AQI值。然后我们连接这些表(第10行)。在某些情况下，一个城市可能一年有一个读数，而另一年没有。在这种情况下，我们用“无读数”替换丢失的值(第11行)。这个最终数据集<strong class="lb iu"> AQI </strong>将包含每个城市在2016年和2010年的水平。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="09dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，现在我们有了这个数据集，我们可以用它来创建2D数组，<strong class="lb iu"> <em class="oo"> hm_array </em> </strong>。这用于填充热图。这将与我们在第一个热图中看到的硬编码阵列具有相同的结构。该数组是在第6到12行创建的。其中，对于每个级别组合，我们计算<strong class="lb iu"> <em class="oo"> AQI </em> </strong>数据集中的记录数(第10-11行)。和以前一样，我们使用这个2D数组创建一个数据帧。我们使用AQI级别作为列名和行名。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="d41f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们像以前一样创建热图。这次我们有不同的参数值。我们使用了不同的配色方案，<strong class="lb iu"> <em class="oo"> cmap </em> </strong>。我们已经将<strong class="lb iu"> <em class="oo"> cbar </em> </strong>设置为false。这隐藏了颜色栏。我们还使用了<strong class="lb iu"> <em class="oo">线宽</em> </strong>和<strong class="lb iu"> <em class="oo">线条颜色</em> </strong>参数来给出热图的黑色网格线。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><h1 id="91e4" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">3)温度随时间变化</h1><p id="2b04" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">类似于上一个热图，我们用这个来可视化时间序列数据。除了现在，我们展示了一个连续变量是如何随时间变化的。在<strong class="lb iu">图4 </strong>中，您可以看到一段时间内的全球平均气温。从1900年到2016年每个月都有读数。在接下来的几个月里，你可以清楚地看到气候变化的影响。也许我们对“热图”这个术语的理解有点过于字面化了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/01eb0fd0ef3bccfa02b2e97c3cb5442a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g-oufizLZBf3GmT2TBdwjw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:一段时间内的平均温度(来源:作者)</p></figure><p id="a0b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从加载数据集开始(第1行)。你可以在[数据中心]找到这个。数据集包含两个不同的温度读数来源。我们只选择GISTEMP读数(第4行)。然后我们为每个读数创建一个年和月的列(第7-9行)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="5b12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与之前一样，我们创建了一个用于填充热图的2D阵列。在之前的热图中，所有2D阵列都是对称的。情况并不总是如此。对于此热图，每个月都有一个子阵列(即1到12)。这些子数组中的每一个都将包含从1900年到2016年每年的温度值。所以我们现在有一个12x117的阵列。我们用年份作为列名，用月份作为行名来创建一个数据帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="5031" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们像以前一样想象这个数据帧。最大的不同是我们将<strong class="lb iu">x<em class="oo">tick labels</em>T29】参数设置为10。这意味着只显示x轴上的第10个标签。您可以在图6 </strong>的<strong class="lb iu">中看到这一点，其中只有1900、1910、1920等的标签..被显示。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><h1 id="42c4" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">4)相关矩阵</h1><p id="0510" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们的第四张热图可能你已经看过了。一个常见的用途是可视化数据集中的相关性。例如，我们在<strong class="lb iu">图7 </strong>中有一个房价数据集的相关矩阵。我们可以利用这一点来确定任何可能在我们的模型中引起问题的多重共线性。例如，X3和X4呈负相关。最后一行还给出与目标变量y的相关性。我们可以利用这一点来了解是否有任何特征与y有显著关系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/82be896c57f944860cb37e168ccf1621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqCr3SVdMltUX_rVEFtr0w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:相关矩阵(来源:作者)</p></figure><p id="a40a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建这个热图，我们首先加载数据集(第2行)。你可以在UCI的<a class="ae ky" href="http://archive.ics.uci.edu/ml/datasets/Real+estate+valuation+data+set" rel="noopener ugc nofollow" target="_blank">机器学习知识库</a>中找到它。使用这个数据集，我们创建一个相关矩阵(第5行)。结果将是一个熊猫的数据框架。列名和行名将与数据集中的要素名相同。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="fab7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能已经注意到，在<strong class="lb iu">图7 </strong>中，对角线上方的单元格是空白的。为此，我们首先需要创建一个遮罩。这是一个2D阵列，类似于我们用来填充以前的热图的阵列。对于要显示的单元格，数组的值应为“True”。否则，对于空白单元格，它们应该为“False”。我们使用下面的代码来创建遮罩。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><p id="d52f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以显示我们的热图。这一个的唯一区别是我们需要将掩码作为参数传递(第8行)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv mk l"/></div></figure><h1 id="5865" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">5) SHAP互动价值观</h1><p id="edb5" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们最后的热图可用于突出显示对模型预测很重要的特征。它是通过取平均SHAP相互作用值产生的。它在对角线上显示了平均主效应。比如我们可以看到，对于体验、学位、性能、销量，主效应大。类似地，平均相互作用效应在非对角线上。我们可以看到，体验、程度和绩效、销售互动的影响是显著的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/8a5f962721881931a6e0970ab2fcdf16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQB-lS3wq-743azbjv7hKQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8:平均SHAP互动值(来源:作者)</p></figure><p id="bcfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们不会讨论用于创建该热图的代码。如果你感兴趣，你可以在下面的文章中找到它。我们深入研究SHAP互动价值观。我们还使用这些值创建和解释其他图。这些用来解释你的机器学习模型。</p><div class="nw nx gp gr ny nz"><a rel="noopener follow" target="_blank" href="/analysing-interactions-with-shap-8c4a2bc11c2a"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">分析与SHAP的互动</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">使用SHAP Python包来识别和可视化数据中的交互</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="os l ok ol om oi on ks nz"/></div></div></a></div></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><p id="4118" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对你有帮助！如果你想看更多，你可以成为我的<a class="ae ky" href="https://conorosullyds.medium.com/membership" rel="noopener"> <strong class="lb iu">推荐会员</strong> </a> <strong class="lb iu">来支持我。你可以访问medium上的所有文章，我可以得到你的部分费用。</strong></p><div class="nw nx gp gr ny nz"><a href="https://conorosullyds.medium.com/membership" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">通过我的推荐链接加入Medium康纳·奥沙利文</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">conorosullyds.medium.com</p></div></div><div class="oi l"><div class="pa l ok ol om oi on ks nz"/></div></div></a></div><p id="ec0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在|<a class="ae ky" href="https://twitter.com/conorosullyDS" rel="noopener ugc nofollow" target="_blank">Twitter</a>|<a class="ae ky" href="https://www.youtube.com/channel/UChsoWqJbEjBwrn00Zvghi4w" rel="noopener ugc nofollow" target="_blank">YouTube</a>|<a class="ae ky" href="https://mailchi.mp/aa82a5ce1dc0/signup" rel="noopener ugc nofollow" target="_blank">时事通讯</a>上找到我——注册免费参加<a class="ae ky" href="https://adataodyssey.com/courses/shap-with-python/" rel="noopener ugc nofollow" target="_blank"> Python SHAP课程</a></p><h2 id="1378" class="nj mm it bd mn nk nl dn mr nm nn dp mv li no np mx lm nq nr mz lq ns nt nb nu bi translated">图像来源</h2><p id="4c46" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">所有图片都是我自己的或从<a class="ae ky" href="http://www.flaticon.com/" rel="noopener ugc nofollow" target="_blank">www.flaticon.com</a>获得。在后者的情况下，我拥有他们的<a class="ae ky" href="https://support.flaticon.com/hc/en-us/articles/202798201-What-are-Flaticon-Premium-licenses-" rel="noopener ugc nofollow" target="_blank">保费计划</a>中定义的“完全许可”。</p><h2 id="5cb2" class="nj mm it bd mn nk nl dn mr nm nn dp mv li no np mx lm nq nr mz lq ns nt nb nu bi translated">数据集源</h2><p id="8487" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated"><strong class="lb iu">热图2，</strong>来源:<strong class="lb iu"> </strong> <a class="ae ky" href="https://www.kaggle.com/datasets/sogun3/uspollution" rel="noopener ugc nofollow" target="_blank">美国污染数据</a>，许可证:开放数据库许可证(ODbL) 1.0</p><p id="fab6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">热图3 </strong>，来源:<a class="ae ky" href="https://datahub.io/core/global-temp" rel="noopener ugc nofollow" target="_blank">全球气温时间序列</a>，牌照:ODC-PDDL-1.0</p><p id="4eb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">热图4 </strong>，来源:<a class="ae ky" href="http://archive.ics.uci.edu/ml/datasets/Real+estate+valuation+data+set" rel="noopener ugc nofollow" target="_blank">房地产估价数据集数据集</a>，牌照:CC0:公共领域</p></div></div>    
</body>
</html>