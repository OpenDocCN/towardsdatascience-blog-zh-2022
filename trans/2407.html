<html>
<head>
<title>How to Write High-Quality Python as a Data Scientist</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">作为数据科学家如何编写高质量的Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-write-high-quality-python-as-a-data-scientist-cde99f582675#2022-05-26">https://towardsdatascience.com/how-to-write-high-quality-python-as-a-data-scientist-cde99f582675#2022-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2e37" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">学习需求技能！</h2><div class=""/><div class=""><h2 id="a461" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">你应该学习的一套具体技能！</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/145f19a7d536d75eca6f5b758d415138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p_7UHVyxrnftSQo3"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="d91a" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">您的旅程概述</h1><ol class=""><li id="3d2b" class="ma mb it mc b md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated"><a class="ae lh" href="#bada" rel="noopener ugc nofollow">为什么高质量的代码很重要</a></li><li id="657e" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated">没有风格，你什么都不是</li><li id="289e" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#7e18" rel="noopener ugc nofollow">变量名——比听起来更难！</a></li><li id="12b0" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#b99c" rel="noopener ugc nofollow">模块化你的代码</a></li><li id="9be5" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#3626" rel="noopener ugc nofollow">设计原则？没听说过！</a></li><li id="e5e8" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#f712" rel="noopener ugc nofollow">代码质量的进一步资源</a></li><li id="9cba" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn mo mp mq mr bi translated"><a class="ae lh" href="#d56d" rel="noopener ugc nofollow">包装</a></li></ol></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="bada" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">1 —为什么高质量的代码很重要</h1><p id="6181" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">当作为一名数据科学家起步时，人们会听到关于代码质量的相互矛盾的故事。有人说代码质量真的很重要。其他人说，数据科学家不是软件工程师，并采用以下口头禅:</p><blockquote class="nw"><p id="166b" class="nx ny it bd nz oa ob oc od oe of mn dk translated">谁在乎呢。如果成功了就成功了，对吧？</p></blockquote><p id="f0c1" class="pw-post-body-paragraph nj nk it mc b md og kd nl mf oh kg nm mh oi no np mj oj nr ns ml ok nu nv mn im bi translated">当面对关心或不关心代码质量的选择时，很容易选择阻力最小的途径。学习编写高质量的代码需要时间和精力。为什么不干脆忽略代码质量，少一件担心的事情呢😌</p><p id="4f45" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">嗯，正如你可能从这篇博文的标题中怀疑的那样，我在这里告诉你数据科学家的<strong class="mc jd">代码质量实际上很重要</strong>。实际上相当多！这里有三种情况，高质量的代码可以节省你无数的时间:</p><ul class=""><li id="3be2" class="ma mb it mc b md ol mf om mh oq mj or ml os mn ot mp mq mr bi translated">如果代码质量不好，错误和可疑的边缘情况很容易被忽视。这导致后来耗时的错误修复，最糟糕的是，生产失败。高质量的代码可以让你尽早失败，快速失败。</li><li id="4353" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated">当新人开始一个项目时，他们必须了解代码库是如何工作的。数据科学和软件工程都是如此。当代码随意编写时，入职流程会变慢。代码的某些部分将是神秘的，除了编写代码的人之外，其他任何人都无法真正理解。甚至对于编写代码的人来说，几个月后这可能会变得毫无意义。高质量的代码是<strong class="mc jd">未来可以理解的</strong>。</li><li id="6844" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated">假设你有一个非常成功的数据科学项目。要求您扩展项目以满足不断增长的需求。通过数据管道的数据量和数据速度将会更高。如果你的代码很糟糕，那么事情可能不像看起来那么简单。当代码具有高质量时，应该可以更顺利地扩展到新的环境。高质量的代码<strong class="mc jd">可以扩展到新的情况</strong>。</li></ul><p id="afc3" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">希望您现在已经确信高质量的代码是有用的。然而，学习编写高质量的代码是一个渐进的过程。你的代码质量在今天和明天之间不会有很大的变化。没关系。如果你努力改进，那么从长远来看，你的劳动成果将会被所有人看到。</p><p id="97df" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">我建议你采取这样的心态:高质量的代码是你引以为豪的东西。几乎每个杰出的作家都为自己的作品感到自豪。同样，作为一名数据科学家，你应该为你的代码感到自豪。它是你创造的东西。它是传递价值的东西。因此，代码应该是高质量的。就这么简单。</p><p id="52bf" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">在这篇博文中，我将向您展示一些用Python编写高质量代码的要点。把博客文章看作一个开始，而不是一幅完整的图画。最后，我会给你一些很酷的资源，它们可以帮助你在编写代码的道路上走得更远🔥</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="6430" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">2 —没有风格你什么都不是</h1><h2 id="a0e3" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">问题是</h2><p id="a290" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">在大多数编程语言中，有许多方法可以解决同一个问题。这鼓励了创造力和解决问题的新方法。但是，也有看似无限的方法来完成以下任务:</p><ul class=""><li id="dec6" class="ma mb it mc b md ol mf om mh oq mj or ml os mn ot mp mq mr bi translated">选择函数定义中的参数之间是否有空格。你应该写一个函数作为<code class="fe pf pg ph pi b">def my_function(a, b)</code>或者<code class="fe pf pg ph pi b">def my_function(a,b)</code>或者<code class="fe pf pg ph pi b">def my_function( a, b )</code>。</li><li id="3a22" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated">函数名应该怎么写？也许就一个字<code class="fe pf pg ph pi b">def myfunction(a, b)</code>？也许在<strong class="mc jd"/><code class="fe pf pg ph pi b">def my_function(a, b)</code>蛇案中？或者也许在<strong class="mc jd">骆驼案</strong>T5？或者也许<strong class="mc jd">帕斯卡-凯斯</strong>T6？</li></ul><p id="47cc" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">对于每一行代码，都有这样的考虑。如果您对所做的选择采取随机行动，您的代码会变得像这样混乱:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="5148" class="ou lj it pi b gy pn po l pp pq">def MyFUNCTION( a,b) :<br/>  return a+b</span></pre><p id="626b" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">呸！那又怎样？你的公司是否应该召开内部会议，让你了解每个案例应该如何处理？听起来非常无聊。</p><h2 id="cc94" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">解决方案</h2><p id="41df" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">不要害怕！在Python中有PEP8。这是官方建议的代码风格约定。关于PEP8的精彩摘要，你可以看看肯尼斯·雷茨的时尚版。</p><p id="2345" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">每个Python开发者都应该(除非你的公司有自己的风格指南)遵守PEP8。这一开始看起来可能有点麻烦。相反，一旦你接受了PEP8作为大多数风格决策的权威，你就可以把精力集中在代码的其他方面。您现在不需要考虑上面代码片段的正确风格版本。正确的格式是:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="1e9d" class="ou lj it pi b gy pn po l pp pq">def my_function(a, b):<br/>    return a + b</span></pre><p id="f4a9" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">仍然有大量的决定留给代码的作者。你应该使用<a class="ae lh" rel="noopener" target="_blank" href="/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1">类型提示</a>来指示参数的数据类型吗？您可能应该编写一个docstring来解释该函数的作用。逻辑怎么实现还是100%看你。你根本不需要花精力去考虑风格的选择。</p><p id="4fcb" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">我建议你花10-15分钟浏览一下<a class="ae lh" href="https://pep8.org/" rel="noopener ugc nofollow" target="_blank"> PEP8风格指南</a>以获得一些改进。当你不确定具体的选择时，你可以查阅PEP8。</p><h2 id="9f86" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">自动代码格式化程序</h2><p id="b848" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">还有像<a class="ae lh" rel="noopener" target="_blank" href="/tired-of-pointless-discussions-on-code-formatting-a-simple-solution-exists-af11ea442bdc"> Black </a>这样的自动代码格式化器，它会自动为你格式化代码。这些太棒了！但是，你要知道，它们是有局限性的。</p><p id="cd22" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">举个例子，PEP8建议用单词<code class="fe pf pg ph pi b">Error</code>结束Python中的一个自定义异常类。因此，表示数据处理错误的类的开头应该写成例如</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="d9e3" class="ou lj it pi b gy pn po l pp pq">class DataProcessingError(Exception):<br/>---</span></pre><p id="f876" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">这是像Black这样的自动格式化程序无法解决的问题。无论如何，使用像Black这样的自动格式化程序。但是一定要记住PEP8的大部分内容。</p><h2 id="b26b" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">但是我不想！</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pr"><img src="../Images/f63006beb2bcb174bd80c04d0ed6e6d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8Sd5S0VBLFbQ_Ab0"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@matthewhenry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马太·亨利</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d987" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">有些读者会认为代码格式和代码风格不重要。如果你真的看不到PEP8的重要性，那么这是完全正确的。要知道，如果你不坚持你的代码，很多人会认为你的代码质量很差。格式糟糕的代码会让人产生期望，就像充满拼写错误的邮件一样。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="7e18" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">3 —变量名—比听起来更难！</h1><p id="be34" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">用Python命名变量、函数、类、模块和包是一项艰苦的工作。事实上，菲尔·卡尔顿有以下名言:</p><blockquote class="nw"><p id="b9a5" class="nx ny it bd nz oa ob oc od oe of mn dk translated">计算机科学只有两个硬东西:缓存失效和事物命名。—菲尔·卡尔顿</p></blockquote><p id="6ee2" class="pw-post-body-paragraph nj nk it mc b md og kd nl mf oh kg nm mh oi no np mj oj nr ns ml ok nu nv mn im bi translated">幸运的是，大多数数据科学家不必处理<a class="ae lh" href="https://en.wikipedia.org/wiki/Cache_invalidation" rel="noopener ugc nofollow" target="_blank">缓存失效</a>。然而，你被事物的命名所困扰。Python包和模块应该有简洁的全小写名称。我们来讨论一下如何给我们的宝贝起个好名字；<em class="ps">变量</em>、<em class="ps">函数</em>和<em class="ps">类</em>。</p><h2 id="5e9e" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">简单的惯例</h2><p id="7449" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">有几个简单的惯例，一个人应该永远遵守。</p><p id="fc58" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">首先，<strong class="mc jd">永远不要</strong>覆盖内置。例如，创建以下变量可能很有吸引力:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="b86d" class="ou lj it pi b gy pn po l pp pq">a = 5<br/>b = 2<br/>min = 0<br/>if a &lt; b:<br/>    min = a<br/>else:<br/>    min = b</span></pre><p id="a7c6" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">上面的代码用变量<code class="fe pf pg ph pi b">min</code>覆盖了内置函数<code class="fe pf pg ph pi b">min()</code>。现在，如果你试图使用内置的<code class="fe pf pg ph pi b">min()</code>函数，你的程序就会崩溃。引用教父的话，“看看他们是如何屠杀我的孩子的！”😧</p><p id="537e" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">其次，对于变量、函数和类，有一些PEP8约定你应该遵守。变量名和函数名都应该小写，不同的单词用下划线隔开:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="8b7b" class="ou lj it pi b gy pn po l pp pq">my_variable = 5</span><span id="76ce" class="ou lj it pi b gy pt po l pp pq">def my_function(a, b):<br/>   return a + b</span></pre><p id="13c9" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">如果希望一个变量在整个程序中保持不变，那么可以用大写字母来表示:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="5fe7" class="ou lj it pi b gy pn po l pp pq">MY_NONCHANGING_VARIABLE = 5</span></pre><p id="4a66" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">对于类，它们的名称应该用大写的单词连接起来，如下所示:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="f5c7" class="ou lj it pi b gy pn po l pp pq">class MyAwesomeClass():<br/>---</span></pre><p id="c201" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">上面对变量名的具体选择并没有提供很多信息。这是我们现在要讨论的命名事物的困难部分。</p><h2 id="6ed4" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">硬性主观性</h2><p id="d948" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">命名事物的困难之处在于不遵循上面描述的惯例。困难的部分是选择以简洁的方式表明实体是什么(对于变量和类)或者它是做什么的(对于函数)。以下是我想强调的一些准则(适用于变量):</p><ul class=""><li id="0017" class="ma mb it mc b md ol mf om mh oq mj or ml os mn ot mp mq mr bi translated"><strong class="mc jd">仔细挑长度:</strong>变量名不能太短也不能太长。如果变量名太短，你最终会使用不是每个人都能理解的缩写。你能说出变量<code class="fe pf pg ph pi b">c = 7</code>或<code class="fe pf pg ph pi b">vprice = 5</code>代表什么吗？断章取义，很明显这些变量名有多烂。但是通过编写:<code class="fe pf pg ph pi b">count_of_how_many_steps_our_pipeline_has = 7</code>和<code class="fe pf pg ph pi b">variance_of_the_column_price_in_our_dataset = 5</code>，它们也可以扩展得太长。现在可以理解，但是读起来就是噩梦。尝试找到一个合适的中间地带:<code class="fe pf pg ph pi b">pipeline_steps = 7</code>和<code class="fe pf pg ph pi b">variance_price = 7</code>怎么样？</li><li id="d538" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd">不要提到数据类型:</strong>将变量的数据类型隐藏在名称中往往很有诱惑力。我们很多人都有把熊猫称为数据帧的罪过。这个想法是，通过将<code class="fe pf pg ph pi b">df</code>作为<strong class="mc jd">数据帧的缩写，</strong>可以向读者表明这是一个数据帧。这种方法被称为<a class="ae lh" href="https://en.wikipedia.org/wiki/Hungarian_notation" rel="noopener ugc nofollow" target="_blank">匈牙利符号</a>，并且在很大程度上不被提倡。在Python中，你可以用<code class="fe pf pg ph pi b">type()</code>函数轻松检查某个东西的类型。如果你也使用类型提示，匈牙利符号就变得毫无用处。我建议把你可用的“变量名milage”花在更有用的东西上。</li><li id="f198" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd">使用直观的领域语言:</strong>您已经存储了变量<code class="fe pf pg ph pi b">broccoli</code>、<code class="fe pf pg ph pi b">celery</code>和<code class="fe pf pg ph pi b">beets</code>，这些变量计算每种蔬菜的销售数量。您现在需要一个容器类型(比如字典)来存储所有这些变量。你把这本字典叫做什么？别担心，这不是一道难题。我不知道你怎么想，但我会称之为<code class="fe pf pg ph pi b">vegatables</code>。尽可能使用直观的领域语言。唯一的例外是，如果您希望您的代码扩展到领域知识不再有意义的情况。</li></ul><p id="ab36" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">对于函数，上面的指导原则同样适用(请不要在函数名中嵌入“函数”一词)。唯一值得注意的是，函数通常做一些事情，而不是包含一些东西。因此，功能通常被赋予动作词(动词)来强调它们做什么。<code class="fe pf pg ph pi b">prune_tree()</code>、<code class="fe pf pg ph pi b">recommend_item()</code>等名字都很棒。</p><p id="c2aa" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">希望我已经让你相信花些时间给你的变量命名是值得的。在某些情况下，打破上述准则将是你最好的行动。例如，缩写API(应用程序编程接口)是众所周知的。由此(私！)名为<code class="fe pf pg ph pi b">api_password</code>的变量完全没问题。使用你自己的判断！</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="b99c" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">4 —模块化您的代码</h1><p id="d163" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">并非所有代码都是平等的。有些代码很难扩展。有些代码不容易被重用。有些代码很难检查错误。在所有这些方面做出改进的一个方法是<strong class="mc jd">模块化你的代码</strong>。</p><p id="9130" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">这在实践中意味着什么？你的代码应该分成函数和类。这些函数和类应该再次分组到Python模块中。为什么这样做？</p><p id="8036" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">考虑没有以任何方式分组的代码(您可能认为代码是“自由浮动的”)。这当然方便写在开头。然而，随着代码的增长，它变得越来越麻烦。</p><p id="b2a4" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">你必须复制和粘贴代码来做一些小的调整。如果你想扩展它，现在你必须在所有重复的地方修改代码。天知道如果一个同事要求你代码的一个特性你会怎么做——一切都是完全交织在一起的。不要让我开始讨论如何检查代码中的错误。</p><p id="9a8b" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">开始时的便利变成了一场噩梦😧</p><p id="48a8" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">解决方法是什么？您应该定期将代码重构为函数和类。让我们以函数为例。函数是一段可重用的代码。当您的代码按逻辑分组到函数中时，您可以:</p><ul class=""><li id="587f" class="ma mb it mc b md ol mf om mh oq mj or ml os mn ot mp mq mr bi translated"><strong class="mc jd">轻松重用一些代码:</strong>因为一个函数是一个独立的部分，你可以将那个特定的函数导出到其他设置中。也许你已经开发了一个很棒的函数<code class="fe pf pg ph pi b">clean_missing_values()</code>来清除数据集中的缺失值。现在，您也可以在其他项目中使用该功能(只需进行最小的调整)。</li><li id="6510" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd">轻松检查代码中的错误:</strong>可以通过单元测试来测试函数中的错误。在编写Python时，最常见的编写单元测试的库是<strong class="mc jd"> Unittest </strong>和(我的最爱)<strong class="mc jd"> Pytest </strong>。</li><li id="b419" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd">轻松添加文档，更加清晰:</strong>对于函数，您可以添加<a class="ae lh" href="https://www.programiz.com/python-programming/docstrings" rel="noopener ugc nofollow" target="_blank">文档字符串</a>来解释它们的功能。您还可以将<a class="ae lh" href="https://docs.python.org/3/library/typing.html" rel="noopener ugc nofollow" target="_blank">类型提示</a>添加到向其他开发人员和数据科学家解释输入和输出的数据类型的函数中。你会发现，一旦项目的复杂性增加，模块化的代码就更容易理解了。</li></ul><p id="17d9" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">特别是对于数据科学家来说，代码经常被留在Jupyter笔记本单元中，完全没有模块化。如果不从长远来看加以解决，上述所有问题都会变得更加突出。</p><p id="a9bc" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">不要误解我。Jupyter笔记本是数据探索和测试机器学习模型的伟大工具。但是，请确保您留出时间将代码重构为可维护的部分(函数和类)。这样做，从长远来看，你会省去很多痛苦。此外，你将成为团队中测试人员/开发人员最喜欢的人，这总是一个优势😅</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="3626" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">5—设计原则？没听说过！</h1><h2 id="9414" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">你不用设计原则？</h2><p id="b844" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">通常，<a class="ae lh" href="https://www.geeksforgeeks.org/an-introduction-to-software-development-design-principles/" rel="noopener ugc nofollow" target="_blank"> <strong class="mc jd">设计原则</strong> </a>是软件开发人员全神贯注的事情。许多数据科学家的印象是，设计原则并不真正与他们有太多的关系。对于这种说法，我想指出亚当·贾奇关于一般设计的名言:</p><blockquote class="nw"><p id="8f3d" class="nx ny it bd nz oa ob oc od oe of mn dk translated">“好设计的替代品总是坏设计。没有所谓的没有设计。”亚当·贾奇</p></blockquote><p id="aa23" class="pw-post-body-paragraph nj nk it mc b md og kd nl mf oh kg nm mh oi no np mj oj nr ns ml ok nu nv mn im bi translated">Adam Judge说的绝对是视觉角度的设计。然而，我认为结论仍然代表着编写代码时的设计原则。通过编写代码，你在使用设计原则。你可能只是没有好好利用它们。</p><p id="fca0" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">让我们从一些设计原则开始，以提高您的一般代码质量！</p><h2 id="3d46" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">可爱的缩写😍</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pu"><img src="../Images/1d459fa7ee8a3e473000f92c4af7376f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MniZI2QIezHNcZ7C"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">加里·本迪格在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="b9b8" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">首先，有一些可爱的首字母缩略词正在被到处乱扔。在编写代码时，您应该将这些原则视为指导原则:</p><p id="715c" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">接吻:保持简单，傻傻的。尽可能降低复杂性。我们举个例子。比如你想算出1到1000之间有多少个非平方数。回想一下，非平方数<code class="fe pf pg ph pi b">n</code>只是一个不能用其他数<code class="fe pf pg ph pi b">m</code>的<code class="fe pf pg ph pi b">n = m**2</code>来表示的数。下面的代码解决了我们的问题:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="57f0" class="ou lj it pi b gy pn po l pp pq">non_square_numbers = len(set(range(1, 1001)).difference(set(map(lambda x: x ** 2, range(1, 1001)))))</span></pre><p id="b0e5" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">要诚实。虽然上面的代码解决了这个问题(甚至使用了很酷的功能，如set和map函数)，但它看起来很可怕。你可能花了一些时间去读它。这太复杂了。考虑以下简化:</p><pre class="ks kt ku kv gt pj pi pk pl aw pm bi"><span id="7aeb" class="ou lj it pi b gy pn po l pp pq">from math import sqrt</span><span id="3aa3" class="ou lj it pi b gy pt po l pp pq">non_square_numbers = list(range(1, 1001))</span><span id="e30c" class="ou lj it pi b gy pt po l pp pq">for n in range(1, int(sqrt(1001))):<br/>    non_square_numbers.remove(n ** 2)</span></pre><p id="b0a8" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">新代码不仅更清晰，而且更快。我只需要运行这些数字直到1001的平方根，因为我是平方数字。从KISS中得到的教训是，如果让你的代码更容易理解，有时候让它长一点是值得的。</p><p id="8b33" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated"><strong class="mc jd">干:不要重复自己</strong>——这个原则鼓励将你的代码模块化成函数。这样做可以避免代码重复。事实上，每当您发现自己重复代码时，您可能应该模块化您的代码。</p><p id="108b" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">YAGNI:你不会需要它的——这个原则鼓励你不要过度设计解决方案。我们来做一个具体的例子。</p><p id="4fd5" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">假设您正在编写一个数据管道，其中第一步是一个从SQL数据库读取数据的函数。也许在未来，你还需要阅读CSV文件。所以你也要实现它。也许在将来，你也需要阅读XML。或者JSON。或者拼花文件。</p><p id="1df4" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">在这种情况下，YAGNI原理很简单。不要。您可能不需要所有的扩展，并且您正在编写永远不会被使用的代码。相反，请确保您的代码可以扩展。但是请将实际的扩展留到您真正需要这样做的时候。</p><p id="49d5" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">遵循YAGNI原则，你的代码库会更小，你需要担心的松散线程也会更少。</p><h2 id="fd02" class="ou lj it bd lk ov ow dn lo ox oy dp ls mh oz pa lu mj pb pc lw ml pd pe ly iz bi translated">坚实的设计原则</h2><p id="64a5" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">一组完善的设计原则(尤其是在OOP中)是<a class="ae lh" href="http://d-the-first-five-principles-of-object-oriented-design" rel="noopener ugc nofollow" target="_blank">坚实的原则</a>。它们形成了一组久经考验的设计原则，在过去的几十年中被大量使用。SOLID中的五个设计原则是:</p><ul class=""><li id="7c0d" class="ma mb it mc b md ol mf om mh oq mj or ml os mn ot mp mq mr bi translated"><strong class="mc jd">S</strong>——<a class="ae lh" href="https://www.digitalocean.com/community/conceptual_articles/s-o-l-i-d-the-first-five-principles-of-object-oriented-design#single-responsibility-principle" rel="noopener ugc nofollow" target="_blank">单一责任原则</a></li><li id="4dd9" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd"> O </strong> — <a class="ae lh" href="https://www.digitalocean.com/community/conceptual_articles/s-o-l-i-d-the-first-five-principles-of-object-oriented-design#open-closed-principle" rel="noopener ugc nofollow" target="_blank">开闭原理</a></li><li id="a018" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd"> L </strong> — <a class="ae lh" href="https://www.digitalocean.com/community/conceptual_articles/s-o-l-i-d-the-first-five-principles-of-object-oriented-design#liskov-substitution-principle" rel="noopener ugc nofollow" target="_blank">利斯科夫替代原理</a></li><li id="18a5" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd"> I </strong> — <a class="ae lh" href="https://www.digitalocean.com/community/conceptual_articles/s-o-l-i-d-the-first-five-principles-of-object-oriented-design#interface-segregation-principle" rel="noopener ugc nofollow" target="_blank">界面偏析原理</a></li><li id="8e7d" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd"> D </strong> — <a class="ae lh" href="https://www.digitalocean.com/community/conceptual_articles/s-o-l-i-d-the-first-five-principles-of-object-oriented-design#dependency-inversion-principle" rel="noopener ugc nofollow" target="_blank">依存倒置原则</a></li></ul><p id="ae59" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">并非所有坚实的原则在数据科学中都同样有用。事实上，我在数据学科中很少使用利斯科夫的替代原理。不要误解我，这是一个伟大的设计原则，我非常尊重芭芭拉·利斯科夫。但是，在大量使用OOP的软件工程中，它肯定更有用。我认为数据科学家最重要的坚实原则是单一责任原则。</p><p id="c973" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">单一责任原则声明函数(以及类)应该有单一的责任。让我们用一个例子来探讨这意味着什么。</p><p id="e1ad" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">假设您有一个函数<code class="fe pf pg ph pi b">process_data()</code>，它加载一个CSV文件作为Pandas数据帧，删除丢失的值，选择一些特征，然后最终绘制这些特征。您的函数<code class="fe pf pg ph pi b">process_data()</code>现在有四个职责:导入数据、清理数据、特征提取和绘图。为什么这样不好？</p><p id="5231" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">首先，现在很难将代码导出到其他设置。您可能已经在函数<code class="fe pf pg ph pi b">process_data()</code>中编写了顶级缺失值清除代码。你如何在其他地方使用这些代码，比如说，不能进行特征提取的地方？没那么简单。</p><p id="015c" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">测试你的代码是否有缺陷也更加困难。通过做多种不同的事情，有更多的地方让臭虫藏身。</p><p id="2e5d" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">单一责任原则建议将功能<code class="fe pf pg ph pi b">process_data()</code>分解为四个功能。这些功能可以称为<code class="fe pf pg ph pi b">import_csv_data()</code>、<code class="fe pf pg ph pi b">clean_missing_values()</code>、<code class="fe pf pg ph pi b">extract_features()</code>和<code class="fe pf pg ph pi b">plot_features()</code>。这样，每个功能都有一个单独的职责😃</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="f712" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">6 —代码质量的更多资源</h1><p id="c3cb" class="pw-post-body-paragraph nj nk it mc b md me kd nl mf mg kg nm mh nn no np mj nq nr ns ml nt nu nv mn im bi translated">我已经给了你一些提高代码质量的起点。关于这个主题的更多信息，您应该从哪里获得？</p><ul class=""><li id="e274" class="ma mb it mc b md ol mf om mh oq mj or ml os mn ot mp mq mr bi translated"><strong class="mc jd">代码风格:</strong>除了熟记PEP8并使用有效的代码格式化程序(如<a class="ae lh" href="https://pypi.org/project/black/" rel="noopener ugc nofollow" target="_blank"> Black </a>或<a class="ae lh" href="https://pypi.org/project/autopep8/" rel="noopener ugc nofollow" target="_blank"> autopep8 </a>)之外，真的没什么别的了。如果您想确保您执行了这一点，那么就请做代码评审的人提供关于代码风格的反馈。您可能还想研究一下在<a class="ae lh" href="https://peps.python.org/pep-0257/" rel="noopener ugc nofollow" target="_blank"> PEP257 </a>中编写适当的文档字符串的Python约定。</li><li id="678d" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd">变量名:</strong>我在这里最好的建议是注意你选择的变量名。除此之外，我在Al Sweigart的书<a class="ae lh" href="https://www.goodreads.com/book/show/41392896-beyond-the-basic-stuff-with-python" rel="noopener ugc nofollow" target="_blank">中发现了许多有趣的点，超出了Python </a>的基本内容。</li><li id="e98c" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd">模块化代码:</strong>编写模块化代码需要付出努力。如果您不确定何时(以及如何)使用类，请考虑学习更多关于OOP(面向对象编程)的知识。我可以推荐免费的YouTube系列<a class="ae lh" href="https://www.youtube.com/playlist?list=PL-osiE80TeTsqhIuOqKhwlXsIBIdSeYtc" rel="noopener ugc nofollow" target="_blank"> Python OOP教程</a>作为一个很好的起点。除此之外，我建议您熟悉Python函数的各个方面，以便能够有效地使用它们。例如，如果您不知道Python函数默认返回值<code class="fe pf pg ph pi b">None</code>，那么您的代码可能会反映出这种知识的缺乏。</li><li id="42fd" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><strong class="mc jd">设计原则:</strong>我只是给了你一点设计原则的味道。有关于这个主题的经典书籍，也有专门针对数据科学的书籍。然而，我怎么推荐都不为过。它们具有极高的质量，并对许多设计原则进行了Python特有的介绍。</li></ul></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="d56d" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">7 —总结</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pv"><img src="../Images/1bc2433f4186ac84ae54e1d8a5168ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6Chhh-i154NxbtU1"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@spencerbergen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯潘塞·伯根</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="d630" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">希望你正在成为一名高质量的代码制作者。如果你的代码不是一夜之间完美的，也不用担心。获得高质量的代码是一个漫长的旅程，我每天都在努力。</p><p id="c0e6" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated"><strong class="mc jd">喜欢我写的？</strong>查看我的其他帖子，了解更多Python内容:</p><ul class=""><li id="682e" class="ma mb it mc b md ol mf om mh oq mj or ml os mn ot mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1">用漂亮的类型提示使你罪恶的Python代码现代化</a></li><li id="3887" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/visualizing-missing-values-in-python-is-shockingly-easy-56ed5bc2e7ea">用Python可视化缺失值非常简单</a></li><li id="48eb" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/introducing-anomaly-outlier-detection-in-python-with-pyod-40afcccee9ff">使用PyOD在Python中引入异常/异常值检测🔥</a></li><li id="6ff5" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/5-awesome-numpy-functions-that-can-save-you-in-a-pinch-ba349af5ac47"> 5个能在紧要关头救你的牛逼数字功能</a></li><li id="2bb6" class="ma mb it mc b md ms mf mt mh mu mj mv ml mw mn ot mp mq mr bi translated">5个专家提示，帮助你提高Python的词典技能🚀</li></ul><p id="9aee" class="pw-post-body-paragraph nj nk it mc b md ol kd nl mf om kg nm mh on no np mj oo nr ns ml op nu nv mn im bi translated">如果你对数据科学、编程或任何介于两者之间的东西感兴趣，那么请随意在LinkedIn上加我，并向✋问好</p></div></div>    
</body>
</html>