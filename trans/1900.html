<html>
<head>
<title>Optimal Undersampling using Machine Learning, with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习和Python实现最佳欠采样</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optimal-undersampling-using-machine-learning-with-python-d40779583d53#2022-05-02">https://towardsdatascience.com/optimal-undersampling-using-machine-learning-with-python-d40779583d53#2022-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="aedc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以下是如何使用几行代码智能地对信号进行欠采样</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/678b9319c668587fcc0629577a7641ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPhL1JaUF3N-n4kJY6EiXg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/s/photos/less?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@prateekkatyal?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>拍摄</p></figure><p id="a05c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在大数据时代<strong class="ky ir">欠采样</strong>是数据处理的关键部分。<br/>即使我们能够以非常严格的方式定义欠采样，但我们的想法是，我们希望获得一个长、大、耗时且消耗内存的信号，并用一个更小且耗时更少的信号来代替它。</p><p id="33d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，你将学习如何使用机器学习和几行代码以一种“智能”的方式对你的信号进行<strong class="ky ir">欠采样。我们将从描述欠采样背后的优化任务开始，然后我们将解释使这种优化尽可能高效的策略。</strong></p><p id="72ac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始吧:)</p><h1 id="15b8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.介绍</h1><p id="ea30" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当然，每个欠采样任务最终都是一个<strong class="ky ir">优化</strong>任务。<br/>我来解释一下原因。</p><p id="2fae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑这个函数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/8593d28826fbb1d1775492df44a6ea37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZD8BSJnLTJQ3D_TVIZzvoA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="ecbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我用了100个点来制作这个函数，正如你所看到的，这足以让它看起来非常平滑。那么欠采样是怎么回事呢？</p><p id="d303" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以一种非常天真的方式和2D信号，它是这样工作的:</p><ol class=""><li id="5e5a" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">考虑沿x轴的随机点(或采样均匀分布的点)。当然，你应该选择少于你的信号的原始点。在我们的例子中，你可以考虑10个数据点，或者20，或者30，但是少于100。</li><li id="4be3" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">使用插值技术连接这些点。最简单的方法是线性插值。基本上你只是用直线连接这些点。</li></ol><p id="4647" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很简单。让我们看看如果我们从100个点中随机选择10个点会是什么样子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/26fdd75d30697afd820c1f88540dd5c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xG7YC5WZ3opoV1E5CzwL9A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="167e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好吧…你们对这种欠采样满意吗？我打赌你不是。</p><p id="1c77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们考虑更多的数据点，看看它是什么样子的。具体来说，让我们把数据点翻倍。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/c90f9dc800fcd128e5c714ce01139ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UONJLDi7VXT1kB820EzbRw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="c1be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当然更好。</p><p id="224d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们试着看看70会发生什么:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/f56c52919f5b29789eebf9c6c56c7eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HHBiaUWCKlSG_rpSGekVA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7676" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那样的话，我们基本上就完美了。尽管如此，我们考虑了70%的数据点，所以即使我们实际上是欠采样，我们仍然考虑了很多点。</p><p id="242f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在应该更清楚为什么我们每次尝试欠采样时都要考虑一个<strong class="ky ir">优化</strong>问题了:</p><ul class=""><li id="bd3c" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr ne mw mx my bi translated">如果使用<strong class="ky ir">太少的</strong>数据点进行欠采样:您的重建会有损失(高效率，低重建质量)</li><li id="d765" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr ne mw mx my bi translated">如果您使用太多的数据点进行欠采样:您的重建是有损失的，但是该方法不是很有效或者根本没有效率。(低效率，高重建质量)</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/ac70088725e9254959193f8c2f313ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KrSsdgolzMAzrPidGSX-Ig.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="c99c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.提议的算法</h1><p id="3e8b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">从这个分析中我们可以得到的信息是<strong class="ky ir">随机</strong>或<strong class="ky ir">均匀</strong>采样x轴<strong class="ky ir">不是最优策略</strong>。</p><p id="69ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们提出的算法在传统算法的第一步和第三步之间增加了另一步:</p><ol class=""><li id="00fb" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">考虑沿x轴的随机点(或采样均匀分布的点)。当然，你应该选择少于你的信号的原始点。在我们的例子中，你可以考虑10个数据点，或者20，或者30，但是少于100。</li><li id="870d" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><strong class="ky ir">对低质量区域进行过采样</strong></li><li id="1094" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">使用插值技术连接这些点。最简单的方法是线性插值。基本上你只是用直线连接这些点。</li></ol><p id="b83e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们更仔细地分析步骤2。<br/>如果我们考虑10/20数据点图像，我们可以看到有些区域的误差比其他区域大。例如，在尾部误差最小，因为在那里考虑直线而不是高斯曲线基本上是无害的。然而，如果我们想在高峰期使用线路，我们会遇到麻烦，而且质量会更低。</p><p id="83b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的算法中，我们考虑了目标信号和插值采样信号之间的绝对差异。然后我们<strong class="ky ir">如果距离太大就加点。</strong>我们来说清楚一点。</p><p id="9dcb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设原始信号有N个起始点，我们从N个采样点开始。我们将执行以下操作:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="519c" class="nl lt iq nh b gy nm nn l no np">1. <strong class="nh ir">Interpolate</strong> the signal and compute, from your n starting point, an interpolated signal with values in the original N data points </span><span id="f466" class="nl lt iq nh b gy nq nn l no np">2. <strong class="nh ir">Compute</strong> the absolute normalized difference between the interpolated signal in the N data points and the original N data points values </span><span id="968e" class="nl lt iq nh b gy nq nn l no np">3. <strong class="nh ir">Add</strong> the point if the difference is larger than a certain threshold (let's say 5 percent of the maximum)</span></pre><p id="743d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们编码:)</p><h1 id="11bb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.动手实施</h1><p id="6aca" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">导入库:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="5776" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建信号:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="36fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">定义欠采样和插值函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9404" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">定义算法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h1 id="04dc" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.分析结果</h1><p id="e3de" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">此过程的结果可以显示在</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/8597016f1324de6ef6f7c3b5d8c3c718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pg6T_F2FbSy96hWRBIyNCg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="c129" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如我们所看到的，我们从欠采样的通用信号开始，然后我们找到一个真正的<strong class="ky ir">优化</strong>版本的信号，在需要它的区域中有更多的数据。</p><h1 id="f9a7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">5.n维信号</h1><p id="669e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在原始的<a class="ae kv" href="https://jovian.ai/piero-paialunga/oversampling" rel="noopener ugc nofollow" target="_blank">文件</a>中，您可以找到N维信号的相同实现。</p><h1 id="5800" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">6.结论</h1><p id="a0d6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="25ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">A.在<a class="ae kv" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Linkedin </strong> </a>上关注我，在那里我发布我所有的故事<br/> B .订阅我的<a class="ae kv" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="ky ir">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae kv" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="ky ir">推荐会员</strong> </a>，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p></div></div>    
</body>
</html>