<html>
<head>
<title>Apply Thousand Separator (and Other Formatting) to Pandas Dataframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对熊猫数据帧应用千位分隔符(和其他格式)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/apply-thousand-separator-and-other-formatting-to-pandas-dataframe-45f2f4c7ab01#2022-02-26">https://towardsdatascience.com/apply-thousand-separator-and-other-formatting-to-pandas-dataframe-45f2f4c7ab01#2022-02-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7e21" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过学习这些有用的熊猫格式技巧，为自己节省一些谷歌搜索时间</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/97a0cd90d1ad4c2cc1092fa0bd6d6359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yO8NR2zSUGxsSz4APhOFZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/vectors/panda-animal-bamboo-wood-6084417/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><h1 id="dfb1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="6b4f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在 pandas 数据框架中格式化数据是一项非常常见的数据科学任务，尤其是为了报告或数据可视化的目的。原始数据通常以各种类型或格式出现，这些类型或格式可能总是适合于分析或可视化。格式化数据有助于我们以一种对读者更友好的方式呈现数据和信息。</p><p id="3d3e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">看看下面这个例子:哪个报表/表格更容易阅读？如果我们要在图表中可视化这些数据，您更愿意在工具提示中显示顶部还是底部表格中的信息？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/d04ae36aa08cfd855e0f6d973cb0b5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*noPmQaCWorxAPmmAMHBVyQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7a2c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这篇文章中，我将与你分享一些熊猫格式技巧，来解决这些常见的格式问题:</p><ul class=""><li id="1340" class="mt mu it lt b lu mn lx mo ma mv me mw mi mx mm my mz na nb bi translated">在数字中插入千位逗号分隔符</li><li id="1e58" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated">将数字格式化为百分比</li><li id="f18d" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated">将日期/时间列更改为所需的格式</li></ul></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="6826" class="kz la it bd lb lc no le lf lg np li lj jz nq ka ll kc nr kd ln kf ns kg lp lq bi translated">抽样资料</h1><p id="cb24" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将使用上面显示的例子来说明如何在 Pandas 数据帧中进行这些格式更改。本教程中使用的样本数据可以从<a class="ae ky" href="http://redfin’s data center" rel="noopener ugc nofollow" target="_blank"> Redfin </a>的开放数据中心下载。下面是样本数据的快速概述:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/eec80fa1ef4b69f12a5428cad9bf4435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*OFmM2xcb_rgjDn1EpHWJTg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="63a0" class="kz la it bd lb lc no le lf lg np li lj jz nq ka ll kc nr kd ln kf ns kg lp lq bi translated">添加千位逗号分隔符</h1><p id="b2c0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们从“中间销售价格”列开始，看看如何通过在前面添加千个逗号分隔符和一个美元符号来格式化它。下面是实现这一功能的代码:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="04e1" class="nz la it nv b gy oa ob l oc od">df.loc[:, "Median Sales Price_formatted"] ='$'+ df["Median Sales Price"].map('{:,.0f}'.format)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/c6e3d080a24acf570270d5742a4cc0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*qjgJioWHslZbbm9JW_rIDw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="bd9a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们使用 python 字符串格式语法<code class="fe of og oh nv b">'{:,.0f}'.format</code>为数字添加一千个逗号分隔符。然后，我们使用 python 的<code class="fe of og oh nv b">map()</code>函数进行迭代，并将格式应用于“中间销售价格”列中的所有行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/9525d50cba367d0c6159069641684c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySy7omFZb-xRNynn5j1j7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f308" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">将语法改为<code class="fe of og oh nv b">'{:,.2f}'.format</code>将得到两位小数。</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="ae6f" class="nz la it nv b gy oa ob l oc od">df.loc[:, "Median Sales Price_formatted"] ='$'+ df["Median Sales Price"].map('{:,.2f}'.format)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/b128b8a9d48a7434ddcbbc9b9c6e7225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sIeWM0ZIO-aTjRpcC10TRw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6378" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果“销售价格中位数”列是整数类型，那么您也可以使用以下代码添加千位逗号分隔符:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="fb04" class="nz la it nv b gy oa ob l oc od">df.loc[:, "Median Sales Price_formatted"] ='$'+ df["Median Sales Price"].map('{:,d}'.format)</span></pre></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="f26f" class="kz la it bd lb lc no le lf lg np li lj jz nq ka ll kc nr kd ln kf ns kg lp lq bi translated">将数字格式化为百分比</h1><p id="beff" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用相同的字符串格式语法，稍加修改，我们可以轻松地将“销售价格中值同比”列格式化为百分比:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="46ae" class="nz la it nv b gy oa ob l oc od">df.loc[:, "Median Sales Price (YoY)_formatted"] =df["Median Sales Price (YoY)"].map('{:.2%}'.format)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/c493feb4d089e724f0941303250a37da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJnvFF2JGTYbZs5eDhgX6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="54ac" class="kz la it bd lb lc no le lf lg np li lj jz nq ka ll kc nr kd ln kf ns kg lp lq bi translated">将日期/时间列格式化为年月</h1><p id="355d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用相同的技术，我们还可以将“月”列格式化为“年-月”或我们想要的任何格式:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="c779" class="nz la it nv b gy oa ob l oc od">df.loc[:, "Month_formatted"] =df["Month"].map('{:%Y-%m}'.format)<br/>df.loc[:, "DateTime_formatted"] =df["Month"].map('{:%Y-%m-%d %H:%M:%S}'.format)<br/>df.loc[:, "Year_formatted"] =df["Month"].map('{:%Y}'.format)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/7175cf425cc64cbfe6433fcdd2b37f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-TsBVKbsj_29LBVPqI5Jg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="37da" class="kz la it bd lb lc no le lf lg np li lj jz nq ka ll kc nr kd ln kf ns kg lp lq bi translated">最终想法</h1><p id="07c7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我想指出的重要一点是，使用这些格式化技术，格式化的列将变成字符串/对象类型(如下图所示)。最佳做法是，始终将格式化的列保存为新列，不要覆盖原始列。</p><p id="4d83" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是为什么呢？这是因为很多时候，您需要使用具有适当数据类型的原始列进行数据分析，而使用格式化的新列进行报告或可视化。</p><p id="fc53" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，在我们的用例中，如果“中值销售价格”或“中值销售价格(YoY)”是字符串，您将无法对它们进行适当的数据分析。设置这些列的格式主要是为了使它们在报告或可视化时更易于阅读。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/ada6b66932fe0db773157efe8bedf785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*cPzz4n1__DHvb3GBiu3u1Q.png"/></div></figure><p id="5113" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢阅读！我希望您喜欢这个关于 Pandas 格式化技巧的简短教程，并且能够很快将这些技巧应用到您的数据科学任务中。你可以阅读我的其他文章来了解更多熊猫的技巧和技术:</p><div class="on oo gp gr op oq"><a rel="noopener follow" target="_blank" href="/why-and-how-to-reshape-a-pandas-dataframe-from-wide-to-long-ca90c89156b9"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">为什么以及如何将熊猫数据框由宽变长</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">一段简单的代码就完成了这个任务</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">towardsdatascience.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe ks oq"/></div></div></a></div><div class="on oo gp gr op oq"><a href="https://medium.com/codex/how-to-batch-rename-columns-in-pandas-based-on-patterns-7d2382b5fc9a" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">如何基于模式批量重命名 Pandas 中的列</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">分享一段简单的代码，希望对你有所帮助！</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">medium.com</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe ks oq"/></div></div></a></div></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h1 id="7e55" class="kz la it bd lb lc no le lf lg np li lj jz nq ka ll kc nr kd ln kf ns kg lp lq bi translated"><strong class="ak">参考文献和数据来源</strong></h1><ol class=""><li id="9bc2" class="mt mu it lt b lu lv lx ly ma pg me ph mi pi mm pj mz na nb bi translated">Python 的常用字符串操作文档:【https://docs.python.org/3/library/string.html#formatstrings T2】</li><li id="ecc7" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm pj mz na nb bi translated">数据来源:Redfin 月度住房市场数据——城市一级。这是一个由<a class="ae ky" href="https://www.redfin.com/news/data-center/" rel="noopener ugc nofollow" target="_blank"> Redfin </a>，<em class="pk"> </em>提供的开放数据集，你可以免费下载，并注明出处。</li></ol></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="f0b2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你可以通过这个<a class="ae ky" href="https://medium.com/@insightsbees/membership" rel="noopener">推荐链接</a>注册 Medium 会员(每月 5 美元)来获得我的作品和 Medium 的其他内容。通过这个链接注册，我将收到你的一部分会员费，不需要你额外付费。谢谢大家！</p></div></div>    
</body>
</html>