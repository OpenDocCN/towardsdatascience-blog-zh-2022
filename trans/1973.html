<html>
<head>
<title>Outlier Detection (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">离群点检测(第1部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/outlier-detection-part1-821d714524c#2022-05-05">https://towardsdatascience.com/outlier-detection-part1-821d714524c#2022-05-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="855a" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">IQR、标准差、Z值和修改后的Z值</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/825f31b2b2936cf9a96cb8359c8f2eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQCdQgbfb5dtWifJpfOUfg.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">作者图片</p></figure><blockquote class="kz la lb"><p id="6256" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">简介</strong></p></blockquote><p id="3814" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">在数据驱动模型中包含异常值是有风险的。一个误导值的存在有可能改变模型所暗示的结论。因此，检测并决定是否将其从数据集中移除非常重要。有时数据点可能非常高或非常低，但这并不意味着它是我们想要摆脱的异常值。可能只是一个极端的数据点。这取决于用户决定它是否应该包含在模型中。然而，有时数据点可能只是数据收集或处理过程中的一个打字错误或一些人为因素。</p><blockquote class="kz la lb"><p id="ebb8" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">离群点检测方法</strong></p></blockquote><p id="6ee5" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">在本文中，我将介绍几种统计异常值检测方法，包括四分位间距(IQR)、标准差、Z得分和修正的Z得分。我将使用python来实现这些方法，并最终共享数据和笔记本。我将使用<a class="ae mc" href="https://www.kaggle.com/datasets/airbnb/boston" rel="noopener ugc nofollow" target="_blank">波士顿AirBnB </a>数据和<a class="ae mc" href="https://creativecommons.org/publicdomain/zero/1.0/" rel="noopener ugc nofollow" target="_blank"> CC0:公共领域</a>许可。</p><blockquote class="kz la lb"><p id="91df" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">四分位间距</strong></p></blockquote><p id="b764" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">四分位数间距(IQR)是最广泛使用的离群点检测和删除程序之一。根据这个程序，我们需要遵循以下步骤:</p><ul class=""><li id="1fc7" class="md me iu lf b lg lh lj lk lz mf ma mg mb mh ly mi mj mk ml bi translated">找到第一个四分位数，Q1。</li><li id="8f53" class="md me iu lf b lg mm lj mn lz mo ma mp mb mq ly mi mj mk ml bi translated">求第三个四分位数，Q3。</li><li id="4c5a" class="md me iu lf b lg mm lj mn lz mo ma mp mb mq ly mi mj mk ml bi translated">计算IQR。IQR = Q3-Q1。</li><li id="c9f1" class="md me iu lf b lg mm lj mn lz mo ma mp mb mq ly mi mj mk ml bi translated">定义正常数据范围，下限为Q1-1.5 * IQR，上限为Q3+1.5*IQR。</li><li id="8a07" class="md me iu lf b lg mm lj mn lz mo ma mp mb mq ly mi mj mk ml bi translated">任何超出此范围的数据点都被认为是异常值，应该删除以便进一步分析。</li></ul><p id="7537" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">在箱线图中，实施这种IQR方法来检测任何极值数据点，其中最大点(高晶须的末端)是Q3+1.5*IQR，最小点(低晶须的起点)是Q1–1.5 * IQR。</p><blockquote class="kz la lb"><p id="5918" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">用python实现</strong></p></blockquote><p id="15d6" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">AirBnB数据有一个价格列，我们将考虑实施。确定Q1、Q3和IQR后，异常点将从数据框中移除，如下所示。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mr ms l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mt"><img src="../Images/f82817b47a28d334b72c8c95a846037a.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*-ygoPKScfi4rLYxi2ZSy_Q.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">应用IQR方法后检测到一个异常值[图片由作者提供]</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mu"><img src="../Images/9ea5a27d1861f169b6ab4a2177484b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*LLVbi-FxFZmBvoRoatkGvQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">异常值与其他箱线图细节一起显示[图片由作者提供]</p></figure><p id="63c2" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">异常值为417，高于箱线图所示的最大限值(whishi = 402)。我们没有低于whislo (10)的ant异常值。</p><blockquote class="kz la lb"><p id="af6c" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">正态分布说明</strong></p></blockquote><p id="5b46" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">如果我们有一个正常的数据集，四分位数可以根据平均值和中位数来确定。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mv"><img src="../Images/45c5d4b3d20e366cd0c64d8c7198d9a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*ZVMZghPthbhHyxWjOUHJzQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">[图片由作者提供]</p></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mw"><img src="../Images/9a311b0ad529153825bfad237b859251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dAiN5Hc79YdnEsRiuZNDow.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">[图片由作者提供]</p></figure><p id="ad64" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">因此，对于正态分布数据，实施乘数为1.5的IQR方法与使用乘数为2.7的标准差方法相同，如上所示。然而，我们经常会将规格限制在3个标准差。为此，IQR乘数应该是~1.7，而不是1.5(为此，我们只将限制设置为标准差的2.7倍)。</p><blockquote class="kz la lb"><p id="6d5e" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">标准偏差</strong></p></blockquote><p id="61ee" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">标准差法类似于上面讨论的IQR程序。根据2倍标准偏差或3倍标准偏差的设定限制，我们可以从数据集中检测并移除异常值。</p><blockquote class="mx"><p id="3b98" class="my mz iu bd na nb nc nd ne nf ng ly dk translated">上限=平均值+ 3 *标准偏差</p><p id="f4b1" class="my mz iu bd na nb nc nd ne nf ng ly dk translated">下限=平均值-3 *标准偏差</p></blockquote><figure class="nh ni nj nk nl ko"><div class="bz fq l di"><div class="mr ms l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nm"><img src="../Images/7cee4e0885e1afb54a0a7849db6c11d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*SbSuiwToX5rCdlNunthfTQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">当平均值+/- 3倍标准差被设定为极限值时，会发现更多的异常值[图片由作者提供]</p></figure><p id="e5a0" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">这里异常值的总数是57。当使用2倍stdev时，传单数量下降到20。这是因为2倍stdev意味着更严格的极限集，并且大多数可能的极值点已经被该过程移除。移除后只剩下少数几个，当用更新的数据生成新的箱线图时，这些仍然被认为是异常值。</p><blockquote class="kz la lb"><p id="1f33" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv"> Z值</strong></p></blockquote><p id="c7e0" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">z分数只是另一种形式的标准差程序。z得分用于将数据转换为另一个均值为0的数据集。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nn"><img src="../Images/b5ae3222503a602105198c2ba7847f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*W5oVcRiMxQgpIMGjkp-9Cw.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">[图片由作者提供]</p></figure><p id="4eb7" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">这里，X-bar是平均值，s是标准偏差。转换数据后，中心变为0，对应于每个数据点的z得分以标准差的形式表示与中心的距离。例如，z值为2.5表示数据点距离平均值有2.5个标准偏差。通常z分数=3被认为是设置限制的临界值。因此，任何大于+3或小于-3的z分数都被视为异常值，这与标准差方法非常相似。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mr ms l"/></div></figure><p id="3710" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">我们发现在实施该方法之前异常值的数量是21，并且在去除这21个异常值之后获得了20。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj no"><img src="../Images/e0ab3c4f68c7bcfabd1b4cc9e819a689.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*djiGvtf7GSKIEaJbBM3-nA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">实施截止值设置为3的Z分数方法后的异常值[图片由作者提供]</p></figure><p id="f1f0" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">事实上，这20个异常值是我们从3倍stdev方法中获得的相同数据点。因此，用户可以选择任何一种。</p><blockquote class="kz la lb"><p id="e5f3" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">修改后的Z值</strong></p></blockquote><p id="c5b8" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">Z-score易受极端数据点的影响。如果有一个极值，对应于该点的z值也将是极值。它有可能使平均值明显偏离其实际值。修改后的z得分比标准z得分更稳健，因为它是根据中位数绝对偏差(MAD)计算的。修正Z值的公式为[1]</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj np"><img src="../Images/5fafed4962d3b1303b9d57aab9c01e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*i9aBfLQLiGhobk0eYbZhaQ.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">[图片由作者提供]</p></figure><p id="daa0" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">因为它依赖于中间值，所以不容易受到任何异常值的影响。我们可以使用修正的Z值的临界值3.5 [1]。一旦实现了这个过程，我们就获得了与Z-score相同的结果，因为数据集可能没有任何有影响的异常值。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj nq"><img src="../Images/e7f81c7fe68fda908a3e30735386c87c.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*0lV7CzAX9nn8z9xW3N3vKA.png"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">实施截断值设置为3.5的修正Z分数方法后的异常值[图片由作者提供]</p></figure><blockquote class="kz la lb"><p id="711a" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">结论</strong></p></blockquote><p id="b203" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated">在本文中，我们展示了检测数据集中异常值的四个统计过程。对于正常数据集，IQR乘数1.7类似于标准偏差乘数3，这也类似于将Z值的临界值设置为3作为检测限。统计学家使用修改的Z-score来最小化异常值对Z-score的影响。这个修改后的Z值表示异常值的相对强度，以及它与它应该具有的Z值的偏差程度。所有这些程序都是统计确定异常值的标准程序。</p><p id="1271" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated"><a class="ae mc" href="https://mdsohelmahmood.github.io/data-science/2020/05/04/Outlier-detection-part1.html" rel="noopener ugc nofollow" target="_blank">代码为</a>的Github页面</p><p id="ad39" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated"><a class="ae mc" href="https://www.learningfromdata.net/" rel="noopener ugc nofollow" target="_blank">我的网站:从数据中学习</a></p><p id="7772" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated"><a class="ae mc" href="https://www.youtube.com/watch?v=xEuuykOff-w&amp;t=3s" rel="noopener ugc nofollow" target="_blank">本文的Youtube】</a></p><p id="9155" class="pw-post-body-paragraph lc ld iu lf b lg lh jv li lj lk jy ll lz ln lo lp ma lr ls lt mb lv lw lx ly in bi translated"><a class="ae mc" href="https://www.youtube.com/watch?v=F4s6H_EDwFc" rel="noopener ugc nofollow" target="_blank">代码演练</a></p><div class="nr ns gq gs nt nu"><a href="https://mdsohel-mahmood.medium.com/membership" rel="noopener follow" target="_blank"><div class="nv ab fp"><div class="nw ab nx cl cj ny"><h2 class="bd iv gz z fq nz fs ft oa fv fx it bi translated">用我的推荐链接加入媒体</h2><div class="ob l"><h3 class="bd b gz z fq nz fs ft oa fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oc l"><p class="bd b dl z fq nz fs ft oa fv fx dk translated">mdsohel-mahmood.medium.com</p></div></div><div class="od l"><div class="oe l of og oh od oi kt nu"/></div></div></a></div><blockquote class="kz la lb"><p id="e818" class="lc ld le lf b lg lh jv li lj lk jy ll lm ln lo lp lq lr ls lt lu lv lw lx ly in bi translated"><strong class="lf iv">参考</strong></p></blockquote><ol class=""><li id="d5b2" class="md me iu lf b lg lh lj lk lz mf ma mg mb mh ly oj mj mk ml bi translated">析因实验设计的稳健数据分析:改进的方法和软件，萨马德，马吉德，<a class="ae mc" href="http://etheses.dur.ac.uk/2432/1/2432_443.pdf" rel="noopener ugc nofollow" target="_blank">http://etheses.dur.ac.uk/2432/1/2432_443.pdf</a></li></ol></div></div>    
</body>
</html>