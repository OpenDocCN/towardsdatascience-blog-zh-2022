<html>
<head>
<title>Learn the Core of MLOps — Building Machine Learning (ML) Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解MLOps的核心——构建机器学习(ML)管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-the-core-of-mlops-building-machine-learning-ml-pipelines-7242b77520b7#2022-10-15">https://towardsdatascience.com/learn-the-core-of-mlops-building-machine-learning-ml-pipelines-7242b77520b7#2022-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="04f5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">实施MLOps使人工智能发挥作用的实用指南</h2></div><h2 id="8def" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">为什么需要MLOps</h2><p id="04fd" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">众所周知，为了让人工智能发挥作用，真正的挑战不是建立一个机器学习(ML)模型，而是建立一个集成的ML系统，并在生产中持续运行它。这就是为什么MLOps的概念被开发出来，并且它正在数据科学家、ML工程师和AI爱好者中迅速获得动力。</p><p id="66f3" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">由于近年来对最大似然算法的大力研究，人工智能和最大似然在创造新的商业机会、提供更好的客户体验、提高运营效率等方面向组织展示了巨大的潜力。然而，在Jupyter笔记本中训练ML模型和在生产系统中部署ML模型之间存在巨大的技术差距。因此，许多公司还没有找到如何实现他们的人工智能/人工智能目标的方法，他们向人工智能操作系统寻求帮助，希望通过人工智能操作系统，他们可以使人工智能在现实世界的生产环境中工作，以真正获得人工智能和人工智能驱动的解决方案的好处</p><p id="83df" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">因此，我认为开发一系列解释如何实施MLOps实践的实用指南是非常有用的。这些指南将包括对关键MLOps组件、设计考虑因素以及实施示例代码的解释。</p><p id="54ea" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">如果我们纯粹从工程和实施的角度来看待MLOps，任何端到端MLOps解决方案都有三个核心部分:</p><ul class=""><li id="a570" class="lz ma iq ld b le lu lh lv ko mb ks mc kw md lt me mf mg mh bi translated">第一部分是— <strong class="ld ir"> <em class="mi">数据和特征工程管线</em> </strong></li><li id="9251" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">第二部分是— <strong class="ld ir"> <em class="mi"> ML模型训练和再训练管道</em> </strong></li><li id="f10e" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">第三部分是— <strong class="ld ir"> <em class="mi"> ML模型推理和服务管道</em> </strong></li></ul><p id="c0d6" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">MLOps以一种<strong class="ld ir"> <em class="mi">自动化</em> </strong>的方式将上述三条流水线缝合在一起，并确保ML解决方案是<strong class="ld ir"> <em class="mi">可靠的</em> </strong>、<strong class="ld ir"> <em class="mi">可测试的</em> </strong>和<strong class="ld ir"> <em class="mi">可再现的</em> </strong>。在这篇博客的剩余部分，我将一点一点地解释这三条管道。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mo"><img src="../Images/91c28267822372f84e922119eec06b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LbsW9CDcBzKwUsXk"/></div></div><p class="na nb gj gh gi nc nd bd b be z dk translated">照片由<a class="ae ne" href="https://unsplash.com/@hiteshchoudhary?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Hitesh Choudhary </a>在<a class="ae ne" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h2 id="93de" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">实施MLOps解决方案的关键构建模块</h2><p id="9309" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">下图显示了上述3条MLOps管道的所有关键组件。正如您所看到的，构建端到端的MLOps解决方案可能非常复杂，但请不要担心，在接下来的系列文章中，我将逐一详细解释它们，并演示如何实现每个组件。</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nm"><img src="../Images/e7f645bed6df5ffb36ab71d22d5812cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QnbFTuw2uShHq6x3N9bhTQ.png"/></div></div><p class="na nb gj gh gi nc nd bd b be z dk translated">学习MLOps的核心——构建ML管道(图片由作者提供)</p></figure><h2 id="cb74" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">数据和特征工程管线</h2><p id="e043" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">我将从数据和特征工程管道开始，因为数据是任何ML系统的核心。一般来说，数据管道是指提取、转换和加载(ETL)管道，数据工程师通过这些管道从源系统摄取原始数据，然后将数据清理并转换为可靠的高质量信息，供下游数据消费者使用。如果您有兴趣了解如何构建数据管道，我有一篇单独的文章。<a class="ae ne" href="https://medium.com/@weiyunna91/learn-the-core-of-data-engineering-building-data-pipelines-21a4be265cc0?source=friends_link&amp;sk=a15ca2e70b29b46a33adc695a341349e" rel="noopener">学习数据工程的核心——构建数据管道</a>。请随意阅读。</p><p id="bd84" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">ML的独特之处在于<strong class="ld ir"> <em class="mi">原始数据</em> </strong>需要转换成<strong class="ld ir">特征</strong>以便ML模型可以有效地从数据中学习有用的模式。将原始数据转换成特征的过程称为<strong class="ld ir"> <em class="mi">特征工程。</em> </strong>因此，这篇文章的重点将是实现特征工程管道，并介绍什么是特征库。</p><p id="79da" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">有各种各样的特征工程技术，包括插补、异常值处理、宁滨、对数变换、一键编码等等。如果你想了解更多，我相信你可以谷歌一下，在特色商店里会有很多博客。然而，我想在这里强调的是，通常对于机器学习(ML)项目，数据科学家将大量的时间和精力投入到特征工程中，以便在他们的机器学习模型上获得体面的性能。因此，存储这些特征以供发现和重用是有价值和必要的。<strong class="ld ir"> <em class="mi"> </em> </strong>因此,“功能商店”的概念得到了发展，并且在功能商店上有相当多的开源和商业产品。然而，功能存储不仅仅是为了功能重用。<strong class="ld ir"> <em class="mi">特征库是机器学习的数据管理层，允许您共享&amp;发现特征并创建更有效的机器学习管道。</em> </strong>任何MLOps解决方案中最重要的两个部分——模型训练和模型服务——都可以利用特征存储。总之，功能存储提供了以下功能和优势:</p><ul class=""><li id="4b5b" class="lz ma iq ld b le lu lh lv ko mb ks mc kw md lt me mf mg mh bi translated">特征发现和重用</li><li id="a28f" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">用于模型训练和服务的一致特征工程</li><li id="4b6b" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">监控数据和特征漂移</li><li id="7677" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">训练数据集的再现性</li></ul><p id="76ba" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">对于完整的MLOps解决方案，必须为模型训练和服务建立特征工程管道和特征存储。这是一个非常高层次的介绍。我将很快发表一篇关于特色商店的博客。如果您想在新日志发布时收到通知，请随时关注我。</p><h2 id="7d93" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ML模型训练和再训练管道</h2><p id="7eb4" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">一旦特征工程完成，下一步将是ML模型训练。ML模型训练是一个高度迭代的过程，这就是为什么它也被称为<strong class="ld ir"> <em class="mi"> ML模型实验</em> </strong>的原因。数据科学家必须使用不同的参数和超参数运行许多实验，以便找到具有最佳性能的模型。因此，数据科学家需要一种系统的方法来记录和跟踪每次实验运行的超参数和指标，以便他们可以比较每次运行，并找到最佳运行。有一些开源库可以帮助数据科学家记录和跟踪模型实验，如<a class="ae ne" href="https://mlflow.org/" rel="noopener ugc nofollow" target="_blank"> mlflow </a>。mlflow是一个管理ML生命周期的开源平台，包括实验、再现性、部署和中央模型注册。</p><p id="f3b4" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">除了模型训练之外，数据科学家还需要<strong class="ld ir"> <em class="mi">评估和测试</em> </strong>模型，然后才能适应将模型放入真实的生产环境。他们需要确保该模型在真实世界的实时数据中表现良好，就像在训练数据中一样。因此，选择正确的测试数据集和最相关的性能指标是非常重要的。有了MLOps，模型训练和模型评估都需要自动化。</p><p id="cfe3" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">ML驱动系统的关键挑战是模型性能由用于训练它的数据决定。然而，<strong class="ld ir"> <em class="mi">数据总是变化的。</em> </strong>因此，对于大多数ML驱动的场景，重新训练模型变得绝对必要。通常，有几种方式来触发模型重新训练:</p><ul class=""><li id="ed6e" class="lz ma iq ld b le lu lh lv ko mb ks mc kw md lt me mf mg mh bi translated"><strong class="ld ir"> <em class="mi">基于计划的</em> </strong> —以预定义的时间间隔，例如每周一次，用最新数据重新训练模型。根据数据变化的速度和其他业务需求，计划频率可能会有很大差异。</li><li id="fb77" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated"><strong class="ld ir"><em class="mi"/></strong>—当识别到漂移时，如数据漂移、特征漂移或模型性能恶化，触发模型重新训练。为了实现完全自动化的方法来重新训练模型，需要有一个健壮的监控解决方案来监控数据变化和模型变化。</li></ul><p id="2b0e" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">MLOps解决方案的理想结果是不仅自动重新训练模型，而且基于预定义的模型指标评估新训练的模型并选择最佳运行。</p><h2 id="a338" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ML模型推理/服务管道</h2><p id="4055" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">一旦模型被训练和评估，下一步将是把模型放到真实的生产环境中使用。一般来说，有两种方式来为训练好的ML模型服务:</p><ul class=""><li id="355a" class="lz ma iq ld b le lu lh lv ko mb ks mc kw md lt me mf mg mh bi translated"><strong class="ld ir"> <em class="mi">离线批量推断</em> </strong> —调用ML模型，以一定的频率进行预测。频率可以高达每天、每周，甚至更长，但也可以低至每分钟。当频率非常低时(非常频繁)，您可以将流数据管道与ML模型推理集成在一起。当批量推理的数据量非常大时，就需要一个分布式计算框架。例如，您可以将模型作为Spark用户定义函数(UDF)加载，并使用分布式计算进行大规模并行推理。</li><li id="29d5" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated"><strong class="ld ir"> <em class="mi">在线实时推理</em> </strong> —将ML模型封装为REST API端点。对于在线实时推理，打包的ML模型通常被嵌入到应用程序中，其中模型预测是根据请求生成的。当请求量很大时，可以将模型打包成容器映像，部署到Kubernetes环境中进行自动缩放，以响应<strong class="ld ir"> <em class="mi">大量的预测请求。</em>T15】</strong></li></ul><p id="87d9" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">如前所述，数据决定了模型的性能。在现实世界中，数据总是在变化，模型性能也不可避免地会发生变化，而且经常会恶化。因此<strong class="ld ir"> <em class="mi">拥有一个监控解决方案来跟踪生产模型的变化以及用于反馈这些变化的数据/特征是非常必要的。</em> </strong>一旦识别出重大变更，监控解决方案需要能够触发模型再训练或者向相关团队发送通知，以便可以立即进行修复。这对于业务关键的ML驱动的应用程序尤其必要。通常，ML模型监控包括以下4个类别:</p><ul class=""><li id="c15b" class="lz ma iq ld b le lu lh lv ko mb ks mc kw md lt me mf mg mh bi translated">预测漂移</li><li id="3cae" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">数据/特征漂移</li><li id="ba70" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">目标漂移</li><li id="88cb" class="lz ma iq ld b le mj lh mk ko ml ks mm kw mn lt me mf mg mh bi translated">数据质量</li></ul><p id="b9e7" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">监控ML解决方案既有开源产品，也有商业产品。例如，<a class="ae ne" href="https://www.evidentlyai.com/" rel="noopener ugc nofollow" target="_blank">显然AI </a>是一个开源的Python库，用于评估、测试和监控ML模型从验证到生产的性能。</p><p id="8622" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">到目前为止，我们已经涵盖了完整MLOps解决方案的3个关键管道——数据和特征工程管道、ML模型训练和再训练管道、ML模型推理管道以及ML模型监控。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h2 id="657b" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">MLOps解决方案的规模范围</h2><p id="8ebe" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">MLOps是一个相当新的概念，你可能会从上面的介绍中看出，MLOps涉及到将许多不同的组件拼凑在一起，以便使AI在现实世界中工作。因此，许多人认为MLOps令人生畏且复杂。然而，当我们谈论实施端到端MLOps解决方案时，需要绘制一个<strong class="ld ir">规模谱</strong>。</p><p id="585c" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">例如，如果您的ML解决方案是小规模和基于批处理的—批处理数据管道、批处理培训、批处理推理，并且数据量不需要分布式计算—那么实施MLOps并不困难，甚至数据科学家也可以成为“全栈”并拥有整个解决方案。然而，如果你谈论的是大规模的、持续的训练和实时的推理，这可能是相当复杂的，需要多个团队和不同的基础设施一起工作。</p><p id="a34e" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">因此，在接下来的帖子中，我将解释一些ML参考架构和在不同规模下实现MLOps的最佳实践，因为每个规模可能涉及非常不同的技能集和不同的基础设施设置。敬请关注。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="a2dc" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">我希望你喜欢阅读这篇博客。如果你想在有新博客发表时得到通知，请随时关注我的Medium，这肯定会激励我写更多。</p><p id="32ec" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">如果想看到更多围绕现代高效数据+AI栈的指南、深度潜水、见解，请订阅我的免费简讯— <a class="ae ne" href="https://yunnawei.substack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ir"> <em class="mi">高效数据+AI栈</em> </strong> </a>，谢谢！</p><p id="c77f" class="pw-post-body-paragraph lb lc iq ld b le lu jr lg lh lv ju lj ko lw ll lm ks lx lo lp kw ly lr ls lt ij bi translated">注:以防万一你还没有成为媒体成员，并希望获得无限制的媒体访问，你可以使用我的<a class="ae ne" href="https://medium.com/@weiyunna91/membership" rel="noopener">推荐链接</a>注册！我可以免费给你一点佣金。非常感谢你的支持！</p></div></div>    
</body>
</html>