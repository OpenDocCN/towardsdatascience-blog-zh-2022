<html>
<head>
<title>Handling Unstructured Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理非结构化数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/handling-unstructured-data-feaeec2a6231#2022-02-01">https://towardsdatascience.com/handling-unstructured-data-feaeec2a6231#2022-02-01</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="a815" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用可执行的BPMN图和工作流引擎走向智能自动化。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/d5251727a6fac062fbc7632d021531e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LIcZSdENCa3PqM_7"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动发起人</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d34e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这一点上，我相信可以说我们已经很好地处理了结构化数据。作为一个行业，我们有大量的工具来处理、存储和分析数据的行和列。我们有更多的工具来绘制视觉效果、创建仪表板和生成报告。每天都有很多关于执行探索性数据分析(EDA)、机器学习、统计和SQL主题的文章。每个月甚至有更多的课程和书籍被开发和发布。但是对于那些行列不整齐的文档，比如PDF或网页，该怎么办呢？这些也是结构化的，但是它们没有始终如一的行和列结构。在这些上下文中，术语“非结构化”经常被不严格地使用。我相信，真的没有非结构化数据这个概念。一切都有组织的模式；否则，我们作为人类什么都不会懂。</p><p id="57b0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">每天都有大量信息在文档中产生、发布、张贴和共享。我每天都收到大量的电子邮件。因此，我开始考虑创建一个环境，让所有这些“非结构化”的文档可以无缝地转化为信息，被处理、读取、解析并组织成“行和列”。我越想越兴奋。请继续阅读，了解我的想法和方法。</p><h1 id="ca60" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">工作流或管道</h1><p id="3eaa" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我们希望处理文档，通过信息提取读取值，建立数据记录并将记录发送到数据库。用一句话写下这样的要求看起来很容易，但是很难与合作的观众交流和想象。和很多人坐下来，让它发生，那就更难了！</p><p id="f94c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以我们需要的是流程图或图表。如果我们使用可执行图表而不是PowerPoint或Visio图像会怎么样？现在，开发人员和非开发人员可以平等地参与讨论。最近，我对可执行的BPMN ( <a class="ae kz" href="https://en.wikipedia.org/wiki/Business_Process_Model_and_Notation" rel="noopener ugc nofollow" target="_blank">业务流程模型和符号</a>)图表产生了兴趣。下面的图1展示了我们用例的BPMN图。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mt"><img src="../Images/9935eb252da8f9d744c1669c8bd1c0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ive6-uYP0eR5e26Cq77dZw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图1:运行在Ubuntu上的<a class="ae kz" href="https://camunda.com/download/modeler/" rel="noopener ugc nofollow" target="_blank"> Camunda modeller </a>应用程序的截图——图片由作者于2022年1月提供</p></figure><p id="f2e0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">图1直观地表示了需求，但是也可以部署到工作流引擎，因此是可执行的。让我们先看看这些步骤，然后讨论它们是如何执行的。</p><h2 id="6597" class="mu lx iu bd ly mv mw dn mc mx my dp mg lj mz na mi ln nb nc mk lr nd ne mm nf bi translated">步伐</h2><ul class=""><li id="59a9" class="ng nh iu lc b ld mo lg mp lj ni ln nj lr nk lv nl nm nn no bi translated">从文件中获取文本:对于给定的文档，我们需要提取文本</li><li id="d4f3" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">单词袋:嗯，不是一个非常用户友好的描述。<a class="ae kz" href="https://en.wikipedia.org/wiki/Bag-of-words_model" rel="noopener ugc nofollow" target="_blank">单词包</a>是对n元文法列表的文本挖掘描述。或许我们可以将描述更新为<strong class="lc iv"><em class="nu">‘剖析文本’。</em> </strong>我们需要分析每个文档的文本，以找出如何用可用的解析器匹配文本。</li><li id="86b9" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">选择解析器:有些人可能不知道什么是解析器！在我们的例子中，我们将从文本中提取信息。然后，基于文本概要，我们将调用特定的解析策略。</li><li id="9ade" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">Parse:在流程图上可能不是一个有用的描述，但是它从文本中提取了信息。我们也可以将该步骤描述为<strong class="lc iv"> <em class="nu">检索信息</em> </strong>或特定内容。</li><li id="f418" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">提交到数据库:一旦我们提取了所需的信息，我们需要创建一个记录，并根据解析策略将该记录提交到数据库。</li></ul><p id="96cb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过对图表进行一些调整和更新，我们可以很容易地对从给定文档中提取信息的管道和步骤达成共识。制定一个工作流程图，列出要采取的步骤，这是很好的第一步。我们将此理解为——对于每个文档，创建一个工作流实例，执行并跟踪所有步骤，直到完成。</p><h1 id="4d43" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">在引擎上执行工作流程图</h1><p id="2696" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">有一个清晰和一致的可执行图当然很好，但是你还需要执行该执行的技术。因此，举例来说，如果您有一个工作流引擎和服务工作，它会有所帮助。</p><p id="e79c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">服务作业需要作为流程模型的助手。在这里，我们谈论这样的事情:-</p><ul class=""><li id="0bee" class="ng nh iu lc b ld le lg lh lj nv ln nw lr nx lv nl nm nn no bi translated">服务作业可能会检测到要处理的新文档</li><li id="b946" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">服务作业必须检索文档名称，并在工作流引擎上创建工作流的新实例，以启动流程迭代</li><li id="1708" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">作为工作流的一部分，需要服务作业来处理和执行外部任务。</li></ul><p id="d8f4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">工作流引擎实现工作流图并管理每个任务的完成状态。图2展示了部署到工作流引擎的工作流图。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ny"><img src="../Images/31ebd4821a161a80d8e6880c83a9bb1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aauM4PmlKisNjEfjD3YDZA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图2:<a class="ae kz" href="https://camunda.com/products/camunda-platform/" rel="noopener ugc nofollow" target="_blank">cam unda工作流引擎</a>的截图，带有部署的BPMN图——图片由作者于2022年1月提供</p></figure><p id="0ffd" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">此时，我们有了一个部署在工作流引擎上的业务流程模型图。如下图所示，启动工作流引擎就像执行。蝙蝠还是。提供了sh文件。</p><pre class="kk kl km kn gu nz oa ob oc aw od bi"><span id="ed05" class="mu lx iu oa b gz oe of l og oh">(base) david@david-Z270N-WIFI:~/Documents/camunda$ ./start.sh</span></pre><p id="8e7e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在生产环境中，您可能希望使用<a class="ae kz" href="https://medium.com/@benmorel/creating-a-linux-service-with-systemd-611b5c8b91d6" rel="noopener"> systemd </a>或类似的策略创建一个服务，并让该服务在引导时启动，在失败时重启。使用crontab启动引擎通常是可行的，但是如果没有systemd提供的监控或服务重启模式，服务通常会变得不可用或不稳定。</p><p id="f767" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当引擎启动时，您将获得大量日志数据，如图3所示</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oi"><img src="../Images/ed824202a5752520bec181c8a5637378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PieTb3TqMtwTONBlm3x7sg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图3:作者2022年1月拍摄的Camunda工作流引擎启动截图</p></figure><p id="bb35" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以导航到localhost:8080以查看工作流引擎驾驶舱。</p><p id="30c9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着引擎的运行，我们现在已经在引擎上部署了一个可执行的BPMN图，一切都在等待文档的到来。我们现在需要一份服务工作和一份文件。工作流程图可以定义各种任务，例如:-</p><ul class=""><li id="277e" class="ng nh iu lc b ld le lg lh lj nv ln nw lr nx lv nl nm nn no bi translated">人工任务:需要人工交互和确认任务完成的表单、web UI或其他动作。手动离线活动。</li><li id="aa29" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">外部任务:外部服务任务提供服务并确认任务完成。</li><li id="f973" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">内部任务:内置任务或决策可以由平台在没有帮助的情况下执行。</li></ul><p id="b922" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为本文部署的图是基于外部任务的，因此工作流引擎将不会找到任何工作，直到服务作业创建了一个实例，并且每个任务都分配了一个外部工作器。图4展示了外部任务的参数。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/74a50e46eee57cd0da65ab028d46e1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bg39wPa-94CR-DyIYqLPTg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图4:作者2022年1月发布的BPMN图和外部任务的截图</p></figure><p id="3378" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">图表中的每个步骤或任务都有一组参数。实现被定义为外部的，主题名是外部服务作业的标签。每个具有主题名称的外部任务都需要一个服务作业。因此，我们在图4中看到,“getTextFromFile”是一个外部任务，通过主题名“getTextFromFile”引用。哦，亲爱的，不是用户友好的，但向前！</p><h1 id="e5f7" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">服务工作</h1><p id="646e" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">就这一点而言，架构很简单。绘制BPMN图是客户端笔记本电脑或台式机的一项活动。运行工作流引擎可通过不同方式实现，例如:-</p><ul class=""><li id="c94e" class="ng nh iu lc b ld le lg lh lj nv ln nw lr nx lv nl nm nn no bi translated">在本地，比如本文中</li><li id="769a" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">使用第三方或专有供应商的SaaS托管版本</li><li id="c570" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">启动云实例、AWS保留的虚拟机或其他spot实例，并托管您自己的服务器。重要的是，使用systemd定义的服务安排引擎启动，管理防火墙安全和备份。</li></ul><p id="662b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因此，如果您有一个独特的工作流引擎服务器或主机，那将是最好的。此外，至少需要两种类型的服务工作，它们是</p><ul class=""><li id="f2c8" class="ng nh iu lc b ld le lg lh lj nv ln nw lr nx lv nl nm nn no bi translated">检测新文档并在工作流引擎上创建实例的作业。您可能正在轮询SharePoint列表，监视系统目录中的文件更改，或者对数据库触发器做出反应。将电子邮件接收到邮箱中可能会使用服务作业来注册工作流实例并触发工作流处理。</li><li id="d0e8" class="ng nh iu lc b ld np lg nq lj nr ln ns lr nt lv nl nm nn no bi translated">与工作流引擎连接并为这些外部任务提供服务的作业</li></ul><p id="29b1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您有运行时环境、凭证、API密钥、防火墙访问和其他元素来在生产环境中部署服务作业，这将会很有帮助。为了便于说明，我们将讨论本文工作流中的几个外部任务。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure><p id="cf18" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们需要一个函数从给定的文档中获取文本。您可能开始问自己什么类型的文档，我们是否需要一种方法来用不同的模块或阅读器打开特定的文档？好吧，我希望你问的是这些问题，这些都是很棒的问题。</p><p id="d0e9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">上面显示的函数“get_data_from_given_path”值得进行一些讨论。它采用一个参数file_name，该参数的数据类型为“pycamunda.variable.variable”。我们正在使用Python Camunda客户端，并使用工作流实例的数据结构。</p><pre class="kk kl km kn gu nz oa ob oc aw od bi"><span id="b747" class="mu lx iu oa b gz oe of l og oh">textback = p.from_file(file_name.value)</span></pre><p id="6985" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">那行代码是伏都教的吗！p是什么？我们需要讨论变量名、清晰可读的代码，以及更好地让人们以后阅读。p是在代码文件顶部的模块导入阶段定义的。</p><pre class="kk kl km kn gu nz oa ob oc aw od bi"><span id="facb" class="mu lx iu oa b gz oe of l og oh">from tika import parser as p</span></pre><p id="d578" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">p代表<a class="ae kz" href="https://tika.apache.org/" rel="noopener ugc nofollow" target="_blank"> Apache Tika Python </a>包装</p><p id="d88a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">所以我们将文件传递给Apache Tika，它会计算出我们传递的是什么类型的文件，以及如何为我们获取文本。一行代码，我们就能得到文本！Tika可以返回文档内容和/或文件级元数据。在Tika中，有不同的操作，如语言检测、语言转换和OCR。一种技术是调用语言检测，并基于返回代码；您知道文件是否包含图像或文本，因此需要OCR，Tika可以处理。Tika与Tesseract集成，可从图像中恢复文本。</p><p id="9827" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">其余代码行决定返回数据结构，并确保字符串值不超过Camunda引擎中的最大字符串长度(4000个字符)</p><pre class="kk kl km kn gu nz oa ob oc aw od bi"><span id="dde0" class="mu lx iu oa b gz oe of l og oh">if len(text) &lt; 4000:<br/>        return {'text': text}<br/>    else:<br/>        return {'text': text[0:3800]}</span></pre><p id="6cba" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该函数将返回一个字典或键-值对，键为“text ”,字符串变量不超过3，800个字符。这不是一个特别聪明的捷径，但是我们可以将数据类型从字符串类型改为JSON对象，以避免数据类型的限制。显然，从简单的字符串类型转移到更复杂的结构会引入更多的处理和代码。</p><p id="7e86" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用Apache Tika和Python函数，我们可以从文件中获取文本，而无需设计和处理不同的文件格式。Apache项目和开源维护者万岁！您确实需要阅读文档并构建错误处理。许多文档类型是可用的，并且是很少使用的旧格式的遗产。</p><pre class="kk kl km kn gu nz oa ob oc aw od bi"><span id="3e4f" class="mu lx iu oa b gz oe of l og oh">def bag_of_words(text: pycamunda.variable.Variable) -&gt; typing.Dict:<br/>    bow = textProcessor.tokenize(text.value)<br/>    print("bow")<br/>    return  {'BoW' : bow}</span></pre><p id="5d33" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下一个函数是“单词包”函数。它在调用中使用一个工作流变量，并利用textProcessor对象方法tokenize，从文本中创建一个标记(<a class="ae kz" href="https://en.wikipedia.org/wiki/N-gram" rel="noopener ugc nofollow" target="_blank">n-gram</a>)或单词列表。textProcessor对象是我的NLP类的一个实例，你可以在Github <a class="ae kz" href="https://github.com/CognitiveDave/nlp/blob/main/nlp.py" rel="noopener ugc nofollow" target="_blank">上找到它。</a></p><p id="11b7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这两个函数是外部Python任务的示例。外部任务可以根据用例用不同的语言编码。接下来，我们需要将这些服务作业粘附到工作流图和引擎上。</p><pre class="kk kl km kn gu nz oa ob oc aw od bi"><span id="f633" class="mu lx iu oa b gz oe of l og oh">worker.subscribe(<br/>        topic="getTextFromFile",<br/>       func=(get_data_from_given_path),<br/>        variables=['file_name']<br/>        )<br/>    <br/>worker.subscribe(<br/>        topic='BagOfWords',<br/>        func=bag_of_words,<br/>        variables=['text']<br/>    )</span></pre><p id="8b4f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">BPMN图中的主题“getTextFromFile”通过订阅BPMN任务主题连接到函数get _ data _ from _给定_path。现在，您可以开始看到服务工作的构建。使用工作人员和主题订阅来执行粘附到工作流引擎的任务的函数。该模型类似于使用MQTT和其他消息代理的Pub/Sub模型。</p><p id="8723" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我在本文中使用的工作对象是由<a class="om on ep" href="https://medium.com/u/eb4cfdd77b0d?source=post_page-----feaeec2a6231--------------------------------" rel="noopener" target="_blank">彼得·克劳克</a>开发和解释的。如果你想了解工人，我建议你读彼得的文章，链接如下。工作人员连接到工作流引擎，收集感兴趣的可用外部任务，使用锁更新工作流引擎以保留任务，然后向引擎提供完成状态和返回值。工作人员必须始终与引擎保持联系，并轮询工作流实例以查找要处理的新任务。</p><p id="58a2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是。我们如何创建工作流实例或处理单个文档？考虑以下代码。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ok ol l"/></div></figure><p id="1ac9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">首先，第1行是要处理的文件列表，在本例中是四个测试PDF文档。我可以使用操作系统模块，直接从文件夹中获取文件，轮询SharePoint列表或任何数量的组合，包括S3桶。</p><p id="acb1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在第7行，我们有工作流引擎的URL。第11行和第12行遍历文件列表，并为每个文件创建一个工作流实例。第14行实际上是将实例发送到工作流引擎。</p><p id="2f4b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在不涉及太多细节的情况下，我们可以使用Python谈论BPMN图、工作流引擎和服务作业，让我们能够对文档执行自然语言处理，而不用担心服务器性能或阻塞线程。事实上，将Apache Tika与OCR相结合，我们可以从文档中获取文本，而不用担心文档的格式。</p><p id="0752" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">无可否认，从文档中获取文本并将其转换成单词包(n-grams)是手头任务中最简单的部分。然而，从文本中提取信息并将该信息映射到数据库记录格式要复杂得多。</p><h2 id="d3b0" class="mu lx iu bd ly mv mw dn mc mx my dp mg lj mz na mi ln nb nc mk lr nd ne mm nf bi translated">选择解析器</h2><p id="bcda" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我们没有讨论工作流中的两个后续步骤，因为它们必须为给定用例中的特定文档流构建。</p><p id="0cb1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当确定给定文本流的正确解析器时，开发人员和设计人员有许多不同的机制和选项。工作流引擎支持决策。我们可以基于文档元数据建立一个规则，并且如果有少量具有可靠元数据标记的良好描述的文档类，那么定义一个决策步骤，这是非常简洁和理想的。但是，如果存在定义不完善的文档类或元数据，那么选择合适的解析器可能是一项基于带有下拉选择器的表单的人工任务。任务和参与者的这种强大组合允许某些问题浮出水面进行人工干预，但仍然保持最高水平的自动化。</p><p id="44ec" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">尽管如此，将文本流映射到预定义的解析器并不是真正的问题。更确切地说，为一类文档预先定义信息提取策略是很有挑战性的。基于OCR的发票处理就是一个例子，工程师记录了良好的准确性，这是由于使用标准软件生成大致相似的发票布局的组织很少使用变体。同样，公用事业账单也遵循类似的模式。然而，阅读法律合同更复杂的是提取某些条款、条件和义务。</p><h2 id="aaab" class="mu lx iu bd ly mv mw dn mc mx my dp mg lj mz na mi ln nb nc mk lr nd ne mm nf bi translated">从语法上分析</h2><p id="a7b1" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">如果您成功地预定义、测试和验证了一个信息提取函数，那么调用解析器需要在服务作业中进行编排，以便根据前面的步骤将文本路由到正确的函数。工作流引擎和服务作业策略将运行良好。</p><h2 id="9868" class="mu lx iu bd ly mv mw dn mc mx my dp mg lj mz na mi ln nb nc mk lr nd ne mm nf bi translated">构建数据记录并将其发布到数据库</h2><p id="83d5" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我们开始从非结构化范式过渡回结构化领域。我们可以将提取的信息编码到传统的行和列中，甚至用JSON结构表示信息，从而允许对文档数据库(MongoDB或CouchDB)进行CRUD操作。我更喜欢在解析器函数中进行处理，并在一个离散的步骤中返回要提交的数据库对象。</p><h1 id="2e01" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">关闭</h1><p id="89fe" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">从非结构化文档中提取信息是一个大课题，而编排自动化管道是极其复杂的。在这篇文章中，我分享了一个让我感兴趣和兴奋的方法。以前，我对可执行的BPMN声明和工作流引擎的优点不自信，但是经过大量的思考、研究和原型制作，我更加自信了。</p><p id="b274" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我使用Celery workers、REDIS、RabbitMQ、Apache Spark和许多线程和集群并行处理的变体评估了其他方法。</p><p id="395b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">写这篇文章对我来说是一次旅程，是对不同可用方法的调和，我对<strong class="lc iv"> <em class="nu">智能自动化</em> </strong>的整个概念感到更舒服。这里描述的方法利用了自然语言处理、OCR和业务规则确定。一旦这些模型被验证和批准使用，使用分类器或其他机器学习模型很容易作为一个步骤插入到BPMN图中。</p><p id="de7c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">如果您对智能自动化、从文档中提取信息或工作流程编排有什么看法，我很想听听您的想法。</p><h1 id="48de" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">参考资料和原始材料</h1><h2 id="eb8d" class="mu lx iu bd ly mv mw dn mc mx my dp mg lj mz na mi ln nb nc mk lr nd ne mm nf bi translated">彼得的文章链接</h2><div class="oo op gq gs oq or"><a href="https://medium.com/@klauke.peter/implementing-an-external-task-worker-for-camunda-in-python-566b5ebff488" rel="noopener follow" target="_blank"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">用Python实现Camunda的外部任务工作器</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">如何实现一个用于外部服务任务的worker，它与Python中的流程实例交换变量。</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">medium.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf kt or"/></div></div></a></div><h2 id="85f3" class="mu lx iu bd ly mv mw dn mc mx my dp mg lj mz na mi ln nb nc mk lr nd ne mm nf bi translated">使用Apache Tika转换文档</h2><div class="oo op gq gs oq or"><a href="https://medium.com/@masreis/text-extraction-and-ocr-with-apache-tika-302464895e5f" rel="noopener follow" target="_blank"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">使用Apache Tika进行文本提取和OCR</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">Apache Tika是一个用于从大多数文件格式中提取文本的库，包括PDF、DOC和PPT。Tika有一个简化的…</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">medium.com</p></div></div><div class="pa l"><div class="pg l pc pd pe pa pf kt or"/></div></div></a></div><div class="oo op gq gs oq or"><a href="https://medium.com/mlearning-ai/convert-any-type-of-document-to-text-with-apache-tika-using-python-api-ff306c467b3" rel="noopener follow" target="_blank"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">使用Python API通过Apache Tika将任何类型的文档转换为文本</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">甚至您的祖母也可以使用这个库来提取不同类型文件的内容。</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">medium.com</p></div></div><div class="pa l"><div class="ph l pc pd pe pa pf kt or"/></div></div></a></div><h2 id="fd0f" class="mu lx iu bd ly mv mw dn mc mx my dp mg lj mz na mi ln nb nc mk lr nd ne mm nf bi translated">替代方法</h2><p id="7a9b" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">拥有RabbitMQ的芹菜工人可以结合Apache Tika来实现类似的工作流，但是没有可执行的BPMN图。</p><div class="oo op gq gs oq or"><a href="https://betterprogramming.pub/background-processing-with-rabbitmq-python-and-flask-5ca62acf409c" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">用RabbitMQ、Python和Flask进行后台处理</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">运行后台进程以提高web应用程序的性能</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">better编程. pub</p></div></div><div class="pa l"><div class="pi l pc pd pe pa pf kt or"/></div></div></a></div><p id="4b98" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本文中对特定供应商或第三方的引用并不表示认可，所有讨论的技术都基于可用的开源软件。专有工作流引擎提供了重要的功能，如日志和审计跟踪，这些功能更适合集成到受监管的行业中，如GMP、Sarbanes Oxley或金融服务监管环境。在部署智能自动化解决方案之前，务必评估控制和监管要求。</p><div class="oo op gq gs oq or"><a href="https://cognitivedave.medium.com/membership" rel="noopener follow" target="_blank"><div class="os ab fp"><div class="ot ab ou cl cj ov"><h2 class="bd iv gz z fq ow fs ft ox fv fx it bi translated">通过我的推荐链接-大卫·摩尔加入媒体</h2><div class="oy l"><h3 class="bd b gz z fq ow fs ft ox fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oz l"><p class="bd b dl z fq ow fs ft ox fv fx dk translated">cognitivedave.medium.com</p></div></div><div class="pa l"><div class="pj l pc pd pe pa pf kt or"/></div></div></a></div></div></div>    
</body>
</html>