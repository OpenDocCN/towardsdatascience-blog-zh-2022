<html>
<head>
<title>12 Essential Visualizations and How to Implement Them, Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">12个基本的可视化以及如何实现它们，第2部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/12-essential-visualizations-and-how-to-implement-them-part-2-e47c1d4b9784#2022-10-19">https://towardsdatascience.com/12-essential-visualizations-and-how-to-implement-them-part-2-e47c1d4b9784#2022-10-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eb4f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们看看如何用Python和Streamlit创建12个最有用的图形和图表</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e630d7bfa393aa30031940c204f6d76a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCR4l48i-XXzas4dI-6yyg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/silver-iphone-6-on-clipboard-with-statistical-data-5561923/" rel="noopener ugc nofollow" target="_blank"> Olya Kobruseva </a>拍摄</p></figure><blockquote class="kz"><p id="bf01" class="la lb it bd lc ld le lf lg lh li lj dk translated"><em class="lk">“当我回顾过去一年为研讨会和咨询项目创作的150多幅视觉作品时，我只使用了十几种不同类型的视觉作品”，</em> Cole Nussbaumer Knaflic用数据讲述故事</p></blockquote><p id="0231" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt lu lv lw lx ly lz ma mb mc md me mf lj im bi translated">在《T4》第一部中，我们看了科尔·努斯鲍默·克纳弗里克(CNK)在她的书<em class="mg">用数据讲故事</em>中确定的12种视觉效果中的前6种(见注释1)。在本文中，我们将处理第二个6的实现。这些是各种各样的条形图，瀑布图和方形面积图。</p><p id="8ead" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">所有的实现都使用Pandas plots和/或Mathplotlib，并且是为Streamlit编写的，尽管也有一个Jupyter笔记本的版本。本文中使用的所有代码(Streamlit和Jupyter)和数据都可以从我的Github页面下载。可下载的代码可能包括下面没有包括的附加示例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/5239caca5848e1026d98f30188e2766e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZK1VbgVU91-M18Pb.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">第二组6个视觉效果的变化——作者图片</em></p></figure><h1 id="172b" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">条形图</h1><p id="53e6" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">CNK认为，条形图通常被避免使用，因为它们很常见。但这正是它们有用的地方！人们习惯于看到它们，所以它们很容易理解。这意味着你的观众花更少的脑力解释你的图形，更多的精力理解数据。</p><p id="a12a" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">因此，我们不应该回避条形图，而应该把它作为一种简单的方法，以一种容易理解的方式表达数据的含义。</p><p id="29cd" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">条形图还具有易于创建的优点，因为它们包含在大多数可视化库中。</p><p id="b3a4" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">CNK将条形图分为4类，垂直、水平、垂直堆叠和水平堆叠，我们将依次来看。</p><h2 id="0b8b" class="nk mo it bd mp nl nm dn mt nn no dp mx lu np nq mz ly nr ns nb mc nt nu nd nv bi translated">零基线问题</h2><p id="9134" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">但是首先要说一下基线。CNK坚持认为，所有的条形图都应该有一个零基线，否则它们就有被误导的风险，或者更严重的是，被操纵的风险。</p><p id="5c6a" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这方面的一个例子是，CNK让我们注意到了福克斯新闻频道在巴拉克·欧巴马总统任期内发表的一份条形图。他们在考虑如果奥巴马的前任乔治·w·布什的税收改革被允许终止会发生什么。</p><p id="93d8" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">现实情况是最高税率将从35%提高到39.6%——绝对增长4.6%，相对增长约13%。</p><p id="5956" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">图表看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/6be1601d64554b776d571902eba37f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2vlQPolRjMSLrRUo.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有非零基线的误导性图表设计—图片由作者提供</p></figure><p id="e557" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">基线从34%开始，因此增长看起来非常巨大。这是因为右边一栏的大小几乎是左边一栏的5倍。当然，这并没有恰当地反映实际的增加。</p><p id="2c89" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">一个类似但基线为零的图表告诉我们真实的情况:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/2ba27bd06dec0a0b4e4b912c88f853cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UPW16otfAT7Egu9I.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">更好的零基线图表设计—作者图片</p></figure><p id="0c77" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">由此得出的结论是，条形图的基线通常应该为零，如果不是一直为零的话。</p><h2 id="05a2" class="nk mo it bd mp nl nm dn mt nn no dp mx lu np nq mz ly nr ns nb mc nt nu nd nv bi translated">数据</h2><p id="e84f" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">在我们开始绘图之前，我们需要获得一些数据。我们将使用2022年冬季奥运会的奖牌榜作为我们将要查看的各种条形图的数据。这是我们需要的初步代码。这些数据是公开的，我是从<a class="ae ky" href="https://en.wikipedia.org/wiki/2022_Winter_Olympics_medal_table" rel="noopener ugc nofollow" target="_blank">维基百科</a>的表格中复制的(见注释2)。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="46e1" class="nk mo it nz b gy od oe l of og">import streamlit as st<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span><span id="2005" class="nk mo it nz b gy oh oe l of og">medals =  pd.read_csv('data/2022WinterOlympics.csv')</span></pre><p id="78a5" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">该数据记录了前5名国家获得的金牌、银牌和铜牌的数量以及奖牌总数。这是它的样子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/cc280aa8e5e50a5b447fd954b17d30fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Wjp3TqFEQMDLbXEs.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">2022年冬奥会前5名国家奖牌榜—数据来源，</em> <a class="ae ky" href="https://en.wikipedia.org/wiki/2022_Winter_Olympics_medal_table" rel="noopener ugc nofollow" target="_blank"> <em class="lk">维基百科</em> </a> <em class="lk">，图片作者</em></p></figure><p id="db2f" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">现在，图表。</p><h1 id="6cbc" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">7.垂直条</h1><p id="8a66" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">垂直条形图是普通的香草口味的条形图。在Streamlit中，实现一个简单的熊猫条形图的代码是这样的:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="682c" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots()<br/>medals.plot.bar(x='Country', y='Total', ax=ax)<br/>st.pyplot(fig)</span></pre><p id="328d" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">该图绘制了每个国家获得的奖牌总数的单个条形图系列，x轴表示国家，y轴表示获得的奖牌总数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/facd6e85d395ac294f1a72d6d71873d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zc0b1nLE34ruyqiB.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">垂直条形图—作者图片</em></p></figure><p id="7df6" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated"><em class="mg">请注意，我使用Streamlit和Pandas来实现这一点，Streamlit坚持我们专门创建一个Matplotlib图形，它可以作为绘图函数的参数。这就是第一行代码的作用。因此，我们必须将</em> <code class="fe ok ol om nz b"><em class="mg">ax=ax</em></code> <em class="mg">添加到熊猫图代码中，以便将该图添加到已经创建的图形中。如果您要使用Jupyter笔记本或独立的Python，就不需要这段代码。查看Github上的Jupyter笔记本，查看替代代码。</em></p><p id="bd76" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">条形图的一个常见用途是比较一系列条形图中的多个值。下面是显示奖牌表中所有列的条形的代码。注意，由于没有为<code class="fe ok ol om nz b">y</code>指定值，Pandas认为我们想要绘制所有的列。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="cee3" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots()<br/>medals.plot.bar(x='Country', ax=ax)<br/>st.pyplot(fig)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/052092ecfccbf7c3912c13c323410476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nLMfBPKTqAiDNhbp.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">多条竖条图—作者图片</em></p></figure><p id="7c6e" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">要显示列的子集，您应该将<code class="fe ok ol om nz b">y</code>设置为您感兴趣的列的列表。下面我们指定列，<code class="fe ok ol om nz b">Gold</code>，<code class="fe ok ol om nz b">Silver</code>和<code class="fe ok ol om nz b">Bronze</code> <em class="mg"> </em>(即不包括<em class="mg">合计</em>)。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="cc7b" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots()<br/>medals.plot.bar(x='Country', y = ['Gold','Silver','Bronze'],ax=ax)<br/>st.pyplot(fig)</span></pre><p id="c873" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">结果是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/639bcff6874cb10a4d26e652a892eba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xjFgue-wW17rydCw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">带有多个特定条形图的垂直条形图—图片由作者提供</em></p></figure><h1 id="e010" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">8.单杠</h1><p id="3436" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">CNK告诉我们，水平条形图是她的条形图版本，因为它更容易阅读。她告诉我们，我们的眼睛自然地以Z形运动扫描一页，在页面上来回移动，因此，我们会首先注意到图表上的标签，然后看到与它们相对应的条形。我要指出的是，虽然从西方文化的角度来看这很可能是真的，但它可能不是普遍的(我非常欢迎对此的评论)。</p><p id="a9ac" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">在Pandas中，垂直条形图和水平条形图在语法上的唯一区别是函数名中只有一个字母。例如，不调用函数<code class="fe ok ol om nz b">medals.plot.<strong class="ln iu">bar</strong>(x='Country', ax=ax) </code> we，而是调用<code class="fe ok ol om nz b">medals.plot.<strong class="ln iu">barh</strong>(x='Country', ax=ax).</code></p><p id="5847" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这里有一个例子，但是上一节中的所有图表都可以通过调用函数的<code class="fe ok ol om nz b">barh</code>版本而不是<code class="fe ok ol om nz b">bar</code>来呈现为水平图表。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="b688" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots()<br/>medals.plot.barh(x='Country', ax=ax)<br/>st.pyplot(fig)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/f10898267aa654fd9faddcab2f636256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VvxVkjiuCNTqeuUx.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">多条横条图—作者图片</em></p></figure><h1 id="bef9" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">9.堆叠垂直条</h1><p id="cc0f" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">堆积条形图不像以前的类型那样常见，但当您想要比较由不同子成分组成的总计时，它会很有用，如下图所示。</p><p id="99fe" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">在这里，我们将每个国家的不同奖牌类别组合成一个单一的堆叠条形图。除了添加了参数<code class="fe ok ol om nz b">stacked = True</code>之外，代码与前面的示例非常相似。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="c137" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots()<br/>medals.plot.bar(x='Country', <br/>                y = ['Gold','Silver','Bronze'],<br/>                stacked = True, ax=ax)<br/>st.pyplot(fig)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/2c14fb278882116d487c759a5b962c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zBHJqBIwxaUYRtlU.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">垂直堆积条形图—作者图片</em></p></figure><p id="466c" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">正如CNK指出的那样，尽管比较第一个子成分很容易，但较高的子成分就不那么容易比较了，因为它们不是从同一水平开始的。</p><h1 id="5bff" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">10.堆叠水平条</h1><p id="ca9a" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">除了我们调用<code class="fe ok ol om nz b">barh</code>函数之外，水平堆叠条形图的编码与垂直堆叠条形图相同。</p><p id="568b" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">当然，关于垂直图表的评论也适用于此。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="132d" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots()<br/>medals.plot.barh(x='Country', <br/>                 y = ['Gold','Silver','Bronze'], <br/>                 stacked = True, ax=ax)<br/>st.pyplot(fig)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/fd2d27f16d4ae647ee84f111bbf90fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mbO-S74vrBdBpNLe.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">水平堆积条形图——作者图片</em></p></figure><h1 id="6860" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">11.瀑布</h1><p id="f4a5" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">瀑布图可以用来解构堆积的<br/>条形图，这样我们就可以一次专注于一个部分。此外，瀑布图可以跟踪从起始值到最终结果的增加和减少。</p><p id="171d" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">瀑布图通常不作为可视化库的标准部分，尽管它们本质上是由两部分组成的堆叠条，当前值和增量或减量。正如CNK所评论的，这些可以通过使酒吧的下部透明来构建。</p><p id="c3b9" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">然而，我们将走一条更容易的路线。Python库w <em class="mg"> aterfallcharts </em>使用Matplotlib实现瀑布图，简单易用。</p><p id="54f8" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">首先，当然，我们安装它。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="3968" class="nk mo it nz b gy od oe l of og">pip install waterfallcharts</span></pre><p id="6ef2" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">我们将构建的图表取自<em class="mg">用数据</em>讲故事，并跟踪一个虚拟公司中人员的增加和减少。下面是数据:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="1d6a" class="nk mo it nz b gy od oe l of og">a = ['Beginning HC','Hires','Transfers In','Transfers Out','Exits']<br/>b = [100,30,8,-12,-10]</span></pre><p id="6bf7" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">List <code class="fe ok ol om nz b">a</code>是一组标签，<code class="fe ok ol om nz b">b</code>是一个值列表，从当前人数开始，然后列出初始值的增量或减量。</p><p id="cb27" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">由此产生的图表看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/07d047f3759ebbe7b2b299b2f2d7a15c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NjtoIijihmIt-Akr.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">瀑布图——作者图片</em></p></figure><p id="6ba7" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">您可以看到初始值以及由于标签所描述的原因而导致的变化。还添加了最终值。</p><p id="c4bb" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">产生这种结果的代码非常简单。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="6c5f" class="nk mo it nz b gy od oe l of og">my_plot = waterfall_chart.plot(a, b, net_label = "Ending HC")<br/>st.pyplot(my_plot)</span></pre><p id="8de0" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">我们传入标签和数据点的列表，以及一个将应用于最终计算出的总数的标签。结果是在Streamlit中可以用<code class="fe ok ol om nz b">st.pyplot()</code>绘制的图形。</p><p id="4042" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">您可能会注意到，在条形的视觉编码中有相当多的冗余。第一个柱和正变化标为绿色，负变化标为红色，最后一个柱标为蓝色。但积极和消极的变化已经通过增加或减少整体高度来区分。除此之外，还有数字标签向我们展示变化——这些也是彩色编码的。</p><p id="cb50" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">此外，我们不需要初始值和最终值是不同的颜色，因为它们是位置编码的:初始值在左边，最终值在最右边。</p><p id="752a" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">在她的书里，CNK把所有的条形都涂成一样的颜色，我认为这样会有更好的效果。因此，这里有一个替代的编码，将所有的条设置为相同的颜色。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="b6de" class="nk mo it nz b gy od oe l of og">my_plot = waterfall_chart.plot(a, b, net_label = "Ending HC",<br/>                               blue_color='blue',<br/>                               red_color='blue', <br/>                               green_color='blue')<br/>st.pyplot(my_plot)</span></pre><p id="2f1b" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这是结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/f72fc67d13e8b6e64b5f7facdc00ac0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vibuvgSV58WbOX5a.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">另一幅瀑布图——作者图片</em></p></figure><h1 id="b680" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">12.正方形区域</h1><p id="923e" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">面积图通常存在问题，因为面积通常是不规则的形状，相互堆叠在一起，读者很难将其解释为一个值。</p><p id="8b91" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">CNK说她一般不使用它们，除了方形面积图更容易阅读，我们将在这一部分探讨。</p><h2 id="d471" class="nk mo it bd mp nl nm dn mt nn no dp mx lu np nq mz ly nr ns nb mc nt nu nd nv bi translated">数据</h2><p id="d74d" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">我们将使用与食用过多加工肉类的健康风险相关的数据。在我的文章<a class="ae ky" rel="noopener" target="_blank" href="/visualizing-health-risk-2a082417f3f2"> <em class="mg">可视化健康风险</em> </a> <em class="mg"> </em>中，我讨论了如何有效地呈现这些风险，我从大卫·斯皮格尔哈尔特的优秀著作<em class="mg">统计的艺术</em>(注4)中获得了灵感。</p><p id="1592" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">2015年11月，国际癌症研究机构(世界卫生组织的一部分)<a class="ae ky" href="https://www.iarc.who.int/wp-content/uploads/2018/07/pr240_E.pdf" rel="noopener ugc nofollow" target="_blank">报告</a>称，食用50克加工肉类——例如培根或香肠——与肠癌风险增加18%有关(注3)。</p><p id="92bf" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这并不像一些媒体让你认为的那样可怕，因为这是相对风险的增加，而不是绝对风险的增加，而且绝对风险仍然相当小(非常粗略地说是从6%增加到7%)。但是仅仅用数字来解释这个想法是很困难的。可视化方法更好，一个好的候选可视化方法是方形面积图。我修改了我最初的方法，创建了一个正方形的面积图，就像CNK的书中所描绘的那样。</p><p id="2c16" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这是原始数据:每100个人中，大约有6个人患有肠癌，大约有1个人因为吃了太多的加工肉类而患病。</p><p id="e037" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">让我们看看用条形图表示的数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/552028fb01b83f6b34b1fe8b1d6ebc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ahLdADShnFPEDBs4.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示癌症实例(但不是很好)的条形图—作者图片</p></figure><p id="be62" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">出于兴趣，下面是生成图表的代码。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="3b7b" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots(figsize=(8,5))</span><span id="1507" class="nk mo it nz b gy oh oe l of og">plt.bar(['Cancer-free','Contracted cancer by chance','Contracted cancer and is a Bacon Eater'],[94,6,1])<br/>plt.xticks(rotation = 45)</span><span id="50ff" class="nk mo it nz b gy oh oe l of og">ax.set_ylabel('Percentage')<br/>ax.set_title('Occurance of Bowel Cancer in a Population')</span><span id="339b" class="nk mo it nz b gy oh oe l of og">st.pyplot(fig)</span></pre><p id="7aaf" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">很明显，最短的棒线和最长的棒线相比很小，但是很难判断到底有什么不同。</p><p id="309e" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">让我们试试传统的面积图。下面的是一个单一的堆积酒吧，作为一个矩形面积图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/c03f6506e7ef69ec5734a34a1a770ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wAB_dUnOolATPJ9o.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个条形图作为面积图显示癌症实例-作者图片</p></figure><p id="276f" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">同样，这是这个图表的代码。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="fe87" class="nk mo it nz b gy od oe l of og">fig, ax = plt.subplots()<br/>ax.bar('Instances of Cancer', 94,label='Cancer-Free')<br/>ax.bar('Instances of Cancer', 6, label='Contracted cancer by chance')<br/>ax.bar('Instances of Cancer', 1, label='Contracted cancer and is a Bacon Eater')<br/>st.pyplot(fig)</span></pre><p id="20c8" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这本书可能比前一本书可读性强一点，但实际上，它也面临着同样的问题。</p><p id="ee19" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">当数值存在差异时，方形面积图会让我们对情况有更好的印象。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/48030d9fec1a8299794699284d84c821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BO_gGNdBg3qQXJDF.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示癌症实例的方形面积图更清楚地显示了数据——图片由作者提供</p></figure><p id="a54b" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">在上图中，很容易看出每个类别的相对大小。问题是，我们并不经常将方形面积图视为可视化软件包的标准组件。</p><p id="3937" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">在下面的代码中，我利用Seaborn热图来创建方形面积图。首先，我创建一个10 x 10的Numpy数组，用零填充—这代表总人口—我用值0代表一个没有癌症的个体。接下来，我用六个1填充数组的左下角。值1代表患有癌症的个体。最后，为了完成数组，我将左下角的单个数组元素的值设置为2，表示一个人由于吃了太多加工过的肉而患了癌症。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="333a" class="nk mo it nz b gy od oe l of og"><em class="mg"># construct a 2D array of 0s - total pop</em><br/>a = [0]*100<br/>b = np.array(a).reshape((10,10))</span><span id="14d6" class="nk mo it nz b gy oh oe l of og"><em class="mg"># add a 2 by 3 rectangle of 1s representing cancer sufferers</em><br/>for i in range(8,10):<br/>    for j in range(7,10):<br/>        b[i,j] = 1</span><span id="ad95" class="nk mo it nz b gy oh oe l of og"><em class="mg"># add a single cell with value 2</em><br/><em class="mg"># representing the number of cancer sufferers </em><br/><em class="mg"># who eat too much bacon</em><br/>b[9,9] = 2</span><span id="6ac0" class="nk mo it nz b gy oh oe l of og"><em class="mg"># Plot the grid as a heat map in Seaborn</em><br/>fig, ax = plt.subplots(figsize=(8,5))<br/>sns.heatmap(b, <br/>            linewidths=0.5, <br/>            yticklabels=False,<br/>            xticklabels=False, <br/>            cmap=['lightblue','royalblue','midnightblue'],<br/>            ax=ax)</span><span id="4564" class="nk mo it nz b gy oh oe l of og"><em class="mg"># Customize legend</em><br/>colorbar = ax.collections[0].colorbar <br/>colorbar.set_ticks([0.5,1,1.5])<br/>colorbar.set_ticklabels(['Cancer-free','Contracted cancer by chance','Contracted cancer and is a Bacon Eater'])</span><span id="0484" class="nk mo it nz b gy oh oe l of og">ax.set_title('Occurance of Bowel Cancer in a Population')<br/>st.pyplot(fig)</span></pre><p id="3c95" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">剩下的代码是为每个类别设置颜色，设置标签等等。</p><h1 id="7476" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">结论</h1><p id="b44e" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">因此，我们有12个必要的可视化，如科尔·努斯鲍默·克纳弗里克的书<em class="mg">用数据讲故事</em>中所描述的。大多数图表都很容易阅读和实现，有一两张稍微复杂一点，因为它们通常不包含在标准的可视化软件包或库中。我希望，在这些案例中，我已经帮助您了解了它们是如何实现的。</p><p id="b25a" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">感谢阅读，我希望它是有用的。所有的代码都可以通过我的<a class="ae ky" href="http://alanjones2.github.io" rel="noopener ugc nofollow" target="_blank">网页</a>上的链接获得。你还会发现一个Jupyter笔记本，实现了每一个视觉效果。还有一个Streamlit应用程序演示了你在这里看到的每一个可视化效果<a class="ae ky" href="https://alanjones2-12visuals-appmain-dply0y.streamlitapp.com/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="bc50" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">要了解我所做工作的更多信息，请访问我的<a class="ae ky" href="http://alanjones2.github.io" rel="noopener ugc nofollow" target="_blank">网页</a>和/或订阅我在<a class="ae ky" href="http://technofile.substack.com" rel="noopener ugc nofollow" target="_blank">子堆栈</a>上的不定期简讯。</p><h1 id="eb1b" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">笔记</h1><ol class=""><li id="ca66" class="ow ox it ln b lo nf lr ng lu oy ly oz mc pa lj pb pc pd pe bi translated"><a class="ae ky" href="https://amzn.to/3dJlMaS" rel="noopener ugc nofollow" target="_blank"> <em class="mg">《用数据讲故事》，商业人士数据可视化指南</em> </a>，科尔·努斯鲍默·克纳弗利奇，威利，2015年(附属链接*)</li><li id="a4d7" class="ow ox it ln b lo pf lr pg lu ph ly pi mc pj lj pb pc pd pe bi translated">维基百科上的奖牌榜页面列出了每个参赛国家获得的奖牌。</li><li id="61a8" class="ow ox it ln b lo pf lr pg lu ph ly pi mc pj lj pb pc pd pe bi translated"><a class="ae ky" href="https://www.iarc.who.int/wp-content/uploads/2018/07/pr240_E.pdf" rel="noopener ugc nofollow" target="_blank"> IARC专论评估红肉和加工肉的消费</a></li><li id="ca6d" class="ow ox it ln b lo pf lr pg lu ph ly pi mc pj lj pb pc pd pe bi translated"><a class="ae ky" href="https://www.amazon.com/Art-Statistics-How-Learn-Data/dp/1541675703/ref=sr_1_1?_encoding=UTF8&amp;amp;camp=1789&amp;amp;creative=9325&amp;amp;crid=1PPXO3JG9UPDR&amp;amp;keywords=the+art+of+statistics&amp;amp;linkCode=ur2&amp;amp;linkId=b71669deca0a471424d5bc6fccbba1b3&amp;amp;qid=1648295722&amp;amp;sprefix=the+art+of+statistics%25252Caps%25252C177&amp;amp;sr=8-1&amp;_encoding=UTF8&amp;tag=alanjones01-20&amp;linkCode=ur2&amp;linkId=fdf08c9a6a07285fa2432673497c25ec&amp;camp=1789&amp;creative=9325" rel="noopener ugc nofollow" target="_blank">统计的艺术:如何从数据中学习</a>，大卫·斯皮格尔哈特，2021 ( <em class="mg">附属链接</em></li></ol><p id="9b67" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">* <em class="mg">如果你通过代销商链接购物，我可能会得到佣金。不会影响你付出的代价。</em></p></div></div>    
</body>
</html>