<html>
<head>
<title>20 Examples to Master Filtering Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">掌握熊猫数据帧过滤的 20 个例子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/20-examples-to-master-filtering-pandas-dataframes-df6fabfe126f#2022-02-23">https://towardsdatascience.com/20-examples-to-master-filtering-pandas-dataframes-df6fabfe126f#2022-02-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3789" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">实用指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/9f663e8874936b7087bc52dc3a170354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFNoUpbmrZPzE-TJD5c8xg.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">法国人 Daphné Be 在<a class="ae ku" href="https://unsplash.com/s/photos/filtering?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="fd74" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们倾向于收集尽可能多的数据，因为数据是非常有价值的资产。我们拥有的数据越多，我们能够创造的解决方案和产品就越强大。</p><p id="e17b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">近年来，收集和存储的数据量急剧增加。这背后的两个主要原因是:</p><ol class=""><li id="e12a" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">收集和存储数据变得更加便宜和容易。</li><li id="444d" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">我们有强大的工具来处理大量的数据。</li></ol><p id="9235" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">然而，我们并不总是使用手头的所有数据。数据的收集可能有多种目的，其中一部分对于特定目的来说可能是多余的。</p><p id="5878" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们有时会从大型数据集中抽取一小部分样本来进行探索性数据分析。这使得熟悉数据的特征和结构变得更加容易。</p><p id="729e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对于这种情况，拥有一个高效的工具来过滤数据是非常重要的。Pandas 是最好的数据分析和操作工具之一，它为我们提供了加速和简化过滤表格数据的功能。</p><p id="84d1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在这个例子中，我们将讨论 20 个例子，包括在过滤熊猫数据帧时使用的函数和技术。</p><p id="63b7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们从导入 Pandas 和创建一个示例数据框架开始。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="622f" class="mk ml it mg b gy mm mn l mo mp">import pandas as pd</span><span id="07bc" class="mk ml it mg b gy mq mn l mo mp">df = pd.DataFrame({</span><span id="a241" class="mk ml it mg b gy mq mn l mo mp">    "name": ["John","Jane","Emily","Lisa","Matt"],<br/>    "note": [92,94,87,82,90],<br/>    "profession":["Electrical engineer","Mechanical engineer",<br/>                  "Data scientist","Accountant","Athlete"],<br/>    "date_of_birth":["1998-11-01","2002-08-14","1996-01-12",<br/>                     "2002-10-24","2004-04-05"],<br/>    "group":["A","B","B","A","C"]</span><span id="95fc" class="mk ml it mg b gy mq mn l mo mp">})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/75146114922f56f1dd416981ebef77f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E33ByLB6P5yaEZuJH-psDg.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">df(作者图片)</p></figure><p id="953a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们现在可以开始举例了。</p><p id="1469" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 1:选择列的子集</strong></p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="f59f" class="mk ml it mg b gy mm mn l mo mp">df[["name","note"]]</span><span id="8d87" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong><br/><br/>   name note<br/>0  John   92<br/>1  Jane   94<br/>2 Emily   87<br/>3  Lisa   82<br/>4  Matt   90</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="b222" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 2:用 loc 选择行和列的子集</strong></p><p id="c023" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">loc 方法用于使用行和列标签进行筛选。以下代码行返回前 3 行以及 name 和 note 列。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="d509" class="mk ml it mg b gy mm mn l mo mp">df.loc[:3, ["name","note"]]</span><span id="d1c5" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="b048" class="mk ml it mg b gy mq mn l mo mp">   name note<br/>0  John   92<br/>1  Jane   94<br/>2 Emily   87</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="2bfb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 3:使用 iloc 选择行和列的子集</strong></p><p id="74c3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">iloc 方法类似于 loc 方法，但它使用行和列索引，而不是标签。以下代码行返回前 3 行和第 3 列(索引从 0 开始)。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="ffcf" class="mk ml it mg b gy mm mn l mo mp">df.iloc[:3, 2]</span><span id="9443" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="f178" class="mk ml it mg b gy mq mn l mo mp">0    Electrical engineer<br/>1    Mechanical engineer<br/>2         Data scientist<br/>Name: profession, dtype: object</span></pre><p id="3971" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">您可能已经注意到，我们使用相同的表达式(":3 ")来选择具有 loc 和 iloc 方法的行。原因是 Pandas 默认为行分配整数标签。除非指定特定的标签，否则一行的索引和标签是相同的。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="08a0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 4:对列值使用比较运算符</strong></p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="7e68" class="mk ml it mg b gy mm mn l mo mp">df[df.note &gt; 90]</span><span id="4dcb" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="929f" class="mk ml it mg b gy mq mn l mo mp">  name  note           profession  date_of_birth  group<br/>0 John    92  Electrical engineer     1998-11-01      A<br/>1 Jane    94  Mechanical engineer     2002-08-14      B</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="25a7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 5:对字符串使用比较运算符</strong></p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="bf15" class="mk ml it mg b gy mm mn l mo mp">df[df.name=="John"]</span><span id="6332" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="2a83" class="mk ml it mg b gy mq mn l mo mp">  name  note           profession  date_of_birth  group<br/>0 John    92  Electrical engineer     1998-11-01      A</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="300c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 6:带有字符串访问器的字符串条件</strong></p><p id="4aa0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">字符串访问器有几个函数可以处理字符串。例如，我们可以基于包含特定单词或字符序列的列进行过滤。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="df77" class="mk ml it mg b gy mm mn l mo mp">df[df.profession.str.contains("engineer")]</span><span id="b625" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="1acb" class="mk ml it mg b gy mq mn l mo mp">  name  note           profession  date_of_birth  group<br/>0 John    92  Electrical engineer     1998-11-01      A<br/>1 Jane    94  Mechanical engineer     2002-08-14      B</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="dea7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 7:另一个带有字符串访问器的字符串条件</strong></p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="d6e6" class="mk ml it mg b gy mm mn l mo mp">df[df.name.str.startswith("L")]</span><span id="09e1" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="b74d" class="mk ml it mg b gy mq mn l mo mp">  name  note  profession  date_of_birth  group<br/>3 Lisa    82  Accountant     2002-10-24      A</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="de8b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 8:多类型字符串方法</strong></p><p id="1de4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们可以通过链接来组合多个 str 方法。例如，如果我们不确定是否所有的名字都以大写字母开头，我们可以先将它们转换成小写字母，然后进行过滤。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="c8b3" class="mk ml it mg b gy mm mn l mo mp">df[df.name.str.lower().str.startswith("l")]</span><span id="ff50" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="8408" class="mk ml it mg b gy mq mn l mo mp">  name  note  profession  date_of_birth  group<br/>3 Lisa    82  Accountant     2002-10-24      A</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="7288" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 9:波浪号(~)运算符</strong></p><p id="902e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">波浪号运算符表示“非”逻辑。它让我们得到不符合给定条件的行。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="2e2b" class="mk ml it mg b gy mm mn l mo mp">df[~df.profession.str.contains("engineer")]</span><span id="f247" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="fdb0" class="mk ml it mg b gy mq mn l mo mp">    name  note      profession  date_of_birth  group<br/>2  Emily    87  Data scientist     1996-01-12      B<br/>3   Lisa    82      Accountant     2002-10-24      A<br/>4   Matt    90         Athlete     2004-04-05      C</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="dcff" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">示例 10:dt 访问器</strong></p><p id="1c5b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">dt 访问器为我们提供了许多处理日期和时间的方法。但是，我们不能将 dt 访问器应用于具有 string 数据类型的列，因此我们首先需要更改数据类型。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="abd7" class="mk ml it mg b gy mm mn l mo mp">df.date_of_birth = df.date_of_birth.astype("datetime64[ns]")</span><span id="8296" class="mk ml it mg b gy mq mn l mo mp">df[df.date_of_birth.dt.month==11]</span><span id="15ac" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="e877" class="mk ml it mg b gy mq mn l mo mp">  name  note           profession  date_of_birth  group<br/>0 John    92  Electrical engineer     1998-11-01      A</span></pre><p id="b085" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们已经从一个日期中提取了月份信息，并将其用于过滤。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="6350" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 11:dt 访问器(2) </strong></p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="9f41" class="mk ml it mg b gy mm mn l mo mp">df[df.date_of_birth.dt.year &gt; 2000]</span><span id="1a6b" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="cd34" class="mk ml it mg b gy mq mn l mo mp">   name  note           profession  date_of_birth  group<br/>1  Jane    94  Mechanical engineer     2002-08-14      B<br/>3  Lisa    82           Accountant     2002-10-24      A<br/>4  Matt    90              Athlete     2004-04-05      C</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="a87b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 12:多个条件(与)</strong></p><p id="26e7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们可以用逻辑运算符组合多个条件。以下代码行用“与”逻辑组合了两个条件。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="ba01" class="mk ml it mg b gy mm mn l mo mp">df[(df.date_of_birth.dt.year &gt; 2000) &amp;  <br/>   (df.profession.str.contains("engineer"))]</span><span id="4344" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="045d" class="mk ml it mg b gy mq mn l mo mp">   name  note           profession  date_of_birth  group<br/>1  Jane    94  Mechanical engineer     2002-08-14      B<br/></span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="af64" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 13:多个条件(or) </strong></p><p id="2b2e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">下面一行代码返回数据科学家或注释超过 90 的人。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="dbae" class="mk ml it mg b gy mm mn l mo mp">df[(df.note &gt; 90) | (df.profession=="Data scientist")]</span><span id="6025" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="aab6" class="mk ml it mg b gy mq mn l mo mp">   name  note           profession  date_of_birth  group<br/>0  John    92  Electrical engineer     1998-11-01      A<br/>1  Jane    94  Mechanical engineer     2002-08-14      B<br/>2 Emily    87      Data scientist      1996-01-12      B</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="8bd6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 isin 方法</strong></p><p id="ede1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">isin 方法是另一种使用多个条件进行过滤的技术。它将该值与值列表进行比较。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="8b34" class="mk ml it mg b gy mm mn l mo mp">df[df.group.isin(["A","C"])]</span><span id="d64a" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="b557" class="mk ml it mg b gy mq mn l mo mp">   name  note           profession  date_of_birth  group<br/>0  John    92  Electrical engineer     1998-11-01      A<br/>3  Lisa    82           Accountant     2002-10-24      A<br/>4  Matt    90              Athlete     2004-04-05      C</span></pre><p id="2100" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">当我们有几个值用于过滤时，isin 方法非常有用。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="9d77" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 15:查询功能</strong></p><p id="2155" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">查询函数接受字符串作为过滤器。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="1710" class="mk ml it mg b gy mm mn l mo mp">df.query("note &gt; 90")</span><span id="cb09" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="3e03" class="mk ml it mg b gy mq mn l mo mp">  name  note           profession  date_of_birth  group<br/>0 John    92  Electrical engineer     1998-11-01      A<br/>1 Jane    94  Mechanical engineer     2002-08-14      B</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="5587" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 16:查询功能(2) </strong></p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="4d68" class="mk ml it mg b gy mm mn l mo mp">df.query("group=='A' and note &gt; 89")</span><span id="124d" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="a57b" class="mk ml it mg b gy mq mn l mo mp">  name  note           profession  date_of_birth  group<br/>0 John    92  Electrical engineer     1998-11-01      A</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="2f6d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">例 17:最小的函数</p><p id="3656" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">它允许根据给定的列选择 n 个最小值。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="7a26" class="mk ml it mg b gy mm mn l mo mp">df.nsmallest(2, "note")</span><span id="b08f" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="1804" class="mk ml it mg b gy mq mn l mo mp">   name  note           profession  date_of_birth  group<br/>3  Lisa    82           Accountant     2002-10-24      A<br/>2 Emily    87       Data scientist     1996-01-12      B</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="9f2c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 nlargest 函数</strong></p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="da10" class="mk ml it mg b gy mm mn l mo mp">df.nlargest(2, "note")</span><span id="41ac" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="7b4e" class="mk ml it mg b gy mq mn l mo mp">  name  note           profession  date_of_birth  group<br/>1 Jane    94  Mechanical engineer     2002-08-14      B<br/>0 John    92  Electrical engineer     1998-11-01      A</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="b4b7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 isna 函数</strong></p><p id="ccb1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">isna 函数可用于选择指定列中缺少值(即 null)的行。让我们首先在数据帧中添加一个空值。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="e9aa" class="mk ml it mg b gy mm mn l mo mp">import numpy as np</span><span id="7819" class="mk ml it mg b gy mq mn l mo mp">df.loc[0, "profession"] = np.nan</span></pre><p id="6ffe" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">以下代码行返回职业值为空的行。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="e8d0" class="mk ml it mg b gy mm mn l mo mp">df[df.profession.isna()]</span><span id="89ff" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="28f3" class="mk ml it mg b gy mq mn l mo mp">  name  note  profession  date_of_birth  group<br/>0 John    92         NaN     1998-11-01      A</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="09d2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">例 notna 函数</strong></p><p id="c922" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这与 isna 的功能正好相反。我们可以用它来过滤掉缺少值的行。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="1d08" class="mk ml it mg b gy mm mn l mo mp">df[df.profession.notna()]</span><span id="dd25" class="mk ml it mg b gy mq mn l mo mp"><strong class="mg iu"># output</strong></span><span id="f0fa" class="mk ml it mg b gy mq mn l mo mp">   name  note           profession  date_of_birth  group<br/>1  Jane    94  Mechanical engineer     2002-08-14      B<br/>2 Emily    87       Data scientist     1996-01-12      B<br/>3  Lisa    82           Accountant     2002-10-24      A<br/>4  Matt    90              Athlete     2004-04-05      C</span></pre></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="17ad" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我们已经做了 20 个例子，展示了几种过滤熊猫数据帧的工具和技术。</p><p id="b9aa" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="nd">你可以成为</em> <a class="ae ku" href="https://sonery.medium.com/membership" rel="noopener"> <em class="nd">介质成员</em> </a> <em class="nd">解锁我的全部写作权限，外加其余介质。如果你已经是了，别忘了订阅</em><a class="ae ku" href="https://sonery.medium.com/subscribe" rel="noopener"><em class="nd"/></a><em class="nd">如果你想在我发表新文章时收到电子邮件。</em></p><div class="ne nf gp gr ng nh"><a href="https://sonery.medium.com/membership" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">通过我的推荐链接加入 Medium-Soner yl DRM</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">sonery.medium.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ko nh"/></div></div></a></div><p id="4512" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>