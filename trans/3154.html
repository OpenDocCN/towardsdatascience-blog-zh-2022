<html>
<head>
<title>Predicting respiratory motion using online learning of recurrent neural networks for safer lung radiotherapy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用递归神经网络的在线学习预测呼吸运动，用于更安全的肺部放射治疗</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/forecasting-respiratory-motion-using-online-learning-of-rnns-for-safe-radiotherapy-bdf4947ad22f#2022-07-11">https://towardsdatascience.com/forecasting-respiratory-motion-using-online-learning-of-rnns-for-safe-radiotherapy-bdf4947ad22f#2022-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4cb2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">UORO在Matlab医疗时间序列预测中的应用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c7ada5aad7a8838bb1e9b441970189fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pxchwmkLnhZlLx87"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@nci?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">国家癌症研究所</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="0135" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated"><span class="l lt lu lv bm lw lx ly lz ma di">T</span>2020年全球新增肺癌病例约200万例，肺癌患者5年相对生存率略高于22% [ <a class="ae kv" href="https://doi.org/10.3322/caac.21660" rel="noopener ugc nofollow" target="_blank"> 1 </a>，<a class="ae kv" href="https://seer.cancer.gov/statfacts/html/lungb.html" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]。这推动了肺部放射治疗的研究，人工智能是实现这一目标的工具之一。</p><p id="479f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你有没有想过人工智能如何改善肺癌的治疗？为什么递归神经网络(RNN)特别有助于这项任务？还有，什么是在线学习，为什么它在这种情况下特别有用？</p><p id="d5cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我将通过总结我最近发表在“生物医学中的计算机方法和程序”上的研究文章“使用经无偏在线递归优化训练的递归神经网络预测外部标记物的位置用于安全肺癌放疗”，并介绍其主要发现<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，尽我所能回答这些问题。</p><p id="48f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mb">除特别注明外，所有图片均为作者所有。</em></p><h1 id="1baf" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">1.为什么我们在肺部放射治疗中需要时间序列预测</h1><p id="a97f" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">肺部肿瘤随着呼吸运动而移动。因此，精确地瞄准它们是具有挑战性的，因为在放射治疗过程中的实时成像具有局限性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/7bd0e81d9ebc7223ee631434face83f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d72KdkoAC0-TNXmeAxFNBw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在一系列计算机断层扫描(CT)图像中，呼气相(左)和吸气相(右)末期的胰腺肿瘤。由于呼吸运动，肿瘤的质心上下移动，并且肿瘤形状也随着该运动而改变。<a class="ae kv" href="https://doi.org/10.15083/00073584" rel="noopener ugc nofollow" target="_blank">【4】</a>原图，经作者许可编辑。</p></figure><p id="9035" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">外部标记是放置在胸部的金属物体，可以使用空间回归模型(也称为对应模型)来帮助推断胸部肿瘤的位置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/d70395d6e1f5d29647a4bc16afb095a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kb2aFE4wneWIknhchigLCw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">放射治疗系统(射波刀),使用外部标记引导放射束。经Wiley许可，改编自<a class="ae kv" href="https://doi.org/10.1118/1.1774132" rel="noopener ugc nofollow" target="_blank">【5】</a>，版权2004美国医学物理学家协会。</p></figure><p id="179b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即使利用外部标记的红外跟踪，肿瘤的位置也难以精确估计，因为这些内部-外部对应模型固有的不精确性，而且因为治疗系统受到由于图像采集、机器人控制和辐射束激活引起的延迟。这种延迟会阻止有效的肿瘤照射，并导致对健康组织的过量剂量，从而导致肺炎等副作用，这种情况可能会危及生命。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/309ce63d927400338fc20752b62440ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGRm5fiw7avbkdbKeYVJQQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由于总系统延迟δt未得到补偿，健康肺组织受到过度照射。考虑到诸如治疗期间肿瘤形状变化的影响，这里用斜线表示的照射区域大于肿瘤尺寸。转载自<a class="ae kv" href="https://doi.org/10.1016/j.compmedimag.2021.101941" rel="noopener ugc nofollow" target="_blank">【6】</a>，版权2021，经爱思唯尔许可。</p></figure><p id="2342" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了解决系统延迟的问题，可以使用过去的呼吸数据来预测肿瘤位置。在如上所述的带有标记的外部引导的情况下，我们可以预测标记的位置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/a10e0a4882aa10b7dab40d71e8255189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ig2zXqqJZEZJadKTq7RC1Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用对应模型从外部标记位置测量中导出肿瘤的未来位置。在这项研究中，我专门关注预测步骤，以补偿治疗系统的延迟。</p></figure><h1 id="4bfb" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">2.我们的方法</h1><h2 id="a65c" class="nd md iq bd me ne nf dn mi ng nh dp mm lf ni nj mo lj nk nl mq ln nm nn ms no bi translated">2.1.数据集</h2><p id="2f64" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">在这项研究中，我使用了由九个序列组成的<a class="ae kv" href="https://paperswithcode.com/dataset/extmarker" rel="noopener ugc nofollow" target="_blank"> ExtMarker </a>数据集，其中包含健康个体胸部三个外部标记的3D位置。采样频率为10 Hz，脊柱方向的运动幅度在6mm-40mm之间。该数据集是公开的，更多信息可在<a class="ae kv" href="https://doi.org/10.48550/arXiv.1508.00749" rel="noopener ugc nofollow" target="_blank">【7】</a>中找到。我们将每个序列的数据分为训练集、交叉验证集和测试集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/43d1cff9bf2ac1fc5bcdd2e9e7003afe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V3zj-ttE_mpD079-WQD5fg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">对于包含标记位置的9个序列中的每一个，将数据划分为训练集、交叉验证集和测试集。</p></figure><p id="291c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">预测呼吸运动是具有挑战性的，因为诸如振幅和周期的呼吸特征在每个记录中是变化的，即使它看起来主要是周期性的。此外，在大约一半的记录中，个人被要求说话或笑，这使得任务更加复杂。在现实世界中，也会发生突发的呼吸异常，如咳嗽、打嗝或打哈欠，这就是为什么挑战记录是有益的。</p><h2 id="e68b" class="nd md iq bd me ne nf dn mi ng nh dp mm lf ni nj mo lj nk nl mq ln nm nn ms no bi translated">2.2.让我们进入RNNs的世界。</h2><p id="5310" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">备注:本节中的方程最好在计算机显示器上查看。</p><p id="f044" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">RNNs是一种特殊类型的神经网络，配备有反馈回路，使它们能够记住随着时间推移获得的信息。当我们进行预测时，标记在过去和未来的位置分别是网络的输入和输出。预测是一个自我监督的学习问题，因为不需要人工注释。这项研究使用了一个简单的香草架构，只有一个隐藏层。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/8b1a7107edac1f9b7e9ca5aa38873c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NG06H8X1Cz4zSqSSl3YOwA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">预测标记位置的RNN的结构。输入向量uₙ对应于过去的位置，输出向量yₙ₊₁对应于预测的位置。经爱思唯尔许可，改编自<a class="ae kv" href="https://doi.org/10.1016/j.compmedimag.2021.101941" rel="noopener ugc nofollow" target="_blank">【6】</a>，版权2022</p></figure><p id="8b79" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">rnn通常使用时间反向传播(BPTT)进行离线训练。离线学习指定了一个学习过程，其中有两个独立的训练和推理步骤。在我们的研究中，我们使用在线学习，这意味着训练和推理是同时进行的。在放射治疗的情况下，这使得网络能够适应看不见的呼吸模式，尽管只看到有限的数据。事实上，由于有关个人信息保护的法规，人工智能医疗应用的数据收集通常很困难。这项研究调查了UORO<a class="ae kv" href="https://doi.org/10.48550/arXiv.1702.05043" rel="noopener ugc nofollow" target="_blank">【8】</a>(一种最近使用RNNs进行在线学习的方法)预测呼吸运动的效率。</p><p id="98a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面简单讨论一下UORO是如何工作的。首先，让我们写出RNN方程。下面的第一个方程(状态方程)描述了内部状态向量<em class="mb"> x </em> ₙ的演化，第二个方程(测量方程)能够计算输出向量<em class="mb"> y </em> ₙ₊₁.<em class="mb"> θ </em> ₙ和<em class="mb"> u </em> ₙ分别指定参数向量和输入向量。注意，参数向量依赖于<em class="mb"> n </em>，因为我们执行在线学习。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/9598d5354dd19aba737e199a4dabc076.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/0*kaKpIZFu22yRarb0"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/9e32be728ac858c85cbe869283d8913a.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/0*nGJwC4a13L6A2I-K"/></div></figure><p id="699d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们寻求最小化的损失函数是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c26f6c611d232badc1dae7166567ab27.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/0*AYUHWM1b6o0rVQS3"/></div></figure><p id="f99c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个等式中，<em class="mb"> y </em> ₙ <em class="mb"> * </em>指定地面实况标签(我们想要预测的标记的位置)。我们可以使用<em class="mb"> y </em> ₙ的定义和链式法则计算损失相对于<em class="mb"> θ </em>的导数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/9462e8c3e71a0ee4b5fd8da330e74e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/0*2azfkqQI41xSf1Yi"/></div></figure><p id="1188" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似地，通过将链式法则与测量方程结合使用，我们可以推导出以下方程:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/4dee83594c6ab7c6c85b4437843bc2d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*Z78eqYNhDnsBZSuv"/></div></figure><p id="8009" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个等式能够计算作为影响矩阵∂xₙ/∂ <em class="mb"> θ的函数的损失梯度。</em>第二个方程让我们在每个时间步递归更新影响矩阵。对于我们的特定网络，所有其他偏导数都可以使用损耗<em class="mb"> L </em>的定义和选择的函数<em class="mb"> F </em> ₒᵤₜ和<em class="mb"> F </em> ₛₜ <em class="mb"> </em>来计算；在我们的工作中，后者分别是线性函数和单元双曲正切。这种在每个时间步计算损失梯度的方法被称为实时递归学习(RTRL)。RTRL的主要缺点是计算量大，因为更新成本是<em class="mb">o(q⁴</em>，其中<em class="mb"> q </em>是隐藏单元的数量。这特别是由于影响矩阵的大小，它有许多条目，我们需要在每个时间步更新。UORO的主要思想是将矩阵估计为两个随机向量的乘积(换句话说，它由无偏的秩为1的矩阵估计器近似)，并在每个时间步长更新它们:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/bcf713e8d12cde5ff9d0f0353488c882.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/0*nvcK3jjYVN-aA8HE"/></div></figure><p id="fa50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，我不会在这里详细描述这两个向量是如何更新的。重要的一点是，有一种有效的方法来压缩包含在影响矩阵中的信息，使得能够将计算成本降低到<em class="mb"> O(q ) </em>。</p><p id="fb29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将在文章结尾的附加部分描述UORO核心的数学属性，所以请务必跟上:)</p><p id="e377" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这项研究中，我对每个序列独立进行预测，并使用网格搜索进行交叉验证。</p><h2 id="68fc" class="nd md iq bd me ne nf dn mi ng nh dp mm lf ni nj mo lj nk nl mq ln nm nn ms no bi translated">2.3.在Matlab中实现UORO</h2><p id="261f" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我们来试着了解一下UORO在Matlab中的基本实现。这里我将描述一下我的论文对应的<a class="ae kv" href="https://github.com/pohl-michel/time-series-forecasting-with-UORO-RTRL-LMS-and-linear-regression" rel="noopener ugc nofollow" target="_blank"> Github库的<code class="fe nx ny nz oa b">rnn_UORO</code>功能。如果您对Python有所了解，那么这里没有什么好害怕的，因为这两种语言的语法非常接近。如果您对代码不感兴趣或者喜欢直接分析结果，可以跳过这一部分。</a></p><p id="401e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">顺便提一下，我还想提一下realpython.com的深度指南，题为<a class="ae kv" href="https://realpython.com/matlab-vs-python/" rel="noopener ugc nofollow" target="_blank">“Matlab与Python:为什么以及如何进行转换”</a>，它比较了MATLAB和Python，并从我在MATLAB的经历中帮助我学习Python(反正它们是非常相似的语言)。如果你精通Python并且想更好地理解Matlab语法，你也可以阅读。</p><p id="c5c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我定义了一个辅助函数来根据状态方程实现正向传播(参见2.2节)。Matlab中的函数是使用<code class="fe nx ny nz oa b">function</code>关键字定义的，而<code class="fe nx ny nz oa b">def</code>关键字是在Python中使用的。在这段代码中，<code class="fe nx ny nz oa b">myRNN</code>是一个包含RNN参数的<a class="ae kv" href="https://www.mathworks.com/help/matlab/ref/struct.html" rel="noopener ugc nofollow" target="_blank"> Matlab结构数组</a>(这或多或少相当于Python中的字典和C语言中的结构)。我选择激活函数<code class="fe nx ny nz oa b">phi</code>作为双曲正切函数。它是使用一个<a class="ae kv" href="https://www.mathworks.com/help/matlab/matlab_prog/anonymous-functions.html" rel="noopener ugc nofollow" target="_blank">匿名函数</a>实现的，这个函数相当于Python中的<a class="ae kv" href="https://realpython.com/python-lambda/#python-lambda-and-regular-functions" rel="noopener ugc nofollow" target="_blank"> lambda函数</a>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Matlab中的状态方程带有线性状态函数<em class="od"> F </em> ₛₜ和双曲正切激活函数</p></figure><p id="9caa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还使用了另一个辅助函数来执行一个梯度下降步骤，在每个时间步进行剪辑。这里，<code class="fe nx ny nz oa b">theta</code>是RNN参数向量，<code class="fe nx ny nz oa b">dtheta</code>是损耗梯度。通过实验，我发现削波有助于稳定RNN的行为并获得更好的性能。如果你在<a class="ae kv" href="https://github.com/pohl-michel/time-series-forecasting-with-UORO-RTRL-LMS-and-linear-regression" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中查看我的代码，你会注意到我也实现了自适应矩估计(ADAM)。然而，我在实验中注意到，后者并没有提高预测的准确性。因此，在我的文章中，我只报告了用梯度下降法获得的结果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Matlab中带裁剪的梯度下降步长</p></figure><p id="5ed8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用于训练RNN的主函数将分别包含RNN参数和预测超参数的结构<code class="fe nx ny nz oa b">myRNN </code>和<code class="fe nx ny nz oa b">pred_par</code>以及包含输入和输出数据(标记的位置)的2D数组<code class="fe nx ny nz oa b">Xdata</code>和<code class="fe nx ny nz oa b">Ydata</code>作为输入。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">UORO在Matlab中的实现</p></figure><p id="5b80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们定义包含有用信息的变量，比如数组的大小(第3行到第11行)。</p><p id="c529" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们在时间步长上循环，并使用上面的辅助函数<code class="fe nx ny nz oa b">RNNstate_fwd_prop</code>执行正向传播(第13到21行)。这些行包括使用测量方程(带有线性输出函数)和瞬时误差(参见第2.2节)计算的<em class="mb"> y </em> ₙ₊₁。<a class="ae kv" href="https://www.mathworks.com/help/matlab/ref/tic.html" rel="noopener ugc nofollow" target="_blank"> tic </a>功能用于告诉计算机“启动秒表”测量当前时间步长对应的计算时间。</p><p id="0c6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第23行和第45行之间的代码部分非常数学化。我不会在这里深入细节，但我会从整体的角度解释发生了什么。首先，您可以看到有一个使用<a class="ae kv" href="https://www.mathworks.com/help/matlab/ref/rand.html" rel="noopener ugc nofollow" target="_blank"> rand </a>函数随机初始化的向量<code class="fe nx ny nz oa b">nu</code>(第30行)。这里重要的一点是两个向量<code class="fe nx ny nz oa b">myRNN.xtilde</code>和<code class="fe nx ny nz oa b">myRNN.theta_tilde</code>是从那个随机向量中计算出来的(第44和45行)。这些对应于我们在2.2节中提到的两个随机向量，其乘积是影响矩阵∂xₙ/∂ <em class="mb"> θ </em>的无偏估计。你可以看到它们在每个时间步递归更新。另一个重要的行是从这两个向量计算损失梯度估计值<code class="fe nx ny nz oa b">gtilde</code>(第27行)。如果你对底层数学感兴趣，我想让你参考一下关于UORO<a class="ae kv" href="https://doi.org/10.48550/arXiv.1702.05043" rel="noopener ugc nofollow" target="_blank">【8】</a>的原始论文和我的文章<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，它首次提供了香草RNNs情况下<code class="fe nx ny nz oa b">myRNN.dtheta</code>、<code class="fe nx ny nz oa b">myRNN.dtheta_g</code>、<code class="fe nx ny nz oa b">dx</code>的闭合形式表达式。这些在该实现中用于计算损耗梯度。此外，在这个故事的结尾有一个额外的部分，涵盖了UORO所依赖的基本数学属性，所以请继续关注我:)</p><p id="3f07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们用上面描述的<code class="fe nx ny nz oa b">update_param_optim</code>辅助函数更新梯度估计(第51行)。我使用了<a class="ae kv" href="https://www.mathworks.com/help/matlab/ref/reshape.html" rel="noopener ugc nofollow" target="_blank">整形</a>函数和切片，因为权重矩阵<code class="fe nx ny nz oa b">myRNN.Wa</code>、<code class="fe nx ny nz oa b">myRNN.Wb</code>和<code class="fe nx ny nz oa b">myRNN.Wc</code>被硬编码为2D数组，连接这些权重的向量<code class="fe nx ny nz oa b">theta_vec</code>是一个线向量。最后，我更新状态向量，并存储计算时间(用<a class="ae kv" href="https://www.mathworks.com/help/matlab/ref/toc.html" rel="noopener ugc nofollow" target="_blank"> toc </a>)和瞬时损耗，供以后分析。</p><p id="d8af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的Github库中的代码略有不同，因为它也处理GPU计算，但是为了解释简单，我跳过了这一部分。此外，我通过实验发现，使用我的GPU会使UORO计算变慢。所以我这篇文章只报道UORO对应CPU计算的性能。</p><h1 id="091a" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">3.结果</h1><h2 id="a7c9" class="nd md iq bd me ne nf dn mi ng nh dp mm lf ni nj mo lj nk nl mq ln nm nn ms no bi translated">3.1.预测行为的定性观察</h2><p id="6fd6" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我们先来定义这里的基本术语。我们称之为“水平”,用<em class="mb"> h </em>表示进行预测的提前时间间隔，信号历史长度(SHL)表示时间间隔，其信息用于在给定的时间步长进行单次预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/91c72b7f987a0ef0f152af66fd762cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ASvtY6LUjCOSsloD2qCPNA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">预测1D位置信号。SHL和horizon分别用h和l表示，转载自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022，经爱思唯尔许可。</p></figure><p id="f829" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们首先在视觉上定性地检查序列1中标记3的预测运动(不规则呼吸)沿着脊柱方向对于不同的水平值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/9f8a960f56ecc84bd1f3fde54b2ec2aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-tgGqIlArra_UZu7LfAmA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一个对象胸部上的三个标记随着呼吸运动而移动。</p></figure><p id="33d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图似乎表明UORO比RTRL和最小均方误差(LMS)更精确。事实上，我们限制了与RTRL关联的隐藏单元和SHL的数量，以保持可接受的计算时间。此外，LMS是自适应线性滤波器，不具有RNNs的代表能力。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/e04cf818d82414d93f554ef961cf971d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wo1RZhocRdO2Lk7VVdV3kw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用UORO训练的RNN预测序列1中标记3的z坐标(脊线轴)。转载自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022，经爱思唯尔许可。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/bb48c95d09e9e14687bdc405e0b042f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRcdf7Lt7--aocKyT1oByQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用RTRL训练的RNN预测序列1中标记3的z坐标(脊柱轴)。转载自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022，经爱思唯尔许可。</p></figure><p id="da89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们观察到LMS给出的预测具有高抖动，即，它在地面实况标记坐标周围振荡很多。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/43046cce00c48da7c528755f86e042e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPLLl-HCzYxhuKmVJ0wgbA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用LMS预测序列1中标记3的z坐标(脊线轴)。经爱思唯尔许可，转载自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022。</p></figure><h2 id="f948" class="nd md iq bd me ne nf dn mi ng nh dp mm lf ni nj mo lj nk nl mq ln nm nn ms no bi translated">3.2.数值预报精度</h2><p id="0c2a" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我承认我选择了上面的例子，因为它使UORO看起来很好。尽管如此，在某些情况下，UORO的表现不如其他方法。让我们仔细看看，当我们对0.1s和2.0s之间的水平值和九个序列的数值精度指标进行平均时，会发生什么情况。事实上，之前有报道称，放射治疗中的潜伏期范围在0.1秒和2.0秒之间<a class="ae kv" href="https://doi.org/10.1109/MCSE.2010.99" rel="noopener ugc nofollow" target="_blank">【9】</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/3770b4ea273d6fa954825a3193e1389e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8phyfLEXrTIhJ8y8wzXmaQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">各算法预测性能的比较。每个误差值对应于测试集在所考虑的序列和0.1s到2.0s之间的水平值上的给定性能测量的平均值。改编自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022，经Elsevier许可。</p></figure><p id="2b9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我报告了几个指标，因为它们给出了关于每个算法的预测行为的不同信息。从严格意义上讲，平均误差(MAE)是一段时间内的平均绝对误差，均方根误差(RMSE)惩罚更高的偏差，抖动衡量预测信号的振荡幅度。振荡太多的预测是不希望的，因为它们使得控制引导辐射束的机器人更加复杂。</p><p id="59ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当查看九个序列的平均误差度量时，我们观察到RTRL在MAE方面优于UORO，但是当查看RMSE时，情况正好相反。LMS精度相对较好，但抖动较大。当然，当仅考虑对应于规则呼吸的序列时，误差较低，而当观察对应于不规则呼吸的序列时，误差较高。</p><p id="d8f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是不同的系统有不同的延迟时间。在每种情况下，最佳算法的选择取决于所考虑的放射治疗系统的等待时间。因此，我将预测误差绘制成水平值的函数<em class="mb"> h. </em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/a82d670814b1a9437ef6a03b102bb154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5426VTsnQWvOEcAcqWtW1Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">根据预测范围预测每个算法的性能。每个点对应于9个序列中测试集的一个性能测量的平均值。经爱思唯尔许可，转载自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022。</p></figure><p id="284f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为超参数优化导致对于不同的<em class="mb"> h </em>值的不同超参数选择，所以图表看起来具有局部不规则性。然而，随着<em class="mb"> h </em>的增加，误差总体上趋于增加。我们观察到，对于低的<em class="mb"> h </em>值，线性预测实际上是最准确的预测算法。LMS对于中间值<em class="mb"> h </em>也很有效。</p><p id="68b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图总结了每种算法在RMSE和抖动方面的性能。顺便提一下，在我的原始文章中，我使用了一个类似的图表，用“归一化RMSE”来描述性能，缩写为nRMSE，而不是nRMSE前者是在评估性能时额外考虑信号幅度的措施。我们再次观察到，对于对应于不规则呼吸的信号，RMSE和抖动都较高。给定可接受的抖动水平和特定的地平线值，这种2D表示可以帮助找到具有最高预测准确度的算法。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/a02123c7c4fadbef7a36efe58e6d419a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rY0E3ZtYXbgpTJhetGOZg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">每个算法在RMSE和抖动方面的预测性能。每个点对应于对于单一水平值的规则或不规则呼吸序列的测试集的给定算法的RMSE和抖动的平均值。对应于具有高层位值的线性回归的数据点由于对应于高RMSE值而没有显示出来。</p></figure><h2 id="a8b4" class="nd md iq bd me ne nf dn mi ng nh dp mm lf ni nj mo lj nk nl mq ln nm nn ms no bi translated">3.3.超参数优化</h2><p id="0a8a" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">先说超参数优化。我们之前指出，我们使用交叉验证来选择网络超参数，以获得最佳性能。我发现在这项研究中，学习速度和SHL是对表现影响最大的因素。因此，让我们仔细看看他们的选择如何影响预测的准确性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/02963cc558371a0c9b3643db84ab2d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yjWezNj00Unsj_l_lJRBUg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">对于<br/>不同的水平值，交叉验证集UORO的预测nRMSE作为学习率和SHL的函数。黑色虚线对应0.1秒至2.0秒范围内的nRMSE最小值平均值，相关误差条对应这些范围内的标准偏差。转载自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022，经爱思唯尔许可。</p></figure><p id="cdca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们再次观察到，地平线<em class="mb"> h </em>越高，预测误差越高。在高值的<em class="mb"> h </em>的情况下，网络看起来更有效，具有更高的学习率和更低的SHL。换句话说，在这种情况下，当只考虑最近的信号并在输入呼吸模式发生变化时更快地调整权重时，网络工作得更好。</p><h2 id="3da6" class="nd md iq bd me ne nf dn mi ng nh dp mm lf ni nj mo lj nk nl mq ln nm nn ms no bi translated">3.4.时间性能</h2><p id="99fc" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">计算时间是评估我们算法的最重要的标准之一。我们观察到预测时间随着SHL的增加而增加，SHL与输入层的大小和隐藏单元的数量成比例。线性回归似乎是最快的预测方法，其次是LMS。UORO能够在我的机器上执行预测的速度比RTRL快大约100倍，这是他们各自计算复杂度<em class="mb"> O(q ) </em>和<em class="mb"> O(q⁴) </em>的直接结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/93d39a7dc24c43ce04fc0a06c06c9b2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eo55AzUiSNYT8X-o9tjLug.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">计算时间(戴尔英特尔酷睿i9–9900k 3.60 GHz CPU 32Gb RAM，带Matlab)。改编自<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">【3】</a>，版权2022，经爱思唯尔许可。</p></figure><h1 id="6f64" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">4.总之</h1><p id="da3a" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">这项工作是首次将UORO训练的RNNs应用于放射治疗中的呼吸运动补偿。UORO是一种在线学习算法，能够学习以流方式到达的数据，这使得对不规则呼吸具有高鲁棒性，并且比传统学习算法需要更少的数据。因此，它有可能减少对健康组织的辐射，从而避免气胸等副作用。</p><p id="5958" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">据我们所知，我们使用最广泛的水平值范围<em class="mb"> h </em>来比较关于呼吸运动预测的文献研究中的不同预测算法。我们发现线性回归在0.1s ≤ <em class="mb"> h </em> ≤ 0.2s时RMSE最低，其次是0.3s ≤ <em class="mb"> h </em> ≤ 0.5s时的LMS，以及<em class="mb"> h </em> ≥ 0.6s时的UORO，呼吸信号采样频率为10Hz。</p><p id="0123" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您对这个故事感兴趣，请不要犹豫阅读最初的研究文章，在那里我更广泛地涉及了这个主题并讨论了数学细节(这篇文章也是第一篇提供与UORO中的损失梯度相关的一些表达式的详细计算的文章)。数据集和Matlab代码是公开可用的，所以如果你愿意，你可以用它们来做你自己的实验。如果你愿意的话，也请考虑引用我的研究文章。</p><p id="fc2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">非常感谢您花时间阅读本文。我真诚地希望你能喜欢学习一些有趣的东西。请不要犹豫，在评论区告诉我你的想法。:)</p><h1 id="fe57" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">5.奖金:排名第一的把戏</h1><p id="b71d" class="pw-post-body-paragraph kw kx iq ky b kz mu jr lb lc mv ju le lf mw lh li lj mx ll lm ln my lp lq lr ij bi translated">我想提一下作为UORO基础的核心数学性质，它是在<a class="ae kv" href="https://doi.org/10.48550/arXiv.1507.07680" rel="noopener ugc nofollow" target="_blank">【10】</a>中首次介绍的。这是:</p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="b163" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给定矩阵的分解<em class="mb"> A </em>为秩1外积的和</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/c7cd6caceecdafe2264b7f42f697996f.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/0*ihYR4vlZfM5usNRZ"/></div></figure><p id="7cc6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">·独立随机符号<em class="mb"> ν </em> ᵢ <strong class="ky ir"> ∈ </strong> {-1，1}，和一个向量<em class="mb"> ρ </em>的<em class="mb"> n </em>正实数，以下量</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/25afa182b4730792759ff87f3e605ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/0*5vArWL6qx429W-WM"/></div></figure><p id="80a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">满足:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/09f09ace7fbda96603c5142accb2ed1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:164/0*YNq7RuLrthA5oCTV"/></div></div></figure><p id="2873" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，选择</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/bf4fcc4af96c9a69ad4f78af63eb4f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:352/0*rbDns2sCRQTEAbnf"/></div></figure><p id="67a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最小化近似值的方差。</p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="50f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个性质的第一部分相对容易证明，它是由期望算子的线性性产生的。方差最小化部分需要更详细的分析。虽然我不会在这里对后者做出评论，但我想在2.3节中与Matlab实现做一个链接。您可以查看代码，看到我的实现中的变量<code class="fe nx ny nz oa b">nu</code>对应于上面的向量ν(第30行)。变量<code class="fe nx ny nz oa b">rho0</code>和<code class="fe nx ny nz oa b">rho1</code>(第40和41行)对应于上述公式中的量<em class="mb"> ρ </em> ᵢ。还要注意后者是如何表示为代码中两个向量的范数的平方根的。出现在这些分数周围的变量<code class="fe nx ny nz oa b">pred_par.eps_normalizer</code>是为了保证数值的稳定性。</p><p id="74b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了推导UORO算法，秩1技巧实际上结合描述影响矩阵∂xₙ/∂ <em class="mb"> θ </em>的递归更新的方程应用了两次(参见第2.2节)。证明细节在原始UORO文件<a class="ae kv" href="https://doi.org/10.48550/arXiv.1702.05043" rel="noopener ugc nofollow" target="_blank">【8】</a>中。</p><h1 id="a5e8" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">参考</h1><ol class=""><li id="5349" class="oz pa iq ky b kz mu lc mv lf pb lj pc ln pd lr pe pf pg ph bi translated">Sung Hyuna、Jacques Ferlay、Rebecca L. Siegel、Mathieu Laversanne、Isabelle Soerjomataram、Ahmedin Jemal和Freddie Bray，<a class="ae kv" href="https://doi.org/10.3322/caac.21660" rel="noopener ugc nofollow" target="_blank">2020年全球癌症统计:全球185个国家36种癌症发病率和死亡率的全球估计数</a> (2020年)，ca:临床医生癌症杂志</li><li id="768d" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">国家癌症研究所-监测、流行病学和最终结果项目，<a class="ae kv" href="https://seer.cancer.gov/statfacts/html/lungb.html" rel="noopener ugc nofollow" target="_blank">癌症统计<br/>事实:肺癌和支气管癌</a>(2022)[2021年6月15日获取]</li><li id="80a3" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">Pohl Michel、Mitsuru Uesaka、Hiroyuki Takahashi、Kazuyuki Demachi和Ritu Bhusal Chhatkuli，<a class="ae kv" href="https://doi.org/10.48550/arXiv.2106.01100" rel="noopener ugc nofollow" target="_blank">使用经过无偏在线递归优化训练的递归神经网络预测外部标记的位置，用于安全肺癌放射治疗</a> (2022)，《生物医学中的计算机方法和程序》</li><li id="ed30" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">Ritu Bhusal Chhatkuli，<a class="ae kv" href="https://doi.org/10.15083/00073584" rel="noopener ugc nofollow" target="_blank">利用主成分分析和多通道奇异光谱分析开发无标记肿瘤预测系统，并在放射治疗中进行实时呼吸相位识别</a> (2016)，东京大学博士论文</li><li id="e272" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">Schweikard Achim，Hiroya Shiomi和John Adler，<a class="ae kv" href="https://doi.org/10.1118/1.1774132" rel="noopener ugc nofollow" target="_blank">放射外科中的呼吸跟踪</a> (2004)，医学物理学</li><li id="c790" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">Pohl Michel、Mitsuru Uesaka、Kazuyuki Demachi和Ritu Bhusal Chhatkuli，<a class="ae kv" href="https://doi.org/10.1016/j.compmedimag.2021.101941" rel="noopener ugc nofollow" target="_blank">使用经过实时递归学习训练的递归神经网络预测胸部内部点的运动，用于肺癌放射治疗中的潜伏期补偿</a> (2021)，计算机化医学成像和图形</li><li id="e2a1" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">Krilavicius Tomas、Indre Zliobaite、Henrikas Simonavicius和Laimonas Jaruevicius，<a class="ae kv" href="https://doi.org/10.48550/arXiv.1508.00749" rel="noopener ugc nofollow" target="_blank">预测放射治疗中实时肿瘤跟踪的呼吸运动</a> (2016)，ArXiv.org</li><li id="4a67" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">Corentin Tallec和Yann Ollivier，<a class="ae kv" href="https://doi.org/10.48550/arXiv.1702.05043" rel="noopener ugc nofollow" target="_blank">无偏在线递归优化</a> (2017)，ArXiv.org</li><li id="f930" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">维尔马·普纳姆、吴焕梅、马克·兰格、因陀罗·达斯和乔治·桑迪森，<a class="ae kv" href="https://doi.org/10.1109/MCSE.2010.99" rel="noopener ugc nofollow" target="_blank">调查:用于图像引导放射治疗的实时肿瘤运动预测</a> (2010)，科学计算&amp;工程</li><li id="c75f" class="oz pa iq ky b kz pi lc pj lf pk lj pl ln pm lr pe pf pg ph bi translated">Ollivier Yann、Corentin Tallec和Guillaume Charpiat，<a class="ae kv" href="https://doi.org/10.48550/arXiv.1507.07680" rel="noopener ugc nofollow" target="_blank">在线无回溯训练循环网络</a> (2015)，ArXiv.org</li></ol></div></div>    
</body>
</html>