<html>
<head>
<title>Paired t-test to evaluate Machine Learning classifiers using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python评估机器学习分类器的配对t检验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/paired-t-test-to-evaluate-machine-learning-classifiers-1f395a6c93fa#2022-07-06">https://towardsdatascience.com/paired-t-test-to-evaluate-machine-learning-classifiers-1f395a6c93fa#2022-07-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/58b301b5a386ee42d74d9e769c79686c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sy6P9RA3aTyka0WKvH434A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><div class=""/><div class=""><h2 id="5cdc" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">了解如何使用假设检验比较分类器</h2></div><h2 id="ee62" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">介绍</h2><p id="0ec5" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">在我的<a class="ae mj" href="https://medium.com/@marcellopoliti/hypotesis-testing-and-climate-change-7ef750ce149e" rel="noopener">上一篇文章</a>中，我谈到了使用统计工具正确比较不同模型的重要性，以便在选择阶段选择最佳模型。</p><p id="42d2" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated">在这篇文章中，我想特别关注一个统计测试，作为一名数据科学家或机器学习工程师，你需要知道这个测试。您可以使用此测试来确定两个分类器之间是否存在统计上的显著差异，以便您实际上可以只使用最好的一个。</p><h2 id="df04" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">k倍交叉验证</h2><p id="83b7" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">假设你有两个分类模型A和B(逻辑回归，决策树等…)。<br/>这种成对t检验需要使用N个不同的测试集来评估每个分类器。幸运的是，我们<strong class="ls jg">并不真的需要N个测试集，而是可以使用k倍交叉验证</strong>。<br/>这种方法允许您在几个测试集上测试一个模型，以获得更可靠的结果，即使您的数据有限。它是如何工作的？</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mp"><img src="../Images/00e3d770527003393df15faf98e90ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQHS0mSAGTf3uN9H9MW3Xg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">10倍简历(图片由作者提供)</p></figure><p id="ecbf" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated">把你的数据集分成k等份，例如k = 10。现在，您可以将第一个拆分用作测试集，将另外9个拆分用作训练集。接下来，您将使用第二个拆分作为测试集，使用另外9个拆分作为训练集，依此类推。这样，您将得到10个结果，比如说10个精度，您通常可以对这些结果取平均值以得到更可靠的结果。</p><h2 id="1ac8" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">计算差异</h2><p id="d87e" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">成对t检验想要找出两个分类器之间是否存在真正的差异，所以假设我们对准确性感兴趣，我们从计算两个模型之间的准确性差异开始。</p><p id="b895" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated">测试装置<em class="mu"> i </em>上A的精度与测试装置<em class="mu"> i </em>上B的精度配对。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/053eeb0f720434516ca03712b71edd58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SljGhPPs4_GVSdPSw5Yf-A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Diff(A，B)(图片由作者提供)</p></figure><ul class=""><li id="12c6" class="mw mx jf ls b lt mk lw ml ld my lh mz ll na mi nb nc nd ne bi translated"><strong class="ls jg">假设</strong>:精度来自正态分布(方差未知)</li><li id="b7bb" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated"><strong class="ls jg">零假设</strong>:A和B的精度来自同一个分布。因此，精度差的期望值等于0 (E[diff]=0)。基本上两个型号没什么区别。</li><li id="270c" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated"><strong class="ls jg">替代假设</strong>:精度来自两种不同的分布，E[diff] ≠ 0。基本上，模型实际上是不同的，所以一个比另一个好。</li></ul><h2 id="284d" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">配对t检验</h2><ul class=""><li id="3240" class="mw mx jf ls b lt lu lw lx ld nk lh nl ll nm mi nb nc nd ne bi translated">取一个<strong class="ls jg"> N次观察的样本</strong>(从k倍cv中给出)。假设这些结果来自具有固定均值和方差的正态分布。</li><li id="876a" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated">计算这些观察值的<strong class="ls jg">样本均值和样本方差</strong>。</li><li id="fbd6" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated">计算t统计量。</li><li id="b76b" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated">使用具有N-1个自由度的<strong class="ls jg"> t分布</strong>来估计真实平均值在给定范围内的可能性。</li><li id="e75b" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated"><strong class="ls jg">如果t统计不在以下区间内，则在显著性水平p拒绝零假设</strong>:</li></ul><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nn"><img src="../Images/beacacff6e5f69f7bf325343c2588b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4xQbSy8M6jwl6pyoYj6eMQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">间隔(图片由作者提供)</p></figure><h2 id="69fc" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">你需要的配方</h2><p id="24fa" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">现在只需使用下面的简单公式按照上述步骤。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi no"><img src="../Images/cf58ca38f165b42c7c90bfd2b2e9cab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*7jkODLQKeQZzxe7rpIRhwQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">公式(作者的图像)</p></figure><h2 id="cdd7" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">让我们完成我们的案子</h2><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/053eeb0f720434516ca03712b71edd58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SljGhPPs4_GVSdPSw5Yf-A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Diff(A，B)(图片由作者提供)</p></figure><ul class=""><li id="af89" class="mw mx jf ls b lt mk lw ml ld my lh mz ll na mi nb nc nd ne bi translated"><strong class="ls jg"> m </strong> = ( 2 + 3 + 1 + 2)/4 = 2</li><li id="d897" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated"><strong class="ls jg">SD</strong>=[(0+1+1+0)/(4–1)]^(1/2)= = 0.471</li><li id="8dfb" class="mw mx jf ls b lt nf lw ng ld nh lh ni ll nj mi nb nc nd ne bi translated"><strong class="ls jg">t</strong>=(^(1/2北部)* m)/sd = 0.816</li></ul><p id="a769" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated">如果我们设置一个<strong class="ls jg"> p值= 0.05 </strong>和一个<strong class="ls jg">自由度n-1 = 3 </strong>，我们可以在t表上检查分数，你可以在这里找到<a class="ae mj" href="https://www.sjsu.edu/faculty/gerstman/StatPrimer/t-table.pdf" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/5cc1e47dd973f15eaa5f18cf9c97458f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8LYqWhzK-bUws5j-3bfyA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">t表(来源:<a class="ae mj" href="https://www.sjsu.edu/faculty/gerstman/StatPrimer/t-table.pdf" rel="noopener ugc nofollow" target="_blank">https://www . sjsu . edu/faculty/gerst man/stat primer/t-table . pdf</a>)</p></figure><p id="b7e8" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated">t = 0.816是否在范围[-3.182，+3.182]内？是的，所以我们<strong class="ls jg">不能拒绝零假设，我们的两个分类器</strong>之间没有显著差异。</p><h2 id="4714" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">5x2成本验证</h2><p id="542b" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">当你在真实数据上运行这个测试时，你应该有<strong class="ls jg">至少20到30个测试集</strong> (k倍)，<strong class="ls jg">否则你可以使用一个5x2 coss验证</strong>。这篇文章很好地解释了这个方法。但是三言两语:</p><blockquote class="nq nr ns"><p id="6703" class="lq lr mu ls b lt mk kg lv lw ml kj ly nt mm ma mb nu mn md me nv mo mg mh mi ij bi translated">在本测试中，我们进行了5次2重交叉验证。在每次复制中，可用数据被随机划分为两个大小相等的集合S1和S2。每个学习算法(A或B)在每一组上训练，并在另一组上测试。</p></blockquote><h2 id="4526" class="ku kv jf bd kw kx ky dn kz la lb dp lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">我们来编码吧！</h2><p id="2c61" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated">让我们导入iris数据并定义两个分类器，一个逻辑回归(LR)和一个max_depth = 1的决策树分类器(DT)。我们想证明LR的性能明显优于DT。让我们从训练这两个模型开始，看看它们的准确性。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="nw nx l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">训练两个模型</p></figure><pre class="mq mr ms mt gt ny nz oa ob aw oc bi"><span id="f0ea" class="ku kv jf nz b gy od oe l of og">output:<br/>Model A accuracy: 95.56% <br/>Model B accuracy: 64.44%</span></pre><p id="301a" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated">我想将显著性水平(alpha)设置为0.05。我想非常确定这些模型在统计学上是不同的。如果函数返回的p值小于α，我们可以成功地拒绝零假设。</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="nw nx l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">运行配对t检验</p></figure><pre class="mq mr ms mt gt ny nz oa ob aw oc bi"><span id="f3b9" class="ku kv jf nz b gy od oe l of og">output:</span><span id="942c" class="ku kv jf nz b gy oh oe l of og">t statistic: 7.936 <br/>aplha  0.05 <br/>p value: 0.001 </span><span id="050e" class="ku kv jf nz b gy oh oe l of og">Reject null hypotesis</span></pre><h1 id="05b2" class="oi kv jf bd kw oj ok ol kz om on oo lc kl op km lg ko oq kp lk kr or ks lo os bi translated">最后的想法</h1><blockquote class="nq nr ns"><p id="fc25" class="lq lr mu ls b lt mk kg lv lw ml kj ly nt mm ma mb nu mn md me nv mo mg mh mi ij bi translated"><em class="jf">假设检验为做出关于感兴趣人群的数据决策提供了一个可靠的框架。它有助于研究人员成功地将数据从样本外推至更大的人群。</em></p></blockquote><p id="5f64" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated">比较一次在不同模型上得到的结果来选择哪一个是最好的，从来都不是一个好方法。统计测试允许我们客观地陈述一个模型是否表现得更好。每次你运行实验时，统计测试被用来表明你所做的比以前存在的更好，只要去阅读任何机器学习论文。这显然不是存在于下一篇文章中的唯一测试，我将继续更详细地研究McNemar测试！</p><h1 id="8081" class="oi kv jf bd kw oj ok ol kz om on oo lc kl op km lg ko oq kp lk kr or ks lo os bi translated">结束了</h1><p id="0b25" class="pw-post-body-paragraph lq lr jf ls b lt lu kg lv lw lx kj ly ld lz ma mb lh mc md me ll mf mg mh mi ij bi translated"><em class="mu">马赛洛·波利蒂</em></p><p id="ac7d" class="pw-post-body-paragraph lq lr jf ls b lt mk kg lv lw ml kj ly ld mm ma mb lh mn md me ll mo mg mh mi ij bi translated"><a class="ae mj" href="https://www.linkedin.com/in/marcello-politi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae mj" href="https://twitter.com/_March08_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae mj" href="https://march-08.github.io/digital-cv/" rel="noopener ugc nofollow" target="_blank"> CV </a></p></div></div>    
</body>
</html>