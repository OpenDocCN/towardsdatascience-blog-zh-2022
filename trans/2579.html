<html>
<head>
<title>Master CSV Files in the Terminal With the Csvkit Package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Csvkit包在终端中控制CSV文件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/master-csv-files-in-the-terminal-with-the-csvkit-package-70984d394501#2022-06-04">https://towardsdatascience.com/master-csv-files-in-the-terminal-with-the-csvkit-package-70984d394501#2022-06-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="29ea" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Excel并不总是一个好主意。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8639a2862ce012b1f8fca51fbcdfe593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-41uGOTJit7uxoxV"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="375a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">您的旅程概述</h1><ol class=""><li id="a82d" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><a class="ae ky" href="#c0e1" rel="noopener ugc nofollow">为什么要在终端处理CSV文件？</a></li><li id="aa07" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#8929" rel="noopener ugc nofollow">快速设置</a></li><li id="ad06" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#c793" rel="noopener ugc nofollow">Excel黑仔(in2csv) </a></li><li id="0fed" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#85f5" rel="noopener ugc nofollow">数据Scapel (csvcut) </a></li><li id="0f31" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#4079" rel="noopener ugc nofollow">好看(csvlook) </a></li><li id="1b21" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#138e" rel="noopener ugc nofollow">牛逼统计(csvstat) </a></li><li id="6a63" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#5243" rel="noopener ugc nofollow">巧妙搜索(csvgrep) </a></li><li id="da58" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#294e" rel="noopener ugc nofollow">包装</a></li></ol></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="c0e1" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">1 —为什么要在终端中处理CSV文件？</h1><p id="1b62" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">很少有事情能像在<strong class="lt iu">命令行终端</strong>中工作一样令人生畏。许多数据科学家没有计算机科学背景，因此不习惯这样。甚至看起来在命令行终端工作已经是过去的事情了😧</p><p id="7473" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">我在这里告诉你，这是假的。事实上，随着像<a class="ae ky" href="https://docs.microsoft.com/en-us/azure/cloud-shell/overview" rel="noopener ugc nofollow" target="_blank"> Azure Cloud Shell </a>这样的基于云的Shell的增加，学习命令行比以往任何时候都更有价值。事实是命令行是一个<em class="ns">效率助推器</em>。对文件夹使用图形用户界面(GUI)对于简单的事情来说是最容易的，但是对于较难的事情来说就变得越来越复杂了。</p><p id="38e8" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">对于数据科学家/数据工程师来说，有许多终端工具可以快速处理终端中的数据。在这篇博文中，我将告诉你一个我最喜欢的叫做<a class="ae ky" href="https://csvkit.readthedocs.io/en/latest/tutorial.html" rel="noopener ugc nofollow" target="_blank"> csvkit </a>的东西。这是一个在终端中处理CSV文件的工具。如果您正在处理CSV文件或Excel文件形式的月度报告，这将非常有用。使用csvkit，您可以轻松地:</p><ul class=""><li id="214e" class="lr ls it lt b lu nn lw no ly nt ma nu mc nv me nw mg mh mi bi translated">将excel文件转换为CSV文件</li><li id="9419" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated">打印格式良好的CSV文件</li><li id="b071" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated">剪切特定的列</li><li id="63f0" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated">获取有关列的统计信息</li><li id="34c9" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated">使用正则表达式在列内搜索</li></ul><p id="8bc3" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">还有更多！您也许可以用Excel做同样的事情。然而，使用csvkit做事情的真正价值在于您可以自动化这个过程(例如使用cronjobs)。</p><p id="a17f" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">我将向您介绍如何使用csvkit，以便您可以在终端中处理CSV文件。具体来说，我会教你我认为最重要的五个csvkit命令。如果你更喜欢视觉学习，那么我也在csvkit上制作了一个免费的youtube视频系列<a class="ae ky" href="https://www.youtube.com/playlist?list=PLSE7WKf_qqo1Dl9C2HuegYp0aK7SbZ3Jx" rel="noopener ugc nofollow" target="_blank">你可以看看😃</a></p><blockquote class="nx ny nz"><p id="6f9b" class="na nb ns lt b lu nn ju nc lw no jx nd oa np nf ng ob nq ni nj oc nr nl nm me im bi translated"><strong class="lt iu">先决条件:</strong>您应该已经安装了运行BASH的命令行终端。如果你使用的是Linux，那么这应该不成问题，而Windows用户可能想看看<a class="ae ky" href="https://cmder.net/" rel="noopener ugc nofollow" target="_blank"> cmder </a>或者用<a class="ae ky" href="https://cloudbytes.dev/snippets/how-to-install-wsl2-on-windows-1011" rel="noopener ugc nofollow" target="_blank"> WSL2 </a>启用Linux子系统。</p></blockquote></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="8929" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">2—快速设置</h1><p id="b5af" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">要开始使用csvkit包，您需要安装它。csvkit包是一个Python包，所以您需要做的就是运行(假设您已经安装了Pyhon的包安装程序pip ):</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="4a22" class="oi la it oe b gy oj ok l ol om">pip install csvkit</span></pre><p id="5bef" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">如果不想全局安装csvkit包，那么可以考虑使用<a class="ae ky" href="#https://virtualenv.pypa.io/en/latest/" rel="noopener ugc nofollow"> virtualenv </a>来设置一个虚拟环境。要检查安装是否正常，您可以运行以下命令:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="fe97" class="oi la it oe b gy oj ok l ol om">in2csv --help</span></pre><p id="1ceb" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">如果一切安装正确，您现在应该会看到命令<code class="fe on oo op oe b">in2csv</code>的帮助页面。命令<code class="fe on oo op oe b">in2csv</code>是csvkit为我们安装的几个命令之一。</p><p id="c023" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">让我们打开一个名为<code class="fe on oo op oe b">csvkit_sandbox</code>的新文件夹，你可以在这里玩你的新玩具:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="5acb" class="oi la it oe b gy oj ok l ol om">mkdir csvkit_<!-- -->sandbox<br/>cd csvkit_<!-- -->sandbox</span></pre><p id="0335" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">最后，您需要一些实际使用的数据:让我们下载csvkit文档也在使用的数据:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="d692" class="oi la it oe b gy oj ok l ol om">curl -L -O https://raw.githubusercontent.com/wireservice/csvkit/master/examples/realdata/ne_1033_data.xlsx</span></pre><p id="aaee" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">运行上面的命令后，您应该在您的文件夹中安装了文件<code class="fe on oo op oe b">ne_1033_data.xlsx</code>。如果你不信任我，你可以运行<code class="fe on oo op oe b">ls</code>来检查你的<code class="fe on oo op oe b">csvkit_sandbox</code>文件夹的内容😉</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="c793" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">Excel黑仔(in2csv)</h1><p id="9c86" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">我们要看的第一个命令是<code class="fe on oo op oe b">in2csv</code>命令。这个命令将一个excel文件转换成一个CSV文件(废话！).这非常有用，因为数据科学家经常获得excel格式的报告，并且必须将它们转换为CSV文件才能有效地使用它们。</p><p id="8cd4" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">要使用<code class="fe on oo op oe b">in2csv</code>命令，您只需编写:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="17f9" class="oi la it oe b gy oj ok l ol om">in2csv ne_1033_data.xlsx</span></pre><p id="956d" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">如果您像这样使用该命令，那么您只需将所有输出转储到终端。即使对于中等大小的文件，这也很糟糕。更好的选择是将输出重定向到一个文件，如下所示:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="ce41" class="oi la it oe b gy oj ok l ol om">in2csv ne_1033_data.xlsx &gt; new_file.csv</span></pre><p id="0b67" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">现在，在您的<code class="fe on oo op oe b">csvkit_sandbox</code>文件夹中应该有一个名为<code class="fe on oo op oe b">new_file.csv</code>的新CSV文件。我有时使用的一个技巧是在同一个命令中添加一个<code class="fe on oo op oe b">rm</code>命令来删除原始文件，如下所示:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="4c89" class="oi la it oe b gy oj ok l ol om">in2csv ne_1033_data.xlsx &gt; new_file.csv &amp;&amp; rm ne_1033_data</span></pre><p id="5ef7" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">如果您运行上面的命令，那么在您的<code class="fe on oo op oe b">csvkit_sandbox</code>文件夹中应该只有文件<code class="fe on oo op oe b">new_file.csv</code>。如果您想签出文件<code class="fe on oo op oe b">new_file.csv</code>，那么尝试命令:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="65d0" class="oi la it oe b gy oj ok l ol om">head new_file.csv</span></pre><p id="cca8" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">该命令将文件<code class="fe on oo op oe b">new_file.csv</code>中的第一行输出到终端。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/852644bab8571caffd76997963873797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rwl6keuv_HzyTfMU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@coopery?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Mohamed Nohassi </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="85f5" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">4—数据手术刀(csvcut)</h1><p id="9aa8" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">在上一节中，您从excel文件中检索了所有列，并将其转换为CSV文件。但是通常您不需要所有的列来进行进一步的分析。如果是这样的话，那么和我们一起拖无用的列将是一件麻烦事。不要害怕！使用命令<code class="fe on oo op oe b">csvcut</code>可以选择CSV文件的某些列:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="75ff" class="oi la it oe b gy oj ok l ol om">csvcut -c county,total_cost,ship_date new_file.csv</span><span id="f4ea" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output:</strong><br/>county,total_cost,ship_date<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BURT,499.0,2013-06-20<br/>...</span></pre><p id="0d05" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">上述命令仅从CSV文件<code class="fe on oo op oe b">new_file.csv</code>中选择列<code class="fe on oo op oe b">county</code>、<code class="fe on oo op oe b">total_cost</code>和<code class="fe on oo op oe b">ship_date</code>。</p><p id="8129" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">但是如果您不记得列名了呢？然后，一个快速的技巧是运行命令:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="0336" class="oi la it oe b gy oj ok l ol om">csvcut -n new_file.csv</span><span id="9f59" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output:<br/></strong>1: state<br/>2: county<br/>3: fips<br/>4: nsn<br/>5: item_name<br/>6: quantity<br/>7: ui<br/>8: acquisition_cost<br/>9: total_cost<br/>10: ship_date<br/>11: federal_supply_category<br/>12: federal_supply_category_name<br/>13: federal_supply_class<br/>14: federal_supply_class_name</span></pre><p id="aa50" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">可选参数<code class="fe on oo op oe b">-n</code>给出了列的名称。整洁，对不对？命令<code class="fe on oo op oe b">csvcut</code>对于选择想要继续的列非常有用。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="4079" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">5-看起来不错(csvlook)</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/722444f0ff45c36c34c55769e5b45d26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zx4ICz6DwTCl95bo"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@cuartodeiibra?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">梅尔·埃利亚斯</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9623" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">当您将最后一部分中的CSV文件输出到终端时，它看起来不是很好。将原始CSV文件打印到终端时，这样读起来通常会很糟糕:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="405f" class="oi la it oe b gy oj ok l ol om">csvcut -c county,total_cost,ship_date new_file.csv</span><span id="35f1" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output:</strong><br/>county,total_cost,ship_date<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>ADAMS,138.0,2008-07-11<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BUFFALO,499.0,2008-09-24<br/>BURT,499.0,2013-06-20<br/>...</span></pre><p id="4b6e" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">命令<code class="fe on oo op oe b">csvlook</code>前来救援。您可以使用<strong class="lt iu">管道操作符</strong> <code class="fe on oo op oe b">|</code>将命令<code class="fe on oo op oe b">csvcut</code>的输出作为命令<code class="fe on oo op oe b">csvlook</code>的输入，如下所示:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="eaa1" class="oi la it oe b gy oj ok l ol om">csvcut -c county,total_cost,ship_date new_file.csv | csvlook</span><span id="eb1c" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output:<br/></strong>| county     | total_cost |  ship_date |<br/>| ---------- | ---------- | ---------- |<br/>| ADAMS      |     138.00 | 2008-07-11 |<br/>| ADAMS      |     138.00 | 2008-07-11 |<br/>| ADAMS      |     138.00 | 2008-07-11 |<br/>| ADAMS      |     138.00 | 2008-07-11 |<br/>| ADAMS      |     138.00 | 2008-07-11 |<br/>| ADAMS      |     138.00 | 2008-07-11 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BUFFALO    |     499.00 | 2008-09-24 |<br/>| BURT       |     499.00 | 2013-06-20 |<br/>...</span></pre><p id="bfd6" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">那看起来好多了！现在，用肉眼解析输出要容易得多。</p><p id="9204" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">还记得你用管道操作符<code class="fe on oo op oe b">|</code>将<code class="fe on oo op oe b">csvcut</code>的输出传递给<code class="fe on oo op oe b">csvlook</code>的输入的技巧吗？这在csvkit中非常常见，并且是创建更复杂管道的关键🔥</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="138e" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">6 —令人敬畏的统计数据(csvstat)</h1><p id="959d" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">当作为数据分析师或数据科学家处理CSV文件时，我们经常希望提取汇总统计数据。有数百种方法可以提取CSV文件中各列的中值和平均值。你应该用哪一个？将数据导入Excel？用熊猫进行快速数据分析？</p><p id="2ff2" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">我想你知道我想说什么。当然，csvkit对此有一个命令叫做<code class="fe on oo op oe b">csvstat</code>。命令<code class="fe on oo op oe b">csvstat</code>从CSV文件中的每一列提取基本统计数据:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="1b58" class="oi la it oe b gy oj ok l ol om">csvstat new_file.csv</span><span id="dc75" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output:</strong></span><span id="f318" class="oi la it oe b gy oq ok l ol om">1. "state"<br/>Type of data:          Text<br/>Contains null values:  False<br/>Unique values:         1<br/>Longest value:         2 characters<br/>Most common values:    NE (1036x)</span><span id="ffee" class="oi la it oe b gy oq ok l ol om">2. "county"<br/>Type of data:          Text<br/>Contains null values:  False<br/>Unique values:         35<br/>Longest value:         10 characters<br/>Most common values:    DOUGLAS (760x)<br/>                       DAKOTA (42x)<br/>                       CASS (37x)<br/>                       HALL (23x)<br/>                       LANCASTER (18x)</span><span id="caca" class="oi la it oe b gy oq ok l ol om">3. "fips"<br/>Type of data:          Number<br/>Contains null values:  False<br/>Unique values:         35<br/>Smallest value:        31001<br/>Largest value:         31185<br/>Sum:                   32176888<br/>Mean:                  31058.772<br/>Median:                31055<br/>StDev:                 23.881<br/>Most common values:    31055 (760x)<br/>                       31043 (42x)<br/>                       31025 (37x)<br/>                       31079 (23x)<br/>                       31109 (18x)<br/>...</span></pre><p id="18d9" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">如果您仔细阅读上面的输出，那么您会发现<code class="fe on oo op oe b">csvstat</code>根据列类型给出不同的统计信息。如果你的某一列是文本格式，那么谈论那一列的标准差就没什么意义了。</p><p id="a5c5" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">命令<code class="fe on oo op oe b">csvstat</code>执行<strong class="lt iu">类型的推理</strong>。它尝试推断列的类型，然后找到合适的汇总统计信息。根据我的经验，这非常有效。</p><p id="c56a" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">有时，您不想要所有列的统计数据，而只想要几列。为此，使用命令<code class="fe on oo op oe b">csvcut</code>过滤出必要的列，然后通过管道将其传递给<code class="fe on oo op oe b">csvstat</code>以获得统计数据:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="01a9" class="oi la it oe b gy oj ok l ol om">csvcut -c total_cost,ship_date new_file.csv | csvstat</span><span id="02f0" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output:</strong></span><span id="14c8" class="oi la it oe b gy oq ok l ol om">1. "total_cost"<br/>Type of data:          Number<br/>Contains null values:  False<br/>Unique values:         92<br/>Smallest value:        0<br/>Largest value:         412000<br/>Sum:                   5553135.17<br/>Mean:                  5360.169<br/>Median:                6000<br/>StDev:                 13352.139<br/>Most common values:    6800 (304x)<br/>                       10747 (195x)<br/>                       6000 (105x)<br/>                       499 (98x)<br/>                       0 (81x)</span><span id="9b4d" class="oi la it oe b gy oq ok l ol om">2. "ship_date"<br/>Type of data:          Date<br/>Contains null values:  False<br/>Unique values:         84<br/>Smallest value:        2006-03-07<br/>Largest value:         2014-01-30<br/>Most common values:    2013-04-25 (495x)<br/>                       2013-04-26 (160x)<br/>                       2008-05-20 (28x)<br/>                       2012-04-16 (26x)<br/>                       2006-11-17 (20x)</span><span id="d20c" class="oi la it oe b gy oq ok l ol om">Row count: 1036</span></pre></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="5243" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">7 —智能搜索(csvgrep)</h1><p id="cdd9" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">我极力推荐的最后一个命令是<code class="fe on oo op oe b">csvgrep</code>命令。命令<code class="fe on oo op oe b">csvgrep</code>允许您搜索CSV文件以找到特定的记录。如果你习惯了终端命令<code class="fe on oo op oe b">grep</code>，那么<code class="fe on oo op oe b">csvgrep</code>命令也差不多。</p><p id="1484" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">要查看它的运行情况，让我们在CSV文件中搜索county <strong class="lt iu"> HOLT </strong>:</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="3017" class="oi la it oe b gy oj ok l ol om">csvgrep -c county -m "HOLT" new_file.csv</span><span id="c67a" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output: <br/></strong>NE,HOLT,31089.0,1005-00-073-9421,"RIFLE,5.56 MILLIMETER",1.0,Each,499.0,499.0,2008-05-19,10.0,WEAPONS,1005.0,"Guns, through 30 mm"</span><span id="b844" class="oi la it oe b gy oq ok l ol om">NE,HOLT,31089.0,1005-00-589-1271,"RIFLE,7.62 MILLIMETER",1.0,Each,138.0,138.0,2006-03-08,10.0,WEAPONS,1005.0,"Guns, through 30 mm"</span><span id="b349" class="oi la it oe b gy oq ok l ol om">NE,HOLT,31089.0,1005-00-589-1271,"RIFLE,7.62 MILLIMETER",1.0,Each,138.0,138.0,2006-03-08,10.0,WEAPONS,1005.0,"Guns, through 30 mm"<br/>...</span></pre><p id="9f25" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">成功了！现在你只能得到县<strong class="lt iu">霍尔特</strong>的记录。</p><ul class=""><li id="a315" class="lr ls it lt b lu nn lw no ly nt ma nu mc nv me nw mg mh mi bi translated">参数<code class="fe on oo op oe b">-c</code>用于选择<em class="ns">列。</em></li><li id="4159" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated">参数<em class="ns"> </em> <code class="fe on oo op oe b">-m</code>用于查找与匹配的字符串<em class="ns">。</em></li></ul><blockquote class="nx ny nz"><p id="7e5c" class="na nb ns lt b lu nn ju nc lw no jx nd oa np nf ng ob nq ni nj oc nr nl nm me im bi translated"><strong class="lt iu"> Pro提示:</strong><code class="fe on oo op oe b">csvgrep</code>命令也允许使用可选参数<code class="fe on oo op oe b">-r</code>进行正则表达式搜索。查看<a class="ae ky" href="https://csvkit.readthedocs.io/en/latest/scripts/csvgrep.html" rel="noopener ugc nofollow" target="_blank"> csvgrep文档</a>了解更多相关信息！</p></blockquote><p id="0e64" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">我给你的最后一个建议是，试着组合几个csvkit命令来获得很酷的结果。看看这个。</p><pre class="kj kk kl km gt od oe of og aw oh bi"><span id="5b9a" class="oi la it oe b gy oj ok l ol om">csvcut -c county,total_cost new_file.csv | csvgrep -c county -m "HOLT" | csvlook</span><span id="2ee0" class="oi la it oe b gy oq ok l ol om"><strong class="oe iu">Output:</strong><br/>| county | total_cost |<br/>| ------ | ---------- |<br/>| HOLT   |     499.00 |<br/>| HOLT   |     138.00 |<br/>| HOLT   |     138.00 |<br/>| HOLT   |     138.00 |<br/>| HOLT   |     138.00 |<br/>| HOLT   |     138.00 |<br/>| HOLT   |     138.00 |<br/>| HOLT   |      58.71 |</span></pre><p id="a214" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">首先，我只选择了带有<code class="fe on oo op oe b">csvcut</code>的两列<code class="fe on oo op oe b">county</code>和<code class="fe on oo op oe b">total_cost</code>。然后我用命令<code class="fe on oo op oe b">csvgrep</code>搜索县<strong class="lt iu"> HOLT </strong>。最后，我用命令<code class="fe on oo op oe b">csvlook</code>很好地显示了结果。现在轮到你和✌️搭档了</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="294e" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">8 —总结</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/6784561c6caed537e147ff1a6283d163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ylpRqADocSnxf8s0"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@spencerbergen?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯潘塞·伯根</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="042e" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">希望你开始像我一样喜欢csvkit。同样，如果你想学习一些更酷的技巧和诀窍，那么查看csvkit文档<a class="ae ky" href="https://csvkit.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">或csvkit </a>上我的youtube视频<a class="ae ky" href="https://www.youtube.com/playlist?list=PLSE7WKf_qqo1Dl9C2HuegYp0aK7SbZ3Jx" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="50b9" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated"><strong class="lt iu">喜欢我写的？</strong>查看我的其他帖子，了解更多Python内容:</p><ul class=""><li id="dad3" class="lr ls it lt b lu nn lw no ly nt ma nu mc nv me nw mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/how-to-write-high-quality-python-as-a-data-scientist-cde99f582675">作为数据科学家如何写出高质量的Python</a></li><li id="b073" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/modernize-your-sinful-python-code-with-beautiful-type-hints-4e72e98f6bf1">用漂亮的类型提示使你罪恶的Python代码现代化</a></li><li id="2911" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/visualizing-missing-values-in-python-is-shockingly-easy-56ed5bc2e7ea">用Python可视化缺失值非常简单</a></li><li id="6b59" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/introducing-anomaly-outlier-detection-in-python-with-pyod-40afcccee9ff">使用PyOD在Python中引入异常/离群点检测🔥</a></li><li id="a92a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nw mg mh mi bi translated">5个专家建议让你的Python字典技能突飞猛进🚀</li></ul><p id="8865" class="pw-post-body-paragraph na nb it lt b lu nn ju nc lw no jx nd ly np nf ng ma nq ni nj mc nr nl nm me im bi translated">如果你对数据科学、编程或任何介于两者之间的东西感兴趣，那么请随意在LinkedIn上加我，并向✋问好</p></div></div>    
</body>
</html>