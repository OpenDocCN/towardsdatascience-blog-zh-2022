<html>
<head>
<title>How to Build REST API in Simple Words</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用简单的话构建REST API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-rest-api-in-simple-words-2aa779749186#2022-06-06">https://towardsdatascience.com/how-to-build-rest-api-in-simple-words-2aa779749186#2022-06-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a098" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://pedram-ataee.medium.com/list/notes-from-industry-265207a5d024" rel="noopener">行业笔记</a></h2><div class=""/><div class=""><h2 id="58bc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">作为数据科学家使用Flask和Docker创建REST API的行动手册</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/63e0fd4dd1f55ebcb1b54fe996627b91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SkwCsutrC6WkRM9E"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">约书亚·厄尔在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae lh" href="https://unsplash.com/@huper?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">胡佩尔的照片</a></p></figure><p id="5742" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我最近开发了一个名为<a class="ae lh" href="https://rapidapi.com/pedram.ataee/api/word-similarity/" rel="noopener ugc nofollow" target="_blank"> OWL </a>的<strong class="lk jd">上下文化的最相似单词</strong> API服务。OWL API是使用Flask和Docker开发的高级NLP服务。该服务通过托管在RapidAPI市场上的一系列REST APIs与社区共享。这对我来说是一个伟大的旅程，所以我决定与你分享它发展的各个阶段。</p><p id="aefe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本文描述了如何使用Flask和Docker构建REST API的分步指南。您可以在您的数据科学项目以及您正在开发的任何其他web应用程序中使用该指南。另外，这篇文章是<strong class="lk jd">“…用简单的话”</strong>系列的一部分，在这里我与你分享我的经验。这个系列之前帮助了很多数据科学爱好者。希望对你也有帮助。</p><ul class=""><li id="b48b" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="https://medium.com/p/aba6f42cc888" rel="noopener">如何在Kubernetes上简单部署</a></li><li id="85f3" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://medium.com/p/263618071dd8" rel="noopener">如何用简单的话学习Git</a></li><li id="9904" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://medium.com/p/2275e4299628" rel="noopener">如何用简单的词语学习circle ci</a></li><li id="fee1" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://medium.com/p/448e2c7f6ebe" rel="noopener">用简单的话深度学习</a></li></ul><p id="c5c9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您想阅读更多关于OWL API的内容，请查看下面的文章。</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/how-to-compute-word-similarity-a-comparative-analysis-e9d9d3cb3080"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jd gy z fp na fr fs nb fu fw jc bi translated">如何计算词语相似度——比较分析</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">Owl API是一个强大的单词相似性服务，使用高级文本聚类技术和各种word2vec模型</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj lb mv"/></div></div></a></div></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h2 id="11a7" class="nr ns it bd nt nu nv dn nw nx ny dp nz lr oa ob oc lv od oe of lz og oh oi iz bi translated">步骤1 —创建app.py</h2><p id="14cf" class="pw-post-body-paragraph li lj it lk b ll oj kd ln lo ok kg lq lr ol lt lu lv om lx ly lz on mb mc md im bi translated">首先，您必须编写一个Python脚本，将RESTful端点映射到一个函数。我们给剧本取名<code class="fe oo op oq or b">app.py</code>。在这个例子中，RESTful端点是<code class="fe oo op oq or b">/general/&lt;N&gt;/&lt;WORD&gt;</code> <strong class="lk jd"> </strong>，其中<strong class="lk jd"> </strong> <code class="fe oo op oq or b">general<strong class="lk jd"> </strong></code>是一个常量，<code class="fe oo op oq or b">N</code>和<code class="fe oo op oq or b">WORD</code>是两个变量。通过这些变量，用户可以将数据发送到RESTful端点的相应函数，即<code class="fe oo op oq or b">similar_words(N, WORD)</code>。在服务器上部署后，您在Python脚本中定义的RESTful端点将被添加到主机的URL中。</p><pre class="ks kt ku kv gt os or ot ou aw ov bi"><span id="4adc" class="nr ns it or b gy ow ox l oy oz">import os<br/>import sys<br/>from flask import Flask, jsonify, request<br/>from flask_httpauth import HTTPBasicAuth</span><span id="48d1" class="nr ns it or b gy pa ox l oy oz">import gensim.downloader as api<br/>sys.path += [os.getcwd()]<br/>from src.core.word_clusterizer import WordClusterizer<br/>from src.backend.wrapper import GensimWrapper</span><span id="cec6" class="nr ns it or b gy pa ox l oy oz">auth = HTTPBasicAuth()<br/>app = Flask(__name__)</span><span id="5c56" class="nr ns it or b gy pa ox l oy oz">MODEL = api.load('glove-wiki-gigaword-300')</span><span id="45c7" class="nr ns it or b gy pa ox l oy oz"><strong class="or jd">@app.route('/general/&lt;N&gt;/&lt;WORD&gt;', methods=['GET'])</strong><br/><strong class="or jd">def similar_words(N, WORD):<br/>    </strong>model = GensimWrapper(MODEL)<br/>    try:<br/>        wc = WordClusterizer(model=model, word=WORD, top_n=int(N)<br/>        wc.fit()<br/>        results = wc.result<br/>    except KeyError:<br/>        results = 'Nothing is found!'<br/>    <strong class="or jd">return jsonify(results)</strong></span><span id="4ddc" class="nr ns it or b gy pa ox l oy oz">if __name__ == '__main__':<br/>    port = os.environ.get("PORT", 8080)<br/>    <strong class="or jd">app.run(host='0.0.0.0', port=port, debug=True)</strong></span></pre><p id="ada2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">不用说，RESTful端点的相应功能是您的数据科学项目的核心。在这种情况下，它是一个单词相似性服务，与当前的解决方案相比，它以更大的粒度提取最相似的单词。</p><h2 id="5824" class="nr ns it bd nt nu nv dn nw nx ny dp nz lr oa ob oc lv od oe of lz og oh oi iz bi translated">步骤2 —创建Dockerfile文件</h2><p id="4863" class="pw-post-body-paragraph li lj it lk b ll oj kd ln lo ok kg lq lr ol lt lu lv om lx ly lz on mb mc md im bi translated">您需要一个Docker映像，在启动服务器时运行<code class="fe oo op oq or b">app.py</code>。要构建这样的Docker映像，您需要一个如下所示的Docker文件。</p><pre class="ks kt ku kv gt os or ot ou aw ov bi"><span id="cfc7" class="nr ns it or b gy ow ox l oy oz"># MAINTAINER YOUR_NAME</span><span id="b0a3" class="nr ns it or b gy pa ox l oy oz">FROM <strong class="or jd">pdrm83/nlp-essentials:latest</strong></span><span id="11fd" class="nr ns it or b gy pa ox l oy oz">RUN pip install --upgrade pip<br/>COPY . /project/<br/>RUN pip install .</span><span id="b293" class="nr ns it or b gy pa ox l oy oz"><strong class="or jd">WORKDIR /project/src/.</strong><br/>ENV PYTHONPATH /project<br/>ENV PORT 8080</span><span id="af53" class="nr ns it or b gy pa ox l oy oz"><strong class="or jd">EXPOSE 8080</strong><br/>EXPOSE 80</span><span id="d3b5" class="nr ns it or b gy pa ox l oy oz"><strong class="or jd">CMD ["python3", "app/app.py"]</strong></span></pre><p id="028b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在docker文件中，您必须打开/暴露设置<code class="fe oo op oq or b">app.py</code>运行的端口。正如您在步骤1中看到的，我将<code class="fe oo op oq or b">app.py</code>脚本设置为在定义为<code class="fe oo op oq or b">port = os.environ.get("PORT", 8080)</code>的端口上运行。这一行意思是，从环境中把<code class="fe oo op oq or b">port</code>变量设置为<code class="fe oo op oq or b">PORT</code>的值，如果设置了，否则设置为8080。</p><p id="714f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这种情况下，<code class="fe oo op oq or b">PORT</code>没有预先设置。因此，我必须确保在docker文件中打开端口8080。我通过Dockerfile文件中的<code class="fe oo op oq or b">EXPOSE 8080</code>做到了这一点。如果<code class="fe oo op oq or b">PORT</code>先前在环境中被设置为除8080之外的任何值，您必须通过添加<code class="fe oo op oq or b">EXPOSE XXXX</code>在docker文件中打开该端口。</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/how-to-create-an-ubuntu-server-to-build-an-ai-product-using-docker-a2414aa09f59"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jd gy z fp na fr fs nb fu fw jc bi translated">如何创建一个Ubuntu服务器来使用Docker构建一个AI产品</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">构建Ubuntu服务器的代码片段集合，该服务器可用于开发简单的人工智能产品。</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="pb l ng nh ni ne nj lb mv"/></div></div></a></div><p id="ad55" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">注意，我在名为<code class="fe oo op oq or b">nlp-essentials</code>的Docker映像创建的环境中运行<code class="fe oo op oq or b">CMD ["python3", "app/app.py"]</code>。这是我之前通过安装所有需要的库构建的Docker映像。这张Docker图片保存在我的Dockerhub账户<code class="fe oo op oq or b">pdrm83</code>中，需要时使用。每当我想更新API服务时，就会拉出<code class="fe oo op oq or b">nlp-essentials</code>映像。这有助于在我每次想要更新API时不安装所有需要的库。最后，但同样重要的是，由于我将<code class="fe oo op oq or b">app.py</code>存储在<code class="fe oo op oq or b">ROOT/src/app/.</code>中，所以我将<code class="fe oo op oq or b">WORKDIR /project/src/.</code>添加到Dockerfile中。你不能复制这一行。你只需要根据你的代码库的文件结构在Dockerfile中正确地配置它。</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/how-to-build-an-automated-development-pipeline-d0b9820a2f3d"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jd gy z fp na fr fs nb fu fw jc bi translated">如何构建自动化开发管道</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">用最小的挫折开发软件的剧本</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="pc l ng nh ni ne nj lb mv"/></div></div></a></div><h2 id="a32c" class="nr ns it bd nt nu nv dn nw nx ny dp nz lr oa ob oc lv od oe of lz og oh oi iz bi translated">步骤3 —启动服务器</h2><p id="1741" class="pw-post-body-paragraph li lj it lk b ll oj kd ln lo ok kg lq lr ol lt lu lv om lx ly lz on mb mc md im bi translated">简而言之，您必须使用<code class="fe oo op oq or b">docker build -f &lt;&lt;DOCKERFILE_NAME&gt;&gt; -t &lt;&lt;IMAGE_NAME&gt;&gt;</code>构建docker映像，然后使用<code class="fe oo op oq or b">docker run -i -p 80:8080 &lt;&lt;IMAGE_ID&gt;&gt;</code>运行它。<code class="fe oo op oq or b">IMAGE_ID</code>是您在上一步中创建的Docker图像的id。注意，我将端口8080映射到80，因为<code class="fe oo op oq or b">app.py</code>在端口8080上运行，我想在端口80上为用户提供API服务。最后，您必须确保端口80在您使用的任何机器上都是开放的。</p><p id="0e26" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有很多方法可以让用户访问你的服务。不过，我想给你介绍一个名为<a class="ae lh" href="https://ngrok.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> ngrok </strong> </a>的很酷的服务，它可以让你通过三个简单的步骤让你的电脑上网<strong class="lk jd">😮。</strong>这3个步骤简单如下:</p><ol class=""><li id="e58e" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md pd mk ml mm bi translated">下载<code class="fe oo op oq or b">ngrok.zip</code>和<code class="fe oo op oq or b">unzip /path/to/ngrok.zip</code>。</li><li id="22f4" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md pd mk ml mm bi translated">运行<code class="fe oo op oq or b">ngrok authtoken YOUR_OWN_TOKEN</code></li><li id="db97" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md pd mk ml mm bi translated">运行<code class="fe oo op oq or b">ngrok http 80</code></li></ol><p id="ce9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">运行<code class="fe oo op oq or b">ngrok http 80</code>之后，ngrok服务在<code class="fe oo op oq or b">ngrok.io</code>域上为您的项目创建一个专用的URL，看起来像下面的链接。</p><pre class="ks kt ku kv gt os or ot ou aw ov bi"><span id="36d5" class="nr ns it or b gy ow ox l oy oz"><a class="ae lh" href="http://d9500fdc2530.ngrok.io/" rel="noopener ugc nofollow" target="_blank">http://YOUR_DEDICATED_SUBDOMAIN.ngrok.io/</a></span></pre><p id="22a7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你的服务现在在互联网上对每个人都是可利用的。你不需要任何花哨的云服务就能把你的API服务推向市场。这不是很神奇吗？你可以在下面的文章中读到为什么我认为ngrok对你向社区提供API服务非常有用。</p><div class="ms mt gp gr mu mv"><a rel="noopener follow" target="_blank" href="/how-to-avoid-cloud-bill-shock-in-data-science-services-e2ade5fae2a8"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jd gy z fp na fr fs nb fu fw jc bi translated">如何避免数据科学服务中的云账单冲击</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">使用ngrok在不到30秒的时间内构建互联网服务器的方法</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">towardsdatascience.com</p></div></div><div class="ne l"><div class="pe l ng nh ni ne nj lb mv"/></div></div></a></div><h2 id="d464" class="nr ns it bd nt nu nv dn nw nx ny dp nz lr oa ob oc lv od oe of lz og oh oi iz bi translated">遗言</h2><p id="7844" class="pw-post-body-paragraph li lj it lk b ll oj kd ln lo ok kg lq lr ol lt lu lv om lx ly lz on mb mc md im bi translated">软件产品最值得推荐的架构之一是<strong class="lk jd"> API架构</strong>。这个架构帮助你设计<strong class="lk jd">模块化</strong>和<strong class="lk jd">可重用</strong>服务，这些服务也<strong class="lk jd">易于维护</strong>。例如，有一些有效的解决方案来测试和记录一系列REST APIs，帮助您轻松地维护它们。在本文中，我描述了如何为您的数据科学项目构建一个<strong class="lk jd"> RESTful API </strong>。除了RESTful之外，还有其他类型的API协议，这不是本文的重点。</p><h2 id="b29c" class="nr ns it bd nt nu nv dn nw nx ny dp nz lr oa ob oc lv od oe of lz og oh oi iz bi translated">感谢阅读！</h2><p id="5340" class="pw-post-body-paragraph li lj it lk b ll oj kd ln lo ok kg lq lr ol lt lu lv om lx ly lz on mb mc md im bi translated">如果你喜欢这个帖子，想支持我…</p><ul class=""><li id="72b2" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><em class="pf">跟我上</em> <a class="ae lh" href="https://medium.com/@pedram-ataee" rel="noopener"> <em class="pf">中</em> </a> <em class="pf">！</em></li><li id="2ca5" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><em class="pf">在</em> <a class="ae lh" href="https://www.amazon.com/Pedram-Ataee/e/B08D6J3WNW" rel="noopener ugc nofollow" target="_blank"> <em class="pf">亚马逊</em> </a> <em class="pf">上查看我的书！</em></li><li id="6029" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><em class="pf">成为</em> <a class="ae lh" href="https://pedram-ataee.medium.com/membership" rel="noopener"> <em class="pf">中的一员</em> </a> <em class="pf">！</em></li><li id="9a4e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><em class="pf">连接上</em><a class="ae lh" href="https://www.linkedin.com/in/pedrama/" rel="noopener ugc nofollow" target="_blank"><em class="pf">Linkedin</em></a><em class="pf">！</em></li><li id="6b66" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><em class="pf">关注我</em> <a class="ae lh" href="https://twitter.com/pedram_ataee" rel="noopener ugc nofollow" target="_blank"> <em class="pf">推特</em> </a> <em class="pf">！</em></li></ul><div class="ms mt gp gr mu mv"><a href="https://pedram-ataee.medium.com/membership" rel="noopener follow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd jd gy z fp na fr fs nb fu fw jc bi translated">通过我的推荐链接加入Medium—Pedram Ataee博士</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">pedram-ataee.medium.com</p></div></div><div class="ne l"><div class="pg l ng nh ni ne nj lb mv"/></div></div></a></div></div></div>    
</body>
</html>