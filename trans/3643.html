<html>
<head>
<title>The Grammar of Graphics or how to do ggplot-style plotting in Julia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图形的语法或如何在Julia中进行ggplot风格的绘图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-grammar-of-graphics-or-how-to-do-ggplot-style-plotting-in-julia-1b0ac2162c82#2022-08-12">https://towardsdatascience.com/the-grammar-of-graphics-or-how-to-do-ggplot-style-plotting-in-julia-1b0ac2162c82#2022-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/b6272687e2556ee11fb787d4b6224e31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DU28_a0MDvk_3W-PTd42Zw.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">照片由<a class="ae jd" href="https://unsplash.com/@olloweb?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">法新社跟随</a>在<a class="ae jd" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><div class=""/><div class=""><h2 id="133a" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">Julia统计绘图软件包的比较介绍</h2></div><p id="6bb5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">图形语法(GoG) </em>是由Leland Wilkinson(<a class="ae jd" href="https://books.google.de/books/about/The_Grammar_of_Graphics.html?id=_kRX4LoFfGQC&amp;redir_esc=y" rel="noopener ugc nofollow" target="_blank"><em class="lr">The Grammar of Graphics</em>，Springer，1999 </a>)和Hadley Wickham(<a class="ae jd" href="https://vita.had.co.nz/papers/layered-grammar.html" rel="noopener ugc nofollow" target="_blank">A Layered Grammar of Graphics，<em class="lr">Journal of Computational and graphic Statistics</em>，vol. 19，no. 1，PP . 3–28，2010 </a>)提出的概念；<a class="ae jd" href="https://byrneslab.net/classes/biol607/readings/wickham_layered-grammar.pdf" rel="noopener ugc nofollow" target="_blank"> pdf </a>)。</p><p id="cf9e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它的主要思想是，每一个统计图都可以由一些基本构件(或机制)组合而成。这允许</p><ul class=""><li id="57b7" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">可视化的简单明了的定义</li><li id="20e3" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">通过仅交换以模块化方式受影响的构建块，可视化的简单适应</li><li id="a8ab" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">可重用的规范(相同的可视化可以应用于不同的数据)</li></ul><p id="b139" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">韦翰表明，这个概念不仅是一个很好的理论。他在非常流行的R包<code class="fe mg mh mi mj b"><a class="ae jd" href="https://ggplot2.tidyverse.org" rel="noopener ugc nofollow" target="_blank">ggplot2</a></code>中实现了它。Julia编程语言也有一些GoG实现。</p><p id="9d3a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇文章中，我将首先解释图形语法的基本概念和思想。在后续文章中，我将展示以下四个完全或部分基于GoG的Julia图形包:</p><ul class=""><li id="107f" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><a class="ae jd" href="http://gadflyjl.org/stable/" rel="noopener ugc nofollow" target="_blank">牛虻. jl </a></li><li id="1fb7" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><a class="ae jd" href="https://www.queryverse.org/VegaLite.jl/stable/" rel="noopener ugc nofollow" target="_blank"> VegaLite.jl </a></li><li id="7820" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><a class="ae jd" href="https://docs.juliaplots.org/stable/" rel="noopener ugc nofollow" target="_blank"> Plots.jl </a>(带<a class="ae jd" href="https://github.com/JuliaPlots/StatsPlots.jl" rel="noopener ugc nofollow" target="_blank"> StatsPlots.jl </a>)</li><li id="de76" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><a class="ae jd" href="https://makie.juliaplots.org/stable/" rel="noopener ugc nofollow" target="_blank"> Makie.jl </a>和<a class="ae jd" href="http://juliaplots.org/AlgebraOfGraphics.jl/stable/" rel="noopener ugc nofollow" target="_blank">代数图形</a></li></ul><p id="286a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了让您能够对这些Julia包进行一对一的比较，我将在每篇文章中使用相同的示例图和相同的基础数据。在本文的第二部分，我将给出示例中使用的数据，因此我不必在后续的每篇文章中重复这些内容。</p><h1 id="3879" class="mk ml jg bd mm mn mo mp mq mr ms mt mu km mv kn mw kp mx kq my ks mz kt na nb bi translated">图形语法</h1><p id="08e1" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">在接下来的章节中，我将解释威尔金森的“图形语法”和韦翰的“图形分层语法”的基本思想。我不会深入到每一个细节，在两个概念不同的方面，我会有意识地选择一个，给出一个相当“统一”的观点。</p><p id="5317" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于代码示例，我使用的是Julia的牛虻包(vers。1.3.4 &amp;朱莉娅1.7.3)。</p><h2 id="aa93" class="nh ml jg bd mm ni nj dn mq nk nl dp mu le nm nn mw li no np my lm nq nr na ns bi translated">主要成分</h2><p id="b6ba" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">可视化的主要构件是</p><ul class=""><li id="ec23" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">数据</li><li id="519a" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">美学</li><li id="7676" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">几何学</li></ul><p id="4c0e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">数据<br/> </strong>这三个概念大家最熟悉的大概就是<em class="lr">数据</em>。这里我们假设数据以表格的形式出现(就像一个数据库表)。对于可视化来说，区分<em class="lr">数字</em>和<em class="lr">分类</em>数据是很重要的。</p><p id="23b1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">例如，我们这里有一个水果经销商的库存清单:</p><pre class="nt nu nv nw gt nx mj ny nz aw oa bi"><span id="94f8" class="nh ml jg mj b gy ob oc l od oe">Row │ quantity  fruit   price <br/>────────────────────────────────<br/> 1  │    3     apples   2.5<br/> 2  │   20     oranges  3.9<br/> 3  │    8     bananas  1.9</span></pre><p id="c347" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它由三个变量<code class="fe mg mh mi mj b">quantity</code>、<code class="fe mg mh mi mj b">fruit</code>和<code class="fe mg mh mi mj b">price</code>组成。<code class="fe mg mh mi mj b">fruit</code>是一个<em class="lr">分类</em>变量，而另外两个变量是<em class="lr">数值</em>。</p><p id="5c69" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">美学<br/> </strong>为了可视化一个数据变量，它被映射到一个或多个<em class="lr">美学</em>。</p><p id="4d21" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">数字变量可以映射到例如</p><ul class=""><li id="2cf6" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><em class="lr">在x轴、y轴或z轴上定位</em></li><li id="edb7" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><em class="lr">尺寸</em></li></ul><p id="2e21" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">分类变量可以映射到例如</p><ul class=""><li id="0b89" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><em class="lr">颜色</em></li><li id="238b" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><em class="lr">形状</em></li><li id="af2e" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><em class="lr">纹理</em></li></ul><p id="a780" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">几何<br/> </strong>除了数据变量和美学，我们至少需要一个<em class="lr">几何</em>来指定一个完整的可视化。几何学基本上告诉我们想要哪种类型的图。一些例子是:</p><ul class=""><li id="9d35" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><em class="lr">线</em> (=线图)</li><li id="8e95" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><em class="lr">点</em> (=散点图)</li><li id="8b59" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><em class="lr">条形图</em> (=条形图)</li></ul><h2 id="42cc" class="nh ml jg bd mm ni nj dn mq nk nl dp mu le nm nn mw li no np my lm nq nr na ns bi translated">基本示例</h2><p id="958e" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">现在我们有足够的信息来建立我们的第一个基于图形语法的可视化。对于使用牛虻包的代码示例，我们假设上面的库存表位于一个名为<code class="fe mg mh mi mj b">inventory</code>的变量中，变量的类型为<code class="fe mg mh mi mj b">DataFrame</code>。</p><p id="a5be" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先我们想看看数量是如何按价格分布的。根据所选的几何图形，我们可以得到散点图或线图:</p><ul class=""><li id="2c21" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">将<strong class="kx jh">价格</strong>映射到<strong class="kx jh"> x轴</strong>，<strong class="kx jh">数量</strong>到<strong class="kx jh"> y轴</strong> <br/>使用牛虻中的<strong class="kx jh">点几何体</strong><br/>:<code class="fe mg mh mi mj b">plot(inventory, x = :price, y = :quantity, Geom.point)</code></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/2a6d1b9eb1d34ebe1d5cf4f1237ef7a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*UW8aAcnGppyuWr2HpO6o4g.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">散点图[图片由作者提供]</p></figure><ul class=""><li id="949b" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">将<strong class="kx jh">价格</strong>映射到<strong class="kx jh"> x轴</strong>，<strong class="kx jh">数量</strong>到<strong class="kx jh"> y轴<br/> </strong>使用<strong class="kx jh">线几何<br/> </strong>在牛虻:<code class="fe mg mh mi mj b">plot(inventory, x = :price, y = :quantity, Geom.line)</code></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/25c22957180d263e6524fdabeda7eacd.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*nEBa9USGZhEugMUa60hrkg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线图[图片由作者提供]</p></figure><p id="02c6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下一步中，我们想额外看看，哪些水果涉及。所以我们也必须将<code class="fe mg mh mi mj b">fruit</code>映射到一个合适的审美。在下面的两个例子中，首先使用<em class="lr">形状</em>，然后使用<em class="lr">颜色</em>。</p><ul class=""><li id="dcc0" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">将<strong class="kx jh">价格</strong>映射到<strong class="kx jh"> x轴</strong>，将<strong class="kx jh">数量</strong>映射到<strong class="kx jh"> y轴，将</strong>水果<strong class="kx jh">形状</strong>映射到<br/>使用<strong class="kx jh">点几何<br/>牛虻<code class="fe mg mh mi mj b">plot(inventory, x = :price, y = :quantity, shape = :fruit, Geom.point)</code></strong></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f0d5e02cdeb963838e96243617549837.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*5IlmM9XOHtU5mhHxUflZZA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">水果映射成形状[图片由作者提供]</p></figure><ul class=""><li id="eff2" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">将<strong class="kx jh">价格</strong>映射到<strong class="kx jh"> x轴</strong>，将<strong class="kx jh">数量</strong>映射到<strong class="kx jh"> y轴，将</strong>水果<strong class="kx jh">颜色</strong>T59使用<strong class="kx jh">点几何<br/> </strong>牛虻:<code class="fe mg mh mi mj b">plot(inventory, x = :price, y = :quantity, color = :fruit, Geom.point)</code></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/76ef2b65e564afaf7547bc04868863b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*ey7HjgCNjwYEL1m2WEpxwA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">水果映射到颜色[图片由作者提供]</p></figure><p id="9295" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">也可以将<em class="lr">一个</em>变量映射到<em class="lr">几个</em>美学。例如，我们可以将<code class="fe mg mh mi mj b">fruit</code>映射到<em class="lr">形状</em>以及<em class="lr">颜色</em>。</p><ul class=""><li id="15ec" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">绘制<strong class="kx jh">价格</strong>到<strong class="kx jh"> x轴</strong>，<strong class="kx jh">数量</strong>到<strong class="kx jh"> y轴，<br/>果</strong>到一个<strong class="kx jh">形状</strong>，<strong class="kx jh">果</strong>到一个<strong class="kx jh">颜色</strong>，<br/>使用一个<strong class="kx jh">点几何<br/> </strong>在牛虻:<code class="fe mg mh mi mj b">plot(inventory, x = :price, y = :quantity, <br/> shape = :fruit, color = :fruit, Geom.point)</code></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/7caa9ab969e7c41bf32f341a13c87f89.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*WwnDfFVZs-Y5AgukPaYRwQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">水果映射到形状和颜色[图片由作者提供]</p></figure><p id="3ab2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用<em class="lr">条形几何图形</em>我们可以绘制库存数量的统计表。这里我们将一个分类变量(<em class="lr"> fruit </em>)映射到x轴上的位置。</p><ul class=""><li id="43c9" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">将<strong class="kx jh">水果</strong>映射到<strong class="kx jh"> x轴</strong>，<strong class="kx jh">数量</strong>到<strong class="kx jh"> y轴</strong>使用牛虻中的<strong class="kx jh">杆几何<br/></strong>:<code class="fe mg mh mi mj b">plot(inventory, x = :fruit, y = :quantity, Geom.bar)</code></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/8cc9995df60c085e39ee011f27965752.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*zUFZm1iuyIKWwGLIQAjd6A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">条形几何[图片由作者提供]</p></figure><p id="47bc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们将<em class="lr">水果</em>也映射到一种颜色，那么条形将以不同的颜色显示:</p><ul class=""><li id="6d70" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">将<strong class="kx jh">水果</strong>映射到<strong class="kx jh"> x轴</strong>，<strong class="kx jh">数量</strong>到<strong class="kx jh"> y轴</strong>，<strong class="kx jh">水果</strong>到一个<strong class="kx jh">颜色</strong> <br/>使用一个<strong class="kx jh">几何形状<br/> </strong>牛虻:<code class="fe mg mh mi mj b">plot(inventory, x = :fruit, y = :quantity, color = :fruit, Geom.bar)</code></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/2367b7fe07b63e6997178769f8b3932a.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*VrqD7D_KRH5D3f1mNcDpSg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">酒吧几何和水果映射到颜色[图片由作者提供]</p></figure><p id="b3a4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些基本示例很好地展示了如何使用几个简单的构建块来指定可视化，从而组成一种强大的可视化语言。</p><p id="9bb5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它们还表明，这些规范使图形包能够为可视化的各个方面导出有意义的缺省值，这些缺省值没有明确给出。</p><p id="4a26" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所有的例子都</p><ul class=""><li id="f1c8" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">x轴和y轴的有意义的<em class="lr">刻度</em>(通常使用比给定数据变量稍大的间隔)</li><li id="4b4e" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">连同适当的<em class="lr">记号</em>和<em class="lr">轴</em>和<em class="lr">标记</em></li><li id="3c6a" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">以及一个描述性的<em class="lr">标签</em>(简单地使用变量名)</li></ul><p id="a2c1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一些例子甚至有自动生成的<em class="lr">图例</em>。这是可能的，因为图例只是数据映射到美学的反函数。例如，如果我们将变量<em class="lr">水果</em>映射到一个<em class="lr">颜色</em>，那么相应的图例就是从<em class="lr">颜色</em>到<em class="lr">水果</em>的反向映射。</p><h2 id="4bbd" class="nh ml jg bd mm ni nj dn mq nk nl dp mu le nm nn mw li no np my lm nq nr na ns bi translated">更多配料</h2><p id="97b3" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">老实说，为了一个完整的可视化，我们需要更多的元素，而不仅仅是<em class="lr">数据</em>、<em class="lr">美学</em>和<em class="lr">几何</em>。</p><p id="6e75" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">比例<br/> </strong>为了将数字变量映射到位置美学(如x轴或y轴上的位置)，我们还需要一个<em class="lr">比例</em>，将数据单位映射到物理单位(如屏幕、窗口或网页)。</p><p id="cee4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的例子中，默认使用了一个<em class="lr">线性标尺</em>。但是我们也可以用<em class="lr">对数标度来交换。</em></p><p id="f7ec" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">也可以将数字变量映射到颜色。然后使用<em class="lr">连续色标</em>进行映射，如下例所示:</p><ul class=""><li id="4b81" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">将<strong class="kx jh">价格</strong>映射到<strong class="kx jh"> x轴</strong>，<strong class="kx jh">数量</strong>到<strong class="kx jh"> y轴</strong>，<strong class="kx jh">数量</strong>到一个<strong class="kx jh">颜色</strong> <br/>使用一个<strong class="kx jh">点几何<br/> </strong>在牛虻:<code class="fe mg mh mi mj b">plot(inventory, x = :price, y = :quantity, <br/>color = :quantity, Geom.point)</code></li></ul><figure class="nt nu nv nw gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f2ad3fe6412007f11250212dce6ed508.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*htAy2Cf0rY9fiDzTbbGDxw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">使用色阶[图片由作者提供]</p></figure><p id="55bf" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">坐标系<br/> </strong>与标尺密切相关的是<em class="lr">坐标系的概念，</em>定义了位置值如何映射到绘图平面上。在上面的例子中，默认使用了<em class="lr">笛卡尔坐标系</em>。其他可能性是<em class="lr">极坐标</em>或<em class="lr">重心</em>坐标系统或用于地图投影的各种系统。</p><p id="f450" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有趣的是，我们可以从相同的数据和美学映射生成不同类型的图表，只需改变坐标系:例如，条形图基于笛卡尔坐标系。如果我们用极坐标系统替换它，我们会得到一个Coxcomb图，如下例所示，来自数据科学的<a class="ae jd" href="https://r4ds.had.co.nz/index.html" rel="noopener ugc nofollow" target="_blank"><em class="lr"/></a>(Hadley Wickham和Garret Grolemund，O'Reilly，2017)。</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/b59f91fb7c8eb4288a311350e896d0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l588hhCrWlYiBkMHxsfU1A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">条形图和统计图【来源:见正文；在<a class="ae jd" href="https://creativecommons.org/licenses/by-nc-nd/3.0/us/" rel="noopener ugc nofollow" target="_blank">知识共享许可</a>下使用</p></figure><h2 id="fe33" class="nh ml jg bd mm ni nj dn mq nk nl dp mu le nm nn mw li no np my lm nq nr na ns bi translated">结论</h2><p id="32b0" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">有了这两个额外的概念，我们现在有了基本GoG的完整图像。在这篇短文中，我当然只能呈现所有可能的<em class="lr">美学</em>和<em class="lr">图形</em>的子集，还有更多GoG元素，如<em class="lr">统计</em>和<em class="lr">小平面</em>。但是到目前为止，我们所看到的是图形语法的核心，应该足以抓住主要思想。</p><h1 id="6ae2" class="mk ml jg bd mm mn mo mp mq mr ms mt mu km mv kn mw kp mx kq my ks mz kt na nb bi translated">Julia图形软件包的比较</h1><p id="85d0" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">现在让我们转到不同的Julia图形包的比较，我将在几篇后续文章中介绍这些比较。作为一种准备，我现在将在这些后续文章中展示不同示例图所用的数据(这些数据的灵感来自YouTube教程<a class="ae jd" href="https://youtu.be/s7ZRVCvdKAo" rel="noopener ugc nofollow" target="_blank"> Julia Analysis for初学者</a>，来自频道<a class="ae jd" href="https://www.youtube.com/c/juliafortalentedamateurs" rel="noopener ugc nofollow" target="_blank"> julia for天才业余爱好者</a>)，并展望我将使用何种图表进行比较。</p><h2 id="27e1" class="nh ml jg bd mm ni nj dn mq nk nl dp mu le nm nn mw li no np my lm nq nr na ns bi translated">按国内生产总值划分的国家</h2><p id="469d" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">用于绘图示例的数据基础是2018年和2019年所有国家及其GDP和人口规模的列表。它来自这个<a class="ae jd" href="https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)" rel="noopener ugc nofollow" target="_blank">维基百科页面</a>(从国际货币基金组织和联合国的数据库中获得数据)。这些数据也可以从我的GitHub知识库中以<a class="ae jd" href="https://raw.githubusercontent.com/roland-KA/StatisticalPlotsWithJulia/main/data/countries.csv" rel="noopener ugc nofollow" target="_blank"> CSV格式</a>获得。</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oh"><img src="../Images/129fcdd8b8b3a2feed37abed0ff78198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*viQtHa-Gp-jl9phpc6Kf4Q.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">国家列表摘录[图片由作者提供]</p></figure><p id="ecb0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">列表中的列具有以下含义:</p><ul class=""><li id="9d04" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">ID</code>:唯一标识符</li><li id="9249" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">Region</code>:国家所在的洲</li><li id="82b8" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">Subregion</code>:每个大陆又分为几个次区域</li><li id="b052" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">Pop2018</code>:2018年全国人口【百万人】</li><li id="98b3" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">Pop2019</code>:2019年全国人口【百万人】</li><li id="b944" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">PopChangeAbs</code>:2018年至2019年人口绝对数量变化【百万人】</li><li id="691b" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">PopChangePct</code>:类似于<code class="fe mg mh mi mj b">PopChangeAbs</code>，但以百分比[%]表示</li><li id="cb86" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">GDP</code>:2019年国内生产总值【百万美元】</li><li id="4a4e" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><code class="fe mg mh mi mj b">GDPperCapita</code> : <code class="fe mg mh mi mj b">GDP</code>除以该国居住人数【美元/人】；该列不在源文件中，但将被计算(见下文)</li></ul><p id="be20" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用以下Julia代码下载文件并转换为<code class="fe mg mh mi mj b">DataFrame</code>:</p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="c1e2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第7行计算上面提到的新列<code class="fe mg mh mi mj b">GDPperCapita</code>，并将其添加到<code class="fe mg mh mi mj b">countries</code> -DataFrame中。</p><h2 id="313e" class="nh ml jg bd mm ni nj dn mq nk nl dp mu le nm nn mw li no np my lm nq nr na ns bi translated">汇总数据</h2><p id="ceda" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">每个国家有一行(210行)的详细列表将在两个级别上进行分组和汇总(使用<code class="fe mg mh mi mj b">DataFrame</code>-函数):</p><p id="9fa9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">级别1 —区域:</strong>以下代码通过<code class="fe mg mh mi mj b">Region</code>(即洲)对列表进行分组，省略第1行中的列<code class="fe mg mh mi mj b">Country</code>和<code class="fe mg mh mi mj b">Subregion</code>(使用嵌套的<code class="fe mg mh mi mj b">select</code>)，然后创建一个汇总所有数字列的聚合(第2–5行)。</p><p id="e061" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">2级—子区域</strong>:第7-11行的子区域级应用了相同的操作。首先通过省略列<code class="fe mg mh mi mj b">Country</code>(第7行)的<code class="fe mg mh mi mj b">Subregion</code>对国家进行分组，然后根据该数据创建汇总；再次对所有数字列求和。此外，地区的名称是从每个小组中挑选出来的(<code class="fe mg mh mi mj b">:Region =&gt; first</code></p><figure class="nt nu nv nw gt is"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="8ae7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">得到的数据帧<code class="fe mg mh mi mj b">regions_cum</code>和<code class="fe mg mh mi mj b">subregions_cum</code>如下所示:</p><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ok"><img src="../Images/659bd02d00a9a98edab8c94a6f39a23c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zp2sV3Un7us5jG4yTjr28w.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">按区域汇总(regions_cum)</p></figure><figure class="nt nu nv nw gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ol"><img src="../Images/b8cc47c110091b24ae4de9d2baa4e2b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AJk0Kz_MF9aPtawKIcfn4Q.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">按次区域汇总(次区域累计)</p></figure><h2 id="d3c6" class="nh ml jg bd mm ni nj dn mq nk nl dp mu le nm nn mw li no np my lm nq nr na ns bi translated">摘要</h2><p id="b566" class="pw-post-body-paragraph kv kw jg kx b ky nc kh la lb nd kk ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">数据帧<code class="fe mg mh mi mj b">countries</code>、<code class="fe mg mh mi mj b">subregions_cum</code>和<code class="fe mg mh mi mj b">regions_cum</code>是即将发表的关于不同Julia图形包的文章中绘图示例的基础。在这些文章中，我们将看到如何创建</p><ul class=""><li id="c07c" class="ls lt jg kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">条形图</li><li id="e18a" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">散点图</li><li id="ad0d" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">直方图</li><li id="f042" class="ls lt jg kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">盒子情节和小提琴情节</li></ul><p id="c818" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这些图形包中。</p><p id="2598" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第一篇文章将呈现牛虻。敬请关注！</p></div></div>    
</body>
</html>