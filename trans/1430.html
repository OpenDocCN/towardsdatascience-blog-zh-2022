<html>
<head>
<title>An introduction to the generalized linear model (GLM)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">广义线性模型(GLM)介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-the-generalized-linear-model-glm-e32602ce6a92#2022-04-08">https://towardsdatascience.com/an-introduction-to-the-generalized-linear-model-glm-e32602ce6a92#2022-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5049" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">它是什么？模型是如何拟合的&amp;在房价预测中的应用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/23c59cb4fe4f765b7ccbbf2f238f55fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d1t55DKtvQikvJOqawBAaA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://unsplash.com/photos/ob-hsLNxYPc" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="d8c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在经典的线性模型中，通常需要正态性。这显示在图0.1中，在随机变量X固定的情况下，Y的分布是正态的(由每个小的钟形曲线说明)。回归曲线穿过每个正态分布的平均值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/5feb0680fca9b0898727c42ae93606c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*5vSiHMp1PnsR4kyS-nusRA.png"/></div></figure><p id="9a03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在广义线性模型中，这一要求不再必要，因为我们可以根据我们对数据的了解，为这些观察值选择一个分布模型。这是通过链接函数实现的，它将这些观察值的平均值<em class="lw">e[yᵢ】</em>转换成线性形式。此外，也不再需要同质性。<em class="lw"> Y </em>中的误差方差不必是常数。[5]</p><h1 id="e69d" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">广义线性模型的组成部分</h1><p id="6cd7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">GLM有三个主要组成部分，链接功能是其中之一。这些组件是</p><p id="4dda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.一个<strong class="lb iu">随机分量</strong> Yᵢ，它是每次观测的响应变量。值得注意的是，这是一个条件分布的反应变量，这意味着Yᵢ是Xᵢ.的条件</p><p id="f4e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lw"> Yᵢ </em>的分布属于<strong class="lb iu">指数族</strong>，这意味着Yᵢ具有形式，定义为【2】</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/7546b3382ffbcc41a2e208b4870cbce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nzGQGzsp_3gLiCsrKJc17Q.png"/></div></div></figure><p id="d736" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不同的是，<strong class="lb iu">规范形式</strong>中的<em class="lw"> θᵢ </em>没有被转换，这使得规范形式更容易处理。此外，请注意，总是可以将指数族转换为标准形式。或者，我们也可以将指数函数写成下面的形式[1]</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/49c1e21c5f0322ae4f39ade478797e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*RCuynaas0JzPbsOsK3NDxQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式1.2指数族</p></figure><p id="5da8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在GLM使用。在等式1.2中，<em class="lw"> θᵢ </em>和<em class="lw"> ϕᵢ </em>分别是<strong class="lb iu">位置</strong>(与均值相关)和<strong class="lb iu">比例</strong>参数(与。另外，我们用<em class="lw"> μᵢ </em>来表示<em class="lw"> Yᵢ </em>的平均值。注释:在等式1.2中，<em class="lw"> yᵢ </em>也可以简单地写成<em class="lw"> y </em>，就像等式1.1中一样。我们只需要记住一个<em class="lw"> yᵢ </em>或者<em class="lw"> y </em>代表一次观察的结果。</p><p id="4fa7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.<strong class="lb iu">线性预测器</strong>，其具有普通线性模型的常见形式</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/10b90cd0ebb6d34a39216b51880535b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*1KgzynjyaeGKohhRdSmT0g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式1.3线性预测值</p></figure><p id="24ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将用这个来预测Yᵢ.的<strong class="lb iu">均值</strong>注意，在等式1.1中，<em class="lw"> ηᵢ </em>不是线性预测器，而是<em class="lw"> θᵢ </em>的变换函数。在本文中，我们将只使用<strong class="lb iu">等式1.2 </strong>中给出的形式。</p><p id="c144" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.一个<strong class="lb iu">链接函数</strong> g(∙)，将yᵢ(e(yᵢ)的平均值转换成等式[linear]中的线性形式，这意味着</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/29b3a93f1b95ac30bb8069f8224ba40a.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*QffBoEF3MTGh4eekfYcIrg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式1.4链接功能</p></figure><p id="3dee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要求链接的函数是光滑可逆的(可逆表示函数是单调的)。</p><h1 id="934c" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">指数家庭为什么好？</h1><p id="7ca2" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">指数族有许多好的性质。</p><p id="525c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.在多种来源中(<a class="ae ky" href="https://www.quora.com/Why-are-exponential-families-so-awesome" rel="noopener ugc nofollow" target="_blank">为什么指数家庭如此令人敬畏？</a>、<a class="ae ky" href="https://stats.stackexchange.com/questions/411893/advantages-of-the-exponential-family-why-should-we-study-it-and-use-it" rel="noopener ugc nofollow" target="_blank">指数族的优点</a>、<a class="ae ky" href="https://en.wikipedia.org/wiki/Exponential_family" rel="noopener ugc nofollow" target="_blank"> Wiki:指数族</a>，提到指数族在贝叶斯统计中非常可行，因为那些分布总是有<a class="ae ky" rel="noopener" target="_blank" href="/bayesian-method-1-1cbdb1e6b4">共轭先验</a>。</p><p id="e161" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.另一个非常重要的性质是，在等式1.1中，<em class="lw">tᵢ(x</em>是<strong class="lb iu">充分统计量</strong>。简单来说，一个充分的统计量就是一个包含变量x关于未知参数的所有信息的函数，在这里是<strong class="lb iu"> <em class="lw"> θ </em> </strong>。这里的“充分”与逻辑学中“充分条件”中的“充分”含义相同。</p><p id="27d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更正式地说，一个统计量<em class="lw"> T(X₁、…、Xₙ) </em>被说成足以求<strong class="lb iu"> <em class="lw"> θ </em> </strong>，如果条件分布<em class="lw"> X₁、…、Xₙ </em>，给定<em class="lw"> T=t </em>，不依赖于<strong class="lb iu"><em class="lw"/></strong><em class="lw"/>求<strong class="lb iu"> </strong>的任何值</p><p id="9cb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.除了上述两个属性，指数族还将多个不同的分布结合在一起。这允许我们将多个不同的分布放到一个模式中。在这里，我们将展示使用<em class="lw"> a </em>、<em class="lw"> b </em>和<em class="lw"> φ </em>可以获得指数族分布的均值和方差的一般表达式。</p><p id="9490" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用最大似然来实现这一点:<strong class="lb iu">当似然函数被优化时，我们想要<em class="lw"> E[Y] </em>。</strong>首先，我们计算指数族分布的一般形式的对数似然(等式1.2)(当然，如果对数似然被优化，则似然也被优化)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b7a6a44bdfbfdc17b01a39d26028518c.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*AwDjTZL4ogI0q5hWJWFHqg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式2.1</p></figure><p id="cf9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们取它关于<em class="lw"> θ </em>的偏导数。注意零件<em class="lw"> c(y，ϕ) </em>不包含<em class="lw"> θ </em>，所以消失。我们得到了</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/ba91052d0513b4320394a654852a2ae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*pYA7EkYuOmC6-fORy_gPVQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式2.3</p></figure><p id="175d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">窍门是我们可以把<em class="lw"> l </em>作为一个随机变量，用它的期望值<em class="lw">e【y】</em>代替<em class="lw"> y </em>，让∂ <em class="lw"> l/ </em> ∂ <em class="lw"> θ </em>的期望值为<em class="lw"> 0 </em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/ebc20eb87e89e9678f2054f8bc252f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*Vp_R8RDOk46oBrnFDSuI5Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">情商。2.4</p></figure><p id="6add" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这给了我们一个非常简单的公式E(Y)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/c3d2b4ac47cde61ca3bf156ddd737211.png" data-original-src="https://miro.medium.com/v2/resize:fit:266/format:webp/1*Ji5FnSUBmccBQ_jah1qheA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式2.5</p></figure><p id="4057" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一个非常重要的事实值得一提。诀窍(将一阶导数设置为0以获得最大值)是由于指数族的对数似然函数的一个属性——它相对于<strong class="lb iu"> </strong> <em class="lw"> θ </em>是<strong class="lb iu">凹的</strong>。[3]否则，这个方法就简单的断了。(这是指数家族的又一个优点)</p><p id="6f63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们试着计算<em class="lw"> Y </em>，<em class="lw"> Var(Y) </em>的方差。取方程2.3的导数，我们得到对数似然函数的二阶导数</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/abba90569a89443ed5b2eca1ff21c064.png" data-original-src="https://miro.medium.com/v2/resize:fit:302/format:webp/1*0r-5DvtwnofgyGH_KJpt6Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式2.6</p></figure><p id="3670" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用一般的结果</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/021aeb2500901171d4cbd68847b3b849.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*zrnbe1WuZFAxVY3UciPFGA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式2.7</p></figure><p id="7173" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它显示了对数似然函数的一个特性。证明是技术性的，既不困难也不有趣。因此，在本文中，我们将省略这一点。将等式2.6代入等式2.7，我们得到</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/cae829aa056d61bccf22d552a1c133c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*KzT8D_1PLHuowJhP_wfzHA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式2.8</p></figure><p id="7002" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用我们已经得到的Y的平均值(等式2.5)，以及等式2.8的一些代数运算，我们立即得到Y的方差</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/1f4e95ae497f51c9c53128059d63e547.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*Ep1tWlBNLQly1ugtWUwdkQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式2.9</p></figure><p id="85c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lw"> a(ϕ) </em>可以是<em class="lw"> ϕ </em>的任何函数，但是为了更容易地使用GLM，我们通常让</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d52fb95e49eeb88712f2694330d7976b.png" data-original-src="https://miro.medium.com/v2/resize:fit:236/format:webp/1*YyNHCjaYgOTnAsjjtAB57A.png"/></div></figure><p id="fec4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中<em class="lw"> w </em>为已知常数。那么我们可以将等式2.9写成</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/5189b7deaf13a3c27c26640e4d006489.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*jyQdzINIvBLPzm3cqIFDUQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">情商。2.10</p></figure><h1 id="a3e9" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">属于指数族分布的一个例子</h1><p id="e421" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">GLM最简单的例子是具有身份链接功能的GLM。这将GLM简化为一个普通的线性模型。虽然很简单，但这个案例让我们了解了GLM的工作。</p><p id="087d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们知道，一个普通的线性模型假设每个观测值都有一个正态分布。既然是GLM的特例，当然正态分布属于指数族。这里我们展示了如何将正态分布转换为等式1.1的形式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9de3397e8f8e2d0aee569f050b33d2c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*Y7eUsOIjgcE7k8K3W05TDg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式3.1正态分布属于指数族</p></figure><p id="63a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，这非常简单——只需将常数移入指数部分，并扩展平方即可。等式3.1告诉我们</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/7d8f9362c0359cac030c455cf750a84f.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*ssjyMYzqK3bg39N3_4L4Ow.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式3.2</p></figure><p id="e6f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用我们在上一节中得到的结果(等式2.5和等式2.10)，我们现在可以检查正态分布的均值和方差</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/4bad468c9b91cff6beb3323722e51783.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*taMjXZ2nNB1HKuK-q3LfFQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式3.3、3.4</p></figure><h1 id="24b6" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">拟合模型</h1><p id="42c7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">为了拟合模型，我们使用似然估计。前面说过，指数函数的对数似然函数是<strong class="lb iu">凹</strong>的，所以我们可以通过寻找一阶导数为零的点来求它的最大值。我们现在在解决什么？简单回顾一下这个问题:我们有一个独立响应变量的n维向量<em class="lw"> Yᵢ </em>，其中<em class="lw">μ=e[yᵢ】</em>，它通过</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/80eb69605ccf500c3510bd1d0b2cad4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*0ufxBe5qXbNqYNlmlZBwtA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.1、4.2</p></figure><p id="83c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">而<em class="lw"> θᵢ </em>是正则参数<em class="lw">。</em>我们想要找到<em class="lw"> β </em>，它最大化了对数似然函数。再次，<em class="lw"> Yᵢ </em>是独立的，这使得<em class="lw"> β </em>的MLE成为可能。类似于等式2.1，<em class="lw"> β </em>的对数似然为</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/b553aafc6c6f1ffe91a39996b109201b.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*pIQmKK6Eg763ryajuo-sVQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.3</p></figure><p id="c200" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lw"> θᵢ </em>和<em class="lw"> β </em>的关联方式如下:<em class="lw"> θᵢ </em>与<em class="lw"> Yᵢ </em>的均值相关(这取决于具体的分布函数，在上一节的例子中，<em class="lw"> θᵢ=μᵢ </em>)，<em class="lw"> β </em>也通过link函数与<em class="lw"> Yᵢ </em>的均值相关。所以<em class="lw"> θᵢ </em>和<em class="lw"> β </em>是通过<strong class="lb iu"><em class="lw">【μᵢ</em></strong>连接起来的，这一点我们在后面的偏微分中会看到。</p><p id="e0aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们要对Eq求导。4.3关于<em class="lw"> β </em>中的每一个元素(它们将由索引<em class="lw"> j </em>下标)。这给了</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ddf7937446172506af2caa2d143da2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*RyOYxuSVXdpq_bsc1rhz8g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.5</p></figure><p id="384b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为链式法则，我们有</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/8a7f1182fa221a3ecba3285b4872211b.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*77QF_Pcs-iPwyX8q8-rihQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.6链式法则</p></figure><p id="f58d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后在微分方程2.5后，我们有</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/bed4f572ff72616591f58bf59541200f.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*4nnLJEt5YAAVouAGLE6ZwQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.7对<em class="nq"> Yᵢ </em>的平均值进行微分</p></figure><p id="2208" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们这样做是为了得到<strong class="lb iu">∂<em class="lw">θᵢ/</em>∂<em class="lw">μ</em></strong><em class="lw">ᵢ</em>因为<em class="lw"> E[Yᵢ] = μᵢ.</em>下一步确实很容易，我们将等式4.7代入等式4.5，然后</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/79f8ccdbe32ab5804b82fd1ffd331fba.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*l-IRA6iqFO52gPnYbJ4LZg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.8</p></figure><p id="624e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中红色部分来自等式4.7。方程4.8可以进一步简化。正如我们谈到的，在GLM中，<em class="lw">【var[yᵢ】</em>不是常数。因此，我们可以把<em class="lw">var[yᵢ】</em>看作<em class="lw">e[yᵢ】</em>的函数，这样我们就可以定义</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ce8bb2e8e2bce813c22a9e5ca87c7a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:278/format:webp/1*NzojrIAyk2-MGBmpkZ2mjg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.9</p></figure><p id="d7da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使得(参考等式2.10)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/7da758b057d0a2e8d0874199f1f4efb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*V_vtozfD6eISSq06a5eMPw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.10</p></figure><p id="55fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将等式4.10代入等式4.8，并将其设置为零(我们感兴趣的是对数似然函数的一阶导数为零的点)，我们得到</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/6646134a86a23bd721ca913a9ce9052b.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*_Oduaakx2NTxFKGTzDp3PA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等式4.11将等式4.8设置为0并代入。</p></figure><p id="d2eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">等式4.11给我们一个非线性方程组<em class="lw">β</em>——如果j从1到m，那么有m个这样的方程。当未知数的数量不一定等于方程的数量，并且方程可能非常复杂时，如何求解这样的非线性方程组？数值方法在这种情况下发挥作用。这里我们将应用迭代加权最小二乘法(IRLS)。在这篇文章中，我们不会深入细节。一般来说，这种方法迭代地逼近解。而当我们知道<em class="lw"> V(μᵢ) </em>独立于<em class="lw"> β </em>时，那么最小二乘目标就是</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/ae3d68dea3305a95f111392fa0009ff7.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/1*dAO-e7Qq5xzLQdZMSjtVVg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Eq 4.12的目标</p></figure><p id="bdb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，从现在开始的问题就是找到使Eq 4.12最小化的<em class="lw"> β </em>。这样，我们得到了方程4.11的最佳解。</p><h1 id="af9d" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">GLM在房价预测中的应用</h1><p id="75c8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">数据集“房价”来自Kaggle上的一个预测竞赛。整个分析的代码可从以下网址获得</p><div class="nw nx gp gr ny nz"><a href="https://github.com/ZhangXichu/House-Price/blob/main/glm.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">房价/glm . ipynb at main zhangxi Chu/房价</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">用GLM模型预测房价。在GitHub上创建一个帐户，为张喜初/房价发展做贡献。</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div><p id="ce99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用均方根偏差(RMSD)评估结果。GLM方法给出了最高33%的位置。当然，这不是最理想的方法——排行榜上有0个错误的结果。但它在实践中很好地展示了GLM。</p><p id="09db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我要说的是，关于实现没有太多要谈的，因为为什么要做每一步，在笔记本上都有解释。大部分代码是数据探索、预处理、模型比较和模型诊断。建模部分归结为一行(当然，不要忘记<code class="fe oo op oq or b"><strong class="lb iu">import</strong> statsmodels.api <strong class="lb iu">as</strong> sm</code>):</p><pre class="kj kk kl km gt os or ot ou aw ov bi"><span id="cc79" class="ow ly it or b gy ox oy l oz pa">model_full <strong class="or iu">=</strong> sm<strong class="or iu">.</strong>formula<strong class="or iu">.</strong>glm(formula<strong class="or iu">=</strong>formula, family<strong class="or iu">=</strong>sm<strong class="or iu">.</strong>families<strong class="or iu">.</strong>Gamma(link<strong class="or iu">=</strong>sm<strong class="or iu">.</strong>genmod<strong class="or iu">.</strong>families<strong class="or iu">.</strong>links<strong class="or iu">.</strong>log()), data<strong class="or iu">=</strong>train)<strong class="or iu">.</strong>fit()</span></pre><p id="cf56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其利用对数链接函数将数据拟合到广义伽马分布。</p><h1 id="6ece" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">摘要</h1><p id="6426" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">这篇文章主要是关于广义线性模型(GLM)的定义，何时使用它，以及如何拟合该模型。许多文本都是关于指数族的，因为它是GLM的基础，了解指数族的性质有助于我们理解为什么模型拟合变得最小化等式4.12。(解决这个问题的细节被省略了，因为它值得一整篇文章的决定。)</p><p id="e616" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，这些都不是程序运行所必需的，正如我们在上一节提到的，建模只是一行代码。我们需要从零开始实施GLM，这几乎不可能发生。然而，了解理论总是有助于决定选择哪个模型，以及诊断和解释模型。</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><p id="9d78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">参考文献</strong>:</p><p id="6a53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[1]赫尔曼·罗德里格斯。<a class="ae ky" href="https://data.princeton.edu/wws509/notes/a2.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="lw">广义线性模型理论</em> </a>。于2022年2月17日访问。</p><p id="026a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]斯蒂芬·贝茨，安迪·曹。<a class="ae ky" href="https://web.stanford.edu/~lmackey/stats300a/doc/stats300a-fall15-lecture2.pdf" rel="noopener ugc nofollow" target="_blank">指数族</a>。于2022年2月18日访问。</p><p id="97ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3]肯普索恩博士，<a class="ae ky" href="https://ocw.mit.edu/courses/mathematics/18-655-mathematical-statistics-spring-2016/lecture-notes/MIT18_655S16_LecNote10.pdf" rel="noopener ugc nofollow" target="_blank">评估方法II </a>。于2022年2月23日访问。</p><p id="3cbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[4]哈斯蒂，T. J .，&amp;蒂布拉尼，R. J. (2017年)。<a class="ae ky" href="https://www.taylorfrancis.com/books/mono/10.1201/9780203753781/generalized-additive-models-hastie-tibshirani" rel="noopener ugc nofollow" target="_blank"> <em class="lw">广义可加模型</em> </a>。劳特利奇。</p><p id="492a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[5]大学习团队(2021)，<a class="ae ky" href="https://www.mygreatlearning.com/blog/generalized-linear-models/" rel="noopener ugc nofollow" target="_blank"> <em class="lw">广义线性模型|什么意思？</em> </a>。于2022年4月7日访问。</p></div></div>    
</body>
</html>