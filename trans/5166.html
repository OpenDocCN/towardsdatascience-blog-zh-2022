<html>
<head>
<title>End-to-End Guide to Building a Credit Scorecard Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习构建信用记分卡的端到端指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/end-to-end-guide-to-building-a-credit-scorecard-using-machine-learning-6502d8bb765a#2022-11-18">https://towardsdatascience.com/end-to-end-guide-to-building-a-credit-scorecard-using-machine-learning-6502d8bb765a#2022-11-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="11ab" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">现实世界问题的开源工具系列</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eddea0d33f84a9f4afab1bc42e438b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o9bG1X-Vz1Nyhh6YRuZB9Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://unsplash.com/@ibrahimboran" rel="noopener ugc nofollow" target="_blank"> ibrahimboran </a>在<a class="ae ky" href="https://unsplash.com/photos/bnW9O5ZOys4" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="bbd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我正在开辟一个名为<strong class="lb iu">的新系列，为现实世界的问题提供开源工具。</strong></p><p id="adb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个系列中，我将首先回顾一个开源工具，然后展示如何将它应用于现实世界的问题。在这个过程中，我会展示所有的编码，列出所有你需要知道的术语、定理、算法。</p><p id="a6b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">潜在受众:</p><ul class=""><li id="bf5a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">想要在简历中加入一个完整的项目，并试图获得更多面试机会的学生</li><li id="323a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">数据科学家/ML 工程师</strong>希望构建记分卡并投入生产</li></ul><p id="a0da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇博客中，你将了解到:</p><ul class=""><li id="06ea" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">通过 Python 使用<strong class="lb iu">机器学习</strong>构建<strong class="lb iu">记分卡</strong></li><li id="b5e7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">技能组合:<strong class="lb iu">逻辑回归</strong>，<strong class="lb iu">梯度推进</strong>，<strong class="lb iu">证据权重</strong>，<strong class="lb iu">信息值(IV) </strong>，<strong class="lb iu">宁滨</strong>，<strong class="lb iu">卡方宁滨</strong></li></ul><p id="213e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建信用记分卡是一个非常典型的行业级问题，比如</p><ol class=""><li id="63f3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mj mb mc md bi translated">评估<strong class="lb iu">交易</strong>或<strong class="lb iu">客户的信誉</strong>以执行进一步的行动，例如<strong class="lb iu">发行信用卡</strong>或<strong class="lb iu">为信用卡公司的<strong class="lb iu">高信用客户</strong>提供余额转账优惠</strong>，</li><li id="75b4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated"><strong class="lb iu">在电子商务平台给予<strong class="lb iu">高价值客户</strong>促销或额外权利</strong>，</li><li id="e3bc" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated">提供<strong class="lb iu">良好的客户细分</strong>以接触到营销公司中的<strong class="lb iu">合适的人</strong>。</li></ol><p id="3f82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你需要建立一个系统<strong class="lb iu">给客户</strong>打分，还得跟<strong class="lb iu">非技术人员</strong>交代清楚，因为出了问题(虚惊一场)你就知道怎么跟经理/客户/业务方交代了。</p><h1 id="9768" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">简介:</h1><p id="db72" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">这个博客的代码和数据可以在这里找到:</p><div class="nh ni gp gr nj nk"><a href="https://github.com/BruceYanghy/End-to-End-Guide-to-Building-a-Credit-Scorecard-Using-Machine-Learning" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">GitHub-BruceYanghy/端到端-使用机器学习构建信用记分卡指南…</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">github.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ks nk"/></div></div></a></div><p id="2803" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">开源工具:</strong> <a class="ae ky" href="https://github.com/amphibian-dev/toad" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Toad </strong> </a></p><p id="a199" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Toad 是一个用于构建记分卡的生产即用库；它提供 EDA、特征工程和记分卡生成。其关键功能简化了最关键、最耗时的流程，如功能选择和精细宁滨。</p><p id="f2af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据集:信用卡客户数据集的默认值</strong></p><p id="4030" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">描述可以在<a class="ae ky" href="https://www.kaggle.com/datasets/uciml/default-of-credit-card-clients-dataset" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">卡格尔</strong> </a>上找到。原始数据集可以在<a class="ae ky" href="https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients" rel="noopener ugc nofollow" target="_blank"> UCI </a>找到。</p><p id="09d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有 25 个变量:</p><ul class=""><li id="588d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu"> ID </strong>:客户 ID</li><li id="1760" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> 23 个特征包括</strong>:限额余额、性别、学历、婚姻、年龄、还款、账单金额、上一次还款金额</li><li id="ec7b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">标签</strong>:默认付款(1 =是，0 =否)</li></ul><p id="3a72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">假设</strong>你是<strong class="lb iu">一家信用卡公司的数据科学家</strong>，为了促进信用卡的使用，你的经理告诉你<strong class="lb iu">为现有客户建立一个记分卡系统，向他们发送一些余额转移优惠</strong>。比方说 6 个月，年利率为 0%，费用为 3%。</p><p id="ee38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有这些客户的历史数据。你不想给那些经常违约的人寄钱，因为他们可能会拿了钱就跑了。6 个月后，贵公司将无法收回这些转账余额，这将成为贵公司的损失。你可能还需要雇佣一个讨债公司来讨回这些债务。这可不好。</p><p id="46a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以一切都取决于你的记分卡系统！</p><p id="798e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧。</p><h1 id="c8db" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">1.数据预处理</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/c608f3c818a7b347c2fab796b7f85b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nX-2IalHlX2VFi2-aiznMQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@gtomassetti" rel="noopener ugc nofollow" target="_blank"> gtomassetti </a>在<a class="ae ky" href="https://unsplash.com/photos/QCbZ4ASLhM8" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的图像</p></figure><p id="5f47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在现实生活中，您可能需要使用类似 SQL 的查询从您公司的数据库中获取原始数据；这可能会花你很多时间。</p><p id="172f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇博客中，我们将只使用 CSV 文件。</p><h2 id="9542" class="oa ml it bd mm ob oc dn mq od oe dp mu li of og mw lm oh oi my lq oj ok na ol bi translated">安装和导入软件包</h2><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="0df4" class="or ml it on b be os ot l ou ov">import pkg_resources<br/>import pip<br/>installedPackages = {pkg.key for pkg in pkg_resources.working_set}<br/>required = { 'pandas','numpy', 'matplotlib', 'seaborn','toad','pickle','sklearn'}<br/>missing = required - installedPackages<br/>if missing:<br/>    !pip install pandas<br/>    !pip install numpy<br/>    !pip install matplotlib<br/>    !pip install seaborn<br/>    !pip install toad<br/>    !pip install pickle<br/>    !pip install sklearn<br/><br/>import pandas as pd<br/>from sklearn.metrics import roc_auc_score,roc_curve,auc,precision_recall_curve<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LogisticRegression <br/>from sklearn.ensemble import GradientBoostingClassifier<br/><br/>import numpy as np<br/>import glob<br/>import math<br/>import seaborn as sns <br/>import matplotlib.pyplot as plt<br/>import toad<br/>import pickle</span></pre><h2 id="26d6" class="oa ml it bd mm ob oc dn mq od oe dp mu li of og mw lm oh oi my lq oj ok na ol bi translated">加载数据并检查默认标签速率</h2><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="8dfa" class="or ml it on b be os ot l ou ov"># use pandas to load the csv file<br/>data = pd.read_csv('UCI_Credit_Card.csv')<br/># check the size of the data<br/>data.shape<br/># check few lines<br/>data.head()<br/>#use the world 'label'<br/>data['label']=data['default.payment.next.month']<br/>data=data.drop(columns=['default.payment.next.month'])<br/>#check the fraud proportion of the data<br/>target_info(data['label'])<br/># set an exclude list for the scorecard package Toad<br/>exclude_list = ['ID','label']</span></pre><p id="9867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 22%的欺诈率</strong>(违约人群)，这是历史数据中相当高的违约率。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/3a0217879fff4cba589ebbb703e26e44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*xF9OSYulZFlGSZ60IIDmfw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><h2 id="6e2e" class="oa ml it bd mm ob oc dn mq od oe dp mu li of og mw lm oh oi my lq oj ok na ol bi translated">训练和测试分割</h2><p id="cd04" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">在实际项目中，您可能希望按照日期/时间分割训练和测试，随机分割并不好，因为这会破坏时间序列，并可能导致过度拟合。</p><p id="520d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用用户 ID 作为进行拆分的时间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/5a146255720ffaf406ea01202d62f36e.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*YSwNq3Tuv2SgnZ0Ocixxqg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="4170" class="or ml it on b be os ot l ou ov"># use the ID column to split the train-test data<br/>data.ID.describe()<br/>train = data_split(data,start = 0, end=22500,date_col='ID')<br/>test = data_split(data,start = 22500, end=172792,date_col='ID')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c6571b97eb3281a21219ea14c2f1c46e.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*2ByES75P9UPZlrgVRrrV6g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><h1 id="ce3b" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">2.特征过滤</h1><p id="15ed" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">首先，我们需要执行特征过滤，以去除具有低信息价值和高相关性的特征。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="17a8" class="or ml it on b be os ot l ou ov">###feature filtering by missing value, IV &amp; corrrelation：<br/>##If the missing value rate is greater than the threshold, delete the feature<br/>##If the correlation coefficient is greater than the threshold, delete the feature<br/>##If the IV is smaller than the threshold, delete the features<br/><br/>train_selected, drop_lst= toad.selection.select(frame = train,<br/>                                                target=train['label'], <br/>                                                empty = 0.7, <br/>                                                iv = 0.02, corr = 1, <br/>                                                return_drop=True, <br/>                                                exclude=exclude_list)<br/>print("keep:",train_selected.shape[1],<br/>      "drop empty:",len(drop_lst['empty']),<br/>      "drop iv:",len(drop_lst['iv']),<br/>      "drop corr:",len(drop_lst['corr']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/03db1f1250d820a9b4c8a53e3c57bd5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*0NbOEUv9-JcmmtSvjF01mg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="388e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们将总共保留 23 个特征，并删除 2 个特征<strong class="lb iu">[‘性’，‘婚姻’]</strong>，因为它们具有<strong class="lb iu">低 IV </strong>。</p><ul class=""><li id="c92c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">证据权重(WOE) </strong> —描述预测变量和二元目标变量之间的<strong class="lb iu">关系</strong></li><li id="cbd2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">信息值(IV) </strong> —基于 WOE 衡量关系的强度。行业水平是丢弃 IV 低于 0.02 的<strong class="lb iu">特性</strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/5d884875032688ed191530f7a633c017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HZjOucFC-iq-vyh8.png"/></div></div></figure><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="3500" class="or ml it on b be os ot l ou ov"># output the iv table to a dataframe<br/>def output_iv_importance(train_selected,label_col):<br/>    feat_import_iv = toad.quality(train_selected,label_col,iv_only=True)<br/>    feat_import_iv=feat_import_iv['iv']<br/>    feat_import_iv = feat_import_iv.reset_index()<br/>    feat_import_iv.columns = ['name','iv']<br/>    return feat_import_iv<br/><br/>df_iv=output_iv_importance(train_selected,'label')<br/>df_iv.head(30)</span></pre><p id="e495" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是所有特性的 IV 排名。我们可以看到<strong class="lb iu"> PAY_0 </strong>的 IV 最高，这是有意义的，因为这个<strong class="lb iu">特征表示最近的还款状态</strong>。与支付状态和金额相比，教育和年龄的 IV 较低。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/6e8730aff69ca5b818c1c51947c346f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*wV2-6u8ubYNI7OSp9SeALA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><h1 id="fe2d" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">3.特色宁滨</h1><p id="482c" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">特征宁滨是将连续变量或数值变量转化为分类特征。</p><p id="9440" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">特色宁滨的优势</strong>:</p><ol class=""><li id="39c3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mj mb mc md bi translated">它<strong class="lb iu">简化了</strong>逻辑回归模型，而<strong class="lb iu">降低了模型过度拟合的风险</strong></li><li id="fdb2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated">Logistic 回归是一个<strong class="lb iu">广义线性模型</strong>，表达能力有限；特征宁滨可以将<strong class="lb iu">非线性</strong>引入到模型中，可以提高模型的表达能力，有助于更好的模型拟合</li><li id="5620" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated"><strong class="lb iu">离散化特征</strong>对<strong class="lb iu">异常数据</strong>非常<strong class="lb iu">鲁棒</strong>:比如年龄&gt; 30 时<strong class="lb iu"> a 特征的值为 1，否则为 0</strong>。如果特征没有被离散化，异常数据点“300 岁”将影响模型拟合</li><li id="2740" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated">它可以将空数据视为一个单独的类<strong class="lb iu"/></li></ol><h2 id="7936" class="oa ml it bd mm ob oc dn mq od oe dp mu li of og mw lm oh oi my lq oj ok na ol bi translated"><strong class="ak">功能宁滨的步骤:</strong></h2><p id="7cb2" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated"><strong class="lb iu">第一步</strong>。初始化:c = toad.transform.Combiner()</p><p id="17c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第二步。</strong>训练宁滨:</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="0b33" class="or ml it on b be os ot l ou ov">c.fit(dataframe, <br/>      y = 'target', <br/>      method = 'chi', <br/>      min_samples = 0.05, <br/>      n_bins = None, <br/>      empty_separate = False)</span></pre><ul class=""><li id="ba5e" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu"> y </strong>:目标列</li><li id="fe3d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">方法</strong>:宁滨方法，支持<strong class="lb iu"> chi </strong>(卡方宁滨)<strong class="lb iu"> dt </strong>(决策树宁滨)<strong class="lb iu">k 均值</strong>，<strong class="lb iu">分位数</strong>，<strong class="lb iu">步长</strong>(等步长宁滨)</li><li id="5437" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> min_samples </strong>:每箱包含<strong class="lb iu">最少数量的样品</strong>，可以是<strong class="lb iu">号</strong>或<strong class="lb iu">比例</strong></li><li id="64dc" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">n _ bin</strong>:bin 的数量；如果不可能划分这么多箱子，则将划分最大数量的箱子。</li><li id="192a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">空 _ 分开</strong>:是否分开<strong class="lb iu">空箱</strong></li></ul><p id="b340" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第三步</strong>。<strong class="lb iu">检查宁滨节点</strong> : <strong class="lb iu"> c.export() </strong></p><p id="7557" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第四步</strong>。<strong class="lb iu">手动调节宁滨</strong> : <strong class="lb iu"> c.load(dict) </strong></p><p id="733c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第五步</strong>。<strong class="lb iu">应用宁滨结果</strong>:<strong class="lb iu">c . transform(data frame，labels=False) </strong></p><ul class=""><li id="2fa0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">标签</strong>:是否将宁滨结果转换成盒子标签。如果<strong class="lb iu">假</strong>，输出<strong class="lb iu"> 0，1，2 </strong> …(离散变量按比例排序)，如果<strong class="lb iu">真</strong>输出<strong class="lb iu"> (-inf，0】，(0，10)，【10，INF】</strong>。</li></ul><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="b9e9" class="or ml it on b be os ot l ou ov">import time<br/>start = time.time()<br/>combiner = toad.transform.Combiner()<br/># use the filtered features for training<br/># Use the stable chi-square binning, <br/># specifying that each bin has at least 5% data to ensure stability<br/># empty values ​​will be automatically assigned to the best bin<br/>combiner.fit(X=train_selected,<br/>             y=train_selected['label'],<br/>             method='chi',<br/>             min_samples = 0.05,<br/>             exclude=exclude_list)<br/>end = time.time()<br/>print((end-start)/60)<br/><br/>#output binning<br/>bins = combiner.export()</span></pre><p id="e2b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">宁滨结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/518d01526bb2c1796fd84975ab505ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9FH1ft-OH2OKMUEhGoWFQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="acc1" class="or ml it on b be os ot l ou ov">#apply binning<br/>train_selected_bin = combiner.transform(train_selected)<br/>test_bin = combiner.transform(test[train_selected_bin.columns])<br/><br/>#Fine tune bins<br/>from toad.plot import  bin_plot,badrate_plot<br/>bin_plot(train_selected_bin,x='PAY_AMT1',target='label')<br/>bin_plot(test_bin,x='PAY_AMT1',target='label')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/ac43a7819feb73c95395c140c888e620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYxQpnD8aANObTYRIOeY5g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="ee3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在该图中，<strong class="lb iu">柱状图</strong>代表相应 bin 中数据的<strong class="lb iu">比例；<strong class="lb iu">红线</strong>代表<strong class="lb iu">违约客户比例</strong>。</strong></p><p id="6049" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要确保宁滨具有<strong class="lb iu">单调性</strong>，这意味着<strong class="lb iu">线与<strong class="lb iu">没有突然跳跃或下降</strong>的</strong>趋势相同。</p><p id="ea28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个剧情看起来还行，如果有突然的跳跃或者下降，我们需要用<strong class="lb iu"> c.set_rules(dict) </strong>结合宁滨。</p><p id="83e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">比如说。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="1422" class="or ml it on b be os ot l ou ov">#setting rules<br/>rule = {'PAY_AMT1':[['0', 'nan'],['1'], ['2'], ['3']]}<br/><br/>#Adjust binning<br/>c.set_rules(rule)</span></pre><h1 id="ad20" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">4.转换为 WOE 并计算 PSI</h1><p id="91ab" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">WOE 转换在宁滨完成后执行。</p><p id="9c37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤如下:</p><ol class=""><li id="3d4c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mj mb mc md bi translated">使用上面调整的<strong class="lb iu">组合器 c </strong>转换数据</li><li id="a57e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated"><strong class="lb iu">初始化 woe 转换</strong>t:<strong class="lb iu">t = toad . transform . woe transformer()</strong></li><li id="e035" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated"><strong class="lb iu">训练</strong>t:<strong class="lb iu">t . fit _ transform</strong>训练并输出车列的 woe 转换数据</li><li id="a4d4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated"><strong class="lb iu">目标</strong>:目标列数据(非列名)</li><li id="4a7a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated"><strong class="lb iu">排除</strong>:不需要进行 WOE 变换的列。注意:所有列都将被转换，包括没有被宁滨的列，不需要被 WOE 转换的列将通过 exclude 删除，尤其是目标列。</li><li id="c001" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mj mb mc md bi translated"><strong class="lb iu">转换测试/OOT 数据</strong>:transfer . Transform</li></ol><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="0ce0" class="or ml it on b be os ot l ou ov">##transform to WOE<br/>t=toad.transform.WOETransformer()<br/>#transform training set<br/>train_woe = t.fit_transform(X=train_selected_bin,<br/>                            y=train_selected_bin['label'], <br/>                            exclude=exclude_list)<br/>#transform testing set<br/>test_woe = t.transform(test_bin)<br/><br/>final_data_woe = pd.concat([train_woe,test_woe])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/c463e25460ec6eb6fc68d4726abd49b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j-XUtUsIGRnIfDuLhiZLgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><h2 id="a0b1" class="oa ml it bd mm ob oc dn mq od oe dp mu li of og mw lm oh oi my lq oj ok na ol bi translated">计算 PSI</h2><p id="8e0f" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">PSI(种群稳定性指数)反映了分布的<strong class="lb iu">稳定性。我们经常用它来筛选特征和<strong class="lb iu">评估模型稳定性</strong>。行业水平是丢弃 PSI 大于<strong class="lb iu"> 0.2 </strong>的特性</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/b6c503151ce2f9badf13adc2be76a8fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/0*ggZut3YA6mm4HbHw.png"/></div></figure><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="e544" class="or ml it on b be os ot l ou ov">#get the feature name<br/>features_list = [feat for feat in train_woe.columns if feat not in exclude_list]<br/>#calculate PSI using toad<br/>psi_df = toad.metrics.PSI(train_woe[features_list], test_woe[features_list]).sort_values(0)<br/>#put into a dataframe<br/>psi_df = psi_df.reset_index()<br/>psi_df = psi_df.rename(columns = {'index' : 'feature',0:'psi'})<br/><br/># features less than 0.25<br/>psi005 = list(psi_df[psi_df.psi&lt;0.25].feature)<br/># features geater than 0.25<br/>psi_remove = list(psi_df[psi_df.psi&gt;=0.25].feature)<br/><br/># keep exclude list<br/>for i in exclude_list:<br/>    if i in psi005:<br/>        pass<br/>    else:<br/>       psi005.append(i) <br/># remove features that are geater than 0.25<br/>train_selected_woe_psi = train_woe[psi005]<br/>off_woe_psi = test_woe[psi005]<br/><br/># output our final data table<br/>final_data_woe = pd.concat([train_selected_woe_psi,off_woe_psi])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/0bb8c36fe5f2eb3b84048dcba8f8a0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*iINrNfJFIt_LQ5QZ5XibgA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><h1 id="05c6" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">5.最终输出 IV</h1><p id="bedf" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">这一步是在<strong class="lb iu"> WOE 变换</strong>之后输出 IV，它与原始特征的 IV 有一点不同。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="fcdd" class="or ml it on b be os ot l ou ov"># output the IV<br/>features_use = [feat for feat in final_data_woe.columns if feat not in exclude_list]<br/>len(features_use)<br/><br/>df_iv=output_iv_importance(final_data_woe[features_use+['label']],'label')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/5fbd2d2bc00883233489da54bc5878b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*cG28wldraYpHDDQJU4CI_A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="e05a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想法是获得具有最高 IV<strong class="lb iu">和最低 PSI </strong>的特征。</p><h1 id="a991" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">6.模型调整</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/407363663dbe1f188dd99ddb58cb70e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W93bKVDeFPuL793doDZlZQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图像由<a class="ae ky" href="https://unsplash.com/@tetrakiss" rel="noopener ugc nofollow" target="_blank">四吻</a>在<a class="ae ky" href="https://unsplash.com/photos/MECKPoKJYjM" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="4064" class="oa ml it bd mm ob oc dn mq od oe dp mu li of og mw lm oh oi my lq oj ok na ol bi translated">逻辑回归</h2><p id="5c5a" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">信用记分卡建模过程中最常用的算法是逻辑回归。原因如下:</p><ul class=""><li id="b181" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">简单线性关系</strong>:变量之间的关系是线性关系</li><li id="de04" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">良好的可解释性</strong>:输入变量对目标变量的影响很容易得到</li><li id="e1b4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">给出概率而不是判别类</strong>:客户的<strong class="lb iu">特征信息</strong>(如婚姻、年龄、历史信用表现等。)可以整合转换成一个<strong class="lb iu">概率值</strong>，为预测客户好坏提供一个<strong class="lb iu">直观的</strong>依据。即价值越大，客户未来违约的概率越小。</li><li id="6bc6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">易于部署</strong>:测试、部署、监控、调优等。，都比较简单</li></ul><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="b539" class="or ml it on b be os ot l ou ov">def check_train_test_auc(x_train,y_train,x_test,y_test):<br/>    from sklearn.linear_model import LogisticRegression<br/>    lr = LogisticRegression(random_state=42,C= 0.1, penalty='l2', solver='newton-cg')<br/><br/>  <br/>    lr = LogisticRegression(class_weight='balanced')<br/>    lr.fit(x_train, y_train)<br/><br/>    pred_train = lr.predict_proba(x_train)[:,1]<br/>    from toad.metrics import KS, AUC<br/><br/>    print('train KS',KS(pred_train, y_train))<br/>    print('train AUC',AUC(pred_train, y_train))<br/>    <br/>    pred_OOT =lr.predict_proba(x_test)[:,1]<br/>    print('Test KS',KS(pred_OOT, y_test))<br/>    print('Test AUC',AUC(pred_OOT, y_test))<br/>    <br/>    from sklearn.metrics import confusion_matrix, accuracy_score, roc_auc_score, plot_roc_curve, classification_report<br/><br/>    fig, ax = plt.subplots(figsize=(12, 8))<br/>    plot_roc_curve(lr, x_test, y_test, color='blue', ax=ax)<br/><br/>#train &amp; test<br/>check_train_test_auc(x_train = train_woe[features_use],y_train=train_woe['label'],<br/>                     x_test =test_woe[features_use] ,y_test = test_woe['label'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/f3544eb07e2f285ac50f4cc537698618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rn7nHH6hg0uPIcItq4bpNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="9cc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，在训练 AUC 和测试 AUC 或训练 KS 和测试 KS 之间没有太大的差异。这意味着我们的模型不会过度拟合。</p><h2 id="539e" class="oa ml it bd mm ob oc dn mq od oe dp mu li of og mw lm oh oi my lq oj ok na ol bi translated">训练 GradientBoostingClassifier 并检查要素重要性表</h2><p id="b77e" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">查看 GBDT 模型的性能是否优于 LR，并将特征重要性表与 IV 进行比较。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="a695" class="or ml it on b be os ot l ou ov">def get_evaluation_scores(label, predictions):<br/>    from sklearn.metrics import classification_report, confusion_matrix, accuracy_score<br/>    from sklearn.metrics import balanced_accuracy_score<br/>    tp, fn, fp, tn = confusion_matrix(label,predictions,labels=[1,0]).reshape(-1)<br/>    print('True Positive：',tp)<br/>    print('True Negative：',tn)<br/>    print('False Positive：',fp)<br/>    print('False Negative：',fn)<br/>    accuracy = (tp+tn)/(tp+fn+fp+tn)<br/>    print('accuracy: ',accuracy)<br/>    recall = tp/(tp+fn)<br/>    print('（recall）: ',recall)<br/>    precision = tp/(tp+fp)<br/>    print('（precision）: ',precision)<br/>    #f1 score = 2*(P*R)/(P+R)<br/>    f1 = 2*precision*recall/(precision+recall)<br/>    print('F1 score: ',f1)<br/>    <br/>    print(classification_report(label, predictions))<br/>    <br/>    print('balanced_accuracy_score: ',balanced_accuracy_score(label,predictions))<br/>    return precision, recall<br/><br/>def evaluate_result(df_train,df_test,features_name):<br/>    from sklearn.ensemble import AdaBoostClassifier, GradientBoostingClassifier, RandomForestClassifier, ExtraTreesClassifier<br/>    import seaborn as sns<br/>    import matplotlib.pyplot as plt<br/>    start = time.time()<br/>    x_train = df_train[features_name]<br/>    y_train = df_train['label']<br/><br/>    x_test  = df_test[features_name]<br/>    y_test  = df_test['label']<br/><br/>    model = GradientBoostingClassifier(n_estimators=250,random_state=0)<br/>    model.fit(x_train,y_train)<br/>    predictions = model.predict(x_test)<br/>    get_evaluation_scores(label = y_test, predictions=predictions)<br/>    feat_importances = pd.Series(model.feature_importances_, index=features_name)<br/>    feat_importances=pd.DataFrame(feat_importances).reset_index()<br/>    feat_importances.columns=['feature_name','feature_importance']<br/>    feat_importances=feat_importances.sort_values(['feature_importance'],ascending=False)<br/>    import matplotlib.pyplot as plt<br/>    plt.figure(figsize=(15,15))<br/><br/>    sns_plot1=sns.barplot(feat_importances.feature_importance,feat_importances.feature_name,estimator=sum)<br/>    plt.title("Features Importance",size=18)<br/>    plt.ylabel('', size = 15)<br/>    plt.tick_params(labelsize=18)<br/>    return feat_importances,model,x_train,y_train,x_test,y_test<br/><br/>fet_importance_GBDT_reason,model,x_train,y_train,x_test,y_test = evaluate_result(df_train=train_woe,<br/>                df_test=test_woe,<br/>                features_name=features_use)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/a51f76c9c69457125d8026f4a65ab5f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*uyd8gE3YitkqJghQT5TwTA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">AI4Finance-Foundation 版权所有</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/274124213fcdb022be049de358ea0e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDpX263aGJPchepxkoWc7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="a88a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从功能重要性表中我们可以看出，GBDT 非常重视 PAY_0 功能(64%)。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="20a3" class="or ml it on b be os ot l ou ov">def plot_roc_pre_recall_curve(labels, probs):<br/>    from sklearn.metrics import precision_recall_curve<br/>    # Get ROC curve FPR and TPR from true labels vs score values<br/>    fpr, tpr, _ = roc_curve(labels, probs)<br/><br/>    # Calculate ROC Area Under the Curve (AUC) from FPR and TPR data points<br/>    roc_auc = auc(fpr, tpr)<br/><br/>    # Calculate precision and recall from true labels vs score values<br/>    precision, recall, _ = precision_recall_curve(labels, probs)<br/><br/>    plt.figure(figsize=(8, 3))<br/><br/>    plt.subplot(1,2,1)<br/>    lw = 2<br/>    plt.plot(fpr, tpr, color='darkorange', lw=lw, label='ROC curve (area = %0.4f)' % roc_auc)<br/>    plt.plot([0, 1], [0, 1], color='navy', lw=lw, linestyle='--')<br/>    plt.xlim([0.0, 1.0])<br/>    plt.ylim([0.0, 1.05])<br/>    plt.xlabel('False Positive Rate')<br/>    plt.ylabel('True Positive Rate')<br/>    plt.title('ROC Curve')<br/>    plt.legend(loc="lower right")<br/>    plt.grid(True)<br/><br/>    plt.subplot(1,2,2)<br/>    plt.step(recall, precision, color='orange', where='post')<br/>    # plt.fill_between(recall, precision, step='post', alpha=0.5, color='orange')<br/>    plt.xlabel('Recall')<br/>    plt.ylabel('Precision')<br/>    plt.ylim([0.0, 1.05])<br/>    plt.xlim([0.0, 1.0])<br/>    plt.title('Precision Recall Curve')<br/>    plt.grid(True)<br/><br/>    left  = 0.125  # the left side of the subplots of the figure<br/>    right = 0.9    # the right side of the subplots of the figure<br/>    bottom = 0.1   # the bottom of the subplots of the figure <br/>    top = 0.9      # the top of the subplots of the figure<br/>    wspace = 0.5   # the amount of width reserved for blank space between subplots<br/>    hspace = 0.2   # the amount of height reserved for white space between subplots<br/>    plt.subplots_adjust(left, bottom, right, top, wspace, hspace)<br/>    plt.show()<br/><br/>probs = model.predict_proba(x_test)[:,1]<br/>sns.set(font_scale = 1)<br/>plot_roc_pre_recall_curve(y_test, probs)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/ab107eba76fae0632617ce99a2ec09c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6fIkwckKo9W2bQ82g_GNfw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="de1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ROC 和精确回忆曲线看起来不错。</p><h1 id="acfc" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">7.模型生产</h1><p id="12aa" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">让我们为逻辑回归训练我们的生产模型</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="7274" class="or ml it on b be os ot l ou ov">#prepare train &amp; test data<br/>x_train = train_woe[features_use]<br/>y_train=train_woe['label']<br/>x_test =test_woe[features_use] <br/>y_test = test_woe['label']<br/><br/>#Train LR<br/>#lr = LogisticRegression(random_state=42,C= 0.1, penalty='l2', solver='newton-cg')<br/>lr = LogisticRegression(class_weight = 'balanced')<br/>lr.fit(x_train, y_train)<br/><br/>#check AUC<br/>probs = lr.predict_proba(x_test)[:,1]<br/>sns.set(font_scale = 1)<br/>plot_roc_pre_recall_curve(y_test, probs)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/e46241b217f58baf5d82a83aabd0ed81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRXI1HZWa54gEnTWyRsWcg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="1ef2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">LR 的 AUC:0.7835</p><p id="a739" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GBDT 的 AUC:0.7892</p><p id="3e42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些模型之间没有太大的区别。所以用 LR 建立记分卡是可以的。</p><h1 id="f31f" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">8.记分卡调整</h1><p id="ad83" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">以下参数是记分卡优化中最重要的参数。</p><ul class=""><li id="890d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu"> base_score </strong> = 1000，<strong class="lb iu"> base_odds </strong> = 35，<strong class="lb iu"> pdo </strong> = 80，<strong class="lb iu">比率</strong> = 2</li></ul><p id="6466" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实际意思是，当基础赔率为<strong class="lb iu"> 35 </strong>时，<strong class="lb iu">基准分为 1000 </strong>，当<strong class="lb iu">比基准</strong>高一倍时，基准分下降 80 分。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="6035" class="or ml it on b be os ot l ou ov"># scorecard tuning<br/>card = toad.ScoreCard(<br/>    combiner = combiner,<br/>    transer = t,<br/>    class_weight = 'balanced',<br/>    C=0.1,<br/>    base_score = 1000,<br/>    base_odds = 35 ,<br/>    pdo = 80,<br/>    rate = 2<br/>)<br/><br/>card.fit(train_woe[features_use], train_woe['label'])<br/><br/>#inference on test data<br/>test['CreditScore'] = card.predict(test)<br/>test['CreditScore'].describe()<br/><br/>#output the scorecard<br/>final_card_score=card.export()<br/>len(final_card_score)<br/><br/>#transform the scorecard into dataframe and save to csv<br/>keys = list(card.export().keys())<br/>score_card_df = pd.DataFrame()<br/>for n in keys:<br/>    temp = pd.DataFrame.from_dict(final_card_score[n], orient='index')<br/>    temp = temp.reset_index()<br/>    temp.columns= ['binning','score']<br/>    temp['variable'] = n<br/>    temp = temp[['variable','binning','score']]<br/>    score_card_df=score_card_df.append(temp)<br/>score_card_df.head(30)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/fff0d1991acc5aab33a36e5b0d259359.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*nipVma2CErDgr5ODDZovAw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="eed0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们的记分卡。一旦我们得到这个表，我们就可以把这个 CSV 文件扔给<strong class="lb iu">开发者</strong>，让他们开发一个服务来给每个客户打分。</p><p id="e5c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我们还需要做更多的事情；对于一个典型的记分卡，我们需要有一个分数范围，每个范围代表一个信任级别。</p><p id="4ae5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，业务方人员更容易针对不同级别的客户采取行动<strong class="lb iu">。</strong></p><p id="5bbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以这样设置<strong class="lb iu">信用等级</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/21a88d97fda289d289eee26ce31c740c.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*9v5iJBMAkcOKfsogZM0lYQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><h1 id="29a2" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">9.分布分析</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/ff4e2bb196093622da704373cfbf674d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtJeCka-IbI3z1HfoX8scg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://unsplash.com/@lukechesser" rel="noopener ugc nofollow" target="_blank">卢克·切斯</a>在<a class="ae ky" href="https://unsplash.com/photos/JKUTrJ4vK00" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="a4a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要绘制违约客户与优质客户的<strong class="lb iu">分数分布</strong>，以便划分<strong class="lb iu">信用等级</strong>(0 级到 8 级)。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="1c61" class="or ml it on b be os ot l ou ov">plt.figure(figsize=(12,10))<br/>import random<br/>import numpy<br/>from matplotlib import pyplot as plt<br/><br/>w = 40<br/>n = math.ceil((data['CreditScore'].max() - data['CreditScore'].min())/w)<br/>#bins = numpy.linspace(-10, 10, 100)<br/><br/>plt.hist(data[data.label==1].CreditScore, alpha=0.5, label='Black',bins = n)<br/>plt.hist(data[data.label==0].CreditScore, alpha=0.5, label='White',bins = n)<br/>plt.legend(loc='upper left')<br/>plt.title('Credit Score Distribution: Test Set',size=15)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/96c10555568dd3c5d982a1613e14f8c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNMGnJnuwOGcsAGeyJf6vA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="3974" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">黑色</strong>表示<strong class="lb iu">默认客户</strong>，白色<strong class="lb iu">表示<strong class="lb iu">好客户</strong>。</strong></p><p id="a8da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个好的模型会清晰的分出<strong class="lb iu">黑/白分布</strong>。</p><p id="53bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最理想的分布是<strong class="lb iu">一个微笑的形状</strong></p><ul class=""><li id="a309" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">信用分数高的好客户-&gt;最右边</li><li id="fce0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">信用评分低的默认客户-&gt;最左边。</li></ul><p id="f87a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">我们当前的模型不能很好地分离这些分布</strong>。对我来说，我会回去探索<strong class="lb iu">更多的特性</strong>来增加<strong class="lb iu">的预测能力</strong>。但是我们总是可以先<strong class="lb iu">建立一个基线模型</strong>并在此基础上进行改进。</p><h1 id="e0b0" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">10.阈值调谐</h1><p id="8b28" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">我们需要针对不同的信用级别执行<strong class="lb iu">阈值调整，这是损失&amp;覆盖范围之间的权衡。</strong></p><p id="a58b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">比方说，你的老板可以承受一些损失，但你必须为下个月覆盖 70%的好客户。</p><p id="119c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，你的目标是找到一个<strong class="lb iu"> ≤10%亏损和≥70%覆盖率</strong>的阈值。</p><pre class="kj kk kl km gt om on oo bn op oq bi"><span id="fa2a" class="or ml it on b be os ot l ou ov">def get_credit_level(<br/>    test,<br/>    target_score ='order_score',<br/>    out_col = 'order_level',<br/>    left_bound = -100,<br/>    level_0 = 100,<br/>    level_1 = 200,    <br/>    level_2 = 250,    <br/>    level_3 = 300,    <br/>    level_4 = 350,    <br/>    level_5 = 400,    <br/>    level_6 = 450,<br/>    level_7 = 500,<br/>    level_8 = 800):<br/>    level = []<br/>    for i in range(len(test)):<br/>        if (test[target_score][i]&gt;left_bound) &amp; (test[target_score][i]&lt;=level_0):<br/>            level.append(0)<br/>        elif  (test[target_score][i]&gt;level_0) &amp; (test[target_score][i]&lt;=level_1):<br/>            level.append(1)<br/>        elif  (test[target_score][i]&gt;level_1) &amp; (test[target_score][i]&lt;=level_2):<br/>            level.append(2)<br/>        elif  (test[target_score][i]&gt;level_2) &amp; (test[target_score][i]&lt;=level_3):<br/>            level.append(3)<br/>        elif  (test[target_score][i]&gt;level_3) &amp; (test[target_score][i]&lt;=level_4):<br/>            level.append(4)<br/>        elif  (test[target_score][i]&gt;level_4) &amp; (test[target_score][i]&lt;=level_5):<br/>            level.append(5)<br/>        elif  (test[target_score][i]&gt;level_5) &amp; (test[target_score][i]&lt;=level_6):<br/>            level.append(6)<br/>        elif  (test[target_score][i]&gt;level_6) &amp; (test[target_score][i]&lt;=level_7):<br/>            level.append(7)<br/>        elif  (test[target_score][i]&gt;level_7 )&amp; (test[target_score][i]&lt;=level_8):<br/>            level.append(8)<br/>        <br/>    test[out_col] = level<br/>    return test<br/><br/>def plot_bts_level_loss(test, target_col):<br/>    bts_level_df = test[target_col].value_counts()<br/>    bts_level_df=pd.DataFrame(bts_level_df)<br/>    df_label_level= test[test.label==1].groupby(target_col)['label'].count()/ test.groupby(target_col)['label'].count()<br/>    df_label_level = pd.DataFrame(df_label_level)<br/>    bts_level_df.sort_index().plot.bar(title='')<br/>    df_label_level.plot()<br/><br/>test = get_credit_level(test,<br/>                       target_score ='CreditScore',<br/>                       out_col = 'CreditScore_level',<br/>                      left_bound = -1000,<br/>    level_0 = 250,<br/>    level_1 = 300,    <br/>    level_2 = 400,    <br/>    level_3 = 500,    <br/>    level_4 = 580,    <br/>    level_5 = 630,    <br/>    level_6 = 690,<br/>    level_7 = 730,<br/>    level_8 = 1000<br/>                )<br/>plot_bts_level_loss(test,target_col='CreditScore_level')<br/>def get_loss_coverage(test,target_level):<br/>    #level 5-Leve 8 Loss (percentage of default people)<br/>    L5_loss = test[test[target_level]&gt;=5 ].label.value_counts()/len(test[test[target_level]&gt;=5 ])<br/>    #level 5- level 8 Coverage (percentage of good people)<br/>    L5_coverage=test[test[target_level]&gt;=5 ].label.value_counts()[0]/test[test.label==0].shape[0]<br/>    print("Level 5-Level 8: Loss is ",L5_loss[1], "; Coverage is ",L5_coverage)<br/>    #level 6-level 8 Loss<br/>    L6_loss=test[test[target_level]&gt;=6 ].label.value_counts()/len(test[test[target_level]&gt;=6 ])<br/>    #level 6-level 8 Coverage<br/>    L6_coverage=test[test[target_level]&gt;=6].label.value_counts()[0]/test[test.label==0].shape[0]<br/>    print("Level 6-Level 8: Loss is ",L6_loss[1], "; Coverage is ",L6_coverage)<br/></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/008d5f470e73fb6c7413f63b2f7920af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*ry2rIOk098LvfmmUMF__hg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="de68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该图显示了每个<strong class="lb iu">信用等级</strong>和该等级下<strong class="lb iu">信用违约率</strong>的分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/4d6d7b4ce522f10f6898e39548d859fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpJcXwP6XHt7m1XrIPa2xQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/f8f0db3cad0ca2aae5113f4480a70bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qFs_VSkT6aqAq95LLJR9Qg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="60ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过检查每一层，你会有一个损失和保险表。例如，如果您向所有人<strong class="lb iu"> 7501 </strong> ( <strong class="lb iu"> L0-L8 </strong>)发送余额转移报价，您将遭受<strong class="lb iu"> 21%的损失率(1548/7501) </strong>。</p><p id="d97d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要达到目标(损耗≤10%，覆盖率≥70%)，需要<strong class="lb iu">挑选损耗 10.1%(347+120+34)/(2573+1570+796)，覆盖率 75%(2226+1450+762)/5953</strong>。</p><p id="437f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本上，下个月(假设测试集是下个月的数据)业务端的人会给<strong class="lb iu">6 级或以上的客户发送余额转移报价，总共 4939 个客户。</strong></p><h1 id="fd62" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">11.手动测试我们的记分卡</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/3773e987af4ff3684a22021a9fe9d136.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bdXlEv-_98hweVjLmgiaUQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@nci" rel="noopener ugc nofollow" target="_blank"> nci </a>在<a class="ae ky" href="https://unsplash.com/photos/GlZv6YgCUyM" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的图像</p></figure><p id="c5df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下个月，我们能否向客户发送包含以下信息的余额转移报价？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/64f7a494ed39842ca4d848d21d4c03ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*3mJwvN0m9sk-m5D-lmMpHA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="a4a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们手动检查记分卡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pw"><img src="../Images/6d105f5bf7ece4e457f2e1bcf427cb5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nt2IyLVyCqC-0yDJp3yU5w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="ef16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">toad 的推断:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi px"><img src="../Images/f6ff2ff03a12aa428cf0c1b8c58774a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*RCunMfOA97sGKboZtQQENg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="178d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过查看我们的信用等级表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi py"><img src="../Images/ab6738a550a583004b87f1b4465cd2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*BFbadmR5e8DixUGGd55LkA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ai4 金融教育版权所有</p></figure><p id="1a0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到这个客户是<strong class="lb iu">8 级客户，信用完美</strong>。所以我们可以给他/她一个余额转移报价。</p><h1 id="d6e9" class="mk ml it bd mm mn mo mp mq mr ms mt mu jz mv ka mw kc mx kd my kf mz kg na nb bi translated">结论:</h1><p id="0164" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">这篇博客介绍了基于开源 ML 工具<a class="ae ky" href="https://github.com/amphibian-dev/toad" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Toad </strong> </a> <strong class="lb iu">构建信用记分卡的端到端过程。</strong></p><p id="9d12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本博客讨论了以下 ML 流行语:</p><p id="4588" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">信息值(IV)、证据权重(WOE)、群体稳定性指数(PSI)、AUC(ROC 曲线下面积)、KS (Kolmogorov-Smirnov)、Logistic 回归(LR)、GBDT(梯度推进决策树)</strong></p><p id="85f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于未来的工作，作为一名数据科学家，您可以尝试使用其他 ML 模型来构建记分卡，如深度神经网络，以进一步提高准确性并降低假阳性率，从而提高客户满意度。</p><p id="1b3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢了。</p><p id="762b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="pz">来自《走向数据科学》编辑的注释:</em> </strong> <em class="pz">虽然我们允许独立作者根据我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="pz">规则和指导方针</em> </a> <em class="pz">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="pz">读者术语</em> </a> <em class="pz">。</em></p></div></div>    
</body>
</html>