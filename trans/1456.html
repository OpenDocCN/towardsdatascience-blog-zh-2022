<html>
<head>
<title>Understanding Conditional Variance and Conditional Covariance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解条件方差和条件协方差</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-conditional-variance-and-conditional-covariance-8b661067fc18#2022-04-10">https://towardsdatascience.com/understanding-conditional-variance-and-conditional-covariance-8b661067fc18#2022-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/347f3b2b19a607b869cb9d239e6dbe77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*boRWTA-erF5Cm3AJpsHNrA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)(数据集来源:<a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/automobile" rel="noopener ugc nofollow" target="_blank">加州大学欧文分校</a>)</p></figure><div class=""/><div class=""><h2 id="eea9" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">以及如何使用真实数据集计算它们的教程</h2></div><p id="df09" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">条件方差和条件协方差是统计建模的核心概念。在本文中，我们将了解它们是什么，并说明如何使用真实世界的数据集来计算它们。</p><p id="2d2c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，快速回顾一下什么是方差和协方差。</p><p id="d22f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">随机变量的方差</strong>衡量其围绕均值的变化。两个随机变量之间的<strong class="kx jh">协方差</strong>是对它们各自均值变化的相关程度的度量。</p><h1 id="d30d" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">条件方差</h1><p id="a073" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">随机变量<strong class="kx jh"> <em class="mo"> X </em> </strong>的<strong class="kx jh">条件方差</strong>是通过<strong class="kx jh"> <em class="mo"> X </em> </strong>与其他随机变量<strong class="kx jh"> <em class="mo"> Y </em> </strong>、<strong class="kx jh"> <em class="mo"> X </em> </strong>、<strong class="kx jh"><em class="mo">W</em></strong>…等的关联来“解释掉”一部分变量后留下多少变化的度量。</p><p id="a7cd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">用符号形式表示为<em class="mo">Var(</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">Y</em></strong><em class="mo">，</em> <strong class="kx jh"> <em class="mo"> X </em> </strong> <em class="mo">，</em><strong class="kx jh"><em class="mo">W</em></strong><em class="mo"/>并读作<strong class="kx jh"><em class="mo">×T56】</em></strong>的方差</p><p id="7b92" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，让我们陈述无条件(总)方差的公式:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mp"><img src="../Images/de51029196b8aec6ab7d80c2697fac20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKmFCK2u9MBNAgnwNRa-1g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"> <em class="mv"> X </em> </strong>的样本方差公式(图片由作者提供)</p></figure><p id="3cac" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上式中，<em class="mo">E(</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">)</em>是<strong class="kx jh"> <em class="mo"> X </em> </strong>的“无条件”期望(均值)。</p><p id="4581" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">条件方差的公式是通过简单地将无条件期望替换为条件期望而获得的，如下所示(注意，在等式(2)中，我们现在计算的是<strong class="kx jh"> <em class="mo"> Y </em> </strong>(不是<strong class="kx jh"> <em class="mo"> X </em> </strong>):</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/fbcfd23b75638f5d486f1b74aaf59d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pj-TgOBW0sZaR78vQum32w.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">以 <strong class="bd mu"> <em class="mv"> X </em> </strong>为条件的<strong class="bd mu"> <em class="mv"> Y </em> </strong> <em class="mv">样本方差公式(图片由作者提供)</em></p></figure><p id="1d51" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mo">E(</em><strong class="kx jh"><em class="mo">Y</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">)</em>是对因变量为<strong class="kx jh"> <em class="mo"> Y </em> </strong>、解释变量为<strong class="kx jh"> <em class="mo"> X </em> </strong>的数据集拟合回归模型预测的<strong class="kx jh"> <em class="mo"> Y </em> </strong>的值。索引<em class="mo"> i </em>隐含在条件期望中，即对于数据集中的每一行<em class="mo"> i </em>，我们使用<em class="mo">E(</em><strong class="kx jh"><em class="mo">Y</em></strong><em class="mo">= Y _ I |</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">= X _ I)</em>。</p><p id="92e2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里，我们对回归模型的选择很重要。模型的正确选择将导致<strong class="kx jh"> <em class="mo"> Y </em> </strong>中的大量方差由拟合的模型来解释，因此<strong class="kx jh"> <em class="mo"> Y </em> </strong>对<strong class="kx jh"> <em class="mo"> X </em> </strong>的条件方差将相应较小。另一方面，由于模型无法解释<strong class="kx jh"> <em class="mo"> Y </em> </strong>中的大部分方差，因此模型选择不正确会导致较大的条件方差。</p><p id="d18d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上述条件方差公式可以扩展到多个变量，方差以使用回归模型为条件，其中<strong class="kx jh"> <em class="mo"> X </em> </strong>矩阵包含多个回归变量。</p><h2 id="ca94" class="mx ls jg bd lt my mz dn lx na nb dp mb le nc nd md li ne nf mf lm ng nh mh ni bi translated">说明</h2><p id="9a53" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">让我们用一些真实世界的数据来说明计算条件方差的过程。下面的数据集包含205辆汽车的规格，摘自1985年版的沃德汽车年鉴。每行包含一组26个关于单个车辆的规格。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/7194893e945ce1d7f303c674be815d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o-Hr55jCYsNmM-C_.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">汽车数据集(来源:<a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/automobile" rel="noopener ugc nofollow" target="_blank">加州大学欧文分校</a>)</p></figure><p id="0f56" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将考虑这个数据集的一个小子集，它由以下六个变量组成:<br/> City_MPG <br/>整备质量<br/>Vehicle _ Volume<br/>Num _ Cylinders<br/>Vehicle _ Price<br/>发动机_Size</p><p id="f990" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这个6变量数据集可以从这里 下载<a class="ae jd" href="https://gist.github.com/sachinsdate/6f1b581565e7fc938dfb5dd56f478288" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh">。</strong></a></p><p id="2472" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们画出发动机大小与气缸数的关系图。我们将使用Python、Pandas和Matplotib包将数据加载到DataFrame中并显示绘图:</p><p id="cd75" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们导入所有需要的包，包括我们将在本文后面使用的包。</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="4f26" class="mx ls jg nl b gy np nq l nr ns"><strong class="nl jh">import </strong>pandas <strong class="nl jh">as </strong>pd<br/><strong class="nl jh">from </strong>patsy <strong class="nl jh">import </strong>dmatrices<br/><strong class="nl jh">import </strong>numpy <strong class="nl jh">as </strong>np<br/><strong class="nl jh">import </strong>scipy.stats<br/><strong class="nl jh">import </strong>statsmodels.api <strong class="nl jh">as </strong>sm<br/><strong class="nl jh">import </strong>matplotlib.pyplot <strong class="nl jh">as </strong>plt</span></pre><p id="d331" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，让我们将数据文件加载到Pandas数据框架中，并绘制引擎大小与汽缸数量的关系图。</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="4104" class="mx ls jg nl b gy np nq l nr ns"><strong class="nl jh"><em class="mo">#Read the automobiles dataset into a Pandas DataFrame</em></strong><em class="mo"><br/></em>df = pd.read_csv(<strong class="nl jh">'automobile_uciml_6vars.csv'</strong>, header=0)</span><span id="2541" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Drop all empty rows</em></strong><em class="mo"><br/></em>df = df.<strong class="nl jh">dropna</strong>()</span><span id="73d6" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Plot Engine_Size versus Num_Cylinders</em></strong><em class="mo"><br/></em>fig = plt.figure()<br/>fig.suptitle(<strong class="nl jh">'Engine_Size versus Num_Cylinders'</strong>)<br/>plt.xlabel(<strong class="nl jh">'Num_Cylinders'</strong>)<br/>plt.ylabel(<strong class="nl jh">'Engine_Size'</strong>)<br/>plt.scatter(df[<strong class="nl jh">'Num_Cylinders'</strong>], df[<strong class="nl jh">'Engine_Size'</strong>])<br/><em class="mo">#Plot a horizontal mean line<br/></em>plt.plot([0, df[<strong class="nl jh">'Num_Cylinders'</strong>].max()], [df[<strong class="nl jh">'Engine_Size'</strong>].mean(), df[<strong class="nl jh">'Engine_Size'</strong>].mean()],<br/>         [df[<strong class="nl jh">'Engine_Size'</strong>].mean()], color=<strong class="nl jh">'red'</strong>, linestyle=<strong class="nl jh">'dashed'</strong>)<br/><br/><strong class="nl jh"><em class="mo">#Group the DataFrame by Num_Cylinders and calculate the mean for each group</em></strong><em class="mo"><br/></em>df_grouped_means = df.groupby([<strong class="nl jh">'Num_Cylinders'</strong>]).mean()<br/><br/><strong class="nl jh"><em class="mo">#Print out all the grouped means</em></strong><em class="mo"><br/></em>df_grouped_means = df.groupby([<strong class="nl jh">'Num_Cylinders'</strong>]).mean()<br/><br/><strong class="nl jh"><em class="mo">#Plot the group-specific means of Engine_Size</em></strong><em class="mo"><br/></em><strong class="nl jh">for </strong>i <strong class="nl jh">in </strong>df_grouped_means.index:<br/>    mean = df_grouped_means[<strong class="nl jh">'Engine_Size'</strong>].loc[i]<br/>    plt.plot(i, mean, color=<strong class="nl jh">'red'</strong>, marker=<strong class="nl jh">'o'</strong>)<br/><br/>plt.show()</span></pre><p id="f119" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是分组平均值表，即以Num_Cylinders的不同值为条件的平均值。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nu"><img src="../Images/1e8c46e7306cf41db2a5df12c99695e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HvpaarcanotXskNEZjwDLA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">分组均值表(条件均值)(图片由作者提供)</p></figure><p id="b7f4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还可以看到下面的曲线图，它显示了不同数值的Num_Cylinders中Engine_Size的变化:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/22ba2f7046b50aa0ef2404ece998cb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqhCf4l42Qa5Mj-vnG2MxQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">引擎大小与气缸数的散点图，显示引擎大小的无条件平均值和条件平均值(图片由作者提供)</p></figure><p id="f3d1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">红色水平线表示<strong class="kx jh">无条件均值</strong>值126.91。红点表示不同Num_Cylinders值的平均发动机尺寸。这些是<strong class="kx jh">条件的意思，也称为对于Num_Cylinders的不同值的发动机_大小的条件期望</strong>，它们被表示为<em class="mo"> E( </em> <strong class="kx jh"> <em class="mo">发动机_大小</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">Num _ Cylinders =</em></strong><em class="mo">x)</em>。</p><h2 id="1d04" class="mx ls jg bd lt my mz dn lx na nb dp mb le nc nd md li ne nf mf lm ng nh mh ni bi translated">引擎大小的无条件(总)方差</h2><p id="b653" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">让我们重温一下<strong class="kx jh"> <em class="mo"> X </em> </strong>的总方差公式:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mp"><img src="../Images/de51029196b8aec6ab7d80c2697fac20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKmFCK2u9MBNAgnwNRa-1g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"> <em class="mv"> X </em> </strong>的样本方差公式(图片由作者提供)</p></figure><p id="e09d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上式中，若<strong class="kx jh"><em class="mo">X</em></strong>= Engine _ Size，则由<em class="mo">E(</em><strong class="kx jh"><em class="mo">)X</em></strong><em class="mo">)</em>表示的平均值为<em class="mo"> </em> 126.88。利用这个公式，我们计算出发动机尺寸的样本方差为<strong class="kx jh"> 1726.14 </strong>。这是围绕<em class="mo"> 126.91 </em>的无条件期望值的Engine_Size变化的度量。</p><p id="2231" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在熊猫中，我们可以得到总方差的值如下:</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="14aa" class="mx ls jg nl b gy np nq l nr ns">unconditional_variance_engine_size = df[<strong class="nl jh">'Engine_Size'</strong>].var()</span><span id="89d5" class="mx ls jg nl b gy nt nq l nr ns">print(<strong class="nl jh">'(Unconditional) sample variance in Engine_Size='</strong>+str(unconditional_variance_engine_size))</span></pre><p id="9602" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到以下输出:</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="d9bc" class="mx ls jg nl b gy np nq l nr ns">Unconditional variance in Engine_Size=<strong class="nl jh">1726.1394527363163</strong></span></pre><h2 id="0107" class="mx ls jg bd lt my mz dn lx na nb dp mb le nc nd md li ne nf mf lm ng nh mh ni bi translated">引擎大小的条件方差</h2><p id="159d" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">以Num_Cylinders为条件的Engine_Size的方差是Engine_Size中剩余的方差，其中一些已经由Num_Cylinders上的Engine_Size的回归“解释”。我们可以使用等式(2)计算如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nw"><img src="../Images/844979ebc782ff1dff415acf21a8177f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AEsWN-rEbSJGmqzBCjkRfA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">发动机尺寸的变化取决于气缸数(图片由作者提供)</p></figure><p id="b9d6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们看一个稍微复杂一点的例子。</p><p id="8d15" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设我们希望<strong class="kx jh">根据整备质量、车辆体积和气缸数量</strong>计算发动机尺寸的变化。</p><p id="800b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，我们使用以下步骤:</p><ol class=""><li id="d664" class="nx ny jg kx b ky kz lb lc le nz li oa lm ob lq oc od oe of bi translated">构建一个回归模型，其中响应变量为发动机尺寸，回归变量为整备质量、车辆体积、气缸数量和截距。</li><li id="2210" class="nx ny jg kx b ky og lb oh le oi li oj lm ok lq oc od oe of bi translated">在数据集上训练模型。</li><li id="2011" class="nx ny jg kx b ky og lb oh le oi li oj lm ok lq oc od oe of bi translated">在数据集上运行训练的模型，以获得整备质量、车辆体积、汽缸数量的每个组合的发动机尺寸的预测(预期)值。这些是条件期望的集合:<br/><em class="mo">E(Engine_Size | Curb _ Weight，Vehicle_Volume，Num_Cylinders) </em>对应于Engine _ Size的观测值。</li><li id="f396" class="nx ny jg kx b ky og lb oh le oi li oj lm ok lq oc od oe of bi translated">将Engine_Size的观测值和步骤2中计算的预测值代入等式(2)以获得条件方差。</li></ol><p id="3be9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们来计算一下！</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="552d" class="mx ls jg nl b gy np nq l nr ns"><strong class="nl jh"><em class="mo">#Construct the regression expression. A regression intercept is included by default</em></strong><em class="mo"><br/></em>olsr_expr = <strong class="nl jh">'Engine_Size ~ Curb_Weight + Vehicle_Volume + Num_Cylinders'</strong></span><span id="4ec8" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Carve out the y and X matrices based on the regression expression</em></strong><em class="mo"><br/></em>y, X = dmatrices(olsr_expr, df, return_type=<strong class="nl jh">'dataframe'</strong>)</span><span id="3106" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Build the OLS linear regression model</em></strong><em class="mo"><br/></em>olsr_model = sm.OLS(endog=y, exog=X)<br/><strong class="nl jh"><em class="mo">#Train the model</em></strong><em class="mo"><br/></em>olsr_model_results = olsr_model.fit()</span><span id="2285" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Make the predictions on the training data set. These are the conditional expectations of y</em></strong><br/>y_pred=olsr_model_results.predict(X)<br/>y_pred=np.array(y_pred)</span><span id="6c0e" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Convert y from a Pandas DataFrame into an array</em></strong><br/>y=np.array(y[<strong class="nl jh">'Engine_Size'</strong>])</span><span id="85d0" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Calculate the conditional variance in Engine_Size using equation (2)</em></strong><br/>conditional_variance_engine_size = np.sum(np.square(y-y_pred))/(len(y)-1)</span><span id="776c" class="mx ls jg nl b gy nt nq l nr ns">print(<strong class="nl jh">'Conditional variance in Engine_Size='</strong>+str(conditional_variance_engine_size))</span></pre><p id="04c6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到以下输出:</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="e3e9" class="mx ls jg nl b gy np nq l nr ns">Conditional variance in Engine_Size=<strong class="nl jh">167.42578329039935</strong></span></pre><p id="abaa" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如预期的那样，这个<strong class="kx jh"> 167.43 </strong>的方差大大小于Engine_Size的总方差(<strong class="kx jh"> 1726.13 </strong>)。</p><h1 id="7b3f" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">条件方差与R平方的关系</h1><p id="5c1b" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated"><strong class="kx jh">线性</strong>回归模型的r平方是解释变量能够“解释”的因变量中总方差的分数。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ol"><img src="../Images/bb0d3a7a46454bcc44f18afbc9a58ef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SkpmY7yX0r0Htd05gQLwMQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性回归模型的R平方的定义(图片由作者提供)</p></figure><p id="b6d3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在知道，<strong class="kx jh"><em class="mo"/></strong>中的方差即<strong class="kx jh"><em class="mo"/></strong>X<em class="mo"/>能够解释的是条件方差<em class="mo">Var(</em><strong class="kx jh"><em class="mo">y</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">)</em>。而<strong class="kx jh"> <em class="mo"> y </em> </strong>中的总方差，简单来说就是无条件方差<em class="mo">Var(</em><strong class="kx jh"><em class="mo">y</em></strong><em class="mo">)</em>。因此，R平方可以用条件方差和无条件方差表示如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a64709303daa4e0ee316d2f93feddbb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*hsMrgyOn0MKAGdUt31lvTw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">用<strong class="bd mu"> y </strong>中的条件方差和无条件方差表示的r平方(图片由作者提供)</p></figure><p id="2d72" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们为之前构建的线性回归模型计算R平方。回想一下，因变量<strong class="kx jh"> <em class="mo"> y </em> </strong>是发动机尺寸，而解释变量<strong class="kx jh"> <em class="mo"> X </em> </strong>是整备质量、车辆体积和汽缸数量。</p><p id="5066" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">发现<strong class="kx jh"> <em class="mo"> y </em> </strong>中的总方差为<strong class="kx jh">163</strong>。36363.666666666665</p><p id="4489" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="mo"> y </em> </strong>中的条件方差，即<strong class="kx jh"> <em class="mo"> y </em> </strong>中以整备质量、车辆体积和气缸数为条件的方差被发现为<strong class="kx jh">167.429039935</strong>。</p><p id="aa5e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用等式(4)，该线性模型的R平方为:</p><p id="51eb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mo"> R平方= 1–167.43/1726.14 = 0.903</em></p><p id="0967" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该值与statsmodels报告的值完全匹配:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi on"><img src="../Images/21bbbcf9cd2bc44c4dfaa99e146f1212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TnJiFLTEFOOZda2Fw_udHA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性回归模型的模型训练摘要(图片由作者提供)</p></figure></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><h1 id="ff74" class="lr ls jg bd lt lu ov lw lx ly ow ma mb km ox kn md kp oy kq mf ks oz kt mh mi bi translated">条件协方差</h1><p id="1caa" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">记住，两个随机变量<strong class="kx jh"> <em class="mo"> X </em> </strong>和<strong class="kx jh"> <em class="mo"> Z </em> </strong>之间的协方差是对<strong class="kx jh"> <em class="mo"> X </em> </strong>和<strong class="kx jh"> <em class="mo"> Z </em> </strong>中的<em class="mo">变量</em>相互之间相关程度的度量。其公式如下:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pa"><img src="../Images/e9921abe53f61d092d2c718e23d6b92a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rrJJ9A9gMfLHwM2SAWabxw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">X和Z之间的样本协方差公式(图片由作者提供)</p></figure><p id="a763" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个公式中，<em class="mo">E(</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">)</em>和<em class="mo">E(</em><strong class="kx jh"><em class="mo">Z</em></strong><em class="mo">)</em>是<strong class="kx jh"><em class="mo">X</em></strong><strong class="kx jh"><em class="mo"/></strong>的无条件手段(又名无条件期望)。</p><p id="616f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> <em class="mo">的<strong class="kx jh">协方差</strong>X</em></strong>和<strong class="kx jh"> <em class="mo"> Z </em> </strong>，<strong class="kx jh">条件依赖于</strong>一些随机变量<strong class="kx jh"><em class="mo"/></strong>W是围绕<strong class="kx jh"> <em class="mo">的条件期望的<strong class="kx jh"><em class="mo"/></strong>X<strong class="kx jh"><em class="mo">Z</em></strong>的变化的相关程度的度量</em></strong></p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pb"><img src="../Images/e1b1aa4c9b27d254264af66e7beca90d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XLS8BlLukjNvja6YonVmxg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated"><strong class="bd mu"> X </strong>和<strong class="bd mu"> Z </strong>之间的样本条件协方差公式(图片由作者提供)</p></figure><p id="7449" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mo">E(</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">W</em></strong><em class="mo">)</em>和<em class="mo">E(</em><strong class="kx jh"><em class="mo">Z | W</em></strong><em class="mo">)</em>是<strong class="kx jh"> <em class="mo"> X的<strong class="kx jh">条件期望</strong>于是<em class="mo">(X _ I—E(</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">W</em></strong><em class="mo">)</em>是<strong class="kx jh"> <em class="mo"> X </em> </strong>中的变异后的一部分已经用<strong class="kx jh"> <em class="mo"> W </em> </strong>解释过了。同上<em class="mo">(Z _ I—E(</em><strong class="kx jh"><em class="mo">Z</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">W</em></strong><em class="mo">)</em>。索引<em class="mo"> i </em>隐含在两个条件期望中，即对于数据集中的每一行<em class="mo"> i </em>，我们使用<em class="mo">E(</em><strong class="kx jh"><em class="mo">)X</em></strong><em class="mo">= X _ I |</em><strong class="kx jh"><em class="mo">W</em></strong><em class="mo">= W _ I)</em>和<em class="mo"/></em></strong></p><p id="dee5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，条件协方差是在通过<strong class="kx jh"><em class="mo">【W】</em></strong>的存在解释了一些各自的方差之后，<strong class="kx jh"><em class="mo"/></strong>和<strong class="kx jh"><em class="mo">【Z】</em></strong><em class="mo">的变化的相关程度的度量。</em></p><p id="5267" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与计算条件方差的过程一样，我们可以通过回归<strong class="kx jh">上的<strong class="kx jh"><em class="mo"/></strong>X</strong>来估计条件期望<em class="mo">E(</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">W</em></strong><em class="mo">)</em>和<em class="mo">E(</em><strong class="kx jh"><em class="mo">Z | W</em></strong><em class="mo">)</em>各自的回归模型对训练数据集的预测就是我们所寻求的对应的条件期望<em class="mo">E(</em><strong class="kx jh"><em class="mo">X</em></strong><em class="mo">|</em><strong class="kx jh"><em class="mo">W</em></strong><em class="mo">)</em>和<em class="mo">E(</em><strong class="kx jh"><em class="mo">Z | W</em></strong><em class="mo">)</em>。</p><h2 id="8efc" class="mx ls jg bd lt my mz dn lx na nb dp mb le nc nd md li ne nf mf lm ng nh mh ni bi translated">说明</h2><p id="96f1" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我们将根据车辆体积计算发动机尺寸和整备质量之间的协方差。</p><p id="343d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们将通过计算Engine_Size和Curb_Weight之间的无条件(总)协方差来确定方差的基线。这可以使用如下等式(5)来容易地完成:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pc"><img src="../Images/ce891c1586d7776056c33c3765b90b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7YA-m6Nh0rdx0vfntVzEyg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">发动机尺寸和整备质量之间的总协方差公式(图片由作者提供)</p></figure><p id="1d93" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用Pandas，我们可以如下计算协方差:</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="ba54" class="mx ls jg nl b gy np nq l nr ns">covariance = df['Curb_Weight'].<strong class="nl jh">cov</strong>(df['Engine_Size'])</span></pre><p id="7662" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到以下输出:</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="d44d" class="mx ls jg nl b gy np nq l nr ns">Covariance between Curb_Weight and Engine_Size=<strong class="nl jh">18248.28333333333</strong></span></pre><p id="c6e8" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还可以查看以平均值为中心的Engine_Size和以平均值为中心的Curb_Weight的散点图，以直观感受这种协方差:</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="5e0e" class="mx ls jg nl b gy np nq l nr ns"><strong class="nl jh"><em class="mo">#Plot mean-centered Curb_Weight versus Engine_Size</em></strong><em class="mo"><br/></em>fig = plt.figure()</span><span id="9c07" class="mx ls jg nl b gy nt nq l nr ns">fig.suptitle(<strong class="nl jh">'Mean centered Curb_Weight versus Engine_Size'</strong>)</span><span id="8ca5" class="mx ls jg nl b gy nt nq l nr ns">plt.xlabel(<strong class="nl jh">'Mean centered Engine_Size'</strong>)</span><span id="907c" class="mx ls jg nl b gy nt nq l nr ns">plt.ylabel(<strong class="nl jh">'Mean centered Curb_Weight'</strong>)</span><span id="be56" class="mx ls jg nl b gy nt nq l nr ns">plt.scatter(df[<strong class="nl jh">'Engine_Size'</strong>]-df[<strong class="nl jh">'Engine_Size'</strong>].<strong class="nl jh">mean</strong>(), df[<strong class="nl jh">'Curb_Weight'</strong>]-df[<strong class="nl jh">'Curb_Weight'</strong>].<strong class="nl jh">mean</strong>())</span><span id="9583" class="mx ls jg nl b gy nt nq l nr ns">plt.show()</span></pre><p id="c77c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到下面的情节:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/0db370565c5e70094f0a26c835568154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8tElV6EeuY1ETaihuNsrw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">平均中心(贬低的)整备质量与贬低的车辆发动机尺寸散点图(图片由作者提供)</p></figure><p id="b9df" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在该图中立即注意到的一件事是，对于发动机尺寸相似的车辆，整备质量似乎有很大差异:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/d70b17496e12492d358b31961a8cd4d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZAMncNyu4jSo4KTQOhDSg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">整备质量变化与车辆平均中心发动机尺寸的散点图，显示了具有相似发动机尺寸的车辆之间整备质量的广泛变化(图片由作者提供)</p></figure><p id="464f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">还有其他因素可以解释特定发动机尺寸内整备重量<em class="mo">的差异。</em></p><p id="9081" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们看看汽车的体积作为这样一个因素。具体来说，让我们<strong class="kx jh">根据车辆体积</strong>计算整备质量和发动机尺寸之间的协方差，即剔除车辆体积的影响。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pd"><img src="../Images/620e51184f36eb03b28e4a504a53a71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DVyZ5Uk061DN6eXWeX3nuA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">发动机尺寸和整备质量之间的协方差公式取决于车辆体积(图片由作者提供)</p></figure><p id="7390" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的公式中，用绿色标记的两个条件期望可以通过回归车辆体积上的发动机尺寸和车辆体积上的整备质量来获得。和以前一样，指数<em class="mo"> i </em>隐含在两个期望中。</p><p id="87b3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用Pandas和statsmodels，让我们如下计算这个条件协方差。在下面这段代码中，<strong class="kx jh"><em class="mo">X</em></strong>=发动机尺寸，<strong class="kx jh"><em class="mo">Z</em></strong>=整备质量，<strong class="kx jh"><em class="mo">W</em></strong>=车辆体积。</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="b949" class="mx ls jg nl b gy np nq l nr ns"><strong class="nl jh"><em class="mo">#Carve out the X and W matrices</em></strong><em class="mo">.</em><strong class="nl jh"><em class="mo"> An intercept is automatically added to W.</em></strong><em class="mo"><br/></em>X, W = dmatrices(<strong class="nl jh">'Engine_Size ~ Vehicle_Volume'</strong>, df, return_type=<strong class="nl jh">'dataframe'</strong>)</span><span id="0ae0" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Regress X on W</em></strong><em class="mo"><br/></em>olsr_model_XW = sm.<strong class="nl jh">OLS</strong>(<strong class="nl jh">endog</strong>=X, <strong class="nl jh">exog</strong>=W)<br/>olsr_model_XW_results = olsr_model_XW.<strong class="nl jh">fit</strong>()</span><span id="ee56" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Get the conditional expectations E(X|W)</em></strong><br/>X_pred=olsr_model_XW_results.<strong class="nl jh">predict</strong>(W)<br/>X_pred=np.<strong class="nl jh">array</strong>(X_pred)</span><span id="c37c" class="mx ls jg nl b gy nt nq l nr ns">X=np.<strong class="nl jh">array</strong>(df[<strong class="nl jh">'Engine_Size'</strong>])</span><span id="8a50" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Carve out the Z and W matrices</em></strong><em class="mo"><br/></em>Z, W = dmatrices(<strong class="nl jh">'Curb_Weight ~ Vehicle_Volume'</strong>, df, return_type=<strong class="nl jh">'dataframe'</strong>)</span><span id="1e5b" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Regress Z on W</em></strong><em class="mo"><br/></em>olsr_model_ZW = sm.OLS(endog=Z, exog=W)<br/>olsr_model_ZW_results = olsr_model_ZW.fit()</span><span id="9620" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Get the conditional expectations E(Z|W)<br/></em></strong>Z_pred=olsr_model_ZW_results.predict(W)<br/>Z_pred=np.array(Z_pred)</span><span id="9f3f" class="mx ls jg nl b gy nt nq l nr ns">Z=np.array(df[<strong class="nl jh">'Curb_Weight'</strong>])</span><span id="330e" class="mx ls jg nl b gy nt nq l nr ns"><strong class="nl jh"><em class="mo">#Construct the delta matrices</em></strong><em class="mo"><br/></em>Z_delta=Z-Z_pred<br/>X_delta=X-X_pred<br/><br/><strong class="nl jh"><em class="mo">#Calculate the conditional covariance</em></strong><em class="mo"><br/></em>conditional_variance = np.<strong class="nl jh">sum</strong>(Z_delta*X_delta)/(len(Z)-1)</span><span id="464e" class="mx ls jg nl b gy nt nq l nr ns">print(<strong class="nl jh">'Conditional Covariance between Curb_Weight and Engine_Size='</strong>+str(conditional_variance))</span></pre><p id="3020" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到以下输出:</p><pre class="mq mr ms mt gt nk nl nm nn aw no bi"><span id="a298" class="mx ls jg nl b gy np nq l nr ns">Conditional Covariance between Curb_Weight and Engine_Size=<strong class="nl jh">7789.498082862661</strong></span></pre><p id="8d0d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们将<strong class="kx jh"> 7789.5 </strong>的这个值与之前计算的<strong class="kx jh"> 18248.28 </strong>的总协方差进行比较，我们会看到发动机尺寸和扣除车辆体积影响的整备质量之间的协方差确实比没有车辆体积影响的情况小得多。</p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="2d21" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是本文中使用的完整源代码:</p><figure class="mq mr ms mt gt is"><div class="bz fp l di"><div class="pe pf l"/></div></figure></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><h1 id="63f5" class="lr ls jg bd lt lu ov lw lx ly ow ma mb km ox kn md kp oy kq mf ks oz kt mh mi bi translated">参考文献、引文和版权</h1><h2 id="2821" class="mx ls jg bd lt my mz dn lx na nb dp mb le nc nd md li ne nf mf lm ng nh mh ni bi translated">数据集</h2><p id="5467" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated"><a class="ae jd" href="https://archive.ics.uci.edu/ml/datasets/automobile" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh">汽车数据集</strong> </a> <strong class="kx jh">引用:</strong> Dua，d .和Graff，C. (2019)。UCI机器学习知识库[http://archive . ics . UCI . edu/ml]。加州欧文:加州大学信息与计算机科学学院。<a class="ae jd" href="https://gist.github.com/sachinsdate/fd97d74979c4febf6746c153ea1b7668" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh">下载链接</strong> </a></p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="0e7c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mo">如果你喜欢这篇文章，请关注我的</em><a class="ae jd" href="https://timeseriesreasoning.medium.com" rel="noopener"><strong class="kx jh"><em class="mo">Sachin Date</em></strong></a><em class="mo">获取关于回归、时间序列分析和预测主题的提示、操作方法和编程建议。</em></p></div></div>    
</body>
</html>