<html>
<head>
<title>Data Drift Explainability: Interpretable Shift Detection with NannyML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据漂移的可解释性:用NannyML进行可解释的移位检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-drift-explainability-interpretable-shift-detection-with-nannyml-83421319d05f#2022-06-09">https://towardsdatascience.com/data-drift-explainability-interpretable-shift-detection-with-nannyml-83421319d05f#2022-06-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="845a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提醒有意义的多元漂移并确保数据质量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/efdb4b7b22b36b752d0d558efaa2c42f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lt1cZG3PWfPKbaS_"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">飞:D </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="2abc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">模型监控</strong>正在成为机器学习的热门趋势。随着关于MLOps的活动越来越多，我们记录了关于该主题的工具和研究的兴起。</p><p id="bf22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中最有趣的肯定是由<a class="ae ky" href="https://www.nannyml.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">【NannyML】</strong></a>开发的<a class="ae ky" href="https://nannyml.readthedocs.io/en/main/how_it_works/performance_estimation.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a><strong class="lb iu">【CBPE】</strong>基于置信度的性能估计算法。他们实施了一个新的程序来<strong class="lb iu">评估未来模型在缺乏基础事实的情况下的性能下降</strong>。它在检测性能下降方面具有很大的优势，因为在实际应用中，收集标签的成本可能很高，并且可能会延迟。</p><p id="548c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> CBPE </strong>算法可在<a class="ae ky" href="https://github.com/NannyML/nannyml" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> NannyML包</strong> </a>中找到，同时还有一些<strong class="lb iu">有趣的移位检测策略</strong>。从标准的单变量漂移检测方法到更先进的多变量特征漂移方法，我们拥有强大的武器库<strong class="lb iu">来自动检测无声模型故障</strong>。</p><p id="76be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们主要关注多元移位检测策略。我们想研究<strong class="lb iu">如何检测多元特征转移</strong>。我们与单变量情况进行了比较，以说明为什么后者在某些情况下不足以警告数据漂移。最后，我们更进一步，<strong class="lb iu">引入了</strong> <strong class="lb iu">一种混合方法来提供可解释的多元漂移检测</strong>。</p><h1 id="d6ca" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">单变量对多变量D </strong>裂缝</h1><p id="3363" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu">单变量漂移</strong>发生在变量在分布中出现显著差异时。实际上，我们独立地监控每个特性，并检查其分布是否随时间而变化。这可以通过比较新观测值和过去观测值之间的统计数据来直接实现。由于这些原因，单变量检测易于交流，完全可以理解。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/b9c4b3b7c533b0631cffa98f4436dff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*ULiLo772THXkOXbN_KHEdw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">单变量数据漂移(图片由作者提供)</p></figure><p id="dd22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">多变量漂移</strong>发生在输入数据之间的关系改变时。检测多变量变化可能更难解释，但通常需要克服单变量检测的缺陷。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/4632016777c82050ea1eda15565bbe77.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*75yrfXR81LrnxBCOfX_cFw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多元数据漂移(图片由作者提供)</p></figure><p id="1623" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">单变量和多变量漂移背后的原因可能因使用情形而异。无论何种应用，<strong class="lb iu">单变量特征漂移的结果可能会产生误导</strong>。我们来调查一下原因。</p><h1 id="cd99" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">单变量漂移检测的局限性</h1><p id="8709" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">假设我们有四个系列的数据(通过模拟获得):两个相关的正弦曲线和两个随机噪声特征。我们还考虑了两个数据子集(时段)来进行我们的实验。在“<em class="mu">参考</em>时期，我们指的是我们所掌握的历史数据。在“<em class="mu">分析</em>期间，我们指的是我们想要分析的新样本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/d751d67612aa13abb4f07561be43b7a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqsiPy04dxLPruN6SaxjTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模拟特征(图片由作者提供)</p></figure><p id="bf39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的<em class="mu">参考</em>时期，数据遵循相同的模式，保持它们的关系不变。在“<em class="mu">分析</em>期间，我们观察到蓝色正弦曲线和红色正弦曲线之间关系的变化。更准确地说，这两个特征在“<em class="mu">参考</em>周期中是正相关的，而在“<em class="mu">分析</em>周期结束时它们变成负相关的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/61bbda760d1ec2d6a143e893290b8404.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*7n6G7zTKy1dadlgWlbLF3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X1与X2的相关性(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/5ef0876889ccbf338c6c53e6f06f250c.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*yai4uNLMqgOMVSbF5waNiQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X1与X2的相关性(图片由作者提供)</p></figure><p id="350a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">关系发生变化，但单变量分布保持不变</strong>。我们的单变量漂移检测能有效吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/95a2869299265064d5191b20ad9bd8d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0O0puex7xm-5BPn4nZoKQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X1随时间的单变量分布(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/63db484910dbffb41c3d9360296766f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aie2wBLyq_mbHEIqWE-s3A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X2随时间的单变量分布(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/585df049d9a61fb99416e2f0281c405d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wb_VzDhNmV3z4DoPBIUq_A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X3随时间的单变量分布(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/167bd287d5a75a0e1503d5bc2485ed2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNwTXEcFaZ8IXFGGGZshbA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X4随时间的单变量分布(图片由作者提供)</p></figure><p id="1572" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如预期的那样，单变量数据漂移检测算法不会显示所有分析要素的任何漂移。从上面的图中，我们可以看到，单变量分布不随时间变化，因此Kolmogorov-Smirnov测试不能提醒变化。我们需要更有效的方法。</p><h1 id="df27" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">基于主成分分析的多元特征漂移</h1><p id="25f8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">上过基础机器学习课程的大家，都已经遇到过<strong class="lb iu">主成分分析(PCA) </strong>。这是一种对表格数据集进行降维以保留最显著的交互的技术。同时，我们可以使用主成分分析将压缩后的数据还原为原始形状。这种重建过程可以仅保留数据中有意义的模式，同时消除噪声。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/b4945463d4952a6c2bd289a055c8ef17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNUpzAw0MJSOI2MFU2wemg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PCA重构能力。左边是有噪声的原始数据。右图为降维后PCA重构的数据(图片由作者提供)</p></figure><p id="811f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.nannyml.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> NannyML </strong> </a> <strong class="lb iu">利用PCA的重构能力，开发了一种简单有效的多变量漂移检测方法。</strong></p><p id="f0c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一组数据首先被压缩到一个较低的维度空间，然后被解压缩以返回到原始的特征维度。这个转换过程是重建我们的数据的关键，只保留相关的相互作用。此时，可以计算原始数据和变换后的对应数据之间的一系列重构误差(简单的欧几里德距离)。<strong class="lb iu">来自一系列重建误差的任何有意义的尖峰可以被视为数据关系的变化</strong>，也称为多变量漂移。</p><p id="8187" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看这种方法在我们的数据上的应用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/5c585a86d791ba93fc3518e17becdf18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gbvfUJpxZVoWkpMWALxCMQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="5c53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在我们的“<em class="mu">参考</em>”数据集上拟合PCA，并计算重建误差。这有助于建立用于检测未来"<em class="mu">分析</em>数据变化的上限和下限。当新数据变得可用时，我们只需使用拟合的PCA来压缩和重建它们。如果重建误差落在预期阈值之外，我们应该记录特征关系的变化。这正是我们的数据所发生的情况。</p><p id="9ea6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PCA方法为多元漂移检测提供了有用的见解。<strong class="lb iu">通过单一KPI，我们可以控制整个系统的状态。同时，分离每个特征的贡献可能是增值的。</strong></p><h1 id="74fb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">可解释的多元特征漂移</h1><p id="0372" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">使用PCA，我们的目标是在单一的学习步骤中学习模式。这很好，并且显示出在大多数情况下和一些应用中是有效的。如果我们的目标是发现特性之间的未知关系，我们可以用一种简单的方式来做同样的事情。</p><p id="7943" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">我们可以把关系发现想象成一项受监督的任务。</strong>换句话说，给定一组特征，我们可以使用它们来预测彼此，并使用生成的残差作为漂移的度量。如果残差随着时间的推移而变化，我们通知一个转变。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/eb65b229e0287d30c7f617272ec5acd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d84tme4esC0dHI1BDS9bcQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">残留特征(图片由作者提供)</p></figure><p id="0890" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到我们的模拟场景，我们根据“<em class="mu">参考</em>”数据为我们所能支配的每个特性拟合一个模型。每个模型都适合使用所有其他特征作为预测器来预测期望的特征。然后我们在“<em class="mu">参考</em>”和“<em class="mu">分析</em>数据上生成残差。有了可处理的残差序列，我们就可以用单变量方法来检测漂移。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/99ae75f9526c2e3063ac7fe49aaa4ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CSZ5t2kqkeYBiuL347aT8A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X1随时间的单变量残差分布(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/32dc9c6d27af0c6aace6e12a087e41bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSDn2U5MAUJytkQQq7rChg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X2随时间的单变量残差分布(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/0b545cb4f535e11a502f609190be4b20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eCvInjlKfbX9D04Mg7jFpA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X3随时间的单变量残差分布(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/5f36b6a3e32f84edcee933a6f57d83a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Wun2HCj7sdkAuhjKotBdA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">X4随时间的单变量残差分布(图片由作者提供)</p></figure><p id="2221" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用单变量方法检测漂移现在更加有效。在“<em class="mu">分析”</em>周期结束时，我们记录了X1和X2的高错误。更准确地说，我们没有证据表明X1和X2在同一时期存在单变量分布漂移。由于这个原因，高误差可以指示X1和输入数据的其余部分之间的关系的变化(对于X2也是如此)。换句话说，单变量重建误差分布的变化可以揭示所涉及的特征已经改变了它们的相互作用。</p><h1 id="e679" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">摘要</h1><p id="a37d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这篇文章中，我们介绍了一些有效监控数据漂移的最新技术。我们也明白为什么只有单变量方法会受到影响。我们发现了多元特征转移的重要性，并试图提供一种可解释的方法来识别可能的多元漂移的来源。</p><h2 id="b4d8" class="nf lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">参考</h2><p id="d4f0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">要发现检测无声模型故障的<strong class="lb iu">的尖端技术，请查看<strong class="lb iu"> NannyML </strong>项目:<a class="ae ky" href="https://github.com/NannyML/nannyml" rel="noopener ugc nofollow" target="_blank">https://github.com/NannyML/nannyml</a></strong></p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="6056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mu">内容是我自己的，自己写的，按本人意愿发表(一如既往)。感谢NannyML团队收到的反馈</em></p><p id="7abb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/cerlymarco/MEDIUM_NoteBook" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">查看我的GITHUB回购</strong> </a></p><p id="0efc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保持联系:<a class="ae ky" href="https://www.linkedin.com/in/marco-cerliani-b0bba714b/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a></p></div></div>    
</body>
</html>