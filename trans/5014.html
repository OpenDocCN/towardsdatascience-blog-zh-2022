<html>
<head>
<title>An End to End Web App to detect anomalies from ECG signals with Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Streamlit从ECG信号中检测异常的端到端Web应用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-end-to-end-web-app-to-detect-anomalies-from-ecg-signals-with-streamlit-e00c177305ff#2022-11-08">https://towardsdatascience.com/an-end-to-end-web-app-to-detect-anomalies-from-ecg-signals-with-streamlit-e00c177305ff#2022-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3979" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">本教程着重于用MLflow、Sagemaker和Streamlit构建一个web应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/efc0609e552af5e775207f931a52d93b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SHSzW9X55SU1Gob0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·芬顿在<a class="ae ky" href="https://unsplash.com/photos/0ZQ8vojHNuc" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="afba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章是关于如何使用DagsHub+ML flow+AWS Lambda部署你的ML模型的故事<a class="ae ky" rel="noopener" target="_blank" href="/how-to-deploy-your-ml-model-using-dagshub-mlflow-aws-lambda-c85e07b06ef6?sk=30e3b1a636acd59d51f03cc7fc9e9459">。在前面的故事中，我展示了如何训练和部署一个模型来从ECG信号中检测不规则的心律。基准数据集是</a><a class="ae ky" href="http://www.timeseriesclassification.com/description.php?Dataset=ECG5000" rel="noopener ugc nofollow" target="_blank"> ECG5000数据集</a>，它包含从一名心力衰竭患者身上随机选取的5000次心跳。它经常被用在研究论文和教程中。</p><p id="98d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次，我将使用另一个真实世界的数据集，它更嘈杂，因此也更具挑战性。该数据包含时间戳、患者id和心率等字段。除了这些特征，还有一个标签告诉你心律是否异常，是通过人工标注得到的。</p><p id="f8dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将构建一个检测心脏异常的web应用程序。在创建应用程序之前，我们将进行一些探索性分析，建立和比较不同的机器学习模型。我们开始吧！</p><h1 id="9128" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">我们试图解决的问题是什么？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/4cf44fac9397d10ce96aec1f46a68853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*_1tvCrWbWVfpU-WmFUfQUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者插图。</p></figure><p id="c496" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将再次关注从ECG信号中检测异常。上面是患者的ECG信号，其中x标记代表异常。从这个例子中，你可以猜到它不仅是异常检测，而且是峰值检测。因此，我们需要识别峰值，并确定这些峰值是否异常。</p><p id="8064" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了遵守异常检测公式，训练集仅包含正常ECG信号，而测试包含正常和异常信号。还有一个重要的考虑因素:异常构成少数类，并对应于峰值。事实上，测试集包含不到1%的异常</p><p id="96a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于这些原因，单靠心率不足以解决这个问题。除了心率，我们还需要创建两个新特性。首先，我们构建一个变量来计算心率的当前值和先前值之间的差值。另一个至关重要的特性是峰值标签，如果有峰值，它的值等于1，否则返回0。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><p id="fa1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">目录</strong></p><ul class=""><li id="ec0c" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated"><strong class="lb iu">第1部分:模型训练和物流跟踪</strong></li><li id="cb5e" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated"><strong class="lb iu">第2部分:使用Amazon SageMaker部署MLflow模型</strong></li><li id="5b52" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated"><strong class="lb iu">第3部分:用Streamlit创建一个Web应用程序</strong></li></ul></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="5a94" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated"><strong class="ak">主要要求</strong></h2><ul class=""><li id="c7ea" class="mv mw it lb b lc nv lf nw li nx lm ny lq nz lu na nb nc nd bi translated">创建GitHub存储库。</li><li id="8e2f" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">登录DagsHub，点击“+ Create”按钮，选择“Connect A Repo”选项。它允许你通过GitHub和DagsHub来管理你的库。</li><li id="367d" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">这创建了一个DagsHub存储库，需要它来跟踪ML实验和版本化数据。</li><li id="9651" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">在本地PC上克隆存储库。建议将Visual Studio代码作为IDE。</li><li id="8c1f" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">使用<code class="fe oa ob oc od b">pip install dvc</code>安装DVC。</li><li id="87ae" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">在我们的项目中运行<code class="fe oa ob oc od b">dvc init</code>。</li></ul></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="9521" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated">第1部分:模型训练和MLflow跟踪</h2><p id="a8c2" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li oe lk ll lm of lo lp lq og ls lt lu im bi translated">就像在之前的教程中一样，我们将使用一个令人敬畏的开源平台来跟踪实验，打包机器学习模型，并在生产中部署它们，称为MLflow。它与DagsHub一起使用，dag shub允许您在存储库上找到所有结果实验，并有效地对数据和代码进行版本控制。除了这些特性，您还可以在DasgHub repository上可视化整个管道的交互式图形。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/83917a9a2589bcbbe77ebbddc630d888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tP1UX1sxwXDrxI-UxVyAfw.gif"/></div></div></figure><p id="be8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这次，我考虑了两种检测心脏异常的模型:自动编码器和隔离森林。这一选择是因为这项任务非常具有挑战性，而且与正常观测相比，异常现象的数量非常少。由于其特有的假设:异常代表少数类，并且在隔离树上具有短的平均路径长度，隔离林被证明比自动编码器具有更好的性能。</p><p id="a8e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，在训练算法之前，它设置超参数的值，该值对应于数据集中异常的比例，也称为污染。隔离林表现最好，污染率小于1%，如0.4%和0.5%。autoencoder发现这项任务更成问题，这并不奇怪，因为它没有这些类型的假设。</p><p id="d9bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在脚本中，我们训练两个可用模型中的一个，并记录超参数和指标。我们还对将模型记录为工件并在模型被训练后注册它感兴趣。这两个操作可以使用<code class="fe oa ob oc od b">mlflow.sklearn.log_model(sk_model=,artifact_path,registered_model_name)</code>合并。如果还是不想注册模型，可以避免指定<code class="fe oa ob oc od b">registered_model_name</code>参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="8d76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ok">你可以在这里</em>  <em class="ok">找到train.py </em> <a class="ae ky" href="https://dagshub.com/eugenia.anello/anomaly_detection_ecg_part2/src/ecg_ad/src/train.py" rel="noopener ugc nofollow" target="_blank"> <em class="ok">的完整代码。</em></a></p><p id="96b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以运行代码并尝试超参数的不同组合，例如model_name (if或Autoencoder)、使用隔离林时的污染率、epochs数以及切换到Autoencoder时的批量。</p><pre class="kj kk kl km gt ol od om on aw oo bi"><span id="c42f" class="nj lw it od b gy op oq l or os">python src/train.py</span></pre><p id="7243" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在实验框中访问实验的结果，它存在于DagsHub存储库中。从测试集上的模型评估中获得的结果，您可以注意到自动编码器获得了非常小的精度和f1分数值，而召回率很高，等于88%。这意味着假阳性的数量增加，然后，自动编码器发现异常甚至正常的模式。</p><p id="ecfb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与autoencoder不同，Isolation Forest获得了更好的分数，63%的准确率和85%的召回率，导致f1分数等于73%。即使仍有一些误报，但考虑到这个问题具有挑战性，结果超出了预期。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/c37d5600919bf5501bf74929f97be371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dl7Kkao2wZOarjg1dQyewQ.png"/></div></div></figure><p id="5292" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更好地理解所获得的评估方法，让我们也将真实值与预测值进行对比。这是使用Autoencoder对患者的ECG信号进行编码后得到的曲线:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/173cbb9f122cf713e8e23c2200263567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SaQY7nrUZe1Zsj6Xupd3Rw.gif"/></div></div></figure><p id="42c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这与隔离林获得的相同地块相比较:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/0eec2932e6da25312eabc7f54013d7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*j5QCnlHJi2QxSiYuKazS0w.gif"/></div></div></figure><p id="1beb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">绿点代表预测标签，而红叉代表地面真相。很明显，自动编码器似乎发现了异常的大量观察值，而隔离森林考虑了最异常的样本。</p><h2 id="ae40" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated">第2部分:使用Amazon SageMaker部署MLflow模型</h2><p id="d878" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li oe lk ll lm of lo lp lq og ls lt lu im bi translated">由于隔离林实现了最佳性能，我们将只关注此算法。它可以分为两步:</p><ul class=""><li id="7e10" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated">MLflow模型的更新阶段</li><li id="9574" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">创建AWS帐户并设置IAM角色</li><li id="8215" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">将MLflow模型部署到Sagemaker端点</li></ul><h2 id="3599" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated">1.MLflow模型的更新阶段</h2><p id="af31" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li oe lk ll lm of lo lp lq og ls lt lu im bi translated">从DagsHub页面，可以访问MLflow服务器用户界面。我们只需点击右上角的远程按钮，然后选择“转到MLflow UI”。之后，我们可以按下菜单中的型号选项，进入注册型号页面。然后，我们单击您注册的模型的最新版本，并将Stage参数从None设置为Staging。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/270d1512400b4349070e0983111fe3be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xXY28JAR8j2a3fvnwrvlow.png"/></div></div></figure><p id="f59f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了手动执行此操作，您还可以直接使用python脚本:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="7616" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们更新了模型的阶段，我们准备切换到下一步！</p><h2 id="578d" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated">2.创建AWS帐户并设置IAM角色</h2><p id="bccd" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li oe lk ll lm of lo lp lq og ls lt lu im bi translated">在部署模型之前，需要考虑一些要求:</p><ul class=""><li id="0762" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated">在<a class="ae ky" href="https://aws.amazon.com/free/?trk=74082305-452d-479a-b9dd-603d703a3cd2&amp;sc_channel=ps&amp;s_kwcid=AL!4422!3!455721528479!e!!g!!aws&amp;ef_id=Cj0KCQjwqoibBhDUARIsAH2OpWhC0b_QeLOL9BiMIoAI3s19JsmgH_jC97bLobePgIbXffUQzOvbd7AaAuslEALw_wcB:G:s&amp;s_kwcid=AL!4422!3!455721528479!e!!g!!aws&amp;all-free-tier.sort-by=item.additionalFields.SortRank&amp;all-free-tier.sort-order=asc&amp;awsf.Free%20Tier%20Types=*all&amp;awsf.Free%20Tier%20Categories=*all" rel="noopener ugc nofollow" target="_blank"> AWS </a>中注册账户</li><li id="b550" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">进入IAM →用户→ <strong class="lb iu">添加用户</strong>。选择用户名，并选择访问密钥-编程访问作为AWS凭据类型。</li><li id="aff0" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">如果您没有SageMaker组，请点击<strong class="lb iu">创建组</strong>。选择组名，添加两个策略:<code class="fe oa ob oc od b">AmazonSageMakerFullAccess</code>和<code class="fe oa ob oc od b">AmazonEC2ContainerRegistryFullAccess</code>。</li><li id="a975" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">之后，我们可以进入角色→ <strong class="lb iu">创建角色</strong>。选择AWS服务和SageMaker。Sagemaker策略将自动附加到角色。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/0c43dee71800dd584194b99527f19d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybKvWnlu-0RPkPhp2gyhog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><ul class=""><li id="f891" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated">设置AWS CLI界面。在终端上运行<code class="fe oa ob oc od b">aws configure</code>,它会询问您AWS访问密钥ID、AWS秘密访问密钥、默认区域名称和默认输出格式。欲了解更多信息，请点击查看<a class="ae ky" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html" rel="noopener ugc nofollow" target="_blank">。这是AWS文档中显示的一个示例:</a></li></ul><pre class="kj kk kl km gt ol od om on aw oo bi"><span id="92a4" class="nj lw it od b gy op oq l or os">$ <strong class="od iu">aws configure</strong> <br/>AWS Access Key ID [None]: <strong class="od iu"><em class="ok">AKIAIOSFODNN7EXAMPLE</em></strong> <br/>AWS Secret Access Key [None]: <strong class="od iu"><em class="ok">wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY</em></strong> <br/>Default region name [None]: <strong class="od iu"><em class="ok">us-west-2</em></strong> <br/>Default output format [None]: <strong class="od iu"><em class="ok">json</em></strong></span></pre><p id="0eb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想强调的是，这些已配置的凭据对于下一步至关重要。</p><h2 id="2b5b" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated">3.将MLflow模型部署到Sagemaker端点</h2><p id="6758" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li oe lk ll lm of lo lp lq og ls lt lu im bi translated">第一步是构建<code class="fe oa ob oc od b">mlflow-pyfunc</code>映像，并使用MLflow CLI将其推送到SageMaker:</p><pre class="kj kk kl km gt ol od om on aw oo bi"><span id="7669" class="nj lw it od b gy op oq l or os">mlflow sagemaker build-and-push-container</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/37bd6716fcb9a10918462f0cf541cdf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hUd-sKKUdf0l39fV6O0QFw.png"/></div></div></figure><p id="3799" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在AWS账户和Docker桌面上找到生成的图片。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/1bd0e5f54bcae5e633b4cb5faadad072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YUzD_QC4rf6xBxhPHmrZrw.png"/></div></div></figure><p id="d38e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，我们可以使用python脚本通过<code class="fe oa ob oc od b">mlflow.sagemaker.deploy</code>将MLflow模型部署到Sagemaker。您可以在<a class="ae ky" href="https://www.mlflow.org/docs/latest/python_api/mlflow.sagemaker.html" rel="noopener ugc nofollow" target="_blank"> mlflow文档</a>中找到更多信息。</p><p id="2f77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将导致创建一个Sagemaker端点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/da84e8e8254338497c62c959c1e6e3aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYaofIdZhnGJ5dUnR2ORUg.png"/></div></div></figure><p id="dc10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该获得这个最终输出。如果出现错误，请检查是否正确指定了image_url、model_uri和arn。</p><p id="c9c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以快速检查端点是否在工作。选择患者的ECG信号，并将其传递到部署的模型，该模型会将观察结果分类为正常或异常。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="1d52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要注意的是，当观察异常时，隔离林返回-1，否则返回1。为了与地面实况进行比较，我们需要映射这些值，1表示异常，0表示正常。如果您运行该脚本，您应该获得如下输出:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><h2 id="594a" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated">第3部分:创建Web应用程序</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/f3cef6669ecf1576ba0d533c09f03367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*211BP5wcpZabCQ5McPC-Ig.gif"/></div></div></figure><p id="302b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们最终构建一个web应用程序来检测ECG信号中的异常！我们将使用Streamlit，这是一个免费的开源框架，允许使用Python用几行代码构建应用程序:</p><ul class=""><li id="f888" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated">我们建立了到通过AWS Lambda获得的API服务的链接，其中已经部署了模型。</li><li id="ad12" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">使用<code class="fe oa ob oc od b">st.markdown</code>显示网络应用的主标题。</li><li id="9e52" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">在上传一个CSV文件来评估模型的性能时，使用<code class="fe oa ob oc od b">st.sidebar</code>创建一个左侧面板侧栏。</li><li id="dc22" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">按钮“检查异常！”需要单击以显示部署模型的结果。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="acc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果上传文件并选择按钮，将出现一个代表患者ECG信号的散点图。像以前一样，它将真实值与预测值进行比较。除了这些特性之外，您还可以通过以下代码更改患者ID的值</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="46d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在GitHub中推送所有更改后，我们可以使用Streamlit部署应用程序。这非常简单明了。如果你想了解更多信息，点击这个<a class="ae ky" href="https://www.youtube.com/watch?v=kXvmqg8hc70&amp;ab_channel=DataProfessor" rel="noopener ugc nofollow" target="_blank"> YouTube视频</a>的链接。我部署的应用程序的链接是<a class="ae ky" href="https://eugeniaring-anomaly-detection-ecg-part2-srcecg-app-xwxtyw.streamlit.app/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h2 id="78ee" class="nj lw it bd lx nk nl dn mb nm nn dp mf li no np mh lm nq nr mj lq ns nt ml nu bi translated">最终想法:</h2><p id="3d51" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li oe lk ll lm of lo lp lq og ls lt lu im bi translated">恭喜你！您已经完成了这个专注于检测ECG信号异常的项目。当从一个工具切换到另一个工具时，一开始可能会感到不知所措，但是当你达到结果时，它会给你带来满足感！特别是，一个网络应用程序可以是一个可爱和直观的方式来与其他人分享你的工作。感谢阅读。祝您愉快！</p><p id="6056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看我的DagsHub存储库中的代码:</p><div class="pc pd gp gr pe pf"><a href="https://dagshub.com/eugenia.anello/anomaly_detection_ecg_part2" rel="noopener  ugc nofollow" target="_blank"><div class="pg ab fo"><div class="ph ab pi cl cj pj"><h2 class="bd iu gy z fp pk fr fs pl fu fw is bi translated">eugenia.anello/anomaly_detection_ecg_part2</h2><div class="pm l"><h3 class="bd b gy z fp pk fr fs pl fu fw dk translated">这个项目的目标是从心电图信号中检测出不规则的心律。因为不规则的心律通常…</h3></div><div class="pn l"><p class="bd b dl z fp pk fr fs pl fu fw dk translated">dagshub.com</p></div></div><div class="po l"><div class="pp l pq pr ps po pt ks pf"/></div></div></a></div></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><p id="dc74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你喜欢我的文章吗？<a class="ae ky" href="https://eugenia-anello.medium.com/membership" rel="noopener"> <em class="ok">成为会员</em> </a> <em class="ok">每天无限获取数据科学新帖！这是一种间接的支持我的方式，不会给你带来任何额外的费用。如果您已经是会员，</em> <a class="ae ky" href="https://eugenia-anello.medium.com/subscribe" rel="noopener"> <em class="ok">订阅</em> </a> <em class="ok">每当我发布新的数据科学和python指南时，您都会收到电子邮件！</em></p></div></div>    
</body>
</html>