<html>
<head>
<title>Spatial Data Science: Spatial Data Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">空间数据科学:空间数据存储</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/spatial-data-science-spatial-data-storage-364a8df4038c#2022-06-07">https://towardsdatascience.com/spatial-data-science-spatial-data-storage-364a8df4038c#2022-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f4a7582cbd2bb13202d3fe7e408fb6fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1mk7QQUWR1OGbXV1LsDXg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:作者&amp;里尼，2022年</p></figure><div class=""/><div class=""><h2 id="e7a1" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">可选空间数据格式介绍；没有shapefile！</h2></div><p id="2e5b" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">空间数据科学家使用空间格式的空间数据。通常，这种格式是由ESRI在90年代开发的“shapefile”格式。我希望本文的读者在继续本文的其余部分之前熟悉“shapefile ”,因为我将向您介绍超越shapefile工作流。如果您对shapefile感到满意，这是一个很好的开始。然而，随着项目变得越来越复杂，您将处理更复杂的数据，如<code class="fe lt lu lv lw b">.osm.pbf</code>文件，或JSON (JavaScript对象符号)。那些是什么？为什么shapefile不够用？</p><h2 id="f760" class="lx ly ji bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">Shapefile的限制</h2><p id="bc34" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">大型项目需要灵活性和稳定性，以减少人为错误。我认为，Shapefile作为一种老技术，对普遍的现代挑战提出了几个限制:</p><ul class=""><li id="0b26" class="mv mw ji kz b la lb ld le lg mx lk my lo mz ls na nb nc nd bi translated"><strong class="kz jj"> Shapefile只允许最大2 GB的数据</strong>，而有时我们需要处理更多这样的数据</li><li id="2ad7" class="mv mw ji kz b la ne ld nf lg ng lk nh lo ni ls na nb nc nd bi translated"><strong class="kz jj">列名只允许一定数量的字符</strong>。你必须明智地命名你的专栏！我还是觉得<code class="fe lt lu lv lw b">.dbf</code>很烂。</li><li id="3802" class="mv mw ji kz b la ne ld nf lg ng lk nh lo ni ls na nb nc nd bi translated"><strong class="kz jj">天生凌乱</strong>。核心文件是<code class="fe lt lu lv lw b">.shp</code>，但是如果没有<code class="fe lt lu lv lw b">.dbf</code>、<code class="fe lt lu lv lw b">.prj</code>和更多的补充，它就一文不值了！如果您想要重命名shapefile，该怎么办？您必须对它们进行重命名，或者打开桌面GIS来为您进行重命名。或者，用花里胡哨的方式，在命令行界面使用GDAL/ogr2ogr。</li></ul><p id="75fc" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">虽然shapefile广为人知，很突出，这很好，但我真的不喜欢shapefile。然而，我必须说，用它工作很舒服！所以我认为恰当的说法是，</p><blockquote class="nj"><p id="a6ef" class="nk nl ji bd nm nn no np nq nr ns ls dk translated">我讨厌我爱shapefile…</p></blockquote><p id="6c7c" class="pw-post-body-paragraph kx ky ji kz b la nt kj lc ld nu km lf lg nv li lj lk nw lm ln lo nx lq lr ls im bi translated">但是外面还有什么呢？让我们探索一些替代方案…</p><h1 id="ccac" class="ny ly ji bd lz nz oa ob mc oc od oe mf ko of kp mi kr og ks ml ku oh kv mo oi bi translated">在这篇文章中</h1><p id="73a8" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">本文向您介绍了各种格式和数据库管理，以支持各种处理空间数据的方法。最后，根据项目的独特环境，您将有多种选择。</p><h1 id="285b" class="ny ly ji bd lz nz oa ob mc oc od oe mf ko of kp mi kr og ks ml ku oh kv mo oi bi translated">存储空间数据</h1><p id="b1a2" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">存储空间数据的标准方法是遵循OGC标准。对于点、多边形、折线等简单的矢量数据，标准应该足够了。空间数据可以以众所周知的文本(WKT)格式存储。；或其替代的著名二进制(WKB ),但它看起来很丑，因为它是二进制的。微软有一篇很棒的文章解释了什么是WKT。</p><pre class="ok ol om on gt oo lw op oq aw or bi"><span id="1b0f" class="lx ly ji lw b gy os ot l ou ov"># example of storing spatial data in WKT format</span><span id="a2ed" class="lx ly ji lw b gy ow ot l ou ov">POINT(-122.349 47.651)</span><span id="1cff" class="lx ly ji lw b gy ow ot l ou ov">LINESTRING(-122.360 47.656, -122.343 47.656)</span><span id="b0d6" class="lx ly ji lw b gy ow ot l ou ov">POLYGON((-122.358 47.653, -122.348 47.649, -122.348 47.658, -122.358 47.658, -122.358 47.653))</span></pre><p id="2dc2" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">一个简单的矢量空间要素仅仅由点和它是什么的定义(它是一个点吗？多边形？还是线？).因此，WKT是空间数据的一种表现形式。考虑到这一点，让我们来看看格式。</p><h1 id="531d" class="ny ly ji bd lz nz oa ob mc oc od oe mf ko of kp mi kr og ks ml ku oh kv mo oi bi translated">空间数据格式</h1><p id="63a5" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">本节讨论存储空间数据的各种格式，作为shapefile的替代方案。如果我们打开QGIS导出选项(下图),会有很多选项。我认为没有必要全部都学，下面的检查是最有可能用到的。</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/ca2ca90e23589cef6976d14dd0946a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*AczKvPDYeFRh33cOQ_VuIA.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">QGis导出选项</p></figure><h2 id="3075" class="lx ly ji bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">CSV —逗号分隔值</h2><p id="aaf7" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">逗号分隔值实际上是一个文本文件。可以在excel中打开CSV。让我给你举个例子:</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/679ed96659f5da791ced6f1f1daddd7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJ-4a4HBXjEythFgr5tr5w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">CSV格式的空间数据(来源:作者，2022)</p></figure><p id="cb82" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我认为这是相当直截了当的，文本本身就说明了问题。几何信息以WKT格式存储，作为一个人，我们可以阅读它，但不是真的。您可以在Ms Excel中打开此CSV文件，编辑属性并将其返回到桌面GIS。够搞笑的，还可以用Ms Words打开编辑。</p><h2 id="4bf7" class="lx ly ji bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">geo JSON-Javascript对象符号(JSON)</h2><p id="0337" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">JSON是web或应用程序相互通信的一种格式。<strong class="kz jj">只是一个文本文件，</strong>像csv...然而，以不同的形式。它由“键”和“值”对组成；当查询“键”时，返回“值”。文字看起来像下图的右边。</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oz"><img src="../Images/5247a485e58b05b7aae26e3e67062187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dM9SmpuHXJjNHle-oj_D1A.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">geojson.io(来源:作者，2022年)</p></figure><p id="a869" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">为了理解JSON文本，我建议阅读更多关于数据结构主题的内容。这本书挺受欢迎的(<a class="ae oj" href="https://www.cs.bham.ac.uk/~jxb/DSA/dsa.pdf" rel="noopener ugc nofollow" target="_blank">数据结构&amp;算法</a>)。试着理解什么是数组、字典、索引等等。一旦掌握了这一点，JSON和GeoJSON就更有意义了。</p><p id="0783" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">当处理在线/网站数据时，您经常会收到这类数据。我80%的时间都在使用Python GIS，当我看到一个以GeoJSON格式提供服务的网站时，我的心中燃起了一丝喜悦。这意味着我可以创建应用程序，检索GeoJSON，并让我的应用程序无缝、干净地处理它。</p><blockquote class="pa pb pc"><p id="bc2c" class="kx ky pd kz b la lb kj lc ld le km lf pe lh li lj pf ll lm ln pg lp lq lr ls im bi translated">你可以去<a class="ae oj" href="http://geojson.io" rel="noopener ugc nofollow" target="_blank"> geojson.io </a>画一些线或者多边形，了解一下。</p></blockquote><p id="4d48" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">因为它是基于文本的，所以您可以打开。GeoJSON用Ms Word照我说！或者，再次，文本编辑器。请确保分机保持不变。GeoJSON保留其格式。</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ph"><img src="../Images/b955425bbd1235e77ffb96aa7bca65dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5ObcFM_AXuSDZ4WkkFMDQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">微软Word中的Geojson(来源:作者，2022)</p></figure><h2 id="77fe" class="lx ly ji bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">地理包-文件地理数据库</h2><p id="1add" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">GeoPackage基本上是一个包含“shapefiles”的“文件夹”。标记引号是因为它们的行为类似于folder和shapefile，但是它们背后的技术本质是不同的。我们称空间数据为“特征”，而不是“形状文件”。您可以在QGIS或ArcGIS中浏览地理包“文件夹”。ESRI也开发了一种类似的格式，称为地理数据库(。广发)。它在ESRI ArcGIS环境中进行了优化。</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/5f4b2fc88b6fd1586a8f48cca87e84d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*6cC3LLf_1U1YGEdpiOmePw.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">地理数据库格式(来源:作者，2022年)</p></figure><h2 id="34fe" class="lx ly ji bd lz ma mb dn mc md me dp mf lg mg mh mi lk mj mk ml lo mm mn mo mp bi translated">PostGIS —数据库管理器</h2><p id="3465" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">Postgis是postgresql(关系数据库管理器，RDBMS)的扩展。嗯，它本身并不是一种格式，但是为了简单起见，我们可以这样看。首先，我们需要安装PostgreSQL并创建一个数据库。然后，我们将postgis扩展到数据库，以支持地理空间处理功能。我们的数据库现在是“邮政地理信息系统”！</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pj"><img src="../Images/dea87659f855cd5e5dc590aebd3ffc11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFSq8JclqoIBTrO_DPInTg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">PostgreSQL中的Postgis几何处理(来源:作者，2022)</p></figure><p id="9b90" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我认为Postgis是最佳的地理空间数据格式。这是因为您可以执行SQL并只选择您需要的数据，而无需加载全部数据并对其进行过滤。除此之外，当您使用geodjango构建web应用程序时，您将使用postgis。如此美丽。</p><p id="b90a" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我通常使用QGIS作为代理来管理postgis数据库，或者使用PgAdmin。您可以使用工具“导出到postgres”或“导出到postgis”(取决于您的QGIS版本)将数据加载到postgis，反之亦然。</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pj"><img src="../Images/d80483944dbdfe213877e08986c3e920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCbWkYfv1SC8B4Oe-8MiZg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Qgis中的Postgis(来源:作者，2022)</p></figure><h1 id="3706" class="ny ly ji bd lz nz oa ob mc oc od oe mf ko of kp mi kr og ks ml ku oh kv mo oi bi translated">结论</h1><p id="469f" class="pw-post-body-paragraph kx ky ji kz b la mq kj lc ld mr km lf lg ms li lj lk mt lm ln lo mu lq lr ls im bi translated">现在，我已经向您介绍了一些替代数据格式，而不是常见的shapefile格式。这5种格式是。csv，。乔森还有。gpkg(地理包)或。gdb(地理数据库)和PostGIS。我个人认为有趣的是，我们可以在Ms Word中写一堆单词，并根据它们创建一个地图，只要我们能够精确定位数据的精确坐标。如果excel女士可以处理多边形数据，我们当然可以创建地图；我们可以，但只能用点和线数据。当然，有一点需要注意:UTF 8编码的文本文件格式效率非常低；另一方面，我发现shapefiles非常快。然而，这些优点并没有消失。</p><p id="7767" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">就个人而言，在从事GIS工作4年之后，我并不那么喜欢shapefile。它在90年代有过辉煌的日子。现在，我更喜欢将我的数据存储在PostGIS、CSV(尤其是当它是点数据时)或geojson中，尽管在性能方面有点低效。处理CSV和WKT数据非常方便，因为像<a class="ae oj" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoSeries.from_wkt.html" rel="noopener ugc nofollow" target="_blank"> geopandas </a>和<a class="ae oj" href="https://gis.stackexchange.com/questions/273143/adding-delimited-text-layer-in-qgis" rel="noopener ugc nofollow" target="_blank"> qgis </a>这样的工具已经提供了快速处理这些数据的命令。</p><p id="edc6" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">在下一篇文章中，我将讨论使用PostGIS管理空间数据库。这是非常奇妙和令人兴奋的！</p></div></div>    
</body>
</html>