<html>
<head>
<title>Amazon Comprehend Custom Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊理解自定义分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/amazon-comprehend-custom-classification-d91d68d169cc#2022-04-13">https://towardsdatascience.com/amazon-comprehend-custom-classification-d91d68d169cc#2022-04-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b0d5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用AutoML定制数据集</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0c2a56ab499e9e16d8f381a6375a474d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LKi8BiAcRHqED6Hh"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://unsplash.com/@sure_mp" rel="noopener ugc nofollow" target="_blank">苏伦兰议员</a>的<a class="ae ky" href="https://unsplash.com/photos/IhWYiwSxm8g" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="333c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://docs.aws.amazon.com/managedservices/latest/userguide/comprehend.html" rel="noopener ugc nofollow" target="_blank">亚马逊理解</a>是庞大的AWS AI/ML堆栈的一部分。这是AWS提供的首要自然语言处理(NLP)服务，它提供了很大的灵活性。在过去，我解释了如何使用理解API来自动化<a class="ae ky" rel="noopener" target="_blank" href="/sentiment-analysis-entity-extraction-with-aws-comprehend-618a7bec60b8">情感分析和实体识别</a>。</p><p id="7ade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，对于大多数用例，您会有一个特定的数据集<strong class="lb iu">来训练您的模型。对于一个<strong class="lb iu">自定义分类</strong>的例子，我们可以使用intensive的AutoML功能，并用我们自己的数据集对它们进行<strong class="lb iu">微调。在本文中，我们将采用一个示例<a class="ae ky" href="https://www.kaggle.com/datasets/team-ai/spam-text-message-classification" rel="noopener ugc nofollow" target="_blank">垃圾邮件数据集</a>，并使用intensive API来启动一个自定义分类训练任务。利用这一点，我们可以从我们训练过的理解模型中<strong class="lb iu">创建</strong>一个<strong class="lb iu">端点</strong>，它可以执行<strong class="lb iu">实时推理</strong>。</strong></strong></p><p id="dad1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong>:对于刚接触AWS的人来说，如果你想继续学习，请确保在下面的<a class="ae ky" href="https://aws.amazon.com/console/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">链接</strong> </a>中注册账户。培训和部署过程中会产生费用，尤其是在您的终端保持运行的情况下。本文还假设您对AWS和使用一个<a class="ae ky" href="https://aws.amazon.com/tools/" rel="noopener ugc nofollow" target="_blank"> AWS SDK </a>有基本的了解。</p><h2 id="363f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">设置</h2><p id="ee50" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">首先，我们将从以下Kaggle <a class="ae ky" href="https://www.kaggle.com/datasets/team-ai/spam-text-message-classification" rel="noopener ugc nofollow" target="_blank">链接</a>中提取样本数据集。您可以在任何环境中使用这个数据集，我将使用一个经典的<a class="ae ky" href="https://docs.aws.amazon.com/sagemaker/latest/dg/nbi.html" rel="noopener ugc nofollow" target="_blank"> SageMaker笔记本实例</a> (ml.c5.xlarge)来获得进一步的计算能力。您也可以在本地的Anaconda环境中工作，或者使用任何您喜欢的环境。</p><p id="6a2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们下载数据集，并使用<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>获得一些初步信息。对于训练数据，我们可以有两种类型的分类问题:<a class="ae ky" href="https://docs.aws.amazon.com/comprehend/latest/dg/prep-classifier-data-multi-class.html" rel="noopener ugc nofollow" target="_blank">多类</a>和<a class="ae ky" href="https://docs.aws.amazon.com/comprehend/latest/dg/prep-classifier-data-multi-label.html" rel="noopener ugc nofollow" target="_blank">多标签</a>模式。对于这个例子，我们有一个多类类型的问题，因为我们有两个类:垃圾邮件和火腿。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">读取数据集</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/95ddcadf7330d32a8b2c2ea4412668f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rz2ndDGDGTzmxYwpyMY3eQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">垃圾邮件数据集(作者截图)</p></figure><p id="698f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使用understand，我们将使用<a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/comprehend.html#comprehend" rel="noopener ugc nofollow" target="_blank"> Boto3 Python SDK </a>，你也可以使用AWS SDKs支持的任何语言。</p><p id="b3c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要注意的一些日常工作是<strong class="lb iu">上传</strong>数据集到<strong class="lb iu"> S3 </strong>并且确保<strong class="lb iu">理解</strong>有<strong class="lb iu">权限</strong>到S3进行模型训练。首先，我们创建一个S3存储桶，确保它有一个唯一的名称，然后我们可以将数据集上传到这个存储桶。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建存储桶并上传文件</p></figure><p id="83ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来转到IAM，确保为Comprehend创建一个附加了<strong class="lb iu">comprehension dataaccessrolepicy</strong>的角色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/1c5ca3bfff3fcd2892572131c56f11f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DWCZ2CIKtUpF5mAnzXNing.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">IAM角色理解(作者截图)</p></figure><p id="5531" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请确保掌握该角色的arn，因为稍后您将需要为模型培训提供它。</p><h2 id="5deb" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">模特培训</h2><p id="fa73" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">对于模型训练，我们首先需要创建一个<strong class="lb iu">文档分类器</strong>，它将为训练指定我们的训练数据位置。这将提交并启动一个培训作业。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建文档分类器</p></figure><p id="986a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着培训作业启动，我们可以监控其状态，直到它成功完成。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">跟踪培训状态</p></figure><p id="b65e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以在控制台中监控并看到该培训作业成功执行。此步骤可能需要30-60分钟，具体取决于数据集的大小、类/标注的数量以及其他因素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/dbd712b7053e0d0cef9de8bafa956a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*piNGIEqdoeXIrwEdFeTuYA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">培训工作(作者截图)</p></figure><p id="f619" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们还可以看到跟踪的不同指标，如准确性和F1得分。使用这个经过训练的文档分类器，我们可以获取作业arn，然后使用它直接部署到<strong class="lb iu">实时端点</strong>或进行<strong class="lb iu">批量推理</strong>。在这个例子中，我们将查看一个实时端点，但是可以在下面的链接中查看关于<a class="ae ky" href="https://docs.aws.amazon.com/comprehend/latest/dg/how-class-run.html" rel="noopener ugc nofollow" target="_blank">异步批处理作业</a>的文档。</p><h2 id="09bd" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">端点创建和调用</h2><p id="c58a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">为了创建端点，我们可以继续使用理解API。我们将首先获取经过训练的文档分类器arn，并将其输入到一个<a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/comprehend.html#Comprehend.Client.create_endpoint" rel="noopener ugc nofollow" target="_blank"> create_endpoint </a>调用中，我们可以对其进行监控，直到创建端点。这一步大约需要10-15分钟。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">端点创建</p></figure><p id="9a87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里需要注意的一个因素是参数<strong class="lb iu">杀菌单位</strong>，这是您可以调节<strong class="lb iu">生产量</strong>的旋钮。每个推理单元代表每秒100个字符的吞吐量，所以请确保选择一个足以满足您的用例的值。一旦端点处于状态，我们就可以获取一个样本数据点，并将其提供给端点进行推断。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/03c392d7580eea219bed00129a3aada7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kcSAEriSa2xX6MzuBOcuYA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自数据集的样本数据点(作者截图)</p></figure><p id="31f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/comprehend.html#Comprehend.Client.classify_document" rel="noopener ugc nofollow" target="_blank"> classify_document </a>调用，我们可以输入这个样本点进行推断。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">端点调用</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/7356c07439342bf5fbe5fdd1fd78705b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDDdv3f2qUjWAMvgjGAmfQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">推论(作者截图)</p></figure><p id="4026" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果不想让端点启动并运行，请确保使用以下调用删除端点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">删除端点</p></figure><h2 id="d6e5" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">其他资源和结论</h2><div class="na nb gp gr nc nd"><a href="https://github.com/RamVegiraju/aws-comprehend-custom-classifier" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd iu gy z fp ni fr fs nj fu fw is bi translated">GitHub-RamVegiraju/aws-领悟-定制-分类器:AWS领悟定制分类</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">github.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ks nd"/></div></div></a></div><p id="bd66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">整篇文章的代码请访问上面的链接。关于Amazon understand的更多示例/资源，请查看如何在没有任何代码的情况下直接在<a class="ae ky" href="https://docs.aws.amazon.com/comprehend/latest/dg/custom-sync.html" rel="noopener ugc nofollow" target="_blank"> AWS控制台</a>上重复整个过程。为了进一步理解代码示例，请查看这个<a class="ae ky" href="https://github.com/aws-samples/amazon-comprehend-examples" rel="noopener ugc nofollow" target="_blank"> AWS示例库</a>。</p><p id="ec5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章很好地介绍了AWS提供的核心AI/ML服务之一。在以后的文章中，我们将探索如何将这个服务与AWS ML堆栈中的其他服务集成在一起。</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><p id="f0f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nz">如果你喜欢这篇文章，请在</em><a class="ae ky" href="https://www.linkedin.com/in/ram-vegiraju-81272b162/" rel="noopener ugc nofollow" target="_blank"><em class="nz">LinkedIn</em></a><em class="nz">上与我联系，并订阅我的媒体</em> <a class="ae ky" href="https://ram-vegiraju.medium.com/subscribe" rel="noopener"> <em class="nz">简讯</em> </a> <em class="nz">。如果你是新手，使用我的</em> <a class="ae ky" href="https://ram-vegiraju.medium.com/membership" rel="noopener"> <em class="nz">会员推荐</em> </a> <em class="nz">报名。</em></p></div></div>    
</body>
</html>