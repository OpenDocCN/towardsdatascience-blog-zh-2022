<html>
<head>
<title>Z Test Statistics Formula &amp; Python Implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">z测试统计公式&amp; Python实现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/z-test-statistics-formula-python-implementation-3755d67ba0e7#2022-11-08">https://towardsdatascience.com/z-test-statistics-formula-python-implementation-3755d67ba0e7#2022-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ef89" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">公式、定义、示例和Python实现</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/51749f169697697ffb313aaf03b4fb19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K9BNb14YKPb2TRtk"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@popnzebra?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pop &amp;斑马</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h1 id="55d8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.目的</h1><p id="fbdd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对大致符合正态分布的数据(即未偏斜的数据)进行称为z检验的统计检验。z检验可用于检验两个样本甚至一个样本之间的比例差异，以评估假设。对于具有已知方差的总体，它确定两个广泛样本的平均值是否不同。根据我们对假设的选择，z检验可以分为左尾、右尾和双尾假设检验。虽然z-检验和t-检验相对相似，但下一节将介绍几个差异。</p><h2 id="30be" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">1.1定义Z检验</h2><p id="ad0b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果数据呈正态分布，并且您想检查两个总体的平均值是否不同，您可以应用z检验。为了验证上述说法，有必要制定零假设和替代假设，并计算z检验统计量的值。z临界值是选择标准的基础。</p><h1 id="1c57" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.范围</h1><ul class=""><li id="2541" class="mz na it lt b lu lv lx ly ma nb me nc mi nd mm ne nf ng nh bi translated">一种是对单个比例进行z检验，以检验涉及人口比例的假设。例如，我们记得2010年足球世界杯上的章鱼保罗。如果我们想测试保罗的成功率是否显著高于50%(即保罗的预测不是偶然的)，该怎么办？</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/f6e42bf402e6b003f5fa2ad259519ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6J7JVXGX0tYXd8ixY-Lplw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nj">图1。</strong>举例说明一个比例Z检验的Z统计量。作者使用Jupyter笔记本中的乳胶显影的图像。从上面的例子中，𝜃表示保罗在世界杯n场不同比赛中的成功预测，而𝜃o是假设的成功率，例如，50%。</p></figure><ul class=""><li id="dc28" class="mz na it lt b lu nk lx nl ma nm me nn mi no mm ne nf ng nh bi translated">使用Z检验法对两个群体具有相同比例的观点进行了比例差异检验。比如说，假设保罗有一个哥哥叫安吉尔，全世界都想知道安吉尔是否有和保罗一样的能力。因此，我们想对安吉尔进行另一个类似的实验，并检验安吉尔和保罗有同样能力的假设。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/b85fe3716fa09f4ea3fe928f6c4d18af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIX_pnnSN8IgYG35CzkUGw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nj">图2。</strong>说明两个比例Z检验的Z统计量。图像由作者在Jupyter笔记本中使用Latex开发。从上面的例子中，𝜃x象征着保罗在世界杯不同比赛中的成功预测，而𝜃y象征着安吉尔成功预测了多少场比赛。</p></figure><ul class=""><li id="c89a" class="mz na it lt b lu nk lx nl ma nm me nn mi no mm ne nf ng nh bi translated">如果要针对特定的总体平均值检验假设，请使用单个平均值的z检验。例如，在医疗保健行业，如果我们想要评估一段时间内产品的销售额，并检查一年的平均销售额是否与公司设定的目标有显著差异(更显著)，该怎么办？</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/55af5ea98a053b3b86a8984f99d1b5b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*DFqB20XE6cXmlB8YZRG_mQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nj">图3。</strong>说明了单样本Z检验的Z统计量。x代表样本均值，而μ是假设的甚至是总体均值，σ是总体标准差，n是样本大小。作者在Jupyter笔记本中使用Latex开发的图像。</p></figure><ul class=""><li id="4a3b" class="mz na it lt b lu nk lx nl ma nm me nn mi no mm ne nf ng nh bi translated">当数据中每个样本的样本量为30或更大时，Z检验可用于检验均值或方差的相等性，即检验两个总体均值相等的假设。例如，经常地，当在测试组和对照组上设计和运行活动时，我们希望了解测试组是否在特定结果变量上优于对照组。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/4af7fc3e10f8477399f0414ca2f8aaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:184/format:webp/0*h-c-c1sSU-MfwjoQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nj">图四。</strong>说明了双样本Z检验的Z统计量。其中x1和x2表示两个样本的均值(平均值)，或者在这种情况下，表示测试组和对照组的表现均值，δ是两个群体均值之间的假设差异(如果我们测试相等的均值，则为0，即两个群体的表现没有差异)，σ1和σ2是两个群体标准差的统计注释，以及测试和对照组的<em class="ns"> n </em> 1和<em class="ns"> n </em> 2样本量。</p></figure><h1 id="97cd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.假设</h1><p id="e572" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">z检验通常假设从中抽取样本的总体是正态分布的；然而，在样本量较大的情况下，人们可以忽略正态假设，尽管这样做是不可取的。理想情况下，对于涉及均值差异的检验，我们倾向于仅在样本量大于30时进行z检验。</p><h1 id="90c6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.t检验与Z检验</h1><p id="3507" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">z-检验比t-检验更实用，t-检验对每个样本量有不同的临界值，而z-检验对每个显著性水平有一个临界值(例如，5%双尾的临界值为1.96)。因此，对于大样本量和已知的总体方差，许多统计检验可以很容易地作为近似z检验来进行。学生t检验可能更适合未知总体方差(必须使用样本本身进行近似计算)和样本量较小时。当样本量很小时，通常采用t检验；然而，当样本量很大或相当大时，在已知标准偏差的情况下，z检验是优选的。</p><h1 id="337d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5.方法学</h1><h2 id="a29c" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">5.1一个比例的Z检验</h2><h2 id="5e56" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">问题陈述</h2><p id="b3db" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们考虑一下，公司A已经推出了一个新的网页布局，以支持在一个国家推出RAT测试套件。这是一个设计实验，随机向30名经常看流感产品的顾客展开。该网页是一个登录页面，目前包含购买不同COVID测试套件的链接。该倡议允许人们更多地了解COVID协议，并在访问测试中心之前获得必要的家庭测试支持。亚马逊希望检查新的布局是否可以将点击率提高40%的特定幅度。</p><p id="4e38" class="pw-post-body-paragraph lr ls it lt b lu nk ju lw lx nl jx lz ma nt mc md me nu mg mh mi nv mk ml mm im bi translated"><strong class="lt iu">零假设(h₀):</strong>)𝐻𝑜=受访者样本比例(点击新登陆页面的用户)小于40% 𝑃 &lt; =0.40 (40%)</p><p id="6b3a" class="pw-post-body-paragraph lr ls it lt b lu nk ju lw lx nl jx lz ma nt mc md me nu mg mh mi nv mk ml mm im bi translated"><strong class="lt iu">替代假设(H₁): </strong> 𝐻𝑎 =样本受访者比例(来自新登陆页面的用户点击量)大于40% 𝑃 &gt; 0.40 (40%)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/2466ecc1d2d6df485723c81ca4874532.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwIVjV3gCxEB77Hoflq2dQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nj">图1: </strong>显示了单尾与双尾测试的剔除区域。假设我们的替代假设检查点击率大于40%，我们将执行右尾测试。代替在这个用例中考虑μ，我们将检查𝜃 &gt;是否是一个值。作者创造的形象。</p></figure><h2 id="d7b2" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">5.1.2计算</h2><p id="a68e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">考虑到接触到新登录页面的30个客户中，有17个使用/点击了指向RAT测试套件的链接。使用下面列出的公式对一个比例进行z检验。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/c61474f1d417a96fbf9e628d2ff04e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dzSIm-jZamqckgQHFwhxng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nj">图5。</strong>概述了比例的Z检验的计算。作者使用Latex和Markdown (Jupyter Notebook)准备的图像。</p></figure><h2 id="e0f9" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">5.1.3结论</h2><div class="ny nz gp gr oa ob"><a href="https://www.ztable.net/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">Z工作台- Z工作台</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">负Z得分表使用下面的负Z得分表查找平均值左侧的值，如所示…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">www.ztable.net</p></div></div><div class="ok l"><div class="ol l om on oo ok op ks ob"/></div></div></a></div><p id="3c6f" class="pw-post-body-paragraph lr ls it lt b lu nk ju lw lx nl jx lz ma nt mc md me nu mg mh mi nv mk ml mm im bi translated">使用上面链接中的Z得分表，让我们确定获得Z得分&lt; =1.88的概率，如图1所示。</p><p id="5640" class="pw-post-body-paragraph lr ls it lt b lu nk ju lw lx nl jx lz ma nt mc md me nu mg mh mi nv mk ml mm im bi translated">𝑃(𝑧≤1.88)=0.96995.但是我们想要计算Z右侧的概率(因为我们感兴趣的是获得落在拒绝区域或临界区域的概率值)，即1–0.96995 = 0.030051–0.96995 = 0.03005。</p><p id="e389" class="pw-post-body-paragraph lr ls it lt b lu nk ju lw lx nl jx lz ma nt mc md me nu mg mh mi nv mk ml mm im bi translated">我们拒绝零假设，支持替代假设，即公司A通过更新登录页面，在95%的置信度下，从p&lt;0.05开始，设法将点击率提高了至少40%。</p><h2 id="3057" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">Python实现</h2><pre class="kj kk kl km gt oq or os ot aw ou bi"><span id="7223" class="mn la it or b gy ov ow l ox oy">#-------------import required library from statsmodel</span><span id="48e6" class="mn la it or b gy oz ow l ox oy"><strong class="or iu">from</strong> <!-- -->statsmodels.stats.proportion <strong class="or iu">import</strong> <!-- -->proportions_ztest</span><span id="afdf" class="mn la it or b gy oz ow l ox oy">#--------perform a one proportion z-test using the invoked function<br/>#----count = number of successful click through rates (17)<br/>#-----nobs = number of observation (customer exposed to the new landing page)</span><span id="0507" class="mn la it or b gy oz ow l ox oy">#-----value: Hypothesized difference (in this atleast 40% click through rate)</span><span id="8703" class="mn la it or b gy oz ow l ox oy">proportions_ztest(count<strong class="or iu">=17</strong>, nobs<strong class="or iu">=30</strong>, value<strong class="or iu">=</strong>0.40)</span><span id="81c8" class="mn la it or b gy oz ow l ox oy">(1.8421903154590296, 0.03272365827054635)</span></pre><p id="bbf5" class="pw-post-body-paragraph lr ls it lt b lu nk ju lw lx nl jx lz ma nt mc md me nu mg mh mi nv mk ml mm im bi translated">请注意，由于四舍五入的原因，Z统计值可能不同于实际操作示例。</p><h2 id="3dc7" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">5.2均值差异的Z检验</h2><h2 id="71d3" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">问题陈述</h2><p id="7ca0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们考虑一下，一家制药公司对一群医生开展了一项数字活动，以推广一种针对不同适应症的新上市药物。该团队为这项实验设计(推广活动)确定了一组医生，并跟踪了这些医生在活动前后的表现。医生的表现取决于开了这种新药的病人数量。我们想核实这场运动是否促使医生让更多的病人服用这种新药。</p><h2 id="08c9" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">计算和方法</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/cd18f56adad60f5f8761fcdbf1701ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8kA6-cu48EcpuKxP6MuQ-g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/eadc12c87fb481252b62a472744795bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h0YWC5tpbueu5aSEFDh-NA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nj">图6。</strong>概述了均值差异的Z检验的计算。作者使用Latex和Markdown (Jupyter Notebook)准备的图像。</p></figure><h2 id="6fa3" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">Python实现</h2><pre class="kj kk kl km gt oq or os ot aw ou bi"><span id="3c50" class="mn la it or b gy ov ow l ox oy">from scipy import stats</span><span id="fab2" class="mn la it or b gy oz ow l ox oy">test_stat, p_value  = stats.ttest_rel(data['New Patient Count'], df['Old Patient Count'], alternative = 'greater')  #Performing a paired t-test</span><span id="cfd8" class="mn la it or b gy oz ow l ox oy">print('The p-value is', p_value)</span></pre><h1 id="c900" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">6.结论</h1><p id="25d7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">问题陈述主要驱动假设检验技术的选择。当进行基于试验控制的分析时，我们会看到一个连续的结果(例如，推广活动前后的患者人数)，均值差异的Z检验允许我们验证差异。我们可以在影响前和影响后进行测量，甚至在测试组和控制组之间进行测量，以精确地确定计划对测试组的影响，以及该计划是否能在不受其他变量影响的情况下做出更好的响应。后COVID时代，公司正专注于理解数字渠道相对于其他目标渠道的影响。对于我们的结果变量是二元的情况，我们可以使用比例检验的Z检验来查看结果的差异。</p></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><p id="c63d" class="pw-post-body-paragraph lr ls it lt b lu nk ju lw lx nl jx lz ma nt mc md me nu mg mh mi nv mk ml mm im bi translated"><em class="pj">关于作者:高级分析专家和管理顾问，帮助公司通过对组织数据的商业、技术和数学的组合找到各种问题的解决方案。一个数据科学爱好者，在这里分享、学习、贡献；你可以和我在</em> <a class="ae ky" href="https://www.linkedin.com/in/angel-das-9532bb12a/" rel="noopener ugc nofollow" target="_blank"> <em class="pj">上联系</em> </a> <em class="pj">和</em> <a class="ae ky" href="https://twitter.com/dasangel07_andy" rel="noopener ugc nofollow" target="_blank"> <em class="pj">上推特</em></a><em class="pj">；</em></p></div></div>    
</body>
</html>