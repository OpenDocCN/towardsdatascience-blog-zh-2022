<html>
<head>
<title>6 Ways to Encode Features for Machine Learning Algorithms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习算法的6种特征编码方式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/6-ways-to-encode-features-for-machine-learning-algorithms-21593f6238b0#2022-06-01">https://towardsdatascience.com/6-ways-to-encode-features-for-machine-learning-algorithms-21593f6238b0#2022-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ea21" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将分类变量编码成数字</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/af46b24ead8dd3d05ea69f38ead75de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8oPjBKau_dA_NDhR"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@popnzebra?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">波普&amp;斑马</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">挡泥板</a>上拍摄</p></figure><p id="fde8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习算法需要能够理解它接收的数据。例如，“小”、“中”、“大”等类别需要转换成数字。为了解决这个问题，我们可以将它们转换成数字标签，其中“1”代表小号，“2”代表中号，“3”代表大号。</p><p id="ad73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但这真的是最好的方法吗？</p><p id="060b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将分类变量编码成数字的方法有很多，每种方法都有自己的优缺点。</p><p id="88ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了发现它们，我们将看到以下编码分类变量的方法:</p><ol class=""><li id="77e9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">独热/虚拟编码</li><li id="4af6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">标签/序数编码</li><li id="b12b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">目标编码</li><li id="3cde" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">频率/计数编码</li><li id="a497" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">二进制编码</li><li id="5353" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">特征散列</li></ol><p id="02a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将用一个非常简单的数据框架来说明这些概念:一个NBA顶级球员的玩具数据集，以及他们在过去比赛中通过罚球获得的分数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/d3d869d0f4732d25618a75c51b144a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vAAxgoQJxzYE3NHpPixHIQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">说明特征编码概念的玩具数据集(图片由作者提供)</p></figure><p id="f003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还推荐使用<a class="ae ky" href="https://github.com/scikit-learn-contrib/category_encoders" rel="noopener ugc nofollow" target="_blank">这个python库</a>将分类变量编码成数字:</p><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="236f" class="mp mq it ml b gy mr ms l mt mu">pip install category_encoders</span></pre><p id="8eb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在进一步挖掘之前，我们需要澄清一些概念:</p><ul class=""><li id="c8cd" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mv mb mc md bi translated"><strong class="lb iu">名义变量</strong>是没有固有顺序的变量。它们只是可以相互区分的类别。</li><li id="6563" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mv mb mc md bi translated"><strong class="lb iu">序数变量</strong>有一个固有的顺序。它们可以从最高到最低排列，反之亦然。</li><li id="726d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mv mb mc md bi translated"><strong class="lb iu">无监督</strong> <strong class="lb iu">编码方法</strong>不利用目标变量对分类变量进行编码(例如，用一个公式对球员姓名进行编码，该公式计算他们得分)。</li><li id="c8ee" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mv mb mc md bi translated"><strong class="lb iu">监督编码方法</strong>使用目标变量对分类变量进行编码。</li><li id="56ca" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mv mb mc md bi translated"><strong class="lb iu">分类变量</strong>的“基数”代表该变量所代表的类别数。</li><li id="e2e1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mv mb mc md bi translated"><strong class="lb iu">当一个变量用于训练但在推理时不可用时，目标泄漏</strong>发生<strong class="lb iu"> </strong>。</li></ul><h1 id="0c8e" class="mw mq it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">独热/虚拟编码</h1><p id="a05e" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">在一键编码中，分类数据被表示为0和1的向量。这是通过为每个类别使用单独的虚拟变量来实现的，如果观察值属于该类别，则将虚拟变量的值设置为1，否则设置为0。</p><p id="1184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果有三个类别，每个类别可以表示为一个零向量，在对应于该类别的位置有一个1。</p><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="fd22" class="mp mq it ml b gy mr ms l mt mu">from category_encoder import OneHotEncoder<br/>OneHotEncoder(cols=['player']).fit(df).transform(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/5d1d9ac707b58e8b8db17a240ebceb99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QtQRJqewIcwc__C-qkKiHA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">玩具数据集上的一键编码(图片由作者提供)</p></figure><h1 id="8bd6" class="mw mq it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">标签/序数编码</h1><p id="a4f4" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">这可能是为机器学习算法编码特征的最简单的方式。在这种方法中，分类数据被转换成数字数据。每个类别都有一个数值。</p><p id="d5dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过我们的玩具数据集，我们可以随机给玩家分配数字，比如斯蒂芬·库里“1”，安东尼·爱德华兹“2”，杜灿·罗宾逊“3”。</p><p id="9d66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是如果我们需要对序数变量进行编码呢？</p><p id="ee39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们可以为每个玩家手动定义映射。假设我们考虑一个订单，如斯蒂芬·库里</p><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="4f91" class="mp mq it ml b gy mr ms l mt mu">from category_encoder import OrdinalEncoder</span><span id="034c" class="mp mq it ml b gy nt ms l mt mu">mapping = [{'col': 'player', 'mapping': {"Stephen Curry": 1,  "Duncan Robinson": 2, "Anthony Edwards": 3}}]</span><span id="7282" class="mp mq it ml b gy nt ms l mt mu">OrdinalEncoder(cols=['player'], mapping=mapping).fit(df).transform(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/354591487b92e1aa66891cb687346b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3MY3oU5fgfgko-iwROOJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">玩具数据集上的标签编码(图片由作者提供)</p></figure><h1 id="ba94" class="mw mq it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">目标编码</h1><p id="3540" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">目标编码是一种通过使用目标值对特征的分类值进行编码的技术。这种技术背后的思想是，如果特征是目标的良好预测器，那么它的值应该更接近目标。</p><ul class=""><li id="7fe3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mv mb mc md bi translated">目标均值编码:我们用目标值的均值替换类别。这种方法通常与平滑一起使用，以避免目标泄漏。</li><li id="bd9d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu mv mb mc md bi translated">留一编码:这种方法与目标均值编码非常相似，但不同之处在于，在留一编码中，我们取除了我们要预测的样本之外的所有样本的目标值的均值。</li></ul><p id="a689" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，留一编码如下所示:</p><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="9bc5" class="mp mq it ml b gy mr ms l mt mu">from category_encoder import TargetEncoder<br/>TargetEncoder(cols=['player'], smoothing=1.0).fit(df, df['point']).transform(df)</span><span id="2275" class="mp mq it ml b gy nt ms l mt mu">from category_encoder import LeaveOneOutEncoder<br/>LeaveOneOutEncoder(cols=['player']).fit(df, df['point']).transform(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/3d3cdd55b584b3d9afc93745421aefe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*81oYyNXud3nzNPLZma9RMQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">玩具数据集上的目标均值编码(图片由作者提供)</p></figure><h1 id="15be" class="mw mq it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">频率/计数编码</h1><p id="5a2c" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">计数编码是一种使用类别计数来表示分类数据的方法。频率编码只是计数编码的标准化版本。</p><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="e265" class="mp mq it ml b gy mr ms l mt mu">from category_encoder import CountEncoder<br/>CountEncoder(cols=['player']).fit(df).transform(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/2f1d345bd6af49ac8d23a779ffb10faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OmVfD3dh0QqlK-cv4OR6jg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">玩具数据集上的计数编码(图片由作者提供)</p></figure><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="0de7" class="mp mq it ml b gy mr ms l mt mu">from category_encoder import CountEncoder<br/>CountEncoder(cols=['player'], normalize=True).fit(df).transform(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/4609ec2e131675260a21abce1143f247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QT3Vabt1zjquVFFtoD7tvw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">玩具数据集上的频率编码(图片由作者提供)</p></figure><h1 id="bbd2" class="mw mq it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">二进制编码</h1><p id="4813" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">二进制编码是一种通过将类别编码为整数，然后将其转换为二进制代码，从而将分类数据转换为数字数据的技术。</p><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="6ae4" class="mp mq it ml b gy mr ms l mt mu">from category_encoder import BinaryEncoder<br/>BinaryEncoder(cols=['player']).fit(df).transform(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/f8974f2a2659399854400fbfb529120e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w9ge8unAj2PSSHlpCqAKAQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">玩具数据集上的二进制编码(图片由作者提供)</p></figure><h1 id="9c0b" class="mw mq it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">特征散列</h1><p id="596a" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">特征散列是一种使用固定大小的数组在高维空间中表示数据的方式。这是通过在散列函数的帮助下对分类变量进行编码来实现的。</p><pre class="kj kk kl km gt mk ml mm mn aw mo bi"><span id="4432" class="mp mq it ml b gy mr ms l mt mu">from category_encoder import HashingEncoder<br/>HashingEncoder(cols=['player']).fit(df).transform(df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/a7d417ad52a40f9ac95fbe72c3ece6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wptBYW2w4_gtOGMAlMUcIw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">玩具数据集上的特征散列(图片由作者提供)</p></figure><h1 id="ee8d" class="mw mq it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">结论</h1><p id="20c7" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">那么，你应该用哪一个呢？</p><p id="878f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这取决于数据集、模型和您试图优化的性能指标。一般来说，一键编码是名义变量最常用的方法。它易于理解和实现，并且适用于大多数机器学习模型。为了对抗维数灾难，二进制编码可能是一个好的选择，因为它在编码分类变量时创建的列更少。</p><p id="0d34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果分类变量的顺序很重要，序数编码是一个很好的选择。例如，如果我们预测一所房子的价格，标签“小”、“中”和“大”将意味着小房子比中房子便宜，中房子比大房子便宜。标签很容易反转，不会增加数据的维度。</p><p id="3f3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，目标编码是受监督的编码器，其捕获关于标签和潜在预测特征的信息。这种编码器不会增加特征空间的维数，但是会导致过拟合，并且容易出现目标泄漏。</p><p id="ffd2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">频率和计数编码器也是监督方法，不会增加特征空间的维度。然而，这些方法只能在计数引用目标变量时使用，否则，所有具有相似基数的类别都将被同样计数。</p><p id="1164" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当基数非常高时，<strong class="lb iu"> </strong>特性散列是处理分类变量的好方法，因为它计算速度快，并且在添加类别时大小不会增长。</p><p id="b904" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了更深入地研究这个主题，我建议阅读以下有趣的文章:</p><ul class=""><li id="fe98" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mv mb mc md bi translated">哈希技巧</li></ul><div class="oa ob gp gr oc od"><a href="https://booking.ai/dont-be-tricked-by-the-hashing-trick-192a6aae3087" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">不要被哈希技巧所欺骗</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">在机器学习中，哈希技巧是一种对分类特征进行编码的技术。它越来越受欢迎…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">booking.ai</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><ul class=""><li id="47e8" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mv mb mc md bi translated">光谱编码</li></ul><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/spectral-encoding-of-categorical-features-b4faebdf4a"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">分类特征的光谱编码</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">另一种实现实体嵌入的方法</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="os l oo op oq om or ks od"/></div></div></a></div></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><p id="9197" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好奇想了解更多关于Anthony的工作和项目吗？在<a class="ae ky" href="https://medium.com/@anthonycvn" rel="noopener">中</a>、<a class="ae ky" href="https://www.linkedin.com/in/anthonycavin/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://twitter.com/Anthony66333223" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注他。</p><p id="c776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pa">需要技术写手？将您的请求发送到</em><a class="ae ky" href="https://amigocci.io/blog/mlops-at-medium-scale/" rel="noopener ugc nofollow" target="_blank"><em class="pa">https://amigo CCI . io</em></a><em class="pa">。</em></p></div></div>    
</body>
</html>