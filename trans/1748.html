<html>
<head>
<title>How to Run a Data Science Project in a Docker Container</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Docker容器中运行数据科学项目</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-run-a-data-science-project-in-a-docker-container-2ab1a3baa889#2022-04-25">https://towardsdatascience.com/how-to-run-a-data-science-project-in-a-docker-container-2ab1a3baa889#2022-04-25</a></blockquote><div><div class="fc ik il im in io"/><div class="ip iq ir is it"><h2 id="e288" class="iu iv iw bd b dl ix iy iz ja jb jc dk jd translated" aria-label="kicker paragraph">环境设置</h2><div class=""/><div class=""><h2 id="d397" class="pw-subtitle-paragraph kc jf iw bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">关于如何将您的数据科学项目包装在Docker映像中并在Docker容器中运行它的一些技巧和实际示例</h2></div><figure class="kv kw kx ky gu kz gi gj paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gi gj ku"><img src="../Images/aee32e0527e896d5e18dd541bec161a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E7tvA4GxYuL8kCnA"/></div></div><p class="lg lh gk gi gj li lj bd b be z dk translated"><a class="ae lk" href="https://unsplash.com/@carrier_lost?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">伊恩·泰勒</a>在<a class="ae lk" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="0109" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">为数据科学项目编写代码时，它应该尽可能具有可移植性，也就是说，即使在不同的机器上，它也可以被执行任意多次。</p><p id="f057" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><strong class="ln jg">在建模和测试阶段，数据科学项目在您的机器上正常工作，但在运行时出错的情况经常发生。</strong></p><p id="5c63" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">这可能是由于例如主机上安装的不同版本的库和软件。</p><p id="5cc1" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">为了应对这个问题，你可以使用<strong class="ln jg">虚拟机</strong>，它们构成了一个隔离独立的环境，允许你执行代码。然而，<strong class="ln jg">虚拟机有一个问题，它们托管整个操作系统</strong>，这通常会占用几千兆字节的存储空间。</p><p id="17f6" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">因此，最好使用更轻便的系统来构建独立的应用程序。</p><p id="0ef5" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在本文中，我描述了Docker平台的概况，它允许您通过一点点努力来构建独立的应用程序。另外我给你提供一个实际的例子，把一个数据科学项目变成Docker镜像。</p><p id="9bec" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">文章组织如下:</p><ul class=""><li id="aca8" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">Docker入门</li><li id="1753" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">Docker项目的结构</li><li id="5ae5" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">构建和运行Docker映像</li><li id="a209" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">实际例子。</li></ul><h1 id="61db" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">Docker入门</h1><p id="2168" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">Docker是一个允许你构建、运行和管理独立应用的平台。其思想是构建一个应用程序，不仅包含编写的代码，还包含执行代码的所有上下文，比如库、环境变量等等。</p><p id="e02e" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">当您用所有上下文包装您的应用程序时，您构建了一个<strong class="ln jg"> Docker映像</strong>，它可以保存在您的本地存储库中或公共Docker存储库中，也称为<a class="ae lk" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>。</p><p id="7a74" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">如果你想运行你的Docker镜像，你需要为它创建一个<strong class="ln jg"> Docker容器</strong>。如果可以为同一个映像创建多个容器，那么可以多次运行同一个Docker映像。</p><p id="5f7c" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">要开始使用Docker，可以从<a class="ae lk" href="https://www.docker.com/products/docker-desktop/" rel="noopener ugc nofollow" target="_blank">这个链接</a>下载。根据您的操作系统，您将下载不同的安装程序。</p><p id="9bcb" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">安装后，您可以运行应用程序或使用命令行实用程序。</p><p id="d290" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">Docker由以下组件组成:</p><ul class=""><li id="cb94" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated"><strong class="ln jg"> Docker引擎</strong> —用于构建、运行和管理Docker映像和容器的本地平台</li><li id="eb82" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated"><strong class="ln jg"> Docker Hub </strong> —所有公共和私有Docker映像的存储库</li><li id="ffba" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated"><strong class="ln jg"> Docker客户端</strong> —与Docker引擎交互的客户端。它可以是命令行工具，也可以是使用Docker引擎提供的REST APIs的对象。</li></ul><h1 id="78a3" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">2 Docker项目的结构</h1><p id="f731" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">要构建Docker映像，您至少应该定义两个元素:</p><ul class=""><li id="4d3a" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">你的申请</li><li id="e45e" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">一份文件</li></ul><p id="e29d" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">该应用程序可以是您的数据科学项目。在本文中，您将看到Python中的一个例子，因此您应该添加另一个名为<code class="fe ns nt nu nv b">requirements.txt</code>的文件，它包含您的应用程序所使用的Python包的列表。</p><h2 id="f017" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">2.1文档文件</h2><p id="5f06" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">Docker文件是Docker用来构建独立应用程序的文件。你可以在<a class="ae lk" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank">这个链接</a>找到Dockerfile的完整文档。</p><p id="2208" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">下面这段代码显示了docker文件的基本结构:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="7d39" class="nw mw iw nv b gz ol om l on oo">FROM &lt;BASE_IMAGE&gt;<br/>COPY &lt;SRC&gt; &lt;DTS<br/>RUN &lt;COMMANDS_AT_BUILD_TIME&gt;<br/>CMD &lt;ENTRY_COMMANDS_AT_RUNTIME&gt;</span></pre><p id="fb46" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">FROM</code>指令包含Docker构建应用程序的基础映像。例如，基本映像可以是特定的操作系统。要选择最适合您的观测范围的基础图像，您应该注意图像大小以及您的应用程序所需的软件包和软件。比如你只需要Python，你可以选择一个slim版本的Python作为基础镜像。你可以在<a class="ae lk" href="https://hub.docker.com/_/python" rel="noopener ugc nofollow" target="_blank">这个链接</a>找到官方Python图片列表。</p><p id="c8ef" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">COPY</code>指令复制Docker映像中的源文件。典型的<code class="fe ns nt nu nv b">COPY</code>语句是:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="e885" class="nw mw iw nv b gz ol om l on oo">COPY . .</span></pre><p id="7e57" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">它将文件系统的当前目录中包含的所有文件复制到Docker映像的当前目录中。</p><p id="6928" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">RUN</code>指令在构建过程中运行指定为参数的命令。例如，在<code class="fe ns nt nu nv b">RUN</code>指令下，您可以安装项目所需的所有Python库，如下所示:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="735d" class="nw mw iw nv b gz ol om l on oo">RUN pip install --no-cache-dir -r requirements.txt</span></pre><p id="e0cd" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">在前面的代码中，<code class="fe ns nt nu nv b">requirements.txt</code>文件包含要安装的所有包的列表，每行一个。</p><p id="33b7" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">CMD</code>指令指定运行应用程序时要执行的命令。在Python项目中，CMD指令应该指定用于运行主应用程序的命令:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="4ccc" class="nw mw iw nv b gz ol om l on oo">CMD ["python", "./app.py"]</span></pre><h2 id="970f" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">2.2要求. txt</h2><p id="69e1" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">如前所述，该文件包含要安装的Python包的列表，每行一个，如下面的代码所示:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="e6f3" class="nw mw iw nv b gz ol om l on oo">numpy<br/>pandas<br/>scikit-learn</span></pre><h1 id="e22d" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">3.构建和运行Docker映像</h1><p id="a2b4" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">在本节中，您将看到:</p><ul class=""><li id="ee60" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">如何建立码头工人形象</li><li id="08bf" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">如何运行Docker映像</li><li id="b4d1" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">如何将Docker图像保存到Docker Hub</li><li id="5c3f" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">从Docker Hub获取Docker图像</li></ul><h2 id="a128" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">3.1建立码头工人形象</h2><p id="7737" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">要为您的数据科学项目构建Docker映像，您应该输入包含您的项目的目录，然后从终端运行以下命令:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="44ac" class="nw mw iw nv b gz ol om l on oo">docker build -t &lt;IMAGE_NAME&gt; .</span></pre><p id="eff1" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">最后一个点(<code class="fe ns nt nu nv b">.</code>)表示包含您的应用程序的当前目录。</p><p id="0c93" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">一旦构建了Docker映像，就可以通过编写以下命令来检查它的可用性:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="d631" class="nw mw iw nv b gz ol om l on oo">docker images</span></pre><p id="72f8" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">作为输出，前面的命令显示了本地存储库中所有可用的Docker图像。</p><h2 id="942d" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">3.2运行Docker映像</h2><p id="41bf" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">要运行Docker映像，您应该告诉Docker引擎为它构建一个容器。您可以从文件系统中的任何地方运行以下命令:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="ed21" class="nw mw iw nv b gz ol om l on oo">docker run -rm --name &lt;CONTAINER_NAME&gt; &lt;IMAGE_NAME&gt;</span></pre><p id="f208" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">-rm</code>参数告诉Docker引擎在停止运行时删除容器。</p><h2 id="64ee" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">3.3将Docker映像保存到Docker Hub</h2><p id="66df" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">Docker Hub是Docker图像的注册表。它包含私有和公共图像。要将Docker图像保存到Docker Hub，您首先需要在<a class="ae lk" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank">这个链接</a>创建一个账户。</p><p id="33bf" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">创建帐户后，您可以从命令行登录，如下所示:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="5e8c" class="nw mw iw nv b gz ol om l on oo">docker login</span></pre><p id="2ec1" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">系统要求您输入用户名和密码。输入密码后，您就可以登录到您的远程存储库。</p><p id="5de0" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">要将Docker映像添加到Docker Hub，您需要将至少一个标记添加到您的Docker映像，如下面这段代码所示:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="6f28" class="nw mw iw nv b gz ol om l on oo">docker -tag &lt;MY_LOCAL_IMAGE&gt; &lt;MY_LOCAL_IMAGE&gt;:&lt;MY_TAG&gt;</span></pre><p id="1369" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">以及您的远程映像:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="8d85" class="nw mw iw nv b gz ol om l on oo">docker tag &lt;MY_LOCAL_IMAGE&gt;:&lt;MY_TAG&gt; &lt;MY_ACCOUNT&gt;/&lt;MY_LOCAL_IMAGE&gt;:&lt;MY_TAG&gt;</span></pre><p id="cb71" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">然后，您可以将本地映像推送到Docker Hub:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="94b2" class="nw mw iw nv b gz ol om l on oo">docker push &lt;MY_ACCOUNT&gt;/&lt;MY_LOCAL_IMAGE&gt;:&lt;MY_TAG&gt;</span></pre><h2 id="3149" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">3.4从Docker Hub获取Docker映像</h2><p id="78a8" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">要从Docker Hub获取Docker映像，只需运行以下命令:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="f32b" class="nw mw iw nv b gz ol om l on oo">docker pull &lt;MY_ACCOUNT&gt;/&lt;MY_LOCAL_IMAGE&gt;</span></pre><h1 id="b955" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">4一个实际例子</h1><p id="11ff" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">作为一个实际的例子，我们可以为我在<a class="ae lk" rel="noopener" target="_blank" href="/a-complete-data-analysis-workflow-in-python-and-scikit-learn-9a77f7c283d3">上一篇文章</a>中描述的例子构建一个Docker映像。该项目在三种不同的条件下计算K-最近邻分类器的ROC和精确召回曲线:</p><ul class=""><li id="28b3" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">不平衡数据集</li><li id="551c" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">过采样数据集</li><li id="6aff" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">欠采样数据集。</li></ul><p id="a2d5" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">这个例子的目的是将描述的应用程序包装到Docker映像中，并将生成的图形保存在当前目录中。关于项目代码的更多细节，可以参考<a class="ae lk" rel="noopener" target="_blank" href="/a-complete-data-analysis-workflow-in-python-and-scikit-learn-9a77f7c283d3">我之前的文章</a>。</p><p id="976f" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">你可以从我的<a class="ae lk" href="https://github.com/alod83/data-science/blob/master/DataAnalysis/Data%20Analysis.ipynb" rel="noopener ugc nofollow" target="_blank"> Github库</a>下载该项目的原始代码。</p><h2 id="376f" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">4.1设置</h2><p id="3615" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">您可以按照下面描述的步骤将示例转换为Docker图像:</p><ul class=""><li id="7484" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">由于原始代码是用Jupyter编写的，首先，您需要<strong class="ln jg">将其下载为Python脚本</strong>。简单地说，您可以访问Jupyter中的文件菜单，并选择下载Python脚本。</li><li id="db04" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">然后，您可以创建一个新目录，其中应该包含所有项目，包括源数据集。在我们的示例中，源数据集位于<code class="fe ns nt nu nv b">source</code>目录下，因此您可以将其复制到当前目录。</li><li id="a11e" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">将下载的脚本重命名为app.py，打开，将所有出现的<code class="fe ns nt nu nv b">plt.show()</code>替换为<code class="fe ns nt nu nv b">plt.savefig(f”{images_dir}/roc.png”)</code>，其中<code class="fe ns nt nu nv b">image_dir</code>是包含输出目录名的变量，比如<code class="fe ns nt nu nv b">images</code>。</li><li id="63b0" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">现在，您可以创建<code class="fe ns nt nu nv b">requirements.tx</code> t文件，它应该包含所有需要的库:</li></ul><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="ddbc" class="nw mw iw nv b gz ol om l on oo">numpy<br/>pandas<br/>scikit-learn<br/>imblearn<br/>matplotlib<br/>scikit-plot</span></pre><ul class=""><li id="7232" class="mh mi iw ln b lo lp lr ls lu mj ly mk mc ml mg mm mn mo mp bi translated">您可以按如下方式创建Dockerfile文件:</li></ul><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="073e" class="nw mw iw nv b gz ol om l on oo">FROM python:slim<br/>WORKDIR /app_home<br/>COPY . .<br/>RUN pip install --no-cache-dir -r requirements.txt<br/>CMD ["python", "./app.py"]</span></pre><p id="71fd" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">FROM</code>指令指定使用Python的精简版本，因此生成的图像不会占用太多存储空间。</p><p id="7a48" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">WORKDIR</code>指令定义了Docker映像中的当前目录。</p><p id="05be" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">COPY</code>指令将文件系统中我们目录的内容复制到Docker映像中的工作目录。</p><p id="ce8f" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">RUN</code>指令安装所有的Python库。</p><p id="a0d4" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated"><code class="fe ns nt nu nv b">CMD</code>指令定义当Docker运行容器中的图像时运行哪个应用程序。</p><h2 id="3b33" class="nw mw iw bd mx nx ny dn nb nz oa dp nf lu ob oc nh ly od oe nj mc of og nl jc bi translated">4.2构建和运行Docker映像</h2><p id="21f7" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">现在，从当前目录，您可以通过以下命令构建映像:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="3e98" class="nw mw iw nv b gz ol om l on oo">docker build -t test-model .</span></pre><p id="30a7" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">您可以通过以下命令运行它:</p><pre class="kv kw kx ky gu oh nv oi oj aw ok bi"><span id="f22a" class="nw mw iw nv b gz ol om l on oo">docker run --rm -v `pwd`:/app_home test-model</span></pre><p id="a233" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">注意，我们已经使用了<code class="fe ns nt nu nv b"> -v</code>参数来映射文件系统中的当前目录(由<code class="fe ns nt nu nv b">pwd</code>指定)和Docker映像中的<code class="fe ns nt nu nv b">app_home</code>目录。这允许我们访问应用程序生成的图表。</p><h1 id="72dc" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">摘要</h1><p id="6882" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">恭喜你！您刚刚学习了如何将您的数据科学项目转换为Docker映像！该程序非常简单，并且产生可移植的软件，该软件也可以在不同于你的机器上使用！</p><p id="c0db" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">您可以从我的<a class="ae lk" href="https://github.com/alod83/data-science/tree/master/EnvironmentSetup/Docker" rel="noopener ugc nofollow" target="_blank"> Github资源库</a>下载本教程中使用的代码。</p><p id="9e59" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">如果你读到这里，对我来说，今天已经很多了。谢谢！你可以在<a class="ae lk" href="https://alod83.medium.com/my-most-trending-articles-4fbfbe107fb" rel="noopener">这个链接</a>阅读我的趋势文章。</p><h1 id="b835" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">相关文章</h1><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/how-to-convert-your-python-project-into-a-package-installable-through-pip-a2b36e8ace10"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd jg gz z fq ox fs ft oy fv fx jf bi translated">如何将您的Python项目转换成可通过pip安装的包</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">一个带有现成模板的教程，描述了如何将Python项目转换成包，该包可在…</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg le os"/></div></div></a></div><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/three-tricks-on-python-functions-that-you-should-know-e6badb26aac2"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd jg gz z fq ox fs ft oy fv fx jf bi translated">你应该知道的关于Python函数的三个技巧</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">快速概述一些可以提高你编程技能的技巧:嵌套函数、可变参数和</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg le os"/></div></div></a></div><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/understanding-the-n-jobs-parameter-to-speedup-scikit-learn-classification-26e3d1220c28"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd jg gz z fq ox fs ft oy fv fx jf bi translated">了解n_jobs参数以加速scikit-learn分类</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">一个现成的代码，演示了如何使用n_jobs参数来减少训练时间</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="pi l pd pe pf pb pg le os"/></div></div></a></div><h1 id="a636" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">你认为使用Docker太复杂了吗？请改用virtualenv</h1><p id="0e96" class="pw-post-body-paragraph ll lm iw ln b lo nn kg lq lr no kj lt lu np lw lx ly nq ma mb mc nr me mf mg ip bi translated">Python virtualenv是一个独立的Python环境，您可以在其中仅安装项目所需的包。</p><p id="cdc9" class="pw-post-body-paragraph ll lm iw ln b lo lp kg lq lr ls kj lt lu lv lw lx ly lz ma mb mc md me mf mg ip bi translated">此处继续阅读<a class="ae lk" rel="noopener" target="_blank" href="/have-you-ever-thought-about-using-python-virtualenv-fc419d8b0785">。</a></p><h1 id="4590" class="mv mw iw bd mx my mz na nb nc nd ne nf kl ng km nh ko ni kp nj kr nk ks nl nm bi translated">保持联系！</h1><ul class=""><li id="c5b2" class="mh mi iw ln b lo nn lr no lu pj ly pk mc pl mg mm mn mo mp bi translated">跟着我上<a class="ae lk" href="https://medium.com/@alod83?source=about_page-------------------------------------" rel="noopener">媒体</a></li><li id="bfce" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">注册我的<a class="ae lk" href="https://medium.com/subscribe?source=about_page-------------------------------------" rel="noopener">简讯</a></li><li id="5e6e" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">在<a class="ae lk" href="https://www.linkedin.com/in/angelicaloduca/?source=about_page-------------------------------------" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上连接</li><li id="76ef" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">在推特上关注我</li><li id="e4c3" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">跟着我上<a class="ae lk" href="https://www.facebook.com/alod83?source=about_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">脸书</a></li><li id="5c34" class="mh mi iw ln b lo mq lr mr lu ms ly mt mc mu mg mm mn mo mp bi translated">在Github上关注我</li></ul></div></div>    
</body>
</html>