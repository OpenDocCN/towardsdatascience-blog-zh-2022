<html>
<head>
<title>Gaussian Process Kernels</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">高斯过程核</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gaussian-process-kernels-96bafb4dd63e#2022-04-30">https://towardsdatascience.com/gaussian-process-kernels-96bafb4dd63e#2022-04-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="26be" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">不仅仅是径向基函数</h2></div><p id="5621" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae lb" rel="noopener" target="_blank" href="/gaussian-process-models-7ebce1feb83d">之前的文章</a>中，我们探讨了高斯过程模型如何工作的基本原理——我们探讨了数学细节，并推导了高斯过程回归模型的解析解。我们还演示了如何使用高斯过程回归模型来模拟一些简单的数据。在本文中，我们将通过探索可用于现实生活数据建模的各种协方差核来深入探讨高斯过程模型的主题。本文假设您已经很好地理解了高斯过程模型——如果您还不太熟悉它们，请先阅读<a class="ae lb" rel="noopener" target="_blank" href="/gaussian-process-models-7ebce1feb83d">以前的文章</a>！</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/451e4320e981bc4c16649334ffd34744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wpotLBihsn9dKwyVt3Iew.jpeg"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">阿布扎比的沙漠。由<a class="ae lb" href="https://unsplash.com/@ssclicks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">萨吉蒙·萨哈德万</a>在<a class="ae lb" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄。</p></figure><h1 id="2eb0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">高斯过程模型的快速回顾</h1><p id="41ce" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">对于某目标的<em class="mp"> φ </em>观测值<strong class="kh ir">y</strong>=<em class="mp">y</em>₁、<em class="mp"> y </em> ₂、……y<em class="mp">ᵩ</em>]ᵀ对应<em class="mp">t19】一组<em class="mp"> φ </em>输入特性<strong class="kh ir">x</strong>=<strong class="kh ir">x</strong>₁、<strong class="kh ir"> x </strong> ₂、…<strong class="kh ir">x</strong>t3t</em></p><p id="b066" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">高斯过程模型对<em class="mp"> yᵩ </em> ₊₁平均值的预测为:</p><p id="0cf5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">μ</em>=<strong class="kh ir">k</strong>ᵀ<strong class="kh ir">c</strong>⁻<strong class="kh ir">y</strong>，</p><p id="aac6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相应的预测方差为:</p><p id="cf23" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">s</em>=<em class="mp">c-</em>kᵀ<strong class="kh ir">c</strong>⁻<strong class="kh ir">k</strong>，</p><p id="3cca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中协方差矩阵<strong class="kh ir"> C </strong>具有元素:</p><p id="e7bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> C </strong> [ <em class="mp"> n </em>，<em class="mp">m</em>]=<em class="mp">k</em>(<strong class="kh ir">x</strong><em class="mp">ₙ</em>，<strong class="kh ir">x</strong><em class="mp">ₘ</em>)+<em class="mp">σδₙₘ</em>，</p><p id="b794" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">协方差向量<strong class="kh ir"> k </strong>具有元素:</p><p id="1191" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">k</strong><em class="mp">n</em><em class="mp">= k</em>(<strong class="kh ir">x</strong><em class="mp">ₙ</em>，<strong class="kh ir"> x </strong> <em class="mp"> ᵩ </em> ₊₁)，</p><p id="a01d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以及标量<em class="mp"> c </em>:</p><p id="f4a1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">c</em>=<em class="mp">k</em>(<strong class="kh ir">x</strong><em class="mp">ᵩ</em>₊₁，<strong class="kh ir">x</strong><em class="mp">ᵩ</em>₊₁)+<em class="mp">σ</em>，</p><p id="ba05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> σ </em>是高斯噪声的标准差，<em class="mp">k</em>(<strong class="kh ir">x</strong>t20】ₙ，<strong class="kh ir">x</strong>t24】ₘ)是我们接下来要探讨的核函数。</p><h1 id="2679" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">高斯过程核</h1><p id="8bc3" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">高斯过程模型中使用的核函数<em class="mp">k</em>(<strong class="kh ir">x</strong><em class="mp">ₙ</em>，<strong class="kh ir"> x </strong> <em class="mp"> ₘ </em>)是其核心——核函数本质上告诉模型两个数据点(<strong class="kh ir"> x </strong> <em class="mp"> ₙ </em>，<strong class="kh ir"> x </strong> <em class="mp"> ₘ </em>)有多相似。有几个内核函数可用于不同类型的数据，我们将在本节中研究其中的几个。</p><h2 id="78b4" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">径向基函数核</h2><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/95b9045349355a5ef14368706b22b168.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*ep3oKlYR9xXrmLptrFp6Qg.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">一维高斯函数。作者创造的形象。</p></figure><p id="f8e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也许最广泛使用的核可能是径向基函数核(也称为二次指数核、平方指数核或高斯核):</p><p id="a684" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>(<strong class="kh ir">x</strong>t48】ₙ，<strong class="kh ir">x</strong>ₘ)= exp(-| |<strong class="kh ir">x</strong><em class="mp">ₙ</em>-<strong class="kh ir">x</strong><em class="mp">ₘ</em>| |/2<em class="mp">l</em>)，</p><p id="3b8f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> L </em>为内核长度刻度。这个内核在很多机器学习库中默认使用，比如<a class="ae lb" href="https://scikit-learn.org/stable/modules/generated/sklearn.gaussian_process.GaussianProcessRegressor.html#sklearn.gaussian_process.GaussianProcessRegressor" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>。</p><p id="452d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一般来说，高斯过程模型将不能外推超过距离训练数据<em class="mp"> L </em>的距离，如下图所示——对于<em class="mp">f</em>(<em class="mp">x</em>)=<em class="mp">x</em>的模型外推(蓝色曲线)会随着<em class="mp"> x </em>远离训练数据(黑色曲线)而很快失败，即使内插(红色曲线)在</p><pre class="ld le lf lg gt nd ne nf ng aw nh bi"><span id="569f" class="mq lt iq ne b gy ni nj l nk nl">from sklearn.gaussian_process import GaussianProcessRegressor<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="6002" class="mq lt iq ne b gy nm nj l nk nl"># Create some toy data for the Gaussian process regressor model.<br/>dx = 0.1<br/>x = np.arange(-10, 10 + dx, dx)<br/>X = x.reshape(-1, 1)<br/>y = x * 1</span><span id="787a" class="mq lt iq ne b gy nm nj l nk nl"># Fit the model to the toy data.<br/>gpr = GaussianProcessRegressor()<br/>gpr.fit(X, y)</span><span id="9ea9" class="mq lt iq ne b gy nm nj l nk nl"># Perform interpolation prediction.<br/>y_pred_in = gpr.predict(X)</span><span id="89cb" class="mq lt iq ne b gy nm nj l nk nl"># Create some data for extrapolation prediction.<br/>x_out = np.arange(10, 20 + dx, dx)<br/>X_out = x_out.reshape(-1, 1)</span><span id="2557" class="mq lt iq ne b gy nm nj l nk nl"># Perform extrapolation prediction. The model should <br/># not perform very well here.<br/>y_pred_out = gpr.predict(X_out)</span><span id="5504" class="mq lt iq ne b gy nm nj l nk nl">plt.plot(x, y, "k", linewidth = 6)<br/>plt.plot(x, y_pred_in, "r")<br/>plt.plot(x_out, y_pred_out, "b")<br/>plt.legend(["Training data", "Interpolation", "Extrapolation"])<br/>plt.xlabel("x")<br/>plt.ylabel("f(x)")<br/>plt.show()</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nn"><img src="../Images/c67c4b202aa59ebab2e16348afe95d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*P8W9EPbRMVw79uScLqxKlA.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">函数的高斯过程模型(黑色曲线):f(x) = x使用径向基函数核。插值(红色曲线)非常好，而外推(蓝色曲线)很快失败。作者创造的形象。</p></figure><h2 id="1c98" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">常数核</h2><p id="8ea6" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">常数内核是最基本的内核，定义如下:</p><p id="3f59" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>(<strong class="kh ir">x</strong>t82】ₙ，<strong class="kh ir">x</strong>t86】ₘ)=<em class="mp">κ</em>，</p><p id="51d5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> κ </em>是某个常数值。</p><h2 id="3afb" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">白噪声核</h2><p id="c273" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">不出所料，白噪声核用于模拟数据中的白噪声:</p><p id="e008" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>(<strong class="kh ir">x</strong>t8】ₙ，<strong class="kh ir">x</strong>T12】ₘ)=<em class="mp">ν</em>δ<em class="mp">ₙₘ</em>，</p><p id="65aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> ν </em>是某个噪声水平值。</p><h2 id="123e" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">指数正弦平方核</h2><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/da964226a2a3183ad63b596c08155b08.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*UFq1dcVrf5Rj7rbUhpswqw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">一维指数正弦平方函数。作者创造的形象。</p></figure><p id="1ca6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">指数正弦平方核本质上是正弦的，因此能够模拟周期性数据:</p><p id="d1ac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>(<strong class="kh ir">x</strong>t24】ₙ，<strong class="kh ir">x</strong>t28】ₘ)= exp(-2/<em class="mp">l</em>(sin(π|<strong class="kh ir">x</strong><em class="mp">ₙ</em>-<strong class="kh ir">x</strong><em class="mp">ₘ</em>|/<em class="mp">p</em>))，</p><p id="05cb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> L </em>是内核长度刻度，而<em class="mp"> p </em>是内核周期。</p><h2 id="2940" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">有理二次核</h2><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/318a8fab576b94cf4a9c79d271f91d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*p_SEc87VUHfKmenMnPMDMQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">一维有理二次核。作者创造的形象。</p></figure><p id="4c3b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有理二次核等价于多个不同长度尺度的径向基函数核的和。</p><p id="0246" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>(<strong class="kh ir">x</strong>T50】ₙ，<strong class="kh ir">x</strong>t54】ₘ)=(1+| |<strong class="kh ir">x</strong>t58】ₙ-<strong class="kh ir">x</strong><em class="mp">ₘ</em>| |/(2<em class="mp">al</em>))⁻<em class="mp">ᵃ</em>，</p><p id="05da" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> L </em>是内核长度标度，而<em class="mp"> a </em>确定大标度和小标度变化的权重。</p><h1 id="dc1f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">内核的组合</h1><p id="e6dc" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我们不仅可以在高斯过程模型中单独使用各种核函数，还可以将它们组合起来，以使模型更加强大！例如，我们将使用具有自定义内核的高斯过程模型来模拟在莫纳罗亚测量的大气二氧化碳<a class="ae lb" href="https://gml.noaa.gov/ccgg/trends/" rel="noopener ugc nofollow" target="_blank">的变化。这些数据是由NOAA提供的，公众可以免费使用。我只从下载的文件中提取了<code class="fe no np nq ne b">year</code>、<code class="fe no np nq ne b">month</code>和<code class="fe no np nq ne b">average</code>列。使用<code class="fe no np nq ne b">pandas</code>库的csv文件。</a></p><p id="d227" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如下图所示，自1958年以来，测量的大气二氧化碳浓度一直在稳步上升，具有明显的周期性趋势。我们将尝试从今天开始推断未来10年(120个月)的趋势。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/518162de16d0fb635483b8769d4ed457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*U9kNMZ64dygWatPLa-6JeQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">莫纳罗亚的大气一氧化碳测量值(ppm)。作者创造的形象。</p></figure><p id="65b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们天真地使用scikit-learn中的默认径向基函数，我们会发现该模型能够很好地插值训练数据，但完全无法外推至未来，如下图所示。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/93042d1d58d7ae2dfaf5ad064c795643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*3-X6Ol-ULQ1M5QMBA0fIog.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">使用默认设置(即使用径向基函数核)训练的高斯过程模型完全不能对未来进行任何种类的外推。作者创造的形象。</p></figure><p id="82b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使用高斯过程模型有效地对数据建模，我们需要在制作模型时投入更多的精力！我们使用<a class="ae lb" href="http://gaussianprocess.org/gpml/chapters/RW.pdf" rel="noopener ugc nofollow" target="_blank"> Rasmussen和Williams (2006) </a>中概述的方程(5.15)—( 5.19)来创建定制的核函数，以便尽可能精确地模拟数据。</p><h2 id="911b" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">长期上升趋势</h2><p id="dcab" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">为了模拟长期上升趋势，我们使用具有大时间尺度的径向基函数核:</p><p id="3604" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>₁(<strong class="kh ir">x</strong>T6】ₙ，<strong class="kh ir">x</strong><em class="mp">ₘ</em>)=<em class="mp">a</em>exp(-| |<strong class="kh ir">x</strong><em class="mp">ₙ</em>-<strong class="kh ir">x</strong><em class="mp">ₘ</em>| |/2<em class="mp">l</em>₁)，</p><p id="e211" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> A </em> = 59.3，<em class="mp"> L </em> ₁ = 390。</p><p id="e7ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用较大的时间尺度可确保模型能够捕捉时间序列中的长期趋势和变化。</p><h2 id="53e6" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">周期性趋势</h2><p id="7583" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我们使用指数正弦平方核来模拟时间序列中的年度周期。此外，为了解决数据周期性的漂移，我们向周期性内核添加径向基函数因子:</p><p id="5843" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>₂(<strong class="kh ir">x</strong>t32】ₙ，<strong class="kh ir">x</strong>t36】ₘ)=<em class="mp">b</em>exp(-| |<strong class="kh ir">x</strong>ₙ-<strong class="kh ir">x</strong><em class="mp">ₘ</em>|/2<em class="mp">l</em>₂₁-2/<em class="mp">l</em>₂₂(sin</p><p id="cbdc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> B </em> = 2.33，<em class="mp"> L </em> ₂₁ = 2330，<em class="mp"> L </em> ₂₂ = 1.26，<em class="mp"> p </em> = 1.09。</p><h2 id="a2e0" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">中期和短期违规行为</h2><p id="9e64" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">时间序列数据中的中期和短期不规则性可以使用有理二次核来建模，该核能够捕捉大范围的长度尺度:</p><p id="eb34" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>₃(<strong class="kh ir">x</strong><em class="mp">ₙ</em>，<strong class="kh ir">x</strong><em class="mp">ₘ</em>)=<em class="mp">c</em>(1+| |<strong class="kh ir">x</strong><em class="mp">ₙ</em>-<strong class="kh ir">x</strong><em class="mp">ₘ</em>|/(2<em class="mp">al</em>₃))⁻</p><p id="3fcf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> C </em> = 0.596，<em class="mp"> a </em> = 0.145，<em class="mp"> L </em> ₃ = 4.74。</p><h2 id="b6ba" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated"><strong class="ak">噪音</strong></h2><p id="3bd9" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">使用径向基函数核和白噪声核的组合对数据中的噪声进行建模:</p><p id="4854" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">k</em>₄(<strong class="kh ir">x</strong>T4】ₙ，<strong class="kh ir">x</strong>t8】ₘ)=<em class="mp">d</em>exp(-| |<strong class="kh ir">x</strong><em class="mp">ₙ</em>-<strong class="kh ir">x</strong><em class="mp">ₘ</em>| |/2<em class="mp">l</em>₄)+<em class="mp">ν</em>δ<em class="mp">ₙₘ</em>，</p><p id="95ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<em class="mp"> D </em> = 0.183，<em class="mp"> L </em> ₄ = 0.133，<em class="mp"> ν = </em> 0.0111。</p><h2 id="045b" class="mq lt iq bd lu mr ms dn ly mt mu dp mc ko mv mw me ks mx my mg kw mz na mi nb bi translated">在高斯过程模型中组合核</h2><p id="bff0" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">用于模拟二氧化碳时间序列的自定义内核是:</p><p id="9d48" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">CO2 _ kernel</em>=<em class="mp">k</em>₁(<strong class="kh ir">x</strong><em class="mp">ₙ</em>，<strong class="kh ir">x</strong><em class="mp">ₘ</em>)+<em class="mp">k</em>₂(<strong class="kh ir">x</strong><em class="mp">ₙ</em>，<strong class="kh ir">x</strong><em class="mp">ₘ</em>+<em class="mp">k</em>₃(<strong class="kh ir">x</strong></p><pre class="ld le lf lg gt nd ne nf ng aw nh bi"><span id="bf36" class="mq lt iq ne b gy ni nj l nk nl"># Kernel of the trained sklearn Gaussian process regressor: <br/>print(gpr.kernel_)</span><span id="9641" class="mq lt iq ne b gy nm nj l nk nl">59.3**2 * RBF(length_scale=390) + 2.33**2 * RBF(length_scale=2.33e+03) * ExpSineSquared(length_scale=1.26, periodicity=1.09) + 0.596**2 * RationalQuadratic(alpha=0.145, length_scale=4.74) + 0.183**2 * RBF(length_scale=0.133) + WhiteKernel(noise_level=0.0111)</span></pre><p id="2d52" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如下图所示，由此产生的经过训练的高斯过程模型能够对大约10年后的大气二氧化碳浓度进行外推。与使用默认径向基函数核训练的原始模型相比，这是一个巨大的改进。</p><p id="fda4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意，随着预测日期和训练数据之间的距离增加，外推的方差变得更大。尽管如此，该模型已经能够捕捉长期上升趋势以及训练数据中的年度周期性！</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/7ebc1fd7981bb01ed17e5358897fe8f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*MLv7QggRtyLDUxFSptfkzA.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">使用包含长期、中期、短期长度尺度以及周期性的定制内核训练的高斯过程回归模型能够推断出大气二氧化碳在不久的将来的变化。作者创造的形象。</p></figure><h1 id="eb37" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结束语</h1><p id="706e" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在今天的文章中，我们更详细地探讨了可用于高斯过程模型的各种内核。虽然径向基函数核被广泛使用，并且在大多数情况下都应该工作良好，但我们表明，使用精心制作的核将允许我们在不久的将来有效地对某些数据集进行预测。</p><p id="6736" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于机器学习从业者来说，很好地理解模型如何工作，以及如何调整模型确实是一项基本技能！如果你想更详细地了解高斯过程模型，我强烈推荐你同时阅读<a class="ae lb" href="https://www.cs.toronto.edu/~duvenaud/thesis.pdf" rel="noopener ugc nofollow" target="_blank">大卫·k·杜文瑙德(2014) </a>和<a class="ae lb" href="http://gaussianprocess.org/gpml/chapters/RW.pdf" rel="noopener ugc nofollow" target="_blank">拉斯姆森和威廉姆斯(2006) </a>。感谢您的阅读！</p><h1 id="bf95" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><p id="11e2" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">[1] C. M. Bishop (2006)，<a class="ae lb" href="https://www.microsoft.com/en-us/research/uploads/prod/2006/01/Bishop-Pattern-Recognition-and-Machine-Learning-2006.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="mp">模式识别与机器学习</em> </a>，【斯普林格】。<br/> [2]大卫·k·杜文瑙德(2014)。<a class="ae lb" href="https://www.cs.toronto.edu/~duvenaud/thesis.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="mp">用高斯过程自动构建模型</em> </a>，剑桥大学博士论文。<br/>【3】<a class="ae lb" href="https://scikit-learn.org/stable/modules/gaussian_process.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/Gaussian _ process . html</a><br/>【4】卡尔·e·拉斯姆森和克里斯托弗·k·I·威廉姆斯(2006)。<a class="ae lb" href="http://gaussianprocess.org/gpml/chapters/RW.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="mp">机器学习的高斯过程</em> </a>，麻省理工出版社。<br/> [5]二氧化碳数据来自:Pieter Tans博士<em class="mp">、</em> NOAA/GML <em class="mp">、T25】(<a class="ae lb" href="http://gml.noaa.gov/ccgg/trends/" rel="noopener ugc nofollow" target="_blank">gml.noaa.gov/ccgg/trends/</a>)<em class="mp">、T29)和斯克里普斯海洋研究所的Ralph Keeling博士。</em></em></p></div></div>    
</body>
</html>