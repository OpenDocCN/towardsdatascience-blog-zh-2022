<html>
<head>
<title>Building a Data Mesh on Databricks — Fast</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在数据块上构建数据网格—快速</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-data-mesh-on-databricks-fast-25bf9a9bf0b2#2022-11-07">https://towardsdatascience.com/building-a-data-mesh-on-databricks-fast-25bf9a9bf0b2#2022-11-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c2b7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">如何在Databricks内部构建数据网格平台</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/692a8d93c1ea132c6b6c0f7ed0224264.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8Iwg-wftbeMhwRNc0noUQ.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated"><strong class="bd kz">(照片由</strong> <a class="ae la" href="https://unsplash.com/@pietrozj?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kz">皮埃特罗</strong> </a> <strong class="bd kz">上</strong> <a class="ae la" href="https://unsplash.com/s/photos/net?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kz">下</strong> </a> <strong class="bd kz"> ) </strong></p></figure><p id="1971" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">Databricks使团队能够以极快的速度和较低的维护需求构建数据网格平台。</p><p id="3472" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">但是构建一个基于数据块的数据网格平台也有意想不到的缺点。</p><p id="91dc" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在本文中，我将使用一个假想的团队结构概述一个可能的设置，并帮助您理解databricks上的数据网格是如何工作的。</p><p id="f248" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><em class="lx">本文节选自我在MEAP曼宁合著的《数据网在行动》</em>  <em class="lx">一书的草稿。</em></p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h2 id="9957" class="mf mg it bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw mx bi translated">为什么将Databricks作为数据网格平台？</h2><p id="de8d" class="pw-post-body-paragraph lb lc it ld b le my ju lg lh mz jx lj lk na lm ln lo nb lq lr ls nc lu lv lw im bi translated">与AWS和GCP版本的数据网格不同，Databricks上的数据网格看起来很像一个集中式数据设置。至少在技术方面。这带来了明显的好处，即易于设置和典型的集中化好处，以及两个不太明显的缺点:</p><ol class=""><li id="cbc1" class="nd ne it ld b le lf lh li lk nf lo ng ls nh lw ni nj nk nl bi translated">通过集中大部分基础设施，我们又一次受制于中心瓶颈。使用托管共享服务时，这种影响要小得多，但它仍然存在。此外，我们在物理上将数据集中在一个地方。</li><li id="b0de" class="nd ne it ld b le nm lh nn lk no lo np ls nq lw ni nj nk nl bi translated">通过集中部分流程，我们让“data domain所有权”变得更加难以理解。在这样的技术架构中，将焦点放在过程、人员和组织上是最重要的。</li></ol><p id="ed67" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">另一方面，这种数据网格可能不需要一个以上的数据工程师来维护中小型公司内部的技术基础设施。在域内部，您应该能够用每个域一名数据科学家/工程师来满足需求。</p><h2 id="8f55" class="mf mg it bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw mx bi translated">8.3.1自助式数据平台架构</h2><p id="6e17" class="pw-post-body-paragraph lb lc it ld b le my ju lg lh mz jx lj lk na lm ln lo nb lq lr ls nc lu lv lw im bi translated">我们的数据网格有几个参与者。</p><ul class=""><li id="925e" class="nd ne it ld b le lf lh li lk nf lo ng ls nh lw nr nj nk nl bi translated">团队<strong class="ld iu">黑</strong> &amp; <strong class="ld iu">白</strong>都是开发团队，团队内部有一名数据科学家。</li><li id="f94d" class="nd ne it ld b le nm lh nn lk no lo np ls nq lw nr nj nk nl bi translated">团队<strong class="ld iu">灰色</strong>只是一个独自维护平台的单人团队。</li><li id="759b" class="nd ne it ld b le nm lh nn lk no lo np ls nq lw nr nj nk nl bi translated">C <strong class="ld iu">消费者</strong>:我们有一些商业分析师和一个推荐系统，它们都主要消费数据。</li></ul><p id="6ed2" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我们的业务分析师精通SQL，可以在笔记本中使用Python做一些工作。</p><p id="7928" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">下图描绘了我们这次的架构。注意上下文变得更加模糊了。你当然可以“分离出”黑白团队的上下文，但是在这种情况下我们没有这样做。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ns"><img src="../Images/3825b4a2dfe4a55701f7aee02ca0e377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ELeT-8HKXn49dRw9"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">小团队如何利用Databricks快速创建自助式数据平台——作者。</p></figure><p id="354b" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">让我们再次确定数据网格的不同组件，首先是平台的组件，然后是数据产品部分。</p><h2 id="c321" class="mf mg it bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw mx bi translated">确定平台的组件</h2><p id="b516" class="pw-post-body-paragraph lb lc it ld b le my ju lg lh mz jx lj lk na lm ln lo nb lq lr ls nc lu lv lw im bi translated">在我们的架构中，平台接口和内核主要由数据块和相关服务组成。一个人的团队可以开始为Kinesis和Fargate组件的供应提供模板或某种服务，但这可能会与拥有一个非常精简的平台团队的想法相冲突。</p><p id="7af9" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">平台团队需要做的是提供指南，一页纸的关于如何在数据网格中使用数据块的指南。如何使用访问权限，在哪里存储所有数据产品等等。</p><h2 id="9cae" class="mf mg it bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw mx bi translated">确定数据产品的组成部分</h2><p id="32cd" class="pw-post-body-paragraph lb lc it ld b le my ju lg lh mz jx lj lk na lm ln lo nb lq lr ls nc lu lv lw im bi translated">所有的数据产品都是建立在数据基础之上的。下面详细描述一下。</p><p id="f903" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">Black团队拥有的数据产品更复杂一些。上游数据来自运行中的RDS实例和一些其他系统。为此，该团队使用定制的AWS Fargate任务定期将数据加载到S3桶中。从那里开始，Databricks spark批处理作业拾取数据，并将它们放入Delta Lake。然后，使用Databricks笔记本将数据转换为数据产品，并将其再次放入三角洲湖形式，在那里向其他人公开以供使用。在这种情况下，三角洲湖数据集形成了<strong class="ld iu">数据输出端口</strong>。</p><p id="dcd5" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">白队拥有的数据产品使用两个上游数据集。用户定期将数据输入到AWS S3存储桶中，该存储桶由批处理作业拾取并交付到三角洲湖中进行临时存储。这形成了数据产品的推送界面。另一方面，该团队提供了一个定制的AWS Kinesis数据流。操作组件将数据实时推送到数据流中，然后由Databricks流作业拾取。同样，笔记本用于转换和产生数据输出。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ns"><img src="../Images/044e6dea8df0b8d7a4bb6251e939aaf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oQBcyvQXy7NdKVme"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">【white团队如何利用Databricks来获取流数据和基于推送的数据，以构建一种新的数据产品——image by the author。</p></figure><p id="ac3f" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">white团队的第二个数据产品展示了使用Databricks构建额外的派生数据产品是多么简单。White团队只需拿起另一个笔记本，找到已经提供的两个数据产品，并将其转换为Databricks中的第三个新数据产品。</p><p id="6a62" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">业务分析师可以轻松地使用Databricks SQL来访问和浏览数据产品。他们还可以在该框架内创建报告和仪表板。</p><h2 id="cfe8" class="mf mg it bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw mx bi translated">评论</h2><p id="fbd8" class="pw-post-body-paragraph lb lc it ld b le my ju lg lh mz jx lj lk na lm ln lo nb lq lr ls nc lu lv lw im bi translated">数据块上的工作流是特定于数据块的。团队可以使用基础设施来管理数据产品的访问权限，分析师可以使用所谓的unity数据目录来浏览数据。</p><p id="0105" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">如果我们采用这样的体系结构，数据网格原理会有所不同。以数据块为中心的架构限制了团队的自由，并且没有简单的选择来“退出”平台。因此，这种设置只有在您解决这些限制或者通过治理措施确保团队在工具选择上保持一致的情况下才能很好地工作。因此，这种体系结构确实会带来退回到非数据网状操作模式的风险。</p><p id="115b" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">这使得这种架构更适合年轻的公司。这个架构也更针对数据工程师和数据科学家。这意味着它的目标是内部数据人员比例较高的公司，而GCP和AWS选项也适用于软件工程师。</p><h2 id="ba09" class="mf mg it bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw mx bi translated">变化</h2><p id="a0c5" class="pw-post-body-paragraph lb lc it ld b le my ju lg lh mz jx lj lk na lm ln lo nb lq lr ls nc lu lv lw im bi translated">Databricks本身可以被其他更大的数据平台取代，如雪花生态系统，它已经提供了几乎所有需要从上面实施架构的组件。</p><p id="6a24" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">要扩展这种数据网格架构，您需要为每个参与者启用“退出”选项。这可以通过添加一个外部数据目录并减少转换工具中的数据块来实现，转换工具仍然是一个强大的工具集。您的设置可能如下所示:</p><ol class=""><li id="a873" class="nd ne it ld b le lf lh li lk nf lo ng ls nh lw ni nj nk nl bi translated">团队将数据存储在他们自己的数据存储中</li><li id="d1bd" class="nd ne it ld b le nm lh nn lk no lo np ls nq lw ni nj nk nl bi translated">摄取工具获取这些数据，并将其放入Databricks可访问的数据存储中。</li><li id="7ae2" class="nd ne it ld b le nm lh nn lk no lo np ls nq lw ni nj nk nl bi translated">Databricks用于对这些数据集进行转换，并生成数据产品。</li><li id="6679" class="nd ne it ld b le nm lh nn lk no lo np ls nq lw ni nj nk nl bi translated">trinoDB这样的查询引擎用于将不同的数据产品连接在一起。</li><li id="feb6" class="nd ne it ld b le nm lh nn lk no lo np ls nq lw ni nj nk nl bi translated">中央数据目录确保数据产品可以存储在任何地方，并且仍然可以访问和查找。</li></ol><h2 id="ca73" class="mf mg it bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw mx bi translated">Databricks架构摘要</h2><p id="113e" class="pw-post-body-paragraph lb lc it ld b le my ju lg lh mz jx lj lk na lm ln lo nb lq lr ls nc lu lv lw im bi translated">本节描述的架构非常注重最大限度地利用Databricks的数据转换能力。因此，它与Databricks平台紧密相连。我们还看到，我们需要一些帮助来将数据放入中央三角洲湖，以释放数据块的力量。</p><p id="6ad6" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">这种设置的一大优势是最少的维护工作，并为公司通常希望承担的所有分析工作负载提供了强大的支持。</p><p id="6a31" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">另一方面，我们看到了对开发团队的有限支持和对Databricks平台的锁定效应。</p><p id="d020" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">看看下面的概要简介。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nt"><img src="../Images/28ace8ca2a3e13626519db2e6936d0b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuNTeZ1mqcsZoxAvsFfHoQ.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者对databricks数据网格平台设置的总结。</p></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><p id="11b4" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">对如何建立伟大的数据公司、伟大的数据密集型产品、成为伟大的数据团队感兴趣，还是对如何利用开源构建任何伟大的东西感兴趣？然后考虑加入我的 <a class="ae la" href="http://thdpth.com/" rel="noopener ugc nofollow" target="_blank"> <em class="lx">免费简讯《三个数据点周四》</em> </a> <em class="lx">。它已经成为数据初创企业、风投和数据领导者值得信赖的资源。</em></p></div></div>    
</body>
</html>