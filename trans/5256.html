<html>
<head>
<title>Object-Oriented Discrete Event Simulation — with SimPy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向对象的离散事件模拟—使用 SimPy</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/object-oriented-discrete-event-simulation-with-simpy-53ad82f5f6e2#2022-11-24">https://towardsdatascience.com/object-oriented-discrete-event-simulation-with-simpy-53ad82f5f6e2#2022-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7fe3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用随机离散事件模拟改善繁忙的急诊科</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/aa24a5f4c0db473be4f982855812be0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e7YfIqLhDHmMyADU"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@shakusky?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">张子超</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="2242" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在日常生活中，我们经常会遇到基于队列的系统。在这种情况下，系统或流程需要实体(如客户或患者)在系统中流动，同时排队等待有限的资源。我们也经常发现自己想知道我们正在使用的系统是否是最佳的，或者推测它需要多长时间才能得到服务。</p><blockquote class="ls lt lu"><p id="3241" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">在排队论的范围内，离散事件模拟(DES)是一种我们可以用程序和数学的方式解决这些问题的方法。</p></blockquote><p id="056f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我之前写过一篇关于 DES 的介绍，概述了方法论背后的一些关键思想，见<a class="ae kv" href="https://medium.com/@yasser.mushtaq/discrete-event-simulation-simply-put-4ae9f098a809" rel="noopener">这里</a>。</p><p id="d0a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lv">在这里</em>，我们将使用 Python 包 SimPy 实现 DES。此外，我们将演示<strong class="ky ir">面向对象的</strong>方法，随着我们的模型变得越来越复杂，这种方法非常有用。</p><h2 id="925a" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">我们提出一个问题</h2><p id="28ea" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">简而言之，DES 可以帮助我们优化任何以实体排队请求特定服务为特征的系统。这适用于许多领域，如制造业、电信和医疗保健。在一个典型的高压环境中，急诊科为测试这种方法提供了一个很好的用例。下面，我们有一个流程图，描述了一个简化的急诊科系统。实体，在这种情况下是患者，流入系统，被分类，随后在回家或被允许进入医院之前通过两个过程中的一个。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/52502a0de88a66912d71f0a0be2eedc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YYNkd9S0DnjgwAuRRg8KLg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">黄色方框代表资源，橙色菱形代表决策树，绿色方框代表“汇点”(实体出口点)。</p></figure><p id="14ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，这个提议的系统确实可以根据项目的需要进行修改和添加。需要仔细考虑所需的详细程度。对系统的过度简化的描述将会产生不切实际的结果，并且不能反映现实，同时我们需要注意不要对超出我们范围的系统方面进行过度建模。</p><p id="db71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的图中，最多有四个点可以形成队列，而某些元素也有一定程度的随机性。这些用红色虚线边框突出显示，主要与我们系统中的进程相关联。例如，病人到达的间隔时间，以及和护士或医生在一起的时间，都可以被随机建模。换句话说，在我们的模型中有一定程度的随机性。</p><p id="df09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面描述的系统非常适合通过 DES 建模。我们将利用 Python 包<em class="lv"> SimPy </em>来完成这项工作。</p><h2 id="9d37" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">代码模板</h2><p id="a1f1" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在这里，我们将通过一个模板，你可以按照这个模板在<em class="lv"> SimPy </em>中编写一个 DES 模型。我们将利用<em class="lv">面向对象的</em>方法来解决这个编码问题，因为这有助于开发用户友好、可读的代码，特别是当模型变大时。</p><p id="476c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该代码将包括以下三个主要类别:</p><ul class=""><li id="aa69" class="my mz iq ky b kz la lc ld lf na lj nb ln nc lr nd ne nf ng bi translated">一个简单保存关键变量的类，用于操纵模型，或者测试<em class="lv">假设</em>场景。</li><li id="3f82" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">用于保存通过系统的实体的关键信息的实体类。在这种情况下，病人类。</li><li id="4b8a" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr nd ne nf ng bi translated">一个代表我们系统的类，以及表征它的过程。</li></ul><p id="3720" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了以上所述，我们可能希望包含更多的实用类，比如跟踪指标。</p><p id="09f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们将只包括代码的关键元素，显示上面的三个主要类。完整代码可以在<a class="ae kv" href="https://github.com/Ya5s3r/Discrete-Event-Sim-AE-Department" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里</strong> </a>查看。</p><h2 id="8061" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">参数和变量</h2><p id="c4f5" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们将包含一个类，它只是作为定义模型的关键变量和值的占位符。这使得接近和操作变得容易。请注意，我们已经包含了资源水平和平均时间的相关信息，这些信息将被纳入模型的<em class="lv">随机</em>元素。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="8511" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">病人</h2><p id="bfca" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">病人类代表进入我们系统的病人。它是用患者 ID 和在我们系统中花费的时间的占位符来实例化的。它还将拥有两种方法，一种是确定患者拥有的优先级，表示严重程度，另一种是在分类过程中使用的分类决策方法，用于确定患者流向哪条路径。这些方法将在我们的主模型代码中的适当位置使用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="0992" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">系统类别</h2><p id="1b6e" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">我们代码的最后一个定义类可以描述为<em class="lv">系统</em>，或者<em class="lv">模型</em>类。这是定义关键流程的地方，代表了我们的实体流动的路径。</p><p id="5eeb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鉴于这门课比其他课稍长，我将把它分成几个主要部分。首先，在<em class="lv">实例化</em>时…</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="61f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里重要的第一步是建立我们的简单环境。环境管理模拟，在事件到事件的基础上逐步通过时间。除了时间，环境还管理事件的调度和处理。这些都是 DES 的关键组件，否则您需要手工编写代码。因此 SimPy 大大简化了实现。</p><p id="ee0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了环境之外，我们还分配了一个患者计数器，它也充当患者 ID。</p><p id="16cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">资源(流程图中的黄色方框)也是在这一点上定义的。这些是我们模型的关键元素，并且在很大程度上决定了我们的系统处理实体的效率。我们定义了两种类型的资源，它们来自 SimPy 提供的功能。第一种，也是最基本的类型，是<code class="fe no np nq nr b">Resource</code>类。我们为这些资源设置了一定的容量，并且它们在<em class="lv">先进先出</em> (FIFO)的基础上工作。也就是说，实体是在先到先服务的基础上处理的。在我们的系统中，分诊护士就是这样一种资源，因此称为<code class="fe no np nq nr b">self.nurse = simpy.Resource</code>。SimPy 允许您定义的另一种资源类型是<em class="lv">优先级资源。</em>这些资源根据实体相关的优先级处理实体，与 FIFO 队列系统相反。在我们的模型中，我们按照从 1 到 5 的优先级对实体进行排序，1 是最重要的，5 是最不重要的。我们系统中优先资源的例子是医生和小房间。</p><p id="5f03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的关键模型变量实例化之后，我们移动到第一个<em class="lv">过程</em>函数。我们要定义的第一个过程是到达我们系统的过程，我们可以这样做。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="eb2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用一个无限 while 循环来生成患者，该循环迭代患者计数器，为每个患者提供一个新的患者 ID。然后，我们用上面定义的<code class="fe no np nq nr b">AEPatient</code>类启动患者，随后通过我们的主要急诊科流程发送患者，我们将在后面定义。我们函数的另一个主要组件是<code class="fe no np nq nr b">samples_interarrival</code>变量，它随机生成下一个实体到达的时间，利用<em class="lv">指数</em>分布进行采样。这种分布通常用于模拟到达之间的时间。我们将到达之间的平均时间输入到指数函数中，在我们的情况下，我们已经预先确定了到达之间的平均时间，但实际上，您可能希望从真实数据中确定到达之间的平均时间。</p><p id="a14e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，到达流程在采样时间内被冻结，随后生成下一个患者。这是通过使用<code class="fe no np nq nr b">yield self.env.timeout</code>实现的。</p><p id="39aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">while 循环一直运行到 SimPy 环境结束，我们将在后面定义。</p><p id="211f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的系统类中的下一个过程是<code class="fe no np nq nr b">attend_ed</code>过程，在这个过程中，我们定义了一个病人在系统中可能经历的旅程。</p><p id="8d57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面代码中的注释描述了患者可能经过的路径，并遵循上面定义的流程图。因此，我将在下面解释代码的一些关键组成部分，您会注意到这些部分在整个流程中会被多次使用。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="fb3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在 SimPy 的上下文中，我们可以使用一个<code class="fe no np nq nr b">with</code>块来请求特定的资源，如代码所示。我们在这个块中做的第一件事是<code class="fe no np nq nr b">yield</code>请求，它告诉进程请求资源，如果资源不可用，进程将冻结在适当的位置，直到资源可用(简单地说，SimPy 为我们处理这一点)。在我们的系统中，一旦资源可用，我们通常会对咨询时间进行采样，无论是与护士还是医生。为此，我们使用了<em class="lv">对数正态</em>分布。对数正态分布的随机变量将只取正的实数值，因此对于在工程等领域中建模过程时间是有用的，在这些领域中负值是不可能的，并且在金融中建模收入分布也是有用的。它的特点是向右倾斜，换句话说，有一条向右的长尾。<a class="ae kv" rel="noopener" target="_blank" href="/log-normal-distribution-a-simple-explanation-7605864fb67c">这篇文章</a>给出了一个很好的概述。它的特点也使它非常适合模拟我们的咨询时间。因此，您会注意到我们的过程持续时间利用了一个自定义函数，该函数从对数正态分布中生成一个随机数。然后，我们利用 SimPy 环境类的<code class="fe no np nq nr b">timeout</code>函数在采样的时间内暂停进程。</p><p id="8304" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，如果患者去急诊科或轻伤病房(MIU ),首先会请求一个隔间。在这个<code class="fe no np nq nr b">with</code>区块内，是另一个<code class="fe no np nq nr b">with</code>区块，在这里请求找医生。这意味着，只有当患者进入隔间时，才会请求医生，并且只有当医生结束时，隔间才会被释放，实际上，隔间<code class="fe no np nq nr b">with</code>条款结束。这是在两个相关资源之间建立关系的一种非常好的方式。另一件要注意的事情是，由于隔间和医生是优先级资源，我们在资源函数参数中指出我们使用的优先级。<code class="fe no np nq nr b">attend_ae</code>功能的结束代表我们系统的结束，患者可以离开的任何点在上面的流程图中用绿色表示。</p><p id="5a73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们类中的最后一个方法是<code class="fe no np nq nr b">run</code>，如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="47ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种方法就是我们后来用来开始我们的环境。我们启动第一个流程，它是生成病人的生成器函数，并使用环境的<code class="fe no np nq nr b">run</code>函数在指定的时间内运行我们的模拟。</p><p id="fd47" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">完整的代码包括主要与跟踪一些关键指标和绘制结果相关的其他方面。为了简洁起见，我在这里省略了这些。</p><p id="caf5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的代码块之外，我们将利用循环的<em class="lv">来运行指定次数的模拟，并根据需要包括任何附加元素来跟踪进度。一个简单的例子如下。</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="99bc" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">输出</h2><p id="3289" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在我们的完整代码中，我们跟踪一些帮助我们确定系统整体性能的指标。这些包括我们系统中的资源(包括护士、隔间和医生)的平均等待时间(在所有运行中)。此外，我们还在整个模拟时间内跟踪一些关键服务的队列长度，试图找出瓶颈。</p><p id="f009" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们在每位患者进入我们的系统时为他们设置了优先级，我们也可以基于优先级可视化指标。</p><p id="40d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以从我们的总体结果开始，显示平均等待时间(以分钟为单位)，模型参数设置如上(提醒一下，我们有 3 名医生，2 名护士和 7 个事故和紧急(AE)室，其他输入见上文)。</p><pre class="kg kh ki kj gt ns nr nt bn nu nv bi"><span id="957b" class="nw ma iq nr b be nx ny l nz oa"># average results across all runs of our model<br/>The average number of patients served by the system was 55<br/>The overall average wait across all runs for a triage nurse was 31.4 minutes<br/>The overall average wait across all runs for a cubicle was 62.3 minutes<br/>The overall average wait across all runs for a doctor was 17.2 minutes<br/>The overall average wait across all runs for a MIU doctor was 0.2 minutes<br/>The mean patient time in the system across all runs was 132.5 minutes</span></pre><p id="b17d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到等待时间最长的是一个小隔间，而平均每个病人花大约 130 分钟通过系统。</p><p id="0e3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的 MIU 几乎没有压力，这是因为在我们的默认设置下，我们的模拟并没有大量使用这个单元。</p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><p id="b6a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可视化瓶颈的一个好方法是在我们的模拟器中绘制任意给定时间等待资源的患者数量。下图显示了这一点，仅关注 AE 组件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/32f4f546fe92f9333d7c3be28f73b5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*8pVypwOZDB5I1cC_MODDNQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图表显示整个模拟器中三种主要资源的平均队列长度—所有运行的平均数。阴影区域代表上下四分位数。</p></figure><p id="affa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们看到一个小隔间排起了相当长的队，这显然是我们系统的瓶颈之一，因此导致病人通过的时间很长。</p><p id="4e8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，使用我们的默认参数，我们还可以通过患者优先级来显示系统中的平均时间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/a97fbd27a31d2f4a2fbdc7a42332e557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*dKQtxEm_Gn7bum4csM4uFw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按优先级划分的系统平均时间—红色数字表示与每个优先级组相关的患者平均人数。误差线表示标准偏差。</p></figure><p id="5fe7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鉴于我们建立模型的方式，大多数患者将优先考虑 3。基于优先级的队列以及我们的系统规定优先级 5 的患者可以去 MIU 或回家，这意味着高优先级和非常低优先级的患者可以更快地得到处理。</p><h2 id="85d7" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">如果……</h2><p id="8428" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">现在我们有了一个模拟系统，我们可以测试<em class="lv">假设</em>场景，在之前<em class="lv">到现实世界的应用。此外，我们可以测试操作变化，以优化我们的系统。这是 DES 的伟大用途之一，在这里，我们将看看潜在的场景。</em></p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><p id="1e2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的默认系统产生了相当长的平均超过两个小时的总处理时间！</p><p id="eda2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想象一下，一位运营经理找到我们，希望减少患者通过急症室的时间。众所周知，病人要等很长时间才能进入小隔间。简单地增加隔间能解决问题吗？</p><p id="d16a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们通过增加两个隔间并比较结果来找出答案。</p><pre class="kg kh ki kj gt ns nr nt bn nu nv bi"><span id="511e" class="nw ma iq nr b be nx ny l nz oa">The average number of patients served by the system was 56<br/>The overall average wait across all runs for a triage nurse was 30.1 minutes<br/>The overall average wait across all runs for a cubicle was 59.2 minutes<br/>The overall average wait across all runs for a doctor was 30.5 minutes<br/>The mean patient time in the system across all runs was 137.2 minutes</span></pre><p id="f366" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也没多大帮助！等待一个小隔间的平均时间略有减少，而总体时间实际上略有增加。</p><p id="ccf4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，经验让我们认为，也许隔间的数量不是问题，但问题在于一旦患者进入隔间，我们处理他们的效率如何。也许你注意到了，仅仅是增加更多的小隔间实际上增加了看医生的时间，因为同样数量的医生现在有更多的小隔间要通过。</p><p id="362d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们认为问题出在隔间的<em class="lv">上游</em>。换句话说，有更多的医生，可以让我们更快地清理小隔间，从而让病人更快地回家。因此，让我们将小隔间的数量恢复到默认值，而不是增加医生的数量。</p><p id="f7b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面我们看到增加一个医生的结果，所以我们现在有四个医生。</p><pre class="kg kh ki kj gt ns nr nt bn nu nv bi"><span id="3b50" class="nw ma iq nr b be nx ny l nz oa">The average number of patients served by the system was 63<br/>The overall average wait across all runs for a triage nurse was 29.6 minutes<br/>The overall average wait across all runs for a cubicle was 44.5 minutes<br/>The overall average wait across all runs for a doctor was 5.2 minutes<br/>The overall average wait across all runs for a MIU doctor was 0.2 minutes<br/>The mean patient time in the system across all runs was 117.8 minutes</span></pre><p id="c8a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过增加一名医生，我们将平均总处理时间减少了约 20 分钟。这也减轻了隔间的压力。</p><p id="c9c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能已经注意到，在我们的默认系统中，另一个上游压力相当大。这是需要入院的患者找到住院床位并因此(在我们的系统中)离开急诊室的平均时间。虽然只有 30%的 4 级及以下优先级别患者需要这种服务，但他们平均需要等待 90 分钟才能获得住院床位。为了证明上游压力对我们的声发射系统的影响，我们模拟了平均时间减少到 45 分钟。结果如下所示。</p><pre class="kg kh ki kj gt ns nr nt bn nu nv bi"><span id="816e" class="nw ma iq nr b be nx ny l nz oa">The average number of patients served by the system was 72<br/>The overall average wait across all runs for a triage nurse was 33.8 minutes<br/>The overall average wait across all runs for a cubicle was 33.0 minutes<br/>The overall average wait across all runs for a doctor was 10.3 minutes<br/>The overall average wait across all runs for a MIU doctor was 0.3 minutes<br/>The mean patient time in the system across all runs was 110.1 minutes</span></pre><p id="4e58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个隔间的平均等待时间已经减少到大约 30 分钟！请记住，在我们的默认系统中，这大约是 60 分钟。我们还可以在下面看到，在我们的模拟器中，排队等候诊室的患者数量也减少了，从大约 40 名患者减少到现在的大约 20 名。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/7090bf2f49e46cfe9c81368e85dfd293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*_EKQV5Ox_b3jjmXUEsfxag.png"/></div></figure><p id="4d4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑到我们只在模型中添加了一个 AE 资源，这相当了不起！显然，在我们的模拟器中，住院系统的低效率对 AE 表现有影响。事实上，这是一个众所周知的现象。</p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><p id="1c66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以继续，但是我们可以在这里结束，因为我们已经证明了 SimPy 在相对容易地开发 DES 模型方面的巨大作用。为了更进一步，我们当然可以进一步增加系统的复杂性，以更好地反映真实世界的急救护理系统。</p><h2 id="a71d" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">感谢</h2><p id="f4d9" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated"><em class="lv">除特别注明外，所有图片均为作者所有。</em></p><p id="ff04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢来自<a class="ae kv" href="https://arc-swp.nihr.ac.uk/research-and-implementation/research-teams/penchord/" rel="noopener ugc nofollow" target="_blank">半岛卫生运筹学和数据科学合作组织</a> (PenCHORD)的同事们在我们参与<a class="ae kv" href="https://arc-swp.nihr.ac.uk/training-type/health-service-modelling-associates-programme-hsma/" rel="noopener ugc nofollow" target="_blank">卫生服务建模项目(HSMA) </a>期间给予的支持，我们目前已于<em class="lv">注册。一些 HSMA 资源可以在下面的链接中看到。</em></p><p id="68d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GitHub 回购:</p><div class="oj ok gp gr ol om"><a href="https://github.com/hsma5/3a_introduction_to_discrete_event_simulation" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">GitHub-hsma 5/3a _ 简介 _ 离散 _ 事件 _ 模拟</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">github.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa kp om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://github.com/hsma5/3b_simpy_part_1" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">GitHub - hsma5/3b_simpy_part_1</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">github.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa kp om"/></div></div></a></div><div class="oj ok gp gr ol om"><a href="https://github.com/hsma5/3c_simpy_part_2" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">GitHub - hsma5/3c_simpy_part_2</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">github.com</p></div></div><div class="ov l"><div class="pc l ox oy oz ov pa kp om"/></div></div></a></div><p id="617f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也有一些 YouTube 视频可用:<br/><a class="ae kv" href="https://www.youtube.com/channel/UCCY9_Gxg6kM-xjk9vV0mzIQ/videos" rel="noopener ugc nofollow" target="_blank">https://www . YouTube . com/channel/uccy 9 _ gxg 6km-xjk 9 vv0 mziq/videos</a></p><h2 id="cecb" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">参考</h2><ol class=""><li id="b70d" class="my mz iq ky b kz ms lc mt lf pd lj pe ln pf lr pg ne nf ng bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/log-normal-distribution-a-simple-explanation-7605864fb67c">https://towards data science . com/log-normal-distribution-a-simple-explain-7605864 FB 67 c</a></li><li id="4e25" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr pg ne nf ng bi translated">埃克塞特大学健康数据科学副教授 Thomas Monks 善意分享的从对数正态分布中产生随机数的自定义函数。</li><li id="956a" class="my mz iq ky b kz nh lc ni lf nj lj nk ln nl lr pg ne nf ng bi translated">英格兰住院床位容量对事故和急诊绩效的溢出效应。R 弗里贝尔和 R M 华雷斯<a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0168851020301901#!" rel="noopener ugc nofollow" target="_blank">https://www . science direct . com/science/article/ABS/pii/s 0168851020301901 #！</a></li></ol></div></div>    
</body>
</html>