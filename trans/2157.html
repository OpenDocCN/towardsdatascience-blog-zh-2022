<html>
<head>
<title>Early Stopping in TensorFlow — prevent overfitting of a neural network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TensorFlow中的早期停止-防止神经网络的过度拟合</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/control-the-training-of-your-neural-network-in-tensorflow-with-callbacks-ba2cc0c2fbe8#2022-05-13">https://towardsdatascience.com/control-the-training-of-your-neural-network-in-tensorflow-with-callbacks-ba2cc0c2fbe8#2022-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c19f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">如何使用回拨在适当的表现下停止训练</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/5d695424fb2e651970c18c055d7c61f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wDngpcfFD4kV9LXz.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@erwanhesry?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">尔万·赫斯里</a>在<a class="ae kz" href="https://unsplash.com/s/visual/4194f627-27ac-44d3-85cd-3e347fc2e5c9?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="3396" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在本文中，我将解释如何通过使用回调来控制Tensorflow中神经网络的训练。<strong class="lc iu">回调是在过程</strong>中反复调用的功能(例如神经网络的训练)，通常用于验证或纠正某些行为。</p><p id="0e94" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在机器学习中，我们可以使用回调来定义在训练时期之前、期间或结束时发生的事情。这对于记录性能或在我们的性能指标达到某个阈值时停止训练特别有用。这种机制称为<strong class="lc iu">提前停止</strong>。</p><p id="c0c3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">例如，如果您设置了1000个历元，并且在200个历元时已经达到了期望的精度，那么训练将自动停止，<strong class="lc iu">避免您可能过度拟合您的模型。</strong>让我们看看这是如何在Tensorflow和Python中实现的。</p><p id="765a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们通过从Tensorflow导入<em class="lw"> fashion_mnist </em>数据集来打好基础。我们将使用这个数据集来解释回调是如何工作的。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="e835" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是我们的数据集的样子</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lz"><img src="../Images/a65c117c8533473b0bdee87453f90c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zqNmwmC32vYMGkWb.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">来源:<a class="ae kz" href="https://www.researchgate.net/figure/Sample-images-from-Fashion-MNIST-dataset_fig8_356111457" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/figure/Sample-images-from-Fashion-MNIST-dataset _ fig 8 _ 356111457</a></p></figure><h1 id="76ea" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">早期停课班</h1><p id="9299" class="pw-post-body-paragraph la lb it lc b ld ms ju lf lg mt jx li lj mu ll lm ln mv lp lq lr mw lt lu lv im bi translated">第二步是创建专门用于提前停止的类。我们将创建一个继承自<code class="fe mx my mz na b">tf.keras.callbacks.Callback</code>的类，并允许我们在达到95%的准确率时停止训练。如果通过查看Tensorflow模型提供的日志来满足条件，回调将使用<em class="lw"> on_epoch_end </em>函数来停止训练。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="b950" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这里，我们访问继承自<code class="fe mx my mz na b">tf.keras.callbacks.Callback</code>的<em class="lw"> on_epoch_end </em>方法，并通过对导致训练停止的条件进行编码来覆盖其行为。</p><p id="2a56" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们继续实现我们的张量流模型。</p><h1 id="1632" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">深度神经网络分类任务</h1><p id="6522" class="pw-post-body-paragraph la lb it lc b ld ms ju lf lg mt jx li lj mu ll lm ln mv lp lq lr mw lt lu lv im bi translated">我们将使用一个多层神经网络来对数据集中的衣物进行分类。最好的方法是使用卷积神经网络，但是对于这个例子，深度神经网络也可以。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="f348" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们现在准备训练模型。要使用回调，只需将对象放入要提供给模型的<code class="fe mx my mz na b">fit() </code>方法中的回调参数的列表中。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="lx ly l"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nb"><img src="../Images/69dcf1c391de16de18fc3e6e7e9e2b8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pY2QhhcBvszrKPzWzZH6Rw.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">训练停止，因为我们已经达到95%的准确率。图片作者。</p></figure><p id="0e55" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">下面是如何设置回调来控制一个神经网络的训练！希望你今天学到了新东西👍</p><p id="cee7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">保持坚强，度过艰难时刻。这是值得的。干杯！</p><h1 id="52af" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">代码模板</h1><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="lx ly l"/></div></figure></div></div>    
</body>
</html>