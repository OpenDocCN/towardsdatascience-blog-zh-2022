<html>
<head>
<title>Simulation of X-ray Computed Tomography</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">X 射线计算机断层成像的模拟</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simulation-of-x-ray-computed-tomography-2579f1ad2652#2022-02-21">https://towardsdatascience.com/simulation-of-x-ray-computed-tomography-2579f1ad2652#2022-02-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5f76" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">拉冬变换的一个应用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/7f0508577808c99f269ecf96110a7d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/1*El0tpm7p7DnvyzfeJwMvTg.gif"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 1:显示拉冬变换的动画。顶部:输入图像。下图:对应的拉冬变换。由<a class="ae kr" href="https://github.com/sebastiengilbert73/tutorial_radon_transform/blob/main/generate_animation_lines.py" rel="noopener ugc nofollow" target="_blank">生成此代码</a>。图片由作者提供。</p></figure><p id="37af" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在电子制造业中，用 X 射线计算机断层扫描检查两个分立元件之间的互连是常见的做法。例如，<a class="ae kr" href="https://en.wikipedia.org/wiki/Ball_grid_array" rel="noopener ugc nofollow" target="_blank">球栅阵列(BGA) </a>是连接印刷电路板(PCB)和芯片的小焊球的密集网格。我们希望确保每个球都正确焊接到芯片和 PCB 的金属焊盘上。如果我们对组装好的封装进行垂直 X 射线检测，就像你的牙医获取你牙齿的图像一样，最终的图像质量会受到芯片和 PCB 中多层金属结构的影响。每个金属结构都充当一个 X 射线衰减器，形成遮挡，可能会阻止检测 BGA 平面中的细微缺陷(通常是孤立的焊料卫星、桥和异常球)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/967f443a6d279804f1a9f320cfaf60f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*7n9TRcLC3i0NHC-iWF8flA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 2:球栅阵列(BGA)位于 PCB 和芯片之间，不完全可见。图片由作者提供。</p></figure><h1 id="c090" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">BGA 检查场景</h1><p id="968e" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">你是计算机视觉工程师，负责检查装配线上的 BGA，就在元件被焊接到熔炉中之后。您考虑从阵列的侧面拍照，但是您很快意识到除了第一行连接之外，您看不到更远的地方。你在寻找可以在芯片下任何地方找到的缺陷，所以你已经排除了这个选项。</p><p id="2dae" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">经过大量的谷歌搜索，你找到了一个基于<em class="mm"> X 射线计算机断层扫描</em>的解决方案。作为一名杰出的制造商，您构建了一个一维 X 射线成像系统，可以从多个角度捕捉 BGA 吸收的切片(参见图 3)。</p><blockquote class="mn mo mp"><p id="1e1f" class="ks kt mm ku b kv kw jr kx ky kz ju la mq lc ld le mr lg lh li ms lk ll lm ln ij bi translated">警告，孩子们:不要在家里这样做，除非在一个拥有高能辐射博士学位的成年人的监督下。</p><p id="4300" class="ks kt mm ku b kv kw jr kx ky kz ju la mq lc ld le mr lg lh li ms lk ll lm ln ij bi translated">再三考虑后，不要这样做，句号。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/bac089907ebf48daaa571a5171657158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*iTYmfkjmQ61B9tlHqoaF-Q.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 3:X 射线成像系统。图片由作者提供。</p></figure><p id="f5f7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">您的成像系统沿着 363 个 X 射线传感器的线性阵列长度产生 BGA 集成密度的切片。旋转机构可以选择投影的角度θ。你可以在这里找到模拟这个系统<a class="ae kr" href="https://github.com/sebastiengilbert73/tutorial_radon_transform/blob/main/simulate_bga.py" rel="noopener ugc nofollow" target="_blank">的代码。</a></p><p id="ece7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">经过几天的对齐调整，你终于成功地获得了一个通过水平堆叠 BGA 的投影构建的图像，以 256 个离散的角度，从- <strong class="ku ir"> π </strong> /2 到<strong class="ku ir"> π </strong> /2:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/a1af223de77036743ca5004b7ff260f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*vi93tZ50fTGl4y_4RWaJEg.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 BGA 平面正弦图。图片由作者提供。</p></figure><p id="87c6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们称这样的图像为<em class="mm">正弦图</em>，因为原始密度图像中的一个点在堆叠切片的图像中产生了正弦曲线。</p><p id="c23a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">你现在做什么？图 4 的正弦图如何揭示 BGA 平面上的密度图？</p><h1 id="030d" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">拉冬变换</h1><p id="4bfd" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">通过在给定角度的平行射线上整合 2D 密度图来创建线性轮廓的操作是<a class="ae kr" href="https://en.wikipedia.org/wiki/Radon_transform" rel="noopener ugc nofollow" target="_blank">拉冬变换</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d4ebce7ad2a64de29d2a0447c739db25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*g_KS_-VPfrGTYYgo4bUk7Q.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 5:(ρ，θ)中 Radon 变换的值是 f(x，y)沿(ρ，θ)定义的线的积分。图片由作者提供。</p></figure><p id="4eb4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">f(x，y)的拉冬变换由下式定义:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/cb71afc4e2ad8680e5c53868c0c98a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*VXgZWM63-ve-6ZoDaPJOew.png"/></div></figure><p id="2dde" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们在图 3 中所示的旋转源和传感器的设置执行了对应于 BGA 平面的 X 射线局部吸收系数的函数的 Radon 变换。由于我们对 X 射线吸收图感兴趣，我们需要计算<em class="mm">逆拉冬变换</em>。</p><h1 id="4dd5" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">逆拉冬变换</h1><p id="8c6b" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">我们可以通过利用<a class="ae kr" href="https://en.wikipedia.org/wiki/Projection-slice_theorem" rel="noopener ugc nofollow" target="_blank">傅立叶切片定理</a>得到逆 Radon 变换的近似:</p><blockquote class="mn mo mp"><p id="6090" class="ks kt mm ku b kv kw jr kx ky kz ju la mq lc ld le mr lg lh li ms lk ll lm ln ij bi translated">对于给定的θ=θ₀，Rf(ρ，θ₀)(在ρ上积分)的 1D 傅立叶变换是 F(u，v)(f(x，y)的 2D 傅立叶变换)穿过原点并沿着θ₀ + <strong class="ku ir"> π </strong> /2 的切片视图。</p></blockquote><p id="cd12" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">图 4 中的每一列都生成了一个 1D 频谱，并粘贴到 2D 频谱 F(u，v)中。有了大量的投影，我们可以建立一个“径向密集”的 2D 光谱(参见图 6)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c9a8b1022899ed1c6ba37ad7535770ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*KF_kgrMGQiU2m2qzDqNsjA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 6:傅立叶切片定理。图片由作者提供。</p></figure><blockquote class="mn mo mp"><p id="4add" class="ks kt mm ku b kv kw jr kx ky kz ju la mq lc ld le mr lg lh li ms lk ll lm ln ij bi translated">你的意思是我们必须把任意角度的 1D 谱粘贴到定义在矩形网格上的 2D 谱上吗？</p></blockquote><p id="5b06" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">是的。你可以猜到，逆拉冬变换是一个插值节。幸运的是，<em class="mm"> skimage </em>库已经为我们完成了这项工作，计算 Radon 逆变换非常简单:</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="263a" class="nd lq iq mz b gy ne nf l ng nh">from skimage.transform import iradon<br/>reconstruction = iradon(sinogram, theta=thetas, filter_name='ramp')</span></pre><h1 id="a3a7" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">BGA 密度图</h1><p id="f676" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">将逆 Radon 变换应用于图 4 的正弦图，我们获得以下密度图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a0ce5d956769f725d6e05b175c2788f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*OVYsMyugfrEyT_aVH4SZ8A.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 7:图 4 的逆 Radon 变换。图片由作者提供。</p></figure><p id="5cb6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因为逆 Radon 变换不精确，所以重建有点嘈杂。质量受到投影角度的数量和用于将 2D 谱的矩形点阵与 1D 切片的极坐标匹配的插值方法的影响。</p><p id="3633" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然而，我们可以看到 BGA 的 16 x 16 单个金属连接。在图像中心的左侧，有一个不应该在那里的小而密集的物体。我们发现了一个<em class="mm">微珠</em>，这是影响 BGA 的缺陷之一，只有通过计算机断层扫描才能看到。</p><h1 id="5e21" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">结论</h1><p id="1d0a" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">我们用计算机断层扫描模拟了 BGA 的检测。这让我们引入了拉冬变换及其逆运算。</p><p id="47fa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们通过整合多个角度的投影来构建 BGA 的正弦图。正弦图的逆拉冬变换揭示了物体密度图。</p><h2 id="53fc" class="nd lq iq bd lr nj nk dn lv nl nm dp lz lb nn no mb lf np nq md lj nr ns mf nt bi translated">有奖游戏</h2><p id="adb7" class="pw-post-body-paragraph ks kt iq ku b kv mh jr kx ky mi ju la lb mj ld le lf mk lh li lj ml ll lm ln ij bi translated">在正弦图中，小物体表现为正弦曲线。我们 BGA 里的微珠打破了对称性。你能感觉到图 4 中看起来不同相的微弱正弦波吗？</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="24cc" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">[1]我们可以将 X 射线沿路径的总吸收建模为一系列短传播长度δX 上的指数吸收的乘积，其中局部吸收系数为αi:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/32262aaba07977aae4b8a00d07fa677f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*o4HbDR3ibfOYq59UdERq1g.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 8:X 射线强度随着射线穿过被测物体而降低。图片由作者提供。</p></figure><p id="9f3e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">检测到的强度 Id 与源强度 I₀的比值可以写为:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/40d968df0d92f8631addd818314e3421.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*18nF_Q9FA1BkLDV0KCIb2Q.png"/></div></figure><p id="42a7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">等式(4)告诉我们，-ln(Id/I₀与 x 射线沿其穿过材料的路径遇到的局部吸收系数αi 的总和(极限情况下的积分)成比例。这就是为什么我们可以将 X 射线投影视为物平面中密度图的积分。</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="d00a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi">[2]</p><h2 id="4751" class="nd lq iq bd lr nj nk dn lv nl nm dp lz lb nn no mb lf np nq md lj nr ns mf nt bi translated">傅立叶切片定理的证明</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/72c2defdeb8983071b56a72b62848593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*dCANfwwbdwF8_5y6DBYwNA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">图 9:密度图 f(x，y)及其 2D 傅立叶变换 F(u，v)。图片由作者提供。</p></figure><p id="9a55" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们需要展示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/6d8fc6d7592c549ffa2c30e4f793a074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*0V0XRD3CB3vDH6tpLXDPag.png"/></div></figure><p id="8702" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">将(1)插入到 1D 傅立叶变换的定义中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="og oh di oi bf oj"><div class="gh gi of"><img src="../Images/794bbb2ef73bb72cf57abcff621e82b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhcnK7EYSMDQnmXOvdasmg.png"/></div></div></figure><p id="480b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">因为变量从(z，ρ)到(x，y)的变化对应于轴的旋转而没有标度变化，所以整个(z，ρ)平面上的积分与整个(x，y)平面上的积分相同。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/1729e2972389c5ed4cc92ee21751f555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*sCx79if9eYyLm_KzTJTL-Q.png"/></div></figure></div></div>    
</body>
</html>