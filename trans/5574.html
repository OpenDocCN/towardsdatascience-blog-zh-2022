<html>
<head>
<title>Automating Deep Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化深度神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-deep-neural-networks-d76af8e0c7fa#2022-12-15">https://towardsdatascience.com/automating-deep-neural-networks-d76af8e0c7fa#2022-12-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="abc7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 DeepHyper 自动开发深度神经网络</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/27d92478c35928968d50d827696a28f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*icJd6MO1SxFi0NQE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯里德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="637d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建神经网络模型很困难，因为我们需要估计或找出给定问题的最佳超参数。我们需要决定用于解决问题的层数和神经元数。创建神经网络模型时，需要考虑多个实体。</p><p id="313c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有不同类型的神经网络，即 ANN、CNN、RNN、LSTM 等。对于所有这些模型，都有不同的超参数来帮助提高模型的准确性和性能。为了创建不同类型的神经网络，我们需要遵循一定的步骤。</p><p id="d6d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">DeepHyper 是一个开源的 python 库，它不仅可以自动化创建模型的过程，还可以帮助进行超参数调整和模型评估。这有助于理解黑匣子里发生了什么。</p><p id="afdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将使用一个 DeepHyper 来创建神经网络模型并对其执行操作。</p><p id="fc6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧…</p><h1 id="41c3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装所需的库</h1><p id="25ac" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将从使用 pip 安装 DeepHyper 开始。下面给出的命令可以做到这一点。</p><pre class="kj kk kl km gt ms mt mu bn mv mw bi"><span id="e17e" class="mx lw it mt b be my mz l na nb">pip install deephyper</span></pre><h1 id="d752" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">导入所需的库</h1><p id="bc37" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这一步中，我们将导入所需的库和函数来创建深度学习模型。</p><pre class="kj kk kl km gt ms mt mu bn mv mw bi"><span id="ee49" class="mx lw it mt b be my mz l na nb">from deephyper.problem import HpProblem<br/>from deephyper.evaluator import Evaluator<br/>from deephyper.evaluator.callback import LoggerCallback<br/>from deephyper.search.hps import AMBS<br/>import matplotlib.pyplot as plt</span></pre><h1 id="5180" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建模型</h1><p id="be72" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这一步中，我们将创建需要优化的函数，然后创建搜索空间，还创建评估器接口，最后创建搜索算法。</p><pre class="kj kk kl km gt ms mt mu bn mv mw bi"><span id="f9d4" class="mx lw it mt b be my mz l na nb">def f(config):<br/>    return - config["x"]**2<br/>problem = HpProblem()<br/>problem.add_hyperparameter((-10.0, 10.0), "x")<br/>problem</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/ad702b170bfceefe0dc9c4a979f0b4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/0*xOCdHS5cdaXRquNR.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">功能(来源:作者)</p></figure><p id="bcfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们创建评估器。</p><pre class="kj kk kl km gt ms mt mu bn mv mw bi"><span id="245a" class="mx lw it mt b be my mz l na nb">evaluator = Evaluator.create(<br/>    f,<br/>    method="ray",<br/>    method_kwargs={<br/>        "num_cpus": 1,<br/>        "num_cpus_per_task": 0.25,<br/>        "callbacks": [LoggerCallback()]<br/>    },<br/>)print(f"Evaluator has {evaluator.num_workers} available worker{'' if evaluator.num_workers == 1 else 's'}")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/a7b60fb0225c6470d71d8276e00b042f.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/0*xG0H8o85Ml-_snof.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">评估(来源:作者)</p></figure><p id="1b99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建搜索是最后一步，让我们来完成它。</p><pre class="kj kk kl km gt ms mt mu bn mv mw bi"><span id="94aa" class="mx lw it mt b be my mz l na nb">search = AMBS(problem, evaluator)</span></pre><p id="2f32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建搜索后，我们需要执行一定数量的搜索。</p><pre class="kj kk kl km gt ms mt mu bn mv mw bi"><span id="d6b6" class="mx lw it mt b be my mz l na nb">results = search.search(max_evals=100)<br/>results</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/f394eb2883ee89a023caf8cf44189f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/0*n4qbFgJFMAF5b7w5.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">结果(来源:作者)</p></figure><p id="a8c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用 matplotlib 可视化评估。</p><pre class="kj kk kl km gt ms mt mu bn mv mw bi"><span id="1c37" class="mx lw it mt b be my mz l na nb">plt.plot(results.objective)plt.xlabel("Iterations")<br/>plt.ylabel("$y = f(x)$")plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/8d9cd7385e4c531b44917aa9cbbf1e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/0*FHfKWrHNedJ25Hex.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">结果(来源:作者)</p></figure><p id="ec7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们可以清楚地看到目标以及它是如何向 0 收敛的。继续尝试，如果你发现任何困难，请在回复部分告诉我。</p><p id="56ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文是与<a class="ng nh ep" href="https://medium.com/u/40808d551f5a?source=post_page-----d76af8e0c7fa--------------------------------" rel="noopener" target="_blank">皮尤什·英加尔</a>合作完成的</p><h1 id="a874" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在你走之前</h1><p id="85c9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu"> <em class="ni">感谢</em> </strong> <em class="ni">的阅读！如果你想与我取得联系，请随时通过 hmix13@gmail.com 联系我或我的</em> <a class="ae ky" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="ni"> LinkedIn 个人资料</em> </strong> </a> <em class="ni">。可以查看我的</em><a class="ae ky" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="ni">Github</em></strong><em class="ni"/></a><em class="ni">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae ky" href="https://medium.com/@hmix13" rel="noopener"> <strong class="lb iu"> <em class="ni">我的简介</em> </strong> </a> <em class="ni">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>