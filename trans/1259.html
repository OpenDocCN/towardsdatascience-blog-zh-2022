<html>
<head>
<title>How to Create an Object Detection Solution with AWS and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 AWS 和 Python 创建对象检测解决方案</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-an-object-detection-solution-with-aws-and-python-8b20690686c5#2022-03-30">https://towardsdatascience.com/how-to-create-an-object-detection-solution-with-aws-and-python-8b20690686c5#2022-03-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="395f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从头开始部署无服务器、事件驱动的对象检测解决方案的端到端教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/57939f01179443176d5cbd61d9287b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqeyJiAPorwvmiBjBbxEeA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><h1 id="597b" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated"><strong class="ak">目录</strong></h1><ol class=""><li id="3539" class="lq lr it ls b lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><a class="ae mi" href="#0aa7" rel="noopener ugc nofollow">简介</a></li><li id="df30" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md me mf mg mh bi translated"><a class="ae mi" href="#5fd8" rel="noopener ugc nofollow">实现</a> <br/> 2.1 <a class="ae mi" href="#289a" rel="noopener ugc nofollow"> S3 木桶</a> <br/> 2.2 <a class="ae mi" href="#ba42" rel="noopener ugc nofollow">角色和策略</a><br/>2.3<a class="ae mi" href="#c235" rel="noopener ugc nofollow">λ函数</a> <br/> 2.4 <a class="ae mi" href="#d20b" rel="noopener ugc nofollow">我们来试试</a>！</li><li id="ab48" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md me mf mg mh bi translated"><a class="ae mi" href="#ece8" rel="noopener ugc nofollow">结论</a></li><li id="7001" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md me mf mg mh bi translated"><a class="ae mi" href="#55a9" rel="noopener ugc nofollow">参考文献</a></li></ol><h1 id="0aa7" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated"><strong class="ak"> 1。简介</strong></h1><p id="dff9" class="pw-post-body-paragraph mo mp it ls b lt lu ju mq lv lw jx mr lx ms mt mu lz mv mw mx mb my mz na md im bi translated">对象检测是一种计算机视觉技术，允许识别和定位图像或视频中的对象。</p><p id="add9" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">在本帖中，我们将开发一个基于 AWS 的<strong class="ls iu">无服务器、事件驱动的对象检测解决方案</strong>，AWS 是一个流行的云提供商。</p><p id="5158" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">我们可以将解决方案描述如下:</p><ol class=""><li id="fe9f" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md me mf mg mh bi translated">一张图片将被加载到亚马逊 S3 的一个对象存储服务中。</li><li id="6e7b" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md me mf mg mh bi translated">将图片加载到 S3 的事件将触发使用<strong class="ls iu"> AWS Lambda </strong>实现的功能的执行。AWS Lambda 是一个<strong class="ls iu">无服务器</strong>、<strong class="ls iu">事件驱动的</strong>计算服务。它支持在不提供或管理底层基础设施的情况下运行我们的代码。</li><li id="e171" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md me mf mg mh bi translated">该功能将调用人工智能(AI)服务<strong class="ls iu"> Amazon Rekognition </strong>，以分析图像并返回已识别的标签。</li><li id="2b80" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md me mf mg mh bi translated">我们的代码会将日志写到<strong class="ls iu"> Amazon CloudWatch </strong>进行监控。</li><li id="6cec" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md me mf mg mh bi translated">该功能将把分析的输出作为 JSON 文件保存回<strong class="ls iu"> S3 </strong>以备将来使用。</li></ol><p id="5485" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">本教程的唯一先决条件是一个活跃的<strong class="ls iu"> AWS 账户</strong>。由于 AWS 提供了<strong class="ls iu">免费层</strong>，我们可以零成本地学习本教程。</p><h1 id="5fd8" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">2.履行</h1><p id="806b" class="pw-post-body-paragraph mo mp it ls b lt lu ju mq lv lw jx mr lx ms mt mu lz mv mw mx mb my mz na md im bi translated">接下来的段落将分享构建解决方案的详细、逐步的过程。</p><h2 id="289a" class="nj kz it bd la nk nl dn le nm nn dp li lx no np lk lz nq nr lm mb ns nt lo nu bi translated"><strong class="ak"> 2.1 S3 吊桶</strong></h2><p id="e951" class="pw-post-body-paragraph mo mp it ls b lt lu ju mq lv lw jx mr lx ms mt mu lz mv mw mx mb my mz na md im bi translated">桶是存放在 S3 的物品的容器。对于本教程，我们想要创建两个不同的存储桶，分别存储输入图像和分析输出。</p><p id="9109" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">我们按如下方式创建输入存储桶:</p><ul class=""><li id="778a" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">打开 AWS 控制台。</li><li id="5ec4" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">在页面顶部的搜索栏中输入“<em class="nw"> S3 </em>”。</li><li id="d5cb" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">打开“<em class="nw">亚马逊 S3 </em>，然后点击“<em class="nw">创建桶</em>”。</li><li id="50ce" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">在“时段创建”页中，提供时段名称和 AWS 区域。</li><li id="6096" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">对于输入桶，我们选择名称<code class="fe nx ny nz oa b">input-img-dev-032022</code>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/a69d8bfb240c82ece8ef5c15693d49af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QV0ufEAtGEuSXVknmwH5nw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输入桶的创建。图片作者。</p></figure><p id="e451" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">我们重复相同的步骤来创建输出桶，将其命名为<code class="fe nx ny nz oa b">output-img-dev-032022</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/f1507d268399cc8ca52da58e0e827726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*05HZ5_AcbAGIpldXy28HNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输入和输出桶。图片作者。</p></figure><p id="fb95" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">我们可以选择其他的存储桶名称，假设在接下来的步骤中应该一致地使用它们。</p><h2 id="ba42" class="nj kz it bd la nk nl dn le nm nn dp li lx no np lk lz nq nr lm mb ns nt lo nu bi translated">2.2 角色和政策</h2><p id="09cc" class="pw-post-body-paragraph mo mp it ls b lt lu ju mq lv lw jx mr lx ms mt mu lz mv mw mx mb my mz na md im bi translated">我们需要我们的 Lambda 函数有权限:</p><ul class=""><li id="1f76" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated"><strong class="ls iu">从<strong class="ls iu"> S3 </strong>读取</strong>图像。</li><li id="24a9" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><strong class="ls iu">发送</strong>图像到<strong class="ls iu">识别</strong>检测标签。</li><li id="0332" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><strong class="ls iu">写</strong>结果回<strong class="ls iu"> S3 </strong>。</li><li id="a88e" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><strong class="ls iu">将</strong>日志写入<strong class="ls iu"> CloudWatch </strong>。</li></ul><p id="3f65" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">在 AWS 中，这样的权限被称为<strong class="ls iu"> <em class="nw">策略</em> </strong>。我们需要定义所需的策略，并将它们附加到一个身份上，比如一个<strong class="ls iu"> <em class="nw">角色</em> </strong>。稍后，我们可以向服务授予身份，以定义与该服务相关联的权限。</p><p id="ec19" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">在我们的例子中，我们将创建策略并将它们附加到角色。然后，我们将把角色与 Lambda 函数关联起来。</p><p id="a946" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated"><strong class="ls iu">创建策略</strong></p><ul class=""><li id="ca92" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">单击 AWS 控制台顶部的帐户名称。</li><li id="fe87" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">选择<em class="nw">安全凭证</em>。</li><li id="4039" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">从左侧菜单中选择“<em class="nw">策略</em>，然后选择“<em class="nw">创建策略</em>”。</li><li id="c515" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">在下一页中，点击<em class="nw"> JSON </em>。</li><li id="2611" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">在文本框中，添加以下代码:</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><ul class=""><li id="721b" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">点击“<em class="nw">下一步:标签</em>”，然后点击“<em class="nw">下一步:查看</em>”。</li><li id="11a5" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">最后，将策略命名为<code class="fe nx ny nz oa b">obj-detect-policy-dev-032022</code>，并单击<em class="nw">创建策略</em>。</li></ul><p id="3c7b" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated"><strong class="ls iu">政策详情</strong></p><ul class=""><li id="b5b2" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">我们的策略被定义为<code class="fe nx ny nz oa b">Statement</code>属性中的 JSON 对象。</li><li id="4064" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">每个策略对象由<br/> - <code class="fe nx ny nz oa b">Effect</code>组成:指定语句的结果是<code class="fe nx ny nz oa b">Allow</code>还是<code class="fe nx ny nz oa b">Deny</code>。<br/> - <code class="fe nx ny nz oa b">Action</code>:所需权限列表。例如，<code class="fe nx ny nz oa b">S3:GetObject</code>将让我们从 S3 读取对象，而<code class="fe nx ny nz oa b">S3:PutObject</code>将允许我们将它们保存到一个桶中。<br/> - <code class="fe nx ny nz oa b">Resource</code>:策略适用的资源。AWS 要求通过他们的<em class="nw">亚马逊资源名称(ARN) </em>来识别资源。</li><li id="52cd" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">在复制代码时，我们应该用创建服务的 AWS 区域替换:<br/> - <code class="fe nx ny nz oa b">&lt;REGION&gt;</code>。<br/> - <code class="fe nx ny nz oa b">&lt;AWS ACCOUNT ID&gt;</code>具有唯一标识 AWS 账户的 12 位数字。</li><li id="382b" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">要了解更多关于 ARN 和政策的信息，我们应该查阅官方文件。例如，资源<code class="fe nx ny nz oa b">arn:aws:s3:::*</code>没有指定帐户 ID 的区域。这是因为在 S3，存储段名称在所有帐户和地区中都是唯一的。</li><li id="d90c" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">通配符符号<code class="fe nx ny nz oa b">*</code>用于标识所有资源。例如，resource: <code class="fe nx ny nz oa b">arn:aws:s3:::*</code>标识所有的桶/对象。</li><li id="cbaa" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">尽管这超出了本文的范围，但我们应该记住最小特权原则:任何参与者都应该只拥有完成任务所需的最小权限。</li></ul><p id="554b" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated"><strong class="ls iu">创建角色</strong></p><ul class=""><li id="2a20" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">单击 AWS 控制台顶部的帐户名称。</li><li id="a288" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">选择<em class="nw">安全凭证</em>。</li><li id="9f23" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">从左侧菜单中选择“<em class="nw">角色</em>，然后选择“<em class="nw">创建角色</em>”。</li><li id="5938" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">在<em class="nw">选择可信实体</em>页面:<br/> -对于<em class="nw">可信实体类型</em>，点击<em class="nw"> AWS 服务</em>。<br/> -对于<em class="nw">用例</em>，选择<em class="nw">λ</em>。</li><li id="e1f9" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">点击<em class="nw">下一个</em>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/853275fd0d9fe5b6570ecaec17b39020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bF9H4Z2mJr4NTJ-DazKvXw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">选择可信实体。图片作者。</p></figure><ul class=""><li id="18e9" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">从“<em class="nw">权限策略</em>菜单中，选择之前创建的策略<code class="fe nx ny nz oa b">obj-detect-policy-dev-032022</code>，并将其添加到角色中。</li><li id="7832" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">点击<em class="nw">下一个</em>。</li><li id="e720" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">给角色命名为<code class="fe nx ny nz oa b">obj-detect-role-dev-032022</code>，点击<em class="nw">创建角色</em>。</li></ul><p id="c211" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">我们已经定义了一组所需的权限(策略)，并将它们附加到一个身份(角色)上。我们可以继续创建 Lambda 函数。</p><h2 id="c235" class="nj kz it bd la nk nl dn le nm nn dp li lx no np lk lz nq nr lm mb ns nt lo nu bi translated">2.3λ函数</h2><ul class=""><li id="124b" class="lq lr it ls b lt lu lv lw lx ly lz ma mb mc md nv mf mg mh bi translated">从 AWS 控制台，在页面顶部的搜索栏上键入“<em class="nw"> lambda </em>”。</li><li id="97bb" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">选择“<em class="nw">λ</em>”服务。</li><li id="ab27" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">lambda 函数的 AWS 区域应该与 S3 输入桶的区域相同。可以通过 AWS 控制台右上角的下拉菜单来更改区域。</li><li id="5231" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">点击<em class="nw">创建功能</em>，然后:<br/>——从头选择<em class="nw">作者</em>。<br/> -对于函数名，键入:<code class="fe nx ny nz oa b">obj-detect-dev-032022</code>。<br/> -对于<em class="nw">运行时</em>，选择<em class="nw"> Python 3.7 </em>。<br/> -对于<em class="nw">执行角色</em>，选择<em class="nw">使用现有角色</em>，并提供之前创建的角色名称。</li><li id="7f0e" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">点击<em class="nw">创建功能</em>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/6cc7862ff184c16df311719a9b4d7539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*df5fmxo4560mMy0NqG5VCg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Lambda 函数创建页面。图片作者。</p></figure><ul class=""><li id="c142" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">在功能页面中，选择“<em class="nw"> +添加触发器</em>”。我们希望配置该函数来运行，以响应亚马逊 S3 上传。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/66db48eb7e5fcfaa33a8e2326526bc57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDjf89I4-IycTIRcTRZz0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><ul class=""><li id="e8aa" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated">在<em class="nw">添加触发</em>页面:<br/> -选择<em class="nw"> S3 </em>作为输入。<br/> -提供桶名:<code class="fe nx ny nz oa b">input-img-dev-032022</code>。这是最初加载图像的桶。<br/> -事件类型:<em class="nw">放</em>。</li><li id="6732" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">勾选信息框，点击<em class="nw">添加</em>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/694606920a4dc873269d6b29d285a678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qIR92niDcyiUoByNFuYxHg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">触发配置。图片作者。</p></figure><p id="ea7f" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">功能页面现在如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/3d90bca60c59333c429fafa9ace93ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JE_qDalhzpODIMrUuOHsRw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="44f3" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated"><em class="nw">就是这样！</em></p><p id="461f" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">我们终于可以用 Python 写应用程序逻辑了。在功能页面的“<em class="nw">代码</em>”选项卡下，让我们将它粘贴到文本框中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="0eb8" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated"><strong class="ls iu">关于代码</strong></p><ul class=""><li id="36ff" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated"><em class="nw"> Boto3 </em>是 Python 的 AWS SDK。我们用它与其他 AWS 服务进行交互:S3 ( <code class="fe nx ny nz oa b">boto3.client("s3")</code>)和 Rekognition ( <code class="fe nx ny nz oa b">boto3.client("rekognition")</code>)。</li><li id="8eba" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><code class="fe nx ny nz oa b">Label</code>类存储 Rekognition 检测到的标签(名称和置信度)。</li><li id="417b" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><code class="fe nx ny nz oa b">Response</code>类存储被分析的对象、完整的元数据和一个列表<code class="fe nx ny nz oa b">Labels</code>。<code class="fe nx ny nz oa b">Response</code>类通过<code class="fe nx ny nz oa b">rekognition.detect_labels()</code>方法实现对 Rekognition 的调用。</li><li id="821f" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><code class="fe nx ny nz oa b">rekognition.detect_labels()</code>方法接受以下参数:<br/> - <code class="fe nx ny nz oa b">MaxLabels</code>:我们希望 Rekognition 返回的标签的最大数量。<br/> - <code class="fe nx ny nz oa b">MinConfidence</code>:最小置信度阈值。Rekognition 不会返回置信度低于此值(默认值:55%)的标签。</li><li id="700b" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><code class="fe nx ny nz oa b">save_analysis()</code>函数将一个对象作为输入，并将其存储在输出 S3 桶中。它利用了<code class="fe nx ny nz oa b">s3.put_object()</code>方法。</li><li id="9abd" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated">调用 Lambda 函数时运行<code class="fe nx ny nz oa b">lambda_handler(event, context)</code>方法。它传递触发执行的事件对象。</li></ul><h2 id="d20b" class="nj kz it bd la nk nl dn le nm nn dp li lx no np lk lz nq nr lm mb ns nt lo nu bi translated">2.4 我们来试试吧！</h2><p id="7703" class="pw-post-body-paragraph mo mp it ls b lt lu ju mq lv lw jx mr lx ms mt mu lz mv mw mx mb my mz na md im bi translated">我们可以添加任何图片到输入桶(AWS 控制台&gt;亚马逊 S3 &gt;桶&gt;输入桶&gt; "<em class="nw">上传</em>")。一个例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/a4496dc18da21842d30ea17728230fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ANCyxa_XwmP-YTa75hvq-A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">意大利佛罗伦萨韦基奥桥。图片作者。</p></figure><p id="da13" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">标签检测过程由上传自动触发。我们可以通过 AWS CloudWatch 日志来查看。要检查它们，我们应该进入 Lamba 功能页面，打开“<em class="nw">监视器</em>选项卡，然后“<em class="nw">查看 CloudWatch </em>中的日志”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/9c9294895833c064042f4c8c3286069a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KPdfw72RmsxIsBmqF1Jacg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="fe3c" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">识别出的标签很好的描述了图片:<code class="fe nx ny nz oa b">urban</code>、<code class="fe nx ny nz oa b">outdoors</code>、<code class="fe nx ny nz oa b">water</code>、<code class="fe nx ny nz oa b">waterfront</code>、<code class="fe nx ny nz oa b">architecture</code>等。</p><p id="76ea" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">亚马逊 Rekognition 可以返回的标签包括在一张图片中找到的<strong class="ls iu"> <em class="nw">物体</em></strong><strong class="ls iu"><em class="nw">场景</em></strong><strong class="ls iu"><em class="nw">动作</em> </strong>和<strong class="ls iu"> <em class="nw">概念</em> </strong>。产品文档中提供了更多信息。</p><p id="aa02" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">让我们检查分析是否也保存在输出桶中:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/74ac016ecb1f9eabeb69380bba853116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iI__SWoyAP5pmW_o5BuSVQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出桶。图片作者。</p></figure><p id="7ae3" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">我们可以下载并检查该文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6aa27f316fe79314d4e88ed7ca440e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*kuySRoQ8nhh1TB2HmysHfg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">保存的文件。图片作者。</p></figure><h1 id="ece8" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">3.结论</h1><p id="84bd" class="pw-post-body-paragraph mo mp it ls b lt lu ju mq lv lw jx mr lx ms mt mu lz mv mw mx mb my mz na md im bi translated">在这篇文章中，我们利用 AWS 快速部署了一个无服务器和事件驱动的图像分析解决方案。</p><p id="1c5f" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">如今，像 S3 这样的对象存储服务是图片等非结构化数据最流行的存储目标。为此，类似的方法可以很容易地从大量图像文件中提取有用的信息。随着分析被保存回 S3，它可用于进一步的服务。搜索引擎和商业报告工具可能会产生吸引人的和可消化的见解。</p><p id="bbae" class="pw-post-body-paragraph mo mp it ls b lt nb ju mq lv nc jx mr lx nd mt mu lz ne mw mx mb nf mz na md im bi translated">在非功能性要点中，我们提醒:</p><ul class=""><li id="5dae" class="lq lr it ls b lt nb lv nc lx ng lz nh mb ni md nv mf mg mh bi translated"><strong class="ls iu">采用托管服务</strong>，这样我们就不必处理复杂耗时的基础设施设置。</li><li id="9f14" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><strong class="ls iu">成本效益</strong>:有了 AWS Lambda，我们只需为我们有效使用的资源付费。代码不运行时不收费。此外，使用亚马逊 Rekognition 等人工智能服务可以消除开发复杂机器学习模型的相关成本。</li><li id="1490" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><strong class="ls iu">通过设计实现自动化和可伸缩性:</strong>该过程是事件驱动的，并且在新映像可用时立即开始。此外，AWS Lambda 会自动缩放代码。</li></ul><h1 id="55a9" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">4.参考</h1><ul class=""><li id="d649" class="lq lr it ls b lt lu lv lw lx ly lz ma mb mc md nv mf mg mh bi translated"><a class="ae mi" href="https://docs.aws.amazon.com/s3/index.html" rel="noopener ugc nofollow" target="_blank">亚马逊简单存储服务(S3)文档</a></li><li id="486e" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><a class="ae mi" href="https://docs.aws.amazon.com/lambda/index.html" rel="noopener ugc nofollow" target="_blank"> AWS Lambda 文档</a></li><li id="655d" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><a class="ae mi" href="https://docs.aws.amazon.com/rekognition/index.html" rel="noopener ugc nofollow" target="_blank">亚马逊认证文档</a></li><li id="5660" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><a class="ae mi" href="https://docs.aws.amazon.com/cloudwatch/index.html" rel="noopener ugc nofollow" target="_blank">亚马逊云观察文档</a></li><li id="1ead" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><a class="ae mi" href="https://docs.aws.amazon.com/iam/index.html" rel="noopener ugc nofollow" target="_blank"> AWS 身份和访问管理文档</a></li><li id="6ba9" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><a class="ae mi" href="https://aws.amazon.com/architecture/" rel="noopener ugc nofollow" target="_blank">亚马逊参考架构</a></li><li id="fa48" class="lq lr it ls b lt mj lv mk lx ml lz mm mb mn md nv mf mg mh bi translated"><a class="ae mi" href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" rel="noopener ugc nofollow" target="_blank"> Boto3 文档</a></li></ul></div></div>    
</body>
</html>