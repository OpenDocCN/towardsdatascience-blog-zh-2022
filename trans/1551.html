<html>
<head>
<title>Measure A/B Testing Platform Health with Simulated A/A and A/B Tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用模拟的A/A和A/B测试测量A/B测试平台的运行状况</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/measure-a-b-testing-platform-health-with-simulated-a-a-and-a-b-tests-7a68b800d0e1#2022-04-14">https://towardsdatascience.com/measure-a-b-testing-platform-health-with-simulated-a-a-and-a-b-tests-7a68b800d0e1#2022-04-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="63fe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们如何通过模拟来确保我们的A/B测试平台的可靠性</h2></div><p id="4dba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">投稿人:<a class="ae lb" href="https://medium.com/@qike_max_li" rel="noopener"> Max李</a>，<a class="ae lb" href="https://www.linkedin.com/in/zhengwen-jia-b32441157/" rel="noopener ugc nofollow" target="_blank">孙耀威贾</a></p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/23f3f944e7947e2ee85c94ec2cf7152a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DOgSxE5-BNlZqWYK"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@wwarby?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">威廉·沃比</a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="365b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">A/B测试在数据驱动型公司的决策中起着至关重要的作用。这通常是新产品设计、商业策略、机器学习模型等的成败的最终决定权。A/B测试平台中的不准确性降低了从A/B测试中得出的所有商业决策。在本文中，我们分享了不断评估A/B测试平台可靠性的方法，以确保实验平台值得信赖。</p><p id="8b2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">连续评估的目标是测量<a class="ae lb" href="https://en.wikipedia.org/wiki/Type_I_and_type_II_errors" rel="noopener ugc nofollow" target="_blank">I型误差</a>率和<a class="ae lb" href="https://en.wikipedia.org/wiki/Power_of_a_test" rel="noopener ugc nofollow" target="_blank">功率</a>，等于1-<a class="ae lb" href="https://en.wikipedia.org/wiki/Type_I_and_type_II_errors" rel="noopener ugc nofollow" target="_blank">II型误差</a>率。第一类错误率和功效决定了<a class="ae lb" href="https://en.wikipedia.org/wiki/Statistical_hypothesis_testing" rel="noopener ugc nofollow" target="_blank">假设检验</a>的质量。类型I错误(误报)通常是当新功能对业务指标没有重大影响时，对有益/有害产品功能的错误声明。发布一个没有影响的特性是一种浪费，可能会导致在一个没有结果的领域的进一步投资。第二类错误(假阴性)导致得出有益/有害产品特征是中性的结论。当我们基于错误的A/B测试结果，扼杀一个可能需要几个月来构建的产品特性时，这是一个机会的错过。</p><h1 id="a7fd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">模拟A/A测试测量第一类错误率</h1><p id="0d24" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">为了测量I型错误率(假阳性率)，我们每天使用过去七天积累的数据运行500次模拟A/A测试。每个模拟的A/A测试将用户随机分为控制组和处理组，并以与生产指标计算管道相同的方式计算两个实验组的指标。</p><p id="2f9f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它需要大量的A/A测试来精确地测量I型错误率，但是用实时用户流量运行所有的重复测试成本太高。模拟A/A测试离线运行，因此对应用/网站延迟没有影响。</p><p id="1aa3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们发现在I型错误率测量中，500次重复在计算成本和精度之间取得了平衡。在标称<em class="mp"> p </em>值阈值为0.05的情况下，对于可靠的A/B测试平台，预期的I型错误率(假阳性率)为5%。假设我们的假阳性率确实是5%，那么<a class="ae lb" href="https://en.wikipedia.org/wiki/Monte_Carlo_method" rel="noopener ugc nofollow" target="_blank">蒙特卡洛模拟</a>中的每次重复都是一次独立的<a class="ae lb" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noopener ugc nofollow" target="_blank">伯努利试验</a>，成功概率为5%。因此，我们的假阳性测量的95%置信区间(CI)为</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/f770bb4313ae1738bbc626ba738a8223.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/0*0OSxMo0VlJDr-K_2"/></div></figure><p id="2833" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">CI随着重复次数的平方根缩小(<em class="mp"> n </em>)。下表显示了不同重复次数下计算的CI。</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="mr ms l"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">表1。CI随着重复次数的平方根(<em class="mt"> n </em>)而缩小</p></figure><p id="8422" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图1展示了一个仪表板，用于监控一段时间内的误报率。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mu"><img src="../Images/5803d81193189df261563c7bf8510978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lAaOR_o_yl5JpimS"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">图一。连续假阳性率评估</p></figure><p id="3eb6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，我们不断评估来自模拟A/A测试的<em class="mp"> p </em>值的分布。当零假设为真，并且满足所有其他假设时，<em class="mp">p</em>-值应均匀分布[1]。零假设为μ1=μ2，其中μ1和μ2分别是对照桶和处理桶的总体均值。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mu"><img src="../Images/1cea687031f8014aaa85a2d7773accb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7x_uB2Efp2PSxKVc"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">图二。A/A测试的p值分布</p></figure><h1 id="b22b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">模拟A/B测试测量功率</h1><p id="7fb6" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Power_of_a_test" rel="noopener ugc nofollow" target="_blank">统计功效</a>，等于1-类型II错误(假阴性)率，同样重要，但由于缺乏基本事实，评估起来更具挑战性。我们通常没有能够提高指标的产品特性。否则，我们早就实施了。另一方面，使用劣质版本的产品来评估A/B测试平台的假阳性将是昂贵的，有时甚至是不道德的。模拟A/B测试使我们能够在不影响用户体验的情况下评估各种业务场景中的能力。</p><p id="b96d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们与模拟A/A测试类似地进行模拟A/B测试，除了我们在处理组中引入合成差异，即，为处理组中的用户增加1%的度量值。在模拟A/B测试中，我们知道由于综合引入的差异，零假设(即，无效果)不成立。模拟A/B测试中的任何中性结果(没有统计意义的结果)都是第二类错误(假阴性)。</p><p id="52c4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，通过模拟，我们可以在各种场景中评估A/B测试的能力。一些说明性的场景是:</p><ul class=""><li id="a08d" class="mv mw iq kh b ki kj kl km ko mx ks my kw mz la na nb nc nd bi translated">对照和处理之间不同水平的度量差异:0.1%、0.2%、0.5%等。</li><li id="0f5c" class="mv mw iq kh b ki ne kl nf ko ng ks nh kw ni la na nb nc nd bi translated">不同模式的差异:新产品功能主要影响重度用户，新产品指标的有效性取决于用户属性(如年龄、地理位置、语言)等。</li></ul><p id="f9de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注:典型的<a class="ae lb" href="https://en.wikipedia.org/wiki/Power_of_a_test#Power_analysis" rel="noopener ugc nofollow" target="_blank">功效分析</a>相当于具有一致差异的模拟A/B测试——处理桶中的总体平均值一致移动X量。通过模拟的A/B测试，我们可以理解具有更复杂业务假设的A/B测试的统计能力。</p><p id="d198" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图3显示了不同高度的模拟A/B测试的结果，其中有一个&lt; b &lt; c &lt; d. When the lift reaches c%, most metrics have sufficient powers. Also, even when the lifts are the same, different metrics have different levels of power due to the difference in the variances of the metrics.</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mu"><img src="../Images/2391f54ab0fd4f2d11cc10c2e00b67e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QNd-vRYm8JnX-zh1"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">Fig 3. Continuous false negative rate evaluation</p></figure><h1 id="3473" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Conclusion</h1><p id="87df" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">The more we improve our A/B testing platform, the more we realize that devil is in the details. It is surprisingly hard to get your A/B testing right. Something seemingly straightforward can lead to <a class="ae lb" rel="noopener" target="_blank" href="/assign-experiment-variants-at-scale-in-a-b-tests-e80fedb2779d">严重缺陷</a>，看似合理的方法可能会产生非常<a class="ae lb" rel="noopener" target="_blank" href="/how-wish-a-b-tests-percentiles-35ee3e4589e7">不准确的结果</a>。对A/B测试平台的健康状况进行系统评估至关重要。模拟A/A和A/B测试持续测量平台的健康状况。</p><p id="15c4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的目标是在未来的工作中使我们的评估更加全面和方便。尽管由于使用来自所有用户的数据，我们当前的模拟A/A测试是通用的，但我们计划通过按需安排A/A测试来启用特定于实验的模拟A/A测试，仅让用户参与特定实验。此外，我们计划在模拟的A/B测试中添加更复杂的场景，以代表各种各样的业务案例。</p><h1 id="b03e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">感谢</h1><p id="cbac" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">感谢齐超对这个项目的贡献。我们也感谢Pai Liu的支持，以及Pavel Kochetkov、Lance Deng和Delia Mitchell的反馈。</p><p id="1c45" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Wish的数据科学家热衷于构建一个值得信赖的实验平台。如果你对解决这一领域的挑战性问题感兴趣，我们正在为数据科学团队<a class="ae lb" href="https://www.wish.com/careers/jobs" rel="noopener ugc nofollow" target="_blank">招聘</a>。</p><h1 id="fd54" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><p id="76f4" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">[1] Murdoch，Duncan J .，蔡玉玲，和James Adcock，<a class="ae lb" href="https://www.tandfonline.com/doi/abs/10.1198/000313008X332421" rel="noopener ugc nofollow" target="_blank">《P值是随机变量》</a> (2008)，美国统计学家，62.3:242–245。</p></div></div>    
</body>
</html>