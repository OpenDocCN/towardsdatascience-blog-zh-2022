<html>
<head>
<title>📢 Sentiment Analysis on Google Sheets with VADER using Python and Google Cloud Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">📢使用Python和谷歌云功能的VADER对谷歌表单的情感分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sentiment-analysis-on-google-sheets-with-vader-using-python-and-google-cloud-functions-e767985ed27d#2022-08-02">https://towardsdatascience.com/sentiment-analysis-on-google-sheets-with-vader-using-python-and-google-cloud-functions-e767985ed27d#2022-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3b47" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用于情感分析的云函数配方</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/edf2fe49e55830933131da1a6afc81db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rSoAoJqIk4NkOIvwNEO6sg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">jkozoski在Unsplash上拍摄的照片</p></figure><h2 id="0022" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">TLDR</h2><p id="a500" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们将讨论如何建立一个基本的工作流程来对谷歌表单中的文本进行简单的情感分析。具体来说，我们将:</p><ol class=""><li id="53c6" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj mr ms mt mu bi translated">使用Python和Google Sheets API读取电子表格中的评论数据</li><li id="6c20" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj mr ms mt mu bi translated">应用<a class="ae na" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank"> VADER </a>(休顿&amp;吉尔伯特，2014)，一个来自<a class="ae na" href="https://github.com/nltk/nltk" rel="noopener ugc nofollow" target="_blank"> nltk </a>包的开源情感分析器来执行情感分析</li><li id="58e6" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj mr ms mt mu bi translated">将结果写入谷歌电子表格的另一个标签</li><li id="1945" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj mr ms mt mu bi translated"><strong class="lt ir">奖励</strong>:将Python代码部署到谷歌云功能上，这样你就可以直接从谷歌表单上在线运行你的Python代码，而不是在你的本地机器上。</li></ol><p id="9afc" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">这个循序渐进的指南使用非常基本的例子来帮助那些刚开始使用Python和情感分析的人。我对我的Python代码做了大量的注释，希望能让它更容易理解。</p><h2 id="1c93" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">语境</h2><p id="4952" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">已经有很多很棒的教程解释了如何使用Python进行情感分析，但没有多少详细介绍了如何将情感分析代码推送到Google Cloud函数。许多设置云功能的教程都非常普通，使用“hello world！”股票示例。对于想要学习的初学者来说，Google Cloud文档也可能令人困惑。</p><p id="51e0" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">考虑到上述情况，本文很少进行深入的情感分析(我们将查看极性得分和复合得分，但跳过符号化、可视化结果等)，而是更侧重于如何设置这一切。</p><p id="455f" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">目标是帮助你在Google Cloud上部署你的第一个情绪分析模型。</p><p id="7117" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">💪让我们开始吧！</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="f12f" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi nl translated">客户评论和用户反馈——在处理社交媒体数据或用户体验研究中，经常会遇到这类开放式的定性文本数据。从中可以得出许多真知灼见，例如，一个品牌是受欢迎还是不受欢迎，用户是否会再次使用该产品，以及<em class="nu">为什么</em>有人会推荐或不推荐某样东西。</p><p id="9789" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">当我们阅读所使用的单词时，我们可以判断他们的情绪是积极的、中立的还是消极的。但是想象一下，必须手动阅读和分析数百条用户评论——对于一个人来说，这将是一个非常耗时的过程😪！</p><h2 id="c9ad" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">什么是情感分析</h2><p id="364a" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">简单来说:情感分析是一种自然语言处理方法，用来判断语料数据是正面的、负面的还是中性的。这有时被称为“观点挖掘”。用于评论或意见的大型数据集可以非常快速地进行分析和分类，这可以极大地帮助节省时间并产生更多见解。</p><p id="c5e1" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">💡想象一下，你收到了数千条关于某个特定产品的顾客评论。情感分析可以帮助将这些评论分为正面、中性和负面，并提取正面和负面评论中使用的常用词，从而显示用户喜欢的功能和用户认为产品缺少的功能。这种类型的信息是非常宝贵的，尤其是当我们考虑到它来自产品的实际用户时。</p><h2 id="e803" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">情感分析的局限性</h2><p id="2ae9" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">近年来，自然语言处理领域取得了许多进展。一些例子包括:</p><ul class=""><li id="7a75" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj nv ms mt mu bi translated"><a class="ae na" href="https://ai.googleblog.com/2018/11/open-sourcing-bert-state-of-art-pre.html" rel="noopener ugc nofollow" target="_blank"> BERT </a>，由谷歌开发的双向模型，可以通过从单词的左侧或右侧考虑上下文来帮助它更好地理解句子之间的关系。</li><li id="6f97" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">微软与英伟达一起开发了<a class="ae na" href="https://www.microsoft.com/en-us/research/blog/using-deepspeed-and-megatron-to-train-megatron-turing-nlg-530b-the-worlds-largest-and-most-powerful-generative-language-model/" rel="noopener ugc nofollow" target="_blank"> MT-NLG </a>模型，提高了阅读理解、常识推理和自然语言推理能力。</li><li id="b177" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">最近，为了确保语言不会成为元宇宙及其他地区的障碍，Meta AI正在开发创新，如<a class="ae na" href="https://about.fb.com/news/2022/07/new-meta-ai-model-translates-200-languages-making-technology-more-accessible/" rel="noopener ugc nofollow" target="_blank"> NLLB-200模型</a>，能够翻译200多种不同的语言，包括罕见的语言。它还可以立即将非英语文本翻译成另一种非英语语言，而不必先将源文本翻译成英语，与以英语为中心的模型相比，这提高了翻译的准确性。</li></ul><p id="5aad" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">然而，如果最终目标是让机器能够以人类可以理解的方式理解人类语言，那么还有很长一段路要走🤖！</p><p id="579a" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">例如，有时我们说的话并不是我们真正想说的🤔。此外，像挖苦、讽刺和跨文化引用这样的非平凡例子是NLP建模的细微差别(老实说，甚至是人类！)还在纠结。</p><p id="35ad" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">简而言之:情感分析还不是100%完美的。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="cc85" class="nw kw iq bd kx nx ny nz la oa ob oc ld jw od jx lh jz oe ka ll kc of kd lp og bi translated">练习:使用VADER和谷歌云函数为谷歌表单构建一个基本的Python情感分析工作流</h1><p id="2076" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">幸运的是，我们的练习相当基础，不需要<a class="ae na" href="https://arxiv.org/pdf/2101.03961.pdf" rel="noopener ugc nofollow" target="_blank">万亿参数语言模型</a>😲！</p><p id="0f2b" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">我们在谷歌表单中收到了上百行客户反馈，需要我们进行分析。反馈与特定产品相关，我们需要大致确定评论是正面的、中性的还是负面的。</p><h2 id="906f" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">R和Python中的NLP包</h2><p id="e2c0" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">根据所选择的编程语言，有许多NLP包可供使用。有些R的套装包括<a class="ae na" href="https://cran.r-project.org/web/packages/RSentiment/index.html" rel="noopener ugc nofollow" target="_blank">R sentence</a>、<a class="ae na" href="https://cran.r-project.org/web/packages/syuzhet/vignettes/syuzhet-vignette.html" rel="noopener ugc nofollow" target="_blank"> syuzhet </a>或<a class="ae na" href="https://cran.r-project.org/web/packages/sentimentr/index.html" rel="noopener ugc nofollow" target="_blank">sentence R</a>。在Python中，通过<a class="ae na" href="https://github.com/nltk/nltk" rel="noopener ugc nofollow" target="_blank"> nltk </a>包的<a class="ae na" href="https://textblob.readthedocs.io/en/dev/" rel="noopener ugc nofollow" target="_blank"> TextBlob </a>和<a class="ae na" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank"> VADER </a>(休顿&amp; Gilbert，2014)是可用的。nltk代表自然语言工具包。</p><p id="7ec2" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">在这个Python练习中，我们将学习使用VADER创建一个简单的例子。</p><h2 id="bab8" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">但是，VADER是什么？</h2><p id="8510" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">不，不是星球大战的反派。VADER代表<strong class="lt ir">价感知词典和情感推理机</strong>——一个开源的、词汇的、基于规则的情感分析模型。由C. J .休顿&amp; E. E. Gilbert (2014)开发，它是一种相对快速的无监督方法，能够分析未标记的文本语料库，并且不需要模型训练。</p><p id="6d74" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">它的许多功能包括正确处理带有否定、变价、标点符号甚至一些城市俚语和表情符号的文本🤯🔥🔥！</p><p id="88b5" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">你可以通过Github官方回购<a class="ae na" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank">了解更多信息。</a></p><h1 id="f727" class="nw kw iq bd kx nx oh nz la oa oi oc ld jw oj jx lh jz ok ka ll kc ol kd lp og bi translated">先决条件</h1><p id="2232" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">在继续下一步之前，您需要确保完成以下先决条件:</p><h2 id="6619" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">👉<strong class="ak"> #1您已经</strong> <a class="ae na" href="https://cloud.google.com/free" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">注册了</strong> </a> <strong class="ak">谷歌云。</strong></h2><p id="ffad" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">谷歌云平台(GCP)有一个<a class="ae na" href="https://www.youtube.com/watch?v=ogzJovMsDIU" rel="noopener ugc nofollow" target="_blank">免费层</a>。只要您将资源保持在最低水平，并且不超过概述的阈值，您应该没问题。谷歌还为新注册用户提供300美元的信用额度——但这个基本练习真的不需要。</p><h2 id="0037" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">👉<strong class="ak"> #2您已经在Google Cloud中创建了一个项目。</strong></h2><p id="65b1" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">您需要确保您已经在项目中启用了计费，否则您将无法继续。只要您保持在免费等级的阈值范围内，就不应该向您收费。您可以随时在项目仪表板中关注您的账单，并在不再需要时关闭资源(或项目本身):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/8fa8318211e172385efa84255e44e5f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axX7ZaVNTBC5PX5nfhMyfg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="ccff" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">👉<strong class="ak">您已经启用了所需的API</strong></h2><ul class=""><li id="9569" class="mk ml iq lt b lu lv lx ly le on li oo lm op mj nv ms mt mu bi translated">谷歌工作表API</li><li id="d9e0" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">秘密管理器API</li><li id="58c9" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">云函数API</li></ul><p id="e39d" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">如果您还没有这样做，那么在运行云功能时，系统会提示您启用以下API:</p><ul class=""><li id="3d34" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj nv ms mt mu bi translated">云运行管理API</li><li id="b17c" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">云日志API</li><li id="4be5" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">云构建API</li><li id="2a83" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">云发布/订阅API</li><li id="055c" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">工件注册API</li></ul><p id="f47b" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">要在您的GCP项目中启用这些API，请使用搜索栏或前往GCP左侧的导航菜单，进入API和服务&gt;库:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/45cf1a98e16d11a5aeee92cf7bf3067a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*n-PMf4t6SagvH2AA3vWu7A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="70d5" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">然后搜索API并启用它们:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/79a0c3375e60f25a730bb4a882a2e570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8sXVFeNzVYJxKojs-4aVg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="6788" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">👉<strong class="ak"> #3您已经创建了一个服务帐户。</strong></h2><p id="7c42" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">使用这些API时，我们需要凭证来进行身份验证。为此，在GCP的左侧导航菜单中，选择API和服务&gt;凭据:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/20b727017219aac218a4ca98863b78f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*dn1BuV15aC4tXoAXusaFiQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="af31" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">选择顶部的“创建凭据”，然后选择服务帐户:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/b8c627c0fb5884ee1d4c58111f4f5ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rv7je3LaIJe5tFG3x4Gagg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="3ce9" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">为您的服务帐户命名。这将自动用于填充ID并生成一个<code class="fe ot ou ov ow b">iam.gserviceaccount.com</code>电子邮件地址。</p><blockquote class="ox oy oz"><p id="a3c4" class="lr ls nu lt b lu mm jr lw lx mn ju lz pa nb mb mc pb nc me mf pc nd mh mi mj ij bi translated">⚠️ <strong class="lt ir">记下这个电子邮件地址，因为你以后会用到它！</strong></p></blockquote><p id="0282" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">你现在可以跳过下面截图中的第2步和第3步:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/55b0962cd87fe639d400bd3156e23089.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J6vXG34XrVs7vudy_EH0lA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="1fbc" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">一旦完成，这应该会带你回到主屏幕。找到您刚刚创建的服务帐户，并单击其末尾的铅笔编辑图标:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/b0e8ed5d09cdbb6c96640b9a8b7e642a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j_or01RdxebEhM23zxA-fQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="75a8" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">在下一个屏幕上，单击“Keys”，然后单击“Add Key”，从下拉菜单中选择“Create a New Key”，然后从弹出菜单中选择“JSON”并将其保存在桌面上的某个位置:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pe"><img src="../Images/fdc22292d2eeee7c2c971ae17c0d76e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzOdNHKHUdeDqJLSAyVTfA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="b571" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">👉<strong class="ak"> #4您已经将密钥保存在Secret Manager中。</strong></h2><p id="3090" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">在使用API时，我们将使用Google的Secret Manager来安全地存储和访问凭证，而不是在不安全的代码中直接引用您的密钥。<br/>在顶部搜索栏中搜索“秘密经理”,然后点击秘密经理:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/fb0d95d73cfde3858c07dc43cf17a4fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f_wNRTpY6DWfVmm_DaMcPg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="ff5a" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">然后选择“创建密码”:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/1379b51e500b2a31d3da6cfd20dd9c71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O4QjwrEbIXPasJwr22b9ww.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="5e61" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">给你的秘密取个名字，从你的桌面上传你之前创建的JSON文件，然后选择“创建秘密”:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ph"><img src="../Images/4ffcde09f92e9be3763c45883181ff24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TkEsitCANclOI7xlULfWTg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="8300" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">完成后，在这个屏幕上，勾选你刚刚创建的秘密，然后点击“添加原则”。使用之前创建服务帐户时生成的<code class="fe ot ou ov ow b">iam.gserviceaccount.com</code>电子邮件地址，并确保其角色设置为“Secret Manager Secret Accessor”:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pi"><img src="../Images/6f9790f1788cff6f55799eb1ae5bfb3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ftUWlhLefR9xUupHZG72bw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="fdff" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">👉<strong class="ak"> #5您已经将服务帐户电子邮件地址添加到您的Google表单中。</strong></h2><p id="f964" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">进入包含您想要分析的数据的Google工作表，并将此电子邮件地址作为编辑器分配给该工作表。您可以取消选中“通知”框，然后点按“共享”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/95f651ebc64ecc3e250d93183867b904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*GJ7IbGIBvlgX_NdsAIt_oA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="3740" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">apis已启用。</p><p id="48d0" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✅凭据已创建。</p><p id="e7a2" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">🚀您已经为下一步做好了准备！</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="fcfd" class="nw kw iq bd kx nx ny nz la oa ob oc ld jw od jx lh jz oe ka ll kc of kd lp og bi translated">步骤1:使用Python和Google Sheets API从Google Sheets中检索数据</h1><p id="3536" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">假设您收到了来自100个客户的反馈，数据存储在一个包含3列的Google工作表中:产品ID、客户反馈和客户ID，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/c5c055b3bd6586033e677aad94b59336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*cGEqli_KUeUdgpyUCJTr_w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="d9c2" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">Python和VS代码</h2><p id="1654" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">👨‍💻我们将假设您首先在本地工作，我们使用的是Python 3。当用R编写代码时，我专门使用<a class="ae na" href="https://www.rstudio.com/" rel="noopener ugc nofollow" target="_blank"> RStudio </a>(现在是<a class="ae na" href="https://posit.co/" rel="noopener ugc nofollow" target="_blank"> Posit </a>)，但是因为这是一个Python练习，所以当用Python安装软件包和编程时，我使用<a class="ae na" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VS Code </a>作为我的首选IDE。</p><p id="912c" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">以下步骤假设您使用VS代码。</p><h2 id="72e5" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">安装云代码扩展</h2><p id="62a1" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">如果我们在本地机器上工作，并且在使用Google Cloud APIs时处理认证，我们将需要在VS代码中安装官方的Cloud代码扩展。此处的说明<a class="ae na" href="https://cloud.google.com/code/docs/vscode/install" rel="noopener ugc nofollow" target="_blank">为</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/c75aae1cfab2eeee70bbf7b16f1fc00a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*10gX_HFnueHDX0vadtq7yw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><blockquote class="ox oy oz"><p id="0ed0" class="lr ls nu lt b lu mm jr lw lx mn ju lz pa nb mb mc pb nc me mf pc nd mh mi mj ij bi translated">⚠️ <strong class="lt ir">注意:确保你之后从VS代码登录谷歌云！</strong></p></blockquote><p id="ebe2" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">您可以在屏幕底部看到您是否登录。如果您尚未登录，请单击此处登录:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/09ad6b774a19873860ed2bbf9869e7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vp7Qb3EiU2AiUpo_eQThHA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="8301" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">安装包</strong></h2><p id="77cb" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated"><a class="ae na" href="https://developers.google.com/docs/api/quickstart/python" rel="noopener ugc nofollow" target="_blank"> Google API客户端</a>包含了我们将在Python中使用的所有相关的基于发现的API。安装软件包:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="02fe" class="kv kw iq ow b gy pq pr l ps pt">pip3 install <!-- -->google-api-python-client</span></pre><p id="ac3f" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">我们还需要<a class="ae na" href="https://google-auth.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank"> google.auth </a>包:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="a7d5" class="kv kw iq ow b gy pq pr l ps pt">pip3 install <!-- -->google-auth</span></pre><p id="5561" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">如前所述，我们将使用<a class="ae na" href="https://codelabs.developers.google.com/codelabs/secret-manager-python#3" rel="noopener ugc nofollow" target="_blank">Google Cloud Secret Manager</a>来保护我们的凭证安全，所以让我们也安装它:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="4a13" class="kv kw iq ow b gy pq pr l ps pt">pip3 install google-cloud-secret-manager</span></pre><p id="34e0" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">我们将使用<a class="ae na" href="https://docs.gspread.org/en/latest/" rel="noopener ugc nofollow" target="_blank"> gspread </a>包使使用Google Sheets变得更加容易:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="32e9" class="kv kw iq ow b gy pq pr l ps pt">pip3 install gspread</span></pre><p id="0077" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">当然还有<a class="ae na" href="https://gspread-dataframe.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> gspread_dataframe </a>:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="5a6b" class="kv kw iq ow b gy pq pr l ps pt">pip3 install gspread-dataframe</span></pre><p id="8424" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">🐍现在让我们使用Python并导入我们刚刚安装的包，调用Google Sheets API，从电子表格中获取我们的反馈数据并将其保存为dataframe👇</p><h2 id="8f2c" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">导入包</h2><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="9898" class="kv kw iq ow b gy pq pr l ps pt">##########################<br/># Load packages<br/>##########################</span><span id="dfac" class="kv kw iq ow b gy pu pr l ps pt"><em class="nu"># Google Credentials<br/></em>from googleapiclient.discovery import build<br/>from google.oauth2 import service_account<br/>import google.auth<br/>from google.cloud import secretmanager</span><span id="b0d9" class="kv kw iq ow b gy pu pr l ps pt"><em class="nu"># Python API for Google Sheets<br/></em>import gspread<br/>from gspread_dataframe import set_with_dataframe</span></pre><p id="dfcc" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">我们还将导入<a class="ae na" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a>、<a class="ae na" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>、<a class="ae na" href="https://docs.python.org/3/library/copy.html" rel="noopener ugc nofollow" target="_blank"> copy </a>和<a class="ae na" href="https://docs.python.org/3/library/json.html" rel="noopener ugc nofollow" target="_blank">JSON</a>——这些<strong class="lt ir">不需要像其他</strong>一样安装，因为它们在Python中是标准的:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="8078" class="kv kw iq ow b gy pq pr l ps pt"><em class="nu"># Standard Python packages<br/></em>import pandas as pd<br/>import numpy as np</span><span id="a7b1" class="kv kw iq ow b gy pu pr l ps pt"><em class="nu"># to create deep copy<br/></em>import copy</span><span id="8c4a" class="kv kw iq ow b gy pu pr l ps pt"><em class="nu"># for JSON encoding or decoding<br/></em>import json</span></pre><h2 id="404d" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">重要变量</h2><p id="a2a6" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">准备好以下变量的值。我们需要他们马上调用GSheets API:</p><p id="a90b" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">👉电子表格_ID</p><p id="25b0" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">👉获取范围名称</p><p id="3c51" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">👉项目编号</p><p id="d030" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">👉秘密_gsheet</p><p id="6c9f" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">👉秘密_版本_页面</p><h2 id="3b99" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">电子表格_ID </strong></h2><p id="8ab7" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">这是指Google Sheet URL末尾的字母数字字符串，如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pv"><img src="../Images/a2a2f448585e55b513b8ba91a443d89c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KtOmZVhmV5pun5lT6j3cw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片:作者自己的</p></figure><h2 id="57a7" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">获取范围名称</strong></h2><p id="ce2a" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">这是一个字符串值，表示电子表格中数据所在的区域。根据下面的截图，如果您的数据在Sheet 1中，那么您的范围名称将是:<em class="nu"> Sheet1！A1:C </em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pw"><img src="../Images/a1c97bd66c4cb03b070b7bc67339780f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GS8CO-xnyC6kAAROeNCIQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="b33d" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">项目_编号</strong></h2><p id="2a53" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">这是一个字符串，表示为您在Google Cloud中创建的项目分配的编号。您可以通过访问Google Cloud仪表板并选择您的项目来找到它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi px"><img src="../Images/f866390d3910079edc3a7cbbbf78b9bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-VeF9g8amR5Lzw7fH32Tgw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="05e4" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak"> secret_gsheet </strong></h2><p id="d047" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">这是一个字符串，表示您为Secret Manager中的gsheet练习指定的名称:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi py"><img src="../Images/617870e272704796ad3bbfd760e79e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c6wyuJHqfv9riiDYWqFaUw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="b5ef" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak"> secret_version_gsheet </strong></h2><p id="3c6b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">这是一个字符串，表示您的密码的版本号。您可以通过在秘密管理器中点击您的秘密来找到它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pz"><img src="../Images/ed926d034a4489d188a25d2edb3bf208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-abwb8gEvnTr2V3kmlnPA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="baf2" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">📞调用Google Sheet API</h2><p id="d4af" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">让我们从Google Sheets中获取数据并保存在一个数据框架中。</p><blockquote class="ox oy oz"><p id="4f4f" class="lr ls nu lt b lu mm jr lw lx mn ju lz pa nb mb mc pb nc me mf pc nd mh mi mj ij bi translated">⚠️注意:在运行之前，你必须先通过VS代码登录谷歌云。记住还要更新上面讨论的变量的值。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qa qb l"/></div></figure><h2 id="042f" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">注意事项:</h2><p id="c04a" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">✏️ <strong class="lt ir">第20行</strong>:当我们给<code class="fe ot ou ov ow b">SERVICE_ACCOUNT_FILE</code>分配秘密的时候，我们用了<code class="fe ot ou ov ow b">json.loads()</code>。由于我们没有引用实际的JSON文件(因为我们现在使用Secret Manager)，我们需要使用<code class="fe ot ou ov ow b">json.loads()</code>将<code class="fe ot ou ov ow b">secret_gsheet_value</code>从JSON字符串转换成Python字典。</p><p id="b77e" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✏️ <strong class="lt ir">第24行</strong>:同样，由于我们不再直接处理JSON文件，我们使用了<code class="fe ot ou ov ow b">service_account.Credentials.from_service_account_<strong class="lt ir">info</strong>()</code>而不是<code class="fe ot ou ov ow b">service_account.Credentials.from_service_account_<strong class="lt ir">file</strong>()</code>。</p><h1 id="03ca" class="nw kw iq bd kx nx oh nz la oa oi oc ld jw oj jx lh jz ok ka ll kc ol kd lp og bi translated">第二步:开始情感分析</h1><p id="0771" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">现在，让我们开始对反馈数据进行基本的情感分析。</p><h2 id="e7cf" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">安装情感分析包</h2><p id="2808" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们将试用Python <a class="ae na" href="https://github.com/nltk/nltk" rel="noopener ugc nofollow" target="_blank"> nltk </a>包中的VADER(休顿&amp;吉尔伯特，2014)。安装它:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="8c14" class="kv kw iq ow b gy pq pr l ps pt">pip3 install nltk</span></pre><h2 id="5872" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">导入情感分析包</h2><p id="8b9e" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">导入我们刚刚安装的包。在本练习中，我们不做标记化，因此下面的内容就足够了:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="ff0a" class="kv kw iq ow b gy pq pr l ps pt">import nltk<br/>from nltk.corpus import stopwords<br/>from nltk.sentiment.vader import SentimentIntensityAnalyzer</span></pre><h2 id="b004" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">运行情绪分析</h2><p id="bc2b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">现在，让我们开始对反馈数据进行基本的情感分析。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qa qb l"/></div></figure><h2 id="a495" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">注意事项:</h2><p id="5094" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">✏️ <strong class="lt ir">第8–13行:</strong>为了进行更准确的分析，需要从反馈语料库中删除停用词，以便在分析过程中不考虑不重要的词。英语中常见的停用词是像“the”、“and”、“is”这样的词。</p><p id="18c1" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✏️ <strong class="lt ir">第25行</strong> : VADER根据它所分析的文本输出负极、中性和正极的极性分数。</p><p id="56f7" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✏️ <strong class="lt ir">第32行</strong>:维达也从极性得分中输出复合得分。这实际上是将消极、中立和积极的分数相加，然后标准化为一个等级，其中+1表示高度积极，而-1表示高度消极。</p><p id="ad73" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✏️ <strong class="lt ir"> Line 40 </strong>:复合分数可以帮助我们标注一条反馈是正面的、中立的还是负面的。通过在复合分数上创建一个基本逻辑，我们可以返回更容易理解的值(即“正”，而不是“0.89”)。</p><p id="f8b8" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">您可以定制这种逻辑，如果您愿意，可以有更多的标签(例如，有5个标签，而不是3个:“非常积极”、“积极”、“中性”、“消极”、“非常消极”)。</p><h1 id="cf03" class="nw kw iq bd kx nx oh nz la oa oi oc ld jw oj jx lh jz ok ka ll kc ol kd lp og bi translated">步骤3:将结果写入电子表格</h1><p id="0979" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">现在我们已经有了分析结果，让我们在同一个电子表格中的一个新选项卡上写东西。我们将数据保存到Sheet2，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/f93dec8da54b3ff0e4d11fbad00ef16b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RCfxPBrzAHBv6jI2Q8rthw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="9319" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">这就是我们使用<code class="fe ot ou ov ow b">gspread</code>和<code class="fe ot ou ov ow b">gspread_dataframe</code>的方法👇</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qa qb l"/></div></figure><h2 id="f428" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">注意事项:</h2><p id="37da" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">✏️️ <strong class="lt ir">第7行&amp;第10行:</strong>我们引用了之前第一次调用Google Sheets API时已经引用过的<code class="fe ot ou ov ow b">CREDS</code>和<code class="fe ot ou ov ow b">SPREADSHEET_ID</code>变量。</p><p id="caee" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✏️ <strong class="lt ir">第13行</strong>:我们指定数据应该写到哪里。例如，如果你想把它写到一个名为“Sheet2”的标签中，那么它将被保存在Google sheet中的这个位置。</p><blockquote class="ox oy oz"><p id="82cd" class="lr ls nu lt b lu mm jr lw lx mn ju lz pa nb mb mc pb nc me mf pc nd mh mi mj ij bi translated">⚠️If当你在实际的工作表中改变标签的名字时，记得更新你的代码中的值，否则你的代码将无法工作。</p></blockquote></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="5bba" class="nw kw iq bd kx nx ny nz la oa ob oc ld jw od jx lh jz oe ka ll kc of kd lp og bi translated">好处:部署到谷歌云功能</h1><p id="3f89" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">👏到目前为止，我们做得很好！但不幸的是，这段代码目前仍在您的本地机器上💻—这意味着它只能从您的计算机上运行。</p><p id="2f69" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">通过将我们的代码部署到Google Cloud Functions的云☁️上，我们将能够在任何地方运行代码。在这一节中，我将概述如何将这些代码直接添加到Google Cloud接口中。</p><p id="5efa" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">仅供参考:直接从您的IDE部署是可能的，但这超出了本文的范围(本文已经够长了！)</p><h2 id="1663" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">配置云功能</h2><p id="09ae" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">在Google Cloud dashboard的搜索栏中为您的项目搜索云功能:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qc"><img src="../Images/9bc46b113c1e9dcdc8639afe5eba38c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PSHdzxxuAU5i3HEJWiJohg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="ae56" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">点击屏幕上的“创建功能”,您将进入以下页面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qd"><img src="../Images/6dd49e7cf967655619f2f3f0c33b0c91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2HjpSAkGz4DK2YcMoEmqQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><ul class=""><li id="88f3" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj nv ms mt mu bi translated">环境:暂时把它作为第一代。</li><li id="34a9" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated"><strong class="lt ir">函数名</strong>:给你的函数起个名字。这里的例子叫做<code class="fe ot ou ov ow b">my-sentiment-function</code>。</li><li id="e3ab" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated"><strong class="lt ir">区域</strong>:选择一个最近的区域。</li><li id="7a9e" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated"><strong class="lt ir">触发器类型</strong>:我们正在创建一个基本的HTTP触发器。勾选“要求HTTPS”框，您可以暂时将身份验证设置为“未验证”,仅用于本练习。</li></ul><p id="b4d6" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">点击“保存”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/f40f791935a44d793ff1f6ac0112854f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*wM8WeGUehGPCezMzfHwrtA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><ul class=""><li id="11ba" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj nv ms mt mu bi translated"><strong class="lt ir">分配的内存</strong>:该示例使用512mb，但是如果您愿意，您可以更改它</li><li id="110c" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated"><strong class="lt ir">超时</strong>:设定为300秒，但您也可以更改</li><li id="4db9" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated"><strong class="lt ir">运行时服务帐户</strong>:从下拉菜单中选择您之前创建的服务帐户</li><li id="6585" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated"><strong class="lt ir">最大实例数</strong>:暂时设为1。</li></ul><p id="ccb6" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">现在，您可以跳过其他选项卡，单击“下一步”进入以下屏幕:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qe"><img src="../Images/a53d8cff3fe3d612e1ee19aa63331063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AkvV0qPu_P8DuFUTM4uCeg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="b568" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">这里有几个要点需要回顾。</p><h2 id="d77f" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">运行时</strong></h2><p id="bab1" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们使用的是最新的Python 3，所以选择Python 3.10。</p><h2 id="fd6e" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak"> main.py </strong></h2><p id="6236" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">云函数要求代码在一个名为<code class="fe ot ou ov ow b">main.py</code> <br/>的文件中，如果你正在上传代码，这对于确保你的文件名称为<code class="fe ot ou ov ow b">main.py</code>是至关重要的。但是因为我们在界面中使用内嵌编辑器直接更新我们的代码(在截图中圈出)，所以这对于这个练习来说不是问题。</p><p id="fd57" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">对于Python，云函数使用<a class="ae na" href="https://flask.palletsprojects.com/en/2.2.0/" rel="noopener ugc nofollow" target="_blank"> Flask </a>框架。所以我们希望<code class="fe ot ou ov ow b">main.py</code>中的代码是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qa qb l"/></div></figure><p id="0fbc" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">我们需要命名我们的函数。在上面的例子中，我们称之为<code class="fe ot ou ov ow b">my_function</code>。</p><p id="c24e" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">函数中的请求参数应该返回可以转换成Flask响应的内容。这个响应可以是一个简单的字符串，甚至是一个JSON字符串。在上面的例子中，我们简单地返回了字符串“耶！搞定！”</p><h2 id="10b3" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">关于最佳实践</h2><p id="ad03" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">从技术上讲，你可以在一个函数中做任何事情，只要它返回一个合适的响应。然而，作为最佳实践，我们应该努力确保一个函数只做一件事，如上面的例子所示。这更干净，有助于降低代码的复杂性。如果我们要正确地完成这项工作，我们之前编写的代码将需要重构，并分解成更小的、正确定义的单个函数。</p><p id="95c6" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">但这并不意味着在一个功能中做多件事会让你的云功能完全无用。这只是意味着您的代码变得难以维护和调试。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qa qb l"/></div></figure><blockquote class="ox oy oz"><p id="b898" class="lr ls nu lt b lu mm jr lw lx mn ju lz pa nb mb mc pb nc me mf pc nd mh mi mj ij bi translated">⚠️知道，你的功能越长越复杂，谷歌云执行的时间就越长。</p></blockquote><p id="8ff7" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">为了让这篇已经很长的帖子保持简短，并希望这个示例是一个基本的快速原型，我们之前编写的代码可以通过以下方式针对云函数进行更新:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qa qb l"/></div></figure><h2 id="9553" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">注意事项:</h2><p id="bee1" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">✏️ <strong class="lt ir">线5 </strong>:所有要装载的包装都已经移动到顶部</p><p id="c0bc" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✏️ <strong class="lt ir">第22行</strong>:剩下的代码在我们命名为<code class="fe ot ou ov ow b">my_sentiment_function</code>的定义函数中。</p><p id="f1e9" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✏️ <strong class="lt ir">第149行</strong>:如果这执行得很好，我们将得到响应“耶！搞定！”在我们的浏览器中。</p><p id="9214" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">上面的代码应该放入<code class="fe ot ou ov ow b">main.py</code>的行内编辑器中。不要忘记指定云函数的开始作为入口点。我们的函数叫做<code class="fe ot ou ov ow b">my_sentiment_function</code>,所以它被用作入口点:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qf"><img src="../Images/b418b72e2ecbc51ee99a1fcc80f73d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QDlf2jHkVJZtXAqlRQ4p_g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h2 id="94a5" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">requirements.txt</h2><p id="33e0" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们需要在requirements.txt中指定需要安装的包。我们只需要以下内容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qg"><img src="../Images/d9287c24cbd913074312d92567ea3f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rN_Lu7DexEaVHdrpMkXcLA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="dbd1" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">请注意，我们没有在这里添加<code class="fe ot ou ov ow b">Flask</code>、<code class="fe ot ou ov ow b">copy</code>和<code class="fe ot ou ov ow b">json</code>。这是因为它们在环境中已经存在。</p><blockquote class="ox oy oz"><p id="2476" class="lr ls nu lt b lu mm jr lw lx mn ju lz pa nb mb mc pb nc me mf pc nd mh mi mj ij bi translated">⚠️:不管怎样，如果你把这些添加到requirements.txt中，云功能将无法部署，即使其他一切都安装正确。</p></blockquote><p id="0edd" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated"><code class="fe ot ou ov ow b">google-api-python-client</code>已经包含了像<code class="fe ot ou ov ow b">googleapiclient.discovery</code>这样的google discovery APIs，所以没有必要再将后者添加到requirements.txt中。</p><p id="5742" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">现在部署！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qh"><img src="../Images/8d48a364d866f147276434d4a7ed1af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJdop1rdbn0wv695mP4WIw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="50f6" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">几分钟后，如果您完成了上述所有操作，您应该会看到绿色的tick✅，表明您的功能已经成功部署🙌🥳!</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qi"><img src="../Images/ff3ccc96c96e3f067626c32fa87aa905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lj7jhpnLJ70WoX7_4cNFEA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><h1 id="f302" class="nw kw iq bd kx nx oh nz la oa oi oc ld jw oj jx lh jz ok ka ll kc ol kd lp og bi translated">测试</h1><p id="b61f" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">让我们快速测试一下这是否真的有效！</p><ol class=""><li id="37c5" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj mr ms mt mu bi translated">点击你的功能，然后进入名为“触发”的标签。此功能是通过HTTP触发的，因此谷歌云功能已经为您分配了一个URL。</li><li id="9e91" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj mr ms mt mu bi translated">点击URL触发您的功能:</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi px"><img src="../Images/b40d88dcd98f7a6f246557c02948777e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FBO2gjn7L4zz8uiD_3FNpg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="73aa" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">3.应该会打开一个新的浏览器选项卡。</p><p id="229e" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated"><strong class="lt ir">结果:</strong></p><p id="ec64" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">❌If:如果失败，你会得到一个错误信息，你可以查看“日志”标签，检查错误，看看为什么失败。这些错误已经被很好的描述了，所以你应该能够理解。</p><p id="ea0e" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">✅如果成功了，你会得到你的“耶！搞定！”浏览器中的成功消息:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi qj"><img src="../Images/353b0251dad3c151ea596072290c043f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqyZQ8KNgeghMurhj-Lpzg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">截图:作者自己的</p></figure><p id="3795" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">为了全面测试这一点，请记住，我们已经配置了代码，从Sheet1读取数据，然后将情感分析结果写入Sheet2。</p><ol class=""><li id="06ab" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj mr ms mt mu bi translated">所以继续删除Sheet2中的所有内容。</li><li id="c82c" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj mr ms mt mu bi translated">复制云功能给你的网址，再次输入浏览器。再次触发该函数应该会更新Sheet2！</li></ol><p id="8446" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">因此，如果您在Sheet1中添加新的客户反馈或更改它们，只需点击您的云函数URL，就会将情感分析的结果输出到Sheet2中！</p><h2 id="bac0" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">作为JSON返回</h2><p id="96ce" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">如果你不想回“耶！搞定！”，并希望该函数返回我们之前以JSON形式创建的情感数据帧，请将return语句替换为:</p><pre class="kg kh ki kj gt pm ow pn po aw pp bi"><span id="0690" class="kv kw iq ow b gy pq pr l ps pt"><em class="nu">from flask import Response</em></span><span id="0b2c" class="kv kw iq ow b gy pu pr l ps pt"><em class="nu">return Response(sentiment_df.to_json(orient="records"), mimetype='application/json')</em></span></pre><h1 id="270e" class="nw kw iq bd kx nx oh nz la oa oi oc ld jw oj jx lh jz ok ka ll kc ol kd lp og bi translated">结束了</h1><p id="a752" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">这就是如何通过Google Cloud函数实时部署基本Python情绪分析代码的快速示例的结尾。谢谢你读到这里🤗！</p><p id="0df6" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">现在您已经了解了所有这些是如何工作的，您可能想进一步了解:</p><ul class=""><li id="b207" class="mk ml iq lt b lu mm lx mn le mo li mp lm mq mj nv ms mt mu bi translated">执行更深入的情感分析——首先尝试一些句子和单词的标记化。</li><li id="cb42" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">看看改进代码，让它更干净。</li><li id="c3cb" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">注意云安全——我们已经避免在代码中硬编码我们的凭证，并使用了Google Secret Manager的基本方法。但是您可以研究进一步的改进，比如限制权限、将密钥限制在特定的API上、只允许经过身份验证的访问、在您完成实验后删除未经身份验证的函数等等。</li><li id="e96c" class="mk ml iq lt b lu mv lx mw le mx li my lm mz mj nv ms mt mu bi translated">关注你的云资源:这个练习不应该让你超越你的免费层，但是如果你正在分析大量的情感数据，那么你将需要关注你的资源。关闭不使用的资源，删除不再需要的示例项目，等等。</li></ul><blockquote class="ox oy oz"><p id="2687" class="lr ls nu lt b lu mm jr lw lx mn ju lz pa nb mb mc pb nc me mf pc nd mh mi mj ij bi translated">⚠️完成后别忘了删除这个云功能！</p></blockquote></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="7c17" class="nw kw iq bd kx nx ny nz la oa ob oc ld jw od jx lh jz oe ka ll kc of kd lp og bi translated">完整的Python代码</h1><p id="8f2b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">👉从我的Github repo <a class="ae na" href="https://github.com/Practical-ML/vader-sentiment-analysis" rel="noopener ugc nofollow" target="_blank">这里</a>获取完整的Python代码。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="344c" class="nw kw iq bd kx nx ny nz la oa ob oc ld jw od jx lh jz oe ka ll kc of kd lp og bi translated">参考资料和进一步阅读</h1><p id="88e9" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">休顿，C.J .和吉尔伯特，2014年。VADER:基于规则的社交媒体文本情感分析的简约模型。载于:<em class="nu">《网络与社交媒体国际AAAI会议论文集》，8 </em> (1)，第216–225页。</p><p id="b766" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">nltk是一个开放源码的Python工具包，受<a class="ae na" href="https://github.com/nltk/nltk/blob/develop/LICENSE.txt" rel="noopener ugc nofollow" target="_blank"> Apache 2.0许可</a>。</p><p id="23a8" class="pw-post-body-paragraph lr ls iq lt b lu mm jr lw lx mn ju lz le nb mb mc li nc me mf lm nd mh mi mj ij bi translated">VADER在麻省理工学院的许可下是开源的。</p></div></div>    
</body>
</html>