<html>
<head>
<title>The Easiest Way To Ingest Data Into BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将数据导入BigQuery的最简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-easiest-way-to-ingest-data-into-bigquery-a94e63d4846e#2022-08-09">https://towardsdatascience.com/the-easiest-way-to-ingest-data-into-bigquery-a94e63d4846e#2022-08-09</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="8273" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">如何使用Google Sheets将数据直接加载到BigQuery中——以及为什么它是某些用例的最佳解决方案</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/94f1fd0d6d94f17f8372d512244d7bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NgLQN5FoxG6Z-pSiIp9uyQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">巴勃罗·阿罗约在<a class="ae kz" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="9e9c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当在一家公司谈论数据管理时，首先浮现在脑海中的是诸如“数据架构”、“数据工程管道”、“数据质量检查”之类的关键词……简而言之，围绕着在整个组织中流动的数据 <strong class="lc iv">的<strong class="lc iv">结构化的概念</strong>。事实上，所有关于数据管理的最佳实践都依赖于这样一个假设，即我们应该将大数据构建到特定的架构中。我同意，而且我肯定会建议任何人，只要他们属于一个组织，就应该构建一个干净可靠的架构。</strong></p><p id="0ca4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然而，我发现<strong class="lc iv">有时候最微不足道的解决方案最终会成为最好的解决方案</strong>。这也适用于数据架构。这就是为什么<strong class="lc iv">使用Google Sheets将数据注入到您的数据仓库BigQuery </strong>有时会很有用。虽然它不应该作为获取数据的主要方式，但它提供了某些优势。</p><p id="09fe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这篇文章中，我想涵盖三个方面:</p><ol class=""><li id="6058" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">为什么应该使用Google Sheets将数据导入BigQuery？</li><li id="c66d" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">怎么做呢？</li><li id="11e4" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">这样做时应该采取什么预防措施？</li></ol><p id="29ce" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了说明我的想法，让我们考虑在您的数据仓库中有一个名为“销售人员”的表。它列出了销售部门的成员(每人一行)。这张桌子看起来像这样:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mk"><img src="../Images/c0e83896bda436524404d5544bd4343a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5PJ3zMjQ-F8kecuFWORTMA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">BigQuery中的输入表(图片由作者提供)</p></figure><p id="f974" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您面临的挑战是，一个业务用户(在我们的例子中是销售主管)定期更新他们团队的组成。例如，尼克最近改变了团队:他不再是蓝队的一员，但他现在是红队的一员。你将如何更新这条信息？</p></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="b1df" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">为什么使用Google Sheets？</h1><p id="57fe" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated"><strong class="lc iv">添加类似“team _ name”</strong>的字段的通常流程是在任何<a class="ae kz" rel="noopener" target="_blank" href="/modern-or-not-what-is-a-data-stack-e6e09e74ae7f">数据架构</a>的数据转换步骤中直接更新它。根据您公司的组织，数据工程师、分析工程师甚至数据分析师都可以在“员工”表中进行修改。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj np"><img src="../Images/67cc0148bcf81e2c0a2217d686372650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RHK9C0ae9QnP7M3s_eE-FQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">Google Sheets中的输入表格(图片由作者提供)</p></figure><p id="5612" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然而<strong class="lc iv">完成整个流程</strong>可能需要几天时间，而添加“团队名称”列的需求可能很迫切。此外，这可能是一个准时的需求:添加员工的团队名称可能只与一个人或一个特定的分析相关。如果它没有为整个组织增加多少价值，那么经历整个数据工程过程可能不值得。</p><p id="4080" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这就是使用Google Sheets及其与BigQuery的本机集成变得相关的地方。<strong class="lc iv">第一个优势是灵活性</strong>。在我们的示例中，如果销售主管改变了主意，Nick将转到黄色团队而不是红色团队，那么可以通过更改Google Sheets中相关单元格的值来轻松完成这一更改。随着灵活性而来的是<strong class="lc iv">快速</strong>。即使不能立即更新，Google Sheets文件中的更新也可以在几分钟内出现在相应的BigQuery表中。</p><h1 id="e585" class="ms mt iu bd mu mv nq mx my mz nr nb nc ka ns kb ne kd nt ke ng kg nu kh ni nj bi translated">如何将Google Sheets中的一个表摄取到BigQuery中？</h1><p id="34d3" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">Google Sheets和BigQuery之间的原生集成允许<strong class="lc iv">将一个工作表的内容直接链接到一个数据库表</strong>。这是一个实时连接，这意味着您不必下载Google Sheets文件，然后在每次发生更改时手动上传到BigQuery。</p><p id="562f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">相反，转到BigQuery中的数据集，然后<strong class="lc iv">单击“创建表”</strong>。这将打开以下面板，您可以在其中完成:</p><ul class=""><li id="ee60" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv nv mc md me bi translated">用作源的Google Sheets文件的URL</li><li id="c381" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv nv mc md me bi translated">如果文件中有多张工作表，则为工作表范围</li><li id="ef00" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv nv mc md me bi translated">目标(项目、数据集、输出表的名称)</li></ul><p id="ac98" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在“模式”部分，您有三种选择:</p><ol class=""><li id="2787" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">“自动检测”让BigQuery自动推断导入表的模式</li><li id="1aaa" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">“作为文本编辑”允许您以JSON的形式写下表的模式</li><li id="815b" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">“+”允许您直接在BigQuery的界面中添加每个字段及其特性(类型、模式、描述)</li></ol><p id="9d5e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，您可以让BigQuery跳过“高级选项”中的标题行。在我们的示例中，我将“1”放在该字段中，因为我们希望忽略第一行(“employee_id”、“team_name”)。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nw"><img src="../Images/73c04499c4ac2f1469981ffb2358f116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AptZzLAysi27c3TRhlvHbQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">将Google Sheets中的表格导入BigQuery(图片由作者提供)</p></figure><p id="4768" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一旦完成，您的工作表就可以在BigQuery中使用了！这允许<strong class="lc iv">编写整合来自BigQuery和Google Sheets文件</strong>的数据的查询。</p><p id="3aa5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">回到我们前面的例子，导入Google Sheets文件允许我编写下面的查询，其中我协调来自我的数据仓库(表“salespersons”)和来自我的电子表格(表“salespersons_teams”)的数据。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nx ny l"/></div></figure><p id="61d7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这导致了下面的输出表:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nz"><img src="../Images/a91632eb8e29db46dda7f1e7c1bc5837.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D4iCoblWhQZlVKjbGlRAYA.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">BigQuery中的输出表(图片由作者提供)</p></figure><h1 id="0118" class="ms mt iu bd mu mv nq mx my mz nr nb nc ka ns kb ne kd nt ke ng kg nu kh ni nj bi translated">你应该在什么时候使用这个技巧？什么时候不呢？</h1><p id="e80b" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">在我们的例子中，一个人(销售主管)将负责更新Google-Sheets文件。只要情况保持不变，前面提到的所有优点都适用:灵活性、快速性。但是<strong class="lc iv">如果更新文件的责任被太多人分担</strong>，你会看到质量差的风险增加。这可能会导致错误的数据输入(例如，合并两个单元格，将一个字符串插入到一个整数字段中)…并且可能会导致表格或仪表板损坏。</p><p id="6879" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这就是为什么我个人会在满足几个条件的情况下使用这种技术:</p><ul class=""><li id="b22d" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv nv mc md me bi translated"><strong class="lc iv">只有一个人</strong>(或非常有限的几个人)<strong class="lc iv">负责</strong>保持Google Sheets文件中数据的正确和最新</li><li id="cb6a" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv nv mc md me bi translated">和/或<strong class="lc iv">所处理的用例具有有限的影响</strong>:它旨在为业务用户回答一个准时的或非常具体的问题</li><li id="e492" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv nv mc md me bi translated">和/或<strong class="lc iv">该方法用作概念验证</strong>，供数据工程团队进一步开发</li></ul><p id="28f3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">事实上，人们可以考虑将来自Google Sheets的数据集成到BigQuery中，这可能与更高级的数据产品的<strong class="lc iv">初级版本相关。在我们的示例中，如果向销售人员分配团队的用例似乎超出了销售主管的单独使用范围，那么下一步将是向数据工程团队提供这种集成作为概念验证。</strong></p></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><h1 id="8ea0" class="ms mt iu bd mu mv mw mx my mz na nb nc ka nd kb ne kd nf ke ng kg nh kh ni nj bi translated">结论</h1><p id="aaa7" class="pw-post-body-paragraph la lb iu lc b ld nk jv lf lg nl jy li lj nm ll lm ln nn lp lq lr no lt lu lv in bi translated">不可否认，将Google Sheets文件中的数据集成到BigQuery表中有两个优点:灵活性和快速性。这就是为什么在处理有限的利益相关者的特定用例时<strong class="lc iv">特别有用的原因</strong>。</p><p id="eefe" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然而，它也有缺点，因此您必须确保用这种方法处理的用例的框架设置清晰。为了获得更高的可伸缩性(但灵活性和速度较低)，通过通常的数据体系结构传输数据仍然是在数据集中实现结构化更改的最佳实践。</p></div><div class="ab cl ml mm hy mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="in io ip iq ir"><p id="1b7e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">你喜欢读这篇文章吗？ <a class="ae kz" href="https://marie-lefevre.medium.com/membership" rel="noopener"> <em class="oa">成为</em> </a> <em class="oa">的一员，加入一个不断成长的充满好奇心的社区吧！</em></p><div class="ob oc gq gs od oe"><a href="https://marie-lefevre.medium.com/membership" rel="noopener follow" target="_blank"><div class="of ab fp"><div class="og ab oh cl cj oi"><h2 class="bd iv gz z fq oj fs ft ok fv fx it bi translated">通过我的推荐链接加入媒体-玛丽·勒菲弗尔</h2><div class="ol l"><h3 class="bd b gz z fq oj fs ft ok fv fx dk translated">阅读玛丽·勒费夫尔(以及媒体上成千上万的其他作家)的每一个故事。每月5美元(或每年50美元),直接向…</h3></div><div class="om l"><p class="bd b dl z fq oj fs ft ok fv fx dk translated">marie-lefevre.medium.com</p></div></div><div class="on l"><div class="oo l op oq or on os kt oe"/></div></div></a></div></div></div>    
</body>
</html>