<html>
<head>
<title>How to Evaluate Clustering Performance without Ground Truth Labels</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在没有基础事实标签的情况下评估聚类性能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-evaluate-clustering-performance-without-ground-truth-labels-9c9792ec1c54#2022-12-01">https://towardsdatascience.com/how-to-evaluate-clustering-performance-without-ground-truth-labels-9c9792ec1c54#2022-12-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ba9e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基于群集构造选择适当有效性度量的说明性指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/451ff9c50426364c965993264a5e7750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yverEwAyMOJhYWD9Afa77w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/photos/hzFK3KLVLkE" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@steve_j" rel="noopener ugc nofollow" target="_blank"> steve_j </a>拍摄的照片</p></figure><h1 id="c022" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="4588" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">监督学习剧本中有许多方法可用于评估已知基本事实标签情况下的聚类性能。然而，当地面实况不可用时，性能评估就不那么简单了。在这种情况下，我们需要依赖有效性度量，这些度量给我们提供了一个关于如何定义集群的指示。这些有效性指标在很大程度上依赖于数据中聚类的基本构造。</p><p id="35e1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于由凸球状星团组成的数据，已经提出了多种有效性指标，最流行的是<strong class="lt iu">轮廓系数</strong>。其他指数包括卡林斯基-哈拉巴斯指数、戴维斯-波尔丁指数和邓恩指数。然而，并不是所有的数据都是由球状星团组成的。有些星系团可以呈现任意形状，由密度来分隔。在这种情况下，我们可以利用<strong class="lt iu">基于密度的聚类验证</strong>指标，或 DBCV。</p><p id="690b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ms">注:</em>下图中使用的数据是使用 scikit-learn 的<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html" rel="noopener ugc nofollow" target="_blank"> make_blobs </a>、<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_moons.html" rel="noopener ugc nofollow" target="_blank"> make_moons </a>和<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_circles.html" rel="noopener ugc nofollow" target="_blank"> make_circles </a>函数生成的。</p><h1 id="53c0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">球状星团</h1><p id="1d13" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于主要为球状的星团，最常用<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html" rel="noopener ugc nofollow" target="_blank">轮廓系数</a> [1]来评估性能。这是一种基于数据点与其自己的聚类相比与其他聚类的相似程度的度量。其值的范围从-1(表示不正确的聚类)到+1(表示高度密集的聚类和良好的分离)。接近 0 的值表示重叠的簇。一个非常适合识别球状星团的算法是<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html" rel="noopener ugc nofollow" target="_blank"> K 均值</a>。</p><p id="3bda" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是一个由 4 个球状星团组成的数据示例(图 1)。这里聚类的标准偏差是 1.2，这导致一些聚类间重叠。然而，K-Means 仍然实现了体面的分离，轮廓系数为 0.44。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/6e73ecbaadccfe2f10436e748fee26d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c588AAPAUZ4lQ5UsrBmVIQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1:原始数据与 K 均值输出。剪影系数:0.44。</p></figure><p id="3896" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们有非常明确的集群(图 2)，我们会期待一个更高的有效性得分。这正是我们在下面的例子中获得的结果，它实现了 0.79 的轮廓系数。本例中聚类的标准偏差为 0.4，产生了更好的可分性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/a4e9ab3338de61cdbfe9ee5b6d8ff806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OaLhcnzmZYenTQe1EBfvxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:原始数据与 K 均值输出。剪影系数:0.79。</p></figure><p id="f8ae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，如果集群不是由球状形状表征的，轮廓系数可能不是合适的有效性度量。此外，K-Means 可能不是合适的聚类算法，因为它通常更喜欢球形。在下面的例子中，K-Means 明显错误地分类了新月的部分，即使剪影系数仍然产生了令人误解的体面值 0.49。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/d7b49dcfb25061217443d05f059e424b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQwEHjG9Nhc8nJFjepvvZg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3:非球状数据的 K-均值聚类。</p></figure><h1 id="3192" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">任意形状的簇</h1><p id="c9e3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于具有任意形状和大小的聚类，<a class="ae ky" href="https://github.com/christopherjenness/DBCV" rel="noopener ugc nofollow" target="_blank">基于密度的聚类验证(DBCV) </a> [2]是优选的评估度量。它根据群集内和群集间的密度来评估群集质量。通过簇内的高密度和簇间的低密度可以获得良好的结果。与剪影系数类似，DBCV 的范围从-1 到+1，分数越高表示聚类质量越好。</p><p id="6446" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有各种常用的聚类算法能够识别任意形状的聚类，如 DBSCAN、HDBSCAN 或 OPTICS。对于下图，我将使用<a class="ae ky" href="https://hdbscan.readthedocs.io/en/latest/how_hdbscan_works.html" rel="noopener ugc nofollow" target="_blank"> HDBSCAN </a>(针对有噪声的应用程序的基于层次密度的空间聚类)。</p><p id="a48d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们看看 HDBSCAN 在两个新月上的表现:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/25a19c05755ebc4bbc3384076b40cf78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*69tOt4sgUMeelL1x1phbVg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4:月牙形星团上的 HDBSCAN。</p></figure><p id="1e9a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于这两个新月看起来可以通过密度来区分，因此毫不奇怪 HDBSCAN 可以很好地区分它们，相应的 DBCV 为 0.54。相比之下，基于 K 均值标签的 DBCV(图 3)为-0.76，表明如预期的那样，由于错误分类的数据点而导致不正确的聚类。</p><p id="ab5c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们看另一个任意形状的集群的例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/9d9729aefa6ef37832b40d47ef907d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1bQgrqBB6k1pAL4YV17XXA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 5:圆形集群上的 HDBSCAN。</p></figure><p id="d4c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">同样，这两个圆似乎可以按密度分开，因此，HDBSCAN 实现了 DBCV 为 0.61 的下降结果。相反，K-Means 很难将它们分开，结果，相关的 DBCV 是-0.8(图 6)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/0601be53f5226c22c6455ebf47d40eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-F9xKA3mCiB2zIvUT59Ew.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 6:圆形簇上的 K-均值。</p></figure><h1 id="9866" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="4571" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果无法获得基本事实，就必须依赖基于模型的性能评估指标。虽然剪影系数对于由凸球状星团组成的数据来说是一个可靠的度量，但它通常不适用于任意形状的星团，并且尽管有明显的错误分类，但仍会产生令人迷惑的高分。在这种情况下，DBCV 是首选的度量标准，因为它可以更好地处理任意形状。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="b00b" class="kz la it bd lb lc ne le lf lg nf li lj jz ng ka ll kc nh kd ln kf ni kg lp lq bi translated">参考</h1><p id="cc76" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">[1]彼得·j·鲁瑟夫(1987 年)。"轮廓:聚类分析解释和验证的图形辅助工具."计算与应用数学 20:53–65。</p><p id="13d6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[2] Moulavi，Davoud 等人(2014 年)。"基于密度的聚类验证."2014 SIAM 数据挖掘国际会议论文集。工业和应用数学学会。</p></div></div>    
</body>
</html>