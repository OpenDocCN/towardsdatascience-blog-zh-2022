<html>
<head>
<title>Prevent Data Loss With This Free dbt Package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用这个免费的 dbt 软件包防止数据丢失</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/prevent-data-loss-with-this-free-dbt-package-a676c2e59c97#2022-03-17">https://towardsdatascience.com/prevent-data-loss-with-this-free-dbt-package-a676c2e59c97#2022-03-17</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><div class=""><h2 id="e759" class="pw-subtitle-paragraph js iu iv bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">因为你的数据价值百万…</h2></div><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/1defbb3338e8f4ac2461952b96d19498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwCWhhnnfHHK0DyjIvm0_Q.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">米克·豪普特在<a class="ae la" href="https://unsplash.com/s/photos/tree-trunk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0dc3" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">您是否曾经在编写数据模型或完成深入分析时发现您的数据有问题？这可能是作为数据专业人员最糟糕的发现之一。你花了这么多时间来确保你的数据是可靠的，进行了多重质量检查，结果却出了问题。</p><p id="36af" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我去过那里。几周前，我验证了自己编写的数据模型，却发现我们最重要的表之一的数据量非常少。经过深入挖掘，我们发现这个问题已经持续了<strong class="ld iw">整整 2 周</strong>。</p><p id="464f" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">幸运的是，我们能够修复它，但是 2 周的数据丢失太多了。尤其是当您是一家希望利用您的数据实现重大增长的小型企业时。</p><p id="c760" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">因此，作为一名数据问题解决者，我开始寻找一种解决方案，当我们的日常数据量出现差异时，这种解决方案将有助于提醒我们。</p><p id="e29e" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">令人惊讶的是，这是一个很难找到的东西。我们使用 Fivetran 将我们的数据接收到雪花数据仓库中，但这两者都没有针对数据量的警报。他们甚至没有让我编写自己的自动化脚本的选项！</p><h1 id="cac9" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">什么是 re_data？</h1><p id="6394" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">在经历了很多挫折之后，我偶然发现了<a class="ae la" href="https://www.getre.io/" rel="noopener ugc nofollow" target="_blank"> re_data </a>，“一个开源的&amp; dbt 原生的，为现代数据栈构建的数据可靠性框架”。这个框架允许您创建警报、跟踪指标和存储 dbt 测试历史。</p><p id="cef2" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">对于表，这些指标包括数据量和新鲜度。</p><p id="86fd" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">对于列，这些度量包括聚合、空值、标准偏差、长度等等。</p><p id="3008" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">您可以跟踪许多指标来创建更可靠的数据生态系统。</p><p id="df77" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">re_data 的工作原理是检测数据中的趋势(并向您发出警报)以及发送清除、规范化和验证数据的宏。通过向您的 YAML 文件添加一些配置细节，您可以轻松地设置它来跟踪您的仓库中的数据。</p><p id="404f" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在本文中，我将教您如何建立一个警报系统，当您的表的数据量远远超出正常水平时，该系统会向您发送一条 Slack 消息。</p><h1 id="6ea9" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">下载 re_data</h1><p id="f379" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">无论您是否是 dbt 用户，re_data 都在他们的<a class="ae la" href="https://docs.getre.io/latest/docs/getting_started/installation/for_dbt_users" rel="noopener ugc nofollow" target="_blank">文档</a>中包含了安装说明。幸运的是，这一步非常简单。如果您是 dbt 用户，只需将包名添加到 packages.yml 文件中，然后运行<code class="fe mu mv mw mx b">dbt deps</code>。</p><p id="9f0a" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">您的文件应该如下所示。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f847b54dbfd82dd601bcce688e6f3498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*v1A06v7YcXoPMUM87o0diQ.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="6f9c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">您还需要使用命令 pip install re-data 安装 Python 包，这样您就可以利用 Slack 通知特性和 re_data UI。</p><h1 id="7d91" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">设置您的监控配置</h1><p id="4cc7" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">re_data 文档概述了如何利用 dbt 原生配置来使用它们的框架。对于本教程，我只监视一个表中的<code class="fe mu mv mw mx b">row_count</code>。我编写的代码将放在 dbt SQL 文件的开头，该文件对应于您希望监视的表。</p><p id="264d" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">为了设置这个，我设置<code class="fe mu mv mw mx b">re_data_monitored</code>为真。然后，我选择了我想要使用的时间过滤器。确保时间过滤器是指定表中行创建时间的列。我的情况是<code class="fe mu mv mw mx b">event_created_at</code>。</p><p id="8dcc" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">例如，如果你在监控网站的点击率，你的<code class="fe mu mv mw mx b">time_filter</code>栏将会是你的网站发生点击的时间。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi mz"><img src="../Images/9f144c963af777464d8dcccb71e5383f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xr0oPcjFSjGNs25Z"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="fcc0" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">现在，让我们导航到<code class="fe mu mv mw mx b">dbt_project.yml</code>文件。我们不是在单个模型的配置中编写<code class="fe mu mv mw mx b">re_data_metrics</code>块，而是将它添加到这里。这将使得<code class="fe mu mv mw mx b">row_coun</code> t 为我们添加 re_data 配置的每个模型进行计算。如果您想要为多个模型计算它们，那么您还可以向这个 dbt 项目文件中添加其他指标。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi na"><img src="../Images/414ad9f18de902072ccd6c8f502a1b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6KjmpyYC_NWag1iR"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="00eb" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">您还可以在 dbt_project.yml 文件中指定特定的 z 得分，您希望 re_data 使用该 z 得分来确定指标是否远离其基线。默认的 z 值为 3，但您可以根据表的性质随时更改该值。就我个人而言，我把我的改为 2，因为我宁愿在开始时被提醒太多，而不是不够。如果你发现它过于频繁地提醒你，你可以随时调整。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nb"><img src="../Images/c3a54d8165ebf7bfc66f6d2627b4c5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c7q36rd6m2XWvdhF"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="1720" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">现在，我们可以将相同的配置对象添加到任何模型的相应 SQL 文件的顶部，并将计算 row_count。对于所有这些模型，当 z 分数超过 2 时，将创建警报。</p><h1 id="7fad" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">数据仓库配置</h1><p id="a0ac" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">现在是运行框架的时候了！您可以使用以下命令运行它:</p><p id="8951" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated"><code class="fe mu mv mw mx b">dbt run — m re_data</code></p><p id="3db9" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">请注意，这个命令与您用来运行已经创建的任何其他 dbt 数据模型的命令相同。</p><p id="3f36" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">运行该命令后，我希望您导航到您的数据仓库，并查看是否有任何更改。您会注意到 re_data 创建了两个模式，<strong class="ld iw"> RE </strong>和<strong class="ld iw"> RE_INTERNAL </strong>。</p><p id="9483" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">请记住，这些模式将在 profiles.yml 文件中定义的数据库中创建。在我的概要文件中，我有两个目标——一个用于开发，一个用于生产，每个目标都有不同的已定义数据库。根据您的目标，这些模式将填充到数据库中。</p><p id="25b0" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">例如，当我在本地开发 dbt 模型时，我的目标在我的<code class="fe mu mv mw mx b">profiles.yml</code>中被设置为 dev。因此，在我的开发数据库中创建了两个 re_data 模式。然而，在生产中，我的目标设置为我的生产数据库。因此，当我在生产中运行相同的代码时，模式是在我的生产数据库中创建的。</p><p id="b13b" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">你可以在 dbt 的<a class="ae la" href="https://docs.getdbt.com/dbt-cli/configure-your-profile" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多关于设置个人资料的信息。</p><p id="4e88" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">默认数据仓库中的 RE 模式包含从包中的宏创建的各种表。我们需要注意的是<strong class="ld iw"> RE_DATA_BASE_METRICS </strong>和<strong class="ld iw"> RE_DATA_Z_SCORE </strong>。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/ed83261d262d98199e5a1deed62084af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/0*sVyMAcnBdPw-rtHZ"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="c81c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">您还可以看到它创建了 4 个不同的视图。我们将需要查看<strong class="ld iw"> RE_DATA_ALERTING </strong>视图。这包含根据我们提供的 YAML 配置创建的任何警报。</p><p id="9594" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">至于<strong class="ld iw"> RE_INTERNAL </strong>模式，您不会看到它。这是宏内部使用的，为您提供我们刚刚讨论过的漂亮的表和视图。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nd"><img src="../Images/6700f1099d8b75610591b96d7685630d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AjnOHotMcYPPvzCU"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><h1 id="0a85" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">已创建 re _ 数据表</h1><h2 id="6ac0" class="ne ly iv bd lz nf ng dn md nh ni dp mh lk nj nk mj lo nl nm ml ls nn no mn np bi translated"><strong class="ak"> re_data_base_metrics </strong></h2><p id="3d62" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">让我们看看“re_data_base_metrics”表。您可以看到，根据您运行模型的时间和我们在<code class="fe mu mv mw mx b">dbt_profiles.yml</code>中定义的“metrics_base ”,有不同的行。因为我们只在那个文件中定义了<code class="fe mu mv mw mx b">row_count</code>，所以我们只会在 metric 列中看到<code class="fe mu mv mw mx b">row_count</code>。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nq"><img src="../Images/498e93f77d2d60a2a1631b00c6d3bdd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Swwdu0gqJHWiYwln"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="f142" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated"><strong class="ld iw"> re_data_z_score </strong></p><p id="5e23" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">接下来，我们来看“re_data_z_score”表。当您尝试计算的指标至少有 2 行数据时，您将在该表中看到至少一行。如果只有一行，则无法计算 z 值。请记住，这也意味着您使用该工具的时间越长，它就越有效。如果你回想一下大数定律，随着样本量的增加，平均值越来越接近真实的总体平均值。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nq"><img src="../Images/986427f2b9f9e65555adfea2cd81e855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gZlq4bruIwNmMkRo"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="db56" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">如果您还记得，我们在 YAML 文件中将 z 值设置为 2。因为此表中的 z 值小于 2，所以不会触发任何警报。如果此 z 值大于 2，将触发警报，并在“re_data_alerting”表中创建一行。</p><h1 id="dd42" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">在生产中运行 re_data</h1><p id="7b93" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">现在，你可能想知道，我如何在生产中运行它？你可能想让这个提醒自动工作，而不需要太多思考。您不希望每天都在本地运行这个命令。</p><p id="b82b" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">就我个人而言，我使用<a class="ae la" rel="noopener" target="_blank" href="/tired-of-airflow-try-this-c51ec26cd29d">perfect</a>来部署我的 dbt 数据模型，所以我也选择使用它来部署 re_data。因为它是如何构建的，所以您会希望像运行 dbt 模型一样运行它。对你来说，这可能是与气流或 Dagster，但对我来说，这是与提督。</p><p id="9de6" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我在 Python 文件中使用 dbt_tasks 来运行我所有的 dbt 模型。我有一个装满这些任务的文件，然后将它复制到 Docker 容器中。对于 re_data，我简单地创建了一个新的 dbt_task 来运行模型。</p><p id="d53a" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated"><code class="fe mu mv mw mx b">dbt_task(command=’dbt run -m re_data’, task_args={“name”: “re_data monitoring”})</code></p><p id="15fc" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我还确保为 web events 表设置了上游依赖项，因为这是我使用 re_data 监视的表。如果您使用它来监视所有的表，请确保为所有的数据同步设置了一个依赖项。</p><h1 id="d2bc" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">设置松弛命令</h1><p id="6f60" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">re_data 刚刚发布了一项功能，允许您发送带有警告更新的 Slack 消息。这是自治数据环境的理想选择，在这种环境中，您只想关注出错的事情。</p><p id="c8e4" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">我尝试设置我的数据环境，这样我就不必每天监控它。当事情出错时，<em class="nr">那是我希望得到通知的</em>。re_data 就是这么做的。</p><p id="b9d1" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">运行该命令之前，请确保您拥有最新版本的包。这是一个相当新的版本，所以如果您没有使用最新的版本，该命令将会失败。</p><p id="ffea" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">请务必在更改版本后运行<code class="fe mu mv mw mx b">dbt deps</code>,否则该命令将再次失败。</p><p id="a5a2" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">re_data Slack 命令如下所示:</p><pre class="kl km kn ko gt ns mx nt nu aw nv bi"><span id="2ae5" class="ne ly iv mx b gy nw nx l ny nz">re_data notify slack \</span><span id="b74b" class="ne ly iv mx b gy oa nx l ny nz">-- end-date $(date +”%Y-%m-%d”) \</span><span id="fe4e" class="ne ly iv mx b gy oa nx l ny nz">--webhook-url {webhook_url}</span></pre><p id="66d0" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">如果希望每天都生成时差通知，可以不指定开始日期。相反，只需以正确的格式将您的结束日期指定为当前日期。<code class="fe mu mv mw mx b">$(date +”%Y-%m-%d”)</code>在运行 Bash 命令时就是这么做的。</p><p id="4b4b" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">然后，您需要包含一个 webhook-url，它可以在<a class="ae la" href="https://api.slack.com/messaging/webhooks" rel="noopener ugc nofollow" target="_blank"> Slack </a>上生成。这些 webhooks 是专门为您希望警报发送到的通道而创建的。</p><p id="c292" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">在我的完美环境中，我在 dbt shell 任务中包含了这个命令。它利用 dbt 凭证，所以您不希望只使用普通的 shell 任务。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nq"><img src="../Images/60b9d41bbec31c6e1c9bf1a2f1a03a49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LSTCUnuBpm7_Pd6g"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="de23" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">同样，如果您使用的是 Prefect，请确保设置了上游依赖项。对于 slack 命令，我设置了 re_data dbt 运行的依赖项。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nq"><img src="../Images/0c9585cc219c466eb40dbbafba2d78b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zZUvznGN297xuD0P"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">作者图片</p></figure><p id="590a" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">如果您在本地运行这个命令，而不是部署到生产环境，那么 re_data 有一个 UI 可以充分利用。您将运行一个类似于 Slack 命令的命令，但是这将生成 UI。</p><p id="8ce9" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated"><code class="fe mu mv mw mx b">re_data overview generate — end-date $(date +”%Y-%m-%d”) — interval days:1</code></p><p id="65da" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">然后，只要您已经使用这个包生成了一些模型，您就可以“服务”UI 了。</p><p id="81bb" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated"><code class="fe mu mv mw mx b">re_data overview serve</code></p><p id="093f" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">这将在您的浏览器中打开，并允许您查看您的所有警报以及您的模型的沿袭。</p><h1 id="72f8" class="lx ly iv bd lz ma mb mc md me mf mg mh kb mi kc mj ke mk kf ml kh mm ki mn mo bi translated">结论</h1><p id="3a38" class="pw-post-body-paragraph lb lc iv ld b le mp jw lg lh mq jz lj lk mr lm ln lo ms lq lr ls mt lu lv lw io bi translated">现在，我们有了一个配备有用警报系统的数据环境。我们不必生活在恐惧中，担心我们的数据在源头可能会出问题。这种数据量警报是确保一切按预期运行的好方法。</p><p id="4ad5" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">不要坐等数据管道出错。在遇到问题之前，现在<em class="nr">实施类似 dbt 包的检查和平衡。相信我，你不会想像我一样丢失两周的数据。数据实际上等于金钱和重要的见解！不惜一切代价保护它。</em></p><p id="235d" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">re_data 最好的一点就是它是免费的！您不必在已经很贵的数据堆栈上支付额外的费用。您可以充分利用 dbt 的所有惊人特性。</p><p id="47e8" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">欲了解更多关于工具和软件包的建议，以改善您的现代数据堆栈，<a class="ae la" href="https://madisonmae.substack.com/" rel="noopener ugc nofollow" target="_blank">订阅</a>我的时事通讯。</p></div></div>    
</body>
</html>