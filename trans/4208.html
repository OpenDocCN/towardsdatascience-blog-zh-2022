<html>
<head>
<title>Working with Well Trajectories in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中使用井轨迹</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/working-with-well-trajectories-in-python-b8eb39773f64#2022-09-19">https://towardsdatascience.com/working-with-well-trajectories-in-python-b8eb39773f64#2022-09-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d3c2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用wellpathpy将原始油井测量数据转换为完整的位置数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d47a8f5c1a0874bea6c5357574088e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MFd3BT5PWv1VKY6x"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">詹姆斯·惠勒摄:<a class="ae ky" href="https://www.pexels.com/photo/photo-of-pathway-surrounded-by-fir-trees-1578750/" rel="noopener ugc nofollow" target="_blank">https://www . pexels . com/photo/photo-of-pathway-around-by-fir-trees-1578750/</a></p></figure><p id="2411" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理地下数据时，深度是一个重要的测量指标。它用于将多组数据绑定到单个引用。有许多用于识别地下位置的深度参考。这些包括测量深度(MD)、真实垂直深度(TVD)和真实水下垂直深度(TVDSS)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/558dfb12b729d646646ddd0eae964b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJAxyMExR2HZWNu9Cpal9A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">钻井和测井中关键参考和深度名称的图解。图片由作者提供。</p></figure><p id="6516" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图展示了本文中提到的关键深度参考。</p><ul class=""><li id="388e" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">测量深度(MD)是沿井眼长度测量的井眼长度。</li><li id="4343" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">真实垂直深度(TVD)，是基准面(如转盘)和井筒中一点之间的绝对垂直距离。</li><li id="4ff5" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">海底真实垂直深度(TVDSS)，是平均海平面和井筒中某点之间的绝对垂直距离。</li></ul><p id="59ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当井是垂直的时，MD等于从同一基准面测量的TVD。在井斜的情况下，TVD值变得小于MD值。</p><p id="0c15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当钻井时，通常进行勘测测量，以确保井沿着预定方向前进。这将生成一个具有稀疏测量值的数据集，其中包含井眼倾角(井眼偏离垂直方向的程度)、相对于北方的方位角以及当前测量的深度。</p><p id="6287" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将其转换为定期采样的数据，类似于测井测量中使用的采样率，我们需要应用三角计算</p><p id="2062" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将看到如何使用名为<a class="ae ky" href="https://github.com/Zabamund/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>的Python库来生成完整的位置日志。</p><h2 id="0329" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">视频教程</h2><p id="27fb" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">如果你想看这个教程的实际操作，我的<a class="ae ky" href="https://www.youtube.com/c/AndyMcDonald42" rel="noopener ugc nofollow" target="_blank"> YouTube频道</a>上有这个教程的视频版本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="bbf8" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">好可怜</h1><p id="1e6d" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated"><a class="ae ky" href="https://github.com/Zabamund/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>是一个Python库，开发该库是为了从各种行业标准方法中获取油井测量数据并计算位置日志。这允许我们生成TVD、TVDSS、北距和东距。</p><p id="8443" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在下面链接的GitHub repo中找到更多关于这个库的信息。</p><div class="nv nw gp gr nx ny"><a href="https://github.com/Zabamund/wellpathpy" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">GitHub - Zabamund/wellpathpy:井斜导入</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">wellpathpy是一个LGPL-3.0许可库，以(md，inc，azi)格式导入井偏差，计算它们的TVD…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">github.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ks ny"/></div></div></a></div><p id="c6da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您还没有安装这个库，您可以使用pip安装它，如下所示:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="f1cd" class="mk ml it oo b gy os ot l ou ov">pip install wellpathpy</span></pre><h1 id="9644" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">本教程中使用的数据</h1><p id="7470" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">本教程中使用的数据是Equinor在2018年发布的Volve数据集的子集。数据集的全部细节，包括许可证，可以在下面的链接中找到。</p><div class="nv nw gp gr nx ny"><a href="https://www.equinor.com/energy/volve-data-sharing" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">Volve现场数据集</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">Equinor已经正式发布了一套完整的北海油田数据，供研究、学习和应用</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">www.equinor.com</p></div></div><div class="oh l"><div class="ow l oj ok ol oh om ks ny"/></div></div></a></div><p id="efe5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Volve数据许可证基于CC BY 4.0许可证。许可协议的全部细节可以在这里找到:</p><p id="89b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://cdn.sanity.io/files/h61q9gi9/global/de6532f6134b9a953f6c41bac47a0c055a3712d3.pdf?equinor-hrs-terms-and-conditions-for-licence-to-data-volve.pdf" rel="noopener ugc nofollow" target="_blank">https://cdn . sanity . io/files/h 61 q 9 gi 9/global/de 6532 f 6134 b 9 a 953 f 6 c 41 BAC 47 a 0 c 055 a 3712d 3 . pdf？equinor-hrs-许可条款和条件-数据-volve.pdf </a></p><h1 id="a8cc" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">导入库和数据</h1><p id="4a6a" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们教程的第一步是导入我们将要使用的库。</p><p id="7231" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们将主要使用3个库:<a class="ae ky" href="https://github.com/Zabamund/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>、<a class="ae ky" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>用于可视化我们的井轨迹，以及<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>用于创建我们的最终数据帧。</p><p id="2f0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还导入了<a class="ae ky" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> numpy </a>，它用于在<a class="ae ky" href="https://github.com/Zabamund/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>生成的数组中隐藏科学记数法。这是通过使用<code class="fe ox oy oz oo b">np.set_printoptions()</code>函数并传入<code class="fe ox oy oz oo b">supress=True</code>来实现的。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="1e05" class="mk ml it oo b gy os ot l ou ov">import wellpathpy as wp<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span><span id="a1a7" class="mk ml it oo b gy pa ot l ou ov">import numpy as np<br/>np.set_printoptions(suppress=True)</span></pre><p id="4c6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导入库后，下一步是导入测量数据。原始csv文件包含三列，分别命名为md，inc和azi。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/59ca452ae0ca6db6578ede178f6c21ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*CIDgCgbd14TJiH7E53YJsg.png"/></div></figure><p id="cae9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们有了这种格式的csv文件，我们就可以给函数调用<code class="fe ox oy oz oo b">wp.read_csv()</code>分配三个变量:<code class="fe ox oy oz oo b">md, inc</code>和<code class="fe ox oy oz oo b">azi</code>。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="0aeb" class="mk ml it oo b gy os ot l ou ov">md, inc, azi = wp.read_csv('Data/Volve/15_9-F-12_Survey_Data.csv')</span></pre><p id="8911" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在后台执行许多检查，以确保数据是有效的。其中包括:</p><ul class=""><li id="88fe" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">测量深度(md)单调增加</li><li id="fe7a" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">各列按照md，inc和azi的正确顺序排列</li><li id="0969" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">倾斜度(inc)包含0到180度之间的值</li><li id="bee4" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">方位角(azi)包含0到360度之间的值</li></ul><p id="69c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦数据被加载，我们可以调用<code class="fe ox oy oz oo b">md</code>并查看数据。这允许我们检查数据是否已经成功加载。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/9d7111c0056b3b5c2a30c4357f224b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*zO7-DVCMv7ADZNrZOGSFwQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">载入<a class="ae ky" href="https://github.com/Zabamund/wellpathpy" rel="noopener ugc nofollow" target="_blank">井眼路径</a>后的测量深度数据示例。图片由作者提供。</p></figure><h1 id="ae17" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">将调查数据加载到wellpathpy</h1><p id="fd9e" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">加载数据后，我们现在需要创建一个<a class="ae ky" href="https://github.com/Zabamund/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>偏差对象。这是按如下方式启动的:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="db3c" class="mk ml it oo b gy os ot l ou ov">dev = wp.deviation(md, inc, azi)<br/>dev</span></pre><p id="9079" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们查看dev对象时，我们看到md，inc和azi数据存储在数组中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/774a2e2a37554fb0cb1b3eb7b1c6ccf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*Al0a_CDrzVDex3wdzcXr1A.png"/></div></figure><p id="6ea1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过像这样调用它们来访问每一个:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="d2ec" class="mk ml it oo b gy os ot l ou ov">dev.md<br/>dev.inc<br/>dev.azi</span></pre><h2 id="e7b2" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">可视化原始调查数据</h2><p id="1b1f" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们可以在matplotlib 中通过创建一个包含两个子图形的图形来非常简单地可视化这些原始数据。一个用于倾角(inc ),一个用于方位角(azi)。这将使我们能够看到井眼轨迹如何随测量深度变化。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="bc23" class="mk ml it oo b gy os ot l ou ov">fig, ax = plt.subplots(1, 2, figsize=(8,10))</span><span id="42c7" class="mk ml it oo b gy pa ot l ou ov">ax1 = plt.subplot2grid((1,2), (0,0))<br/>ax2 = plt.subplot2grid((1,2), (0,1))</span><span id="a120" class="mk ml it oo b gy pa ot l ou ov">ax1.plot(dev.inc, dev.md, color = "black", marker='.', linewidth=0)<br/>ax1.set_ylim(dev.md[-1], 0)<br/>ax1.set_xlim(0, 90)<br/>ax1.set_xlabel('Deviation', fontweight='bold', fontsize=14)<br/>ax1.set_ylabel('Measured Depth', fontweight='bold', fontsize=14)<br/>ax1.grid(color='lightgrey')<br/>ax1.set_axisbelow(True)</span><span id="8e92" class="mk ml it oo b gy pa ot l ou ov">ax2.plot(dev.azi, dev.md, color = "black", marker='.', linewidth=0)<br/>ax2.set_ylim(dev.md[-1], 0)<br/>ax2.set_xlim(0, 360)<br/>ax2.set_xlabel('Azimuth', fontweight='bold', fontsize=14)<br/>ax2.grid(color='lightgrey')<br/>ax2.set_axisbelow(True)</span><span id="340d" class="mk ml it oo b gy pa ot l ou ov">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/14d2d2ab1530059a8225db3e9a034065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*OTPfXHUBShG-ijOy2yNrTA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原始勘测测量的井筒方位角和倾斜度。图片由作者提供。</p></figure><p id="8a6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的图中我们可以看到:</p><ul class=""><li id="0133" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">钻孔开始是垂直的，直到我们到达大约500米，然后逐渐增加，然后减少。最终，井眼以53.43度的倾角落在目标层段内。</li><li id="93b9" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">当钻孔开始垂直时，我们的方位角被设置为正北(0度)，然后转向东北，然后转向南方，并在东方结束</li></ul><p id="c4e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文的后面，我们将能够以3D的形式来可视化这些数据，这将会更有意义。</p><h1 id="5fe7" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">从测量数据创建位置日志</h1><p id="7bfc" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">调查数据是随机抽样的，两次测量之间有很大的间隔。我们可以对数据进行重新采样，这样每1米就有一次测量。</p><p id="c814" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们首先定义深度步长，然后创建一个在0和最后一个<code class="fe ox oy oz oo b">md</code>值之间的等间距值列表。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="cc33" class="mk ml it oo b gy os ot l ou ov">depth_step = 1<br/>depths = list(range(0, int(dev.md[-1]) + 1, depth_step))</span></pre><p id="2f00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/Zabamund/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>包含多种计算真实垂直深度(TVD)的方法，但是，我们将重点介绍最小曲率法。如果你想了解这种方法背后的数学原理，请点击下面的链接。</p><div class="nv nw gp gr nx ny"><a href="https://www.drillingformulas.com/minimum-curvature-method/" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd iu gy z fp od fr fs oe fu fw is bi translated">最小曲率法</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">Facebook0Tweet0Pin0LinkedIn0最小曲率法平滑平衡切线的两条直线段…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">www.drillingformulas.com</p></div></div><div class="oh l"><div class="pf l oj ok ol oh om ks ny"/></div></div></a></div><p id="64fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了创建我们的TVD曲线和位置测量(北距和东距),我们需要调用以下代码。这也将重新采样我们的深度值，以便我们每1米测量一次。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="e012" class="mk ml it oo b gy os ot l ou ov">pos = dev.minimum_curvature().resample(depths = depths)</span></pre><p id="3c3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们调用<code class="fe ox oy oz oo b">pos</code>时，我们得到一个包含三个数组的位置对象，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/6120a207146afb55d58ccdd831cbecd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ncRLqIA_1Wtp-JcaVFfMDw.png"/></div></figure><h2 id="61d9" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">创建重新采样的测量数据</h2><p id="ecb3" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">为了将我们的原始测量数据更新到1米的深度步长，我们可以通过调用<code class="fe ox oy oz oo b">pos.deviation()</code>来对数据进行重新采样</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="6cb0" class="mk ml it oo b gy os ot l ou ov">resampled_dev = pos.deviation()</span></pre><p id="9bc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们查看<code class="fe ox oy oz oo b">resampled_dev</code>时，我们得到下面的数组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/362b98f651043eabde5e7c8505044f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PG0IKR0Ho_KdN3TbrJ5JRg.png"/></div></div></figure><p id="82c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与我们对数据进行重采样的任何计算一样，将结果与原始结果进行比较是一种很好的做法。</p><p id="d2af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码与上面创建的图相同，但是现在包含了来自变量<code class="fe ox oy oz oo b">resampled</code>的重采样数据。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="7080" class="mk ml it oo b gy os ot l ou ov">fig, ax = plt.subplots(1, 2, figsize=(8,10))</span><span id="fd54" class="mk ml it oo b gy pa ot l ou ov">ax1 = plt.subplot2grid((1,2), (0,0))<br/>ax2 = plt.subplot2grid((1,2), (0,1))</span><span id="54fe" class="mk ml it oo b gy pa ot l ou ov">ax1.plot(dev.inc, dev.md, color = "black", marker='.', linewidth=0)<br/>ax1.plot(resampled_dev.inc, resampled_dev.md, color='red')</span><span id="7d64" class="mk ml it oo b gy pa ot l ou ov">ax1.set_ylim(dev.md[-1], 0)<br/>ax1.set_xlim(0, 90)<br/>ax1.set_xlabel('Deviation', fontweight='bold', fontsize=14)<br/>ax1.set_ylabel('Measured Depth', fontweight='bold', fontsize=14)<br/>ax1.grid(color='lightgrey')<br/>ax1.set_axisbelow(True)</span><span id="6d08" class="mk ml it oo b gy pa ot l ou ov">ax2.plot(dev.azi, dev.md, color = "black", marker='.', linewidth=0)<br/>ax2.plot(resampled_dev.azi,resampled_dev.md, color='red')</span><span id="1c9a" class="mk ml it oo b gy pa ot l ou ov">ax2.set_ylim(dev.md[-1], 0)<br/>ax2.set_xlim(0, 360)<br/>ax2.set_xlabel('Azimuth', fontweight='bold', fontsize=14)<br/>ax2.grid(color='lightgrey')<br/>ax2.set_axisbelow(True)</span><span id="120b" class="mk ml it oo b gy pa ot l ou ov">plt.show()</span></pre><p id="9958" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当图出现时，我们可以看到原始数据为黑点，重采样数据为红线。总的来说，这看起来不错，并且这些值看起来彼此一致。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/87bf292eb97a9d257ab2bd9660e70576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*leFZcTXjqYv9P29BSfXiew.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原始勘测测量的井眼方位角和倾斜度，以及来自wellpathpy的重采样数据。图片由作者提供。</p></figure><h2 id="6152" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">创建位置地块</h2><p id="de44" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">现在我们已经对数据进行了重新采样，并创建了位置日志，我们可以用下面的代码来可视化我们的位置数据。这允许我们生成三个图:</p><ul class=""><li id="7e3e" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">北/南位置与东/西位置(地形图)</li><li id="2512" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">东西位置随深度的变化</li><li id="0759" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">北/南位置随深度的变化</li></ul><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="675a" class="mk ml it oo b gy os ot l ou ov">fig, ax = plt.subplots(2, 2, figsize=(15,5))</span><span id="f45a" class="mk ml it oo b gy pa ot l ou ov">ax1 = plt.subplot2grid((1,3), (0,0))<br/>ax2 = plt.subplot2grid((1,3), (0,1))<br/>ax3 = plt.subplot2grid((1,3), (0,2))</span><span id="2832" class="mk ml it oo b gy pa ot l ou ov">ax1.plot(pos.easting, pos.northing, color = "black", linewidth=2)</span><span id="cdd9" class="mk ml it oo b gy pa ot l ou ov">ax1.set_xlim(-500, 400)<br/>ax1.set_ylim(-400, 100)<br/>ax1.set_xlabel('West (-) / East (+)', fontweight='bold', fontsize=14)<br/>ax1.set_ylabel('South (-) / North (+)', fontweight='bold', fontsize=14)<br/>ax1.grid(color='lightgrey')<br/>ax1.set_axisbelow(True)</span><span id="af95" class="mk ml it oo b gy pa ot l ou ov">ax2.plot(pos.easting, pos.depth, color = "black", linewidth=2)</span><span id="e001" class="mk ml it oo b gy pa ot l ou ov">ax2.set_xlim(-500, 400)<br/>ax2.set_ylim(3500, 0)<br/>ax2.set_xlabel('West (-) / East (+)', fontweight='bold', fontsize=14)<br/>ax2.set_ylabel('Depth', fontweight='bold', fontsize=14)<br/>ax2.grid(color='lightgrey')<br/>ax2.set_axisbelow(True)</span><span id="2d4a" class="mk ml it oo b gy pa ot l ou ov">ax3.plot(pos.northing, pos.depth, color = "black", linewidth=2)</span><span id="12b4" class="mk ml it oo b gy pa ot l ou ov">ax3.set_xlim(-500, 400)<br/>ax3.set_ylim(3500, 0)<br/>ax3.set_xlabel('South (-) / North (+)', fontweight='bold', fontsize=14)<br/>ax3.set_ylabel('Depth', fontweight='bold', fontsize=14)<br/>ax3.grid(color='lightgrey')<br/>ax3.set_axisbelow(True)</span><span id="dc30" class="mk ml it oo b gy pa ot l ou ov">plt.tight_layout()</span><span id="5b3a" class="mk ml it oo b gy pa ot l ou ov">plt.show()</span></pre><p id="c69f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这产生了下面的图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/356af924f71af23ba597089eb8658261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e1fyDEMPvZlNQQcnMkNY9A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从不同角度观察井眼位置，以便更好地了解井眼轨迹。图片由作者提供。</p></figure><h1 id="ca64" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">计算TVDSS</h1><p id="5d00" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">这些计算的一个常见输出是TVDSS。这为我们提供了基准面(如转盘或钻台)和井筒内某个位置之间的绝对垂直差。</p><p id="e04a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当它被计算时，我们在平均海平面以上有正值，在平均海平面以下有负值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/558dfb12b729d646646ddd0eae964b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJAxyMExR2HZWNu9Cpal9A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">钻井和测井中关键参考和深度名称的图解。图片由作者提供。</p></figure><p id="0427" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了计算TVDSS，我们简单地调用<code class="fe ox oy oz oo b">pos.to_tvdss()</code>并传入我们的永久数据。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="a9fe" class="mk ml it oo b gy os ot l ou ov"><br/>pos_tvdss = pos.to_tvdss(datum_elevation=30)</span></pre><p id="26bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行时，它返回以下带有多个数组的位置对象。第一个标记为深度的代表我们的TVDSS数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/71888a380f933f557da720ff7024ddeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*yuCfzEsBM8xokxYeNjK5Wg.png"/></div></figure><h1 id="514b" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">用Plotly构建3D井眼轨迹图</h1><p id="919c" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">查看2D图上的油井位置可能会有很大的局限性，尤其是当您试图了解井筒的位置和形状时。在本节中，我们将了解如何使用Python和创建交互式3D绘图</p><p id="6447" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，在我们生成图之前，我们可以选择将我们的井筒定位在正确的位置。</p><h2 id="6c90" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">设置参考位置</h2><p id="c3b4" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们的位置对象的当前北距和东距从0开始。我们可以通过提供钻机的表面位置来修正该位置。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="1947" class="mk ml it oo b gy os ot l ou ov">wellhead_northing = 6478572<br/>wellhead_easting = 435050</span><span id="3000" class="mk ml it oo b gy pa ot l ou ov">pos_wellhead = pos.to_wellhead(surface_northing=wellhead_northing,<br/>                               surface_easting=wellhead_easting)</span></pre><p id="d6dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这部分代码后，我们可以检查我们的井筒位置的北距，以查看数据是否已更新。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="de8e" class="mk ml it oo b gy os ot l ou ov">pos_wellhead.northing</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/32081ea03d350339766217ae97aaf025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*69v_Iz00A757PoOsQ2Uj2Q.png"/></div></figure><h2 id="aa04" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">创建3D井眼轨迹图</h2><p id="af82" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">现在，井眼已经参考到正确的位置，我们现在可以制作我们的三维绘图。</p><p id="6734" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将依赖于<a class="ae ky" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> plotly </a>而不是matplotlib。在我看来，与matplotlib相比，它生成了更好的交互图。</p><p id="1793" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码用于生成3D绘图。如果你没有安装<a class="ae ky" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> plotly </a>，你可以使用<code class="fe ox oy oz oo b">!pip install plotly</code>在Jupyter笔记本上安装。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="5323" class="mk ml it oo b gy os ot l ou ov">import plotly<br/>import plotly.graph_objs as go</span><span id="c0c4" class="mk ml it oo b gy pa ot l ou ov"># Configure Plotly to be rendered within the notebook<br/>plotly.offline.init_notebook_mode()</span><span id="23ca" class="mk ml it oo b gy pa ot l ou ov"># Configure the trace.<br/>wellpath = go.Scatter3d(<br/>    x=pos_wellhead.easting,  <br/>    y=pos_wellhead.northing,<br/>    z=pos_wellhead.depth,<br/>    mode='markers',<br/>    marker={<br/>        'size': 5,<br/>        'opacity': 0.8,<br/>    }<br/>)</span><span id="9cd0" class="mk ml it oo b gy pa ot l ou ov">data = [wellpath]</span><span id="de76" class="mk ml it oo b gy pa ot l ou ov">fig = go.Figure(data=data)</span><span id="c3ff" class="mk ml it oo b gy pa ot l ou ov">fig.update_layout(scene = dict(<br/>                    zaxis_autorange="reversed",<br/>                    xaxis_title='West (-) / East (+) (m)',<br/>                    yaxis_title='South (-) / North (+) (m)',<br/>                    zaxis_title='TVD (m)'),<br/>                    width=800,<br/>                    margin=dict(r=20, b=10, l=10, t=10))<br/>plotly.offline.iplot(fig)</span></pre><p id="74dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当上面的代码被执行时，我们生成了下面这个可以移动的图。注意，为了显示z轴随着我们的深入而增加的深度，我们需要通过用<code class="fe ox oy oz oo b">zaxis_autorange="reversed"</code>更新布局来反转z轴。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/b0ce507371e45aaa2c64bfa34f1f619d.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*UNkydXKKfNm4ZFXzZGtLFw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用plotly创建的交互式3D井眼轨迹。图片由作者提供。</p></figure><h1 id="7121" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">创建重采样调查数据和位置数据的熊猫数据框架</h1><p id="0b8e" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">在Python中处理测井数据时，通常会处理数据帧。<a class="ae ky" href="https://github.com/Zabamund/wellpathpy/tree/master/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>没有提供直接导出到这种格式，但是我们可以很容易地创建一个数据帧，如下所示:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="f696" class="mk ml it oo b gy os ot l ou ov">#Create a dictionary of the curve names and the data<br/>data = {'MD':resampled_dev.md, <br/>        'AZI':resampled_dev.azi,<br/>        'INC':resampled_dev.inc,<br/>        'TVD':pos.depth,<br/>        'TVDSS':pos_tvdss.depth,<br/>        'YLOC':pos.northing,<br/>        'XLOC':pos.easting,<br/>        'NORTHING': pos_wellhead.northing,<br/>        'EASTING': pos_wellhead.easting}</span><span id="f0eb" class="mk ml it oo b gy pa ot l ou ov">df = pd.DataFrame(data)</span></pre><p id="6e0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回以下数据帧，其中包含我们计算的所有位置数据和测量结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/abfaf8e55704bada28bf9536de1fedb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LB8WeMZAcQlkKznFWNBIWQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在pandas数据框架内结合油井测量和位置数据。图片由作者提供。</p></figure><h1 id="9ab9" class="nk ml it bd mm nl nm nn mp no np nq ms jz nr ka mv kc ns kd my kf nt kg nb nu bi translated">摘要</h1><p id="b3a5" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">使用<a class="ae ky" href="https://github.com/Zabamund/wellpathpy/tree/master/wellpathpy" rel="noopener ugc nofollow" target="_blank"> wellpathpy </a>库，将原始油井测量数据转换为定期采样的位置测量数据是一个简单的过程。生成数据后，我们可以创建交互式图表，以便更好地可视化和理解井眼轨迹。此外，这种数据现在可以与来自同一口井的测井数据集成，以便具有完整的复合井数据集。</p></div><div class="ab cl po pp hx pq" role="separator"><span class="pr bw bk ps pt pu"/><span class="pr bw bk ps pt pu"/><span class="pr bw bk ps pt"/></div><div class="im in io ip iq"><p id="71e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pv">感谢阅读。在你走之前，你一定要订阅我的内容，把我的文章放到你的收件箱里。</em> <a class="ae ky" href="https://andymcdonaldgeo.medium.com/subscribe" rel="noopener"> <strong class="lb iu"> <em class="pv">你可以在这里做！</em></strong></a><strong class="lb iu"><em class="pv"/></strong><em class="pv">或者，您可以</em> <a class="ae ky" href="https://fabulous-founder-2965.ck.page/2ca286e572" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="pv">注册我的简讯</em> </strong> </a> <em class="pv">免费获取更多内容，直接发送到您的收件箱。</em></p><p id="9894" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，通过注册会员，你可以获得完整的媒介体验，并支持我和成千上万的其他作家。每月只需花费你5美元，你就可以接触到所有精彩的媒体文章，也有机会通过写作赚钱。</p><p id="f393" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="pv">如果你用</em> <a class="ae ky" href="https://andymcdonaldgeo.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="pv">我的链接</em> </strong> </a> <strong class="lb iu"> <em class="pv">，</em> </strong> <em class="pv">报名，你直接用你的一部分费用支持我，不会多花你多少钱。如果你这样做了，非常感谢你的支持！</em></p></div></div>    
</body>
</html>