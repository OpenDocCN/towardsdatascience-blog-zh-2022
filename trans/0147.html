<html>
<head>
<title>How to Fill Missing Data with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用熊猫填补缺失数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-fill-missing-data-with-pandas-8cb875362a0d#2022-02-07">https://towardsdatascience.com/how-to-fill-missing-data-with-pandas-8cb875362a0d#2022-02-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4dbb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">初学者指南</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/a76435c866095265592839c0cd16a8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Qr1MOezmdEjoNlzI"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">马特·霍夫曼在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="08ac" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">介绍</h1><p id="37db" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">处理缺失数据是任何数据科学工作流的重要组成部分。处理缺失数据的常用方法包括(a)忽略缺失数据，(b)删除缺失数据的记录，或(c)填充缺失数据。在本文中，我们将使用一个包含2021年1月4天水果价格的玩具数据集，研究各种填充熊猫库缺失数据的方法。</p><p id="87fe" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">让我们生成我们的玩具数据集。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="84e5" class="my lb it mu b gy mz na l nb nc">df = pd.DataFrame({'date':['2021-01-01', '2021-01-02', '2021-01-03', '2021-01-04','2021-01-01', '2021-01-02', '2021-01-03', '2021-01-04'], 'fruit':['apple', 'apple', 'apple', 'apple', 'mango', 'mango', 'mango', 'mango'], 'price': [0.80, None, None, 1.20, None, 2.10, 2.00, 1.80]})<br/>df['date'] = pd.to_datetime(df['date'])</span></pre><p id="4e64" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">在该数据集中，有4条记录的缺失值用“NaN”表示，并且苹果的价格通常低于芒果的价格。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/bf55abd8ad29d34e52d86907d09b2c84.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*gOfGGwNEOGWRlBlv"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h1 id="2a78" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">方法</h1><h2 id="f551" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">用常数值填充</h2><p id="27a5" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">让我们用用户定义的价格0.85来填充缺失的价格。“价格”列中所有缺少的值都将用相同的值填充。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="a5c2" class="my lb it mu b gy mz na l nb nc">df['price'].fillna(value = 0.85, inplace = True)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi np"><img src="../Images/47daf608fae1c22f80d474d4cab3757a.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/0*G9DPl9qC2b8j2u7C"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h2 id="59c2" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">用列的平均值/中值填充</h2><p id="1295" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们可以用整个列的平均价格或中间价格来填充缺失的价格。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="abd8" class="my lb it mu b gy mz na l nb nc"># mean<br/>df['price'].fillna(value = df.price.mean(), inplace = True)</span><span id="a4fa" class="my lb it mu b gy nq na l nb nc"># median<br/>df['price'].fillna(value = df.price.median(), inplace = True)</span></pre><p id="6177" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated"><code class="fe nr ns nt mu b">df.price.mean()</code>和<code class="fe nr ns nt mu b">df.price.median()</code>分别返回平均价格(1.975)和中间价格(2.0)。<code class="fe nr ns nt mu b">.fillna()</code>方法用给定的平均值或中间值估算缺失的价格。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/68a84bb7adcd312f4133082c86ed0520.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/0*xYAeknrJHuCcNSJv"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">左图:用平均值估算缺失价格。右图:用中位数估算缺失价格。作者图片</p></figure><p id="9462" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">这些价格对于苹果价格来说可能太高，对于芒果价格来说可能太低，因此我们可能不想用所有水果的平均价格来估算苹果的价格。相反，我们可能想用苹果的平均(或中间)价格来估算苹果的缺失价格，并对芒果做同样的事情。这就引出了下一种用特定组内的平均值(或中值)填充缺失值的方法。</p><h2 id="8cec" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">用组的平均值/中值填充</h2><p id="1836" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们可以通过以下方式使用组级统计来填充缺失值。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="d8b5" class="my lb it mu b gy mz na l nb nc"># mean<br/>df['price'].fillna(df.groupby('fruit')['price'].transform('mean'), inplace = True)</span><span id="a622" class="my lb it mu b gy nq na l nb nc"># median<br/>df['price'].fillna(df.groupby('fruit')['price'].transform('median'), inplace = True)</span></pre><p id="2f99" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">让我们把上面的代码分成两步。</p><p id="a320" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">第一步:计算每种水果的平均价格，并返回一个与原始数据帧行数相同的序列。苹果和芒果的平均价格分别为1.00英镑和2.95英镑。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="29f8" class="my lb it mu b gy mz na l nb nc">df.groupby('fruit')['price'].transform('mean')</span></pre><p id="9e22" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">第2步:根据第1步的结果填充缺失的值。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/b5c70c7bfb62f2326f7258fd4a71563f.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/0*ibttnUOhVUlvhwgP"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h2 id="a698" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">向前填充</h2><p id="8540" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">向前填充，简称为“ffill ”,沿着数据帧的选定轴向前传播最后一个有效观察值(在我们的示例中，沿着列向下)。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="b803" class="my lb it mu b gy mz na l nb nc">df['price'].fillna(method = 'ffill', inplace = True)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/703f1f11e02161c107fbe7b2a6e4167a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/0*YwUB4dPvVs2GQHLV"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="0da9" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">我们可以通过使用<code class="fe nr ns nt mu b">limit</code>参数来限制传播最后一个有效观察的行数。以下示例显示，传播仅限于最后一次有效观察后的1步。苹果2021-01-03缺少的价格没有填写，因为它是在最后一次有效观察之后2步。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="8a57" class="my lb it mu b gy mz na l nb nc">df['price'].fillna(method = 'ffill', limit = 1, inplace = True)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/44ada6f9b7bdf33fd0b04820a7476b1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/0*wUgAd9OQi7O_U6Vt"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="7134" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">向前填充用2021年1月4日的苹果价格替换2020年1月1日缺失的芒果价格。这没有意义，因为这不是苹果之间的比较(没有双关语的意思)。因此，我们可能希望对每个水果分别应用向前填充。我们可以通过使用熊猫分组前向填充方法来实现。</p><h2 id="312b" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">组内正向填充</h2><p id="4d0f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">正向填充可以与groupby结合使用，在特定组内执行正向填充。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/be2bd56992efc550ec6035aed22363c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/0*D-FhxVnQ-6Q-PRXB"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="997b" class="my lb it mu b gy mz na l nb nc">df['price'] = df.groupby('fruit')['price'].ffill()</span></pre><p id="c4b3" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">请注意，2021–01–01上缺失的芒果价格没有被2021–01–04上的苹果价格填充，因为苹果和芒果现在被视为不同的组。与前面的例子类似，我们也可以设置<code class="fe nr ns nt mu b">limit</code>参数来限制ffill传播。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="6c1f" class="my lb it mu b gy mz na l nb nc">df['price'] = df.groupby('fruit')['price'].ffill(limit = 1)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/d10c404bb2e03cc8e282c7e59f257523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/0*-iq4kk5REwlebguh"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h2 id="92dc" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">后面充填物</h2><p id="44cc" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">回填也简称为“bfill ”,是正向回填的反义词。在“NaN”值之后的第一个有效观察被识别，并沿着所选的轴向后传播(在我们的例子中是向上的列)。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="f0ba" class="my lb it mu b gy mz na l nb nc">df['price'].fillna(method = 'bfill', inplace = True)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/081e4d4541758516fca151f59c9d24ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/0*oiDtJRmjPO7mRpFS"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="dc83" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">类似地，我们也可以使用<code class="fe nr ns nt mu b">limit</code>参数来限制有效观察传播的行数。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="5485" class="my lb it mu b gy mz na l nb nc">df['price'].fillna(method = 'bfill', limit = 1, inplace = True)</span></pre><h2 id="fac8" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">组内回填</h2><p id="15c0" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">与前向填充类似，我们也可以仅在特定组内执行后向填充，并限制其传播。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="c63f" class="my lb it mu b gy mz na l nb nc"># backfill without propagation limit<br/>df['price'] = df.groupby('fruit')['price'].bfill()</span><span id="6d48" class="my lb it mu b gy nq na l nb nc"># backfill with propagation limited to 1<br/>df['price'] = df.groupby('fruit')['price'].bfill(limit = 1)</span></pre><h2 id="a7a7" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">FFill和BFill的组合</h2><p id="856d" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们也可以通过方法链接用前向填充填充一个列，然后用后向填充填充。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="edfe" class="my lb it mu b gy mz na l nb nc">df['price'] = df.groupby('fruit')['price'].ffill().bfill()</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/505fcc1f70999fb94db0461ce78092c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/0*EigRTqT8ybMMUZZe"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="db60" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">注意<code class="fe nr ns nt mu b">.ffill()</code>和<code class="fe nr ns nt mu b">.bfill()</code>的顺序很重要。如果我们交换顺序，将首先执行回填，然后执行向前回填，从而产生不同的结果。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="3575" class="my lb it mu b gy mz na l nb nc">df['price'] = df.groupby('fruit')['price'].bfill().ffill()</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/df70e4d91041f09b8171cb1483bf4c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/0*BXk8ZdgFBXNw2yuZ"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h2 id="4464" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">插入</h2><p id="d46e" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">插值是一种估计位于一系列已知离散数据点之间的新数据点的值的方法。我们可以通过以下方式对熊猫应用线性插值</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="e9f3" class="my lb it mu b gy mz na l nb nc">df['price'].interpolate(method = 'linear', inplace = True)</span></pre><p id="253f" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">线性插值假设这些值的间距相等。苹果在2021年1月2日和2021年1月3日缺少的值被填充为0.933和1.067，其中价格以0.133的间隔增加。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oa"><img src="../Images/91d6f23772c2375abc51736ddc7c99f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Hol8k9kfX-I-spVi"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="fc27" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">以这种方式使用线性插值来填充2021年1月1日缺失的芒果价格是没有意义的，因为我们是基于2021年1月4日的苹果价格和2021年1月2日的芒果价格进行插值的。让我们试着对每个水果分别进行插值。</p><h2 id="2aca" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">在组内插值</h2><p id="ab5f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们可以按以下方式在特定组内执行插值</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="d27c" class="my lb it mu b gy mz na l nb nc">df['price'] = df.groupby('fruit')['price'].apply(lambda x: x.interpolate(method='linear'))</span></pre><p id="985b" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">芒果在2021年1月1日的价格是“Nan ”,因为没有足够的数据点来执行插值。线性插值需要至少2个已知数据点，但是没有芒果在2021年1月1日之前的数据点。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ob"><img src="../Images/2fc530c359137719206ef147bfc9377b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tNW5ymHI7bnNm1r6"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="7b6a" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">假设2021年1月1日和2021年1月2日的芒果价格相同，我们可以使用回填来填充缺失的价格。让我们通过将两种方法链接在一起来依次执行插值和回填。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="40b2" class="my lb it mu b gy mz na l nb nc">df['price'] = df.groupby('fruit')['price'].apply(lambda x: x.interpolate(method='linear')).bfill()</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oc"><img src="../Images/496774e33a9d3676b53b044c74ee9074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bl6XAyWzkIJlLlx8"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h2 id="f2e1" class="my lb it bd lc ne nf dn lg ng nh dp lk mb ni nj lm mf nk nl lo mj nm nn lq no bi translated">基于条件的填充值</h2><p id="fa9c" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">在某些情况下，我们可能希望根据其他列中的值来定义如何填充缺失值。例如，水果的价格在周末可能比平日更贵。因此，我们希望用以下方式来填补缺失的价格:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi od"><img src="../Images/f62b3568ec75980b709ad624ef15380a.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*hSUeeSaAhDo_3kI4mMMwdQ.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><p id="9f94" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">首先，我们需要通过创建一个布尔列来确定哪些日期是周末和工作日，其中<code class="fe nr ns nt mu b">True</code>表示工作日，<code class="fe nr ns nt mu b">False</code>表示周末。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="fecb" class="my lb it mu b gy mz na l nb nc">df['weekday'] = df['date'].apply(lambda x: False if x.day_name() in ['Saturday', 'Sunday'] else True)</span></pre><p id="96b3" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">然后我们确定每种水果的平均价格</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="bc47" class="my lb it mu b gy mz na l nb nc">mean_price = df.groupby('fruit')['price'].transform('mean')</span></pre><p id="a8bf" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">最后我们根据给定的条件用熊猫<code class="fe nr ns nt mu b">.where()</code>方法填充缺失值。</p><pre class="kk kl km kn gt mt mu mv mw aw mx bi"><span id="975a" class="my lb it mu b gy mz na l nb nc">df['price'].fillna((mean_price).where(cond = df.weekday, other = mean_price*1.25), inplace = True)</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oe"><img src="../Images/11474ff09ce7b2218bd51661813b0ae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ra9r4k4LHPpTDUd-"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">作者图片</p></figure><h1 id="bc82" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">结论</h1><p id="9098" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">在本文中，我们研究了以下使用熊猫填充缺失值的方法。</p><ul class=""><li id="660a" class="of og it lu b lv mo ly mp mb oh mf oi mj oj mn ok ol om on bi translated">菲尔娜</li><li id="3c45" class="of og it lu b lv oo ly op mb oq mf or mj os mn ok ol om on bi translated">向前填充</li><li id="43a2" class="of og it lu b lv oo ly op mb oq mf or mj os mn ok ol om on bi translated">后面充填物</li><li id="2cef" class="of og it lu b lv oo ly op mb oq mf or mj os mn ok ol om on bi translated">插入文字</li></ul><p id="7d68" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">填充方法的选择取决于假设和问题的背景。例如，用苹果和芒果的平均价格来填充芒果的缺失值可能不是一个好主意，因为苹果和芒果在我们的玩具数据集中具有相当不同的价格。</p><p id="4c7a" class="pw-post-body-paragraph ls lt it lu b lv mo ju lx ly mp jx ma mb mq md me mf mr mh mi mj ms ml mm mn im bi translated">我们还将看到如何将每个方法与pandas <code class="fe nr ns nt mu b">.groupby()</code>方法结合使用，分别为每个组填充缺失值。</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><ul class=""><li id="ee46" class="of og it lu b lv mo ly mp mb oh mf oi mj oj mn ok ol om on bi translated"><a class="ae kz" href="https://medium.com/@edwin.tan/membership" rel="noopener">加入灵媒</a>阅读更多这样的故事</li><li id="3dd1" class="of og it lu b lv oo ly op mb oq mf or mj os mn ok ol om on bi translated">关注我关于熊猫的教程</li></ul></div></div>    
</body>
</html>