<html>
<head>
<title>How To Extract Data From The Twitter API Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python从Twitter API中提取数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-extract-data-from-the-twitter-api-using-python-b6fbd7129a33#2022-05-16">https://towardsdatascience.com/how-to-extract-data-from-the-twitter-api-using-python-b6fbd7129a33#2022-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f93f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Tweepy最新版本概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/29a1b529845885eb72af3710a7484044.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*czaEEQhu0vF0tT0B"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卢克·切瑟在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1d9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在许多情况下，从Twitter等社交网络获取外部数据是有价值的。</p><p id="293f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论你是大公司还是个人，这都有助于进行和丰富特定主题的分析，监控竞争，评估特定产品的社会声誉，分析客户评论，跟踪对最近事件的反应等。</p><p id="bb82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">几年前，从Twitter和其他社交网络中提取数据是一场噩梦:没有API，没有清晰的文档，没有库，并且您必须手动构建复杂的网络爬虫来从底层HTML代码中收集数据。</p><p id="a895" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不用说，这是痛苦和笨拙的😰。</p><p id="8658" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望，事情已经挂起了很多。</p><blockquote class="lv lw lx"><p id="0fc8" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><em class="it">在这篇文章中，我将向你展示如何从Twitter中提取有用且可操作的数据。为此，我们将使用一个名为</em> <strong class="lb iu"> <em class="it"> Tweepy </em> </strong> <em class="it">的Python包，它将与Twitter API交互以获取不同类型的元数据并自动执行任务。</em></p></blockquote><p id="beb6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望你都准备好了。让我们看一看🔍</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="c8bf" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">我们为什么需要Twitter API？</h1><p id="eee5" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">想象一下:你是一名web开发人员，想要提取一个给定帐户的tweets，以便将它们嵌入到你的应用程序中。您还想每天获取并更新这些推文，以获得最新的推文。</p><blockquote class="lv lw lx"><p id="0f00" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">你会怎么做？</p></blockquote><p id="7afb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了消费Twitter数据，你不需要访问Twitter的内部服务器和数据库。你也不需要理解Twitter是如何编码的。</p><p id="6648" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您所需要的只是您和Twitter后端之间的一个中介，一个您可以请求(通过一些参数)以获得一些数据或与Twitter服务交互的中介。</p><p id="2887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单地说，API就是这样:它只是两个相互通信的独立应用程序之间的连接点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/2ee4761b1edb45e7a7853e3ebc1b65bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OE6wYsiPuJGPDpdyYA60Pg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e8c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一种抽象，Twitter API<strong class="lb iu">简化了与第三方(开发者、应用、其他API等)的集成。).</strong></p><p id="c3b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是您可以用Twitter API做的事情:</p><ul class=""><li id="8be4" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated">基于标签、关键词、地理位置等以编程方式搜索推文。</li><li id="6ceb" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">构建自动转发预定义账户列表的Twitter机器人</li><li id="d4a5" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">基于一系列过滤器实时传输推文</li><li id="a017" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">自动关注用户列表</li><li id="7a5d" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">等等。</li></ul><p id="fe73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该API允许您以编程方式执行您从界面中手动执行的任何操作。</p><p id="7c4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来很有趣:现在让我们看看Python如何与Twitter API交互。</p><h1 id="e832" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">创建一个Twitter应用程序并设置凭证</h1><p id="d671" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated"><em class="ly">为了能够重现以下步骤，你需要一个Twitter账户。</em></p><p id="b548" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使用Twitter API，你首先必须在开发者的<a class="ae ky" href="https://developer.twitter.com/en" rel="noopener ugc nofollow" target="_blank">网站</a>上注册成为Twitter开发者。</p><p id="d807" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注册后，您需要创建一个Twitter应用程序，该应用程序将设置一系列凭证:这些凭证稍后将由Tweepy库使用，以便对您进行身份验证。</p><p id="2643" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，进入开发者的<a class="ae ky" href="https://developer.twitter.com/en/portal/dashboard" rel="noopener ugc nofollow" target="_blank">仪表盘</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/7b0855dba6016cce0a49ccc0d1a92e02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8RzLCxEbvFfpBV0F0YAhg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="eec3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击左侧边栏中的<strong class="lb iu">概述</strong>并点击<strong class="lb iu">创建应用</strong>按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/bd43e35c53c120dfe492e0d44df76487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHiNzWowPaZqZkrWZiuaKA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="5a14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为您的应用程序命名。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/7d6a5e9dd0dc3a110fc0d1671b006cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KKZFtw_giqRM20bWO00OIg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="492b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将生成以下凭据。这是私人物品，不要和任何人分享。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/8955d41d45160e7e38212609d3742feb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j3vFoqr5dDcZ9MfjaUno6w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="9d22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在第一次看到凭据时没有进行复制粘贴，则需要重新生成凭据。为此，从左侧边栏访问您的应用程序，点击<strong class="lb iu">键和令牌</strong>边栏。</p><p id="e347" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击每个<strong class="lb iu">重新生成</strong>按钮，并将以下凭证保存在某处:</p><ul class=""><li id="dd80" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated"><strong class="lb iu"> API_KEY </strong></li><li id="36e6" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><strong class="lb iu"> API_KEY_SECRET </strong></li><li id="2b38" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><strong class="lb iu">访问_令牌</strong></li><li id="bfda" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><strong class="lb iu">访问_令牌_秘密</strong></li><li id="a2ad" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><strong class="lb iu">不记名_令牌</strong></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/ccd5709cf58070f5e262cdd18ae08d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QokF2BnUU2gVxzg4F5pt2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="57c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您现在已经准备好使用API了。</p><h1 id="df8d" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">连接到Twitter API</h1><p id="123a" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了能够使用Python与Twitter API进行交互，我们将使用一个名为<a class="ae ky" href="https://github.com/tweepy/tweepy/" rel="noopener ugc nofollow" target="_blank"> Tweepy </a>的库。</p><p id="0066" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了能够从源代码中隐藏凭证并将它们作为环境变量加载，我们将使用<a class="ae ky" href="https://github.com/theskumar/python-dotenv" rel="noopener ugc nofollow" target="_blank"> python-dotenv </a>。</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="a1ba" class="oj mk it of b gy ok ol l om on">pip install tweepy<br/>pip install python-dotenv</span></pre><p id="953f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，创建一个<code class="fe oo op oq of b">.env</code>文件来保存您的凭证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/1456477e7eb6f4e4a6d23c7cc78965c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RkCnej4hL7T5q5BW5AjX8Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="9559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在包含<code class="fe oo op oq of b">.env</code>文件的同一个目录中打开一个jupyter笔记本或python交互式shell。</p><p id="c1ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用下面的脚本对Twitter API进行认证。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="f586" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们检查一下发起这个连接的Twitter用户是不是我。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/c41e1069077f0db0a106e324c692375a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YDv5m-ES6K8qlULPUjhWoA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="ffb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们调用<code class="fe oo op oq of b">verifiy_credentials</code>方法，该方法返回包含我的个人资料数据的用户对象。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/dedd94e2cc4096ee9dc0f3d5cc11b72c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KY5hKPHTLqza0RJN2Cdxbg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="c256" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个对象是一个包含大量元数据的blob。我们可以将其中一些作为对象属性来访问，并将它们打印在屏幕上。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/3a2ad5c4238526ed5536fa3ef1ffafd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*tI7RiAGzWygu9pFmz0MMLQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="76b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个用户肯定是我。您可以在我的<a class="ae ky" href="https://twitter.com/ahmed_besbes_" rel="noopener ugc nofollow" target="_blank">档案</a>中清楚地看到这些数据。</p><h1 id="f171" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">搜索和提取推文</h1><p id="73ec" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Twitter API的第一个应用是能够基于多种类型的过滤器以编程方式搜索推文。</p><blockquote class="lv lw lx"><p id="29df" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><em class="it">例如，让我们搜索一些提到乌克兰🇺🇦.的推文</em></p></blockquote><p id="b1df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在设置了认证之后，我们将使用<code class="fe oo op oq of b">search_tweets</code>方法，遍历提取的tweets并打印它们的文本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="ee95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是运行代码片段后发生的情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/3f7b8ea3b851a2ce9bf6a77d4fb35b9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nAO7U13ehv7bcHVSoV-mMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="647c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">👉在这个例子中，我们没有指定任何过滤器，但是您可以通过设置一些参数来定制搜索，例如您想要的推文数量(<code class="fe oo op oq of b">count</code>)、语言(<code class="fe oo op oq of b">lang</code>)、位置(<code class="fe oo op oq of b">geocode</code>)、停止日期(<code class="fe oo op oq of b">until</code>)等。<br/>你可以在这里了解全部参数<a class="ae ky" href="https://docs.tweepy.org/en/stable/api.html#search-tweets" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c95f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">👉您还可以使用更高级的搜索查询，直接在其中嵌入一些过滤器。<br/>例如，如果您想要提取非转发的关于新冠肺炎的英语推文，您可以编写以下查询:<code class="fe oo op oq of b">covid-19 lang:en -is:retweet</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/7e18e0bc5d80e69c6b570e45e9b9c923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g40rhuwKK2YPbm64r_Q28A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="ef91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解更多关于Twitter搜索运营商的信息，请参考这个<a class="ae ky" href="https://developer.twitter.com/en/docs/twitter-api/v1/rules-and-filtering/search-operators" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><h1 id="507a" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">使用分页搜索大量的推文</h1><p id="80a8" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在前面的例子中，我们只提取了15条左右的tweets:这是因为Twitter有分页机制，我们只得到第一页的结果。</p><p id="f38c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了循环多个结果页面/tweet，我们需要使用包装了<code class="fe oo op oq of b">search_tweets</code>方法的光标<a class="ae ky" href="https://docs.tweepy.org/en/stable/v1_pagination.html" rel="noopener ugc nofollow" target="_blank">类</a>。</p><p id="2e7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Cursor类的每个实例都支持两种方法，这取决于您想要迭代的内容:</p><ul class=""><li id="364d" class="nh ni it lb b lc ld lf lg li nj lm nk lq nl lu nm nn no np bi translated"><code class="fe oo op oq of b">items</code>:要迭代的最大项数</li><li id="82de" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><code class="fe oo op oq of b">pages</code>:迭代的最大页数</li></ul><p id="deab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用<code class="fe oo op oq of b">items</code>方法提取250条推文。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="b308" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe oo op oq of b">items</code>方法时，我怀疑<code class="fe oo op oq of b">count</code>参数没有作用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/638cd7e698ae2ecc4da7c859b05981cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*d5CoIF0JzYiswFv1zYaHQA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="90ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，我们可以使用<code class="fe oo op oq of b">pages</code>方法获得相同数量的tweet:我们告诉Cursor对象迭代5个页面，并为每个页面提取50条tweet。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="281c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">⚠️如果您积极地使用搜索API，您可能会遇到429错误代码，这表明您已经达到了特定端点的速率限制。</p><p id="1161" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">👉例如，<code class="fe oo op oq of b">/search/tweets/</code>端点上的速率限制是每15分钟180次。这意味着，在这种限制下，您每15分钟最多可以获得180 * <code class="fe oo op oq of b">count</code>条推文(<code class="fe oo op oq of b">count</code>是您在<code class="fe oo op oq of b">search_tweets</code>方法中指定的参数)</p><p id="0ac5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里了解更多关于Twitter费率限制<a class="ae ky" href="https://developer.twitter.com/en/docs/twitter-api/v1/rate-limits" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><h1 id="1801" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">搜索特定账户的推文</h1><p id="0f9c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">假设你想分析埃隆·马斯克的推文:这相当简单。</p><p id="aac9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你所需要做的就是在你的查询前面加上<code class="fe oo op oq of b">from</code>关键字。<br/>如果你想收集关于特斯拉的推文，你可以这样写:</p><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="60b5" class="oj mk it of b gy ok ol l om on">tesla from:elonmusk lang:en -is:retweet</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/a7b24f7af2149d784a3c8eff258f21ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WK9YlubZUwhXdTx3sq63mg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><h1 id="c1d7" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">流式实时推文</h1><p id="c64d" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Twitter API的一个有趣的功能是能够传输实时推文的样本。这尤其有助于跟踪现场事件并收集相关数据。</p><p id="1de4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了能够使用API的流功能，您首先需要授予<strong class="lb iu">对您的Twitter应用程序</strong>的写访问权限，然后<strong class="lb iu">将它移动到一个项目中。</strong></p><p id="fa45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您需要重新生成凭证。</p><p id="4678" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了能够使用Tweepy获取流媒体tweets，您必须定义一个自定义类，它是<code class="fe oo op oq of b">StreamingClient</code>类的子类。</p><p id="74ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个类需要覆盖一个名为<code class="fe oo op oq of b">on_tweet</code>的方法，该方法在每次收到tweet时执行:为了简单起见，我们告诉这个方法打印tweet的id和文本。</p><p id="de08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了从这个类中实例化一个定制的流，我们需要将无记名令牌传递给构造函数。</p><p id="185b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们需要附加一些规则来定义我们想要搜索的内容(注意tweepy允许在一个列表中有多个规则，但是在这个例子中我们只设置一个)。</p><p id="db27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，调用<code class="fe oo op oq of b">filter</code>方法打开流，并对每个传入的tweet运行<code class="fe oo op oq of b">on_tweet</code>方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="b346" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的GIF说明了流打开后会发生什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/a3a2dbe4879465230f71db853e97c889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*meLhHR0eQFG8SOyGcqcBOg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者GIF</p></figure><p id="d952" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解更多关于Tweepy流的信息，请查看此<a class="ae ky" href="https://docs.tweepy.org/en/v4.9.0/streaming.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><h1 id="b1ce" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">参考</h1><ul class=""><li id="6d03" class="nh ni it lb b lc nb lf nc li pc lm pd lq pe lu nm nn no np bi translated"><a class="ae ky" href="https://developer.twitter.com/" rel="noopener ugc nofollow" target="_blank">https://developer.twitter.com/</a></li><li id="d26d" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><a class="ae ky" href="https://medium.com/towards-data-science/how-to-access-data-from-the-twitter-api-using-tweepy-python-e2d9e4d54978" rel="noopener">https://medium . com/forward-data-science/how-to-access-data-from-the-Twitter-API-using-tweepy-python-e 2d 9 E4 d 54978</a></li><li id="cc6a" class="nh ni it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated"><a class="ae ky" href="https://docs.tweepy.org/en/latest/getting_started.html" rel="noopener ugc nofollow" target="_blank">https://docs.tweepy.org/en/latest/getting_started.html</a></li></ul><h1 id="407f" class="mj mk it bd ml mm nv mo mp mq nw ms mt jz nx ka mv kc ny kd mx kf nz kg mz na bi translated">结论</h1><p id="362d" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">这篇文章简单介绍了tweepy和Twitter API。它让我们有机会从离线到流媒体模式以各种方式提取推文和元数据。</p><p id="0e07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是一名数据科学家，将tweepy添加到你的技能中肯定会给你带来竞争优势，并帮助你用外部数据丰富你的分析。</p><p id="4a53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我们只是触及了表面:显然还有更多要学的。如果你想更深入地挖掘，我鼓励你看看API文档，一如既往地实验，实验，实验。(3次不够说)。</p><p id="929a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天就这些了。直到下一次更多的编程技巧和教程。👋</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="d998" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">新到中？你可以每月订阅5美元，并解锁各种主题的无限文章(技术、设计、创业……)你可以通过点击我的推荐<a class="ae ky" href="https://ahmedbesbes.medium.com/membership" rel="noopener">链接</a>来支持我</h1><div class="pf pg gp gr ph pi"><a href="https://ahmedbesbes.medium.com/membership" rel="noopener follow" target="_blank"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd iu gy z fp pn fr fs po fu fw is bi translated">加入我的介绍链接媒体-艾哈迈德贝斯</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">ahmedbesbes.medium.com</p></div></div><div class="pr l"><div class="ps l pt pu pv pr pw ks pi"/></div></div></a></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/14bd7070eaa05ad12f243aa9d5199fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3ljur14OQ-6NH7gW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@charlesdeluvio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> charlesdeluvio </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div></div>    
</body>
</html>