<html>
<head>
<title>Solve Complex NLP Tasks with 5 Lesser-known Python Libraries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用5个鲜为人知的Python库解决复杂的NLP任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/solving-complex-nlp-tasks-with-5-simple-python-snippets-libraries-7d4dfab131e8#2022-05-11">https://towardsdatascience.com/solving-complex-nlp-tasks-with-5-simple-python-snippets-libraries-7d4dfab131e8#2022-05-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="71b4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一口大小的Python代码块</h2></div><p id="0ecc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">随着非结构化数据的增长，实现文本处理或NLP任务的解决方案变得越来越迫切。</p><p id="afad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我为您的下一个NLP项目编译了5个有用的Python食谱。我们还将查看定期出现的各种用例，以利用这些代码块。</p><p id="88fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个练习中，我们将使用图层<a class="ae le" href="https://app.layer.ai/layer/wikitext" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="lf"> WikiText数据集</em></strong></a>——一个包含从维基百科上的一组高质量文章中提取的超过1亿个令牌的公共数据。使用{ <strong class="kk iu"> <em class="lf">图层</em> </strong> }可以直接拉取该数据集。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="5e63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您还可以在这里找到更多带有<em class="lf"> WikiText数据</em> <a class="ae le" href="https://app.layer.ai/layer/wikitext/" rel="noopener ugc nofollow" target="_blank">的项目。</a></p><h2 id="0c1a" class="ln lo it bd lp lq lr dn ls lt lu dp lv kr lw lx ly kv lz ma mb kz mc md me mf bi translated">(1)使用{textstat}检查文本数据的度量</h2><p id="bf36" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><a class="ae le" href="https://pypi.org/project/textstat/" rel="noopener ugc nofollow" target="_blank"> Textstat </a>是一个易于使用的库，用于计算文本数据统计，如阅读时间和字数。它还为你文本分配一个可读性分数，以帮助确定它的复杂程度和等级。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/87b3b8342198e86cebc431539d95f1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7dfBKz8cmpouy6qnC1B4g.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated"><a class="ae le" href="https://pypi.org/project/textstat/" rel="noopener ugc nofollow" target="_blank"> Textstat等级级别</a></p></figure><p id="1bd6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">代码片段</em> </strong> <em class="lf"> : </em></p><pre class="lg lh li lj gt mw mx my mz aw na bi"><span id="fb00" class="ln lo it mx b gy nb nc l nd ne">## curText = doc_set[27310]<br/>curText = '''george washington johnson was born on may 27 , 1811 near georgetown in scott county , kentucky , the son of major william and betsy payne johnson . major johnson died soon after the close of the war of 1812 , in which he was a participant , and george johnson was reared in the home of his stepfather , john allen.'''</span></pre><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="47d8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">用户案例/应用</em> </strong>:</p><p id="2c13" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当给利益相关者写论文、博客或报告时，你会希望确保内容简明易懂。Textstat提供的度量可以帮助测量文本的属性。如果你对媒体上的文章进行了评估，你会发现短小、易读的文章比冗长的半学术性文章更受欢迎。</p><p id="dc40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"><em class="lf">* * *加入我们的YouTube社区🎦</em> </strong> <a class="ae le" href="https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="lf">【数据与Kat谈判】</em> </strong> </a> <strong class="kk iu"> <em class="lf">😄我帮你提升数据科学、分析和编码水平:</em> </strong></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nf lm l"/></div></figure><h2 id="16ab" class="ln lo it bd lp lq lr dn ls lt lu dp lv kr lw lx ly kv lz ma mb kz mc md me mf bi translated">(2)用{pyspellchecker}纠正拼写错误</h2><p id="bf46" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><a class="ae le" href="https://pyspellchecker.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Pyspellchecker </a>顾名思义，提供纯Python的拼写检查和纠正。它使用一种<a class="ae le" href="https://en.wikipedia.org/wiki/Levenshtein_distance" rel="noopener ugc nofollow" target="_blank"> Levenshtein距离</a>算法来查找和比较原始单词的排列，然后确定最有可能的正确结果。</p><p id="a89b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">代码片段</em> </strong>:标记出错别字<code class="fe ng nh ni mx b">commentyra </code>和<code class="fe ng nh ni mx b">gimimick</code></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nj"><img src="../Images/cba293c74707aeae9c846977d1e480b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zbkm9lM_vAc1vcKm0U5EUw.png"/></div></div></figure><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="1bc0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是发现并纠正了错别字的返回结果，</p><p id="49ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni mx b">{‘commentyra’: ‘commentary’, ‘gimimick’: ‘gimmick’}</code></p><p id="cd3c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，下面的一行程序使我们能够用正确的单词替换错别字:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nk"><img src="../Images/2c8e12b32599be9753c9035acd669c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kPlJOaCMOZQV3smZXQpDJQ.png"/></div></div></figure><p id="c924" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">用例/应用:</em> </strong></p><p id="ce38" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">直截了当，识别并纠正拼写错误！当NLP项目带有包含错别字的杂乱文本数据时，Python中的拼写检查器/校正器将是数据清理和数据预处理的有用工具。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nl"><img src="../Images/bd7a40258bd339b5478f69ae860dab37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ilpt-cehP3xdyakYOZDIPw.jpeg"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated"><a class="ae le" href="https://pixabay.com/photos/mistake-error-correction-wrong-968334/" rel="noopener ugc nofollow" target="_blank">图片来源:Pixabay </a></p></figure><h2 id="466e" class="ln lo it bd lp lq lr dn ls lt lu dp lv kr lw lx ly kv lz ma mb kz mc md me mf bi translated">(3)用{下一个单词预测}进行下一个单词预测</h2><p id="abe6" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated"><a class="ae le" href="https://pypi.org/project/next-word-prediction/" rel="noopener ugc nofollow" target="_blank">下一个单词预测</a>是一个生成式预训练转换器2，又名GPT-2，用于语言建模。这是一个方便的工具来实现一个心血来潮的下一个单词预测器。</p><p id="6920" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">代码片段</em> </strong>:</p><pre class="lg lh li lj gt mw mx my mz aw na bi"><span id="e1ae" class="ln lo it mx b gy nb nc l nd ne">curText = “falafel has become popular among vegetarians and vegans , as an alternative to meat @-@ laden street foods , and is now sold in packaged mixes in health @-@ food stores . falafel ‘s versatility has allowed for the reformulating of recipes for meatloaf , sloppy <br/>joes and spaghetti and meatballs into vegetarian [MASK]”</span></pre><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="4d51" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们根据之前的上下文预测了'<em class="lf">素食者</em>'之后的前5个下一个最有可能的单词，代码吐出了这5个单词/字符串:<code class="fe ng nh ni mx b">[‘dishes’, ‘and’, ‘,’, ‘-’, ‘recipes’]</code>。现在，与我们的维基文本数据中的原始文本相比，</p><pre class="lg lh li lj gt mw mx my mz aw na bi"><span id="321c" class="ln lo it mx b gy nb nc l nd ne">falafel has become popular among vegetarians and vegans , as an alternative to meat @-@ laden street foods , and is now sold in packaged mixes in health @-@ food stores .falafel ‘s versatility has allowed for the reformulating of recipes for meatloaf , sloppy joes and spaghetti and meatballs into vegetarian [dishes].</span></pre><p id="0274" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">单词“<code class="fe ng nh ni mx b"><strong class="kk iu"><em class="lf">dishes</em></strong></code>”被正确预测为最有可能出现的单词，这难道不令人惊讶吗！</p><p id="a71c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">用例/应用:</em> </strong></p><p id="eea0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一个单词预测是自然语言处理的基本任务之一。你可以每天在WhatsApp、电子邮件、Facebook Messenger或谷歌搜索等应用上使用它。这种自动完成功能为用户节省了时间，也可以被虚拟助手用来完成句子。</p><h2 id="2674" class="ln lo it bd lp lq lr dn ls lt lu dp lv kr lw lx ly kv lz ma mb kz mc md me mf bi translated">(4)创建有效的词云</h2><p id="5a19" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">Word Cloud是一个简单而强大的可视化工具，可以量化和突出显示您基于文本的见解。生成一个词云并不是一个困难的过程；现在，让我们使用来自<em class="lf"> WikiText </em> <code class="fe ng nh ni mx b">doc_set[8319:8334]</code>的文本列表来揭示这个非结构化子数据集的核心内容。</p><p id="3f30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">代码片段(Part1): </em> </strong> <em class="lf">文本清理和构建N元模型</em></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="5a83" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里，我们创建了一个短语长度为2-5个单词的N元模型。</p><p id="bf00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">代码片段(Part2): </em> </strong> <em class="lf">字云</em></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="b0c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ng nh ni mx b">“Super Big Power Crystal”, “Wumpa Fruit”, “Coco Bandicoot”</code>！你认为这些维基页面是关于什么的？任天堂的派对游戏<strong class="kk iu"><em class="lf">Crash Boom Bang</em></strong>！！</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nm"><img src="../Images/0d630cfbdac040bf45384a2e28b48154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BOykLgQaa7payqeIiacsHg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">作者可视化</p></figure><p id="70f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">用例/应用:</em> </strong></p><p id="e383" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">人脑更喜欢视觉表现，而不是其他任何形式。您可以将最重要的信息转换成文字云，帮助您的受众定量地理解非结构化数据，而不是向您的利益相关者展示长篇大论的文本。</p><h2 id="12a5" class="ln lo it bd lp lq lr dn ls lt lu dp lv kr lw lx ly kv lz ma mb kz mc md me mf bi translated">(5)语义相似度分析</h2><p id="8502" class="pw-post-body-paragraph ki kj it kk b kl mg ju kn ko mh jx kq kr mi kt ku kv mj kx ky kz mk lb lc ld im bi translated">与<a class="ae le" href="https://en.wikipedia.org/wiki/Lexicography" rel="noopener ugc nofollow" target="_blank">的字典编纂相似度</a>，<a class="ae le" href="https://en.wikipedia.org/wiki/Semantic_similarity" rel="noopener ugc nofollow" target="_blank">的语义相似度</a>基于它们的意思来衡量文档/句子/短语的相似度。最有效的方法是使用强大的转换器对<strong class="kk iu"> <em class="lf">的</em> </strong> <em class="lf">句子进行编码，得到它们的</em> <strong class="kk iu"> <em class="lf">嵌入</em> </strong> <em class="lf">，然后使用</em> <strong class="kk iu"> <em class="lf">余弦相似度</em> </strong> <em class="lf">计算它们的距离/相似度得分</em>。</p><p id="176b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了证明，我们有以下三个句子，</p><pre class="lg lh li lj gt mw mx my mz aw na bi"><span id="1ade" class="ln lo it mx b gy nb nc l nd ne">sentences = ['''in italy , plum cake is known by the english name , baked in an oven using dried fruit and often yoghurt''',<br/>             <br/> '''plum cake in the united states originated with the english settlers. this original fruitcake version of plum cake in the united states has been referred to as a reigning " standard american celebration cake through the time of the civil war''', <br/> <br/> '''the song received positive reviews , peaking at eighteen in the united states. the song 's accompanying music video was also received warmly''']</span></pre><p id="3b3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">代码片段</em> </strong>:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="ll lm l"/></div></figure><p id="bdc1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">计算两个嵌入之间的余弦距离给出了“相似性”分数，</p><pre class="lg lh li lj gt mw mx my mz aw na bi"><span id="535b" class="ln lo it mx b gy nb nc l nd ne">Similarity between Sent1 and Sent2 = 0.703 ## Both about plum cakes<br/>Similarity between Sent1 and Sent3 = 0.249<br/>Similarity between Sent2 and Sent3 = 0.462 ## moderate; mentioned US</span></pre><p id="7b0b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">用例/应用:</em> </strong></p><p id="60fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它广泛应用于信息检索和文本摘要，例如，从多个文档中提取前N个最相似的句子。相似性分数也可以用来减少维度和寻找相似的资源。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><p id="e77a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文到此为止。所有的代码都可以在<a class="ae le" href="https://colab.research.google.com/drive/131x3tLv1esXM8bDA02qco6XU6je09zDo#scrollTo=lDTNf8azLTXt" rel="noopener ugc nofollow" target="_blank">这个Colab笔记本</a>里找到。继续尝试这些，并在下面评论哪一个是你最喜欢的？✨</p><p id="f2aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lf">想要更多数据科学和编程技巧？使用</em> </strong> <a class="ae le" href="https://yilistats.medium.com/membership" rel="noopener"> <strong class="kk iu"> <em class="lf">我的链接</em> </strong> </a> <strong class="kk iu"> <em class="lf">注册Medium，获得我所有内容的全部访问权限。</em>T49】</strong></p><p id="d197" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">你可能会发现其他博客也很鼓舞人心，</strong></p><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/6-sql-tricks-every-data-scientist-should-know-f84be499aea5"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">每个数据科学家都应该知道的6个SQL技巧</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">提高分析效率的SQL技巧</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol mq nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/best-of-both-worlds-automated-and-dynamic-sql-queries-from-python-5b74a24501b0"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">两全其美:来自Python的自动化和动态SQL查询</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">通过SQL和Python集成将自动化带到新的高度</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="om l oi oj ok og ol mq nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/4-hidden-gems-for-idiomatic-pandas-code-99c706e6ce93"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">地道熊猫代码的4个隐藏的宝石</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">分享更多熊猫提示来提高你的数据处理水平</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="on l oi oj ok og ol mq nx"/></div></div></a></div></div></div>    
</body>
</html>