<html>
<head>
<title>Python f-strings Are More Powerful Than You Might Think</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python f-strings比您想象的更强大</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-f-strings-are-more-powerful-than-you-might-think-8271d3efbd7d#2022-04-04">https://towardsdatascience.com/python-f-strings-are-more-powerful-than-you-might-think-8271d3efbd7d#2022-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cd53" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解Python的f字符串(格式化的字符串文字)的未知特性，并提升您的文本格式化知识和技能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b3ce34e064c854042ca1e1acf04f1ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SevZ61QnLIxrvtYNZ4DenQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@amadorloureiro?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿玛多·洛雷罗</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7fda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">格式化字符串文字——也称为<em class="lv"> f字符串</em>——从Python 3.6开始就已经存在，所以我们都知道它们是什么以及如何使用它们。然而，有一些事实和f弦方便的特点，你可能不知道。所以，让我们来看看一些令人敬畏的f-string特性，你会想在你的日常编码中使用它们。</p><h1 id="8070" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">日期和时间格式</h1><p id="e18e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">用f字符串应用数字格式很常见，但是您知道您还可以格式化日期和时间戳字符串吗？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="e5b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">f字符串可以格式化日期和时间，就像你使用<code class="fe mv mw mx my b">datetime.strftime</code>方法一样。当你意识到有更多的格式，而不仅仅是文档中提到的几种格式时，这就更好了。Python的<code class="fe mv mw mx my b">strftime</code>也支持底层C实现所支持的所有格式，这可能因平台而异，这也是为什么在文档中没有提到它的原因。也就是说，你可以利用这些格式，例如使用<code class="fe mv mw mx my b">%F</code>，它相当于<code class="fe mv mw mx my b">%Y-%m-%d</code>或<code class="fe mv mw mx my b">%T</code>，它相当于<code class="fe mv mw mx my b">%H:%M:%S</code>，同样值得一提的是<code class="fe mv mw mx my b">%x</code>和<code class="fe mv mw mx my b">%X</code>，它们分别是本地首选的日期和时间格式。这些格式的使用显然不仅限于f字符串。有关格式的完整列表，请参考<a class="ae ky" href="https://manpages.debian.org/bullseye/manpages-dev/strftime.3.en.html" rel="noopener ugc nofollow" target="_blank"> Linux联机帮助页</a>。</p><h1 id="1c15" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">变量名和调试</h1><p id="05fc" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">f-string特性(从Python 3.8开始)最近增加的一项功能是打印变量名和值的能力:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f86c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该功能称为<em class="lv">“调试”</em>，可与其他修改器结合使用。它还保留了空格，所以<code class="fe mv mw mx my b">f"{x = }"</code>和<code class="fe mv mw mx my b">f"{x=}"</code>会产生不同的字符串。</p><h1 id="79c5" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">字符串表示</h1><p id="75e4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当打印类实例时，默认使用该类的<code class="fe mv mw mx my b">__str__</code>方法进行字符串表示。然而，如果我们想强制使用<code class="fe mv mw mx my b">__repr__</code>，我们可以使用<code class="fe mv mw mx my b">!r</code>转换标志:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="4a4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以只在f字符串中调用<code class="fe mv mw mx my b">repr(some_var)</code>，但是使用转换标志是一个很好的原生且简洁的解决方案。</p><h1 id="9f70" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">性能优越</h1><p id="4367" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">强大的功能和语法糖经常伴随着性能损失，然而，当涉及到f字符串时，情况并非如此:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="afda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的例子是用<code class="fe mv mw mx my b">timeit</code>模块测试的，比如:<code class="fe mv mw mx my b">python -m timeit -s 'x, y = "Hello", "World"' 'f"{x} {y}"'</code>，正如你所看到的，f字符串实际上是Python提供的所有格式化选项中最快的。因此，即使您更喜欢使用一些旧的格式选项，您也可以考虑切换到f字符串来提高性能。</p><h1 id="a33f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">格式化规范的全部功能</h1><p id="192c" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">f字符串支持Python的<a class="ae ky" href="https://docs.python.org/3/library/string.html#formatspec" rel="noopener ugc nofollow" target="_blank">格式规范迷你语言</a>，所以你可以在它们的修饰符中嵌入很多格式化操作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="ab57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python的格式化迷你语言不仅仅包括格式化数字和日期的选项。它允许我们对齐或居中文本，添加前导零/空格，设置千位分隔符等等。显然，所有这些不仅适用于f字符串，也适用于所有其他格式选项。</p><h1 id="e6b0" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">嵌套F字符串</h1><p id="a885" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果基本的f字符串不能满足您的格式需求，您甚至可以将它们嵌套在一起:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="dc25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以将f字符串嵌入到f字符串中，以解决棘手的格式问题，比如向右对齐的浮点数添加美元符号，如上所示。</p><p id="d780" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果需要在格式说明符部分使用变量，也可以使用嵌套的f字符串。这也可以使f弦更具可读性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="f724" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">条件格式</h1><p id="b5f8" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在上述嵌套f字符串示例的基础上，我们可以更进一步，在内部f字符串中使用三元条件运算符:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="b5e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这可能会很快变得非常不可读，所以你可能想把它分成多行。</p><h1 id="d4bf" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">λ表达式</h1><p id="4671" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">如果你想突破f字符串的限制，并让阅读你代码的人感到愤怒，那么——稍加努力——你也可以使用lambdas:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="c1d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，lambda表达式两边的括号是强制的，因为有了<code class="fe mv mw mx my b">:</code>，f-string就会解释它。</p><h1 id="f138" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结束语</h1><p id="1679" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">正如我们在这里看到的，f弦真的非常强大，比大多数人想象的要多得多。然而，这些<em class="lv">【未知】</em>特性中的大多数在Python文档中都有提及，所以我建议不要只是通读f字符串的文档页面，还要通读您可能正在使用的Python的任何其他模块/特性。钻研文档通常会帮助你发现一些非常有用的特性，这些特性是你在钻研<em class="lv"> StackOverflow </em>时不会发现的。</p><p id="0762" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">本文原帖</em><a class="ae ky" href="https://martinheinz.dev/blog/70?utm_source=medium&amp;utm_medium=referral&amp;utm_campaign=blog_post_70" rel="noopener ugc nofollow" target="_blank"><em class="lv">martinheinz . dev</em></a></p></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><p id="82e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/@martin.heinz/membership" rel="noopener">成为会员</a>阅读Medium上的每一个故事。<strong class="lb iu">你的会员费直接支持我和你看的其他作家。</strong>你还可以在媒体上看到所有的故事。</p><div class="ng nh gp gr ni nj"><a href="https://medium.com/@martin.heinz/membership" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">通过我的推荐链接加入Medium—Martin Heinz</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ks nj"/></div></div></a></div></div><div class="ab cl mz na hx nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="im in io ip iq"><p id="009d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能也喜欢…</p><div class="ng nh gp gr ni nj"><a rel="noopener follow" target="_blank" href="/ultimate-ci-pipeline-for-all-of-your-python-projects-27f9019ea71a"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">所有Python项目的终极CI管道</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">您对Python项目持续集成管道的所有期望—启动并运行…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">towardsdatascience.com</p></div></div><div class="ns l"><div class="ny l nu nv nw ns nx ks nj"/></div></div></a></div><div class="ng nh gp gr ni nj"><a rel="noopener follow" target="_blank" href="/optimizing-memory-usage-in-python-applications-f591fc914df5"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">优化Python应用程序中的内存使用</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">找出你的Python应用程序使用太多内存的原因，并通过这些简单的技巧和…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">towardsdatascience.com</p></div></div><div class="ns l"><div class="nz l nu nv nw ns nx ks nj"/></div></div></a></div></div></div>    
</body>
</html>