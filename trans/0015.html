<html>
<head>
<title>How to Clean Messy Pandas Column Names</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何清理乱七八糟的熊猫栏目名称</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-clean-messy-pandas-column-names-20dc7400cea7#2022-02-01">https://towardsdatascience.com/how-to-clean-messy-pandas-column-names-20dc7400cea7#2022-02-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cc46" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不需要正则表达式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/06ddb8e46f24a8d3896dcafbc90feff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YQMwF0l2ApwV132i"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@norevisions?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍摄的照片<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上没有修改</a></p></figure><h1 id="2d82" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">动机</h1><p id="961f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">真实世界的数据是混乱的。我们经常收到来自不同列命名格式的多个来源的数据，对它们进行标准化可能是一件麻烦的事情。尽管有这些麻烦，但在数据清理过程的早期将列名标准化为通用格式仍然很重要，以便更好地促进下游任务。正则表达式通常用于清理混乱的列名，但是编写正则表达式来处理各种混乱的情况可能会很乏味。这就是史基比出现的时候。</p><h1 id="3691" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">不足的</h1><p id="c5dd" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://aeturrell.github.io/skimpy/" rel="noopener ugc nofollow" target="_blank">skippy</a>通常用于提供熊猫数据框架中变量的汇总统计数据。然而这不是我们今天感兴趣的。Skimpy的一个较少使用的函数是<code class="fe mn mo mp mq b">clean_columms</code>便利函数，它有助于解决熊猫列名混乱的问题。</p><p id="1d7a" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">Skimpy为标准化列名提供了一些常见的格式。下表显示了不同案例样式的结果列名。这些大小写样式在使用的大小写和分隔符方面有所不同。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/8cdaa444a890999baf5d1c3b17cca349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yMAc3ChHB3O8cvJMZSLJyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b768" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">让我们看看如何使用skimpy来执行列名清理。</p><p id="50f1" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">安装Skimpy</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="ba0b" class="nb la it mq b gy nc nd l ne nf">pip install skimpy</span></pre><p id="89a2" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">导入库</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="0065" class="nb la it mq b gy nc nd l ne nf">import pandas as pd<br/>from skimpy import clean_columns</span></pre><p id="5d72" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">让我们创建一个玩具数据集来看看Skimpy是如何工作的。</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="34b5" class="nb la it mq b gy nc nd l ne nf">columns = ['_Customer__name',<br/>           'customer_génder',<br/>           'customer age',<br/>           'billingAddress',<br/>           'delivery** address  ',<br/>           'item(Description)',<br/>           'quantity/Volume',<br/>           'total.price']<br/>messy_df = pd.DataFrame(data = [], columns=columns, index=[0])</span></pre><p id="0494" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated">我们的玩具数据集具有混乱的列名的常见元素，包括重音符号、不同的分隔符、大小写和多个空格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/688dcb8ed4311377326fc84bd24fedd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6a0iOVQkdWBUfLL7"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="1083" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">蛇案</h1><p id="301b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">skimpy标准化的默认格式是<code class="fe mn mo mp mq b">snake</code> case样式。蛇形大小写样式用下划线替换空格和符号分隔符，并将所有字符转换为小写。</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="1994" class="nb la it mq b gy nc nd l ne nf">clean_df = clean_columns(messy_df)<br/>clean_df.columns.tolist()</span><span id="8ee5" class="nb la it mq b gy nh nd l ne nf">&gt;&gt;<br/>['customer_name',<br/> 'customer_gender',<br/> 'customer_age',<br/> 'billing_address',<br/> 'delivery_address',<br/> 'item_description',<br/> 'quantity_volume',<br/> 'total_price']</span></pre><h1 id="6424" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">烤肉串盒</h1><p id="6a2f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">kebab</code>大小写样式类似于snake大小写，除了它使用破折号分隔符而不是下划线。</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="352a" class="nb la it mq b gy nc nd l ne nf">clean_df = clean_columns(messy_df, case = 'kebab')<br/>clean_df.columns.tolist()</span><span id="10a3" class="nb la it mq b gy nh nd l ne nf">&gt;&gt; <br/>['customer-name',<br/> 'customer-gender',<br/> 'customer-age',<br/> 'billing-address',<br/> 'delivery-address',<br/> 'item-description',<br/> 'quantity-volume',<br/> 'total-price']</span></pre><h1 id="00b5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">骆驼箱</h1><p id="725c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">Camel</code>大小写样式开始使用大写字符作为分隔符，每个字符串的第一个字符是小写的。</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="6562" class="nb la it mq b gy nc nd l ne nf">clean_df = clean_columns(messy_df, case = 'camel')<br/>clean_df.columns.tolist()</span><span id="5258" class="nb la it mq b gy nh nd l ne nf">&gt;&gt;<br/>['customerName',<br/> 'customerGender',<br/> 'customerAge',<br/> 'billingAddress',<br/> 'deliveryAddress',<br/> 'itemDescription',<br/> 'quantityVolume',<br/> 'totalPrice']</span></pre><h1 id="5edb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">帕斯卡案例</h1><p id="908f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">Pascal</code>除了每个字符串的第一个字符是大写字母之外，大小写样式类似于camel case。</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="ca39" class="nb la it mq b gy nc nd l ne nf">clean_df = clean_columns(messy_df, case = 'pascal')<br/>clean_df.columns.tolist()</span><span id="435f" class="nb la it mq b gy nh nd l ne nf">&gt;&gt;<br/>['CustomerName',<br/> 'CustomerGender',<br/> 'CustomerAge',<br/> 'BillingAddress',<br/> 'DeliveryAddress',<br/> 'ItemDescription',<br/> 'QuantityVolume',<br/> 'TotalPrice']</span></pre><h1 id="fded" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">恒定情况</h1><p id="a6e4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">Constant</code>大小写样式使用下划线分隔符，并将所有字符改为大写。</p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="c2d0" class="nb la it mq b gy nc nd l ne nf">clean_df = clean_columns(messy_df, case = 'const')<br/>clean_df.columns.tolist()</span><span id="483a" class="nb la it mq b gy nh nd l ne nf">&gt;&gt;<br/>['CUSTOMER_NAME',<br/> 'CUSTOMER_GENDER',<br/> 'CUSTOMER_AGE',<br/> 'BILLING_ADDRESS',<br/> 'DELIVERY_ADDRESS',<br/> 'ITEM_DESCRIPTION',<br/> 'QUANTITY_VOLUME',<br/> 'TOTAL_PRICE']</span></pre><h1 id="6b01" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">替换字符串</h1><p id="5551" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><code class="fe mn mo mp mq b">clean_columns()</code>还提供替换字符串的选项。这对于纠正拼写错误的列名或将列重命名为标准格式非常有用。例如，我们可能希望将<code class="fe mn mo mp mq b">Address</code>缩短为<code class="fe mn mo mp mq b">Addr</code>，将<code class="fe mn mo mp mq b">Description</code>缩短为<code class="fe mn mo mp mq b">Desc</code></p><pre class="kj kk kl km gt mx mq my mz aw na bi"><span id="b21a" class="nb la it mq b gy nc nd l ne nf">clean_df = clean_columns(messy_df, case = 'pascal', replace = {'Address':'Addr', 'Description':'Desc'})<br/>clean_df.columns.tolist()</span><span id="92fe" class="nb la it mq b gy nh nd l ne nf">&gt;&gt;<br/>['CustomerName',<br/> 'CustomerGender',<br/> 'CustomerAge',<br/> 'BillingAddr',<br/> 'DeliveryAddr',<br/> 'ItemDesc',<br/> 'QuantityVolume',<br/> 'TotalPrice']</span></pre><h1 id="1ee9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="9005" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">处理混乱的列名是数据科学工作流的一部分，对于具有大量列和不同命名格式的数据集来说，这可能相当乏味。在本文中，我们研究了如何在不使用regex的情况下，使用skimpy将列名快速标准化为不同的常见大小写样式。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="6c8f" class="pw-post-body-paragraph lr ls it lt b lu mr ju lw lx ms jx lz ma mt mc md me mu mg mh mi mv mk ml mm im bi translated"><a class="ae ky" href="https://medium.com/@edwin.tan/membership" rel="noopener">加入Medium </a>阅读更多这样的故事。</p></div></div>    
</body>
</html>