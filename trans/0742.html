<html>
<head>
<title>Why We Will Never Open Deep Learning’s Black Box</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我们永远不会打开深度学习的黑匣子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-we-will-never-open-deep-learnings-black-box-4c27cd335118#2022-03-02">https://towardsdatascience.com/why-we-will-never-open-deep-learnings-black-box-4c27cd335118#2022-03-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/06b052e7566f8726946667d19df50b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2tw6EIx8Hn1Qvgv274r89w.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><div class=""/><div class=""><h2 id="2e3d" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">但是我们仍然可以把整件事炸掉</h2></div><p id="c902" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">尽管关于深度学习的黑盒有很多争论，但很少有人谈到为什么深度神经网络首先是黑盒。当我们说<em class="lq"> </em>是黑匣子的时候，又是什么意思呢？这真的是很难的数学吗，还是有什么东西使得它们本质上无法解释？有什么方法可以训练深度神经网络，让它不是黑盒？</p><h1 id="1841" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated"><strong class="ak">黑盒是什么？</strong></h1><p id="44ad" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">在最基本的层面上，“黑盒”只是意味着，对于深度神经网络来说，我们不知道所有单个神经元如何共同工作以达到最终输出。很多时候，甚至不清楚任何特定的神经元自己在做什么。</p><p id="2ea5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">深度神经网络中的每个神经元从其他神经元接收一组输入，将每个输入乘以它在训练期间学习的权重，然后计算输出(通过将它传递给非线性激活函数)。众所周知，这在数学上等同于在前一层神经元的空间中绘制线性决策边界(例如，2 维中的线或更高维中的超平面)。当考虑多个神经元如何一起工作时，黑箱就出现了。</p><p id="d07d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们看看这个非常简单的问题是什么样子的。我们有一个包含蓝色和红色样本的训练集。每个样本有两个输入值，<em class="lq"> x </em>和 y，我们可以在下面看到。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/6d88bec3f988a924b0ee71d9989e6f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gi2rsnr1SgOq7qs1-oF0rw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">训练样本，每个样本由两个值(x，y)组成，标记为蓝色或红色</p></figure><p id="def4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">然后，我们训练一个简单的神经网络，它可以准确预测所有这些训练样本的蓝色或红色(该网络有 2 个隐藏层，每个隐藏层有 4 个神经元)。我们可以通过根据网络的输出给背景着色来表示网络学到了什么。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/8147f0213e37f44afbfc9fa69778ba3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Fw-5vPeT3b2LPylrAoiFw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">经过训练的神经网络的预测在背景中是彩色的</p></figure><p id="3b59" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">它能合理地预测所有(<em class="lq"> x </em>，<em class="lq"> y </em>)对的标签，甚至在训练样本之外。现在我们来看看第一层的神经元在做什么。我们可以把他们的决策边界画成线。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/393c22092cc60d4db8e5ca7a6648782b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RU-weS8zV9670gcEONlx9g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">单个神经元无法解释</p></figure><p id="cf10" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">它们没有多大意义。观察这些神经元的决策边界，我们发现了几个谜团。这些行与训练样本有什么关系？这些线路与网络输出有什么关系？而它为什么要这样学呢？</p><p id="bbc8" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="lq">这个</em>就是我们所说的“黑匣子”。</p><p id="94a4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">黑盒的存在是由于中间神经元在做出网络最终决定的过程中做出了这些奇怪的决定。不仅仅是复杂的、高维的非线性数学；黑匣子本质上是由于非直觉的中间决策。</p><h1 id="491f" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated"><strong class="ak">为什么会有黑匣子？</strong></h1><p id="d28c" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">考虑每个神经元在训练过程中必须学习什么。较浅的神经元学习如何从输入中提取特征，并将它们映射到一些有用的潜在空间。更深层的神经元学习如何将训练样本从潜在空间映射到适当的输出。</p><p id="c2ee" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">然而，所有的神经元同时被训练。一开始，他们是随机开始的。较浅的神经元开始训练，以开发一个对较深的神经元当前正在做的事情有用的潜在空间。同时，更深层的神经元必须学会如何从这个最初糟糕的潜在空间映射到适当的输出。</p><p id="1a05" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">虽然每个神经元都在学习做自己的工作，但它会因其他神经元的不良表现而受到削弱。他们学会补偿其他神经元的缺陷，这发展成一个相互依赖的可悲的缠结网络。</p><p id="5e50" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">为了看到这一点，让我们看看上面例子中的四个第一层神经元。在训练结束时，我们可以通过计算损失函数相对于每个样本的神经元输入权重的梯度，来测量每个训练样本对每个神经元的决策边界的位置有多大影响。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/312424d40fc0858794d7e1db003af3bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gy7dPc4vcxBQKvBcea_Cpg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">四个第一层神经元中的每一个，每个训练样本的大小与其对神经元位置的影响程度成比例</p></figure><p id="00ec" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">最负责设计每个神经元的训练样本分布在输入空间中，并且不反映训练样本的明显结构。由于通过梯度下降学习的纠缠性质，每个神经元都做一点点事情，以处理它从前一层接收的混乱。结果是，不是每个神经元都有明确的功能来反映它试图学习的任务的结构，而是它的功能被涂掉了。这导致了黑箱，每个神经元形成看似无意义的决策边界。</p><p id="5cdf" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这些纠缠的潜在空间的另一个结果是无法远离原始训练样本进行外推。我们可以缩小这个红蓝问题，看看神经元决策边界的混乱如何在训练样本的领域之外产生意想不到的、不良的行为。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/8148f6f0c794c8d9e2f2a603b237a1c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKZsAvgPiGC0H4wREj3Rtg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">缩小显示无法解释的隐藏神经元是造成推断不佳的原因</p></figure><p id="e5ee" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">很明显，在遥远的外推法中，网络的行为渐近于基于神经元决定边界的几何形状。隐藏神经元的不可解释性是深度学习无法进行外推和概括的直接原因。在更高的维度上，这产生了奇怪的决策边界，导致了<a class="ae mu" href="https://www.nature.com/articles/d41586-019-03013-5" rel="noopener ugc nofollow" target="_blank">对抗性攻击</a>的现象。</p><h1 id="ebf6" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated"><strong class="ak">炸毁黑匣子</strong></h1><p id="b4d3" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">基于梯度的深度学习如果没有可解释性、泛化和对抗鲁棒性，永远无法实现真正的人工智能。我们不应该试图打开一个无法打开的黑匣子，而是需要将整个事情炸毁，并找到一种更类似于人类推理的深度学习的替代训练方法。即使是传统的基于梯度的深度学习的创始人之一 Geoffrey Hinton，<a class="ae mu" href="https://www.axios.com/artificial-intelligence-pioneer-says-we-need-to-start-over-1513305524-f619efbd-9db0-4947-a9b2-7a4c310a28fe.html" rel="noopener ugc nofollow" target="_blank">也说过同样的话</a>。</p><p id="7bdb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">麦卡洛克和皮茨最初提出的人工神经元实际上是为了模仿简单的人类逻辑[1]。当我们开始依赖梯度下降来训练神经网络以解决更大、更复杂的问题时，我们只是被困在了黑盒中。</p><p id="7860" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">可解释的深度学习会是什么样子？对于上面的红色对蓝色问题，似乎最直观的神经网络将使用具有如下所示决策边界的神经元。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mo"><img src="../Images/52a8c1464e66d46af58b04d8e4a232ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fyi0GtvnmewYI_78_-qfRQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">一个理想的神经网络的输出和第一层神经元的蓝色与红色的任务</p></figure><p id="6850" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">现在，神经元对于训练样本有意义，并且很容易看出它们如何与网络的最终输出相关。网络进行推断是因为神经元学习了可解释的和可概括的决策边界。但是梯度下降怎么学这个呢？</p><p id="0c4b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">它不能。</p><p id="6f20" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">如上所述，梯度下降训练迫使神经元补偿其他神经元的不足，在多个神经元之间涂抹简单的功能。它没有教导神经元在网络中具有专门的和/或模块化的子功能。</p><p id="006a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">因为神经元通过决策边界形成分离，理想情况下，它们会学习基于概念的结构来分离训练样本。这是最近提出的一种替代方法<a class="ae mu" href="https://rdcu.be/cyfGB" rel="noopener ugc nofollow" target="_blank">的基础，该方法用于训练模仿人类推理的可解释的深度神经网络</a>【2】。</p><p id="6902" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在这种称为本质神经网络(ENNs)的深度学习新范式中，每个神经元都承担一些专门的功能(即分离训练样本的两个子群或区分不同的学习特征)，同时仍然能够扩展到大型问题，如计算机视觉和复杂的逻辑推理问题。</p><p id="9b24" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">当我们抛弃梯度下降并使用更类似人类的方法来训练深度神经网络时，黑箱立即消失。通过赋予可解释性，我们使深度神经网络能够进行推断和概括，并且对敌对攻击更加鲁棒。这种新形式的神经符号人工智能正在带来许多新的能力，这些能力以前是传统的基于梯度的深度学习所不可能的。</p><p id="5669" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">黑盒不是神经网络的必要特征。随着我们超越反向传播和梯度下降，深度学习将回到它的起源，并再次模仿人类推理，而没有不必要的黑盒神秘主义。</p><p id="2c5c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">参考文献</strong></p><p id="d6f8" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">[1] W.S .麦卡洛克&amp; W .皮茨，“神经活动中固有观念的逻辑演算”。<em class="lq">数学生物物理学通报</em> <strong class="kw jg"> 5 </strong>，115–133(1943)。</p><p id="497d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">[2]布拉塞克和林明敏。“模拟推理的可解释神经网络”。<em class="lq">自然计算科学</em> <strong class="kw jg"> 1 </strong>，607–618(2021)。</p><p id="1d7b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">[3]布拉塞克。《亚里士多德如何修复深度学习的缺陷》。<em class="lq">渐变</em> (2022)。</p></div></div>    
</body>
</html>