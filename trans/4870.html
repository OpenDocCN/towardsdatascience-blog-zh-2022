<html>
<head>
<title>How to Visualize Neural Network Architectures in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python可视化神经网络架构</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-visualize-neural-network-architectures-in-python-567cd2aa6d62#2022-10-29">https://towardsdatascience.com/how-to-visualize-neural-network-architectures-in-python-567cd2aa6d62#2022-10-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="852c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Jupyter或Google Colab创建神经网络图示的快速指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/93c715dd8ffafeb144dfb48e838d2ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TF4ENXrhomx4vBF8G4FHwQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Image Credit —由作者使用visualkeras和Jupyter Notebook开发。</p></figure><h1 id="d0e1" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">1.介绍</h1><p id="4a03" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">通常，在使用人工神经网络或其他变体(如卷积神经网络或递归神经网络)时，我们希望可视化并创建编译模型的图形表示。这可以解决两个目的:</p><ol class=""><li id="a9e9" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated">而定义和训练多个模型允许我们可视化我们的模型的深度，并比较不同的层以及它们是如何顺序放置的。</li><li id="c294" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated">允许更好地理解模型结构、每层中使用的激活函数、每层的形状(神经元的数量)以及需要训练的参数</li></ol><p id="e244" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">python中有几个现成的包可以创建我们的神经网络模型的可视化表示。<strong class="ls iu">前三个包甚至可以在模型训练之前使用(模型只需要定义和编译)；然而，Tensor Boards要求用户在可视化架构之前，根据准确的数据训练模型。</strong></p><ol class=""><li id="5de0" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated"><a class="ae nf" href="https://github.com/RedaOps/ann-visualizer" rel="noopener ugc nofollow" target="_blank">安可视化器</a></li><li id="6956" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><a class="ae nf" href="https://github.com/paulgavrikov/visualkeras" rel="noopener ugc nofollow" target="_blank">视觉角膜</a></li><li id="e83d" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><a class="ae nf" href="https://keras.io/api/utils/model_plotting_utils/" rel="noopener ugc nofollow" target="_blank"> Keras模型图</a></li><li id="559c" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><a class="ae nf" href="https://www.tensorflow.org/tensorboard/graphs" rel="noopener ugc nofollow" target="_blank">张量板</a></li></ol><h1 id="a79b" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">2.安装快速指南</h1><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="8981" class="nl kz it nh b gy nm nn l no np">pip install visualkeras</span><span id="225d" class="nl kz it nh b gy nq nn l no np">pip install ann_visualizer</span><span id="53b7" class="nl kz it nh b gy nq nn l no np">pip install graphviz</span></pre><p id="8187" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">我们不需要单独安装“张量板”和“Keras模型图”。这将随Tensorflow &amp; Keras的初始安装一起提供。</p><h1 id="fb0b" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">3.设置Tensorflow包</h1><p id="77e7" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们可能只使用下面列出的几个库。<strong class="ls iu"> <em class="nr">大多数库可以将TensorFlow模型转换为图表，而无需对数据进行显式训练。你可以认为这是真理的单一来源。一些库，如Pandas、Skimage和OpenCV，在读取结构化数据或图像时会派上用场。</em></strong></p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="6cb0" class="nl kz it nh b gy nm nn l no np"># Import necessary libraries</span><span id="dbeb" class="nl kz it nh b gy nq nn l no np">import pandas as pd</span><span id="50eb" class="nl kz it nh b gy nq nn l no np">import numpy as np                               # Import numpy</span><span id="50ae" class="nl kz it nh b gy nq nn l no np">from skimage import data, io   # Import skimage library (data - Test images and example data.</span><span id="2745" class="nl kz it nh b gy nq nn l no np">#                          io - Reading, saving, and displaying images.)</span><span id="40fc" class="nl kz it nh b gy nq nn l no np">from skimage.color import rgb2gray</span><span id="1a43" class="nl kz it nh b gy nq nn l no np">import matplotlib.pyplot as plt                  # Import matplotlib.pyplot (Plotting framework in Python.)</span><span id="0d1c" class="nl kz it nh b gy nq nn l no np">%matplotlib inline</span><span id="050a" class="nl kz it nh b gy nq nn l no np">import os                                        # This module provides a portable way of using operating system dependent functionality.</span><span id="24b7" class="nl kz it nh b gy nq nn l no np">os.environ['TF_CPP_MIN_LOG_LEVEL'] = '3'</span><span id="5989" class="nl kz it nh b gy nq nn l no np">import warnings</span><span id="b9ba" class="nl kz it nh b gy nq nn l no np"># Suppress warnings</span><span id="30f2" class="nl kz it nh b gy nq nn l no np">warnings.filterwarnings('ignore')</span><span id="0c84" class="nl kz it nh b gy nq nn l no np">from IPython.display import display</span><span id="2286" class="nl kz it nh b gy nq nn l no np">import cv2 as cv<br/>from sklearn.metrics import confusion_matrix</span><span id="ae51" class="nl kz it nh b gy nq nn l no np">from sklearn.model_selection import train_test_split</span><span id="c8c3" class="nl kz it nh b gy nq nn l no np">from tensorflow.keras import utils</span><span id="4396" class="nl kz it nh b gy nq nn l no np">from tensorflow.keras.models import Sequential,load_model</span><span id="0f5b" class="nl kz it nh b gy nq nn l no np">from tensorflow.keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D, BatchNormalization</span><span id="b351" class="nl kz it nh b gy nq nn l no np">from tensorflow.keras.optimizers import Adam</span><span id="eea7" class="nl kz it nh b gy nq nn l no np">import tensorflow as tf</span><span id="9f85" class="nl kz it nh b gy nq nn l no np">import seaborn as sns</span></pre><p id="b1fe" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">一些有助于从头开始探索ANNs &amp; CNNs更多内容的链接。</p><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/convolution-neural-network-for-image-processing-using-keras-dc3429056306"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">用于图像处理的卷积神经网络——使用Keras</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">Python中使用CNN的综合指南</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-artificial-neural-network-using-tensor-flow-keras-41ccd575a876"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">使用张量流和Keras的人工神经网络初学者指南</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">使用人工神经网络构建欺诈检测模型&amp;使用RandomizedSearchCV微调超参数</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">towardsdatascience.com</p></div></div><div class="oe l"><div class="ok l og oh oi oe oj ks nv"/></div></div></a></div><h1 id="4465" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">4.建立卷积神经网络模型</h1><p id="51c2" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们将用不同的超参数定义三个不同的CNN模型。理想情况下，在现实世界中，考虑到我们正在为多类别分类任务构建模型，我们的目标是实现不同的架构，以最大化准确性或任何相关指标。我们对问题类型的选择不会对如何使用可视化包产生任何影响。</p><p id="14ff" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">我们创建了用户定义的函数，用不同数量的CNN层、最大池和密集层分别构建三个不同的模型。</p><h2 id="f069" class="nl kz it bd la ol om dn le on oo dp li lz op oq lk md or os lm mh ot ou lo ov bi translated">4.1 -架构1 -浅层CNN层+ ANN层</h2><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="9c3d" class="nl kz it nh b gy nm nn l no np">def construct_model():</span><span id="4894" class="nl kz it nh b gy nq nn l no np">model = Sequential()</span><span id="37e7" class="nl kz it nh b gy nq nn l no np">model.add(Conv2D(filters=64, kernel_size=(3, 3), input_shape=(128, 128, 1), activation=’relu’))</span><span id="7b91" class="nl kz it nh b gy nq nn l no np">model.add(Conv2D(filters=64, kernel_size=(3, 3), activation=’relu’))</span><span id="ec7e" class="nl kz it nh b gy nq nn l no np">model.add(MaxPool2D((2, 2)))</span><span id="e03b" class="nl kz it nh b gy nq nn l no np">model.add(Flatten())</span><span id="aacd" class="nl kz it nh b gy nq nn l no np">model.add(Dense(256, activation=’relu’))</span><span id="f80d" class="nl kz it nh b gy nq nn l no np">model.add(Dense(12, activation=’softmax’))</span><span id="b247" class="nl kz it nh b gy nq nn l no np">model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</span><span id="8ce8" class="nl kz it nh b gy nq nn l no np">return model</span></pre><h2 id="e112" class="nl kz it bd la ol om dn le on oo dp li lz op oq lk md or os lm mh ot ou lo ov bi translated">4.2 —架构2 —深层CNN +浅层ANN层</h2><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="c5e3" class="nl kz it nh b gy nm nn l no np">def sconstruct_model():</span><span id="a5e2" class="nl kz it nh b gy nq nn l no np">smodel = Sequential()</span><span id="64f5" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=64, kernel_size=(3, 3), input_shape=(128, 128, 3), activation=’relu’))</span><span id="d0a6" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=64, kernel_size=(3, 3), activation=’relu’))</span><span id="488a" class="nl kz it nh b gy nq nn l no np">smodel.add(MaxPool2D((2, 2)))</span><span id="6609" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=128, kernel_size=(3, 3), activation=’relu’))</span><span id="3e0d" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=128, kernel_size=(3, 3), activation=’relu’))</span><span id="b42f" class="nl kz it nh b gy nq nn l no np">smodel.add(MaxPool2D((2, 2)))</span><span id="2c79" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=128, kernel_size=(3, 3), activation=’relu’))</span><span id="2779" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=128, kernel_size=(3, 3), activation=’relu’))</span><span id="aadd" class="nl kz it nh b gy nq nn l no np">smodel.add(MaxPool2D((2, 2)))</span><span id="3bfd" class="nl kz it nh b gy nq nn l no np">smodel.add(Flatten())</span><span id="725f" class="nl kz it nh b gy nq nn l no np">smodel.add(Dense(256, activation=’relu’))</span><span id="cf9e" class="nl kz it nh b gy nq nn l no np">smodel.add(Dense(12, activation=’softmax’))</span><span id="e5b0" class="nl kz it nh b gy nq nn l no np">#optimizer = Adam(lr=0.001)</span><span id="7edd" class="nl kz it nh b gy nq nn l no np">smodel.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</span><span id="3345" class="nl kz it nh b gy nq nn l no np">#model.summary()</span><span id="c564" class="nl kz it nh b gy nq nn l no np">return smodel</span></pre><h2 id="0c75" class="nl kz it bd la ol om dn le on oo dp li lz op oq lk md or os lm mh ot ou lo ov bi translated">4.3 —架构3 —深层CNN和ANN层</h2><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2651" class="nl kz it nh b gy nm nn l no np">def cconstruct_model(learningRate):</span><span id="f5d0" class="nl kz it nh b gy nq nn l no np">smodel = Sequential()</span><span id="7fd7" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=32, kernel_size=(3, 3), input_shape=(128, 128, 1), activation=’relu’))</span><span id="87c5" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=32, kernel_size=(3, 3), activation=’relu’))</span><span id="3b57" class="nl kz it nh b gy nq nn l no np">smodel.add(MaxPool2D((2, 2)))</span><span id="fa8e" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=64, kernel_size=(3, 3), activation=’relu’))</span><span id="5acb" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=64, kernel_size=(3, 3), activation=’relu’))</span><span id="cb32" class="nl kz it nh b gy nq nn l no np">smodel.add(MaxPool2D((2, 2)))</span><span id="9c2d" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=128, kernel_size=(3, 3), activation=’relu’))</span><span id="14f1" class="nl kz it nh b gy nq nn l no np">smodel.add(Conv2D(filters=128, kernel_size=(3, 3), activation=’relu’))</span><span id="11d3" class="nl kz it nh b gy nq nn l no np">smodel.add(MaxPool2D((2, 2)))</span><span id="fd61" class="nl kz it nh b gy nq nn l no np">smodel.add(Flatten())</span><span id="1020" class="nl kz it nh b gy nq nn l no np">smodel.add(Dense(256, activation=’relu’))</span><span id="de43" class="nl kz it nh b gy nq nn l no np">smodel.add(Dense(256, activation=’relu’))</span><span id="9dda" class="nl kz it nh b gy nq nn l no np">smodel.add(Dense(12, activation=’softmax’))</span><span id="7932" class="nl kz it nh b gy nq nn l no np">optimizer = Adam(lr=learningRate)</span><span id="96c5" class="nl kz it nh b gy nq nn l no np">smodel.compile(loss=’categorical_crossentropy’, optimizer=optimizer, metrics=[‘accuracy’])</span><span id="1706" class="nl kz it nh b gy nq nn l no np">smodel.summary()</span><span id="be28" class="nl kz it nh b gy nq nn l no np">return smodel</span><span id="2da1" class="nl kz it nh b gy nq nn l no np">model=cconstruct_model(0.001)</span></pre><h1 id="c54f" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">5.使用人工神经网络可视化工具进行可视化</h1><p id="72f1" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">一个名为ANN Visualizer的Python模块使得用几行代码可视化人工神经网络成为可能(Gheorghiu，2022)。它使用Keras和Python的Graphviz模块来生成一个整洁而有吸引力的神经网络图。你可以灵活地可视化整个深度学习网络，或者只是你在深度学习进展的驱动下创建的卷积神经网络(Shah，2018)。</p><p id="a0b6" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">使用下面的结构生成神经网络的pdf表示。但是，在此之前，我们需要对上述模型进行编译。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="900e" class="nl kz it nh b gy nm nn l no np">model=construct_model()</span></pre><p id="2e91" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><strong class="ls iu"> ann_viz(model，view=True，filename="network.gv "，title="MyNeural Network") </strong></p><ul class=""><li id="fed8" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml ow mu mv mw bi translated"><strong class="ls iu"> <em class="nr">模型— </em> </strong>时序模型来自Keras</li><li id="064f" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml ow mu mv mw bi translated"><strong class="ls iu"> <em class="nr">视图— </em> </strong>调用ann_viz()后，可视化图形</li><li id="304f" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml ow mu mv mw bi translated"><strong class="ls iu"> <em class="nr">文件名— </em> </strong>文件的名称</li><li id="808f" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml ow mu mv mw bi translated"><strong class="ls iu"> <em class="nr">标题— </em> </strong>表示图形的任何特定标题</li></ul><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="767b" class="nl kz it nh b gy nm nn l no np">from ann_visualizer.visualize import ann_viz</span><span id="7ee2" class="nl kz it nh b gy nq nn l no np">ann_viz(model, view=True, filename=”cconstruct_model”, title=”CNN — Model 1 — Simple Architecture”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/94d4fe4f011eafcd5a8f99dead9de8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SR3VXl0GXji2Wh6RmnI9nQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:使用ANN Visualizer创建的construct_model()的快照。作者使用Jupyter笔记本开发的图片。原始输出太大，不适合作为图像放在这里，因此这里使用了底层的快照。</p></figure><h1 id="bd81" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">6.使用Visual Keras的可视化</h1><p id="32db" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">一个名为Visualkeras的Python工具可以更容易地查看keras神经网络设计(单独或作为TensorFlow的一部分)。大多数造型需求都可以轻松满足。卷积神经网络(CNN)从开发分层式架构中受益匪浅。大多数模型，包括简单的前馈网络，都从该模块支持的图形风格架构的生成中受益匪浅(Gavrikov，2022)。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="b95d" class="nl kz it nh b gy nm nn l no np">model1=construct_model()</span><span id="c0a7" class="nl kz it nh b gy nq nn l no np">model2=sconstruct_model()</span><span id="1297" class="nl kz it nh b gy nq nn l no np">model3=cconstruct_model(0.009)</span><span id="b80f" class="nl kz it nh b gy nq nn l no np">import visualkeras</span><span id="d08e" class="nl kz it nh b gy nq nn l no np">from PIL import ImageFont</span><span id="7598" class="nl kz it nh b gy nq nn l no np">visualkeras.layered_view(model1, legend=True)</span><span id="2284" class="nl kz it nh b gy nq nn l no np">visualkeras.layered_view(model2, legend=True)</span><span id="bea5" class="nl kz it nh b gy nq nn l no np">visualkeras.layered_view(model3, legend=True)</span></pre><div class="kj kk kl km gt ab cb"><figure class="oy kn oz pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/0335a7cdedbf2e4a68186e6721acd478.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*CLkQ4u-VthfNQGjo0BHNRg.png"/></div></figure><figure class="oy kn pe pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/310762318b8fa8956cc8de75c86b9039.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*YlTLgbme6pWvGmTOxuPsIw.png"/></div></figure><figure class="oy kn pf pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/44aedb1a1485f4298b93eca070b506b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*TF4ENXrhomx4vBF8G4FHwQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk pg di ph pi translated">图二。展示了三种不同模型架构的图示。作者使用Jupyter笔记本开发的图片。</p></figure></div><h1 id="04aa" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">7.Keras模型图</h1><p id="e4c4" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated"><a class="ae nf" href="https://keras.io/api/utils/model_plotting_utils/" rel="noopener ugc nofollow" target="_blank"> keras.utils.plot_model </a>提供了内置函数来绘制通过keras使用Graphviz和pydot包定义和编译的模型。从图形上看，它不如上面使用的包直观，但它概述了顺序模型的基本架构。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="e7c4" class="nl kz it nh b gy nm nn l no np">tf.keras.utils.plot_model(</span><span id="4e23" class="nl kz it nh b gy nq nn l no np">model1,</span><span id="b7aa" class="nl kz it nh b gy nq nn l no np">to_file="model.png",</span><span id="2281" class="nl kz it nh b gy nq nn l no np">show_shapes=True,</span><span id="afcc" class="nl kz it nh b gy nq nn l no np">show_dtype=False,</span><span id="bcb5" class="nl kz it nh b gy nq nn l no np">show_layer_names=True,</span><span id="b855" class="nl kz it nh b gy nq nn l no np">rankdir="TB",</span><span id="2c5d" class="nl kz it nh b gy nq nn l no np">expand_nested=True,</span><span id="caab" class="nl kz it nh b gy nq nn l no np">dpi=96,</span><span id="86aa" class="nl kz it nh b gy nq nn l no np">layer_range=None,</span><span id="1274" class="nl kz it nh b gy nq nn l no np">show_layer_activations=True,</span><span id="7236" class="nl kz it nh b gy nq nn l no np">)</span></pre><p id="93d7" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">需要考虑的几个超参数:</p><ol class=""><li id="4b87" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated"><strong class="ls iu"> <em class="nr">模型:</em></strong>Keras编译的模型或模型对象的实例</li><li id="d434" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><strong class="ls iu"> <em class="nr"> to_file: </em> </strong>图像的文件名</li><li id="beb8" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><strong class="ls iu"> <em class="nr"> show_shapes: </em> </strong>显示神经网络中各层的尺寸和形状</li><li id="f886" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><strong class="ls iu"> <em class="nr">显示_层_激活:</em> </strong>显示神经元内使用的激活功能</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/6d4a3e134af7255c09cc342c5a95baa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*HqcKRy1mqbylPGdAZgPDiw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3。阐释了tf.keras.utils.plot_model()的输出。作者使用Jupyter笔记本开发的图片。</p></figure><h1 id="8003" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated"><strong class="ak"> 8。张量板</strong></h1><p id="7019" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">TensorBoard是一个仪表板界面，允许用户可视化不同模型运行的日志。日志的范围可以从跟踪不同时期的任何模型验证度量，如准确性、召回率、RMSE、MAPE和MSE，到创建模型架构的概念图。它是一个强大的工具，可以可视化预期的模型是否与预期的设计相匹配，同时推动对如何使用操作级图来更改模型的深入了解。</p><p id="f38c" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">为了利用这个功能，我们需要首先加载TensorBoard，然后创建一个日志目录。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="beca" class="nl kz it nh b gy nm nn l no np">%load_ext tensorboard</span><span id="982b" class="nl kz it nh b gy nq nn l no np">from datetime import datetime</span><span id="1fcd" class="nl kz it nh b gy nq nn l no np">from tensorflow import keras</span><span id="62d7" class="nl kz it nh b gy nq nn l no np"># Define the Keras TensorBoard callback.</span><span id="3030" class="nl kz it nh b gy nq nn l no np">logdir="logs/fit/" + datetime.now().strftime("%Y%m%d-%H%M%S")</span><span id="9507" class="nl kz it nh b gy nq nn l no np">tensorboard_callback = keras.callbacks.TensorBoard(log_dir=logdir)</span></pre><p id="b321" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">在训练之前，创建Keras TensorBoard回调并指定日志目录。通过向model.fit()提供此回调，可以确保为TensorBoard可视化记录图形数据。一旦你调用TensorBoard，它可能需要几分钟来加载。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2b59" class="nl kz it nh b gy nm nn l no np">model.fit(</span><span id="f982" class="nl kz it nh b gy nq nn l no np">X2_train, Y2_train,</span><span id="898d" class="nl kz it nh b gy nq nn l no np">batch_size=64,</span><span id="4a9e" class="nl kz it nh b gy nq nn l no np">epochs=5,</span><span id="6938" class="nl kz it nh b gy nq nn l no np">callbacks=[tensorboard_callback])</span></pre><p id="0bcc" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><strong class="ls iu">注:X2_train和Y2_train是未反映在上述代码中的训练数据集。您可以用自己的任何训练数据来替换它。</strong></p><p id="dcfc" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">TensorBoard默认总是显示op级图形。(“默认”标签在左侧突出显示。)该图与代码相比是颠倒的，因为数据是从下往上流动的。但正如你所见，该图大致类似于Keras模型的描述，带有通向其他计算节点的附加边(Tensorflow，2022)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/f171a5dcd97b2153f55a217ec351f09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utskxVSwPYEMKjIkVyVWvg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4。显示了TensorBoard的输出。作者使用Jupyter笔记本开发的图片。</p></figure><p id="67c8" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">更多关于如何使用TensorBoard的内容可以在参考中找到。</p><h1 id="de7a" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">9.结论</h1><p id="0b03" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">从商业角度来看，用户必须向一组利益相关者展示他们的分析，这些图表增加了讨论的复杂性。它们可能不是极端增值。然而，从学术和学习的角度来看，利用这些包来展示这些深度学习架构是有价值的。对我来说，ANN visualizer比其他产品都突出，因为它很容易理解图表，而TensorBoard的图形输出需要更多的技术细节才能得到结果。</p><h1 id="ca8f" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">10.参考</h1><p id="a5db" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Gavrikov，P. (2022，4月13日)。<em class="nr">针对Keras / TensorFlow的visualkeras】。GitHub。https://github.com/paulgavrikov/visualkeras<a class="ae nf" href="https://github.com/paulgavrikov/visualkeras" rel="noopener ugc nofollow" target="_blank"/></em></p><p id="c1bb" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">t . gheorghiu(2022年10月21日)。<em class="nr">安可视化器</em>。GitHub。<a class="ae nf" href="https://github.com/RedaOps/ann-visualizer" rel="noopener ugc nofollow" target="_blank">https://github.com/RedaOps/ann-visualizer</a></p><p id="6028" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">沙阿，A. (2018年4月28日)。<em class="nr">只用一行代码可视化人工神经网络</em>。中等。<a class="ae nf" rel="noopener" target="_blank" href="/visualizing-artificial-neural-networks-anns-with-just-one-line-of-code-b4233607209e">https://towards data science . com/visualizing-artificial-neural-networks-ann-with-just-one-line-of-code-b 4233607209 e</a></p><p id="e28c" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">堆栈溢出。(未注明)。<em class="nr">机器学习——如何可视化神经网络架构？</em>数据科学栈交换。检索于2022年10月29日，来自<a class="ae nf" href="https://datascience.stackexchange.com/questions/12851/how-do-you-visualize-neural-network-architectures" rel="noopener ugc nofollow" target="_blank">https://data science . stack exchange . com/questions/12851/how-do-you-visualize-neural-network-architectures</a></p><p id="7cdf" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">小组，k .(未注明)。<em class="nr"> Keras文档:模型绘图实用程序</em>。keras . io . 2022年10月29日检索，来自<a class="ae nf" href="https://keras.io/api/utils/model_plotting_utils/#modeltodot-function" rel="noopener ugc nofollow" target="_blank">https://keras . io/API/utils/model _ plotting _ utils/# modeltodot-function</a></p><p id="7b39" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">张量流。(2022年1月6日)。<em class="nr">检查张量流图|张量板</em>。张量流。<a class="ae nf" href="https://www.tensorflow.org/tensorboard/graphs" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/tensorboard/graphs</a></p></div><div class="ab cl pl pm hx pn" role="separator"><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq pr"/><span class="po bw bk pp pq"/></div><div class="im in io ip iq"><p id="a50f" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><em class="nr">关于作者:高级分析专家和管理顾问，帮助公司通过对组织数据的商业、技术和数学的组合找到各种问题的解决方案。一个数据科学爱好者，在这里分享、学习、贡献；你可以和我在</em> <a class="ae nf" href="https://www.linkedin.com/in/angel-das-9532bb12a/" rel="noopener ugc nofollow" target="_blank"> <em class="nr">上联系</em> </a> <em class="nr">和</em> <a class="ae nf" href="https://twitter.com/dasangel07_andy" rel="noopener ugc nofollow" target="_blank"> <em class="nr">上推特</em></a><em class="nr">；</em></p></div></div>    
</body>
</html>