<html>
<head>
<title>7 Python One-Liners that will Blow Your Mind</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">会让你大吃一惊的7个Python单句程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/7-python-one-liners-that-will-blow-your-mind-479d5b2ab93a#2022-07-20">https://towardsdatascience.com/7-python-one-liners-that-will-blow-your-mind-479d5b2ab93a#2022-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9aec" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">少即是多？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/40aefddf41e6fd39f0fe50b641589456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HbkvisySyqYvQ66H"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@photos_by_lanty" rel="noopener ugc nofollow" target="_blank">摄影</a>Lanty摄影<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="8593" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">一句话这个术语来自喜剧，其中一个笑话用一句台词来表达。一个好的一行程序据说是有意义的和简洁的。这个概念也存在于编程中。Python一行程序是可以执行强大操作的简短程序。这在Java等其他语言中几乎是不可能的，所以它被认为是Pythonic的一个特性。</p><h2 id="7abc" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated"><strong class="ak">关于Python一行程序的争论</strong></h2><p id="0aef" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">如果您是第一次看到一行程序，请记住Python一行程序是一把双刃剑。一方面，它让代码<em class="nc">看起来很酷</em>，这绝对是给你的同事或面试官留下深刻印象的一种方式。但另一方面，花哨的俏皮话可能会令人困惑，难以理解，并变成炫耀技能的一种方式。因此，在代码审查期间，一定会有一些争论。根据经验，一行程序在Python中非常受欢迎，但如果它走得太远，开始让人困惑，那么就该放弃它了。最终，您的代码需要具有可读性和可维护性。</p><p id="93fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">无论如何，在本文中，我想给你一些可以提高代码质量的Python一行程序的实际例子。我还将向您展示一些有趣的俏皮话。无论如何，你必须知道用代码表达你的想法的所有可能的方式，这样你才能做出正确的决定。</p><h2 id="409a" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">交换两个变量</h2><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="d647" class="me mf it ne b gy ni nj l nk nl"># normal<br/>c = a<br/>a = b<br/>b = c</span><span id="a69c" class="me mf it ne b gy nm nj l nk nl"># 1-liner<br/>a,b = b,a</span></pre><p id="691b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在正常情况下，当你交换两个变量时，你需要一个中间人。我在我的<a class="ae ky" rel="noopener" target="_blank" href="/how-to-write-pythonic-code-208ec1513c49">如何编写Pythonic代码文章</a>中也提到了这个窍门。在Python中，一行就可以完成。右边是一个表达式，实际上是一个元组(b，a ),左边是表示元组中第一个和第二个变量的变量。</p><h2 id="abca" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">列表理解</h2><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="2c65" class="me mf it ne b gy ni nj l nk nl">result = []<br/>for i in range(10):<br/>    result.append(i**2)</span><span id="b51f" class="me mf it ne b gy nm nj l nk nl"># use list comprehension<br/>result = [i**2 for i in range(10)]</span></pre><p id="2e32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我在上一篇文章中提到的另一个Pythonic特性。它告诉Python如何处理列表中的每个元素。该列表包含<code class="fe nn no np ne b">for</code>和<code class="fe nn no np ne b">if</code>语句。例如:</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="8b33" class="me mf it ne b gy ni nj l nk nl">#list comprehension with if<br/>result = [i**2 for i in range(10) if i%2==0]</span><span id="9bef" class="me mf it ne b gy nm nj l nk nl">#read file in one-line<br/>[line.strip() for line in open(filename)]</span></pre><p id="f2a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列表/集合理解是一个如此强大的工具，每个人都必须知道它。它允许您编写优雅的代码，几乎和普通英语一样易读。每个列表理解包括3个要素:1)表达。任何有效的表达式，如<code class="fe nn no np ne b">i**2</code>或<code class="fe nn no np ne b">line.strip()</code>。2)成员。iterable中的对象。3)可迭代。列表、集合、生成器或任何其他可迭代对象。</p><h2 id="89ea" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">λ和映射函数</h2><p id="ce7f" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">列表理解的下一个层次是lambda函数。查看<a class="ae ky" rel="noopener" target="_blank" href="/learn-python-lambda-from-scratch-f4a9c07e4b34">从头开始学习Python Lambda</a>。</p><blockquote class="nq nr ns"><p id="1e4f" class="kz la nc lb b lc ld ju le lf lg jx lh nt lj lk ll nu ln lo lp nv lr ls lt lu im bi translated">与其他语言中添加功能的lambda形式不同，如果你懒得定义函数，Python lambdas只是一种速记符号。</p></blockquote><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="c2ae" class="me mf it ne b gy ni nj l nk nl"># traditional function with def<br/>def sum(a, b):    <br/>  return a + b</span><span id="045a" class="me mf it ne b gy nm nj l nk nl"># lambda function with name<br/>sum_lambda = lambda x, y: x + y</span></pre><p id="9033" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Lambda函数通常与Python高阶函数结合使用。有几个内置的高阶函数，如<code class="fe nn no np ne b">map</code>、<code class="fe nn no np ne b">filter</code>、<code class="fe nn no np ne b">reduce</code>、<code class="fe nn no np ne b">sorted</code>、<code class="fe nn no np ne b">sum</code>、<code class="fe nn no np ne b">any</code>、<code class="fe nn no np ne b">all</code>。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="c42d" class="me mf it ne b gy ni nj l nk nl">map(lambda x:x**2, [i for i in range(3)]) <br/># &lt;map object at 0x105558a90&gt;</span><span id="9b8d" class="me mf it ne b gy nm nj l nk nl">filter(lambda x: x % 2 == 0, [1, 2, 3])<br/># &lt;filter object at 0x1056093d0&gt;</span><span id="db6d" class="me mf it ne b gy nm nj l nk nl">from functools import reduce<br/>reduce(lambda x, y: x + y, [1, 2, 3])<br/># 6</span></pre><p id="1629" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得注意的是，<code class="fe nn no np ne b">map</code>和<code class="fe nn no np ne b">filter</code>的返回是对象，不是函数的结果。如果想得到实际的结果，需要转换成类似<code class="fe nn no np ne b">list(map(lambda x:x**2, [i for i in range(3)])</code>的列表。</p><h2 id="9d64" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">打印时不换行</h2><p id="c781" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated"><code class="fe nn no np ne b">print</code>是每种编程语言中最基本的语句之一。但是你看过Python doc中<code class="fe nn no np ne b">print</code>接口的定义吗？</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="f2b9" class="me mf it ne b gy ni nj l nk nl"><strong class="ne iu">print</strong>(<em class="nc">*objects</em>, <em class="nc">sep=' '</em>, <em class="nc">end='\n'</em>, <em class="nc">file=sys.stdout</em>, <em class="nc">flush=False</em>)</span></pre><p id="34ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该功能打印对象，由<code class="fe nn no np ne b">sep</code>分隔，后跟<code class="fe nn no np ne b">end</code>。让我们来看看这个一行程序。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="4579" class="me mf it ne b gy ni nj l nk nl">#for-loop<br/>for i in range(1,5):<br/>    print(i, end=" ")</span><span id="0589" class="me mf it ne b gy nm nj l nk nl">#one-liner<br/>print(*range(1,5)) #<!-- -->1 2 3 4</span></pre><p id="ff45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于<code class="fe nn no np ne b">print</code>接受一个iterable，我们可以直接使用<code class="fe nn no np ne b">*range(1,5)</code>作为输入，它的输出与for循环相同。</p><h2 id="db2c" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">海象</h2><p id="ccd0" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">Walrus操作符是Python 3.8以后的一个特性。它为表达式中间的赋值变量提供了新的语法<code class="fe nn no np ne b">:= </code>。是为了避免两次调用同一个函数。</p><p id="09da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是Python文档中的一个例子。walrus operator允许您在飞行途中进行计算，而不是预先单独计算。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="cb60" class="me mf it ne b gy ni nj l nk nl"># without walrus<br/>discount = 0.0<br/>mo = re.search(r'(\d+)% discount', "10% discount")<br/>if mo:<br/>  discount = float(mo.group(1))/100.0</span><span id="1c15" class="me mf it ne b gy nm nj l nk nl"># with walrus<br/>discount = 0.0<br/>if (mo := re.search(r'(\d+)% discount', "10% discount")):<br/>  discount = float(mo.group(1)) / 100.0</span></pre><p id="969d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我发现walrus在for/while循环中非常有用，因为代码看起来非常整洁，就像普通的英语一样。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="666d" class="me mf it ne b gy ni nj l nk nl"># without walrus<br/>f = open("source/a.txt")<br/>line = f.readline()<br/>while line != '':<br/>    print(line)<br/>    line = f.readline()</span><span id="79e2" class="me mf it ne b gy nm nj l nk nl"># with walrus<br/>f = open("f.txt")<br/>while (line := f.readline()) != '':<br/>    print(line)</span></pre><h2 id="389d" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">斐波纳契</h2><p id="5825" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">好了，现在让我们来看看一些奇特的例子。你知道你可以用一行代码编写斐波那契算法吗？挺神奇的！</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="0ab6" class="me mf it ne b gy ni nj l nk nl">#for-loop<br/>def fib(x):<br/>    if x &lt;= 2:<br/>        return 1<br/>    return fib(x - 1) + fib(x - 2)</span><span id="aa81" class="me mf it ne b gy nm nj l nk nl">#1-liner<br/>fib = lambda x: x if x&lt;=1 else fib(x-1) + fib(x-2)</span></pre><h2 id="45e6" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">快速排序</h2><p id="77b3" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">如果你认为你还能处理它，让我们看看下一个层次的一行程序。这是快速排序的一个单行版本，一个著名的排序算法。</p><pre class="kj kk kl km gt nd ne nf ng aw nh bi"><span id="972f" class="me mf it ne b gy ni nj l nk nl">q = lambda l: q([x for x in l[1:] if x &lt;= l[0]]) + [l[0]] + q([x for x in l if x &gt; l[0]]) if l else []<br/>q([])</span></pre><p id="8619" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我看来，看着它，了解Python有多强大很好玩，但不要在工作中使用它。当一行程序变得太长而无法容纳一行时，是时候放弃它了。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="bc28" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">结论</h2><p id="4e31" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">像往常一样，我希望您发现这篇文章很有用，并且学到了一种提高代码质量的新方法。请随意与一行程序分享您的经验。干杯！</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h2 id="5bcc" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">参考</h2><div class="od oe gp gr of og"><a href="https://www.amazon.com/Python-One-Liners-Concise-Eloquent-Professional/dp/1718500505" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">Python一行程序:像专业人员一样编写简洁、雄辩的Python</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">Python一行程序:像Amazon.com的专业人士(Mayer，Christian)一样编写简洁、雄辩的Python。*免费*运输…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">www.amazon.com</p></div></div><div class="op l"><div class="oq l or os ot op ou ks og"/></div></div></a></div></div></div>    
</body>
</html>