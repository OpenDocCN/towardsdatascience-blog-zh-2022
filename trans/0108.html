<html>
<head>
<title>Data Mesh Patterns: Immutable Change / Audit Log</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据网格模式:不可变的变更/审计日志</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-mesh-patterns-immutable-change-audit-log-aec93da33648#2022-02-04">https://towardsdatascience.com/data-mesh-patterns-immutable-change-audit-log-aec93da33648#2022-02-04</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="e67b" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">让我们回顾一下企业数据网格是如何使用“不可变变更/审计日志”模式的。</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/b6cdeeb5b57e24e3fab35fa9b9120c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kY3JmZj8wMGm0A47ESnc7Q.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">米克·豪普特在<a class="ae kz" href="https://unsplash.com/s/photos/index?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="8ea4" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">不可变的变更/审计日志:一种基本的数据网格模式</h1><p id="f797" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">本文讨论不可变的变更/审计日志，是关于基础数据网格模式的系列文章的第三篇。我将总结该模式的目的、它的问题域和业务上下文、该模式如何工作，以及支持该模式的候选供应商。</p><p id="0745" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">本文假设您对数据网格有很高的理解。如果需要的话，下面的文章应该会给你一些背景知识:</p><ul class=""><li id="239c" class="mt mu iu lu b lv mo ly mp mb mv mf mw mj mx mn my mz na nb bi translated">数据网格原则(更多信息可在<a class="ae kz" href="https://martinfowler.com/articles/data-mesh-principles.html" rel="noopener ugc nofollow" target="_blank">这里</a>获得)</li><li id="80b5" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">数据网格架构(更多信息请点击<a class="ae kz" rel="noopener" target="_blank" href="/an-architecture-for-the-data-mesh-32ff4a15f16f">这里</a></li><li id="fa43" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">数据网格模式(更多信息见<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-architecture-patterns-98cc1014f251">此处</a>)</li></ul><p id="a9b9" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">本文末尾提供了完整系列的基础数据网格模式文章的列表。</p><h1 id="c681" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">模式摘要</h1><p id="1b5b" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">不可变的变更/审计日志模式跟踪企业数据网格中的数据沿袭。它通过建立数据变更日志来实现这一点，该日志通常来自企业数据网格的<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-pattern-deep-dive-change-data-capture-eb3090178c34">变更数据捕获</a> (CDC)系统，可以对其进行聚合、分析和切片，以支持审计和联合治理需求。</p><h1 id="9f3a" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">背景和业务问题</h1><p id="97bf" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">大多数大型企业都被看似简单的问题搞糊涂了。我的数据从哪里来？当它从一个应用程序和数据库转移到另一个应用程序和数据库时发生了什么？谁对数据进行了更改？</p><p id="bc2e" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">但是为什么这很重要呢？首先，最简单的是，数据治理所需的基本“良好卫生”使其变得有用，并且在许多情况下是大型企业所必需的。但更重要的是，尤其是在金融服务和医疗保健等受监管行业，它是由监管机构强制执行的。</p><p id="783d" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">例如，在金融服务监管机构要求“重要的”人工智能/机器学习模型(即。那些直接影响人或财务风险/状况的风险是<a class="ae kz" rel="noopener" target="_blank" href="/rethinking-ai-machine-learning-model-management-8afeaa31d8f8">可重复、可追踪和可验证的</a>。满足这一需求意味着企业的数据血统必须被很好地建立、理解，并且在接到通知后立即可用/可视化。</p><p id="2573" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">不幸的是，企业不得不拼凑一些定制的解决方案，每个解决方案都针对特定的应用程序或数据库配置文件。因此，毫不奇怪，企业会留下一组不一致的工具和能力差距，最终阻碍敏捷性和上市时间。</p><h1 id="b5e4" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">解决办法</h1><p id="e644" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">不可变的变更/审计日志使企业能够理解、可视化和报告数据单元的生命周期——或沿袭(注意，我使用的“数据单元”是最广义的，因为它可以是数据元素、数据行、数据表，这取决于您的具体情况所需的粒度。)</p><p id="ed12" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">不可变的变更/审计日志监听(在事件流主干上)数据变更事件。它收到数据变更事件的通知，并自动捕获数据单元中的变更(使用<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-pattern-deep-dive-change-data-capture-eb3090178c34">变更数据捕获</a>模式)，将数据单元变更(和元数据)呈现为“数据沿袭事件”，将事件存储在仅附加的持久日志中，并发布数据沿袭事件(使用<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-pattern-deep-dive-event-streaming-backbone-99a5bb2a7cbf">事件流骨干</a>模式)，以便其他感兴趣的下游方可以消费数据沿袭事件。</p><p id="3a8e" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">它还提供了将数据变更事件转化为可操作见解的工具。低级数据更改事件被分组和聚合，以查看单个数据单元的生命周期，可视化工具使查找和查看数据单元的生命周期和沿袭变得容易。</p><p id="2fea" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">请注意，将这种模式与流行的“事件源”模式混为一谈是一个常见的错误(为了方便起见，关于事件源的一些精彩信息可以在这里的<a class="ae kz" href="https://martinfowler.com/eaaDev/EventSourcing.html" rel="noopener ugc nofollow" target="_blank">、这里</a><a class="ae kz" href="https://microservices.io/patterns/data/event-sourcing.html" rel="noopener ugc nofollow" target="_blank">的</a>以及这里<a class="ae kz" href="https://docs.microsoft.com/en-us/azure/architecture/patterns/event-sourcing" rel="noopener ugc nofollow" target="_blank">的</a>中找到)。但是有一些重要的区别。</p><p id="1696" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">在事件源提供事件的持久日志的情况下，不可变的更改/审核日志将数据单元更改(在数据映像之前和之后)与导致数据更改的事件联系起来。</p><p id="6796" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">事件源中的主要实体是事件，而<strong class="lu iv"> <em class="nh">不是</em> </strong>它所作用的数据单元，不可变变更/日志模式中的主要实体既是数据单元<strong class="lu iv"> <em class="nh">又是</em> </strong>它所作用的事件。</p><h1 id="589c" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">它是如何工作的</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/0587777501fd8f7e3de9d31fcccbf7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gP8raAZsFqjYjliui6QTVg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><em class="ni">图 1，数据网格模式:不可变变更/审计日志</em></p></figure><ol class=""><li id="ba89" class="mt mu iu lu b lv mo ly mp mb mv mf mw mj mx mn nj mz na nb bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-pattern-deep-dive-change-data-capture-eb3090178c34">变更数据捕获</a> (CDC)从运营、参与或分析数据库的数据库事务日志中捕获数据变更，将其格式化为事件，并发布事件(使用<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-pattern-deep-dive-event-streaming-backbone-99a5bb2a7cbf">事件流主干</a>)供下游系统使用。</li><li id="66f2" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn nj mz na nb bi translated">其中一个下游服务是“聚合微服务”，它接收 CDC 数据更改事件并创建一个<strong class="lu iv">数据沿袭记录</strong>，该记录将数据的“之前”(数据更改之前)&amp;“之后”(数据的最终状态)图像与导致数据更改的事件相关联。</li><li id="7fe7" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn nj mz na nb bi translated">数据沿袭记录存储在不可变的变更/审核日志中；注意,“不可变”特征很重要——这通常实现为“仅附加”日志，因此提供了数据单元生命周期的持久且不可改变的历史记录。</li><li id="1286" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn nj mz na nb bi translated">数据沿袭记录被转发到<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-architecture-patterns-98cc1014f251">企业数据产品目录</a>；该目录允许按需搜索和可视化数据沿袭记录(以及许多其他属性)。</li><li id="4ba0" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn nj mz na nb bi translated">模式注册表为所有事件以及数据沿袭记录(以及它们包含的事件信息)提供了定义，从而为实现复杂的数据沿袭分析提供了必要的结构。</li><li id="b18a" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn nj mz na nb bi translated">整个企业的用户——数据科学家、治理团队成员和开发人员可以根据需要使用数据谱系记录。</li></ol><h1 id="4e3b" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">使用场景</h1><p id="ae4d" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">数据科学家使用这种模式来了解训练数据的谱系，以实现其模型的<a class="ae kz" rel="noopener" target="_blank" href="/rethinking-ai-machine-learning-model-management-8afeaa31d8f8">可再现性、可追溯性和可验证性</a>，这是人工智能/机器学习支持日益关键的决策所必需的。</p><p id="823c" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated">数据治理团队也使用这种模式来理解整个企业中的数据沿袭和相关的消费模式。</p><h1 id="29eb" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">供应商前景</h1><p id="6806" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">有几个组件相互作用来捕获、编目和可视化由不可变变更/审计日志模式存储的数据沿袭记录:</p><ul class=""><li id="0b39" class="mt mu iu lu b lv mo ly mp mb mv mf mw mj mx mn my mz na nb bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-architecture-and-the-role-of-apis-json-schemas-3dc616650960"> <strong class="lu iv">模式注册中心</strong> </a>:由于该组件提供了事件的定义(通常是<a class="ae kz" href="https://json-schema.org/" rel="noopener ugc nofollow" target="_blank"> JSON 模式</a>或<a class="ae kz" href="https://avro.apache.org/docs/current/spec.html" rel="noopener ugc nofollow" target="_blank"> AVRO </a>)，因此它与事件流主干紧密耦合。我对 Kafka Schema Registry 的<a class="ae kz" href="https://www.confluent.io/" rel="noopener ugc nofollow" target="_blank">汇合</a>版本有很好的体验。</li><li id="1afb" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-architecture-patterns-98cc1014f251"> <strong class="lu iv">企业数据产品目录</strong> </a>:到目前为止，我还没有找到一个具体的供应商来解决这个问题，我必须构建自己的定制系统，将模式注册、聚合微服务、事件可视化和可搜索的目录联系起来。考虑到这一点，我通常会从一个灵活的静态开源内容管理服务开始，如<a class="ae kz" href="https://docusaurus.io/" rel="noopener ugc nofollow" target="_blank"> Docusaurus </a>或<a class="ae kz" href="https://gohugo.io/" rel="noopener ugc nofollow" target="_blank"> Hugo </a>，它们具有可靠的搜索/查找和内容存储功能，然后在聚合和可视化功能上再加一层。我意识到可能有更复杂的解决方案，但这很有效，可以很快实现。</li><li id="8878" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated"><strong class="lu iv">不可变日志</strong>:任何可以存储非结构化数据的健壮数据库在这里都可以；此外，虽然该功能不同于事件源，但 Kafka 保存的持久日志可以作为不可变更改/审计日志的基础，尽管可能需要实现额外的功能和配置。</li></ul><p id="5647" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated"><em class="nh">完全披露:在推荐上述任何产品时，我没有</em> <strong class="lu iv"> <em class="nh">经济利益</em></strong><em class="nh">——我之所以强调这些产品，是因为我有一些使用它们的经验，它们对我很有效。</em></p><h1 id="8f09" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">本系列的其他文章</h1><p id="6c94" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">下面列出了本系列中关于基础数据网格模式的全部文章。</p><ul class=""><li id="8646" class="mt mu iu lu b lv mo ly mp mb mv mf mw mj mx mn my mz na nb bi translated"><strong class="lu iv">变更数据捕获(CDC)模式</strong>，它跟踪数据库中的变更，并将它们捕获为“事件”(此处<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-pattern-deep-dive-change-data-capture-eb3090178c34">可用</a>)。</li><li id="17b4" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated"><strong class="lu iv">事件流骨干模式</strong>，CDC 和其他应用程序使用该模式在企业数据网格中发布和订阅/接收事件(此处<a class="ae kz" rel="noopener" target="_blank" href="/data-mesh-pattern-deep-dive-event-streaming-backbone-99a5bb2a7cbf">可用</a>)。</li><li id="0c97" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated"><strong class="lu iv">不可变的变更/审计日志模式</strong>，它保留日志并跟踪企业数据网格中的数据血统，用于未来的审计和治理目的(本文)。</li><li id="a617" class="mt mu iu lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated"><strong class="lu iv">企业数据产品目录模式</strong>，这是一个目录/存储库，包含关于企业数据网格中数据产品的元数据(即将推出)。</li></ul><h1 id="ddee" class="la lb iu bd lc ld le lf lg lh li lj lk ka ll kb lm kd ln ke lo kg lp kh lq lr bi translated">总结想法</h1><p id="4b1b" class="pw-post-body-paragraph ls lt iu lu b lv lw jv lx ly lz jy ma mb mc md me mf mg mh mi mj mk ml mm mn in bi translated">不可变的变更/审计日志是一种基本的数据网格模式。与模式注册中心和企业数据产品目录相结合，它提供了实现监管者、审计者和数据治理专家所需的数据谱系的底层能力，同时实现了“联合计算治理”的核心数据网格原则。</p><p id="f01f" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi">***</p><p id="8a81" class="pw-post-body-paragraph ls lt iu lu b lv mo jv lx ly mp jy ma mb mq md me mf mr mh mi mj ms ml mm mn in bi translated"><em class="nh">除非另有说明，本文中的所有图片均由 Eric Broda(本文作者)创作。图像中使用的所有图标都是普通的 PowerPoint 图标，不受版权保护。</em></p></div></div>    
</body>
</html>