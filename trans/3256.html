<html>
<head>
<title>Simple Market Basket Analysis with Association Rules Mining</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于关联规则挖掘的简单购物篮分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-simple-association-rules-mining-for-market-basket-analysis-ef8f2d613d87#2022-07-20">https://towardsdatascience.com/introduction-to-simple-association-rules-mining-for-market-basket-analysis-ef8f2d613d87#2022-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f219" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过概念、关联规则挖掘的工作机制和Python代码理解客户行为</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4c3e2894509cb1ae8463e6d8ed7c8f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*61CHD4DVs44iL9TE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@orenlbz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">柳文欢·埃尔巴兹</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="9284" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="7ea2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你一定已经注意到比萨饼店的售货员做了比萨饼、软饮料和薯条的组合。他也给购买这些套餐的顾客打折。你有没有想过他为什么要这么做？</p><p id="f1a9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为他发现买披萨的顾客也会买软饮料和薯条。通过做组合，他让顾客很容易。同时，他也提高了自己的销售业绩。</p><p id="9bde" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上面的小例子来看，收集和分析用户行为对于在销售中创建有效的交叉销售和追加销售策略的重要性是不可否认的。基于用户行为的数据，我们可以使用RFM和聚类分析将客户分成不同的组，以便为每个组提供定制的服务。但是，要预测客户可能购买的其他产品，分析师经常使用的了解客户购买习惯的方法之一是<strong class="lt iu"> <em class="ms">关联规则挖掘</em> </strong>。</p><p id="49f2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在今天的文章中，我将向您提供关于这项技术的最全面的信息，以及如何使用它来更好地了解客户。</p><h1 id="cdc7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是关联规则挖掘？</h1><p id="ca75" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">基于交易历史，可以利用许多模式来理解客户行为。可以实现的洞察之一是所购买的物品之间的关联。使用所有购买商品的数据，我们可以确定哪些商品通常是一起购买的，从而定义和建立产品关联模型。结论必须进行概率和可靠性测试。例如，一个人去超市买面包。他/她有80%的可能性购买果酱或火腿与面包一起吃，有90%的把握。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/a554a017d014cca4813cca03c797aa86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H1UO-UrsdjNBzBcpkEL7sA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="af60" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，零售商可以使用分析结果来定位、推荐和导航商店中的产品，以促进产品或产品类别之间的交叉销售。</p><h1 id="4706" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">基于Apriori的关联规则挖掘</h1><p id="4354" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Apriori是一种算法，它利用数据中相互关联的对象集。换句话说，它有助于识别频繁出现的项目集。先说一个最小发生阈值为1的apriori。该过程从查找满足最小出现要求的单个对象开始。然后，它一次一个项目地扩展项目集，检查更广泛的项目集是否仍然满足预定义的阈值。当不再有满足最小出现条件的项目要添加时，算法终止。</p><h1 id="6a8c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">先验的成分</h1><p id="85dc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设我们有4个订单，每个订单描述如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/86c5bd95721161637e8e4c9d783ab7cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*V6BPtWj1zO9AafgUMA_DyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cb20" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这4个订单中，我们有3个包含苹果的订单，3个包含香蕉的订单，2个包含香蕉和苹果的订单。利用这些信息，我将计算一些重要的先验指标，包括支持度、信心度和提升度。</p><h2 id="890d" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">支持</h2><p id="38c0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是包含项目集的订单比例。正如您在上面的示例中所看到的，3个订单包括总共4个订单中的香蕉，因此:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="ba37" class="mv la it ni b gy nm nn l no np"><strong class="ni iu"><em class="ms">Support (bananas) <br/>= Bananas related orders/Total orders <br/>= 3/4 = 0.75</em></strong></span></pre><p id="3213" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">信心</strong></p><p id="feee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个例子中，置信度表达了在购买香蕉之后购买苹果的次数的百分比。所以，公式可以如下所示:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="82e0" class="mv la it ni b gy nm nn l no np"><strong class="ni iu"><em class="ms">Confidence (bananas -&gt; apples) <br/>= support (bananas, apples) / support (bananas) <br/>=(2/4)/(3/4) = 0.6667</em></strong></span></pre><p id="a17b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">66.67%的值意味着购买香蕉的顾客中有66.67%也购买苹果。然而，这个数字是否暗示了这两种水果之间的关系，或者它们仅仅是偶然一起购买的？为了回答这个问题，我们将不得不看看另一个衡量这两种事物受欢迎程度的指标。</p><p id="e8f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">根据业务目的、研究背景和行业领域，支持度和置信度阈值的设置是不同的。例如，在分析金融欺诈时，支持值可能是1%，因为数据集中出现欺诈的交易相对较少。因此，没有特定的标准来决定一个特定的阈值。</p><h2 id="3298" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">电梯</h2><p id="3e70" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">此指标显示商品之间是否实际存在关联，或者购买这些商品是否只是随机组合。从这个例子中，我们可以快速计算升力:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="f264" class="mv la it ni b gy nm nn l no np"><strong class="ni iu"><em class="ms">Lift(bananas, apples) = Lift(apples, bananas)<br/>= support(bananas, apples) / (support(bananas) * support(apples))<br/>=(2/4)/(0.75*0.75) = 0.89</em></strong></span></pre><p id="5a24" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，该度量意味着，如果香蕉出现在75%的订单中，苹果出现在75%的订单中，并且这两个项目之间没有联系，则苹果和香蕉预计会在75% * 75% = 56.25%的情况下一起购买。同时，分子反映了苹果和香蕉以相同顺序出现的频率。在这个场景中，这是50%的时间。得到这个值并除以56.25%显示了苹果和香蕉以相同的顺序出现的次数比它们没有关联时多多少次。</p><p id="9cbb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">基于升力值的结果，我们可以有一些推论:</p><ul class=""><li id="b6f1" class="nq nr it lt b lu mn lx mo ma ns me nt mi nu mm nv nw nx ny bi translated">lift = 1:物品随机一起买。换句话说，项目之间没有关系。</li><li id="2470" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">lift &gt; 1:物品一起购买的频率高于随机购买。</li><li id="d468" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">抬起&lt; 1: items are bought together less regularly than random.</li></ul><p id="e0ee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">In the example above, apples and bananas appear together 0.89 times more than random. Therefore, we can tell there is a negative relationship between these 2 items.</p><p id="10bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Now, let’s see how the association rules mining works in a real dataset.</p><h1 id="fad9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Dataset</h1><p id="b272" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">For this article, I will use a dataset from a bakery (License: CC0: Public Domain). This dataset includes 20507 entries, over 9000 transactions, and 5 columns. You can download the data from this <a class="ae ky" href="https://www.kaggle.com/datasets/mittalvasu95/the-bread-basket" rel="noopener ugc nofollow" target="_blank">连杆</a>。</p><p id="09c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据集的概述如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/50847996c36bafff527961fccffa8d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*ONZwD422bdQ1E1vbdW5PAA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据类型-按作者分类的图像</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/31c6d7d317be1076e380be67059eed59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uArDGMxQ97GQVxuSAXfnkQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最后五行—作者图片</p></figure><p id="18c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从2016年11月到2017年3月，总交易量急剧增加，如下图所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/ce14eef0cd187298d200ef3538bea6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LD0lXKfWqvmP_Sebsqcvuw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每月交易—按作者分类的图像</p></figure><p id="61ee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下表描述了销售额最高的10件商品。咖啡、面包和茶是面包店最受欢迎的商品。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/9516439879a5fdd3053a78b677695148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XqHdLtZSDmtBe7LaAnhZCg.png"/></div></div></figure><p id="7f9d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，让我们看看如何将关联规则挖掘应用于这些数据。</p><h1 id="de77" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">转换数据集</h1><p id="2e05" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">因为事务中的项目被拆分到不同的行中，所以我将这些项目分组到一个地方。项目列表的列表转换如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/fffa80fb651aedacbeecac6698b68b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*lVrdOCvyxRn9k42Ucx3hUw.png"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="7e54" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Apriori模块需要一个值为0和1或True和False的数据帧。因此，我将使用一个热编码数据，以满足mlxtend库给出的Apriori模块的要求。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/8cb7d01144ed0fd6595c8bab534db985.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x7th0RheQJNML1OaekX0eQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一次热编码后—作者提供的图片</p></figure><p id="5d80" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在应用Apriori模块之前，我们需要导入一些必要的库:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="0774" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，我们可以轻松地应用mlxtend库中的apriori模块。只用一行代码就可以找到频繁集。在这个例子中，我将使用<code class="fe om on oo ni b">min_support = 0.05</code>，它意味着选择一个项目集所需的最小支持。同时，<code class="fe om on oo ni b">use_colnames = True</code>为项目集保留列名，使它们更容易理解。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/17bd9c3a694c0939ed724b9c7d0f4559.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*wafm_YnPD7VUKx6o0c8PgQ.png"/></div></div></figure><p id="2f67" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从这些频繁集中，我继续寻找决定<strong class="lt iu">T5的关联规则，如果 </strong> A被购买，<strong class="lt iu"> <em class="ms">那么</em> </strong> B也被购买。我将<code class="fe om on oo ni b">metric = 'lift'</code>设置为最小阈值= 1。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/dd91264bd0409f776a8c976f6916d3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o2UDTlGFlGSKF5BQSfZtEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">关联规则-按作者分类的图像</p></figure><p id="014f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如我们所看到的，结果只包含两个关联规则。在<code class="fe om on oo ni b">lift = 1.1</code>和53%的置信度下，蛋糕和咖啡比随机购买更频繁。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/a768618db81a0271480fb2e12bcdc3e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*yeV5bRdVNcFHBLoWUkop4A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="f104" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">限制</h1><p id="411d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尽管Apriori算法易于应用，但它仍有某些限制，包括:</p><ul class=""><li id="858d" class="nq nr it lt b lu mn lx mo ma ns me nt mi nu mm nv nw nx ny bi translated">如果事务数量很大并且内存容量有限，则算法的效率会降低。</li><li id="cd7e" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">由于它需要扫描整个数据库，因此需要很高的处理能力</li></ul><h1 id="dd4a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="6bc6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">了解关联规则挖掘技术将有助于更好地了解客户，从而有合适的策略来促进销售。可以从该方法中提取的一些益处可以提及如下:</p><ul class=""><li id="7819" class="nq nr it lt b lu mn lx mo ma ns me nt mi nu mm nv nw nx ny bi translated">展位安排:您可以将相关商品组合在一起。基于消费者购买习惯的组合商品价格。</li><li id="8bf9" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">产品推荐:产品推荐要基于用户购买习惯。如果顾客购买更多的组合，你可以给他们折扣。或者，客户可以用最低总价购买额外的商品。</li><li id="5f22" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">库存管理:市场篮子分析成为预测未来采购的基础。此外，销售数据是同时获取的，因此保持产品供应和控制库存变得更加高效。</li><li id="b724" class="nq nr it lt b lu nz lx oa ma ob me oc mi od mm nv nw nx ny bi translated">优化广告成本:充分利用你的广告机会。客户对信息、沟通和产品的反应反映了这一点。</li></ul><p id="37e9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我希望我的文章能为那些想更多了解这种有用方法的人更好地理解客户行为打下良好的基础。</p><h1 id="dd46" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">参考</h1><div class="os ot gp gr ou ov"><a href="https://www.kaggle.com/code/datatheque/association-rules-mining-market-basket-analysis" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd iu gy z fp pa fr fs pb fu fw is bi translated">关联规则挖掘/购物篮分析</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自Instacart市场篮分析的数据</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">www.kaggle.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj ks ov"/></div></div></a></div></div></div>    
</body>
</html>