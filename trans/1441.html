<html>
<head>
<title>Are These Data ‘Normal’? Anomalies &amp; Outliers In Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这些数据‘正常’吗？机器学习中的异常和异常值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/are-these-data-normal-anomalies-outliers-in-machine-learning-a259bbe58690#2022-04-08">https://towardsdatascience.com/are-these-data-normal-anomalies-outliers-in-machine-learning-a259bbe58690#2022-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="31a8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python深入研究隔离森林</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2f5da25f27ca47fe1ec58808d77cdaa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4k0GQVi5E4e4gOfMpGOug.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">鲁珀特·布里顿在<a class="ae ky" href="https://unsplash.com/s/photos/odd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="cae1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">微积分笑话大多是衍生的，三角学笑话太图形，代数笑话通常公式化，算术笑话相当基础。</p><p id="516a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">但偶尔的统计笑话是一个异数。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="fa26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有人希望他们的数据中有异常值——尤其是当这些异常值来自于由于大拇指造成的虚假条目时。几个零可能会打乱算法，破坏汇总统计数据。</p><p id="c9b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以这就是你如何使用机器学习来删除那些讨厌的离群值。</p><h1 id="74af" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">什么是正常？</h1><p id="4ed6" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">从历史上看，异常检测的第一步是尝试并理解什么是“正常”，然后找到“不正常”的例子。这些“不正常”的点就是我们归类为异常值的点——即使在它的最远端，它们也不符合我们的预期分布。</p><p id="47f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">隔离森林，或iForest，一个优雅而美丽的想法，不要遵循这种方法。背后的前提很简单。最初的作者和iForests的发明者表示，离群值或异常值是“T8”很少并且“T9”不同于其他人群的数据点。</p><p id="c746" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们进一步指出，“<em class="lv">少且不同的</em>数据点具有一种被称为“<em class="lv">隔离</em>的特征”。</p><p id="a34f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">似乎合乎逻辑。</p><h1 id="eecc" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">它是如何工作的？</h1><p id="4307" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">隔离森林算法通过隔离实例<em class="lv">来工作，而</em>不依赖于任何距离度量。他们结合使用了之前针对异常现象规定的两种特征——异常现象既少又不同。</p><p id="640f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该算法利用了<a class="ae ky" href="https://en.wikipedia.org/wiki/Binary_tree" rel="noopener ugc nofollow" target="_blank">二叉树结构</a>。它们是递归结构，每个节点最多有<strong class="lb iu">两个子节点。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/7f4f49e7842096e03623ef01bb27b133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2B2CA8OYhm_SZCcU.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Binary_tree#/media/File:Full_binary.svg" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Binary _ tree #/media/File:Full _ Binary . SVG</a></p></figure><p id="ae56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是重要的一点。</p><p id="c012" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于离群值容易被隔离，所以离群值更可能位于树根附近——隔离它们需要较少的分区。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/d3e416e72fb54090470e82368589bd75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIJTJIAMaGh3BYCmN7jdUw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="0d8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，<em class="lv">路径长度</em>较短的点很可能是异常值。iForest算法构建了一个iTrees集合(看起来很熟悉吧？)然后平均路径长度。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/917bc8fdda609fe4266d696eeb80138c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OoXcO16SDoE8F7wu1ngmaQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/tkdd11.pdf" rel="noopener ugc nofollow" target="_blank">https://cs . nju . edu . cn/Zhou zh/Zhou zh . files/publication/tkdd 11 . pdf</a>—路径长度是必须遍历的边数。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/17f5e424cc7e5b68af9d0634306959cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*G0unZpZ22lkoQrPf4tAQsQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/tkdd11.pdf" rel="noopener ugc nofollow" target="_blank">https://cs . nju . edu . cn/Zhou zh/Zhou zh . files/publication/tkdd 11 . pdf</a></p></figure><p id="0ac1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你从上面的<a class="ae ky" href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/tkdd11.pdf" rel="noopener ugc nofollow" target="_blank">原始作者的</a>图片中看到的，我们的眼睛清楚地告诉我们，一个离群点需要更少的分割来隔离。路径长度收敛于小于明显不是异常值的点的一半长度。</p><h1 id="26ab" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">它与其他异常检测算法相比如何？</h1><p id="c22e" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">首先，使用iForest有很多好处。这里有一些例子。</p><ul class=""><li id="cb19" class="ne nf it lb b lc ld lf lg li ng lm nh lq ni lu nj nk nl nm bi translated">iForest可以利用子采样，因此它具有较低的线性时间复杂度和较小的内存需求。</li><li id="664b" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">它可以处理淹没和掩蔽的影响。</li><li id="d79c" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">适用于高维问题。</li><li id="b3a8" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">适用于不相关的属性。</li><li id="70a9" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">在没有包含异常(无监督)的训练集的情况下工作。</li></ul><p id="5ed5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但iForest如此出色的主要原因是它是为这项工作而设计的。许多同行的情况并非如此。单类SVM和大多数聚类方法等算法是为其他目的而设计的。它们适合异常检测，但仍然不是为此目的而创建的。</p><p id="460d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不同异常检测算法的全面比较可以在这里看到<a class="ae ky" href="https://scikit-learn.org/stable/modules/outlier_detection.html#isolation-forest" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="b4b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅从这张照片，我就知道我喜欢用哪一张。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/ffc7c0d827af9babdbf9cd54f11fa6f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UIrsRUsKrsHa4QEGKcYoJw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/outlier_detection.html#isolation-forest" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/outlier _ detection . html # isolation-forest</a></p></figure><h1 id="a97b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">下面是它在Python中的工作方式</h1><p id="7188" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">用Python运行很简单。如您所见，只有30行左右的代码可以得到预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="745e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你所要做的就是导入包和数据。然后，在运行和拟合模型之前，将其转换为Numpy数组。然后，您可以将其转换回pandas数据框架，并对其运行value_counts方法，这将告诉您有多少异常值。从我使用的数据集，该算法挑选了148个离群值，然后将其赋值为-1。</p><p id="7a8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以将其合并回原始数据框架，并使用您选择的绘图包来查看它预测的异常值。</p><p id="c790" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这一切都有意义，并快乐(离群)狩猎。</p><p id="8f30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">干杯，</p><p id="2df4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">詹姆斯</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><pre class="kj kk kl km gt nv nw nx ny aw nz bi"><span id="b97a" class="oa me it nw b gy ob oc l od oe">If I’ve inspired you to join medium I would be really grateful if you did it through this <a class="ae ky" href="https://jamesasher4994.medium.com/membership" rel="noopener">link</a> — it will help to support me to write better content in the future.</span><span id="c588" class="oa me it nw b gy of oc l od oe">If you want to learn more about data science, become a certified data scientist, or land a job in data science, then checkout <a class="ae ky" href="https://365datascience.pxf.io/c/3458822/791349/11148" rel="noopener ugc nofollow" target="_blank">365 data science</a> through my <a class="ae ky" href="https://365datascience.pxf.io/c/3458822/791349/11148" rel="noopener ugc nofollow" target="_blank">affiliate link.</a></span></pre><p id="f799" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这个，这里还有一些我的文章。</p><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/econometrics-is-the-original-data-science-6725d3f0d843"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">计量经济学是原始的数据科学</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">这就是你应该多了解它的原因</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox ks oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/how-to-easily-show-your-matplotlib-plots-and-pandas-dataframes-dynamically-on-your-website-a9613eff7ae3"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">如何轻松地在你的网站上动态显示你的Matplotlib图和Pandas数据框。</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">这是一种令人惊讶的简单方法，可以在线向全世界展示您的图表和数据框架，而且不到…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox ks oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/how-to-make-a-free-serverless-interactive-dashboard-in-minutes-e6ce5a1088e0"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">如何在几分钟内制作一个免费的、无服务器的交互式仪表板</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">我向你保证，你可以像做一个标准的可视化一样快地制作这个仪表板…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oz l ou ov ow os ox ks oj"/></div></div></a></div></div></div>    
</body>
</html>