<html>
<head>
<title>Using AI to Prevent Supplier Invoice Fraud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用人工智能防止供应商发票欺诈</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-ai-to-prevent-supplier-invoice-fraud-fed13f2aaab4#2022-09-09">https://towardsdatascience.com/using-ai-to-prevent-supplier-invoice-fraud-fed13f2aaab4#2022-09-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/548e9c3f69a91ae67295c61b169ff3a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*s1A3wefT3qwSsJST"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kc" href="https://unsplash.com/@esen_aza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿扎马特E </a>拍摄</p></figure><p id="4b6e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">供应商发票欺诈是商业中的一个重要问题。每年都有数百万美元因供应商提交的不正确或无效发票而损失。这里概述的基于机器学习的方法能够在这些发票到期支付之前识别高达97%的发票。</p><p id="c9de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此处使用的示例基于一个私有的匿名数据库，该数据库包含一家服务公司五年内的约9万张发票，该公司反过来购买服务和商品进行转售。该公司已经允许在本文中使用发票数据库。</p><p id="1ef8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在开具发票期间，该公司一直存在一个问题，即供应商提交的发票金额夸大、金额错误，有时还会提交从未提供的货物/服务的发票。</p><p id="bd86" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过仔细的人工分析后，许多发票被标记为欺诈性的，这些发票用于训练此处的模型。值得注意的是，这里的“欺诈”一词并不一定意味着故意欺诈，还包括无意的数据输入错误。</p><p id="48c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将数据加载到Pandas数据框架中，并整理一些缺失的值:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="2bbe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在生成人工智能模型之前，需要大量的特征工程。探索的第一个项目是<a class="ae kc" href="https://en.wikipedia.org/wiki/Benford%27s_law" rel="noopener ugc nofollow" target="_blank">本福特定律</a>的应用。这表明，在自然出现的数据集中，前导数字更可能是一个小数字，而不是一个大数字。</p><p id="f280" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">计算的基础是数字的对数正态分布，而不是数字本身。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/b30a15779f76580949dd3ab79a1955ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*kqujygU4dGoUxxPOFDeECg.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">本福特定律</p></figure><p id="0847" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基于此，每个发票金额的第一个数字的分布应该如下所示:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/2898fcd3eae0b069ea2ab20f5a5c901c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*2QSSlbCeXzmBBbC5oDWpPA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">本福特定律下第一位数的分布</p></figure><p id="8157" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个数字大约有30%的概率是1，大约有4%的概率是9。对发票数据集的分析揭示了真实世界的分布情况:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/7f00e6caaf79667d36baabf580f535c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*AIXk_lrA-2pR5fdx8Z3RLw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">第一位数的真实分布</p></figure><p id="7693" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以立即看到，数字9的出现比我们预期的要高。此外，对于小数值小于1的发票，数字0也会出现。</p><p id="1d1a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了在模型中利用本福特定律，我们将把发票金额的第一个数字分离到一个名为“first_digit”的新列中。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="9092" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们将为每张发票生成一个<a class="ae kc" href="https://www.investopedia.com/terms/z/zscore.asp" rel="noopener ugc nofollow" target="_blank"> z分数</a>。这是衡量一个值与其组的标准偏差的距离。在这种情况下，我们将按供应商对发票进行分组，并获得每张发票的标准差。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/eb729f7ab579caf20d8e98f7ea2d812c.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*kYXJA8ENVlUOueHHo_DQkA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">z得分是减去组平均值的值，除以组标准偏差</p></figure><p id="266d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是使用下面的代码生成的:</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="35d3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有趣的是，据报道，在夏季的几个月里，欺诈的发生率较高。虽然对此没有明显的解释，但还是决定进一步调查。</p><p id="fe97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，发票日期被转换为基于自1月1日以来的天数的新功能。这允许所有年份都被平等地处理。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="a3e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为12月31日紧挨着1月1日，所以需要将<em class="ll">天数</em>转换成一个循环值。这是通过生成天数除以一年365天的余弦值来实现的。绘制该值会给出下图，其中每个值都在-1和+1之间:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/a4f8435809c45e8a04d80a52b99eda6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*Aix0NwTY_Ev1gR9zvAQ02A.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">天数的正弦值与余弦值的对比表明了数据的循环性质</p></figure><p id="de60" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们将创建另外两个特征。同样，根据传闻信息，据报道，欺诈性发票通常是整数金额，没有小数，而且更常见的是描述也较短。</p><p id="9d5e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这种可能性，添加了另一个新特性来标记金额是否包含小数，以及发票描述的长度。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="c777" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后对包括新特征在内的数据集进行分析，以寻找相关性:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/683d147f9299c979cd8d45c5a010b2f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m974voYINvSUmaAOHSjZZQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">数据集中列的相关矩阵</p></figure><p id="78c7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面的关联矩阵中，如果我们查看与“欺诈”字段相关的行，我们可以观察到许多有趣的事情。</p><p id="2fb9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，与发票金额有很强的相关性。这在某种程度上是意料之中的，因为欺诈者不太可能开具低值发票。我们已经知道，数据集包含许多值小于1的发票，因此大额发票可能更经常是欺诈性的。</p><p id="a851" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这似乎也与发票描述的长度有关。这表明欺诈性发票更有可能具有较短的描述。</p><p id="c59f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">支持本福特定律，我们可以看到与发票金额第一位数字的相关性。最后，我们可以观察到，zscore还与发票是否存在欺诈行为相关联。</p><p id="d8d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里的下一步是选择要使用的最佳分类器类型。虽然我们有许多与欺诈与否密切相关的特征，但这些特征彼此之间没有很强的相关性。例如，发票描述的长度与发票金额的第一位数字具有0.024的相关性。</p><p id="3888" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于这些特征之间的相关性较弱，因此选择了随机森林分类器。这种分类器通过创建几个独立的决策树来工作，每个决策树输出自己的预测。然后将这些组合在一起，做出最终预测。</p><p id="eb95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在将把数据分成测试和训练数据集，并训练一个随机森林分类器。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="5488" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过训练后，该模型能够对测试数据集进行预测，准确率高达97%(精确度92%，召回率78%)。</p><p id="adbf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了评估模型的整体质量，我们现在将生成一条ROC曲线。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="bde1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将生成下图:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lo"><img src="../Images/fcbc727e0bcfcc66b7a2f601020c5a84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1OTH4nuXyaAzg1Sm-fDmqQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">训练后模型的ROC曲线</p></figure><p id="c63c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型本身能够实现超过80%的准确性，而不会产生大量的假阳性。略高于90%的准确度代表了产生少量假阳性的折衷。</p><p id="c07c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总的来说，这种方法能够达到非常高的准确性，这取决于您愿意接受的假阳性的数量。</p><p id="5e0a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，这完全取决于源数据的性质，所有的公司都不尽相同。此处显示的许多因素都是该公司及其所在行业特有的，例如欺诈活动的季节性和发票金额的分布。要成功地将这种方法应用到另一家公司，对其业务的透彻理解将是极其有益的。</p><p id="e482" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ll">注:除特别注明外，所有图片均为作者所有。</em></p></div></div>    
</body>
</html>