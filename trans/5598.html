<html>
<head>
<title>Convert Jupyter Notebooks into Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将 Jupyter 笔记本转换为功能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/convert-jupyter-notebooks-into-functions-6fbda7b18419#2022-12-19">https://towardsdatascience.com/convert-jupyter-notebooks-into-functions-6fbda7b18419#2022-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a8a5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">参数化笔记本，以便您可以通过编程方式运行它们</h2></div><p id="f394" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你已经在 Jupyter 笔记本上训练了你的机器学习模型。现在，您希望对每天获得的数据运行该模型。</p><p id="c67f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">日复一日，你创建了同一个笔记本的新副本并运行它。您存储笔记本的副本，并将结果传递给利益相关者。</p><p id="a3ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在另一个场景中，您每天都有一组新的数据需要在 Jupyter notebook 上用相同的代码可视化。</p><p id="c03d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，您创建了同一个笔记本的新副本，并修改了输入。同样，您存储笔记本的副本，并将结果传递给您的利益相关者。</p><p id="03bb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">听起来不痛苦吗？</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/8636f943d6d85ef68c524e2aca67917c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*XCpPgPfY_fFKMAV9ofh4rw.jpeg"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">这是你的桌面吗？只是一堆笔记本叠在一起而已！稳定扩散成像</p></figure><p id="f7be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们有一个函数<code class="fe ln lo lp lq b">run_notebook(input_data)</code>，这个问题就可以解决。通过提供参数<code class="fe ln lo lp lq b">input_data</code>，笔记本将使用新的 input_data 运行。输出将是使用新数据运行的笔记本的副本。</p><p id="9afb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这正是造纸厂所做的。</p><p id="67a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个它的快速演示。</p><h1 id="f915" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">Papermill:参数化并自动执行 Jupyter 笔记本</h1><p id="a7f9" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">它是一个用于参数化、执行和分析 Jupyter 笔记本的开源工具。只需将参数传入笔记本，Jupyter 笔记本就会自动运行。</p><h2 id="15ea" class="mo ls iq bd lt mp mq dn lx mr ms dp mb ko mt mu md ks mv mw mf kw mx my mh mz bi translated">造纸厂的使用案例</h2><p id="24ac" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">如果手动对多个数据集进行相同的分析，既耗时又容易出错。例如，每日报告控制面板可能需要每天根据新数据进行刷新。Papermill 实现了自动化。</p><p id="dc96" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Jupyter 笔记本中的机器学习算法可能用于每天生成结果。Papermill 可用于在生产中生成结果，而不是每天用新数据手动运行笔记本。</p><p id="e239" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我回顾了:</p><ul class=""><li id="1618" class="na nb iq kh b ki kj kl km ko nc ks nd kw ne la nf ng nh ni bi translated">安装造纸厂</li><li id="6c08" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">Papermill 入门</li><li id="c26e" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">使用 Papermill 定期生成可视化报告</li><li id="bd26" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">在造纸厂生产中运行机器学习算法</li><li id="b450" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">你可以用 Papermill 做的其他事情</li><li id="c5ff" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">进一步的阅读和资源</li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h1 id="a344" class="lr ls iq bd lt lu nv lw lx ly nw ma mb jw nx jx md jz ny ka mf kc nz kd mh mi bi translated">1.安装造纸厂</h1><p id="8063" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">只需在您的终端中运行以下命令。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="6042" class="oe ls iq lq b be of og l oh oi">pip install papermill[all]</span></pre><h1 id="e3a9" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">2.Papermill 入门</h1><h2 id="35c4" class="mo ls iq bd lt mp mq dn lx mr ms dp mb ko mt mu md ks mv mw mf kw mx my mh mz bi translated">在朱庇特笔记本上</h2><ol class=""><li id="1b69" class="na nb iq kh b ki mj kl mk ko oj ks ok kw ol la om ng nh ni bi translated">在你的桌面上创建一个 Jupyter 笔记本，命名为<code class="fe ln lo lp lq b">hello_papermill</code></li><li id="4806" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la om ng nh ni bi translated">比方说，我们要参数化<em class="on"> a </em>和<em class="on"> b </em>来计算<code class="fe ln lo lp lq b">a+b</code>。我们将创建这个代码块。</li></ol><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi oo"><img src="../Images/aa3bf36a26f2800127a14477157256d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uJEpfp67qPWFGJmd5HKEA.png"/></div></div></figure><p id="a90e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.转到工具栏-&gt;视图-&gt;单元格工具栏-&gt;标签。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi ot"><img src="../Images/04991c2ad668efc5ba57ca861228e5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3-M_D0U0SmbGJce3rCR6_A.png"/></div></div></figure><p id="8084" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.在第一个单元格的右上角键入<code class="fe ln lo lp lq b">parameters</code>。点击“添加标签”。笔记本参数化！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi ou"><img src="../Images/771ac9d3e09ca7c7e319d41ee726b694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZ4aGLGLNeFYRoStZkbkKw.png"/></div></div></figure><p id="b477" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.启动终端并导航到您的桌面。</p><p id="eee5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于 Mac 用户，该命令是:</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="6469" class="oe ls iq lq b be of og l oh oi">cd ~/Desktop/ </span></pre><p id="992d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于 Windows 用户，该命令为</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="b012" class="oe ls iq lq b be of og l oh oi">cd C:\Users\YOUR_USER_NAME_HERE\Desktop</span></pre><p id="a351" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.用这个命令运行你的参数化笔记本。该命令告诉 Papermill“使用参数<code class="fe ln lo lp lq b">a=10</code>和<code class="fe ln lo lp lq b">b=20</code>运行<code class="fe ln lo lp lq b">hello_papermill.ipynb</code>，并将结果存储在<code class="fe ln lo lp lq b">output.ipynb</code>中”</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="4429" class="oe ls iq lq b be of og l oh oi">papermill hello_papermill.ipynb output.ipynb -p a 10 -p b 20</span></pre><p id="66b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">7.从 Jupyter 界面，打开<code class="fe ln lo lp lq b">output.ipynb</code>。您应该会看到以下自动生成的内容。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi ov"><img src="../Images/6a65165561c3584add91fbfc77a523a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W-7lUhC6Pbp39lqRCMXpEA.png"/></div></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">单元格[1]中的所有输入都被单元格[2]中的参数覆盖。请注意，单元格[2]是由 Papermill 自动生成的，并且具有注入参数标签。</p></figure><h1 id="fddb" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">3.使用 Papermill 定期生成可视化报告</h1><p id="7bb6" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">现在我们已经浏览了 Papermill 的“hello world ”,让我们深入第一个可能的用例。</p><p id="d04d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在运行这段代码之前，请安装以下软件包。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="6d75" class="oe ls iq lq b be of og l oh oi">pip install yfinance<br/>pip install matplotlib</span></pre><p id="1b50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我的<code class="fe ln lo lp lq b">Desktop</code>上，我创建了一个叫做<code class="fe ln lo lp lq b">plot_stock_price</code>的 Jupyter 笔记本。</p><p id="b695" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本笔记本:</p><ul class=""><li id="c614" class="na nb iq kh b ki kj kl km ko nc ks nd kw ne la nf ng nh ni bi translated">接受参数<code class="fe ln lo lp lq b">stock</code>，它是公司的股票代码(微软用<code class="fe ln lo lp lq b">MSFT</code>，特斯拉用<code class="fe ln lo lp lq b">TSLA</code>，Meta 用<code class="fe ln lo lp lq b">Meta</code>)，</li><li id="660e" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">提取一家公司的股票价格，</li><li id="2310" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">绘制图表，</li><li id="21a8" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">将图形导出为名为<code class="fe ln lo lp lq b">output_{stock}.png</code>的文件</li></ul><p id="f46c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是代码。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="5b34" class="oe ls iq lq b be of og l oh oi">import pandas<br/>import yfinance<br/>import matplotlib.pyplot as plt<br/><br/># selecting a stock ticker<br/>stock = 'MSFT' # This line is parameterized.<br/>stock_list = [stock]<br/><br/># downloading the stock<br/>stock_data = yfinance.download(stock,start="2021-10-01", end="2022-02-14")<br/>stock_data.head(5)<br/><br/># plot only the Opening price of ticket<br/>data = stock_data.loc[:,"Open"].copy()<br/><br/># Plot the data with matplotlib<br/>plt.style.use("seaborn")<br/>fig, ax = plt.subplots(1, figsize=(16,5))<br/>ax.plot(data)<br/><br/># Save the image as a PNG file<br/>fig.savefig(f'output_{stock}.png')<br/>print(f"Image saved to output_{stock}.png")</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi ow"><img src="../Images/51cd26cf85a9f46e4d988ea1adedc3ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6vbQWgw0UESSoRMnLvRYw.png"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi ow"><img src="../Images/062c711f4ca2866b553090f305255e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rfxZG-ymmFcydbzvTJJZNg.png"/></div></div></figure><p id="b20d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，再次打开您的终端并导航到您的桌面。(上面我提供了一些说明)。运行此命令。这告诉 papermill“使用参数<code class="fe ln lo lp lq b">stock='TSLA'</code>运行<code class="fe ln lo lp lq b">plot_stock_price.ipynb</code>，并将输出笔记本存储到<code class="fe ln lo lp lq b">output.ipynb</code>”。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="cb62" class="oe ls iq lq b be of og l oh oi">papermill plot_stock_price.ipynb output_TSLA.ipynb -p stock 'TSLA'   </span></pre><p id="03b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您应该在终端中看到类似这样的内容。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="4116" class="oe ls iq lq b be of og l ox oi">Input Notebook:  plot_stock_price.ipynb<br/>Output Notebook: output_TSLA.ipynb<br/>Executing:   0%|                                                                                                                                          | 0/8 [00:00&lt;?, ?cell/s]<br/>Executing notebook with kernel: python3<br/>Executing: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:04&lt;00:00,  1.81cell/s]</span></pre><p id="5dd3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，再次检查你的桌面。你应该会看到两个文件:<code class="fe ln lo lp lq b">output_TSLA.ipynb</code>和<code class="fe ln lo lp lq b">output_TSLA.png</code>。太好了，我们已经成功运行了参数化笔记本。</p><h1 id="29fe" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">4.在经过训练的机器上对不同数据集进行预测</h1><p id="42fc" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">下一个用例是我们熟悉的。</p><p id="e7ef" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你已经在笔记本上训练了你的机器学习算法。现在，您需要定期对新数据运行算法。</p><p id="419a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在运行这段代码之前，请安装以下软件包。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="4ccd" class="oe ls iq lq b be of og l oh oi">pip install scikit-learn<br/>pip install pandas<br/>pip install numpy</span></pre><p id="738c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我的<code class="fe ln lo lp lq b">Desktop</code>上，我创建了一个叫做<code class="fe ln lo lp lq b">predict_linear_regression</code>的 Jupyter 笔记本。</p><p id="4863" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个笔记本</p><ul class=""><li id="14c7" class="na nb iq kh b ki kj kl km ko nc ks nd kw ne la nf ng nh ni bi translated">基于模拟数据训练线性回归模型，</li><li id="cd7d" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">以输入文件(CSV)格式作为参数读入，</li><li id="208e" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">创建模拟输入，</li><li id="39b2" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">基于 CSV 文件中的输入进行预测，并且</li><li id="58c7" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">将预测导出为名为<code class="fe ln lo lp lq b">output_{stock}.png</code>的文件</li></ul><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="fa1b" class="oe ls iq lq b be of og l oh oi">import numpy as np<br/>from sklearn.linear_model import LinearRegression<br/>import pandas as pd<br/><br/>X = np.array([[1, 1], [1, 2], [2, 2], [2, 3]])<br/><br/># Convert the array X into a pandas dataframe<br/>train_df = pd.DataFrame(X, columns=['a', 'b'])<br/><br/># Create a new column 'y' with the formula y = 3 + a + 2*b <br/>np.random.seed(5)<br/>train_df['y'] = 3 + train_df['a'] + 2*train_df['b'] <br/><br/>reg = LinearRegression().fit(train_df.drop(columns=['y']), <br/>                             train_df['y'])<br/><br/># Create a mock input dataset <br/>X1 = np.array([[5, 3], [10, -4]])<br/>input_set1 = pd.DataFrame(X1, columns=['a', 'b'])<br/>input_set1.to_csv('input_set1.csv', index=False)<br/><br/># Create another mock input dataset<br/>X2 = np.array([[10, -1], [2, -6]])<br/>input_set2 = pd.DataFrame(X2, columns=['a', 'b'])<br/>input_set2.to_csv('input_set2.csv', index=False)<br/><br/># Make predictions on the mock input datasets<br/>input_name = 'input_set1.csv' # Parameterized<br/>output_name = 'output_set1.csv' # Parameterized<br/><br/># Read test input<br/>pred_df = pd.read_csv(input_name)<br/><br/># Make predictions <br/>pred_df['y_pred'] = reg.predict(pred_df)<br/><br/>pred_df.to_csv(output_name, index=False)</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi oy"><img src="../Images/24f3a8f8c84eaae0b6e2bc11006a08b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5tLViMJzCVP698aWioGo6A.png"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi oz"><img src="../Images/e8a4878fff6e59fb50ab4a5a7636a8fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vUklS31EKTkSL7V_k7cxTw.png"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="op oq di or bf os"><div class="gh gi pa"><img src="../Images/b40e2c59b81de50007efeca42e93d4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pxux0l_R3mEHc2Om9ASnQA.png"/></div></div></figure><p id="13eb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，再次打开您的终端并导航到您的桌面。(上面我提供了一些说明)。运行此命令。这告诉 papermill“使用参数输入名<code class="fe ln lo lp lq b">='input_set2.csv'</code>和输出名<code class="fe ln lo lp lq b">='output_set2.csv'</code>运行<code class="fe ln lo lp lq b">predict_linear_regression.ipynb</code>。最后，将输出笔记本存储到<code class="fe ln lo lp lq b">predict_output.ipynb</code>。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="52b2" class="oe ls iq lq b be of og l oh oi">papermill ./predict_linear_regression.ipynb ./predict_output2.ipynb -p input_name './input_set2.csv' -p output_name './output_set2.csv'<br/></span></pre><p id="6d18" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您应该在终端中看到类似这样的内容。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="5e00" class="oe ls iq lq b be of og l ox oi">Input Notebook:  ./predict_linear_regression.ipynb<br/>Output Notebook: ./predict_output2.ipynb<br/>Executing:   0%|                                                                                                                                         | 0/11 [00:00&lt;?, ?cell/s]Executing notebook with kernel: python3<br/>Executing: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:05&lt;00:00,  2.12cell/s]</span></pre><p id="9983" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，再次检查你的桌面。你应该看到两个文件:<code class="fe ln lo lp lq b">predict_output2.ipynb</code>和<code class="fe ln lo lp lq b">output_set2.csv</code>。很好，我们已经成功地为机器学习用例运行了一个参数化的笔记本。</p><h1 id="13ff" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">5.用 Papermill 做更多</h1><p id="a3ef" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">Papermill 还有更多有用的功能。这里我强调几个有趣的用法。</p><h2 id="37ea" class="mo ls iq bd lt mp mq dn lx mr ms dp mb ko mt mu md ks mv mw mf kw mx my mh mz bi translated">将笔记本电脑作为功能运行</h2><p id="4db3" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">你可以把笔记本作为一个函数来执行，而不是在终端中执行笔记本。这里有两个实现相同目标的备选方案。</p><p id="c76a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">备选方案 1:在终端中，导航到包含<code class="fe ln lo lp lq b">predict_linear_regression.ipynb</code>的目录。然后，运行命令</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="3d2c" class="oe ls iq lq b be of og l oh oi">papermill ./predict_linear_regression.ipynb ./predict_output2.ipynb -p input_name './input_set2.csv' -p output_name './output_set2.csv'</span></pre><p id="e29c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">备选方案 2:在 Jupyter 中，导航到包含<code class="fe ln lo lp lq b">predict_linear_regression.ipynb</code>的目录。在那里创建一个新的笔记本并运行命令。</p><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="4e07" class="oe ls iq lq b be of og l oh oi">import papermill as pm<br/><br/>pm.execute_notebook(<br/>   'predict_linear_regression.ipynb',<br/>   'predict_output2.ipynb',<br/>   parameters = {'input_name': './input_set2.csv', <br/>                 'output_name': './output_set2.csv')</span></pre><h2 id="c077" class="mo ls iq bd lt mp mq dn lx mr ms dp mb ko mt mu md ks mv mw mf kw mx my mh mz bi translated">将您的结果上传到亚马逊 S3 或云</h2><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="9a87" class="oe ls iq lq b be of og l oh oi">$ papermill predict_linear_regression.ipynb s3://bkt/output.ipynb -p alpha 0.6 -p l1_ratio 0.1</span></pre><h2 id="7a78" class="mo ls iq bd lt mp mq dn lx mr ms dp mb ko mt mu md ks mv mw mf kw mx my mh mz bi translated">提供一个. yml 文件，而不是参数</h2><pre class="lc ld le lf gt oa lq ob bn oc od bi"><span id="b534" class="oe ls iq lq b be of og l ox oi">$ papermill predict_linear_regression.ipynb s3://bkt/output.ipynb -f parameters.yaml</span></pre><h1 id="8f95" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">6.造纸厂的更多资源</h1><ul class=""><li id="4d45" class="na nb iq kh b ki mj kl mk ko oj ks ok kw ol la nf ng nh ni bi translated">网飞公布了他们如何使用 Papermill 自动执行笔记本日常数据分析和工程工作。</li><li id="523c" class="na nb iq kh b ki nj kl nk ko nl ks nm kw nn la nf ng nh ni bi translated">阅读<a class="ae pb" href="https://github.com/nteract/papermill" rel="noopener ugc nofollow" target="_blank">文档</a>以更清楚地了解它是如何工作的。</li></ul><p id="3dc4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博文中，我们学习了如何用 Papermill 参数化一个笔记本。这是优化数据科学工作流程的绝佳工具。试试看！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/8766fc83ab926fcf1e58fabd99f0fbfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*hjTLVRtHBlm9NAHmxxUZ3Q.jpeg"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">使用 Papermill，这样你的笔记本就可以放在适当的位置。</p></figure></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="750d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我是 Travis Tang，在 tech 工作的数据科学家。我在开源图书馆的 TowardsDataScience 上发表博文。每天，我都会在 LinkedIn 上发布数据科学技巧。关注我，获取更多定期更新。</p></div></div>    
</body>
</html>