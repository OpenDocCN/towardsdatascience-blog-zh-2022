<html>
<head>
<title>Explore More About Excel: Analysis Toolpak</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解有关 Excel 的更多信息:分析工具库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/explore-more-about-excel-analysis-toolpak-e6f8de2826#2022-02-17">https://towardsdatascience.com/explore-more-about-excel-analysis-toolpak-e6f8de2826#2022-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6158" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 Excel 进行更复杂的统计分析、回归、模拟和优化</h2></div><p id="dfdc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你以为 Excel 是微软的老软件，只能用来做很简单的分析吗？实际上，不是的，Excel 中还有很多大多数人不知道的更高级的特性。在本文中，我想向您介绍 Excel 中一个非常简单却非常强大的“插件”——分析工具库。</p><p id="d485" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，当我想对一小组数据及其结构进行 ANOVA 测试或简单的线性回归时，我想知道是否还需要使用 Python/R 并编写代码来进行分析。借助 Excel 中的“分析工具库”,我们可以方便快捷地实现大多数统计模型。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="4bbd" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">介绍</h2><p id="7ef9" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">这是一个非常简单的工具:1。它是完全免费的，内置在每个 Excel 中，所以你不需要下载或安装任何东西。2.它非常用户友好:使用这个特性，一些需要 Python/R 代码行的统计模型只需要简单的 3、4 次鼠标点击。3.它只需要非常基本的统计学知识，来自不同背景和领域的人可以很容易地使用它。</p><p id="0374" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同时，它非常强大:它有大约 20 个统计模型，包括假设检验、方差分析和回归。每次运行只需要不到 2 秒钟，它可以处理最多 100 万行数据。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="2935" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">逐步添加</h2><p id="86a9" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">打开一个 Excel &gt;“文件”&gt;“选项”&gt;“加载项”&gt;在“管理”框中，找到“Excel 加载项”并单击它</p><p id="4df2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">弹出一个对话框&gt;选择“分析工具库”并点击“确定”</p><p id="a959" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在顶部的“数据”选项卡中，最右侧的“数据分析”功能</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mg"><img src="../Images/2ffc1a34fa4ef4ce52bd0bfc7bfc30a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cSsoyoTRfp2X1pfM30zIHA.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">加载项步骤(图片由作者提供)</p></figure><p id="3fd2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在此功能中预览模型:</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/36ed11c9a72361138ac855ba94286d05.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*t8zF_eu1t3fWRCRc6lNEfA.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="edc9" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">个案研究</h2><p id="d1d6" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">现在让我们做一个小的案例研究，以便更好地理解如何使用“分析工具库”进行统计分析。</p><p id="dc23" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将使用<a class="ae mx" href="https://www.kaggle.com/grubenm/austin-weather" rel="noopener ugc nofollow" target="_blank">2014–2017 年美国奥斯汀的天气数据</a>来建立一个预测模型——使用前 5 天的温度来预测明天的天气。研究中使用的统计模型:描述性统计、方差分析、相关性和线性回归。你可以在我的 Github 上找到<a class="ae mx" href="https://github.com/brantgithub/TowardsDataScience/blob/master/ExcelAnalysisToolpak_weather_forecasting_trainingdata.xlsx" rel="noopener ugc nofollow" target="_blank">准备的数据集</a>和<a class="ae mx" href="https://github.com/brantgithub/TowardsDataScience/blob/master/ExcelAnalysisToolpak_weather_forecasting_solutions.xlsx" rel="noopener ugc nofollow" target="_blank">解决方案</a>。</p><p id="787d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="my">工作表“01 _ 按季度”</em> </strong></p><p id="d12e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在建立预测模型之前，我们需要了解不同时期的天气是否不同。一个常识是四个季节有不同的天气表现，所以首先让我们确定我们的数据是否在不同的季节有显著的不同。</p><p id="b3f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，让我们对我们的数据进行探索性数据分析。</p><p id="6ad3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击“数据分析”&gt;找到“<strong class="kh ir">描述性统计</strong>”，点击&gt;填写“输入范围”、“第一行标签”、“输出范围”和“汇总统计”&gt;点击“确定”</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/6ee6717a607983263a4d3f3dabb0ec50.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*lQGT68tY54KZH4YvGdsy3w.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">(图片由作者提供)</p></figure><p id="ad0f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从输出中，我们可以看到 4 个季节的平均温度和温度方差相差不大，所以我们感觉不同季节的天气差别不大。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi na"><img src="../Images/9c03e9982f63666049d5fe200bae7a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-pui9xkRiJTAmyfql2ivXA.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">描述性分析(图片由作者提供)</p></figure><p id="9578" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，这个 EDA 只能给我们一种“感觉”。如果我们想知道是否有统计学上的显著差异，我们应该使用 Anova 检验进一步分析。</p><p id="6351" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击“数据分析”&gt;查找“<strong class="kh ir">方差分析:单因素</strong>”并点击&gt;填写“输入范围”、“第一行标签”、“输出范围”&gt;点击“确定”</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/99e770e408e95da34e68f606ab5e68c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*pfTPiAfdGqmz2BE3hadYpA.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">(图片由作者提供)</p></figure><p id="9fa3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从输出中，我们可以看到 p 值&lt; alpha 0.05, which means there is statistically significant difference of temperature across different seasons.</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nc"><img src="../Images/c0175ebf174c0539bbf9cd6da2ab7a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_pWjxEiqHR4Dc4-HkM9GQ.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">(Image by Author)</p></figure><p id="0582" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Now, we know that 4 quarters have different weather, so we should build different prediction models for different seasons. In this article, we will only focus on building a model for Q3.</p><p id="547b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="my">工作表【02 _ 相关性】</em> </strong></p><p id="cb3b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">建立预测模型最常见、最简单的方法是回归。回归有预测值和输出变量。在回归之前，让我们首先确定哪些变量可能与我们的输出变量——明天的天气——潜在相关。</p><p id="1291" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击“数据分析”&gt;查找“<strong class="kh ir">相关性</strong>”，点击&gt;填写“输入范围”、“第一行标签”、“输出范围”&gt;点击“确定”</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/fb7e6daa88a234553e6c648fdbe6e6bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*i_qYs3Q6fOBGDD9iN2-W2Q.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">(图片由作者提供)</p></figure><p id="1f89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从输出-相关矩阵中，我们可以看到 T-3D、T-2D 和 T-D 与 T 具有中到高的相关性。我们可以使用前 3 天的天气来预测明天的天气。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/3126fb4a5881055b044d63f2532e49b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*L0mZGWSkd-OxG3kSC8-SAA.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">相关矩阵(图片由作者提供)</p></figure><p id="9111" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="my">工作表【03 _ 回归】</em> </strong></p><p id="13b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从相关性中知道，前三天的天气与明天的天气高度相关，所以让我们使用前三天作为预测因子来建立回归。</p><p id="5e8f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击“数据分析”&gt;找到“回归”并点击它&gt;填充“输入 Y 范围”、“输入 Y 范围”、“标签”、“输出范围”&gt;点击“确定”</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b92f36853e42cb58afe79ae06968dd7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*zzhyxHvlCjWWOUSLNd-NvQ.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">(图片由作者提供)</p></figure><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ng"><img src="../Images/1985f4f07b8953fb0968860656982416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPS9FwKHBM1t1rAxSRnF7Q.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">回归输出(图片由作者提供)</p></figure><p id="bd7f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从回归输出中，我们可以看到 1)。截距和所有 3 个预测因子的 p 值都小于α0.05，这意味着我们的截距和预测因子都是显著的。2).预测变量的截距值和系数。3).R 和调整后的 R 都是 0.66，这意味着预测值解释了我们输出变量中 66%的方差→一个好模型！</p><p id="5f54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用这个回归模型，我们可以用前三天的天气来预测明天的天气。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h2 id="5ad3" class="li lj iq bd lk ll lm dn ln lo lp dp lq ko lr ls lt ks lu lv lw kw lx ly lz ma bi translated">关键要点</h2><p id="97c3" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">在这篇文章中，我首先介绍了 Excel 中“分析工具库”的增强-----------------------------------------------------简单而又强大，然后我带您了解如何获得这一特性的步骤。最后我们做了一个案例研究，利用前三天的天气预报(描述性统计、方差分析、相关和回归)。</p><p id="4a4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过本文，您不仅可以发现该功能的魅力，还可以探索 Excel 隐藏的美丽。Excel 是一个经典的软件，但它绝对不会过时，它还有更多不为人知的强大功能等待我们去探索。是的，Python 或 R 或其他编程比 Excel 先进得多，但如果我们能以更简单、更快的方式实现同样的目标，为什么不呢？</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="da04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您对本文有任何疑问，请随时联系我！期待和大家一起聊聊用 Excel 做数据分析！🙋‍♂️</p></div></div>    
</body>
</html>