<html>
<head>
<title>4 Ways to Create a Multi-Page Streamlit App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建多页简化应用程序的4种方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-ways-to-create-a-multi-page-streamlit-app-1825b5b07c0f#2022-06-03">https://towardsdatascience.com/3-ways-to-create-a-multi-page-streamlit-app-1825b5b07c0f#2022-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1753" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Streamlit可能不是为成熟的网站设计的，但在一个应用程序中创建多个页面是相当简单的</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dc69b3513ee96e134002921cda8b75a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wfLMk9iBolBomrDhJ1hUMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6c2e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建多页面应用程序有两个方面:如何从用户界面中选择你想要的，以及如何选择要运行的代码。</p><p id="1652" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">UI可以是选项菜单、下拉菜单、按钮或其他UI元素。在这里，我们将使用侧边栏中的Streamlit <code class="fe lu lv lw lx b">selectbox</code>来选择运行应用程序的哪一部分。</p><p id="429f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了确定要运行哪些代码，我们将考察您可以自己实现的3种不同技术，以及Streamlit的多页面新的本机实现:</p><ul class=""><li id="b397" class="ly lz it la b lb lc le lf lh ma ll mb lp mc lt md me mf mg bi translated">使用select语句如<code class="fe lu lv lw lx b">if... else...</code>或3.10模式匹配来选择要显示的页面。这是最简单的方法，适用于少量页面。</li><li id="e395" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt md me mf mg bi translated">将应用程序构建为库包。一种更复杂的交付多页的方式，也很容易使用——只要遵循这个模式。</li><li id="816a" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt md me mf mg bi translated">一个应用程序库的通用启动器应用程序。这个启动器会自动获取存储在库中的应用程序，但仍然易于创建和使用。</li><li id="b2e0" class="ly lz it la b lb mh le mi lh mj ll mk lp ml lt md me mf mg bi translated">Streamlit本机方法</li></ul><h2 id="922b" class="mm mn it bd mo mp mq dn mr ms mt dp mu lh mv mw mx ll my mz na lp nb nc nd ne bi translated">书页</h2><p id="cd33" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">在每种情况下，我们将使用相同的两个代码块来显示来自Plotly中包含的Gapminder数据的关于一个国家或洲的数据。所以让我们先来看一下代码。</p><p id="0a5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先让我们得到数据:</p><pre class="kj kk kl km gt nk lx nl nm aw nn bi"><span id="4da8" class="mm mn it lx b gy no np l nq nr">df = pd.DataFrame(px.data.gapminder())</span></pre><p id="811d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的代码显示了两个图表，一个是一个国家的人均GDP，另一个是人口增长。数据在熊猫数据框<code class="fe lu lv lw lx b">df</code>中，我们首先从数据框中构建一个唯一的国家名称列表。然后从细流中选择国家<code class="fe lu lv lw lx b">selectbox</code>。然后，我们将图形分成两列，使它们并排出现。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="0b88" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一个代码块非常相似，但是显示了一个大陆上所有国家的数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="fdcd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，这两个代码块将成为我们的两个“页面”。对于这三种解决方案，我将向您展示框架并指出这些代码块的位置。</p><h2 id="9d7f" class="mm mn it bd mo mp mq dn mr ms mt dp mu lh mv mw mx ll my mz na lp nb nc nd ne bi translated">简单选择</h2><p id="6796" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">第一种技术非常简单，我们简单地使用一个<code class="fe lu lv lw lx b">if... else...</code>或Python 3.10 <code class="fe lu lv lw lx b">match</code>语句来选择要运行的代码。这非常简单，但可能更适合于少量的页面，比如我们在这里使用的两个页面。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="34e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个解决方案中，我们将页面定义为函数<code class="fe lu lv lw lx b">countryData()</code>和<code class="fe lu lv lw lx b">continentData()</code>，并将<code class="fe lu lv lw lx b">st.selectbox</code>放在<code class="fe lu lv lw lx b">st.sidebar</code>中，作为选择我们将运行哪个代码的机制。然后，我们简单地根据从<code class="fe lu lv lw lx b">st.selectbox</code>返回的值调用适当的函数。</p><p id="31d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您使用的是Python 3.10或更高版本，您可以用类似下面的<code class="fe lu lv lw lx b">match</code>语句替换<code class="fe lu lv lw lx b">if... else...</code>:</p><pre class="kj kk kl km gt nk lx nl nm aw nn bi"><span id="9a6f" class="mm mn it lx b gy no np l nq nr">match page:<br/>    case 'Country data': countryData()<br/>    case 'Continent data': continentData()</span></pre><p id="a98e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个结构更简洁一些，尤其是当你有超过两个页面的时候。</p><h2 id="37a1" class="mm mn it bd mo mp mq dn mr ms mt dp mu lh mv mw mx ll my mz na lp nb nc nd ne bi translated">实现为库</h2><p id="4e31" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">如果您有几个页面需要选择，那么将所有代码放在一个文件中会有点麻烦。更好的方法是使用Python包机制来保存可以导入到主程序中的函数。</p><p id="8181" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您需要做的第一件事是创建一个存放页面的文件夹，并将其配置为库。所以首先创建一个名为<code class="fe lu lv lw lx b">stlib</code>的子文件夹，然后在里面创建一个文件<code class="fe lu lv lw lx b">__init__.py</code>。这个文件可以是空的，它只需要将文件夹标记为库。</p><p id="db35" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在在子文件夹中再创建两个文件，一个用于国家数据页面，另一个用于洲数据页面。我们将这些文件称为<code class="fe lu lv lw lx b">countryData.py</code>和<code class="fe lu lv lw lx b">continentData.py</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="d29b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">主代码编码为一个名为<code class="fe lu lv lw lx b">run()</code>的函数。它可以被命名为任何名称，但是它有助于使用一个标准名称来调用函数，我们将在后面看到。</p><p id="4c54" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一个<code class="fe lu lv lw lx b">if</code>语句是可选的，但是如果你包含它，你可以将模块作为独立程序运行。</p><p id="eee2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们已经将“页面”实现为Python模块，我们可以导入它们并为每个调用<code class="fe lu lv lw lx b">run()</code>函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h2 id="aa83" class="mm mn it bd mo mp mq dn mr ms mt dp mu lh mv mw mx ll my mz na lp nb nc nd ne bi translated">通用解决方案</h2><p id="0803" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">库的方法非常吸引人，因为这意味着我们可以将“页面”的功能转移到函数库。然而，我们可以更进一步，将模块信息存储在一个外部文件(在库中)中，并构建一个通用的“主”程序，该程序将读取该文件，构建选择菜单并调用任何可用的模块。</p><p id="af1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先要做的是在library文件夹中创建一个包含可用模块列表的文件。我称之为<code class="fe lu lv lw lx b">libContents.py</code>，它看起来像这样:</p><pre class="kj kk kl km gt nk lx nl nm aw nn bi"><span id="18c4" class="mm mn it lx b gy no np l nq nr"><em class="nu"># Return a list of the modules in this package</em><br/>    def packages():<br/>        return ['countryData','continentData']</span></pre><p id="6202" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个以列表形式返回模块名称的函数。</p><p id="ae4f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个解决方案中的代码要多一点，但是更加灵活，您只需要编写一次。</p><p id="2422" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">代码如下所示，首先要注意的是我们显式地导入了<code class="fe lu lv lw lx b">libContents</code>，然后我们声明了保存模块列表(名称、描述和模块引用)的全局数组。<code class="fe lu lv lw lx b">moduleNames</code>是直接从<code class="fe lu lv lw lx b">libContents</code>分配的，其他的我们会在后面的循环中处理。第一件事是使用<code class="fe lu lv lw lx b">importlib.import_module</code>从名字中获取模块引用。然后我们在一个全局字符串<code class="fe lu lv lw lx b">description</code>中寻找模块的描述。如果存在，我们将其存储在<code class="fe lu lv lw lx b">descriptions</code>列表中，否则，我们存储模块名称。</p><p id="39f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着模块现在可以包含如下描述:</p><pre class="kj kk kl km gt nk lx nl nm aw nn bi"><span id="5d1c" class="mm mn it lx b gy no np l nq nr">description = "Continent Data"</span><span id="061e" class="mm mn it lx b gy nv np l nq nr">def run():<br/>    import streamlit as st</span><span id="8c2f" class="mm mn it lx b gy nv np l nq nr">    <em class="nu"># etc.</em></span></pre><p id="2e40" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这不是强制性的，但如果有，它将在下拉菜单中使用。</p><p id="530a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用<code class="fe lu lv lw lx b">st.selectbox</code>中的描述。这与我们之前看到的类似，但是它使用一个函数来定义显示的文本，而不是传递给它的实际值(这非常简洁)。</p><p id="aadc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此函数<code class="fe lu lv lw lx b">format_func(name)</code>获取模块的名称，在<code class="fe lu lv lw lx b">moduleNames</code>列表中找到它的索引，然后使用这个索引来选择要为<code class="fe lu lv lw lx b">descriptions</code>列表显示的正确文本。</p><p id="6b8c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一行</p><pre class="kj kk kl km gt nk lx nl nm aw nn bi"><span id="1345" class="mm mn it lx b gy no np l nq nr">modules[moduleNames.index(page)].run()</span></pre><p id="baf1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过检索模块引用，再次通过使用模块名称的索引来运行选定的模块。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h2 id="5765" class="mm mn it bd mo mp mq dn mr ms mt dp mu lh mv mw mx ll my mz na lp nb nc nd ne bi translated">Streamlit本机方法</h2><p id="7cde" class="pw-post-body-paragraph ky kz it la b lb nf ju ld le ng jx lg lh nh lj lk ll ni ln lo lp nj lr ls lt im bi translated">在我写这篇文章的几个小时内，Streamlit宣布了一个简单易用的原生多页面特性。</p><p id="dbbe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你需要把你的应用组织成一个文件层次结构。在你的主目录中必须有一个主文件，它是应用程序的入口点。必须有一个名为“页面”的子文件夹。你把附加的页面文件放在这个子文件夹中，主程序会自动把它们捡起来并显示在侧边栏中。选择其中一个条目将加载该页面。简单！</p><p id="8b4a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是这个实现的完整代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="22d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们做到了！三…不，四，在Streamlit中实现多页面应用的方法。第一个简单，第二个更适合更多页面，第三个是可以在任何应用程序中重用的通用解决方案，第四个是由Streamlit新提供的非常简单的解决方案。</p><p id="b449" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然Streamlit版本很简单(尽管，在撰写本文时，它似乎在Python 3.10中不起作用)，但我最喜欢的解决方案是第三个，因为一旦编写了主函数，这个解决方案就像原生解决方案一样容易使用，但更灵活，因为可以添加描述，并且顺序由作者决定(Streamlit按字母顺序排序)。它还可以进一步定制。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="d9d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读，我希望这是有用的。如果你发现任何错误，有任何建议，或者只是想说声“你好”，请留下你的评论。</p><p id="367e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在我的<a class="ae od" rel="noopener ugc nofollow" target="_blank" href="/alanjones2.github.io"> Github页面</a>上找到这篇文章和我其他作品的代码</p><div class="oe of gp gr og oh"><a href="https://alanjones2.github.io" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">AlanJones:编码、科学和技术</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">使用Streamlit、Plotly、Python和Flask为web构建数据可视化应用程序。适用于…的文章、教程和应用程序</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">alanjones2.github.io</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div><p id="5cce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在Substack 上订阅我偶尔发的<a class="ae od" rel="noopener ugc nofollow" target="_blank" href="/technofile.substack.com">时事通讯。</a></p><div class="oe of gp gr og oh"><a href="https://technofile.substack.com" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">技术文件</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">技术、科学、数据科学和编码。点击阅读阿兰·琼斯的技术文件，这是一个子堆栈出版物，包含…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">technofile.substack.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov ks oh"/></div></div></a></div></div></div>    
</body>
</html>