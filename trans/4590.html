<html>
<head>
<title>12 Essential Visualizations and How to Implement Them - Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">12个基本的可视化以及如何实现它们——第1部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/12-essential-visualizations-and-how-to-implement-them-part-1-41e40400a740#2022-10-12">https://towardsdatascience.com/12-essential-visualizations-and-how-to-implement-them-part-1-41e40400a740#2022-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="86c5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们看看如何用Python、Matplotlib和Streamlit创建12个最有用的图形和图表</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5d6adcc274a7cb3187a27e247b317b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-AEuGtwEkiVkFeUUf_yaA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马体·米罗什尼琴科的照片</p></figure><blockquote class="kz"><p id="ca6e" class="la lb it bd lc ld le lf lg lh li lj dk translated"><em class="lk">“当我回顾过去一年为研讨会和咨询项目创作的150多幅视觉作品时，我只使用了十几种不同类型的视觉作品”，</em> Cole Nussbaumer Knaflic用数据讲述故事</p></blockquote><p id="5df7" class="pw-post-body-paragraph ll lm it ln b lo lp ju lq lr ls jx lt lu lv lw lx ly lz ma mb mc md me mf lj im bi translated">许多人都读过科尔·努斯鲍默·克纳弗里克(Cole Nussbaumer Knaflic)的书《用数据讲述T4》，根据这本书的前言，克纳弗里克“在这个星球上一些最受数据驱动的组织工作过”，在谷歌教授数据可视化已经有几年了，现在她已经创建了自己的教学公司。</p><p id="b761" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这本书致力于描述如何使用图表和图形进行有效的交流，并提供了大量关于用图形进行交流的许多方面的信息。</p><p id="dc46" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">但是你在书中学到的第一件事是，作者只依赖12种不同类型的可视化。这本书描述了这些视觉效果和它们的用途，但没有深入到实现中，所以这就是我们在这里要做的。</p><p id="29fd" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">本文的目的是开始描述12种视觉效果，并展示如何用Python实现它们。本文中使用的所有代码和数据都可以从我的Github页面下载。(可下载的代码还可能包含本文中没有包含的其他示例。)</p><p id="5a39" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">本文将着眼于前6种视觉效果:简单的文本、表格、热图、散点图、线图和坡度图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/9cd485c5abd9741ddaa7ce834c1b66f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hZg9NB8-axf-76hy.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">六种视觉效果——作者图片</p></figure><p id="3dcd" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">我将在后续文章中处理剩余的图表。这些将是，垂直和水平条形图，垂直和水平堆积条形图，瀑布图和方形面积图。</p><h1 id="0601" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">1.简单文本</h1><p id="6a17" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">正如科尔·努斯鲍默·克纳弗里克(CNK，从现在开始)告诉我们的，有时候，图形并不是必要的，甚至不是交流数据的最佳选择。当只呈现几个值时，简单的文本就可以了，甚至可能比图表更好。我们举个例子。</p><p id="0702" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">英国伦敦的天气在夏天似乎越来越热。2022年7月最高气温27.2摄氏度，对英国来说相当炎热。2012年是24.2度。</p><p id="8a74" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">我们将设计一个视觉传达这种仅由文本组成的增加，我们将看到许多不同的设计效果如何。</p><p id="bc41" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">首先，让我们设置一些代表伦敦这两年最高气温的变量和一些标题。然后我们会用不同的格式展示它们。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="e11e" class="np mo it nl b be nq nr l ns nt"># Set up variables<br/>years = ['2012','2022']<br/>temps = [24.2,27.2]<br/>caption = f"The maximum temperature in July 2022 was {temps[1]}°C"<br/>caption2 =  f"That's {temps[1]-temps[0]}° up from 2012"</span></pre><p id="a577" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">现在，看看下面的条形图——它显示了使用我们刚刚设置的日期从2012年到2022年的温度变化。但是，虽然很明显温度上升了几度，但你不能确切地看到多少或确切地说这些温度是多少。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/6d467d998583fb4bbe4d245aec7e9bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DS7DzLa_Dzhy5kYW.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="62fd" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">条形图并不适合呈现这类数据，因此，让我们看看一些纯文本的视觉效果如何让我们更好地了解正在发生的事情。</p><p id="2ab0" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">Streamlit为我们提供了一种很有吸引力的方法来显示两个值以及它们之间的变化。这为我们提供了一种显示相同数据的吸引人且有效的方式，并且编码非常简单，如下所示:</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="34a2" class="np mo it nl b be nq nr l ns nt">col3.metric("Temperature", temps[1],temps[0])</span></pre><p id="4e4f" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">如果我们将它与一些说明性的文字结合起来，并使用一个列布局，我们可以实现一个直观的形象，告诉我们到底发生了什么，而不需要任何形式的图表。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="6a71" class="np mo it nl b be nq nr l ns nt">col3, col4 = st.columns([1,4])<br/>col3.metric("Temperature", temps[1],temps[0])<br/>col4.markdown(f"#### {caption}")<br/>col4.markdown(caption2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/60e0d028887eb175cd38485a39acd302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rDRW0ADS6lZ8kPdL.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="62f2" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这种视觉效果提供了与条形图相同的数据，但实际上比图表传达得更好。</p><p id="8bba" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">使用markdown，您可以获得类似的结果，如下所示:</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="3294" class="np mo it nl b be nq nr l ns nt">col1, col2 = st.columns([1,4])<br/>col1.markdown(f"# {temps[1]}")<br/>col2.markdown(f"#### {caption}")<br/>col2.markdown(caption2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/53ea91e4d55926784d5de9a6e42c94ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JdQSuuIvo0aYDs4D.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="6916" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这两种方法是Streamlit特有的。另一种更通用的Python方法是在Matplotlib图表中定位文本。下面的代码就是这样做的。</p><p id="1d99" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">您可以看到，我们创建了一个Mathplotlib图表，但其中没有绘制任何图形——我们只是将文本放置在正确的位置，并关闭轴、刻度等。用语句<code class="fe nv nw nx nl b">ax2.axis('off')</code>。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="3950" class="np mo it nl b be nq nr l ns nt">fig2, ax2 = plt.subplots(figsize=(5,1))<br/>ax2.text(0, 0.9, temps[1],<br/>        verticalalignment='top', horizontalalignment='left',<br/>        color='red', fontsize=18, fontweight = 'bold')<br/>ax2.text(0.2, 0.9, caption,<br/>        verticalalignment='top', horizontalalignment='left',<br/>        color='Black', fontsize=10)<br/>ax2.text(0.2, 0.55, caption2,<br/>        verticalalignment='top', horizontalalignment='left',<br/>        color='darkgrey', fontsize=6)<br/>ax2.axis('off')<br/>st.pyplot(fig2)</span></pre><p id="29ca" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这给了我们下图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/306b0288f3e17cf5825d21e528065804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/0*H4MO3uKugq3DI8zZ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="a25a" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这比其他两种方法更大胆和引人注目，但是，当然，如果我们愿意，我们可以通过改变字体大小、颜色和文本的位置来制作一个更微妙的小图形。</p><h1 id="b4a0" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">2.桌子</h1><p id="2898" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">CNK告诉我们，表格是向不同的受众显示数据的合适的视觉工具，每个受众可能对特定的行感兴趣。她还建议，我们应该让数据成为关注的中心，所以不应该让表格边框太重，而应该使用浅色边框或空白来分隔数据项。</p><p id="b122" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">Streamlit为我们提供了两种显示表格的方法，<code class="fe nv nw nx nl b">st.table()</code>和<code class="fe nv nw nx nl b">st.dataframe()</code>。</p><p id="7088" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">使用与上一个示例相同的数据，下面是将数据显示为表格的代码。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="2fc8" class="np mo it nl b be nq nr l ns nt">import streamlit as st<br/>import pandas as pd<br/><br/>temps = pd.DataFrame()<br/>temps['Year'] = ('2012', '2022')<br/>temps['Temperature'] = (24.2,27.2)<br/><br/>st.subheader("st.table")<br/>st.table(temps)</span></pre><p id="a689" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/6e30b2e4ecffa662a2385310b8176ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xwvJ4-ZRa9L54DiS.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="32ea" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">如果你喜欢的表格太宽了，那么把它放在一个栏里，然后把这个栏调整到你想要的宽度就很简单了。</p><p id="e87e" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">数据帧非常相似:</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="19f8" class="np mo it nl b be nq nr l ns nt">st.dataframe(temps)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/77571f1074a3a6e9ac9f72872c0aa4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/0*B-gebMeflupXfZIz.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="645d" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">单击数据框的列标题将按该列对数据框进行排序。</p><p id="88a9" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">同样，这些是特定于Streamlit的方法。用Mathplotlib显示一个表格是可能的，但是它实际上是被设计成一个图表的附加物。我在Matplotlib中尝试了各种形式的表格，但对结果都不太满意。因此，我不确定这是否为独立的Python程序提供了合适的解决方案。</p><p id="3246" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">但是，如果您没有使用Streamlit，那么作为一名数据科学家，您可能会使用Jupyter笔记本，它们可以非常简洁地呈现数据帧，例如，您只需在Jupyter单元格中写下数据帧的名称:</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="d732" class="np mo it nl b be nq nr l ns nt">import pandas as pd<br/><br/>temps = pd.DataFrame()<br/>temps['Year'] = ('2012', '2022')<br/>temps['Temperature'] = (24.2,27.2)<br/>temps</span></pre><p id="2aa6" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">它是这样呈现的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/90b2563dcda64fb627797fb91c595058.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/0*Ei3FYNZvE7NybQnb.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><h1 id="d850" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">3.热图</h1><p id="101e" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">热图是一种使用颜色而不是数字来突出表格中数值差异的图形。</p><p id="92f1" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">我们将看看热图的一个非常合适的用途——我们想要显示热量的增加！嗯，温度，真的。</p><p id="cbe3" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">下图显示了过去150年左右的相对全球温度，摘自我的文章<a class="ae ky" rel="noopener" target="_blank" href="/topical-plots-global-warming-6b5fb80a0371">专题图:全球变暖热图</a>。(我在这里使用的数据包含在可下载的代码中，可以免费使用——参见注释2)。</p><p id="a015" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">热图是展示过去几十年全球变暖趋势的绝佳工具。随着时间的推移，你可以很容易地看到颜色变浅，这意味着气温上升。(当然，这些数据不是绝对温度，而是相对于1961年至1990年期间的温度。)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/2cdfeb854930705b9ecb4dc2c9c95e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3UAfqD5sDExxJ2Fc.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="ef18" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">创建热图最简单的方法之一是使用Seaborn库。从下面的代码中可以看到，Seaborn只是将Pandas数据帧作为参数，并将相应的地图显示为matplotlib图表。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="cde5" class="np mo it nl b be nq nr l ns nt">import streamlit as st<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/>url='data/bydecade.csv'<br/>gwdec = pd.read_csv(url)<br/>gwdec=gwdec.set_index('Year')<br/>st.table(gwdec)<br/><br/>import seaborn as sns<br/>fig, ax = plt.subplots()<br/>sns.heatmap(gwdec)<br/>st.pyplot(fig)</span></pre><p id="fbd8" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">您可以使用matplotlib中的<code class="fe nv nw nx nl b">imshow()</code>函数来实现类似的图表(参见可下载代码中的示例)。</p><h1 id="2447" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">4.散点图</h1><p id="820e" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">散点图用于显示两个变量之间的关系。下面的例子使用了一个数据文件，该文件记录了2018年伦敦每个月的天气数据(见注4)。它绘制了以毫米为单位的降雨量与日照时数的关系。</p><p id="a546" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">当然，当下雨的时候，太阳通常是不发光的，所以当下雨的时候，你会看到更少的日照时间。散点图清楚地显示了这种关系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/cb96af6a6fc19f9f2c4ec52086f4e07e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*drTrQPbNSeK1wHoL.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="3223" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">下面的代码使用Matplotlib散点图来创建图表。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="d76a" class="np mo it nl b be nq nr l ns nt">import streamlit as st<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/>weather =  pd.read_csv('data/london2018.csv')<br/>fig, ax = plt.subplots()<br/>weather.plot.scatter(x='Rain', y='Sun', ax=ax)<br/>st.pyplot(fig)</span></pre><h1 id="0f91" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">5.线条</h1><p id="cbd7" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">折线图用于连续数据，通常也用于时间序列数据。</p><p id="adb6" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">使用与上面相同的天气数据，我们将看三个不同的线图。</p><p id="4b63" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">首先，我们将绘制一年中的平均温度，然后我们将看看如何通过绘制平均、最高和最低温度将多幅图放在同一个图中。最后，在第三个图表中，我们将看到如何通过绘制平均温度并在周围加上阴影来显示该平均值周围的最大值和最小值范围，从而显示一系列值，您可以使用相同的技术来显示置信水平。</p><p id="4a01" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">首先，我们读取数据。它包含各种温度、日照时间和降雨量的每月读数。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="5e39" class="np mo it nl b be nq nr l ns nt">weather =  pd.read_csv('data/london2018.csv')<br/>weather['Tmean'] = (weather['Tmax'] + weather['Tmin'])/2</span></pre><p id="f10a" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/eccab7a6c53ad0daa5fc4e6f24fc1f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f1AeBoEChdTK-PoG.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="0c53" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">它最初没有<em class="mg"> mean </em>列——我们在上面的第二行代码中创建了它。</p><p id="8a08" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">现在，简单的线图。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="b255" class="np mo it nl b be nq nr l ns nt">fig, ax = plt.subplots()<br/>ax = weather.plot.line(x='Month', y = 'Tmean', ax=ax)<br/>st.pyplot(fig)</span></pre><p id="9555" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">使用Pandas和Matplotlib绘制的非常简单的平均温度线图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/d45be3ea4974c888619545722cf9ab41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H-UAQ9cckfgI-HLx.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="1ac9" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">在同一个图中创建多个图只是为这些图创建新的轴。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="1bce" class="np mo it nl b be nq nr l ns nt">ax = weather.plot.line(x='Month', y = 'Tmax', color = 'lightgrey', ax=ax)<br/>ax = weather.plot.line(x='Month', y = 'Tmin',  color = 'lightgrey', ax=ax)<br/>st.pyplot(fig)</span></pre><p id="b5d3" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">上面的代码为最低和最高温度增加了两个轴——我将这两个轴与<em class="mg">平均值</em>图进行了不同的着色——然后重新绘制了该图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f6d7d6d043a6a85745bf08146cccf72f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eV9P-mp5qT2-Q5Rv.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="8741" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">你可以看到，这给了我们一个范围，但我们可以使它在视觉上更具吸引力，更好地传达一个范围的想法，通过阴影的最大和最小线之间的区域。</p><p id="5669" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">我们使用Matplotlib函数<code class="fe nv nw nx nl b">fill_between()</code>如下所示:</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="e3ea" class="np mo it nl b be nq nr l ns nt">plt.fill_between(weather['Month'], <br/>                 weather['Tmax'],<br/>                 weather['Tmin'], color='lightgrey', alpha=0.5)<br/>ax.get_legend().set_visible(False)<br/>ax.set_ylabel('Temperature Range °C')</span></pre><p id="a796" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">填充颜色设置为<code class="fe nv nw nx nl b">lightgrey</code>,因此它混合了上下图。我还隐藏了图例，并给y轴加了一个标签，以显示我们试图表示的内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/48e696803cb329df23dfd336b8d257d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7TXwtrlFiiKZVJuF.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="0ce2" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">正如你所看到的，这也是一个非常合适的信心水平表示。例如，您可以使用原始图的固定百分比来创建上图和下图。因此，举例来说，上面的图线可以取中间值加5%的值，下面的图线取中间值减5%的值。</p><h1 id="bd3f" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">6.斯洛佩格拉夫</h1><p id="0f16" class="pw-post-body-paragraph ll lm it ln b lo nf ju lq lr ng jx lt lu nh lw lx ly ni ma mb mc nj me mf lj im bi translated">斜率图只是一个符合特定样式的线图，但只比较两组值。</p><p id="09cf" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">根据CNK的说法，“当你有两个时间段或比较点，并想快速显示相对增加和减少时，斜率图会很有用”。</p><p id="c07d" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">不幸的是，slopegraph在标准的可视化库中并不常见。你可以简单地用线图来代替，它应该传达同样的意思。我们将这样做，但也通过结合线图和散点图并添加适当定位的文本来创建一个更典型的斜率图。</p><p id="c7fb" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">继续我们的天气主题，我将创建两个图表来显示我们在上面的文字图中看到的温度变化，但这次我们将伦敦与苏格兰的威克进行比较:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/f06fe13ae3ccb285d6feff383bd08324.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BCSEmcUAWsOiCN_R.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="3ba3" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这个数据代表了两个城市在不同年份的最高温度。在下面的代码中，我们在同一个图中绘制了两个图。第一个是数据的简单线图，然后我们叠加一个只有四个点的散点图，以给出斜率图线末端的原型斑点。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="72a9" class="np mo it nl b be nq nr l ns nt">import streamlit as st<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/>st.header("Slope graph")<br/>st.subheader("Here is the data")<br/><br/>df = pd.DataFrame()<br/>df['year']=[2012,2022]<br/>df['London']=(24.2,27.2)<br/>df['Wick']=(14.8,17.3)<br/>st.table(df)<br/><br/>st.subheader("A Slopegraph as a line graph")<br/>fig, ax = plt.subplots()<br/>ax = df.plot(x='year', color = ('red', 'blue'), ax=ax)<br/>ax = df.plot.scatter(x='year',y='London', color= 'red', ax=ax)<br/>df.plot.scatter(x='year',y='Wick', color = 'blue', ax=ax)<br/>plt.xlim(2010,2024)<br/>plt.xticks(df['year'])<br/>ax.set_ylabel('')<br/>st.pyplot(fig)</span></pre><p id="38d3" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">我在这里做的是绘制线条，然后使用散点图在线的末端叠加斑点。我还设置了记号，只显示我们感兴趣的两年，并调整了x轴的限制，在图的两边留出一些间距。这些调整中的每一项都使线形图更像斜率图。</p><p id="6e81" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">它看起来还不错，但不是斜率表的典型形式，当然也不是CNK书中描述的那种形式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/d6ff2d77d03b529be8d65f96ee958b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*28WXzeaOUd21lBXJ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="7370" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">为了制作一个更传统的CNK风格的斜坡图，我们需要用Matplotlib做一些操作。</p><p id="29c1" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这是CNK在书中的渲染类型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/931b27090ba3cdb07edb62803e00e590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Duku_DEFXK6OTse2.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="lk">作者图片</em></p></figure><p id="57d0" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">它不同于传统的折线图，因为y值和图例文本被写在线的末端，而传统的轴被移除。</p><p id="0514" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">运行这段代码将会显示上面的图表。</p><pre class="kj kk kl km gt nk nl nm bn nn no bi"><span id="2e19" class="np mo it nl b be nq nr l ns nt">ax.text(df.year[0] -5, df.London[0], df.columns[1])<br/>ax.text(df.year[0] -2.5,df.London[0], f'{df.London[0]}°C')<br/>ax.text(df.year[1] +1, df.London[1],f'{df.London[1]}°C')<br/>ax.text(df.year[0] -5, df.Wick[0], df.columns[2])<br/>ax.text(df.year[0] -2.5, df.Wick[0],f'{df.Wick[0]}°C')<br/>ax.text(df.year[1] +1, df.Wick[1],f'{df.Wick[1]}°C')<br/><br/>ax.spines['right'].set_visible(False)<br/>ax.spines['left'].set_visible(False)<br/>ax.spines['bottom'].set_visible(False)<br/>ax.spines['top'].set_visible(False)<br/><br/>ax.xaxis.grid(visible=True, color = 'black')<br/>ax.get_yaxis().set_visible(False)<br/><br/>ax.get_legend().set_visible(False)<br/><br/>st.pyplot(fig)</span></pre><p id="8608" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">前六行将文本和值添加到行尾，接下来我们移除样条线(图表的框架),然后我们添加x轴网格，这为我们提供了垂直线。最后，我们隐藏了这个传说。</p><p id="da9b" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">对于一个没什么不同的结果来说，这是不是太多的努力了？我会让你决定。</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><p id="f313" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">这是CNK书中的前6个视觉效果，以及它们是如何实现的——我希望你会觉得有用。</p><p id="da17" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">你可以阅读第二部分，解决接下来的6个视觉效果。这里:</p><div class="or os gp gr ot ou"><a rel="noopener follow" target="_blank" href="/12-essential-visualizations-and-how-to-implement-them-part-2-e47c1d4b9784"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">12个基本的可视化以及如何实现它们，第2部分</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">我们看看如何用Python和Streamlit创建12个最有用的图形和图表</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">towardsdatascience.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ks ou"/></div></div></a></div><p id="857b" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">您可以从我的Github资源库下载所有代码和数据文件。在我的<a class="ae ky" href="http://alanjones2.github.io" rel="noopener ugc nofollow" target="_blank">网页</a>上找到它的链接，以及其他文章的信息。</p><p id="a8ff" class="pw-post-body-paragraph ll lm it ln b lo mh ju lq lr mi jx lt lu mj lw lx ly mk ma mb mc ml me mf lj im bi translated">如果你想了解我发表的其他文章，你可以在Medium上关注我，或者在<a class="ae ky" href="http://technofile.substack.com" rel="noopener ugc nofollow" target="_blank"> Substack </a>上订阅我的时事通讯。</p><div class="or os gp gr ot ou"><a href="https://medium.com/membership/@alan-jones" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">通过我的推荐链接-阿兰·琼斯加入媒体</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">阅读阿兰·琼斯的每一个故事(以及媒体上成千上万的其他作家)。你的会员费直接支持艾伦…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">medium.com</p></div></div><div class="pd l"><div class="pj l pf pg ph pd pi ks ou"/></div></div></a></div><h1 id="2fae" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">笔记</h1><ol class=""><li id="4cf6" class="pk pl it ln b lo nf lr ng lu pm ly pn mc po lj pp pq pr ps bi translated"><a class="ae ky" href="https://amzn.to/3dJlMaS" rel="noopener ugc nofollow" target="_blank"> <em class="mg">《用数据讲故事》，商业人士数据可视化指南</em> </a>，科尔·努斯鲍默·克纳弗利奇，威利，2015年(附属链接*)</li><li id="6dfc" class="pk pl it ln b lo pt lr pu lu pv ly pw mc px lj pp pq pr ps bi translated">全球温度数据包含在可下载的代码中，并来自HadCRUT数据集，该数据集跟踪自19世纪后期以来的温度变化。你可以从英国气象局哈德利中心下载它的版本，<a class="ae ky" href="https://www.metoffice.gov.uk/hadobs/hadcrut5/data/current/download.html" rel="noopener ugc nofollow" target="_blank">根据<a class="ae ky" href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="noopener ugc nofollow" target="_blank">开放政府许可v3 </a>免费下载</a>页面(也见下面的注释3)。</li><li id="a5dc" class="pk pl it ln b lo pt lr pu lu pv ly pw mc px lj pp pq pr ps bi translated"><a class="ae ky" href="https://www.metoffice.gov.uk/hadobs/hadcrut4/HadCRUT4_accepted.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="mg">使用观测估计集合量化全球和区域温度变化的不确定性:HadCRUT4数据集</em> </a>，Colin P. Morice，John J. Kennedy，Nick A. Rayner和Phil D. Jones</li><li id="c042" class="pk pl it ln b lo pt lr pu lu pv ly pw mc px lj pp pq pr ps bi translated">天气数据来源于英国气象局的文本数据，在这里<a class="ae ky" href="https://www.metoffice.gov.uk/research/climate/maps-and-data/historic-station-data" rel="noopener ugc nofollow" target="_blank">找到</a>。该数据根据<a class="ae ky" href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="noopener ugc nofollow" target="_blank">开放政府许可v3 </a>发布，并可在相同条件下使用。</li></ol><ul class=""><li id="57e3" class="pk pl it ln b lo mh lr mi lu py ly pz mc qa lj qb pq pr ps bi translated"><em class="mg">如果你通过代销商链接购物，我可能会得到佣金。不会影响你付出的代价。</em></li></ul></div></div>    
</body>
</html>