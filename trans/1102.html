<html>
<head>
<title>SAP Querying Intelligent Robot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SAP 查询智能机器人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sap-querying-intelligent-robot-12a4e301e876#2022-03-21">https://towardsdatascience.com/sap-querying-intelligent-robot-12a4e301e876#2022-03-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b113" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用 SQUIR 自动提取 SAP 的表</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/804cc01dd0a73f7391a920df37571340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_5nqIa9S3V7VQUYHTavEZw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用机器人为重要的任务保存你的能量</p></figure><p id="bbcb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您是否经常运行 SE16N 事务来从 SAP 中提取表格？如果你想自动化，你可以在这里找到解决方案。Squir (SAP 查询智能机器人)是一个独立的应用程序。该程序由 Python，一个用于参数选择的 Excel 模板，以及机器人需要与之交互的截图组成。多亏了 Pyinstaller，即使您的非 Pythonist 爱好者同事也可以轻松地使用该应用程序从 SAP 中自动导出表格。Squir 可以做重复无聊的事情，这样你就可以专注于更重要的任务。</p><p id="aed8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">解决方案:</strong></p><p id="0935" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在之前的帖子中，我们学习了如何使用 Pyautogui 构建 RPA 来自动化重复性任务:</p><div class="lu lv gp gr lw lx"><a rel="noopener follow" target="_blank" href="/let-the-bot-automate-your-data-processing-e6ef26959d65"><div class="ly ab fo"><div class="lz ab ma cl cj mb"><h2 class="bd iu gy z fp mc fr fs md fu fw is bi translated">让机器人自动处理你的数据</h2><div class="me l"><h3 class="bd b gy z fp mc fr fs md fu fw dk translated">使用 RPA、PyAutoGui 和 Pandas 来避免在 SAP 和您的数据仓库中进行重复的手动工作</h3></div><div class="mf l"><p class="bd b dl z fp mc fr fs md fu fw dk translated">towardsdatascience.com</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml ks lx"/></div></div></a></div><p id="74a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将对上面的代码做一个改进。不设置静态计时:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="77a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">...我们将用一种更动态的方法取代静态计时器。机器人将不断筛选，一旦图像弹出，例如在 20 秒的循环内，机器人将立即与该对象进行交互:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="7646" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们为 Squir 提供所有必要的截图。例如，要在 SAP 中运行 SE16N，必须找到此按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/fcaec668e1726f6beeaa7941f89f5347.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*TTGAJt0CCcuj96CD1JKNqQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Squir 需要查找的事务。</p></figure><p id="c4cb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，Squir 必须在该选择字段中输入所需的表名:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/c69bfa73d84c44c4aaac8a3458b95a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mi02Y8TGSqpQGUnbyik8vw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Squir 必须键入表格的名称，例如 MARC</p></figure><p id="51ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后 Squir 会将结果导出为 txt:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/4c5d8ef77d8a82a8b54fd0c3b73a92e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*748YyyK7BO4tt21tsW5aBg.png"/></div></figure><p id="49ef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正是像 OpenCV 这样的包让机器人变得如此迷人！你可以在我的 Github 里找到所有需要的 SE16N 截图。如果您的 SAP 应该有不同外观的对象，您可以轻松地用自己的截图替换。只保留原来的 png 名称。</p><p id="fdf1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们已经编写了一个 Python 机器人来为我们完成这项工作。下一步，我们将使用 Pyinstaller 将我们的脚本转换为可执行文件:</p><div class="lu lv gp gr lw lx"><a rel="noopener follow" target="_blank" href="/excel-python-app-for-non-pythonists-68b4fec0fabf"><div class="ly ab fo"><div class="lz ab ma cl cj mb"><h2 class="bd iu gy z fp mc fr fs md fu fw is bi translated">面向非 Python 爱好者的 Excel-Python 应用程序</h2><div class="me l"><h3 class="bd b gy z fp mc fr fs md fu fw dk translated">让您的非编码同事预测 Python 在 Excel 中的威力(使用 Xlwings 和……</h3></div><div class="mf l"><p class="bd b dl z fp mc fr fs md fu fw dk translated">towardsdatascience.com</p></div></div><div class="mg l"><div class="mr l mi mj mk mg ml ks lx"/></div></div></a></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/02fc4bfa82462c1c72b9fc758c53b807.png" data-original-src="https://miro.medium.com/v2/resize:fit:188/format:webp/1*HyI3OFFD_DAXOsxoQjYhCA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由于 Pyinstaller，Python 文件转换为可执行文件</p></figure><p id="7f71" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">仍然缺少的是用户与机器人交互的简单方法。因此，我们提供了一个 Excel 模板，可以在其中输入所需的表格、变量、文件名等。在我们的示例中，您最多可以添加三个 SE16N 提取，机器人将运行这些提取:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/7781f30f687bfdeb9d712994c87539eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S56e-8EfLu-eCFvQmJDSYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">您最多可以在此模板中输入三个表格</p></figure><p id="e597" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着我们只需用一个循环稍微修改一下原始 RPA 代码，就可以从 Excel 中获取这些参数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="8ef9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在我的 github 中找到完整的 Python 代码。</p><p id="9ead" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">祝贺您，现在您有了一个完整的独立应用程序来提取表格。您不再需要手动输入。只需将截图、exe 和 xls 文件全部保存在一个文件夹中，就可以开始运行可执行文件了。虽然这个例子是为 SAP 设计的，但是您当然也可以将代码调整到任何其他 ERP 上。</p><p id="47fa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">享受看斯奎尔现在为你做的工作。或者干脆不去管你的电脑，在新的空闲时间里做任何你想做的事情:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/f06967a06188c5c6de28bfc3b3119b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciUjGKkF9SsOSS4tRp3bkQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模拟仍然最摇滚(法国摇滚，作者图片)</p></figure><p id="046b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">非常感谢阅读，我希望这是支持。你可以在我的<a class="ae mv" href="https://github.com/DAR-DatenanalyseRehberg/Squir" rel="noopener ugc nofollow" target="_blank"> Github 库</a>里找到所有的截图、Python 代码和 Excel 模板。exe 文件存储在我的<a class="ae mv" href="https://drive.google.com/drive/folders/18pixZgWdjVDsMY31dNq5qqlyENXZEIN6?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Drive </a>里。欢迎在<a class="ae mv" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae mv" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae mv" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室(有或没有 VR) </a>与我联系。</p></div></div>    
</body>
</html>