<html>
<head>
<title>Teaching a LightGBM How to Count to 10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">教灯GBM如何数到10</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/teaching-a-lightgbm-how-to-count-to-10-1e96b1486f10#2022-05-09">https://towardsdatascience.com/teaching-a-lightgbm-how-to-count-to-10-1e96b1486f10#2022-05-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a12b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">会有多难呢？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1fc73ce39e3f40f29dd1e9acd43bd941.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3MgLuPbR124j2mzA"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯·贾维斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="f289" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> LightGBM是一个强大的机器学习算法。但是能数到10吗？</strong></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="d7d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">LightGBM可以说是处理表格数据的最佳算法。这是一个聪明的方法，也是许多机器学习竞赛获奖解决方案的支柱。LightGBM还提供时间序列数据。M次预测竞赛(M5)最新一轮的<a class="ae ky" href="https://github.com/Mcompetitions/M5-methods/" rel="noopener ugc nofollow" target="_blank">获胜者使用了LightGBM作为学习算法。</a></p><p id="ed61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在摆弄它的时候，我决定用LightGBM来解决下面的问题:<strong class="lb iu">预测序列1，2，…，9的下一个值。也就是数字10 </strong>。在这个任务中几乎没有不确定性，它只需要将1和前一个值相加。这么复杂的算法能有多难？</p><p id="50df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我第一次尝试的代码，我在下面解释。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="28aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先创建一个可训练数据集，我们称之为<em class="me"> sequence_df </em>(第1–10行)<em class="me">。</em>下面是它的样子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表1:准备用于训练的数据集</p></figure><p id="64a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以第一行为例，4为目标值，[1，2，3]为解释变量的向量。因此，这遵循一个自回归模型——使用过去的观察值作为当前的解释变量。</p><p id="8528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在构建数据集之后，我们用它来装配LightGBM(第11–18行)。通常，您应该优化模型的超参数。为了简单起见，这里我只使用默认配置。</p><p id="b6ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们得到对输入向量[7，8，9]的预测。</p><p id="84a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到6.5分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mf"><img src="../Images/96a15fe16678e9413f3a809339cd10a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2qRXfYulGNDMSP43"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@rojekilian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sarah Kilian </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="973b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为什么我们得到6.5？<strong class="lb iu"> LightGBM使用基于树的方法构建。这些不能在观察(训练)范围之外外推。因此，LightGBM也不能做到这一点。</strong>6.5值是训练目标变量的平均值。</p><p id="cb60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">我们可以通过引入差分预处理步骤来解决这个问题，该步骤去除了序列的<em class="me">趋势</em>。</strong> <a class="ae ky" rel="noopener" target="_blank" href="/12-things-you-should-know-about-time-series-975a185f4eb2">正如我在之前的一篇文章</a>中所描述的，求差是对时间序列的连续观测值取差的过程。其目的是去除趋势，稳定数据均值。下面是修改后的片段:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="b0a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，<strong class="lb iu">第8行中的差分步骤将序列[1，2，…，9]转换为1的常量序列</strong>。除了预测阶段之外，其余过程与之前相同。</p><p id="7d68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们得到对差异数据的预测(<em class="me"> prediction_raw </em>)。然后，我们通过添加最后一个已知的观察值(即9)来恢复差分操作。</p><p id="5395" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧，我们得到了10。</p><p id="01f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个故事是关于LightGBM行为的轶事，但也是一个警示故事。LightGBM是一个强大的算法。但是时间序列的预处理在预测系统的开发中是至关重要的。因此，请注意这一趋势！</p><p id="0d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="985e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">附言</strong>我们本可以应用线性模型(或助推器)。那么，差分预处理将不是必需的。不过，去除趋势也有助于时间序列建模时的线性模型。</p></div></div>    
</body>
</html>