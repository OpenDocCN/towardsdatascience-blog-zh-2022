<html>
<head>
<title>Interactive Dashboard from Jupyter Notebook with Mercury framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jupyter笔记本的交互式仪表盘，带有Mercury框架</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interactive-dashboard-from-jupyter-notebook-with-mercury-framework-e1269fdbe73c#2022-02-15">https://towardsdatascience.com/interactive-dashboard-from-jupyter-notebook-with-mercury-framework-e1269fdbe73c#2022-02-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/1b6801b8015ba029c6e6d2c2d7e48180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*xIHEay1V3bUugBLFXK6QXw.jpeg"/></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">由<a class="ae jy" href="https://unsplash.com/@louishansel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">路易斯·汉瑟</a>在<a class="ae jy" href="https://unsplash.com/s/photos/woodworking?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="ee1b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">你刚刚在笔记本上准备了分析报告。恭喜你！🎉你想与他人分享你的结果和发现。坏消息是你不能直接和你的朋友分享Jupyter笔记本代码，因为他们不会说Python🐍。他们不能安装所需的包，不能从GitHub库提取代码，也不能在本地运行笔记本。好消息是，你可以轻松地将你的笔记本转换成一个独立的网络应用程序。</p><p id="d66a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在这篇文章中，你将学会如何:</p><ul class=""><li id="fd58" class="kx ky iq kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">在Jupyter笔记本中创建仪表板，</li><li id="2bfb" class="kx ky iq kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">将笔记本转换为独立的web应用程序，</li><li id="58df" class="kx ky iq kb b kc lg kg lh kk li ko lj ks lk kw lc ld le lf bi translated">将基于笔记本的应用程序部署到Heroku。</li></ul></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="93ff" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">这篇文章的灵感来自于上一篇文章<a class="ae jy" rel="noopener" target="_blank" href="/creating-an-interactive-dashboard-from-jupyter-notebook-with-voila-b64918b4d15a">Ruben Winastwan</a>的《从Jupyter Notebook创建一个交互式仪表板》。</p><p id="d502" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">鲁本在他的文章中创造了旧金山犯罪的仪表板。他的代码可以在GitHub<a class="ae jy" href="https://github.com/marcellusruben/sf-crime-voila" rel="noopener ugc nofollow" target="_blank">https://github.com/marcellusruben/sf-crime-voila</a>获得</p><h1 id="9505" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">笔记本中的仪表板</h1><p id="1dc4" class="pw-post-body-paragraph jz ka iq kb b kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw ij bi translated">创建仪表板的代码可以分为三个部分:</p><ol class=""><li id="0970" class="kx ky iq kb b kc kd kg kh kk kz ko la ks lb kw mv ld le lf bi translated">从CSV文件加载数据集。</li><li id="e5a2" class="kx ky iq kb b kc lg kg lh kk li ko lj ks lk kw mv ld le lf bi translated">设置过滤数据的参数。</li><li id="3586" class="kx ky iq kb b kc lg kg lh kk li ko lj ks lk kw mv ld le lf bi translated">将数据绘制成地图和直方图。</li></ol><p id="ec1e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">代码在下面的要点中给出。</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">创建仪表板的代码。</p></figure><p id="a490" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">您将需要在<code class="fe nc nd ne nf b">requirements.txt</code>文件中的以下包来运行笔记本:</p><pre class="mw mx my mz gt ng nf nh ni aw nj bi"><span id="b9e8" class="nk lt iq nf b gy nl nm l nn no">mljar-mercury                             <br/>pandas                             <br/>numpy                             <br/>matplotlib                             <br/>folium</span></pre><p id="5d38" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">仪表板显示在下面的屏幕截图中:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi np"><img src="../Images/fb1a4e6284eefdbf43ff31a29fc382b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-fO8knJyM1iWOzyB1NfIlQ.png"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">Jupyter笔记本中的仪表板视图</p></figure><p id="ef72" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">创建仪表板的代码只是Python代码。请注意，仪表板中使用的参数只是简单的变量。<strong class="kb ir">没有使用小部件</strong>。如果你想改变仪表板中的一些东西，你需要改变变量并重新执行笔记本。</p><p id="e89f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">激动人心的事情将发生在🪄的下一步</p><h1 id="1525" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">将笔记本转换为Web应用程序</h1><p id="d581" class="pw-post-body-paragraph jz ka iq kb b kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw ij bi translated">现在我们需要一些魔法。鲁本在他的<a class="ae jy" rel="noopener" target="_blank" href="/creating-an-interactive-dashboard-from-jupyter-notebook-with-voila-b64918b4d15a">文章</a>中，使用<a class="ae jy" href="https://github.com/jupyter-widgets/ipywidgets" rel="noopener ugc nofollow" target="_blank"> ipywidgets </a>和<a class="ae jy" href="https://github.com/voila-dashboards/voila" rel="noopener ugc nofollow" target="_blank"> Voila </a>将笔记本变成了网络应用。这里我将使用一个<a class="ae jy" href="https://github.com/mljar/mercury" rel="noopener ugc nofollow" target="_blank"> Mercury </a>框架。它允许您通过在笔记本的开头添加YAML标题来定义笔记本的小部件。YAML在下面:</p><figure class="mw mx my mz gt jr"><div class="bz fp l di"><div class="na nb l"/></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">作为第一个原始单元格添加到笔记本中的YAML标题。</p></figure><p id="fc0f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">YAML标题应添加在笔记本的开头，作为一个<strong class="kb ir"> <em class="nu">原始</em> </strong>单元格。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi nv"><img src="../Images/4d30a4ddb6aa91ecbc9ffe75b1f79601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*poVMtuNxnsL7I0iz90M6jA.gif"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">完整的笔记本代码和YAML标题。</p></figure><p id="1106" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">YAML配置用于为笔记本创建小部件。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/4f2ba2aae6a294d89c72fc30398ea537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Ksm2p3obBSLpkMb_ndyZzQ.png"/></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">小部件是基于YAML配置定义的。</p></figure><p id="528c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">以下微件面板是基于YAML创建的:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/c0fcc1f048252b41b2e0e4d0e6eabe21.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*HTNOUicU_6r2FBfjAaAFOw.png"/></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">从YAML标题生成的窗口小部件面板。</p></figure><p id="8a4a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">需要注意的是，YAML中的变量应该与代码中的变量同名。稍后，在点击<code class="fe nc nd ne nf b">Run</code>按钮后，widgets值将被赋给代码中的变量。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi ny"><img src="../Images/f0037db5aac415a3328f1c4359a34533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zIty879H1mkk71wGm41btA.png"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">YAML参数应该与变量名相同。</p></figure><p id="56f6" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">YAML准备好了。是时候检查一下它在<a class="ae jy" href="https://github.com/mljar/mercury" rel="noopener ugc nofollow" target="_blank">水星</a>里的样子了。</p><p id="991e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">您可以在笔记本开发过程中观察web应用程序的外观。笔记本上有一个命令<code class="fe nc nd ne nf b">mercury watch — </code>用于观看<em class="nu">代码更新</em>。请运行以下命令:</p><pre class="mw mx my mz gt ng nf nh ni aw nj bi"><span id="b5f2" class="nk lt iq nf b gy nl nm l nn no">mercury watch SF_crime.ipynb</span></pre><p id="7ecc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">您将在<a class="ae jy" href="http://127.0.0.1:8000" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8000/ </a>上运行应用程序</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi nz"><img src="../Images/07542bdb6b7abbabf41194b0ce704d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZnLlka-jA3FvMaQKpZHTQ.png"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">在监视模式下运行的应用程序。</p></figure><p id="52dc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">每次您更新笔记本时，它都会在Mercury中自动更新(无需按F5😊)</p><h1 id="e6c6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">部署到Heroku</h1><p id="4e6e" class="pw-post-body-paragraph jz ka iq kb b kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw ij bi translated">仪表板已经准备好了，让我们把它部署到Heroku上。</p><p id="10d6" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="nu">我假设你已经安装了Heroku账号和Heroku命令行(CLI)工具(如果需要的话，查看</em> <a class="ae jy" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank"> <em class="nu">文档</em> </a> <em class="nu">)。</em></p><p id="0caf" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">让我们运行以下命令来创建一个Heroku应用程序:</p><pre class="mw mx my mz gt ng nf nh ni aw nj bi"><span id="1302" class="nk lt iq nf b gy nl nm l nn no">heroku create dashboard-mercury</span></pre><p id="ea37" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在项目目录中。<em class="nu">(你应该在创建命令中使用不同的名称)</em></p><p id="79dc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们将需要添加一个<code class="fe nc nd ne nf b">Procfile</code>到我们的项目中:</p><pre class="mw mx my mz gt ng nf nh ni aw nj bi"><span id="a6ec" class="nk lt iq nf b gy nl nm l nn no">web: mercury runserver 0.0.0.0:$PORT --runworker</span></pre><p id="4d0d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">让我们在dyno中设置必要的环境变量:</p><pre class="mw mx my mz gt ng nf nh ni aw nj bi"><span id="2724" class="nk lt iq nf b gy nl nm l nn no">heroku config:set ALLOWED_HOSTS=<!-- -->dashboard-mercury<!-- -->.herokuapp.com<br/>heroku config:set SERVE_STATIC=True<br/>heroku config:set NOTEBOOKS=*.ipynb</span></pre><p id="ceaa" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">您可以通过运行以下命令来部署应用程序:</p><pre class="mw mx my mz gt ng nf nh ni aw nj bi"><span id="476b" class="nk lt iq nf b gy nl nm l nn no">git push heroku main</span></pre><p id="fadf" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">仅此而已。你应该能够检查在https://dashboard-mercury.herokuapp.com运行的应用程序。以下是笔记本电脑仪表盘在移动和桌面上的视图。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a6b4e0f57cb5c39fb0d8a999a6d2d212.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/1*rnvVK-qDBacOygP3QbiaQw.gif"/></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">仪表板应用程序的移动视图。</p></figure><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi ob"><img src="../Images/b6e3ec139b5075f0e99ad4bd1be0ca14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rORA8keqbMqjMZ5AhdqxNQ.gif"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">仪表板应用程序的桌面视图。</p></figure><h1 id="383f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">结论</h1><p id="2cdc" class="pw-post-body-paragraph jz ka iq kb b kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw ij bi translated">Jupyter笔记本是分析数据和可视化结果的绝佳工具。由于有了<a class="ae jy" href="https://github.com/mljar/mercury" rel="noopener ugc nofollow" target="_blank"> Mercury </a>框架🧰.，用Python创建的仪表板可以作为独立的web应用程序轻松共享交互部件由YAML头定义。小部件的值被分配给代码中的变量，因此不需要重写或更改笔记本的代码。该应用程序可以很容易地在免费的Heroku dyno上发布。</p><p id="08a2" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">仪表板代码和数据可从<a class="ae jy" href="https://github.com/pplonski/dashboard-from-jupyter-with-mercury" rel="noopener ugc nofollow" target="_blank"> GitHub </a>库获得。</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="ac69" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="nu">我是</em> <a class="ae jy" href="https://github.com/mljar/mercury" rel="noopener ugc nofollow" target="_blank"> <em class="nu">水星</em> </a> <em class="nu">框架的作者。</em></p></div></div>    
</body>
</html>