<html>
<head>
<title>Securing our Prototypes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保护我们的原型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/securing-our-prototypes-2d1f9b21798f#2022-02-14">https://towardsdatascience.com/securing-our-prototypes-2d1f9b21798f#2022-02-14</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="2722" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">锁定我们的数据科学原型和隐私概念证明</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/c43c04f9d75a9f532acbd3ae9d09fc41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9QA17LzLIbGX5qj9"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@flyd2069?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">飞:D </a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="ec5b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">网络安全和信息保护成为焦点，因为看起来像是<a class="ae kz" href="https://www.itgovernance.co.uk/blog/list-of-data-breaches-and-cyber-attacks-in-december-2021-219-million-records-breached" rel="noopener ugc nofollow" target="_blank">不断传来的</a>网络攻击和数据泄露。小型原型或概念验证应用程序可能成为攻击目标，并涉及数据泄露。我们继续一系列关于帮助求职者将他们的简历与招聘信息相匹配的文章。该项目可以同时处理<a class="ae kz" href="https://www.itgovernance.eu/blog/en/the-gdpr-what-is-sensitive-personal-data" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv">个人数据</strong> </a>和<strong class="lc iv">敏感个人数据</strong>。我的全新NLP和数据科学支持的简历服务的第一个重要特征是安全性。</p><p id="9312" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这是到目前为止的整个系列，还有更多。这些文章涵盖了孕育这个想法所需的研究和原型制作工作。</p><ul class=""><li id="9473" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/ai-is-working-against-your-job-application-bec65d496d22">利用NLP改善简历</a>:对职位描述进行关键词匹配和文本分析。一篇有很多参与和讨论的受欢迎的文章。</li><li id="6704" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/using-a-python-back-end-b9e4f9ac5d">使用Python后端</a>:用于NLP的Python Flask和Vue.js。用Vue.js前端构建Flask后端服务器，避免CORS和docker容器编排问题。</li><li id="3f88" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><a class="ae kz" href="https://medium.com/towards-data-science/semantic-highlighting-d2fba3da2822" rel="noopener">语义高亮</a>:为NLP构建并添加一个用户界面，使用vue-text-highlight节点包在屏幕上高亮显示给定的文本。思考过程是为用户突出关键词或关键句子，以帮助更新简历。</li><li id="37ff" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">向求职者展示自然语言处理:一个简短的演示，演示如何从前端获取一段文本，执行关键词提取，并为用户突出显示关键词。</li><li id="a04c" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><a class="ae kz" href="https://medium.com/towards-data-science/handling-unstructured-data-feaeec2a6231" rel="noopener">处理非结构化数据</a>:考虑到数据量和高需求，我们讨论如何使用Apache Tika编排工作流并从更广泛的文档中提取文本。</li><li id="7818" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/fastapi-versus-flask-3f90adc9572f#cd73-dbd440d31c27">法斯塔皮对弗拉斯克:</a>这是怎么回事？我们不是已经有姜戈了吗！。考虑web框架、微服务和后端API，什么是服务NLP例程的最佳架构？</li></ul><p id="8042" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本文将展示我在原型中经常使用的一种提供身份验证的技术。身份验证发生在前端，只有经过授权的用户才能调用后端API端点。由<a class="ae kz" href="http://twitter.com/vivekmadurai" rel="noopener ugc nofollow" target="_blank"> @vivekmadurai </a>撰写的文章<a class="ae kz" href="https://medium.com/@vivekmadurai/different-ways-to-authenticate-a-web-application-e8f3875c254a" rel="noopener">认证Web应用程序</a>的不同方法为认证提供了一个很好的解释。然而，我更喜欢使用第三方访问(OAuth，API-token)方法，使用<a class="ae kz" href="https://auth0.com/" rel="noopener ugc nofollow" target="_blank"> Auth0 </a>。</p><h2 id="742e" class="mk ml iu bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">网络安全</h2><p id="2edd" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">Web应用程序安全性是一个重要的话题，有各种各样的过程和方法来保护应用程序和API免受不良分子的攻击。认证就是这样一种验证个人身份的过程。授权是另一个方面，它是通过指定的角色和权限来控制用户访问的过程。我们需要验证所有用户，仔细检查权限，并在处理个人或敏感个人数据时快速注销非活动会话。这类数据有很多问题，尤其是静态或传输中的加密。</p><p id="9c3d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">有许多关于身份验证的文章，我倾向于将这些方法分为两个不同的类别</p><ul class=""><li id="7446" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">从头开始创建用户数据库、登录、注销和注册过程，或者使用特定web框架的可用扩展。</li><li id="0a87" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">使用第三方提供商。</li></ul><p id="2040" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">从头开始开发身份验证方法似乎是一个完全的目标置换。然而，请记住，我的兴趣是为我的潜在客户构建NLP服务。因此，我使用一个第三方提供商，提供我正在使用的语言所需的SDK(Python和带有Vue.js的Node)，对我来说是Auth0。</p><h2 id="58bc" class="mk ml iu bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">将Auth0集成到FastAPI和Vue.js中</h2><p id="3f99" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">由于我很难宣称自己是安全专家，能力甚至是一种延伸；我使用了一篇博客文章、可用的代码示例和python的SDK。</p><div class="ni nj gq gs nk nl"><a href="https://auth0.com/blog/build-and-secure-fastapi-server-with-auth0/" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fp"><div class="nn ab no cl cj np"><h2 class="bd iv gz z fq nq fs ft nr fv fx it bi translated">使用Auth0构建和保护FastAPI服务器</h2><div class="ns l"><h3 class="bd b gz z fq nq fs ft nr fv fx dk translated">FastAPI是一个相对较新的Python框架，使您能够非常快速地创建应用程序。这个框架…</h3></div><div class="nt l"><p class="bd b dl z fq nq fs ft nr fv fx dk translated">auth0.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz kt nl"/></div></div></a></div><p id="a88a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">vue.js有一个入门应用程序，就像放入一个安全的基础，然后在上面构建组件、服务和视图，这非常有吸引力。科学不是重新发明轮子！</p><div class="ni nj gq gs nk nl"><a href="https://auth0.com/blog/complete-guide-to-vue-user-authentication/" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fp"><div class="nn ab no cl cj np"><h2 class="bd iv gz z fq nq fs ft nr fv fx it bi translated">使用Auth0进行Vue.js用户认证的完整指南</h2><div class="ns l"><h3 class="bd b gz z fq nq fs ft nr fv fx dk translated">了解如何通过实现用户身份验证来保护Vue.js应用程序，这包括用户登录、注销和…</h3></div><div class="nt l"><p class="bd b dl z fq nq fs ft nr fv fx dk translated">auth0.com</p></div></div><div class="nu l"><div class="oa l nw nx ny nu nz kt nl"/></div></div></a></div><p id="db8d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">鉴于这些文章的质量，我觉得我没有必要写太多，除了在处理第一部分时反思我的经历。</p><h2 id="9168" class="mk ml iu bd mm mn mo dn mp mq mr dp ms lj mt mu mv ln mw mx my lr mz na nb nc bi translated">保护NLP操作的FastAPI端点</h2><p id="56f0" class="pw-post-body-paragraph la lb iu lc b ld nd jv lf lg ne jy li lj nf ll lm ln ng lp lq lr nh lt lu lv in bi translated">没过多久我就遇到了阻碍，我花了很多时间来找出我做错了什么。<a class="ae kz" href="https://github.com/CognitiveDave/semantic" rel="noopener ugc nofollow" target="_blank"> Github库</a>包含代码，还有三种不同后端方法的文件:-</p><ul class=""><li id="a760" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">烧瓶与vue通过预建的dist文件夹(<a class="ae kz" href="https://github.com/CognitiveDave/semantic/blob/master/backend.py" rel="noopener ugc nofollow" target="_blank"> backend.py </a>)</li><li id="9154" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">FastAPI带vue带预建策略(<a class="ae kz" href="https://github.com/CognitiveDave/semantic/blob/master/main.py" rel="noopener ugc nofollow" target="_blank"> main.py </a>)</li><li id="987e" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">带有Auth0和预建vue策略的FastAPI(<a class="ae kz" href="https://github.com/CognitiveDave/semantic/blob/master/mainAuth0.py" rel="noopener ugc nofollow" target="_blank">main auth 0 . py</a>)</li></ul><p id="a48a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该问题在下图中显而易见</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/0359f1632d242b9798ffefb315b8d40e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvu9AbJN9i2DWIW9TsyLeg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">运行main.py(未经身份验证的FastAPI按作者分类的图像</p></figure><p id="0117" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Main.py定义了两条路由。一个是对“/”调用进行FileResponse，然后是一个不安全的端点“/API/public”，它应该返回一个JSON响应对象。但是服务器对于不安全的端点返回<strong class="lc iv"> <em class="oc"> 404 Not Found </em> </strong>，对我来说一点意义都没有。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj od"><img src="../Images/dc71cec39b3982fa37ea5f87f0a665ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7NjZH9GOg8Vvdc97"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@visuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">视觉效果</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4dd8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">经过一段时间的反复试验，我发现了这个问题</p><pre class="kk kl km kn gu oe of og oh aw oi bi"><span id="3f4e" class="mk ml iu of b gz oj ok l ol om">app.mount("/", StaticFiles(directory="./dist",html=True), name="static")</span></pre><p id="4ceb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">app <a class="ae kz" href="https://fastapi.tiangolo.com/advanced/sub-applications/" rel="noopener ugc nofollow" target="_blank"> mount </a>似乎已经产生了使实例成为子应用程序并将其限制为静态文件服务器的效果。即使文档中另有暗示，如下面的屏幕截图所示。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj on"><img src="../Images/bd8042c077f9369356de5aca35a990a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1r9jsX3Lg_gCaHGu8qVPw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">显示两个端点的main.py的Swagger UI视图——作者图片</p></figure><p id="a1aa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我接受了这个设计，并试图调和Flask的显著差异，以绕过这个障碍。在mainAuth0.py中，我更改了子应用程序的概念来解决这个问题。</p><pre class="kk kl km kn gu oe of og oh aw oi bi"><span id="75df" class="mk ml iu of b gz oj ok l ol om">app = FastAPI()<br/>appVue = FastAPI()<br/>appVue.mount("/", StaticFiles(directory="./dist",html=True), name="static")</span><span id="bf44" class="mk ml iu of b gz oo ok l ol om">@appVue.get("/")async def home():    <br/>  return FileResponse("index.html")</span></pre><p id="e9f4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">子应用程序appVue是为前端HTML和相关的静态文件保留的，这看起来是一种简洁的方法。接下来，定义一个新的子应用app，负责服务前端调用。</p><pre class="kk kl km kn gu oe of og oh aw oi bi"><span id="b8e5" class="mk ml iu of b gz oj ok l ol om">@app.get("/api/public")<br/>def public():    <br/> ....<br/> return JSONResponse(content=json_compatible)</span></pre><p id="a79a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">运行mainAuth0.py并访问swagger UI</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj on"><img src="../Images/cdca6ba25652cbb22cfedea84ab0d6a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XY90mhxZ-5lvVUYlxrR3Zg.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">mainAuth0.py显示两个端点的swagger UI视图</p></figure><p id="230c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们看到一个公共和私有端点。所以现在我们准备保护私有的。我仔细阅读了Auth0代码示例，只遇到了一个小问题。我拼错了我的一个秘密，让Auth0燃烧了更多的时间。以下是一些亮点</p><pre class="kk kl km kn gu oe of og oh aw oi bi"><span id="8eb1" class="mk ml iu of b gz oj ok l ol om">from fastapi.security import HTTPBearer  <br/>token_auth_scheme = HTTPBearer()</span></pre><p id="c5e9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这些行有助于从请求头中获取授权承载令牌。如果没有标头或承载令牌，HTTPBearer将返回“未授权”</p><pre class="kk kl km kn gu oe of og oh aw oi bi"><span id="e8ac" class="mk ml iu of b gz oj ok l ol om">from utils import VerifyToken<br/>result = VerifyToken(token.credentials).verify()</span></pre><p id="1ad9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">VerifyToken是一个直接来自Auth0的类，代码显示了如何使用该类来验证给定的令牌。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="op oq l"/></div></figure><p id="a1ee" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">综上所述，我们看到了一个安全的端点。您需要一个Auth0帐户，并且必须按照教程中的步骤注册一个API。我使用curl从Auth0获取一个不记名令牌来测试我的安全端点。</p><p id="234d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">首先，我尝试了一个无效的令牌，看看我得到了什么！</p><pre class="kk kl km kn gu oe of og oh aw oi bi"><span id="dcdd" class="mk ml iu of b gz oj ok l ol om">curl -X 'GET' \<br/>  --url 'http://127.0.0.1:8000/api/private' \<br/>  --header 'Authorization: Bearer FastAPI is awesome'<br/></span></pre><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj or"><img src="../Images/64d667096965ddab862519f14c7767e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WV3E2KGxovGS7mbBjt4ETQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">终端窗口——使用curl向安全端点发送错误代码</p></figure><p id="986b" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">向端点发送正确的令牌展示了期望的回报。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj os"><img src="../Images/ccf5ba2b5f59a6a78a9dfc1e8a6bbafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kfAL5kC6QD6c9Ull_qMWNQ.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">我使用curl测试了一个具有正确的JWT不记名令牌的安全端点。</p></figure><p id="2bd8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">NLP项目现在使用Auth0，我们可以保护FastAPI路由。在下面的文章中，我们将把Vue.js前端与Auth0连接起来，使用户能够注册、登录、注销、检索令牌，并在授权头中将令牌传递给后端。</p><p id="3bdb" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">一个意想不到的404让我损失了很多时间，但是写这个我学到了很多。大多数情况下，复制粘贴比手工输入你的秘密要好。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ot"><img src="../Images/b475885c0c53411da91c77c3488f4bc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5T-lIC_ZphhKRass"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kz" href="https://unsplash.com/@aronvisuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aron视觉</a>拍摄的照片</p></figure><div class="ni nj gq gs nk nl"><a href="https://cognitivedave.medium.com/membership" rel="noopener follow" target="_blank"><div class="nm ab fp"><div class="nn ab no cl cj np"><h2 class="bd iv gz z fq nq fs ft nr fv fx it bi translated">通过我的推荐链接-大卫·摩尔加入媒体</h2><div class="ns l"><h3 class="bd b gz z fq nq fs ft nr fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nt l"><p class="bd b dl z fq nq fs ft nr fv fx dk translated">cognitivedave.medium.com</p></div></div><div class="nu l"><div class="ou l nw nx ny nu nz kt nl"/></div></div></a></div></div></div>    
</body>
</html>