<html>
<head>
<title>Time Series Forecasting made easy with Darts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">飞镖使时间序列预测变得简单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-forecasting-made-easy-with-darts-3be0b8ba02f4#2022-08-17">https://towardsdatascience.com/time-series-forecasting-made-easy-with-darts-3be0b8ba02f4#2022-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0842" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个用于时间序列预处理和预测的开源包，具有统一和用户友好的API</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1bd3f967e5d540e2ca61c60e3e284835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_pDw0o1-EKIntdOds51PWg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">科林·伯伦斯来自<a class="ae ky" href="https://pixabay.com//?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3068300" rel="noopener ugc nofollow" target="_blank">的图片</a></p></figure><p id="2505" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时间序列预测涉及基于历史时间戳数据的模型构建，以进行科学预测并推动未来的战略决策。时间序列预测在各个领域都有很多用途，包括:</p><ul class=""><li id="eef7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">预测消费者对每种产品的需求</li><li id="c11d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">医疗保健中疫情传播、诊断、药物和规划的预测</li><li id="e267" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">异常检测、网络安全和预测性维护</li><li id="45ef" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">预测当前的基础设施能否处理近期和远期的流量</li></ul><p id="9b1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有很多。</p><p id="b58d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时间序列预测与传统的机器学习用例略有不同，因为它涉及到在特征工程和建模过程中必须考虑的数据的时间顺序。</p><h2 id="39e9" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">动机:</h2><p id="a460" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">为了训练一个时间序列预测模型，您最终会遇到这样的情况:使用<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>进行预处理，使用<a class="ae ky" href="https://www.statsmodels.org/stable/index.html" rel="noopener ugc nofollow" target="_blank"> statsmodel </a>进行季节性和统计测试，使用<a class="ae ky" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>或<a class="ae ky" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">脸书先知</a>进行预测，并使用定制代码来实现回溯测试和模型选择。</p><p id="8646" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于不同的库有不同的API和数据类型，端到端的时间序列预测对数据科学家来说是一项单调乏味的任务。对于传统的机器学习用例，我们有<a class="ae ky" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>包，它为端到端的机器学习建模提供了一致的API。</p><p id="c927" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Darts试图成为时间序列的scikit-learn，其主要目标是简化整个时间序列预测方法。在本文中，我们将讨论darts包及其实现。</p><h1 id="0b69" class="nh mk it bd ml ni nj nk mo nl nm nn mr jz no ka mu kc np kd mx kf nq kg na nr bi translated">飞镖:</h1><p id="3946" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated"><strong class="lb iu"> Darts </strong>是一个Python库，可以轻松操作和预测时间序列。它提供了各种模型的实现，从ARIMA等经典模型到深度神经网络，这些模型的实现方式与scikit-learn模型相同(使用fit和predict APIs)。</p><p id="9d8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Darts包的一些特点是:</p><ul class=""><li id="9f55" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">它是围绕不可变的TimeSeries类构建的</li><li id="7ad4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">它有一个统一且用户友好的类似scikit-learn的API接口，如fit()和predict()</li><li id="3022" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">它提供了从经典模型到最先进的ML/DL方法的各种模型</li><li id="3a1c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">它为端到端时间序列预测用例提供API，包括数据发现、数据预处理、预测以及模型选择和评估。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/f8d21bb2d34c663a1ca3393a148a14c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S2wV6dtWgR3MSbCmpI0sWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(来源)，Dart包概述</p></figure><h1 id="db5a" class="nh mk it bd ml ni nj nk mo nl nm nn mr jz no ka mu kc np kd mx kf nq kg na nr bi translated">用飞镖预测:</h1><p id="e4ec" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">此外，让我们讨论、探索和实现从1949年到1960年每月航空乘客数据集的<a class="ae ky" href="https://unit8co.github.io/darts/generated_api/darts.datasets.html" rel="noopener ugc nofollow" target="_blank">航空乘客数据集</a> ( <a class="ae ky" href="https://opendatacommons.org/licenses/dbcl/1-0/" rel="noopener ugc nofollow" target="_blank">开源</a>)的Darts包的基本功能。</p><h2 id="8021" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">读取时间序列:</h2><p id="079d" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">读取航空乘客数据集，将其拆分为训练和验证数据，并进一步可视化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/ec87a10a06dcabaa10aa346fc7b0569d.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*csUmdV7psSUHSFHF7AJWTQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，可视化培训和验证数据</p></figure><h2 id="e146" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">预测:</h2><p id="2ea5" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">Darts提供了各种经典和先进的时间序列建模技术的实施，包括ARIMA，西塔，指数平滑，N-Beats，脸书先知等。</p><blockquote class="nw nx ny"><p id="c72e" class="kz la nz lb b lc ld ju le lf lg jx lh oa lj lk ll ob ln lo lp oc lr ls lt lu im bi translated">跟随<a class="ae ky" href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.html" rel="noopener ugc nofollow" target="_blank"> darts.models文档</a>来了解每个实现的更多信息。</p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/ae2be5b0911f619c478323a675b1f926.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*_SKzPQ5fxiKai3vSM233fA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)，可视化训练、验证和预测数据</p></figure><h2 id="8fd3" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">评估和调整:</h2><p id="e6ec" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">Darts提供了计算模型性能的实现，并调整估计器的超参数以获得优化的模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h1 id="aa65" class="nh mk it bd ml ni nj nk mo nl nm nn mr jz no ka mu kc np kd mx kf nq kg na nr bi translated">高级功能:</h1><ul class=""><li id="65da" class="lv lw it lb b lc nc lf nd li od lm oe lq of lu ma mb mc md bi translated">除了经典的时间序列模型，Darts还提供最先进的现代ML/DL功能。</li><li id="1d68" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">概率预测</li><li id="472f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">针对多个系列和大型数据集的培训</li><li id="ded6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">支持多维系列。可以对多维时间序列数据执行n拍建模。</li><li id="e07c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">包括外部过去和未来数据。过去和未来的协变量数据可以在模型训练期间传递，以提高模型性能。</li></ul></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><h1 id="6bfa" class="nh mk it bd ml ni on nk mo nl oo nn mr jz op ka mu kc oq kd mx kf or kg na nr bi translated">结论:</h1><p id="b2f5" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">Darts是一个方便的包，它提供了用户友好的现代ML实现，专门针对时序用例。</p><p id="03bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Darts包的局限性可能是静态协变量、AutoML实现、异常检测和预训练模型的不可用性。</p><h1 id="015f" class="nh mk it bd ml ni nj nk mo nl nm nn mr jz no ka mu kc np kd mx kf nq kg na nr bi translated">参考资料:</h1><p id="bb03" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">[1]飞镖文档:<a class="ae ky" href="https://unit8co.github.io/darts/#" rel="noopener ugc nofollow" target="_blank">https://unit8co.github.io/darts/#</a></p><p id="a6e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]航空客运数据(<a class="ae ky" href="https://opendatacommons.org/licenses/dbcl/1-0/" rel="noopener ugc nofollow" target="_blank">开源许可</a>):<a class="ae ky" href="https://www.kaggle.com/datasets/rakannimer/air-passengers" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/datasets/rakannimer/air-passengers</a></p><blockquote class="os"><p id="b9fc" class="ot ou it bd ov ow ox oy oz pa pb lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>