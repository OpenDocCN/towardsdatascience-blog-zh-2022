<html>
<head>
<title>How to Animate Plots in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Python 中制作情节动画</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-animate-plots-in-python-2512327c8263#2022-02-04">https://towardsdatascience.com/how-to-animate-plots-in-python-2512327c8263#2022-02-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cf4f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解制作数据动画以创建动态视觉效果的基础知识</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/0245164b0c962b8d6473f86f7ad9c589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*lYNitER8Q33sXgScL-XKaw.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">动画情节[由作者创作]</p></figure><p id="6a53" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当今世界对数据的需求越来越大。公司和个人通过机器学习使用它来预测股票价格，跟踪运动员的健康状况，研究特定城市的房价……可能性是无限的。虽然原始数据是基础，但它能讲述的故事更重要。讲述这个故事是工程师和数据科学家的工作。视觉可能是使用数据传达想法的最佳方式之一。想一想，你是愿意看一行行的数据，还是看几幅概括这些数据的图表？像大多数人一样，你可能认为剧情听起来更好。虽然并不总是必要的，但在情节中加入动画可以为你的故事提供额外的意义。</p><p id="21b1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到本文结束时，您应该能够重现上述情节，并使用该框架创建自己的精美动画。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lq"><img src="../Images/dc10fa9acf6e51219baecc480786fe20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uPoRzMEDK6fEp-fB"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">Emile Perron 在<a class="ae lv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="14ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于本文，我将假设您对 Python 以及如何执行基本的数据操作和绘图有一点了解。请记住，这不是使用 Python 动画功能的唯一方法，所以如果你有其他想法，请在下面分享你的方法！我们将使用三维线和散点来创建轨迹，但这些概念可以扩展到其他绘图类型，如二维线、条形图、饼图、等高线等。</p><h2 id="b8f6" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">导入包</h2><p id="787a" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">Python 有大量用于数据分析的库，所以我们将使用其中的几个。让我们开始一个新的脚本，并导入这个项目所需的包:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="6508" class="md me it nc b gy ng nh l ni nj"># Importing Packages<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>from mpl_toolkits.mplot3d import Axes3D<br/>from matplotlib import animation</span></pre><ul class=""><li id="a091" class="nk nl it kw b kx ky la lb ld nm lh nn ll no lp np nq nr ns bi translated"><em class="nt"> NumPy </em>将用于创建数值数组和使用三角函数(为了方便调用，定义为<em class="nt"> np </em>)</li><li id="32ce" class="nk nl it kw b kx nu la nv ld nw lh nx ll ny lp np nq nr ns bi translated">来自<em class="nt"> Matplotlib </em>的<em class="nt"> Pyplot </em>将用于绘制图形(为便于调用，定义为<em class="nt"> plt </em></li><li id="576a" class="nk nl it kw b kx nu la nv ld nw lh nx ll ny lp np nq nr ns bi translated"><em class="nt"> Axes3D </em>将用于为我们的绘图创建三维轴</li><li id="49d2" class="nk nl it kw b kx nu la nv ld nw lh nx ll ny lp np nq nr ns bi translated">来自<em class="nt"> Matplotlib </em>的<em class="nt">动画</em>将用于通过重复调用我们稍后将定义的函数来创建我们的动画</li></ul><h2 id="6687" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated"><strong class="ak">创建数据集</strong></h2><p id="80f7" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">在我们考虑绘制任何东西之前，我们需要创建要绘制的数据。对于这一部分，我使用正弦函数和一个从<em class="nt"> 0 </em>到<em class="nt"> 20 </em>运行的时间数组创建了一些位置数据(我在动画中任意标注为秒)。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="b25f" class="md me it nc b gy ng nh l ni nj"># Time Array<br/>t = np.linspace(0, 20, 100)<br/><br/># Position Arrays<br/>x = np.sin(np.pi/5 * t)<br/>y = np.sin(np.pi/3 * t)<br/>z = np.linspace(0, 100, 100)<br/><br/># Setting up Data Set for Animation<br/>dataSet = np.array([x, y, z])  # Combining our position coordinates<br/>numDataPoints = len(t)</span></pre><p id="0183" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我认为这一部分非常简单明了。你可以改变时间和位置数组来创建新的轨迹。<em class="nt">数据集</em>和<em class="nt"> numDataPoints </em>变量将在我们的动画函数中使用，我们将在接下来定义。</p><h2 id="a31a" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated"><strong class="ak">动画功能</strong></h2><p id="4a0b" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">为了给我们的人物制作动画，我们将使用一个名为<em class="nt"> FuncAnimation </em>的函数，来自导入的<em class="nt"> animation </em>类。您可以在这里访问这两个<a class="ae lv" href="https://matplotlib.org/stable/api/animation_api.html" rel="noopener ugc nofollow" target="_blank">的文档。<em class="nt"> FuncAnimation </em>要求我们创建自己的函数来更新线、点等。，我们将其定义为<em class="nt"> animate_func </em>。</a></p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="33d7" class="md me it nc b gy ng nh l ni nj">def animate_func(num):<br/>    ax.clear()  # Clears the figure to update the line, point,   <br/>                # title, and axes</span><span id="d946" class="md me it nc b gy nz nh l ni nj">    # Updating Trajectory Line (num+1 due to Python indexing)<br/>    ax.plot3D(dataSet[0, :num+1], dataSet[1, :num+1], <br/>              dataSet[2, :num+1], c='blue')</span><span id="96ab" class="md me it nc b gy nz nh l ni nj">    # Updating Point Location <br/>    ax.scatter(dataSet[0, num], dataSet[1, num], dataSet[2, num], <br/>               c='blue', marker='o')</span><span id="aa5c" class="md me it nc b gy nz nh l ni nj">    # Adding Constant Origin<br/>    ax.plot3D(dataSet[0, 0], dataSet[1, 0], dataSet[2, 0],     <br/>               c='black', marker='o')</span><span id="47e8" class="md me it nc b gy nz nh l ni nj">    # Setting Axes Limits<br/>    ax.set_xlim3d([-1, 1])<br/>    ax.set_ylim3d([-1, 1])<br/>    ax.set_zlim3d([0, 100])<br/><br/>    # Adding Figure Labels<br/>    ax.set_title('Trajectory \nTime = ' + str(np.round(t[num],    <br/>                 decimals=2)) + ' sec')<br/>    ax.set_xlabel('x')<br/>    ax.set_ylabel('y')<br/>    ax.set_zlabel('z')</span></pre><p id="5b29" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们首先注意到被传递到<em class="nt"> animate_func </em>中的<em class="nt"> num </em>变量。这是当前动画步骤的索引。当我们将<em class="nt"> animate_func </em>传递给<em class="nt"> FuncAnimation </em>时，它将迭代我们的<em class="nt"> num </em>变量。我们可以使用该变量来遍历我们之前创建的数据集。</p><p id="10f0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该功能从清除图形开始。这将删除线、点、原点、轴标签和标题。然后添加更新的轨迹线(从<em class="nt"> 0 </em>到<em class="nt">号</em>)和点位置(在步骤<em class="nt">号</em>)。我们的原点在这个图中保持不变，所以你会注意到<em class="nt"> num </em>没有出现，因为我们没有改变原点。接下来，该函数定义了我们不变的轴限制。如果希望轴随着数量的增加而变化(使轴成为动态的)，可以删除轴限制。</p><p id="1d66" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，该函数定义了我们的标题和轴标签。标签很简单，只是我们的<em class="nt"> x </em>、<em class="nt"> y </em>和<em class="nt"> z </em>用于笛卡尔坐标。作为一点额外的功能，我们有一个显示轨迹时间数组的动态标题，<em class="nt"> t. </em>我们正在显示它(四舍五入到第二个小数位)并在每次迭代中更新它。注意，这些不是实时秒。</p><h2 id="2417" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">绘制我们的动画</h2><p id="38a4" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">最后一步实际上是使用<em class="nt"> FuncAnimation </em>绘制我们的动画。我们首先用三维轴创建我们的图形对象。然后我们使用<em class="nt"> FuncAnimation </em>，它将图形、我们之前创建的动画函数、一个<em class="nt">间隔</em>值和一个<em class="nt">帧</em>值作为输入。<em class="nt">间隔</em>是以毫秒为单位的帧之间的延迟，而<em class="nt">帧</em>仅仅是你希望显示的帧数。这最后两个是可选参数，但是如果我想调整动画的外观，我喜欢包含它们。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="c5c1" class="md me it nc b gy ng nh l ni nj"># Plotting the Animation<br/>fig = plt.figure()<br/>ax = plt.axes(projection='3d')<br/>line_ani = animation.FuncAnimation(fig, animate_func, interval=100,   <br/>                                   frames=numDataPoints)<br/>plt.show()</span></pre><p id="850c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以运行代码，如果操作正确，您的绘图应该如下所示(点的速度可能不同):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/0245164b0c962b8d6473f86f7ad9c589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*lYNitER8Q33sXgScL-XKaw.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">轨迹动画【作者创作】</p></figure><h2 id="b9f1" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">保存我们的动画(可选)</h2><p id="40ac" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">如果你想把你的动画保存为<em class="nt">。gif </em>文件，您可以使用下面的代码做到这一点。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="1ec4" class="md me it nc b gy ng nh l ni nj"># Saving the Animation<br/>f = r"c://Users/(Insert User)/Desktop/animate_func.gif"<br/>writergif = animation.PillowWriter(fps=numDataPoints/6)<br/>line_ani.save(f, writer=writergif)</span></pre><p id="31b7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你需要选择一个位置来保存它，并将其存储为变量<em class="nt"> f </em>。您可以在<em class="nt">枕套</em>中调整每秒帧数、<em class="nt"> fps </em>、变量。我将<em class="nt"> numDataPoints </em>变量(定义为<em class="nt"> FuncAnimation </em>中的帧数)除以<em class="nt"> 6 </em>，使动画长度为<em class="nt"> 6 </em>秒。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="0b18" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文到此为止。感谢您的阅读！如果您不想错过更多的 Python 和工程文章，请关注我并订阅我的电子邮件。我已经写了一些其他的文章，所以也来看看吧！</p></div></div>    
</body>
</html>