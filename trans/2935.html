<html>
<head>
<title>How and Why Performing One-Hot Encoding in Your Data Science Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何以及为什么在您的数据科学项目中执行一键编码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-and-why-performing-one-hot-encoding-in-your-data-science-project-a1500ec72d85#2022-06-27">https://towardsdatascience.com/how-and-why-performing-one-hot-encoding-in-your-data-science-project-a1500ec72d85#2022-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e3ec" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一篇关于什么是一键编码，为什么使用它，以及如何使用它的文章(Python语言)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f19e3823d8d934d82e0773690e2b7474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hnc8dqfWohEPLouJPeFKmw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com/s/photos/binary?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2b0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> W </span>当处理真实数据时，你经常会得到带有“混合”值的数据集:字符串和数字。如果您是数据科学和机器学习领域的新手，您通常会发现“非常漂亮”的列(最多有一些nan要处理)，通常带有缩放值。但是当涉及到真实世界的数据时，我们经常要处理杂乱的数据。</p><p id="c2dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，当涉及到真实数据时，我们可能必须在同一个数据集中处理带有字符串的列和带有数字的列。我们该如何应对？</p><p id="20b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一种可能性是执行所谓的一键编码。在本文中，我们将了解什么是一键编码，为什么要执行它，它的局限性，以及执行它的几种方法。</p><h1 id="bff3" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">1.为什么您应该需要一次性编码</h1><p id="6597" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">一些算法可以直接处理分类数据；例如，可以直接从分类数据中学习决策树，而不需要数据转换(这取决于具体的实现)。相反，许多机器学习算法要求所有输入和输出变量都是数字。</p><p id="789e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这些情况下，一键编码会有所帮助，因为它将分类数据转换为数字数据；换句话说:它将字符串转换为数字，以便我们可以毫无问题地应用我们的机器学习算法。</p><p id="5488" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，想象一个有某种动物的柱子；类似于:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="f91a" class="ng mf it nc b gy nh ni l nj nk">animals = ['dog', 'cat', 'mouse'] </span></pre><p id="16d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一键编码将创建与“动物”列中的独特动物种类数量一样多的新列，新列将填充0和1。因此，如果您的“动物”列中有100种动物，一键编码将创建100个新列，全部用1和0填充。</p><p id="c5dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所想象的，这个过程会导致一些麻烦。在这种情况下，麻烦的是所谓的“<strong class="lb iu">哑变量陷阱</strong>”。</p><p id="88af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虚拟变量陷阱是这样一种场景，其中存在的变量变得彼此高度相关，这意味着一件重要的事情:一次性编码可能导致多重共线性；这意味着<strong class="lb iu">我们总是必须分析变量</strong>(新特性，又名:新列)<strong class="lb iu">，并决定是否要删除它们中的一些</strong>(你可以在这里阅读我的文章<a class="ae ky" rel="noopener" target="_blank" href="/how-to-perform-feature-selection-in-a-data-science-project-591ba96f86eb">关于特性选择:它甚至涵盖了多重共线性的场景)。</a></p><p id="9e8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着一件重要的事情:当我们没有“太多”的唯一值要转换到新列(即新要素)时，我们最好执行一次性编码，这样我们可以避免多重共线性(但有时我们别无选择:我们必须面对多重共线性并执行要素选择，意识到我们可能会遗漏一些东西)。</p><p id="b527" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们来看看执行一键编码的几种方法。</p><h1 id="0306" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">2.scikit-learn中的“OneHotEncoder”方法</h1><p id="8f33" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我要展示的第一个方法是scikit-learn提供的“OneHotEncoder”方法。直接举个实际例子吧。假设我们有这样一个数据集:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="5a96" class="ng mf it nc b gy nh ni l nj nk">import pandas as pd<br/>from sklearn.preprocessing import OneHotEncoder</span><span id="91b4" class="ng mf it nc b gy nl ni l nj nk"># initializing values<br/>data = {'Name':['Tom', 'Jack', 'Nick', 'John',<br/>                'Tom', 'Jack', 'Nick', 'John',<br/>                'Tom', 'Jack', 'Nick', 'John',],<br/>        'Time':[20, 21, 19, 18,<br/>                20, 100, 19, 18,<br/>                21, 22, 21, 20]<br/>}</span><span id="3fa7" class="ng mf it nc b gy nl ni l nj nk">#creating dataframe<br/>df = pd.DataFrame(data)</span><span id="efc7" class="ng mf it nc b gy nl ni l nj nk">#showing head<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/198326a9017accf69e531f03a6b52f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*UfqkmvVSPZPrdFS-FJqMYg.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我创建的数据框。图片作者。</p></figure><p id="c57d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了执行一键编码，我们可以使用下面的代码:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="f925" class="ng mf it nc b gy nh ni l nj nk">#creating instance of one-hot-encoder<br/>encoder = OneHotEncoder(handle_unknown='ignore')</span><span id="f310" class="ng mf it nc b gy nl ni l nj nk">#perform one-hot encoding on columns <br/>encoder_df = pd.DataFrame(encoder.fit_transform(df[['Name']]).toarray())</span><span id="e251" class="ng mf it nc b gy nl ni l nj nk">#merge one-hot encoded columns back with original DataFrame<br/>df2 = df.join(encoder_df)</span><span id="dffd" class="ng mf it nc b gy nl ni l nj nk">#drop columns with strings<br/>df2.drop('Name', axis=1, inplace=True)</span><span id="a398" class="ng mf it nc b gy nl ni l nj nk">#showing new head<br/>df2.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/715582fd9c55ab2d79e91d104e1b40c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*sai37tJJkWadLGUkBM4Oqw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用scikit-learn的编码数据帧。图片作者。</p></figure><p id="be39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，编码器创建了4个新列，相对于另一列(列“时间”)的值，全部用0和1填充。如果有十个(或更多)独立值成为新列，您可能会理解数据框会变成什么样。</p><p id="6ca4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，这个方法有一个问题:如你所见，新列是数字…你如何理解哪个数字代表你的旧字符串值？更具体地说:这些数字中哪个是汤姆，哪个是尼克？我们必须以某种方式重命名这些列。</p><p id="7b91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个过程中，我寻找了一些重命名列的解决方案，这样我们就不会丢失新列和旧列之间的关系(也就是Nick？)，但我只找到了一个，我对此不满意，所以我不会在这里展示它。</p><p id="d21e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，我在Linkedin上发布了这个方法，我网络中的一个家伙Filippo回答并建议我另一个方法。让我们看看。</p><h1 id="591d" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">3.熊猫中的“get_dummy”</h1><p id="115a" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">有一种更简单的方法来执行一键编码，它可以直接在熊猫身上完成。考虑我们之前创建的数据帧df。要对其进行编码，我们可以简单地编写以下代码行:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="140e" class="ng mf it nc b gy nh ni l nj nk">#one-hot encoding<br/>df3 = pd.get_dummies(df, dtype=int)</span><span id="62e8" class="ng mf it nc b gy nl ni l nj nk">#showing new head<br/>df3.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/99814c69915c09c4b2c7f65035e23488.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*GP-pvj7j4sZVyANnYfINEQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫的编码数据帧。图片作者。</p></figure><p id="8c4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就这么简单。只需一行代码，您就可以获得用“Name”列中的唯一值命名的列，并删除“Name”列。现在，如果您想要重命名列，例如从“Name_Jack”重命名为“Jack ”,您可以使用Pandas轻松完成，但是列的名称是已知的。</p><h1 id="2fe4" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="6a45" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">在本文中，我们已经了解了什么是一键编码，以及何时以及为什么要执行它。记住，我们必须在编码过程之后执行特征选择，我的建议是在Pandas中使用“get_dummy()”方法，这既快速又简单。你可以在文档<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html" rel="noopener ugc nofollow" target="_blank">上阅读更多关于“get_dummy()”方法的内容。</a></p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="04cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nw">让我们连在一起！</em></p><p id="0980" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://federicotrotta.medium.com/" rel="noopener"> <em class="nw">中等</em> </a></p><p id="7e4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.linkedin.com/in/federico-trotta/" rel="noopener ugc nofollow" target="_blank"> <em class="nw"> LINKEDIN </em> </a> <em class="nw">(向我发送连接请求)</em></p><p id="7820" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nw">如果你愿意，你可以</em> <a class="ae ky" href="https://federicotrotta.medium.com/subscribe" rel="noopener"> <em class="nw">订阅我的邮件列表</em> </a> <em class="nw">这样你就可以一直保持更新了！</em></p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="064b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑成为会员:你可以免费支持我和其他像我一样的作家。点击 <a class="ae ky" href="https://federicotrotta.medium.com/membership" rel="noopener"> <em class="nw">这里的</em> </a> <em class="nw">成为会员。</em></p></div></div>    
</body>
</html>