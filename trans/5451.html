<html>
<head>
<title>Functional Data Analysis: A Solution to the Curse of Dimensionality</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">功能数据分析:维数灾难的解决方案</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/functional-data-analysis-a-solution-to-the-curse-of-dimensionality-f83dd19fa6e8#2022-12-07">https://towardsdatascience.com/functional-data-analysis-a-solution-to-the-curse-of-dimensionality-f83dd19fa6e8#2022-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ef10" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">使用梯度增强和 FDA 对 Python 中的 ECG 数据进行分类</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/0306c44391f44c069050dbd9d0e3c944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ngl_O1Q0KFDzVfZ_GngDNw.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae kw" href="https://unsplash.com/s/photos/data-analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="1016" class="kx ky iq bd kz la lb lc ld le lf lg lh jw li jx lj jz lk ka ll kc lm kd ln lo bi translated"><strong class="ak">维度的诅咒</strong></h1><p id="be0d" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">维数灾难是指在机器学习中处理<strong class="lr ir">高维数据集</strong>时出现的挑战和困难。随着数据集中维度(或特征)数量的增加，准确了解特征和目标变量之间的关系所需的数据量呈指数增长。这使得在高维数据集上训练高性能的机器学习模型变得困难。</p><p id="59a3" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">维数灾难是机器学习中的一个问题的另一个原因是，它可能导致过度拟合。在处理高维数据集时，很容易包含不相关或冗余的特征，这些特征对模型的预测能力没有贡献。这可能会导致模型过于接近定型数据，从而导致对看不见的数据的泛化能力很差。</p><h1 id="d57e" class="kx ky iq bd kz la lb lc ld le lf lg lh jw li jx lj jz lk ka ll kc lm kd ln lo bi translated">功能<strong class="ak">数据分析</strong></h1><p id="b229" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated"><strong class="lr ir">功能数据分析(FDA) </strong>是一种统计分析，用于分析连续曲线或函数形式的数据，而不是统计分析中常用的传统表格数据。在函数数据分析中，目标是通过检查函数本身之间的关系，而不仅仅是单个数据点，来建模和理解数据的底层结构。这种类型的分析对于复杂或依赖于时间的数据集特别有用，并且<strong class="lr ir">可以提供传统统计技术无法提供的洞察力。</strong></p><p id="2fd4" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">函数数据分析在许多不同的情况下都很有用。例如，它可用于对可能具有大量底层结构的复杂数据集进行建模，如时序数据或连续测量的数据。它还可用于识别数据中的模式和趋势，这些模式和趋势在查看单个数据点时可能不明显。[1]此外，函数数据分析可以提供对数据集中不同变量之间关系的更详细和细微的理解，这对于进行预测或开发新理论是有用的。<strong class="lr ir">功能数据分析的使用可以帮助研究人员更深入地理解他们正在处理的数据</strong>，并揭示从更传统的统计技术中可能不明显的见解。</p><h2 id="bd18" class="mq ky iq bd kz mr ms dn ld mt mu dp lh ly mv mw lj mc mx my ll mg mz na ln nb bi translated">功能数据表示</h2><p id="ccae" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">可以将数据从离散集合<strong class="lr ir">x₂…xₜx₁</strong>转换成函数形式。换句话说，我们可以将数据表示为函数，而不是离散的点。</p><p id="ad98" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">在函数数据分析中，基是用来表示连续曲线或函数的一组函数。<strong class="lr ir"> </strong>这个过程也叫基平滑。<strong class="lr ir"> </strong>平滑过程如公式 1 <strong class="lr ir">所示。它包括将统计单位 xᵢ表示为系数 cᵢₛ和基函数φₛ.的线性组合</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/5808172917ccfc30b8f276f556f35b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*7BpVVo85l_XKAMWZKKJUjw.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">等式 1。功能数据表示。[2]</p></figure><h1 id="2fc3" class="kx ky iq bd kz la lb lc ld le lf lg lh jw li jx lj jz lk ka ll kc lm kd ln lo bi translated">基本类型</h1><p id="8507" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">根据数据的性质和分析的具体目标，可以使用不同类型的基础。一些常见类型的基包括傅立叶基、多项式基、样条基和小波基。每种类型的基础都有其独特的属性，可用于不同类型的数据和分析。例如，傅立叶基常用于具有周期性结构的数据，而多项式基则适用于由多项式函数近似的数据。一般来说，<strong class="lr ir">基础的选择将取决于数据的具体特征和分析的目标。</strong></p><h2 id="5e02" class="mq ky iq bd kz mr ms dn ld mt mu dp lh ly mv mw lj mc mx my ll mg mz na ln nb bi translated"><strong class="ak"> B 样条</strong> <strong class="ak">基础</strong></h2><p id="1419" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">在函数数据分析中，B 样条基是一种使用 B 样条函数构造的基。<strong class="lr ir"> B 样条函数是计算机图形学和数值分析中常用的分段多项式函数</strong>。在 B 样条基中，函数以特定的方式排列，以便它们可以用来表示任何连续的曲线或函数。b 样条基常用于函数数据分析，因为它们有许多有用的性质。b 样条基是 FDA 研究中使用最多的基。[3] <br/>图 1 显示了一个三次 B 样条基的例子。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nd"><img src="../Images/4320ecfd5efde21d008887ef7d268db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T1b95Y_colkjj6c8HaG0lA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图一。三次 B 样条基，使用 n = 15。图片作者。</p></figure><h2 id="bc17" class="mq ky iq bd kz mr ms dn ld mt mu dp lh ly mv mw lj mc mx my ll mg mz na ln nb bi translated">FDA 如何降低数据的维度？</h2><p id="8b2e" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">让我们来看一个 FDA 的 Python 实现，以展示这种强大的技术如何在一些数据集上很好地工作，从而既降低维度又提高准确性。您可以在文章末尾找到完整的代码链接。该过程如下:</p><p id="d194" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated"><strong class="lr ir"> 1。选择一个数据集<br/> </strong>对于下面的例子，我使用的是<a class="ae kw" href="https://physionet.org/content/chfdb/1.0.0/" rel="noopener ugc nofollow" target="_blank"> BIDMC 充血性心力衰竭数据库</a>【4】【5】数据集。该分析基于一个名为<a class="ae kw" href="https://timeseriesclassification.com/description.php?Dataset=ECG5000" rel="noopener ugc nofollow" target="_blank"> ECG5000 </a>的预处理版本。如图 2 所示，数据集是一个具有 140 个特征(时刻)和 5000 个实例(500 个用于训练集，4500 个用于测试集)的时间序列。在目标变量中有五个等级，有四种不同类型的心脏病。对于这种分析，我们将只考虑一个二元目标，如果心跳正常，则为 0，如果受到心脏病的影响，则为 1。<strong class="lr ir">训练集大小为 500x140，是一个高维数据集。</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/5b1126a3cb790261436c8015f5f303e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2PfydpMtEviIHSx2dhu9w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图二。ECG5000 数据集。数据集的目的是预测心脏病。图片作者。</p></figure><p id="dfd4" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated"><strong class="lr ir"> 2。选择一个基础。<br/> </strong>我选择了如图 1 所示的基础。</p><p id="ce5a" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated"><strong class="lr ir"> 3。以函数形式表示数据。<br/> </strong>图 3 显示了使用具有 15 个函数的 B 样条将数据转换为函数形式后的结果。我已经用 python 库<a class="ae kw" href="https://fda.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> scikit-fda </a>用下面的代码完成了。</p><pre class="kh ki kj kk gt nf ng nh bn ni nj bi"><span id="eaf9" class="nk ky iq ng b be nl nm l nn no">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>from skfda.representation.basis import BSpline<br/>from skfda.representation import FDataGrid, FDataBasis<br/><br/>train = pd.read_csv(f'ECG5000_TRAIN.arff', header=None)<br/>test = pd.read_csv(f'ECG5000_TEST.arff', header=None)<br/>y_train = train.iloc[:, -1]<br/>y_train = [1 if i == 1 else 0 for i in y_train]<br/>X_train = train.iloc[:, :-1]<br/>y_test = test.iloc[:, -1]<br/>y_test = [1 if i == 1 else 0 for i in y_test]<br/>X_test = test.iloc[:, :-1]<br/><br/>basis = BSpline(n_basis=15, order = 3)<br/>X_train_FDA = FDataBasis.from_data(X_train, grid_points= np.linspace(0, 1, 140), basis=basis)<br/>X_test_FDA = FDataBasis.from_data(X_test, grid_points= np.linspace(0, 1, 140), basis=basis)<br/><br/>X_train_FDA = X_train_FDA.coefficients<br/>X_test_FDA = X_test_FDA.coefficients</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi np"><img src="../Images/96588ffcd3959b18b6ea72bb030ac0ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4I2TyIGx-pL7xNSQGjB24w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图 3。用函数表示的 ECG5000。图片作者。</p></figure><p id="81d6" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated"><strong class="lr ir"> 4。最后，提取系数。这是你的新数据集。<br/> </strong>基础集中有 15 个功能。因此，要使用 15 个系数。该过程有效地将维数从 140 减少到 15 个特征。现在让我们训练一个 XGBoost 模型来评估准确性是否受到影响。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nq"><img src="../Images/41b8a4c899d99346d7b401d418ac2859.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfxF0uBALQNx-UOIMcPhaw.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图 4。ECG5000 数据集上的 FDA 之前和之后。图片作者。</p></figure><p id="005a" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">可以观察到，在将特征的数量减少了几乎 10 倍之后，准确度提高了！</p><h2 id="9974" class="mq ky iq bd kz mr ms dn ld mt mu dp lh ly mv mw lj mc mx my ll mg mz na ln nb bi translated">还有一步:添加衍生品</h2><p id="5fc4" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">导数是一个数学概念，用来衡量函数相对于它的一个自变量的变化率。在函数数据分析的背景下，导数可用于定量描述函数数据集的平滑度和形状。例如，函数的一阶导数可用于识别局部最大值和最小值，而二阶导数可用于识别拐点。</p><p id="687f" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">导数也可以用来确定函数的斜率或曲率的变化。这对于识别一段时间内数据的趋势或变化非常有用。此外，导数可用于通过多项式展开来逼近原始函数，这对于进行预测或对数据执行其他分析非常有用。<br/>图 5 显示了添加一阶和二阶导数后精度的提高。导数以同样的方式加入。首先，我们对函数形式求导，并将基系数添加到数据集。对二阶导数重复这一过程。</p><p id="f52c" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">由于我们添加了额外的功能，维度增加了。然而，它还不到原始数据集的三分之一。混淆矩阵显示,<strong class="lr ir">衍生工具为模型</strong>增加了重要信息，显著减少了假阴性的数量，并且<strong class="lr ir">实现了对健康个体近乎完美的分类。</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/93a56bd694d9bfa7d60a03e2b7fd03ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*dCtWillefWKcFWqBeOXowQ.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图 5。特征加导数后的结果。图片作者。</p></figure><h2 id="832f" class="mq ky iq bd kz mr ms dn ld mt mu dp lh ly mv mw lj mc mx my ll mg mz na ln nb bi translated">结论</h2><p id="e138" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">总的来说，FDA 是分析功能数据的强大工具，在工程、经济和生物学等领域有广泛的应用。它能够使用函数形式对函数数据进行建模，并应用广泛的统计方法，这使它成为在某些情况下降低维度和提高准确性的重要工具。</p><h2 id="0276" class="mq ky iq bd kz mr ms dn ld mt mu dp lh ly mv mw lj mc mx my ll mg mz na ln nb bi translated">参考</h2><p id="91ad" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">您可以在<a class="ae kw" href="https://github.com/reese3222/fda-ecg5000/blob/main/fda-ecg5000.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到数据集以及图和模型的完整代码。</p><p id="3274" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">[1] Ramsay，j .，&amp; Silverman，B. W. <em class="ns">功能数据分析</em> (2010) <em class="ns">(统计学中的 Springer 系列)</em>(精装第 2 版软装再版。2005).斯普林格。</p><p id="02a7" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">[2] Maturo，f .，&amp; Verde，r .生物医学信号监督分类的汇集随机森林和功能数据分析:心电图数据的理论和应用。(2022).<em class="ns">医学统计学</em>，<em class="ns"> 41 </em> (12)，2247–2275。<a class="ae kw" href="https://doi.org/10.1002/sim.9353" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1002/sim.9353</a></p><p id="272d" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">[3]s .乌拉和 f .芬奇。功能数据分析的应用:系统综述。(2013) <em class="ns"> BMC 医学研究方法论</em>，<em class="ns"> 13 </em> (1)。【https://doi.org/10.1186/1471-2288-13-43】</p><p id="fd10" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">[4] Baim DS，Colucci WS，Monrad ES，Smith HS，Wright RF，Lanoue A，Gauthier DF，Ransil BJ，Grossman W，Braunwald E .口服米力农治疗严重充血性心力衰竭患者的生存率。美国心脏病学会，1986 年 3 月；7(3):661–670.<a class="ae kw" href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;list_uids=3950244&amp;dopt=Abstract" rel="noopener ugc nofollow" target="_blank">http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db = PubMed&amp;list _ UIDs = 3950244&amp;dopt = Abstract</a></p><p id="90bf" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">[5] Goldberger，a .，Amaral，l .，Glass，l .，Hausdorff，j .，Ivanov，P. C .，Mark，r .，…和 Stanley，H. E. (2000 年)。生理银行、生理工具包和生理网:复杂生理信号新研究资源的组成部分。循环[ <a class="ae kw" href="https://physionet.org/" rel="noopener ugc nofollow" target="_blank">在线</a>。101 (23)，第 e215–e220 页。</p></div></div>    
</body>
</html>