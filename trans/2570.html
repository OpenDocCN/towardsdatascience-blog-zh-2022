<html>
<head>
<title>How To Stratify Data in Machine Learning Projects to Significantly Improve Model Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对机器学习项目中的数据进行分层，以显著提高模型性能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-stratify-data-in-machine-learning-projects-to-significantly-improve-model-performance-4929b600340b#2022-06-03">https://towardsdatascience.com/how-to-stratify-data-in-machine-learning-projects-to-significantly-improve-model-performance-4929b600340b#2022-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="150a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何以及何时对机器学习项目中的数据进行分层，以确保仅使用7行Python代码就能做出准确且有意义的预测</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/34ca3ce662cb2697b7ca374b139ff685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cc8T9cgYv4r2ik4akjsCyA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@muhozi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">金刚砂木火子</a>在<a class="ae ky" href="https://unsplash.com/s/photos/rock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="9961" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">背景</h2><p id="7906" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我最近参与了一个真实世界的机器学习项目，该项目最初产生了一组预测，但这些预测被领域专家拒绝，因为他们无法接受未来会以模型预测的方式出现。</p><p id="1c00" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">问题的原因围绕着数据所代表的业务方面随时间变化的性质，即未来不会像过去一样。</p><p id="2797" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这可能意味着机器学习模型可能不够准确，没有意义，但最终通过对数据进行分层找到了解决方案，这促使我写了这篇文章来分享该解决方案，以便其他遇到类似问题的数据科学家可以使用它。</p><h2 id="0217" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">入门指南</h2><p id="7b82" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我们首先需要的是一些数据。项目中使用的真实数据不能共享，所以我使用Faker库从头开始创建了一个虚拟数据集。这意味着<strong class="lx iu">对数据没有许可限制，数据可以用于或重新用于学习和开发目的</strong>。</p><div class="mt mu gp gr mv mw"><a href="https://faker.readthedocs.io/en/master/" rel="noopener  ugc nofollow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">欢迎来到Faker的文档！- Faker 13.12.0文件</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">Faker是一个为你生成假数据的Python包。无论您是否需要引导数据库，创建…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">faker.readthedocs.io</p></div></div></div></a></div><p id="abcb" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">让我们从导入我们需要的库开始，然后读入虚构的数据集…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/ed6f45ea0ff9380255dc7289a6d47f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_t6ULuMsnGRulyZGoUzqA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6dc5" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><code class="fe ni nj nk nl b">CompletedCustomerLoans.xlsx</code>表示虚拟贷款已经以存储在<code class="fe ni nj nk nl b">LoanStatus</code>目标特征中的两种状态或分类之一完成。“已偿还”贷款已成功完成并由客户偿还，而“违约”贷款未偿还且未成功完成。</p><p id="8c18" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><code class="fe ni nj nk nl b">LiveCustomerLoans.xlsx</code>有完全相同的格式，但没有<code class="fe ni nj nk nl b">LoanStatus</code>，因为它们仍在运行，尚未完成，无论成功与否。</p><h2 id="e325" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">理解问题</h2><p id="81c5" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">机器学习的一个很好的用途是在已完成的贷款上训练一个模型，该模型可以预测当前贷款的未来贷款状态。</p><p id="684e" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">然而，我们需要两样东西来让一个模型以这种方式工作-</p><ul class=""><li id="929d" class="nm nn it lx b ly mo mb mp li no lm np lq nq mn nr ns nt nu bi translated">一组可靠、准确和一致的历史数据</li><li id="62bb" class="nm nn it lx b ly nv mb nw li nx lm ny lq nz mn nr ns nt nu bi translated">未来会以与过去相似的方式发展</li></ul><p id="60b3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">第二个因素是我们在这个数据集上有一些问题。此数据中的一个重要因素是<code class="fe ni nj nk nl b">LoanType</code>，它可以是青铜、白银、黄金或白金。</p><p id="cc00" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">贷款构成随时间变化的方式可以想象如下-</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a785452d25b47ef08db615370e53747c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*HkUXDsvapTW2Ntx0fixomw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/45cbcbaa0b57c3675784f9619ecdf160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*g8rXaAHLAa8M-zmQoa9c5g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4e04" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这些图表突出了这个问题。历史/已完成贷款有大量的青铜、白银和黄金贷款，但活贷款/未完成贷款没有。看起来我们的虚构贷款业务正在将所有未来客户转换为白金贷款，并停止其他贷款类型。</p><p id="d6e3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果不同类型的贷款在偿还和违约方面的表现不同，那么机器学习模型将产生扭曲的预测。</p><p id="59a7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果遇到这种情况，您可能需要根据实时数据中的比例对训练数据进行分层，以提高预测的准确性。</p><p id="8d83" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">本文的剩余部分将展示如何用不到5行的Python代码来实现这一点…</p><h2 id="bb73" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">实现解决方案(前5行代码)</h2><p id="3756" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">基于在另一个数据集中发现的任何要素组合的比例对一个数据集进行分层的可重用函数可按如下方式实现</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/08648f30d1abc18d4939592fef0c3003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*3kaIC5nAMhIElIfs63QpBA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/e52d771b0f67f365f917be7dc8d6126f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6caH_a36FiWRW70U6pYzBg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="180b" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">了解解决方案</h2><p id="1506" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated"><code class="fe ni nj nk nl b">stratify</code>函数只用了3行代码就实现了它的目的，这是Pythonic式的方法，但是减少代码行数会降低可读性，所以让我们把它拆开来看看到底发生了什么...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="8ca3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这是第一行代码…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="bb8b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><code class="fe ni nj nk nl b">stratify_cols</code>包含用于构建权重的数据字段列表。</p><p id="cfa8" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这行代码的返回类型是Pandas系列，其中index包含在人口数据中找到的值的范围，value包含找到该值的行的百分比。</p><p id="b1b1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><code class="fe ni nj nk nl b">normalize=True</code>告诉<code class="fe ni nj nk nl b">value_counts</code>返回百分比而不是实际计数。然后将这些值乘以在样本数据中找到的记录总数(<code class="fe ni nj nk nl b">sample.shape[0]</code>)，得到样本数据集中所需的记录数，以反映在总体中找到的比例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt oe nl of og aw oh bi"><span id="e69e" class="kz la it nl b gy oi oj l ok ol">&lt;class 'pandas.core.series.Series'&gt;<br/>MultiIndex([('Platinum',),<br/>            (  'Silver',),<br/>            (  'Bronze',),<br/>            (    'Gold',)],<br/>           names=['LoanType'])</span><span id="43af" class="kz la it nl b gy om oj l ok ol">LoanType<br/>Platinum    2032<br/>Silver       367<br/>Bronze       170<br/>Gold         170<br/>dtype: int32</span></pre><p id="ee24" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">下面是下一行代码。它做了很多事情，我将分阶段解释…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="4329" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">让我们从头开始。<code class="fe ni nj nk nl b">sample.groupby(stratify_cols)</code>返回一个<code class="fe ni nj nk nl b">DataFrameGroupBy</code>对象，为在<code class="fe ni nj nk nl b">stratify_cols</code>中找到的每个唯一组合分组。这可以想象如下...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt oe nl of og aw oh bi"><span id="deeb" class="kz la it nl b gy oi oj l ok ol">Bronze<br/>Gold<br/>Platinum<br/>Silver</span></pre><p id="ad38" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><code class="fe ni nj nk nl b">group.sample(n=weights[group.name])</code>然后使用组名索引权重系列，并提取要采样的记录数...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt oe nl of og aw oh bi"><span id="bb4b" class="kz la it nl b gy oi oj l ok ol">170</span></pre><p id="22c7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最后一部分只是承认样本数据中可能有在总体数据中找不到的值，所以内联<code class="fe ni nj nk nl b">if</code>语句只对任何符合该条件的数据进行零行采样</p><pre class="kj kk kl km gt oe nl of og aw oh bi"><span id="518d" class="kz la it nl b gy oi oj l ok ol">group.sample(n=weights[group.name] if group.name in weights else 0</span></pre><p id="e7c8" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">样本中的参数<code class="fe ni nj nk nl b">replace=True</code>将每个采样行放回数据中，以便在必要时可以重新采样，并且<code class="fe ni nj nk nl b">random_state</code>被设置为支持可再现的结果。</p><p id="ce8c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最后，lambda函数的魔力意味着为每个组返回的样本被连接在一起，产生一个单独的<code class="fe ni nj nk nl b">DataFrame</code>。</p><p id="46f7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了解释第三行也是最后一行代码，让我们快速看一下<code class="fe ni nj nk nl b">df_return</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/cab95b2f2be7d52f2b382f64712a99b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_-fjbudXd3IaWrx0JiL4g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7008" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这看起来不太对。Pandas已经返回了一个<code class="fe ni nj nk nl b">MultiIndex</code>，这需要看起来像在原始数据中找到的简单索引，而不丢失索引值。</p><p id="3cc4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这需要进行大量的研究和文档阅读，但事实证明，通过删除与最初用于构建索引的特性相关的多部分，可以将索引恢复到原始格式</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/e70e6cc08c0ff9e037da0d1d0c118831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJnVRXAe0nLR7xZ2PghUBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="1a5f" class="oo la it bd lb op oq or le os ot ou lh jz ov ka ll kc ow kd lp kf ox kg lt oy bi translated">最后的改进(总共7行代码)</h1><p id="4e8a" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">现在我们有了一个函数，可以通过在另一个数据集中找到的比例对任何数据集进行分层，但是如果我们只知道所需的比例，但没有人口数据集，那该怎么办呢？</p><p id="1ca1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这可以通过在<code class="fe ni nj nk nl b">build_weights</code>函数中增加一行代码和对<code class="fe ni nj nk nl b">stratify</code>做一点小小的修改来实现，以接受<code class="fe ni nj nk nl b">weights</code>作为可选参数。</p><p id="9638" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">请注意，如果<code class="fe ni nj nk nl b">values</code>的列表代表行数，则<code class="fe ni nj nk nl b">sample_size</code>被设置为<code class="fe ni nj nk nl b">0</code>。如果<code class="fe ni nj nk nl b">values</code>包含一组加起来等于<code class="fe ni nj nk nl b">1</code>的浮点数(即百分比)，则<code class="fe ni nj nk nl b">sample_size</code>包含要乘以百分比进行采样的记录数。</p><p id="3f18" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><code class="fe ni nj nk nl b">build_weights</code>中的一行代码相当简单明了。它使用内联的<code class="fe ni nj nk nl b">if</code>语句为<code class="fe ni nj nk nl b">data</code>和<code class="fe ni nj nk nl b">index</code>参数传递适当的值。为了找到如何为不止一个层次的实例构造一个<code class="fe ni nj nk nl b">MultiIndex</code>,但是完成的代码非常干净，确实花费了相当多的研究...</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt oe nl of og aw oh bi"><span id="ff9f" class="kz la it nl b gy oi oj l ok ol">Bronze      1000<br/>Silver       500<br/>Gold         250<br/>Platinum     100<br/>dtype: int64</span></pre><p id="f0b7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">或者…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><pre class="kj kk kl km gt oe nl of og aw oh bi"><span id="4154" class="kz la it nl b gy oi oj l ok ol">Bronze      1000<br/>Silver       500<br/>Gold         250<br/>Platinum     100<br/>dtype: int64</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/d727f12db312489f02b20657900d1a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lJcvdDYRwhiaYTGo4ahK6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="c406" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h2><p id="20f2" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">在本文中，对数据进行分层可以显著提高机器学习模型的性能。这已经通过引用真实世界的项目来呈现，然后使用虚构和合成的数据来演示。</p><p id="c669" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">仅用3行Python代码就开发了一个简单的函数，该函数可以根据在另一个数据集中发现的比例对任何数据集进行分层，从而为符合所述条件的建模准备数据。</p><p id="0e21" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最后，还提供了一个额外的函数，该函数可以构建权重并将其传递给执行分层的函数，以满足数据科学家知道比例应该是多少，但无法访问包含正确比例的数据集的情况。</p><h2 id="becf" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">感谢您的阅读！</h2><p id="5530" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">如果你喜欢读这篇文章，为什么不看看我在https://grahamharrison-86487.medium.com/的其他文章呢？此外，我很乐意听到您对这篇文章、我的任何其他文章或任何与数据科学和数据分析相关的内容的看法。</p><p id="2d01" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果你想联系我讨论这些话题，请在LinkedIn上找我—【https://www.linkedin.com/in/grahamharrison1 T2】或者发电子邮件到<a class="ae ky" href="mailto:GHarrison@lincolncollege.ac.uk" rel="noopener ugc nofollow" target="_blank">ghar rison @ Lincoln college . AC . uk</a>。</p><p id="b8dc" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果你想通过订阅来支持作者和全世界1000个为文章写作做出贡献的人，请使用下面的链接(注意:如果你使用这个链接免费注册，作者将收到一定比例的费用)。</p><div class="mt mu gp gr mv mw"><a href="https://grahamharrison-86487.medium.com/membership" rel="noopener follow" target="_blank"><div class="mx ab fo"><div class="my ab mz cl cj na"><h2 class="bd iu gy z fp nb fr fs nc fu fw is bi translated">通过我的推荐链接加入媒体-格雷厄姆哈里森</h2><div class="nd l"><h3 class="bd b gy z fp nb fr fs nc fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ne l"><p class="bd b dl z fp nb fr fs nc fu fw dk translated">grahamharrison-86487.medium.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ks mw"/></div></div></a></div></div></div>    
</body>
</html>