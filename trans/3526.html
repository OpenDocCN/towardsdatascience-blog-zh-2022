<html>
<head>
<title>What Do You Do When Git Goes Wrong?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当Git出错时，你会怎么做？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-do-you-do-when-git-goes-wrong-a50d20595a80#2022-08-04">https://towardsdatascience.com/what-do-you-do-when-git-goes-wrong-a50d20595a80#2022-08-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="002e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何安全地恢复最新提交</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f01ae002d10271c9607d4bbba9e51d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ufMYtjKeXgdeG9KQlemDGg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">吉姆·威尔逊在<a class="ae ky" href="https://unsplash.com/s/photos/revert?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="84a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有没有遇到过这样的情况，当你的git严重出错，你需要拼命恢复？我发现自己偶尔会遇到这种情况，人们似乎也会遇到同样的问题。许多新的Git用户在第一次遇到这种情况时可能会感到绝望。因此，在本文中，我将向您展示当git出错时该做什么，以及如何安全地修复它。</p><h1 id="dcd8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Git问题</h1><p id="1bf9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">长话短说，我忘记了为我的代码使用分支，并且没有首先做<code class="fe ms mt mu mv b">git pull</code>从远程存储库中获取所有的更改就提交了我的更改。结果是:</p><ul class=""><li id="e8fc" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><code class="fe ms mt mu mv b">git push</code>被拒。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/5b09c623243bff8605cabdbdec7bc5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tuGtTV6tO2ZZ0tpi9s4Syg.png"/></div></div></figure><ul class=""><li id="3450" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><code class="fe ms mt mu mv b">git pull</code>也不行。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/dc18f473932bf5e7b385851cf1027b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N7eZ4_xO1Q3saUsx8qE8zA.png"/></div></div></figure><h1 id="6f8b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">解决方案</h1><p id="b125" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">上面的“提示”里有一些很好的建议。但有时我们想做的只是撤销最近的提交。与此同时，我们可能仍然需要最近一次提交所做的更改，并且不想丢失它们。有多种方法可以做到这一点。我是这样做的:</p><ul class=""><li id="d1c3" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">我检查我的<code class="fe ms mt mu mv b">git log</code>，它显示了我所有的提交历史:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/737347f9a680606c93698e2051a82c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33lYIvEQUCq4-LWCfeMUHw.png"/></div></div></figure><ul class=""><li id="d509" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">然后，我复制并粘贴我的最新提交ID。我执行<code class="fe ms mt mu mv b">git diff commit_id &gt; patch</code>来保存最近提交到文件的差异。这一步非常重要。这允许我们将最近提交的更改保存到一个单独的文件中。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/82689f68de781beea2edf32d61e2aa46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dnN8nK2zuRFjN2BWjXT5sg.png"/></div></div></figure><ul class=""><li id="d256" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">然后我做了一个<code class="fe ms mt mu mv b">git reset --hard HEAD^</code>来回复到之前的提交。注意这是一个<strong class="lb iu">危险区域</strong>。您将丢失最近提交的内容。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/4864f8a79b137aa24379f1b76595d39e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IVChkeUDoiaxPWR_SxojTg.png"/></div></div></figure><ul class=""><li id="9712" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">现在，当我们再次检查<code class="fe ms mt mu mv b">git log</code>时，我们确实处于之前的提交状态:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/f9ef16a3e2015e73004538cbc1f99c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JO7LuEWPKytNVMOF-Nkgg.png"/></div></div></figure><ul class=""><li id="ee4d" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">然后我们终于可以做一个<code class="fe ms mt mu mv b">git pull</code></li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/8d54e5cb5126aab188bb6d9762fd316c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ih587jnxY6OttoKf7OFrYA.png"/></div></div></figure><ul class=""><li id="446e" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">如果我们仍然想要应用我们最近提交的更改，我们想要做什么？请记住，我们已经将差异保存在补丁文件中。在这里，我们可以运行<code class="fe ms mt mu mv b">patch -p1 &lt; patch</code>来应用这些更改。我先做了一次预演，以确保一切正常。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/a0241035b8e9c99f67cacdd3fc7105bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fEt7YjcEFdrE_Lma12OiwA.png"/></div></div></figure><ul class=""><li id="36e7" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">现在我们可以在<code class="fe ms mt mu mv b">git diff</code>中看到文件变更，我们可以使用<code class="fe ms mt mu mv b">git commit -a</code>提交所有变更，使用<code class="fe ms mt mu mv b">git push</code>成功推送变更。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/4b73226851128c160e4c6a51421bb7b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XwQtQvxkOTsahjXdDW_nTA.png"/></div></div></figure><h1 id="3693" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">摘要</h1><p id="a89a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">总之，下面是我为解决冲突和保存文件更改而执行的git命令:</p><pre class="kj kk kl km gt no mv np nq aw nr bi"><span id="7ef3" class="ns lw it mv b gy nt nu l nv nw"># get the id of the lastest commit<br/>git log</span><span id="d6af" class="ns lw it mv b gy nx nu l nv nw"># save the diff from the latest commit to a patch file<br/>git diff 13fd7bc9219ee10f64b803303e6d90f94bb6e219 &gt; patch </span><span id="238c" class="ns lw it mv b gy nx nu l nv nw"># revert to the previous commit<br/>git reset — hard HEAD^ </span><span id="d1d9" class="ns lw it mv b gy nx nu l nv nw"># confirm that we are at the previous commit<br/>git log </span><span id="3f54" class="ns lw it mv b gy nx nu l nv nw"># fetch changes from repo<br/>git pull</span><span id="24c9" class="ns lw it mv b gy nx nu l nv nw"># apply file changes from the path file<br/>patch -p1 — dry-run &lt; patch <br/>patch -p1 &lt; patch </span><span id="8cc6" class="ns lw it mv b gy nx nu l nv nw"># check git diff on the file changes<br/>git diff </span><span id="f0d5" class="ns lw it mv b gy nx nu l nv nw"># commit changes<br/>git commit -a </span><span id="e619" class="ns lw it mv b gy nx nu l nv nw"># push changes<br/>git push</span></pre><p id="a8ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我知道你在这种情况下通常做什么，如果你有任何建议。请随意与我分享您使用git的有趣经历！:)</p></div></div>    
</body>
</html>