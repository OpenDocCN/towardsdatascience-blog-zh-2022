<html>
<head>
<title>Find the Difference between Two Angles using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 找到两个角度之间的差异</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/find-the-difference-between-two-angles-using-python-ac553a1ef5c0#2022-02-23">https://towardsdatascience.com/find-the-difference-between-two-angles-using-python-ac553a1ef5c0#2022-02-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c0e6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">因为在角度从 355 度变为 5 度之前，这都是一种乐趣和游戏</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/32788c9a736c13fa292b0849c2ffe702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MGc-wjhJRf_7xUYE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ray027?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sunil Ray </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="e217" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我的业务领域(海上风力)，我花了很多时间分析风力数据，但直到最近我才尝试使用 python 来分析风向随时间的变化。所以直到最近我才意识到我不知道该怎么做。</p><p id="8a8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来很简单，如果方向从 350 度变到 320 度，从另一个中减去一个，得到绝对值，这就是 30 度的变化。但是等一下，等一下…</p><p id="7208" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 350 度到 5 度的变化是 15 度或 345 度的变化，这取决于变化发生的方向。同样，从 250 度到 200 度的变化可以是 50 度，也可以是 450 度。如果您正在处理大型数据集(或者只是通常重视您的时间)，打开巨大的文件，手动检查每个文件并编辑正确的结果是不可行的。你和你的电脑都可能会认输，所以需要一个自动化的解决方案。</p><p id="5eca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在整篇文章中，我将使用风向作为例子，但这适用于任何使用角度或弧度的东西，并寻求随时间的变化。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="4d6e" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">目录</h2><h2 id="b493" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated"><a class="ae ky" href="#cd3a" rel="noopener ugc nofollow"> 1。必要的假设</a></h2><h2 id="9c2f" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated"><a class="ae ky" href="#cc4d" rel="noopener ugc nofollow"> 2。代码</a></h2><h2 id="a788" class="mc md it bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated"><a class="ae ky" href="#9ac4" rel="noopener ugc nofollow"> 3。解释</a></h2></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="cd3a" class="mv md it bd me mw mx my mh mz na nb mk jz nc ka mn kc nd kd mq kf ne kg mt nf bi translated">必要的假设</h1><p id="b0ed" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">如前所述，当方向通过北方，或零度时，我们的简单方法就失败了。将度数转换成弧度也不能解决问题(相信我，我试过了)。相反，我们需要对方向行为进行假设。</p><p id="a118" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果方向从 350 度变为 5 度，那就是 15 度的变化，只有<strong class="lb iu"> </strong>如果，<strong class="lb iu">是顺时针方向。</strong>即<strong class="lb iu"> </strong>如果风向从 350 度变化到 351 度、352 度…..359，0，1 … 5 度。也有可能风向已经从 350 度变成了 349 度，348 度…6、5 度或逆时针方向。这两个选项如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/a4fd0ec761ce5af6e584647587817129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hOcsPzK2Lf3d6a9lTrTAvA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">角度方向可以逆时针(红色)或顺时针(蓝色)改变。作者提供的图片-未按比例绘制。</p></figure><p id="638e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两种情况实际上是否可能取决于数据类型和数据粒度。例如，一艘船的航向有可能在三秒钟内改变 190 度吗？极端天气会导致极端风向改变吗？</p><p id="a8f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使建议的解决方案起作用，我们必须假设<strong class="lb iu">不可能在给定的周期内方向改变超过 180 度</strong>。即，如果数据是一分钟粒度的时间序列，从分钟 1 到分钟 2，超过 180 度的真正方向改变是不可能的。</p><p id="49f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果这对您的数据集不起作用，请格外小心！考虑你拥有的可以证明或反驳这一理论的任何其他数据点，如果可能的话，获取更高频率的数据，以便这一假设可以成立。</p><h1 id="cc4d" class="mv md it bd me mw nm my mh mz nn nb mk jz no ka mn kc np kd mq kf nq kg mt nf bi translated">代码</h1><p id="bf21" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">这不是一个完美的 pythonic 解决方案，但是对于我的用例来说，它完成了工作。下面的片段使用了熊猫图书馆，关于它的文档可以在<a class="ae ky" href="https://pandas.pydata.org/docs/" rel="noopener ugc nofollow" target="_blank">这里找到。</a></p><pre class="kj kk kl km gt nr ns nt nu aw nv bi"><span id="9dfb" class="mc md it ns b gy nw nx l ny nz"><strong class="ns iu"># find diff between min and max wind direction</strong></span><span id="8b2f" class="mc md it ns b gy oa nx l ny nz">df['delta'] = df.max_winddirection - df.min_winddirection<br/>    <br/><strong class="ns iu"># check for if difference minimun &lt; max - 180, if so, use different equation to get degree change<br/></strong>  <br/>df.loc[df.min_winddirection &lt; df.max_winddirection - 180, 'delta'] = 360 - df.max_winddirection + df.min_winddirection</span></pre><h1 id="9ac4" class="mv md it bd me mw nm my mh mz nn nb mk jz no ka mn kc np kd mq kf nq kg mt nf bi translated">解释</h1><p id="a824" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">以 350 度到 5 度为例。</p><ol class=""><li id="a25a" class="ob oc it lb b lc ld lf lg li od lm oe lq of lu og oh oi oj bi translated">上面的代码首先为所有行分配基本的 delta 方程“最大角度-最小角度”。这将应用 350 作为该行的增量。</li><li id="6632" class="ob oc it lb b lc ok lf ol li om lm on lq oo lu og oh oi oj bi translated">代码检查是否满足这些“穿过北方”情况的标准。这将检查是否:<em class="op">最小角度&lt;最大角度—180”</em>。在这种情况下，5 小于(350–180 ),因此为真。</li><li id="bd3f" class="ob oc it lb b lc ok lf ol li om lm on lq oo lu og oh oi oj bi translated">该代码应用了一个新的公式，当δ为真时为<em class="op">“360-最大角度+最小角度”。</em>导致 15 度。</li></ol><p id="d018" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果不满足“穿过北方”标准，将毫无问题地应用基本最大值减去最小值公式。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="9136" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这对你有所帮助。如果你有一个更干净的替代解决方案，我很乐意从中学习，请随时在评论中提出来。</p></div></div>    
</body>
</html>