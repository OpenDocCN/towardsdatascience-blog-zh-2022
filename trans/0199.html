<html>
<head>
<title>How to Easily Access and Download Public Data from National Statistical Institutions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何方便地从国家统计机构获取和下载公共数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-access-and-download-public-data-from-national-statistical-institutions-dab9f2e6a18f#2022-02-08">https://towardsdatascience.com/how-to-easily-access-and-download-public-data-from-national-statistical-institutions-dab9f2e6a18f#2022-02-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2122" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">R中PxWeb API接口指南，使用PxWeb包。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6a4f6b46c56267b6c9cf27d52fcc516a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p6bMyOec0CmlNpUD7rG3xQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://pixabay.com/sv/users/tungnguyen0905-17946924/" rel="noopener ugc nofollow" target="_blank">东阮</a>在<a class="ae ky" href="https://pixabay.com/images/id-6701404/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄</p></figure><p id="ca61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PxWeb是一个网络应用编程接口和网络工具，用于传播来自国家统计机构的数据。在R中，有一个名为<code class="fe lv lw lx ly b">pxweb</code>的包，它连接到这些web APIs，使您能够从NSI数据库直接将数据下载到R会话中，而无需通过HTTP/HTTPS使用web浏览器。</p><p id="409b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我将向您展示如何从统计机构下载公共数据。我将举一个例子，寻找显示瑞典父母第一个孩子出生时平均年龄的数据。我们可以在瑞典统计局的人口数据库中找到这些数据，这是他们公开数据的一部分。他们的开放数据可供所有人免费使用。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="c367" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PxWeb APIs由元数据和实际数据组成。元数据是一个分层的节点树，其中每一层都包含有关其子节点的信息。您可以将这些节点视为文件夹。您可以在这些表中导航，直到找到包含感兴趣的数据的表。</p><p id="4458" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您需要两件事情来访问和下载数据，API中指向数据表的<strong class="lb iu"> URL </strong>和指定您想要下载什么数据的<strong class="lb iu">查询</strong>。我将向您展示这两者是如何通过一个非常直观的分步过程获得的。</p><h1 id="355a" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">安装并加载pxweb包</h1><p id="553c" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">如果是第一次使用<code class="fe lv lw lx ly b">pxweb</code>包，你需要安装它。然后将它加载到您R会话中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="d188" class="mg mh it bd mi mj nf ml mm mn ng mp mq jz nh ka ms kc ni kd mu kf nj kg mw mx bi translated">导航API</h1><p id="88eb" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们通过输入<code class="fe lv lw lx ly b">pxweb_interactive()</code>连接到API目录。您可以向该函数传递一个URL来跳过一些步骤，直接访问特定的API或数据库级别。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6462" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将继续打开API目录，以便您可以看到当前包含在软件包中的统计机构。您可以打开任何PxWeb API，即使它没有包含在软件包中。只需在<code class="fe lv lw lx ly b">pxweb_interactive()</code>调用中将URL添加到API中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/d6579360812e94c2a0b3aabe460cdc32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHhHuudseHmdgbOf9GKi2g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1bc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想从瑞典统计局下载数据，所以我们输入“1”。在选择了一个API之后，你还要选择你想要访问的数据库的版本和语言。之后，您将在API中看到所有可用的数据库。我们对人口数据库感兴趣，所以我们选择11号。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/2936116933504fc44b1bf6170e5dc28e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*peUyOWZMjPjcGMiOj7OP6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="764f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您只需继续导航并选择要打开的子文件夹，直到找到包含要下载的数据的表格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/4680f2ae641a0b1e50257aec2243943d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8OnEEh_OZ_Yn-zeJltNgTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/a33c9e773f72ebb6815acbc865232740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8nKYDfl_6qgI0KNQl3jJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="3c71" class="mg mh it bd mi mj nf ml mm mn ng mp mq jz nh ka ms kc ni kd mu kf nj kg mw mx bi translated">查询数据</h1><p id="bd2a" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">现在我们在包含感兴趣的数据的表中。(<em class="no">表:按地区、活产顺序、父母、观察和年份分列的儿童平均出生年龄。</em>)我们将查询数据并选择每个变量的值，一次一个变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/c41e13f9dc56083840f67c8c730c1c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lMKQLW_izFszAYpk716LQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e59d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的查询，我选择了以下数据:</p><blockquote class="nq nr ns"><p id="2258" class="kz la no lb b lc ld ju le lf lg jx lh nt lj lk ll nu ln lo lp nv lr ls lt lu im bi translated">地区:瑞典和斯德哥尔摩县<br/> BarnOrder(活产顺序):第一个孩子<br/>for older(父母):母亲、父亲<br/> ContentsCode:孩子出生时的平均年龄<br/> Tid(时间):2000年至2020年</p></blockquote></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="1ccb" class="mg mh it bd mi mj nf ml mm mn ng mp mq jz nh ka ms kc ni kd mu kf nj kg mw mx bi translated">下载数据</h1><p id="d7a9" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">当您定义了查询后，R会问您几个问题来帮助您将数据下载到R中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/128df61e872e814aaaacffb63edc1eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MjXotvKr_tEZcYn8AEzMMQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="65af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过对所有这些问题选择“是”，<code class="fe lv lw lx ly b">pxweb</code>包非常有用，它将你下载数据所需的所有代码打印到控制台的一个整洁的data.frame中。</p><h2 id="3193" class="nx mh it bd mi ny nz dn mm oa ob dp mq li oc od ms lm oe of mu lq og oh mw oi bi translated"><strong class="ak"> 1。将查询代码存储为json文件。</strong></h2><p id="f0ea" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">根据选择的数据，R将我们的查询以json格式打印到控制台。将它保存在一个单独的json文件中。如果想要更改查询，可以直接在这个json文件中进行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="6dd7" class="nx mh it bd mi ny nz dn mm oa ob dp mq li oc od ms lm oe of mu lq og oh mw oi bi translated"><strong class="ak"> 2。下载数据并转换为data.frame格式</strong></h2><p id="1055" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">pxweb_get(url = [url to table], query = [path to json])</code>功能，您可以将数据下载到R会话中。r已经把需要的代码打印到控制台上了。您只需要更改json文件的路径。运行<code class="fe lv lw lx ly b">as.data.frame()</code>将数据转换成data.frame</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="201d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您在R会话中有了一个整洁的data.frame，您可以继续分析和可视化数据了！我为我们的数据做了一个图表，它显示了斯德哥尔摩第一次做父母的平均年龄远远高于全国平均水平。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/56c70103fde4222f88eb47e67f8d738c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*wve4cOEO9q2oFV4Nkvqtpg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/5d759023fdc92c6d2d44a35b99d4859a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SmuBIrg40ZumuerBAfkv3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="eb2d" class="nx mh it bd mi ny nz dn mm oa ob dp mq li oc od ms lm oe of mu lq og oh mw oi bi translated"><strong class="ak"> 3。获取数据注释</strong></h2><p id="fbf4" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">有时数据有注释，您可能也想下载它们。在我们的例子中，没有注释。要下载评论，你只需使用下面的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="e123" class="nx mh it bd mi ny nz dn mm oa ob dp mq li oc od ms lm oe of mu lq og oh mw oi bi translated"><strong class="ak"> 4。获取数据引用</strong></h2><p id="2b94" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">为了可再现性，引用数据是一种好的做法，这样你和其他人就可以看到数据来自哪里，何时下载的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="5cde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的例子，引用看起来像这样</p><blockquote class="nq nr ns"><p id="4a2e" class="kz la no lb b lc ld ju le lf lg jx lh nt lj lk ll nu ln lo lp nv lr ls lt lu im bi translated">瑞典统计局(2022年)。"按地区、活产顺序、父母、观察和年份分列的儿童平均出生年龄."[使用pxweb R包0.12.0访问的数据2022–02–07 12:48:51]，<url: class="ae ky" href="http://api.scb.se/OV0104/v1/doris/en/ssd/BE/BE0101/BE0101H/MedelAlder1" rel="noopener ugc nofollow" target="_blank">http://API . SCB . se/ov 0104/v1/Doris/en/SSD/BE/BE 0101/BE 0101h/medel alder 1&gt;。</url:></p></blockquote><p id="7ee9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您是用LaTex编写的，该软件包还会将引文打印为BibTex条目。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="7ca7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我发现<code class="fe lv lw lx ly b">pxweb</code>包是一个非常有用的工具。它很容易使用，并且可以把你想要的数据整理成一个整洁的格式。如果您需要某个项目的数据，您可以通过使用<code class="fe lv lw lx ly b">pxweb_interactive()</code>功能浏览目录及其数据库来获得灵感。如果您已经知道使用什么数据，或者如果您随着时间的推移分析某个变量，您可以使用<code class="fe lv lw lx ly b">pxweb_get()</code>函数直接获得数据。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="2fe8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="no">*</em><code class="fe lv lw lx ly b"><em class="no">pxweb</em></code><em class="no">套装由曼斯·马格努松、马库斯·凯努、詹尼·霍瓦里和利奥·拉赫蒂(罗彭戈夫)开发。网址:</em><a class="ae ky" href="http://github.com/ropengov/pxweb" rel="noopener ugc nofollow" target="_blank"><em class="no">http://github.com/ropengov/pxweb</em></a></p></div></div>    
</body>
</html>