<html>
<head>
<title>Do Neural Networks Dream of Falling Snow?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络会梦到落雪吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/do-neural-networks-dream-of-falling-snow-89b5036ae324#2022-08-31">https://towardsdatascience.com/do-neural-networks-dream-of-falling-snow-89b5036ae324#2022-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6b1e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">发展基于深度学习雷达的降水反演</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2a7ff9553a8a5f366ec3ba60852840a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pSkPLR5xKOy55fhZylfACg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">DeepPrecip网络计算机图形渲染Graphcore和Author提供的图像</p></figure><p id="aa17" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">机器学习(ML)在地球科学中的应用并不是一个新概念。自20世纪60年代中期以来，k-means聚类、马尔可夫链和决策树的早期示例已经在多个地理环境中得到积极应用(<em class="lr"> Preston等人，1964</em>；<em class="lr">克鲁姆宾等人，1969</em>；<em class="lr">纽恩多普，1976年</em>。</p><p id="647a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，来自<a class="ae ls" href="https://www.graphcore.ai" rel="noopener ugc nofollow" target="_blank"> Graphcore </a>、<a class="ae ls" href="https://aws.amazon.com/?nc2=h_lg" rel="noopener ugc nofollow" target="_blank"> Amazon </a>和<a class="ae ls" href="https://cloud.google.com" rel="noopener ugc nofollow" target="_blank"> Google </a>等公司的云计算资源的进步，加上对强大的ML库(例如<a class="ae ls" href="https://www.tensorflow.org" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>、<a class="ae ls" href="https://keras.io" rel="noopener ugc nofollow" target="_blank"> Keras </a>、<a class="ae ls" href="https://pytorch.org" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>)和蓬勃发展的开发人员社区的轻松访问，使得这一新兴领域近年来大受欢迎(<em class="lr"> Dramsch，2020 </em>)。</p><p id="2670" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，最大似然模型不仅经常用于地球科学中的业务预测(Ashouri等人，2021年)，还用于统计推断；没有与自然过程的物理模型模拟相关的传统不确定性(<em class="lr"> King等人，2022 </em>)。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="a2b8" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">问题是</h2><p id="7e86" class="pw-post-body-paragraph kv kw iq kx b ky mt jr la lb mu ju ld le mv lg lh li mw lk ll lm mx lo lp lq ij bi translated">降雪是全球水循环和能量循环不可或缺的组成部分，对区域淡水可用性有重大影响(<em class="lr"> Musselman等人，2021</em>；<em class="lr"> Gray和Landine，2011年</em>。事实上，每年有超过20亿人(全球人口的六分之一)依赖融雪产生的淡水供人类消费和农业用途(<em class="lr"> Sturm等人，2017 </em>)。随着全球平均气温持续上升，预计降雪频率和强度也将发生变化，从而导致全球范围内新的水资源管理挑战(<em class="lr"> IPCC，2019 </em>)。</p><p id="0846" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，传统的降雪模型在估计中有很大的不确定性，因此应该研究新的算法来促进我们对全球降雪模式变化的理解。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/06c132069d916179c41ab843fb443dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Jp1WYZCDVvD4L4iUWBr3A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">智利托雷斯海峡上空可见复杂的降雪——图片由作者提供</p></figure><p id="c911" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，让我们探索一下<strong class="kx ir"> ML是如何被用于推进降雪预测领域的，以及这些技术在未来可能会走向何方。</strong></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="d157" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">我们的解决方案</h2><p id="7f2b" class="pw-post-body-paragraph kv kw iq kx b ky mt jr la lb mu ju ld le mv lg lh li mw lk ll lm mx lo lp lq ij bi translated">这篇帖子顶部的插图是<a class="ae ls" href="https://github.com/frasertheking/DeepPrecip" rel="noopener ugc nofollow" target="_blank"> DeepPrecip </a>。或者更准确地说，是DeepPrecip计算图的渲染，它构成了模型决策过程的基础。</p><p id="2f86" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">DeepPrecip是一个深度卷积神经网络(CNN ),由滑铁卢<a class="ae ls" href="https://uwaterloo.ca" rel="noopener ugc nofollow" target="_blank">大学</a>开发，由<strong class="kx ir">400万</strong>可训练模型参数组成！我们使用该模型的目的是评估在不同的地区气候下，我们如何利用地面雷达数据输入来预测地表降雨量(<em class="lr"> King等人，2022–2</em>)。这种类型的模型被称为“降水”<em class="lr">反演</em>，因为该模型的输入是大气雷达观测值(即从下落的水凝物反向散射的能量)，它输出关于地面雨雪的预测。</p><p id="ec09" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">但是如何利用大气雷达后向散射强度来推断地面降水量呢？</strong></p><p id="75c5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们必须找到一种方法，从感兴趣的部分相关的大气变量(在这种情况下是雷达反向散射强度)中提取非常具体的降水信息。这可以通过两种方式实现:</p><ol class=""><li id="9cb9" class="mz na iq kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated">通过一个基于物理的模型，模拟大气中发生的导致冰晶形成和最终降雪的物理过程。</li><li id="6844" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">经验统计过程(如ML模型),可以发现不同变量之间的模式，通过正向模型显示彼此之间的一些敏感性。</li></ol><p id="ad62" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然这两种技术都有各自的优缺点，我们<em class="lr">可以</em>用整篇博文来讨论，但在本文中，我们将重点讨论第二种方法。但首先，什么是正向模型<em class="lr">？</em>斯蒂芬斯于1994年提供了一个经典的例证:</p><blockquote class="nn no np"><p id="6a83" class="kv kw lr kx b ky kz jr la lb lc ju ld nq lf lg lh nr lj lk ll ns ln lo lp lq ij bi translated">“假设你想要描述一条龙，但你只观察到龙在沙地上留下的脚印。现在，如果你已经了解龙，你可以很容易地描述它可能在沙子上留下的痕迹；也就是说，你可以开发一个正向模型。但是如果你只观察沙地上的痕迹，那么描述龙的任何细节都会困难得多。你可能能够分辨出它是龙而不是鹿，但是有些方面你无法辨别:龙的颜色，它是否有翅膀，等等。检索可以将观察结果(大脚印)与先验信息(大多数龙有翅膀，留下大脚印的龙是绿色的)结合起来，以获得最可能的状态(它是一条有翅膀的绿色龙)。”</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/21c827967291fa08ac7baf8de96343b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AVYbgAeh0pGxbwz7B4OCNw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">沙滩上的龙脚印——由<a class="ae ls" href="https://www.gettyimages.ca/photos/dinosaur-footprint" rel="noopener ugc nofollow" target="_blank">盖蒂图片社</a>的<a class="ae ls" href="https://www.gettyimages.ca/search/photographer?photographer=Vishy%20Patel%20%2F%20EyeEm" rel="noopener ugc nofollow" target="_blank"> Vishy Patel </a>拍摄</p></figure><p id="694c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以利用这个想法将垂直雷达剖面图中的信息与地面降雪量联系起来！由于雷达数据输入有一个物理结构(剖面从地表延伸到大约3公里)，DeepPrecip使用了多个卷积层来提取可能的水凝物活动的不同部分之间的特征。这些信息有助于我们的模型理解不同的风暴事件类型和结构，从而提高网络的全连接前馈回归组件中降水率估计强度的准确性。</p><p id="256a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更正式地说，DeepPrecip的模型架构如下所示。您能否将此图中的不同模型架构层与之前显示的计算图匹配起来？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/c418e161ac4e73978d50bbb4f7760095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvrqBxYmMw0nQqRkKLD4OQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">DeepPrecip模型架构图—图片由作者提供</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="1306" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">模特培训</h2><p id="021e" class="pw-post-body-paragraph kv kw iq kx b ky mt jr la lb mu ju ld le mv lg lh li mw lk ll lm mx lo lp lq ij bi translated">为了开发一个稳健的模型，我们首先需要收集雷达数据和同位原位降水测量观测值的代表性训练数据集。请注意，这是一个监督学习问题，因此需要参考数据。</p><p id="a0c4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于地球科学中的问题总是具有挑战性，因此在数据选择阶段必须小心选择有代表性的样本。每个站点还必须配备以相同方式校准的类似仪器。在这项工作中，我们选择了北半球的9个站点，用8年的时间从微雨雷达(MRR)系统和雨量计收集数据。这些工具的示例如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/7157f72fa6d78d366c1b158a82b09312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gy442r-83nKzAj1aUsApQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">MRR和Pluvio2仪器及反射率剖面示例—图片由作者提供</p></figure><p id="1905" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于我们管理的训练数据集的规模很大(数百万个训练样本)，加上模型架构的一般复杂性，超参数优化在开发过程的早期成为我们的瓶颈。在尝试了各种不同的云计算选项后，<a class="ae ls" href="https://www.graphcore.ai" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> Graphcore </strong> </a>的系统脱颖而出，成为大幅缩短我们培训时间的绝佳选择。</p><p id="2a83" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Graphcore加速训练的关键是使用了他们专门的<a class="ae ls" href="https://www.graphcore.ai/products/ipu" rel="noopener ugc nofollow" target="_blank">情报处理单元(IPUs) </a>。IPU是一种全新的大规模并行处理器，用于加速机器智能。计算和内存架构是为人工智能横向扩展而设计的。请注意IPUs和传统处理器之间的差异如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/2c49b2a25909e87da53de4e5bda51287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_l3KInLg-WhRQe4TwjZ4g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">IPU架构与其他处理器设计的差异—图片由<a class="ae ls" href="https://www.graphcore.ai" rel="noopener ugc nofollow" target="_blank"> Graphcore </a>提供</p></figure><p id="277b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">硬件与软件一起开发，提供了一个易于使用且擅长实际应用的平台。使用Graphcore MK2经典IPU-POD4(注意，第二代IPU现已上市)，我们能够<strong class="kx ir">将DeepPrecip的训练时间比其他最先进的系统(如Tesla V100s)加快</strong> <strong class="kx ir"> 6 </strong>倍。如果你想为你的项目测试IPU系统，看看他们的<a class="ae ls" href="https://www.graphcore.ai/ipus-in-the-cloud" rel="noopener ugc nofollow" target="_blank">云平台</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/269c74124a1a8e74592ebcca307c5bc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGT5sVfBKyBYHWvsSCBxSQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">DeepPrecip培训的硬件吞吐量比较—图片由作者提供</p></figure><p id="aa6a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">选定硬件后，我们需要选择一个优化范例。为了确定DeepPrecip的最佳超参数值，我们决定使用一种称为<a class="ae ls" href="https://jmlr.org/papers/volume18/16-558/16-558.pdf" rel="noopener ugc nofollow" target="_blank">超波段优化</a>的自适应优化形式。这种方法是贝叶斯优化(即自适应搜索)的一种变体，它专注于使用自适应资源分配和早期停止来加速随机搜索过程(<em class="lr">李等人，2018 </em>)。这使我们能够测试一个巨大的超参数空间，并快速确定模型参数的正确值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/9c36fabe0c03cd8f9aae4d02bb402e14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2G7MHu6dLO1U3f049PsXqw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不同的超参数优化技术—图片由<em class="nz"> Talaat等人提供，2022 </em></p></figure><p id="de0a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用单个IPU对DeepPrecip的14个不同参数和68个不同的总价值选项(即数万亿种可能的组合)进行超波段优化大约需要两周时间。均方误差(MSE)指标(如下)显示了该过程如何智能地选择更好的超参数组合，同时缓慢增加每个周期的周期数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/c74a15b5ba6f2eeb7cc834daa66fc5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oGUeWsfCsfBft3izdYauUg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">通过连续的超波段优化步骤改进了模型技巧-图片由作者提供</p></figure><p id="9760" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于超波段优化过程的每次迭代(或索引)，可以使用平行坐标图来呈现这些参数关系的高维可视化(如下所示)。这允许我们在模型架构的复杂性和性能之间找到一个平衡，以产生一个既高效又有技巧的模型。有关此过程以及最终超参数值的更多详细信息，请参见<em class="lr"> King等人，2022–2</em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/3a306ce1dae006f05df8b7e526d8c513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9dA7qnNtD7PENi9il1N7Xg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">每个超参数组合的平行坐标图—图片由作者提供</p></figure><p id="ba00" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然花费在收集、预处理和正确采样数据上的时间以及2周的超参数化过程可能看起来有些多余，但正确执行这些步骤是非常重要的，因为它可以显著降低未来过度拟合问题的可能性。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="162f" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">性能和耐用性</h2><p id="95e4" class="pw-post-body-paragraph kv kw iq kx b ky mt jr la lb mu ju ld le mv lg lh li mw lk ll lm mx lo lp lq ij bi translated">有了一个训练有素的模型，我们能够评估它相对于其他ML模型和传统经验关系的一般性能。</p><p id="ac2f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">总的来说，DeepPrecip被发现优于其他传统的检索方法，其MSE值比其他方法低40%，T2比其他方法高40%。我们还注意到，与其他测试模型相比，DeepPrecip似乎更有能力正确估计高强度降水的波峰和波谷。使用交叉验证方法，我们发现<strong class="kx ir"> DeepPrecip展示了稳健性</strong>，提高了准确预测区域气候站点降雨量的能力，而这些区域气候是该模型以前未见过的。</p><p id="5473" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于健壮性的最后一点是关键。以前的经验方法的一个主要限制是，每个模型都是为其衍生的气候定制的(<em class="lr"> Wood等人，2014 </em>)。因此，虽然一种模式在美国北部可能行得通，但在瑞典或韩国却未必行得通。</p><p id="f07b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">基于最大似然的方法的一个实质性好处是，它可以以不受粒子微观物理学的物理假设约束的方式对来自各种不同位置的数据进行训练。我们从该项目中发现，基于最大似然法的地表降雪解决方案显示出低误差和高概化，并且有充分的理由相信，全球最大似然法反演算法可以帮助增强当前基于卫星的产品，这些产品提供了对世界各地降雪量的估计。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/5a93b9742dbbcd2aecd69f2d81acf17f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZGxBFC9EafG7cKMmIF2dg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">飓风上方的全球降水测量(GPM)核心卫星——由<a class="ae ls" href="https://gpm.nasa.gov/missions/GPM/core-observatory" rel="noopener ugc nofollow" target="_blank"> NASA </a>拍摄</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="6c29" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">推理</h2><p id="041c" class="pw-post-body-paragraph kv kw iq kx b ky mt jr la lb mu ju ld le mv lg lh li mw lk ll lm mx lo lp lq ij bi translated">这个项目开始时的目标不仅是开发一个操作模型，而且要解释所述模型，以识别垂直雷达剖面图中对高模型技能贡献最大的区域。</p><p id="7deb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">DL模型通常被认为是“<em class="lr">黑盒</em>”算法，其中一些输入被输入到模型中，一些输出出来；不知道这两个阶段之间发生了什么。一些ML模型，如随机森林，提供了一个基于每个决策树做出决策的方式的特征重要性排名，但是我们如何为像DeepPrecip这样的DL模型提取类似的东西呢？</p><p id="9e03" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">回车，<a class="ae ls" href="https://christophm.github.io/interpretable-ml-book/shapley.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">沙普利值</strong> </a>。</p><p id="0eb7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由Lloyd Shapley <strong class="kx ir">于1951年提出(并以其命名)，Shapley值是合作博弈理论中的一个解概念。这个值代表个人参与者对游戏中某个共同目标的贡献。对于多个参与者，它允许我们测量每个参与者对最终结果的边际贡献。例如，如果多人出去吃饭，每个人点了不同的主菜，如果我们决定分摊晚餐账单，每个人支付的百分比可以根据Shapley值分摊。</strong></p><p id="8eac" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是死亡率风险评估的直观图表，描述了来自大量观察样本的局部解释如何使用Shapley值提供关于全局模型行为的见解:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/7ee1f7c4abfd25a78786f3196d2bbf89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29CpD6c9AiYCNZ8ljRumaA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="nz">局部解释提供了多种理解全局模型结构的新方法——图片由</em> Lundberg等人提供，2020年</p></figure><p id="ed08" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用上面显示的方法和Lundberg等人在<em class="lr">2020</em>中更详细地概述的方法，测量局部和全局对某个目标的贡献的过程可以与DL相关。我们可以检查模型输入的不同组合(即雷达数据子集，或大气变量组合)，以查看模型精度如何变化。然后，这可以用来确定哪些变量，以及在我们的情况下，大气中的哪些位置，为主动检索降雪提供了最重要的信息。请注意，这是一个计算量非常大的分析。</p><p id="75e8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将我们的数据集分成不同强度的降水事件类型，并对每个子集进行Shapley分析，揭示了最重要的变量和区域(如下所示；较暗的阴影区域表示较高的重要性)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/4085d1989ba94af729d369f3df14d832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2o7-EGRJMwpjlhsLd-9p8w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">表面上方每个垂直条柱的每个模型预测值的Shapley值的热图-图片由作者提供</p></figure><p id="9a00" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有趣的是，也许出乎意料的是，我们发现DeepPrecip认为大气中上部区域(接近2公里)是最重要的贡献者。不仅仅是在垃圾箱附近。通常，基于雷达的降雪量反演依赖于来自单个(或少数几个)近地表面元的信息，但在这里似乎不是这样。此外，反射率(RFL)通常被认为是基于雷达的反演中最重要的变量，然而多普勒速度(DOV)对于高强度降水事件的重要性实际上超过了RLF。请注意，SPW是光谱宽度，TMP是温度，WVL是风速。</p><p id="ae33" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">理解我们的DL模型如何做出决策是进一步优化其性能并在未来迭代中提高其技能的重要一步。此外，这一分析揭示的信息有助于为下一代降水任务的当前和未来降雪反演提供信息。如果您正在用DL执行类似的实验，我强烈推荐在您自己的模型上测试这个过程，因为这些输出可能非常有启发性！</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="8d6a" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">总结和结论</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/872ce2ff29b434eb5b7d554c95bb940f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fx1BIX17SE2ZZLJkMOcNA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">DeepPrecip项目总结和后续步骤—图片由作者提供</p></figure><p id="634d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这项工作中，我们简要描述了DeepPrecip的发展过程:一种新的利用垂直反射率剖面的深度学习降雪反演算法。虽然我们在这里不讨论DeepPrecip的代码，但是这个模型是开源的，可以在GitHub上使用。它是使用<a class="ae ls" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>、<a class="ae ls" href="https://www.tensorflow.org" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>和<a class="ae ls" href="https://keras.io" rel="noopener ugc nofollow" target="_blank"> Keras </a>用Python开发的。</p><div class="og oh gp gr oi oj"><a href="https://github.com/frasertheking/DeepPrecip" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">GitHub-frasertheking/DeepPrecip:用于地面降水的深度卷积神经网络…</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">DeepPrecip是一个深度卷积多层感知器，可以对低层大气进行主动雷达测量…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">github.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox kp oj"/></div></div></a></div><p id="d0b4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您对测试感兴趣，可以使用以下命令构建并运行模型:</p><pre class="kg kh ki kj gt oy oz pa pb aw pc bi"><span id="bc45" class="ma mb iq oz b gy pd pe l pf pg">git clone <a class="ae ls" href="https://github.com/frasertheking/DeepPrecip.git" rel="noopener ugc nofollow" target="_blank">https://github.com/frasertheking/DeepPrecip.git</a><br/>conda env create -f req.yml<br/>conda activate deep_precip<br/>python deep_precip.py</span></pre><p id="2de7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还包括一个<a class="ae ls" href="https://github.com/frasertheking/DeepPrecip/blob/main/deep_precip_ipu.py" rel="noopener ugc nofollow" target="_blank"> deep_precip_ipu.py </a>模块，用于在<a class="ae ls" href="https://www.graphcore.ai/graphcloud" rel="noopener ugc nofollow" target="_blank"> Graphcore IPUs </a>上运行这个模型。请注意，您将需要MRR培训数据作为模型的输入。</p><p id="9677" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我将在这篇文章的结尾说，我不期望DL模型完全取代物理模型或传统的降雪反演经验方法。然而，DL方法的高准确性和稳健性，结合全球模型行为分析提供的见解，有助于<strong class="kx ir">增强和通知未来地面和星载雷达任务的降雪反演方法</strong>。</p><p id="0da2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于这个项目的更多细节，请阅读我们目前在大气测量技术(AMT)上发表的论文(<a class="ae ls" href="https://egusphere.copernicus.org/preprints/2022/egusphere-2022-497/" rel="noopener ugc nofollow" target="_blank">https://eg sphere . Copernicus . org/preprints/2022/eg sphere-2022-497/</a>)。</p><p id="05fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，如果您愿意支持我们的工作，我们是NSERC科学曝光大赛的决赛选手，我们将通过<a class="ae ls" href="http://www.nserc-crsng.gc.ca/ScienceExposed-PreuveParLimage/past_winners-images_des_gagnants_eng.asp?year=2022#img-7" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">为我们的形象</strong> </a>投票来感谢您的支持。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="7ecc" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">承认</h2><p id="fb1c" class="pw-post-body-paragraph kv kw iq kx b ky mt jr la lb mu ju ld le mv lg lh li mw lk ll lm mx lo lp lq ij bi translated">我要感谢为这项工作贡献了多年观测数据的许多数据提供商、我的合著者、滑铁卢大学以及Graphcore团队，感谢他们对计算系统的持续支持和访问。</p><p id="64a0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我还要感谢加拿大自然科学和工程研究委员会(NSERC)对这个项目的资助。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="2bd4" class="ma mb iq bd mc md me dn mf mg mh dp mi le mj mk ml li mm mn mo lm mp mq mr ms bi translated">参考资料:</h2><p id="a7a1" class="pw-post-body-paragraph kv kw iq kx b ky mt jr la lb mu ju ld le mv lg lh li mw lk ll lm mx lo lp lq ij bi translated">Ashouri、Hamed、Gehne、Maria和国家大气研究中心工作人员(Eds)。2021年10月31日最后修改。"气候数据指南:PERSIANN-CDR:使用人工神经网络从遥感信息进行降水估算-气候数据记录."</p><p id="7e19" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">德拉姆施，J. S. (2020)。地球科学中的机器学习70年回顾。<em class="lr">地球物理学进展</em>，<em class="lr"> 61 </em>，1–55。<a class="ae ls" href="https://doi.org/10.1016/bs.agph.2020.08.002" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1016/bs.agph.2020.08.002</a></p><p id="be6b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">格雷，医学博士，男性，教育学博士。(1981).<em class="lr">雪手册:原理、流程、管理&amp;使用</em>。佩加蒙出版社。<a class="ae ls" href="https://snia.mop.gob.cl/repositoriodga/handle/20.500.13000/2981" rel="noopener ugc nofollow" target="_blank">https://snia . mop . gob . cl/repository odga/handle/20 . 500 . 13000/2981</a></p><p id="4ea4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">IPCC，2019: IPCC关于气候变化中的海洋和冰冻圈的特别报告[h .-o . p rtner，D.C. Roberts，v . Masson-德尔莫特，P. Zhai，M. Tignor，E. Poloczanska，K. Mintenbeck，A. Alegría，M. Nicolai，A. Okem，J. Petzold，B. Rama，N.M. Weyer(编。)].剑桥大学出版社，英国剑桥，美国纽约，755页h<a class="ae ls" href="https://doi.org/10.1017/9781009157964." rel="noopener ugc nofollow" target="_blank">ttps://doi . org/10.1017/9781009157964。</a></p><p id="9399" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">f .金、g .达菲和C. G .弗莱彻(2022)。基于机器学习的厘米波长降雪反演算法。<em class="lr">应用气象学与气候学杂志</em>，<em class="lr"> 1 </em> (aop)。<a class="ae ls" href="https://doi.org/10.1175/JAMC-D-22-0036.1" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1175/JAMC-D-22-0036.1</a></p><p id="bd83" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">金，f .，达菲，g .，米兰尼，l .，弗莱彻，C. G .，彼得森，c .，&amp;埃贝尔，K. (2022)。DeepPrecip:降水反演的深度神经网络。<em class="lr">平衡球</em>，1–24。<a class="ae ls" href="https://doi.org/10.5194/egusphere-2022-497" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.5194/egusphere-2022-497</a></p><p id="292a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Krumbein，W. C .，&amp; Dacey，M. F. (1969年)。地质学中的马尔可夫链和嵌入马尔可夫链。<em class="lr">国际数学地质协会杂志</em>，<em class="lr"> 1 </em> (1)，79-96。<a class="ae ls" href="https://doi.org/10.1007/BF02047072" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1007/BF02047072</a></p><p id="a589" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Li，l .，Jamieson，k .，DeSalvo，g .，Rostamizadeh，a .，&amp; Talwalkar，A. (2018)。<em class="lr"> Hyperband:一种新的基于Bandit的超参数优化方法</em> (arXiv:1603.06560)。arXiv。<a class="ae ls" href="https://doi.org/10.48550/arXiv.1603.06560" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.48550/arXiv.1603.06560</a></p><p id="cde9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Lundberg，S. M .、Erion、g .、Chen、h .、DeGrave、a .、Prutkin、J. M .、Nair、b .、Katz、r .、Himmelfarb、j .、Bansal、n .、和Lee，s-I .(2020)。从局部解释到对树的可解释人工智能的全局理解。<em class="lr">自然机器智能</em>，<em class="lr"> 2 </em> (1)，56-67。<a class="ae ls" href="https://doi.org/10.1038/s42256-019-0138-9" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1038/s42256-019-0138-9</a></p><p id="4c19" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Musselman，K. N .，Addor，n .，Vano，J. A .，&amp; Molotch，N. P. (2021)。冬季融化趋势预示着雪水资源的广泛减少。<em class="lr">自然气候变化</em>，<em class="lr"> 11 </em> (5)，418-424。<a class="ae ls" href="https://doi.org/10.1038/s41558-021-01014-9" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1038/s41558-021-01014-9</a></p><p id="8638" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Newendorp，P. D. (1976年)。<em class="lr">石油勘探决策分析</em>。<a class="ae ls" href="https://www.osti.gov/biblio/6406439" rel="noopener ugc nofollow" target="_blank">https://www.osti.gov/biblio/6406439</a></p><p id="6248" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">普雷斯顿，弗洛伊德w，和詹姆斯亨德森。<em class="lr">地层对比用旋回沉积物的傅里叶级数表征</em>。堪萨斯地质调查局，1964年。</p><p id="6ec0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Stephens，G. L .，1994: <em class="lr">低层大气的遥感:导论。</em>牛津大学出版社，562页</p><p id="87da" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Sturm，m .，Goldstein，M. A .，&amp; Parr，C. (2017)。来自雪的水和生命:一个万亿美元的科学问题。<em class="lr">水资源研究</em>，<em class="lr"> 53 </em> (5)，3534-3544。<a class="ae ls" href="https://doi.org/10.1002/2017WR020840" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1002/2017WR020840</a></p><p id="937f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Talaat，F. M .，&amp; Gamel，S. A. (2022)。基于RL的卷积神经网络超参数优化算法。<em class="lr">环境智能与人性化计算杂志</em>。<a class="ae ls" href="https://doi.org/10.1007/s12652-022-03788-y" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1007/s12652-022-03788-y</a></p><p id="bfcc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Wood，N. B .，L'Ecuyer，T. S .，Heymsfield，A. J .，Stephens，G. L .，Hudak，D. R .，&amp; Rodriguez，P. (2014)。使用同位多传感器观测估算雪微物理特性。地球物理研究杂志:大气，<em class="lr"> 119 </em> (14)，8941–8961。【https://doi.org/10.1002/2013JD021303 T4】</p></div></div>    
</body>
</html>