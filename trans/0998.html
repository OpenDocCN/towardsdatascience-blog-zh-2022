<html>
<head>
<title>Using Versatile Data Kit to Ingest and Process Data from REST API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用通用数据工具包从 REST API 获取和处理数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-versatile-data-kit-to-ingest-and-process-data-from-rest-api-6e3e0660b791#2022-03-15">https://towardsdatascience.com/using-versatile-data-kit-to-ingest-and-process-data-from-rest-api-6e3e0660b791#2022-03-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="3c2e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据库ˌ资料库</h2><div class=""/><div class=""><h2 id="0dfe" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">关于如何使用通用数据工具包(VDK)从 REST API 获取数据的教程，以及一些关于如何安装 VDK 服务器的提示。</h2></div><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj kr"><img src="../Images/e1832fa3767f54a3f6666687ee39c81c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Sup7l-CpNYCQ2jSJ"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">凯文·Ku 在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5aa7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://github.com/vmware/versatile-data-kit" rel="noopener ugc nofollow" target="_blank">多功能数据套件</a> (VDK)是一个开源框架，最近由 VMware 发布。它与一个数据湖一起工作，您可以接收不同格式的数据，然后轻松地访问它们。在我上一篇题为<a class="ae lh" rel="noopener" target="_blank" href="/an-overview-of-versatile-data-kit-a812cfb26de7">多功能数据工具包概述</a>的文章中，我描述了 VDK 背后的主要概念，包括安装它的分步指南。在我的下一篇文章中，名为<a class="ae lh" rel="noopener" target="_blank" href="/from-raw-data-to-a-cleaned-database-a-deep-dive-into-versatile-data-kit-ab5fd992a02e">从原始数据到干净的数据库:深入了解多功能数据工具包</a>，我展示了如何连接 VDK 和 Trino DB，以及如何接收和处理 CSV 文件。</p><p id="8720" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我为您提供了 VDK 的另一个例子，从 REST API 中提取数据。因为访问 REST API 需要一个秘密密钥，所以我还描述了如何配置 VDK 服务器来存储这个秘密。</p><p id="2444" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">文章组织如下:</p><ul class=""><li id="354a" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">场景的定义</li><li id="b96f" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">环境设置</li><li id="a1a7" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">VDK 的数据接收</li><li id="a50f" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">VDK 的数据处理</li></ul><h1 id="3eef" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">1 情景的定义</h1><p id="7052" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">这个场景的目标是在 VDK 摄取和处理文森特·梵高在著名的欧洲文化遗产平台<a class="ae lh" href="https://www.europeana.eu/" rel="noopener ugc nofollow" target="_blank"> Europeana </a>上的画作。Europeana 通过其 public <a class="ae lh" href="https://pro.europeana.eu/page/intro#access" rel="noopener ugc nofollow" target="_blank"> REST API </a>提供所有文化遗产对象。Europeana 提供了 700 多幅作品，其作者是文森特·梵高。对于每个记录，REST API 提供了很多信息，包括完整性、国家、数据提供者、创建者、标题等等。</p><p id="ec69" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下 JSON 显示了由 Europeana REST API 返回的记录摘录:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="3233" class="nu mt it nq b gz nv nw l nx ny">[{<br/>    completeness: 10,<br/>    country: ["Belgium"],<br/>    dataProvider: ["Catholic University of Leuven"],<br/>    dcCreator: ["http://data.europeana.eu/agent/base/59832",<br/>    "Vincent van Gogh"],<br/>    dcCreatorLangAware: {<br/>        def: ["http://data.europeana.eu/agent/base/59832"],<br/>        en:  ["Vincent van Gogh"]<br/>    },<br/>    dcDescription:<br/>        ["KU Leuven. Glasdia’s kunstgeschiedenis. Université de Louvain, tussen 1839 en 1939. Fotograaf onbekend. Toegevoegde informatie op dia. Stroming/Stijl: Postimpressionisme. Creatie/Bouw: 1889. Techniek/Materiaal: Olieverf op doek. Huidige locatie: Nederland, Otterlo, Kröller-Müller Museum. EuroPhot. Kunstgeschiedenis. 19de eeuw. Schilderkunst. Portret. EuroPhot. Art history. 19th century. Paintings. Portrait."],<br/>        ...<br/>}]</span></pre><p id="7a21" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">REST API 的访问点可从以下链接获得:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="99aa" class="nu mt it nq b gz nv nw l nx ny"><a class="ae lh" href="https://api.europeana.eu/record/v2/search.json" rel="noopener ugc nofollow" target="_blank">https://api.europeana.eu/record/v2/search.json</a></span></pre><p id="c16a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">需要<a class="ae lh" href="https://pro.europeana.eu/pages/get-api" rel="noopener ugc nofollow" target="_blank">免费注册</a>才能获得 API 密钥。</p><h1 id="bc85" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">2 环境设置</h1><p id="ec96" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">要运行这个示例，我需要:</p><ul class=""><li id="f81d" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">多功能数据工具包</li><li id="3e85" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">Trino DB</li><li id="3a0e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">Trino 的多功能数据工具包插件</li><li id="8aa5" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">多功能数据套件服务器</li><li id="db4c" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">欧洲 API 密钥</li></ul><p id="3472" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在<a class="ae lh" rel="noopener" target="_blank" href="/from-raw-data-to-a-cleaned-database-a-deep-dive-into-versatile-data-kit-ab5fd992a02e">我的上一篇文章</a>中，我已经介绍了如何配置 Trino DB 和 Trino 的通用数据工具包插件，如果需要安装可以参考一下。</p><h2 id="805b" class="nu mt it bd mu nz oa dn my ob oc dp nc lr od oe ne lv of og ng lz oh oi ni iz bi translated"><strong class="ak"> 2.1 多功能数据套件服务器</strong></h2><p id="ff33" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">在这个例子中，我在本地安装了通用数据工具包(VDK)服务器。我将使用 VDK 服务器来存储 Europeana API 密钥。VDK 服务器需要以下先决条件:</p><ul class=""><li id="05be" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="https://helm.sh/docs/intro/install" rel="noopener ugc nofollow" target="_blank">舵</a></li><li id="f7dd" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://docs.docker.com/get-docker" rel="noopener ugc nofollow" target="_blank">码头工人</a></li><li id="c946" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://kind.sigs.k8s.io/docs/user/quick-start/#installation" rel="noopener ugc nofollow" target="_blank">种类</a></li></ul><p id="ab3f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我可以按照他们的官方指南安装它们。我可以通过以下命令安装通用数据工具包服务器:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="121c" class="nu mt it nq b gz nv nw l nx ny">vdk server — install</span></pre><p id="3a9d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">关于如何安装 VDK 服务器的更多信息，可以参考<a class="ae lh" href="https://github.com/vmware/versatile-data-kit/wiki/Installation#install-locally" rel="noopener ugc nofollow" target="_blank"> VDK 官方文档</a>。</p><p id="371a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">安装完成后，我应该可以通过以下链接访问 VDK REST API:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="a585" class="nu mt it nq b gz nv nw l nx ny">http://localhost:8092/swagger-ui.html</span></pre><p id="a63e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">此外，从 Docker 仪表板，我应该能够看到安装的 VDK 服务器，如下图所示:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj oj"><img src="../Images/1550e8e767dd97cb4b8bfc11fd6920c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ja8Xba7M0D1kEcUVTmTt-g.png"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><h2 id="1267" class="nu mt it bd mu nz oa dn my ob oc dp nc lr od oe ne lv of og ng lz oh oi ni iz bi translated"><strong class="ak"> 2.2 欧洲 API 密钥</strong></h2><p id="ea2e" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我可以通过注册到<a class="ae lh" href="https://pro.europeana.eu/page/get-api" rel="noopener ugc nofollow" target="_blank">这个链接</a>来获得一个 Europeana API 密钥。我应该填一份表格，要你的电子邮件。一旦我提交了表单，API 密匙就会通过电子邮件发送。</p><p id="6b9e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我可以添加 Europeana API 键作为 VDK 属性，如下所示:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="f0ac" class="nu mt it nq b gz nv nw l nx ny">vdk properties — set-secret api_key</span></pre><p id="4325" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">VDK 将向您询问以下信息:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="eb77" class="nu mt it nq b gz nv nw l nx ny">Job Name: online-exhibition<br/>Job Team: my-team<br/>api_key: YOUR_API_KEY</span></pre><p id="be73" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这一步之后，Europeana API 密钥应该存储在您的 VDK 服务器中。我可以通过运行以下命令来控制它是否被正确存储:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="8754" class="nu mt it nq b gz nv nw l nx ny">vdk properties --list</span></pre><p id="85f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我写下作业名称和作业团队，系统返回给我 Europeana API 键。</p><h1 id="a37f" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">3 VDK 的数据接收</h1><p id="b348" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">数据摄取在数据库输出中上传对 Europeana REST API 的调用。数据接收通过以下步骤执行:</p><ul class=""><li id="93a5" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">删除现有的表(如果有)</li><li id="98c2" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">创建新表格</li><li id="f067" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">直接从 REST API 获取表值。</li></ul><p id="b66c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了访问 Europeana REST API，这个示例需要一个活动的 Internet 连接才能正常工作。</p><h2 id="6113" class="nu mt it bd mu nz oa dn my ob oc dp nc lr od oe ne lv of og ng lz oh oi ni iz bi translated">3.1 删除现有表格</h2><p id="65e5" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我将这一步写成一个 SQL 命令，如果表存在的话，就删除它:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="3589" class="nu mt it nq b gz nv nw l nx ny">DROP TABLE IF EXISTS assets</span></pre><p id="22f5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">REST API 的输出被导入到一个名为<code class="fe ok ol om nq b">assets</code>的表中。</p><h2 id="e179" class="nu mt it bd mu nz oa dn my ob oc dp nc lr od oe ne lv of og ng lz oh oi ni iz bi translated">3.2 创建新表</h2><p id="68bf" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">现在我定义了一个新的步骤，它创建了一个新的表，该表将包含 REST API 的所有输出。我将把输出作为原始值导入，其中可能包含一个 JSON:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="14b6" class="nu mt it nq b gz nv nw l nx ny">CREATE TABLE assets (</span><span id="2d0a" class="nu mt it nq b gz on nw l nx ny">completeness int,<br/>country varchar,<br/>dataProvider varchar,<br/>dcCreator varchar,<br/>dcCreatorLangAware varchar,<br/>dcTitleLangAware varchar,<br/>edmDatasetName varchar,<br/>edmIsShownBy varchar,<br/>edmPreview varchar,<br/>edmTimespanLabel varchar,<br/>edmTimespanLabelLangAware varchar,<br/>europeanaCollectionName varchar,<br/>europeanaCompleteness int,<br/>"guid" varchar,<br/>id varchar,<br/>index int,<br/>language varchar,<br/>link varchar,<br/>previewNoDistribute boolean,<br/>provider varchar,<br/>rights varchar,<br/>score double,<br/>"timestamp" varchar,<br/>timestamp_created varchar,<br/>timestamp_created_epoch varchar,<br/>timestamp_update varchar,<br/>timestamp_update_epoch varchar,<br/>title varchar,<br/>"type" varchar,<br/>ugc varchar<br/>)</span></pre><p id="6e3a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下表显示了<code class="fe ok ol om nq b">assets</code>表的一个示例:</p><figure class="ks kt ku kv gu kw gi gj paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gi gj oo"><img src="../Images/5b19de8ed0553f90cc967d76fb0f8153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5j-ijiKcXY844DdfewD6Q.png"/></div></div><p class="ld le gk gi gj lf lg bd b be z dk translated">作者图片</p></figure><p id="2689" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">前面的表格只显示了一些字段，以便了解导入数据的原始程度。</p><h2 id="7651" class="nu mt it bd mu nz oa dn my ob oc dp nc lr od oe ne lv of og ng lz oh oi ni iz bi translated">3.3 直接从 REST API 获取表值</h2><p id="88d2" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">下一步是 Python 脚本，它直接从 REST API 导入值。我实现了<code class="fe ok ol om nq b">run()</code>函数，它将被 VDK 自动读取，如下所示。首先，我通过 job_input 的<code class="fe ok ol om nq b">get_property()</code>方法检索 api_key。然后我访问 Europeana REST API。因为 Europeana 通过分页返回信息，所以我应该遍历所有页面。最后，我使用<code class="fe ok ol om nq b">send_tabular_data_for_ingestion()</code>方法存储检索到的信息。运行代码的完整代码如下所示:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="7cb2" class="nu mt it nq b gz nv nw l nx ny">def run(job_input: IJobInput):<br/>   api_key = job_input.get_property("key")</span><span id="039d" class="nu mt it nq b gz on nw l nx ny">   start = 1<br/>   rows = 100<br/> <br/>   basic_url = f"https://api.europeana.eu/record/v2/search.json?wskey={api_key}&amp;query=who:%22Vincent%20Van%20Gogh%22"<br/>   url = f"{basic_url}&amp;rows={rows}&amp;start={start}"</span><span id="904a" class="nu mt it nq b gz on nw l nx ny">   response = requests.get(url)<br/>   response.raise_for_status()<br/>   payload = response.json()<br/>   n_items = int(payload["totalResults"])<br/>   <br/>   while start &lt; n_items:<br/>      if start &gt; n_items - rows:<br/>          rows = n_items - start + 1<br/>          url = f"{basic_url}&amp;rows={rows}&amp;start={start}"<br/>          response = requests.get(url)<br/>          response.raise_for_status()<br/>          payload = response.json()["items"]<br/>          df = pd.DataFrame(payload)<br/>          job_input.send_tabular_data_for_ingestion(<br/>             df.itertuples(index=False),<br/>             destination_table="assets",<br/>             column_names=df.columns.tolist(),<br/>          )<br/>          start = start + rows</span></pre><h1 id="64c0" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">4 数据处理</h1><p id="ca03" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">进口的桌子挺脏的，要清洗一下。数据处理包括清理资产表，只提取一些有用的信息。提取的信息包括以下各列:</p><ul class=""><li id="f927" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">国家</li><li id="d190" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">EDM 预览</li><li id="e346" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">供应者</li><li id="2bc0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">标题</li><li id="5703" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">权利</li></ul><p id="1542" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将结果表存储到名为 cleaned_assets 的表中。我为数据处理定义了两个步骤:</p><ul class=""><li id="8f15" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">删除<code class="fe ok ol om nq b">cleaned_assets table</code>(如果有的话)</li><li id="aedb" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">创建并填充<code class="fe ok ol om nq b">cleaned_assets table</code>。</li></ul><h2 id="ebd6" class="nu mt it bd mu nz oa dn my ob oc dp nc lr od oe ne lv of og ng lz oh oi ni iz bi translated">4.1 删除 cleaned _ assets 表</h2><p id="5564" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">与资产表类似，这一步是一条 SQL 语句，如果表存在，它将删除该表:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="86d2" class="nu mt it nq b gz nv nw l nx ny">DROP TABLE IF EXISTS cleaned_assets</span></pre><h2 id="054b" class="nu mt it bd mu nz oa dn my ob oc dp nc lr od oe ne lv of og ng lz oh oi ni iz bi translated">4.2 创建并填充 cleaned_assets 表</h2><p id="f10f" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">这一步操作资产表，只提取有用的信息。我可以这样写:</p><pre class="ks kt ku kv gu np nq nr ns aw nt bi"><span id="8b65" class="nu mt it nq b gz nv nw l nx ny">CREATE TABLE cleaned_assets AS (</span><span id="ccd3" class="nu mt it nq b gz on nw l nx ny">SELECT<br/>  SUBSTRING(country, 3, LENGTH(country)-4) AS country,<br/>  SUBSTRING(edmPreview, 3, LENGTH(edmPreview)-4) AS edmPreview,<br/>  SUBSTRING(provider, 3, LENGTH(provider)-4) AS provider,<br/>  SUBSTRING(title, 3, LENGTH(title)-4) AS title,<br/>  SUBSTRING(rights, 3, LENGTH(rights)-4) AS rights</span><span id="b5db" class="nu mt it nq b gz on nw l nx ny">FROM assets</span><span id="ea10" class="nu mt it nq b gz on nw l nx ny">)</span></pre><p id="c5df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">前面的代码通过<code class="fe ok ol om nq b">SUBSTRING()</code>函数清理了一些字段。</p><p id="ec9f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在数据集已经准备好进行进一步的分析了！好好享受吧！</p><h1 id="58af" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">摘要</h1><p id="9084" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">恭喜你！您刚刚学习了如何从 VDK 的 REST API 导入数据，以及如何配置 VDK 服务器来存储机密。你可以从<a class="ae lh" href="https://github.com/vmware/versatile-data-kit" rel="noopener ugc nofollow" target="_blank"> VDK 官方知识库</a>的“示例→在线展览”部分下载本文中描述的示例。</p><p id="6fca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">目前就这些。请继续关注 VDK 的最新消息！</p><h1 id="326a" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">相关文章</h1><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/an-overview-of-versatile-data-kit-a812cfb26de7"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd jd gz z fq ox fs ft oy fv fx jc bi translated">多功能数据工具包概述</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">开始使用多功能数据工具包，这是一个使数据工程师工作更高效的框架</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg lb os"/></div></div></a></div><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/from-raw-data-to-a-cleaned-database-a-deep-dive-into-versatile-data-kit-ab5fd992a02e"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd jd gz z fq ox fs ft oy fv fx jc bi translated">从原始数据到干净的数据库:对多功能数据工具包的深入研究</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">使用通用数据工具包(VMware 最近发布的一个框架)和 Trino DB 的完整示例</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg lb os"/></div></div></a></div><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/is-a-small-dataset-risky-b664b8569a21"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd jd gz z fq ox fs ft oy fv fx jc bi translated">小数据集有风险吗？</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">关于在数据科学项目中使用小数据集的一些思考和测试。</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="pi l pd pe pf pb pg lb os"/></div></div></a></div><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/how-to-convert-a-shapefile-to-a-dataframe-in-python-a6ca9a893504"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd jd gz z fq ox fs ft oy fv fx jc bi translated">如何在 Python 中将 Shapefile 转换为 DataFrame</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">GeoPandas Python 库概述，附带一个分步示例</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="pj l pd pe pf pb pg lb os"/></div></div></a></div></div></div>    
</body>
</html>