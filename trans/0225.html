<html>
<head>
<title>A Quick Guide to the Dialects of SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 方言快速指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-quick-guide-to-the-dialects-of-sql-7249125f9228#2022-02-09">https://towardsdatascience.com/a-quick-guide-to-the-dialects-of-sql-7249125f9228#2022-02-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="80f9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">T-SQL、PL/SQL、PL/pgSQL 等之间的区别</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/81235ee37174c4d45d68c9983626c0e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S-0PV1mOgcxMPfJA"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">伊恩·巴塔格利亚在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="ade0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SQL 于 20 世纪 70 年代首次开发，并于 20 世纪 80 年代在<a class="ae ky" href="https://en.wikipedia.org/wiki/SQL#History" rel="noopener ugc nofollow" target="_blank">得到广泛应用，很快成为与数据库通信的行业标准方法。直到最近受到 NoSQL 崛起的威胁，SQL 仍然是一股普遍的力量，也是任何数据专业人士的必备条件。</a></p><p id="4c8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，自最初发布以来，SQL 发展成了不同的形式。虽然许多核心和基本的关键字和功能是相同的，但不同的供应商利用同一种语言的不同变体来扩展其功能。这些差异通常很小，但有时很大，并且通常会给需要管理来自两个独立数据库(每个数据库都有自己的方言)的查询的数据专业人员或需要转换到新公司首选供应商的求职者带来困难。</p><p id="010a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然没有详尽地介绍每一种可能的变体或其细微差别的深度，但我们将探索由 Microsoft (T-SQL)、Oracle (PL/SQL)和 PostgreSQL (PL/sgSQL)实现的方言之间的基本差异。此外，还将简要介绍一些其他变体。</p><h1 id="b665" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">T-SQL</h1><p id="957a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><a class="ae ky" href="https://docs.microsoft.com/en-us/sql/t-sql/language-reference?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"> Transact-SQL </a>，简称 t-SQL，是微软对 SQL 的<a class="ae ky" href="https://en.wikipedia.org/wiki/Transact-SQL" rel="noopener ugc nofollow" target="_blank">扩展。编写 T-SQL 是为了在其生态系统中为查询提供更大的能力，它可以与</a><a class="ae ky" href="https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank">SQL Server Management Studio</a>、<a class="ae ky" href="https://azure.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank">基于 Azure 的产品</a>以及各种其他微软软件一起使用。主要的例外是<a class="ae ky" href="https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/overview-of-the-access-sql-reference" rel="noopener ugc nofollow" target="_blank">访问</a>，它使用<a class="ae ky" href="https://documentation.help/MS-Jet-SQL/" rel="noopener ugc nofollow" target="_blank"> Jet SQL </a>来代替。</p><p id="f731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然大多数标准的 SQL 查询在翻译时不会出现大的问题，但是 T-SQL 为使用它的人提供了很大的好处。例如，它提供了创建<a class="ae ky" href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/variables-transact-sql?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank">变量</a>的能力，允许更简洁的查询。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="2c79" class="mx lw it mt b gy my mz l na nb">DECLARE @myVariable INT<br/>SET @myVariable = 5</span></pre><p id="5fc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，T-SQL 引入了创建<a class="ae ky" href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/while-transact-sql?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"> while 循环</a>的能力，这允许查询中的迭代。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c3bc" class="mx lw it mt b gy my mz l na nb">DECLARE @Counter INT<br/>SET @Counter = 0</span><span id="29f4" class="mx lw it mt b gy nc mz l na nb">WHILE (@Counter &lt; 10)<br/>BEGIN<br/>  PRINT 'Example'<br/>  SET @Counter = @Counter + 1<br/>END</span></pre><p id="77e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它还提供了<a class="ae ky" href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/try-catch-transact-sql?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"> Try/Catch </a>逻辑来更动态地处理错误。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="02a7" class="mx lw it mt b gy my mz l na nb">BEGIN TRY<br/>  SELECT * FROM MisspelledTableName;<br/>END TRY<br/>BEGIN CATCH<br/>  SELECT <br/>    ERROR_NUMBER() AS ErrorNumber,<br/>    ERROR_MESSAGE() AS ErrorMessage;<br/>END CATCH</span></pre><p id="7fb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然详述微软在 T-SQL 中包含的所有额外特性本身就值得一篇<a class="ae ky" href="https://docs.microsoft.com/en-us/sql/t-sql/language-reference?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank">文章来讨论</a>，但这足以说明当与他们的产品线一起工作时，这种扩展使 SQL 成为一种更动态的语言。</p><h1 id="af19" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">PL/SQL</h1><p id="2ae8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/PL/SQL" rel="noopener ugc nofollow" target="_blank">SQL</a>的过程化语言，缩写为 PL/SQL，是 Oracle 对 SQL 的<a class="ae ky" href="https://www.oracle.com/database/technologies/appdev/plsql.html" rel="noopener ugc nofollow" target="_blank">扩展。与微软的 T-SQL 非常相似，Oracle 的版本试图在使用他们的解决方案时赋予 SQL 更多的功能。因此，PL/SQL 既可以在他们著名的数据库上工作，也可以在最近的云服务上工作。</a></p><p id="35d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就与 T-SQL 的能力而言，PL/SQL 有很多重叠，它还具有<a class="ae ky" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/sqpug/VARIABLE.html" rel="noopener ugc nofollow" target="_blank">变量</a>的特性。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="b3a9" class="mx lw it mt b gy my mz l na nb">DECLARE<br/>  myVariable NUMBER := 5;<br/>BEGIN<br/>  NULL;<br/>END;</span></pre><p id="5d99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，PL/SQL 允许使用循环。然而，与 T-SQL 不同的是，除了<a class="ae ky" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/lnpls/WHILE-LOOP-statement.html" rel="noopener ugc nofollow" target="_blank"> while 循环</a>之外，PL/SQL 还具有两个独立的<a class="ae ky" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/lnpls/basic-LOOP-statement.html" rel="noopener ugc nofollow" target="_blank">循环</a> <a class="ae ky" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/lnpls/FOR-LOOP-statement.html" rel="noopener ugc nofollow" target="_blank">结构</a>，为实现提供了不同的选项。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d2d6" class="mx lw it mt b gy my mz l na nb">DECLARE <br/>  i NUMBER := 0;<br/>BEGIN<br/>  LOOP<br/>    dbms_output.put_line(i);<br/>    i := i + 1<br/>    IF i &gt; 5 THEN<br/>      exit;<br/>    END IF<br/>  END LOOP<br/>END;</span></pre><p id="0427" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，PL/SQL 最有趣和最有利的特性之一是<a class="ae ky" href="https://docs.oracle.com/en/database/oracle/oracle-database/21/adobj/about-oracle-objects.html#GUID-8F0BA083-FA6D-4373-B440-50FDDA4D6E90" rel="noopener ugc nofollow" target="_blank">面向对象编程</a>。那些习惯于这种编程范式的人将很快利用这种独特的选项。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8add" class="mx lw it mt b gy my mz l na nb">CREATE OR REPLACE TYPE person AS OBJECT (<br/>  firstName VARCHAR2(30),<br/>  lastName VARCHAR2(30)<br/>);<br/>/</span></pre><p id="67f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后可以调用该对象。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d0c5" class="mx lw it mt b gy my mz l na nb">DECLARE<br/>  customer person;<br/>BEGIN<br/>  customer := person("John", "Doe");<br/>  dbms_output.put_line(customer.firstName);<br/>  dbms_output.put_line(customer.lastName);<br/>END;</span></pre><p id="0b65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://docs.oracle.com/en/" rel="noopener ugc nofollow" target="_blank">官方文档</a>中可以更深入地探索更多的特性，但是很容易看出 Oracle 创建 PL/SQL 是为了让数据专业人员以比简单的通用 SQL 更强大的方式利用他们的数据库。</p><h1 id="984a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">PL/sgSQL</h1><p id="1b7b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">从 SQL 的公司风格转向免费和开源，<a class="ae ky" href="https://www.postgresql.org/docs/current/plpgsql.html" rel="noopener ugc nofollow" target="_blank">过程语言/postgreSQL </a>，或 PL/sgSQL，是 postgreSQL 使用的方言。PL/sgSQL 不仅仅是一个相似的名称，它与 Oracle 的 PL/SQL 有许多共同的特性。事实上，这两者非常相似，以至于 PostgreSQL 甚至在其官方<a class="ae ky" href="https://www.postgresql.org/docs/current/plpgsql-porting.html" rel="noopener ugc nofollow" target="_blank">文档</a>中专门用了一页来说明它们之间相对较少的差异。</p><p id="3c07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列出的一些差异包括字符串变量的不同关键字，使用 REVERSE 关键字时处理循环的略有不同的方法，以及如何编写函数体的一些细微差别。</p><p id="4c7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，这两个扩展非常相似，并且允许使用 SQL 进行更多的动态编程。</p><h1 id="c027" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">SQL 的其他变体</h1><p id="22df" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">尽管 SQL 或多或少是数据库行业的标准，但不同的实现不可避免地会产生一些差异。此外，许多数据库、工具和技术在某种程度上使用了 SQL 这个名称，这导致了进一步的混淆。虽然不全面，但还有一些其他类型的 SQL 值得一提:</p><p id="3b49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://cassandra.apache.org/doc/latest/cassandra/cql/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">CQL</strong></a>—NoSQL 的一个特定变体，用于 Cassandra 数据库。官方文件<a class="ae ky" href="https://cassandra.apache.org/doc/latest/cassandra/cql/" rel="noopener ugc nofollow" target="_blank">详细描述了它的细节。</a></p><p id="0d4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.geeksforgeeks.org/dynamic-sql/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> DSQL </strong> </a> —动态 SQL 的简称，这不是一种特定的语言，而是一种允许在运行时动态编写查询的通用技术。顺便说一下，它还与一个<a class="ae ky" href="https://dsql.readthedocs.io/en/develop/#" rel="noopener ugc nofollow" target="_blank">查询构建器</a>共享一个名称。</p><p id="530e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://firebirdsql.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">火鸟 SQL</strong></a>——一个自由开放源码的数据库，通常只被称为火鸟，但有时会收到 SQL 后缀。因为它是一个数据库，所以它不是 SQL 的一种独特方言，而是接受几种变体的<a class="ae ky" href="https://firebirdsql.org/file/documentation/chunk/en/refdocs/fblangref30/fblangref30-structure.html" rel="noopener ugc nofollow" target="_blank"> ANSI SQL 方言</a>。</p><p id="7b95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://documentation.help/MS-Jet-SQL/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Jet SQL</strong></a>——前面已经简要提到，Jet SQL 是构建 Microsoft Access 的变体。通常不需要手动编写查询，因为 Access 的内置查询生成器通常会生成代码并处理任何差异。</p><p id="3561" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.mysql.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">MySQl</strong></a>——另一个免费的开源数据库，使用了一种同名的 SQL 风格。它与 SQL 之间只有细微的区别，详见<a class="ae ky" href="https://dev.mysql.com/doc/refman/8.0/en/differences-from-ansi.html" rel="noopener ugc nofollow" target="_blank">正式文件</a>。值得注意的是，另一个流行的开源数据库 MariaDB 是 MySQL 的一个分支，并且保持了与它的高度兼容性。</p><p id="203a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/NoSQL" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">NoSQL</strong></a>——一个用来描述非关系数据查询方法的总称，NoSQL 仍然使用与常规 SQL 重叠的查询命令。</p><p id="fb50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.sqlalchemy.org/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">SQLAlchemy</strong></a><strong class="lb iu"/>——虽然不是真正的 SQL 风格，但它是一个 Python 工具包，可以将面向对象的语言转换为针对各种不同数据库实现的 SQL 查询，无需了解它们的差异。</p><p id="3210" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.sqlite.org/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">SQLite</strong></a>——SQLite 是基于文件的，而不是基于服务器的，它是一个轻量级数据库，不是语言本身的变体。主要用于本地应用程序，它的 SQL 风格在数据类型、关键字方面有一些小的变化，并且不包括常规 SQL 的一些特性。</p><h1 id="e7b5" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="c5b6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">虽然 SQL 是一个行业标准，但是它的各种实现方式给那些进入这个领域的人带来了很多困惑和挫折。虽然这不一定是一件坏事，但很大程度上是因为这些实现极大地扩展了基础语言的能力，可能需要额外的教育来充分理解它们的差异。</p><p id="8f3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，许多工具和数据库通过在其名称中选择使用 SQL 来进一步混淆这个问题。然而，通过一些研究，区分语言和数据库或工具是可能的。</p></div></div>    
</body>
</html>