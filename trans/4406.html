<html>
<head>
<title>Isolation Forest — Auto Anomaly Detection with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">隔离林—使用Python自动检测异常</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/isolation-forest-auto-anomaly-detection-with-python-e7a8559d4562#2022-09-29">https://towardsdatascience.com/isolation-forest-auto-anomaly-detection-with-python-e7a8559d4562#2022-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6ef8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python的Scikit-learn库检测异常值</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5cbfbbec4fa07c4e98e0c56df93ab7f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*93pit0tTWbbeZ_wf5b4LmQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由pix abay:<a class="ae ky" href="https://www.pexels.com/photo/black-tree-near-body-of-water-35796/" rel="noopener ugc nofollow" target="_blank">https://www . pexels . com/photo/black-tree-near-body-of-water-35796/</a></p></figure><p id="d67b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html" rel="noopener ugc nofollow" target="_blank">隔离森林</a>是一种流行的无监督机器学习算法，用于检测数据集内的异常(离群值)。异常检测是任何机器学习和数据科学工作流的关键部分。没有在早期识别的错误值会导致机器学习模型的预测不准确，因此会影响对这些结果的解释。</p><p id="f129" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇短文中，我们将介绍算法的基础，以及如何使用<a class="ae ky" href="https://scikit-learn.org/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Scikit-learn </a>用<a class="ae ky" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> Python </a>轻松实现它。</p><p id="df72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是首先，我们需要知道异常值到底是什么。</p><h1 id="2aa9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是离群值？</h1><p id="7059" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">处理真实世界的数据时，经常会遇到超出正常趋势的数据点。这些通常被称为<strong class="lb iu">异常值</strong>或<strong class="lb iu">异常值</strong>。检测异常非常有用，原因有很多，包括:</p><ul class=""><li id="ddc7" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">检测欺诈性信用卡交易</li><li id="48b2" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">识别可能表明未经授权访问的异常网络流量</li><li id="7104" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">探测深空图像中有可能成为新星的异常点/像素</li><li id="ff82" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">检测医学扫描中的异常“特征”</li></ul><p id="6057" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在测井测量和岩石物理数据中，异常值可能由于被冲刷的钻孔、工具和传感器问题、罕见的地质特征以及数据采集过程中的问题而出现。</p><p id="bc5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在数据科学/机器学习工作流的早期识别和调查异常值是非常重要的，因为它们可能导致机器学习模型的预测不准确。</p><p id="e887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python中有许多算法，无论是有监督的还是无监督的，都可以用来检测这些异常。</p><p id="8bc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在监督学习的情况下，我们可以使用我们已经检查过并标记为好或坏的数据样本来训练模型，并使用它来预测新的数据样本是否异常。</p><p id="cc9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，这些方法具有许多问题，包括减少计算时间所需的小数据集大小和低维度，并且异常在标记的数据中可能是罕见的，导致检测到假阳性。</p><p id="c33f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中一种无监督的方法叫做<strong class="lb iu">隔离森林。关于该算法如何工作的全部细节可以在刘等人(2008)的原始论文中找到，并且可以在这里免费获得<strong class="lb iu"/><a class="ae ky" href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a>。</strong></p><h1 id="1028" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">隔离林方法</h1><p id="4fe0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html" rel="noopener ugc nofollow" target="_blank">隔离森林</a>是一种基于模型的异常值检测方法，它试图使用决策树集合将异常从其余数据中隔离出来。它不依赖于在标记数据上训练模型。</p><p id="040a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该方法选择一个要素，并在最小值和最大值之间随机分割数据。然后，该过程沿着决策树继续进行，直到数据中所有可能的拆分都已完成，或者达到拆分数量的限制。</p><p id="d133" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何异常/异常值都将在流程的早期被分离出来，使其易于识别并与其余数据隔离。</p><p id="4d3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用这种方法检测异常假设:</p><ul class=""><li id="309b" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">异常的存在是很小的</li><li id="ee80" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">异常值不同于正常值</li></ul><p id="744a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图展示了一个非常简单的例子，它使用了一个变量——体积密度(RHOB)和一棵树。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/178ea16ed0d8fefb94f5903f6c81741b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5MQajgrmaq5WEg7X.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测井数据隔离林示例。图片由作者提供。</p></figure><p id="1d45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于我们使用的是随机拟合数据的树的集合(组),因此我们可以取出现异常值的树内深度的平均值，并对该数据点的“异常值”进行最终评分。</p><h2 id="11f3" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">隔离林的优势</h2><p id="2a1c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">与传统的基于距离和密度的模型相比，隔离林有许多优势:</p><ul class=""><li id="973b" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">减少计算时间，因为异常情况可以尽早快速识别</li><li id="266d" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">可轻松扩展到高维度和大型数据集</li><li id="8ff2" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">在一定程度上对数据进行子采样，这是其他方法无法做到的</li><li id="d5fc" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">包含不相关的功能时有效</li></ul><h1 id="d14a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">隔离林Python教程</h1><p id="16a2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在下面的例子中，我们将看到如何用<a class="ae ky" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> seaborn </a>增强散点图。</p><h2 id="5652" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">数据源</h2><p id="d066" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为此，我们将使用一个更大数据集的子集，该数据集曾被用作Xeek和FORCE 2020 <em class="nt"> (Bormann等人，2020) </em>举办的机器学习竞赛的一部分。它是在挪威政府的NOLD 2.0许可下发布的，详细信息可以在这里找到:<a class="ae ky" href="https://data.norge.no/nlod/en/2.0/" rel="noopener ugc nofollow" target="_blank">挪威开放政府数据许可(NLOD) 2.0 </a>。</p><p id="495a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的数据集可以通过以下链接获得:【https://doi.org/10.5281/zenodo.4351155<a class="ae ky" href="https://doi.org/10.5281/zenodo.4351155" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="e661" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文中的所有示例都可以用于任何数据集。</p><h2 id="9b18" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">导入库和数据</h2><p id="9cc0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对于本教程，我们将需要从Scitkit-Learn 导入<a class="ae ky" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> seaborn </a>、<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>和<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html" rel="noopener ugc nofollow" target="_blank"> IsolationForest。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="a6b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导入这些数据后，我们接下来需要加载我们的测井数据。在本例中，数据存储在一个CSV文件中，包含单井的测量值:15/9–15。</p><p id="3956" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您不熟悉这种类型的数据，请不要担心，本教程中展示的技术同样可以应用于其他数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b341" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将返回以下数据帧摘要:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/ead637efb6cadf70b6aaf500dc4ff79b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-6TwGf1Qm5LDCADWFnyZw.png"/></div></div></figure><p id="33d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的总结只显示了文件中的数字数据。如果我们想要查看数据帧中的所有特性，我们可以调用<code class="fe nx ny nz oa b">df.info()</code>，这将通知我们有12列数据，以及不同级别的完整性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/1345676c54740696bad1d4c9730e5658.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*qvCAiyl7CkQzlmWwrS4ulw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据框内的特征概述。图片由作者提供。</p></figure><p id="9748" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与许多机器学习算法一样，我们需要处理丢失的值。如上所示，我们有几列，如NPHI(中子孔隙度)有13，346个值，伽马射线有17，717个值。</p><p id="f464" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理这些缺失值的最简单方法是删除它们。尽管这是一个快速的方法，但也不应该盲目地去做，你应该尝试去理解丢失值的原因。在构建机器学习模型时，删除这些行会导致数据集减少。</p><p id="7897" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想了解更多关于处理缺失数据的信息，我建议你看看我的这些文章:</p><ul class=""><li id="ae98" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/using-the-missingno-python-library-to-identify-and-visualise-missing-data-prior-to-machine-learning-34c8c5b5f009">在机器学习之前，使用missingno Python库识别和可视化缺失数据</a></li><li id="8a13" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/identifying-and-handling-missing-well-log-data-prior-to-machine-learning-5fa1a3d0eb73">在岩石物理机器学习之前识别和处理缺失的测井数据</a></li></ul><p id="22fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要删除丢失的行，我们可以调用:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="f72d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们再次调用<code class="fe nx ny nz oa b">df</code>，我们将会看到每一列的值减少到了13，290。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/90a7f29375d1e4f4ff4134c092d9f13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*U6BkRTV9MglsHftUial3Tg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">移除空值后数据帧中的要素概述。图片由作者提供。</p></figure><h1 id="25bf" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用Scikit-Learn构建隔离林模型</h1><p id="5ba1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">从我们的数据框架中，我们需要选择用于训练隔离森林模型的变量。</p><p id="8e97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我将只使用两个变量(NPHI和RHOB)。实际上，我们会使用更多，稍后我们会看到一个例子。使用两个变量可以让我们看到算法做了什么。</p><p id="b9de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将创建一个列名列表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="8809" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将创建隔离林模型的一个实例。这是通过首先创建一个名为<code class="fe nx ny nz oa b">model_IF</code>的变量，然后将它赋给<code class="fe nx ny nz oa b">IsolationForest()</code>来完成的。</p><p id="85ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们可以为我们的模型传入一些参数。我在下面的代码中使用的是:</p><ul class=""><li id="1f32" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><strong class="lb iu">污染</strong>:这是我们期望被视为异常值的总数据量。我们可以传入一个0到0.5之间的值，或者将其设置为auto。</li><li id="dc97" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu"> random_state </strong>:这让我们可以控制分裂树的随机选择过程。换句话说，如果我们用相同的数据和参数重新运行这个模型，并且这个参数的值是固定的，那么我们应该得到可重复的输出。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="13f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们的模型被初始化，我们就可以用数据来训练它。为此，我们调用<code class="fe nx ny nz oa b">.fit()</code>函数，并将其传递给我们的dataframe ( <code class="fe nx ny nz oa b">df</code>)。当我们传递dataframe参数时，我们还将选择我们之前定义的列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="11a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">拟合模型后，我们现在可以创建一些预测。为此，我们将在数据框架中添加两个新列:</p><ul class=""><li id="d44c" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><code class="fe nx ny nz oa b">anomaly_scores</code>:通过调用<code class="fe nx ny nz oa b">model_IF.decision_function()</code>生成，提供数据集中每个样本的异常分值。分数越低，样本越不正常。负值表示样本是异常值。</li><li id="6cfa" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><code class="fe nx ny nz oa b">anomaly</code>:调用<code class="fe nx ny nz oa b">model_IF.predict()</code>生成，用于标识一个点是<strong class="lb iu">离群点(-1) </strong>还是<strong class="lb iu">内界点(1) </strong></li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="534e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦发现异常，我们就可以查看我们的数据框架并看到结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/081de32e5f4df10babc82a60bb468610.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*CplvWBl9qzQ18j3Q7fRRgg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示异常检测结果的熊猫数据框。值为1表示数据点是好的。图片由作者提供。</p></figure><p id="df61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的返回值中，我们可以看到原始输入要素、生成的异常得分以及该点是否为异常。</p><h1 id="64ef" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用matplotlib可视化异常数据</h1><p id="42e5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">查看数值并尝试确定该点是否已被识别为异常值可能会很乏味。</p><p id="41de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，我们可以使用seaborn生成一个基本图形。我们可以使用我们用来训练模型的数据，并在视觉上将它分成离群值或内联值。</p><p id="0704" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个简单的函数旨在生成图表，并以文本形式提供一些额外的指标。该函数采用:</p><ul class=""><li id="e4c7" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><code class="fe nx ny nz oa b">data</code>:包含数值的数据帧</li><li id="ad4c" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><code class="fe nx ny nz oa b">outlier_method_name</code>:我们正在使用的方法的名称。这只是为了展示的目的</li><li id="39fc" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><code class="fe nx ny nz oa b">xvar</code>、<code class="fe nx ny nz oa b">yvar</code>:我们要分别绘制在x轴和y轴上的变量</li><li id="3fa2" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><code class="fe nx ny nz oa b">xaxis_limits</code>、<code class="fe nx ny nz oa b">yaxis_limits</code>:x轴和y轴范围</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="c3e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦定义了函数，我们就可以传入所需的参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="7aaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这产生了下面的图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/f732a0c1d335d5aa0783f9136de7b31c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OCSAWQqac1WIXWn8GBURSw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Seaborn散点图显示了隔离林模型确定的异常值和内部值。图片由作者提供。</p></figure><p id="bea9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以马上知道有多少值被识别为异常值，以及它们位于何处。由于我们只使用了两个变量，我们可以看到，我们基本上已经在数据边缘的点和数据中心的点之间形成了分离。</p><h2 id="68a7" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">增加隔离林污染值</h2><p id="c6b9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">前面的示例使用0.1 (10%)的值作为污染参数，如果我们将该值增加到0.3 (30%)会怎么样？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="2198" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们运行上面的代码时，我们得到了下面的图。我们可以看到更多的点被选择并识别为异常值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/b8c47a506ba64f0ae4410e8117c3875f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*6P3NHjpLztfGXcUflDP7xg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Seaborn散点图显示了隔离森林模型确定的30%污染的异常值和内部值。图片由作者提供。</p></figure><h2 id="8ff1" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">我们如何知道设置哪个污染值？</h2><p id="10c2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">通过设置污染值，我们可以确定哪些百分比的值应该被识别为异常值，但选择该值可能会很棘手。</p><p id="d0ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择这个值没有严格的规则，它应该基于围绕数据及其预期应用程序的领域知识。</p><p id="3f95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个我非常熟悉的数据集，我会考虑其他特征，如井径和δ-rho(DRHO ),以帮助识别潜在的不良数据。</p><h1 id="9a12" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">对隔离林使用2个以上的功能</h1><p id="cd55" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在，我们已经看到了使用只有两个变量的隔离林的基础，让我们看看当我们使用更多的变量时会发生什么。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/641614acd254ccdd91db02f41958cad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*XRmmGoZyNIler3S3VWCzYA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Seaborn散点图显示了隔离森林模型使用多个输入要素和10%污染确定的异常值和内界值。图片由作者提供。</p></figure><p id="a4be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在看到，被识别为异常值的点在散点图上更加分散，并且在一组核心点周围没有硬边界。</p><h2 id="ffee" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">用Seaborn的配对图显示异常值</h2><p id="e1b3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们可以看看我们用过的所有变量，而不是只看两个变量。这是通过使用seaborn pairplot来完成的。</p><p id="5fac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要设置调色板，这将允许我们控制在情节中使用的颜色。</p><p id="20ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以调用<code class="fe nx ny nz oa b">sns.pairplot</code>并传入所需的参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="c355" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它返回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/cbfb21a623a0042a00794d4b4284d3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xE2G-qWOq2mMjb7UkRKzbA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">隔离森林后数据集中所有要素的Seaborn pairplot。橙色点表示异常值(-1)，蓝色点表示内部值(1)。图片由作者提供。</p></figure><p id="e3a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这为我们提供了一个更好的数据概览，我们现在可以清楚地看到其他特性中突出显示的一些异常值。尤其是在PEF和GR特性中。</p><h1 id="f984" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">摘要</h1><p id="db5f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">隔离森林是一种易于使用和理解的无监督机器学习方法，可以将异常数据点从良好数据中隔离出来。如果需要，该算法可以扩展到处理大型和高维数据集。</p><p id="dc95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有兴趣了解这种方法与其他方法的比较，您可能会喜欢下面的文章:</p><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/well-log-data-outlier-detection-with-machine-learning-a19cafc5ea37"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">基于机器学习和Python的测井数据异常检测</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">异常值的识别是岩石物理机器学习工作流程中的一个重要步骤</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ks ol"/></div></div></a></div></div><div class="ab cl pa pb hx pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="im in io ip iq"><p id="75b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nt">感谢阅读。在你走之前，你一定要订阅我的内容，把我的文章放到你的收件箱里。</em> <a class="ae ky" href="https://andymcdonaldgeo.medium.com/subscribe" rel="noopener"> <strong class="lb iu"> <em class="nt">你可以在这里做！</em></strong></a><strong class="lb iu"><em class="nt"/></strong><em class="nt">或者，您也可以</em> <a class="ae ky" href="https://fabulous-founder-2965.ck.page/2ca286e572" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nt">注册我的简讯</em> </strong> </a> <em class="nt">免费将更多内容直接发送到您的收件箱。</em></p><p id="2e54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，通过注册会员，你可以获得完整的媒介体验，并支持我和其他成千上万的作家。每月只需花费你5美元，你就可以接触到所有精彩的媒体文章，也有机会通过写作赚钱。如果你用 <a class="ae ky" href="https://andymcdonaldgeo.medium.com/membership" rel="noopener"> <strong class="lb iu"> <em class="nt">我的链接</em></strong></a><strong class="lb iu"><em class="nt"/></strong><em class="nt">报名，你直接用你的一部分费用支持我，不会多花你多少钱。如果你这样做了，非常感谢你的支持！</em></p><h2 id="cff1" class="nh lw it bd lx ni nj dn mb nk nl dp mf li nm nn mh lm no np mj lq nq nr ml ns bi translated">参考</h2><p id="4160" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">博尔曼，彼得，奥桑德，彼得，迪里布，法哈德，曼拉尔，投降，&amp;迪辛顿，彼得。(2020).机器学习竞赛FORCE 2020井测井和岩相数据集[数据集]。芝诺多。<a class="ae ky" href="http://doi.org/10.5281/zenodo.4351156" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.5281/zenodo.4351156</a></p></div></div>    
</body>
</html>