<html>
<head>
<title>How To Read Multiple CSV Files Non-Iteratively (and Without Pandas)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何非迭代地读取多个CSV文件(并且没有熊猫)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-read-multiple-csv-files-non-iteratively-and-without-pandas-984fd954999c#2022-05-30">https://towardsdatascience.com/how-to-read-multiple-csv-files-non-iteratively-and-without-pandas-984fd954999c#2022-05-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0d16" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对熊猫的读CSV方法说不！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dc8f4b092d9d8e62f654ee4efa116a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0oIEezKoAUE_IvMN"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Solaiman Hossen 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3789" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Pandas的一个主要警告是它不能扩展到多个CPU核心(通常)。本质上，当您运行任何操作时，在理想情况下并行化是可能的，Pandas仍将坚持传统的单核执行，而其他内核将闲置。当您构建大规模应用程序时，这一点尤其重要。</p><p id="d9aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">处理大规模数据驱动的应用程序需要通过优化算法来加快执行速度，并消除/减少管道中每一个可能的位的运行时间。在我看来，经常被忽视的一个领域是优化输入输出操作。</p><p id="7307" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您有数百个CSV文件需要读入python环境。毫无疑问，你的第一选择是熊猫。另外，即使您没有处理大量的CSV文件，我也总是建议您删除所有的CSV文件，将它们转换为相对更快、存储效率更高的文件，比如Pickle、Feather或Parquet。</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/why-i-stopped-dumping-dataframes-to-a-csv-and-why-you-should-too-c0954c410f8f"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">为什么我停止向CSV转储数据帧，为什么您也应该这样做</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">是时候告别pd.to_csv()和pd.read_csv()了</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="4d80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你必须使用CSV，我个人不推荐使用熊猫的CSV读写功能，你可以在我下面的帖子中找到答案。</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/its-time-to-say-goodbye-to-pd-read-csv-and-pd-to-csv-27fbc74e84c5"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">是时候告别pd.read_csv()和pd.to_csv()了</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">讨论熊猫的另一个重要警告</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="mk l mg mh mi me mj kp lv"/></div></div></a></div><p id="77b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，回到我们的数百个CSV文件的场景，在这里，读取多个CSV文件的一种简单方法可以是在一个循环中迭代它们，获得Pandas数据帧的列表，并将该列表连接成单个数据帧。这将在下面演示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/8e3015417ef3794e7af1355f91355b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5kzC-BCVZyt8dnm3Ldbkxg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用Pandas读取多个CSV文件的代码片段(图片由作者提供)</p></figure><p id="a05d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，这种方法存在一些问题:</p><ol class=""><li id="4a33" class="mm mn iq ky b kz la lc ld lf mo lj mp ln mq lr mr ms mt mu bi translated">该循环不可避免地引入了一个迭代过程，即一次只能读取一个CSV文件，从而导致资源利用不足。</li><li id="0ffc" class="mm mn iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">Pandas read-csv方法本身是一个序列化的过程。</li></ol><p id="d84a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章旨在解决上述两个与熊猫有关的读取多个CSV文件的问题，我们将在这篇文章中探索<strong class="ky ir">数据表</strong>。</p><blockquote class="na"><p id="adfc" class="nb nc iq bd nd ne nf ng nh ni nj lr dk translated">Datatable是一个用于操作表格数据的python库。它支持内存不足的数据集、多线程数据处理和灵活的API。</p></blockquote><h1 id="b878" class="nk nl iq bd nm nn no np nq nr ns nt nu jw nv jx nw jz nx ka ny kc nz kd oa ob bi translated"><strong class="ak">使用数据表读取多个CSV(非迭代):</strong></h1><p id="cf33" class="pw-post-body-paragraph kw kx iq ky b kz oc jr lb lc od ju le lf oe lh li lj of ll lm ln og lp lq lr ij bi translated">下面的代码片段演示了如何使用DataTable读取多个CSV文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/e06e4dac2d024a1ff0945ee0c06924b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XAg9uqY6dUPTmjQCAwvjMg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用数据表读取多个CSV文件的代码片段(图片由作者提供)</p></figure><h1 id="ee56" class="nk nl iq bd nm nn no np nq nr ns nt nu jw oi jx nw jz oj ka ny kc ok kd oa ob bi translated">实验设置:</h1><ol class=""><li id="20fa" class="mm mn iq ky b kz oc lc od lf ol lj om ln on lr mr ms mt mu bi translated">出于实验目的，我用Python生成了10个不同的随机CSV文件，每个文件有10万行和30列——包括字符串、浮点和整数数据类型。</li><li id="7ce9" class="mm mn iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">我重复了下面描述的实验五次，以减少随机性，并从观察到的结果中得出公正的结论。我下面报告的数字是五次实验的平均值。</li><li id="76cf" class="mm mn iq ky b kz mv lc mw lf mx lj my ln mz lr mr ms mt mu bi translated">Python环境和库:</li></ol><ul class=""><li id="08a6" class="mm mn iq ky b kz la lc ld lf mo lj mp ln mq lr oo ms mt mu bi translated">Python 3.9.12</li><li id="6e2a" class="mm mn iq ky b kz mv lc mw lf mx lj my ln mz lr oo ms mt mu bi translated">熊猫</li><li id="9e98" class="mm mn iq ky b kz mv lc mw lf mx lj my ln mz lr oo ms mt mu bi translated">数据表1.0.0</li></ul><h1 id="f4df" class="nk nl iq bd nm nn no np nq nr ns nt nu jw oi jx nw jz oj ka ny kc ok kd oa ob bi translated">实验:读取所有CSV文件所花费的时间</h1><p id="97be" class="pw-post-body-paragraph kw kx iq ky b kz oc jr lb lc od ju le lf oe lh li lj of ll lm ln og lp lq lr ij bi translated">下图描述了Pandas和DataTable读取十个CSV文件并生成一个<strong class="ky ir">Pandas数据帧所花费的时间(以秒为单位)。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/c952643aa7d9736b2d5318a5245fe007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*rViDidnd28oO9yExZ67GGQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">描述熊猫和数据表读取CSV文件所用时间的条形图(图片由作者提供)</p></figure><ul class=""><li id="5c04" class="mm mn iq ky b kz la lc ld lf mo lj mp ln mq lr oo ms mt mu bi translated">实验结果表明，在读取CSV文件时，与Pandas相比,<strong class="ky ir">的速度提高了两倍多。</strong></li><li id="b768" class="mm mn iq ky b kz mv lc mw lf mx lj my ln mz lr oo ms mt mu bi translated">与Pandas相反，这些结果也为DataTable采用的多线程方法提供了证据。</li></ul><h1 id="2e7b" class="nk nl iq bd nm nn no np nq nr ns nt nu jw oi jx nw jz oj ka ny kc ok kd oa ob bi translated">结束语</h1><p id="ba53" class="pw-post-body-paragraph kw kx iq ky b kz oc jr lb lc od ju le lf oe lh li lj of ll lm ln og lp lq lr ij bi translated">老实说，我不太喜欢CSV。如果你通读了我之前的帖子(我在上面链接了)和你现在正在读的帖子，你可能也会和我产生共鸣。自从我发现与CSV相关的众多问题后，我尽可能地停止使用它们。</p><p id="0ada" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总之，我认为除非您需要在非pythonic环境(如Excel)之外查看数据框架，否则根本不需要CSV。更喜欢像拼花地板、羽毛或泡菜这样的格式来存储你的数据帧。尽管如此，如果您看不到其他选择，至少通过利用DataTable而不是Pandas来优化您的输入和输出操作。</p></div><div class="ab cl oq or hu os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/ab299f32fe117f0be6b334bc097c49a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*NhjfZUy3UMb1FelI.jpg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">毒枭迷因由作者使用MemesPortal.com创造。</p></figure></div></div>    
</body>
</html>