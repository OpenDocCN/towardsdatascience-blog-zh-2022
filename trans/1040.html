<html>
<head>
<title>An Introduction to Ibis for Python Programmers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 程序员的 Ibis 介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-ibis-for-python-programmers-2112ea32370d#2022-03-18">https://towardsdatascience.com/an-introduction-to-ibis-for-python-programmers-2112ea32370d#2022-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5a2a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">更 Pythonic 化的处理数据库的方式</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/196fcab3dfdda1bfd84c4de5b7483cfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*DQgNQwKjgB0JuvH954vkag.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">照片来自<a class="ae kr" href="https://photostockeditor.com/image-rf/elephant-and-egrit-174825883" rel="noopener ugc nofollow" target="_blank">图片编辑</a></p></figure><p id="8486" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">几周前，我正致力于建立一个关系数据库，以探索来自<a class="ae kr" href="https://data.sfgov.org/Culture-and-Recreation/Civic-Art-Collection/r7bn-7v9c" rel="noopener ugc nofollow" target="_blank"> DataSF 的公民艺术收藏</a>的记录。每当我参加一个技术会议，我都会试着花一两天的时间在这个城市看看它的文化场景，所以这看起来像是有用的信息！我决定使用 MySQL 作为我的数据库引擎。作为一个熊猫出身的人，我对自己编写原始 SQL 查询时的低效和受限感到惊讶。我还花了大量时间来解决查询中的错误，这些错误适用于一种风格的 SQL，但不适用于 MySQL。在整个过程中，我一直在想，如果有一个更 Pythonic 式的方法就好了！！！几周后，我被介绍给了<a class="ae kr" href="https://ibis-project.org/" rel="noopener ugc nofollow" target="_blank">宜必思</a>。在这篇文章中，我将向您简要介绍 Ibis，并带您浏览一些代码示例，展示 Ibis 如何为我的问题提供解决方案。</p><p id="4fd8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">Ibis 提供了一种更 Pythonic 化的方式来与多个数据库引擎进行交互。对于我们这些喜欢在 SQL 字符串上写 python 代码的人来说，这尤其有用。可以在 select 语句中编写的任何东西都可以在 Ibis 中编写。在我自己的冒险中，我总是遇到栖息在大象身上的朱鹭(鸟类版本)。如果你在现实生活中从未见过大象，我可以肯定它们是巨大而复杂的生物。这是我站在两个人旁边的照片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lo"><img src="../Images/581ee8ac832fad80b87ea17f86bd876c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_KQrbM3AzvH3WG0Ohs3LQ.jpeg"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">作者图片</p></figure><p id="a12c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">一只小鸟坐在一只大象上的图像隐喻了 Ibis 如何为用户提供一种不太复杂、更具性能的方式来与多个大数据引擎进行交互。事实上，数据越大越复杂，使用 Ibis 的争议就越大。它简化了您的工作流程，消除了对复杂 SQL 查询的需求。相反，你可以编写类似熊猫的代码，无论你想扩大规模还是缩小规模，代码都保持不变。</p><p id="438a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">比方说，您已经开始在 jupyter 笔记本中编写访问 SQLite 数据库的代码。如果您决定扩大规模并使用 Dask，您可以在同一个笔记本中用一行代码实现这一点。如果需要，Ibis 可以让您自由地切换后端，并在相同的上下文中使用更强大的引擎继续工作。这意味着你的工作保持在一个地方，不容易出错，你的认知负荷也减少了。</p><p id="5851" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">目前，Ibis 支持相当多的后端，包括:</p><p id="ac97" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">传统 DBMS:</strong>PostgreSQL、MySQL、SQLite<br/>T5】分析 DBMS:OmniSciDB、ClickHouse、Datafusion <br/> <strong class="ku ir">分布式 DBMS:</strong>Impala、PySpark、BigQuery <br/> <strong class="ku ir">内存分析:</strong> pandas、Dask</p><p id="400b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">无论您想要与 SQL 数据库还是分布式 DBMSs 进行交互，Ibis 都可以让您用 Python 来实现。对于 Python 程序员来说，Ibis 提供了一种用 Python 编写 SQL 的方法，允许对特定查询引擎(例如 BigQuery)进行单元测试、可组合性和抽象！你可以用一种熟悉的、类似熊猫的语法对你的数据进行连接、过滤和其他操作。</p><p id="4e4a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在这篇文章中，我将带你了解使用 SQLite 后端的一些基本知识，但是如果你想尝试其他的，请查看 Ibis 后端页面的例子。Ibis 目前支持超过 12 个后端，其中一些编译成 SQL，一些直接执行。</p><p id="fb6d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">让我们使用我之前提到的<a class="ae kr" href="https://data.sfgov.org/Culture-and-Recreation/Civic-Art-Collection/r7bn-7v9c" rel="noopener ugc nofollow" target="_blank">公民艺术收藏数据集</a>，看看 Ibis 能做什么！</p><h1 id="42f5" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">装置</h1><p id="0b33" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">可以用 Pip，Conda 或者 Mamba 安装 Ibis。</p><p id="f0a6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">为了安全起见，我建议建立一个虚拟环境。您可以将这些命令复制并粘贴到您的终端中，以安装带有 Pip 或 Conda 的 Ibis。</p><h2 id="af47" class="mq lu iq bd lv mr ms dn lz mt mu dp md lb mv mw mf lf mx my mh lj mz na mj nb bi translated">Pip:</h2><p id="2a36" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">如果您使用 pip 来安装 Ibis，您将需要运行<code class="fe nc nd ne nf b">pip install 'ibis-framework[sqlite]'</code>而不是通常的<code class="fe nc nd ne nf b">pip install ibis-framework</code>来运行 sqlite。如果您喜欢使用另一个后端，请在<a class="ae kr" href="https://ibis-project.org/backends/" rel="noopener ugc nofollow" target="_blank"> Ibis 文档</a>中查找具体的命令。</p><p id="337a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">Mac:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="aaf1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">窗口:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="991f" class="mq lu iq bd lv mr ms dn lz mt mu dp md lb mv mw mf lf mx my mh lj mz na mj nb bi translated">康达:</h2><p id="3c78" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">如果你正在使用 Conda，你可以使用下面的命令，sqlite 框架将默认包含在内。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="2269" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">用 SQLite 创建数据库</h1><p id="8754" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">接下来，我们将创建一个数据库和一个表，其中包含来自 DataSF 的关于旧金山周围艺术的数据。这些数据是开源的，所以你可以直接从网站下载<a class="ae kr" href="https://data.sfgov.org/Culture-and-Recreation/Civic-Art-Collection/r7bn-7v9c" rel="noopener ugc nofollow" target="_blank"> CSV 文件</a>。Ibis 还不支持将 CSV 文件加载到 SQL 表中，所以我们将按照这些命令来创建一个 SQLite 数据库和一个包含我们的数据的表。</p><p id="7d02" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">创建一个名为 civic_art 的文件夹</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="4996" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">为了使接下来的步骤更容易，我将 CSV 文件从我的下载文件夹移动到我们刚刚创建的 civic_art 文件夹中。当我们在 civic_art 文件夹中时，我们用下面的命令创建一个新的数据库。</p><p id="b717" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">创建一个名为 civicArt.db 的数据库</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="2874" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这个命令应该可以在命令行中打开 SQLite。您可以键入<code class="fe nc nd ne nf b">.databases</code>来再次检查数据库是否被正确创建。这是我看到的照片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ni"><img src="../Images/fa0c9a9dcbed16f30a33be9fa8be0e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ynspsvpiK4hihK1CyuvXsQ.png"/></div></div></figure><p id="e999" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">太好了！数据库已成功创建！SQLite 已经在<code class="fe nc nd ne nf b">civicArt database</code>中打开了，所以我们接下来要做的是创建一个表，并将 CSV 文件中的数据加载到其中。</p><p id="fded" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">在</strong> <code class="fe nc nd ne nf b"><strong class="ku ir">civicArt.db</strong></code>中创建一个表<strong class="ku ir">名为</strong> <code class="fe nc nd ne nf b"><strong class="ku ir">civicArtTable</strong></code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="bf43" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">检查表格是否已按预期创建</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="4cdf" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果您的表已经按预期创建，您现在可以通过键入<code class="fe nc nd ne nf b">.quit</code>退出 SQLite。这将带您回到命令行。我们现在准备开始用 Ibis 探索我们的数据！</p><h1 id="7f46" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">连接到数据库</h1><p id="27ca" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">Ibis 的优势之一是它允许您使用自己最熟悉的工具工作。我喜欢用 IPython 编写 Python 代码，但是您也可以使用 jupyter 笔记本或任何您喜欢的 Python shell。无论您选择什么，我们都将使用相同的命令连接到我们之前创建的 civicArt 数据库。</p><p id="af59" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">连接到我们的数据库</strong>(我们将使用 Ibis 的交互模式进行惰性评估)</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="2d18" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这里需要注意的是，<a class="ae kr" href="https://pandas.pydata.org/docs/reference/api/pandas.read_sql.html" rel="noopener ugc nofollow" target="_blank"> pandas.read_sql </a>将数据加载到内存中并自己执行计算。<strong class="ku ir"> Ibis 不会加载数据或执行任何计算</strong>。相反，它将数据留在数据库中，并要求后端在那里执行计算。这意味着您可以以后端的速度执行，而不是本地计算机的速度。思考这个问题的一个好方法是回到我们的大象比喻。如果你需要一些重物，与朱鹭相比，让大象来做可能是个好主意。我们优雅的 Ibis 可以将较重的工作传递给较大的数据库引擎，并观察工作完成的速度比它本身快得多。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nj"><img src="../Images/d603ccc5988f90f331ed78adfa4fc6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*atTbYaDA9jHiah7zINLo-g.jpeg"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">照片由<a class="ae kr" href="https://focusedcollection.com/199821762/stock-photo-botswana-chobe-national-park-game.html" rel="noopener ugc nofollow" target="_blank">存放照片</a></p></figure><p id="1be8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果一切顺利，你应该连接到数据库。接下来我们来看看我们的数据！</p><h1 id="178b" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">查看表格详细信息</h1><p id="a143" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">让我们使用 Ibis 来查看一下 civicArt 数据库中的表。</p><p id="345f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">列出数据库中的所有表格</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6ca5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">为表格指定一个更易读的名称，并列出其中的列</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nk"><img src="../Images/4a14456690ca19c0704664a6f953aabb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XL0eNVRPy4aJJDvV6LQbQ.png"/></div></div></figure><h1 id="a755" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">与 Ibis 争论数据</h1><p id="1fe3" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">现在让我们使用 Ibis 在数据集上执行一些常见的 SQL 命令，并在这个过程中找到一些关于旧金山艺术的有用信息。</p><h2 id="4bf4" class="mq lu iq bd lv mr ms dn lz mt mu dp md lb mv mw mf lf mx my mh lj mz na mj nb bi translated">询问</h2><p id="0608" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated"><strong class="ku ir">您可以在 SELECT 语句中编写的任何内容都可以在 Ibis </strong>中编写。让我们来测试一下！我将使用下面的代码来找出哪些艺术家的作品目前在这个城市展出，以及他们的作品的标题是什么。</p><p id="cb3c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">从表格中选择列</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b183" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">太好了！如果您以前使用过 Pandas，这应该感觉类似于从 Pandas 数据框架中获取列。但是请记住，数据库正在为我们做所有的工作，所以这样效率更高！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nl"><img src="../Images/ef12c6eea3e8736aad1bc5d3f8768553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fclhyhnoz-mWP7CjjmByZA.png"/></div></div></figure><p id="d2f6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我也很好奇总共有多少艺术家展出他们的作品。为了找出答案，让我们找出不同的艺术家，然后计算他们的数量。</p><h2 id="3c37" class="mq lu iq bd lv mr ms dn lz mt mu dp md lb mv mw mf lf mx my mh lj mz na mj nb bi translated">独特和计数</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="1a73" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">您应该已经在表格底部看到了列表的长度，但是为了向您展示计数方法，我们确认在旧金山展出一件或多件作品的艺术家数量为 386 位！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nm"><img src="../Images/830dc2003cf10966bf0162bf54517ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h0I_LFkdrqvMDmFXGywf7A.png"/></div></div></figure><h2 id="f060" class="mq lu iq bd lv mr ms dn lz mt mu dp md lb mv mw mf lf mx my mh lj mz na mj nb bi translated">过滤数据</h2><p id="32d8" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">接下来让我们挑选一位艺术家，并找出他们所有的艺术作品的确切位置。阿德里安·科尔伯恩斯的展览标题《地质幽灵》引起了我的注意，所以让我们选择它们吧！我使用以下命令来完成这项工作。</p><p id="1e12" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">按艺人名称过滤</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nn"><img src="../Images/6fe8be5fca17ae189e90530903e073dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H4RKqgFJIJon1hwQj9xrwg.png"/></div></div></figure><p id="5eb4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">原来 Adriane 有两件展品，一件在 4 Guy Place，另一件在 Dagget 街&amp; 16 街。这太好了，我们已经有一些地方可以添加到我们的旅游行程中了！</p><h2 id="4c0e" class="mq lu iq bd lv mr ms dn lz mt mu dp md lb mv mw mf lf mx my mh lj mz na mj nb bi translated">分组依据</h2><p id="9fa8" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">会议结束后，我通常不会在一个城市停留超过一两天。为了在最短的时间内做最多的事情，知道哪些地方展出的艺术品最多可能是件好事。我们将使用下面的<code class="fe nc nd ne nf b">groupby</code>表达式来获取我们需要的信息。</p><p id="0145" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">获取旧金山最具艺术气息的地点！</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi no"><img src="../Images/47bd7115d49605b04c7d2e5250c0e192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r672vAV0pFnJqnUcconAqA.png"/></div></div></figure><p id="3e34" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">第一站是 Potrero 大街 1001 号，这里展出了 59 本书！！</p><p id="2497" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">出于好奇，我搜索了波特雷罗大道 1001 号，以了解更多关于我所期望的艺术画廊的信息。令人惊讶的是，它竟然是扎克伯格旧金山总医院。他们显然在艺术上投入了大量资金，并拥有令人难以置信的收藏。数据能让你大吃一惊！艺术品数量第二多的地方是位于电报山大道 1 号的 Coit Tower。它不是医院，看起来是一个探索的好地方！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi np"><img src="../Images/a2112cf4a988a481e8f7e953b16031d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOgpfdz02V91EDrQv7ruJw.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">照片来源<a class="ae kr" href="https://www.flickr.com/photos/runner310/532799970/" rel="noopener ugc nofollow" target="_blank"> Flikr </a></p></figure><h2 id="5ac4" class="mq lu iq bd lv mr ms dn lz mt mu dp md lb mv mw mf lf mx my mh lj mz na mj nb bi translated">连接</h2><p id="cae1" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">非常好。在这一点上，我们知道，下次我们在旧金山参加技术会议时，我们有一些很好的选择。现在我们知道去哪里了。下一步是什么？</p><p id="daa6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">嗯，通常美术馆里都是潮人，他们可能会问你展出的艺术家的情况。好在我们可以提前做好这方面的准备！让我们使用一个内部连接来帮助我们找到哪些艺术家有最多的艺术展示，这样我们就可以查找他们，并通过良好的响应感到很酷；)</p><p id="6870" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">使用 inner_join 查找最受欢迎的艺术家</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="dc97" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">(<strong class="ku ir"> I </strong> <a class="ae kr" href="https://ibis-project.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir"> bis 版本 2.1.1 </strong> </a>有时会遇到视图注释被具体化，然后在连接操作中具体化不解析列名的问题。以下代码片段仅适用于版本 2.1.1，并使用 mutate()函数来更改其中一个列标题和 materialize()，以确保可以显示创建的视图。这个应该是在<a class="ae kr" href="https://ibis-project.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ku ir">3 . 0 . 0</strong></a><strong class="ku ir">版本中修复的。</strong>)</p><p id="7b25" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">使用 inner_join </strong>查找当地最受欢迎的艺术家</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nq"><img src="../Images/3576c45a730c245d99ba611cf26388d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbNz53jX9furvWRxU0qCog.png"/></div></div></figure><p id="9e65" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">太棒了。我们现在知道 Mary (McChesney) Fuller 在 Potrero 大道 1001 号展出的艺术品最多，可以在网上搜索了解更多！在我看来，我们已经做好了探索科幻艺术的准备！</p><p id="e459" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们在相对较短的时间内学到了很多信息。如果你喜欢 Python 代码，这可能比写出原始的 SQL 字符串更有效。这也意味着如果你在 IPython 或 jupyter 笔记本上开始你的工作流程，你可以留在那里。这应该感觉更顺畅，并有望提高生产率。使用有助于提高效率的工具意味着你有更多的时间在工作中进行创新和探索！感谢你的阅读，希望我能在世界各地的某个美术馆里看到你看大象。</p><p id="2f2c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">另外，我还做了一个 jupyter 笔记本，里面有这篇文章中列出的所有命令！这里可以找到<a class="ae kr" href="https://github.com/marlenezw/ibis-tutorial" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>