<html>
<head>
<title>A Simple Trick to Load Multiple Excel Worksheets in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Pandas中加载多个Excel工作表的简单技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-trick-to-load-multiple-excel-worksheets-in-pandas-3fae4124345b#2022-04-30">https://towardsdatascience.com/a-simple-trick-to-load-multiple-excel-worksheets-in-pandas-3fae4124345b#2022-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4351" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">高效加载包含多个工作表的Excel文件的快速指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f55c02d3af0022f2a129d617734f2037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MiDr1Hq_bSP7BsfQ.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://pixabay.com/photos/notebook-typing-coffee-computer-1850613/" rel="noopener ugc nofollow" target="_blank">像素</a>上的<a class="ae ky" href="https://pixabay.com/users/pexels-2286921/" rel="noopener ugc nofollow" target="_blank">像素</a>拍摄</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="31ee" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在我的日常工作中，我经常使用Excel文件——获取Excel文件，其中大部分包含多个工作表，并使用Pandas将它们加载到Python中以完成各种任务。我发现这个过程相当繁琐，直到一位同事(感谢<a class="mc md ep" href="https://medium.com/u/b0e2eea1e573?source=post_page-----3fae4124345b--------------------------------" rel="noopener" target="_blank">多嘴多舌的林</a>！)教会了我一个简单的技巧，从此以后，我可以更直观、更有效地完成这项任务。允许我在这篇文章里转发一下！🙂</p><p id="9a8e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><em class="me">本文给出的代码可以在这个</em><a class="ae ky" href="https://github.com/zeyalt/My-Articles/tree/master/Python%20Tips/A%20Simple%20Trick%20To%20Load%20Multiple%20Excel%20Worksheets%20in%C2%A0Pandas" rel="noopener ugc nofollow" target="_blank"><em class="me">GitHub repo</em></a><em class="me">找到。</em></p><h1 id="f671" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">数据</h1><p id="2942" class="pw-post-body-paragraph lg lh it li b lj mx ju ll lm my jx lo lp mz lr ls lt na lv lw lx nb lz ma mb im bi translated">在进入症结之前，让我们先看看下面的Excel文件，这是我创建的，并将用于举例说明。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/89ce1a92f80193575bf1f40f39445d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*0S5WbN6bnTA4cdKBbWvcqA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">包含多个工作表的Excel文件(作者提供的GIF)</p></figure><p id="ce41" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">它包含连续三个月(1月到3月)的虚构(非常简单)销售数据。每个月的销售数据显示在单独的工作表中。</p><h1 id="eb8d" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">我以前做过的事情及其局限性</h1><p id="ff65" class="pw-post-body-paragraph lg lh it li b lj mx ju ll lm my jx lo lp mz lr ls lt na lv lw lx nb lz ma mb im bi translated">假设我的目标是将所有工作表中的数据组合成一个Pandas数据框架。为了完成这个任务，我过去常常做以下事情:</p><ol class=""><li id="7a44" class="nd ne it li b lj lk lm ln lp nf lt ng lx nh mb ni nj nk nl bi translated">使用<code class="fe nm nn no np b">openpyxl</code>或<code class="fe nm nn no np b">pandas</code>获得所有工作表的名称列表。</li><li id="12f7" class="nd ne it li b lj nq lm nr lp ns lt nt lx nu mb ni nj nk nl bi translated">遍历每个工作表，将每个工作表解析为一个Pandas数据帧，并将每个数据帧追加到另一个列表中。</li><li id="7afc" class="nd ne it li b lj nq lm nr lp ns lt nt lx nu mb ni nj nk nl bi translated">使用<code class="fe nm nn no np b">pd.concat</code>将所有内容合并成一个数据帧。</li></ol><p id="8304" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我的代码应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/31f80046964e4407330af7441eb8a571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqbM56HRsnc0VH6sF-bEMA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="dcbd" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">可以想象，这种方法存在一些问题:</p><ul class=""><li id="1f4a" class="nd ne it li b lj lk lm ln lp nf lt ng lx nh mb ny nj nk nl bi translated"><strong class="li iu">你做一个简单的任务</strong>至少有8行代码，效率相当低。</li><li id="99d4" class="nd ne it li b lj nq lm nr lp ns lt nt lx nu mb ny nj nk nl bi translated"><strong class="li iu">你不能在不知道工作表名称的情况下将Excel文件加载到Python </strong>中。您需要一点逆向工程——在您相应地在<code class="fe nm nn no np b">pd.read_excel()</code>函数中指定<code class="fe nm nn no np b">sheet_name</code>参数之前，您首先需要弄清楚工作表的名称。</li><li id="0163" class="nd ne it li b lj nq lm nr lp ns lt nt lx nu mb ny nj nk nl bi translated"><strong class="li iu">您需要指定想要加载的工作表的确切名称</strong>。如果从单个工作表加载数据或者工作表的名称很简单，这可能很简单，但是如果有多个工作表或者工作表名称很复杂，这就容易出错。</li></ul><h1 id="1ac2" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">诀窍是</h1><p id="9f25" class="pw-post-body-paragraph lg lh it li b lj mx ju ll lm my jx lo lp mz lr ls lt na lv lw lx nb lz ma mb im bi translated">现在，为了解决这些问题，这里有一个技巧——只需在<code class="fe nm nn no np b">pd.read_excel()</code>函数中将<code class="fe nm nn no np b">sheet_name</code>参数指定为<code class="fe nm nn no np b">None</code>。是的，就这么简单！让我们走一遍。</p><p id="2866" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">通过在<code class="fe nm nn no np b">pd.read_excel()</code>函数中指定<code class="fe nm nn no np b">sheet_name=None</code>，您将得到一个熊猫数据帧的字典，其中键是工作表的名称，值是每个工作表中作为熊猫数据帧的数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/efb58169e748ed56c562fd0d888d001f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2I9FKY__Dc7aJk9txI_MQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1830" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，如果您希望分析特定工作表中的数据，比如“二月”工作表，您只需执行以下操作:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/57a321029a39c6f06e87646ce0de9946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l9XJv2D9u2fMPxWGVph2RQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c907" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请注意，这将返回一个Pandas DataFrame对象。</p><p id="13f2" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">或者，如果您希望合并多个工作表中的数据，您可以这样做:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/73ef233050279d4c3f2ca31c580ab732.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IpiMVPRI4ws6JZsJFWz_KQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="59af" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在这里，我们在<code class="fe nm nn no np b">pd.concat()</code>中指定<code class="fe nm nn no np b">ignore_index=True</code>，以便结果数据帧的索引按顺序运行。</p><h1 id="75bd" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="3d32" class="pw-post-body-paragraph lg lh it li b lj mx ju ll lm my jx lo lp mz lr ls lt na lv lw lx nb lz ma mb im bi translated">简而言之，完整的代码片段如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="764e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">或者您可以下载并保存以供将来参考的格式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/745a3cc9477c4c5de35378722603bdc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4sstlFkfsvpXFuT7SWgYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由作者使用<a class="ae ky" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">碳</a></p></figure><p id="b5c8" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，您有了更少的代码行，这也转化为更高效和可读的代码。</p><p id="27de" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在我结束之前，请注意<code class="fe nm nn no np b">pd.read_excel()</code>函数中的微小差异:</p><ul class=""><li id="13d7" class="nd ne it li b lj lk lm ln lp nf lt ng lx nh mb ny nj nk nl bi translated">对于Pandas版本≥ 0.21.0: <code class="fe nm nn no np b">pd.read_excel(filename, sheet_name=None)</code></li><li id="2cbf" class="nd ne it li b lj nq lm nr lp ns lt nt lx nu mb ny nj nk nl bi translated">对于熊猫版&lt; 0.21.0:  【T9】 </li></ul><h1 id="ce9c" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">Conclusion</h1><p id="e6b0" class="pw-post-body-paragraph lg lh it li b lj mx ju ll lm my jx lo lp mz lr ls lt na lv lw lx nb lz ma mb im bi translated">So, there you have it — a simple trick to load Excel files with multiple worksheets using Pandas! Depending on your use-cases and the type of Excel files you are working with, this approach may or may not be better than how you are used to doing this task. Nonetheless, I hope this article helps to shed light on this subtle, little-known trick and offers you an alternative method.</p><p id="e4ea" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">👇️<em class="me">这张照片总结了我的同事教给我这个技巧后我的感受，所以如果你也发现它很有用，请随时在评论中与我击掌！</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/767b64148e64f6afe775903435b1750f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yqh4F-hCg4Lx1VZR"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@krakenimages?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> krakenimages </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="6eb6" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">就是这样。感谢阅读！</p><blockquote class="oe of og"><p id="ac8c" class="lg lh me li b lj lk ju ll lm ln jx lo oh lq lr ls oi lu lv lw oj ly lz ma mb im bi translated"><strong class="li iu">在你走之前……</strong></p><p id="65bf" class="lg lh me li b lj lk ju ll lm ln jx lo oh lq lr ls oi lu lv lw oj ly lz ma mb im bi translated">如果这篇文章有价值，并且你希望支持我作为一个作家，请考虑注册一个中级会员。作为会员，你可以无限制地阅读媒体上发表的故事。如果你使用<a class="ae ky" href="https://zeyalt.medium.com/membership" rel="noopener">这个链接</a>注册，我将获得一小笔佣金。如果你想在我发表文章时得到通知，也可以随时加入我的<a class="ae ky" href="https://zeyalt.medium.com/subscribe" rel="noopener">邮件列表</a>。</p></blockquote></div></div>    
</body>
</html>