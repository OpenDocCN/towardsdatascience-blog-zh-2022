<html>
<head>
<title>Machine Learning Magic Triangle</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习魔法三角</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-magic-triangle-b1ee85c7a3fd#2022-10-12">https://towardsdatascience.com/machine-learning-magic-triangle-b1ee85c7a3fd#2022-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3875" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">思考机器学习过程的新方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1681da3147d3ac4e26afc4dad3242d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wnrhAfdMfwhYbkw7RGlwEA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·泽兹奇在<a class="ae ky" href="https://unsplash.com/s/photos/magic-triangle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="13e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面显示的机器学习流程看起来熟悉吗？这是所有数据科学家和机器学习工程师都习惯在工作中看到和使用的流程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/4731eb16d80966d324caae5676cbc9fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2FMeStkmNGTYK6354FOKtQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标准机器学习流程(图片由作者提供)</p></figure><p id="c025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这是一个完美的机器学习流程，但它有以下低效之处</p><ul class=""><li id="e7bf" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">它专注于数据科学的发展，而忽略了开发问题的业务假设的重要部分</li><li id="a1c5" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">这是一个开放的流程。然而，高效的机器学习需要在开始和结束之间形成闭环</li></ul><p id="cabc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇博客文章中，我想介绍一种思考机器学习过程的新方法。我把它命名为机器学习魔术三角。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/21aa8bb67c25d8704b0f8e9aad03fb20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tW3rmFJoH2hTgNH4.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">机器学习魔三角(图片由作者提供)</p></figure><p id="36b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它试图克服标准机器学习流程的低效率。</p><ul class=""><li id="fe0b" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">它侧重于开发问题的业务假设。这非常重要，因为它将数据探索步骤转化为业务语言中的假设</li><li id="4b48" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">通过确保模型解释与初始假设相匹配，这是一个闭环流程。</li></ul><p id="9bb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我举个例子说明一下过程。</p><p id="491c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我举一个电信公司的例子。该公司收集与客户人口统计数据、客户所拥有的服务以及客户是否有过不愉快经历相关的数据。样本数据如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/47dc17f2574b6a3602800578710c0726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZoqPsJHWrB-IYwfm.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">电信客户流失数据集(图片由作者提供)</p></figure><p id="974a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这些数据，我们可以开发一个机器学习模型，用于预测可能流失的客户。目标变量是客户流失，这是我们需要预测的。其他列称为分类(非数字)特征和数字特征。</p><p id="f737" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们来看看开发预测模型所需的步骤。使用这些数据，我们可以开发一个机器学习模型，用于预测可能流失的客户。</p><p id="48df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将经历机器学习神奇三角的以下步骤。</p><p id="745c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据探索和假设</strong>:在这一步中，我们将探索数据，并提出一个假设，解释客户为什么会流失。</p><p id="6756" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习:我们将训练一个机器学习模型，它将能够预测客户是否会流失。</p><p id="8e71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">模型解释</strong>:我们将通过预测已知的流失案例并解释结果来理解机器学习模型。这个解释可以用最初的假设来检验。</p><h1 id="cb20" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">数据探索和假设</h1><p id="6e1e" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">数据探索有助于理解客户为什么会流失。一种有用的数据探索技术是分析<strong class="lb iu">分类(非数字)与目标变量(变动)</strong>。</p><p id="7f30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是性别与流失/不流失以及技术支持与流失/不流失的例子。就性别而言，我们看到，女性与男性的比例相当于搅拌者和非搅拌者。这意味着性别对搅拌没有影响。</p><p id="62fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，对于技术支持，我们发现没有技术支持的客户流失率更高。因此，技术支持是决定客户流失的一个重要因素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/64d118b3cba92d306c4a30bff7eb17c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-LkPrmtQqKWEf-Ke.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分类(非数字)与目标变量(变动)-按作者分类的图像</p></figure><p id="5bc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图是对所有分类变量的分析。你会发现不同的服务(除了电话服务)有助于区分搅拌者和非搅拌者</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/7fb2e414496f8533ee098e101a722298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OkpVe0GKAvg1TTrH.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">所有分类(非数字)与目标变量(变动)-按作者分类的图像</p></figure><p id="248d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用箱线图可视化对<strong class="lb iu">数字变量</strong>进行同样的分析。下面是任期与目标变量的一个例子。我们可以观察到，任期较短的客户很可能会流失。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/5953509382393af7972c18c953a5bc35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EtfZK9zaNx3HqJ5x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数字变量与目标(图片由作者提供)</p></figure><p id="1d14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面显示的是对所有数值变量的分析。你会发现高月费和低总费用也是流失的原因。高总费用也意味着高任期。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/30d3539b9596aaef6153749082f420bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s4QqOP3QJHQB8itL.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">所有数字变量与目标(图片由作者提供)</p></figure><p id="e48b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于以上数据探索，我们可以做出以下<strong class="lb iu">假设:</strong></p><blockquote class="nk nl nm"><p id="6a75" class="kz la nn lb b lc ld ju le lf lg jx lh no lj lk ll np ln lo lp nq lr ls lt lu im bi translated">月费<strong class="lb iu">高的客户</strong>和月费<strong class="lb iu">低的客户(新客户)</strong>更容易流失。此外，这些相对较新的客户支付较高的月费，<strong class="lb iu">并没有将所有服务都包括在较高的月费中。因此，尽管每月收费很高，但他们可能并没有获得价值和服务，所以他们可能会陷入困境</strong></p></blockquote><blockquote class="nr"><p id="00f3" class="ns nt it bd nu nv nw nx ny nz oa lu dk translated">开发这样的文本解释有助于用商业语言描述问题。这也可以帮助业务线领导理解机器学习工作的目标。</p></blockquote><h1 id="425e" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz ob ka my kc oc kd na kf od kg nc nd bi translated">机器学习模型</h1><p id="f36e" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">现在让我们训练一个机器学习模型。机器学习算法有很多种，这里用的是XGBoost。</p><p id="04ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用因变量(X)作为所有人口统计字段、服务类型和计费字段来训练该模型。目标变量(Y)是客户流失。机器学习模型将尝试在X变量和y之间建立关系。</p><p id="fa01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据分为训练(70%的数据)和测试(30%的数据)。机器学习模型是基于训练数据开发的。然后，该模型用于预测测试数据的流失。然后将预测的流失和实际的流失与测试数据进行比较。结果可以被可视化为如下所示的混淆矩阵。</p><p id="c058" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">训练和测试数据准确性都很好。所以我们可以保留基于XGBoost的机器学习模型。</p><p id="1772" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习模型的输出可以被可视化为如下所示的混淆矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/ae55cc7b5296d3c6b631a425e8b0a37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hHBpaWjlTJRiusPE.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">混淆矩阵-作者图片</p></figure><h1 id="e944" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">预测流失和解释预测</h1><p id="7728" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">现在是使用机器学习模型进行预测的时候了。预测是在名为score dataset的数据集上进行的，score dataset是一些不是模型训练的记录。</p><p id="555a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们来解释一些预测。例如，预测客户6894-LFHLY会流失。SHAP解释器将显示如下所示的可视化。</p><blockquote class="nk nl nm"><p id="9c42" class="kz la nn lb b lc ld ju le lf lg jx lh no lj lk ll np ln lo lp nq lr ls lt lu im bi translated">正柱表示该因素有助于客户流失。负柱表示该因素不会导致客户流失。</p></blockquote><p id="80f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到，导致客户流失的主要因素是合同和总费用。合同是月合同，总费用(75)相对较低，表明任期较短。这个解释也符合最初的假设。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/f5e6fbbad998d6b1c456183d9fc1f4a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QbH3qW3s4JPnMtvrFJkoMw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对流失客户的SHAP分析</p></figure><p id="970f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们以客户9767-FFLEM为例，预计他不会流失。预测的解释如下所示。我们发现月费和租期是阻止客户流失的主要因素。任期(38)是高的，因此客户没有搅动。<strong class="lb iu">这个解释也符合最初的假设</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/c49c886b9e1e15be55cf3e52ef603abd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZyORmFZE4FIrgRn8XrE1Dg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">针对非频繁交易客户的SHAP分析(图片来自作者)</p></figure><blockquote class="nr"><p id="833b" class="ns nt it bd nu nv nw nx ny nz oa lu dk translated">你会发现我们闭合了假设和模型解释之间的回路。这使机器学习流程有了目的，并有助于确保结果与问题的商业解释相匹配</p></blockquote><p id="6631" class="pw-post-body-paragraph kz la it lb b lc og ju le lf oh jx lh li oi lk ll lm oj lo lp lq ok ls lt lu im bi translated">这就是机器学习神奇三角的力量！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/21aa8bb67c25d8704b0f8e9aad03fb20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tW3rmFJoH2hTgNH4.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">机器学习魔三角(图片由作者提供)</p></figure><h1 id="9d33" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">结论</h1><p id="4526" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">标准的机器学习流程侧重于数据科学的发展，而忽略了对问题的商业假设的发展。</p><p id="57ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习三角有助于克服标准流程的低效率，方法是专注于开发问题的业务假设，以及关闭预测和假设之间的循环</p><h1 id="451a" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">数据集引用</h1><p id="0bee" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">电信数据集可在此获得。<a class="ae ky" href="https://www.ibm.com/community/terms-of-use/download/" rel="noopener ugc nofollow" target="_blank">T5T7<strong class="lb iu">允许商业和非商业使用。</strong></a></p><div class="ol om gp gr on oo"><a href="https://community.ibm.com/community/user/businessanalytics/blogs/steven-macko/2019/07/11/telco-customer-churn-1113" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">电信客户流失(11.1.3+)</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">编辑描述</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">community.ibm.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ks oo"/></div></div></a></div><p id="c6af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请<strong class="lb iu">订阅</strong>每当我发布一个新的故事时，请保持通知。</p><div class="ol om gp gr on oo"><a href="https://pranay-dave9.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">每当Pranay Dave发表文章时，您都会收到电子邮件。</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">每当Pranay Dave发表文章时，您都会收到电子邮件。通过注册，您将创建一个中型帐户，如果您还没有…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">pranay-dave9.medium.com</p></div></div><div class="ox l"><div class="pd l oz pa pb ox pc ks oo"/></div></div></a></div><p id="d366" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以通过我的推荐链接<strong class="lb iu">加入Medium </strong></p><div class="ol om gp gr on oo"><a href="https://pranay-dave9.medium.com/membership" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">加入我的介绍链接-普拉内戴夫媒体</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">阅读Pranay Dave(以及Medium上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">pranay-dave9.medium.com</p></div></div><div class="ox l"><div class="pe l oz pa pb ox pc ks oo"/></div></div></a></div><h1 id="4305" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">额外资源</h1><h1 id="a91c" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">网站(全球资讯网的主机站)</h1><p id="ae3b" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">你可以访问我的网站进行零编码分析。<a class="ae ky" href="https://experiencedatascience.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/>https://experiencedatascience.com</a></p><h1 id="f898" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">Youtube频道</h1><p id="4ae3" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">这是我在https://www.youtube.com/c/DataScienceDemonstrated的YouTube频道<br/>T5的链接</p></div></div>    
</body>
</html>