<html>
<head>
<title>How to Schedule Jupyter Notebooks In Amazon SageMaker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在亚马逊SageMaker安排Jupyter笔记本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-schedule-jupyter-notebooks-in-amazon-sagemaker-d50fa1c8c0ad#2022-07-28">https://towardsdatascience.com/how-to-schedule-jupyter-notebooks-in-amazon-sagemaker-d50fa1c8c0ad#2022-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="46b6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用AWS服务定期运行Jupyter笔记本的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f8d44c563174761a186794f08db6a251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eD8XqZzMzCv9zaRK"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@towfiqu999999?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Towfiqu barb huya</a>拍摄的照片</p></figure><p id="5643" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你的经理问:“下周你能为我重新运行这个分析吗？”。不用担心:您可以设置一个提醒来手动重新运行它。</p><p id="083b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来的一周，你重新运行分析。这一次，你的经理说，“这太好了。可以每周发给我吗？”真烦人。你不喜欢打开你的Jupyter笔记本，运行它，并将结果保存到S3周刊。这很费时间，而且你的任务清单上还有更有价值的任务。</p><p id="12f8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章是如何在Amazon SageMaker中安排Jupyter笔记本的指南。这些是我用来在<a class="ae kv" href="https://movember.com" rel="noopener ugc nofollow" target="_blank">11月</a>日自动运行时间序列预测笔记本的步骤(更多细节见<a class="ae kv" href="https://medium.com/towards-data-science/build-complex-time-series-regression-pipelines-with-sktime-910bc25c96b6" rel="noopener">本文</a>)。</p><h1 id="4eeb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">解决方案概述</h1><p id="ce66" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我将向您展示如何使用AWS服务安排您的Jupyter笔记本。我会假设你的数据可以在线访问(例如S3，GitHub)，你会把它保存到一个类似的位置。Jupyter笔记本将在亚马逊SageMaker笔记本实例上运行。一个<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/notebook-lifecycle-config.html" rel="noopener ugc nofollow" target="_blank">生命周期配置</a>将通过指定<em class="mp"> conda </em>环境和实现自动停止功能来控制笔记本实例。最后，我们使用<a class="ae kv" href="https://docs.aws.amazon.com/lambda/index.html" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>和<a class="ae kv" href="https://docs.aws.amazon.com/eventbridge/?id=docs_gateway" rel="noopener ugc nofollow" target="_blank"> Amazon EventBridge </a>按照固定的时间表触发笔记本实例。</p><p id="82e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的建筑看起来会像这样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/c0e10b6a47afd12239549998ad00460a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eoHUBrqwGlREWF5-QTPC2Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="83bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将看到我们仅使用AWS服务。第三方选项，比如<a class="ae kv" href="https://blog.jetbrains.com/datalore/2022/06/14/how-to-schedule-a-jupyter-notebook/" rel="noopener ugc nofollow" target="_blank"> JetBrains </a>都有，但是自己做可能更划算。</p><h1 id="d3e5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">场景和输入数据</h1><p id="1f5a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将使用<a class="ae kv" href="https://github.com/CSSEGISandData/COVID-19/blob/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv" rel="noopener ugc nofollow" target="_blank">JHU·CSSE·新冠肺炎的数据</a> [1]，该数据给出了各州和国家每日累计的新冠肺炎病例数。在我们的场景中，我们假设我们的经理要求我们创建一个折线图，显示澳大利亚各州在过去一年中的每日累积案例。我们的地块应该可以在S3以PNG格式访问，看起来像下面的图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/a0eab0f55f5b1ca7d2e67570a5938beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nDzK-MEScLvho9gB-1Z3Jg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="9893" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">创建一个Amazon SageMaker笔记本实例</h1><p id="e41b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们将在一个<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/nbi.html" rel="noopener ugc nofollow" target="_blank">亚马逊SageMaker笔记本实例</a>中运行我们的Jupyter笔记本应用程序。该服务提供完全托管的云笔记本电脑，预装了执行数据科学任务所需的库。</p><p id="809e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先在SageMaker控制台中创建一个新的笔记本实例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/7296710c084f52ee4645a2cd12cd78f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xW6tVb5fIL05SqSEi6Kcmw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="feb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用Jupyter Lab 3创建了一个<em class="mp"> ml.t3.medium </em>实例。我还创建了一个新的IAM角色，该角色将访问我的帐户上的所有S3存储桶。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/bbabcdf426fc5c143b20a48e4ad8b000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tKGriwKVvVhkWRa2ra7SnQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1452" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建您的笔记本实例后，您可以在SageMaker控制台中启动它并打开Jupyter Lab。我将使用<em class="mp"> python3 conda </em>环境内核，它预装了执行本教程所需的基本库。如果您需要在您的环境中安装外部库，您应该阅读<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-add-external.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="8490" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们在我们的环境中创建我们的<strong class="ky ir"> analysis.ipynb </strong> Jupyter笔记本。笔记本使用<em class="mp"> pandas </em>从GitHub读取并处理CSV文件。然后，我们使用<em class="mp"> pandas </em>和<em class="mp"> matplotlib </em>绘制我们的新冠肺炎数据，并将生成的PNG文件导出到我们的S3存储桶。</p><p id="3a14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们示例中的代码如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="6b6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你也可以在<a class="ae kv" href="https://github.com/rtkilian/data-science-blogging/blob/main/schedule_sagemaker_notebooks.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到例子。</p><h1 id="dece" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">将生命周期配置添加到笔记本实例</h1><p id="fdaf" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一个<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/notebook-lifecycle-config.html" rel="noopener ugc nofollow" target="_blank">生命周期配置</a>是一个shell脚本，我们添加到我们的SageMaker笔记本实例来安装包，选择我们的<em class="mp"> conda </em>环境，并自动停止我们的笔记本以防止超额计费。</p><p id="2c41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先为您的笔记本实例添加一个新的配置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/bfb1f043e8389045a2e3ec5abf6130f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ct_rnmrAEyVm3BMd-NEHKQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="d2b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将我们的配置称为<strong class="ky ir"> schedule-configuration </strong>，并包含以下脚本。我们的脚本激活了<em class="mp"> python3 conda </em>环境，并在空闲5分钟后加载命令来自动停止我们的笔记本实例。亚马逊提供的这个<a class="ae kv" href="https://github.com/aws-samples/amazon-sagemaker-notebook-instance-lifecycle-config-samples" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>托管了几个样本生命周期配置脚本，你可以用它们来定制你的笔记本实例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/30152c905f48fadce68a9d745d96edbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xve9NxUT7dz7iXNCkv8X2w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="5a86" class="nd lt iq mz b gy ne nf l ng nh">set -e</span><span id="87ab" class="nd lt iq mz b gy ni nf l ng nh">sudo -u ec2-user -i &lt;&lt;'EOF'</span><span id="890c" class="nd lt iq mz b gy ni nf l ng nh"># PARAMETERS<br/>ENVIRONMENT=python3<br/>NOTEBOOK_FILE=/home/ec2-user/SageMaker/analysis.ipynb</span><span id="e1fc" class="nd lt iq mz b gy ni nf l ng nh">echo "Activating conda env"<br/>source /home/ec2-user/anaconda3/bin/activate "$ENVIRONMENT"</span><span id="31c8" class="nd lt iq mz b gy ni nf l ng nh">echo "Starting notebook"<br/>jupyter nbconvert "$NOTEBOOK_FILE" --ExecutePreprocessor.kernel_name=python --execute --to notebook</span><span id="29ca" class="nd lt iq mz b gy ni nf l ng nh">echo "Dectivating conda env"<br/>source /home/ec2-user/anaconda3/bin/deactivate</span><span id="dfe1" class="nd lt iq mz b gy ni nf l ng nh"># PARAMETERS<br/>IDLE_TIME=300</span><span id="878b" class="nd lt iq mz b gy ni nf l ng nh">echo "Fetching the autostop script"<br/>wget <a class="ae kv" href="https://raw.githubusercontent.com/aws-samples/amazon-sagemaker-notebook-instance-lifecycle-config-samples/master/scripts/auto-stop-idle/autostop.py" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/aws-samples/amazon-sagemaker-notebook-instance-lifecycle-config-samples/master/scripts/auto-stop-idle/autostop.py</a></span><span id="5e10" class="nd lt iq mz b gy ni nf l ng nh">echo "Detecting Python install with boto3 install"</span><span id="58df" class="nd lt iq mz b gy ni nf l ng nh"># Find which install has boto3 and use that to run the cron command. So will use default when available<br/># Redirect stderr as it is unneeded<br/>if /usr/bin/python -c "import boto3" 2&gt;/dev/null; then<br/>    PYTHON_DIR='/usr/bin/python'<br/>elif /usr/bin/python3 -c "import boto3" 2&gt;/dev/null; then<br/>    PYTHON_DIR='/usr/bin/python3'<br/>else<br/>    # If no boto3 just quit because the script won't work<br/>    echo "No boto3 found in Python or Python3. Exiting..."<br/>    exit 1<br/>fi</span><span id="93aa" class="nd lt iq mz b gy ni nf l ng nh">echo "Found boto3 at $PYTHON_DIR"</span><span id="9c86" class="nd lt iq mz b gy ni nf l ng nh">echo "Starting the SageMaker autostop script in cron"</span><span id="f442" class="nd lt iq mz b gy ni nf l ng nh">(crontab -l 2&gt;/dev/null; echo "*/5 * * * * $PYTHON_DIR $PWD/autostop.py --time $IDLE_TIME --ignore-connections &gt;&gt; /var/log/jupyter.log") | crontab -</span><span id="7558" class="nd lt iq mz b gy ni nf l ng nh">EOF</span></pre><p id="1b04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保存生命周期配置后，导航至您的笔记本实例，然后按“编辑”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/09e582b43e5fd099e84283a2f3d932eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rJ6xuz0QfaatAkpjlRBAwQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="53ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加您的生命周期配置并保存。启动您的笔记本实例将加载<em class="mp"> python3 </em>环境，并在空闲5分钟后触发自动停止功能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/57a92f9710aeb679b4a350cbf75ef0ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_KEbgibpv-hIWkKFeON4w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="6fc7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">用Amazon EventBridge和AWS Lambda触发笔记本</h1><p id="749e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用Amazon EventBridge和AWS Lambda可以按照固定的时间表运行我们的SageMaker笔记本。<a class="ae kv" href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html" rel="noopener ugc nofollow" target="_blank"> Amazon EventBridge </a>是一个事件服务，它将触发一个<a class="ae kv" href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-what-is.html" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a>函数来启动我们的SageMaker笔记本实例。</p><p id="396c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，创建一个新的Lambda函数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/7f93fcc6030aedc8d8b1ab46b55b8a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXS8wzit4sN5zHyqgQIHEw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="136d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将调用我们的函数<strong class="ky ir"> launch_jupyter_nb </strong>并选择用<em class="mp"> Python 3.9 </em>编写。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/b7f8d484a56986a71233508cd3d0d65d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zCnCeNjPqduCvC93J-R9Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="a1d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保存后，我们添加<em class="mp"> boto3 </em>命令来启动我们的SageMaker笔记本实例。您可以在下面找到代码。完成后按“部署”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/d3f70eb07a43d0c03a594ca7141ca73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Ktk0WvuYsNMXq2XuRnhpw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="8058" class="nd lt iq mz b gy ne nf l ng nh">import boto3<br/>import logging<br/>def lambda_handler(event, context):<br/>    client = boto3.client('sagemaker')<br/>    client.start_notebook_instance(NotebookInstanceName='sagemaker-schedule')<br/>    return 0</span></pre><p id="cfe5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要给Lambda函数访问SageMaker Notebook实例的权限。导航到“配置”选项卡，然后单击当前角色。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/80d933e3fd9384072aa58ec3b7059110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ERupPjg3cFTxvlQzIy0iyg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="bb9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击该角色将引导您进入IAM。在这里，您应该附加“AmazonSageMakerFullAccess”策略。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/51e081bd63066508308edf47aa136aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18V9F7EVodZ0zK-A-yltaA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="c486" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">回到AWS Lambda，在“函数概述”下，给你的函数添加一个触发器。我们将添加一个名为<strong class="ky ir"> launch_jupyter_nb </strong>的EventBridge触发器，它按照固定的时间表运行。我们使用一个<a class="ae kv" href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-create-rule-schedule.html" rel="noopener ugc nofollow" target="_blank"> Cron表达式</a>来指定时间表。在我们的示例中，EventBridge触发器将在每天03:00 UTC运行。</p><pre class="kg kh ki kj gt my mz na nb aw nc bi"><span id="c904" class="nd lt iq mz b gy ne nf l ng nh">cron(0 3 * * ? *)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/4ea5b9bec4f673b977b57b15f2d7e806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z7C2I6WfII_YrFBXwVgnYQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="4914" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们完了！我们的Jupyter笔记本托管在SageMaker笔记本实例中，由于Amazon EventBridge和AWS Lambda，它将按照固定的时间表运行。一旦笔记本电脑完成运行并闲置5分钟，我们的生命周期配置将关闭笔记本电脑实例。</p><h1 id="4def" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">其他考虑</h1><p id="e4e5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在安排您的Jupyter笔记本时，您应该注意两个重要的考虑事项。首先，我们创建的生命周期配置不能运行超过5分钟。否则就会失败。根据<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/notebook-lifecycle-config.html" rel="noopener ugc nofollow" target="_blank">文档</a>，您可以通过以下方式克服这一限制:</p><ul class=""><li id="999a" class="no np iq ky b kz la lc ld lf nq lj nr ln ns lr nt nu nv nw bi translated">减少步骤的数量</li><li id="eb13" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">并行运行任务</li><li id="0209" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">在你的脚本中使用<a class="ae kv" href="https://www.geeksforgeeks.org/nohup-command-in-linux-with-examples/" rel="noopener ugc nofollow" target="_blank"> <em class="mp"> nohup </em> </a>命令</li></ul><p id="fe36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其次，本教程向您展示了如何在SageMaker Notebook实例中而不是<a class="ae kv" href="https://docs.aws.amazon.com/sagemaker/latest/dg/notebooks.html" rel="noopener ugc nofollow" target="_blank">sage maker Studio Notebook</a>中安排笔记本。您可以通过调整<a class="ae kv" href="https://github.com/aws-samples/sagemaker-studio-lifecycle-config-examples" rel="noopener ugc nofollow" target="_blank">生命周期配置</a>并参考<em class="mp">boto 3</em>T12】文档来修改上述步骤，以使用Studio笔记本。</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="2375" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下次你的经理让你重复你的Jupyter笔记本分析，你可以。在本指南中，我向您展示了如何使用Lambda和EventBridge在SageMaker笔记本实例中调度您的笔记本。没有必要注册第三方服务。</p><p id="00f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">喜欢你读的书吗？跟着我上<a class="ae kv" href="https://medium.com/@rtkilian" rel="noopener">媒</a>。否则，<a class="ae kv" href="https://twitter.com/rtkilian" rel="noopener ugc nofollow" target="_blank">发微博给我</a>或者在<a class="ae kv" href="https://www.linkedin.com/in/rtkilian/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上加我。</p><p id="4cfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在GitHub 上找到这篇文章中用到的所有代码。</p></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="8671" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[1]约翰·霍普金斯大学系统科学与工程中心(CSSE)的新冠肺炎数据存储库，在知识共享署名4.0国际版(CC BY 4.0)下获得许可</p></div></div>    
</body>
</html>