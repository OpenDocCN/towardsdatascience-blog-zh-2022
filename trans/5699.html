<html>
<head>
<title>Genetic Algorithm and its practicality in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">遗传算法及其在机器学习中的实用性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/genetic-algorithm-6aefd897f1ac#2022-12-26">https://towardsdatascience.com/genetic-algorithm-6aefd897f1ac#2022-12-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a60c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">GA 是什么，如何用它来训练机器学习模型？</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/dfcb7991baa9e4783f10de1f25952849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N0GA0bVPo_bPC-0-"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kw" href="https://unsplash.com/@sangharsh_l?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sangharsh Lohakare </a>拍摄的照片</p></figure><h1 id="a78c" class="kx ky iq bd kz la lb lc ld le lf lg lh jw li jx lj jz lk ka ll kc lm kd ln lo bi translated">介绍</h1><p id="2866" class="pw-post-body-paragraph lp lq iq lr b ls lt jr lu lv lw ju lx ly lz ma mb mc md me mf mg mh mi mj mk ij bi translated">遗传算法(GA)是一种自然计算算法，是通过复制自然界中存在的现象和行为来尝试解决问题的算法。</p><p id="051b" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">文献中有几种自然算法，如粒子群优化算法(PSO)，它试图以数学方式模拟鱼群或鸟群的社会行为，以及蚁群优化算法(ACO)，它试图在模拟蚂蚁移动行为的图中找到最佳路径。</p><p id="6f20" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">这些类型的算法用于解决优化问题，其中您希望在搜索空间内找到最优值(最大值或最小值，取决于所分析的问题)。研究最多的优化问题之一就是所谓的<a class="ae kw" href="https://en.wikipedia.org/wiki/Travelling_salesman_problem#Natural_computation" rel="noopener ugc nofollow" target="_blank"> <em class="mq">旅行商问题</em> </a>。</p><p id="c55b" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">在所有的自然计算算法中，最著名的是遗传算法。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h2 id="82d4" class="my ky iq bd kz mz na dn ld nb nc dp lh ly nd ne lj mc nf ng ll mg nh ni ln nj bi translated"><em class="kf">概述</em></h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nk"><img src="../Images/02014b542012618dbf0dfd891da6723f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TnnmCM5G9hB2vP8N"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kw" href="https://unsplash.com/@pankajpatel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pankaj Patel </a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d983" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">遗传算法是基于遗传学的概念，其中变换被应用于旨在试图复制诸如突变、自然选择和交叉等事件的数据。</p><p id="19bc" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">简而言之，遗传算法迭代执行，并具有以下步骤:</p><ul class=""><li id="c065" class="nl nm iq lr b ls ml lv mm ly nn mc no mg np mk nq nr ns nt bi translated">初始种群的生成</li></ul><p id="2106" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated"><strong class="lr ir">对于每次迭代:</strong></p><ul class=""><li id="f42b" class="nl nm iq lr b ls ml lv mm ly nn mc no mg np mk nq nr ns nt bi translated">子群体(亲本)的选择</li><li id="8146" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">应用交叉和变异操作产生新的种群(子代)</li><li id="60b1" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">对产生的新群体的评估</li><li id="c57a" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">用新群体替换初始群体</li></ul><p id="6d53" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">算法将一直运行，直到达到停止条件，通常是最大迭代次数或评估生成的群体时获得的某个值。</p><p id="ec6f" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">重要的是要记住，要正确地执行算法，必须要有一个明确定义的问题要解决，并且要使用评估度量。</p><h2 id="e029" class="my ky iq bd kz mz na dn ld nb nc dp lh ly nd ne lj mc nf ng ll mg nh ni ln nj bi translated">概念</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nz"><img src="../Images/cf88ef60b20f31aee78f2d37fdcba0c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ENOhgkq34Yy1PI7r"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">Joshua Hoehne 在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="c8d6" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">为了理解算法，有必要理解它背后的概念。</p><ul class=""><li id="fce7" class="nl nm iq lr b ls ml lv mm ly nn mc no mg np mk nq nr ns nt bi translated"><strong class="lr ir">个体</strong>:代表问题唯一可能解决方案的群体成员。在数学上，它可以表示为一个值数组，其中数组中的每个值都是一个与所分析问题的响应方程相关联的系数。</li><li id="b506" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><strong class="lr ir">群体</strong>:作为所分析问题答案候选人的一组个体。</li><li id="643d" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><strong class="lr ir">比武</strong>:选择种群中最适个体的方法。它包括比较群体中两个(或更多)个体的结果，并选择获得最佳结果的一个。</li><li id="96c9" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated"><strong class="lr ir">交换</strong>:基因重组的操作，父母的遗传密码结合在一起产生孩子。定义一个(或多个)截止点，其中子代从父代 1 接收从遗传密码的开始到截止点的所有基因，并从父代 2 接收从截止点到遗传密码的结束的所有基因。下图(图 1)显示了一个具有一个截止点的交叉运算示例，其中每个单元格代表一个与响应方程相关的系数。</li></ul><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/3e81fb61d4bcc57c8a2e79601612fa93.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*uE7nLX4dBJoAckIo-UiuoA.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图 1 —交叉操作示例—作者图片</p></figure><ul class=""><li id="089c" class="nl nm iq lr b ls ml lv mm ly nn mc no mg np mk nq nr ns nt bi translated"><strong class="lr ir">突变:</strong>将基因的值修改为不同于原始值的操作。图 2 显示了一个应用于个体的突变的例子。</li></ul><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ob"><img src="../Images/bec90f91090daf53a6687dcb2492b85a.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*whK7XbarK8wGUJHBNboTCA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图 2——第二个基因的突变操作示例——作者图片</p></figure><p id="6459" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">既然已经定义了基本概念，那么让我们来看一个使用遗传算法来解决问题的例子。</p><h2 id="17f9" class="my ky iq bd kz mz na dn ld nb nc dp lh ly nd ne lj mc nf ng ll mg nh ni ln nj bi translated">这个例子</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oc"><img src="../Images/478153bc9cee4070e67c16d529b2987c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U-OsZfhbzPcWANW7"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/@kaleidico?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">万花筒</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="80b6" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">在机器学习中，一种广泛使用的算法是人工神经网络，它试图模拟人脑的行为进行决策。一种非常简单的网络被称为多层感知器(MLP ),它是由一个输入层、一个或多个中间层和一个输出层组成的网络。</p><p id="df02" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">下图(图 3)显示了一个 MLP 前馈神经网络的示例，其中间层包含四个神经元，隐藏层也包含四个神经元，输出层包含一个神经元。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi od"><img src="../Images/964899bc59c5619752eed012aa46e7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cODa2fJXZR64_Em-RpF3tg.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图 3-带有一个隐藏层的前馈神经网络示例-作者图片</p></figure><p id="1153" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">网络如何工作的细节不是本文的重点，知道输出<em class="mq"> y </em>是通过使用网络各层和输入数据之间的权重的运算来计算的就足够了。</p><p id="ca87" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">层权重是向量集，其中每个值对应于与不同层中的神经元之间的链接相关联的权重。目的是优化这些权重，以便网络可以解决问题。</p><p id="a5c1" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">让我们从定义图 3 中描述的 MLP 前馈的类开始。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="bbb9" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">现在，让我们一步一步地了解算法的功能。第一步是创建初始种群。下面的函数接收所需的个体数量(n_indiv ),并使用 MLPFeedforward 类返回随机初始化的个体总数(神经网络的权重)。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="2003" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">下面的函数执行 GA 的锦标赛步骤，从初始群体中随机选择两个父代，并将两个父代中的最佳父代(具有最大准确度的一个)存储在父代列表中。它接收人口和数据作为参数:特征(<strong class="lr ir"><em class="mq">)X</em></strong>)和标签(<strong class="lr ir"> <em class="mq"> y </em> </strong>)。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="01f5" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">下一步是创建执行交叉和变异操作的函数。该函数的参数是双亲列表、决定是否会发生交叉(cross_thr)和突变(mutation_thr)操作的阈值以及限制操作中基因变化范围的突变限制。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="81bc" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">最后，实现了一个包含整个算法的类。它还具有 run 方法，该方法多次执行算法，存储每次运行时获得的精度，并保存生成的最佳 MLP 及其性能。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="69d4" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">现在，为了展示该算法，创建了一个具有 4 个特征、10.000 行和 2 个类的通用数据集，将其分为训练和测试数据(70%为训练样本，其余 30%为测试样本)，并使用标准缩放器对其进行标准化。然后，使用 GA_MLPFeedforward 类来展示模型的性能如何随着遗传算法的使用而提高。算法中使用的参数是:</p><ul class=""><li id="69fe" class="nl nm iq lr b ls ml lv mm ly nn mc no mg np mk nq nr ns nt bi translated">人口规模= 50</li><li id="d54c" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">迭代次数= 200</li><li id="171c" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">交叉阈值= 0.5</li><li id="d18c" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">突变阈值= 0.7</li><li id="aa7b" class="nl nm iq lr b ls nu lv nv ly nw mc nx mg ny mk nq nr ns nt bi translated">突变极限= [-5，5]</li></ul><p id="d01d" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">重要的是要说，所使用的参数没有优化，参数的优化对算法的结果起着非常重要的作用。</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="7e30" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">在执行算法之后，绘制了训练数据的精度演变，如下图 4 所示。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi og"><img src="../Images/82c29ea85e451feec3b95c346995298d.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*kXanC_ImLYoRuS2Ralp7kw.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图 4——算法准确性的演变——作者提供的图片</p></figure><p id="0446" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">最后，评估测试数据时模型的性能如图 5 所示。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/d6f50f02ba61cb193f6121c21b0c2956.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*DmtNH3QO64dfbzffgmdXdQ.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">测试数据的混淆矩阵和获得的准确度—图片由作者提供</p></figure></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oi"><img src="../Images/4cc629775f4714321984e384a0d5254c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ec5PrLfAQkOnUpWA"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">Joshua Hoehne 在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="76fa" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">希望这篇文章能够让你快速理解遗传算法，以及如何在机器学习算法的开发中使用它。学习新的技能和做同样事情的方法总是好的。</p><p id="1d46" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">欢迎任何意见和建议。</p><p id="9618" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated">请随时通过我的 Linkedin 联系我，并查看我的 GitHub。</p><p id="d949" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated"><a class="ae kw" href="https://www.linkedin.com/in/alexandre-rosseto-lemos/" rel="noopener ugc nofollow" target="_blank">领英</a></p><p id="de8f" class="pw-post-body-paragraph lp lq iq lr b ls ml jr lu lv mm ju lx ly mn ma mb mc mo me mf mg mp mi mj mk ij bi translated"><a class="ae kw" href="https://github.com/alerlemos" rel="noopener ugc nofollow" target="_blank"> GitHub </a></p></div></div>    
</body>
</html>