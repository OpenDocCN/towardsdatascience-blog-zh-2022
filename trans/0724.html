<html>
<head>
<title>How to Create Custom Streamlit Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建定制的Streamlit组件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-custom-streamlit-components-de6a00a7d5ab#2022-03-01">https://towardsdatascience.com/how-to-create-custom-streamlit-components-de6a00a7d5ab#2022-03-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="db03" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Streamlit构建一切</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/33ff6cbc1191d902601b76f74a3639e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nfAfkS9wz3UA0Exeww4zSA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">背景由<a class="ae ky" href="https://unsplash.com/@fakurian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">法库里安设计</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上，由作者编辑。</p></figure><p id="3c06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit作为构建web应用程序的纯Python解决方案广受欢迎。它使得构建动态的、以数据为中心的应用程序变得异常简单。学习曲线实际上是不存在的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/55ee2cb54c2cfbea971ff389a928ce1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OY0J3RRLMrSAeRxNYlVYoA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Streamlit应用程序的屏幕截图(左)和创建它所需的代码(右)。</p></figure><p id="95ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只需几行代码，我们就可以通过简单地实现预构建的Streamlit组件来组装干净的交互式应用。</p><p id="abdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit设计了大量预构建组件。如果你找不到你需要的，甚至还有社区构建的组件。</p><p id="6e21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将这些几乎像“乐高”积木一样的组件放在一起很容易，这使得Streamlit成为ML工程师的理想选择。让我们专注于ML，同时仍然能够与世界分享我们的应用和工具。</p><p id="af41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，有时我们会陷入困境，根本没有涵盖我们所需要的组件。如果需要，我们仍然可以构建自己的定制组件。</p><p id="cc54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要做到这一点，我们需要从底层的网络技术着手，让Streamlit自己发挥作用。所以这不像使用预构建组件那么简单。然而，由于预制的模板，创建一个新组件并不太难。</p><p id="ed04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将确切地了解如何创建定制组件。我们将关注于使用材料UI设计元素设计一个交互式卡片组件。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="337e" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">设置和安装</h1><p id="d711" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们将使用<em class="na"> Node.js </em>和<em class="na"> NPM </em>来开发我们的卡组件。它们可以从<a class="ae ky" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">这里</a>安装在Windows/Mac/Linux上，或者在Mac上使用<em class="na">自制软件</em>:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="4a08" class="ng me it nc b gy nh ni l nj nk"><strong class="nc iu">brew install node</strong></span></pre><p id="2107" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装后，我们可以确认两个包都安装了:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="59d8" class="ng me it nc b gy nh ni l nj nk"><strong class="nc iu">node -v</strong></span><span id="1a00" class="ng me it nc b gy nl ni l nj nk"><em class="na">AND</em></span><span id="8503" class="ng me it nc b gy nl ni l nj nk"><strong class="nc iu">npm -v</strong></span></pre><p id="e8cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保您的Python环境中安装了Streamlit。如果没有，就<code class="fe nm nn no nc b"><strong class="lb iu">pip install streamlit</strong></code>。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="cdbd" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">从模板开始</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自定义组件的React模板设置</p></figure><p id="bcd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将从克隆<a class="ae ky" href="https://github.com/streamlit/component-template" rel="noopener ugc nofollow" target="_blank"><em class="na">streamlit/组件模板</em> repo </a>开始:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/0130f6f6366b410ee15b27281960d4be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PpkZQL9SXar9yiW4u1-_rw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们可以从Streamlit中克隆出组件模板。</p></figure><p id="355c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们将找到一个<code class="fe nm nn no nc b">/template</code>目录，其中包含:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/c5ece4a1a3c17a040cf87b0afe537fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fBxbI3l1XaUt1kSgm9tmDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模板组件目录结构概述。</p></figure><p id="b34a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">突出显示最重要的文件和目录。其余的我们可以完全忽略。</p><h2 id="cc94" class="ng me it bd mf nu nv dn mj nw nx dp mn li ny nz mp lm oa ob mr lq oc od mt oe bi translated">模板组织</h2><p id="20e4" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在我们开始构建任何东西之前，让我们组织我们的模板。首先，我们将所有默认的<code class="fe nm nn no nc b">MyComponent</code>引用更新为更具描述性的<code class="fe nm nn no nc b">CardComponent</code>。</p><ul class=""><li id="bc16" class="of og it lb b lc ld lf lg li oh lm oi lq oj lu ok ol om on bi translated">将<code class="fe nm nn no nc b">/my_component</code>更名为<code class="fe nm nn no nc b">/st_card_component</code></li><li id="e7e1" class="of og it lb b lc oo lf op li oq lm or lq os lu ok ol om on bi translated">将<code class="fe nm nn no nc b">index.tsx</code>中的<code class="fe nm nn no nc b">MyComponent</code>替换为<code class="fe nm nn no nc b">CardComponent</code>，将<code class="fe nm nn no nc b">__init__.py</code>中的<code class="fe nm nn no nc b">my_component</code>替换为<code class="fe nm nn no nc b">CardComponent</code></li><li id="9df4" class="of og it lb b lc oo lf op li oq lm or lq os lu ok ol om on bi translated">重命名<code class="fe nm nn no nc b">MyComponent.tsx</code>并替换代码中的<code class="fe nm nn no nc b">MyComponent</code>引用</li></ul><p id="ab55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一次更新是对<code class="fe nm nn no nc b">package.json</code>中的<code class="fe nm nn no nc b">"name"</code>参数，我们将其命名为<code class="fe nm nn no nc b">streamlit_card_component</code>。</p><h2 id="e3a9" class="ng me it bd mf nu nv dn mj nw nx dp mn li ny nz mp lm oa ob mr lq oc od mt oe bi translated">节点包</h2><p id="e988" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">接下来，我们在终端窗口中导航到<code class="fe nm nn no nc b">/frontend</code>目录，并使用<code class="fe nm nn no nc b">npm install</code>安装<code class="fe nm nn no nc b">package.json</code>中指定的必要节点包。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ad39e96d25b8f4729fdf5b6693fbd375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gig_OH3ZOsjyl-vEUrmpJg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用<strong class="bd ns"> npm install </strong>安装<strong class="bd ns"> package.json </strong>包</p></figure><p id="9c9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并安装材料UI卡所需的其他依赖项:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="16ed" class="ng me it nc b gy nh ni l nj nk">npm install @mui/material @mui/icons-material @emotion/react @emotion/styled</span></pre><p id="9e61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您看到一个<em class="na">上游依赖冲突</em>错误，通过在install命令中添加<code class="fe nm nn no nc b">--legacy-peer-deps</code>来强制安装。</p><h2 id="757d" class="ng me it bd mf nu nv dn mj nw nx dp mn li ny nz mp lm oa ob mr lq oc od mt oe bi translated">运行组件</h2><p id="8832" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">现在，我们可以通过在终端窗口中输入<code class="fe nm nn no nc b">npm start</code>来运行组件的当前状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/478fa8d0b1ffc8858400b0334bafe89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KjhhGl3NiTN8uusgCRBCHA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<strong class="bd ns"> localhost:3001 </strong>上托管组件</p></figure><p id="38f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前往<code class="fe nm nn no nc b">http://localhost:3001</code>我们将什么也看不到，因为我们托管的是组件，<em class="na">而不是</em>Streamlit应用。在开发过程中，我们需要两者都运行。组件正在运行，所以我们通过导航到<code class="fe nm nn no nc b">/card_component</code>目录(在一个<em class="na">新的</em>终端窗口中)并键入<code class="fe nm nn no nc b">streamlit run __init__.py</code>来初始化我们的应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/45a79f6b546bbe67a015e94987a82078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17EMe0hmoBkoe10RI7bJ5Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">默认组件模板。</p></figure><p id="f24f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将打开一个新的浏览器窗口，看起来像上面的默认Streamlit组件模板。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="ce5a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">构建组件</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建MUI卡组件</p></figure><p id="077a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在需要修改这个模板来创建卡片格式。这大部分是在<code class="fe nm nn no nc b">CardComponent.tsx</code>文件中完成的。如果我们现在看，那里有很多。我们不需要大部分，所以让我们先把它拆了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="f8b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些基本要素就是我们所需要的，<code class="fe nm nn no nc b">CardComponent</code>类，我们从<code class="fe nm nn no nc b">render</code>中的类返回的HTML，以及我们的组件返回到我们的Streamlit实例的<code class="fe nm nn no nc b">export</code>。</p><p id="2265" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以修改它来创建我们的卡组件。首先，让我们设置组件的绝对核心。基本信息的简单显示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/ce7fea29fe1b150c03c24a39e237685d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NPgybwmsMna6fDF3Kj1VEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卡片元素的高级细分。</p></figure><p id="bcd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每张卡片将显示一个标题、副标题、段落和超链接，显示为材料图标。</p><p id="9850" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在<code class="fe nm nn no nc b">CardComponent.tsx</code>和<code class="fe nm nn no nc b">__init__.py</code>中的<code class="fe nm nn no nc b">card_component</code>函数中向组件添加可通过的参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="03e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe nm nn no nc b">CardComponent.tsx</code>中，我们通过<code class="fe nm nn no nc b">this.props.args</code>引入参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="8004" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nm nn no nc b">card_component</code>函数充当React组件的初始化，通常从前端Streamlit脚本调用。如果我们看一下我们的Streamlit窗口，我们会看到一个错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/a18c0382d3e5786a08238965998c3fcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1MKIxf0TxfRzrAuWpYl2Dw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ns"> TypeError </strong>由现在过时的代码引发。</p></figure><p id="7de0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为调用我们的<code class="fe nm nn no nc b">card_component</code>的代码仍然只传递一个值<code class="fe nm nn no nc b">"World"</code>，而新组件需要四个参数；<code class="fe nm nn no nc b">title</code>、<code class="fe nm nn no nc b">subtitle</code>、<code class="fe nm nn no nc b">body</code>和<code class="fe nm nn no nc b">link</code>。</p><p id="4a3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在开发过程中，前端脚本临时存储在<code class="fe nm nn no nc b">__init__.py</code>中，所以我们在调用<code class="fe nm nn no nc b">card_component</code>的地方更新这个脚本以反映这些变化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="1aa3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以看到我们的卡组件的第一个版本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/d5f1843733fd42c2b29ba490ba369f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MkZdYDrbZT78a_DMBgomUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“卡”的简单实现，没有任何格式或结构。</p></figure><p id="a9ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它并不漂亮，但组件的核心在那里。我们有标题、副标题、正文和链接。我们开始做造型吧。</p><h2 id="830a" class="ng me it bd mf nu nv dn mj nw nx dp mn li ny nz mp lm oa ob mr lq oc od mt oe bi translated">材质用户界面样式</h2><p id="c303" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们将使用MUI来设计和实现卡的功能。幸运的是，我们几乎可以通过在<a class="ae ky" href="https://mui.com/components/cards/" rel="noopener ugc nofollow" target="_blank"> MUI组件页面</a>中找到符合我们要求的卡来复制和粘贴所需的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/3b08acdc3995cce303241c3ede328858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfvvWW6FnQUPbrww5aTXeA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MUI组件页面中的卡组件。我们点击<strong class="bd ns"> &lt; &gt; </strong>图标查看代码示例。</p></figure><p id="fa6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要在我们的<code class="fe nm nn no nc b">CardComponent.tsx</code>文件的顶部添加几个导入。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="77c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在组件本身中，我们添加了各种卡片和按钮标签。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="5989" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，我们就可以刷新页面，看到新的卡片格式页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/3ba95a52e4764b6052c39d21e0db75d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1qssPVYc1k06TDKQ4I2RGg.png"/></div></div></figure><p id="6d82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还缺少最后一个细节。使用的字体与MUI示例不一致。为此，我们需要安装并导入<em class="na"> Roboto </em>字体。从<code class="fe nm nn no nc b">/frontend</code>目录，我们在终端窗口中输入<code class="fe nm nn no nc b">npm install @fontsource/roboto</code>。然后将字体添加到<code class="fe nm nn no nc b">CardComponent.tsx</code>导入:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="6db0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们的组件与MUI示例相匹配。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/53d88e8d32b353d08b1e62a1a8ab5682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dr3qO1YaS-zs2AcVsdbdQ.png"/></div></div></figure><p id="20f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很好，现在让我们清理一下<code class="fe nm nn no nc b">__init__.py</code>，从我们的cards组件中删除任何不需要的东西，并将它作为一个单独的组件在Streamlit项目中实现。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="aa01" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">发布组件</h1><p id="a7af" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">Streamlit组件通常通过<code class="fe nm nn no nc b">pip install</code>和<code class="fe nm nn no nc b">import</code>集成到单个项目中。我们将发布我们的卡组件来遵循相同的示例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将Streamlit组件发布到PyPI</p></figure><p id="41c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们通过设置<code class="fe nm nn no nc b">_RELEASE = True</code>告诉<code class="fe nm nn no nc b">__init__.py</code>使用脚本的<em class="na">版本</em>版本。这告诉Streamlit从<code class="fe nm nn no nc b">/frontend/build</code>目录中提取组件。目前，这个目录不存在。我们必须通过NPM创造它。</p><p id="150c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们在终端中导航到<code class="fe nm nn no nc b">/frontend</code>并输入<code class="fe nm nn no nc b">npm run build</code>。该命令创建<code class="fe nm nn no nc b">/frontend/build</code>目录，其中包含组件发布版本中使用的编译代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/8236668f9d3a7886b4ca3bc0609a5cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-RShTTZ1Wb6KQ8o9K2fb6w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">执行<strong class="bd ns"> npm run build </strong>构建编译后的组件代码。</p></figure><p id="a5bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们导航到顶层目录并创建一个Python <code class="fe nm nn no nc b">/dist</code>文件夹，其中将包含pip包轮。</p><p id="50bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在构建dist文件夹之前，我们需要修改一些东西。首先将<code class="fe nm nn no nc b">setup.py</code>中的<code class="fe nm nn no nc b">name</code>参数改为<code class="fe nm nn no nc b">name="st_card_component"</code>。</p><p id="15a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将编译后的代码包含在构建目录中，我们必须将目录从<code class="fe nm nn no nc b">MANIFEST.in</code>更新到<code class="fe nm nn no nc b">recursive-include <strong class="lb iu">st_card_component</strong>/frontend/build *</code>。</p><p id="be88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们必须将<code class="fe nm nn no nc b">__init__.py</code>中的组件名称更新为<code class="fe nm nn no nc b">"st_card_component"</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><p id="d76e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在准备创建发行版。使用终端，我们执行<code class="fe nm nn no nc b">python setup.py sdist bdist_wheel</code>，在<code class="fe nm nn no nc b">/dist</code>文件夹中我们会看到:</p><ul class=""><li id="14a4" class="of og it lb b lc ld lf lg li oh lm oi lq oj lu ok ol om on bi translated">st_card_component-0.0.1.tar.gz</li><li id="cd80" class="of og it lb b lc oo lf op li oq lm or lq os lu ok ol om on bi translated">ST _ card _ component-0 . 0 . 1 . py3-none-any . whl</li></ul><p id="7f1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们继续上传到<a class="ae ky" href="https://pypi.org" rel="noopener ugc nofollow" target="_blank"> PyPi </a>，在那里<code class="fe nm nn no nc b">pip install</code>包被下载。首先，我们用<code class="fe nm nn no nc b">pip install twine</code>安装twine，然后用<code class="fe nm nn no nc b">python -m twine upload --repository pypi dist/*</code>上传我们的包(都来自组件的顶层目录— <code class="fe nm nn no nc b">/st-card-component</code>)。</p><p id="f230" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="na">当发布我们组件的新版本时，我们必须更新</em> <code class="fe nm nn no nc b"><em class="na">setup.py</em></code> <em class="na">文件中的版本号。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="633a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">使用组件</h1><p id="75cc" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我们终于可以像使用其他组件一样使用我们的Streamlit组件了。组件包安装有<code class="fe nm nn no nc b">pip install st-card-component</code>。</p><p id="262d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个“测试”脚本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov nq l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/70911b09ce7aca84a86b4ca06cc718ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68PV-ysa_EyP7lE1xZCCbA.png"/></div></div></figure><p id="96e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有我们定制的Streamlit卡组件！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="5362" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是为Streamlit构建定制和可共享组件的指南。我们已经介绍了很多，从默认模板到在React中构建组件，甚至在PyPi上发布组件。</p><p id="7ec7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这是一个极其简单的组件。我们可以在这里做更多的事情。我把那个留给你。</p><p id="1240" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以通过<a class="ae ky" href="https://jamescalam.medium.com/subscribe" rel="noopener">此链接</a>了解最新的ML文章。我还在YouTube上上传每周的ML和NLP视频。</p><p id="9670" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="fee4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🎁<a class="ae ky" href="https://www.pinecone.io/learn/nlp" rel="noopener ugc nofollow" target="_blank">面向语义搜索的NLP免费课程</a></p><p id="7cf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🤖<a class="ae ky" href="https://bit.ly/nlp-transformers" rel="noopener ugc nofollow" target="_blank">带变形金刚课程的NLP 70%折扣</a></p><p id="24da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/jamescalam/dhivehi_nlp/blob/main/examples/00_create_dv_base/01_tokenizer_components.ipynb" rel="noopener ugc nofollow" target="_blank">文章笔记本脚本</a></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="12ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="na">*所有图片均由作者提供，除非另有说明</em></p></div></div>    
</body>
</html>