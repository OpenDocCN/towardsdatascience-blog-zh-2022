<html>
<head>
<title>Create an Interactive Web App with PyScript and Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用PyScript和熊猫创建一个交互式Web应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-an-interactive-web-app-with-pyscript-and-pandas-3918ad2dada1#2022-05-28">https://towardsdatascience.com/create-an-interactive-web-app-with-pyscript-and-pandas-3918ad2dada1#2022-05-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ccc4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">PyScript允许我们用HTML和Python作为脚本语言创建一个无服务器的web应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ad75eea34712304f5bf807cce55c3667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RhnZ-ii4-lplAya7.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1703" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PyScript是web应用的未来吗？也许是，但可能还不是——我敢肯定，它仍然只是一个alpha版本，还有很多工作要做。</p><p id="d831" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是现在它有多大用处呢？</p><p id="3c19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将创建一个交互式web应用程序，其中的逻辑完全是用Python编写的。</p><p id="e23c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可能听说过PyScript，它是由Anaconda的首席执行官王蒙杰在2022年的PyCon大会上宣布的。用他们自己的<a class="ae lu" href="https://anaconda.cloud/pyscript-python-in-the-browser" rel="noopener ugc nofollow" target="_blank">话说</a>这是“一项闪亮的新技术……允许用户在浏览器中编写Python，事实上还有许多语言”。</p><p id="b1b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PyScript的最大优势在于，您可以用Python编写web应用程序，而不需要服务器。这是通过使用用WebAssembly编写的Pyodide Python解释器来实现的，web assembly是现代浏览器支持的较低级的web语言。</p><p id="561b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，Python web应用程序都是基于服务器的，并且使用Django或Flask等框架，其中前端是用HTML和Javascript创建的，而后端是在远程服务器上运行的Python。</p><p id="de03" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最近，Dash和Streamlit试图通过提供纯Python框架来简化此类应用的构建，从而避免学习HTML和Javascript。但是这些仍然是基于服务器的应用程序。</p><p id="d317" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PyScript是一种不同的方法。在PyScript中，用户界面仍然是用HTML构造的，但是Javascript被Python代替了(尽管如果您愿意，您仍然可以使用Javascript，并且用两种脚本语言编写的函数可以相互通信)。</p><h1 id="0e54" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">网络应用</h1><p id="e224" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我将运行一个用PyScript和HTML编写的简单应用程序，它从远程数据源读取数据，并显示一个简单的仪表板，用户可以在其中选择要在Pandas图表中显示的数据。</p><p id="6d41" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该应用程序的基本形式如下:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="3f3b" class="mx lw it mt b gy my mz l na nb">&lt;html&gt;<br/>    &lt;head&gt;<br/>        &lt;link rel="stylesheet" <br/>            href="https://pyscript.net/alpha/pyscript.css" /&gt;<br/>        &lt;script defer <br/>            src="https://pyscript.net/alpha/pyscript.js"&gt;<br/>        &lt;/script&gt;<br/>        &lt;py-env&gt;<br/>            - libraries-that-will-be-used<br/>        &lt;/py-env&gt;<br/>    &lt;/head&gt;<br/>    &lt;body&gt;</span><span id="cee4" class="mx lw it mt b gy nc mz l na nb">        &lt;!-- HTML layout code goes here --&gt;</span><span id="827c" class="mx lw it mt b gy nc mz l na nb">        &lt;py-script&gt;<br/>            # PyScript code goes here<br/>        &lt;/py-script&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="a688" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你所看到的，它看起来像一个标准的HTML文件，事实上它就是一个。但是对于PyScript app，我们需要在<code class="fe nd ne nf mt b">&lt;head&gt;</code>部分包含到PyScript样式表和Javascript库的链接，以及包含我们稍后将看到的<code class="fe nd ne nf mt b">&lt;py-env&gt;</code>块。</p><p id="163a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来在<code class="fe nd ne nf mt b">&lt;body&gt;</code>中，我们有HTML布局内容，后面是包含Python代码的<code class="fe nd ne nf mt b">&lt;py-script&gt;...&lt;/py-script&gt;</code>标签。</p><p id="1c7f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在将充实这些部分。</p><p id="a35d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我将使用Bootstrap框架来使整个应用程序看起来很漂亮。这意味着我们需要包含到引导css文件的链接。我们将使用Matplotlib和Pandas库，这些库需要在<code class="fe nd ne nf mt b">&lt;py-env&gt;...&lt;/pt-env&gt;</code>部分声明。<code class="fe nd ne nf mt b">&lt;head&gt;...&lt;/head&gt;</code>现在看起来像这样:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="3fdb" class="mx lw it mt b gy my mz l na nb">&lt;head&gt;<br/>    &lt;link rel="stylesheet" <br/>        href="https://pyscript.net/alpha/pyscript.css" /&gt;<br/>    &lt;script defer <br/>        src="https://pyscript.net/alpha/pyscript.js"&gt;<br/>    &lt;/script&gt;<br/>    &lt;link rel="stylesheet" <br/>        href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"&gt;<br/>    &lt;py-env&gt;<br/>        - matplotlib<br/>        - pandas<br/>    &lt;/py-env&gt;<br/>&lt;/head&gt;</span></pre><p id="1bf3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来要看的是网页的HTML代码。第一部分基本上是页面的标题。我们利用Bootstrap的<em class="ng">大屏幕</em>容器。这给了我们一个令人愉快的灰色背景的盒子和一些经典引导风格的介绍性文本。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="508d" class="mx lw it mt b gy my mz l na nb">&lt;div class="jumbotron"&gt;<br/>    &lt;h1&gt;Weather Data&lt;/h1&gt;<br/>    &lt;p class="lead"&gt;<br/>        Some graphs about the weather in London in 2020<br/>    &lt;/p&gt;<br/>&lt;/div&gt;</span></pre><p id="1c36" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来是两行:第一行有一个按钮和一个下拉菜单，第二行包含要显示的图表。</p><p id="37c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是第一行:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6619" class="mx lw it mt b gy my mz l na nb">&lt;div class="row"&gt;<br/>    &lt;div class="col-sm-2 p-2 ml-4 mb-1"&gt;<br/>        &lt;button type="button" class="btn btn-secondary"&gt;Select chart from list:&lt;/button&gt;<br/>    &lt;/div&gt;</span><span id="ab64" class="mx lw it mt b gy nc mz l na nb">    &lt;div class="col-sm-4 p-2 mr-4 mb-1"&gt;<br/>        &lt;select class="form-control" id="select"&gt;<br/>            &lt;option value="Tmax"&gt;Maximum Temperature&lt;/option&gt;<br/>            &lt;option value="Tmin"&gt;Minimum Temperature&lt;/option&gt;<br/>            &lt;option value="Sun"&gt;Sun&lt;/option&gt;<br/>            &lt;option value="Rain"&gt;Rain&lt;/option&gt;        <br/>        &lt;/select&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="a46e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它由两列组成，一列用于按钮，另一列用于菜单(我在这里使用按钮只是为了美观，它实际上并没有按钮的功能)。下拉列表中的选项将用于显示四个不同图表中的一个。将使用的数据是2020年伦敦的天气状况表。表格中有12行代表每个月，表格中的列代表该月的最高温度<em class="ng"/>、最低温度<em class="ng"/>、日照时数<em class="ng"/>和降雨量<em class="ng">毫米</em>。</p><p id="4139" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，菜单项代表这些选项，并将取值为“Tmax”、“Tmin”、“Sun”或“Rain”。</p><p id="1daa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">到目前为止，我们已经编写了网页代码，现在我们需要定义对用户输入做出反应的逻辑，并绘制图表。这在<code class="fe nd ne nf mt b">&lt;py-script&gt;</code>一节中定义。我们接下来要处理的代码在这一节中。</p><p id="e223" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">先导入一些库。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="68cf" class="mx lw it mt b gy my mz l na nb"># Import libraries<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span></pre><p id="454a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然是熊猫和Matplotlib，但我们还需要以下内容:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="754e" class="mx lw it mt b gy my mz l na nb">from pyodide.http import open_url</span></pre><p id="4c50" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是PyScript提供的一个库，它允许我们从网上的资源中读取内容，我们是这样使用它的:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="febc" class="mx lw it mt b gy my mz l na nb">url = 'https://raw.githubusercontent.com/alanjones2/uk-historical-weather/main/data/Heathrow.csv'<br/>url_content = open_url(url)</span><span id="081c" class="mx lw it mt b gy nc mz l na nb">df = pd.read_csv(url_content)</span></pre><p id="18ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PyScript实现Pandas函数<code class="fe nd ne nf mt b">read_csv</code>不能直接打开url，所以我们必须使用上面的技术。</p><p id="bd29" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正在下载的文件包含几十年的数据，但为了保持简单，我们将过滤它，只保存2020年的数据。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="a19c" class="mx lw it mt b gy my mz l na nb"># filter the data for the year 2020<br/>df = df[df['Year']==2020]</span></pre><p id="aa2e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在是我们之前看到的在HTML <code class="fe nd ne nf mt b">&lt;div&gt;</code>中绘制图表的函数。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="0d77" class="mx lw it mt b gy my mz l na nb"># Function to plot the chart<br/>def plot(chart):<br/>    fig, ax = plt.subplots()<br/>    df.plot(y=chart, x='Month', figsize=(8,4),ax=ax)<br/>    pyscript.write("chart1",fig)</span></pre><p id="7e1d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是和熊猫一起策划的非常标准的东西。与“普通”Python程序的主要区别在于它的呈现方式。<code class="fe nd ne nf mt b">pyscript.write</code>函数获取HTML元素的id，并将第二个参数的内容写入其中。</p><p id="0357" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这依赖于PyScript实现中包含的呈现特定对象的方式——在本例中是matplotlib图表——这不一定适用于任何类型的对象。例如，如果我们想要显示一个Plotly图表，我们将不得不使用不同的技术，因为在PyScript中没有直接实现Plotly图形(到目前为止)。</p><p id="d390" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来要做的是定义当用户从下拉菜单中选择一个新图表时调用<code class="fe nd ne nf mt b">plot</code>函数的方法。</p><p id="5b5c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先是更多的库——这些是作为PyScript的一部分提供的。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8485" class="mx lw it mt b gy my mz l na nb">from js import document<br/>from pyodide import create_proxy</span></pre><p id="5405" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><code class="fe nd ne nf mt b">js</code>库允许PyScript访问Javascript函数，在这个例子中，我们引入了访问DOM的能力。Pyodide的create_proxy则相反，允许Javascript直接调用PyScript函数。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="9936" class="mx lw it mt b gy my mz l na nb">def selectChange(event):<br/>    choice = document.getElementById("select").value<br/>    plot(choice)</span></pre><p id="78a9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当一个改变事件发生时，这个函数被调用。它读取选择的值，然后用该值调用先前定义的<code class="fe nd ne nf mt b">plot</code>函数。</p><p id="de24" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们定义一个代理，它将允许change事件调用PyScript函数<code class="fe nd ne nf mt b">selectChange</code>。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="f2dc" class="mx lw it mt b gy my mz l na nb"># set the proxy<br/>def setup():<br/>    # Create a JsProxy for the callback function<br/>    change_proxy = create_proxy(selectChange)</span><span id="eea6" class="mx lw it mt b gy nc mz l na nb">    e = document.getElementById("select")<br/>    e.addEventListener("change", change_proxy)</span></pre><p id="cdbc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，当页面第一次加载时，我们需要调用<code class="fe nd ne nf mt b">setup</code>函数并使用默认值(‘Tmax’)运行<code class="fe nd ne nf mt b">plot</code>函数，以便在启动时显示图表。</p><p id="f267" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是实现一个简单的仪表板应用程序的全部代码，就像本文开头截图中的那个一样。这个代码和一个演示应用程序的链接将在最后的链接。</p><h1 id="4425" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">PyScript与现有的基于服务器的应用程序相比如何？</h1><p id="3f54" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">就难度而言，只要你熟悉Python，构建web应用程序就相对简单，可能比构建Django或Flask应用程序更容易——我认为更像Dash的水平。</p><p id="d1e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而细流是一个不同的故事。Streamlit在视觉设计方面更受限制，但它的优势是你不必学习HTML。Streamlit应用程序非常容易创建——我认为比PyScript更容易。</p><p id="6dd4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，PyScript相对于所有竞争对手的优势在于它不依赖于服务器。这使得部署变得非常容易——我只需将您在这里看到的应用程序上传到Github Pages网站，它就可以正常工作了。</p><p id="bc70" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">目前PyScript有点慢。因为所有的工作都是在浏览器中完成的，所以性能由运行浏览器的机器决定——如果你的硬件很弱，那么加载你的应用可能需要很长时间，尽管一旦它启动并运行，性能似乎就没问题了。</p><p id="1a9f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，随着硬件变得更加强大，PyScript变得更加成熟，并且(希望)变得更加高效，性能只会变得更好。有一天，谁知道呢，也许我们会看到PyScript像今天的Javascript一样嵌入到浏览器中。</p><p id="b25e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="ng">更新:你可以在这里</em> </strong>  <strong class="la iu"> <em class="ng">找到这个app用Plotly代替熊猫绘图的版本</em> </strong> <a class="ae lu" href="https://medium.com/technofile/how-to-use-ploty-with-pyscript-578d3b287293" rel="noopener"> <strong class="la iu"> <em class="ng">。</em>T13】</strong></a></p><p id="2218" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="ng">更新2:</em></strong><a class="ae lu" href="https://alan-jones.medium.com/whats-new-in-pyscript-dfdf25538281" rel="noopener"><strong class="la iu"><em class="ng">PyScript新增功能</em> </strong> </a> <strong class="la iu"> <em class="ng">查看截至2023年初PyScript所做的一些重大更改。</em> </strong></p></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="473a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一如既往，感谢阅读。你可以在我的<a class="ae lu" href="https://alanjones2.github.io/" rel="noopener ugc nofollow" target="_blank">网站</a>上找到完整代码和演示网页的链接，在那里你还可以找到其他文章的链接。</p><div class="no np gp gr nq nr"><a href="https://alanjones2.github.io" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">AlanJones:编码、科学和技术</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">使用Streamlit、Plotly、Python和Flask为web构建数据可视化应用程序。适用于…的文章、教程和应用程序</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">alanjones2.github.io</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div><p id="82f0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想跟上我写的东西，请考虑订阅我偶尔的<a class="ae lu" href="http://technofile.substack.com" rel="noopener ugc nofollow" target="_blank">时事通讯</a>或者点击下面的链接，当我在这里发表时，你会收到一封电子邮件。</p><div class="no np gp gr nq nr"><a href="https://technofile.substack.com" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">技术文件</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">技术、科学、数据科学和编码。点击阅读阿兰·琼斯的技术文件，这是一个子堆栈出版物，包含…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">technofile.substack.com</p></div></div><div class="oa l"><div class="og l oc od oe oa of ks nr"/></div></div></a></div><h1 id="5cbd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">笔记</h1><ol class=""><li id="e466" class="oh oi it la b lb mn le mo lh oj ll ok lp ol lt om on oo op bi translated">天气数据来自我的报告<a class="ae lu" href="https://github.com/alanjones2/uk-historical-weather" rel="noopener ugc nofollow" target="_blank">英国历史天气</a>，并来自英国气象局<a class="ae lu" href="https://www.metoffice.gov.uk/research/climate/maps-and-data/historic-station-data" rel="noopener ugc nofollow" target="_blank">历史气象站数据</a>。它是根据<a class="ae lu" href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="noopener ugc nofollow" target="_blank">英国开放政府许可证</a>发布的，可以在相同的条件下使用。</li></ol></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h2 id="c6ed" class="mx lw it bd lx oq or dn mb os ot dp mf lh ou ov mh ll ow ox mj lp oy oz ml pa bi translated">海生的</h2><p id="a411" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在回答“Seaborn是否适用”这个问题时:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="2e35" class="mx lw it mt b gy my mz l na nb">&lt;html&gt;</span><span id="2a63" class="mx lw it mt b gy nc mz l na nb">&lt;head&gt;<br/>&lt;link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" /&gt;<br/>&lt;script defer src="https://pyscript.net/alpha/pyscript.js"&gt;&lt;/script&gt;</span><span id="33d8" class="mx lw it mt b gy nc mz l na nb">&lt;link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"&gt;</span><span id="822f" class="mx lw it mt b gy nc mz l na nb">&lt;py-env&gt;<br/>   - matplotlib<br/>   - pandas<br/>   - seaborn<br/>&lt;/py-env&gt;</span><span id="ad62" class="mx lw it mt b gy nc mz l na nb">&lt;/head&gt;<br/>&lt;body&gt;</span><span id="fd44" class="mx lw it mt b gy nc mz l na nb">&lt;div class="jumbotron"&gt;</span><span id="a41e" class="mx lw it mt b gy nc mz l na nb">   &lt;h1&gt;Weather Data&lt;/h1&gt;<br/>   &lt;p class="lead"&gt;<br/>      Some graphs about the weather in London in 2020<br/>   &lt;/p&gt;</span><span id="3cfd" class="mx lw it mt b gy nc mz l na nb">&lt;/div&gt;</span><span id="bbdf" class="mx lw it mt b gy nc mz l na nb">&lt;div class="row"&gt;<br/>   &lt;div class="col-sm-2 p-2 ml-4 mb-1"&gt;<br/>   &lt;button type="button" class="btn btn-secondary"&gt;Select chart from list:&lt;/button&gt;<br/>   &lt;/div&gt;<br/>   &lt;div class="col-sm-4 p-2 mr-4 mb-1"&gt;<br/>      &lt;select class="form-control" id="select"&gt;<br/>         &lt;option value="Tmax"&gt;Maximum Temperature&lt;/option&gt;<br/>         &lt;option value="Tmin"&gt;Minimum Temperature&lt;/option&gt;<br/>         &lt;option value="Sun"&gt;Sun&lt;/option&gt; <br/>         &lt;option value="Rain"&gt;Rain&lt;/option&gt;<br/>      &lt;/select&gt;<br/>   &lt;/div&gt;<br/>&lt;/div&gt;</span><span id="2eba" class="mx lw it mt b gy nc mz l na nb">&lt;div class="row"&gt;<br/>   &lt;div class="col-sm-6 p-2 shadow ml-4 mr-4 mb-4 bg-white rounded"&gt;<br/>      &lt;div id="chart1"&gt;&lt;/div&gt;<br/>   &lt;/div&gt;<br/>&lt;/div&gt;</span><span id="5386" class="mx lw it mt b gy nc mz l na nb">&lt;py-script&gt;<br/># Import libraries<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="bb5a" class="mx lw it mt b gy nc mz l na nb"># Get the data</span><span id="b504" class="mx lw it mt b gy nc mz l na nb">from pyodide.http import open_url</span><span id="e7a3" class="mx lw it mt b gy nc mz l na nb">url = 'https://raw.githubusercontent.com/alanjones2/uk-historical-weather/main/data/Heathrow.csv'</span><span id="8431" class="mx lw it mt b gy nc mz l na nb">url_content = open_url(url)</span><span id="659d" class="mx lw it mt b gy nc mz l na nb">df = pd.read_csv(url_content)</span><span id="485e" class="mx lw it mt b gy nc mz l na nb"># filter the data for the year 2020</span><span id="8c48" class="mx lw it mt b gy nc mz l na nb">df = df[df['Year']==2020]</span><span id="9404" class="mx lw it mt b gy nc mz l na nb"># Function to plot the chart</span><span id="17c0" class="mx lw it mt b gy nc mz l na nb">def plot(chart):<br/>   fig, ax = plt.subplots()<br/>   sns.lineplot(y=chart, x="Month", data=df, ax=ax)<br/>   pyscript.write("chart1",fig)</span><span id="286a" class="mx lw it mt b gy nc mz l na nb"># Set up a proxy to be called when a 'change'</span><span id="8c01" class="mx lw it mt b gy nc mz l na nb"># event occurs in the select control</span><span id="0edd" class="mx lw it mt b gy nc mz l na nb">from js import document<br/>from pyodide import create_proxy</span><span id="845f" class="mx lw it mt b gy nc mz l na nb"># Read the value of the select control</span><span id="c129" class="mx lw it mt b gy nc mz l na nb"># and call 'plot'</span><span id="2282" class="mx lw it mt b gy nc mz l na nb">def selectChange(event):<br/>   choice = document.getElementById("select").value<br/>   plot(choice)</span><span id="d1ac" class="mx lw it mt b gy nc mz l na nb"># set the proxy</span><span id="fcff" class="mx lw it mt b gy nc mz l na nb">def setup():<br/>   # Create a JsProxy for the callback function<br/>   change_proxy = create_proxy(selectChange)<br/>   e = document.getElementById("select")<br/>   e.addEventListener("change", change_proxy)</span><span id="ae17" class="mx lw it mt b gy nc mz l na nb">setup()</span><span id="7582" class="mx lw it mt b gy nc mz l na nb"># Intitially call plot with 'Tmax'</span><span id="436a" class="mx lw it mt b gy nc mz l na nb">plot('Tmax')</span><span id="c260" class="mx lw it mt b gy nc mz l na nb">&lt;/py-script&gt;</span><span id="774b" class="mx lw it mt b gy nc mz l na nb">&lt;/body&gt;</span><span id="ada6" class="mx lw it mt b gy nc mz l na nb">&lt;/html&gt;</span></pre></div></div>    
</body>
</html>