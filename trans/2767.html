<html>
<head>
<title>3 Functions to Use with Pandas Groupby That You Probably Don’t Use</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3个你可能不会用到的熊猫群组功能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-functions-to-use-with-pandas-groupby-that-you-probably-dont-use-724db94327ee#2022-06-15">https://towardsdatascience.com/3-functions-to-use-with-pandas-groupby-that-you-probably-dont-use-724db94327ee#2022-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="189f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索更多关于熊猫的知识</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3417822dd372a725c87b89ae7bed83be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVp3cIBHPb3t0r9erlhJkQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杰西·卡森在<a class="ae ky" href="https://unsplash.com/s/photos/owl?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="45a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用Pandas进行数据分析时，groupby是最常用的函数之一。它允许根据给定的一列或多列中的值对数据点(即行)进行分组。</p><p id="f6be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您有一个汽车数据集，并希望根据平均价格比较汽车品牌。这是一个两步任务。第一个是根据颜色对汽车进行分组，这就是groupby函数的用途。第二步是根据要聚合的值应用聚合函数。在本例中，这是通过对price列应用mean函数来实现的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/bc2cf2ac1613142ca398462c458aed7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFGJyuvUiiiP3xFMiOcDWg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="01e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有许多聚合函数可以与groupby函数一起使用，如mean、min、max和median。我刚刚列出的是常见的。还有一些功能不是那么常用。你不会经常需要它们，但是在某些情况下这些函数会派上用场。所以，最好了解一下他们。</p><p id="823b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将讨论其中的3个函数。让我们创建一个样本数据帧用于示例。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="a785" class="mb mc it lx b gy md me l mf mg">import pandas as pd<br/>import numpy as np</span><span id="9c82" class="mb mc it lx b gy mh me l mf mg">df = pd.DataFrame({</span><span id="9041" class="mb mc it lx b gy mh me l mf mg">  "Year": [2021, 2021, 2021, 2022, 2022, 2022, 2022, 2022],<br/>  "Month": ["Jan", "Jan", "May", "Jan", "Feb", "Feb", "May", "Sep"],<br/>  "Qty": np.random.randint(10, 100, size=8)<br/>    <br/>})</span><span id="18e4" class="mb mc it lx b gy mh me l mf mg">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/ca770afbea0b5c02bef49d8c833b78f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVZ_ESHPXUq4F35eFMlMsw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df(作者图片)</p></figure><p id="4355" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一个3列8行的数据帧。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="9815" class="mb mc it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated">1.努尼克岛</h2><p id="fe6a" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">顾名思义，nunique函数返回唯一值的数量。如果与groupby函数一起使用，我们可以获得每个组的唯一值的数量。</p><p id="2ef9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以在我们的数据框架中找到每年独特月份的数量，如下所示:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1a74" class="mb mc it lx b gy md me l mf mg">df.groupby("Year")["Month"].nunique()</span><span id="082f" class="mb mc it lx b gy mh me l mf mg"><strong class="lx iu"># Output</strong><br/>Year<br/>2021    2<br/>2022    4<br/>Name: Month, dtype: int64</span></pre><p id="4100" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，在处理大型数据集时使用它更有意义。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="00f4" class="mb mc it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated">1.n最大</h2><p id="2332" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">nlargest函数返回一列中的n个最大值。n的值可以用函数的n参数来指定。</p><p id="2d5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的数据框架中，我们可以将它与groupby函数一起使用来查找每年的最大数量。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9ffe" class="mb mc it lx b gy md me l mf mg">df.groupby("Year")["Qty"].nlargest(1)</span><span id="0ef7" class="mb mc it lx b gy mh me l mf mg"><strong class="lx iu"># Output</strong><br/>Year   <br/>2021  2    85<br/>2022  5    61<br/>Name: Qty, dtype: int64</span></pre><p id="f462" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2021年一个月中的最高数量是85，这是索引为2的行。让我们看看现在是几月:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="c02a" class="mb mc it lx b gy md me l mf mg">df.iloc[2]</span><span id="453e" class="mb mc it lx b gy mh me l mf mg"><strong class="lx iu"># Output</strong><br/>Year     2021<br/>Month     May<br/>Qty        85<br/>Name: 2, dtype: object</span></pre><p id="186c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2021年的最高数量是在5月观察到的。</p><p id="5ce6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫还有最小的功能，与最大的功能相反。语法是一样的，所以没有必要为最小的做一个单独的例子。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="31db" class="mb mc it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated">3.累计</h2><p id="1ba0" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">cumsum函数计算给定列中值的累积和。在处理时间序列或序列数据时，这是一个非常实用的方法。一个典型的例子是计算一年的累计收益或收入。</p><p id="2ff8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在某些情况下，您可能希望分别计算不同类别或组的累计总和。我们的数据框架中有一个日期和月份列。我们可以使用cumsum和groupby函数创建一个列，其中包含每年数量的累积和。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5e0b" class="mb mc it lx b gy md me l mf mg">df["cumulative_sum"] = df.groupby("Year").cumsum()</span><span id="e073" class="mb mc it lx b gy mh me l mf mg">df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/c6991243b8931536a61e704ad3a537fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*za8Vckkf4iYvU59eqrGhtg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df(作者图片)</p></figure><p id="4a3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们在上面的截图中所看到的，累积总值从2022年重新开始。</p><p id="cbdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们所做的例子并不是groupby函数的典型用例。然而，他们绝对有解决问题的潜力。因此，最好把它们放在你的武器库中。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="6d23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nm">你可以成为</em> <a class="ae ky" href="https://sonery.medium.com/membership" rel="noopener"> <em class="nm">媒介会员</em> </a> <em class="nm">解锁我的全部写作权限，外加其余媒介。如果你已经是了，别忘了订阅</em><a class="ae ky" href="https://sonery.medium.com/subscribe" rel="noopener"><em class="nm"/></a><em class="nm">如果你想在我发表新文章时收到电子邮件。</em></p><div class="nn no gp gr np nq"><a href="https://sonery.medium.com/membership" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">通过我的推荐链接加入Medium-Soner yl DRM</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">sonery.medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div><p id="71ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>