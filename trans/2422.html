<html>
<head>
<title>How to Explore a Dataset of Images with Graph Theory</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用图论探索图像数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-explore-a-dataset-of-images-with-graph-theory-fd339c696d99#2022-05-26">https://towardsdatascience.com/how-to-explore-a-dataset-of-images-with-graph-theory-fd339c696d99#2022-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2a65" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">组合特征提取、相似性度量和最近邻图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fd6b8bb14b5b77b76df1aec3e1ab34c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H88aRtloLkQ_RCY48tj6Sg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k-最近邻图示例(图片由作者提供)</p></figure><p id="d208" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当你开始处理一个由图片组成的数据集时，你可能会被问到这样的问题:你能检查图片是否好吗？有什么异常吗？一个快速而简单的解决方案是手动逐个查看数据，并尝试对它们进行分类，但这可能是一项繁琐的工作，具体取决于您获得的图片数量。</p><p id="2ad8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，在制造业中，您可以从由不同类型和大小的电池组成的生产线上获得包含数千张图片的样本。你必须手动浏览所有图片，并按照类型、大小甚至颜色进行排列。</p><p id="754e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一方面，另一个更有效的选择是走计算机视觉路线，找到一种可以自动排列和分类图像的算法——这是本文的目标。</p><p id="287e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是我们怎样才能自动完成一个人的工作，也就是说，两个两个地互相比较图片，并根据相似性进行分类？这个问题没有统一的答案。尽管如此，我们可以将问题分成更容易的子问题，并逐一解决它们:从每幅图像中提取相关特征，定义特征之间的相似性度量，并根据相似性对它们进行排序。</p><p id="d8fd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了解决每个子问题，我们将在本文中使用以下方法:</p><ol class=""><li id="2bcb" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">方向梯度直方图(HOG)提取特征</li><li id="cce7" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">测量直方图之间相似性的Wasserstein距离</li><li id="32b0" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">K-最近邻图(K-NNG ),以便根据相似性对图像进行排序</li></ol><h1 id="b824" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">方向梯度直方图</h1><p id="95f2" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">任何计算机视觉问题的第一步都是从图片中提取有用的特征。在我们的例子中，我们希望比较图像，并根据相似性对它们进行排序。所以我们希望我们的特征能够区分相似和不太相似的图像。目标检测中经常使用的一个特征是梯度方向直方图(HOG)。</p><p id="2fc5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">HOG特征是将图像表示为矢量，其中矢量中的每个元素都是定向梯度的直方图。推荐阅读<a class="ae nf" href="https://medium.com/analytics-vidhya/a-gentle-introduction-into-the-histogram-of-oriented-gradients-fdee9ed8f2aa" rel="noopener">这篇文章</a>了解HOG算法的工作原理。</p><p id="3328" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了从图像中提取hog特征，我们可以使用Scikit-image库中的HOG()函数。以下是在黑白图片上提取的渐变的视觉示例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/bdab396b7ef803c418cb372b88e990b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pdv4NIotx00MG1ZeA-cn1w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">方向梯度直方图示例</p></figure><p id="ec3d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">既然我们已经从图像中提取了特征，我们需要定义这些特征之间的相似性度量。机器学习中常用的相似性度量是欧几里德距离，但是在我们的例子中，我们将使用Wasserstein度量来给出两个分布之间的距离度量。</p><h1 id="f1ad" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">瓦瑟斯坦距离</h1><p id="424e" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">Wasserstein度量，也称为推土机距离，是两个概率分布之间的距离度量。它基于测量将一种分布转换成另一种分布所需的“工作量”的思想。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/8e48956f7612392391d3fb90954a6948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZrPWkFLa-eZsiF9fkOHFDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Wasserstein距离示例(图片由作者提供)</p></figure><p id="7520" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用Wasserstein度量标准有很多原因。一个原因是它是概率度量空间中一个非常自然的度量。这是一个非常通用的指标，可以用来比较不一定相同的分布。</p><p id="164b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">寻找特征向量之间的良好距离度量是许多机器学习算法的基本步骤。在我们的例子中，Wasserstein度量测量两个直方图之间的距离，因此提供了两个图片之间的相似性度量。</p><p id="5687" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">HOG从图片中提取特征，Wasserstein度量提供每个特征之间的距离。下一步是绘制数据并探索数据集。对于这个任务，k-最近邻图因其简单性和可解释性而成为自然的选择。</p><h1 id="b5c4" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">K-最近邻图(K-NNG)</h1><p id="a674" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">简单地说，K-最近邻图是每个节点都与其K个最近邻相连的图。K-NNG有助于发现数据中的模式。例如，如果您有一个人的身高和体重的数据集，您可以使用K-最近邻图来找出数据中是否有任何模式。</p><p id="b5aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于我们的最后一个例子，我创建了自己的玩具数据集，其中有一个杯子的500张照片，有几种位置和旋转。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/adfc534b3bafe40a41b48c1cc97732d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gysn5vsg5mQEzsSr7ThkYA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有不同位置和旋转的杯子数据集(图片由作者提供)</p></figure><p id="d201" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了发现数据的全局结构，我们可以使用流形学习，例如t-分布式随机邻居嵌入(t-SNE)来将HOG描述符的维度降低到仅二维。</p><p id="0131" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过这种布局，我们获得了一个分隔节点的图，如下图所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/6896e9f010fcbcf19efb4b5628f04b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0FuAv3PXxYno1oFXWV9uDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">30-cup数据集的最近邻图(图片由作者提供)</p></figure><p id="cc39" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以用这种方法轻松地分离不同类型的数据，但我们也可以探索数据集的底层结构。对于杯子的例子，我们能够区分五个水平位置，也能够区分杯子在图片中的旋转。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/30c7dbe3047273aa2aae99e02be96f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kdvOoabLdEUoeV0iJw50fQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">第一个位置的编码旋转(图片由作者提供)</p></figure><h1 id="e2ef" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">结论</h1><p id="b04d" class="pw-post-body-paragraph ky kz it la b lb na ju ld le nb jx lg lh nc lj lk ll nd ln lo lp ne lr ls lt im bi translated">HOG特征是一个强大的特征描述符，可用于各种计算机视觉应用。然而，它也是一个高维特征向量，可能很难处理。</p><p id="bbd1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，我们使用Wasserstein度量来计算每个直方图之间的距离，这在计算上是昂贵的，但是在比较两个分布时是自然的选择。</p><p id="025e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了改进这种方法，我们可以降低HOG特征的维度。例如，我们可以使用更少数量的箱、更粗糙的宁滨方案或更小范围的值，但我们将在另一篇文章中讨论这一点。</p><p id="ff5f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，通过K近邻图，我们了解数据。这包括理解数据代表什么以及数据集的整体结构，这是迭代和细化探索性分析的良好起点。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="a557" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好奇想了解更多关于Anthony的工作和项目吗？在<a class="ae nf" href="https://medium.com/@anthonycvn" rel="noopener">媒体</a>、<a class="ae nf" href="https://www.linkedin.com/in/anthonycavin/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae nf" href="https://twitter.com/Anthony66333223" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注他。</p><p id="1fa4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ns">需要技术写手？将您的请求发送到</em><a class="ae nf" href="https://amigocci.io/blog/mlops-at-medium-scale/" rel="noopener ugc nofollow" target="_blank"><em class="ns">https://amigo CCI . io</em></a><em class="ns">。</em></p></div></div>    
</body>
</html>