<html>
<head>
<title>Streamlit from Scratch: Build a Data Dashboard with Streamlit's Layout and UI features</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始简化:使用简化的布局和 UI 功能构建数据仪表板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/streamlit-from-scratch-build-a-data-dashboard-with-streamlits-layout-and-ui-features-a2fc2f0a6a59#2022-12-16">https://towardsdatascience.com/streamlit-from-scratch-build-a-data-dashboard-with-streamlits-layout-and-ui-features-a2fc2f0a6a59#2022-12-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2812" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Streamlit 为用户交互和布局提供了简单而有效的组件，让我们能够构建有效且有吸引力的数据科学和仪表板应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/21c4112e0d1488c956d6986fef395df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Uc2ZUwmCvQDfPIYh"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不，我们不会做一个这样的仪表板——照片由<a class="ae ky" href="https://unsplash.com/@cleipelt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·莱佩尔特</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="d1f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将探索 Streamlit 的一些布局和用户界面特性，以便创建一个简单而有效的数据仪表板应用程序。</p><p id="a282" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本系列的前几篇文章中，我们已经了解了如何呈现文本、媒体和数据，现在我们将使用这些知识并添加布局和用户界面组件来创建一个完整的应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/77ab81d728474dd3c820e8ecaf004646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fsTbivAZhowy9A6hJSB-JA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">居然三个 app！—作者图片</p></figure><p id="551c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit 使应用程序开发人员的生活变得简单，并且没有 HTML 和 Javascript UI 库等其他技术中可用的大量 UI 选项。但是使用它的布局组件，你可以很容易地设计一个有吸引力的和有能力的网页。</p><p id="2bc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit 应用程序由各种容器元素和用户界面组件(如滑块和选择框)构成，我们将查看一些最有用的组件。</p><p id="0c6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是首先，我们需要一些数据。</p><p id="49fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码从我的 Github 库<a class="ae ky" href="https://github.com/alanjones2/CO2" rel="noopener ugc nofollow" target="_blank"> CO2 </a>中获取四个数据文件。它们包含了过去几百年全球二氧化碳排放量的数据。我从 Data[1]中下载了我们世界的数据，并把它分成了四个不同的子集。第一个包含世界上每个国家的数据，第二个按洲细分，第三个是全世界的数据，最后一个按收入类型表示国家组。(我们不会使用所有的代码，所以你可以忽略下面的代码，但是如果你需要的话，它就在那里。)</p><p id="6407" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还包括了我们将在本文中使用的所有库。</p><h1 id="8ebe" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">获取数据并缓存</h1><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="3cb2" class="mt lx it mp b be mu mv l mw mx">import streamlit as st<br/>import plotly.express as px<br/>import pandas as pd<br/>import numpy as np<br/><br/>@st.cache<br/>def get_countries_data(): <br/>    url = "https://github.com/alanjones2/CO2/raw/master/data/countries_df.csv"<br/>    return pd.read_csv(url)<br/>@st.cache<br/>def get_continent_data():<br/>    url = 'https://github.com/alanjones2/CO2/raw/master/data/continents_df.csv'<br/>    return pd.read_csv(url)<br/>@st.cache<br/>def get_world_data():<br/>    url = 'https://github.com/alanjones2/CO2/raw/master/data/world_df.csv'<br/>    return pd.read_csv(url)<br/>@st.cache<br/>def get_group_data():<br/>    url = 'https://github.com/alanjones2/CO2/raw/master/data/income_types_df.csv'<br/>    return pd.read_csv(url)<br/><br/>df_countries= get_countries_data()<br/>df_continents= get_continent_data()<br/>df_world = get_world_data()<br/>df_groups = get_group_data()</span></pre><p id="9e4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能想知道为什么我编写了函数来下载并为每个文件创建一个数据帧。Python 装饰器<code class="fe my mz na mp b">@st.cache</code>指出了这样做的原因。</p><p id="ac39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每当用户与 Streamlit 应用程序交互时，例如输入值或更改设置，整个 Streamlit 应用程序都会从头开始运行。这可能看起来效率很低，但这就是 Streamlit 的工作方式，通常不会对用户体验产生太大影响。</p><p id="a92f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了有时候会这样。这种影响可能是巨大的。</p><p id="7ca6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果从外部源下载大量数据，这将需要时间。虽然这在应用程序第一次启动时是可以接受的，但你真的不希望当用户试图改变某些东西时有长时间的停顿。这就是<code class="fe my mz na mp b">@st.cache</code>装饰的全部意义。</p><p id="d5b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以这种方式标记函数告诉 Streamlit 缓存任何结果数据，并停止再次调用该函数，除非传递给它的参数已经更改。相反，缓存的数据被返回给调用者。</p><p id="99c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的函数中没有参数，所以它们只会被调用一次。这正是我们想要的；数据不会改变，所以只会在第一次调用函数时获取。此后，将使用缓存的数据。</p><p id="3845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据帧看起来都像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/78757866ac32aa9777b015aa95ec250a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rP2ZwMumW3wV8G_y6ijMVg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">示例数据—作者提供的图片</p></figure><p id="4574" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们包含用于的列</p><ul class=""><li id="9337" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated"><em class="nl">实体</em>:国家、洲、收入群体或“世界”</li><li id="ee31" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><em class="nl">代码</em>:ISO 国家代码(如果是国家)</li><li id="30ef" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><em class="nl">年</em></li><li id="2b37" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><em class="nl">年度二氧化碳排放量</em>:来自燃烧化石燃料和工业过程</li><li id="2094" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><em class="nl">包括土地利用变化在内的 CO2 年排放量</em>:上栏和下栏之和</li><li id="af47" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><em class="nl">土地利用变化的年 CO2 排放量</em></li></ul><p id="4594" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用前四列来显示每种实体类型随时间推移的排放量。</p><p id="a0d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将建立不同的应用程序，使用不同的用户界面和布局功能。我们将首先看看组件，然后看看如何构建应用程序。</p><h1 id="2be9" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">用户界面</h1><p id="854f" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">我们首先关注的是世界。我们将在地图上展示世界上所有国家的排放量是如何变化的。用户将选择一个年份，国家将根据其排放水平打上阴影。</p><p id="dcbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们遇到第一个 Streamlit UI 组件的地方。我们将使用一个滑块来允许用户选择年份。</p><h2 id="ee5b" class="nw lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">滑块</h2><p id="a38e" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">滑块非常容易使用:</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="99d7" class="mt lx it mp b be mu mv l mw mx">year = st.slider('Select year',1850,2020)</span></pre><p id="2e95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe my mz na mp b">st.slider</code>方法需要三个参数、一个提示字符串和两个数值限制。返回值介于两个极限之间，对应于滑块的位置。在下图中，范围介于 1850 和 2020 之间，返回值为 1978。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/ae298c01cc2e6f9c5cc335866a341f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5bUGDNE-4rtEJxfdIEiTJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">滑块—作者的图像</p></figure><p id="4a2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，当一个 UI 控件发生变化时，整个应用程序将再次运行。但是只有当滑块移动时，该值才会更新。</p><p id="15e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以给出第四个参数来设置滑块的默认值，例如</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="fade" class="mt lx it mp b be mu mv l mw mx">year = st.slider('Select year',1850,2020,1950)</span></pre><p id="51a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在一个 Plotly choropleth 中使用 year 值，它将给出一个如下图所示的数字。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/ae275137b33b869e74ecbd8dbe8fc410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0mfQkSd0IGn_Gw4D_1l_w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示全球二氧化碳排放量的图表——图片由作者提供</p></figure><p id="531b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建 choropleth 没有什么特别困难的。Plotly 为您做了所有艰苦的工作，我们只需提供适当的价值观。这是代码。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="1dc0" class="mt lx it mp b be mu mv l mw mx">max = df_countries['Annual CO₂ emissions'].max()<br/><br/>year = st.slider('Select year',1850,2020)<br/>fig1 = px.choropleth(df_countries[df_countries['Year']==year], locations="Code",<br/>                    color="Annual CO₂ emissions",<br/>                    hover_name="Entity",<br/>                    range_color=(0,max),<br/>                    color_continuous_scale=px.colors.sequential.Blues)<br/>st.plotly_chart(fig1)</span></pre><p id="9756" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在代码中，我们使用了<code class="fe my mz na mp b">year</code>的值来过滤数据帧，并生成 choropleth 将使用的数据。我们还计算了表格中二氧化碳排放量的最大值，这用于设置地图上使用的颜色范围。除了数据之外，参数还包括:</p><ul class=""><li id="3e58" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated"><code class="fe my mz na mp b">locations</code>:将用于在地图上识别区域的 ISO 代码</li><li id="37da" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><code class="fe my mz na mp b">color</code>:将用于设置颜色的值</li><li id="1369" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><code class="fe my mz na mp b">hover_name</code>:悬停在地图上时显示的字符串，即国家名称</li><li id="c23c" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><code class="fe my mz na mp b">range_color</code>:将被映射到颜色上的数值范围</li><li id="eb24" class="nc nd it lb b lc nm lf nn li no lm np lq nq lu nh ni nj nk bi translated"><code class="fe my mz na mp b">color_continuous_scale</code>:将要使用的颜色列表(在这种情况下，Plotly Express 提供了一系列连续的蓝色)</li></ul><p id="7133" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该图的细节有点难以看清，但如果您使用扩展器控件(将图像扩展到全屏)和/或缩放工具，可以很容易地看到各个国家。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/23f95df0df2b6614d8a0759c8b115b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4WHaaCfNj380Ak8LRQFLoA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">国家特写——作者图片</p></figure><p id="cae5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">滑块也可以用于分类值，它们可以支持一个范围。例如:</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="2d17" class="mt lx it mp b be mu mv l mw mx">start_month, end_month = st.select_slider(<br/>    'Select a range of months',<br/>    options=['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', <br/>             'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],<br/>    value=('Jan', 'Dec')<br/>)<br/>    <br/>st.write('You selected months between', start_month, 'and', end_month)</span></pre><p id="b70c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这让用户可以选择月份列表的开始和结束，默认结果是“一月”和“十二月”。结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/04c269f256bb0c461de642e4990de1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5rR5OF0LSzwe8dTF1E_Cw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">范围选择器—按作者分类的图像</p></figure><h2 id="29dd" class="nw lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">选择框</h2><p id="f2da" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">Streamlit 提供了两个<em class="nl"> selectbox </em>方法:一个用于选择单个项目，另一个用于选择多个项目。</p><p id="462a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是单个<em class="nl">选择框</em>的例子。它可以让您选择一个洲，并以线形图的形式显示该洲的二氧化碳排放量。首先，我们需要创建一个大陆列表，并将其存储在变量<code class="fe my mz na mp b">continents</code>中，然后我们会看到<em class="nl">选择框</em>，它将让用户选择一个大陆。使用该值，我们过滤数据帧，并用 Plotly 绘制一个折线图。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="d844" class="mt lx it mp b be mu mv l mw mx">continents = df_continents['Entity'].unique()<br/><br/>selected_continent = st.selectbox('Select country or group',continents)<br/><br/>df = df_continents[df_continents['Entity'] == selected_continent]<br/><br/>fig2 = px.line(df,"Year","Annual CO₂ emissions")<br/><br/>st.plotly_chart(fig2, use_container_width=True)</span></pre><p id="a2f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果看起来是这样的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/40939ab2229256f86968fe862513eb7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yf_pOsclj2WdM1zt3EU8OA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有下拉选择器的折线图—按作者分类的图像</p></figure><p id="be9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">单击显示洲的字段将会弹出一个菜单，从中可以选择其他值。</p><p id="1259" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想运行类似的东西，但我们可以比较国家，那么我们需要<em class="nl">多选择框</em>。</p><p id="1759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个使用<code class="fe my mz na mp b">st.multiselect()</code>的类似函数。这允许用户以类似的方式从下拉菜单中选择，但是一旦选择，该值将保存在菜单上方的框中显示的列表中。要从列表中删除一个项目，单击该项目的<em class="nl"> x </em>，该项目将从框中删除并重新出现在菜单中。</p><p id="45a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该代码与前面的函数非常相似，只是我们没有根据单个值过滤数据帧，而是使用<code class="fe my mz na mp b">isin()</code>方法来检查洲名是否在所选列表中。我还限制了年数，这样数字更易读。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="f006" class="mt lx it mp b be mu mv l mw mx">continents = df_continents['Entity'].unique()<br/><br/>selected_continents = st.multiselect('Select country or group',<br/>                                      continents, continents)<br/>df = df_continents[df_continents['Year'] &gt;= 2010]<br/>df = df[df_continents['Entity'].isin(selected_continents)]<br/><br/>fig = px.bar(df,"Year","Annual CO₂ emissions",color="Entity", barmode='group')<br/>st.plotly_chart(fig, use_container_width=True)</span></pre><p id="de7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是选择了五大洲的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/eccd522b189402d589b57c44e7872503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sipBoBCniumUuQTlx8oesg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多选条形图—按作者分类的图像</p></figure><h2 id="5e5a" class="nw lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">单选按钮</h2><p id="0738" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">我们要看的下一个 UI 组件是一个实现单选按钮的组件。</p><p id="d065" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码应该看起来很熟悉，首先是一个提示，然后是可以选择的项目列表。接下来是一组测试<code class="fe my mz na mp b">chart</code>值的<code class="fe my mz na mp b">if</code>语句，并显示我们之前创建的正确图表。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="6cf4" class="mt lx it mp b be mu mv l mw mx">chart = st.radio(<br/>    "Select the chart that you would like to display",<br/>    ('World Map', 'Continent Emissions', 'Comparing continents'))<br/><br/>if chart == 'World Map': <br/>    st.plotly_chart(fig1)<br/>if chart == 'Continent Emissions': <br/>    st.plotly_chart(fig2)<br/>if chart == 'Comparing continents': <br/>    st.plotly_chart(fig3)</span></pre><p id="9cdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果看起来是这样的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/97b52f6f5f954848c3338f977beb32e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1aKlzf8TvUDQq-qRhBAAg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">单选按钮-按作者分类的图像</p></figure><h1 id="aedc" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">布局</h1><p id="71c7" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">Streamlit 还提供了其他几个 UI 组件，但我们现在就不讨论了，因为为了构建一个有效的应用程序，我们需要知道如何布局我们到目前为止看到的组件。</p><p id="bb90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit 提供了许多布局元素、容器、列和侧边栏。我们将使用这些特性，根据我们看到的数据构建两个版本的仪表板应用程序。</p><p id="4c81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在我们开始之前，让我们看看使用布局组件的两种方法——对象符号和<code class="fe my mz na mp b">with</code>。</p><h2 id="2fa3" class="nw lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">使用对象符号或'<code class="fe my mz na mp b">with’</code></h2><p id="dc95" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">布局组件可使用对象符号或<code class="fe my mz na mp b">with</code>关键字进行编程。这里有一段虚构的代码显示了这种差异。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="55a2" class="mt lx it mp b be mu mv l mw mx"># Object notation<br/>layoutcomponent1.write('This will be written inside component 1')<br/>layoutcomponent1.write('This will also be written inside component 1')<br/><br/># 'with' notation<br/>with layoutcomponent2:<br/>    st.write('This will be written inside component 2')<br/>    st.write('This will also be written inside component 2')</span></pre><p id="228a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这两个例子的工作方式相同，产生的结果也相同。</p><p id="b953" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用对象表示法，布局对象的名字代替了<code class="fe my mz na mp b">st</code>，所以当你写<code class="fe my mz na mp b">st.write("stuff")</code>来写布局组件中不包含的东西时，在这样的组件中写的时候，你用组件名代替了<code class="fe my mz na mp b">st</code>。</p><p id="8adf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用<code class="fe my mz na mp b">with</code>符号时，使用<code class="fe my mz na mp b">with component_name:</code>打开一个块。块内写入的任何内容都显示在布局组件中，并使用正常的<code class="fe my mz na mp b">st</code>前缀。</p><p id="82b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe my mz na mp b">with</code>可以让您将布局组件上的操作组合在一起，而对象符号可以让您自由地将这些操作分散到整个代码中。使用哪一个完全取决于你，但我倾向于尽可能选择<code class="fe my mz na mp b">with</code>选项——我认为如果可以的话，将代码放在一个块中更合理。</p><p id="ee48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果这一点还不完全清楚，那么当我们处理一些具体的例子时，它就会变得清楚了。</p><p id="f3da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们就这么做吧。</p><h2 id="2988" class="nw lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">侧栏布局</h2><p id="4c71" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">侧边栏是 Streamlit 中最早的布局组件之一。这允许您将用户输入控件分组到屏幕一侧的区域中，并在主窗口中显示应用程序的其余部分。</p><p id="847a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是如何使用它的一个例子。侧边栏包含三个单选按钮，允许您选择三个图表中的一个显示在主窗口中。(为了简洁起见，我将注释放在了我们已经看到的代码所在的位置。然而，可下载的代码是完整的。)</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="564f" class="mt lx it mp b be mu mv l mw mx"># Code to import libraries and get the data goes here<br/><br/># The side bar that contains radio buttons for selection of charts<br/>with st.sidebar:<br/>    st.header('Select an chart to be displayed')<br/>    chart = st.radio(<br/>    "Select the image that you would like to display",<br/>    ('World Map', 'Continent Emissions', 'Comparing continents'))<br/><br/># The main window<br/><br/>st.title("A Simple CO2 Emissions Dashboard")<br/>st.write("an example of a Streamlit layout using a sidebar")<br/><br/>with st.container():<br/>    <br/>    if chart == 'World Map': <br/><br/>        # code to draw the choropleth<br/><br/>    if chart == 'Continent Emissions': <br/>        <br/>        # code to draw the continent chart<br/><br/>    if chart == 'Comparing continents': <br/><br/>        # code to draw the multiple continents chart</span></pre><p id="026e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到我已经使用了<code class="fe my mz na mp b">with</code>块来包含显示代码；一个用于侧边栏，另一个将显示在主窗口中，作为<code class="fe my mz na mp b">st.container()</code>，它只是一个通用容器，确实可以做任何非常特殊的事情。</p><p id="ae0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果实际上是一个简单但完整的仪表板应用程序，看起来像这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/78dc1a5bc162d10f61e8dafb2a4fc0e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikzdbOj-hL31pzaEGhk_Cg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有侧边栏的应用程序——作者图片</p></figure><h2 id="e4cd" class="nw lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">列布局</h2><p id="501e" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">列允许您在屏幕上并排放置组件，我们将了解如何创建基于列的排放应用程序版本。创建列的最简单方法如下:</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="9035" class="mt lx it mp b be mu mv l mw mx">col1, col2 = st.column(2)</span></pre><p id="1fac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对<code class="fe my mz na mp b">st.column()</code>的调用返回一个列对象列表，列对象的数量由参数值决定。它们将在主窗口或另一个布局组件中相邻显示。</p><p id="19d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以使用附加参数来调整列之间的间距，例如</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="2528" class="mt lx it mp b be mu mv l mw mx">col1, col2 = st.columns(2, gap="large")</span></pre><p id="4312" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们使用<em class="nl">大</em>间隙，但该值也可以是<em class="nl">小</em>(默认)或<em class="nl">中</em>。</p><p id="7ddc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，列的宽度是相同的，但是您可以通过在 tuple 中指定它来获得不同的宽度。例如:</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="74a8" class="mt lx it mp b be mu mv l mw mx">col1, col2 = st.columns((2,4))</span></pre><p id="9f1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">元组中的值不是实际宽度，而是表示相对比例。因此，在上面的示例中，第一列的宽度是第二列的一半，使用元组(1，2)或(50，100)可以达到相同的效果。</p><p id="8f95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的例子中，我们有两个上下叠放的容器。每个容器被分割成列，这些列包含绘制图表的代码。</p><p id="9817" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个容器被分成三列，中间一列是容器宽度的一半。我们将只使用这个中间的列，左右的列将作为较大的边距。地图画在这一栏里。</p><p id="7e11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个容器有两个包含其他图表的等宽列。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="b9a5" class="mt lx it mp b be mu mv l mw mx"># Set app to use a wide layout <br/># - this must be executed before any code that displays anything <br/>st.set_page_config(layout = "wide")<br/><br/># Code to import libraries and get the data goes here<br/><br/># The main window<br/>st.title("A Simple CO2 Emissions Dashboard")<br/>st.info("An example of a Streamlit layout using columns")<br/><br/># This container will be displayed below the text above<br/>with st.container():<br/>    col1, col2, col3 = st.columns((25,50,25))<br/><br/>    with col2:<br/>        st.header("Global emissions since 1850")<br/>        st.info("""Select a year with the slider to see the intensity<br/>                of emissions change in each country""")<br/><br/>        # code to draw the choropleth<br/><br/># This container will be displayed below the first one<br/>with st.container():<br/>    col1, col2 = st.columns(2, gap="large")<br/>    with col1:<br/>        st.header("Continental emissions since 1850")  <br/>        st.info("Select a single continent or compare continents")<br/>        <br/>        # code to draw the single continent data<br/><br/>    with col2:<br/>        st.header("Continental emissions since 1850")<br/>        st.info("To add a continent select it from the menu. You can also delete one, too")<br/><br/>        # code to draw the compared continent data</span></pre><p id="6f6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这个，我们就有了一个完整的应用程序，看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/1f33bfe513a14b7ac1204b53ca523e0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qzsoglPh758MjV00zldmWg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个基于栏目的应用程序——作者图片</p></figure><h2 id="1cf3" class="nw lx it bd ly nx ny dn mc nz oa dp mg li ob oc mi lm od oe mk lq of og mm oh bi translated">制表符</h2><p id="2361" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">上面的应用程序非常大，你必须向下滚动才能看到所有的内容。(为了得到截图，我不得不缩小浏览器。)</p><p id="195a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想以某种方式将下面的两个图表组合起来，我们可以将它们放在第一个图表的旁边，并立即在屏幕上显示所有的数据。</p><p id="6bfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过使用标签来实现。</p><p id="79b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选项卡的构造方式与列类似，只是您传递了一个将用作选项卡标题的字符串列表。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="4f6a" class="mt lx it mp b be mu mv l mw mx">tab1, tab2 = st.tabs(["Header1"],["Header2"])</span></pre><p id="87b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将创建两个选项卡，标题分别为“标题 1”和“标题 2”。它们的使用方式与列类似。</p><p id="b0b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在下一个例子中看到这是如何工作的。我们只有一个容器，它被分成两个相等的列。第一个包含地图，第二个包含两个选项卡。每个选项卡都包含一个图表。</p><pre class="kj kk kl km gt mo mp mq bn mr ms bi"><span id="6dac" class="mt lx it mp b be mu mv l mw mx"># Code to import libraries and get the data goes here<br/><br/>st.set_page_config(layout = "wide")<br/><br/># The main window<br/><br/>st.title("A Simple CO2 Emissions Dashboard")<br/>st.info("An example of a Streamlit layout using columns")<br/><br/>with st.container():<br/>    col1, col2 = st.columns(2, gap="large")<br/><br/>    with col1:<br/>        # code to draw the choropleth<br/>    with col2:<br/>        st.header("Continental emissions since 1850")  <br/>        st.info("Select a single continent or compare continents")<br/><br/>        tab1, tab2 = st.tabs(["Continental emissions since 1850", <br/>                              "Continental emissions compared since 1850"])<br/>        with tab1:<br/>            # code to draw the single continent data<br/>        with tab2:<br/>            # code to draw the compared continent data</span></pre><p id="0fd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这产生了下面的应用程序。您可以在右栏中看到选项卡，以红色突出显示的选项卡是被选中的选项卡。如果我们单击另一个，将显示第二个图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/5b83995853c89ab74b8732b9ed8bcd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1mBf_K5w4aEkbvYizKcsHw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带标签的应用程序—作者图片</p></figure><h1 id="7ac9" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="f2fc" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">因此，我们有三个应用程序基于相同的数据，但具有不同的布局和 UI 元素。我们可以涵盖更多的 Streamlit 功能，但我认为我们在这里看到的功能可以用来创建有用的数据仪表板应用程序。</p><p id="6ef1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个简短系列中的文章涵盖了如何开始使用 Streamlit，如何包含图像和其他媒体，呈现数据，最后一篇文章介绍了 UI 和布局功能，并创建了三个简单的仪表板应用程序。以下是以前文章的链接:</p><p id="0853" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/towards-data-science/streamlit-from-scratch-getting-started-f4baa7dd6493" rel="noopener">从头开始简化 it:入门</a></p><p id="a8c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/towards-data-science/streamlit-from-scratch-embedding-images-video-and-audio-8b2e8b98fad4" rel="noopener">从头开始精简:嵌入图像、视频和音频</a></p><p id="d054" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/towards-data-science/streamlit-from-scratch-presenting-data-d5b0c77f9622" rel="noopener">从头开始精简:呈现数据</a></p><p id="304b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以从<a class="ae ky" href="https://alanjones2.github.io/streamlitfromscratch/" rel="noopener ugc nofollow" target="_blank"> Streamlit from Scratch </a>网站下载所有文章的完整代码，包括这篇文章。</p></div><div class="ab cl os ot hx ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="im in io ip iq"><h1 id="1b9d" class="lw lx it bd ly lz oz mb mc md pa mf mg jz pb ka mi kc pc kd mk kf pd kg mm mn bi translated">笔记</h1><p id="f51d" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">[1] <a class="ae ky" href="https://ourworldindata.org/" rel="noopener ugc nofollow" target="_blank">我们的数据世界</a>是一个信息宝库，其使命是发布<em class="nl">“研究和数据，以针对世界上最大的问题取得进展”</em>。他们所有的作品都可以在<a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">知识共享协议下通过许可</a>获得。</p></div></div>    
</body>
</html>