<html>
<head>
<title>SQL Aggregate Functions for Your Next Data Science Interview</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">下一次数据科学面试的SQL聚合函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-sql-aggregate-functions-92f7244a07cb#2022-10-04">https://towardsdatascience.com/how-to-use-sql-aggregate-functions-92f7244a07cb#2022-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="57a3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">基础知识回归| SQL初学者基础知识</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/75a729a56daacf991f271f7c5ba8a411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-sKS4ffWopsSMUf-tbPpg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片，创建于<a class="ae kv" href="https://www.canva.com" rel="noopener ugc nofollow" target="_blank"> canva </a></p></figure><p id="e467" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在企业的不同层级；我们经常依赖报告或可视化仪表板形式的数据来完成日常任务；比方说，对于审计和法规遵从性(内部和外部)，做出决策，衡量成功与否，或者甚至支持一个新业务想法的假设(开发一个新想法)</p><p id="9fc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不管你有什么数据，也不管你存储或维护数据的效率如何。事实上，您需要知道基本的编码来实际检索数据，也就是您的数据有任何价值的时候。</p><p id="8d92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">了解基本的SQL并不是真正的火箭科学，但它是游戏规则的改变者。如果团队中的每个人都熟练掌握基本的数据检索编码，这将增强整个团队的能力，并减少琐碎任务的依赖性，从而快速做出决策。</p><p id="3a53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SQL中的聚合函数非常强大，是日常分析中最常用的函数；比如，哪个产品的总收入最高，每个季度的总销售额等等。下面是最常见的聚合函数的快速回顾。</p><h2 id="63d2" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">什么是SQL聚合函数？</h2><p id="464b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">SQL聚合函数对一组值执行计算并返回一个值。嗯，大多数时候！当通过子句与<em class="mq"> GROUP配对时，它为每个组返回单个值。聚合函数大多是<a class="ae kv" href="https://docs.microsoft.com/en-us/sql/relational-databases/user-defined-functions/deterministic-and-nondeterministic-functions?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"> <em class="mq">确定性函数</em> </a>。</em></p><p id="7091" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦我们看完本文中的例子，这一切都有意义了。</p><p id="c883" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我使用<a class="ae kv" href="https://www.mysqltutorial.org/mysql-sample-database.aspx" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">classic models</strong></a>MySQL示例数据库进行演示，它保存了一家汽车零售商的业务数据。下面是ER图，以便快速理解，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/c8eecf27187711291ef0341d63121b71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WokfDeDulO1ZT5YvSO28Gw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="0afd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">📌<strong class="ky ir">侧注</strong></p><p id="169e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq"> GROUP BY </em>子句通常与聚合函数一起使用，按一列或多列对结果集进行分组。(基本上是将相似的数据组织成组)</p><p id="3dad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq"> ORDER BY </em>子句用于按升序或降序对结果集进行排序。默认情况下，它是按升序排列的。一起使用时，<em class="mq"> GROUP BY </em>子句总是在<em class="mq"> ORDER BY </em>子句之前。</p><p id="3742" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq">有</em>子句与<em class="mq">相似，其中</em>子句有一些不同。它只能用于属于GROUP BY 子句或聚合函数的<em class="mq">列。我写了一篇关于SQL中过滤子句的详细文章，可以在这里随意参考，</em></p><div class="mz na gp gr nb nc"><a rel="noopener follow" target="_blank" href="/commonly-asked-interview-question-where-vs-having-vs-qualify-1445a1d15902"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">常见的面试问题:vs在哪里有资格</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">基础知识回归| SQL初学者基础知识</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">towardsdatascience.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq kp nc"/></div></div></a></div><p id="ef46" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq"> DISTINCT </em>子句用于过滤掉重复项，只提供结果集中唯一的值。</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="db4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最常见的聚合函数有:</p><h2 id="b8b5" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak">伯爵()</strong></h2><p id="6760" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><em class="mq">‘计数’</em>这个词的一般意思是确定某物的总数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b3c9058b269a720cd68d4409fcea475f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gR4qO_jENeZpR8BoHZDDZw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片，创建于<a class="ae kv" href="https://www.canva.com" rel="noopener ugc nofollow" target="_blank"> canva </a></p></figure><p id="ccc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似地，在SQL <em class="mq">中，COUNT() </em>返回非空记录或与指定条件表达式匹配的记录的数量。<em class="mq"> COUNT() </em>在不使用<em class="mq"> OVER </em>和<em class="mq"> ORDER BY </em>子句的情况下为确定性函数，在使用<em class="mq"> OVER </em>和<em class="mq"> ORDER BY </em>子句的情况下为非确定性函数。<em class="mq"> COUNT() </em>的常用语法是，</p><blockquote class="nr ns nt"><p id="12dc" class="kw kx mq ky b kz la jr lb lc ld ju le nu lg lh li nv lk ll lm nw lo lp lq lr ij bi translated"><em class="iq">计数(【全部|不同】表达式)</em></p></blockquote><p id="3183" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们快速查询表<em class="mq"> OFFICES </em>，它保存了世界各地销售办事处的数据，</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="9cea" class="ls lt iq ny b gy oc od l oe of">#offices<br/>SELECT * FROM CLASSICMODELS.OFFICES LIMIT 10;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/de0c6f768c0300cd35c2cf9ad380b71e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*ZDgwYlzgX17znmT6D3mf0Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="ac50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从简单的开始；我们需要统计在世界各地拥有办公场所的不同城市的总数，</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="e586" class="ls lt iq ny b gy oc od l oe of">#cities that have sales offices.<br/>SELECT DISTINCT<br/>    COUNT(DISTINCT CITY) AS TOTAL_OFFICES<br/>FROM <br/>    CLASSICMODELS.OFFICES;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/620c5fa6895b26dcbbc92c4412021531.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*ZKqpO-6e3n1ybpKc7asTTw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7623" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们尝试查询每个国家的办事处数量，</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="a849" class="ls lt iq ny b gy oc od l oe of">#total number of sales offices in each country.<br/>SELECT<br/>    COUNTRY,<br/>    COUNT(DISTINCT CITY) AS TOTAL_OFFICES<br/>FROM <br/>    CLASSICMODELS.OFFICES<br/>GROUP BY COUNTRY<br/>ORDER BY COUNTRY DESC;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6dd6285420ae850c0922e8101c9fdf50.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*9I4e331w6ItvUDtjKpn3QA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="07f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个查询简单地提供了世界各地办事处的总数，而在第二个查询中，我们根据国家对结果集进行分组，并使用<em class="mq"> ORDER BY </em>子句对结果集进行排序。两个结果集中的办公室总数保持不变，都是7；唯一的区别是第二个结果集计数被分成不同的组。</p><p id="3d7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq"> COUNT() </em>可以有几种不同的用法；这里有一些简单的例子，</p><ul class=""><li id="8972" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated"><em class="mq"> COUNT(*) </em>返回表格中记录/行的总数，包括重复值和空值。</li></ul><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="2103" class="ls lt iq ny b gy oc od l oe of">SELECT COUNT(*) FROM CLASSICMODELS.OFFICES;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/f551bdcdd140633280c0ac8008f26ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*h30Gv4-eLN9C0wZ-vwg1-w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><ul class=""><li id="658a" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated"><em class="mq"> COUNT(1)，</em> 1是非空表达式，因此<em class="mq"> </em>类似于<em class="mq"> COUNT(*) </em>。</li></ul><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="7c3a" class="ls lt iq ny b gy oc od l oe of">SELECT COUNT(1) FROM CLASSICMODELS.OFFICES;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/47648e7dbace922694f1a73d7be2d8f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/1*CxtJqkx84u8hge8BQya9lA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><ul class=""><li id="c9d1" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated"><em class="mq"> COUNT(column_name) </em>从特定的<em class="mq"> column_name </em>返回非空的记录数。</li></ul><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="eb79" class="ls lt iq ny b gy oc od l oe of">SELECT COUNT(COUNTRY) FROM CLASSICMODELS.OFFICES;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/9a399e976d05fe49e1773c03e402bc09.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*eEFd6XJbtZT7Xu2Lup-7_A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><ul class=""><li id="0b5d" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated"><em class="mq">COUNT(DISTINCT column _ name)</em>从<em class="mq"> column_name </em>返回非空且唯一的记录数。</li></ul><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="b3a5" class="ls lt iq ny b gy oc od l oe of">SELECT COUNT(DISTINCT COUNTRY) FROM CLASSICMODELS.OFFICES;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/54770828b0a259bbfd14e4a26f209c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*7Ta8r5OTcFMqocUB2d8GvQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><ul class=""><li id="c569" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated"><em class="mq">COUNT(x THEN y ELSE z END的情况)</em>返回满足条件的行数。</li></ul><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="a21a" class="ls lt iq ny b gy oc od l oe of">#USA office locations<br/>SELECT <br/>    COUNT(CASE WHEN COUNTRY='USA' THEN CITY ELSE NULL END) AS USA_OFFICE_LOCATIONS<br/>FROM <br/>    CLASSICMODELS.OFFICES;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/c2635b0db763b260e89f042a627ce9a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*fDD9biJlWfcse1Gu22MUIw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><ul class=""><li id="b842" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated"><em class="mq"> COUNT IF </em>是<em class="mq"> COUNT() </em>的另一个扩展，它返回匹配条件表达式的记录数。</li></ul><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="eb55" class="ls lt iq ny b gy oc od l oe of">#country wise count of office locations<br/>SELECT <br/>    COUNT(IF(COUNTRY = 'USA', 1, NULL)) AS 'USA',<br/>    COUNT(IF(COUNTRY = 'UK', 1, NULL)) AS 'UK',<br/>    COUNT(IF(COUNTRY = 'Japan', 1, NULL)) AS 'Japan'<br/>FROM<br/>    CLASSICMODELS.OFFICES;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/2191b13e1ba5d61f3a85f77abd55062e.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*ZzuaaZXiKjYuyPyL7MUMZw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="145f" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak"> SUM( ) </strong></h2><p id="dc38" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在数学中，求和/总和是一系列数字的相加。类似地，在SQL中，<em class="mq"> SUM() </em>返回所选集中所有非空值的总和。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/da7c688ce62ea381c18bbaf01e756042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQwCzIjgFL0z6H4pK4crvw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片，创建于<a class="ae kv" href="https://www.canva.com" rel="noopener ugc nofollow" target="_blank"> canva </a></p></figure><p id="f122" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">语法是，</p><blockquote class="nr ns nt"><p id="6ae9" class="kw kx mq ky b kz la jr lb lc ld ju le nu lg lh li nv lk ll lm nw lo lp lq lr ij bi translated"><em class="iq"> SUM(【所有|不同】表达式)</em></p></blockquote><p id="a335" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">新手有时候会分不清<em class="mq"> SUM() </em>和<em class="mq">COUNT()</em>；但是请记住，他们两个是非常不同的。<em class="mq"> COUNT() </em>返回列中非空记录/行的总数，而<em class="mq"> SUM() </em>返回该列中所有值的总和。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5644c576536a5509b1c89f4a649e00e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDWcBrsiZAMYpASdjnMW2w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片，创建于<a class="ae kv" href="https://www.canva.com" rel="noopener ugc nofollow" target="_blank"> canva </a></p></figure><p id="d608" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">表<em class="mq">产品</em>保存了一系列可用产品的数据，</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="3543" class="ls lt iq ny b gy oc od l oe of">#products<br/>SELECT * FROM CLASSICMODELS.PRODUCTS LIMIT 10;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/ef9b46e8e7f7201529712c41f9361ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZ44voPfX2j5CKWjng06eQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="36b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比方说，我们需要库存中当前产品总量的信息，</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="b7bc" class="ls lt iq ny b gy oc od l oe of">#total quantity available in stock<br/>SELECT <br/>    SUM(QUANTITYINSTOCK) as TOTAL_QUANTITY_IN_STOCK<br/>FROM<br/>    CLASSICMODELS.PRODUCTS;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/95e33f1b8f30f92d64bebe8d7ce5b3a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/1*bb-gPSA_zXkUvduVNA0e-w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3069" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在商业中，这些信息没有多大用处。现在让我们尝试查询每条<em class="mq">生产线</em>的当前总库存数量，并按降序对结果集进行排序。</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="c238" class="ls lt iq ny b gy oc od l oe of">#total quantity currently in stock for each productline grouped by productline<br/>SELECT<br/>    PRODUCTLINE,<br/>    SUM(QUANTITYINSTOCK) AS TOTAL_IN_STOCK<br/>FROM <br/>    CLASSICMODELS.PRODUCTS<br/>GROUP BY PRODUCTLINE      <br/>ORDER BY TOTAL_IN_STOCK DESC;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/5c48c6f13fb97058541d3aafe4ca4cf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*_yTOP4tE38juIooMBgBZeQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="32f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们做一些快速销售分析。表<em class="mq"> ORDERDETAILS </em>中的样本数据为:</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="ffc2" class="ls lt iq ny b gy oc od l oe of">#orderdetails<br/>SELECT * FROM CLASSICMODELS.ORDERDETAILS LIMIT 10;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/f9d44db10867ad2c1c6eadaba506f2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XhmKGSgj3rgB8-Hqw3sskQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="6aab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比方说，我们需要知道每个订单的总销售额，按降序排列，</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="08b9" class="ls lt iq ny b gy oc od l oe of">#total sales for each order placed<br/>SELECT <br/>    ORDERNUMBER,<br/>    SUM(QUANTITYORDERED * PRICEEACH) AS TOTAL_SALES<br/>FROM <br/>    CLASSICMODELS.ORDERDETAILS<br/>GROUP BY ORDERNUMBER<br/>ORDER BY TOTAL_SALES DESC;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/2585a0b7295a765f9cbd7e91270b1d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*C2tlReLHRB7QD9PfAfgZ9g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1636" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">出于演示目的，我限制了上述查询的结果集。现在，这个结果集也给出了销售额最高的<em class="mq">订单号</em>的概念。您可以从这里获取<em class="mq">订单号</em>，并进一步分析该订单中包含哪些产品、数量是多少、买方是谁、订单是何时下的、装运状态等。</p><p id="7adf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果所选集合的所有值都为空值，SUM() 将返回空值<em class="mq"/>。</p><h2 id="e3c5" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated"><strong class="ak"> AVG( ) </strong></h2><p id="f243" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在数学中，平均值的计算方法是将一系列数字相加，然后除以这些数字的个数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/30f13b9fe255764a7d4f108aaf92812f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUOcosuxoGl_A77LJnd68A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片，创建于<a class="ae kv" href="https://www.canva.com" rel="noopener ugc nofollow" target="_blank"> canva </a></p></figure><p id="6d5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，<em class="mq"> AVG() </em>返回所选集合的平均值，<em class="mq">空值</em>被忽略。常见的语法是，</p><blockquote class="nr ns nt"><p id="2fd9" class="kw kx mq ky b kz la jr lb lc ld ju le nu lg lh li nv lk ll lm nw lo lp lq lr ij bi translated"><em class="iq"> AVG</em></p></blockquote><p id="d640" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">继续<em class="mq">产品</em>表，现在让我们找出平均购买价格。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/ef9b46e8e7f7201529712c41f9361ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZ44voPfX2j5CKWjng06eQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="6bc7" class="ls lt iq ny b gy oc od l oe of">#average buy price<br/>SELECT<br/>    AVG(BUYPRICE) AS AVERAGE_BUYPRICE<br/>FROM<br/>    CLASSICMODELS.PRODUCTS;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/6a2532917aea6884fc4a68ee6c3b4033.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*H9JO74-5jsgHdCoFaliQdA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="af94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们对每条<em class="mq">生产线</em>进行分析，</p><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="ef2e" class="ls lt iq ny b gy oc od l oe of">#average buy price for each product line<br/>SELECT<br/>    PRODUCTLINE,<br/>    AVG(BUYPRICE) AS AVERAGE_BUYPRICE<br/>FROM<br/>    CLASSICMODELS.PRODUCTS<br/>GROUP BY PRODUCTLINE;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/1126c6ac6d601d5e076a5c7513497c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*tCyCXwk9J5GKIZtpHM9XPg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="6c50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">稍加修饰，将<em class="mq"> AVG(BUYPRICE)作为AVERAGE_BUYPRICE </em>替换为<em class="mq">格式(AVG(BUYPRICE)，2)作为AVERAGE_BUYPRICE </em>，结果集将为，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/e99245e7255aeb084cfaee2c10ca5ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*qtCasjbaA6RkTCWiN6LYyg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="5956" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">最大( )，最小( )</h2><p id="f121" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">嗯！这个是简单的一个，顾名思义；<em class="mq"> MAX() </em>返回所选集合中的最高或最大非空值，而<em class="mq"> MIN() </em>返回所选集合中的最低或最小非空值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/e9ed5747a019cb1c263cf93f40b716f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swjaIC3VDQcI1ACgl915PQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片，创建于<a class="ae kv" href="https://www.canva.com" rel="noopener ugc nofollow" target="_blank"> canva </a></p></figure><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="dc88" class="ls lt iq ny b gy oc od l oe of">#maximum buy price<br/>SELECT <br/>    MAX(BUYPRICE) AS MAXIMUM_BUYPRICE<br/>FROM<br/>   CLASSICMODELS.PRODUCTS;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/dac5c8c6276c29a290376a82f181a492.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*cmXMwVIDNC2s-FTDnv_c7g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><pre class="kg kh ki kj gt nx ny nz oa aw ob bi"><span id="9569" class="ls lt iq ny b gy oc od l oe of">#minimum buy price<br/>SELECT <br/>    MIN(BUYPRICE) AS MAXIMUM_BUYPRICE<br/>FROM<br/>    CLASSICMODELS.PRODUCTS;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/b44211d65ea9f8bf67f30034059a1c05.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*_V1ODEaFgmEBgItU-4uAuQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="814a" class="pi lt iq bd lu pj pk pl lx pm pn po ma jw pp jx md jz pq ka mg kc pr kd mj ps bi translated">结论</h1><p id="d637" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">撰写本文的想法是简单快速地回顾一下SQL聚合函数的基础知识。关于这些还有更多值得探索的地方，下面是一些入门资源，</p><ul class=""><li id="6d2e" class="oj ok iq ky b kz la lc ld lf ol lj om ln on lr oo op oq or bi translated"><a class="ae kv" href="https://www.mysqltutorial.org/mysql-sample-database.aspx" rel="noopener ugc nofollow" target="_blank"> MySQL样本数据库</a></li><li id="f12b" class="oj ok iq ky b kz pt lc pu lf pv lj pw ln px lr oo op oq or bi translated"><a class="ae kv" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html" rel="noopener ugc nofollow" target="_blank"> MySQL官方文档</a></li><li id="9b68" class="oj ok iq ky b kz pt lc pu lf pv lj pw ln px lr oo op oq or bi translated"><a class="ae kv" href="https://www.mysqltutorial.org/mysql-aggregate-functions.aspx" rel="noopener ugc nofollow" target="_blank">聚合函数简介</a></li><li id="2373" class="oj ok iq ky b kz pt lc pu lf pv lj pw ln px lr oo op oq or bi translated"><a class="ae kv" href="https://www.hackerrank.com" rel="noopener ugc nofollow" target="_blank"> Hackerrank </a>或<a class="ae kv" href="https://leetcode.com" rel="noopener ugc nofollow" target="_blank"> Leetcode </a>练习基础/中级/高级SQL聚合问题。</li></ul><p id="0e4f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">快乐学习！</p></div></div>    
</body>
</html>