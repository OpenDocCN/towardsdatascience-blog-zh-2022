<html>
<head>
<title>Sudoku smashing solution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数独粉碎解决方案</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sudoku-smashing-solution-470c14ce1143#2022-05-05">https://towardsdatascience.com/sudoku-smashing-solution-470c14ce1143#2022-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4475" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">详尽的数独解决机器人教程:图像和光学字符识别加上文本到语音</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/09a11c9c2521bba35f0b3f8c1355beca.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*jHBMrO_Y9FHH9gr7zG8jBg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">让机器人帮你解决数独(照片由约翰·摩根在T2 Unsplash上拍摄)</p></figure><p id="ab17" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在上一篇文章中，我们创建了一个名为<a class="ae ku" rel="noopener" target="_blank" href="/chatbot-complete-pycharm-app-3517b64075f2">艾萨克</a>(用于管理和分析通信的智能解决方案)的机器人。在这篇文章中，我们将教艾萨克如何玩数独。以撒将有眼睛去看，有手写字，有嘴说话。有了这些技能，艾萨克将能够看着我们的数独游戏，并向我们口头揭示缺失的数字。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/f1b02eab1b9e4db55f77af1b68ebdfd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:182/format:webp/1*MidUJFofLYLAVMmuSbSvUg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">向世界问好，艾萨克！(图片由作者提供)</p></figure><p id="32b5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">数独是从日语单词“suuji wa dokushin ni kagiru”缩写而来，意思是“数字(或数位)必须保持单一”。每个数独游戏由9列和9行组成，其中每列和每行只能包含数字1-9一次。在每个3x3的正方形中，不能有任何重复。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/ea08c52082736957458a0221b44d6862.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*hPncKH0zKMW9V3OdF04_VQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">一个未解数独的例子(图片由作者提供)。</p></figure><p id="5e33" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这篇文章的主要目的是展示如何将机器学习图像识别、光学字符识别(OCR)、文本到语音和Python中的“条件检查问题编码”整合到一个数据产品中。您将在我的Github资源库中找到完整的代码。为了避免信息过载，每个里程碑的细节将在单独的帖子中单独解释(链接将尽快添加)。</p><p id="6f27" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">里程碑:</p><ul class=""><li id="9c06" class="lt lu it kx b ky kz lb lc le lv li lw lm lx lq ly lz ma mb bi translated">使用CV2进行图像识别(在每张图像上查找数独)</li><li id="2c2e" class="lt lu it kx b ky mc lb md le me li mf lm mg lq ly lz ma mb bi translated">使用Tensorflow进行数字识别(在每个数独方块中查找已经输入的数字)</li><li id="15a1" class="lt lu it kx b ky mc lb md le me li mf lm mg lq ly lz ma mb bi translated">数独解决逻辑(条件检查编码)</li><li id="6a97" class="lt lu it kx b ky mc lb md le me li mf lm mg lq ly lz ma mb bi translated">使用gtts进行文本到语音转换</li></ul><p id="1894" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">解决方案:</strong></p><p id="86f6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">除了必不可少的Numpy，Google的<a class="ae ku" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>和<a class="ae ku" href="https://gtts.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> gtts </a>以及<a class="ae ku" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank"> CV2 </a>都是解决我们问题的魔法库。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="353a" class="mm mn it mi b gy mo mp l mq mr">import numpy as np<br/>import cv2<br/>from tensorflow.keras.models import load_model<br/>from gtts import gTTS</span></pre><blockquote class="ms mt mu"><p id="a8ed" class="kv kw mv kx b ky kz ju la lb lc jx ld mw lf lg lh mx lj lk ll my ln lo lp lq im bi translated">如前所述，每个代码模块的详细解释将在以后的文章中给出。在这篇文章中，我们更侧重于理解主要概念和文本到语音的转换。</p></blockquote><p id="98db" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">使用CV2是为了向Isaac展示数独图像。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="3ec6" class="mm mn it mi b gy mo mp l mq mr">picture = cv2.imread("SudokuUnfinished.jpg")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/7230d742aa574bca0178e799936f2c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*hiYt_aVMDiqJ7PcV0m-msg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">艾萨克将筛选这个数独jpg(图片由作者提供)</p></figure><p id="8d84" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">下一步，CV2将首先在图像上发现数独。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="0a12" class="mm mn it mi b gy mo mp l mq mr">def GreatestOutline(outline):<br/>    biggest = np.array([])<br/>    biggestArea = 0<br/>    for i in outline:<br/>        area = cv2.contourArea(i)<br/>        if area &gt; 50:<br/>            peri = cv2.arcLength(i, True)<br/>            approx = cv2.approxPolyDP(i, 0.02 * peri, True)<br/>            if area &gt; biggestArea and len(approx) == 4:<br/>                biggest = approx<br/>                biggestArea = area<br/>    return biggest,biggestArea</span></pre><p id="d6c6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">图像上最大的轮廓应该是数独。数独将进一步被分成9*9个方块。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="17cb" class="mm mn it mi b gy mo mp l mq mr">def SplitBoxes(picture): <br/>    rows = np.vsplit(picture,9)<br/>    boxes=[]<br/>    for r in rows:<br/>        column= np.hsplit(r,9)<br/>        for box in column:<br/>            boxes.append(box)<br/>    return boxes<br/>boxes = SplitBoxes(warpColored)</span></pre><p id="5f83" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">然后将使用Tensorflow检查每个方块中已经输入的数字。每个找到的数字将与先前训练的模型进行比较。如果该数字至少与模型预期的80%匹配匹配，则该数字将被采用。否则方块将被认为是空的，因此将被视为零(记住，数独中不存在0)。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="8581" class="mm mn it mi b gy mo mp l mq mr">def RecPrediction(boxes,model):<br/>    result = []<br/>    for image in boxes:<br/>        picture = np.asarray(image)<br/>        picture = picture[4:picture.shape[0] - 4, 4:picture.shape[1] -4]<br/>        picture = cv2.resize(picture, (28, 28))<br/>        picture = picture / 255<br/>        picture = picture.reshape(1, 28, 28, 1)<br/>        predictions = model.predict(picture)<br/>        classIndex = model.predict_classes(picture)<br/>        probabilityValue = np.amax(predictions)<br/>        if probabilityValue &gt; 0.8: <br/>            result.append(classIndex[0])<br/>        else:<br/>            result.append(0) <br/>    return result<br/>numbers = RecPrediction(boxes, model)</span></pre><p id="5b46" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Isaac现在知道了当前填充的数独状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/b401d58898e0fdb77a4632f470dd0a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*SWjwrmuN4Xo3flnPOPj-kQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">在第0行第0列，Isaac可以看到数字6已被输入(图片由作者提供)</p></figure><p id="0e33" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们检查一下是否正确。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="8d9b" class="mm mn it mi b gy mo mp l mq mr">textfile = open("SudokuInput.txt", "w") <br/>for element in numbers:<br/>    textfile.write(str(element))<br/>textfile.close()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/621a171c9295dd08148a109f22aca5ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emOEp73sk_zCBDGjnxKWew.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">0表示该字段没有可用的数字</p></figure><p id="9650" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">将Isaac的输出与数独图像进行比较，我们看到Isaac是正确的。但是格式不太方便阅读，所以我们会在每个9位数后添加新行:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="a000" class="mm mn it mi b gy mo mp l mq mr">textfiles = open("SudokuInput.txt", "r")<br/>data = textfiles.read()<br/>my_str = str(data)<br/>group = 9<br/>char = "\n"<br/>hallo =char.join(my_str[i:i + group] for i in range(0, len(my_str), group))<br/>textfile = open("SudokuRev.txt", "w")<br/>for element in hallo:<br/>    textfile.write(str(element))<br/>textfiles.close()<br/>textfile.close()</span></pre><p id="3905" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这最终看起来更像数独游戏:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/e7dd91780fe2a7a7ce386135dbc68c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:252/format:webp/1*vAvUQQH71KK-qP1Zh6sf7g.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">SudokuRev.txt(图片作者提供)</p></figure><p id="b33f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">知道了现有的数字，我们现在必须教艾萨克如何正确地玩数独。这将是显式编码部分。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="2dee" class="mm mn it mi b gy mo mp l mq mr">class Sudoku:<br/>    def __init__(self, variables, areas, condition):<br/>        self.variables = variables<br/>        self.areas = areas<br/>        self.condition = condition #...explanation details to follow</span></pre><p id="d99e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">既然艾萨克知道怎么玩了，那我们就来试试吧。让我们看看艾萨克输入的缺失数字:</p><p id="be55" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi">6 1 5 8 3 4 7 9 2 |2 4 7 5 1 9 8 6 3 |9 8 3 7 6 2 4 1 5 |3 2 1 6 7 5 9 4 8 |5 6 4 9 8 3 2 7 1 |8 7 9 2 4 1 3 5 6 |4 5 6 3 2 7 1 8 9 |1 9 2 4 5 8 6 3 7 |7 3 8 1 9 6 5 24</p><p id="3415" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">干得好，艾萨克！缺失的数字已按正确的顺序正确填写。</p><p id="ce1d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">我为我热爱数独的奶奶创造了这个解决方案。不幸的是，她更喜欢听结果(而不是在她的小电脑屏幕上查看结果)。所以艾萨克必须学会说话。多亏了谷歌的gtts，这相当简单明了。在简单的英语中，我们通过在每个数字后添加一个空格来拆分结果字符串。也就是说，所以以撒说的是“一”、“二”、“三”，而不是“一百二十三”。否则将很难遵循数独的正确数字顺序。</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="0c4c" class="mm mn it mi b gy mo mp l mq mr">voice_texts = ""<br/>for line in range(0, 9):<br/>    voice_texts += '|'<br/>    for column in range(0, 9):<br/>        if (line, column) in assignment:<br/>            voice_texts += str(assignment[(line, column)])<br/>        else:<br/>            voice_texts += ''<br/>        voice_texts += ' '<br/>print(voice_texts)<br/>voice_text = ""<br/>for i in voice_texts.split(): <br/>    voice_text += i + ' '<br/>voice_text = voice_text[:-1]<br/>voice_text ="Hi, this is Isaac telling you your Sudoku numbers"+voice_text<br/>tts = gTTS(voice_text)<br/>tts.save("IsaacReadsYourSudokuSolution.mp3")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/76d35a0f341d89728dc12c3b63191261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*oi-1BR6A2sKcAUSR-zezfg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">文本到语音转换保存mp3音频文件(图片由作者提供)</p></figure><p id="97a5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">恭喜:</strong></p><p id="f1c9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">你教艾萨克筛选数独并告诉你答案。在以后的文章中，我们将学习如何将Isaac与Flask一起部署为一个web可访问的应用程序。作为更进一步，我们将建立一个Android应用程序。所以你可以上传一张照片给艾萨克，让他马上在你的智能手机上告诉你答案。我们还将在未来挑战Isaac，看看他是否能够解决比数独更困难的现实生活难题:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/7699aef9c9bf5477921b6496f037d8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*n3vdcEUebC4uL20HGyAX3w.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">我认为这可能不是世界上最严肃的丹麦广告</p></figure><p id="ef32" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">非常感谢您的阅读！希望这篇文章对你有帮助。请随时在<a class="ae ku" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ku" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ku" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室</a>与我联系。</p><div class="nj nk gp gr nl nm"><a href="https://jesko-rehberg.medium.com/membership" rel="noopener follow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">通过我的推荐链接加入Medium-Jesko Rehberg</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">阅读杰斯科·雷伯格(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">jesko-rehberg.medium.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ko nm"/></div></div></a></div><p id="a03f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">你可以在我的<a class="ae ku" href="https://github.com/DAR-DatenanalyseRehberg/Sudoku" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到完整的代码。请随时在<a class="ae ku" href="https://de.linkedin.com/in/jesko-rehberg-40653883" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ku" href="https://twitter.com/DAR_Analytics" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae ku" href="https://jesko-rehberg.medium.com/virtual-reality-vr-for-education-a532aa5b6272" rel="noopener">工作室(有或没有虚拟现实)</a>与我联系。</p></div></div>    
</body>
</html>