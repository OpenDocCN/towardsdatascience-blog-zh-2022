<html>
<head>
<title>Boost Your ML Team’s Productivity with Container-Based Development in the Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">借助云中基于容器的开发，提高您的 ML 团队的生产力</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/boost-your-ml-teams-productivity-with-container-based-development-in-the-cloud-56aa35552776#2022-12-16">https://towardsdatascience.com/boost-your-ml-teams-productivity-with-container-based-development-in-the-cloud-56aa35552776#2022-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3693" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在 SageMaker 上运行容器中 VS 代码的简单方法</h2></div><p id="8c28" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今年早些时候，我在 SageMaker 上发布了两个托管代码服务器的指南(<a class="ae lb" href="https://medium.com/towards-data-science/hosting-vs-code-in-sagemaker-studio-f211385e25f7" rel="noopener">这里</a>，和<a class="ae lb" href="https://aws.amazon.com/blogs/machine-learning/host-code-server-on-amazon-sagemaker/" rel="noopener ugc nofollow" target="_blank">这里</a>)。它展示了如何在可扩展的云计算上运行 VS 代码，以及从任何地方运行代码，而不用担心本地设置。你所需要的只是一个互联网连接。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/0fb3aa7822a6f440dea4464b1c4bbefe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*fz7Y4jj45PN-apfAQ6TA6w.jpeg"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">由作者创建的图像:使用稳定扩散创建</p></figure><p id="49c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将更进一步，展示如何在云中进行基于容器的开发，以加速您的 ML 项目交付。</p><p id="4d0e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将从 Dockerhub 中提取一个示例 python 3.10 容器映像，并在 SageMaker 上使用 VS 代码进行开发。您将需要访问一个<a class="ae lb" href="https://www.youtube.com/watch?v=X5CLunIzj3U" rel="noopener ugc nofollow" target="_blank"> SageMaker 笔记本实例</a>来浏览这个例子。一小杯应该够了。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="81c3" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">为什么云中基于容器的开发有助于简化您的 ML 项目？</h1><p id="54a9" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">使用基于容器的开发，您可以在容器中编写、执行和测试 ML 代码。这意味着您可以像您的团队成员一样使用相同的库和依赖项，通过一致且高度可重复的开发环境使协作变得更加容易。</p><p id="8280" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个优势是，您可以在一个与您的生产环境行为完全相同的环境中开发和测试您的代码，这有助于在您的项目中更快地从 0 移动到 1。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/8529305bfcb09c165fae5278524b4042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q3XCmXIEr5Tv2oOBc5yCJg.jpeg"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@disruptxn?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Desola Lanre-Ologun </a>在<a class="ae lb" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="76bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在 SageMaker 上托管代码服务器对 VS 代码的本地开发体验做了最小的改动，允许你在任何地方，在可扩展的云计算上编码。</p><h2 id="0cc8" class="mx lw iq bd lx my mz dn mb na nb dp mf ko nc nd mh ks ne nf mj kw ng nh ml ni bi translated">“但我认为 VS 代码是开源的”</h2><p id="d5d2" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">通常对于 VS 代码，你会使用<a class="ae lb" href="https://code.visualstudio.com/docs/devcontainers/containers" rel="noopener ugc nofollow" target="_blank">Dev Containers 扩展</a>来进行基于容器的开发。但是，您不能将它用于 code-server，也不能用于任何其他开源 VS 代码项目。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nj"><img src="../Images/12d311086fcadd94bcf32bb43e6c481f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QimnT9rDTBQGZ4V0h-_9cg.jpeg"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@cookiethepom?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Cookie Pom</a>在<a class="ae lb" href="https://unsplash.com/s/photos/frustration?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="78e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然 VS 代码的核心是开源的，但是微软发布的 marketplace 和许多扩展却不是。微软<a class="ae lb" href="https://cdn.vsassets.io/v/M146_20190123.39/_content/Microsoft-Visual-Studio-Marketplace-Terms-of-Use.pdf" rel="noopener ugc nofollow" target="_blank">禁止</a>使用任何非微软 VS 代码访问他们的市场。更多详情，参见<a class="ae lb" href="https://github.com/coder/code-server/blob/v3.4.1/doc/FAQ.md#differences-compared-to-vs-code" rel="noopener ugc nofollow" target="_blank">与 VS 代码</a>的差异。</p><p id="cacd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么我们如何在 SageMaker 上用 VS 代码进行基于容器的开发呢？</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="575c" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">VS 容器中的代码，托管在 SageMaker 上</h1><p id="95c5" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">因此，由于微软扩展许可问题，我们不能将容器带到 IDE 中。但是如果我们把 IDE 放到容器中呢？事实上，code-server 是基于 web 的，可以真正在任何地方运行。设置非常简单，只需 3 个步骤:</p><h2 id="4ebc" class="mx lw iq bd lx my mz dn mb na nb dp mf ko nc nd mh ks ne nf mj kw ng nh ml ni bi translated">步骤 1:将代码服务器添加到您现有的 docker 文件中</h2><p id="9bb0" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">您可以用一行代码将 code-server 添加到容器中。下面是一个将它添加到 Dockerhub 的<a class="ae lb" href="https://hub.docker.com/_/python" rel="noopener ugc nofollow" target="_blank"> python 3.10 </a>图像的例子</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nk"><img src="../Images/f3e403a9fb1dae4fe7eb4f53492f08d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvc_PRBVTKMG-m4sJGZGRQ.png"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">作者图片:我在我的笔记本实例中使用一个现有的 Dockerfile 文件，使用 python:3.10</p></figure><p id="c5a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">加一行就是了！</p><figure class="ld le lf lg gt lh"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="f7aa" class="mx lw iq bd lx my mz dn mb na nb dp mf ko nc nd mh ks ne nf mj kw ng nh ml ni bi translated">步骤 2:在笔记本实例上构建并启动容器映像</h2><p id="c6a0" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">通过笔记本实例的 Jupyter/Jupyterlab 启动终端:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nn"><img src="../Images/13afd1f7e113348cf4931d2c7a467d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_vTFxLswTlLoKMbLdsl8EA.png"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">图片作者:如果你用 Jupyter，按钮应该在右上角</p></figure><p id="de96" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，您可以导航到 Dockerfile 文件夹，并使用以下命令在本地构建容器映像:</p><pre class="ld le lf lg gt no np nq bn nr ns bi"><span id="f49d" class="nt lw iq np b be nu nv l nw nx"># BUILD THE CONTAINER IMAGE LOCALLY<br/>docker build -t ide-in-container:latest .</span></pre><p id="e24d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦构建了映像，您就可以使用命令运行容器来启动 code-server:</p><pre class="ld le lf lg gt no np nq bn nr ns bi"><span id="ead0" class="nt lw iq np b be nu nv l nw nx"># RUN CONTAINER WITH VS CODE IN IT<br/>docker run --rm -it -p 8080:8080 ide-in-container:latest code-server --auth none --disable-telemetry --bind-addr 0.0.0.0:8080</span></pre><p id="7120" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过默认端口<code class="fe ny nz oa np b">8080</code>向实例公开代码服务器。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ob"><img src="../Images/30c791131adb02aa25da5ceab06c1d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w329727i55HKvHB0fd1yFg.png"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">Image by author:运行 docker 命令后，您应该会看到以下内容</p></figure><h2 id="8024" class="mx lw iq bd lx my mz dn mb na nb dp mf ko nc nd mh ks ne nf mj kw ng nh ml ni bi translated">步骤 3:通过笔记本实例 Jupyter 代理访问 VS 代码</h2><p id="34e8" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">现在，您需要做的就是复制您的笔记本实例 URL，对其稍作更改，然后将其粘贴到一个新的选项卡中:</p><div class="ld le lf lg gt ab cb"><figure class="oc lh od oe of og oh paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><img src="../Images/c363fa1e708a12aff0ed4b4f7918eed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*lbp6WyyKZcZUVQ-osuuTaA.png"/></div></figure><figure class="oc lh oi oe of og oh paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><img src="../Images/1afa98f61289f6bca0d0e4e49441736c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*oWEBsOR8l9KDtqSoNqTwOA.png"/></div><p class="lk ll gj gh gi lm ln bd b be z dk oj di ok ol translated">作者图片:左边是我的实例原始 URL。我用<code class="fe ny nz oa np b">/proxy/8080/</code>替换了<code class="fe ny nz oa np b">/tree</code>，并将其粘贴到一个新的浏览器标签中。</p></figure></div><p id="e939" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选项卡现在应该打开 VS 代码:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi om"><img src="../Images/9e34cad77b5b08c5414880a5d8e0571f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AACfc395UxYdB8tRZ5qirw.png"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">作者图片:您可以安装 VS 代码的 Python 扩展，并开始在您的 ML 项目中工作！</p></figure><h2 id="87fa" class="mx lw iq bd lx my mz dn mb na nb dp mf ko nc nd mh ks ne nf mj kw ng nh ml ni bi translated"><strong class="ak">注意事项</strong></h2><p id="a8ee" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated"><strong class="kh ir">为了进一步简化您的工作</strong>，您可以挂载本地笔记本实例卷，并将 VS 代码指向您现有的配置(扩展、按键绑定、设置)。在示例<a class="ae lb" href="https://gist.github.com/sofianhamiti/542e9ff6d6dbe72c5178c7bb4c8b1901" rel="noopener ugc nofollow" target="_blank"> Dockerfile </a>中，我将 VS 代码指向实例中已经有的<code class="fe ny nz oa np b">/home/SageMaker/vscode-config</code> config 文件夹。这是使用<code class="fe ny nz oa np b">XDG_DATA_HOME</code>环境变量完成的。</p><p id="1c7d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是将笔记本实例卷装载到容器的方法:</p><pre class="ld le lf lg gt no np nq bn nr ns bi"><span id="1db4" class="nt lw iq np b be nu nv l nw nx"># RUN THIS COMMAND IF YOU WANT TO MOUNT THE NOTEBOOK INSTANCE HOME/SAGEMAKER FOLDER<br/>docker run --rm -it -p 8080:8080 -v /home/ec2-user/SageMaker/:/home/SageMaker ide-in-container:latest code-server --auth none --disable-telemetry --bind-addr 0.0.0.0:8080</span></pre><p id="6a7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">为了改善您的协作</strong>，您可以在您的项目团队 GitHub repo 上添加这个“环境 Dockerfile”。这样，它将被版本化，每个人都可以在任何时候使用完全相同的依赖项。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="70ba" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">结论</h1><p id="10ef" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">使用基于云的 ide 在容器内部进行开发可以帮助简化您的 ML 项目和团队协作，因为它使在一致的环境中运行和测试代码变得容易，并且允许您从任何地方访问该开发环境。</p><p id="6cbe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我和你分享了一个在 Amazon SageMaker 上运行 VS 代码的简单方法。</p><p id="4e9b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">更进一步，您可以访问<a class="ae lb" href="https://medium.com/towards-data-science/5-simple-steps-to-mlops-with-github-actions-mlflow-and-sagemaker-pipelines-19abf951a70" rel="noopener">使用 GitHub Actions、MLflow 和 SageMaker Pipelines 的 MLOps 的 5 个简单步骤</a>，了解您的团队如何使用 GitHub Actions 和 SageMaker 轻松运行端到端 MLOps 项目。</p></div></div>    
</body>
</html>