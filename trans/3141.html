<html>
<head>
<title>Two Quick Code Snippets for Animated Plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">两个动画情节的快速代码片段</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/two-quick-codes-to-animate-your-plots-ecbaa99cd127#2022-07-10">https://towardsdatascience.com/two-quick-codes-to-animate-your-plots-ecbaa99cd127#2022-07-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8e36" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用plotly或gif库在Python中创建动画图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/77e8788dfe2dfb11ce937ca568c48c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uw3IaV-wHnYkMUrLBVTfpg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">艾萨克·史密斯在<a class="ae ky" href="https://unsplash.com/s/photos/line-chart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="3adc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这不是我第一次发表关于数据可视化的文章。这当然是引起我注意的事情。我喜欢在探索新的数据集时可视化数据，因为我相信我们的大脑被设计成从图像中捕捉比从文本或数字中捕捉更多的信息。</p><p id="6650" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我确信不仅仅是我这么想。<a class="ae ky" href="https://news.mit.edu/2014/in-the-blink-of-an-eye-0116" rel="noopener ugc nofollow" target="_blank">麻省理工学院的科学家发现，我们的大脑可以识别13毫秒</a>内看到的图像！你能相信吗？我怀疑文本或数字也能做到这一点。</p><p id="b3af" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">嗯，想想一本杂志。什么最先吸引你的注意力？图片、信息图表还是文字？不过，我会把这个想法留给你。</p><h2 id="46d1" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">愉快的</h2><p id="67d4" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">回到主题，在Python中有很多用于绘制图形的库。Matplotlib、Seaborn、Bokeh、Plotly，等等。我甚至在这里写了一个完整的帖子，关于为什么你应该探索和使用更多plotly express来探索数据，因为它有惊人的交互性。</p><p id="0cc4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">好的，但是我们还能做些什么来使我们的演示更有影响力呢？</p><p id="8172" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我想提出的选项是动画情节。有一点我可以告诉你，他们第一眼就能产生影响。每当我在LinkedIn上看到一个，我都会停下来看看。我认为他们在某些情况下讲故事讲得很好。</p><p id="1a99" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">显然，这是一个受众和要传达的信息的问题。并非每个图形或数据集都适合动画情节。这是你应该为你的项目和报告做的评估。我认为它们对于时间序列来说非常有效。例如，线是如何在几个月内形成的。</p><h2 id="1cd5" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">Plotly Express</h2><p id="901a" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">让我们现在编码。创建动画情节的第一个选项是使用我最喜欢的Python库之一:<em class="na"> Plotly Express </em>。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="12c4" class="mc md it nc b gy ng nh l ni nj">import plotly.express as px<br/>import pandas as pd<br/>import numpy as np</span></pre><p id="1360" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">让我们在数据集中创建一些值。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="aec0" class="mc md it nc b gy ng nh l ni nj"># create dataframe<br/>df = pd.DataFrame( {'week': np.random.randint(1,21, size=200),<br/>'P1': np.random.randint(10,220, size=200),<br/>'P2': np.random.randint(15,200, size=200),<br/>'P3': np.random.randint(10,490, size=200),<br/>'P4': np.random.randint(10,980, size=200) } )</span><span id="739b" class="mc md it nc b gy nk nh l ni nj">df = df.melt(id_vars='week', var_name= 'product', value_vars= df.columns[1:], value_name='sales')<br/>df = df.groupby(['week', 'product']).sales.mean().reset_index()<br/>df = df.sort_values(by=['week', 'product', 'sales'])</span></pre><p id="6131" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，我们可以绘制一个动画条形图来检查每周产品的变化。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="56d2" class="mc md it nc b gy ng nh l ni nj"># Animated graphic</span><span id="931e" class="mc md it nc b gy nk nh l ni nj">fig = px.bar(df, x="product", y="sales", color="product",<br/>animation_frame="week", animation_group="product", range_y=[0,750])<br/>fig.update_layout(height=600, width=800)<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/4da4f3a75fb6fe42f359d926f585ee3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*gok9vYarjQ2uLk_v"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这是你将看到的动画情节。图片由作者提供。</p></figure><p id="c653" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">创建动画散点图也同样容易。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="714f" class="mc md it nc b gy ng nh l ni nj">fig = px.scatter(df, x="week", y="sales", animation_frame="week", animation_group="product", size="sales", color="product", hover_name="product", range_x=[0,20], range_y=[0,800])</span><span id="43dc" class="mc md it nc b gy nk nh l ni nj">fig.update_layout(height=600, width=1000)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/2b15a89d244fe41e85e1c22ada1f5c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*82wl7tp_0uZBgogJ"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用plotly创建的动画散点图。图片由作者提供。</p></figure><h2 id="16d4" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">gif库</h2><p id="556e" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">创建动画情节的第二种方法是使用<code class="fe nm nn no nc b">gif</code>库。这个库所做的是创建一系列的情节，并把它们放在一个帧序列中，创建一个动画gif图像。</p><p id="7f6d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">首先，我们来获取一些时间序列数据进行绘图。我们使用著名的<a class="ae ky" href="https://github.com/mwaskom/seaborn-data/blob/master/flights.csv" rel="noopener ugc nofollow" target="_blank">航空乘客数据集</a>，这是一个我们可以直接从seaborn图书馆获得的开放数据。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="50cc" class="mc md it nc b gy ng nh l ni nj">import seaborn as sns<br/>df = sns.load_dataset('flights')</span></pre><p id="8a72" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">接下来，我们创建一个函数，为每个观察值创建一个图。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="1033" class="mc md it nc b gy ng nh l ni nj"># Create a plot function to create the frames</span><span id="e8f3" class="mc md it nc b gy nk nh l ni nj">@gif.frame<br/>def plot_flights(df, i):<br/>    df = df.copy()<br/>    <strong class="nc iu"># Get the year for the plot title</strong><br/>    yr = df['year'][i]<br/>    <strong class="nc iu"># Force X axis to be entirely plotted at once</strong><br/>    df.iloc[i:] = np.nan<br/>    <strong class="nc iu">#Plot</strong><br/>    ax = df.plot(x='month', y= 'passengers', legend=False, <br/>                 style="o-", figsize=(20,10))<br/>    ax.set_title(f"Air Passengers {yr}", size=20)<br/>    ax.set_xlabel("Months")<br/>    ax.set_ylabel("Number of Passengers")</span></pre><ul class=""><li id="bd6d" class="np nq it li b lj lk lm ln lp nr lt ns lx nt mb nu nv nw nx bi translated"><code class="fe nm nn no nc b">@gif.frame</code>是一个装饰器，由<code class="fe nm nn no nc b">gif</code>库用来创建帧序列。</li><li id="8eab" class="np nq it li b lj ny lm nz lp oa lt ob lx oc mb nu nv nw nx bi translated"><code class="fe nm nn no nc b">df.iloc[i:] = np.nan</code>将所有未来的观测值转换为NA。这是一种编程方式，一次仅绘制一个值(<em class="na"> i=0所有NAs，i=1，仅绘制索引0，i=2，仅绘制0和1…</em>)，并且X轴仍然从一端到另一端绘制，因此在动画过程中不会改变。剧情尺寸会保持不变，更容易观看。</li></ul><p id="944f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们使用函数创建一个循环来创建帧。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="c3b5" class="mc md it nc b gy ng nh l ni nj"># Build the gif "frames"</span><span id="b262" class="mc md it nc b gy nk nh l ni nj">frames = []<br/>for i in range(df.shape[0]):<br/>    frame = plot_flights(df, i)<br/>    frames.append(frame)</span></pre><p id="12a7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最后，保存生成的GIF图像。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="c9d0" class="mc md it nc b gy ng nh l ni nj"># Choose the duration between frames (milliseconds) and save to file:</span><span id="b9c8" class="mc md it nc b gy nk nh l ni nj">gif.save(frames, 'gif_example.gif', duration=180)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/03bcfdb7b671958faaf3cc6f9d3915cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-g6iepIedX5Joq7BzTLgsA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用gif库绘制的航空乘客时间序列。图片由作者提供。</p></figure><h2 id="8202" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">在你走之前</h2><p id="894b" class="pw-post-body-paragraph lg lh it li b lj mv ju ll lm mw jx lo lp mx lr ls lt my lv lw lx mz lz ma mb im bi translated">动画情节是一个好的演示文稿的有效资源。就像我们在这里展示的，时间序列，条形图和散点图很容易创建。</p><p id="e715" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">然而，并不是所有的情节都适合被动画化。你应该知道使用动画的最佳情况。并不是所有的公众都会喜欢这样，因为动画图形并不是深入分析的最佳选择，例如，当你需要一个静态图像来观察、比较和理解时。</p><p id="9a81" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">要创建动画线条图，我建议你使用<code class="fe nm nn no nc b">gif</code>库，因为对于这种图形类型，它似乎比plotly更容易编码。如果您查看文档，您会发现动画线图需要使用dash模块进行更多的编码。另一方面，对于条形图和散点图，gor对于<code class="fe nm nn no nc b">plotly.express</code>来说毫无疑问。</p><h2 id="622d" class="mc md it bd me mf mg dn mh mi mj dp mk lp ml mm mn lt mo mp mq lx mr ms mt mu bi translated">参考</h2><div class="oe of gp gr og oh"><a href="https://plotly.com/python/animations/" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">介绍</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">动画人物与Plotly表达几个Plotly表达功能支持创建动画人物通过…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">plotly.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div><div class="oe of gp gr og oh"><a rel="noopener follow" target="_blank" href="/a-simple-way-to-turn-your-plots-into-gifs-in-python-f6ea4435ed3c"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">用Python把你的图转换成gif的简单方法</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">用动画情节打动你的观众</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">towardsdatascience.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov ks oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://pypi.org/project/gif/" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">可交换的图像格式</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">matplotlib动画扩展</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">pypi.org</p></div></div><div class="oq l"><div class="ox l os ot ou oq ov ks oh"/></div></div></a></div><p id="d57e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果这些内容对你有用，请关注我的博客。</p><div class="oe of gp gr og oh"><a href="https://gustavorsantos.medium.com/" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">古斯塔沃·桑托斯-中等</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">阅读古斯塔夫·桑托斯在媒介上的作品。数据科学家。我从数据中提取见解，以帮助个人和公司…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">gustavorsantos.medium.com</p></div></div><div class="oq l"><div class="oy l os ot ou oq ov ks oh"/></div></div></a></div><p id="8016" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果你想阅读大量的好内容，可以考虑订阅Medium。您可以使用此<a class="ae ky" href="https://gustavorsantos.medium.com/" rel="noopener">推荐代码</a>。</p></div></div>    
</body>
</html>