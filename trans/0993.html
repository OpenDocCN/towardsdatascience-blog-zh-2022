<html>
<head>
<title>The Unofficial PyTorch Optimization Loop Song</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">非官方 PyTorch 优化循环歌曲</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-unofficial-pytorch-optimization-loop-song-89657dd3a434#2022-03-15">https://towardsdatascience.com/the-unofficial-pytorch-optimization-loop-song-89657dd3a434#2022-03-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8b52" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一首有趣的顺口溜，帮助你记住 PyTorch 训练循环中的步骤</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a221c2eda23a1615a0272ca44c50e6a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4EamQtHILwzCScnSpbxtYw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个教程都需要一首歌。</p></figure><p id="8d8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我一直在学 PyTorch。</p><p id="c4e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您也在学习 PyTorch，但来自 Scikit-Learn 或 TensorFlow 等框架，编写自己的训练和测试循环可能是一个陌生的概念(这两个框架都有一个漂亮的<code class="fe lu lv lw lx b">model.fit()</code>系统)。</p><p id="0472" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了帮助自己学习，我写了一首顺口溜。</p><p id="ffb6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以我永远不会忘记 T2。</p><p id="2676" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在 YouTube 上看到<a class="ae lz" href="https://youtu.be/Nutpusq_AFw" rel="noopener ugc nofollow" target="_blank">我唱这首歌的视频版本。</a></p><p id="4285" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">托奇，放音乐！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ma mb l"/></div></figure><h1 id="d080" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是优化循环？</h1><p id="a514" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">在说歌词之前，先定义一下我说的优化循环(或者训练循环)是什么意思。</p><p id="89b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 PyTorch 或一般的机器学习中，<strong class="la iu">优化循环</strong>遍历数据集，目标是<strong class="la iu">训练</strong>模型(通常是神经网络)学习数据集中的模式。</p><p id="0d53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该模型通过结合前向传播(前向传递，数据通过模型)、<strong class="la iu">后向传播</strong>(后向传递，通过模型返回)和<strong class="la iu">梯度下降</strong>来更新其内部数字(权重)，从而进行学习(请参阅参考资料一节中关于这两者的更多信息)。</p><p id="6c92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">测试循环</strong>的目标是评估模型在<strong class="la iu">训练循环</strong>中学习的模式。</p><h1 id="fab0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">抒情诗</h1><blockquote class="mz"><p id="abdf" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">我们训练吧！</p><p id="0fd1" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">对于一个范围内的一个时期</p><p id="84d9" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">呼叫模型点火车</p><p id="a841" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">向前传球</p><p id="176a" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">计算损失</p><p id="e370" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">优化零梯度</p><p id="1777" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">向后丢失</p><p id="6f38" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">优化器步骤步骤步骤</p><p id="eb0e" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">考试时间！</p><p id="791b" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">调用模型点评估</p><p id="3f9d" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">在火炬推断模式下，</p><p id="d826" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">向前传球</p><p id="7137" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">计算损失</p><p id="b16b" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">打印出发生了什么</p><p id="3b92" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">让我们再做一次‘增益’增益</p><p id="18e3" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">另一个时代</p><p id="d9c1" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">呼叫模型点火车</p><p id="e2c1" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">向前传球</p><p id="4c98" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">计算损失</p><p id="b25e" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">优化零梯度</p><p id="8326" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">向后丢失</p><p id="a3d9" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">优化器步骤步骤步骤</p><p id="b3d6" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">考试时间！</p><p id="bf1f" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">调用模型点评估</p><p id="2008" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">在火炬推断模式下，</p><p id="84b9" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">向前传球</p><p id="964f" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">计算损失</p><p id="bf27" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">打印出发生了什么</p><p id="0dc0" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">如果你想的话，继续走</p><p id="ed74" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">但是不要忘记拯救拯救拯救</p></blockquote><h1 id="af17" class="mc md it bd me mf mg mh mi mj mk ml mm jz nj ka mo kc nk kd mq kf nl kg ms mt bi translated">解释歌词</h1><p id="115b" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">歌词描述了训练循环中发生的事情(向前传递<strong class="la iu">训练数据</strong>，损失计算，将优化器梯度归零，通过步进优化器执行反向传播和梯度下降)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/682251f1f9b056ed725b3fc980ca9b4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wkUFMiyeSzaqP83h.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PyTorch 训练循环的步骤。来源:<a class="ae lz" href="https://www.learnpytorch.io/01_pytorch_workflow/#pytorch-training-loop" rel="noopener ugc nofollow" target="_blank">学习 PyTorch 用于深度学习的书第 01 章</a>。</p></figure><p id="70a9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以及测试循环中发生的情况(正向传递，对<strong class="la iu">测试数据</strong>的损失计算——模型从未见过的数据)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/5287461d46b39f810663289be73c87c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3UqTcl3D64_YWiHh.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PyTorch 测试循环中的步骤(注意没有通过<code class="fe lu lv lw lx b">loss.backward()</code>的反向传播，也没有通过<code class="fe lu lv lw lx b">optimizer.step()</code>的梯度下降，这是因为评估/测试/做出推断不需要这两个步骤)。来源:<a class="ae lz" href="https://www.learnpytorch.io/01_pytorch_workflow/#pytorch-training-loop" rel="noopener ugc nofollow" target="_blank">学习深度学习 PyTorch 书籍第 01 章</a>。</p></figure><p id="3c58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它们被称为循环，因为它们遍历数据中的各种样本(训练集和测试集)。</p><p id="4046" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为这是机器学习模型的全部思想，查看数据样本并执行数值计算以找到数据中的模式。</p><p id="f126" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就订单而言，在计算损失之前，您需要执行正向传递。</p><p id="fb83" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在进入优化器(<code class="fe lu lv lw lx b">optimizer.step()</code>)和执行梯度下降之前，您可能想要执行反向传播(<code class="fe lu lv lw lx b">loss.backward()</code>)。</p><p id="408c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">损失衡量模型的错误程度，越低越好。</p><p id="6064" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">优化器告诉模型如何更新其学习的模式，以改善损失。</p><h1 id="1b44" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">制作培训和测试功能</h1><p id="8373" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">当然，您可以将上面的代码函数化。</p><p id="ac20" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你应该这么做。</p><p id="2d69" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它可以防止你发疯和学这样的顺口溜。</p><p id="8f67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是你只需要学一次。</p><p id="beaf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后将上面的代码函数化。</p><p id="09a9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">并利用它再次‘增益’增益。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/bd41d99352a410643cba54801ee28902.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MfuZbG340lbpcE5P.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不需要记住所有的步骤，您可以将训练和测试循环步骤函数化(在编码一两次之后)，这样您就可以在不同的项目和数据集上重用它们。</p></figure><h1 id="c6c2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">材料和资源</h1><p id="9c79" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">这首歌来自于寻找一种记忆和教授 PyTorch 优化循环中的步骤的方法。</p><p id="bbe9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">许多学习 PyTorch 的资源从未真正讨论过每一步或步骤的顺序。</p><p id="39b8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以我自己做了。</p><ul class=""><li id="04af" class="nn no it la b lb lc le lf lh np ll nq lp nr lt ns nt nu nv bi translated"><a class="ae lz" href="https://github.com/mrdbourke/pytorch-deep-learning" rel="noopener ugc nofollow" target="_blank">学习深度学习 GitHub 的 PyTorch</a>—学习 py torch 代码的资源——首先从基础开始。</li><li id="85e1" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><a class="ae lz" href="https://www.learnpytorch.io/" rel="noopener ugc nofollow" target="_blank">Learn py torch for Deep Learning Book</a>—以上代码资料的在线书籍版本(更多章节即将推出)。</li><li id="244b" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated"><a class="ae lz" href="https://colab.research.google.com/drive/1DLKoq8v1A6glr8yc4hrp_VTqfQGzGyaF?usp=sharing" rel="noopener ugc nofollow" target="_blank">编写上述广告歌的代码</a>——py torch 代码的一个小功能版本，用于编写广告歌。</li></ul><p id="68f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使神经网络能够学习的两个主要算法是反向传播和梯度下降。</p><p id="1533" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PyTorch 实现了幕后人员的机制。</p><p id="05a6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是如果你想了解每一个，我推荐以下内容:</p><ul class=""><li id="b0d3" class="nn no it la b lb lc le lf lh np ll nq lp nr lt ns nt nu nv bi translated"><a class="ae lz" href="https://youtu.be/IHZwWFHWa-w" rel="noopener ugc nofollow" target="_blank">梯度下降，神经网络如何学习</a>视频由 3blue1brown</li><li id="74b3" class="nn no it la b lb nw le nx lh ny ll nz lp oa lt ns nt nu nv bi translated">反向传播到底在做什么？视频由 3blue1brown 制作</li></ul><p id="7881" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">PS 你可能已经猜到了，这首歌并没有得到 PyTorch 的认可，我只是为了好玩才创作的，因此<em class="ly">是非官方的。</em></p></div></div>    
</body>
</html>