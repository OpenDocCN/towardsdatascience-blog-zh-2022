<html>
<head>
<title>Hypothesis and Pandera: Generate Synthesis Pandas DataFrame for Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">假设和潘德拉:生成用于测试的综合熊猫数据框架</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hypothesis-and-pandera-generate-synthesis-pandas-dataframe-for-testing-e5673c7bec2e#2022-09-16">https://towardsdatascience.com/hypothesis-and-pandera-generate-synthesis-pandas-dataframe-for-testing-e5673c7bec2e#2022-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1bac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用基于属性的测试创建干净和健壮的测试</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e8f05bba246dca8635c5471f14c1372e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MyFoGgn21aamg4JFMPHqZg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="15ce" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">动机</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="0564" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">假设您正在试图判断函数<code class="fe mo mp mq mr b">processing_fn</code>是否正常工作。您使用pytest通过一个示例来测试该函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms lr l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms lr l"/></div></figure><p id="fe7b" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">测试通过了，但是你知道一个例子是不够的。您需要使用更多的示例来测试该函数，以确保该函数可以正常处理任何数据。</p><p id="7253" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">为此，您可以使用pytest parameterize，但是很难找出每个可能导致失败的示例。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms lr l"/></div></figure><p id="7b13" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">即使你花时间去写所有的例子，你也要花很长时间去运行所有的测试。</p><p id="c57f" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果有一种测试策略可以让您:</p><ul class=""><li id="50d2" class="mt mu it lu b lv lw ly lz mb mv mf mw mj mx mn my mz na nb bi translated">轻松编写测试</li><li id="5144" class="mt mu it lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">为测试生成良好的数据</li><li id="5da3" class="mt mu it lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">快速检测伪造示例</li><li id="445d" class="mt mu it lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">制作简单明了的测试</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/9b6a527cb8c81f5e72dd4bf1cbb86452.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ehkYkD1wmTf7HKvEHl1kNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f633" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">这就是假说和潘德拉派上用场的时候。</p><h1 id="feef" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">潘德拉是什么？</h1><p id="c928" class="pw-post-body-paragraph ls lt it lu b lv ni ju lx ly nj jx ma mb nk md me mf nl mh mi mj nm ml mm mn im bi translated">Pandera是一个简单的Python库，用于验证熊猫数据帧。</p><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/validate-your-pandas-dataframe-with-pandera-2995910e564"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">用Pandera验证你的熊猫数据框架</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">确保您的数据符合您的期望</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div><p id="e3a5" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">要安装Pandera，请键入:</p><pre class="kj kk kl km gt og mr oh oi aw oj bi"><span id="9057" class="ok kz it mr b gy ol om l on oo">pip install pandera</span></pre><h1 id="d9ea" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">什么是假设？</h1><p id="370d" class="pw-post-body-paragraph ls lt it lu b lv ni ju lx ly nj jx ma mb nk md me mf nl mh mi mj nm ml mm mn im bi translated"><a class="ae nn" href="https://github.com/HypothesisWorks/hypothesis" rel="noopener ugc nofollow" target="_blank"> Hypothesis </a>是一个灵活易用的基于属性的测试库。</p><p id="24c7" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">基于实例的测试使用具体的实例和具体的预期输出。基于属性的测试将这些具体的例子归纳为基本的特征。</p><p id="4e0a" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">因此，基于属性的测试允许您编写更清晰的测试，并更好地指定代码的行为。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/bfa4d6dbb2b79e37bb0b7503f4e99a16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nhJKsZmDBRp7bbCZzMsNGQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="89af" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">要安装假设，请键入:</p><pre class="kj kk kl km gt og mr oh oi aw oj bi"><span id="3c99" class="ok kz it mr b gy ol om l on oo">pip install hypothesis</span></pre><p id="c180" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">本文将向您展示如何使用这两个工具来生成用于测试的合成熊猫数据帧。</p><h1 id="328a" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">Pandera —检查函数的输出</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="3257" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">首先，我们将使用Pandera来测试当给定<strong class="lu iu">一个输入</strong>时，函数的<strong class="lu iu">输出是否满足某些约束</strong>。</p><p id="3cfb" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">在下面的代码中，我们:</p><ul class=""><li id="2c14" class="mt mu it lu b lv lw ly lz mb mv mf mw mj mx mn my mz na nb bi translated">使用<code class="fe mo mp mq mr b">pandera.DataFrameSchema</code>为输出指定一些约束，比如列的数据类型和值的范围。</li><li id="0c81" class="mt mu it lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">使用<code class="fe mo mp mq mr b">pandera.check_output</code>装饰器来测试函数的输出是否满足约束。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms lr l"/></div></figure><p id="df41" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">因为运行这段代码时没有错误，所以输出是有效的。</p><h1 id="2824" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">假设—创建测试示例</h1><p id="4f71" class="pw-post-body-paragraph ls lt it lu b lv ni ju lx ly nj jx ma mb nk md me mf nl mh mi mj nm ml mm mn im bi translated">接下来，我们将根据<code class="fe mo mp mq mr b">pandera.DataFrameSchema</code>给出的约束，使用假设<strong class="lu iu">创建用于测试</strong>的数据。</p><p id="a7dd" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">具体来说，我们将补充:</p><ul class=""><li id="c97a" class="mt mu it lu b lv lw ly lz mb mv mf mw mj mx mn my mz na nb bi translated"><code class="fe mo mp mq mr b">schema.strategy(size=5)</code>指定描述如何生成和简化数据的搜索策略</li><li id="ec0b" class="mt mu it lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated"><code class="fe mo mp mq mr b">@given</code>在指定策略的大范围匹配数据上运行测试功能</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms lr l"/></div></figure><p id="3dda" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">使用pytest运行测试:</p><pre class="kj kk kl km gt og mr oh oi aw oj bi"><span id="bb49" class="ok kz it mr b gy ol om l on oo">pytest test4.py</span></pre><p id="d386" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">输出:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms lr l"/></div></figure><p id="0ddd" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们在不到2秒的时间里发现了一个伪造的例子！输出也很简单。例如，不要选择如下可能导致错误的示例:</p><pre class="kj kk kl km gt og mr oh oi aw oj bi"><span id="a32a" class="ok kz it mr b gy ol om l on oo">      val1  val2<br/>0     1    2<br/>1     2    1<br/>2     3    0<br/>3     4    0<br/>4     5    1</span></pre><p id="3b20" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">假设选择了一个更简单易懂的例子:</p><pre class="kj kk kl km gt og mr oh oi aw oj bi"><span id="377d" class="ok kz it mr b gy ol om l on oo">      val1  val2<br/>0     0    0<br/>1     0    0<br/>2     0    0<br/>3     0    0<br/>4     0    0</span></pre><p id="a375" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">这很酷，因为:</p><ul class=""><li id="bde9" class="mt mu it lu b lv lw ly lz mb mv mf mw mj mx mn my mz na nb bi translated">我们不需要列举任何具体的例子。</li><li id="91a6" class="mt mu it lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">这些例子非常直观，足以让我们快速理解被测试函数的行为。</li><li id="3d55" class="mt mu it lu b lv nc ly nd mb ne mf nf mj ng mn my mz na nb bi translated">我们在短时间内找到了伪造的例子。</li></ul><h1 id="3d25" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="a25a" class="pw-post-body-paragraph ls lt it lu b lv ni ju lx ly nj jx ma mb nk md me mf nl mh mi mj nm ml mm mn im bi translated">恭喜你！您刚刚学习了如何使用Pandera和Hypothesis来生成用于测试的综合数据。我希望这篇文章能够为您提供为Python函数创建健壮和干净的测试所需的知识。</p><p id="a81d" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">随意发挥，并在这里叉这篇文章的源代码:</p><div class="no np gp gr nq nr"><a href="https://github.com/khuyentran1401/Data-science/tree/master/data_science_tools/pandera_hypothesis" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">数据科学/数据科学工具/pandera假设1401/数据科学</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">有用的数据科学主题以及代码和文章的集合…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="oq l oc od oe oa of ks nr"/></div></div></a></div></div><div class="ab cl or os hx ot" role="separator"><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow"/></div><div class="im in io ip iq"><p id="d884" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的数据科学工具。你可以通过<a class="ae nn" href="https://www.linkedin.com/in/khuyen-tran-1401/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae nn" href="https://twitter.com/KhuyenTran16" rel="noopener ugc nofollow" target="_blank"> Twitter </a>与我联系。</p><p id="6044" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在Medium上关注我，了解我的最新数据科学文章，例如:</p><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/detect-defects-in-a-data-pipeline-early-with-validation-and-notifications-83e9b652e65a"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">通过验证和通知尽早检测数据管道中的缺陷</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">使用深度检查和提督在Python中构建健壮的数据管道</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="oy l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/how-to-create-fake-data-with-faker-a835e5b7a9d9"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">如何用Faker创建假数据</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">您可以收集数据或创建自己的数据</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="oz l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/pytest-for-data-scientists-2990319e55e6"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">数据科学家Pytest</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">适用于您的数据科学项目的Pytest综合指南</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="pa l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://pub.towardsai.net/github-actions-in-mlops-automatically-check-and-deploy-your-ml-model-9a281d7f3c84" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">MLOps中的GitHub动作:自动检查和部署您的ML模型</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">使用GitHub动作自动化您的ML管道</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">pub.towardsai.net</p></div></div><div class="oa l"><div class="pb l oc od oe oa of ks nr"/></div></div></a></div></div></div>    
</body>
</html>