<html>
<head>
<title>AWS Essentials for Data Science: Storage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS数据科学基础:存储</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/aws-essentials-for-data-science-storage-5755afc3cb4a#2022-08-22">https://towardsdatascience.com/aws-essentials-for-data-science-storage-5755afc3cb4a#2022-08-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8c81" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解和部署S3、RDS和DynamoDB服务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3d0d297183b087251ee73571e171d3b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0V5FR2cz-CqV4YGZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">科技日报在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae ky" href="https://unsplash.com/@techdailyca?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="b459" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会把你的音乐、视频和个人文件存放在满是硬盘的车库里吗？我敢打赌……不会。除非你在过去的15年里避开了<a class="ae ky" href="https://www.apple.com/icloud/" rel="noopener ugc nofollow" target="_blank"> iCloud </a>、<a class="ae ky" href="https://www.dropbox.com/" rel="noopener ugc nofollow" target="_blank"> Dropbox </a>和<a class="ae ky" href="https://www.google.com/drive/" rel="noopener ugc nofollow" target="_blank">Google Drive</a>——如果你避开了，那就恭喜你！那么你很可能使用<strong class="lb iu">云存储</strong>。如果你丢失了手机，你可以找回你的短信；可以用链接分享文件，而不是海量的邮件附件；您可以按照片中的人来整理和搜索照片。</p><p id="c67e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是这些好处也延伸到了职业领域。如果你开了一家分享数据的公司，比如说，以低廉的月租费分享数以千计的4K电影和电视剧(😛)—您会希望将这些数据存储在云服务器上。当你关闭笔记本电脑时，云服务器不会关闭，你也不必担心邪恶的用户获取你的私人数据。</p><p id="9dbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么如何才能设置云存储呢？哪种存储类型最适合我们的数据？我们如何从代码中直接与云存储交互，而不需要在UI中点击？</p><p id="24ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本帖将回答这些问题。在展示如何在<strong class="lb iu"> Amazon Web Services (AWS) </strong>中有效地存储<a class="ae ky" href="https://en.wikipedia.org/wiki/Binary_large_object" rel="noopener ugc nofollow" target="_blank">blob</a>、表格数据和JSONs之前，我们将设置我们的软件环境。(关于云行业的一般介绍，请查看<a class="ae ky" rel="noopener" target="_blank" href="/aws-essentials-for-data-science-why-cloud-computing-141cc6cee284">上一篇文章</a>。)请继续关注关于云计算的另一个主要产品<em class="lv"> compute </em>的后续文章。</p><h1 id="ae0d" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">背景</h1><h2 id="33ad" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">为什么选择云存储？</h2><p id="ce63" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">当你独自做一个小项目时，你可能不会过多考虑数据存储。也许你在Jupyter笔记本或R脚本的同一个文件夹中有几个CSV。希望所有东西都备份到硬盘上了。</p><p id="edde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，当您想在项目中添加人员时，会发生什么情况呢？轮流使用笔记本电脑没有意义。您可以将数据复制到他们的笔记本电脑上，但是如果数据太多，队友的电脑装不下怎么办？一旦这项工作开始，同步数据集之间的变化将是一个令人头痛的问题。马上交出所有数据也是一种很大的信任——如果这个新人离开了，带走了所有的东西，与竞争对手或恶意行为者分享，怎么办？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/67f63c1a6cf55eebdcd535c76bf7d362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fctCx87D-_ZhpehPaTCJOQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="794d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">云存储旨在解决这些问题。和Dropbox或Google Drive一样，你可以简单地通过一个链接发送数据:“点击<em class="lv">这里</em>访问数据库。”通过微调访问规则，这些数据可以变成只读的——如果你的队友是竞争对手的间谍，你可以在他们下次试图获取数据时立即将这些URL变成错误消息。[1]</p><p id="5dd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<a class="ae ky" href="https://www.ibm.com/cloud/blog/sdk-vs-api" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">SDK</strong>(软件开发工具包)</a>直接从我们的代码中访问数据，这对于将任何应用扩展到极少数用户之外是至关重要的。只要您的互联网连接可靠，您就应该能够随时访问数据，例如，AWS保证正常运行时间为<a class="ae ky" href="https://aws.amazon.com/s3/sla/" rel="noopener ugc nofollow" target="_blank"> 99.9% </a>、<a class="ae ky" href="https://aws.amazon.com/dynamodb/sla/" rel="noopener ugc nofollow" target="_blank"> 99.99% </a>或<a class="ae ky" href="https://aws.amazon.com/blogs/publicsector/achieving-five-nines-cloud-justice-public-safety/" rel="noopener ugc nofollow" target="_blank"> 99.999% </a>，具体取决于您的应用。[2]</p><h2 id="4fea" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">我在储存什么？</h2><p id="10f8" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">因此，我们看到将数据存储在云中是有用的，因此它是安全的，可通过代码访问，并且高度可用。但是“数据”是一个宽泛的术语——是原始视频和文本记录吗？用户档案和活动日志？Python和R脚本？Excel的颗粒状截图？</p><p id="5186" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们<em class="lv">可以</em>将我们所有的文件放入一个大的Dropbox文件夹中，照片与配置文件和CSV混合在一起。只要您知道包含所需数据的文件的名称，Dropbox就会在需要时获取该文件。但是，除非文件严格包含您所请求的数据，否则您需要搜索整个文件以提取相关数据。</p><p id="a9a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个问题——不知道数据的确切位置——是随着数据量的增长，一个大的Dropbox文件夹让我们失望的地方。因为我们经常需要<em class="lv">搜索</em>符合某些标准的数据，所以<strong class="lb iu"> <em class="lv">我们组织数据的方式</em>决定了我们的应用程序是可以支持100个用户还是1亿个用户。正如我们将会看到的，访问特定类型数据的最佳方式很大程度上取决于它的格式<em class="lv"/>。</strong></p><p id="b49d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种格式，即<em class="lv">结构化</em>、<em class="lv">半结构化</em>或<em class="lv">非结构化</em>，是指数据在文件中的组织方式。<strong class="lb iu">结构化</strong>数据是您可能熟悉的行和列的表格集合:通常，每行是一个样本，每列是该样本的一个<a class="ae ky" href="https://www.datarobot.com/wiki/feature/" rel="noopener ugc nofollow" target="_blank">特征</a>。关系数据库中的表由结构化数据组成，如果表通过一个很好地划分数据的列进行<a class="ae ky" href="https://www.codecademy.com/article/sql-indexes" rel="noopener ugc nofollow" target="_blank"> <em class="lv">索引</em> </a>，我们可以快速搜索这些数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/29da7b6e8f487a8780cae17e2fd1776f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*loW0mNjtXfVYs45YC7puag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0f06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">半结构化</strong>数据包括<a class="ae ky" href="https://www.w3schools.com/js/js_json_intro.asp" rel="noopener ugc nofollow" target="_blank"> JSON </a>、<a class="ae ky" href="https://www.w3.org/standards/xml/core" rel="noopener ugc nofollow" target="_blank"> XML </a>、<a class="ae ky" href="https://en.wikipedia.org/wiki/HTML" rel="noopener ugc nofollow" target="_blank"> HTML </a>和大型图表，其中的数据通常不能很好地适应列和行。这种格式非常适合分层数据，其中一个字段可能有子字段，许多子字段包含自己的子字段。<strong class="lb iu">层数没有限制，但是<em class="lv">是</em>需要的结构。例如，一个HTML页面可以有许多嵌套在一起的<code class="fe nh ni nj nk b">&lt;div&gt;</code>部分，每个部分都有独特的CSS格式。</strong></p><p id="6a2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<strong class="lb iu">非结构化</strong>数据是原始的、未格式化的，不可能拆分成结构化数据的行和列，甚至是半结构化数据的嵌套字段，没有进一步的处理。不能或者不应该分解的非结构化数据的一个例子是<strong class="lb iu">二进制大型对象</strong>(<a class="ae ky" href="https://en.wikipedia.org/wiki/Binary_large_object" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">BLOB</strong></a><strong class="lb iu">s</strong>)。例如，你通常想要一次加载整个图像，所以你不应该在一个文件中存储一半像素，在另一个文件中存储一半像素。类似地，<a class="ae ky" href="https://en.wikipedia.org/wiki/Executable" rel="noopener ugc nofollow" target="_blank">可执行程序</a>(例如，编译后的C++脚本)是你总是想一次获取的实体。</p><h1 id="ba5e" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">使用SDK时避免被黑客攻击</h1><p id="e41b" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">既然我们对可以存储在云中的数据类型有了概念，我们就可以开始试验针对每种类型优化的AWS服务。为了真正展示云的力量，我们将使用AWS Python SDK将这些服务集成到我们的代码中。要使用Python SDK，我们只需安装<code class="fe nh ni nj nk b">boto3</code>库。在终端或命令提示符下，我们只需键入以下命令:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="1a99" class="mo lx it nk b gy np nq l nr ns">pip install boto3</span></pre><p id="695b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在我们运行任何脚本之前，我们需要做一件事来避免被黑客删除。<strong class="lb iu">在我们的代码中，将我们的AWS凭证存储在一个安全的位置是至关重要的。</strong></p><p id="7e58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS服务器每秒接收几十或几百个查询。如果服务器收到从您的S3存储桶下载文件的请求，服务器如何知道是阻止还是允许该操作？为了确保这个请求来自你或者代表你的机器<strong class="lb iu">我们</strong> <a class="ae ky" href="https://docs.aws.amazon.com/general/latest/gr/signing_aws_api_requests.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="lv">用我们的AWS访问密钥ID和秘密访问密钥签署</em>我们的API请求</strong> </a> <strong class="lb iu">。</strong>这些密钥用于<a class="ae ky" href="https://www.okta.com/identity-101/hmac/" rel="noopener ugc nofollow" target="_blank">加密我们的消息内容</a>并且<a class="ae ky" href="https://docs.aws.amazon.com/general/latest/gr/signature-version-4.html" rel="noopener ugc nofollow" target="_blank">生成一个哈希</a>来证明AWS收到的消息与我们发送的消息相同。</p><p id="5227" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此本质上，AWS收到的任何用您的访问密钥签名的请求都将被视为来自您。因此，确保您是唯一执行这些请求的人非常重要！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/d425e10af97548976c451d20a7d43726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*71nnRnVpZJjTiBroMpmAEw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6a74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nh ni nj nk b">boto3</code>当我们实例化一个客户机对象时，要求我们传递我们的访问密钥ID和秘密访问密钥。从技术上讲，我们可以通过将访问键定义为变量，然后像这样传递它们:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="d2d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是这是一个巨大的安全漏洞，因为任何阅读这段代码的人都可以冒充你！如果您不小心将这个文件推送到Git这样的版本控制系统，删除第4-5行并推送到一个新版本是不够的——任何人都可以滚动文件的历史来找到您的密钥。</p><p id="820f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">MacOS和Linux用户可以将这些<a class="ae ky" href="https://secrethub.io/blog/what-is-secrets-management/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">秘密</strong> </a>存储在<code class="fe nh ni nj nk b">.bash_profile.rc</code>或<code class="fe nh ni nj nk b">.zshrc</code>文件中，而不是在Python中硬编码这些值。(<a class="ae ky" href="https://saralgyaan.com/posts/set-passwords-and-secret-keys-in-environment-variables-maclinuxwindows-python-quicktip/" rel="noopener ugc nofollow" target="_blank">见此处</a>为视窗。)该文件包含文件路径的别名(例如，当您键入<code class="fe nh ni nj nk b">python</code>时，终端知道您指的是<code class="fe nh ni nj nk b">/opt/homebrew/bin/python</code>)，以及数据库密码或其他敏感信息。这个文件位于你的根目录下，是隐藏的——要找到它，你需要键入<code class="fe nh ni nj nk b">⌘</code> + <code class="fe nh ni nj nk b">.</code>才能看到它。</p><p id="a32c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个文件中，我们可以设置AWS访问键。(注意等号两边没有空格。)</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="e1b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们这样做了，我们就可以通过Python的<code class="fe nh ni nj nk b">os</code>模块访问我们的变量。通过访问来自<code class="fe nh ni nj nk b">os.environ</code>的值，任何阅读代码的人都不会看到它们。[3]</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="8592" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至此，我们已经准备好开始使用AWS了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/bc7878f7df07468168d77eda59a381ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qrt6Rr9O0c943X2v_RXkQA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><h1 id="cc80" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">S3:简单的存储服务</h1><p id="efb2" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">S3或简单存储服务是Dropbox或Google Drive最接近的类似物。把S3想象成你的文件的“包罗万象”。只需创建一个<strong class="lb iu">桶</strong>(即不同的目录)并上传<a class="ae ky" href="https://docs.amazonaws.cn/en_us/AmazonS3/latest/userguide/upload-objects.html" rel="noopener ugc nofollow" target="_blank"> <em class="lv">任意<em class="lv">任意</em>类型</em></a>的任意数量的文件——文本、CSV、可执行文件、Python pickle文件、图像、视频、压缩文件夹等。只需点击几下鼠标，即可定义文件、文件夹、[4]或存储桶级别的访问规则。</p><p id="d963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种简单性的缺点是S3只包含关于文件的数据，而不是文件里面的内容。所以，如果你忘记了你的脸书密码，并且不能在你的文本文件中搜索短语<code class="fe nh ni nj nk b">my Facebook password is</code>，那你就太不幸了。如果我们需要在我们的文件中搜索数据，我们最好将数据存储在数据库中。[5]</p><p id="9ddf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是即使有了数据库，S3仍然是存储生成这些数据的原始数据的理想选择。S3可以作为日志、物联网应用的原始传感器数据、用户访谈的文本文件等的备份。一些文件类型，如图像或训练有素的机器学习模型，最好保存在S3，数据库只需存储对象的路径。</p><h2 id="44f9" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">使用S3</h2><p id="a3ef" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">让我们实际创建一个桶。不要担心AWS会收取存储数据的费用——我们会保持在<a class="ae ky" href="https://aws.amazon.com/free/" rel="noopener ugc nofollow" target="_blank">自由层</a>的范围内，一旦完成，就会删除所有内容。我们将创建一个bucket，然后上传和下载文件。我们将使用控制台、AWS CLI和Python SDK来执行这些步骤，但是请注意，我们可以使用任何一种工具来执行所有步骤。</p><p id="fbc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从控制台开始创建一个bucket。我们首先<a class="ae ky" href="https://aws.amazon.com" rel="noopener ugc nofollow" target="_blank">登录我们的AWS账户</a>(最好使用一个<a class="ae ky" href="http://localhost:4000/AWS-Intro/#iam-identity-and-access-management" rel="noopener ugc nofollow" target="_blank"> IAM角色</a>)并导航到S3。然后，我们只需点击“创建存储桶”按钮:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/6582c5c776874e857e36216bcd6abe2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWNmU5cVDfYWyTAsjwdPPQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="a253" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们创建一个bucket时，我们需要给它一个在所有AWS buckets中全局唯一的名称。这里我们创建一个名为<code class="fe nh ni nj nk b">matt-sosnas-test-bucket</code>的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/7f33c22b798c4ae35f7dbc84a5ff339b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LWZlp30EaM3hejlwNMiFsQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="0054" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的bucket可以有定制的访问规则，但是现在让我们保持禁用公共访问。一旦我们选择了那个，我们的桶就准备好了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/63eba10a2c3ef32db12faa8901b89923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OgDHycRWpiFI7RkWcZFi3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="c240" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">上传文件</h2><p id="3af6" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">现在让我们切换到AWS CLI。在终端或命令提示符下，我们可以使用以下命令看到我们的新bucket。(您可能需要按照步骤<a class="ae ky" rel="noopener" target="_blank" href="/aws-essentials-for-data-science-why-cloud-computing-141cc6cee284">进行认证，此处为</a>)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="7b72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以创建一个文件，并将其上传到我们的bucket。为了简单起见，我们将通过用<code class="fe nh ni nj nk b">echo</code>和<code class="fe nh ni nj nk b">&gt;</code>将一个字符串传送到一个文件中，直接从命令行创建一个文件。然后我们将使用<code class="fe nh ni nj nk b">aws s3 cp &lt;source&gt; &lt;destination&gt;</code>上传文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="32a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以用<code class="fe nh ni nj nk b">aws s3 ls &lt;bucket_name&gt;</code>查看我们的文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="a680" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果S3文件路径包含一个文件夹，AWS会自动为我们创建一个文件夹。我们这次创建一个Python文件，<code class="fe nh ni nj nk b">test.py</code>，并上传到我们bucket中的一个<code class="fe nh ni nj nk b">python/</code>目录。因为<code class="fe nh ni nj nk b">s3://matt-sosnas-test-bucket/python/test.py</code>包含一个<code class="fe nh ni nj nk b">python/</code>目录，S3将为我们创建一个。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="c862" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在当我们用<code class="fe nh ni nj nk b">aws s3 ls</code>查看内容时，我们看到根目录中<code class="fe nh ni nj nk b">test.txt</code>旁边的<code class="fe nh ni nj nk b">python/</code>文件夹。如果我们在命令中将<code class="fe nh ni nj nk b">/python/</code>添加到我们的bucket名称的末尾，我们就可以看到文件夹的内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="02b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以通过指定<code class="fe nh ni nj nk b">--recursive</code>、<code class="fe nh ni nj nk b">--exclude</code>和<code class="fe nh ni nj nk b">--include</code>标志来上传多个文件。下面，我们创建两个CSV，<code class="fe nh ni nj nk b">file1.csv</code>和<code class="fe nh ni nj nk b">file2.csv</code>，首先创建标题，然后各追加两行。然后，我们使用AWS CLI将当前目录(<code class="fe nh ni nj nk b">.</code>)中匹配<code class="fe nh ni nj nk b">file*</code>模式的所有文件上传到我们的bucket中的<code class="fe nh ni nj nk b">csv/</code>文件夹。最后，我们列出了<code class="fe nh ni nj nk b">csv/</code>文件夹的内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><h2 id="0b35" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">下载文件</h2><p id="6449" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">上传文件很好，但是在某些时候我们会想要下载它们。让我们使用第三个工具Python SDK <code class="fe nh ni nj nk b">boto3</code>来演示下载文件。这一步比一行AWS CLI命令更复杂，但是我们将在下面一行一行地进行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="fcd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们先导入<code class="fe nh ni nj nk b">boto3</code>、<code class="fe nh ni nj nk b">io.StringIO</code>、<code class="fe nh ni nj nk b">os</code>、<code class="fe nh ni nj nk b">pandas</code>。<code class="fe nh ni nj nk b">boto3</code>包含与AWS交互的代码，<code class="fe nh ni nj nk b">io</code>是一个用于处理<a class="ae ky" href="https://en.wikipedia.org/wiki/Stream_(computing)" rel="noopener ugc nofollow" target="_blank">流数据</a>的库，<code class="fe nh ni nj nk b">os.environ</code>存储我们的AWS凭证，<code class="fe nh ni nj nk b">pandas</code>将把我们的CSV转换成dataframe。</p><p id="623c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第7–12行，我们实例化了一个<code class="fe nh ni nj nk b">boto3</code>客户端，它允许我们向AWS发出请求。我们执行这样一个请求，从第15-18行的<code class="fe nh ni nj nk b">matt-sosnas-test-bucket</code>中获取<code class="fe nh ni nj nk b">csvs/file1.csv</code>文件。这个对象打包了元数据，所以我们提取第21行的字节字符串，在第22行将其解码为CSV字符串，最后在第23行将该字符串解析为dataframe。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/96f9d1b138bbef60556769afd35d2be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ae5fvdubp-pZ9S4gUvWAcQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><h1 id="36c1" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">RDS:关系数据库服务</h1><p id="bb42" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">把我们所有的数据都扔进一个桶里，即使文件类型是按文件夹排列的，也只能做到这一步。随着数据的增长，我们需要一种更具可扩展性的方法来查找、连接、过滤和计算数据。关系数据库是更好地存储和组织数据的一种方式。(参见<a class="ae ky" rel="noopener" target="_blank" href="/a-hands-on-demo-of-sql-vs-nosql-databases-in-python-eeb955bba4aa">这篇文章</a>了解数据库的入门知识。)</p><p id="a5df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们<em class="lv">可以</em>在云中租用一个EC2实例(即虚拟服务器),然后自己安装一个MySQL或PostgreSQL数据库。但这比在我们车库的服务器上托管数据库好不了多少<a class="ae ky" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Welcome.html" rel="noopener ugc nofollow" target="_blank">——虽然AWS将处理服务器维护，但我们仍将负责扩展、可用性、备份以及软件和操作系统更新。对于稍微增加的成本，我们可以使用类似于</a><a class="ae ky" href="https://aws.amazon.com/rds/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Amazon RDS </strong> </a>的服务，让AWS管理除我们实际数据之外的一切。</p><p id="c9e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以让我们在RDS中创建一个数据库。我们将登录AWS控制台，导航到RDS，然后单击<code class="fe nh ni nj nk b">Create database</code>。如果您阅读了针对所有人的中间SQL，那么您可能已经安装了Postgres数据库的GUI。既然我电脑上已经有pgAdmin了，那就用Postgres吧。🙂</p><p id="2682" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在设置向导中，选择<code class="fe nh ni nj nk b">Standard create</code>作为创建方法，选择<code class="fe nh ni nj nk b">Postgres</code>作为引擎。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/5117ef160df217c61dc6d370a4ee05aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jP6oCdqwgUUR7QrWnZJ5UQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="a19b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保指定您想要使用空闲层！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/1ecafc98820ed662716a94fd3a183ee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yMGosMR1pNQp90lcYWd4OA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="9873" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">命名您的数据库标识符并设置一个用户名—<code class="fe nh ni nj nk b">postgres</code>对两者都很好——并确保在安全的地方写下您的密码。禁用自动缩放(在“存储”下)，并为公共访问选择是。我们的数据库不会真正对世界开放，不要担心——我们仍然需要密码才能访问数据库。(不过，对于专业应用程序，您可能需要<a class="ae ky" href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.WorkingWithRDSInstanceinaVPC.html" rel="noopener ugc nofollow" target="_blank">配置一个VPC </a>。)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/1e4dde3206ff6f3afed1637e253973ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9rTVMHk0FVH11gCnWk_qA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="bf1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在“附加配置”下，命名您的初始数据库<code class="fe nh ni nj nk b">my_database</code>，然后禁用自动备份、性能洞察和次要版本升级。配置中的其他一切都可以保持不变。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/dcdd8ac4780b595834aca73b5574a202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3S0BotNiij65nudfG6LEMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="18e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们点击<code class="fe nh ni nj nk b">Create database</code>时，我们被带回RDS登录页面，看到我们的数据库正在创建。完成后，您可以单击该实例并转到下一页。在此页面上，单击“安全”下的VPC安全组链接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/3277df473cb7c8e7f5cdde55c41c47b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QYSNuHGp_Nm0weka9ZMptw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="2efd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们可以向下滚动到<code class="fe nh ni nj nk b">Inbound rules</code>选项卡，点击<code class="fe nh ni nj nk b">Edit inbound rules</code>，然后点击<code class="fe nh ni nj nk b">Add rule</code>。为<code class="fe nh ni nj nk b">Type</code>选择“PostgreSQL”，为<code class="fe nh ni nj nk b">Source</code>选择“Anywhere-IPv4”。(友情提醒，不要对生产数据库这样做！)您也可以通过<a class="ae ky" href="https://www.avast.com/c-how-to-find-ip-address#" rel="noopener ugc nofollow" target="_blank">指定您的IP地址</a>来提高安全性。完成后，点击<code class="fe nh ni nj nk b">Save rules</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/e500d0acb608db5c99a7544890a10449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWl5RKepqo8G-IV4uTVe-w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="f467" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在对出站规则做同样的操作:单击<code class="fe nh ni nj nk b">Outbound rules</code>选项卡、<code class="fe nh ni nj nk b">Edit outbound rules</code>、<code class="fe nh ni nj nk b">Add rule</code>、<code class="fe nh ni nj nk b">Type</code>的“PostgreSQL”和<code class="fe nh ni nj nk b">Destination</code>的“Anywhere-IPv4”(或您的IP地址)，然后单击<code class="fe nh ni nj nk b">Save rules</code>。</p><p id="c1a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在将从pgAdmin访问我们的数据库。在AWS RDS的Connectivity &amp; security选项卡下，复制端点地址。(看起来有点像<code class="fe nh ni nj nk b">postgres.abcdef.us-east-1.rds.amazonaws.com</code>。)然后打开pgAdmin，右键点击Servers &gt;注册&gt;服务器。将连接命名为类似于<code class="fe nh ni nj nk b">aws_rds_postgres</code>的名称，并将端点地址粘贴到主机名/地址字段中。填写您的密码并点击“保存密码”。</p><p id="7ee2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果一切顺利，您应该会看到<code class="fe nh ni nj nk b">aws_rds_postgres</code>服务器和<code class="fe nh ni nj nk b">my_database</code>数据库。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/8d29f5ff832f79f0dd9640b1a9e9661a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iAXFVDGsyAtpY9nAOZAS-w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="420d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">右键点击<code class="fe nh ni nj nk b">my_database</code>，然后点击<code class="fe nh ni nj nk b">Query Tool</code>，输入以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="f6f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于我们使用免费层，不幸的是我们只能通过pgAdmin查询我们的数据库，而不是AWS控制台或<code class="fe nh ni nj nk b">boto3</code>。(尽管我们<em class="lv">可以</em> <a class="ae ky" href="https://docs.aws.amazon.com/cli/latest/reference/rds/" rel="noopener ugc nofollow" target="_blank">对数据库本身进行修改</a>。)但是为了确保上面的操作有效，请在pgAdmin中键入以下内容，以确认我们可以查询我们的数据库。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/a483909030143386adf1e2c521b2c808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUrh35_sZq4PUAOhBG-fmw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><h1 id="f578" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">DynamoDB</h1><p id="0a56" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">让我们讨论最后一种数据库类型:非关系数据库。AWS为创建和查询NoSQL数据库提供了DynamoDB。</p><p id="27cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢天谢地，DynamoDB比RDS更容易设置。我们将从导航到AWS控制台内的DynamoDB并点击<code class="fe nh ni nj nk b">Create table</code>按钮开始。让我们创建一个名为<code class="fe nh ni nj nk b">users</code>的表，用<code class="fe nh ni nj nk b">id</code>作为数字分区键。然后，点击<code class="fe nh ni nj nk b">Customize settings</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/7a18e7ab1f1e34d9bac08ee2648f48cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qyOwAg6-1yytvxHVjbAnGw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="8196" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择<code class="fe nh ni nj nk b">DynamoDB Standard</code>作为表类，选择<code class="fe nh ni nj nk b">Provisioned</code>作为容量，然后关闭读取和写入的自动扩展，并将配置的容量单元数量减少到各1个。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/11b239ba17b75e2f48265efc82154042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-7zlHecIt1W1RUdK0NlIBw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="79dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让加密归亚马逊DynamoDB所有，然后点击<code class="fe nh ni nj nk b">Create table</code>。</p><p id="c7f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有…就是这样！现在让我们导航到Python来写入我们的表。在Jupyter笔记本或Python脚本中，运行以下命令:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9d04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">写入DynamoDB的语法相当明确——我们需要指定正在编写的字典的每个元素的数据类型。参见<code class="fe nh ni nj nk b"><a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/dynamodb.html#DynamoDB.Client.put_item" rel="noopener ugc nofollow" target="_blank">boto3</a></code> <a class="ae ky" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/dynamodb.html#DynamoDB.Client.put_item" rel="noopener ugc nofollow" target="_blank"> DynamoDB文档</a>中的一些例子。但总的来说，请注意我们如何能够在<code class="fe nh ni nj nk b">favorite_movies</code>下保存电影列表，并为用户456编写一组不同的字段。这种灵活性是NoSQL数据库的特点。</p><p id="19a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果上面的代码运行没有错误，那么我们应该在DynamoDB控制台中看到这些记录。点击我们的<code class="fe nh ni nj nk b">users</code>表，然后点击<code class="fe nh ni nj nk b">Explore table items</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/1fdb72cbda307ab6f88dcdacb1bbca83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*obCUvw2P6xicf8xTJhZwcA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者截图</p></figure><p id="7982" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们还可以从Python中获取对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/1054641806b4aea3a31058465fbc3639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a2I4_QGHgzAqj7lD"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简·kopřiva在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="d964" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">清理</h1><p id="79f4" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">在这篇文章中，我们建立了一个S3桶、关系数据库和NoSQL表。尽管我们使用AWS的免费层，并且每个数据源仅存储极少量的数据，但我们仍然希望拆除每个数据源，以避免最终被收费。</p><p id="a793" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">谢天谢地，删除很简单。在S3，我们只需点击我们的桶，然后点击<code class="fe nh ni nj nk b">Empty</code>按钮。确认我们要删除所有内容。然后再次点击我们的桶，并点击<code class="fe nh ni nj nk b">Delete</code>按钮，确认我们希望桶消失。</p><p id="992a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在RDS中，我们只需点击我们的数据库(<code class="fe nh ni nj nk b">postgres</code>)，然后<code class="fe nh ni nj nk b">Actions</code>，然后<code class="fe nh ni nj nk b">Delete</code>。确保避免在删除之前拍摄数据库的最终快照。</p><p id="395c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，对于DynamoDB，我们点击<code class="fe nh ni nj nk b">Actions</code> &gt; <code class="fe nh ni nj nk b">Delete table</code>，然后确认我们不想要<a class="ae ky" href="https://aws.amazon.com/cloudwatch/" rel="noopener ugc nofollow" target="_blank"> Cloudwatch </a>警报。</p><p id="ff6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！友情提醒，千万不要这样对你公司的生产数据。🤓</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/9be95d031af8ec10e12c128aaed9f946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TiOijFuzAKrhvH-R"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/es/@fourcolourblack?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚当·威尔森</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="1dc5" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="fa99" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">这篇文章介绍了云存储的好处以及我们可能实际存储的各种数据格式:<em class="lv">结构化的</em>数据用于表格数据，<em class="lv">半结构化的</em>用于不适合列和行的数据，以及<em class="lv">非结构化的</em>用于原始和未格式化的数据。</p><p id="e0da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们为每一个构建了优化的数据源。我们创建了一个S3桶作为日志、CSV、照片和任何我们能想象到的东西的“包罗万象”的来源。然后，我们为结构整齐的表格数据构建了一个RDS数据库。最后，我们使用DynamoDB编写了具有不同键和数据格式的Python字典。</p><p id="1e8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，还有很多其他的AWS数据存储服务我们没有在这里介绍。<a class="ae ky" href="https://aws.amazon.com/glue/" rel="noopener ugc nofollow" target="_blank"> AWS Glue </a>和<a class="ae ky" href="https://aws.amazon.com/athena/" rel="noopener ugc nofollow" target="_blank"> Athena </a>允许您直接在S3桶中的文件上运行SQL查询(有一些严重的警告[5])。<a class="ae ky" href="https://aws.amazon.com/redshift/" rel="noopener ugc nofollow" target="_blank"> AWS Redshift </a>是一个数据仓库，它让您可以组合来自多个来源(包括S3、RDS和DynamoDB)的数据，从而更容易地运行分析。AWS Cloudwatch 是一个日志监控和警报服务。</p><p id="0b8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">凭借您在这篇文章中获得的技能，您应该已经具备了开始构建更大、更复杂的云存储应用程序的基础。在下一篇文章中，我们将通过讨论<em class="lv">计算</em>来结束我们的AWS系列，其中我们将使用AWS服务器来运行数据计算。那里见！</p><p id="57ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最好，<br/>哑光</p><h1 id="7c9c" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">脚注</h1><h2 id="42e1" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">1.为什么选择云存储？</h2><p id="ef4f" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">虽然我们可以撤销用户对云数据的访问权限，但当然总是会担心用户制作了本地副本。这个问题没有真正好的答案</p><p id="3d33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦那个人离开你的团队，我们不能让下载的数据自毁。对于来自S3的文件来说，希望不大，但是至少对于来自数据库的数据来说，下载所有的东西是不切实际或者不可能的。在Meta这样的公司，数据访问受到严密监控，从访问包含敏感数据的表格到下载数据的任何时间。</p><h2 id="5420" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">2.为什么选择云存储？</h2><p id="4f83" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">99.999%的正常运行时间是一个很难想象的数字。每年，<a class="ae ky" href="https://docs.aws.amazon.com/wellarchitected/latest/reliability-pillar/s-99.999-or-higher-scenario-with-a-recovery-time-under-1-minute.html" rel="noopener ugc nofollow" target="_blank">“五个9”</a>表示AWS保证不超过5分15秒不可用。</p><h2 id="74d1" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">3.使用SDK时避免被黑客攻击</h2><p id="0cc3" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">我们可以对不太敏感的数据使用类似的过程，比如常量或文件路径。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="a63f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将这些值存储在一个配置文件中，我们可以保持主工作流的整洁:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="5cd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果config.py存储了我们不想让其他人看到的数据，我们可以将它添加到我们的<code class="fe nh ni nj nk b">.gitignore</code>文件中，Git不会试图对它进行版本控制。下面，Git不会跟踪名称中带有<code class="fe nh ni nj nk b">.ipynb</code>、<code class="fe nh ni nj nk b">.pyc</code>或<code class="fe nh ni nj nk b">config.py</code>的文件。</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="26bc" class="mo lx it nk b gy np nq l nr ns">.ipynb<br/>.pyc<br/>config.py</span></pre><h2 id="d482" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">4.S3:简单的存储服务</h2><p id="e84e" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">一个迂腐的注解:S3 <a class="ae ky" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-folders.html" rel="noopener ugc nofollow" target="_blank">的“文件夹”<em class="lv">并不真正</em>存在</a>。它们更像是组织数据的人性化方式。</p><h2 id="bd0d" class="mo lx it bd ly mp mq dn mc mr ms dp mg li mt mu mi lm mv mw mk lq mx my mm mz bi translated">5.S3:简单的存储服务</h2><p id="2486" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">您<em class="lv">可以</em>像对待数据库一样对待S3存储桶，方法是以标准化格式存储CSV或JSONs，用<a class="ae ky" href="https://aws.amazon.com/glue/" rel="noopener ugc nofollow" target="_blank"> AWS Glue </a>索引存储桶，然后用<a class="ae ky" href="https://aws.amazon.com/athena/" rel="noopener ugc nofollow" target="_blank"> AWS Athena </a>查询索引。但是有一些严重的警告——在以前的工作中，我不小心上传了一个格式错误的CSV文件，使得整个桶无法搜索。对于数百个文件，我不知道错误在哪里。在我看来，您最好使用具有严格写入规则的数据库，这些规则会立即标记(并阻止)格式错误的数据。</p></div></div>    
</body>
</html>