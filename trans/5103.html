<html>
<head>
<title>Machine Learning for Forecasting: Transformations and Feature Extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于预测的机器学习:转换和特征提取</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-for-forecasting-transformations-and-feature-extraction-bbbea9de0ac2#2022-11-15">https://towardsdatascience.com/machine-learning-for-forecasting-transformations-and-feature-extraction-bbbea9de0ac2#2022-11-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0955" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">时间序列的监督学习。如何使用 Python 创建单变量预测模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/75d58239cd32d17bd96062cf52bbb317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bbo01Xh_yBeQ0aSf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚当·米格尔斯基在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="23bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将学习使用 Python 对时间序列应用监督学习。</p><p id="3e44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这包括两件事:</p><ul class=""><li id="75f4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">将时间序列从序列转换成表格格式；</li><li id="6e88" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">基于汇总统计信息添加新功能。</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="7c7c" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">介绍</h1><p id="fb14" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi nn translated">预测是数据科学中研究最多的问题之一。目标是预测时间序列的未来值。</p><p id="f49c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">准确的预测对决策者来说是非常宝贵的。它们减少了未来的不确定性，从而改进了行动计划。</p><p id="aa88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">传统的预测方法包括 ARIMA 或指数平滑法。但是，<a class="ae ky" rel="noopener" target="_blank" href="/machine-learning-for-forecasting-size-matters-b5271ec784dc">机器学习回归方法越来越多地被用来解决这个问题</a>。</p><p id="4a12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习方法将任务构建为监督学习。目标是基于历史数据创建一个模型。然而，还不清楚如何使用一系列值作为输入来训练模型。</p><p id="203d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实证明，有一个巧妙的转变让我们可以做到这一点。</p><h1 id="0f99" class="mq mr it bd ms mt nw mv mw mx nx mz na jz ny ka nc kc nz kd ne kf oa kg ng nh bi translated">延时嵌入</h1><p id="26af" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">模型被训练以导出观察和那些观察的结果之间的模式。</p><p id="23e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们如何处理时间序列呢？</p><p id="c58d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">时间序列的值可以被认为是它之前的最近值的结果。该值作为目标变量。过去最近的值被用作解释变量。</p><p id="5725" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种过程将序列从一系列值转变为表格格式。这个变换叫做延时嵌入，是<strong class="lb iu">自回归</strong>的关键。</p><p id="e543" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个 Python 函数来完成:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="b85a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是将该函数应用于从 1 到 9 的序列时的数据集:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/fd8803c6ee045b33efa27b954cc139f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*X2J4Vl89zc8qfOwu4onQNw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="38df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以第一行为例。目标是预测数字 4(列系列(t+1))。解释变量是它之前的过去 3 个值:3、2 和 1。</p><p id="c717" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">延时嵌入有很强的理论基础。详情可查阅参考文献[1]。嵌入定理假定时间序列在变换前后是等价的。</p><h2 id="3dd7" class="oe mr it bd ms of og dn mw oh oi dp na li oj ok nc lm ol om ne lq on oo ng op bi translated">完整示例</h2><p id="b18d" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">让我们编写一个完整的例子。我们将使用太阳黑子时间序列。该数据集可在<em class="oq"> pmdarima </em>库中获得。它看起来是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/73aa60ca799db16450d2a928c1bc06cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMbCfS4yHO_FPygRDtIpIQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">太阳黑子时间序列。作者图片</p></figure><p id="a6c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是如何转换时间序列和训练自回归模型的示例。</p><p id="d59f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每一步中查看更多的上下文注释。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><h2 id="3298" class="oe mr it bd ms of og dn mw oh oi dp na li oj ok nc lm ol om ne lq on oo ng op bi translated">滞后次数和预测范围</h2><p id="f4ee" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">转换时间序列需要指定滞后的数量。也就是我们要用多少最近的过去值来预测下一个点。</p><p id="f91d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对此有一些处方。例如，检查部分自相关并确定它在哪里是显著的。您还可以使用交叉验证来优化该参数。</p><p id="b21f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个参数是预测范围。这是您想要预测的未来步数。如果该值为 1，则该问题被称为单步提前预测。否则，<a class="ae ky" rel="noopener" target="_blank" href="/6-methods-for-multi-step-forecasting-823cbde4127a">多步提前预测</a>。</p><p id="922c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得一提的是，转换并没有取代其他预处理步骤。</p><p id="7775" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您仍然需要考虑趋势和季节因素，并在需要时删除它们。</p><h1 id="06e8" class="mq mr it bd ms mt nw mv mw mx nx mz na jz ny ka nc kc nz kd ne kf oa kg ng nh bi translated">特征抽出</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/92c64ce78caca1279cc491caabaa47fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P0-OKW5fLDEkGFeO"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@pratiksha_mohanty?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pratiksha Mohanty </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="cecd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自回归方法背后有一个基本假设。过去的滞后包含了足够多的关于系列将如何发展的信息。</p><p id="0aa5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，你可以从中获得更多的信息。</p><p id="b64d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在机器学习中，特征工程是建立精确模型的关键部分。这也可以用于预测问题。</p><p id="e47a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用统计数据总结最近的数值。这些统计数据丰富了时间序列的表示。希望这能转化为更好的预测性能。</p><p id="23ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，过去几个值的平均值可能很有用。它给出了级数在每个点的平滑指标。</p><p id="938f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个例子。我重复了上面的代码，但是添加了一个特性工程步骤(第 20–22 行)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="1236" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第 21 行和第 22 行，我添加了滞后的平均值作为解释变量。这使得预测性能略有提高。</p><p id="8b68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是功能重要性的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/4505740fb673a72bd54cd3a7fe3b4287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*ybL6bOV1TwziXkJgXvWBiQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4578" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">均值特征是最重要的特征。</p><p id="79a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我添加了一个特性。但是，你只受到你的想象力的限制。</p><p id="f4b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以测试其他几个汇总统计数据，并检查它们是否改进了模型。</p><h1 id="192d" class="mq mr it bd ms mt nw mv mw mx nx mz na jz ny ka nc kc nz kd ne kf oa kg ng nh bi translated">外卖食品</h1><ul class=""><li id="1d39" class="lv lw it lb b lc ni lf nj li ou lm ov lq ow lu ma mb mc md bi translated">使用时间延迟嵌入将时间序列转换为矩阵</li><li id="e044" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">时间序列中的值是根据它们过去的滞后时间建模的(自动回归)</li><li id="dfa8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">用部分自相关分析或交叉验证选择滞后数</li><li id="9743" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用汇总统计从过去的滞后中提取更多特征</li></ul><p id="1984" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，下一个故事再见！</p><h2 id="9c1b" class="oe mr it bd ms of og dn mw oh oi dp na li oj ok nc lm ol om ne lq on oo ng op bi translated">你可能想读的以前的故事</h2><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/12-things-you-should-know-about-time-series-975a185f4eb2"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">关于时间序列你应该知道的 12 件事</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">时间序列建模时需要考虑的一组重要属性或组成部分。</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><h2 id="cc31" class="oe mr it bd ms of og dn mw oh oi dp na li oj ok nc lm ol om ne lq on oo ng op bi translated">参考</h2><p id="a25f" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">[1]塔肯斯，芙罗莉丝。"探测湍流中的奇怪吸引子."<em class="oq">动力系统和湍流，沃里克 1980 </em>。施普林格，柏林，海德堡，1981。366–381.</p><p id="97de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] Bontempi、Gianluca、Souhaib Ben Taieb 和 Yann-al Le bor gne。"时间序列预测的机器学习策略."<em class="oq">欧洲商业智能暑期学校</em>。施普林格，柏林，海德堡，2012。</p></div></div>    
</body>
</html>