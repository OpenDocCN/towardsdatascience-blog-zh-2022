<html>
<head>
<title>How to work with censored data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何处理经过审查的数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-work-with-censored-data-26b7b6e2c7f#2022-08-24">https://towardsdatascience.com/how-to-work-with-censored-data-26b7b6e2c7f#2022-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="34a6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Tobit模型在零工经济中的应用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/217ebd58842f29db04a465d5b2efaa15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h5SvI0pSUIGuD_C5"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@kaip?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯·皮尔格</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="cfe3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">线性回归可能是统计学习中最基础的话题。几乎所有机器学习、统计学、计量经济学的课程都是从普通最小二乘法的基础开始的。为什么不呢？它的定义方程<em class="ls">y =β</em>₀+<em class="ls">β₁</em><em class="ls">x+e</em>看起来足够简单。但是你为什么会关心OLS方程呢？诚然，在大型语言模型和无人驾驶汽车的时代，谈论线性回归听起来几乎很神秘。然而，正如我们将在本文中看到的，有时线性回归正是您所需要的。</p><p id="7afd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">线性回归的优点之一是可解释性。在我们上面的等式中，我们可以说<em class="ls"> x </em>对<em class="ls"> y </em>的影响是<em class="ls">，</em>平均而言，<em class="ls"> β₁ </em>，考虑到一些随机噪声，<em class="ls"> e </em>，以及一个常数项，<em class="ls"> β </em> ₀ <em class="ls">。然而，这个简单的解释是基于对数据如何产生的强有力的假设:在<em class="ls"> x </em>和<em class="ls"> y </em>之间的关系实际上是线性的吗？我们是否正确测量了<em class="ls"> x </em>和<em class="ls"> y </em>？我们看到的是目标人群的代表性样本吗？你可能已经猜到，在现实生活中，这些问题的答案往往是<em class="ls">不</em>。这就引出了我想在本文中展示的用例:删失数据的Tobit模型。</em></p><h1 id="1882" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">零工经济遭遇数据审查</h1><pre class="kg kh ki kj gt ml mm mn mo aw mp bi"><span id="cb87" class="mq lu iq mm b gy mr ms l mt mu"><strong class="mm ir">Note</strong>: This article uses simulated data. This data is meant to be representative of a real-life scenario, but it does not contain any real transactions from any company mentioned in the article nor does it reflect their actual state of operations.</span></pre><p id="e737" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设你是gig行业公司的一名数据科学家。假设你的公司运行一个骑行应用，比如优步。(这适用于任何配对业务，从送餐到家政服务或运输。)您的经理想知道优惠价格对司机一天完成的乘车次数有什么影响。您有一个数据集，其中包含驾驶员在登录应用程序后一天内完成的乘车次数，包括那些没有完成任何乘车次数的驾驶员。该数据集还包含一个收入变量，该变量已按小时标准化，因此乘车次数具有可比性。“简单——你对自己说——我只要运行一个线性回归，然后取β值就行了”。你确定吗？看下面的图表。它显示了一个城市中有多少司机完成了每小时收入的函数。有什么奇怪的吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/316894d69ee97cf360bb5f39913f31d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*ts04NwPwbge2lo380SqMAw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作为小时收入的函数完成的乘坐次数。来源:作者</p></figure><p id="db9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">乍一看，不尽然。虽然差异很大，但每小时收入和完成的乘坐次数之间似乎存在正相关关系。换句话说，如果司机得到更多的报酬，他们就会做更多的工作。经济学101。但是让我们更深入地分析一下数据。看下面的直方图。它显示了每位驾驶员每天完成的乘坐次数的分布。如您所见，0次乘车有大量积分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/c3a0f08beec9b92da309de350edda7c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*HOtTes9Rsalbhs6XPUInPw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">每位驾驶员每天完成的乘坐次数分布。来源:作者</p></figure><p id="ac08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在再来看看散点图。是不是感觉云<em class="ls">想让</em>继续在x轴的负侧？“但这没有意义——你想——你不可能在一天之内完成消极乘坐！”这是真的，你不能。但是你的数据也不一定是错误的。相反，这是经济学领域众所周知的现象。我们在这里看到的是一个数据审查的例子:司机只有在他们愿意以特定的速度完成一次骑行时才会完成。然而，其他一些司机会登录该应用程序，查看当时支付的费率，并决定不值得他们花时间。这些是零骑的。</p><h1 id="ef24" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">托比特模型</h1><blockquote class="mx my mz"><p id="7964" class="kw kx ls ky b kz la jr lb lc ld ju le na lg lh li nb lk ll lm nc lo lp lq lr ij bi translated">“什么叫少于一无所有？”威尔伯回答道。“我不认为有比一无所有更少的东西。无绝对是虚无的极限。这是你能出的最低价了。这是这条线的终点。有东西怎么会比没有东西少呢？如果有比无更少的东西，那么无就不是无，它会是有，即使只是很小的一点点。但是如果没有什么就是没有什么，那么没有什么就没有比它更少的东西。”<br/>——<em class="iq">詹姆士·托宾1958年引用埃尔文·布鲁克斯·怀特的</em>《夏洛特的网》<em class="iq"> (1952) </em></p></blockquote><p id="6a6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个问题最早是由詹姆斯·罗宾提出的，他在1958年的论文[1]中研究了个人在耐用品上的支出。特别是，他注意到他的美国家庭样本显示，大多数美国家庭报告汽车或耐用品的零消费，因为他们买不起。换句话说，他的样本必然有一个零下限。他在论文的图1中巧妙地描述了这个问题，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/9416abce4201e6460612395ca4d029c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHFncpTaLiVHhBMdXt7bIA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">托宾(1958)的截图——复古，对吧？</p></figure><p id="8c75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意这对OLS估计量的重要影响。如果你要运行一个简单的线性回归，你的<em class="ls"> β₁ </em>会不一致，因为你观察到的数据在图表上不是线性分布的。如果我们取上面托宾的图像，你会想要一个从a到b的直线斜率的估计<em class="ls">β₁</em>——换句话说，<em class="ls"> x </em>和<em class="ls"> y </em>之间的无条件平均关系。但是，因为您的数据是经过审查的，所以观察到的关系(条件平均值)不是线性的，而是类似于O和b之间的线。基本上，您的模型对于某些小时费率会看到太多的零，如果我们允许“负乘”来保持线性关系(即，如果我们让数据云继续进入y轴的负值)，则实际上应该是负值。因此，因为我们的样本在零行程时被删截，所以数据不允许我们画出代表<em class="ls"> x </em>和<em class="ls"> y. </em>之间线性关系的真正直线</p><p id="ea7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在他的论文中，Tobin提出了一种使用截尾数据估计<em class="ls"> β₁ </em>的方法，这种方法后来被称为<em class="ls"> Tobit </em>模型。他的想法是通过考虑观测值被删截为0(或任何其他值，从下往上)的概率来修正我们估计β₁的方法。你会问，为什么是托宾模型而不是托宾T21模型？这个术语是由另一位经济学家亚瑟·戈德伯格创造的。它是单词<em class="ls"> Tobit </em> and和<em class="ls"> probit，</em>的组合，这是一种分类技术，用于计算观察结果被删截的概率。</p><p id="8030" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然模型的推导超出了本文的范围，但是让我们快速地看一下这个问题的完整性。下面的函数显示了我们必须通过最大似然估计来解决的最大化问题，以得到我们真正的<em class="ls"> β₁ </em>(在向量符号<em class="ls">中显示为β，</em>与<em class="ls"> β </em> ₀) <em class="ls">。</em>托宾解暗示误差是独立且正态分布的，标准差σ。在函数中，如果<em class="ls"> y = 0 </em>，则<em class="ls"> dᵢ </em>取值为0，否则取值为1。因此，总和的左边(乘以<em class="ls"> dᵢ </em>，在顶行)相当于OLS似然函数，而右边(乘以<em class="ls"> (1-dᵢ) </em>，在底行)，说明观察值<em class="ls"> i </em>被删除的概率。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/1299e8111b1eb7fe97f263bf60915b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wd4PjzhF7_0Qo0zJnmUXxw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Tobit模型的似然函数。来源:作者</p></figure><h1 id="7b89" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">履行</h1><p id="26e8" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">虽然很酷，但据我所知，Python中没有使用Tobit模型的Python包(至少我在<code class="fe nk nl nm mm b">pip</code>或<code class="fe nk nl nm mm b">conda</code>上没见过)。然而，我发现<a class="ae kv" href="https://github.com/jamesdj" rel="noopener ugc nofollow" target="_blank"> James Jensen的实现</a>非常有用。我分叉了我自己的版本，你可以在这里找到<a class="ae kv" href="https://github.com/AlvaroCorrales/tobit" rel="noopener ugc nofollow" target="_blank"/>，我强烈鼓励你也这样做！</p><p id="01ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还记得我说过，如果我们用简单的OLS估计，β₁会不一致吗？用数学术语来说，这意味着我们对<em class="ls"> β </em>的估计不会收敛到它的实际值。更简单地说，我们的线性关系的斜率将是off。为了说明这一点，下图中的绿线显示了我们的驱动程序示例中的OLS拟合值。另一方面，使用Tobit模型估算<em class="ls"> β </em>给出了一个稍高的值(<code class="fe nk nl nm mm b">0.35</code>对<code class="fe nk nl nm mm b">0.33</code>)，用蓝线表示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/0525654e64576c9593076d4d4e7be1d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*RwyIgyPyTnCXmyVVuUzrOw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">小时收入和乘坐次数之间的最佳拟合线已完成:OLS(绿色)和托比特模型(蓝色)。来源:作者</p></figure><p id="e5a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">OLS估计值和托比特估计值之间的差异会因您的模型规格而异，有时会更大，有时会更小。请注意，我们的等式中没有包括任何控制变量，也没有任何可靠的识别策略来支持它。这意味着我们的模型可以改进，这可能会影响我们的估计。因此，我们不应该试图从这些特定的数字中推导出任何意义。</p><h1 id="3a57" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">边际效应</h1><p id="4591" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">现在你已经运行了你的Tobit模型，并得出了对<em class="ls"> β₁、</em>的估计，你可能会忍不住说，每增加一美元，每位车手将完成<em class="ls"> β₁ </em>更多的旅程。但事情没这么简单！我们来看看为什么。</p><p id="67bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一般来说，我们的目的是估计收入变化对完成的游乐设施的平均影响。这就是经济学家所说的“边际效应”。虽然我们将跳过数学细节，但这相当于等式中<em class="ls"> y </em>(乘车次数)相对于<em class="ls"> x </em>(收益)的导数。在OLS模型中，这就是简单的<em class="ls"> β₁.</em>但是，在Tobit模型中，<em class="ls"> x </em>对<em class="ls"> y </em>的边际效应稍微复杂一些。因为我们在推导<em class="ls"> β₁ </em>的过程中包括了一个观察被删节的概率，所以我们在解释它的时候也需要考虑它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/f3d5c3d0e92976804aee1b6e160f9d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*_prnajnia5dVi-eOVClrSA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Tobit模型中x对y的边际效应。来源:作者</p></figure><p id="945f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的等式显示了收入的变化如何转化为平均完成的乘坐次数——因此在左手边有条件的期望。在右边，我们得到了我们的<em class="ls"> β₁ </em>，乘以正态分布的累积分布函数(CDF，用φ表示)，在我们的模型对<em class="ls"> y、</em>的估计值处评估，即<em class="ls">β</em>₀+<em class="ls">β₁</em><em class="ls">x</em>，并通过我们的误差标准偏差σ归一化。</p><p id="b57e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我上面描述的可能听起来很复杂，但是你会发现实际上并不复杂。边际效应等式的意思是，每小时收入变化的平均影响确实取决于β₁.然而，该系数由个人愿意以当前小时工资率工作的概率加权，如CDF所示。换句话说，提供额外一美元的边际效应将会不同，这取决于那次乘坐最初是10美元还是40美元。如果你想一想，这是有道理的:有人为40美元工作的概率可能高于为10美元工作的概率！</p><p id="44d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了了解这在实践中是如何工作的，让我们回到我们的Python实现。为了计算边际效应，我创建了一个名为<code class="fe nk nl nm mm b">margins</code>的函数，它建立在詹姆斯·詹森的解决方案之上。根据我们估计的<code class="fe nk nl nm mm b">0.35</code>的<em class="ls"> β₁ </em>和10美元的起始时薪，估计的边际效应将是<code class="fe nk nl nm mm b">0.17</code>。然而，将起步价改为40美元会产生边际效应<code class="fe nk nl nm mm b">0.32</code>。如果我们把每小时的收入进一步提高，比如说100美元，边际效应已经是<code class="fe nk nl nm mm b">0.35</code>。如你所见，收入越高，我们的边际效应就越接近<em class="ls"> β₁，</em>因为司机更有可能愿意为了更高的时薪完成一次驾驶。</p><h1 id="aecc" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="f214" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在这篇文章中，我们已经看到，如果我们的观察数据被审查，一些表面上简单的回归问题实际上可能变得棘手。对于零工经济行业的公司来说，情况就是这样，他们可能想知道给员工提供多少工资来增加他们在平台上的参与度。为了解释这个删失数据问题，我们引入了Tobit模型，这是一个由詹姆士·托宾在1958年开发的计量经济学模型。</p><p id="4146" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这个<a class="ae kv" href="https://github.com/AlvaroCorrales/tobit" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到跟随这篇文章的代码。</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h1 id="f7cb" class="lt lu iq bd lv lw nv ly lz ma nw mc md jw nx jx mf jz ny ka mh kc nz kd mj mk bi translated">参考</h1><p id="2138" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">[1]托宾·詹姆斯(1958)。<a class="ae kv" href="http://cowles.yale.edu/sites/default/files/files/pub/d00/d0003-r.pdf" rel="noopener ugc nofollow" target="_blank">“有限因变量的关系估计”</a> (PDF)。<em class="ls">计量经济学</em>。<strong class="ky ir">26</strong>(1):24–36。</p></div></div>    
</body>
</html>