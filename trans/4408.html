<html>
<head>
<title>Amazon Business Analyst Interview Questions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊业务分析师面试问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/amazon-business-analyst-interview-questions-bcb57f7768c3#2022-09-29">https://towardsdatascience.com/amazon-business-analyst-interview-questions-bcb57f7768c3#2022-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3517" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">提高你编写SQL查询的技能，最大化你在亚马逊获得业务分析师工作的机会</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/4b8a7c67118841c1cd858c5acfca829c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AoBNF3QikpVjIvm0"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图片</p></figure><p id="b62f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">亚马逊每天运送超过一百万个包裹。即使是物流和商业运作效率的微小提高也能节省数百万美元。业务分析师可以分析硬数据，获得洞察力，并将他们的发现传达给公司的决策者。</p><p id="87c7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本文中，我们将讨论业务分析师如何融入亚马逊的组织结构。了解他们未来的责任可以帮助有抱负的商业分析师获得工作，并推进他们在亚马逊的<a class="ae kw" href="https://www.stratascratch.com/blog/amazon-data-scientist-position-guide/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank">职业生涯。</a></p><h1 id="aa90" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">亚马逊业务分析师的职责</h1><p id="ece4" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">亚马逊的业务分析师利用数据来获得关于业务运营、物流、客户行为和习惯的见解，并利用它们来增加利润。有两种方法可以做到这一点:削减不必要的成本，增加收入。</p><p id="1a3d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">和今天的其他科技企业一样，亚马逊收集了大量的用户数据。商业分析师通过寻找增加用户支出的方法来增加收入。另一方面，查看数据是发现和消除组织内低效率的最安全的方法之一。</p><p id="1c9d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个角色的面试反映了商业分析师在亚马逊的职责。候选人必须表现出很强的商业知识和处理数据的能力。编写SQL查询是业务分析师的日常任务之一。</p><p id="a5ca" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">潜在的业务分析师必须回答从业务案例到实际SQL挑战的各种问题。SQL问题通常涉及业务流程，消除低效并增加收入。</p><p id="7d7b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">分析数据只是业务分析师工作的一部分。他们的主要职责之一是与公司的决策者交流见解。</p><h1 id="44fb" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">亚马逊的面试官在寻找什么？</h1><p id="2e9d" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">业务分析师在SQL方面做了很多工作，所以面试官希望他们对这种语言非常精通。与其他数据科学专业不同，业务分析师通常只需要Python的基础知识。这也有助于很好地理解Excel。</p><p id="5d00" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">专注于任务和检测数据模式的能力也能帮助你在工作中取得成功。这样的技能是很难衡量的，所以面试官通常会在回答问题的过程中观察应聘者。</p><p id="72b0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有抱负的商业分析师也需要展现出深厚的商业知识。分析和汇总数据的能力很重要，但如果不能在业务环境中获得洞察力并做出正确的结论，这还不够。为了在这些面试中理解非技术性问题，请阅读一篇关于<a class="ae kw" href="https://www.stratascratch.com/blog/business-analyst-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank">业务分析师面试问题</a>的一般性文章。</p><p id="d2cf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">亚马逊的文化专注于改善客户体验，让他们的网站成为网上购物最便捷的选择。同样关注改善客户体验可以帮助你在亚马逊找到一份工作。</p><h1 id="8a74" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">解决亚马逊业务分析师面试问题的框架</h1><p id="a63c" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated"><strong class="kz ir"> 1。理解问题</strong></p><p id="7454" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">应对SQL挑战的最佳方式是仔细阅读描述。尤其是问题有很多概念和条件的情况下。新问题一开始可能会令人困惑。多读几遍，以保持正确的方向。</p><p id="e2cc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有些问题是明确而具体的。其他的则很宽泛，可以有不同的解释。当问题在任何方面都不清楚时，最好直接要求面试官具体说明。</p><p id="774b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">问题通常会引入“唯一用户”之类的概念或“计算每月销售额差异”之类的操作。有些问题对这些概念和任务有具体的定义，而有些则没有。</p><p id="4fd3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">通常，任务描述还会指定在返回数据之前如何安排数据，如何格式化输出，或者类似的事情。</p><p id="0b0c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 2。分析数据</strong></p><p id="8518" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">查看可用数据是解决SQL问题的第二重要步骤。如果幸运的话，可用数据将包含在一个表中，但情况并非总是如此。</p><p id="0539" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有些问题有多个表，每个表可以有十几列。开发一种系统的方法来轻松理解可用的数据是很重要的。</p><p id="d705" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">第一步是查看问题描述中提到的值，并确定哪些表和列包含这些值。</p><p id="a8d3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">查看每一列的数据类型会有所帮助。它可以帮助您决定是否需要对值进行转换或格式化。日期值经常是这种情况，它需要格式化或转换成文本值。</p><p id="0355" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">此外，数据中每个值的唯一性和限制也很重要。所以看实际数据是值得的。</p><p id="cd2f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 3。规划你的方法</strong></p><p id="6c16" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦你理解了问题和可用的数据，就该为找到解决方案制定合理的步骤了。</p><p id="61b5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">写下你的计划可以帮助你专注于解决挑战。你可以从最直接的方法开始，最终你可能会对最初的想法有所改进。在编写查询时，写下的逻辑步骤很容易遵循。</p><p id="d617" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">养成计划你的方法的习惯是非常有益的。这是一个在面试中展示你想法的机会。想出多种方法来处理一个问题可以证明你的SQL技能和作为数据科学家的总体敏锐度。</p><p id="c16b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这些步骤应该描述从初始数据到最终答案你将执行什么操作(赋值、乘法、除法、格式化)。</p><p id="5f72" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您不必为每个步骤编写特定的代码，但是您可以编写伪代码，或者在编写实际代码时引用您将使用的SQL特性。</p><p id="126e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 4。编写代码</strong></p><p id="f0a3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">将您的逻辑大纲转换成有效的SQL查询。从最基本的查询开始，逐渐增加复杂性。</p><p id="9c6c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">例如，如果需要筛选某一列中的值，首先选择该列中的所有值。逐步添加过滤、格式化规则、聚合等条件。</p><p id="bad3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">添加这些复杂要素时，请检查查询的输出。这样，您将知道什么在起作用，以及额外的代码是否有预期的效果。您还可以检测代码中的问题，并轻松地修复它们。</p><h1 id="0b58" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">亚马逊商业分析师面试问题#1: <br/>找出没有订单的客户数量</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/8aba874dbeb97bca44e0af32406657a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTobQQJrdcN_IuiqlXf0-w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="bc8c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">业务分析师的日常任务之一是了解客户行为。在这个角色中，您可能需要分析没有下订单的用户的行为。也许你需要理解他们为什么不下订单。或者亚马逊员工如何鼓励用户订购更多。</p><p id="47b1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">分析用户行为是亚马逊成功的秘诀之一。因此，我们从这个SQL挑战开始列出潜在的面试问题。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mq"><img src="../Images/19e5e240daef41d6aade4529a28c4f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YxbuOm03E7imvswhywQTrw.png"/></div></div></figure><h2 id="91b6" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">理解问题</h2><p id="2574" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">这个问题看起来很简单，很清楚候选人需要做什么。在StrataScratch平台上标记为‘中等’难度。</p><p id="66fe" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个Amazon business analyst采访问题中，我们必须处理两个表——一个包含订单信息，另一个包含客户信息。</p><p id="e489" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">似乎合乎逻辑的是，为了找到答案，我们将不得不交叉检查两个表以得到答案。</p><p id="939d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">事不宜迟，我们开始吧。</p><h2 id="64ca" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">分析数据</h2><p id="2874" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">如前所述，我们可以从两个表中提取所有必要的信息。首先，让我们看看<strong class="kz ir">订单</strong>表:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nd"><img src="../Images/c0a41fc26c5a454e11c94da2636c01ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E29kP-9_H4GCVNVao_7vFw.png"/></div></div></figure><p id="eb96" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果我们看一下实际的表格，现有的数据可能更容易理解:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ne"><img src="../Images/550ad5a00ca667509449f847f1a06dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLK0PLHtkJtJk-YoZD2BRQ.png"/></div></div></figure><p id="0938" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们看一下每一栏:</p><ul class=""><li id="0f18" class="nf ng iq kz b la lb ld le lg nh lk ni lo nj ls nk nl nm nn bi translated"><strong class="kz ir"> id </strong>列包含一个唯一的整数值来标识每个订单。</li><li id="6fe4" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated"><strong class="kz ir"> cust_id </strong>列包含一个整数值，用于标识下订单的客户。由于问题要求查找没有订单的客户，我们将不得不查找不在该列中的用户。<br/>在现实生活中，一个客户可以下多个订单。<strong class="kz ir"> cust_id </strong>值描述了许多订单与一个客户的关系，因此它们不一定是唯一的。</li><li id="700c" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">这个问题没有提到订单的时间顺序，所以可以安全地忽略<strong class="kz ir"> order_date </strong>列中的值。</li><li id="78e1" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">此外，该问题没有要求我们查找客户订购了什么，因此可以忽略<strong class="kz ir"> order_details </strong>列。</li><li id="c702" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">我们不必计算每个用户的订单量。也不需要跟踪<strong class="kz ir"> total_order_cost </strong>列中的值。</li></ul><p id="9dc8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">客户</strong>表是拼图的另一个重要部分:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nt"><img src="../Images/d21e2d81205fe696a96966a6e7fb49f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-mCNrjNT4d5qe6Bw5cj5Q.png"/></div></div></figure><p id="64d6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在我们已经知道了列和列中包含的值的类型，让我们来看看表本身:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nu"><img src="../Images/474fe83a6fc5cacac42c58c6776fd7fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWvjdSoIxKAcNrM3KN1ZZg.png"/></div></div></figure><p id="fb7b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们看一下每一栏:</p><ul class=""><li id="b28b" class="nf ng iq kz b la lb ld le lg nh lk ni lo nj ls nk nl nm nn bi translated"><strong class="kz ir"> id </strong>列包含一个唯一的整数值来标识每个客户。每行只描述一个客户，所以<strong class="kz ir"> id </strong>的值是唯一的。</li></ul><p id="0a8b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">本质上，我们有一个所有用户的列表，不管他们是否下了订单。我们必须用<strong class="kz ir">订单</strong>表中的<strong class="kz ir"> cust_id </strong>列交叉检查这个列表。</p><ul class=""><li id="4fc4" class="nf ng iq kz b la lb ld le lg nh lk ni lo nj ls nk nl nm nn bi translated">该问题没有要求我们通过用户的全名来识别用户。因此，我们可以忽略<strong class="kz ir">名</strong>、<strong class="kz ir">姓</strong>列中的值。</li><li id="29f7" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">客户的位置不是兴趣点，所以我们可以忽略<strong class="kz ir">城市</strong>和<strong class="kz ir">地址</strong>列中的值。</li><li id="2b3f" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">我们也不需要包含在<strong class="kz ir"> phone_number </strong>列中的用户联系信息。</li></ul><p id="e3fe" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先，我们需要识别重要的列。在这种情况下，这将是<strong class="kz ir">客户</strong>表中的<strong class="kz ir"> id </strong>列和<strong class="kz ir">订单</strong>表中的<strong class="kz ir"> cust_id </strong>列。</p><p id="5be6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">常见的错误是从<strong class="kz ir">订单</strong>表中选择<strong class="kz ir"> id </strong>列。我们需要<strong class="kz ir"> cust_id </strong>列，因为在这个表中，<strong class="kz ir"> id </strong>列标识订单，而不是客户。</p><p id="2e58" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">从数据中可以明显看出，每一笔订单都与一个客户相关联。有时一个客户有多个订单，但是没有一个订单没有<strong class="kz ir"> cust_id </strong>值，该值标识谁下了订单。</p><h2 id="3fb2" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">规划你的方法</h2><p id="ef6c" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated"><strong class="kz ir"> 1。合并两个表格中的数据</strong></p><p id="6787" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这种情况下，显而易见的选择是使用联接来合并两个表中的数据。我们只需要选择正确的连接类型。</p><p id="89d6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了执行连接，我们需要定义共享维度——客户的身份。在<strong class="kz ir">订单</strong>表中，客户标识符位于<strong class="kz ir"> cust_id </strong>列。在<strong class="kz ir">客户</strong>表中，这些值存储在<strong class="kz ir"> id </strong>列中。</p><p id="eeb6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题要求我们找出满足特定标准的客户数量。第一张表是<strong class="kz ir">订单</strong>，第二张是<strong class="kz ir">客户</strong>。我们使用RIGHT OUTER JOIN来确保第二个表中第一个表中没有的客户id不会被删除。</p><p id="7d3b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">两个表之间的共享维度是客户的身份。在<strong class="kz ir">客户</strong>表中，这些值存储在<strong class="kz ir"> id </strong>列中。在<strong class="kz ir">订单</strong>表中，它们存储在<strong class="kz ir"> cust_id </strong>列中。</p><p id="b37f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 2。过滤记录以查找没有订单的用户</strong></p><p id="4af9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">接下来，您需要找到特定客户id没有<strong class="kz ir">订单</strong>的情况。换句话说，在任何订单的<strong class="kz ir"> cust_id </strong>列中都找不到该客户的<strong class="kz ir"> id </strong>。</p><p id="741f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们执行一个连接，但是不能保证<strong class="kz ir">客户</strong>表的<strong class="kz ir"> id </strong>列中的每个值都会出现在<strong class="kz ir">订单</strong>表的<strong class="kz ir"> cust_id </strong>列中。在没有匹配的情况下，<strong class="kz ir"> cust_id </strong>列将为空。</p><p id="f610" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这一阶段，我们有了包含相应订单数据的所有客户的列表。我们可以使用WHERE语句只保留没有订单的用户。</p><p id="de19" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 3。获取过滤结果中的行数</strong></p><p id="ee72" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一旦我们有了所有没有<strong class="kz ir"> cust_id </strong>值的记录，我们就差不多找到了答案。</p><p id="d309" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后一步是使用<strong class="kz ir"> COUNT() </strong>聚合函数来获得被过滤的行数。这是没有订单的客户数量。</p><p id="7e30" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 4。输出结果并重命名列</strong></p><p id="23d3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">使用<strong class="kz ir">作为</strong>关键字给输出列一个更具描述性的标签是一个很好的实践。</p><h2 id="72c2" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">写代码</h2><ol class=""><li id="f98f" class="nf ng iq kz b la ml ld mm lg nv lk nw lo nx ls ny nl nm nn bi translated">合并两个表中的数据</li></ol><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="a2a0" class="mr lu iq oa b gy oe of l og oh">SELECT *<br/>FROM orders o<br/>RIGHT OUTER JOIN customers c ON o.cust_id = c.id</span></pre><p id="b804" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">2.筛选记录以查找没有订单的用户</p><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="ca1d" class="mr lu iq oa b gy oe of l og oh">SELECT *<br/>FROM orders o<br/>RIGHT OUTER JOIN customers c ON o.cust_id = c.id<br/>WHERE o.cust_id IS NULL</span></pre><p id="9bc4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">3.获取筛选结果中的行数</p><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="b2a2" class="mr lu iq oa b gy oe of l og oh">SELECT COUNT(*)<br/>FROM orders o<br/>RIGHT OUTER JOIN customers c ON o.cust_id = c.id<br/>WHERE o.cust_id IS NULL</span></pre><p id="12cd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">4.输出结果并重命名该列。</p><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="57c1" class="mr lu iq oa b gy oe of l og oh">SELECT COUNT(*) AS n_customers_without_orders<br/>FROM orders o<br/>RIGHT OUTER JOIN customers c ON o.cust_id = c.id<br/>WHERE o.cust_id IS NULL</span></pre><p id="6f43" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有经验的SQL开发人员有时会更改表的顺序，使用左连接而不是右外连接。</p><p id="9642" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你准备好迎接挑战，尝试使用左连接来解决这个亚马逊商业分析师面试问题。</p><h1 id="e31d" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">亚马逊商业分析师面试问题#2:寻找员工少于5人的部门</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/b02acbb3956c7cfe4cf45eea7a8da297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GkIOrctm_gJORGCwlFP0ow.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="c8f8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">业务分析师有时需要检测组织中的结构性低效。由于这个原因，亚马逊面试官可能会要求他们解决这个问题，候选人需要找到有一定数量工人的部门。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oi"><img src="../Images/4934ea28b6d4c2ad7ab32dd05b6c3304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eXQ4HZpZ2JWbJSTawhQMKQ.png"/></div></div></figure><h2 id="3fd9" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">理解问题</h2><p id="6db6" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">要回答这个亚马逊业务分析师面试问题，候选人必须找到每个部门的工人数量，然后过滤列表以满足标准。</p><p id="be97" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最终输出只包含两列——部门和相应的员工人数。</p><h2 id="f536" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">分析数据</h2><p id="e462" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">解决这个问题所需的所有信息都包含在一个<strong class="kz ir">工人</strong>表中。这是桌子的模型:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oj"><img src="../Images/e1a115dc761b70f12d7d6f792ea0b17b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6te1qKwrEbahX8uSO76Juw.png"/></div></div></figure><p id="2cb3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们有六列不同类型的值。除了注意值的类型之外，查看表中的实际数据也很有帮助:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ok"><img src="../Images/b7918d788bf558b106c0fcd876035fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XLuWZm4Nx4ZeIrKulE3xFg.png"/></div></div></figure><p id="2a7e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们检查每一列中的值:</p><ul class=""><li id="8977" class="nf ng iq kz b la lb ld le lg nh lk ni lo nj ls nk nl nm nn bi translated"><strong class="kz ir"> worker_id </strong>列包含一个唯一的整数值来标识每个雇员。我们将使用这些值来计算每个部门的员工人数。</li><li id="a6f0" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">我们不应该使用<strong class="kz ir"> first_name </strong>和<strong class="kz ir"> last_name </strong>列中的值来标识每个用户。可能有同名的雇员，所以最好使用唯一的<strong class="kz ir"> worker_id </strong>值来标识他们。因此，可以忽略这些值。</li><li id="7054" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">这个问题没有问我们关于补偿的问题。因此<strong class="kz ir">薪资</strong>列可以忽略。</li><li id="ea8f" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">候选人不必按时间顺序跟踪每个员工的加入日期。我们不需要处理<strong class="kz ir"> joining_date </strong>列中的值。</li><li id="52e5" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">最后，<strong class="kz ir">部门</strong>列包含每个员工的工作地点信息。该问题要求我们返回部门信息以及雇员人数。</li></ul><p id="e1f9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">工人</strong>表中最重要的列是<strong class="kz ir">工人id </strong>和<strong class="kz ir">部门</strong>。我们必须得到每个部门的雇员人数。获得雇员数量的最安全的方法是计算每个部门的唯一值。</p><h2 id="a75e" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">规划你的方法</h2><p id="c915" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated"><strong class="kz ir"> 1。选择要使用的数据</strong></p><p id="7b9b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们需要编写一条语句来从<strong class="kz ir"> workers </strong>表中选择<strong class="kz ir">部门</strong>和<strong class="kz ir"> worker_id </strong>列。这将为我们提供员工名单及其工作地点。</p><p id="0fbf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们没有把员工人数单列出来。我们需要用其他方法找到工人总数。</p><p id="771b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 2。合计每个部门的员工人数</strong></p><p id="b0fe" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以通过对<strong class="kz ir"> worker_id </strong>值使用<strong class="kz ir"> count() </strong>聚合函数来获得工人的数量。我们需要使用GROUP BY语句来输出每个部门的员工总数。</p><p id="b5a7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">默认情况下，<strong class="kz ir"> count() </strong>聚合函数给列一个通用的<strong class="kz ir"> count </strong>标签。我们可以使用<strong class="kz ir">作为</strong>关键字来给列一个描述性的名称。</p><p id="465a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个阶段，我们应该只有唯一的<strong class="kz ir">部门</strong>值和每个值的员工数量。</p><p id="dbd4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 3。过滤出员工人数超过5人的部门</strong></p><p id="c1be" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们不能使用WHERE语句来过滤聚合函数的结果。SQL开发人员使用HAVING()子句丢弃不符合标准的组(部门)。在这种情况下，条件是每个部门必须有5名以上的员工。</p><h2 id="ec07" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">写代码</h2><ol class=""><li id="f6de" class="nf ng iq kz b la ml ld mm lg nv lk nw lo nx ls ny nl nm nn bi translated">选择要处理的数据</li></ol><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="0f05" class="mr lu iq oa b gy oe of l og oh">SELECT <br/>    department,<br/>    worker_id<br/>FROM worker</span></pre><p id="dd16" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">2.合计每个部门的员工人数</p><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="071e" class="mr lu iq oa b gy oe of l og oh">SELECT department,<br/>       count(worker_id) AS num_of_workers<br/>FROM worker<br/>GROUP BY department</span></pre><p id="2bcf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">3.筛选出拥有超过5名员工的部门</p><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="d44c" class="mr lu iq oa b gy oe of l og oh">SELECT department,<br/>       count(worker_id) AS num_of_workers<br/>FROM worker<br/>GROUP BY department<br/>HAVING count(worker_id) &lt; 5</span></pre><h1 id="40d3" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">亚马逊商业分析师面试问题3:薪水最高的员工</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/8baca2faf6933aa8b3cb1f06cc9cf74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n_9HwV2bzYn4H6jCe-6E9A.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="8c75" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要解决这个“中等”难度的问题，考生必须分析<strong class="kz ir"> worker </strong>表中的数据。它包含像工人的工资和他们的部门的信息。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ol"><img src="../Images/10869ca2dbf1379f9f79e6a3d2c6f15e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3stCvL3-XSQT-jbdDc_2w.png"/></div></div></figure><h2 id="4be3" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">理解问题</h2><p id="97e1" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">这项任务相当简单——我们有关于工人、他们的工资和他们所属部门的信息。我们需要为每个部门找到收入最高的人。问题描述还指定需要返回哪些值。</p><p id="bd68" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你必须决定如何解决在同一个部门工作的多名员工分享最高工资的边缘情况。最有可能的是，你应该回复他们所有人的信息，但是你可能想和面试官澄清这一点。</p><h2 id="5cce" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">分析数据</h2><p id="f2a6" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">潜在的业务分析师需要编写SQL查询来处理<strong class="kz ir"> workers </strong>表中的数据。这是问题2中的表格。但是，在这种情况下，我们将使用不同的值来获得最终答案:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi om"><img src="../Images/324961e2a0a0adffed4f8f8185eb6ffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K18-YvVNGlJRAodxxPZexg.png"/></div></div></figure><p id="8125" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们再次看看可用数据的具体例子:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi on"><img src="../Images/8425dd4bda984a1bafb25bb1af8ec234.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQzC8uR0q9tfAv5CzFEjag.png"/></div></div></figure><p id="51e5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们看一下表格中的列:</p><ul class=""><li id="c2d1" class="nf ng iq kz b la lb ld le lg nh lk ni lo nj ls nk nl nm nn bi translated">对于这个亚马逊业务分析师面试问题，我们不需要跟踪<strong class="kz ir"> worker_id </strong>列中的值。我们只需在<strong class="kz ir">first _ name</strong>列中找到工资和产值最高的行。</li><li id="e217" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">我们的最终输出包括我们确定的每个部门中工资最高的个人的<strong class="kz ir"> first_name </strong>值。因此，我们需要从该列中选择值。</li><li id="d569" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">我们根本不需要处理<strong class="kz ir">姓氏</strong>的值。因此，可以忽略该列。</li><li id="96e3" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">要解决这个问题，候选人需要找到每个部门薪资最高的员工。因此，我们需要根据员工的工作地点定义不同的员工群体，并为每个群体找到最高的<strong class="kz ir">工资</strong>。</li><li id="f58f" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">每个员工加入的时间并不重要，因此可以忽略<strong class="kz ir">加入日期</strong>列。</li><li id="4258" class="nf ng iq kz b la no ld np lg nq lk nr lo ns ls nk nl nm nn bi translated">我们必须在每个部门找到最高的薪水。因此，我们必须在<strong class="kz ir">部门</strong>列中寻找具有相同值的多个工人，并输出工资最高的一个。</li></ul><p id="dca0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了回答这个亚马逊商业分析师的采访问题，我们需要使用<strong class="kz ir">薪水</strong>和<strong class="kz ir">部门</strong>列。最后，输出还需要包括工人各自的<strong class="kz ir">名字</strong>值。</p><h2 id="cb57" class="mr lu iq bd lv ms mt dn lz mu mv dp md lg mw mx mf lk my mz mh lo na nb mj nc bi translated">规划你的方法</h2><p id="7550" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated"><strong class="kz ir"> 1。找出每个部门员工的最高工资</strong></p><p id="7320" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在查看了现有的数据之后，很明显有许多员工被分配到仅仅几个部门。我们需要根据员工工作的部门对他们进行分类，并找出每组中收入最高的人。</p><p id="1bf4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为此，我们最有可能使用MAX()聚合函数以及GROUP BY语句将它们放在不同的组中。</p><p id="3dac" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 2。组合主表和临时表中的数据</strong></p><p id="91c0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了访问所有列中的值，我们需要创建一个包含最高收入者的临时表。然后，我们必须将它与主表连接起来，以访问两个表中的所有值。</p><p id="2a0e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们可以执行一个内部连接来剔除那些不是收入最高的员工的记录。为此，我们需要使用on语句指定共享维度。内部联接将完成剩下的工作。</p><p id="b95a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> 3。输出三列中的值</strong></p><p id="ec4d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将临时表与主表连接起来的主要原因是为了能够访问主表的所有列。</p><p id="8def" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该问题要求我们找出每个部门中工资最高的人，并在他们的<strong class="kz ir">工资</strong>、<strong class="kz ir">部门</strong>和<strong class="kz ir">名字</strong>列中输出值。</p><p id="454e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">编写代码</strong></p><ol class=""><li id="db5c" class="nf ng iq kz b la lb ld le lg nh lk ni lo nj ls ny nl nm nn bi translated">找出每个部门员工的最高工资</li></ol><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="8411" class="mr lu iq oa b gy oe of l og oh">SELECT <br/>      max(salary) AS TotalSalary,<br/>      department <br/>FROM worker <br/>GROUP BY department</span></pre><p id="de54" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">2.合并两个表中的数据</p><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="2c60" class="mr lu iq oa b gy oe of l og oh">SELECT *<br/>FROM<br/>  (SELECT max(salary) AS TotalSalary,<br/>          department<br/>   FROM worker<br/>   GROUP BY department) AS TempNew<br/>INNER JOIN worker t ON TempNew.department = t.department<br/>AND TempNew.TotalSalary = t.salary</span></pre><p id="8862" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">3.输出三列中的值</p><pre class="kh ki kj kk gt nz oa ob oc aw od bi"><span id="5163" class="mr lu iq oa b gy oe of l og oh">SELECT t.department,<br/>       t.first_name,<br/>       t.salary<br/>FROM<br/>  (SELECT max(salary) AS TotalSalary,<br/>          department<br/>   FROM worker<br/>   GROUP BY department) AS TempNew<br/>INNER JOIN worker t ON TempNew.department = t.department<br/>AND TempNew.TotalSalary = t.salary</span></pre><h1 id="ec92" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">摘要</h1><p id="5ed0" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">业务分析师的角色是独特的，因为它需要技术和业务专长，两者同等重要。为了得到一份工作，候选人经常会面临SQL挑战。他们编写SQL查询的能力将影响他们成功的机会。</p><p id="452c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这篇文章中，我们讨论了亚马逊业务分析师职位的三个面试问题。您可以在StrataScratch上探索其他SQL问题，在这个平台上，任何级别的数据科学家都可以练习和提高他们的SQL技能。</p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><p id="7ba9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="ov">最初发表于</em><a class="ae kw" href="https://www.stratascratch.com/blog/amazon-business-analyst-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=tds" rel="noopener ugc nofollow" target="_blank"><em class="ov">【https://www.stratascratch.com】</em></a><em class="ov">。</em></p></div></div>    
</body>
</html>