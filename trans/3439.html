<html>
<head>
<title>A Visual Summary of SQL Date/Time Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL日期/时间函数的可视化摘要</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-visual-summary-of-sql-date-time-functions-8bb96ce4f1b4#2022-07-29">https://towardsdatascience.com/a-visual-summary-of-sql-date-time-functions-8bb96ce4f1b4#2022-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="63a0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">准备SQL面试？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a04b10327080ff0c9272a29e2f010dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uAoz1oTTh-1v8t7M"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@agebarros?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿格巴洛斯</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d1d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在时间戳、日期和时间数据类型之间，SQL日期/时间函数可能很容易混淆。在这篇博客中，我将尝试使用<strong class="ky ir"> PostgreSQL语法</strong>绘制出SQL访谈中常见的数据/时间命令。</p><h1 id="23c5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">在SQL代码之前</h1><p id="f060" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在我们开始编码之前，让我们先暂停一下，考虑一下日期/时间表示中的元素。我们知道时间是线性的，单向的，并且在数学上可以用向量来表示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/3df3c5893e8285bd013740f3ae18781d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bq1Jl8bCWYa1qw4In4ZLYw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="3474" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">时间向量t上的两个关键元素是<em class="mq">时刻</em>和<em class="mq">持续时间</em>。这些术语可能不是最准确的，但是由于SQL使用了关键字<em class="mq">时间戳</em>和<em class="mq">间隔</em>，现在让我们使用不同的词语来理解这个概念。</p><ul class=""><li id="b859" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><strong class="ky ir">瞬间</strong>指事件发生的瞬间。力矩是瞬时的，所以用向量t上的点来表示，t1和t2是力矩。</li><li id="ea77" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><strong class="ky ir">持续时间</strong>是指两个时刻之间的时间跨度。持续时间由无数个瞬间组成，有开始也有结束。</li></ul><p id="ee2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，我们真的只需要了解这两个元素，以及这两个元素之间的转换，就能掌握SQL中的日期/时间函数。</p><h1 id="72d7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">Moment &amp; Moment家庭</h1><p id="c8c6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><em class="mq">时间戳</em>给了我们最多的信息。时间戳可以精确到毫秒，并且包含时区信息，但是大多数时候，YYYY-MM-DD HH:MM:SS格式的时间就足够了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/aadf5e18c7be5ffe02efdfb4b9749ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_6LNgYMMBLp3BStxh5VqA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="1e67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq">时间戳</em>可以分成两部分，<em class="mq">日期</em>和<em class="mq">时间</em>，通过将<em class="mq">时间戳</em>转换成<em class="mq">日期</em>或<em class="mq">时间</em>对象(简写::)。但是，将日期<em class="mq">或时间</em>转换回时间戳是不可取的，因为您将丢失时间戳<em class="mq">中一半的信息</em>或者SQL将抛出一个错误。</p><p id="cda8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从一个<em class="mq">时间戳</em>中可以提取很多信息，比如年、月、日、时、分、秒等。然而，并不是所有的信息都可以单独从<em class="mq">日期</em>或<em class="mq">时间</em>对象中提取。例如，您不能从<em class="mq">时间</em> 01:50:39提取年份。</p><p id="3ace" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是PostgreSQL代码中的几个示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="7bf8" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">创造时刻</h2><p id="660b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">通常情况下，在SQL面试问题中会给你一点时间。例如，它可以是用户的登录时间、用户向另一个用户发送消息的时刻，或者客户下订单的时刻。但是，这并不能保证。有时候，你只需要创造属于你的时刻。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/5af8743b0d5755b355333b81ff7c102a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lzXd_TniMZGlITSTbbOMnA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="bbda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">现在</strong> : 99%的时候，我们需要利用现在的时刻进行一些计算。<code class="fe nv nw nx ny b">CURRENT_TIMESTAMP</code>和<code class="fe nv nw nx ny b">NOW()</code>给你当前时刻完全相同的时间戳。上图展示了更多的变化。请注意，没有所谓的<code class="fe nv nw nx ny b">LOCALDATE</code>。</p><p id="0cd9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">定制时刻:</strong>很少会遇到需要定制特定时刻的情况，但如果你这样做了，<code class="fe nv nw nx ny b">MAKE_TIMESTAMP</code>就会做到。上图展示了更多的变化。</p><h2 id="a07d" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">从一瞬间到另一瞬间</h2><p id="85c1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><code class="fe nv nw nx ny b">DATE_TRUNC</code>将一个时刻转换成另一个时刻。它的工作原理类似于一个下限函数，将时间戳重置为时间戳的年/月/周/日/小时/…的开始。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/8bf4e68be28600347fc7df0f828ed302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*999Mygo08k-ohKw3-ccXBg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="ed9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以向函数<code class="fe nv nw nx ny b">DATE_TRUNC</code>输入<em class="mq">日期</em>，而不是<em class="mq">时间戳</em>，它将通过用零填充未知时间来输出结果。但是，输入一个<em class="mq">时间</em>会抛出一个错误。</p><h1 id="9114" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">持续时间</h1><p id="d895" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在，我们来谈谈持续时间。持续时间对应PostgreSQL中的<em class="mq">区间</em>，以'<em class="mq"> 20年11个月6天'的格式表示。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/61913500b35b04cdc07a8aa89326bfd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hG9Ej5qKX25lPrMUyBU09g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="5399" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以再次借用函数<code class="fe nv nw nx ny b">EXTRACT</code>和<code class="fe nv nw nx ny b">DATE_PART</code>得到具体的年/月/日/小时/分钟/秒/…的间隔。<code class="fe nv nw nx ny b">AGE</code>功能给了我们一个更全面的视角。请注意，如果只给<code class="fe nv nw nx ny b">AGE</code>函数一个输入，它会自动将输入与当前时间戳进行比较，但输出的精度会与您的输入保持一致。</p><h2 id="39f9" class="ni lt iq bd lu nj nk dn ly nl nm dp mc lf nn no me lj np nq mg ln nr ns mi nt bi translated">把瞬间和间隔放在一起</h2><p id="b227" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">知道了<code class="fe nv nw nx ny b">timestamp2-timestamp1=interval</code>，只要知道方程的两个元素，就可以计算第三个。因此，我们可以使用时间戳和间隔来获取其他时间戳。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/105d818d883d3f1cb8b0d9eab00a02b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AupC4hq5O5jI0FJffkjOrw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure></div><div class="ab cl oc od hu oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="ij ik il im in"><p id="88fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读！希望这篇博客对你有所帮助。</p></div></div>    
</body>
</html>