<html>
<head>
<title>Fine-Tuning for Domain Adaptation in NLP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然语言处理中领域适应的微调</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fine-tuning-for-domain-adaptation-in-nlp-c47def356fd6#2022-05-10">https://towardsdatascience.com/fine-tuning-for-domain-adaptation-in-nlp-c47def356fd6#2022-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/500b1b02255c9b5097df1215472dfdb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0EYP7p8BJeuPdbiV"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">卢卡·布拉沃在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="6a44" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">创建您的自定义模型并上传到拥抱脸</h2></div><h2 id="5be1" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">简介</strong></h2><p id="0dce" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">通常，当我们想要解决一个NLP问题时，我们会使用预先训练好的语言模型，显然会小心地选择最合适的模型，这些模型已经针对我们感兴趣的语言进行了微调。<br/>例如，如果我正在进行一个基于意大利语的项目，我将使用诸如<a class="ae jd" href="https://huggingface.co/dbmdz/bert-base-italian-xxl-cased" rel="noopener ugc nofollow" target="_blank"><em class="mk">dbmdz/Bert-base-Italian-xxl-cased</em></a>或<a class="ae jd" href="https://huggingface.co/dbmdz/bert-base-italian-xxl-uncased" rel="noopener ugc nofollow" target="_blank"><em class="mk">dbmdz/Bert-base-Italian-xxl-uncased</em></a>这样的模型。<br/> <strong class="lt jh">这些语言模型通常在通用文本上工作得很好，但当我们在特定领域使用它们时</strong>却常常不太合适，例如，如果我们在有其<strong class="lt jh">特殊语言</strong>的医学或科学领域使用它们。<br/>为此，我们需要应用<strong class="lt jh">域适配</strong>！<br/>领域适应，是指我们对新数据集上的预训练模型进行微调，它会给出更适合该数据集的预测。</p><h2 id="63c9" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">微调是什么意思？</h2><blockquote class="ml mm mn"><p id="1c13" class="lr ls mk lt b lu mo kh lw lx mp kk lz mq mr mb mc ms mt me mf mu mv mh mi mj ij bi translated">NLP中的微调指的是<strong class="lt jh">使用您自己的自定义数据</strong>重新训练预训练语言模型的过程。作为微调过程的结果，原始模型的权重被更新，以考虑领域数据和您感兴趣的任务的特征。</p></blockquote><figure class="mx my mz na gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mw"><img src="../Images/9847b6357ee0583c4d91c96ca0f3fb4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*siC4uqdrfWviwAz7Hedn6A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="0375" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">在我们的例子中，我们将使用<strong class="lt jh">屏蔽语言模型任务(MLM) </strong>进行微调。换句话说，我们的数据集将不具有前缀标签，但是对于每个句子<strong class="lt jh">，一些单词将被隐藏</strong>(被屏蔽)，并且<strong class="lt jh">模型将不得不猜测</strong>哪些是隐藏的单词。</p><h2 id="12d2" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">资料组</h2><p id="6898" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们将用于此目的的<strong class="lt jh">数据是公开的，可以在kaggle的<a class="ae jd" href="https://www.kaggle.com/datasets/mrisdal/fake-news" rel="noopener ugc nofollow" target="_blank">链接</a>中找到。这个<strong class="lt jh">数据集包含大约13k条新闻</strong>。我们只对评论的内容感兴趣，所以你只需要使用<em class="mk">文本</em>列。在本文中，我不会描述从kaggle下载数据集并提取csv文件的过程，如果您有问题，可以阅读我在TDS上发布的其他文章。</strong></p><h2 id="8bc6" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">亲自动手</h2><p id="2947" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">让我们先导入我们需要的所有库。</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">进口</p></figure><p id="a7bf" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">让我们定义模型训练所需的超参数。(如果你有足够的计算能力，可以随便玩！)</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">超参数</p></figure><p id="f9c0" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">先说资料准备。加载您的csv文件，分割它并将其转换为数据集对象。</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">数据准备</p></figure><p id="c225" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">现在你必须选择你的分层模型和标记器。我喜欢用distilbert，因为它更轻，训练更快。</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">开始模型和标记器</p></figure><p id="308f" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">为了给模型提供信息，我们需要对数据集进行标记。</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="f710" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">现在我们可以训练我们的模型了。<em class="mk">DataCollatorForLanguageModeling</em>是一个允许我们非常容易地在掩蔽语言任务上训练模型的函数。</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">训练并保存您的自定义模型</p></figure><h2 id="a317" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">困惑评估</h2><p id="ce1c" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">你创建的定制模型真的比源模型好吗？要了解是否有改进，我们可以计算模型的困惑度！如果你对这个指标感兴趣，请阅读这篇<a class="ae jd" rel="noopener" target="_blank" href="/perplexity-in-language-models-87a196019a94">文章</a>。</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">原始模型困惑</p></figure><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">定制模型困惑</p></figure><p id="5e14" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">希望你注意到了模型困惑的改善！</p><h2 id="eb54" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">在拥抱脸上发布您的自定义模型！</h2><p id="9c1a" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">如果您在个人数据集或您自己创建的特定数据集上训练您的模型，您的模型可能对其他人有用。只需几行代码就可以上传到你的拥抱脸账户！</p><p id="41d7" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">首先创建一个拥抱脸的个人帐户，然后运行以下命令。</p><figure class="mx my mz na gt is"><div class="bz fp l di"><div class="nb nc l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">上传你的模型到拥抱脸</p></figure><p id="ff99" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated">搞定了。现在你的模型在拥抱脸，任何人都可以下载和使用它！感谢大家的贡献！</p><h2 id="07b1" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h2><p id="b1b7" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">如果你也喜欢创建你自己的自定义语言模型并把它发布在Hugging Face上，请继续创建新的模型并让社区可以使用它们。<br/>如果你想看看我在太空物品(遥感器、卫星……)方面训练过的模型，这就是:</p><div class="ip iq gp gr ir nd"><a href="https://huggingface.co/Chramer/remote-sensing-distilbert-cased" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd jh gy z fp ni fr fs nj fu fw jf bi translated">照相机/遥感蒸馏器外壳拥抱脸</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">地球观测领域正在日益扩大。越来越多的数据科学家对这个领域感兴趣…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">huggingface.co</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ix nd"/></div></div></a></div><h2 id="4f62" class="kv kw jg bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结束了</h2><p id="59c9" class="pw-post-body-paragraph lr ls jg lt b lu lv kh lw lx ly kk lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">作者:<em class="mk">马赛洛·波利蒂</em></p><p id="dcf8" class="pw-post-body-paragraph lr ls jg lt b lu mo kh lw lx mp kk lz le mr mb mc li mt me mf lm mv mh mi mj ij bi translated"><a class="ae jd" href="https://www.linkedin.com/in/marcello-politi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae jd" href="https://twitter.com/_March08_" rel="noopener ugc nofollow" target="_blank"> Twitter </a></p></div></div>    
</body>
</html>