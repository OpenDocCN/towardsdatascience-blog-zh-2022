<html>
<head>
<title>Unsupervised Multilingual Text Classification With Zero-Shot Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于零触发方法的无监督多语言文本分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/unsupervised-multilingual-text-classification-with-zero-shot-approach-e65bd79b5d0#2022-02-07">https://towardsdatascience.com/unsupervised-multilingual-text-classification-with-zero-shot-approach-e65bd79b5d0#2022-02-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ed73" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这篇文章是使用拥抱脸变形金刚的综合概述🤗执行零射击分类</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a2b12ec061827703ee3e6a4eb149d799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NoJ9FdiEFu7bfGgy"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@waldemarbrandt67w" rel="noopener ugc nofollow" target="_blank">瓦尔德马·布兰德</a>在<a class="ae ky" href="https://unsplash.com/photos/U3Ptj3jafX8" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="f307" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="cee1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">大多数时候，当我们训练一个机器学习模型时，所有的候选标签/目标都是事先知道的，这意味着如果你的训练标签是<strong class="lt iu">科学</strong>、<strong class="lt iu">政治</strong>、<strong class="lt iu">教育</strong>，你将无法预测<strong class="lt iu">医疗保健</strong>标签，除非你重新训练你的模型，考虑到那个标签和相应的输入数据。在本文中，我将介绍我认为是多语言自然语言处理领域中最强大的无监督技术之一:<code class="fe mn mo mp mq b"><strong class="lt iu">Zero-Shot-Classification</strong></code></p><h2 id="3dbd" class="mr la it bd lb ms mt dn lf mu mv dp lj ma mw mx ll me my mz ln mi na nb lp nc bi translated">零射击分类——是什么？</h2><p id="ec3e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这种方法使得在没有看到任何候选标签的情况下预测文本的目标成为可能。</p><p id="a36e" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">根据<a class="ae ky" href="https://colab.research.google.com/drive/1jocViLorbwWIkTXKwxCOV9HLTaDDgCaw?usp=sharing" rel="noopener ugc nofollow" target="_blank">介绍 colab </a>:</p><blockquote class="ni nj nk"><p id="9af8" class="lr ls nl lt b lu nd ju lw lx ne jx lz nm nf mc md nn ng mg mh no nh mk ml mm im bi translated">底层模型是在自然语言推理(NLI)任务上训练的，它接受两个序列，并确定它们是否相互矛盾、相互依赖或者都不存在。</p><p id="f3e1" class="lr ls nl lt b lu nd ju lw lx ne jx lz nm nf mc md nn ng mg mh no nh mk ml mm im bi translated">这可以通过将我们想要分类的序列视为一个 NLI 序列(称为前提)并将一个候选标签变成另一个标签(假设)来适应零射击分类的任务。如果模型预测，构建的前提需要假设，那么我们可以把它作为标签应用于文本的预测。</p></blockquote><h1 id="dad5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">实验</h1><p id="146f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">大多数研究都集中在英语上，这使得大多数方法在英语数据上比其他语言更有效。在一个有 6000 多种不同语言的世界中设计工具时，这可能是一个负担。</p><p id="4d87" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">这个课题已经吸引了研究界好几年，结果相当令人鼓舞。我们的实验将利用乔·戴维森的 XNLI 罗伯塔大型 XNLI 模型的力量。除了对英语非常有效之外，它对相当多的语言也很有效，如法语、西班牙语、德语、斯瓦希里语、乌尔都语等。</p><p id="adb7" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">简单来说，实验将基于两种主要语言，英语和法语，分别在<a class="ae ky" href="https://www.kaggle.com/balatmak/newsgroup20bbcnews" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> BBC 新闻数据</strong> </a> <strong class="lt iu"> </strong>和<a class="ae ky" href="https://www.ecolemedia.ci/actualite/voir_actualite/education-inclusive-le-gouvernement-en-action-pour-une-education-de-qualite-aux-enfants-a-deficience-sensorielle-1257.html" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">Ecole Media CI</strong></a><strong class="lt iu"/>网站摘录；<strong class="lt iu"> </strong>和<strong class="lt iu"> </strong>的数据都是<strong class="lt iu">两者免检</strong>。还有，文中用到的所有源代码在我的<a class="ae ky" href="https://github.com/keitazoumana/Medium-Articles-Notebooks/blob/main/Zero_Shot_Classification_Multi_Lingual.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> Github </strong> </a>上都有。</p><h2 id="edb6" class="mr la it bd lb ms mt dn lf mu mv dp lj ma mw mx ll me my mz ln mi na nb lp nc bi translated">先决条件</h2><p id="e946" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">确保安装转换器并导入成功实验所需的库。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实验 _ 预准备. py</p></figure><p id="9d2f" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">考虑到多语言方面，下面的表达式用于实例化我们的模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">zsmlc_classifier.py</p></figure><ul class=""><li id="385f" class="nr ns it lt b lu nd lx ne ma nt me nu mi nv mm nw nx ny nz bi translated"><code class="fe mn mo mp mq b">zsmlc_classifier</code>用于零触发多语言分类器。将<code class="fe mn mo mp mq b">model</code>参数初始化为<code class="fe mn mo mp mq b">joeddav/xlm-roberta-large-xnli</code>，以便下载预先训练好的多语言模型。</li></ul><h2 id="422a" class="mr la it bd lb ms mt dn lf mu mv dp lj ma mw mx ll me my mz ln mi na nb lp nc bi translated">让我们深入分类</h2><p id="8e01" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">分类任务使用三个主要参数，它们是</p><ul class=""><li id="1793" class="nr ns it lt b lu nd lx ne ma nt me nu mi nv mm nw nx ny nz bi translated"><code class="fe mn mo mp mq b">sequences</code>对应要预测的文本/序列。</li><li id="7a8b" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><code class="fe mn mo mp mq b">candidate_labels</code>是我们需要预测的所有候选标签的列表。请记住，这些标签不需要预先知道模型。</li><li id="ec1f" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><code class="fe mn mo mp mq b">multi_class</code> <strong class="lt iu"> <em class="nl"> </em> </strong>是二进制值。如果我们要进行多类分类，则<strong class="lt iu"> <em class="nl">为真</em> </strong>，在这种情况下，所有的预测概率将是独立的，意味着每个值都在 0 和 1 之间，总和不一定是 1。如果为 False，则概率得分之和为 1。</li></ul><p id="19a5" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><strong class="lt iu">了解单个预测的输出</strong></p><p id="d2c9" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">这里的目标是帮助您理解单个预测的输出格式，这对于更好地理解其余部分是必不可少的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示输出格式</p></figure><pre class="kj kk kl km gt of mq og oh aw oi bi"><span id="5358" class="mr la it mq b gy oj ok l ol om">{'labels': ['tech', 'entertainment', 'business', 'sport', 'politics'],  <br/>'scores': [0.8140193223953247,   0.802348256111145,   0.791598916053772,   0.7419557571411133,   0.7163865566253662],  'sequence': 'tv future in the hands of viewers...they want [truncated]</span></pre><p id="fec4" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">输出是一个包含三个主键的字典:</p><ul class=""><li id="0cba" class="nr ns it lt b lu nd lx ne ma nt me nu mi nv mm nw nx ny nz bi translated"><em class="nl">标签</em>:用于预测的所有候选标签列表。</li><li id="80e4" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><em class="nl">分数</em>:标签对应的概率分数列表。而我们可以看到，文中已经预测为<strong class="lt iu"> <em class="nl">科技</em> </strong> (81%信心)<strong class="lt iu"> <em class="nl">娱乐</em> </strong> (80%信心)<strong class="lt iu"> <em class="nl">商业</em> </strong> (79%信心)<strong class="lt iu"> <em class="nl">体育</em> </strong> (74%信心)，以及<strong class="lt iu"> <em class="nl">政治</em> </strong> (71%信心)。</li><li id="ba9e" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><em class="nl">序列</em>:用于预测的原始序列/文本。为了不显示全部信息，这部分内容被故意截断了。</li></ul><p id="1911" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">为了用<a class="ae ky" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>对之前的预测有一个很好的图形化可视化，我们使用两个感兴趣的关键字将结果转换成熊猫数据帧:<em class="nl">标签</em>和<em class="nl">分数</em>列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">绘图 _ 结果. py</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/03b0e04ae2c1062ad36c4db990fe2c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7N4VF9h_Y7QMLkZuJi03wQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1:预测为 81%可信技术的序列(图片由作者提供)</p></figure><p id="ee47" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">现在我们已经了解了预测格式，让我们通过对一批文本/描述进行预测来进一步分析。</p><p id="34e4" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><strong class="lt iu">案例 1:英语文本的分类</strong></p><p id="fbe0" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">本例中的说明是通过使用原始数据的子集来实现的，这样处理速度会更快。为此，我随机对五个标签中的每一个进行了 2 次观察，总共 10 次观察。</p><p id="f271" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">已经实现了以下帮助器功能:</p><ul class=""><li id="d5a5" class="nr ns it lt b lu nd lx ne ma nt me nu mi nv mm nw nx ny nz bi translated"><code class="fe mn mo mp mq b">make_prediction</code>为了从模型预测中返回概率得分最高的标签。</li><li id="bdc1" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><code class="fe mn mo mp mq b">run_batch_prediction</code>用于对用户提供的数据集的所有观测值进行预测。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实用程序 _ 功能. py</p></figure><p id="5894" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">最后，我们可以使用下面的表达式执行批量预测，以了解模型的执行情况。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">run_batch_prediction.py</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/4911d77d1f2702eb1125ccd51b6f5d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NYxLH8OsqWmiHbZsfjW4jA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:对 10 条随机 BBC 新闻的批量预测(图片由作者提供)</p></figure><p id="118c" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">从上表中，我们可以观察到，除了第 221 行中的一个预测外，该模型的所有预测都是正确的，被预测为<strong class="lt iu"> <em class="nl"> sport </em> </strong>而不是<strong class="lt iu"> <em class="nl"> tech </em> </strong>。让我们看看相应的文本/描述以及所有候选标签的预测概率得分。</p><ul class=""><li id="3046" class="nr ns it lt b lu nd lx ne ma nt me nu mi nv mm nw nx ny nz bi translated">这是已经分类的原文</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/c224cb6cb016afe94be2f18fd3595388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8qyIeofuNwyZiptvW4glfA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3:模型预测的原始文本(图片由作者提供)</p></figure><ul class=""><li id="4ecf" class="nr ns it lt b lu nd lx ne ma nt me nu mi nv mm nw nx ny nz bi translated">这是模型的预测</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/e83546c9b265b7460076e7aad03dc6ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNOdODsdTdcKbIzOvxQG8g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4:预测为 75%置信度的运动的序列(图片由作者提供)</p></figure><p id="7a4a" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">我们可以观察到，文中已经预测到 75% <strong class="lt iu"> <em class="nl">体育</em> </strong>，74% <strong class="lt iu"> <em class="nl">商业</em> </strong>，74% <strong class="lt iu"> <em class="nl">科技</em> </strong>，70% <strong class="lt iu"> <em class="nl">娱乐</em> </strong>，50% <strong class="lt iu"> <em class="nl">政治</em> </strong>。通读全文，我们可以同意，它确实主要是关于<strong class="lt iu"> <em class="nl">科技</em> </strong>而不是其他类别。</p><p id="65da" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><strong class="lt iu">案例 2:对法文文本的分类</strong></p><p id="8e93" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">我们将以不同的方式处理这个问题。我们将尝试执行情感分类任务，而不是定义主题，这意味着我们将预测下面的文本是正极性、负极性还是中性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/e843f599a4ccd66316bc9a42e5cb838c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a52Nm2iCfE1eeEL16QzEiw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片 5:这个摘录没有获得<a class="ae ky" href="https://www.ecolemedia.ci/actualite/voir_actualite/education-inclusive-le-gouvernement-en-action-pour-une-education-de-qualite-aux-enfants-a-deficience-sensorielle-1257.html" rel="noopener ugc nofollow" target="_blank"> Ecolemedia.ci </a>的许可(图片由作者提供)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/017b490f24a54e0d2ade0330bf3264bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w1hMgk0xTB0Awmsu7Y_pcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片 5:法语序列被预测为“positif”(英语中为阳性)，置信度为 99%(图片由作者提供)</p></figure><p id="fab6" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">该模型以 99%  的置信度预测先前文本为<strong class="lt iu"> <em class="nl">阳性。对于懂法语的人来说，我们可以同意这个预测是完全准确的。</em></strong></p><h1 id="aae3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="782f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">从之前的用例来看，毫无疑问，零镜头分类对于无监督的文本分类来说是一场革命。它提供了更大的灵活性，并展示了迁移学习对更一般数据的所有威力。然而，当你在处理一个特殊的商业问题(如生物、金融等)时，使用监督培训方法可能更好。).不要犹豫，试一试，不要忘记继续学习！</p><p id="d2ce" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">关注我的 YouTube<a class="ae ky" href="https://www.youtube.com/channel/UC9xKdy8cz6ZuJU5FTNtM_pQ" rel="noopener ugc nofollow" target="_blank">了解更多互动内容！</a></p><h1 id="5c06" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">额外资源</h1><p id="b1d1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://github.com/keitazoumana/Medium-Articles-Notebooks/blob/main/Zero_Shot_Classification_Multi_Lingual.ipynb" rel="noopener ugc nofollow" target="_blank">Github 上的源代码</a></p><p id="3762" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">乔·戴维森的 XNLI 罗伯塔大型 XNLI</p><p id="d8af" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><a class="ae ky" href="https://discuss.huggingface.co/t/new-pipeline-for-zero-shot-text-classification/681" rel="noopener ugc nofollow" target="_blank">零镜头文本分类的新管道</a></p><p id="1d07" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated"><a class="ae ky" href="https://www.ecolemedia.ci/actualite/voir_actualite/education-inclusive-le-gouvernement-en-action-pour-une-education-de-qualite-aux-enfants-a-deficience-sensorielle-1257.html" rel="noopener ugc nofollow" target="_blank"> 全纳教育:政府致力于为感官障碍儿童提供优质教育 </a></p><p id="07c4" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">BBC 新数据 Kaggle(T3)</p><p id="0666" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">曲名 : Bye For Now↓↓</p></div></div>    
</body>
</html>