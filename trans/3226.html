<html>
<head>
<title>Query Tableau workbook permissions for all groups and users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">查询所有组和用户的Tableau工作簿权限</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/query-tableau-workbook-permissions-for-all-groups-and-users-4ae4e4cc404#2022-07-18">https://towardsdatascience.com/query-tableau-workbook-permissions-for-all-groups-and-users-4ae4e4cc404#2022-07-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b3cb" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">TABLEAU REST API: TABLEAU-API-LIB教程</h2><div class=""/><div class=""><h2 id="8e94" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用Python和Tableau REST API来跟踪谁可以做什么</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1bcbe1d506b06c2863d6bd3bffbbab4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZqW71iitbw1eFSII"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">纳蕾塔·马丁在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="92ce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在您的Tableau环境中，跟踪谁可以访问什么可能是一件困难的事情。数据治理总是伴随着挑战。一个好的经验法则是将内容组织到特定的项目中，为这些项目分配特定的组权限，并避免完全分配基于用户的权限。</p><p id="bde0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">即使您遵循了最佳实践，也有足够的理由维护一个更新的视图，以了解哪些组和用户对您环境中的任何给定内容拥有各种权限。手动编译这些信息很繁琐，而自动化可以消除很多麻烦。</p><p id="8112" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们来看看实现自动化的一种方法。</p><p id="fd54" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本文中看到的所有代码在最后都以更方便的格式提供，并带有代码所在的GitHub gist的链接。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="00ee" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本教程介绍了如何使用Python <a class="ae lh" href="https://github.com/divinorum-webb/tableau-api-lib" rel="noopener ugc nofollow" target="_blank"> tableau-api-lib </a>包，并且是如何像使用小桶一样使用tableau服务器的系列教程的一部分，让您能够控制Tableau服务器的REST API。</p><p id="01fe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这些教程假设您已经安装了Python 3。如果你还没有Python 3，这将帮助你入门:<a class="ae lh" href="https://wiki.python.org/moin/BeginnersGuide/Download" rel="noopener ugc nofollow" target="_blank">安装Python的指南</a>。</p><h2 id="c538" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">搭建舞台</h2><p id="ac06" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">有许多Tableau REST API端点，您可以在<a class="ae lh" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref.htm" rel="noopener ugc nofollow" target="_blank"> Tableau的REST API参考</a>中阅读所有相关内容。在本教程中，我们将放大查询<a class="ae lh" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref_permissions.htm#query_workbook_permissions" rel="noopener ugc nofollow" target="_blank">工作簿权限</a>。</p><p id="812b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里演示的概念旨在强调什么是可能的，并且可以扩展到其他权限模型，如视图和数据源。如何将这些例子应用到您自己的产品代码中是您自己的选择。</p><p id="30da" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe ni nj nk nl b">tableau-api-lib</code>库中的所有功能都基于Tableau REST API。如果你选择使用另一个库，比如Tableau的<code class="fe ni nj nk nl b">tableau-server-client</code>(或者从头开始编写你自己的代码)，请注意本教程依赖于<code class="fe ni nj nk nl b">tableau-api-lib</code>中的帮助函数，这些函数旨在为我们做很多繁重的工作。</p><p id="9e7c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在高层次上，我们的目标是获得一个Pandas数据框架，它描述了每个工作簿的组及其各自用户的所有权限。以下是相关的里程碑:</p><ol class=""><li id="68b3" class="nm nn it lk b ll lm lo lp lr no lv np lz nq md nr ns nt nu bi translated">创建一个占位符Pandas DataFrame来存储所有权限</li><li id="9d53" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">获取描述我们所有工作簿的熊猫数据框架</li><li id="6e11" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">获得一个描述我们环境中所有群体的熊猫数据框架</li><li id="56d0" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">遍历每个工作簿，获取每个组和该组中每个用户的权限，并将数据追加到我们的占位符数据框架中</li><li id="b5c3" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">获得一个描述我们环境中所有用户的熊猫数据框架</li><li id="87ed" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">遍历每个工作簿，获取单个用户的权限(用户级，而不是组级),并将数据追加到我们的占位符数据框架中</li><li id="0557" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">将结果数据帧输出到一个CSV文件，该数据帧描述了我们工作簿的所有组和用户权限</li><li id="b7bb" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">使用Tableau Desktop连接到CSV文件并与结果进行交互</li></ol><h2 id="043c" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤1:确保你已经安装了tableau-api-lib</h2><p id="9505" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">即使你是这些教程的专家，帮自己一个忙，下载最新版本的库。它定期更新。</p><p id="29b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe ni nj nk nl b">pip install --upgrade tableau-api-lib</code></p><p id="acc5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">不熟悉Python这个东西？别担心，你会很快明白的。跟随<a class="ae lh" href="https://medium.com/snake-charmer-python-and-analytics/tableau-server-on-tap-getting-started-89bc5f0095fa" rel="noopener">这个入门教程</a>。该教程将引导您使用tableau-api-lib连接到Tableau服务器。</p><h1 id="8840" class="oa mm it bd mn ob oc od mq oe of og mt ki oh kj mw kl oi km mz ko oj kp nc ok bi translated">步骤2:进入Tableau服务器环境</h1><p id="864d" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">使用下面的代码作为连接到您的服务器的模板。在接下来的步骤中，我们将使用一次性代码行来构建这个boiler板。在本文的最后，您会发现一个合并的代码块，为了方便起见，您可以复制/粘贴它。</p><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="68fb" class="ml mm it nl b gy op oq l or os">import pandas as pd</span><span id="dc5c" class="ml mm it nl b gy ot oq l or os">from tableau_api_lib import TableauServerConnection<br/>from tableau_api_lib.utils import querying, flatten_dict_column, flatten_dict_list_column</span><span id="8a83" class="ml mm it nl b gy ot oq l or os">tableau_server_config = {<br/>        'my_env': {<br/>                'server': '<a class="ae lh" href="https://tableaupoc.interworks.com%27/" rel="noopener ugc nofollow" target="_blank">https://YourTableauServer.com'</a>,<br/>                'api_version': '&lt;YOUR_API_VERSION&gt;',<br/>                'username': '&lt;YOUR_USERNAME&gt;',<br/>                'password': '&lt;YOUR_PASSWORD&gt;',<br/>                'site_name': '&lt;YOUR_SITE_NAME&gt;',<br/>                'site_url': '&lt;YOUR_SITE_CONTENT_URL&gt;'<br/>        }<br/>}</span><span id="d68b" class="ml mm it nl b gy ot oq l or os">conn = TableauServerConnection(tableau_server_config, env='my_env')<br/>conn.sign_in()</span></pre><p id="fa83" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有趣的事实:你也可以使用个人访问令牌，假设你在Tableau Server 2019.4或更新版本上。如果你对访问令牌很感兴趣，可以看看我的文章，了解如何使用它们的细节。</p><h2 id="1359" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤3(可选):了解相关的API端点</h2><p id="033f" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">本教程深入探讨了两个端点:</p><ol class=""><li id="ae8d" class="nm nn it lk b ll lm lo lp lr no lv np lz nq md nr ns nt nu bi translated">【查询工作簿权限】的<a class="ae lh" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref_permissions.htm#query_workbook_permissions" rel="noopener ugc nofollow" target="_blank">端点</a></li><li id="cc6e" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">【站点查询工作簿】<a class="ae lh" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref_workbooks_and_views.htm#query_workbooks_for_site" rel="noopener ugc nofollow" target="_blank">端点</a></li><li id="ef79" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated">【查询组】的<a class="ae lh" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref_users_and_groups.htm#query_groups" rel="noopener ugc nofollow" target="_blank">端点</a></li><li id="9c5f" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated"><a class="ae lh" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref_users_and_groups.htm#get_users_in_group" rel="noopener ugc nofollow" target="_blank">端点</a>中的“获取用户组”</li><li id="0afb" class="nm nn it lk b ll nv lo nw lr nx lv ny lz nz md nr ns nt nu bi translated"><a class="ae lh" href="https://help.tableau.com/current/api/rest_api/en-us/REST/rest_api_ref_users_and_groups.htm#get_users_on_site" rel="noopener ugc nofollow" target="_blank">端点</a></li></ol><p id="5bb7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的链接将带您进入Tableau的REST API文档，该文档提供了一些技术指导和对这些端点如何工作的解释。</p><p id="ff38" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这些端点中的每一个，tableau-api-lib库都有一个以<code class="fe ni nj nk nl b">snake_case</code>格式镜像名称的方法，这样“查询工作簿权限”就变成了“query_workbook_permissions()”。</p><h2 id="0195" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤4:创建一个占位符熊猫数据框架</h2><p id="9e6f" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">这一步创建了一个空的数据帧，我们将向其追加数据:</p><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="fcd1" class="ml mm it nl b gy op oq l or os">workbook_permissions_df = pd.DataFrame()</span></pre><h2 id="3def" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤5:获得一个描述所有工作簿的熊猫数据框架</h2><p id="aabf" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">当我们收到描述我们工作簿的数据时，一些关于相关项目的信息包含在名为<code class="fe ni nj nk nl b">project</code>的嵌套列中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/ff7c6b73ee42dd6804fe2690595b6fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vr8SRkKxW3okJTTfVmCWyA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">“项目”列本身是一个字典，填充了键/值对。</p></figure><p id="733b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们使用<code class="fe ni nj nk nl b">flatten_dict_column</code>函数来删除该列中的有用信息。</p><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="17f4" class="ml mm it nl b gy op oq l or os">workbooks_df = querying.get_workbooks_dataframe(conn)[["project", "name", "id"]]<br/>workbooks_df = flatten_dict_column(df=workbooks_df, keys=["id", "name"], col_name="project")<br/>workbooks_df.rename(columns={"id": "workbook_id", "name": "workbook_name"}, inplace=True)<br/>workbooks_df</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/a7c0123c0988e01214246819f10c8eab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-6DhhOWnbO-8vCZFm-9Xzw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">“项目”栏已被展平，将“项目标识”和“项目名称”分开。</p></figure><h2 id="3afa" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">第六步:获得描述所有群体的熊猫数据框架</h2><p id="1292" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">当我们查询工作簿的权限时，我们将收到与任何给定组相关的权限规则信息。这是由组的本地唯一标识符(LUID)唯一标识的，我们将需要关于每个组的一些附加信息。</p><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="fe21" class="ml mm it nl b gy op oq l or os">groups_df = querying.get_groups_dataframe(conn)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/bf45f7522d6f4c2ecedaebbb4dd5209f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3iNMAwiwLG2QfraQdfFKWg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">现在，我们可以使用用户友好的组名了。</p></figure><h2 id="df55" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤7:迭代我们的工作簿和查询权限</h2><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="bec6" class="ml mm it nl b gy op oq l or os">for _, workbook in workbooks_df.iterrows():<br/>    print(f"fetching group permissions for workbook '{workbook.workbook_name}...'")<br/>    response = conn.query_workbook_permissions(workbook_id=workbook.workbook_id)<br/>    permissions_df = pd.DataFrame(response.json()["permissions"]["granteeCapabilities"])<br/>    if "group" not in permissions_df.columns:<br/>        continue<br/>    permissions_df = permissions_df[permissions_df["group"].notnull()]<br/>    permissions_df = flatten_dict_column(df=permissions_df, keys=["id"], col_name="group")<br/>    permissions_df = flatten_dict_list_column(df=permissions_df, col_name="capabilities")<br/>    permissions_df = flatten_dict_column(df=permissions_df, keys=["name", "mode"], col_name="capability")<br/>    permissions_df["workbook_id"] = workbook.workbook_id<br/>    permissions_df["workbook_name"] = workbook.workbook_name<br/>    permissions_df["project_name"] = workbook.project_name<br/>    permissions_df["project_id"] = workbook.project_id<br/>    permissions_df["join_col"] = 1<br/><br/>    all_group_users_df = pd.DataFrame()<br/>    group_ids = permissions_df.group_id.unique()<br/>    for index, group_id in enumerate(group_ids):<br/>        print(f"joining users from group '{group_id}'")<br/>        group_users_df = querying.get_group_users_dataframe(conn=conn, group_id=group_id)<br/>        group_users_df.rename(columns={"name": "user_name", "id": "user_id"}, inplace=True)<br/>        group_users_df["join_col"] = index<br/>        group_df = groups_df[groups_df["id"] == group_id].copy()[["id", "name"]]<br/>        group_df = group_df.add_prefix("group_")<br/>        group_df["join_col"] = index<br/>        all_group_users_df = pd.concat([all_group_users_df, pd.merge(group_users_df, group_df, how="inner", on="join_col")])<br/><br/>    workbook_permissions_df = pd.concat(<br/>        [workbook_permissions_df, permissions_df.merge(all_group_users_df, on=["group_id"])]<br/>    )</span></pre><p id="eb4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的逻辑遍历每个工作簿。对于每个工作簿，获取并加入相关的组及其各自的用户。结果是，我们获得了一个数据框架，描述了为每个工作簿分配的所有组级权限。</p><p id="f905" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这可能需要一些时间，取决于您的Tableau环境的大小。如果工作簿的数量非常大，您可能需要考虑将此逻辑隔离到工作簿的一个子集(按项目过滤等)。</p><h2 id="d521" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤8(可选):获得一个描述所有用户的熊猫数据帧</h2><p id="c98e" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">如果您定义了任何特定于用户的权限，那么您还会希望获取每个工作簿的权限，其中权限是特定于用户而不是组的。提醒一下，这通常是一种不好的做法。最好将用户分配到组中，然后将权限分配给这些组。</p><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="7847" class="ml mm it nl b gy op oq l or os">users_df = querying.get_users_dataframe(conn)<br/>users_df.rename(columns={"id": "user_id", "name": "user_name"}, inplace=True)</span></pre><h2 id="b742" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤9(可选):遍历我们的工作簿和查询权限</h2><p id="567f" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">与查询组级权限非常相似，我们将遍历工作簿并查询用户级权限。</p><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="ae04" class="ml mm it nl b gy op oq l or os">for _, workbook in workbooks_df.iterrows():<br/>    print(f"fetching user permissions for workbook '{workbook.workbook_name}...'")<br/>    response = conn.query_workbook_permissions(workbook_id=workbook.workbook_id)<br/>    permissions_df = pd.DataFrame(response.json()["permissions"]["granteeCapabilities"])<br/>    if "user" not in permissions_df.columns:<br/>        continue<br/>    permissions_df = permissions_df[permissions_df["user"].notnull()]<br/>    permissions_df = flatten_dict_column(df=permissions_df, keys=["id"], col_name="user")<br/>    permissions_df = flatten_dict_list_column(df=permissions_df, col_name="capabilities")<br/>    permissions_df = flatten_dict_column(df=permissions_df, keys=["name", "mode"], col_name="capability")<br/>    permissions_df["workbook_id"] = workbook.workbook_id<br/>    permissions_df["workbook_name"] = workbook.workbook_name<br/>    permissions_df["project_name"] = workbook.project_name<br/>    permissions_df["project_id"] = workbook.project_id<br/>    permissions_df["join_col"] = 1<br/><br/>    workbook_permissions_df = pd.concat(<br/>        [workbook_permissions_df, permissions_df.merge(users_df, on=["user_id"])]<br/>    )</span></pre><p id="df4e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我们查询组级别的权限时，我们最终得到了用户级别的数据，但是请注意不同之处:这些是属于特定组的用户。上面的查询是查询不与任何给定组相关联的用户权限(同样，用户级权限规则通常是一种不好的做法)。</p><h2 id="0d42" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤10:将最终权限数据输出到CSV</h2><p id="04b6" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">现在我们有了一个描述所有权限的Pandas数据框架，我们可以使用它了。对于本教程，我们希望将数据输出到一个文件，然后使用Tableau连接到它。在您自己的使用中，考虑将数据写入数据库或以其他方式存储它，但这对于您的工作流是有意义的。</p><pre class="ks kt ku kv gt ol nl om on aw oo bi"><span id="4b7c" class="ml mm it nl b gy op oq l or os">workbook_permissions_df.to_csv("workbook_permissions.csv", sep=",", header=True, index=False)</span></pre><h2 id="f2e1" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">步骤11:连接Tableau桌面中的数据并进行交互</h2><p id="227e" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">本教程假设熟悉Tableau桌面。如果您不知道如何在Tableau中连接到CSV文件，有许多免费文章、YouTube视频和Tableau论坛可以提供帮助。</p><p id="0192" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是一个与最终数据交互的例子。这是一个非常基本的Tableau工作表，但是请注意，我可以很容易地过滤到特定的用户、组、站点角色等。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/ce526cbb6a4fc375099c3b0e9346d1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Job3hPLyc8kKvltj168zA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">我们现在可以利用权限数据了。</p></figure><p id="19be" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面的屏幕截图中，我们可以很容易地识别不同工作簿的组级和用户级权限。在这种情况下，<code class="fe ni nj nk nl b">Null</code>组名表示权限不与任何组相关联，这意味着它们是用户级权限。</p><h2 id="e2f1" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">包装它</h2><p id="9669" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">希望本教程有助于展示一种可行的方法，提取您需要了解的关于Tableau环境中内容权限的信息。</p><p id="0ad7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后一点:我强烈建议您组织您的权限模型，始终在项目级别锁定权限，并且只在组级别而不是用户级别分配权限。</p><h2 id="121e" class="ml mm it bd mn mo mp dn mq mr ms dp mt lr mu mv mw lv mx my mz lz na nb nc iz bi translated">合并代码</h2><p id="c034" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">使用GitHub gist作为模板，将本教程的内容集成到您自己的工作流程中。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="oy oz l"/></div></figure></div></div>    
</body>
</html>