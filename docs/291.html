<html>
<head>
<title>Identifying Tweet Sentiment in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中识别推文情感</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/identifying-tweet-sentiment-in-python-7c37162c186b#2022-01-10">https://towardsdatascience.com/identifying-tweet-sentiment-in-python-7c37162c186b#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="6fc4" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">在Python中识别推文情感</h1></div><div class=""><h2 id="6152" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Tweepy和Textblob识别推文情感</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/6aa186210daf59d46c84a40076771bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*faGEUVJSK573rD1uMGP8Iw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片来自<a class="ae ku" href="https://unsplash.com/@ymoran" rel="noopener ugc nofollow" target="_blank">埃德加·莫兰</a>拍摄的<a class="ae ku" href="https://unsplash.com/photos/92PmjawKUfs" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="c5ac" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这篇文章的目的是为读者提供关于<a class="ae ku" href="https://www.tweepy.org/" rel="noopener ugc nofollow" target="_blank"> tweepy </a>和<a class="ae ku" href="https://textblob.readthedocs.io/en/dev/" rel="noopener ugc nofollow" target="_blank"> textblob </a>库的入门指南。本文将涵盖下面目录中列出的下列主题。</p><p id="747d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">目录<br/> </strong> - Twitter API凭证<br/> -连接Twitter API <br/> -抓取Twitter数据<br/> -清理Tweet数据<br/> -情感分析<br/> -结束语<br/> -资源</p><h1 id="cda0" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">Twitter API凭证</h1><p id="d183" class="pw-post-body-paragraph kv kw it kx b ky mj ju la lb mk jx ld le ml lg lh li mm lk ll lm mn lo lp lq im bi translated">获得连接到twitter API所需的凭证相当简单，首先要创建一个twitter帐户。请注意，如果你是学生，你有更高的机会被Twitter接受，如果你不是学生，并且想出于非教育/研究目的这样做(例如，如果它将被应用到公司的产品中)，那么Twitter的准则对你的要求和细节就要高得多。</p><p id="c1fa" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">要开始这个过程，你需要创建一个twitter开发者账户，这可以在<a class="ae ku" href="https://developer.twitter.com/en/portal/petition/essential/basic-info" rel="noopener ugc nofollow" target="_blank">这里</a>完成。接下来，你需要向Twitter提供一些细节，说明你为什么想要访问开发者账户，理由可能是进行研究、建立网络、探索API等等。这一流程非常广泛，因为Twitter要求提供许多至少100个字符的详细信息，然后Twitter开发人员会审查您提交的产品&amp;应用程序的API访问权限，您应该会看到关于该流程的接受/拒绝通知。</p><p id="eca4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">最后，一旦你的申请被批准，你就可以前往<a class="ae ku" href="https://developer.twitter.com/en/portal/dashboard" rel="noopener ugc nofollow" target="_blank"> twitter开发者平台</a>继续你的应用程序。转到<code class="fe mo mp mq mr b">Keys and tokens</code>选项卡，生成必要的API键来连接twitter API。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/156b249b45d72ef6e048425159940764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m4K7EouCFYwf_CG7-W-C2A.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">在生成您的API密钥和令牌时，它应该类似于下图。(图片由作者提供)</p></figure><p id="350d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果您仍然有问题，Twitter已经在他们的文档中写了一份关于如何连接API的详细指南:</p><div class="mx my gp gr mz na"><a href="https://developer.twitter.com/en/docs/twitter-api/getting-started/getting-access-to-the-twitter-api" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">访问Twitter API</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">注册一个开发者帐户又快又简单！只要点击下面的按钮，回答几个问题，你…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">developer.twitter.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no ko na"/></div></div></a></div><h1 id="23b0" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">连接到Twitter API</h1><p id="0cef" class="pw-post-body-paragraph kv kw it kx b ky mj ju la lb mk jx ld le ml lg lh li mm lk ll lm mn lo lp lq im bi translated">在连接到twitter API之前，您必须首先满足必要的安装要求。本文中概述的代码是在以下库和版本上编写的:</p><pre class="kj kk kl km gt np mr nq nr aw ns bi"><span id="65d6" class="nt ls it mr b gy nu nv l nw nx">Python=3.8.8<br/>pandas=1.2.4<br/>numpy=1.20.1<br/>textblob=0.17.1<br/>tweepy=4.4.0<br/>matplotlib=3.3.4<br/>python-dotenv=0.19.2</span></pre><p id="2b26" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">一旦满足了必要的安装要求，就可以创建一个名为<code class="fe mo mp mq mr b">.env</code>的环境文件来存储上面从twitter仪表板生成的密钥。您可以使用dotenv和os模块来引用此环境文件。这将允许您的登录凭据保持匿名。环境文件可以具有以下格式:</p><pre class="kj kk kl km gt np mr nq nr aw ns bi"><span id="92a2" class="nt ls it mr b gy nu nv l nw nx">twitter_api_key=''<br/>twitter_secret=''<br/>twitter_bearer=''<br/>twitter_access_token=''<br/>twitter_access_token_secret=''</span></pre><p id="f3d0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">请注意，当将您的工作推送到Github帐户时，您可能希望将<code class="fe mo mp mq mr b">.env</code>添加到<code class="fe mo mp mq mr b">.gitignore</code>文件中，这样环境文件就不会被推送到git。</p><p id="5472" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，通过下面的代码片段可以很容易地连接到API。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h1 id="f11a" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">抓取Twitter数据</h1><p id="b92a" class="pw-post-body-paragraph kv kw it kx b ky mj ju la lb mk jx ld le ml lg lh li mm lk ll lm mn lo lp lq im bi translated">现在已经建立了到twitter API的连接，让我们对API进行一些调用来获取一些tweet数据。出于本教程的目的，我们将从GTA的警察账户中收集推文，目的是识别与推文相关的情绪。我在下面概述了创建名为data的目录并存储与列表中传递的twitter句柄相关的最新tweet数据的各种函数。这些功能相互配合，以<code class="fe mo mp mq mr b">.csv</code>文件的形式获取和存储数据。注意函数<code class="fe mo mp mq mr b">get_all_tweets</code>是从<a class="ae ku" href="https://gist.github.com/yanofsky/5436496" rel="noopener ugc nofollow" target="_blank">亚诺夫斯基</a>重新转换而来的。由于我们使用twitter API的免费层，我们可以从用户那里获取的tweet数量有限制，yanofsky发现了一种从超过限制的用户那里获取tweet的好方法。基本上，如果多伦多警察局在其整个twitter职业生涯中有10，000条推文，twitter API将在获取100条推文后达到上限(这100条推文将是用户的最新100条推文)。Yanofsky的解决方案现在允许我们从该用户那里获取近3000条推文。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="43e1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">上面代码的结果应该会产生一个tweets_df，包含以下几列:</p><pre class="kj kk kl km gt np mr nq nr aw ns bi"><span id="7b9d" class="nt ls it mr b gy nu nv l nw nx">['author_name', 'tweet_id', 'tweet_created_at', 'content', 'hashtags', 'location', 'author_created_at', 'author_url', 'author_screen_name', 'tweet_favourite_count', 'tweet_favourited', 'retweet_count', 'retweeted', 'author_followers_count', 'author_friends_count']</span></pre><h1 id="81c5" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">清理推文数据</h1><p id="cdfb" class="pw-post-body-paragraph kv kw it kx b ky mj ju la lb mk jx ld le ml lg lh li mm lk ll lm mn lo lp lq im bi translated">在进行情感分析之前，最好对推文进行一些初步清理。像删除停用词和标点符号这样简单的事情会对情感分析的结果产生很大的影响。下面的函数就是这样做的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h1 id="e7ac" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">情感分析</h1><p id="7d3a" class="pw-post-body-paragraph kv kw it kx b ky mj ju la lb mk jx ld le ml lg lh li mm lk ll lm mn lo lp lq im bi translated">textblob库有一个不错的内置函数，可以对推文进行情感分析。由此产生的情绪是指对推文的情绪或态度。它产生的分数上限为1，下限为-1。更接近-1的分数可以视为一条<code class="fe mo mp mq mr b">negative</code>推文，同样，更接近1的分数可以视为一条<code class="fe mo mp mq mr b">positive</code>推文。等于0的分数通常是<code class="fe mo mp mq mr b">neutral</code>(即既非正也非负)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="db60" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这导致了以下GTA中警察部门发布的正面、负面和中性推文的分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oa"><img src="../Images/867dd5a3b15e02b05b5829904b1c495f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KAJdQcTWUb505XjXwgR8dg.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由作者提供</p></figure><p id="17cf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">令人惊讶的是，积极的推文比消极的多，然而大多数是中性的。查看与每个标签相关的推文样本，我们可以尝试看看这个情感评分表现如何。</p><p id="de4e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">正面推文的随机样本:</strong></p><pre class="kj kk kl km gt np mr nq nr aw ns bi"><span id="4f0d" class="nt ls it mr b gy nu nv l nw nx">tweets_df[tweets_df['tweet_sentiment'] == 'Positive'].content.sample(3).values</span><span id="10aa" class="nt ls it mr b gy ob nv l nw nx">Smartest idea we've heard all night! Way to be a responsible driver! ^MRT <a class="ae ku" href="https://t.co/htkoL5EpKJ" rel="noopener ugc nofollow" target="_blank">https://t.co/htkoL5EpKJ</a>"</span><span id="e59d" class="nt ls it mr b gy ob nv l nw nx">Hanukkah Sameach! May this festival of light and joy bring blessings of health, happiness and prosperity. <a class="ae ku" href="https://t.co/0bq0dKNFc3" rel="noopener ugc nofollow" target="_blank">https://t.co/0bq0dKNFc3</a>'</span><span id="012a" class="nt ls it mr b gy ob nv l nw nx">RT @CACP_ACCP: On this National Day of Remembrance &amp;amp; Action on Violence Against Women, we are proud to launch the Canadian Framework for Co…'</span></pre><p id="c3d2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">负面推文的随机样本:</strong></p><pre class="kj kk kl km gt np mr nq nr aw ns bi"><span id="cdea" class="nt ls it mr b gy nu nv l nw nx">tweets_df[tweets_df['tweet_sentiment'] == 'Negative'].content.sample(3).values</span><span id="a993" class="nt ls it mr b gy ob nv l nw nx">COLLISION:\nFGX/Parklawn, single vehicle involved, E/B express lanes approaching Lakeshore exit, 2 lanes closed.… <a class="ae ku" href="https://t.co/Pz5hBIC0H9" rel="noopener ugc nofollow" target="_blank">https://t.co/Pz5hBIC0H9</a></span><span id="7c6f" class="nt ls it mr b gy ob nv l nw nx">@Toronto_Fire @TorontoMedics FIRE: (UPDATE)\nDunn Ave &amp;amp; Queen St W\n- roads have re-opened\n#GO1455141\n^al</span><span id="0679" class="nt ls it mr b gy ob nv l nw nx">Bollywood superstar's son walks out from jail in drugs case\nhttps://t.co/Yf9ytlkNiF <a class="ae ku" href="https://t.co/vsdkYzQnad" rel="noopener ugc nofollow" target="_blank">https://t.co/vsdkYzQnad</a></span></pre><p id="e78f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">中立推特的随机样本:</strong></p><pre class="kj kk kl km gt np mr nq nr aw ns bi"><span id="f2c0" class="nt ls it mr b gy nu nv l nw nx">tweets_df[tweets_df['tweet_sentiment'] == 'Neutral'].content.sample(3).values</span><span id="ce1b" class="nt ls it mr b gy ob nv l nw nx">Remember to follow our @DRPSCommunity account for helpful safety tips during Crime Prevention Week. #CPWeek2020 <a class="ae ku" href="https://t.co/vGO8saST4r" rel="noopener ugc nofollow" target="_blank">https://t.co/vGO8saST4r</a></span><span id="19ae" class="nt ls it mr b gy ob nv l nw nx">The #BarriePolice is reminding the public that you DO NOT have to pay money to receive a lottery prize. If you get… <a class="ae ku" href="https://t.co/G5H2dsc468" rel="noopener ugc nofollow" target="_blank">https://t.co/G5H2dsc468</a></span><span id="0a16" class="nt ls it mr b gy ob nv l nw nx">Road closure on Dundas St East in Whitby between Hopkins and Craydon for Police Investigation.</span></pre><h1 id="eb61" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">结束语</h1><p id="3703" class="pw-post-body-paragraph kv kw it kx b ky mj ju la lb mk jx ld le ml lg lh li mm lk ll lm mn lo lp lq im bi translated">总的来说，本文展示了如何通过开发者门户访问twitter API、连接到它、获取与用户句柄相关的tweet、执行简单的文本清理以及识别与tweet相关的情感。基于正面、负面和中性推文的随机小样本，模型的表现似乎不会太差。很明显，这个样本太小了，无法对情感分析的性能做出任何明确的陈述，然而对于第一遍来说，它似乎并不太糟糕。</p><p id="5935" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这个过程可以被复制，用于分析来自twitter或其他来源的任何其他主题。这篇文章关注的是从警察局发来的推文，但是从健康组织、政治家、你的朋友等发来的推文也有同样的结果。只需对代码做最少的改动。将此作为你自己探索的起点！</p><h1 id="4b39" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">资源</h1><ul class=""><li id="d5c6" class="oc od it kx b ky mj lb mk le oe li of lm og lq oh oi oj ok bi translated"><a class="ae ku" href="https://gist.github.com/yanofsky/5436496" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/yanofsky/5436496</a></li><li id="f03f" class="oc od it kx b ky ol lb om le on li oo lm op lq oh oi oj ok bi translated"><a class="ae ku" href="https://textblob.readthedocs.io/en/dev/quickstart.html#sentiment-analysis" rel="noopener ugc nofollow" target="_blank">https://text blob . readthedocs . io/en/dev/quick start . html #情绪分析</a></li><li id="a6e3" class="oc od it kx b ky ol lb om le on li oo lm op lq oh oi oj ok bi translated"><a class="ae ku" href="https://developer.twitter.com/en/portal/dashboard" rel="noopener ugc nofollow" target="_blank">https://developer.twitter.com/en/portal/dashboard</a></li></ul></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="9ae2" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果你喜欢这篇文章，我写了更多你可能也会喜欢的文章</p><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/word2vec-explained-49c52b4ccb71"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">Word2Vec解释道</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">解释Word2Vec的直观性&amp;用Python实现它</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="ox l nl nm nn nj no ko na"/></div></div></a></div><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/recommendation-systems-explained-a42fc60591ed"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">推荐系统解释</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">用Python解释和实现基于内容的协同过滤和混合推荐系统</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="oy l nl nm nn nj no ko na"/></div></div></a></div><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/bayesian-a-b-testing-explained-344a6df88c1a"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">贝叶斯A/B测试解释</h2><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="oz l nl nm nn nj no ko na"/></div></div></a></div><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/random-walks-with-restart-explained-77c3fe216bca"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">带重启的随机漫步解释</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">理解带重启的随机游走算法及其在Python中的相关实现</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="pa l nl nm nn nj no ko na"/></div></div></a></div><div class="mx my gp gr mz na"><a rel="noopener follow" target="_blank" href="/markov-chain-explained-210581d7a4a9"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">马尔可夫链解释道</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">在本文中，我将解释并提供马尔可夫链的python实现。这篇文章不会是一篇深刻的…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">towardsdatascience.com</p></div></div><div class="nj l"><div class="pb l nl nm nn nj no ko na"/></div></div></a></div></div></div>    
</body>
</html>