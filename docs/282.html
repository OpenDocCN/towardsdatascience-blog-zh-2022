<html>
<head>
<title>How (not) to do MLOps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何(不)做MLOps</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-not-to-do-mlops-96244a21c35e#2022-01-10">https://towardsdatascience.com/how-not-to-do-mlops-96244a21c35e#2022-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/f38edb1eeefde644cf4faab960b558ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSw-njRsFwVlqbTElIX8oQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">凯文·Ku在<a class="ae jd" href="https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""><h1 id="46f1" class="pw-post-title je jf jg bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">如何(不)做MLOps</h1></div><p id="bf07" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最初发表于我的<a class="ae jd" href="https://abhijithc.com/learning/mlops/mlengineering/2022/01/09/how-not-to-do-mlops.html" rel="noopener ugc nofollow" target="_blank">博客</a>。</p><p id="d390" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的公司——嗯，我的团队——组织了一个叫做读报俱乐部的组织。这个想法是让我们每个人向整个团队提交一篇论文，我们觉得这篇论文很吸引人，并且与我们的工作相关。因此，对于几周前举行的论文展示会议，我决定展示<a class="ae jd" href="https://arxiv.org/abs/2107.00079" rel="noopener ugc nofollow" target="_blank">“使用反模式避免MLOps错误”</a>。</p><p id="5e98" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自去年以来，我们一直在关注MLOps和ML Engineering。我主要是一名数据科学家，但也是MLOps团队的一员，我发现这篇文章与我们的工作非常相关。</p><blockquote class="lb lc ld"><p id="7aae" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated"><em class="jg">“正如设计模式编纂最佳软件工程实践一样，</em> <strong class="kf jh">反模式</strong> <em class="jg">提供了一个词汇来描述有缺陷的实践和方法。”</em></p></blockquote><p id="5a0a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些实践包括整个ML模型部署生命周期的步骤，包括性能跟踪、监控等部署后任务。定义了九种反模式。我也加入了我在建造模型和大规模部署它们的经验中的一些想法。</p><blockquote class="lb lc ld"><p id="76bc" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated"><em class="jg">💡还有一个关于</em> <a class="ae jd" href="https://abhijithc.com/learning/mlops/mlengineering/2022/01/09/[https://thedataexchange.media/mlops-anti-patterns/](https://thedataexchange.media/mlops-anti-patterns/)" rel="noopener ugc nofollow" target="_blank"> <em class="jg">数据交换</em> </a> <em class="jg">的不错的播客，你可以听听。</em></p></blockquote><h1 id="5e96" class="li lj jg bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">现在从这些反模式开始…</h1><h2 id="ffc1" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">数据泄露</h2><p id="3ee8" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">我们试图避免的最大和最常见的问题之一是数据集中的信息泄露。模型使用了不应该使用的数据/信息(或在推断过程中不可用的数据/信息),这在我们的评估阶段给了我们不正确的结果。当训练-测试分割不是按顺序进行时，时间序列数据也容易出现这种情况。对于不平衡数据，执行不正确的过采样是另一个例子——在将数据分成训练集和测试集之前进行过采样。其他示例包括预处理阶段，在训练测试分割之前，再次执行标准归一化。</p><h2 id="4755" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">立即行动，不要反思</h2><p id="89e9" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">大多数时候，来自我们模型的预测被直接使用，没有任何检查、过滤甚至检验。这导致围绕概念漂移和错误预测的问题。</p><p id="e6b4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">避免这种情况的一个好方法是定义系统和过程来研究数据和预测的偏差。数据漂移仪表板—可以监控和跟踪数据指标的简单仪表板在这里非常有用，即使是手动检查。预测也可以通过这样的仪表板，简单的聚合指标和图表可以用来跟踪预测的分布。如果在违反某些阈值时发出警报，就可以避免大量的调试工作。</p><h2 id="a986" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">地毯下的调谐</h2><p id="9952" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">虽然我不一定理解这是严格的反模式，但我绝对认为这是一个很好的指导原则，可以节省大量的金钱和时间。这与超参数是如何调整的有关。作者提出，超参数空间的随机搜索(在定义的范围内)产生了计算上廉价并且与网格搜索等效的替代方案。这会给你的迭代(周期)和成本带来很大的不同。记录与超参数相关的一切也是非常重要的，以便它是可重复的(包括使用的随机种子)。</p><p id="212f" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我个人发现像<a class="ae jd" href="https://wandb.ai/site" rel="noopener ugc nofollow" target="_blank">权重和偏见</a>和<a class="ae jd" href="https://neptune.ai/" rel="noopener ugc nofollow" target="_blank"> Neptune.ai </a>这样的工具在这里非常有用。这些工具成倍地增加了你的实验周期，这是在大多数公司应用ML解决问题时最重要的实践。</p><h2 id="2ebb" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">PEST——感知的经验优势</h2><p id="5971" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">机器学习研究是由理论建议的经验验证和确认驱动的。对应用机器学习研究的新贡献包括(I)验证以前未验证的理论建议，(ii)结合经验验证的新理论建议，或(iii)对现有学习管道的有效扩充，以产生改进的经验性能。作者提到，通常新提出的ML方法的经验验证是不充分的，有缺陷的，或发现有所欠缺的，这导致了术语PEST的定义。他们谈到需要相同的实验管道来比较和评估ML模型。</p><h2 id="d65c" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">不良信用转让</h2><p id="d104" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">该反模式讨论了未能正确识别性能提高的原因。虽然您的模型架构和那些超级调整的超参数将提升您的性能，但未能将(可能的)收益归因于其他任务，如巧妙的问题表述、某些预处理步骤等。可能会导致未来的问题。</p><p id="4f5c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">扩展前面提到的数据漂移仪表板，并使用实验跟踪工具，人们应该能够从部署的每个模型中定义推论，以便能够适当地进行属性划分。</p><h2 id="9b98" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">给自己的考试打分</h2><p id="b144" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">这些都是不正确的评估和验证实践所带来的问题。测试和评估数据应独立采样，对于稳健的性能分析，应在模型开发完成之前保持隐藏，并且只能用于最终评估。</p><p id="c5c6" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">解决这个问题的一个方法是投资特色商店。这些可以是独立的地面真相系统，由数据管道驱动，定期创建您的训练测试数据集，确保您总是可以有看不见的测试集。</p><h2 id="5e7e" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">一劳永逸</h2><p id="df8a" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">说到模特训练，我们很多人都是这种心态。这个反模式讨论了概念漂移和建立模型再培训作业和管道的合理需求。围绕贝叶斯模型已经有了一些工作，用于概念漂移的检测和适应。</p><p id="c807" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">前面提到的推断仪表板可以帮助捕捉这些漂移，只需通过人工检查。当然，这也可以自动化。</p><h2 id="b97c" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">带着矛盾的心情交流</h2><p id="5dd2" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">预测很重要，但预测中的不确定性可能更重要。对于基于模型预测做出决策的情况，以及这些决策是否至关重要(与财务、健康等相关)。)那么这些不确定性就变得至关重要了。报告预测不确定性的机制变得很重要，如果出现问题，可以启用后备系统和更有信心的模型。</p><h2 id="91e9" class="mg lj jg bd lk mh mi dn lo mj mk dp ls ko ml mm lw ks mn mo ma kw mp mq me mr bi translated">最后，数据危机即服务</h2><p id="2712" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">回到特征(数据)存储的概念。每一个产生你的数据的管道都应该被记录下来，并且详细的信息应该被传达。一种有效的方法是构建与要素存储同步的数据目录。这确保了新的管线可以容易地创建和调度，遵守特征存储的预定义标准，并且更重要的是，设置了能够在需要时复制这些管线的过程。这也有助于跟踪数据血统。</p><h1 id="f17e" class="li lj jg bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">作者的建议</h1><p id="4979" class="pw-post-body-paragraph kd ke jg kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">几十年来，技术债务一直让工程师望而却步。技术债务对我们来说(读ML的人)并不真正与软件工程相关，但它与数据管道、模型管道、模型(再)培训工作、反馈机制等等都有关系。</p><p id="8f07" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这些问题，他们提出了一些具体建议:</p><ul class=""><li id="e1e3" class="mx my jg kf b kg kh kk kl ko mz ks na kw nb la nc nd ne nf bi translated">使用这些反模式来设置流程以避免这些错误</li><li id="4c17" class="mx my jg kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated">使用断言来跟踪数据质量</li><li id="322d" class="mx my jg kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated">记录数据传承并创建“审计跟踪”</li><li id="84c3" class="mx my jg kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated">出现错误时，使用集合和后备系统</li><li id="9640" class="mx my jg kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated">在多个层面确保人在回路中的操作能力</li></ul></div></div>    
</body>
</html>