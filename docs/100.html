<html>
<head>
<title>Using Geospatial Data to Discover Volcanoes in Hawaii</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用地理空间数据发现夏威夷的火山</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-geospatial-data-to-discover-volcanoes-in-hawaii-67a15c18fa8f#2022-01-04">https://towardsdatascience.com/using-geospatial-data-to-discover-volcanoes-in-hawaii-67a15c18fa8f#2022-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="6c59" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""><h1 id="4736" class="pw-post-title iy iz iq bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">使用地理空间数据发现夏威夷的火山</h1></div><div class=""><h2 id="060e" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用地形数据和迁移学习的地理空间图像分割</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b4290977b709d162d956d328faa6af62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*80-CNOVtGYRZ4xelwIpfEQ.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">马克·塞格拉特在<a class="ae le" href="https://unsplash.com/s/photos/volcano-hawaii?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="af7f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated"><span class="l mc md me bm mf mg mh mi mj di"> P </span>语义图像分割的实际例子旨在以像素为基础识别特征，从<a class="ae le" href="https://smartlabai.medium.com/deep-learning-based-semantic-segmentation-in-simulation-and-real-world-for-autonomous-vehicles-e7fe25cef816" rel="noopener">无人驾驶汽车</a>到<a class="ae le" rel="noopener" target="_blank" href="/deep-learning-for-ship-detection-and-segmentation-71d223aca649">在卫星图像中检测船只</a>。但是那些不使用这些传统图像数据集的实际应用呢？</p><p id="165d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在本文中，我将通过一个语义分割的地理空间示例<strong class="lh ja"/>，在这里我们将<strong class="lh ja">使用数字高程模型(DEM)数据绘制夏威夷的煤渣锥</strong>。</p><p id="dbb2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们将从快速介绍<strong class="lh ja">什么是煤渣锥</strong>，以及如何使用<a class="ae le" href="https://qgis.org/en/site/index.html" rel="noopener ugc nofollow" target="_blank"> QGIS </a>快速<strong class="lh ja">创建一个带标签的数据集</strong>开始。然后，在<strong class="lh ja">用新数据测试我们训练好的模型</strong>之前，我们将经历一些<strong class="lh ja">数据处理</strong>和模型选择/训练。</p><h1 id="ff35" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">那么什么是煤渣锥呢？</h1><p id="64ea" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">根据美国地质调查局的定义:</p><blockquote class="nh ni nj"><p id="7d0b" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">“火山渣锥是最简单的火山类型。它们是由从一个单一的喷口喷出的凝结的熔岩颗粒和水滴构成的。…大多数煤渣锥在顶部都有一个碗状的坑……</p></blockquote><p id="43e0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是一张照片胜过千言万语，所以这里有一些煤渣锥的漂亮照片:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/d17bf221b1527848f1d3cdc6bc7938b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u41U2gwTL0rEA-Yx9LSw_A.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@jeffkingla?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰夫·金</a>在<a class="ae le" href="https://unsplash.com/s/photos/volcanic-cone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="21d0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以我们现在知道从空间的角度来看我们大概在寻找什么；<strong class="lh ja">侧面陡峭，中间有圆形弹坑的锥形特征。</strong></p><p id="3394" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">让我们继续看看这在我们的数据集中是什么样子。</strong></p><h1 id="0972" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">数据加载和标记</h1><p id="78b4" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">我们将为此使用的数据集是来自夏威夷群岛最大岛屿(由美国地质调查局提供)的DEM数据(又名地形数据)，在这里我们可以看到煤渣锥的形态。我们将绘制在休眠火山<a class="ae le" href="https://www.google.ru/maps/place/Mauna+Kea+Ice+Age+Natural+Area+Reserve/@19.8235951,-155.5825901,11.18z/data=!4m13!1m7!3m6!1s0x7bffdb064f79e005:0x4b7782d274cc8628!2sHawaii,+USA!3b1!8m2!3d19.8967662!4d-155.5827818!3m4!1s0x7953bdf95561b15d:0x582987cd20952faf!8m2!3d19.7915039!4d-155.4748835!5m1!1e4" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"/></a>上发现的火山渣锥，以建立一个模型，该模型将用于绘制附近火山<a class="ae le" href="https://www.google.ru/maps/place/Hual%C4%81lai/@19.6811034,-155.9165149,12.38z/data=!4m13!1m7!3m6!1s0x7bffdb064f79e005:0x4b7782d274cc8628!2sHawaii,+USA!3b1!8m2!3d19.8967662!4d-155.5827818!3m4!1s0x79540a70234d7c0f:0xdf4d56417549044!8m2!3d19.6890817!4d-155.8646894!5m1!1e4" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja">华莱</strong> </a>上的火山渣锥。</p><p id="a8e1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">QGIS是处理地理空间应用程序的一个很好的应用程序，将用于标记煤渣锥。加载作为. geotiff的数据，并将输出更改为10m等高线有助于我们可视化煤渣锥(<strong class="lh ja"> <em class="nk">提示:寻找紧密间隔的小同心等高线圆</em> </strong>):</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/e5ac711b70a95865de064899b688259d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S35PK4DUbIwzTtWhLYyOWQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">莫纳克亚山南翼煤渣锥等高线图(间隔10米)。图片作者。</p></figure><p id="57b8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">基于我们之前定义的空间标准，我们可以看到煤渣锥，所以现在<strong class="lh ja">我们需要映射它们</strong>来创建我们的<strong class="lh ja">标签遮罩</strong>。为了简单起见，我们可以假设煤渣锥是圆形的，因此使用圆形多边形作为标签是可以的，并创建一个圆形的形状文件。我们可以开始加载DEM geotiff和shapefile标签:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="2cd5" class="nu ml iq nq b gy nv nw l nx ny">#Loading a geotiff shapefile<br/>def readimage():<br/> print(‘reading image…’)<br/> with rasterio.open(path_image, ‘r’) as ds:<br/> arr = ds.read()<br/> arr = np.transpose(arr, (1, 2, 0))<br/> #Clip negative values to 0 <br/> arr = arr.clip(0)<br/> print(arr.shape)<br/> return arr</span><span id="3ce5" class="nu ml iq nq b gy nz nw l nx ny">#Loading the shapefile mask<br/>def readmask(link):<br/>print(‘reading mask…’)<br/>geo = gpd.read_file(link)<br/>with rasterio.open(path_image) as src:<br/>raster = src.read()<br/>geo = geo.to_crs(src.crs)<br/>out_image, out_transform = rasterio.mask.mask(src, geo.geometry, filled=True)<br/>masks = out_image[0,:,:]<br/>#Set the mask labels to 1 and the rest to 0<br/>masks[np.where(masks&lt;=0)] = 0<br/>masks[np.where(masks&gt;0)] = 1<br/>masks = masks.astype(np.int8)<br/>masks = np.expand_dims(masks, axis=2)<br/>return masks</span></pre><h1 id="4ee0" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">数据预处理</h1><p id="796e" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">我们的DEM阵列覆盖了整个岛屿，所以我们需要在Mauna Kea周围做一些裁剪，在那里我们有我们的标记遮罩。此外，我们将需要我们的DEM阵列，这是2D，并<strong class="lh ja">把它变成一个三维阵列</strong>与三个通道。我们为什么要这样做？稍后，我们将使用<strong class="lh ja">预训练编码器</strong>构建分割模型，这通常需要3通道图像输入(即彩色图像)，因此这确保了兼容性:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="9ecc" class="nu ml iq nq b gy nv nw l nx ny">#Crop both the image and masks to the same Mauna Kea area<br/>image = image[ymin:ymax, xmin:xmax,:]<br/>masks = masks[ymin:ymax, xmin:xmax,:]<br/><br/>#Stack the image array and normalise<br/>image = np.dstack((image, image, image))<br/>image = (image — image.min())/(image.max() — image.min())<br/> <br/>original_size = image.shape</span></pre><p id="76c5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这给了我们<strong class="lh ja"> (4000，6500，3) </strong>的最终形状。完美。让我们一起来看看并想象图像和面具:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/bf356c77e877bfb66dbe525bf5c41ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KkTmlsgBGmJym7Phe_6Ig.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">高程数据(左)和带标签的煤渣锥形遮罩(右)的图像。图片作者。</p></figure><p id="e543" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">既然我们已经知道如何复制同一个图像三次，我们可以通过应用一些滤镜来使这些图像更有用。我们将<strong class="lh ja">增强对比度</strong>，以便煤渣圆锥体与更平坦的环境相比更加突出，并且<strong class="lh ja">添加一个索贝尔滤镜来突出圆锥体的形状:</strong></p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="d949" class="nu ml iq nq b gy nv nw l nx ny">#Contrast enhancing<br/>image_eq = exposure.equalize_adapthist(image, clip_limit=0.05)</span><span id="4fd4" class="nu ml iq nq b gy nz nw l nx ny">#Sobel filter and normalising<br/>image_sobel = filters.sobel(np.squeeze(image))<br/>image_sobel = (image_sobel — image_sobel.min())/(image_sobel.max() — image_sobel.min())</span><span id="604e" class="nu ml iq nq b gy nz nw l nx ny">#concatenate standard image, equalised and sobel together<br/>images = np.dstack((image[:,:,0], image_sobel[:,:,0], image_sobel[:,:,0]))</span></pre><p id="395e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们已经对这三个通道做了一些额外的使用，我们现在需要<strong class="lh ja">将这个大数组细分为更小的数组，这些数组将被输入到我们的模型中。我们将拆分数组，使输出看起来像这样:</strong></p><blockquote class="nh ni nj"><p id="17d4" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">(样本数量、高度、宽度、通道数量)</p></blockquote><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="9f14" class="nu ml iq nq b gy nv nw l nx ny">#Making image tiles<br/>size = 224<br/>step = int(size/2)</span><span id="60f4" class="nu ml iq nq b gy nz nw l nx ny">patch_arr = skimage.util.view_as_windows(image, (size, size, layer.shape[2]), step = step)<br/>output = patch_arr.reshape((-1,) + (size, size, layer.shape[2]))</span></pre><p id="c8d3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">对输入图像和蒙版都重复这一过程，因此一切都是互补的。最后，留给我们以下输入:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/9015a3b61c32e1c5c7e6f22abf80c9dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJP3qx5o0oyOY_Q_aIx4eA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">来自莫纳克亚山DEM数据的图像切片和掩膜。图片作者。</p></figure><p id="a81c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这里有不少有趣的图片！我们最终的阵形是<strong class="lh ja"> (1938，224，224，3)；</strong>没有太多构建模型的示例来进一步支持使用预训练模型的需求。最后一步是在训练集和验证集之间拆分数据:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="7096" class="nu ml iq nq b gy nv nw l nx ny">x_train, x_val, y_train, y_val = train_test_split(images, masks, test_size=0.2, shuffle=True, random_state=123)<br/>print(x_train.shape)<br/>print(x_val.shape)<br/>print(y_train.shape)<br/>print(y_val.shape)</span><span id="26dd" class="nu ml iq nq b gy nz nw l nx ny">y_train = tf.cast(y_train, tf.float32)<br/>y_val = tf.cast(y_val, tf.float32)</span></pre><h1 id="b50a" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated"><strong class="ak">模型建立和训练</strong></h1><p id="76c3" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">现在我们准备建立一个模型！我们将使用<strong class="lh ja"> UNET模型</strong>，这似乎是分段架构的首选，在<a class="ae le" href="https://keras.io/api/applications/" rel="noopener ugc nofollow" target="_blank"> Keras </a>中提供了预训练的编码器。由于其在imagenet数据集上的性能，我选择使用<strong class="lh ja"> InceptionResNetV2 </strong>作为编码器，但是我们可以使用任何预训练的模型。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="3ac1" class="nu ml iq nq b gy nv nw l nx ny">input_shape = (size, size, 3)<br/>inception = InceptionResNetV2(include_top = False, weights = 'imagenet', input_tensor = input_shape)</span><span id="df4e" class="nu ml iq nq b gy nz nw l nx ny">inception.summary()<br/>layer_names = [layer.name for layer in model.layers]</span></pre><p id="7ae6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">使用我们的输入维度加载预训练的编码器，并获得编码器的层名称列表，这将有助于构建UNET的解码器部分，因为我们希望在编码器和解码器之间添加跳过连接。将“include_top”设置为False可以确保我们可以构建匹配的解码器。解码器会将编码器的输出恢复到原始输入图像尺寸，以便我们有一个匹配的分段掩码:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="c832" class="nu ml iq nq b gy nv nw l nx ny">x = Conv2DTranspose(num_filters, (2,2), strides=2, padding=’same’)(inputs)<br/>x = Conv2D(size, 2, padding=’same’, dilation_rate = 1, kernel_initializer = ‘he_normal’)(x)<br/>x = BatchNormalization()(x)<br/>x = Dropout(0.2)(x)<br/>x = Activation(‘LeakyReLU’)(x)</span></pre><p id="fbb4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">将这些具有递减滤波器尺寸的块堆叠在一起，将构成我们的解码器，现在是跳过连接。跳过连接可以被添加到激活层，其中输入层大小对应于<strong class="lh ja"> 224、112、56和28。</strong>根据使用的模型，层大小可能不直接对应这些尺寸，因此可能需要填充，如下例所示:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="ab8d" class="nu ml iq nq b gy nv nw l nx ny">skip_connection_2 = inception.get_layer(index = 3).output <br/>skip_connection_2 = ZeroPadding2D(( (1, 0), (1, 0))  (skip_connection_2)</span></pre><p id="1dde" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这里，我们看到第四层(指数3)需要填补，以符合我们想要的形状。</p><p id="4b1b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这些跳过连接将通过将指定激活层的输出与我们的转置解码器模块相连接来链接编码器和解码器，例如:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="1a08" class="nu ml iq nq b gy nv nw l nx ny">x = Concatenate()([x, skip_connection_2])</span></pre><p id="13c0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">一旦解码器构建完成，我们使用sigmoid激活完成具有最终输出层的模型，因为我们的任务是<strong class="lh ja">二进制分割</strong>(即是否为煤渣锥)。</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="93e3" class="nu ml iq nq b gy nv nw l nx ny">outputs = Conv2D(1, (1,1), padding=’same’, activation=’sigmoid’)(last_layer)</span></pre><p id="0ab4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在编译模型时，损失函数应考虑类别不平衡，因为煤渣锥的数量相对于背景区域并不高，因此我们可以使用<strong class="lh ja"> Tversky损失</strong>。这里有很多不同的损失函数<a class="ae le" href="https://www.kaggle.com/bigironsphere/loss-function-library-keras-pytorch" rel="noopener ugc nofollow" target="_blank">可以使用，这有助于实验不同的损失。我们的度量将是<strong class="lh ja"> Jaccard相似性系数</strong>，以测量我们的输入遮罩和分割遮罩之间的重叠像素的百分比。</a></p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="cc5a" class="nu ml iq nq b gy nv nw l nx ny">model.compile(tf.keras.optimizers.Adam(5e-5), <br/>loss= tversky_loss, metrics=[jaccard_coefficient],)</span><span id="3f98" class="nu ml iq nq b gy nz nw l nx ny">reduce_lr = ReduceLROnPlateau(monitor=’loss’, factor=0.2, patience=15, verbose=1, mode=’max’, min_lr=1e-6)<br/>early = tf.keras.callbacks.EarlyStopping(monitor=’val_loss’, patience=10)</span><span id="9c7f" class="nu ml iq nq b gy nz nw l nx ny">history = model.fit(x_train, y_train, epochs=100, batch_size = 32, validation_data = (x_val,y_val), callbacks = [reduce_lr, early])</span></pre><p id="4c97" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在100个时期的训练期间使用低学习率1e-5和ReduceLROnPlateau允许模型实现仅超过80%的验证IoU，这并不太坏。也许这可以进一步改善更定制的标签策略(即。没有将标签简化为圆圈)或不同的编码器模型。也可以尝试冻结不同的编码器层。</p><h1 id="fbc9" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">在另一座火山测试模型</h1><p id="a29a" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">移动到Hualālai火山，在那里我们将看到我们的分割模型如何识别煤渣锥。让我们来看看这座新火山:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oc"><img src="../Images/ab3e30ef255dd3580497dc5662272935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yv_Lkhw31B06ptsDoVOZ0w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Hualālai <strong class="bd od"> </strong>火山的归一化DEM。图片作者。</p></figure><p id="af89" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们需要像处理Mauna Kea输入一样应用所有相同的预处理步骤，以便一切都与我们的模型兼容。在裁剪了这个区域，应用了滤镜，并把数组分成一个个小块之后，我们得到了一个(420，224，224，3)的形状。值得一提的是<strong class="lh ja">我们在平铺图像</strong>时不需要一个步骤，因为我们对增加样本的大小不感兴趣。</p><p id="c90f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们快速看一下之前的输入图块示例:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oe"><img src="../Images/2809387b42eaebda46cff9784380faa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TvIr0LWJdC49Bfmn4Lcguw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">来自Hualālai <strong class="bd od"> </strong> DEM数据的图像图块和遮罩。图片作者。</p></figure><p id="d700" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">使用我们的模型进行预测后:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="e851" class="nu ml iq nq b gy nv nw l nx ny">y_pred = model.predict(tiled_Hualalai_image)</span></pre><p id="edac" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<strong class="lh ja">重新组合图像拼贴</strong>以形成与原始图像尺寸相同的分割蒙版之前，我们可以快速浏览一些分割的拼贴:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/24f3a0f8acf568b77d0c1b1126779506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5RvQK92zlX7e5I9XhmYaDw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">具有输入图像块的预测分割掩模。图片作者。</p></figure><p id="bd47" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">预测似乎还可以，但看起来模型很难分割小煤渣锥，这可能是由于我们在莫纳克亚山训练集中的煤渣锥的大小(通常更大)。</p><p id="2e64" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们现在可以查看叠加在原始输入图像上的分割图像。为了使煤渣锥更容易被发现，我们将在sobel过滤器图像上覆盖预测的分割蒙版(<em class="nk">煤渣锥显示为小点/环</em>):</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/c6245205313094783d7855474b79a0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cAcIaElT60KCgPuJoTgnjw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">带sobel滤波器的DEM数据(左)与叠加分段掩膜(右)相结合。图片作者。</p></figure><p id="8aaa" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">从整体上看，这幅图像看起来要好得多:</p><blockquote class="nh ni nj"><p id="014d" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">遮罩的位置大致与火山沿线的火山渣锥的西北-东南方向相匹配；</p><p id="70ca" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">各种尺寸的煤渣锥体被分段(即不仅仅是大的)；</p><p id="10e2" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">每个煤渣锥体的形状与分段遮罩的形状大致匹配。</p></blockquote><h1 id="41f7" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">摘要</h1><p id="9750" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">总的来说，我们已经完成了一个<strong class="lh ja">使用图像分割</strong>和地理空间数据集来识别夏威夷煤渣锥的新颖例子。由于我们可以从DEM输入数据中将分割蒙版转换回原始坐标，因此我们现在有能力<strong class="lh ja">将分割蒙版转换成真实数据集</strong>以供进一步分析(<strong class="lh ja">，即煤渣锥大小的分布情况如何？煤渣锥的密度如何变化？</strong>)。</p><p id="d2b3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">感谢阅读！</p></div><div class="ab cl oh oi hu oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ij ik il im in"><p id="54c7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="nk">【1】美国地质调查局，2013，USGS 13弧秒n20w156 1 x 1度:美国地质调查局。数据来自美国地质调查局，国家地理空间计划。来自国家地图的数据是免费的，并且在公共领域。</em></p></div></div>    
</body>
</html>