<html>
<head>
<title>Data Manipulation in SQL, Python and R — a comparison</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL、Python和R中的数据操作——比较</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-manipulation-in-sql-python-and-r-a-comparison-db63f72fa020#2022-01-02">https://towardsdatascience.com/data-manipulation-in-sql-python-and-r-a-comparison-db63f72fa020#2022-01-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="9711" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">SQL、Python和R中的数据操作——比较</h1></div><div class=""><h2 id="6ec4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对最常见的SQL语句及其用pandas (Python)和dplyr (R)编写的对应物的完整而友好的概述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3d2d22bb2ef2a8bc11a77abcab7c61df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bHF-bi18BsN8GLXU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯托夫·高尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="7495" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">目录</h1><ol class=""><li id="2b2b" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><a class="ae ky" href="#7a9f" rel="noopener ugc nofollow">简介</a></li><li id="bb49" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#b12a" rel="noopener ugc nofollow">创建表格</a></li><li id="b5da" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#3933" rel="noopener ugc nofollow">插入</a> <br/> 3.1 <a class="ae ky" href="#f54c" rel="noopener ugc nofollow">插入单个观测值</a> <br/> 3.2 <a class="ae ky" href="#855c" rel="noopener ugc nofollow">插入多个观测值</a></li><li id="a8f3" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#0a4b" rel="noopener ugc nofollow">选择</a> <br/> 4.1 <a class="ae ky" href="#9b1a" rel="noopener ugc nofollow">选择所有行和列</a> <br/> 4.2 <a class="ae ky" href="#9bdd" rel="noopener ugc nofollow">选择有限数量的行</a> <br/> 4.3 <a class="ae ky" href="#1fff" rel="noopener ugc nofollow">选择特定列</a> <br/> 4.4 <a class="ae ky" href="#59c4" rel="noopener ugc nofollow">选择不同的</a></li><li id="ae0b" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#8d5e" rel="noopener ugc nofollow"> WHERE条件(过滤)</a> <br/> 5.1 <a class="ae ky" href="#6d08" rel="noopener ugc nofollow">一个过滤条件</a> <br/> 5.2 <a class="ae ky" href="#9193" rel="noopener ugc nofollow">多个过滤条件</a></li><li id="c2f4" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#6d08" rel="noopener ugc nofollow">ORDER BY</a><br/>6.1<a class="ae ky" href="#cb63" rel="noopener ugc nofollow">ORDER BY one column</a><br/>6.2<a class="ae ky" href="#8485" rel="noopener ugc nofollow">指定升序与降序</a><br/>6.3<a class="ae ky" href="#19a1" rel="noopener ugc nofollow">ORDER BY multiple column</a></li><li id="4c54" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#f6ae" rel="noopener ugc nofollow">聚合函数</a> <br/> 7.1 <a class="ae ky" href="#79ed" rel="noopener ugc nofollow">计数</a> <br/> 7.2 <a class="ae ky" href="#52aa" rel="noopener ugc nofollow"> AVG、最小值、最大值、… </a> <br/> 7.3 <a class="ae ky" href="#9468" rel="noopener ugc nofollow">聚合函数和WHERE条件</a> <br/> 7.4 <a class="ae ky" href="#613c" rel="noopener ugc nofollow">加成:描述和总结</a></li><li id="85ce" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#1f6d" rel="noopener ugc nofollow">分组依据</a></li><li id="0900" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#c947" rel="noopener ugc nofollow">更新/更改表</a> <br/> 9.1 <a class="ae ky" href="#1e50" rel="noopener ugc nofollow">修改现有列的值</a> <br/> 9.2 <a class="ae ky" href="#3234" rel="noopener ugc nofollow">添加新列</a> <br/> 9.3 <a class="ae ky" href="#4d72" rel="noopener ugc nofollow">删除列</a></li><li id="7413" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#6e85" rel="noopener ugc nofollow">加入</a> <br/> 10.1 <a class="ae ky" href="#f41c" rel="noopener ugc nofollow">内加入</a> <br/> 10.2 <a class="ae ky" href="#406a" rel="noopener ugc nofollow">左加入</a> <br/> 10.3 <a class="ae ky" href="#e3dc" rel="noopener ugc nofollow">右加入</a> <br/> 10.4 <a class="ae ky" href="#8a70" rel="noopener ugc nofollow">全加入</a></li><li id="a0ae" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#9f4d" rel="noopener ugc nofollow">结论</a></li><li id="acbd" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><a class="ae ky" href="#59be" rel="noopener ugc nofollow">参考文献</a></li></ol><h1 id="2d68" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.介绍</h1><p id="34c9" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">这篇文章的目的是分享用于数据操作的最常用的SQL命令，以及它们在Python和R语言中的对应部分。</p><p id="48ef" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">通过提供实例，我们还想强调两种不同语言之间在逻辑和句法上的相似之处。</p><p id="c2a4" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">对于SQL语句，我们使用<code class="fe ng nh ni nj b">PostgreSQL</code>，一个流行的开源关系数据库管理系统。对于Python，我们使用<code class="fe ng nh ni nj b">pandas</code>库，而对于R，我们利用<code class="fe ng nh ni nj b">dplyr</code>包。</p><p id="59f3" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">为什么<code class="fe ng nh ni nj b">pandas</code>:</p><ol class=""><li id="a307" class="lr ls it lt b lu nb lw nc ly nk ma nl mc nm me mf mg mh mi bi translated"><em class="nn">事实上的</em>管理Python中表格数据结构的标准。</li><li id="d0b5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">一整套现成的数据操作方法。</li><li id="3acf" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">快速高效的<code class="fe ng nh ni nj b">DataFrame</code> <strong class="lt iu"> </strong>对象。</li><li id="afd0" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">出色的数据表现。</li></ol><p id="feb9" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">为什么选择<code class="fe ng nh ni nj b">dplyr</code>:</p><ol class=""><li id="adac" class="lr ls it lt b lu nb lw nc ly nk ma nl mc nm me mf mg mh mi bi translated">更干净、更易读的代码:借助管道操作符<code class="fe ng nh ni nj b">%&gt;%</code>的函数链接允许更容易地读写R代码，并提供语义救济。</li><li id="c9c5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">简单高效的语法。</li><li id="93f9" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">速度:比base R或plyr快。</li></ol><p id="1d7e" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">这篇文章是由SQL commands⁴在分段中组织的，暗示SQL是逻辑入口点。然而，根据对每种语言的熟悉程度，也可以很容易地从其他角度阅读它。</p><h1 id="b12a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.创建表格</h1><p id="5612" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">我们可以用<code class="fe ng nh ni nj b">CREATE TABLE</code>指令创建一个SQL表:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="00aa" class="ns la it nj b gy nt nu l nv nw">CREATE TABLE IF NOT EXISTS customer_table (<br/> id SERIAL PRIMARY KEY,<br/> age NUMERIC NOT NULL,<br/> gender VARCHAR NOT NULL<br/>);</span></pre><p id="c2ed" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL表的<code class="fe ng nh ni nj b">pandas</code>等价物是<code class="fe ng nh ni nj b">pandas.DataFrame</code>，一个可以存储二维表格数据的对象。它可以按如下方式创建:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="508c" class="ns la it nj b gy nt nu l nv nw"># the pandas library is imported first<br/>import pandas as pd</span><span id="3a10" class="ns la it nj b gy nx nu l nv nw">columns = {'id':int(),<br/>           'age':int(),<br/>           'gender':str()}</span><span id="f53e" class="ns la it nj b gy nx nu l nv nw">customer_table = pd.DataFrame(columns, index=[])</span></pre><p id="ce6c" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r也提供了一个数据帧，它可以通过基本的<code class="fe ng nh ni nj b">data.frame()</code> ⁵函数创建:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="2068" class="ns la it nj b gy nt nu l nv nw"># the dplyr package is imported first<br/>library(dplyr)</span><span id="520a" class="ns la it nj b gy nx nu l nv nw">customer_table &lt;- data.frame(id=integer(),<br/>                             age=integer(),<br/>                             gender=character())</span></pre><h1 id="3933" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.插入</h1><h2 id="f54c" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">3.1插入单个观察值</h2><p id="ee55" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">一旦我们创建了数据结构，无论是表还是数据框:</p><ul class=""><li id="b55b" class="lr ls it lt b lu nb lw nc ly nk ma nl mc nm me oj mg mh mi bi translated">我们可以通过<code class="fe ng nh ni nj b">INSERT INTO</code> ⁴语句向SQL表中添加行。</li><li id="bd7e" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">我们可以用<code class="fe ng nh ni nj b">pandas.DataFrame.append()</code> ⁶方法向<code class="fe ng nh ni nj b">pandas.DataFrame</code>添加行。</li><li id="b898" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">我们可以使用<code class="fe ng nh ni nj b">add_row()</code> ⁷函数向r数据帧添加行。</li></ul><p id="204e" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="617f" class="ns la it nj b gy nt nu l nv nw">INSERT INTO customer_table VALUES<br/>  (1, 27, 'Female');</span></pre><p id="6c62" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="18ab" class="ns la it nj b gy nt nu l nv nw">customer_table = customer_table.append(<br/>   {'id': 1, 'age': 27, 'gender': 'Female'}, <br/>   ignore_index=True)</span></pre><p id="4f42" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="bdde" class="ns la it nj b gy nt nu l nv nw">customer_table &lt;- <br/>  customer_table %&gt;% add_row(id=1, age=27, gender='Female')</span></pre><p id="e743" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><strong class="lt iu">注意</strong>:当我们创建pandas数据帧时，我们指定了列数据类型。尽管如此，用户可以添加一个数据类型不同于最初为列指定的数据类型的记录，并且不会出现错误。</p><p id="5095" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">例如，这个Python语句完全有效，即使我们先前指定<code class="fe ng nh ni nj b">gender</code>是字符串类型:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="0357" class="ns la it nj b gy nt nu l nv nw">customer_table = customer_table.append(<br/>   {'id': 1, 'age': 27, 'gender': 2})</span><span id="1f64" class="ns la it nj b gy nx nu l nv nw">type(customer_table['gender'].values[0])</span><span id="aaa6" class="ns la it nj b gy nx nu l nv nw"># prints: 'int'</span></pre><h2 id="855c" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">3.2插入多个观察值</h2><p id="de77" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="d848" class="ns la it nj b gy nt nu l nv nw">INSERT INTO customer_table VALUES<br/>  (1, 27, 'Female'),<br/>  (2, 27, 'Female'),<br/>  (3, 45, 'Female'),<br/>  (4, 18, 'Male'),<br/>  (5, 23, 'Male'),<br/>  (6, 43, 'Female'),<br/>  (7, 28, 'Female'),<br/>  (8, 27, 'Male'),<br/>  (9, 19, 'Male'),<br/>  (10, 21, 'Male'),<br/>  (11, 24, 'Male'),<br/>  (12, 32, 'Female'),<br/>  (13, 23, 'Male');</span></pre><p id="20fc" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="cdb8" class="ns la it nj b gy nt nu l nv nw">customer_table = customer_table.append([<br/>   {'id': 1, 'age': 27, 'gender': 'Female'},<br/>   {'id': 2, 'age': 27, 'gender': 'Female'},<br/>   {'id': 3, 'age': 45, 'gender': 'Female'},<br/>   {'id': 4, 'age': 18, 'gender': 'Male'},<br/>   {'id': 5, 'age': 23, 'gender': 'Male'},<br/>   {'id': 6, 'age': 43, 'gender': 'Female'},<br/>   {'id': 7, 'age': 28, 'gender': 'Female'},<br/>   {'id': 8, 'age': 27, 'gender': 'Male'},<br/>   {'id': 9, 'age': 19, 'gender': 'Male'},<br/>   {'id': 10, 'age': 21, 'gender': 'Male'},<br/>   {'id': 11, 'age': 24, 'gender': 'Male'},<br/>   {'id': 12, 'age': 32, 'gender': 'Female'},<br/>   {'id': 13, 'age': 23, 'gender': 'Male'}])</span></pre><p id="a1a2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="5366" class="ns la it nj b gy nt nu l nv nw">id_list &lt;- c(2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13)<br/>age_list &lt;- c(27, 45, 18, 23, 43, 28, 27, 19, 21, 24, 32, 23)<br/>gender_list &lt;- c("Female", "Female", "Male", "Male", "Female",<br/>                 "Female", "Male", "Male", "Male", "Male", "Female",<br/>                 "Male")</span><span id="88d5" class="ns la it nj b gy nx nu l nv nw">customer_table &lt;- <br/>  customer_table %&gt;% add_row(id = id_list,<br/>                             age = age_list,<br/>                             gender = gender_list)</span></pre><h1 id="0a4b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.挑选</h1><h2 id="9b1a" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">4.1选择所有行和列</h2><p id="d683" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">一旦我们填充了数据结构，我们就可以查询它们:</p><ul class=""><li id="75db" class="lr ls it lt b lu nb lw nc ly nk ma nl mc nm me oj mg mh mi bi translated">我们可以用<code class="fe ng nh ni nj b">SELECT *</code> ⁴.从SQL表中选择所有的行和列</li><li id="5631" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">在Python和R中，为了显示所有的行和列，只需提示数据框的名称。</li></ul><p id="ce17" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="f1a0" class="ns la it nj b gy nt nu l nv nw">SELECT *<br/>FROM customer_table;</span></pre><p id="1e36" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="6385" class="ns la it nj b gy nt nu l nv nw"> id | age | gender <br/>— — + — — + — — — — <br/> 1  | 27  | Female<br/> 2  | 27  | Female<br/> 3  | 45  | Female<br/> 4  | 18  | Male<br/> 5  | 23  | Male<br/> 6  | 43  | Female<br/> 7  | 28  | Female<br/> 8  | 27  | Male<br/> 9  | 19  | Male<br/> 10 | 21  | Male<br/> 11 | 24  | Male<br/> 12 | 32  | Female<br/> 13 | 23  | Male<br/>(13 rows)</span></pre><p id="872a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python，R:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="6049" class="ns la it nj b gy nt nu l nv nw">customer_table</span></pre><h2 id="9bdd" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">4.2选择有限数量的行</h2><ul class=""><li id="754b" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me oj mg mh mi bi translated">在SQL中，我们可以使用<code class="fe ng nh ni nj b">LIMIT</code> ⁴子句来指定要返回的行数。</li><li id="3d99" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated"><code class="fe ng nh ni nj b">head()</code>函数允许返回要显示的顶部行数，即使在Python⁸和R⁹.使用的语法略有不同</li><li id="5238" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">此外，在Python和R中，可以通过指定索引位置来指定要返回的行数。</li></ul><p id="f6f6" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="e572" class="ns la it nj b gy nt nu l nv nw">--top 3 rows<br/>SELECT * <br/>FROM customer_table <br/>LIMIT 3;</span></pre><p id="bde9" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="16bb" class="ns la it nj b gy nt nu l nv nw">  id | age  | gender <br/> — — + — — -+ — — — — <br/> 1   | 27   | Female<br/> 2   | 27   | Female<br/> 3   | 45   | Female<br/>(3 rows)</span></pre><p id="126a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="1bdf" class="ns la it nj b gy nt nu l nv nw"># top 3 rows with head<br/>customer_table.head(3)</span><span id="7a20" class="ns la it nj b gy nx nu l nv nw"># top 3 rows by index with iloc<br/>customer_table.iloc[0:3,]</span></pre><p id="ea7d" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="3795" class="ns la it nj b gy nt nu l nv nw"># top 3 rows with head<br/>head(customer_table, 3)</span><span id="b485" class="ns la it nj b gy nx nu l nv nw"># top 3 rows by index<br/>customer_table[0:3,]</span></pre><h2 id="1fff" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">4.3选择特定的列</h2><p id="1136" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="57ad" class="ns la it nj b gy nt nu l nv nw">SELECT age, gender <br/>FROM customer_table <br/>LIMIT 3;</span></pre><p id="99d4" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="fe84" class="ns la it nj b gy nt nu l nv nw">age | gender <br/> — -+ — — — — <br/> 27 | Female<br/> 27 | Female<br/> 45 | Female<br/>(3 rows)</span></pre><p id="dcd2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python和R中，可以通过名称或索引位置来选择列。</p><p id="272b" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">备注:</p><ul class=""><li id="aebe" class="lr ls it lt b lu nb lw nc ly nk ma nl mc nm me oj mg mh mi bi translated">在Python中，应该在双方括号中指定列名，以返回一个<code class="fe ng nh ni nj b">pandas.DataFrame</code>对象。否则，返回一个<code class="fe ng nh ni nj b">pandas.Series</code>对象。</li><li id="9cbe" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">Python从0开始计算索引，而R从1开始。例如，第二列在Python中的索引是1，在r中是2。</li></ul><p id="f466" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="9e61" class="ns la it nj b gy nt nu l nv nw"># select columns by name<br/>customer_table[['age', 'gender']].head(3)</span><span id="5dc4" class="ns la it nj b gy nx nu l nv nw"># select columns by index<br/>customer_table.iloc[:, [1, 2]]</span></pre><p id="b04e" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4037" class="ns la it nj b gy nt nu l nv nw"># select columns by name<br/>customer_table[, c('age', 'gender')]</span><span id="ca74" class="ns la it nj b gy nx nu l nv nw"># select columns by index<br/>customer_table[, c(2, 3)]</span><span id="b32b" class="ns la it nj b gy nx nu l nv nw"># dplyr<br/>customer_table %&gt;%<br/>   select(age, gender)</span></pre><h2 id="59c4" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">4.4选择不同的</h2><ul class=""><li id="3824" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me oj mg mh mi bi translated"><code class="fe ng nh ni nj b">SELECT DISTINCT</code>允许在SQL中只返回不同的值。</li><li id="5a3e" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">在Python中，我们可以通过在数据帧上调用<code class="fe ng nh ni nj b">pandas.DataFrame.drop_dupicates()</code> ⁰方法，或者通过在r中应用<code class="fe ng nh ni nj b">dplyr</code>中的<code class="fe ng nh ni nj b">distinct()</code>函数来获得相同的结果</li></ul><p id="0744" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="138a" class="ns la it nj b gy nt nu l nv nw">SELECT DISTINCT age, gender <br/>FROM customer_table;</span></pre><p id="fdc0" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="2c54" class="ns la it nj b gy nt nu l nv nw">age | gender <br/> — -+ — — — — <br/> 32 | Female<br/> 28 | Female<br/> 45 | Female<br/> 27 | Female<br/> 43 | Female<br/> 23 | Male<br/> 21 | Male<br/> 18 | Male<br/> 24 | Male<br/> 27 | Male<br/> 19 | Male<br/>(11 rows)</span></pre><p id="8eb5" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="9ff9" class="ns la it nj b gy nt nu l nv nw">customer_table.drop_duplicates()</span><span id="c1fb" class="ns la it nj b gy nx nu l nv nw">customer_table[['age', 'gender']].drop_duplicates()</span></pre><p id="2c8b" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="de92" class="ns la it nj b gy nt nu l nv nw">distinct(customer_table)</span><span id="8a9b" class="ns la it nj b gy nx nu l nv nw">customer_table[, c('age', 'gender')]</span></pre><h1 id="8de5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5.WHERE条件(过滤)</h1><ul class=""><li id="7e15" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me oj mg mh mi bi translated"><code class="fe ng nh ni nj b">WHERE</code> ⁴子句可用于根据特定条件过滤行。</li><li id="7c5d" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">在Python中，我们可以在<code class="fe ng nh ni nj b">pandas.DataFrame.iloc</code>方法中传递这个条件。该条件将返回一个布尔数组，其中<code class="fe ng nh ni nj b">True</code>将指示匹配该条件的行的索引。随后，<code class="fe ng nh ni nj b">iloc</code>将使用布尔数组作为输入对<code class="fe ng nh ni nj b">pandas.DataFrame</code>进行过滤。</li><li id="eb1d" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">在R中，我们可以使用管道操作符<code class="fe ng nh ni nj b">%&gt;%</code>和<code class="fe ng nh ni nj b">filter()</code>方法。</li></ul><h2 id="6df5" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">5.1一个过滤条件</h2><p id="d56e" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="f9f1" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table <br/>WHERE gender='Female';</span></pre><p id="ef42" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="ed38" class="ns la it nj b gy nt nu l nv nw">id  | age | gender <br/>- — + — — + — — — — <br/> 1  | 27  | Female<br/> 2  | 27  | Female<br/> 3  | 45  | Female<br/> 6  | 43  | Female<br/> 7  | 28  | Female<br/> 12 | 32  | Female<br/>(6 rows)</span></pre><p id="1a77" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="ce06" class="ns la it nj b gy nt nu l nv nw">customer_table.loc[customer_table['gender']=='Female']</span></pre><p id="8ac5" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="6473" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% filter(gender=='Female')</span></pre><h2 id="9193" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">5.2多重过滤条件</h2><p id="c676" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="ce2f" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table <br/>WHERE gender='Female' AND age&gt;30;</span></pre><p id="351c" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="04ec" class="ns la it nj b gy nt nu l nv nw">  id | age | gender <br/> — — + — — + — — — — <br/>   3 | 45  | Female<br/>   6 | 43  | Female<br/>  12 | 32  | Female<br/>(3 rows)</span></pre><p id="50ad" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="f674" class="ns la it nj b gy nt nu l nv nw">customer_table.loc[(customer_table['gender']=='Female') &amp; (customer_table['age']&gt;30)]</span></pre><p id="9e74" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="3dda" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% filter(gender=='Female' &amp; age&gt;30)</span></pre><h1 id="6d08" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">6.以...排序</h1><ul class=""><li id="3ad9" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me oj mg mh mi bi translated"><code class="fe ng nh ni nj b">ORDER BY</code> ⁴命令用于根据一列或多列的值对结果集进行升序或降序排序。默认情况下，它按升序对行进行排序。</li><li id="3014" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">在Python中，我们可以用<code class="fe ng nh ni nj b">pandas.DataFrame.sort_values()</code>对结果进行排序，而在r中，可以使用<code class="fe ng nh ni nj b">arrange()</code> ⁴函数。对于Python和R，默认的排序条件是升序。</li></ul><h2 id="cb63" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">6.1按一列排序</h2><p id="872b" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="069c" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table <br/>ORDER BY age;</span></pre><p id="c910" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="360e" class="ns la it nj b gy nt nu l nv nw">  id | age | gender <br/> — — + — — + — — — — <br/> 4   | 18  | Male<br/> 9   | 19  | Male<br/> 10  | 21  | Male<br/> 13  | 23  | Male<br/> 5   | 23  | Male<br/> 11  | 24  | Male<br/> 1   | 27  | Female<br/> 2   | 27  | Female<br/> 8   | 27  | Male<br/> 7   | 28  | Female<br/> 12  | 32  | Female<br/> 6   | 43  | Female<br/> 3   | 45  | Female<br/>(13 rows)</span></pre><p id="7eae" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="b06f" class="ns la it nj b gy nt nu l nv nw"># default ascending order<br/>customer_table.sort_values(by='age')</span></pre><p id="2ea2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4f1a" class="ns la it nj b gy nt nu l nv nw"># default ascending order<br/>customer_table %&gt;% arrange(age)</span></pre><h2 id="8485" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">6.2指定升序还是降序</h2><p id="9f8d" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">在SQL中，可以用<code class="fe ng nh ni nj b">DESC</code>(降序)和<code class="fe ng nh ni nj b">ASC</code>(升序)关键字指定顺序，如下所示:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="1bfa" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table <br/>ORDER BY age DESC;</span></pre><p id="5433" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="d976" class="ns la it nj b gy nt nu l nv nw"> id | age | gender <br/>— — + — — + — — — — <br/> 3  | 45  | Female<br/> 6  | 43  | Female<br/> 12 | 32  | Female<br/> 7  | 28  | Female<br/> 1  | 27  | Female<br/> 2  | 27  | Female<br/> 8  | 27  | Male<br/> 11 | 24  | Male<br/> 13 | 23  | Male<br/> 5  | 23  | Male<br/> 10 | 21  | Male<br/> 9  | 19  | Male<br/> 4  | 18  | Male<br/>(13 rows)</span></pre><p id="6af5" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python中，我们可以将<code class="fe ng nh ni nj b">ascending</code>属性设置为<code class="fe ng nh ni nj b">False</code>来进行降序排列:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="44fd" class="ns la it nj b gy nt nu l nv nw">customer_table.sort_values(by='age', ascending=False) </span></pre><p id="c5e3" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="63c3" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% arrange(desc(age))</span></pre><h2 id="19a1" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">6.3按多列排序</h2><p id="823e" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4527" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table <br/>ORDER BY age DESC, id DESC;</span></pre><p id="572c" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="fe59" class="ns la it nj b gy nt nu l nv nw"> id  | age | gender <br/> — — + — — + — — — — <br/> 3  | 45   | Female<br/> 6  | 43   | Female<br/> 12 | 32   | Female<br/> 7  | 28   | Female<br/> 8  | 27   | Male<br/> 2  | 27   | Female<br/> 1  | 27   | Female<br/> 11 | 24   | Male<br/> 13 | 23   | Male<br/> 5  | 23   | Male<br/> 10 | 21   | Male<br/> 9  | 19   | Male<br/> 4  | 18   | Male<br/>(13 rows)</span></pre><p id="813c" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="8c07" class="ns la it nj b gy nt nu l nv nw">customer_table.sort_values(by=['age', 'id'], <br/>                           ascending=[False, False])</span></pre><p id="269b" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="7d23" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% arrange(desc(age, id))</span></pre><h1 id="f6ae" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">7.聚合函数</h1><h2 id="79ed" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">7.1计数</h2><p id="4525" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="38af" class="ns la it nj b gy nt nu l nv nw">SELECT count(*) <br/>FROM customer_table;</span></pre><p id="de20" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="9625" class="ns la it nj b gy nt nu l nv nw">count <br/>— — — -<br/>13<br/>(1 row)</span></pre><p id="8a97" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python中，我们可以利用<code class="fe ng nh ni nj b">pandas.DataFrame.shape</code>方法，返回大小为2(行x列)的元组，以及其他方法:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="a922" class="ns la it nj b gy nt nu l nv nw">customer_table.shape[0]</span><span id="9078" class="ns la it nj b gy nx nu l nv nw"># a less efficient alternative to shape<br/>len(customer_table.index)</span></pre><p id="69c4" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在R中，我们可以通过使用<code class="fe ng nh ni nj b">nrow</code>或<code class="fe ng nh ni nj b">count</code>获得类似的结果:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="d576" class="ns la it nj b gy nt nu l nv nw">nrow(customer_table)</span><span id="d9d6" class="ns la it nj b gy nx nu l nv nw"># as alternative to 'nrow', one may use 'count' from dplyr<br/>count(customer_table)</span></pre><h2 id="52aa" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">7.2 AVG，最小值，最大值，…</h2><ul class=""><li id="4097" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me oj mg mh mi bi translated">SQL支持大量的聚合函数，可以从列中直接获得有用的信息，比如average ( <code class="fe ng nh ni nj b">AVG</code>)、count ( <code class="fe ng nh ni nj b">COUNT</code>)、standard deviation ( <code class="fe ng nh ni nj b">STDDEV</code>)等等。</li><li id="d21c" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">Python和R都提供了现成的方法来计算这样的指标。</li></ul><p id="7860" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="2e43" class="ns la it nj b gy nt nu l nv nw">-- AVG used as example, other functions include: MIN, MAX, STDEV, …<br/>SELECT AVG(age) <br/>FROM customer_table;</span></pre><p id="b76f" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">也可以用<code class="fe ng nh ni nj b">ROUND</code>函数将结果四舍五入到第n位小数:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="cd7b" class="ns la it nj b gy nt nu l nv nw">SELECT ROUND(AVG(age), 2) <br/>FROM customer_table;</span></pre><p id="2a95" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="d7ae" class="ns la it nj b gy nt nu l nv nw">-- without ROUND<br/>avg <br/>— — — — — — — — — — -<br/>27.4615384615384615<br/>(1 row)</span><span id="0ea7" class="ns la it nj b gy nx nu l nv nw">-— with ROUND<br/>round <br/>— — — -<br/>27.46<br/>(1 row)</span></pre><p id="5798" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="bf51" class="ns la it nj b gy nt nu l nv nw">customer_table['age'].mean()</span><span id="f0d8" class="ns la it nj b gy nx nu l nv nw"># round the result to the nth decimal<br/>customer_table['age'].mean().round(2)</span></pre><p id="aec1" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="6a81" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% summarize(mean(age))</span><span id="25a0" class="ns la it nj b gy nx nu l nv nw"># round the result to the nth decimal<br/>customer_table %&gt;% summarize(round(mean(age), 2))</span></pre><h2 id="9468" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">7.3聚合函数和WHERE条件</h2><p id="bb39" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="53bd" class="ns la it nj b gy nt nu l nv nw">SELECT ROUND(AVG(age),2) <br/>FROM customer_table <br/>WHERE gender='Female';</span></pre><p id="d4f0" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="2ed3" class="ns la it nj b gy nt nu l nv nw">round <br/>— — — -<br/>33.67<br/>(1 row)</span></pre><p id="c82a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4bc0" class="ns la it nj b gy nt nu l nv nw">customer_table.loc[customer_table['gender']=='Female']['age'].mean().round(2)</span></pre><p id="bec5" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在R中，正是在必须执行多个操作的地方,<code class="fe ng nh ni nj b">dplyr</code>的链接功能真正发挥了作用:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="1632" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% <br/>  filter(gender=='Female') %&gt;% <br/>  summarize(round(mean(age), 2))</span></pre><h2 id="613c" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">7.4奖金:描述和总结</h2><p id="4379" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">Python和R提供了可视化数据框及其结构的汇总统计数据的方法。</p><p id="68ae" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">例如，<code class="fe ng nh ni nj b">pandas.DataFrame.describe()</code> ⁵方法提供了对数字列的有用见解(输出中省略了非数字列):</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="ebcb" class="ns la it nj b gy nt nu l nv nw">customer_table.describe().round(2)</span></pre><p id="0f67" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="94b1" class="ns la it nj b gy nt nu l nv nw">      | id    | age <br/>— — — + — — — + — — — — <br/>count | 13.00 | 13.00<br/>mean  | 6.50  | 27.50<br/>std   | 3.61  | 8.66<br/>min   | 1.00  | 18.00<br/>25%   | 3.75  | 22.50<br/>50%   | 6.50  | 25.50<br/>75%   | 9.25  | 29.00<br/>max   | 12.00 | 45.00<br/>count | 12.00 | 12.00<br/>mean  | 6.50  | 27.50</span></pre><p id="a1fc" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">同样的方法<code class="fe ng nh ni nj b">pandas.Series.describe()</code>，也可以仅应用于感兴趣的特定列(<code class="fe ng nh ni nj b">pandas.Series</code>):</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="3b3b" class="ns la it nj b gy nt nu l nv nw">customer_table['age'].describe().round(2)</span></pre><p id="ec91" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">相反，在r中，我们可以使用<code class="fe ng nh ni nj b">summary</code> ⁶函数来实现类似的结果:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="a159" class="ns la it nj b gy nt nu l nv nw"># summary statistics of the whole dataset<br/>summary(customer_table)</span><span id="1aef" class="ns la it nj b gy nx nu l nv nw"># summary statistics of a specific column<br/>summary(customer_table['age'])</span></pre><p id="bbd9" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">尽管这些本地方法在标准SQL中不可用，但是可以编写查询来实现类似的输出。例如:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4bdf" class="ns la it nj b gy nt nu l nv nw">SELECT <br/> COUNT(age), <br/> ROUND(AVG(age),2) AS avg,<br/> MIN(age),<br/> MAX(age),<br/> ROUND(STDDEV(age),2) AS stddev<br/>FROM<br/> customer_table;</span></pre><p id="f606" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="dce7" class="ns la it nj b gy nt nu l nv nw">count | avg   | min | max | stddev <br/>— — — + — — — + — — + — — + — — — — <br/>13    | 27.46 | 18  | 45  | 8.29<br/>(1 row)</span></pre><h1 id="1f6d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">8.分组依据</h1><p id="0eac" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">⁴命令允许你按组排列行。</p><p id="45bc" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="dfd7" class="ns la it nj b gy nt nu l nv nw">SELECT gender, count(*) <br/>FROM customer_table <br/>GROUP BY gender;</span></pre><p id="c213" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="81dd" class="ns la it nj b gy nt nu l nv nw">gender  | count <br/>— — — — + — — — -<br/>Female  | 6<br/>Male    | 7<br/>(2 rows)</span></pre><p id="611a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">例如，在Python中，可以使用:<br/> 1。返回要素唯一值计数的<code class="fe ng nh ni nj b">pandas.Series.value_counts()</code> ⁷方法。<br/> 2。对要素上的数据进行分组并执行聚合操作的<code class="fe ng nh ni nj b">pandas.DataFrame.groupby()</code> ⁸方法。</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="0403" class="ns la it nj b gy nt nu l nv nw"># return unique gender values (Male, Female) and respective counts<br/>customer_table['gender'].value_counts()</span><span id="362c" class="ns la it nj b gy nx nu l nv nw"># return average age grouped by gender<br/>customer_table.groupby(['gender'])['age'].mean().round(2)</span></pre><p id="4358" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在r中，我们可以利用方便的<code class="fe ng nh ni nj b">group_by</code> ⁹从<code class="fe ng nh ni nj b">dplyr</code>对数据进行分组，然后通过<code class="fe ng nh ni nj b">summarize</code> ⁰方法计算指标:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="09a8" class="ns la it nj b gy nt nu l nv nw"># return both count and average age grouped by gender<br/>customer_table %&gt;% <br/>  group_by(gender) %&gt;% <br/>  summarize(count=n(), round(mean(age), 2))</span></pre><p id="3d48" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="12e6" class="ns la it nj b gy nt nu l nv nw">gender  | count  | round(mean(age),2) <br/>— — — — + — — — -+ - - - - - - - - - -<br/>Female  | 6      | 33.67<br/>Male    | 7      | 22.14<br/>(2 rows)</span></pre><h1 id="c947" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">9.更新/更改表</h1><p id="d28e" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">在SQL中，<code class="fe ng nh ni nj b">ALTER TABLE</code>语句用于添加、删除或修改现有表中的列和约束，而<code class="fe ng nh ni nj b">UPDATE</code>语句用于修改现有记录。</p><h2 id="1e50" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">9.1修改现有列的值</h2><p id="9b9e" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="b4a1" class="ns la it nj b gy nt nu l nv nw">UPDATE customer_table <br/>SET gender = 'M' <br/>WHERE gender = 'Male';</span><span id="92ca" class="ns la it nj b gy nx nu l nv nw">SELECT * FROM customer_table;</span></pre><p id="231e" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="519e" class="ns la it nj b gy nt nu l nv nw">id  | age | gender <br/> —  + — — + — — — — <br/> 1  | 27  | Female<br/> 2  | 27  | Female<br/> 3  | 45  | Female<br/> 6  | 43  | Female<br/> 7  | 28  | Female<br/> 12 | 32  | Female<br/> 4  | 18  | M<br/> 5  | 23  | M<br/> 8  | 27  | M<br/> 9  | 19  | M<br/> 10 | 21  | M<br/> 11 | 24  | M<br/> 13 | 23  | M<br/>(13 rows)</span></pre><p id="6daa" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python中，我们可以使用<code class="fe ng nh ni nj b">pandas.DataFrame.replace()</code>方法来更新现有列的值:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="e533" class="ns la it nj b gy nt nu l nv nw">customer_table.replace('Male', 'M')</span></pre><p id="6792" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">我们也可以同时替换多个值:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="27c9" class="ns la it nj b gy nt nu l nv nw">customer_table.replace(['Male', 'Female'], ['M', 'F'] )</span></pre><p id="c2d2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在R中，我们可以如下使用<code class="fe ng nh ni nj b">mutate()</code>:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="72df" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% <br/> mutate(gender = case_when(gender == 'Male' ~ 'M',<br/>                           gender == 'Female' ~ 'F'))</span></pre><h2 id="3234" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">9.2添加新列</h2><p id="6129" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="a2f7" class="ns la it nj b gy nt nu l nv nw">-- create new column<br/>ALTER TABLE customer_table<br/>ADD COLUMN age_bins VARCHAR;<br/></span><span id="8fea" class="ns la it nj b gy nx nu l nv nw">-- populate column based on existing values<br/>UPDATE customer_table <br/>SET <br/> age_bins = CASE<br/> WHEN age &lt; 20 THEN 'Teenager'<br/> WHEN age &gt; 20 AND age &lt; 30 THEN 'Between 20 and 30'<br/> WHEN age &gt; 30 AND age &lt; 40 THEN 'Over 30'<br/> WHEN age &gt; 40 THEN 'Over 40'<br/> ELSE 'Unknown'<br/> END;<br/></span><span id="2739" class="ns la it nj b gy nx nu l nv nw">-- observe result<br/>SELECT * FROM customer_table;</span></pre><p id="0341" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4560" class="ns la it nj b gy nt nu l nv nw"> id | age | gender  | age_bins <br/> — —+ — — + — — — — + — — — — — — — — — -<br/> 1  | 27  | Female  | Between 20 and 30<br/> 2  | 27  | Female  | Between 20 and 30<br/> 3  | 45  | Female  | Over 40<br/> 6  | 43  | Female  | Over 40<br/> 7  | 28  | Female  | Between 20 and 30<br/> 12 | 32  | Female  | Over 30<br/> 4  | 18  | Male    | Teenager<br/> 5  | 23  | Male    | Between 20 and 30<br/> 8  | 27  | Male    | Between 20 and 30<br/> 9  | 19  | Male    | Teenager<br/> 10 | 21  | Male    | Between 20 and 30<br/> 11 | 24  | Male    | Between 20 and 30<br/> 13 | 23  | Male    | Between 20 and 30<br/>(13 rows)</span></pre><p id="5788" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python中，我们可以通过<code class="fe ng nh ni nj b">pandas.DataFrame.apply()</code>函数实现这一结果，该函数沿<code class="fe ng nh ni nj b">pandas.DataFrame</code>的轴执行函数(<code class="fe ng nh ni nj b">axis=0</code>将函数应用于每一列，而<code class="fe ng nh ni nj b">axis=1</code>将函数应用于每一行):</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="ea06" class="ns la it nj b gy nt nu l nv nw">def age_bins(row):<br/> if row['age'] &lt; 20:<br/>   return 'Teenager'<br/> elif row['age'] &gt; 20 and row['age'] &lt; 30:<br/>   return 'Between 20 and 30'<br/> elif row['age'] &gt; 30 and row['age'] &lt; 40:<br/>   return 'Over 30'<br/> elif row['age’] &gt; 40:<br/>   return 'Over 40'<br/> else:<br/>   return 'Unknown'</span><span id="7906" class="ns la it nj b gy nx nu l nv nw">customer_table['age_bins'] = customer_table.apply(lambda row: age_bins(row), axis=1)</span></pre><p id="9abb" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在R中，我们仍然可以使用<code class="fe ng nh ni nj b">mutate</code>函数:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="c654" class="ns la it nj b gy nt nu l nv nw">customer_table %&gt;% <br/> mutate(age_bins = case_when(<br/>     age &lt; 20 ~ 'Teenager',<br/>     age &gt; 20 &amp; age &lt; 30 ~ 'Between 20 and 30',<br/>     age &gt; 30 &amp; age &lt; 40 ~ 'Between 30 and 40',<br/>     age &gt; 40 ~ 'Over 40',<br/>     TRUE ~ 'Unknown'))</span></pre><h2 id="4d72" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">9.3下降柱</h2><ul class=""><li id="d0d7" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me oj mg mh mi bi translated">在SQL中，我们可以通过<code class="fe ng nh ni nj b">ALTER TABLE .. DROP COLUMN</code>命令从表中删除一列。</li><li id="c259" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">在Python中，我们可以简单地将列名作为列表提供给<code class="fe ng nh ni nj b">pandas.DataFrame.drop()</code> ⁵方法。</li><li id="173a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated">在r中，<code class="fe ng nh ni nj b">select()</code> ⁶函数允许通过名称选择列，其中可以减去要删除的列。</li></ul><p id="7f25" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="7ad5" class="ns la it nj b gy nt nu l nv nw">ALTER TABLE customer_table <br/>DROP COLUMN age_bins;</span></pre><p id="6b0c" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="3b00" class="ns la it nj b gy nt nu l nv nw">customer_table.drop(['age_bins'], axis=1)</span></pre><p id="5bf8" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="8590" class="ns la it nj b gy nt nu l nv nw">select(customer_table, -'age_bins')</span></pre><h1 id="6e85" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">10.加入</h1><p id="8f9d" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">让我们假设信息分布在多个表上。例如，我们可能有一个customer表和一个purchase表，我们可能希望跨这两个表检索信息，以便生成业务报表。</p><p id="5369" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在SQL中，我们使用了<code class="fe ng nh ni nj b">JOIN</code> ⁴表操作符，它允许根据两个(或更多)表之间的相关列来组合它们的信息。</p><p id="cf87" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在观察不同的连接条件之前，我们应该<strong class="lt iu">创建第二个表/数据帧</strong>进行实验。</p><p id="4c67" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="5f29" class="ns la it nj b gy nt nu l nv nw">-- create purchase table<br/>CREATE TABLE IF NOT EXISTS purchase_table (<br/>    purchase_id SERIAL PRIMARY KEY,<br/>    product_id VARCHAR NOT NULL,<br/>    price NUMERIC NOT NULL,<br/> customer_id NUMERIC NOT NULL<br/>);</span><span id="a616" class="ns la it nj b gy nx nu l nv nw">-- populate purchase table with values<br/>INSERT INTO purchase_table VALUES<br/>  (1, 'SX145', 59.99, 1),<br/>  (2, 'DE438', 19.99, 2),<br/>  (3, 'TG671', 39.99, 4),<br/>  (4, 'ZR565', 129.99, 8),<br/>  (5, 'PO876', 200.00, 5),<br/>  (6, 'LI657', 25.50, 12),<br/>  (7, 'VF455', 69.99, 8),<br/>  (8, 'WS130', 75.00, 8),<br/>  (9, 'CV761', 120.00, 7);<br/>  <br/>-- observe table<br/>SELECT * FROM purchase_table;</span></pre><p id="23e2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="996b" class="ns la it nj b gy nt nu l nv nw">purchase_id  | product_id | price  | customer_id <br/>-------------+------------+--------+-------------<br/>           1 | SX145      |  59.99 |           1<br/>           2 | DE438      |  19.99 |           2<br/>           3 | TG671      |  39.99 |           4<br/>           4 | ZR565      | 129.99 |           8<br/>           5 | PO876      | 200.00 |           5<br/>           6 | LI657      |  25.50 |          12<br/>           7 | VF455      |  69.99 |           8<br/>           8 | WS130      |  75.00 |           8<br/>           9 | CV761      | 120.00 |           7<br/>(9 rows)</span></pre><p id="bbcb" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">我们创建对应于新表的<code class="fe ng nh ni nj b">pandas.DataFrame</code>:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="e877" class="ns la it nj b gy nt nu l nv nw">purchase_table =pd.DataFrame({<br/>    'purchase_id':[1, 2, 3, 4, 5, 6, 7, 8, 9],<br/>    'product_id':['SX145', 'DE438', 'TG671', 'ZR565', 'PO876',       <br/>                  'LI657', 'VF455', 'WS130', 'CV761'],<br/>    'price':[59.99, 19.99, 39.99, 129.99, 200.00, 25.50,<br/>             69.99, 75.00, 120.00],<br/>    'customer_id':[1, 2, 4, 8, 5, 12, 8, 8, 7]<br/>})</span></pre><p id="19b2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">类似地，我们在R中创建一个<code class="fe ng nh ni nj b">data.frame</code>:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="d813" class="ns la it nj b gy nt nu l nv nw">purchase_table &lt;- data.frame(<br/>  purchase_id = c(1, 2, 3, 4, 5, 6, 7, 8, 9),<br/>  product_id= c('SX145', 'DE438', 'TG671', 'ZR565','PO876','LI657',<br/>                'VF455', 'WS130', 'CV761'),<br/>  price = c(59.99, 19.99, 39.99, 129.99, 200.00, 25.50, <br/>            69.99, 75.00, 120.00),<br/>  customer_id = c(1, 2, 4, 8, 5, 12, 8, 8, 7))</span></pre><h2 id="f41c" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">10.1内部连接</h2><p id="dbbf" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated"><code class="fe ng nh ni nj b">INNER JOIN</code>根据相关列返回在两个表中具有匹配值的记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/3e282e3f4a1c8f0a2bbbeb9aa76565e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*ryuh8rLeONNJiOBNlFuMzA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内部联接。图片作者。</p></figure><p id="492b" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="5cda" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table as customer <br/> INNER JOIN purchase_table as purchase<br/>   ON customer.id = purchase.customer_id;</span></pre><p id="93bd" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="c8b7" class="ns la it nj b gy nt nu l nv nw">id | age | gender | purchase_id | product_id | price  | customer_id <br/>---+-----+--------+-------------+------------+--------+-------------<br/> 1 |  27 | Female |           1 | SX145      |  59.99 |           1<br/> 2 |  27 | Female |           2 | DE438      |  19.99 |           2<br/> 4 |  18 | Male   |           3 | TG671      |  39.99 |           4<br/> 5 |  23 | Male   |           5 | PO876      | 200.00 |           5<br/> 7 |  28 | Female |           9 | CV761      | 120.00 |           7<br/> 8 |  27 | Male   |           4 | ZR565      | 129.99 |           8<br/> 8 |  27 | Male   |           7 | VF455      |  69.99 |           8<br/> 8 |  27 | Male   |           8 | WS130      |  75.00 |           8<br/> 12|  32 | Female |           6 | LI657      |  25.50 |          12<br/>(9 rows)</span></pre><p id="5bd9" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">我们有13个客户和9次购买。由于<code class="fe ng nh ni nj b">INNER JOIN</code>只返回匹配的值，我们只观察到9条记录。查询不会返回没有进行过购买的客户。</p><p id="d4f5" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python中，我们可以如下使用<code class="fe ng nh ni nj b">pandas.DataFrame.merge()</code> ⁷:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4438" class="ns la it nj b gy nt nu l nv nw">pd.merge(customer_table,<br/>  purchase_table,<br/>  left_on='id',<br/>  right_on='customer_id')</span></pre><p id="fd77" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">默认情况下，<code class="fe ng nh ni nj b">pandas.DataFrame.merge()</code>执行一个<code class="fe ng nh ni nj b">INNER JOIN</code>。</p><p id="168a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在r中，我们可以使用⁸:的<code class="fe ng nh ni nj b">dplyr</code>连接方法</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="02a9" class="ns la it nj b gy nt nu l nv nw">customer_table  %&gt;%<br/>    inner_join(purchase_table, by=c('id' = 'customer_id'))</span></pre><h2 id="406a" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">10.2左连接</h2><p id="45ca" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated"><code class="fe ng nh ni nj b">LEFT JOIN</code>返回左表中的所有记录，以及右表中匹配的记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/77d25f3339f11cd2bf2f03cab82059ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*ldy4noef-5xVOwa6ZV4zOQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左接合。图片作者。</p></figure><p id="b923" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="a2cb" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table as customer <br/>  LEFT JOIN purchase_table as purchase<br/>    ON customer.id = purchase.customer_id;</span></pre><p id="e8da" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="9853" class="ns la it nj b gy nt nu l nv nw"> id | age | gender | purchase_id | product_id | price  | customer_id <br/>----+-----+--------+-------------+------------+--------+------------<br/>  1 |  27 | Female |           1 | SX145      |  59.99 |           1<br/>  2 |  27 | Female |           2 | DE438      |  19.99 |           2<br/>  3 |  45 | Female |             |            |        |            <br/>  4 |  18 | Male   |           3 | TG671      |  39.99 |           4<br/>  5 |  23 | Male   |           5 | PO876      | 200.00 |           5<br/>  6 |  43 | Female |             |            |        |            <br/>  7 |  28 | Female |           9 | CV761      | 120.00 |           7<br/>  8 |  27 | Male   |           4 | ZR565      | 129.99 |           8<br/>  8 |  27 | Male   |           7 | VF455      |  69.99 |           8<br/>  8 |  27 | Male   |           8 | WS130      |  75.00 |           8<br/>  9 |  19 | Male   |             |            |        |            <br/> 10 |  21 | Male   |             |            |        |            <br/> 11 |  24 | Male   |             |            |        |            <br/> 12 |  32 | Female |           6 | LI657      |  25.50 |          12<br/> 13 |  23 | Male   |             |            |        |            <br/>(15 rows)</span></pre><p id="d914" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python中，我们总是可以利用<code class="fe ng nh ni nj b">pandas.DataFrame.merge()</code>函数，但这次我们需要将<code class="fe ng nh ni nj b">how</code>参数指定为<code class="fe ng nh ni nj b">left</code>(其默认值为<code class="fe ng nh ni nj b">inner</code>)。</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="a0d6" class="ns la it nj b gy nt nu l nv nw">pd.merge(customer_table,<br/>         purchase_table,<br/>         left_on='id',<br/>         right_on='customer_id',<br/>         how='left')</span></pre><p id="f2c4" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在R中:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="f9d1" class="ns la it nj b gy nt nu l nv nw">customer_table  %&gt;% <br/>   left_join(purchase_table, by=c('id' = 'customer_id'))</span></pre><h2 id="e3dc" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">10.3右连接</h2><p id="7fd5" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated"><code class="fe ng nh ni nj b">RIGHT JOIN</code>返回右表中的所有记录，以及左表中匹配的记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/85e732839e29fc223a3c054a04ba47c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*YVpwgB7YxKD9RrCXqFqcBg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向右加入。图片作者。</p></figure><p id="d5aa" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="4a6a" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table as customer <br/> RIGHT JOIN purchase_table as purchase<br/>   ON customer.id = purchase.customer_id;</span></pre><p id="836b" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="5ad6" class="ns la it nj b gy nt nu l nv nw"> id | age | gender | purchase_id | product_id | price  | customer_id <br/>----+-----+--------+-------------+------------+--------+------------<br/>  1 |  27 | Female |           1 | SX145      |  59.99 |           1<br/>  2 |  27 | Female |           2 | DE438      |  19.99 |           2<br/>  4 |  18 | Male   |           3 | TG671      |  39.99 |           4<br/>  5 |  23 | Male   |           5 | PO876      | 200.00 |           5<br/>  7 |  28 | Female |           9 | CV761      | 120.00 |           7<br/>  8 |  27 | Male   |           4 | ZR565      | 129.99 |           8<br/>  8 |  27 | Male   |           7 | VF455      |  69.99 |           8<br/>  8 |  27 | Male   |           8 | WS130      |  75.00 |           8<br/> 12 |  32 | Female |           6 | LI657      |  25.50 |          12<br/>(9 rows)</span></pre><p id="340c" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在Python中:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="cab8" class="ns la it nj b gy nt nu l nv nw">pd.merge(customer_table,<br/>         purchase_table,<br/>         left_on='id',<br/>         right_on='customer_id',<br/>         how='right')</span></pre><p id="2180" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">在R中:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="ce54" class="ns la it nj b gy nt nu l nv nw">customer_table  <br/>    %&gt;% right_join(purchase_table, by=c('id' = 'customer_id'))</span></pre><h2 id="8a70" class="ns la it bd lb ny nz dn lf oa ob dp lj ly oc od ll ma oe of ln mc og oh lp oi bi translated">10.4完全加入</h2><p id="4b2b" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">当左表或右表中有匹配时，<code class="fe ng nh ni nj b">FULL JOIN</code>返回所有记录:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/d7fc7ec8db6fc0d0d767d840b9adfc59.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*xYwSNpmRdeufVc9MqhRzyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">完全加入。图片作者。</p></figure><p id="6d15" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">SQL语句:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="3b75" class="ns la it nj b gy nt nu l nv nw">SELECT * <br/>FROM customer_table as customer <br/>  FULL JOIN purchase_table as purchase<br/>    ON customer.id = purchase.customer_id;</span></pre><p id="c215" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">输出:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="00c9" class="ns la it nj b gy nt nu l nv nw">id  | age | gender | purchase_id | product_id | price  | customer_id <br/>----+-----+--------+-------------+------------+--------+------------<br/>  1 |  27 | Female |           1 | SX145      |  59.99 |           1<br/>  2 |  27 | Female |           2 | DE438      |  19.99 |           2<br/>  3 |  45 | Female |             |            |        |            <br/>  4 |  18 | Male   |           3 | TG671      |  39.99 |           4<br/>  5 |  23 | Male   |           5 | PO876      | 200.00 |           5<br/>  6 |  43 | Female |             |            |        |            <br/>  7 |  28 | Female |           9 | CV761      | 120.00 |           7<br/>  8 |  27 | Male   |           4 | ZR565      | 129.99 |           8<br/>  8 |  27 | Male   |           7 | VF455      |  69.99 |           8<br/>  8 |  27 | Male   |           8 | WS130      |  75.00 |           8<br/>  9 |  19 | Male   |             |            |        |            <br/> 10 |  21 | Male   |             |            |        |            <br/> 11 |  24 | Male   |             |            |        |            <br/> 12 |  32 | Female |           6 | LI657      |  25.50 |          12<br/> 13 |  23 | Male   |             |            |        |            <br/>(15 rows)</span></pre><p id="5178" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="667e" class="ns la it nj b gy nt nu l nv nw">pd.merge(customer_table,<br/>         purchase_table,<br/>         left_on='id',<br/>         right_on='customer_id',<br/>         how='outer')</span></pre><p id="0c83" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="d4d2" class="ns la it nj b gy nt nu l nv nw">customer_table  %&gt;% <br/>    full_join(purchase_table, by=c('id' = 'customer_id'))</span></pre><p id="c10a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><strong class="lt iu">备注</strong>:</p><ul class=""><li id="f300" class="lr ls it lt b lu nb lw nc ly nk ma nl mc nm me oj mg mh mi bi translated">在关系数据库系统和r之间执行连接操作的方式上有一些微小的差异。<br/>例如，在数据库和r处理NA/NaN值的方式上:<code class="fe ng nh ni nj b">dplyr</code>连接函数⁸将两个NA或NaN值视为相等，而数据库则不是这样。<br/>通过将值为<code class="fe ng nh ni nj b">never</code>的<code class="fe ng nh ni nj b">na_matches</code>参数传递给<code class="fe ng nh ni nj b">dplyr</code>连接函数，可以修改这种行为，从而在NA/NaN处理方面产生与数据库连接更相似的结果。</li><li id="d631" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me oj mg mh mi bi translated"><code class="fe ng nh ni nj b">pandas</code>也提供<code class="fe ng nh ni nj b">pandas.DataFrame.join()</code>来执行连接操作。虽然它与<code class="fe ng nh ni nj b">pandas.DataFrame.merge()</code>非常相似，但这两种方法存在差异，这里将详细讨论⁹.</li></ul><h1 id="9f4d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">11.结论</h1><ol class=""><li id="43be" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">有不同的方法可以达到同样的结果。在本文中，我们总结了用于数据操作的最常见的SQL查询，并为每一个查询提供了Python和R语言中许多可能的对应查询之一。这篇文章的目的是分享有用的实例，以及了解Python、R和SQL之间相似之处的方法。</li><li id="e212" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">SQL查询是为<code class="fe ng nh ni nj b">PostgreSQL</code>编写的，这是一个流行的开源关系数据库管理系统。不同的数据库可能呈现稍微不同的SQL风格。</li><li id="872c" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">我们在这篇文章中探讨的语句是<strong class="lt iu">不适当的</strong>，这意味着它们<strong class="lt iu">不会改变</strong>底层数据结构。例如，用<code class="fe ng nh ni nj b">customer_table.drop_duplicates()</code>选择不同的行不会从<code class="fe ng nh ni nj b">customer_table</code>中删除重复的行。为了保持变化，我们应该<strong class="lt iu">分配结果</strong>，例如:<code class="fe ng nh ni nj b">new_dataframe = customer_table.drop_duplicates()</code>。这也适用于R。为了完整起见，我们提醒许多<code class="fe ng nh ni nj b">pandas</code>方法通过接受设置为<code class="fe ng nh ni nj b">True</code>的<code class="fe ng nh ni nj b">inplace</code>参数也支持就地操作(默认情况下，该参数设置为<code class="fe ng nh ni nj b">False</code>)。r还通过将链操作符从<code class="fe ng nh ni nj b">%&gt;%</code>修改为<code class="fe ng nh ni nj b">%&lt;&gt;%</code>来支持就地操作。例子如下:</li></ol><p id="06a0" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">Python:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="f5c3" class="ns la it nj b gy nt nu l nv nw"># not in-place: customer_table is not filtered<br/>customer_table.drop_duplicates()</span><span id="180b" class="ns la it nj b gy nx nu l nv nw"># in-place: customer_table is filtered<br/>customer_table.drop_duplicates(inplace=True)</span></pre><p id="0107" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">r:</p><pre class="kj kk kl km gt no nj np nq aw nr bi"><span id="d45e" class="ns la it nj b gy nt nu l nv nw"># magrittr is the R package that provides the chain operator<br/>library(magrittr)</span><span id="0d1f" class="ns la it nj b gy nx nu l nv nw"># not in-place: customer_table is not filtered<br/>customer_table %&gt;% <br/>  filter(gender=='Female')</span><span id="d009" class="ns la it nj b gy nx nu l nv nw"># in-place: customer_table is filtered<br/>customer_table %&lt;&gt;% <br/>  filter(gender=='Female')</span></pre><h1 id="59be" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">12.参考</h1><p id="9541" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">[1]<a class="ae ky" href="https://pandas.pydata.org/docs/index.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/docs/index.html</a></p><p id="2cbe" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[2]<a class="ae ky" href="https://dplyr.tidyverse.org/" rel="noopener ugc nofollow" target="_blank">dplyr.tidyverse.org/</a></p><p id="0ed2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/frame.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/docs/reference/frame</a></p><p id="76c2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://www.postgresql.org/docs/10/sql-commands.html" rel="noopener ugc nofollow" target="_blank">postgresql.org/docs/10/sql-commands</a></p><p id="dde1" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[5]<a class="ae ky" href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/data.frame" rel="noopener ugc nofollow" target="_blank">rdocumentation . org/packages/base/versions/3 . 6 . 2/topics/data . frame</a></p><p id="680a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.append.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/docs/reference/api/pandas.[6]DataFrame.append </a></p><p id="b06d" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[7]<a class="ae ky" href="https://www.rdocumentation.org/packages/tibble/versions/3.1.6/topics/add_row" rel="noopener ugc nofollow" target="_blank">rdocumentation . org/packages/tible/versions/3 . 1 . 6/topics/add _ row</a></p><p id="1d40" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[8]<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html</a></p><p id="cee2" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[9]<a class="ae ky" href="https://www.rdocumentation.org/packages/utils/versions/3.6.2/topics/head" rel="noopener ugc nofollow" target="_blank">rdocumentation . org/packages/utils/versions/3 . 6 . 2/topics/head</a></p><p id="0898" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[10]pandas.pydata.org/docs/reference/api/pandas.<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop_duplicates.html" rel="noopener ugc nofollow" target="_blank">DataFrame.drop_duplicates </a></p><p id="00a7" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">【11】<a class="ae ky" href="https://dplyr.tidyverse.org/reference/distinct.html" rel="noopener ugc nofollow" target="_blank">dplyr.tidyverse.org/reference/distinct</a></p><p id="5543" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc</a></p><p id="e0c0" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html" rel="noopener ugc nofollow" target="_blank">【13】pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values </a></p><p id="160d" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[14]<a class="ae ky" href="https://dplyr.tidyverse.org/reference/arrange.html" rel="noopener ugc nofollow" target="_blank">dplyr.tidyverse.org/reference/arrange</a></p><p id="b618" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/docs/reference/api/pandas.[15]data frame . description</a></p><p id="3b5e" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[16]<a class="ae ky" href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/summary" rel="noopener ugc nofollow" target="_blank">rdocumentation . org/packages/base/versions/3 . 6 . 2/topics/summary</a></p><p id="1189" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.value_counts.html" rel="noopener ugc nofollow" target="_blank">【17】pandas.pydata.org/docs/reference/api/pandas.Series.value_counts </a></p><p id="b5b6" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html" rel="noopener ugc nofollow" target="_blank">【18】pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby </a></p><p id="73c4" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[19]<a class="ae ky" href="https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/group_by" rel="noopener ugc nofollow" target="_blank">rdocumentation . org/packages/DP lyr/versions/0 . 7 . 8/topics/group _ by</a></p><p id="7c24" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[20]<a class="ae ky" href="https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/summarise" rel="noopener ugc nofollow" target="_blank">rdocumentation . org/packages/DP lyr/versions/0 . 7 . 8/topics/summary</a></p><p id="cf25" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.replace.html" rel="noopener ugc nofollow" target="_blank">【21】pandas.pydata.org/docs/reference/api/pandas.DataFrame.replace </a></p><p id="c1d4" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[22]<a class="ae ky" href="https://dplyr.tidyverse.org/reference/mutate.html" rel="noopener ugc nofollow" target="_blank">dplyr.tidyverse.org/reference/mutate</a></p><p id="cd13" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[23]pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html" rel="noopener ugc nofollow" target="_blank"/></p><p id="0a44" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">【pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop 25】<a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html" rel="noopener ugc nofollow" target="_blank"/></p><p id="0365" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[26]<a class="ae ky" href="https://www.rdocumentation.org/packages/dplyr/versions/0.7.8/topics/select" rel="noopener ugc nofollow" target="_blank">rdocumentation . org/packages/DP lyr/versions/0 . 7 . 8/topics/select</a></p><p id="9fef" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge</a></p><p id="d50a" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated"><a class="ae ky" href="https://dplyr.tidyverse.org/reference/mutate-joins.html" rel="noopener ugc nofollow" target="_blank">dplyr.tidyverse.org/reference/mutate-joins</a></p><p id="2eec" class="pw-post-body-paragraph mo mp it lt b lu nb ju mq lw nc jx mr ly nd mt mu ma ne mw mx mc nf mz na me im bi translated">[29]<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html" rel="noopener ugc nofollow" target="_blank">pandas.pydata.org/pandas-docs/stable/user_guide/merging</a></p></div></div>    
</body>
</html>