<html>
<head>
<title>Yelp Data Scientist Interview Question Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Yelp数据科学家面试问题演练</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/yelp-data-scientist-interview-question-walkthrough-dee5e5ba39b2#2022-01-28">https://towardsdatascience.com/yelp-data-scientist-interview-question-walkthrough-dee5e5ba39b2#2022-01-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="effc" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">Yelp数据科学家面试问题演练</h1></div><div class=""><h2 id="252d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">帮你解决Yelp SQL面试问题</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/b2d3f8a271da2f4b2a7b16b753fcca8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T6Vc--GFDRUmzbp-"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图像</p></figure><p id="cd42" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你曾经去过一个新城镇，想找一家好餐馆，你可能知道Yelp。作为一家企业，Yelp专注于创建和维护总结大量信息的产品，以帮助客户做出明智的决策。它追踪世界各地成千上万不同企业的公众形象。</p><p id="5946" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">组织所有这些数据并不是一件容易的事情，因此Yelp一直在寻找有前途的数据科学家加入其行列。</p><p id="963d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Yelp的数据科学家必须编写不同难度的查询。为了在工作中取得成功，数据科学家候选人必须具备扎实的基本和中级SQL概念的基础知识。我们来看看回答技术面试问题你应该知道的具体概念。</p><h1 id="5ca2" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">面试中测试基本到中级概念</h1><p id="dc97" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">最佳候选人用最少的代码行编写回答问题的查询。如果没有对SQL概念、语句和子句的深入了解，这通常是不可能的。</p><p id="2a8e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">扎实的基础知识可以帮助你获得一份工作。更重要的是，一旦你有了工作，掌握实用和理论上的SQL可以帮助你保住工作。雇主希望有人写防呆代码。Yelp也不例外。要编写这样的查询，您需要对SQL有深刻的理解。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/6f584ea160700f65fc601ed2069459e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dhBtNVrx7dKqpKxTEb0VsQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者在<a class="ae kw" href="https://canva.com/" rel="noopener ugc nofollow" target="_blank"> Canva </a>上创建的图片</p></figure><p id="d7a9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">以下是回答这类数据科学面试问题时你应该知道的概念:</p><p id="066a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">选择/从</strong></p><p id="5f76" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当您开始学习SQL时，SELECT和FROM语句通常是您学习的最初几个概念。我们使用FROM语句来指定我们将使用的表。我们使用SELECT语句来查看表中的特定列。</p><p id="c5fc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这两种说法很容易掌握。不管有多难，SELECT和FROM对于编写任何SQL查询都是必不可少的。因此，如果您没有SQL的工作知识，这两条语句是一个很好的起点。</p><p id="d8cd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">哪里</strong></p><p id="b4c2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Yelp的用户通常希望看到最受欢迎的商家。过滤这些数据是Yelp数据科学家工作的一大部分。</p><p id="8334" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">WHERE语句允许您设置条件。编写SQL查询时，其主要目的是确保只返回满足指定条件的记录。WHERE语句中可以使用许多运算符。具体可以用:equals(=)，not equals(！=)、大于(&gt;)、小于(&lt;)以及比较运算符的其他变体。对数值使用比较运算符很容易。</p><p id="592c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您还应该知道如何比较非数值(使用=或！=比较运算符)。要编写条件，必须使用正确的语法规则。例如，要将列值与文本值进行比较，需要单引号“”。要编写条件，必须使用正确的语法规则。例如，要将列值与文本值进行比较，需要单引号“”。此外，您应该知道如何使用字母和不同的运算符按照字母顺序进行排序。</p><p id="49d2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">例如，您可能需要删除以字母A、B或c开头的值，SQL中的WHERE语句非常通用，可以应用于许多不同的任务。</p><p id="1552" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">最小值/最大值()</strong></p><p id="ee89" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这些问题以及类似的问题通常会测试您对中级SQL概念的了解，例如SQL中的MIN()和MAX()聚合函数。在我们的例子中，候选人必须找到拥有最多“酷”选票的企业。在这种任务中，MAX()聚合函数会很有用。它返回指定列中具有最大值的行。MIN()返回最低值。</p><p id="910e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于数值，使用这些聚合函数是很直观的。此外，了解MIN()和MAX()在应用于非数值时的工作方式也很有用。例如，MIN()函数可用于查找一列中最早的日期或以A开头的单词或字母表中其他较早的字母。MAX()可以做相反的事情。阅读本文“<a class="ae kw" href="https://www.stratascratch.com/blog/basic-sql-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> <em class="mq">基础SQL面试问题</em> </a>”了解更多关于聚合函数的知识。</p><p id="0a97" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">排序依据</strong></p><p id="1191" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">通常会遇到<a class="ae kw" href="https://www.stratascratch.com/blog/sql-interview-questions-you-must-prepare-the-ultimate-guide/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> SQL面试问题</a>，要求您找出特定列中具有最高值的行。理解这一概念对于回答今天<a class="ae kw" href="https://www.stratascratch.com/blog/data-science-interview-guide-questions-from-80-different-companies/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">数据科学访谈</a>中提出的大多数SQL问题至关重要。ORDER BY允许您指定行排列的标准。该子句通常与另外两个关键字一起使用:DESC和ASC。这些关键字帮助您指定是希望结果按升序还是降序排列。</p><p id="5476" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在处理数字时，ORDER BY子句的默认行为很容易预测:它将从最小的数字到最大的数字对值进行排序。数据科学家职位的优秀候选人还应该知道如何对字母和日期值使用ORDER BY。</p><p id="aabe" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">内部连接</strong></p><p id="bf21" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">连接是SQL中不可或缺的概念。任何有抱负的数据科学家都应该在进入更高级的概念之前掌握<a class="ae kw" href="https://www.stratascratch.com/blog/sql-join-interview-questions/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">连接</a>。由于其实用性，内部连接可用于回答各种各样的SQL问题。</p><p id="980e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先，考生应该理解编写SQL查询的语法。例如，您可以从组合表中选择列，而不仅仅是from语句后面的列。此外，如有必要，他们应该能够演示如何从一个表中选择列。</p><p id="ef1c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">具有编写SQL查询实际知识的数据科学家也应该理解编写别名的重要性。他们还应该熟悉用SQL编写别名的语法，并理解它们在提高SQL查询可读性方面的作用。</p><p id="dccb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">编写内部连接的另一个重要方面是ON语句。熟练的数据科学家应该了解它的用途，并能够正确地将值从一个表映射到另一个表。选择正确的连接键来获得期望的结果也很重要。</p><p id="fded" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">考生应该能够解释多种联接类型之间的区别。当两个表中的记录没有任何公共值时会发生什么？INNER JOIN是做什么的？根据资历级别，候选人应该能够区分内部和外部连接，并选择正确的类型来解决手头的问题。</p><p id="bcdf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本文中，我们将回顾一个问题，并使用内部连接的关键特性来得出答案。</p><h1 id="a163" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">Yelp数据科学家面试问题演练</h1><p id="e8c7" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">在本文中，我们将重点关注Yelp数据科学家职位候选人的问题。</p><p id="2522" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">顶级酷票</strong></p><p id="0093" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个问题目前在StrataScratch平台上被标记为‘中等’难度。条件相当简单明了。候选人必须编写一个查询来查找具有最高“酷”票数的记录，并以特定的格式返回。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mr"><img src="../Images/3e76a986c04db01655f4c40968c73b3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C28LxF2ZCB-TTX0K1zdbAA.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10060-top-cool-votes?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="9f37" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">链接:<a class="ae kw" href="https://platform.stratascratch.com/coding/10060-top-cool-votes?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">https://platform . stratascratch . com/coding/10060-top-cool-votes</a></p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="4d4f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个问题中，候选人必须使用一个有9列的表格。他们必须编写SQL查询来查找在<strong class="kz ir"> cool </strong>列中具有最高整数值的记录。然后，受访者必须输出两列各自的值，<strong class="kz ir"> business_name </strong>和<strong class="kz ir"> review_text </strong>。</p><p id="62b2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这项任务很简单，有很多方法可以得到想要的结果。因此，您的重点应该是编写一个优化的SQL查询。只要您理解了本文中概述的原则和陈述，您应该能够找到一个运行良好且不过分冗长的解决方案。</p><p id="bb0b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">可用数据集</strong></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mu"><img src="../Images/746db7be1438271d353c4eb36d2463bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o67opGjp4HYgOZodeHUpBQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10060-top-cool-votes?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><h2 id="50bb" class="mv lu iq bd lv mw mx dn lz my mz dp md lg na nb mf lk nc nd mh lo ne nf mj ng bi translated">数据假设</h2><p id="a2e5" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">解决任何SQL问题的第一步，也可能是最重要的一步是研究可用数据。</p><p id="224c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先要做的是扫描列名及其对应的数据类型。你可以利用这个机会形成第一印象，进入思维空间解决问题。如果有些事情不清楚，你可以提问来检查你的假设。</p><p id="49ea" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">只要有可能，也试着从表中查看实际记录。看到实际的数据可以帮助你更好地理解你将使用什么样的价值观。除了实际数据之外，注意列名和数据类型将为您制定计划提供足够的信息。</p><p id="5013" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你已经分析了数据，但事情仍然不清楚，不要害怕要求澄清一些观点。你可以通过问一些具体的、指示性的问题来获得更多的信息。</p><p id="6740" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据问题的表述，您应该准备好对值进行造型、格式化或以任何其他方式操作数据。一旦完成了对表的分析，您还应该清楚哪些列是重要的，哪些列可以安全地忽略。</p><p id="dc55" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">让我们来看看<strong class="kz ir"> yelp_reviews </strong>表的列:</p><ul class=""><li id="c1c0" class="nh ni iq kz b la lb ld le lg nj lk nk lo nl ls nm nn no np bi translated">这个问题的最终解决方案应该返回<strong class="kz ir"> business_name </strong>列中的值。我们将使用<strong class="kz ir"> SELECT </strong>语句来查看该列。</li><li id="8bbe" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">我们的问题没有提到识别每个评论，所以我们可以忽略<strong class="kz ir"> review_id </strong>列。</li><li id="dba7" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">这个问题不要求我们识别用户，所以我们可以忽略<strong class="kz ir"> user_id </strong>列</li><li id="ea21" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">我们不必用‘星星’的数量作为判断标准，所以<strong class="kz ir">星星</strong>列可以忽略。</li><li id="91d4" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">由于时间顺序对解决方案并不重要，我们可以忽略<strong class="kz ir"> review_date </strong>列</li><li id="5630" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">最终输出必须包括来自<strong class="kz ir"> review_text </strong>列的值，因此我们将需要它。</li><li id="251e" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">该问题要求我们确定拥有最多“酷”投票的企业，因此我们需要使用<strong class="kz ir">酷</strong>列。另外两个栏目——<strong class="kz ir">搞笑</strong>和<strong class="kz ir">有用</strong>可以忽略。</li></ul><p id="5fd0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个具体问题可以用许多不同的方法来解决。如果你只能选择一个解决方案，但无法在几个好的选项中做出选择，你应该问问面试官。有时候面试官可能更喜欢标准SQL而不是它的许多方言。</p><h2 id="b9c4" class="mv lu iq bd lv mw mx dn lz my mz dp md lg na nb mf lk nc nd mh lo ne nf mj ng bi translated">解决方案逻辑</h2><p id="e976" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">一旦您理解了问题和包含所有数据的表，您就可以轻松地回答像这样的复杂的SQL问题。首先，我们必须制定回答这个问题的方法:</p><ul class=""><li id="7117" class="nh ni iq kz b la lb ld le lg nj lk nk lo nl ls nm nn no np bi translated">根据问题描述，我们需要输出两列— <strong class="kz ir"> business_name </strong>和<strong class="kz ir"> review_text </strong>。首先，我们必须使用SELECT语句来查看它们。</li><li id="6232" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">然后，我们必须编写SELECT语句，但这次是为了查看具有最高票数的记录。我们可以使用MAX()聚合函数找到这个记录。</li><li id="c56f" class="nh ni iq kz b la nq ld nr lg ns lk nt lo nu ls nm nn no np bi translated">最后，我们编写ON语句来过滤掉所有没有最高“酷”票数的企业。</li></ul><p id="ced3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要回答Yelp数据科学家的采访问题，您必须具备良好的基本和中级SQL概念的工作知识。在第一步中，我们需要使用SELECT和FROM语句的组合。这是任何SQL查询的最基本的构建块，因此您应该轻松地完成这一步。</p><p id="3b27" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在下一步中，我们使用MAX()聚合函数来查找<strong class="kz ir"> cool </strong>列中的最大数值。函数的名称是自我描述的:它返回列中的最大值。</p><p id="2d78" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">请注意，在执行任何类型的连接时，为表提供别名总是一个好主意。这样，您不必每次都键入表名。可以在每个表名后分配别名。您留下一个空格，并为该表编写别名。</p><p id="72d5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">看着这个问题，有人可能会想:如果两个或更多的企业分享最高数量的“酷”票会怎么样？在我们的解决方案中，我们使用内部连接来保留拥有最高票数的企业，并过滤掉其余的企业。如果有三家企业获得了最高票数，我们的最终结果将包括这三家企业。</p><h2 id="1a5e" class="mv lu iq bd lv mw mx dn lz my mz dp md lg na nb mf lk nc nd mh lo ne nf mj ng bi translated">常见错误解决方案</h2><p id="f7de" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">正如我们之前提到的，知识渊博的数据科学家可以找到多种方法来解决问题。最常见的错误之一是使用ORDER BY和LIMIT语句。使用这种方法，我们编写一个查询，以降序对“cool”列中的值进行排序，并使用LIMIT语句显示第一个值。</p><p id="3aff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这种方法的问题是，最有可能的是，将有多个企业拥有最高数量的“酷”票。根据问题，我们需要退回所有这些业务，而不仅仅是一个。如果我们不知道有多少企业共享最高票数，极限陈述实际上是没有用的。</p><pre class="kh ki kj kk gt nv nw nx ny aw nz bi"><span id="6182" class="mv lu iq nw b gy oa ob l oc od">SELECT business_name,<br/>       review_text<br/>FROM yelp_reviews<br/>ORDER BY cool DESC<br/>LIMIT 1</span></pre><h2 id="f720" class="mv lu iq bd lv mw mx dn lz my mz dp md lg na nb mf lk nc nd mh lo ne nf mj ng bi translated">正确的解决方案</h2><p id="c184" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated"><strong class="kz ir">编写子查询来查找最高数量的“酷”票</strong></p><p id="271c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先，我们必须编写一个子查询，它将返回“cool”列中的最大值。我们使用AS语句，所以我们可以将这个值称为' max_cool '。</p><pre class="kh ki kj kk gt nv nw nx ny aw nz bi"><span id="d534" class="mv lu iq nw b gy oa ob l oc od">SELECT max(cool) AS max_cool<br/>FROM yelp_reviews</span></pre><p id="1e69" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">运行此代码将返回以下输出:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oe"><img src="../Images/7790f9edb4c14cfba0a456cb66c5a5cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k3AfciiKeYD4ipvsf8KLVQ.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10060-top-cool-votes?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="4daf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这一步帮助我们解决了一个难题——我们知道在<strong class="kz ir"> yelp_reviews </strong>表格中，企业获得“酷”投票的最高可能数量。</p><p id="285c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">抓取感兴趣的栏目</strong></p><p id="82cc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">首先，我们必须选择最终输出中包含的两个字段。我们应该返回来自<strong class="kz ir"> yelp_reviews </strong>表中两列的值，这两列是<strong class="kz ir"> business_name </strong>和<strong class="kz ir"> review_text </strong>列。完成后，SQL代码将如下所示:</p><pre class="kh ki kj kk gt nv nw nx ny aw nz bi"><span id="dc84" class="mv lu iq nw b gy oa ob l oc od">SELECT business_name,<br/>       review_text<br/>FROM yelp_reviews</span></pre><p id="cba0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该查询将返回具有相应<strong class="kz ir"> review_text </strong>值的所有企业。让我们来看看:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi of"><img src="../Images/a237f03ff3c0dad65c1e0d196fb08777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85ABlhlIUQ-SDIvo2H5D9w.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10060-top-cool-votes?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="5af6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">使用内部连接过滤掉业务</strong></p><p id="961b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在最后一步，我们使用内部连接过滤掉没有达到最大“酷”票数的企业。<br/>为了实现这一点，我们将使用之前创建的子查询内部连接<strong class="kz ir"> yelp_reviews </strong>表。</p><p id="0b46" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将给出每个表的别名，以使查询更具可读性。“yr”用于<strong class="kz ir"> yelp_reviews </strong>表，而“mc”用于子查询。</p><pre class="kh ki kj kk gt nv nw nx ny aw nz bi"><span id="7f44" class="mv lu iq nw b gy oa ob l oc od">SELECT business_name,<br/>       review_text<br/>FROM yelp_reviews yr<br/>INNER JOIN (<br/>    SELECT<br/>        max(cool) as max_cool<br/>    FROM yelp_reviews) mc<br/>ON yr.cool = mc.max_cool</span></pre><p id="a703" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最后，我们必须选择连接键并编写on语句的条件。我们必须参考<strong class="kz ir"> yelp_reviews </strong>表中的<strong class="kz ir"> cool </strong>列，并将其设置为最大值。</p><p id="692e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这是最终答案。如果我们运行代码，输出将如下所示:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi og"><img src="../Images/f090e78adf4afaa2c8a9d788e887fd99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8QRDvPXQE5S3OScS5XUM1Q.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">截图来自<a class="ae kw" href="https://platform.stratascratch.com/coding/10060-top-cool-votes?python=&amp;utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> StrataScratch </a></p></figure><p id="67ea" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这两家公司都拥有最高的“酷”票数。</p><p id="9c7f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">另一个正确的解决方案</strong></p><p id="5306" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">使用内部连接过滤掉投票数低于最大值的企业非常简单，但是还有一个更简单的解决方案。</p><p id="352c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">逻辑大致相同:我们选择想要查看的列，并有条件地返回具有最高“酷”投票数的记录。就像使用INNER JOIN的解决方案一样，我们使用max()聚合函数来查找最高票数。主要区别在于，使用这种方法，我们使用WHERE语句来过滤企业。</p><p id="efbc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该解决方案回答了Yelp数据科学家的采访问题，并处理了边缘案例。运行该查询将返回任意数量的具有最高票数的企业。有人可能会说，由于这种解决方案只需要编写较少的代码，因此是一种更优化的解决方案。</p><pre class="kh ki kj kk gt nv nw nx ny aw nz bi"><span id="507b" class="mv lu iq nw b gy oa ob l oc od">SELECT business_name,<br/>       review_text<br/>FROM yelp_reviews<br/>WHERE cool =<br/>    (SELECT max(cool)<br/>     FROM yelp_reviews)</span></pre><h2 id="fcd9" class="mv lu iq bd lv mw mx dn lz my mz dp md lg na nb mf lk nc nd mh lo ne nf mj ng bi translated">最后的话</h2><p id="bee6" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">像Yelp这样的公司正在寻找编写简单而有效的SQL查询的数据科学家。<a class="ae kw" href="https://www.stratascratch.com/blog/5-tips-to-prepare-for-a-data-science-interview/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">为面试</a>做好充分准备可以显著增加你<a class="ae kw" href="https://www.stratascratch.com/blog/how-to-get-a-data-science-job-the-ultimate-guide/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank">获得数据科学工作</a>的机会。如果你想知道如何构建你的代码，特别是在性能和可读性方面，我们推荐我们的帖子“<a class="ae kw" href="https://www.stratascratch.com/blog/best-practices-to-write-sql-queries-how-to-structure-your-code/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"> <em class="mq">编写SQL查询的最佳实践</em> </a>”。</p><p id="c96f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这篇文章中，我们回答了一个有趣的问题，这个问题是问参加Yelp数据科学家职位面试的候选人的。这不是最容易解决的问题，但面试官用它来衡量候选人的SQL知识的深度。</p></div><div class="ab cl oh oi hu oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ij ik il im in"><p id="92a0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="mq">最初发表于</em><a class="ae kw" href="https://www.stratascratch.com/blog/yelp-data-scientist-interview-question-walkthrough/?utm_source=blog&amp;utm_medium=click&amp;utm_campaign=medium" rel="noopener ugc nofollow" target="_blank"><em class="mq">https://www.stratascratch.com</em></a><em class="mq">。</em></p></div></div>    
</body>
</html>