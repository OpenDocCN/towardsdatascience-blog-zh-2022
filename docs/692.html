<html>
<head>
<title>Scaling Up Your Data Science Means Scaling Up Your Compute</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">扩展您的数据科学意味着扩展您的计算</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/scaling-up-your-data-science-means-scaling-up-your-compute-ead3d5dd243d#2022-01-24">https://towardsdatascience.com/scaling-up-your-data-science-means-scaling-up-your-compute-ead3d5dd243d#2022-01-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="e1a7" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">扩展您的数据科学意味着扩展您的计算</h1></div><div class=""><h2 id="5e9e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用云虚拟机设置支持远程桌面的数据科学环境</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/96f2e8ab1ec06e45b56ac16deb2306fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HuibsKSgEkB2iBP3"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Artur Aldyrkhanov 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5b96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每个数据科学家的旅程中，经常会有这样一个时刻，她/他/他们已经不再学习数据科学的基础知识，并开始将新获得的知识应用到越来越大的数据集。与此同时，这些数据科学家也经常开始试验更复杂的模型，如深度学习模型。</p><p id="a5b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着我们的数据集越来越大，模型越来越复杂，所需的计算资源也在增加。在不太遥远的过去，这意味着我们需要购买更好的硬件。内存更大、光盘更大、芯片更快的笔记本电脑。幸运的是，如今随着云技术的出现，我们可以利用大得多的计算资源进行有限的使用，其成本只是购买高性能笔记本电脑的一小部分。</p><p id="823d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不幸的是，对于今天的数据科学学生来说，这些云资源也提供了许多利用更强大的计算环境的选项。如此之多，以至于它可能会变得相当混乱，不知道该把重点放在哪里。DataBricks、AWS Sagemaker或Google CoLab等数据科学平台都提供托管数据科学环境，让数据科学家能够访问更强大的计算资源。</p><p id="a331" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些或多或少“受管理”的选项的缺点是，每个平台都有难以驾驭的方面。例如，Google CoLab使用一个非持久性磁盘来存储您的工件(例如csv文件、结果输出等)，每次会话结束时都会删除这些工件。此外，磁盘环境的目录结构可能并不总是容易理解。最后，添加更多您可能需要的软件作为您的数据科学管道的一部分会更加困难，因为您对用于支持您的笔记本电脑的虚拟机的可见性更低。</p><p id="d5ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管有这些限制，云环境仍然为数据科学家提供了大量短期借用大量计算资源的潜力，这有助于控制成本。在本教程的剩余部分，我将带您使用虚拟机和云存储桶来设置云数据科学环境。此外，我们将建立一个远程桌面连接，并安装Anaconda的Miniconda，以实现更丰富的视觉体验，更类似于您自己的个人笔记本电脑。我们的目标是在不倾家荡产的情况下，让有兴趣扩大数据科学工作负载的年轻数据科学家具备相关能力。</p><p id="04fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于那些只需要高级步骤而不需要所有解释的人，请参见TL；文末博士。让我们跳进来。</p><h1 id="503e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第一步:选择云平台并建立账户</h1><p id="14ca" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">让我们面对现实吧，随着越来越多的公司使用云服务构建基础设施，云计算将会继续存在。对于所有数据科学家来说，熟悉云技术是数据科学之旅的一个基本组成部分，因为我们希望在这个不断发展的商业环境中保持竞争力。对于数据科学企业家来说，学习如何导航和利用云服务更加重要，因为学习这些技能可以让我们获得高性能计算环境和一流的人工智能服务，使我们的初创公司能够支持大规模企业。</p><p id="cee3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在现有的“三大”云平台(如AWS、微软Azure、谷歌云平台[GCP])中设立一两个账户是向前迈出的重要一步。在本教程中，我们利用GCP，但AWS和微软的步骤是相似的，有一些明显的小差异。</p><p id="bdb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这三种云中的每一种都提供了一个可通过浏览器访问的管理控制台。要找到GCP控制台，我只需打开Chrome，搜索“GCP控制台”如果你有一个链接到Chrome浏览器的Gmail帐户，点击搜索链接将打开该帐户下的控制台。如果您是第一次访问GCP控制台，您的屏幕应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/521a4f9d02f2fad94c77cb4ac3d7b477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRMKQ1tObvr0LlkxkP-Cag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="168e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会注意到谷歌提供300美元信用的免费试用，这相当于相当多的实验。您还将被要求设置计费信息，这可以通过单击控制台中的“计费”链接来完成。请注意，虽然本教程中的大多数服务都很便宜，但如果不删除，随着时间的推移，它们会产生一些费用。一个很好的经验是，云服务使我们能够轻松扩展，但当我们这样做时，我们的成本也会增加😊让潜在的雇主知道你了解扩展这些云服务的后果，因此会是他们云成本的好管家，这总是好的。</p><p id="fbcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">先不说速度，几年前我很快就学到了这一课。我通过谷歌的NLP API运行一些从互联网上搜集的文本，为我正在测试的实验产品提取实体。我们的目标是将搜索范围扩大到数千个抓取的网页。当我自动化这个过程时，我注意到代码需要一段时间才能完成。不久之后，谷歌给我发了一封电子邮件，大意是“嘿，老兄，你正在运行异常高数量的API请求，所以我们为你停止了它，因为我们认为可能有问题。”天哪，有过吗？！？当我爬到我的控制台仪表板上去看发生了什么事时，我的胃沉了下去。啊，蟹肉块，我的预期账单从几美元涨到了300多美元。听起来不多，但对于一个我亲自买单的实验来说，只能说这远远超出了预算。经过一番挖掘，我发现我在搜索中找到的一个网页是一本书的几千页电子版。惨痛的教训。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/1fb4c833e7f773d11ad6cb50c56e5e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jUH78o9lTp4jrGLY_d9Vbw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="f40a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你建立了你的帐户，点击“创建项目”按钮。如果你已经设置了GCP，那么你很可能会看到你已经在你工作的最后一个项目中，如下图所示。您可以选择为本教程创建一个新项目，也可以留在当前使用的项目中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/074c0ef1a5d48cb116176f1d9ffc42ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfwLvkzMH_xDDEAeDc3KIQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="6385" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤2:创建虚拟机和存储桶</h1><p id="155b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">启用帐户后，下一步是设置一个虚拟机，用于设置我们的数据科学环境。点击左上角的“汉堡”菜单，向下滚动到菜单的“计算”部分。在“计算”下，你会看到一个“计算引擎”的选项，将鼠标悬停在该选项上会打开另一个带有更多选项的侧边栏。在顶部，您应该会看到“虚拟机实例”单击此处，让我们设置虚拟机。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/18604b3d55c5999d2f85cfaff6a4ba15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nH5Gh_U22A_JD1vfIMVoiw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="22cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在虚拟机设置页面上，您会注意到相当多的选项。让我们讨论一下数据科学环境中的重要问题。首先，是选择地区。选择地理空间上离您最近的地区，以确保最佳的网络速度。</p><p id="69a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，选择您希望使用的实例类型。请注意，较大的计算资源与较高的每小时成本相关，例如正常运行时间。默认选择是E2实例，这是通用机器，当您向下滚动不同的E2选项时，仍然提供相当多的计算。对于这个演示，我将选择一台小型机器，它有2个虚拟CPU(vCPU)和2 GB的RAM。把vCPUs想象成线程。如果您有2个vCPUs，您可以跨2个线程进行多进程处理。</p><p id="fae6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这台机器的成本大约是0.02美元/小时，我们可以看到，如果我不小心让这台机器24/7运行一个月，它只需要大约13美元。不算太寒酸。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/91407b6f3d5e92d03840c1956cf85b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Njw0afuKG2GdEal9zfcIw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="809e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们要更改的下一个选项是启动盘的大小和操作系统。默认情况下，Debian OS包含一个10 GB的引导磁盘，但是由于我们的目标是为我们的数据科学开发设置一个具有更丰富视觉体验的远程桌面，并计划安装Anaconda，我们将需要一个更大的引导磁盘来处理所有这些应用程序。我选择了100 GB的启动盘。请记住，您还需要为正在使用的磁盘付费，也可以选择为SSD等速度更快的磁盘付费，但它们的价格甚至更高。不幸的是，引导磁盘不能像虚拟机那样关闭，所以只要它们在我们的帐户中，我们就要为它们付费。然而，总的来说，我们每月的花费仍然只有22美元左右。幸运的是，即使在启动虚拟机之后，磁盘大小也是可以调整的。</p><p id="ea3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我也喜欢用Ubuntu，所以我把我的OS换成了包含Ubuntu。请注意，使用一些操作系统，如Ubuntu Pro，会产生额外的云费用。</p><p id="190b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在设置我们的虚拟机时，我们最不想做的事情是选择让所有Google APIs都可以访问虚拟机的选项(“允许完全访问所有云API”)。通过选择此选项，我们可以确保我们的虚拟机能够访问其他云服务，如我们将设置的云存储桶或Google的认知服务，如Google NLP。Google NLP是一个经过预先训练的机器学习解决方案，用于从非结构化文本中提取含义(参见上面我的故事，了解我如何使用API)😊).</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/38faa70a40025964d62c60a6c0a8474e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ax5r2rSzqyJDqLUfhUvFPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="555e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们做出了选择，我们就可以启动我们的实例了。除了VM之外，我们还想建立一个Google云存储桶来保存我们的数据科学实验的任何工件。谷歌云存储桶比我们连接到虚拟机的磁盘更便宜，因此是一种经济高效的方式来存储我们的代码、数据集、模型和其他与数据科学项目相关的工件，如果我们选择在使用后删除它们。</p><p id="7971" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以启动一个大型虚拟机实例，并设置我们的远程桌面来执行我们的研究和训练模型。一旦完成训练，我们就可以将实验代码、管道代码、最终模型、相关的训练数据集和requirements.txt保存到一个存储桶中。保存后，我们可以删除该实例，这样我们就不会再为虚拟机或相关磁盘产生费用。</p><p id="e8ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Google甚至允许我们将实例保存为映像，因此如果我们需要重新启动完全相同的虚拟机环境，因为我们可能下载了其他软件工具，如Tesseract for OCR，我们可以使用保存的映像创建一个新的实例。</p><p id="1de0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我跑题了。要设置云存储桶，我们需要做的就是选择左上角的“汉堡”菜单图标，向下滚动到存储。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/a88ea85681e2b185e279908bac9e024f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qMjCBtpOmEA1QvcqzRFW-A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3a9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择后，我们可以选择创建一个存储桶，并为该桶提供一个唯一的名称。我们可能希望打开的另一个配置是，为了安全起见，确保没有对bucket的公共访问，如下所示。除了这些选择，缺省值将满足我们在这里的使用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/d8d77620cb65cb9c75a2ad6e418f3974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFqcRV3S16Uovp017q1jwQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="c9ff" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤3:设置防火墙规则</h1><p id="2ef5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在开始使用我们的实例之前，我们还需要设置一些防火墙规则，允许虚拟机建立"<a class="ae ky" href="https://cloud.google.com/iap/docs/using-tcp-forwarding" rel="noopener ugc nofollow" target="_blank">一个加密隧道，通过该隧道，您可以将SSH、RDP和其他流量转发到虚拟机实例</a>"，并确保我们可以从本地笔记本电脑通过远程桌面连接到实例。要设置这些规则，请在搜索栏中键入“防火墙”点击“防火墙”服务。</p><p id="e085" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">防火墙窗口打开后，单击浏览器顶部的“创建防火墙规则”。我们将设置2个防火墙规则。第一个允许创建加密隧道，第二个允许从您的特定笔记本电脑访问。<a class="ae ky" href="https://cloud.google.com/iap/docs/using-tcp-forwarding" rel="noopener ugc nofollow" target="_blank">此链接</a>展示了如何创建防火墙规则以允许加密隧道。要设置允许您的个人笔记本电脑访问的规则，请先访问<a class="ae ky" href="https://whatismyipaddress.com/" rel="noopener ugc nofollow" target="_blank">此链接</a>并复制您的IPv4地址。</p><p id="13d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，将目标更改为“网络中的所有实例”，将您的特定IP地址粘贴到“源IPv4范围”框中，选中“tcp”复选框，并在TCP框中输入“20，3389，4000”。这些端口允许RDP、SSH和NoMachine(我们将使用的远程桌面应用程序)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/d02845a228502118777b9794388c6ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rGd5HR4X8n-tG_0MrnclJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2979" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然您的防火墙规则已经设置好了，我们就可以在虚拟机上完成远程桌面的设置了。</p><h1 id="c0c4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤4:通过SSH访问我们的虚拟机并安装远程桌面</h1><p id="4724" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们的项目已经设置了初始的云服务，下一步是回到我们刚刚设置的VM实例。单击左侧菜单栏中的“VM Instance”选项将弹出一个窗口，其中列出了我们为此项目启动的虚拟机。</p><p id="1001" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与AWS相比，Google的优点在于它提供了一个基于浏览器的SSH连接窗口，可以直接从实例启动命令shell。另一方面，如果您使用Windows，AWS需要使用第三方SSH客户端，如Putty，这也意味着您需要下载Putty用来与AWS云上任何正在运行的实例建立安全SSH连接的私钥。</p><p id="1de7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只要您登录到控制台环境，Google就会为您处理这些SSH密钥，为我们节省了一个敏感的安全步骤。</p><p id="90b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">单击新创建的实例旁边的SSH按钮后，一个SSH shell将在一个新窗口中打开。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/305a641f12fdbcd27c735c774ab8f20e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PTWbCQacwaAfD52ksL1pHw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4468" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们提交一系列命令，这些命令将执行以下操作:1 .更新我们的Linux应用程序repo，2。将用户添加到机器，以便从远程桌面连接(系统将提示您设置密码，其余信息是可选的)，3 .从NoMachine下载我们的Ubuntu操作系统的最新远程桌面应用程序，4。并在虚拟机上设置我们的访问规则，以允许基于密码访问机器。</p><p id="dcda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是要输入的命令。请注意，这一步需要一点时间来下载。完成后，返回控制台中的虚拟机窗口，停止然后启动实例，以说明对机器所做的所有更改。在这里，为您的虚拟机复制外部IP。</p><p id="7882" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本地机器的快速步骤。我们正在使用一个免费的远程桌面应用程序，名为NoMachine。要建立远程桌面连接，我们需要在笔记本电脑上安装NoMachine软件。你可以通过访问这个<a class="ae ky" href="https://www.nomachine.com/download" rel="noopener ugc nofollow" target="_blank">链接</a>来实现。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="68f2" class="ng lw it nc b gy nh ni l nj nk">sudo apt-get update</span><span id="ac8d" class="ng lw it nc b gy nl ni l nj nk">sudo apt-get upgrade -y</span><span id="498f" class="ng lw it nc b gy nl ni l nj nk">sudo adduser username</span><span id="6520" class="ng lw it nc b gy nl ni l nj nk">sudo apt-get install ubuntu-desktop</span><span id="f18b" class="ng lw it nc b gy nl ni l nj nk">wget <a class="ae ky" href="https://www.nomachine.com/free/linux/64/deb" rel="noopener ugc nofollow" target="_blank">https://www.nomachine.com/free/linux/64/deb</a> -O nomachine.deb</span><span id="5c45" class="ng lw it nc b gy nl ni l nj nk">sudo dpkg -i ./nomachine.deb</span></pre><p id="cbd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是如何使用VIM在shell中设置访问规则。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="513a" class="ng lw it nc b gy nh ni l nj nk">sudo vim /etc/ssh/sshd_config</span></pre><p id="92f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦VIM打开配置文件，输入以下内容:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="d20d" class="ng lw it nc b gy nh ni l nj nk">- press i and then enter<br/>- change “PasswordAuthentication” line from no to yes<br/>- press esc then :wq</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/7a6b686a8e6fb49d7f25694335e620b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Un1jsTJ7Q65B8cEg-wSk7g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="cfe8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤5:访问远程桌面并安装Miniconda</h1><p id="0fa2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦您在本地笔记本电脑上下载了NoMachine，打开应用程序并单击“添加”来添加您的新连接。您将需要虚拟机的外部IP地址，以便将应用程序指向正确的访问位置。注意，每次你关闭你的虚拟机和重启外部IP都会改变。你可以向谷歌申请创建一个“静态IP ”,或者在重新连接时确保重新复制和粘贴。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/769d8eca1a41a7bfde8bcf63143df654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SxPMXDwvsXM3YuN0ReSxPw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1588" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，请确保在连接前选择“配置”并选择“使用密码验证”选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/7aca65e075913a376842f8e3999834ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzvmUiBzXUysKMfTQNniSQ.png"/></div></div></figure><p id="7422" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是我们期待已久的时刻。点击“连接”并输入您的用户名和密码。一旦你完成了NoMachine和Ubuntu的设置问题，你应该会看到你新创建的桌面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/d54f1d4b2dca6a0edd1092176b7f7001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jb5d8x4kGhAJrFuC14WL5A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3133" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这里开始，我们将像对待任何桌面环境一样对待我们的桌面。Ubuntu桌面包括一个终端，我们可以启动它来运行命令行提示。要找到它，点击“显示应用程序”按钮，然后在搜索框中输入“终端”打开终端应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/c115ddb84c3a8dacec9ebe979f0875a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zwKJit7KIMxJpMOIxDa7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cbff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开后，我们将使用以下命令将Miniconda安装程序下载到新创建的目录(/miniconda3)中:</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="5b98" class="ng lw it nc b gy nh ni l nj nk">mkdir -p ~/miniconda3<br/>wget <a class="ae ky" href="https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh" rel="noopener ugc nofollow" target="_blank">https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh</a> -O ~/miniconda3/miniconda.sh<br/>bash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3<br/>rm -rf ~/miniconda3/miniconda.sh<br/>~/miniconda3/bin/conda init bash</span></pre><p id="6548" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码取自<a class="ae ky" href="https://waylonwalker.com/install-miniconda/" rel="noopener ugc nofollow" target="_blank">这里的</a>，如果需要关于代码做什么的额外解释。</p><h1 id="3cb7" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">步骤6:数据科学环境</h1><p id="0006" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">完成上述命令后，Miniconda会要求您关闭然后重新打开终端。执行此操作后，您将看到一个“(base)”描述符出现在命令行上终端屏幕的左侧。这告诉您现在正在使用Anaconda环境，您可以自由地使用常见的命令，比如包安装(conda或pip)。要停用conda环境，只需输入“conda停用”或“conda激活”即可重新激活。</p><p id="ba17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们安装一个IDE (Spyder)和一个特定的包来用Python访问我们的Google云存储桶。</p><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="144b" class="ng lw it nc b gy nh ni l nj nk">conda install spyder<br/>pip install gcsfs<br/>pip install pandas</span></pre><p id="88b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装完软件包后，在终端中键入“spyder”来启动Spyder IDE。在下图中，我添加了一些代码来创建一个dataframe，将它作为一个. csv文件保存到我们的存储桶中，然后删除它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/8df0e18b1f8784f812eeec49930edf7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5Rbpc7nk1f9XnQmfdW7tQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt nb nc nd ne aw nf bi"><span id="984b" class="ng lw it nc b gy nh ni l nj nk">import gcsfs<br/>import pandas as pd</span><span id="1259" class="ng lw it nc b gy nl ni l nj nk">df = pd.DataFrame({'Name':['Eddie','Jeff','Stone','Matt','Mike'], 'Inst':['Vocal','Bass','Guitar','Drums','Guitar']})</span><span id="2d4c" class="ng lw it nc b gy nl ni l nj nk">fs = gcsfs.GCSFileSystem(project='your-project-name')<br/>fs.ls('your-bucket')</span><span id="7633" class="ng lw it nc b gy nl ni l nj nk">with fs.open('your-bucket/test.csv','r') as f:<br/> df.to_csv(f)</span><span id="0748" class="ng lw it nc b gy nl ni l nj nk">fs.rm('your-bucket/test.csv')</span></pre><p id="78ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅此而已。现在，您已经使用云服务成功设置了自己的虚拟数据科学环境。</p><p id="ff88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于上面的设置，最后一个警告。我们的引导磁盘只有100 GBs，对于像Pandas这样的大型Python数据科学库来说，这实在是小得可怜。实际上，您更可能希望使用更大的引导磁盘(500 GB或更大)来支持您的实验。只要你记得在完成后停止并删除你的实例，你就能有效地控制成本。</p><h1 id="1c0c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="85df" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">同样，这种方法的核心优势是用户控制，因此这是一种利用云服务处理超过笔记本电脑需求的大型数据科学工作负载的好方法，其成本只是外出购买新笔记本电脑的一小部分。</p><p id="b57b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，初创公司可以避免与更多托管解决方案相关的成本不确定性，还可以利用按需提供自己的虚拟机实例的灵活性。</p><p id="157e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">比如参与学习数据科学、职业发展或糟糕的商业决策？<a class="ae ky" href="https://www.facebook.com/groups/thinkdatascience" rel="noopener ugc nofollow" target="_blank">加入我</a>。</p><h1 id="8317" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="e538" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">GCP设置</p><p id="6bb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.创建虚拟机实例<br/> -更改实例类型<br/> -更改引导磁盘<br/> -更改对API的访问<br/> -创建后复制外部IP</p><p id="4622" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.转到防火墙<br/> -添加allow-ingress-from-iap <br/>名称:allow-ingress-from-iap <br/>流量方向:Ingress <br/>目标:网络中的所有实例<br/>源过滤器:IP范围<br/>源IP范围:35.235.240.0/20 <br/>协议和端口:选择TCP并输入22，3389，4000以允许RDP和SSH以及nomachine。</p><p id="0765" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">-添加笔记本电脑到虚拟机<br/>流量方向:入口<br/>目标:网络中的所有实例<br/>源过滤器:IP范围<br/>源IP范围:您的IPv4 <br/>协议和端口:选择TCP并输入22，3389，4000以允许RDP、SSH和nomachine。</p><p id="d101" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.为桌面设置虚拟机<br/> - SSH到虚拟机</p><p id="3a8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sudo apt-get更新<br/> sudo apt-get升级-y</p><p id="1628" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sudo adduser用户名</p><p id="cb11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装ubuntu桌面</p><p id="f7c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">https://www.nomachine.com/free/linux/64/deb-O nomachine . deb</p><p id="5857" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sudo dpkg -i ./nomachine.deb</p><p id="c0d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">-在虚拟机上配置系统SSHD，以启用基于密码的身份验证。</p><p id="4db6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编辑/etc/ssh/sshd_config，将“PasswordAuthentication”行从“No”更改为“Yes”。</p><p id="6f81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sudo vim/etc/ssh/sshd _ config<br/>-按I然后回车<br/> -从否变为是<br/> -按esc然后:wq</p><p id="d859" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保存更改。</p><p id="0406" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">返回GCP仪表板，停止并启动您的虚拟机。</p><p id="ab1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">等到它重新启动</p><p id="3031" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.在本地打开no machine<br/>-添加<br/> -配置使用pw认证<br/> -连接</p><p id="0f1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.安装</p><p id="a96a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">-miniconda<br/>mkdir-p ~/miniconda 3<br/>wget<a class="ae ky" href="https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh" rel="noopener ugc nofollow" target="_blank">https://repo . anaconda . com/miniconda/miniconda 3-latest-Linux-x86 _ 64 . sh</a>-O ~/miniconda 3/miniconda . sh<br/>bash ~/miniconda 3/miniconda . sh-b-u-p ~/miniconda 3<br/>RM-RF ~/miniconda 3/miniconda . sh<br/>~/miniconda 3/bin/</p><ul class=""><li id="8fcd" class="ns nt it lb b lc ld lf lg li nu lm nv lq nw lu nx ny nz oa bi translated">anaconda<br/>CD/tmp<br/>curl-O<a class="ae ky" href="https://repo.anaconda.com/archive/Anaconda3-2021.05-Linux-x86_64.sh" rel="noopener ugc nofollow" target="_blank">https://repo . anaconda . com/archive/anaconda 3-2021.05-Linux-x86 _ 64 . sh</a></li><li id="978d" class="ns nt it lb b lc ob lf oc li od lm oe lq of lu nx ny nz oa bi translated">bash anaconda 3–2021.05-Linux-x86 _ 64 . sh</li></ul><p id="67b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.设置Google云存储</p><p id="b4fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">-简单地设置一个桶并阻止公共访问</p><p id="e462" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7.根据需要返回桌面<br/>安装库</p></div></div>    
</body>
</html>