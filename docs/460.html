<html>
<head>
<title>What’s in a List Comprehension?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是列表理解？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/whats-in-a-list-comprehension-c5d36b62f5#2022-01-16">https://towardsdatascience.com/whats-in-a-list-comprehension-c5d36b62f5#2022-01-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="ce68" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">什么是列表理解？</h1></div><div class=""><h2 id="ae05" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">概述Python对循环的替代以及为什么应该使用它们。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6306467d91b773ef7d0dee72401526a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KE5fia-jA0WMxuA3"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托尔比约恩·赫尔格森在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a6c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">更新:一定要看看本文</em>  <em class="lv">第二部分</em> <a class="ae ky" href="https://levelup.gitconnected.com/whats-in-a-list-comprehension-part-2-49d34bada3f5" rel="noopener ugc nofollow" target="_blank">！</a></p><p id="10b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我的系列文章中的第二篇，讨论Python中的独特特性以及使用它们的好处。请务必在此查看第一部分:<a class="ae ky" rel="noopener" target="_blank" href="/whats-in-a-lambda-c8cdc67ff107">Lambda中有什么？</a></p><p id="f33b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python作为一种编程语言之所以受欢迎，很大程度上是因为它能够以简单紧凑的方式完成复杂的任务。大多数语言中存在的常见编程思想通常在Python中有独特的实现，这有助于编写干净、可读的代码。列表理解是我最喜欢的Python特有的特性之一，因为它们提供了传统for循环的单行替代方案。</p><h2 id="84c3" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">列表理解到底是什么？</strong></h2><p id="843b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">列表理解是Python中的一种语法形式，允许程序员在一行中循环并转换一个iterable。术语<em class="lv">列表理解</em>来源于两个特征:1)用于编写这种理解的类似列表的语法，以及2)列表理解的输出总是Python列表的形式。</p><p id="0c3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理解列表理解的最简单方法是将它们与传统的for循环进行对比。让我们来看看下面这个具体的例子，在这个例子中，我们要对列表中的每个数字求平方:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="aadb" class="lw lx it mv b gy mz na l nb nc">lst = [1, 2, 3, 4, 5]<br/>squared_lst = []<br/>for number in lst:<br/>    squared_lst.append(number * number)</span></pre><p id="7fc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和...相对</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="1a0c" class="lw lx it mv b gy mz na l nb nc">lst = [1, 2, 3, 4, 5]<br/>squared_lst = [number * number for number in lst]</span></pre><p id="ab40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于上面的两个代码片段，需要注意一些要点:</p><ul class=""><li id="735e" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">与for循环不同，list comprehensions自动将其输出放入一个列表中。在第一个代码片段中，我们必须显式地创建一个新的列表，然后在for循环中向其追加内容。相比之下，在第二个代码片段中，我们简单地将list comprehension的输出赋值给我们的新变量。</li><li id="ac89" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">一开始阅读列表理解可能会令人困惑，因为如果你习惯于for循环，顺序就会颠倒。但是，它使用相同的基本概念。在这个列表理解中，语句<code class="fe nr ns nt mv b">for number in lst</code>可以被认为对应于传统的for循环。它遍历列表中的每个元素，每次都将临时变量<code class="fe nr ns nt mv b">number</code>绑定到元素。在列表理解的第一部分，<code class="fe nr ns nt mv b">number * number</code>告诉Python，在将元素添加到我们的新列表之前，我们要对它求平方。</li><li id="82bd" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">与for循环一样，原始列表<code class="fe nr ns nt mv b">lst</code>保持不变。list comprehension将转换后的元素放入一个新的列表中，然后该列表被赋值给我们的变量<code class="fe nr ns nt mv b">squared_lst</code>。</li></ul><h2 id="042e" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">列表理解还能做什么？</h2><p id="1e01" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">上面的例子很酷，但是如果列表理解不能做任何更复杂的事情，那就太可悲了。这里我想强调两个特别的特性:1)过滤列表的能力和2)模拟嵌套for循环的能力。</p><p id="3672" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于Python程序员来说，根据某种条件从列表中删除元素是一个相当常见的用例。例如，假设您希望过滤一个数字列表，只保留那些小于100的数字。您可以这样做:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="4006" class="lw lx it mv b gy mz na l nb nc">&gt;&gt;&gt; lst = [1, 324, 44, 500, 7]<br/>&gt;&gt;&gt; [number for number in lst if number &lt; 100]<br/>[1, 44, 7]</span></pre><p id="5185" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更好的是，您甚至可以对剩余的数字进行运算！列表理解允许您在一条语句中过滤和转换所有内容:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="e2cb" class="lw lx it mv b gy mz na l nb nc">&gt;&gt;&gt; lst = [1, 324, 44, 500, 7]<br/>&gt;&gt;&gt; [number * number for number in lst if number &lt; 100]<br/>[1, 1936, 49]</span></pre><p id="1ff4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个重要的注意事项:如果您使用上面的语法在单个列表理解中过滤和转换，请记住Python <strong class="lb iu">首先过滤，然后转换</strong>。</p><p id="1c00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python程序员的第二个常见用例是将一个for循环嵌套在另一个循环中。这里有一个这样的例子:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="b110" class="lw lx it mv b gy mz na l nb nc">&gt;&gt;&gt; nested_lst = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]<br/>&gt;&gt;&gt; for inner_lst in nested_lst:<br/>        for number in inner_lst:<br/>            print(number)<br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9</span></pre><p id="c420" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过列表理解，您可以将整个嵌套的for循环缩减为一行:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="a04e" class="lw lx it mv b gy mz na l nb nc">&gt;&gt;&gt; nested_lst = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]<br/>&gt;&gt;&gt; <strong class="mv iu">[print(number) for inner_lst in nested_lst for number in inner_lst]</strong><br/>1<br/>2<br/>3<br/>4<br/>5<br/>6<br/>7<br/>8<br/>9<br/>[None, None, None, None, None, None, None, None, None]</span></pre><p id="c54f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我知道，这看起来有点混乱。一开始我也很困惑。但是如果你仔细阅读这一行，它遵循与嵌套的for循环相同的逻辑:首先，我们编写<code class="fe nr ns nt mv b">for inner_lst in nested_lst</code>来访问外部列表中的每个单独的列表，然后我们编写<code class="fe nr ns nt mv b">for number in inner_lst</code>来访问各自内部列表中的每个数字。和嵌套的for循环完全一样；我们只是删除了冒号和换行符。</p><p id="02ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个小提示:出现9次<code class="fe nr ns nt mv b">None</code>的列表只是列表理解的输出(因为Python中的<code class="fe nr ns nt mv b">print</code>函数返回<code class="fe nr ns nt mv b">None</code>)。</p><h2 id="42f3" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">为什么列表理解有用？</h2><p id="1907" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">好吧，所以列表理解很酷，但是拥有它们有什么意义吗？我们不能一直使用for循环吗？</p><p id="021a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从技术上讲，是的——但这并不意味着列表理解毫无用处。正如我在上一篇关于lambdas的文章中提到的，Pythonic编程的原则之一是编写简单、简洁、可读的代码。列表理解是产生这种高质量代码的极好方法。</p><p id="e605" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是使用列表理解的几种情况:</p><ul class=""><li id="7217" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu">使用</strong><a class="ae ky" href="https://en.wikipedia.org/wiki/MapReduce" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">MapReduce</strong></a><strong class="lb iu">模型</strong>快速处理数据。假设您正在处理一些数据，并且希望在编写利用专业MapReduce框架的密集型代码之前快速获得一些见解。列表理解提供了一种简单的方法来模拟这个模型，以便运行小型测试。您可以快速过滤您的数据，并在理解的范围内映射一些转换函数，然后您可以将Python的<code class="fe nr ns nt mv b">reduce</code>函数应用于结果列表。</li><li id="f33e" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu">在Jupyter中模拟随机实验</strong>。如果你是一名数据科学家(或者正在接受培训成为一名数据科学家)，你可能已经使用<code class="fe nr ns nt mv b">sample</code>和<code class="fe nr ns nt mv b">random</code>以及Jupyter笔记本中的所有好东西运行了一些测试。一般来说，在评估某个假设时，使用for循环是为了模拟实验的数千次运行。下一次，你可以使用列表理解，让你的代码简单一点。</li></ul><p id="aca9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这只是两个例子。总的来说，我建议明智地使用列表理解，以使你的代码更简洁，可读性更好。如果你是一名Python程序员，这是你应该非常熟悉的思维方式——如果你是这门语言的新手，这是你应该学好的思维方式。</p><p id="f0ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下次见，伙计们！</p></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="8960" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">想擅长Python？</strong> <a class="ae ky" href="https://witty-speaker-6901.ck.page/0977670a91" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">获取独家、免费获取我简单易懂的指南点击</strong> </a> <strong class="lb iu">。想在介质上无限阅读故事？用我下面的推荐链接注册！</strong></p><div class="ob oc gp gr od oe"><a href="https://murtaza5152-ali.medium.com/?source=entity_driven_subscription-607fa603b7ce---------------------------------------" rel="noopener follow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">穆尔塔扎阿里培养基</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">阅读媒介上穆尔塔扎·阿里的作品。华盛顿大学的博士生。对人机感兴趣…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">murtaza5152-ali.medium.com</p></div></div><div class="on l"><div class="oo l op oq or on os ks oe"/></div></div></a></div><p id="9c73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">我叫穆尔塔扎·阿里，是华盛顿大学的一名博士生，研究人机交互。我喜欢写关于教育、编程、生活以及偶尔的随想。</em></p></div></div>    
</body>
</html>