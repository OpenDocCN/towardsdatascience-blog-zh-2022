<html>
<head>
<title>Understanding Google Cloud IAM concepts with stick figures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用简笔画理解谷歌云IAM概念</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/google-cloud-iam-with-stick-figures-cd5ce19c142b#2022-01-10">https://towardsdatascience.com/google-cloud-iam-with-stick-figures-cd5ce19c142b#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="3d79" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">用简笔画理解谷歌云IAM概念</h1></div><div class=""><h2 id="018d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用涂鸦描述谷歌云平台上的IAM概念</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/863b9ce4ad32f2c4f7fac7e7a40d0e0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZnIpTcP3L5uv9D-B4saWug.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">IAM概念插图-作者图片</p></figure><p id="5b81" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用类比和例子解释新概念会很有帮助。在本文中，我将尝试使用涂鸦来解释GCP的IAM(身份和访问管理)概念。GCP的IAM并不特别难，尽管这样做很有趣，我希望我不那么复杂的涂鸦能帮助你多理解一点IAM的概念。</p><p id="2ff1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们开始之前，这里有一个我们将涉及的每个关键概念的地图，以便您可以跟随类比。</p><ul class=""><li id="d205" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><strong class="la iu">人物</strong>:在GCP，这相当于一个<code class="fe md me mf mg b">principal</code>或者<code class="fe md me mf mg b">identity</code>。这可能是一个实际的用户帐户(alex@example.com)、一个服务帐户或其他<a class="ae mh" href="https://cloud.google.com/iam/docs/overview#concepts_related_identity" rel="noopener ugc nofollow" target="_blank">实体</a>。我将交替使用“主体”和“身份”。</li><li id="f0ba" class="lu lv it la b lb mi le mj lh mk ll ml lp mm lt lz ma mb mc bi translated"><strong class="la iu">键</strong>:相当于GCP的一个<code class="fe md me mf mg b">role</code>。例如，alex@example.com可以有一个云存储桶管理员角色。</li><li id="84ce" class="lu lv it la b lb mi le mj lh mk ll ml lp mm lt lz ma mb mc bi translated"><strong class="la iu">房子</strong>:相当于GCP的一个<code class="fe md me mf mg b">resource</code>。这可能是一个计算引擎实例或BigQuery。</li></ul><p id="fdd5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用上面的图像作为指导，让我们想象简笔画用户(可能是任何GCP <code class="fe md me mf mg b">identity</code>)试图进入一所房子(可能是任何<code class="fe md me mf mg b">resource</code>，像GCP的计算引擎实例)。需要进行一些验证，以确保我们的用户拥有正确的<strong class="la iu"> <em class="mn">权限</em> </strong>来访问特定的属性。用户需要被授予正确的权限才能继续。</p><blockquote class="mo"><p id="ff46" class="mp mq it bd mr ms mt mu mv mw mx lt dk translated">在IAM中，访问资源的权限不是直接授予终端用户的。相反，权限被分组到<em class="my">角色</em>中，角色被授予经过身份验证的<em class="my">主体。</em></p></blockquote><h2 id="a3a2" class="mz na it bd nb nc nd dn ne nf ng dp nh lh ni nj nk ll nl nm nn lp no np nq nr bi translated">那么什么是角色呢？</h2><blockquote class="ns nt nu"><p id="12fb" class="ky kz mn la b lb lc ju ld le lf jx lg nv li lj lk nw lm ln lo nx lq lr ls lt im bi translated">一个<em class="it">角色</em>是权限的集合。权限决定了允许对资源进行哪些操作。当您将一个<code class="fe md me mf mg b">role</code>授予一个<code class="fe md me mf mg b">principal</code>时，您就授予了该角色包含的所有权限。</p></blockquote><h2 id="d974" class="mz na it bd nb nc ny dn ne nf nz dp nh lh oa nj nk ll ob nm nn lp oc np nq nr bi translated">什么是权限？</h2><blockquote class="ns nt nu"><p id="0bad" class="ky kz mn la b lb lc ju ld le lf jx lg nv li lj lk nw lm ln lo nx lq lr ls lt im bi translated">权限决定了允许对资源进行哪些操作。例如，“调用”云功能是可以在云功能上执行的操作。在IAM世界中，权限以<code class="fe md me mf mg b">service.resource.verb</code>的形式表示，例如<code class="fe md me mf mg b">pubsub.subscriptions.consume</code>。</p></blockquote><p id="35cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">继续上图中的例子，<em class="mn"> </em>图中的<em class="mn">键</em>将代表一个<em class="mn"> </em> <code class="fe md me mf mg b"><em class="mn">role</em></code>，它可能被分配了以下虚拟权限:<code class="fe md me mf mg b">living.house.openFrontDoor</code>、<code class="fe md me mf mg b">living.house.openKitchenDoor</code>和<code class="fe md me mf mg b">living.house.openBasement</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/10893e5dbd5a1ef5cb217437ecd315ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z9rvtkuCR54iFWgWugfhxA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对密钥(即角色)的允许权限—按作者排列的图像</p></figure><p id="41bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在GCP，角色和权限的映射在概念上是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/1a1206c7315a6c944c4ce91cb3bb2224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oxmjlmjE8mokgov9hRpVEg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源— <a class="ae mh" href="https://cloud.google.com/iam/docs/overview#roles" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a></p></figure><p id="7309" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">既然我们已经为密钥分配了权限，流程的下一步就是将密钥分配给简笔画用户。我们还需要让房屋主人知道用户在物业中被允许做什么。要做到这一点，我们需要某种策略来概述授权用户并明确定义他们可以做什么。</p><p id="b15e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了在GCP实现这一点，每个资源被分配一个叫做<strong class="la iu"> <em class="mn"> IAM策略</em> </strong>的东西。</p><h2 id="d612" class="mz na it bd nb nc ny dn ne nf nz dp nh lh oa nj nk ll ob nm nn lp oc np nq nr bi translated">IAM策略</h2><blockquote class="ns nt nu"><p id="074f" class="ky kz mn la b lb lc ju ld le lf jx lg nv li lj lk nw lm ln lo nx lq lr ls lt im bi translated">一个<em class="it"> IAM策略</em>定义并强制执行哪些角色被授予哪些身份。此策略附加到资源。如果我们有20个计算引擎实例，它们每个都有一个IAM策略。重要的是，如果您将策略分配给GCP项目，用户将获得整个项目的指定角色。</p></blockquote><p id="5a1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以实际上，IAM策略只是绑定的集合。绑定是将身份与角色联系起来的东西。以下是GCP实际的IAM政策。</p><pre class="kj kk kl km gt of mg og oh aw oi bi"><span id="8fa8" class="mz na it mg b gy oj ok l ol om">{<br/>  "bindings": [<br/>    {<br/>      "members": [<br/>        "user:alex@example.com"<br/>      ],<br/>      "role": "roles/pubsub.subscriptions.consume"<br/>    }<br/>  ],<br/>  "etag": "BwUjMhCsNvY=",<br/>  "version": 1<br/>}</span></pre><p id="c612" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">IAM策略可以是JSON或YAML格式。你可以在这里阅读更多关于IAM政策的信息。</p><p id="db50" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，想象我们有一个叫做“IAM”的房子主人，在插图中的房产前站岗。当我们经过身份验证的用户试图访问这个房产(又名<code class="fe md me mf mg b">resource</code>)时，IAM会检查房子的策略，以确定用户试图执行的操作是否被允许。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/3c6f5f0556d80c9016f67afdc9cf887b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PeEqZmeX_1jCS5n4igiHhg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">IAM政策说明—作者图片</p></figure><p id="feaa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果根据预定义的策略允许该动作，则用户将被允许在房子上执行该动作(也称为<code class="fe md me mf mg b">resource</code>)。</p><h2 id="0a9e" class="mz na it bd nb nc ny dn ne nf nz dp nh lh oa nj nk ll ob nm nn lp oc np nq nr bi translated">结论</h2><p id="5e37" class="pw-post-body-paragraph ky kz it la b lb oo ju ld le op jx lg lh oq lj lk ll or ln lo lp os lr ls lt im bi translated">我们已经看了Google Cloud中IAM的几个关键概念，我希望这些插图有助于更好地理解。IAM允许您授予对特定Google云资源的细粒度访问权限，并帮助阻止对其他资源的访问。IAM允许您采用最小特权的安全原则，即任何人都不应该拥有超过他们实际需要的权限。</p><p id="3db0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">继续在您的环境中尝试这些！</p></div><div class="ab cl ot ou hx ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="im in io ip iq"><blockquote class="mo"><p id="69be" class="mp mq it bd mr ms mt mu mv mw mx lt dk translated">你可以<a class="ae mh" href="https://medium.com/@tobisam/membership" rel="noopener">成为</a>的中等会员，享受更多这样的故事。</p></blockquote><h1 id="b0d3" class="pa na it bd nb pb pc pd ne pe pf pg nh jz ph ka nk kc pi kd nn kf pj kg nq pk bi translated">参考</h1><ul class=""><li id="e6ae" class="lu lv it la b lb oo le op lh pl ll pm lp pn lt lz ma mb mc bi translated">IAM <a class="ae mh" href="https://cloud.google.com/iam/docs/policies" rel="noopener ugc nofollow" target="_blank">政策</a></li><li id="a63b" class="lu lv it la b lb mi le mj lh mk ll ml lp mm lt lz ma mb mc bi translated"><a class="ae mh" href="https://cloud.google.com/iam/docs/overview" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/iam/docs/overview</a></li></ul></div></div>    
</body>
</html>