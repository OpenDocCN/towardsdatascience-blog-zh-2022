<html>
<head>
<title>Blazing-Fast Algebra and Random Numbers in Python with mtalg</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用mtalg在Python中实现极快的代数和随机数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/blazing-fast-algebra-and-random-numbers-in-python-with-mtalg-aa50ac8ffd3#2022-01-09">https://towardsdatascience.com/blazing-fast-algebra-and-random-numbers-in-python-with-mtalg-aa50ac8ffd3#2022-01-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="ba1c" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">使用mtalg在Python中实现极快的代数和随机数</h1></div><div class=""><h2 id="fcdb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用于多线程代数和伪随机数生成的python工具</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/09d553f4a897a606b0fc6969811eaf02.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*L-A8lkYuG4RFp-BI8mCs9g.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">来自<a class="ae kr" href="https://github.com/WWakker/mtalg" rel="noopener ugc nofollow" target="_blank"> mtalg </a>的图像</p></figure><p id="01a1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">数据科学家和研究人员经常需要执行快速有效的数值计算。因此，处理大型数据结构需要能够通过多重处理或多线程来利用所有可用的计算资源(参见这篇<a class="ae kr" href="https://medium.com/@bfortuner/python-multithreading-vs-multiprocessing-73072ce5600b" rel="noopener">伟大的文章</a>来复习)。这非常重要，以至于像<code class="fe lo lp lq lr b">numpy</code>这样的数值库自动支持线性代数运算上的多线程。</p><p id="572a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然而，有点令人惊讶的是，<code class="fe lo lp lq lr b">numpy</code>没有为元素操作和(伪)随机数生成提供现成的多线程功能。这些通常是主要的瓶颈，例如当执行大规模蒙特卡罗模拟时，用于通过MCMC的贝叶斯参数估计等。</p><p id="e18c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">Python库<code class="fe lo lp lq lr b"><a class="ae kr" href="https://github.com/WWakker/mtalg" rel="noopener ugc nofollow" target="_blank">mtalg</a></code> [1]提供了多线程的基于元素的函数和多线程的随机数生成，击败了大多数其他库，包括<code class="fe lo lp lq lr b">numexpr</code>和使用<code class="fe lo lp lq lr b">numba</code>的即时编译(参见下面的基准)。</p><h1 id="7414" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">多线程代数</h1><p id="c413" class="pw-post-body-paragraph ks kt iq ku b kv mk jr kx ky ml ju la lb mm ld le lf mn lh li lj mo ll lm ln ij bi translated">安装了带有<code class="fe lo lp lq lr b">pip install mtalg</code>的库后，我们可以导入<code class="fe lo lp lq lr b">mtalg</code>并使用它的内置函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="81d6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">请注意，默认情况下，操作在第一个参数中就地执行。因此，<code class="fe lo lp lq lr b">mtalg.add(a,b)</code>相当于<code class="fe lo lp lq lr b">a = a + b</code>(只是方式更快！).这种行为可以通过可选参数<code class="fe lo lp lq lr b">direction</code>来覆盖:例如<code class="fe lo lp lq lr b">mtalg.sub(a, b, direction='right')</code>将等同于<code class="fe lo lp lq lr b">b = a - b</code>(注意这与<code class="fe lo lp lq lr b">mtalg.sub(b, a)</code>不同，后者将等同于<code class="fe lo lp lq lr b">b = b — a</code>)。</p><p id="234a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">默认情况下,<code class="fe lo lp lq lr b">mtalg</code>将线程数量设置为可用CPU内核的数量，但是该参数可以作为<code class="fe lo lp lq lr b">mtalg.set_num_threads(6)</code>被覆盖。同样，我们可以将当前设定值检查为<code class="fe lo lp lq lr b">mtalg.get_num_threads()</code>。</p><h1 id="361e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">随机数生成</h1><p id="c59c" class="pw-post-body-paragraph ks kt iq ku b kv mk jr kx ky ml ju la lb mm ld le lf mn lh li lj mo ll lm ln ij bi translated">随机数生成可以按如下方式执行:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="2675" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><code class="fe lo lp lq lr b">mtalg.random</code>提供了一系列不同的发行版来进行采样，所有发行版都保持了类似numpy的语法。</p><p id="7f67" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><code class="fe lo lp lq lr b">mtalg</code>目前支持从以下分布中采样:<em class="mr">、二项式、卡方、指数、f、伽马、几何、gumbel、超几何、整数、拉普拉斯、逻辑、对数正态、对数序列、负二项式、非中心卡方、非中心f、正态、帕累托、泊松、幂、随机、瑞利、标准柯西、标准指数、标准伽马、标准正态、标准t、三角形、均匀、冯米斯、瓦尔德、威布尔、zipf </em>。</p><h1 id="6bc8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">基准</h1><p id="c718" class="pw-post-body-paragraph ks kt iq ku b kv mk jr kx ky ml ju la lb mm ld le lf mn lh li lj mo ll lm ln ij bi translated">针对numpy和一些最快的可用库的基准测试证明了<code class="fe lo lp lq lr b">mtalg</code>的速度。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/3356051a0ae94d42e9e38c0bb7661665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-_bBEnwWz4LrzbwDWIMmw.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><strong class="bd mx">图1 </strong> — Elementwise代数:十亿次运算的加法函数基准[2]。其他基本功能的执行方式类似。【来源:作者图片】</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/2804f6452cd7b80c5a613748bfc775b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULFJ5NQtIvlfRloGcI3zdw.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><strong class="bd mx">图2 </strong> —元素代数:加法函数的基准[2]。其他基本功能的执行方式类似。【来源:作者图片】</p></figure><p id="3115" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">通常，多线程会带来开销，因此多线程的好处只有在处理大量操作时才会显现出来(按照10⁷ / 10⁸或更大的数量级——图2)。</p><p id="c448" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">还可以观察到随机数生成的速度大幅提高，这是执行大规模蒙特卡罗模拟或通过MCMC进行贝叶斯参数估计时的一项关键任务。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/c0bbb34b7e67ae66ff1214d0019fa987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W5X9UcMzBfPDORAuhueAQg.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><strong class="bd mx">图3 </strong> —随机数生成:均匀和标准正态分布随机变量的基准[2](十亿)。从其他分布中取样的表现类似。【来源:作者图片】</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/ffe491c082c5540bc15d387e30201848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vn0Fh5jdrPvXBNPuIby79A.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><strong class="bd mx">图4 </strong> —随机数生成:均匀和标准正态分布随机变量的基准[2]。从其他分布中取样的表现类似。【来源:作者图片】</p></figure><h1 id="6bfb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="55e8" class="pw-post-body-paragraph ks kt iq ku b kv mk jr kx ky ml ju la lb mm ld le lf mn lh li lj mo ll lm ln ij bi translated">在本文中，我们介绍了<code class="fe lo lp lq lr b">mtalg</code>，这是一个直观的Python库，用于快速的元素操作和随机数生成。</p><p id="70ec" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">欢迎在下面的专门部分留下评论、编辑建议或提问！</p><p id="f604" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">另外，如果你想为图书馆做贡献，请随时联系我们！</p><h1 id="3ca7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><p id="a398" class="pw-post-body-paragraph ks kt iq ku b kv mk jr kx ky ml ju la lb mm ld le lf mn lh li lj mo ll lm ln ij bi translated">GitHub上的[1]<a class="ae kr" href="https://github.com/WWakker/mtalg" rel="noopener ugc nofollow" target="_blank"><em class="mr">mtalg</em></a><br/>【2】性能指标评测是使用英特尔至强黄金6142M CPU @ 2.60GHz和24个线程进行的<br/>【3】<em class="mr">免责声明:作者是此处提供的库的维护者和合著者。</em></p></div></div>    
</body>
</html>