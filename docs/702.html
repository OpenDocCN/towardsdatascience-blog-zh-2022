<html>
<head>
<title>Implement Your Topic Modeling Using The BERTopic Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用BERTopic库实现您的主题建模</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implement-your-topic-modeling-using-the-bertopic-library-d6708baa78fe#2022-01-25">https://towardsdatascience.com/implement-your-topic-modeling-using-the-bertopic-library-d6708baa78fe#2022-01-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="1f3b" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">使用BERTopic库实现您的主题建模</h1></div><div class=""><h2 id="bf3d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python中使用BERT的主题建模</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/78932605ad17b9d94f0d2bae8549d620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QNUUztfz1AwyPLzL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马丁·范·登·霍维尔在<a class="ae ky" href="https://unsplash.com/s/photos/documents?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="c6ac" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="0b62" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">文本可以包含大量信息，无论是隐式的还是显式的。像其他数据一样，这些文本可能包含隐藏信息。</p><p id="b68e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些信息是我们肉眼看不到的。我们需要数据科学来帮助我们解决这个问题。在本文中，我将向您展示如何使用BERTopic库实现主题建模。没有进一步，让我们开始吧！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="5c18" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">该机制</h1><p id="a4d2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们深入建模过程之前，让我向您展示库背后的机制。总之，该算法将做三个步骤。这些嵌入在文本中，对它们进行聚类，最后是主题建模。步骤如下所示:</p><ul class=""><li id="e58f" class="ne nf it lt b lu mn lx mo ma ng me nh mi ni mm nj nk nl nm bi translated">首先，BERT模型为每个文档生成一个表示向量。</li><li id="15fa" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">然后，UMAP算法降低了每个向量的维数。</li><li id="4ffa" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">接下来，HDBSCAN算法用于聚类过程。因此，每个组都包含具有相似含义的文本。</li><li id="e5b9" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">之后，c-TF-IDF算法检索每个主题最相关的单词。</li><li id="479a" class="ne nf it lt b lu nn lx no ma np me nq mi nr mm nj nk nl nm bi translated">最后，为了最大化多样性，使用最大化候选相关性算法。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/e163ae3044363ac011e99435341df2ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*egcJ2MvdPtmQpEeK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://maartengr.github.io/BERTopic/algorithm/algorithm.html" rel="noopener ugc nofollow" target="_blank">BERTopic文档</a>。</p></figure></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="29e7" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">履行</h1><h2 id="78f3" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">获取并加载数据</h2><p id="a4ab" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将使用Kaggle的一个数据集，名为Gabriel Preda的2020年东京奥运会推文。</p><p id="d7dd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该数据集汇编了关于2020年东京夏季奥运会的推文。使用Twitter API通过查看标签为#Tokyo2020的tweets来检索数据集。您可以在这里 查看关于数据集<a class="ae ky" href="https://www.kaggle.com/gpreda/tokyo-olympics-2020-tweets" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">的详细信息。</strong></a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/f52600c82e43387dcb7ba33a2ec23e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aQSy9pWLSIzglB3M"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图为作者截图。</p></figure><p id="507f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了下载数据，我们可以使用Kaggle API来简化这个过程。确保获得一个包含用于访问Kaggle的API密钥的JSON文件。</p><p id="7c3b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要创建该文件，请在Kaggle的您的个人资料页面上打开“帐户”选项卡。然后，单击创建新的API令牌。在我的例子中，它看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/b7a2150e082a906ad27e94492606517a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hMEYqAb-MnMdCPYH"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">截图为作者截图。</p></figure><p id="3538" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">获得JSON文件后，下一步是将文件复制到。kaggle文件夹。您可以使用下面的代码来复制该文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="e75e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果没有问题，您可以使用下面的脚本下载数据集，不会出现任何错误:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="b270" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们使用下面的脚本解包数据集:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="f4f2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">完成之后，现在我们可以加载数据了。代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><blockquote class="oj ok ol"><p id="d309" class="lr ls om lt b lu mn ju lw lx mo jx lz on mp mc md oo mq mg mh op mr mk ml mm im bi translated">注意:<br/>数据集最初包含大约10万条推文。为了使我们的过程高效，我们对2万个数据进行采样。</p><p id="89d3" class="lr ls om lt b lu mn ju lw lx mo jx lz on mp mc md oo mq mg mh op mr mk ml mm im bi translated">我以前在主题建模过程中使用过完整的数据集。最后因为回忆之类的资源不够，过程做不下去。</p><p id="8e1b" class="lr ls om lt b lu mn ju lw lx mo jx lz on mp mc md oo mq mg mh op mr mk ml mm im bi translated">如果您有足够的计算资源，可以使用完整的数据集尝试建模过程。</p></blockquote><h2 id="73b0" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">清理数据</h2><p id="ed2d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">文本数据不干净。在我们进入建模过程之前，我们必须首先清理数据。这是最佳实践。因此，我们可以从中获得高质量的信息。</p><p id="aa63" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了清理文本，我们可以使用NLTK和re这样的库。这个库将过滤单词、提及、标签、链接等等。</p><p id="a69f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在让我们清理数据。这样做的代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="5d5e" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">使用BERT对数据建模</h2><p id="f65e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们有了干净的数据之后，我们现在可以进行主题建模过程了。对于建模过程，我们将使用BERTopic库。</p><p id="63b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们可以使用这个库之前，让我们先使用pip安装这个库。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="7022" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们可以使用图书馆了。让我们使用下面的代码导入库:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="33b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们导入库之后，下一步是准备两个数据。第一个是推文本身。第二个是时间戳，描述了tweet发布的时间。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="2fdd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">做完这些后，现在让我们做主题建模。主题建模的过程很简单。</p><p id="9f0a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您所需要的就是初始化BERTopic对象。然后，该模型将拟合和转换推文，以基于推文生成主题。</p><p id="d54a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您以前已经使用过scikit-learn库，您会发现它很容易使用。下面是实现这一点的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="92b6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从这段代码中，现在我们可以检索数据集上存在的主题。要显示包含主题和tweets数量的表格，可以运行下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="3355" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从上面可以看出，数据集内有357个主题。-1主题不包括，因为这些推文没有重要的意义。</p><p id="d80e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从数据集中，我们可以看到304条推文谈论了他们观看奥运会的活动。然后，接下来的话题是人们对为国家赢得奖牌的运动员的赞赏，以及巴西排球运动员坦达拉和菲娜达·加雷的故事。</p><p id="e212" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是这些信息不够有趣。让我们看看能否用图表把它形象化。幸运的是，BERTopic有内置的函数来做这件事。</p><h2 id="7ecf" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">想象结果</h2><p id="730f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以创建的第一个可视化是主题之间的距离图。为了形象化，您可以运行下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="ca69" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以做的第二个可视化是每个主题中最常出现的单词的条形图。您可以运行下面的代码来可视化:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="db24" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">尽管这个图表有很好的视觉效果，但是它不能显示前八个主题之外的其他主题。</p><p id="82c8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以做的第三个可视化是可视化热图。如果您想要查看哪个主题与另一个主题高度相关，热图非常有用。为了形象化，您可以运行下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h2 id="00ca" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">一段时间内出现的主题</h2><p id="b13b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如你所知，我们把时间戳作为一个变量。我们可以使用该变量来可视化一个主题随时间变化的趋势。为了在时间戳旁边建模主题，您可以运行下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="52de" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从那里，您可以可视化时间序列的集合，每个集合代表一个主题的趋势。您可以运行下面的代码来可视化:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div></figure><h1 id="5499" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="57b1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">干得好！您已经学习了如何使用BERT和BERTopic库进行主题建模。我希望你能在这里学到新的东西。同时，我希望它能帮助你从文本中获取有意义的信息。</p><p id="6ea2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你有任何问题，你可以通过我的电子邮件联系我。还有，你可以在<a class="ae ky" href="https://www.linkedin.com/in/alghaniirfan/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> LinkedIn </strong> </a>上和我联系。</p><p id="35e6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">谢谢你看我的文章！</p><h2 id="e5a0" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">参考</h2><p id="58ba" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">[1]【https://maartengr.github.io/BERTopic/index.html<br/>【2】<a class="ae ky" href="https://maartengr.github.io/BERTopic/algorithm/algorithm.html" rel="noopener ugc nofollow" target="_blank">https://maartengr . github . io/ber topic/algorithm/algorithm . html</a></p></div></div>    
</body>
</html>