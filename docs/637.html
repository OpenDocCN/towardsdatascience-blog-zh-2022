<html>
<head>
<title>A Simple Way to Turn Your Plots into GIFs in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python把你的图转换成gif的简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-way-to-turn-your-plots-into-gifs-in-python-f6ea4435ed3c#2022-01-22">https://towardsdatascience.com/a-simple-way-to-turn-your-plots-into-gifs-in-python-f6ea4435ed3c#2022-01-22</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><figure class="iu iv gp gr iw ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi it"><img src="../Images/2a7390b6fdf2e8a6d0979986a64eaef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DBYzKB8jFGi7qh5u7ZxgwA.jpeg"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">雅各布·欧文斯在<a class="ae ji" href="https://unsplash.com/s/photos/video?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""><h1 id="4e9d" class="pw-post-title jj jk jl bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">用Python把你的图转换成gif的简单方法</h1></div><div class=""><h2 id="d12a" class="pw-subtitle-paragraph ki jk jl bd b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz dk translated">用动画情节打动你的观众</h2></div><p id="ec10" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">随着时间的推移，我看到了相当多的动画情节，例如，不同产品的销售如何随着时间的推移而变化，特定公司的市场份额如何演变，感染人数等。最近我想，用Python创作这样的动画，一定有简单的方法。经过快速搜索，我找到了最适合这项工作的图书馆。在这篇短文中，我将向您展示如何用几行代码轻松地将您的情节转换为动画gif。</p><h1 id="24d4" class="lw lx jl bd ly lz ma mb mc md me mf mg kr mh ks mi ku mj kv mk kx ml ky mm mn bi translated">设置</h1><p id="787f" class="pw-post-body-paragraph la lb jl lc b ld mo km lf lg mp kp li lj mq ll lm ln mr lp lq lr ms lt lu lv io bi translated">和往常一样，我们从导入库开始。为了创建gif，我们将使用<code class="fe mt mu mv mw b">gif</code>库。在所有的导入之后，我们也将DPI(每英寸点数)增加到300，这样我们的动画将会有更高的分辨率。</p><figure class="mx my mz na gt ix"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="152f" class="lw lx jl bd ly lz ma mb mc md me mf mg kr mh ks mi ku mj kv mk kx ml ky mm mn bi translated">图1:一个简单的线形图</h1><p id="5b6f" class="pw-post-body-paragraph la lb jl lc b ld mo km lf lg mp kp li lj mq ll lm ln mr lp lq lr ms lt lu lv io bi translated">我在考虑用哪种图来演示，我决定用线图，因为它们显示了一些值是如何随时间变化的。这使得他们成为动画的完美候选人。更准确地说，我们将关注股票价格。</p><p id="c2bd" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">我们从下载特斯拉2019年至2021年的股价开始。</p><figure class="mx my mz na gt ix"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="c736" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">我们下载了每日数据，这导致数据帧超过1000行。对于我们的用例来说，这可能有点过了。这就是为什么我们通过取每个月的最后一个值将数据重新采样到每月频率。</p><pre class="mx my mz na gt nd mw ne nf aw ng bi"><span id="049f" class="nh lx jl mw b gy ni nj l nk nl">tsla_df = df[["Adj Close"]].resample("M").last()</span></pre><p id="a77c" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">然后，我们定义一个辅助函数来分别显示动画的每一帧。</p><figure class="mx my mz na gt ix"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="4d44" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">这里有几件事值得一提:</p><ul class=""><li id="53af" class="nm nn jl lc b ld le lg lh lj no ln np lr nq lv nr ns nt nu bi translated">我们创建了一个函数来显示动画中每一帧的情节。在我们的例子中，每一帧对应于显示特定日期之前数据的图。稍后我们将把这些帧组合成一个动画。</li><li id="0641" class="nm nn jl lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">在定义函数时，我们使用了<code class="fe mt mu mv mw b">@gif.frame</code>装饰器(必需的步骤)。</li><li id="6c8c" class="nm nn jl lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">我们使用下面的代码片段<code class="fe mt mu mv mw b">df.iloc[i:] = np.nan</code>来屏蔽当前帧之后的所有数据。这是一个从开始显示整个x轴的简单技巧，因此我们不会观察到一个不断扩展的轴。在我看来，这简直是赏心悦目。</li><li id="9575" class="nm nn jl lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">使用<code class="fe mt mu mv mw b">matplotlib</code>绘图时，该函数不应返回任何内容(这与我们使用<code class="fe mt mu mv mw b">plotly</code>或<code class="fe mt mu mv mw b">altair</code>时不同)。</li></ul><p id="6639" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">然后，我们使用for循环来获取动画的所有帧，并将它们附加到一个列表中。</p><figure class="mx my mz na gt ix"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="f399" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">最后，我们把所有的帧放在一起并保存GIF。我们使用<code class="fe mt mu mv mw b">save</code>函数来实现。我们提供了帧列表、GIF的预期名称、持续时间以及表示时间的单位。最后，我们还应该指定<code class="fe mt mu mv mw b">between</code>参数。它决定了<code class="fe mt mu mv mw b">duration</code>参数描述的是帧之间的时间(<code class="fe mt mu mv mw b">“frames”</code>)还是整个动画的持续时间(<code class="fe mt mu mv mw b">“startend”</code>)。我们选择后者。</p><figure class="mx my mz na gt ix"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="bb82" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">下面，我们可以观察我们工作的产出。</p><figure class="mx my mz na gt ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi oa"><img src="../Images/1eb4bb4bc4bbb03fea3967822755f3ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Exq5TlSfR3c-p7HktzNMLw.gif"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">作者制作的动画</p></figure><p id="060b" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">另一方面，这是相当可观的增长📈！</p><h1 id="ddff" class="lw lx jl bd ly lz ma mb mc md me mf mg kr mh ks mi ku mj kv mk kx ml ky mm mn bi translated">图2:多个时间序列</h1><p id="1840" class="pw-post-body-paragraph la lb jl lc b ld mo km lf lg mp kp li lj mq ll lm ln mr lp lq lr ms lt lu lv io bi translated">说到成长，让我们更进一步。这一次，我们下载了同一时间段的五家科技公司(任意选择:特斯拉、Twitter、脸书、亚马逊、苹果)的股价。与前面的例子类似，我们也以每月一次的频率对数据进行重采样。然后，我们计算相对于锚定期(第一行)，即2018年12月，每个月的价格如何变化。</p><figure class="mx my mz na gt ix"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="3e68" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">您可以在下面看到数据框的预览:</p><figure class="mx my mz na gt ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi ob"><img src="../Images/5083d913b917151b56869a4fba7e7a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PDwSlBgJkBwnFSzwVQn_iQ.png"/></div></div></figure><p id="f24a" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">我们再次定义了一个用于绘制框架的辅助函数。逻辑和上次差不多。最大的变化出现在函数的末尾，我们将图例移到了图的外面。否则，它可以根据线条的当前位置，在帧之间的图形周围跳跃。这样，我们使它的位置固定在绘图区域之外。</p><p id="7043" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated"><strong class="lc jm">注</strong>:操纵图例的代码改编自<a class="ae ji" href="https://stackoverflow.com/questions/4700614/how-to-put-the-legend-out-of-the-plot" rel="noopener ugc nofollow" target="_blank">this stack overflow answer</a>，在这里你也可以找到如何将其放置在剧情的其他部分。这在和<code class="fe mt mu mv mw b">matplotlib</code>一起工作的时候绝对可以派上用场！</p><figure class="mx my mz na gt ix"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="3299" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">我们没有展示其余的过程(存储帧和保存GIF ),因为与第一个动画相比没有什么变化。</p><p id="f5f9" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">最后，我们可以看看结果。</p><figure class="mx my mz na gt ix gh gi paragraph-image"><div role="button" tabindex="0" class="iy iz di ja bf jb"><div class="gh gi oa"><img src="../Images/aca7877031c4759e289a1bdd13eb35ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*pX2lxoptwZantJZ18WlxOA.gif"/></div></div><p class="je jf gj gh gi jg jh bd b be z dk translated">作者制作的动画</p></figure><p id="063b" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">在这一点上，值得一提的是<code class="fe mt mu mv mw b">gif</code>库并不局限于从线图创建gif。我们可以随心所欲地设计任何情节。也许我们唯一需要记住的是，动画应该强调我们试图传达的故事，而不是仅仅为了动画而创作动画。</p><h1 id="2f32" class="lw lx jl bd ly lz ma mb mc md me mf mg kr mh ks mi ku mj kv mk kx ml ky mm mn bi translated">外卖食品</h1><ul class=""><li id="0323" class="nm nn jl lc b ld mo lg mp lj oc ln od lr oe lv nr ns nt nu bi translated">是一个方便的库，可以将你的常规情节转换成动态的、易于共享的动画，</li><li id="5531" class="nm nn jl lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">该库与<code class="fe mt mu mv mw b">matplotlib</code>、<code class="fe mt mu mv mw b">plotly</code>、<code class="fe mt mu mv mw b">altair</code>、</li><li id="bcb7" class="nm nn jl lc b ld nv lg nw lj nx ln ny lr nz lv nr ns nt nu bi translated">我们可以基于各种类型的图表创建动画。</li></ul><p id="fb23" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">就个人而言，我认为我更喜欢静态的剧情(或者像<code class="fe mt mu mv mw b">plotly</code>中那样的互动)，而不是动画。因为这样我们就可以更深入地分析并尝试识别模式。然而，这样的动画情节在特殊情况下绝对是很好的“炫耀”——这完全取决于目的。</p><p id="9339" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">你可以在我的<a class="ae ji" href="https://github.com/erykml/medium_articles/blob/master/Misc/creating_gifs.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到本文使用的代码。此外，欢迎任何建设性的反馈。你可以在推特或评论中联系我。</p><p id="3a01" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">喜欢这篇文章吗？成为一个媒介成员，通过无限制的阅读继续学习。如果你使用<a class="ae ji" href="https://eryk-lewinson.medium.com/membership" rel="noopener">这个链接</a>成为会员，你将支持我，不需要额外的费用。提前感谢，再见！</p><p id="fb22" class="pw-post-body-paragraph la lb jl lc b ld le km lf lg lh kp li lj lk ll lm ln lo lp lq lr ls lt lu lv io bi translated">您可能还会对以下内容感兴趣:</p><div class="iu iv gp gr iw of"><a rel="noopener follow" target="_blank" href="/8-more-useful-pandas-functionalities-for-your-analyses-ef87dcfe5d74"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd jm gy z fp ok fr fs ol fu fw jk bi translated">用于分析的8个更有用的熊猫功能</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">它们可以让你的日常工作更轻松、更快捷</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">towardsdatascience.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot jc of"/></div></div></a></div><div class="iu iv gp gr iw of"><a href="https://medium.com/geekculture/top-4-python-libraries-for-technical-analysis-db4f1ea87e09" rel="noopener follow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd jm gy z fp ok fr fs ol fu fw jk bi translated">用于技术分析的4大Python库</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">有一个计算布林线的例子</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">medium.com</p></div></div><div class="oo l"><div class="ou l oq or os oo ot jc of"/></div></div></a></div><div class="iu iv gp gr iw of"><a rel="noopener follow" target="_blank" href="/use-annotations-to-tell-better-stories-with-your-plots-410cb1752bee"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd jm gy z fp ok fr fs ol fu fw jk bi translated">使用注释来讲述更好的故事</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">以及如何使用plotly在Python中实现它</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">towardsdatascience.com</p></div></div><div class="oo l"><div class="ov l oq or os oo ot jc of"/></div></div></a></div><h1 id="bf18" class="lw lx jl bd ly lz ma mb mc md me mf mg kr mh ks mi ku mj kv mk kx ml ky mm mn bi translated">参考</h1><ul class=""><li id="fd9a" class="nm nn jl lc b ld mo lg mp lj oc ln od lr oe lv nr ns nt nu bi translated"><a class="ae ji" href="https://github.com/maxhumber/gif" rel="noopener ugc nofollow" target="_blank">https://github.com/maxhumber/gif</a></li></ul></div></div>    
</body>
</html>