<html>
<head>
<title>Automated emails and data quality checks for your data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">针对您的数据的自动化电子邮件和数据质量检查</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automated-emails-and-data-quality-checks-for-your-data-1de86ed47cf0#2022-01-28">https://towardsdatascience.com/automated-emails-and-data-quality-checks-for-your-data-1de86ed47cf0#2022-01-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="1d96" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">针对您的数据的自动化电子邮件和数据质量检查</h1></div><div class=""><h2 id="805b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过预定的电子邮件获得更好、更干净数据的数据仓库指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fb8e11b84d979981b023d08ac1cb2e98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMIqtbw8jL0DZp051d-Ljw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><h1 id="63f4" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">用干净的数据构建数据仓库</h1><p id="b0b4" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">如果您正在构建一个数据仓库解决方案或/和在数据库中运行一些管理任务，那么本文适合您。它回答了这个问题:</p><blockquote class="mo mp mq"><p id="1135" class="ls lt mr lu b lv ms ju lx ly mt jx ma mu mv md me mw mx mh mi my mz ml mm mn im bi translated">如何测试数据质量，并在出现问题时发送电子邮件通知。</p></blockquote><p id="1631" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">理想情况下，每个数据用户都希望在数据出现任何异常时得到通知，尤其是当我们谈到关键的报告组件和字段时。</p><p id="004d" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">每个数据仓库可能有几十个数据管道源，它们来自API、连接的数据库、像Kinesis或Kafka这样的数据流以及第三方数据提供商。我以前写过如何用easy连接所有这些，你可以在这里阅读我的设置:<a class="ae na" rel="noopener" target="_blank" href="/how-to-handle-data-loading-in-bigquery-with-serverless-ingest-manager-and-node-js-4f99fba92436">如何用无服务器摄取管理器和Node.js处理BigQuery中的数据加载</a></p><p id="452e" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">因此，当数据来了，我想确保所有字段都准备好了，并有正确的格式。<strong class="lu iu">例如，您的报告可能使用</strong> <code class="fe nb nc nd ne b"><strong class="lu iu">date</strong></code> <strong class="lu iu">列，并且您希望确保它在数据仓库中的格式正确，或者至少不为空(非空)。</strong></p><p id="1a6c" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">这里有一个简单而有效的框架。</p><h1 id="2860" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">先决条件、库和设置</h1><ul class=""><li id="7c6b" class="nf ng it lu b lv lw ly lz mb nh mf ni mj nj mn nk nl nm nn bi translated"><strong class="lu iu"> Google BigQuery </strong>。我将使用<strong class="lu iu"> BigQuery </strong>作为数据仓库解决方案，因为它是免费的，但是您可以使用任何您喜欢的替代方案，例如雪花、红移、任何db引擎。他们中的大多数人无论如何都可以发送电子邮件通知。这就是一切。</li><li id="373e" class="nf ng it lu b lv no ly np mb nq mf nr mj ns mn nk nl nm nn bi translated"><strong class="lu iu">标准SQL </strong>。这不是高级教程。这里提供的SQL可以在任何数据库引擎中工作，或者您可以调整它以满足您的需求。很容易。</li></ul><p id="2c6e" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><strong class="lu iu">重要提示</strong> : BigQuery并不是完全免费的，但是Google提供免费的积分，即使你没有剩余的积分，我也会使用免费的数据进行查询。你所需要的就是<a class="ae na" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank"> Google账户</a>和<strong class="lu iu"> BigQuery API </strong>启用。</p><h1 id="fbd6" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">您将学习如何:</h1><ul class=""><li id="31c7" class="nf ng it lu b lv lw ly lz mb nh mf ni mj nj mn nk nl nm nn bi translated">使用SQL检查数据质量</li><li id="3fcf" class="nf ng it lu b lv no ly np mb nq mf nr mj ns mn nk nl nm nn bi translated">发送电子邮件通知</li><li id="52b1" class="nf ng it lu b lv no ly np mb nq mf nr mj ns mn nk nl nm nn bi translated">用SQL创建测试表和模拟数据</li><li id="180c" class="nf ng it lu b lv no ly np mb nq mf nr mj ns mn nk nl nm nn bi translated">检测数据异常</li></ul><h1 id="430d" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">如何安排电子邮件通知</h1><p id="fc82" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">在BigQuery中非常简单。</p><ul class=""><li id="1026" class="nf ng it lu b lv ms ly mt mb nt mf nu mj nv mn nk nl nm nn bi translated">转到<a class="ae na" href="https://console.cloud.google.com/bigquery/scheduled-queries" rel="noopener ugc nofollow" target="_blank">预定查询</a>:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/fa659090e15ceeed19e4a7948aff04e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8qxq5Nzd0tm3wDVC.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><ul class=""><li id="0233" class="nf ng it lu b lv ms ly mt mb nt mf nu mj nv mn nk nl nm nn bi translated">输入您的SQL，即测试它的东西:<code class="fe nb nc nd ne b">select 1 as test;</code>并点击下面的计划查询:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/4a42764d4b4158fb60fb7997c322d500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XISjM95yni17ilU_.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><ul class=""><li id="7df4" class="nf ng it lu b lv ms ly mt mb nt mf nu mj nv mn nk nl nm nn bi translated">为您的查询命名，然后点击下面的<strong class="lu iu">“发送电子邮件通知”</strong>。所以现在，如果您的SQL查询<strong class="lu iu">失败</strong>，您将开始收到通知:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/470a5c8277a0e43b16fdc0d166f106b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6xK0uHLvFzyC7kfk.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。@ MikeShakomirov</p></figure><blockquote class="mo mp mq"><p id="d080" class="ls lt mr lu b lv ms ju lx ly mt jx ma mu mv md me mw mx mh mi my mz ml mm mn im bi translated">如果查询结果中的任何记录满足您指定的行条件，您现在需要做的就是引发一个异常。</p></blockquote><h1 id="8485" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">如何使用行条件添加数据检查</h1><p id="08eb" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">基本上这就是你如何测试你的数据满足你需要的质量要求。</p><p id="8eb9" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">让我们试着想象一些现实生活中的场景，你的数据必须通过<strong class="lu iu">质量保证</strong>流程。<em class="mr">例如，我的暂存数据仓库中有一个</em> <code class="fe nb nc nd ne b"><em class="mr">user_transaction</em></code> <em class="mr">表，可以用您的SQL脚本创建:</em></p><p id="2602" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><strong class="lu iu">让我们创建一个表格</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><blockquote class="mo mp mq"><p id="6ccb" class="ls lt mr lu b lv ms ju lx ly mt jx ma mu mv md me mw mx mh mi my mz ml mm mn im bi translated"><em class="it">如果你像我一样遇到错误:</em> <code class="fe nb nc nd ne b"><em class="it">error: Cannot set write disposition in jobs with DDL statements</em></code> <em class="it">只要刷新你的页面就行了。</em></p></blockquote><p id="3390" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">当你的网页打开时间过长时，可能会出现一些界面元素失效的问题。</p><p id="d4f5" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">在这里阅读更多关于在BigQuery中创建表的信息:<a class="ae na" href="https://cloud.google.com/bigquery/docs/creating-partitioned-tables#sql" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/big query/docs/creating-partitioned-tables # SQL</a></p><p id="a539" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><strong class="lu iu">结果:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/262ebc0b74413d5a94ec24da203a63b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_6gM_fj9hfdntY4r.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><h2 id="574a" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated"><strong class="ak">现在我想检查数据是否有任何潜在问题</strong></h2><p id="70f5" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">在这里，我将计算带有缺失(NULL)值的记录，并检查您是否从source pieline中获得了任何重复项:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="33f7" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">因此，您将看到事务总数大于唯一事务计数，并且有一个<code class="fe nb nc nd ne b">payment_date</code>的值为<code class="fe nb nc nd ne b">NULL</code>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/d9fe2a8b2d9b5eca97128d96fa521f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EBWyJX6bBoTB5wa-.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><blockquote class="mo mp mq"><p id="25f1" class="ls lt mr lu b lv ms ju lx ly mt jx ma mu mv md me mw mx mh mi my mz ml mm mn im bi translated"><em class="it">如果昨天在我的</em> <strong class="lu iu"> <em class="it">数据仓库</em> </strong> <em class="it">中摄取的数据中检测到这种情况，我肯定希望收到电子邮件通知。</em></p></blockquote><h2 id="f4ee" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated">那么我们该怎么做呢？</h2><p id="0f41" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><strong class="lu iu">让我们再添加一些SQL并引发一个异常</strong></p><p id="3996" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">这将触发电子邮件通知:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="8b3f" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">将引发错误(BigQuery异常):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/7fa112253508dfd3c10577764e0115ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YD00OBjOQk7kDORw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><p id="a8b6" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">我会收到一封邮件说:</p><blockquote class="mo mp mq"><p id="b824" class="ls lt mr lu b lv ms ju lx ly mt jx ma mu mv md me mw mx mh mi my mz ml mm mn im bi translated"><strong class="lu iu"> <em class="it">注意:production.user_transaction昨天有可能丢失数据:1。</em>T44】</strong></p></blockquote><p id="d2c4" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><em class="mr">很棒。但是，我希望在我的电子邮件中收到一份关于潜在数据问题的完整摘要。</em></p><h2 id="c9f2" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated"><strong class="ak">让我们总结一下所有潜在的数据质量问题</strong></h2><p id="f2ef" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">我们可以使用类似于:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="1ce0" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">当我们的任何<code class="fe nb nc nd ne b">checks</code>失败时，这将触发一个电子邮件通知，但不会提供太多信息:</p><blockquote class="mo mp mq"><p id="12df" class="ls lt mr lu b lv ms ju lx ly mt jx ma mu mv md me mw mx mh mi my mz ml mm mn im bi translated"><strong class="lu iu"> <em class="it">注意:production.user_transaction存在潜在的昨天所有数据质量问题:%t. </em> </strong></p></blockquote><p id="b0e8" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">相反，我希望得到这样的结果:</p><blockquote class="mo mp mq"><p id="7dab" class="ls lt mr lu b lv ms ju lx ly mt jx ma mu mv md me mw mx mh mi my mz ml mm mn im bi translated"><strong class="lu iu"> <em class="it">注意:production.user_transaction有1个重复的事务和1个值为空的payment_date。</em> </strong></p></blockquote><p id="4394" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><strong class="lu iu">让我们看看使用SQL需要做些什么来实现这一点</strong></p><p id="bafd" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">要总结失败的数据质量检查，您可能需要使用以下内容:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="6143" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated"><strong class="ak">结果:</strong></h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/cac47520a987d6ae8ee694c89b132c80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sZv-ZUkC0UpOn2QQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/69c14872b88e26367d11d2f3a327e895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hA8UaInia108G--bh8tHew.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><p id="3a45" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">在上面的SQL中，我创建了一个CTE，其中的行条件定义了我需要的警报。</p><blockquote class="or"><p id="e600" class="os ot it bd ou ov ow ox oy oz pa mn dk translated"><em class="pb">我将使用它来生成数据质量警报的完整摘要，并将其包含在我的电子邮件通知中。</em></p></blockquote><p id="2ea2" class="pw-post-body-paragraph ls lt it lu b lv pc ju lx ly pd jx ma mb pe md me mf pf mh mi mj pg ml mm mn im bi translated">使用SQL有很多方法可以实现这一点。它非常灵活，这也是我喜欢它的原因，但我决定使用<strong class="lu iu"> BigQuery数组函数</strong><a class="ae na" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/big query/docs/reference/standard-SQL/array _ functions</a></p><h2 id="c7c1" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated">让我们来看看怎么做:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="6617" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated">因此，您将看到检测到的潜在数据质量问题的摘要文本消息:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/b39fabc30f311576574994c55e483b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ijQxIJfsbS_Vm4eP.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/9f72fbd20f123c8493e19199a6ac0f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yJAgBptxVo3jjIW8H1kw8Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><h2 id="0a16" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated"><strong class="ak">最后，让我们用BigQuery异常来总结一下，这样它就可以给我们发送一封电子邮件:</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/be54539de69ffedf138fa734b6cdfb93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uDlzqKTEHmmw1j5d.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/923a80f748122c6d786a8b6865bb196f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMgE8Nb9zxacqbs59YmCog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><h2 id="10d6" class="oc lb it bd lc od oe dn lg of og dp lk mb oh oi lm mf oj ok lo mj ol om lq on bi translated">还有一件事…</h2><p id="445e" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><strong class="lu iu">让我们创建那个</strong> <code class="fe nb nc nd ne b"><strong class="lu iu">dataChecks.check_user_transaction_failed_v</strong></code> <strong class="lu iu">视图，以便更容易找到没有通过质量检查的准确记录:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/e58b9d084a10c43588fb6f203cbe840e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4QbRgKgGieDrotHB.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/f2f3890b728c8f461e4059aba5b264df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWiCfyO3jnDGAJBgw1HijQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><p id="51b1" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">因此，现在有了这个视图，我们就可以在收到通知时轻松调查数据质量问题。</p><p id="8d28" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">有用的是，如果你能<strong class="lu iu">在<strong class="lu iu"> BigQuery通知消息</strong>中添加一个查看URL链接</strong>，那么谷歌就能推断出这一点，你就能点击它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/c9b3a6c786b7170481e84b5ff6783417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XpWDU22tmRaV1anv.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。<a class="ky kz ep" href="https://medium.com/u/e06a48b3dd48?source=post_page-----1de86ed47cf0--------------------------------" rel="noopener" target="_blank">💡迈克·沙克霍米罗夫</a></p></figure><h1 id="fd21" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">结论</h1><p id="4121" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated">这是一个简单可靠的数据质量框架，大多数现代数据仓库都支持它。</p><p id="c46c" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated">最终，它允许<strong class="lu iu">用视图检查您的数据</strong>，并且<strong class="lu iu">轻松检测潜在的数据质量问题</strong>。不仅仅是缺失数据和空值。在数据集条件中，几乎可以使用任何东西，即使用<strong class="lu iu"> regex函数</strong>检查数据是否满足特定模式或任何其他组合条件，其中<strong class="lu iu">使用了多列</strong>。</p><p id="ec8b" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><strong class="lu iu">需要异常检测吗？很简单。只需将30天移动平均线和阈值添加到数据集条件中，并在阈值被突破时收到电子邮件通知。</strong></p><h1 id="a85d" class="la lb it bd lc ld le lf lg lh li lj lk jz ll ka lm kc ln kd lo kf lp kg lq lr bi translated">资源</h1><p id="0c24" class="pw-post-body-paragraph ls lt it lu b lv lw ju lx ly lz jx ma mb mc md me mf mg mh mi mj mk ml mm mn im bi translated"><a class="ae na" href="https://cloud.google.com/bigquery/docs/creating-partitioned-tables#sql" rel="noopener ugc nofollow" target="_blank">【1】:https://cloud . Google . com/big query/docs/creating-partitioned-tables # SQL</a></p><p id="576d" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><a class="ae na" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/array_functions" rel="noopener ugc nofollow" target="_blank">【2】:https://cloud . Google . com/big query/docs/reference/standard-SQL/array _ functions</a></p></div><div class="ab cl pm pn hx po" role="separator"><span class="pp bw bk pq pr ps"/><span class="pp bw bk pq pr ps"/><span class="pp bw bk pq pr"/></div><div class="im in io ip iq"><p id="b6a2" class="pw-post-body-paragraph ls lt it lu b lv ms ju lx ly mt jx ma mb mv md me mf mx mh mi mj mz ml mm mn im bi translated"><em class="mr">最初发表于</em><a class="ae na" href="https://mydataschool.com/blog/data-quality-guide-with-bigquery/" rel="noopener ugc nofollow" target="_blank">T5【https://mydataschool.com】</a><em class="mr">。</em></p></div></div>    
</body>
</html>