<html>
<head>
<title>Advancing to Professional Dashboard with Python, using Dash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Dash通过Python升级到专业仪表板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/advancing-to-professional-dashboard-with-python-using-dash-and-plotly-1e8e5aa4c668#2022-01-08">https://towardsdatascience.com/advancing-to-professional-dashboard-with-python-using-dash-and-plotly-1e8e5aa4c668#2022-01-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="5828" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">使用Dash通过Python升级到专业仪表板</h1></div><div class=""><h2 id="848a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">增强初始框架代码的高级方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3f1cd82ff6c405b941482bcdf7d19572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZqLJRcNfNB3XdEDxO2DNqw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我的Dash web应用程序的登录页面—作者图片</p></figure><p id="7dfe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么您已经遵循了推荐的文件夹结构，构建了一个简单的框架dash应用程序，或者甚至可能将它部署到了某个服务器上，那么现在呢？您添加了更多的组件，但是面临需要调试的错误，或者web应用程序不够“专业”。这篇文章包含了让Dash应用程序运行得更快，提高web应用程序的美观性，减少调试的痛苦，SEO，跟踪和一些额外的高级东西的技巧。本文的结构是这样的，随着我们的进展，它的复杂性增加了，但是不要担心，演示代码可以用来说明每一点。</p><h1 id="205b" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated"><strong class="ak">目录</strong></h1><ul class=""><li id="1b0e" class="mm mn it la b lb mo le mp lh mq ll mr lp ms lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#efc9" rel="noopener">先决条件</a></li><li id="02dc" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#98ab" rel="noopener">管理回拨效率</a></li><li id="c1da" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#7cd8" rel="noopener">专业外观的CSS样式</a></li><li id="aa3f" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#65c0" rel="noopener">与装修工一起调试</a></li><li id="b06d" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#99ca" rel="noopener">带有客户端回调的多标签应用</a></li><li id="7953" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#c202" rel="noopener">多页面应用</a></li><li id="85f7" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#ea88" rel="noopener">搜索引擎优化</a></li><li id="266c" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#cf77" rel="noopener">使用谷歌分析进行跟踪</a></li><li id="3483" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#43cc" rel="noopener">结论</a></li><li id="23b8" class="mm mn it la b lb my le mz lh na ll nb lp nc lt mt mu mv mw bi translated"><a class="ae mx" href="https://medium.com/p/1e8e5aa4c668/#17ed" rel="noopener">相关链接</a></li></ul></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="efc9" class="lu lv it bd lw lx nk lz ma mb nl md me jz nm ka mg kc nn kd mi kf no kg mk ml bi translated">先决条件</h1><p id="b1b9" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">了解Dash应用的基本知识。如果没有，Dash官方文档<a class="ae mx" href="https://dash.plotly.com/" rel="noopener ugc nofollow" target="_blank">中的Dash教程</a>可以让你快速上手。</p><h1 id="98ab" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">管理回拨效率</h1><p id="842a" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">有没有注意到web应用程序在页面加载或切换选项卡时需要一些时间来渲染？Dash的工作方式是，当一个组件出现在屏幕上时，该组件的所有相关回调都将被触发——即使输入没有被触发。如果屏幕上没有太多组件，这可能不是问题，但是当在没有正确初始化的变量上触发回调时，您将遇到可伸缩性问题甚至错误。</p><p id="806b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">官方Dash文档建议引发<code class="fe ns nt nu nv b">PreventUpdate</code>异常以防止更新输出，然而，这涉及到检查输入是否为<code class="fe ns nt nu nv b">None</code>，这可能是也可能不是不同组件的情况。我采用的一个解决方案是初始化返回变量，只有当回调通过输入触发时才更新返回变量。下面显示了一个例子，</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="e999" class="oa lv it nv b be ob oc l od oe">@app.callback(...)<br/>def sample_function(trigger)<br/>    reply = ""<br/>    if dash.callback_context.triggered:<br/>        reply = "Callback is triggered"<br/>    return reply</span></pre><p id="71e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这样，如果无意中触发了回调，它将跳过所有中间处理，从而节省页面加载或tab切换的时间。</p><p id="feac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="of">更新</em> </strong>:您可以在<code class="fe ns nt nu nv b">@app.callback()</code>装饰器中设置<code class="fe ns nt nu nv b">prevent_initial_call=True</code>来防止回调级别的初始回调。这可以在<a class="ae mx" href="https://dash.plotly.com/advanced-callbacks" rel="noopener ugc nofollow" target="_blank">高级回调仪表板文档</a>中找到。</p><h1 id="7cd8" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">专业外观的CSS样式</h1><p id="d4ea" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">在屏幕上添加更多组件时，您可能会注意到默认颜色使web应用程序看起来非常单调或空洞。一个建议是为你的网络应用选择一个颜色方案。我使用的一些网站是<a class="ae mx" href="https://www.color-hex.com/color-palettes/" rel="noopener ugc nofollow" target="_blank"> colour-hex </a>和<a class="ae mx" href="https://color.adobe.com/explore" rel="noopener ugc nofollow" target="_blank"> Adobe </a>，它们为获取预设调色板提供了一个很好的起点。</p><p id="0fde" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用CSS样式可以帮助同时改变多个组件的样式，而不是手动改变颜色方案的字体和背景，只要它们属于同一个“组”。这可以通过使用Dash组件的<code class="fe ns nt nu nv b">className</code>属性来完成。</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="76f8" class="oa lv it nv b be ob oc l od oe">app.layout = html.Div([<br/>    html.Div(className="custom-div"),<br/>    html.Div(className="custom-div"),<br/>])</span></pre><p id="094f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<code class="fe ns nt nu nv b">/assets</code>文件夹的CSS文件中，为该类添加自定义样式</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="ef87" class="oa lv it nv b be ob oc l od oe">.custom-div {<br/>    color: steelblue;<br/>}</span></pre><h1 id="65c0" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">用decorators调试</h1><p id="fcd1" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">编码时，错误是不可避免的，使用<code class="fe ns nt nu nv b">app.run_server(debug=True)</code>可以帮助热重装，并在错误发生时显示回溯消息。但是，当您不知道触发了哪些回调，或者触发回调的顺序时，可能很难进行调试。</p><blockquote class="og oh oi"><p id="0f7c" class="ky kz of la b lb lc ju ld le lf jx lg oj li lj lk ok lm ln lo ol lq lr ls lt im bi translated">装饰器允许对现有函数进行扩展，而无需修改原始函数源代码</p></blockquote><p id="500e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将decorators堆叠到回调函数中可以用来在回调被触发时添加打印语句。它实现起来很简单(每个回调只有一行代码)，如果您想进入或退出调试模式，您可以很容易地打开和关闭它！</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="41d5" class="oa lv it nv b be ob oc l od oe"># Toggle this to enter or exit debug mode<br/>debug_mode = True<br/><br/>def print_callback(debug_mode):<br/>    def decorator(func):<br/>        def wrapper(*args, **kwargs):<br/>            if debug_mode:<br/>                print(f"==== Function called: {func.__name__}")<br/>                print(f"Triggered by {dash.callback_context.triggered[0]['prop_id']}")<br/>            result = func(*args, **kwargs)<br/>            return result<br/>        return wrapper<br/>    return decorator<br/><br/># Using the decorator<br/>@app.callback(...)<br/>@print_callback(debug_mode)<br/>def sample_function(trigger):<br/>    pass</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/25accba466942a0cfab7b4663d0ebedc.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*wCUQuWvjlrrxJRb5OJiqAg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">装饰函数添加的打印语句示例</p></figure><h1 id="99ca" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">具有客户端回调的多标签应用程序</h1><p id="3073" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">客户端回调是直接在浏览器中运行的回调，而不是向Dash发出请求，当回调由于数据传输或回调链而导致大量开销时，客户端回调非常有用。一般来说，我不使用很多客户端回调，除了选项卡(来自dash核心组件)，我希望不同的选项卡可以改变web应用程序的标题。这是一个非常小的改进，但是我发现与在不同的标签上只显示一个标题相比，它使web应用程序更加定制化和交互式。</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="c48d" class="oa lv it nv b be ob oc l od oe">app.layout = html.Div(<br/>    html.Div(id="dummy-component"),<br/>    dcc.Tabs(<br/>        id="tabs-parent",<br/>        value=None,<br/>        children=[<br/>            dcc.Tab(label="Tab 1", value="tab1"),<br/>            dcc.Tab(label="Tab 2", value="tab2"),<br/>        ],<br/>    )<br/>)<br/><br/>app.clientside_callback(<br/>    """<br/>    function(tab_value) {<br/>        if (tab_value === 'tab1') {<br/>            document.title = 'Tab One'<br/>        } else if (tab_value === 'tab2') {<br/>            document.title = 'Tab Two'<br/>        }<br/>    }<br/>    """,<br/>    Output("dummy-component", "children"),<br/>    [Input("tabs-parent", "value")],<br/>)</span></pre><h1 id="c202" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">多页应用程序</h1><p id="777b" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">使用多个选项卡的另一种方法是使用扩展，如<em class="of">www.example.com/extension</em>，在多个页面上呈现web应用程序。为此，您需要为不同的页面准备好多个<code class="fe ns nt nu nv b">html.Div</code>容器，并利用<code class="fe ns nt nu nv b">dcc.Location</code>获取当前的web应用程序URL。</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="0937" class="oa lv it nv b be ob oc l od oe">app.layout = html.Div(<br/>    [<br/>        dcc.Location(id="url", refresh=False),<br/>        html.Div(id="page-content"),<br/>    ]<br/>)<br/><br/>@app.callback(Output("page-content", "children"), Input("url", "pathname"))<br/>@print_callback(print_function)<br/>def display_page(pathname):<br/>    if pathname == "/":<br/>        return html.Div("Main application")<br/>    elif pathname == "/extension":<br/>        return html.Div("Extension application")</span></pre><h1 id="ea88" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">搜索引擎优化</h1><p id="1c18" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">你可以使用元标签来执行SEO，一些重要的标签包括标题标签、元描述标签和社交媒体元标签。这些标签不仅能与搜索引擎交流，还能让你的网络应用程序的URL更易于共享！我的web应用程序就是一个例子，如下所示</p><div class="on oo gp gr op oq"><a href="https://kayjan.fly.dev" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">让生活变得有趣和轻松的工具</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">Kay Jan的副业——自动化重复的数据分析任务，执行预测和优化，以及玩游戏</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">kayjan.fly.dev</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe ks oq"/></div></div></a></div><p id="c3c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的代码示例展示了如何将meta标签添加到Dash应用程序中。请注意，必须为谷歌(以<code class="fe ns nt nu nv b">og:</code>开头的标签)和Twitter(以<code class="fe ns nt nu nv b">twitter:</code>开头的标签)分别添加重复的标签。</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="0c97" class="oa lv it nv b be ob oc l od oe">meta_tags = [<br/>    {<br/>        "name": "author",<br/>        "content": "Kay Jan WONG"<br/>    },<br/>    {<br/>        "name": "description",<br/>        "content": "Kay Jan's Side Project - Automate repetitive data analysis tasks and perform predictions and optimizations",<br/>    },<br/>    {<br/>        "name": "viewport",<br/>        "content": "width=device-width, initial-scale=1"<br/>    },<br/>    {<br/>        "property": "og:type",<br/>        "content": "website"<br/>    },<br/>    {<br/>        "property": "og:title",<br/>        "content": "Tools to make life easier"<br/>    },<br/>    {<br/>        "property": "og:description",<br/>        "content": "Automate repetitive data analysis tasks and perform predictions and optimizations",<br/>    },<br/>    {<br/>        "property": "og:image",<br/>        "content": "link-to-image.png"<br/>    },<br/>    {<br/>        "property": "twitter:title",<br/>        "content": "Tools to make life easier"<br/>    },<br/>    {<br/>        "property": "twitter:description",<br/>        "content": "Automate repetitive data analysis tasks and perform predictions and optimizations",<br/>    },<br/>    {<br/>        "property": "twitter:image",<br/>        "content": "link-to-image.png",<br/>    },<br/>]<br/>app = dash.Dash(__name__, meta_tags=meta_tags)</span></pre><h1 id="cf77" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">使用谷歌分析进行跟踪</h1><p id="985b" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">部署后，很自然地想要执行跟踪和查看网站流量。一种方法是将Google Analytics整合到Dash应用程序中。有一系列的安装步骤我不会在这里介绍，但是你可以按照谷歌文档中的<a class="ae mx" href="https://support.google.com/analytics/answer/1008015?hl=en" rel="noopener ugc nofollow" target="_blank">开始使用分析</a>的说明。之后，你应该会得到一个类似于<code class="fe ns nt nu nv b">&lt;script async src="https://www.googletagmanager.com/gtag/js?id=XXX"&gt;&lt;/script&gt;</code>的谷歌标签脚本。</p><p id="7055" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Dash中使用的HTML组件是pythonic代码。为了合并原始的HTML脚本，我们可以改变应用程序的<code class="fe ns nt nu nv b">index_string</code>组件。您可以直接复制下面的代码，并相应地填写您的Google标记脚本。</p><pre class="kj kk kl km gt nw nv nx bn ny nz bi"><span id="349c" class="oa lv it nv b be ob oc l od oe">app.index_string = """<br/>&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>    &lt;head&gt;<br/>    &lt;!-- Global site tag (gtag.js) - Google Analytics --&gt;<br/>    &lt;script async src="https://www.googletagmanager.com/gtag/js?id=XXX"&gt;&lt;/script&gt;<br/>    &lt;script&gt;<br/>        window.dataLayer = window.dataLayer || [];<br/>        function gtag(){dataLayer.push(arguments);}<br/>        gtag('js', new Date());<br/>        gtag('config', 'XXX');<br/>    &lt;/script&gt;<br/>        {%metas%}<br/>        &lt;title&gt;{%title%}&lt;/title&gt;<br/>        {%favicon%}<br/>        {%css%}<br/>    &lt;/head&gt;<br/>    &lt;body&gt;<br/>        {%app_entry%}<br/>        &lt;footer&gt;<br/>            {%config%}<br/>            {%scripts%}<br/>            {%renderer%}<br/>        &lt;/footer&gt;<br/>    &lt;/body&gt;<br/>&lt;/html&gt;<br/>"""</span></pre><h1 id="43cc" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><p id="9868" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">诚然，我不是Dash方面的专家，也没有受过前端开发的专业训练；我只为我的工作和个人项目构建了一个web应用程序。分享的代码是我很好奇的东西，为了让它们工作，我经历了很多困难。希望这也能让你受益。</p><p id="fc04" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">感谢您的阅读！</strong>如果你喜欢这篇文章，请随意分享。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="b808" class="lu lv it bd lw lx nk lz ma mb nl md me jz nm ka mg kc nn kd mi kf no kg mk ml bi translated">相关链接</h1><p id="280c" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated"><strong class="la iu">我的个人Dash应用</strong>:<a class="ae mx" href="https://kayjan.fly.dev" rel="noopener ugc nofollow" target="_blank">https://Kay Jan . fly . dev</a></p><p id="4f77" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">Plotly Dash-你需要知道的一切</strong>:<a class="ae mx" href="https://medium.datadriveninvestor.com/plotly-dash-everything-you-need-to-know-bc09a5e45395" rel="noopener ugc nofollow" target="_blank">https://medium . datadriveninvestor . com/Plotly-Dash-你需要知道的一切-bc09a5e45395 </a></p></div></div>    
</body>
</html>