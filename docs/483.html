<html>
<head>
<title>Comparing Documents With Similarity Metrics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用相似性度量比较文档</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/comparing-documents-with-similarity-metrics-e486bc678a7d#2022-01-17">https://towardsdatascience.com/comparing-documents-with-similarity-metrics-e486bc678a7d#2022-01-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="e7bc" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">使用相似性度量比较文档</h1></div><div class=""><h2 id="04f8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">自然语言处理中如何利用数学比较文本的初步研究</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fa39b033e9a0e4a52bb1ff12f6947888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D2IBdJ-u-vL3Wf68"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">帕特里克·托马索在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="88df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">评估文档之间的相似性是自然语言处理中的一个常见步骤。它在许多具有信息检索和翻译等功能的微服务中扮演着不可或缺的角色。</p><p id="c074" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">花点时间问问自己:机器首先是如何比较文本的？</p><p id="933c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想为自己利用这些技术，您需要了解一点执行文本比较背后的数学知识。</p><p id="974b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然许多确定文档相似性的微服务非常复杂，并且采用了先进的技术和概念，但是您可以通过首先了解可以量化文本片段之间的相似性的更简单的度量标准，朝着正确的方向迈出一步。</p><p id="2afe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">相似性度量虽然很幼稚，但却是向自己介绍比较文档概念的好方法。在这里，我们探讨两个比较著名的相似性度量:欧几里德距离和余弦相似性。</p><h2 id="6051" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">欧几里得距离</h2><p id="92e1" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">请记住，在NLP中，文本的主体被表示为向量。</p><p id="72f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，从数学的角度来看，比较向量最合适的方法是什么？</p><p id="d2c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">直觉上，比较两个向量之间的距离似乎是最合理的方法。</p><p id="6301" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测量两个向量之间距离的度量是<strong class="ky ir">欧几里德距离。</strong></p><p id="5a08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其公式如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/e13509883464f34aabc9c0eb87887983.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/1*yzsLxjv0uqZ149_nDs6OqQ.gif"/></div></figure><p id="24ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:在Python中，可以使用Sklearn模块的<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.euclidean_distances.html" rel="noopener ugc nofollow" target="_blank"> euclidean_distances </a>函数轻松计算这个度量。</p><p id="9a3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然用这种度量来比较向量可能有意义，但在NLP中使用时，它会引入一个明显的问题。</p><p id="3b40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请看下图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/9b6f1b3a79ed23951142e0968e7722a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*cbE52O3dg04Gxre9cgNbwg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">矢量图(由作者创建)</p></figure><p id="0413" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">向量x和y之间的距离取决于这些向量的大小。在这种情况下，向量x或y的大小增加会导致更大的欧几里德距离。</p><p id="4b9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就NLP而言，这意味着在多样性和频率方面具有更多单词的较大正文文本将比较小正文文本具有更大的量级，即使它们共享相同的主题。</p><p id="9007" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这可能是一个问题，因为比较文档的人对文档的主题比对文本的数量更感兴趣。</p><p id="74db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想想我们已经变得如此依赖的搜索引擎。如果我们在谷歌中搜索“气球”，我们会希望看到与气球最相关的文章。我们不想局限于与查询本身一样长的结果。</p><p id="5963" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，欧几里德距离可能不是文档相似性的最佳度量。</p><p id="a182" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，我们如何在数学上比较文档，同时忽略大小，专注于主题呢？</p><h2 id="9fa0" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">余弦相似性</h2><p id="da65" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">一个学派建议考虑向量之间的角度而不是距离。</p><p id="f5df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">表示为向量的文档可以通过评估两个向量之间的角度来进行比较。</p><p id="bfe3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑两个向量的角度的度量是<strong class="ky ir">余弦相似性度量</strong>。</p><p id="922b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">余弦相似度的公式如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/f5a12b93e5c9f36b99fdb264fdcd2c31.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/1*UusRhODM8SCR0ZZ1mezTJw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">余弦相似度(由作者创建)</p></figure><p id="4b0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">余弦相似性值的范围可以从0到1，0表示最低相似性，1表示最高相似性。</p><p id="5949" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要理解余弦相似性如何胜过欧几里德距离，请看下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/dedcd4bc76cc4365ffcf15e234db59e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*VvIPtbqX32HlfQGVUTvKUw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">矢量图(由作者创建)</p></figure><p id="73ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不管矢量x和y的大小变化多少，矢量x和y之间的角度将保持不变。</p><p id="5f41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着余弦相似性考虑两个向量之间的角度，而不检查向量的大小。这消除了欧几里德距离度量带来的问题。</p><p id="677e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为余弦相似性度量的演示的一部分，考虑以下3个句子:</p><p id="9fa2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我喜欢在炎热的夏天吃冰淇淋。</p><p id="c029" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只有无聊的人才不喜欢吃冰淇淋。</p><p id="3858" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不喜欢在夏天出去，因为天气太热了。</p><p id="e8dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以通过推导这些句子的向量表示之间的角度余弦来评估这些句子之间的相似性。</p><p id="42a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于Sklearn模块的<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html" rel="noopener ugc nofollow" target="_blank">余弦相似度</a>函数，这在Python中很容易实现。</p><p id="43ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们创建一个函数来计算两个给定文本的余弦相似度。这个函数将用TF-IDF算法将给定的句子转换成向量，并计算生成的向量的余弦相似度。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="1b3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用这个函数来确定这三个句子之间的相似度。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/305535168d30116e61633cbcd4bbd269.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*MNY8Hrnsj2A47uk17g04gQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="e601" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基于结果，句子1和2以及句子1和3具有最高的相似度，而句子2和3具有最低的相似度。</p><p id="028c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是有道理的，因为句子1和2都提到了“吃冰淇淋”，而句子1和3都提到了“炎热的夏天”。另一方面，句子2和3实际上没有共享任何主题，因此导致低余弦相似性分数。</p><h2 id="51e1" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/dc01dfa3bcb0c73b4ee9dc976b5139ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9kn_jLaGmB9DVNM0"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@prateekkatyal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">普拉蒂克·卡蒂亚尔</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="cf0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">自然，我们经常依赖的微服务是复杂的，依赖的不仅仅是简单的矢量化和相似性度量。</p><p id="d120" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，如果您掌握了比较文本的简单方法，您将朝着理解NLP中用于文档相似性的更高级技术迈进了一步。</p><p id="33c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我祝你在数据科学的努力中好运！</p></div></div>    
</body>
</html>