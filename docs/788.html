<html>
<head>
<title>Detection of Duplicate Images Using Image Hash Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用图像散列函数检测重复图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/detection-of-duplicate-images-using-image-hash-functions-4d9c53f04a75#2022-01-28">https://towardsdatascience.com/detection-of-duplicate-images-using-image-hash-functions-4d9c53f04a75#2022-01-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="f7e6" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">使用图像散列函数检测重复图像</h1></div><div class=""><h2 id="7500" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python库undouble自动搜索(几乎)相同的照片</h2></div><p id="081b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在整个系统中搜索(几乎)相同的照片可能是一项繁琐的工作；你需要在成千上万的照片中点击，然后决定每张照片是否是一张<em class="le">【相似】</em>的照片。检测重复的最直接的方法是根据文件大小或文件名。然而，照片通常来自不同的来源，如移动设备、社交媒体应用程序，这导致了文件大小、名称以及分辨率、缩放比例、压缩和亮度的差异。<strong class="kk iu"> <em class="le">哈希函数</em> </strong> <em class="le"> </em>由于对微小变化的鲁棒性，是检测(接近)相同照片的理想选择。我将总结一下<em class="le">散列函数</em>的概念，随后是一个实践教程，演示在最小化误报冲突的同时检测重复的步骤。所有结果都是使用<a class="ae lf" href="https://erdogant.github.io/undouble" rel="noopener ugc nofollow" target="_blank"> <em class="le"> Python库undouble </em> </a> <em class="le">导出的。</em></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/ab05e147118aff5b52e15b540bb7d700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7JfsHWbU9DCueBlmDxjLQ.jpeg"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">乔恩·泰森在<a class="ae lf" href="https://unsplash.com/s/photos/photos?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="17f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">如果你觉得这篇文章很有帮助，可以使用我的</em> <a class="ae lf" href="https://medium.com/@erdogant/membership" rel="noopener"> <em class="le">推荐链接</em> </a> <em class="le">继续无限制学习，并注册成为中级会员。另外，</em> <a class="ae lf" href="http://erdogant.medium.com" rel="noopener"> <em class="le">关注我</em> </a> <em class="le">关注我的最新内容！</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="544c" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">视觉相似但数值不同。</h1><p id="f9d2" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">两幅图像可能在视觉上相似，但在数字上不同。数字差异可能由各种原因造成，例如使用社交媒体应用程序可能会改变<em class="le">亮度、对比度、伽马校正、压缩、分辨率和/或缩放比例。</em>例如，使用Whatsapp发送图像会导致分辨率降低(图1)。请注意，减少量可能因设备和用户定义的设置而异。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi na"><img src="../Images/c16a4a928a774060181b0a35a1dc3643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YeGugEdwnEbBDzqLWmWWlA.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图一。视觉上相似但数字不同的照片。a .最左边是源图像。b .中间是用Whatsapp发完之后。c .右图像是两个图像之间的差异。<em class="nb">路易·菲利浦·波伊特拉斯在Unsplash上拍摄的照片</em></p></figure><p id="837d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从视觉角度来看，很难看出<em class="le">源</em>和<em class="le"> Whatsapp </em>图像之间的任何变化，但是当我们减去这两幅图像时，差异就变得很明显了(图1C)。如果你的磁盘上只有几幅图像需要确认的话，选择分辨率最好的图像是很容易的。然而，当你偶尔或者可能每年将你所有的图像转储到磁盘时，这就成了一项耗时的任务，当家人/朋友/同事也与你分享他们<em class="le">几乎相似的</em>时刻时，这就更具挑战性了。</p><blockquote class="nc"><p id="ce7a" class="nd ne it bd nf ng nh ni nj nk nl ld dk translated">问题不是你有没有重复的照片，而是它们在哪里。</p></blockquote><p id="b79e" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr no kt ku kv np kx ky kz nq lb lc ld im bi translated">像按文件大小排序或图像相减这样的方法就会失败。尽管有解决方案；<strong class="kk iu"> <em class="le">哈希函数！</em> </strong> <em class="le">哈希函数</em>对亮度、对比度、伽马校正、压缩、缩放和/或分辨率的微小变化具有鲁棒性，因此非常适合检测(接近)相同的图像。散列函数的使用有很多应用，例如在<em class="le">数字取证</em>、<em class="le">版权强制</em>中，以及更一般的用于<em class="le">磁盘空间减少并因此取消发布。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="1bdc" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">可撤销库搜索重复的图像。</h1><p id="026d" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated"><a class="ae lf" href="https://erdogant.github.io/undouble" rel="noopener ugc nofollow" target="_blank"> <em class="le">可撤销</em>库</a>可用于检测整个系统或任何输入目录中的相同图像。给定输入数据，对图像执行预处理，计算散列，并基于图像散列对图像进行分组。为了在不执行手动操作的情况下组织磁盘上的图像，<em class="le">移动功能</em>将移动相同的图像，但分辨率最大的图像除外(该图像被复制)。所采取步骤的示意图如下所示。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nr"><img src="../Images/7bcdb4f0a96b010119d6f65e8d71be4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EAZ8DXduTLJAnPr2bxBO9w.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在undouble中根据图像哈希对图像进行分组所采取的步骤的示意图。<em class="nb">图片来自作者</em>。</p></figure><p id="7304" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在接下来的部分中，我将更详细地描述预处理步骤、散列函数、分组结果和绘图功能，比如图像散列。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="af09" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">图像哈希函数。</h1><p id="0562" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">哈希函数将输入数据转换或映射为固定长度的字符串，可以看作输入数据的“<em class="le">指纹“</em>或<em class="le">“签名”</em>；<em class="le">图像哈希</em>。因此，一个好的散列函数应该完全由输入数据决定，或者在我们的例子中，由图像决定。哈希函数有很多种，比如；<em class="le">平均哈希、感知哈希、差分哈希、Haar小波哈希、Daubechies小波哈希、HSV颜色哈希、抗裁剪哈希。</em>每个哈希函数都有特定的属性，使其能够抵抗某些变化，如<em class="le">亮度、对比度、伽马、校正、水印、压缩、缩放和灰度变化</em>。</p><blockquote class="nc"><p id="4700" class="nd ne it bd nf ng nh ni nj nk nl ld dk translated">图像哈希函数将图像映射到称为图像哈希的短字符串，可用于图像认证或用作数字指纹。</p></blockquote><p id="ad21" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr no kt ku kv np kx ky kz nq lb lc ld im bi translated">然而，两个视觉上不同的图像 得到相同的图像散列，这被称为<strong class="kk iu"> <em class="le">碰撞</em> </strong>，这是可能发生的。使用101 objects数据集展示了不止一个示例，但是让我们开始评估最著名的哈希函数的健壮性。通过改变单幅图像的<em class="le">亮度(-50%、-20%、+20% +50%)、对比度(-50%、-20%、+20% +50%)、缩放和压缩(png、jpg) </em>来评估鲁棒性。总共为“<em class="le">猫和狗”</em>图像(图2)创建了10种不同的变化。请注意，这不会评估<em class="le">冲突</em>，而是评估不同哈希函数的亮度和对比度的影响。所有哈希函数都使用python <a class="ae lf" href="https://erdogant.github.io/undouble" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="le">库undo double</em></strong></a>进行评估，该库依次使用图像哈希库<a class="ae lf" href="https://github.com/JohannesBuchner/imagehash" rel="noopener ugc nofollow" target="_blank"><em class="le">image hash</em></a><em class="le">【3】</em>的功能。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nr"><img src="../Images/6307e60d1202a308d71381235883f7bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zzQ4JooDUrE79es05Xxg5w.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图二。亮度和对比度变化的四个例子。<em class="nb">路易·菲利浦·波伊特拉斯在Unsplash上拍摄的照片</em></p></figure><h1 id="d126" class="md me it bd mf mg ns mi mj mk nt mm mn jz nu ka mp kc nv kd mr kf nw kg mt mu bi translated">计算哈希之前的预处理。</h1><p id="eddc" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">在我们能够确定图像散列之前，需要预处理步骤；<em class="le"> 1。脱色，2。归一化像素值，以及3 .缩放图像</em>。脱色的原因是“识别”图像所需的信息很容易出现在灰度通道中。此外，从RGB的每像素24位减少到每像素8位在计算上更有吸引力；在时间和记忆方面。下一步是将图像向下采样/缩放到更小的尺寸。大多数情况下，选择64位哈希，这仅仅意味着图像被下采样为8 x 8像素。下面是一个示例，展示了如何使用Python为各种哈希函数导出图像哈希。</p><pre class="lh li lj lk gt nx ny nz oa aw ob bi"><span id="8e2a" class="oc me it ny b gy od oe l of og">pip install undouble</span></pre><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">演示计算图像散列和创建绘图的示例。</p></figure><h1 id="1db9" class="md me it bd mf mg ns mi mj mk nt mm mn jz nu ka mp kc nv kd mr kf nw kg mt mu bi translated">平均哈希。</h1><p id="c73b" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">在脱色和缩放步骤<em class="le">、</em>之后，将每个像素块与图像的所有像素值的平均值(顾名思义)进行比较。在下面的例子中，我们将生成一个64位散列，这意味着图像被缩放到8×8像素。如果像素块中的值大于平均值，则得到值1(白色)，否则得到值0(黑色)。图像散列是通过将二进制数组展平成向量来创建的。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oj"><img src="../Images/8b10b87f6e64fc660cc0a560999417c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4SNz46yMDCHRU865KGXIrQ.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图二。镜像哈希二进制:11111111111101111110011100000011000000011111000011111111111。图片由作者提供。</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ok"><img src="../Images/f75c0e863fb505485dd90ff8351974eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iX4A8v7vpajRTYOtv2Lw1g.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图3。10个更改图像的平均哈希。</p></figure><p id="4459" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们对10个被修改的图像运行<em class="le">平均哈希函数</em>，我们可以看到<em class="le">图像哈希</em>非常稳定，只有微小的差异(图3)。只有在亮度增加50%的情况下，图像哈希才开始出现偏差。在所有组合中，图像散列平均有2.1个变化。</p><h1 id="5be1" class="md me it bd mf mg ns mi mj mk nt mm mn jz nu ka mp kc nv kd mr kf nw kg mt mu bi translated">感性杂凑。</h1><p id="281b" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">感知散列函数仅从图像脱色开始，然后应用离散余弦变换(DCT );首先是每行，然后是每列。高频像素现在被裁剪为8 x 8像素。然后将每个像素块与图像的所有灰度值的中值进行比较。如果像素块中的值大于中值，则得到值1，否则为0。最终图像散列之后是将二进制数组展平成向量。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ol"><img src="../Images/a7a6c21b74473c13a2577b493b09d69b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YjyJCy5LV7cqGItXAKVb5A.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图4。<em class="nb">感性</em>-哈希:111010101100011010100110110111011001000110110000011011011000001010。图片由作者提供。</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ok"><img src="../Images/48d50f6e969f8f183b45bc0caebb17b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ovvl2wDi8P2boU95zaCakg.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图5。<em class="nb">感知</em>对于10个被改变的图像。图片由作者提供。</p></figure><p id="1b5d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们对10张图像运行<em class="le">感知哈希函数</em>并进行一些修改，就可以检测到图像哈希中的各种微小差异(图5)。在亮度增加50%的情况下，图像散列开始更加偏离。在所有组合中，图像散列平均有4次变化。</p><h1 id="3164" class="md me it bd mf mg ns mi mj mk nt mm mn jz nu ka mp kc nv kd mr kf nw kg mt mu bi translated">差异哈希。</h1><p id="7e74" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">在脱色和缩放<em class="le">、</em>步骤之后，像素被连续地(每行从左到右)与其右边的相邻像素进行比较。如果位置x处的字节小于位置(x+1)处的字节，则得到值1，否则为0。最终图像散列之后是将二进制数组展平成向量。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oj"><img src="../Images/0b65abee6fb6f349449eb19bf8dfaf61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlZ9jwoyFDJXEQA4DPieFQ.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图6。镜像哈希:000111100001100110011001100011000010010100010001000010110000001。图片由作者提供。</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ok"><img src="../Images/44ceb76556a2d7fa389f3d505541189c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oDj-GoeMewprFX6fAnKIw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图7。<em class="nb">10张更改图像的差异哈希</em>。图片由作者提供。</p></figure><p id="0ce8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们对10张图像运行<em class="le">差异哈希函数</em>，并做一些修改，图像哈希会产生一些小的变化(图7)。50%亮度的增加显示了最大的差异。在所有组合中，图像散列平均有3.8次变化。</p><h1 id="576d" class="md me it bd mf mg ns mi mj mk nt mm mn jz nu ka mp kc nv kd mr kf nw kg mt mu bi translated">哈尔小波哈希。</h1><p id="cc3b" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">在脱色和缩放步骤<em class="le">、</em>之后，对图像应用二维小波变换。然后将每个像素块与图像的所有灰度值的中值进行比较。如果像素块中的值大于中值，则得到值1，否则为0。最终的图像散列之后是将数组展平成向量。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oj"><img src="../Images/54f50496733d83cfbd8bd2e7f06a85a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o6Zp-Z-9O6jOSD-Uj6fi2g.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图8。镜像哈希:111001111110110111001110000001000000010000001110000011111111101。图片由作者提供。</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ok"><img src="../Images/cc1b4c04f214365283fab022c001701c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXJKXRjs_JurlpFhNGx1qw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图9。<em class="nb"> haar小波哈希</em>用于10幅修改后的图像。图片由作者提供。</p></figure><p id="6bf1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们比较10个被改变的图像的图像散列，我们可以看到<em class="le"> haar小波散列</em>是相当稳定的，尽管在被改变的图像上有一些微小的变化。在所有组合中，图像散列平均有2.5个变化。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="ea97" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">在真实数据集中查找相同的图像。</h1><p id="c0ef" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">为了演示各种散列函数在真实数据集上的性能，我使用了<a class="ae lf" href="http://www.vision.caltech.edu/Image_Datasets/Caltech101/101_ObjectCategories.tar.gz" rel="noopener ugc nofollow" target="_blank"> <em class="le">加州理工学院101</em></a><em class="le"/>【2】数据集，并将其保存到我的本地磁盘。针对<em class="le"> aHash、pHash、dHash、</em>和<em class="le">小波哈希检查重复的检测。</em><em class="le">加州理工</em>数据集包含9144张属于101个类别的真实世界图像。大约40至800每类图像。每个图像的大小大约为300 x 200像素。<a class="ae lf" href="https://erdogant.github.io/undouble" rel="noopener ugc nofollow" target="_blank"> <em class="le">可撤销库</em> </a> <em class="le"> </em>的输入可以简单地是存储所有图像的<em class="le">目录位置</em>。所有子目录也将被递归分析。请注意，该数据集不包含相同图像的地面实况标签。因此，我将直观地检查分组的所有结果，并描述每个散列函数的结果。</p><pre class="lh li lj lk gt nx ny nz oa aw ob bi"><span id="67ac" class="oc me it ny b gy od oe l of og">pip install undouble</span></pre><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在101对象数据集中检测具有相同图像散列的图像的示例。</p></figure><p id="adfc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">平均哈希</em> </strong>功能检测到135个组，这些组可以链接到具有相同哈希(阈值=0)的335个图像，基于输入哈希大小8 (64位)。尽管检测到相同的图像，但大多数组显示了碰撞，如左上角和左下角，和/或几乎相同的图像，如摩托车(图11)。通过将散列大小增加到16 (256位)，检测到64个图像的28个组。<strong class="kk iu"> <em class="le">没有碰撞出现，但是检测到近乎相同的图像</em> </strong>，比如摩托车。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi om"><img src="../Images/73925412f57a441e0b4f7ec7667094fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Wk1nXeCfA2KWtJ2a0YN6Q.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图11。平均哈希在335个具有相同哈希的图像中检测到135个组。碰撞和几乎相同的图像出现在几乎所有的组中。图片由作者提供。</p></figure><p id="9e8f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">小波哈希</em> </strong>功能检测到141个组，根据输入哈希大小8 (64位)，这些组可以链接到具有相同哈希(阈值=0)的513个图像。目测显示，几乎所有组都包含碰撞或几乎相同的图像(图12)。谁知道草莓会有和摩托车相似的图片呢？通过将散列大小增加到16 (256位)，检测到51个图像的25个组。<strong class="kk iu"> <em class="le">未出现碰撞，但检测到近乎相同的图像</em> </strong>，如摩托车。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi on"><img src="../Images/42be8b4eca5f2ef3e3aaa24ad1cb42b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Sau8g21PDAgbGwbLKkw8Q.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图12。小波哈希检测到513个具有相同哈希的图像的141组。几乎每一组都包含了一幅几乎完全相同的图像。图片由作者提供。</p></figure><p id="f83a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">差分哈希</em> </strong>功能检测到28个图像可以链接到具有相同哈希(阈值=0)的31个图像。视觉检查显示没有碰撞，但检测到几乎相同的图像(两辆摩托车)。通过将散列大小增加到16 (256位)，检测到16个图像的8个组。没有碰撞出现，但只有一些几乎相同的图像，如摩托车。通过将散列大小增加到16 (256位)，检测到16个图像的8个组。<strong class="kk iu"> <em class="le">没有碰撞，也没有检测到近似相同的图像</em> </strong>，所有图像在视觉上都是相似的。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oo"><img src="../Images/8b69733354634772f66be44f2dfc4443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mIA0g6VRfpfn30YCIXlbEQ.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图13。差分哈希检测到28组31个图像具有相同的哈希。没有观察到碰撞，只有一个图像几乎相同(摩托车)。图片由作者提供。</p></figure><p id="6c35" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">感知哈希</em> </strong>功能检测到38个组，这些组可以链接到具有相同哈希(阈值=0)的41个图像。视觉检查显示没有碰撞，但是检测到几乎相同的图像，例如摩托车，如图14所示。通过将散列大小增加到16 (256位)，检测到20个图像的10个组。<strong class="kk iu"> <em class="le">没有检测到碰撞和几乎相同的图像</em> </strong>，所有图像在视觉上都是相似的。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi op"><img src="../Images/4b0fe73c06332c0cdfa6285344d36304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XzO07ER0VCwwzE-YHqTMhQ.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图14。感知散列检测到具有相同散列的41个图像的38个组。没有观察到碰撞，但是在4组中出现了几乎相同的图像。图片由作者提供。</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="85b2" class="oc me it bd mf oq or dn mj os ot dp mn kr ou ov mp kv ow ox mr kz oy oz mt pa bi translated">结论。</h2><p id="a3a5" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">在<em class="le">猫和狗图像</em>实验的情况下，每个哈希函数的结果都相当稳定。然而，当我们使用真实世界的数据集时，很明显，散列大小为8 (64位)会导致<em class="le">平均散列</em>和<em class="le">小波散列的许多冲突。</em>此外，它还集合了许多近乎相同的图像。<em class="le">差分散列</em>的结果是准确的，但也是最保守的。另一方面，<strong class="kk iu">的<em class="le">感知哈希</em>也显示了准确的结果，但不那么保守。</strong>当哈希大小增加到16 (256位)时，没有哈希函数导致冲突，但是对于<em class="le">平均哈希</em>和<em class="le">小波哈希</em>检测到几乎相同的图像。<em class="le">感知哈希</em>和<em class="le">差分哈希</em>都没有显示冲突或几乎相同的图像。这里再次说明，<em class="le">感知哈希</em>不那么保守。</p><blockquote class="nc"><p id="fa51" class="nd ne it bd nf ng nh ni nj nk nl ld dk translated">感知哈希对于重复图像的检测最为准确<em class="nb">。</em></p></blockquote><p id="a94c" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr no kt ku kv np kx ky kz nq lb lc ld im bi translated">此外，结果还可能取决于输入图像的类型。当图像有一个坚实的背景，如摩托车和交通标志，碰撞会更经常发生。原因之一是二进制像素信息表征了图像，并且形成的图像散列变得不那么唯一。例如，使用<em class="le">平均哈希</em>和<em class="le">小波哈希</em>可以很容易地得到一个相同的图像哈希。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="affe" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">哈希函数还是聚类？</h1><p id="0e52" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">哈希函数和聚类方法旨在对相似的图像进行分组，但还是有区别的。哈希函数将创建图像的“<em class="le">指纹“</em>或“<em class="le">”签名“</em>”；图像哈希。两个相同的图像散列应该代表两个相同的图像。在聚类的情况下，提取特征，选择距离度量和链接类型，最后，图像被聚类。采取不同的步骤和/或方法将产生不同的分组，因为它隐含地对数据施加了结构，从而对样本进行了划分。或者换句话说，有更多的自由度来定义“相似”图像。</p><blockquote class="nc"><p id="8788" class="nd ne it bd nf ng nh ni nj nk nl ld dk translated">哈希函数旨在创建可用于检测相同图像的唯一签名，而聚类方法旨在检测相似图像组。</p></blockquote><p id="13fe" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr no kt ku kv np kx ky kz nq lb lc ld im bi translated">为了比较散列函数和聚类得出的结果，我将使用相同的<em class="le"> 101对象</em>数据集并执行聚类方法。<a class="ae lf" href="https://erdogant.github.io/clustimage" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="le"> clustimage库</em></strong>【5】</a>用于对仅给出路径位置作为输入的图像进行聚类。子目录中的所有图像都被递归收集。使用默认设置和PCA方法，检测到63个最佳聚类(图15 ),其中显示了聚类的质心图像。尽管一些聚类包含具有高相似性的图像(图15D)，但是图像不一定是相同的或接近相同的。如果你想了解更多关于图像聚类的知识，请阅读这篇博客。</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="oh oi l"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">对101对象数据集进行聚类的示例。</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi pb"><img src="../Images/e724c4b65702f6cf3d522baaef885bc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*exc-qkkwuxLvukat7E_Xvw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">图15。Caltech101数据集[2] <a class="ae lf" href="http://www.vision.caltech.edu/Image_Datasets/Caltech101/101_ObjectCategories.tar.gz" rel="noopener ugc nofollow" target="_blank">下载链接</a>。a .轮廓分数在63个聚类处检测到最佳值。b .使用检测到的聚类标签对样本进行着色的tSNE嵌入。c .并非所有聚类都产生高度相似的图像。在群集13中检测到的图像主要是钢琴的图像。图片由作者提供。</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="ded0" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">最后的话。</h1><p id="13f7" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">我提到了用于检测(几乎)相同图像的<em class="le">散列函数</em>的概念。<strong class="kk iu"> <em class="le">建议使用感知哈希函数</em> </strong>检测重复图像。使用<a class="ae lf" href="https://erdogant.github.io/undouble" rel="noopener ugc nofollow" target="_blank"> <em class="le"> undouble </em>库</a>可以相对简单地检测整个系统或目录中(几乎)相同的映像。它管道化了图像预处理(灰度化、归一化和缩放)、计算图像散列以及基于图像散列差异对图像进行分组的过程(图10)。阈值为0将对具有相同图像哈希的图像进行分组。然而，当取消发布我的个人照片库时，阈值10显示了最佳结果，因为照片(如连拍的照片)也被分组。使用绘图功能可以轻松查看结果，使用<em class="le">移动</em>功能可以显示图像。在移动图像的情况下，具有最高分辨率的组中的图像将被复制，并且所有其他图像被移动到“undouble”子目录中。如果您需要更多关于图像分组的灵活性和自由度，我推荐您阅读这篇关于图像聚类的<a class="ae lf" rel="noopener" target="_blank" href="/a-step-by-step-guide-for-clustering-images-4b45f9906128">博客</a>【4】，它描述了使用<a class="ae lf" href="https://erdogant.github.io/clustimage" rel="noopener ugc nofollow" target="_blank"> clustimage库</a>【5】进行图像聚类。</p><p id="ea09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">注意安全。保持冷静。</em></p><p id="2224" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">欢呼e .</em>T21】</strong></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="87dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">如果你觉得这篇文章很有帮助，可以使用我的</em> <a class="ae lf" href="https://medium.com/@erdogant/membership" rel="noopener"> <em class="le">推荐链接</em> </a> <em class="le">继续无限制学习，并注册成为中级会员。另外，</em> <a class="ae lf" href="http://erdogant.medium.com" rel="noopener"> <em class="le">关注我</em> </a> <em class="le">保持我的最新内容！</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="ff19" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">软件</h1><ul class=""><li id="c4c7" class="pc pd it kk b kl mv ko mw kr pe kv pf kz pg ld ph pi pj pk bi translated"><a class="ae lf" href="https://erdogant.github.io/undouble" rel="noopener ugc nofollow" target="_blank">不可置疑的Github/文档</a></li><li id="b9fe" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld ph pi pj pk bi translated"><a class="ae lf" href="https://erdogant.github.io/clustimage" rel="noopener ugc nofollow" target="_blank">Clustimage Github/文档</a></li></ul><h2 id="a642" class="oc me it bd mf oq or dn mj os ot dp mn kr ou ov mp kv ow ox mr kz oy oz mt pa bi translated">我们连线吧！</h2><ul class=""><li id="ff1c" class="pc pd it kk b kl mv ko mw kr pe kv pf kz pg ld ph pi pj pk bi translated"><a class="ae lf" href="https://www.linkedin.com/in/erdogant/" rel="noopener ugc nofollow" target="_blank">我们在LinkedIn上连线</a></li><li id="73b8" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld ph pi pj pk bi translated"><a class="ae lf" href="https://github.com/erdogant" rel="noopener ugc nofollow" target="_blank">在Github上关注我</a></li><li id="22f4" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld ph pi pj pk bi translated"><a class="ae lf" href="https://erdogant.medium.com/" rel="noopener">在Medium上跟随我</a></li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2849" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">参考</h1><ol class=""><li id="c501" class="pc pd it kk b kl mv ko mw kr pe kv pf kz pg ld pq pi pj pk bi translated">Taskesen，E. (2022)。检测(接近)相同图像的Python库。【电脑软件】。</li><li id="db2d" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld pq pi pj pk bi translated">长度飞飞，r .弗格斯和p .佩罗娜。<em class="le"> </em> <a class="ae lf" href="http://www.vision.caltech.edu/Image_Datasets/Caltech101/#Download" rel="noopener ugc nofollow" target="_blank"> <em class="le">从少数训练实例中学习生成视觉模型<br/>:在<br/> 101个对象类别</em>上测试的增量贝叶斯方法。</a> IEEE。CVPR 2004，基于生成模型<br/>的视觉研讨会。2004</li><li id="6095" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld pq pi pj pk bi translated"><a class="ae lf" href="https://github.com/JohannesBuchner/imagehash" rel="noopener ugc nofollow" target="_blank">https://github.com/JohannesBuchner/imagehash</a></li><li id="5c58" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld pq pi pj pk bi translated">Taskesen，E. <a class="ae lf" rel="noopener" target="_blank" href="/a-step-by-step-guide-for-clustering-images-4b45f9906128"> <em class="le">图像聚类的分步指南。</em> </a>走向数据科学，2021。</li><li id="1f46" class="pc pd it kk b kl pl ko pm kr pn kv po kz pp ld pq pi pj pk bi translated">Taskesen，E. (2021)。<a class="ae lf" href="https://erdogant.github.io/clustimage" rel="noopener ugc nofollow" target="_blank"> Python包clustimage用于图像的无监督聚类。</a>【电脑软件】。<a class="ae lf" rel="noopener" target="_blank" href="/a-step-by-step-guide-for-clustering-images-4b45f9906128">https://towards data science . com/a-step-by-step-step-guide-for-clustering-images-4b 45 f 9906128</a></li></ol></div></div>    
</body>
</html>