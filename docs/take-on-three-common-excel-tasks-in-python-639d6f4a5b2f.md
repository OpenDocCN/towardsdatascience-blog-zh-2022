# 在 Python 中承担三个常见的 Excel 任务

> 原文：<https://towardsdatascience.com/take-on-three-common-excel-tasks-in-python-639d6f4a5b2f>

## 让迁移到 Python 变得稍微容易一点

![](img/dddb3b57d36ce44299a7befe7296e706.png)

[微软 365](https://unsplash.com/@microsoft365?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

从 Excel 迁移到 Python 可能会令人望而生畏——但不一定如此！本教程将指导你完成你在 Excel 中习惯的三个常见任务，并向你展示如何用 Python 和 Pandas 来完成它们。

本教程结束时，您将学会如何:

*   写 IF()函数在熊猫、
*   复制文本到列的功能，以及
*   向数据中添加汇总行

我们将假设您知道如何使用 Pandas 读取 Excel 文件。如果你还没到那一步，不要担心，看看这个教程。为了使事情简单一点，让我们假设我们正在使用下面的数据框架:

加载样本熊猫数据帧

# 编写 IF 函数

我们先来看看熊猫里的 IF()函数怎么写。有很多方法可以解决这个问题，但是让我们来看看如何使用列表理解来完成这个任务。

看看下面的理解，它检查总数是否超过 100，并基于此指定一个新列。

在上面的代码中，我们编写了一个 list comprehension，它循环遍历我们的 Total 列，如果值超过 100，则返回 Yes，否则返回 No。

# 文字分列

在这一节中，让我们探索如何复制文本到列特性。该功能允许您根据分隔符将文本分成多列。谢天谢地，熊猫让这变得很容易！

让我们看看下面的代码:

在上面的代码中，我们根据分隔符`', '`将位置列分成两列。让我们来看看这是如何工作的:

1.  我们一次分配两列(注意我们是如何使用双方括号的)
2.  然后，我们应用 string split()函数来拆分文本
3.  我们使用`expand=True`参数让 Pandas 知道我们想要将结果列表分成多列

# 添加汇总行

在这最后一节中，让我们看看如何向我们的 Pandas 数据帧添加一个总计行。我们可以通过使用`.loc`访问器来分配一个新行。我们可以将单词 Total 分配给 Name 列，并将 Total 列中的值相加:

请记住，这样做时，我们实际上是在修改原始数据帧。最好将它用于报告层，记住这可能会对下游产生更多影响。

# 结论

在本教程中，您学习了如何使用 Pandas 在 Python 中复制三个常见的 Excel 函数。您首先学习了如何复制 IF 函数。然后，您学习了如何使用文本转列功能。最后，您学习了如何向数据中添加汇总行。