# 当 SQL 仓库遇到探索性分析

> 原文：<https://towardsdatascience.com/when-sql-warehouse-meets-exploratory-analysis-dd74c7812225>

## 探索更快的选项

![](img/469eb52f2350c853ff49662fc7f21706.png)

由 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的 [Venti Views](https://unsplash.com/@ventiviews?utm_source=medium&utm_medium=referral) 拍摄的照片

在现代数据栈时代，云 SQL 仓库对于数据从业者来说并不陌生。Snowflake、BigQuery 和 Redshift 等主要公司已经帮助数千家企业简化了他们的数据基础架构。人们用它们来

1.  在表中接收和存储数据。
2.  运行查询和作业来转换数据。
3.  通过消费数据构建应用或获得洞察力。

总的来说，所有流行的 SQL 仓库在成本效益方面都做得很好，适用于任何规模的企业，它们都设计有云原生功能，包括但不限于:

*   **连接** — it 可以连接数千个云服务，为客户构建端到端的解决方案，包括 ETL/ELT、云功能和数据分析/BI 工具。
*   **弹性** —它可以根据实际需要独立、动态地扩展存储和计算。
*   **可用性** —它构建强大可靠的软件，并为不想接受不必要挑战的所有客户重复使用，客户以超低成本享受高可用性。

# 使用 SQL 仓库的最终目的

信不信由你，无论基础设施构建得多么复杂，人们使用 SQL warehouse 的最终目的都很简单— **获得洞见**！

*   对人而言:对你的业务建立更好的理解。
*   对于产品/服务:建立更好的 API 或 AI 模型！

获得洞察力也经常被称为最后一英里价值，人们使用它来进行沟通，以做出更好的数据驱动的决策。为了向你的听众传达一种“洞察力”，你需要经历这些步骤，并且做得很好:

1.  洞察力的发现:这通常也被称为探索性分析。这就像金矿开采，如果配备了智能和快速的工具，你应该可以轻松获得它们。
2.  **洞见的讲故事**在短时间内将你从专家角度的理解简洁地传递给你的听众的理解。
3.  **洞察力的沟通**:以故事的形式向你的听众分享和展示“洞察力”,可以是会议中的 PPT，也可以是聊天应用中分享的卡片。

如你所见，更好的沟通是我们为人们所做的所有数据工作的核心价值。

# SQL 仓库遇到探索性分析时的问题

正如我们前面所讨论的，现代 SQL 仓库总体来说很棒，但是在最后一英里中不如“获得洞察力”部分好，为什么呢？

以下是一些观察结果:

*   **接口:**为了简单起见，通常 SQL 是与一个仓库进行交互的标准接口，当然这也是为什么叫 SQL 仓库的原因。然而，探索性分析喜欢直观的 UI，支持切片和切块的快速交互迭代。
*   **速度:**他们的基础架构针对“大规模”进行了优化，处理的数据量越多(例如大型连接)，节省的成本就越多。类似地，它服务的客户端越多，它提供的效率就越高，因此这些查询通常很慢。然而，探索性分析喜欢挖掘同一个数据集，用户不应该等待任何改变。
*   **成本:**迭代大型慢速查询不仅耗时，而且费用昂贵，你的账单通常是按“时间*资源”计算的，重复同样的昂贵查询，只有微小的变化，会很快堆积你的账单。

随着时间的推移，我希望 SQL warehouse 在探索性分析方面会有所改进，但目前还不是很好。

# 改进的选项

差距现在很明显:SQL warehouse 擅长大数据处理，比如大连接，这是一个高资源消耗的操作，从调度，以及资源分配到作业执行。然而，探索性分析大部分时间集中在单个立方体上，它需要具有亚秒周转的交互式用户体验。

那么我们如何解决这个问题呢？

关键是避免昂贵的部分被重复执行。根据关键点，根据哪一方付出努力，至少有 3 个分类选项:

1.  **用户**:创建一个中间表，用于探索性分析的钻取。
2.  **仓库**:透明缓存每一步的结果，尽可能重用缓存。
3.  **第三方**:将探索性分析功能与数据建模功能分开，让各方负责一件事。事实上，一些现有的 BI 工具提供了这种类型的功能，例如 PowerBI 服务。

利弊很容易辨别:

选项 1 要求用户成为专家，因此维护负担落在用户身上，如果他们已经为服务付费，谁还想要更多的工作呢？

选项 2 的实现和运行成本都很高，尤其是当用户行为不可预测时，虽然我相信仓库供应商有动机，但它可能永远不会成为他们路线图中的优先事项。

选项 3 似乎是解决这个问题的最有希望的方法，责任分离很好，钻井体验也很棒。

# 案例研究:SQL 数据仓库的瞬间探索

让我们以[列](https://columns.ai)为例来展示分布式中间层是如何帮助我们的。

在这种情况下，我们在任何数据上构建一个统一的分析 API，它包括一个与主要 SQL 仓库(如雪花)一起工作的数据模型。它的分布式查询引擎使得探索性分析总是在不到一秒的时间内得到回答，即使有数十亿行。

这个[视频](https://www.loom.com/share/dd9ea4cc0f9c4bc7ba11bf628b4d17aa)展示了一个演示，展示了当我们将探索性分析从 SQL 数据模型中分离出来时的体验。

我希望这篇文章有助于带来新的想法。感谢阅读！