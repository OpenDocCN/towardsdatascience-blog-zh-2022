<html>
<head>
<title>Fuzzy String Matching — How To Match Strings That Aren’t Identical</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模糊字符串匹配—如何匹配不同的字符串</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fuzzy-string-matching-how-to-match-strings-that-arent-identical-a686d2d59eac#2022-01-20">https://towardsdatascience.com/fuzzy-string-matching-how-to-match-strings-that-arent-identical-a686d2d59eac#2022-01-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="92b4" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">模糊字符串匹配—如何匹配不同的字符串</h1></div><div class=""><h2 id="922b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">人类思维很容易注意到接近但不完美的匹配——这就是Python的工作方式。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b902188ec26af9028065b743c5196a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKSkeYY3octx9kiFKkDylg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">梅尔·普尔在<a class="ae ky" href="https://unsplash.com/s/photos/string?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="9dd0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="1fa9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本教程中，您将学习如何近似匹配字符串，并通过查看各种示例来确定它们的相似程度。</p><p id="ceee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我将在最后提供一个函数，您可以使用它将一个列表与另一个列表进行匹配，尽管它们可能没有完全相同的匹配。</p><p id="422d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您是否曾经想要比较引用同一事物的字符串，但它们的书写略有不同，有拼写错误或拼写错误？这是一个经常出现的问题。在大多数没有ID的数据集中，您将根据名称进行匹配，如果这些名称拼错了，那就有问题了。</p><p id="2232" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">以下是修复方法。</p><h1 id="f0d8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">莱文斯坦距离</h1><p id="cc3e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">简而言之，<a class="ae ky" href="https://en.wikipedia.org/wiki/Levenshtein_distance" rel="noopener ugc nofollow" target="_blank"> Levenshtein距离</a> (LD)是一种度量两个序列或字符串之间差异的标准。通俗地说，LD是将一个序列转换成另一个序列所必须进行的单独编辑的次数。编辑可以是<em class="ms">插入、删除或替换</em>。它以苏联数学家<a class="ae ky" href="https://en.wikipedia.org/wiki/Vladimir_Levenshtein" rel="noopener ugc nofollow" target="_blank"> Vladimir Levenshtein </a>的名字命名，</p><p id="58d1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，以下是一些示例的LD:</p><ul class=""><li id="3b10" class="mt mu it lt b lu mn lx mo ma mv me mw mi mx mm my mz na nb bi translated"><em class="ms">卡爪&gt;卡爪</em> ( <strong class="lt iu"> 1 </strong> —插入‘s’)</li><li id="eabc" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated"><em class="ms">卡爪&gt;卡爪</em>(<strong class="lt iu">2</strong>-插入‘s’并用‘D’替换‘D’)</li><li id="1181" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated">狗&gt;猫(<strong class="lt iu"> 3 </strong> -三个字母都被替换)</li></ul><p id="494c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是来自维基百科的正式方程式，相对简单。如您所见，“D”与“D”不同，标点符号也被视为需要删除的字符。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/4fab7234225f51cc97c883c0fd235ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q1FVi-3g_5sLrhAurlCeLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">【https://en.wikipedia.org/wiki/Levenshtein_distance T4】</p></figure><p id="19fd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">直觉上(<em class="ms">我的意思是，在维基百科上阅读它们之后，它们在逻辑上对我来说是有意义的</em>)LD有一些上限和下限。以下是一些进一步解释的定义。</p><ul class=""><li id="15f2" class="mt mu it lt b lu mn lx mo ma mv me mw mi mx mm my mz na nb bi translated">它至少是两个字符串大小的差异(<em class="ms">至少是必须进行的加法的数量)。</em></li><li id="c2df" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated">它至多是较长字符串的长度(<em class="ms">即使其中一个字符串的长度为零，也只需要增加与最大字符串的长度相等的长度)。</em></li><li id="aa3f" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated">当且仅当字符串相等时为零<em class="ms">(这需要解释吗？)</em></li><li id="952a" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated">如果字符串具有相同的大小，则<a class="ae ky" href="https://en.wikipedia.org/wiki/Hamming_distance" rel="noopener ugc nofollow" target="_blank">汉明距离</a>是Levenshtein距离的上限。汉明距离是两个字符串中对应符号不同的位置的数量。<em class="ms">(这相当于最少换人次数)</em></li><li id="6ef1" class="mt mu it lt b lu nc lx nd ma ne me nf mi ng mm my mz na nb bi translated">两个字符串之间的Levenshtein距离不大于它们与第三个字符串之间的Levenshtein距离之和(<a class="ae ky" href="https://en.wikipedia.org/wiki/Triangle_inequality" rel="noopener ugc nofollow" target="_blank">三角形不等式</a>)。<em class="ms">(即使你让第一串和第三串尽可能的靠近，这也是成立的——试着用['猫'，'狗'，' At']举例)</em></li></ul><p id="7d62" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">由此，我们还可以计算Levenshtein比率(LR ),根据LD创建相似性比率。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/f7324fba6854a57d5727566804ec5677.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*Yn5hUDOCwfXWaveKS_xLWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="f553" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中a和b的绝对值分别是a和b的长度。</p><p id="8cef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，这就是你需要知道的关于Levenshtein测度的全部内容。下面是一些python的例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创作作者:<a class="ae ky" href="https://gist.github.com/jasher4994/d06ea3e88461978ede2aaa0fcfa633e0" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/ja sher 4994/d 06 ea 3 e 88461978 ede 2 AAA 0 fcfa 633 e 0</a></p></figure><p id="1d07" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是输出结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/9310d57c62c63de462909bb7e91870f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*6yARp-IfJ-kEnpf8MsKIrw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">VS作者的代码输出。</p></figure><p id="7dfd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如你所看到的，这工作得很好，但有同音异义词的问题，这取决于你使用它的上下文。如果你只需要一段将来可以使用的代码片段，你可以在这里找到:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创作作者:<a class="ae ky" href="https://gist.github.com/jasher4994/f43cba274232e1cf6db36943089e93c4" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/ja sher 4994/f 43 CBA 274232 E1 cf 6 db 36943089 e 93 c 4</a></p></figure><h1 id="9a69" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">模糊不清的包裹</h1><p id="0581" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">长话短说，FuzzyWuzzy (FW)包做了Levenshtein包所做的一切，但更多。Levenshtein包是一个很好的介绍，但是您最好在几乎所有情况下都使用FW包。</p><p id="0252" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">简单LD的FW输出完全相同，调用方式也完全相同，输出也完全相同。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创作作者:<a class="ae ky" href="https://gist.github.com/jasher4994/27be17f32f6b79cd19d634eb30e7706e" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/jasher 4994/27be 17 f 32 f 6b 79 CD 19d 634 EB 30 e 7706 e</a></p></figure><p id="cdf1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是这个令人眼花缭乱的软件包真正发挥作用的地方是它还能做什么。</p><h2 id="fd0c" class="nm la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">子串匹配</h2><p id="10df" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">该包可以匹配子字符串:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="e1bf" class="nm la it nz b gy od oe l of og">Str1 = "FC Barcelona" Str2 = "Barcelona"<br/>Partial_Ratio = fuzz.partial_ratio(Str1.lower(),Str2.lower())</span></pre><h2 id="4369" class="nm la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">令牌排序</h2><p id="b766" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">它还可以匹配逆序的字符串:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="77a7" class="nm la it nz b gy od oe l of og">Str1 = "FC Barcelona" Str2 = "Barcelona FC"<br/>Token_Sort_Ratio = fuzz.token_sort_ratio(Str1,Str2)Token set ratio</span></pre><h2 id="1f88" class="nm la it bd lb nn no dn lf np nq dp lj ma nr ns ll me nt nu ln mi nv nw lp nx bi translated">令牌集</h2><p id="82e2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">以及相似但长度相差很大的字符串:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="206a" class="nm la it nz b gy od oe l of og">Str1 = "FC Barcelona" Str2 = "The victory went to FC Barcelona "<br/>Token_Set_Ratio = fuzz.token_set_ratio(Str1,Str2)</span></pre><h1 id="cec4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">模糊过程</h1><p id="6743" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对我来说，这是最有用的部分。你可以为所有可能的匹配计算一个分数，然后选择最大的——或者让FW为你做。所以我创建了一个简单的函数来做这件事，同时检查它是否成功。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="eb73" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以在这里，函数做它在tin上所说的。它接受两个列表作为输入，第一个是您试图从第二个匹配的列表。例如，第一个列表可能是某人在输入框中输入的公司列表，第二个列表可能是实际的公司名称。</p><p id="7ea6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该函数使用FW中的extractOne方法创建两个新列表，“匹配”和“概率”。您还必须在这里导入“流程”。我在这里设置了它，以便它只在比率高于90%时添加一个匹配。你可以把它改成任何适合你的，我推荐90%以上，否则，你会开始得到一些严重的可疑匹配。如果没有找到匹配，它会插入‘no match’——我这样做是为了保持列表的长度不变。然后，我将它转换成熊猫数据帧，以利用输出。</p><p id="3994" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以使用下面的两个列表:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="b7fa" class="nm la it nz b gy od oe l of og">list1 = ['cat', 'dog', 'Cat', 'Dog', 'turtle', 'bed']</span><span id="3cab" class="nm la it nz b gy oh oe l of og">list2 = ['cats', 'hotdog', 'Cat', 'Dog', 'turtles', 'bath']</span></pre><p id="143f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">运行函数并随机取样:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="21eb" class="nm la it nz b gy od oe l of og">df = match_lists(list1, list2)</span><span id="3615" class="nm la it nz b gy oh oe l of og">df.sample(5)</span></pre><p id="baba" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">(我意识到我是从6个观察值中抽取5个样本，但这只是为了向你展示我将如何在大范围内这样做。)</p><p id="e36d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在熊猫数据框架中，您会得到以下结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/4f46d19f2dff579203f01a87ec05eec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*exJdceNajxsfXt_ZzmRfBw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="07cf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后你可以用一个简单的视力测试来看看这个功能做得有多好——这里看起来相当不错。</p><p id="c2ef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢阅读，我希望这能帮助你。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="c183" class="nm la it nz b gy od oe l of og">If I’ve inspired you to join medium I would be really grateful if you did it through this <a class="ae ky" href="https://jamesasher4994.medium.com/membership" rel="noopener">link</a> — it will help to support me to write better content in the future.</span><span id="c588" class="nm la it nz b gy oh oe l of og">If you want to learn more about data science, become a certified data scientist, or land a job in data science, then checkout <a class="ae ky" href="https://365datascience.pxf.io/c/3458822/791349/11148" rel="noopener ugc nofollow" target="_blank">365 data science</a> through my <a class="ae ky" href="https://365datascience.pxf.io/c/3458822/791349/11148" rel="noopener ugc nofollow" target="_blank">affiliate link.</a></span></pre></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="e130" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是我写的其他一些东西:</p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/how-to-easily-run-python-scripts-on-website-inputs-d5167bd4eb4b"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">如何在网站输入上轻松运行Python脚本</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">这是我建立的一个网站的演示，它将动态分析文本情感</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ks ot"/></div></div></a></div><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/how-to-easily-show-your-matplotlib-plots-and-pandas-dataframes-dynamically-on-your-website-a9613eff7ae3"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">如何轻松地在你的网站上动态显示你的Matplotlib图和Pandas数据框。</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">这是一种令人惊讶的简单方法，可以在线向全世界展示您的图表和数据框架，而且不到…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pi l pe pf pg pc ph ks ot"/></div></div></a></div><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/how-to-easily-automate-your-keyboard-to-do-tasks-in-python-b698e98a5c40"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">如何轻松地自动化您的键盘来完成Python中的任务</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">永远告别单调的任务</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pj l pe pf pg pc ph ks ot"/></div></div></a></div></div></div>    
</body>
</html>