<html>
<head>
<title>Hands-on Content Based Recommender System using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Python的实用内容推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hands-on-content-based-recommender-system-using-python-1d643bf314e4#2022-01-16">https://towardsdatascience.com/hands-on-content-based-recommender-system-using-python-1d643bf314e4#2022-01-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/b52f5256cf8c2b30eae0a24e34e30116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c-k_GQqrem0YlmFKmEbvxA.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">乔纳斯·雅各布森在<a class="ae jd" href="https://unsplash.com/s/photos/help?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""><h1 id="9543" class="pw-post-title je jf jg bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">基于Python的实用内容推荐系统</h1></div><div class=""><h2 id="b3e9" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">以下是如何用Python通过几个步骤创建一个基于内容的推荐系统</h2></div><p id="bd6f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">人工智能最令人惊讶和着迷的应用之一无疑是推荐系统。</p><p id="fb19" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">简而言之，推荐系统是一种工具，它根据你已经看过和喜欢的内容向你推荐下一个内容。像<strong class="kx jh"> Spotify、网飞</strong>或<strong class="kx jh"> Youtube </strong>这样的公司使用推荐系统向你推荐你已经看过或听过的下一个视频或歌曲。</p><p id="d08d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">建立推荐系统的想法肯定不是昨天才产生的。2006年，网飞宣布奖励研究团队100万美元，奖励他们在给定一些测试数据的情况下，能够构建出最好的推荐系统。这叫做“<a class="ae jd" href="https://en.wikipedia.org/wiki/Netflix_Prize" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> Netflix奖</strong> </a> <strong class="kx jh">”，</strong>对了。</p><p id="dff0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于这个想法相对来说比较古老，所以有一些疯狂的好的推荐系统，他们考虑了很多变量和关于用户的具体信息。当然，网飞的推荐系统并不是真正的开源，即使我们有一些关于他们如何工作的想法，我们也没有他们预先训练好的可以使用的神奇模型。</p><p id="8c52" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">无论如何，有一种方法可以让推荐系统非常简单，易于运行，并且实际上非常有效！</p><p id="bfad" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这本笔记本中，我将向您展示如何使用几行代码和一些关于<strong class="kx jh">机器学习</strong>和<strong class="kx jh">代数</strong>的领域知识来构建基于内容的推荐系统。</p><p id="cb8e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们开始吧:)</p><h1 id="2692" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">0.图书馆</h1><p id="042b" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">这是让它工作所需要的:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><blockquote class="mu mv mw"><p id="89c8" class="kv kw mx kx b ky kz kh la lb lc kk ld my lf lg lh mz lj lk ll na ln lo lp lq ij bi translated">附言:我安装了KMeans来进行非监督学习方法，但我没有在本笔记本中使用它，所以如果你没有它，就不需要安装它:我们不会使用它。</p></blockquote><h1 id="e2a3" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">1.数据集</h1><p id="ce7b" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我们首先需要的当然是<strong class="kx jh">数据集</strong>。我在这里找到了数据集<a class="ae jd" href="https://www.kaggle.com/harshitshankhdhar/imdb-dataset-of-top-1000-movies-and-tv-shows" rel="noopener ugc nofollow" target="_blank">，它基本上是从<strong class="kx jh"> IMDb </strong>(是的，著名的</a><a class="ae jd" href="https://www.imdb.com" rel="noopener ugc nofollow" target="_blank">网站</a>)中提取的集合。在这个集合中，我们有一个电影列表和它们相应的特征。我们正在使用的功能有:</p><ul class=""><li id="3430" class="nb nc jg kx b ky kz lb lc le nd li ne lm nf lq ng nh ni nj bi translated">电影的<strong class="kx jh">概述</strong>(即简短描述)</li><li id="fd45" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">其<strong class="kx jh">标题</strong></li><li id="b614" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq ng nh ni nj bi translated">它的<strong class="kx jh">流派</strong>(其实每部电影都有多个流派)</li></ul><p id="62aa" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们来看看:</p><h2 id="00e3" class="np ls jg bd lt nq nr dn lx ns nt dp mb le nu nv md li nw nx mf lm ny nz mh oa bi translated">1.1导入它:</h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h2 id="d53e" class="np ls jg bd lt nq nr dn lx ns nt dp mb le nu nv md li nw nx mf lm ny nz mh oa bi translated">1.2查看它:</h2><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="966d" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">2.方法</h1><p id="831e" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">当处理文本数据时，首先要做的是将文本转换成数字。更准确地说，我们正在将一串文本转换成一个<strong class="kx jh">向量</strong>。</p><p id="5df4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是我们是如何做到的呢？我们应该如何聪明地转换字符串，使向量代表文本的含义？<br/>嗯，这是一个非常好的问题，当然要找到一个最佳答案并不容易。尽管如此，还是有真正好的模型(或者更准确地说是<strong class="kx jh">变形金刚</strong>)，比如<a class="ae jd" href="https://arxiv.org/pdf/1810.04805.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> BERT </strong> </a>，它们能够明智地将句子转换成文本。如果你对细节感兴趣，这张<a class="ae jd" href="https://arxiv.org/pdf/1810.04805.pdf" rel="noopener ugc nofollow" target="_blank">纸</a>实际上是一张杰作，而且如此清晰。</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/79921300e91283764e95f310f5bcef2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RDi_ETEpgBM7riLzwJ5gEg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">BERT预训练和微调的想法。图片摘自伯特的论文(<a class="ae jd" href="https://arxiv.org/pdf/1810.04805.pdf" rel="noopener ugc nofollow" target="_blank">此处</a>)</p></figure><p id="bc00" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是为什么我们首先要把文本转换成向量呢？</p><p id="78dc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">嗯，因为现在我们有了<strong class="kx jh">向量</strong>我们能够做所有你通常在向量上做的操作:)</p><p id="c338" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设你正在做一个分类任务，你想使用<a class="ae jd" href="https://en.wikipedia.org/wiki/Support-vector_machine" rel="noopener ugc nofollow" target="_blank">支持向量机</a>。当然，你需要有<strong class="kx jh">个向量</strong>来做这件事。因此，如果你必须对一个文本进行分类，你首先要将文本转换成一个向量，然后应用SVM算法。</p><p id="a39e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的例子中，我们将使用向量化测试来寻找两个向量之间的相似性。我们的推荐将是与我们正在考虑的向量最相似的(5)<strong class="kx jh"/>。</p><p id="9520" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个例子:</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/a1e02e09954d5ae8bd843bf90615ee83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCThFX5lMhR0eie84K2xoA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我制作的图像</p></figure><p id="8fda" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设x和y是两个分量(我们会有比两个多得多的分量)。如果一部电影谈论科学、太空和火箭，而另一部或多或少谈论相同的东西，我们希望这两个向量接近，就像蓝色的向量一样。另一方面，如果另一部电影是关于一个爱情故事，我们会期望这个向量很远，像红色和蓝色的。</p><p id="ec08" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以我们要做的是:</p><ol class=""><li id="4022" class="nb nc jg kx b ky kz lb lc le nd li ne lm nf lq od nh ni nj bi translated">使用<strong class="kx jh"> BERT </strong>将我们的文本转换成矢量</li><li id="b5bd" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq od nh ni nj bi translated">得到一个固定电影(向量)和所有其他电影的<strong class="kx jh">余弦相似度</strong>(两个向量夹角的余弦)</li><li id="cbf3" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq od nh ni nj bi translated"><strong class="kx jh">挑选余弦相似度最大的电影(矢量)。我们将挑选其中的5个。</strong></li></ol><p id="04ff" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就这样:)</p><p id="db73" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我希望这听起来已经很简单了，但是当我告诉你怎么做的时候，它会变得更加清晰。所以让我们开始吧！</p><h1 id="c5fb" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">3.该方法</h1><h2 id="939c" class="np ls jg bd lt nq nr dn lx ns nt dp mb le nu nv md li nw nx mf lm ny nz mh oa bi translated">3.1从文本到矢量:</h2><p id="20ba" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">下面是你如何将一个<strong class="kx jh">文本</strong>转换成一个<strong class="kx jh">向量</strong>:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h2 id="cd34" class="np ls jg bd lt nq nr dn lx ns nt dp mb le nu nv md li nw nx mf lm ny nz mh oa bi translated">3.2 PCA(可选)</h2><p id="c6fd" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我现在使用一种非常已知的方法来降低我们数据集的维度(<strong class="kx jh">主成分分析</strong>)。它只是画出图来，给你一个文本-向量转换结果的概念，所以你可以安全地跳过它。</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h2 id="5101" class="np ls jg bd lt nq nr dn lx ns nt dp mb le nu nv md li nw nx mf lm ny nz mh oa bi translated">3.3余弦相似度和推荐函数</h2><p id="dd06" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">下面是如何计算<strong class="kx jh">余弦</strong> <strong class="kx jh">相似度</strong>(一行代码)和<strong class="kx jh">函数</strong>，我们将用它来获得我们的推荐:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="83a2" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">4.结果呢</h1><p id="dd0a" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">让我们<strong class="kx jh">剧情</strong>一些推荐:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="5fea" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以欣赏一些非常酷的东西。算法识别出<strong class="kx jh">教父、教父II和教父III是相似的！</strong></p><p id="732b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们更深入地探索一下。</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="3a72" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以，如果你刚刚看完《黑暗骑士》,它会给你《小丑》、《肮脏的哈利》、《蝙蝠侠诞生》、《银河护卫队》和《死亡笔记》!我发现这些建议非常准确，尤其是如果我们考虑到算法非常简单的话！</p><p id="e94a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以通过查看<strong class="kx jh">图</strong>来了解这些建议的准确性:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="ba14" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以，<strong class="kx jh">你看过的电影有以下的剧情</strong>:</p><blockquote class="oe"><p id="dca6" class="of og jg bd oh oi oj ok ol om on lq dk translated">“当被称为小丑的威胁对哥谭市的人民造成破坏和混乱时，蝙蝠侠必须接受一次最大的心理和身体测试，以测试他对抗不公正的能力。”</p></blockquote><p id="8f6b" class="pw-post-body-paragraph kv kw jg kx b ky oo kh la lb op kk ld le oq lg lh li or lk ll lm os lo lp lq ij bi translated"><strong class="kx jh">第一部推荐的电影有这个情节</strong>:</p><blockquote class="oe"><p id="e133" class="of og jg bd oh oi oj ok ol om on lq dk translated">“在哥谭市，精神有问题的喜剧演员亚瑟·弗莱克被社会忽视和虐待。然后，他走上了革命和血腥犯罪的恶性循环。这条路让他直面他的另一个自我:小丑。”</p></blockquote><p id="ea1f" class="pw-post-body-paragraph kv kw jg kx b ky oo kh la lb op kk ld le oq lg lh li or lk ll lm os lo lp lq ij bi translated">所以他们其实挺像的！</p><p id="3a4a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们甚至可以欣赏到推荐的电影也有相同的类型:</p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="f15e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以你看的电影是一部<strong class="kx jh">剧情</strong>和<strong class="kx jh">家庭</strong>电影，而推荐的电影是:</p><ol class=""><li id="501e" class="nb nc jg kx b ky kz lb lc le nd li ne lm nf lq od nh ni nj bi translated"><strong class="kx jh">戏剧</strong></li><li id="5317" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq od nh ni nj bi translated"><strong class="kx jh">剧情</strong></li><li id="395e" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq od nh ni nj bi translated"><strong class="kx jh">剧情</strong></li><li id="d84f" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq od nh ni nj bi translated"><strong class="kx jh">戏剧、历史、战争</strong></li><li id="5679" class="nb nc jg kx b ky nk lb nl le nm li nn lm no lq od nh ni nj bi translated"><strong class="kx jh">冒险、历史、家庭</strong></li></ol><p id="a8fc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，这是一个非常简单的算法的质量指标！</p><p id="68bb" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">最后，这是你将你的推荐存储到数据帧中的方式:</strong></p><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="mo mp mq mr gt is"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="15a6" class="lr ls jg bd lt lu lv lw lx ly lz ma mb km mc kn md kp me kq mf ks mg kt mh mi bi translated">5.结论</h1><p id="5dec" class="pw-post-body-paragraph kv kw jg kx b ky mj kh la lb mk kk ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">我知道有很多方法可以得到一个推荐系统。我们这里的假设是，我们推荐的东西与你已经看过的东西<strong class="kx jh">相似</strong>，但是也许你想<strong class="kx jh">给用户一个惊喜，所以它不应该像我们建议的那样相似。</strong></p><p id="44b3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，我们只考虑一部电影，我们并没有真正考虑用户的口味，这只是关于电影本身。</p><p id="78bd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">换句话说，这只是众多方法中的一种，而且实际上非常简单。尽管如此，我发现这些建议非常准确和有趣，所以这是一个有效的方法，而且从计算上来说，非常便宜！</p><p id="c017" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">写这篇文章让我很开心。我希望你读它的时候有很多乐趣。如果你有任何问题或意见，我很高兴在这里听到他们:【piero.paialunga@hotmail.com T2】。</p><p id="e79f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">再见:)</p></div></div>    
</body>
</html>