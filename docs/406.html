<html>
<head>
<title>Strings in SQL, Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL中的字符串，第2部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/strings-in-sql-part-2-21a467374b84#2022-01-13">https://towardsdatascience.com/strings-in-sql-part-2-21a467374b84#2022-01-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="e70a" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">SQL中的字符串，第2部分</h1></div><div class=""><h2 id="90fe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用SQL聚集和分割字符串变量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c8b359e06b7159e941052bee48f572b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wdj2kBYtsX-1KuMO"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@chrismoore_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·摩尔</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h2 id="7595" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">介绍</h2><p id="cb64" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi ml translated">关于字符串的第一篇文章有助于为这种变量类型的数据操作提供一些初步的见解。我们能够提取字符串的元素来搜索共同的群组。通过使用索引方法，可以研究字符串中的任意数量的特征。</p><div class="mu mv gp gr mw mx"><a rel="noopener follow" target="_blank" href="/strings-in-sql-part-1-122185dd0099"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd ir gy z fp nc fr fs nd fu fw ip bi translated">SQL第1部分中的字符串</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">使用SQL字符串技术从字符列中提取有意义的信息</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">towardsdatascience.com</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl kp mx"/></div></div></a></div><p id="7c28" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">本文旨在展示如何将数据聚合整合到数据分析中。</p><h2 id="4c7f" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">输入数据和软件</h2><p id="4a15" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">对于这段分析，IBM HR分析数据集的一个样本取自Kaggle。在这个数据集中，有几个字符变量可用。</p><div class="mu mv gp gr mw mx"><a href="https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd ir gy z fp nc fr fs nd fu fw ip bi translated">IBM HR Analytics员工流失和绩效</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">预测你有价值的员工的流失</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">www.kaggle.com</p></div></div><div class="ng l"><div class="nr l ni nj nk ng nl kp mx"/></div></div></a></div><p id="89cc" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">本文中显示的SQL代码是使用Microsoft SQL Server Management Studio 18的一个实例创建的。</p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h2 id="a0ed" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">CONCAT &amp; CONCAT_WS</h2><p id="0e86" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">通过连接，该方法旨在将多个字符串值组合成一个完整的字符串。一个简单的例子是将第一个和第二个名字组合在一起创建一个总名。在SQL中，有许多方法可供使用。包含三个用户定义的declare语句提供了创建所需消息的灵活性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL代码1.1使用串联方法</p></figure><p id="0f17" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">在上面的SQL代码中，第10行和第11行显示了使用加号的第一种连接方法。用这种简单的方法，可以很容易地组合变量。需要添加空格以确保在每个单独的字符串之间添加一个空格。如果我们忘记包含这个元素，那么当一个变量结束，下一个变量开始时，所有的文本将被压缩在一起。另外，请注意，我们已经展示了如何使用cast方法将JobSatisfaction变量转换为不同的字符串数据类型。如果变量数据类型不是字符串数据类型，那么这个cast方法可以用来转换。</p><p id="3fe0" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">采用concat方法仍然需要在每个字符串变量之间包含每个空格分隔符。使用逗号分隔字符串的每个元素会使事情变得更简单。但是，仍有可能会缺少一个空格。concat_ws方法通过声明一次分隔符简化了连接字符串的创建。在方法开始时提供此分隔符可确保所需的编码更少，并减少出错的机会。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/d9ba83c9370529be188378346462550c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qaw2mdbbLLxsprCarHLOcw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL输出1.1由第一个串联方法产生</p></figure><p id="63ef" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">SQL输出显示串联字符串是如何生成的。每种方法都会产生相同的结果。</p><h2 id="a590" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">字符串_聚集</h2><p id="cd33" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">当处理较大的数据集时，有时字符串方法会显示过多的信息。对于本文中显示的示例，我们使用1，000行表格数据的样本。当运行某些SQL字符串方法时，这可能会导致显示错误，因为查询已超出预定义的内存容量。但是，解决这个问题的一个方法是创建一个公共表表达式(CTE ),它提供一个临时的命名结果集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL代码1.2创建CTE参考数据集</p></figure><p id="fb08" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">SQL代码将汇总查询存储在Job_Roles变量中。在查询中，我们按不同的工作角色总结了数据，以减少string_agg方法正常工作的潜在值的数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/009152e693f89ac82346f8163c59167d.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*FUCXgfWz4AVPUsteZjBivg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">工作角色卷的SQL输出1.2摘要</p></figure><p id="0c33" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">从CTE查询的结果中，我们可以看到一些角色比其他角色具有更高的比例。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL代码1.3使用作业角色的字符串聚合方法</p></figure><p id="195a" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">为了生成作业角色的列表，string_agg方法将采用字符串变量JobRole并创建一个连接列表。使用下面的结果，我们可以遍历列表并过滤每个群组的整体数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/4648b94175a702eed05dc226608f8632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yit6Tg_R6-uCld3Z6b0C8A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL输出1.3在一个字符串中显示作业角色列表</p></figure><p id="27e5" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">由于工作角色是按照它们第一次出现在初始数据集中的顺序显示的，所以理解任何类似的角色可能会很棘手。在下面的SQL代码中，我们看到了string_agg group如何按字母顺序排序。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL代码1.4对工作角色列表进行排序的方法</p></figure><p id="b1db" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">列表的排序有助于以更有意义的方式处理数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/7dd1b4c65dbccd6ea5faf3b19e15c39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z97tPSj0gizIHNsRRGlTCg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL输出1.4作业角色已按字母顺序排序</p></figure><h2 id="b3a8" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">字符串_拆分</h2><p id="ad56" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">到目前为止，我们已经使用了组合字符串值的方法。使用这种方法，我们将把字符串变量分割成其独特的部分。有时我们需要了解一个字符串中包含的单词数量，因此使用这种方法可以帮助最初的发现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nz oa l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL代码1.5使用拆分方法在声明的字符串中创建标记</p></figure><p id="e3d9" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">通过声明一个字符串消息，我们可以试验这个方法。因为消息由空格分隔，所以这是包含在方法的第二个参数中的分隔符。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/27193c4e2737bbfe5d88748e3bc29685.png" data-original-src="https://miro.medium.com/v2/resize:fit:198/format:webp/1*t5_Se2LNlS-nTVbIH8eIGg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SQL output 1.5分隔到输出数据集中每一行的标记列表</p></figure><p id="8ab7" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">查询输出显示了由split方法标记的每个元素。未来的任务可能是对每个标签进行计数，以理解术语频率。</p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h2 id="d239" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h2><p id="384d" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在本文中，我们展示了字符串是如何组合和拆分的。通过理解我们想要询问数据的问题，我们可以在应用字符串方法之前首先创建概括的查询结果。使用串联方法允许用户创建可用于进一步处理数据的消息或id。最后，我们看到分割字符串如何提供标签列表，这些标签可以在自然语言处理(NLP)数据分析中进行检查。</p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="d695" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated"><em class="og">非常感谢您阅读</em></p><p id="a01b" class="pw-post-body-paragraph ls lt iq lu b lv nm jr lx ly nn ju ma lf no mc md lj np mf mg ln nq mi mj mk ij bi translated">[1]:ka ggle dataset IBM HR analytics attraction dataset来自<a class="ae kv" href="https://www.kaggle.com/pavansubhasht/ibm-hr-analytics-attrition-dataset" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/pavansubhasht/IBM-HR-analytics-attraction-dataset</a>，许可协议为【https://opendatacommons.org/licenses/dbcl/1-0/ T2】</p></div></div>    
</body>
</html>