<html>
<head>
<title>Assessing Model Performance for Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">评估回归模型性能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/assessing-model-performance-for-regression-7568db6b2da0#2022-01-07">https://towardsdatascience.com/assessing-model-performance-for-regression-7568db6b2da0#2022-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="8251" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">评估回归模型性能</h1></div><div class=""><h2 id="add9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">用于评估回归模型质量的一些方法概述</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/829207031a2df597ef3ec80fce295ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6w-wgIiKbQpDaa-fb8CywQ.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">本·穆林斯在<a class="ae kw" href="https://unsplash.com/s/photos/test?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6123" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">当我们创建由学习算法在训练期间没有看到的示例组成的维持集时，模型评估阶段开始。如果我们的模型在维持集<strong class="kz ir">上表现良好，我们可以说我们的模型概括得很好</strong>，并且质量很好。</p><p id="0aec" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">评估一个模型好坏的最常见的方法是对维持数据计算一个<strong class="kz ir">性能指标。</strong></p><p id="1f52" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">本文将关注回归模型的性能指标。这是值得详细说明的，因为分类任务具有完全不同的可跟踪性能指标。</p><h1 id="93b6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">回归的性能指标</h1><p id="952c" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">我们将涵盖均方误差(MSE)、平均绝对误差(MAE)、中值绝对误差(MdAE)、几乎正确预测误差率(ACPER)、平均绝对百分比误差(MAPE)和均方根误差(RMSE)。就我而言，这些是回归模型最有用的指标。</p><p id="3e12" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们将从MSE开始，它相当容易理解。</p><h2 id="ffb0" class="mq lu iq bd lv mr ms dn lz mt mu dp md lg mv mw mf lk mx my mh lo mz na mj nb bi translated">均方误差</h2><p id="543d" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">最常见的度量是<strong class="kz ir">回归的成本函数:均方误差(MSE) </strong>。它被定义为</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/5cf84dce471425ed49dca9d07ea2d6aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*OxlP2Zo9fSiLAk8MWgtPGw.png"/></div></figure><p id="ab55" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">其中<em class="nd"> f </em>是将特征向量<em class="nd"> x </em>作为输入并输出预测的模型，范围从1到N的<em class="nd">I</em>表示来自数据集中的示例的索引。在<em class="nd"> N </em>上预测值减去实际值的总和表示平均值。通过平方，我们去除了负号，并对较大的差异给予更大的权重。</p><p id="6ee4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">回归模型试图通过绘制一条线<strong class="kz ir">来拟合数据，该线使真实数据点与同一条线上的点</strong>的距离最小化。数值越接近直线，模型在该点的表现越好。所以MSE越低越好。</p><p id="6bf8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">MSE指标通常与平均基线模型</strong>相比较，后者是一种基于平均值的回归模型。此模型总是预测训练数据标签的平均值。如果我们的回归模型MSE大于基线MSE，那么我们的回归模型就有问题。</p><p id="d044" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> MSE受异常值</strong>的影响，即数据值异常远离真实回归线。根据定义，如此远的点的平方误差将非常高。在这些情况下，最好应用MdAE，它代表<strong class="kz ir">中值绝对误差</strong>(更多信息见下文)。</p><p id="672e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面是如何用Python实现它</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">用Python实现MSE</p></figure><h2 id="5228" class="mq lu iq bd lv mr ms dn lz mt mu dp md lg mv mw mf lk mx my mh lo mz na mj nb bi translated">平均绝对误差</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/38ab4f19661be666740eff0321dcc22a.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*K_wQLppt7HeHxJJg61v8LA.png"/></div></figure><p id="d997" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">MAE类似于MSE，因为它采用残差的绝对值<em class="nd"> f(x) - y </em>而没有平方因子。它不考虑误差的方向，这意味着我们不会知道负误差或正误差在总体均值中的权重更大。也就是说，<strong class="kz ir"> MAE对异常值更稳健，因为它不平方遥远预测的误差值。</strong></p><p id="ce93" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面是如何用Python实现它</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">用Python实现MAE</p></figure><h2 id="ee8d" class="mq lu iq bd lv mr ms dn lz mt mu dp md lg mv mw mf lk mx my mh lo mz na mj nb bi translated">中位数绝对误差</h2><p id="2009" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">正如我们从统计学的基础知识中所知，中值不受异常值的影响，比如平均值是T5。MdAE表示预测与中值回归线的绝对距离。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/295ad0abf821f6663b3de6a279ad0970.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*8pcZzIdbQFyhkjOjsaZE1g.png"/></div></figure><p id="8466" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这里<em class="nd"> {|f(x_i) — y_i|} </em>表示对其执行模型评估的所有示例的绝对误差值的集合。</p><p id="978f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果存在异常值且未进行处理，则使用MdAE代替MSE或MAE，因为它可以更好地表示距离回归线不远的点的误差。</p><p id="e894" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面是如何用Python实现它</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">MdAE在Python中的实现</p></figure><h2 id="a175" class="mq lu iq bd lv mr ms dn lz mt mu dp md lg mv mw mf lk mx my mh lo mz na mj nb bi translated">几乎正确的预测误差率</h2><p id="8848" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">ACPER是预测值与真实值的百分比。这是关于设置一个你的价值观的任意范围。所有这些值都有助于计算ACPER。</p><p id="12cf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">以下是计算ACPER的简单算法:</p><ol class=""><li id="e4a2" class="ni nj iq kz b la lb ld le lg nk lk nl lo nm ls nn no np nq bi translated">定义一个你认为可接受的百分比误差阈值(比如2%)</li><li id="12d5" class="ni nj iq kz b la nr ld ns lg nt lk nu lo nv ls nn no np nq bi translated">对于目标值<em class="nd"> y </em>的每个真值，期望的预测应该在<em class="nd"> y_i-0.02*y_i和y_i+0.02*y_i </em>之间</li><li id="1574" class="ni nj iq kz b la nr ld ns lg nt lk nu lo nv ls nn no np nq bi translated">通过使用所有样本，计算符合上述规则的预测值的百分比。这将为我们的模型提供ACPER。</li></ol><p id="5896" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面是如何用Python实现它</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">用Python实现ACPER</p></figure><p id="e1c7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">结果:【<em class="nd">假，假，真，假</em>】。我们可以简单地计算真值的个数，然后除以列表的长度。</p><h2 id="24bf" class="mq lu iq bd lv mr ms dn lz mt mu dp md lg mv mw mf lk mx my mh lo mz na mj nb bi translated">平均绝对百分比误差(MAPE)</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/75b5d2d9e95aa48fb289a0c1e59dc692.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*bcH6qQNEhPKACaR1peaQDA.png"/></div></figure><p id="2d21" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">平均绝对百分比误差</strong> (MAPE)以百分比形式测量误差，可通过对MAE稍加修改并乘以100获得百分比分数来计算。<strong class="kz ir">它是回归模型评估中最有用和最常用的指标之一。</strong></p><p id="eb6f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">假设我们的模型的MAPE是5% —这将表明预测值和观察值之间的平均差异是5%。方便又可解读，对吧？</p><p id="5937" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">和MAE一样，它也存在异常值，所以一定要正确对待它们。</p><p id="6a83" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">下面是如何用Python实现它</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">MAPE在Python中的实现</p></figure><h2 id="a52f" class="mq lu iq bd lv mr ms dn lz mt mu dp md lg mv mw mf lk mx my mh lo mz na mj nb bi translated">均方根误差(RMSE)</h2><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/cb67f3a7d65544a1cc069205806c5e7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*veCkB-eyB4zsTQOxiNKf0g.png"/></div></figure><p id="a97d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">均方根误差(RMSE)是一种绝对误差的度量，其中误差被平方以防止正值和负值相互抵消(就像MSE一样)。<strong class="kz ir">表示残差的标准差。</strong>换句话说，残差是预测点和观察点之间的距离。作为标准差，<strong class="kz ir">，它表示残差在我们的回归线</strong>周围如何分布。</p><p id="0e8b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我在这里借用并引用一位<a class="ae kw" rel="noopener" target="_blank" href="/what-does-rmse-really-mean-806b65f2e48e">的同行作家</a></p><blockquote class="ny nz oa"><p id="64fe" class="kx ky nd kz b la lb jr lc ld le ju lf ob lh li lj oc ll lm ln od lp lq lr ls ij bi translated">这启发性地告诉我们，RMSE可以被认为是预测值向量和观测值向量之间的某种(归一化)距离。</p></blockquote><p id="c570" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">实现非常简单，因为它只是将<em class="nd"> np.sqrt </em>应用于我们上面看到的MSE计算。</p><h1 id="bcdd" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="690c" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">请随意使用本文中的代码来实现您的性能指标。请记住，Scikit-Learn有一个专用的<a class="ae kw" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics" rel="noopener ugc nofollow" target="_blank"> API，它让我们的生活变得简单。用它！</a></p></div></div>    
</body>
</html>