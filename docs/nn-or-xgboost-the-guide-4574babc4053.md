# NN 或 XGBoost:指南

> 原文：<https://towardsdatascience.com/nn-or-xgboost-the-guide-4574babc4053>

![](img/959191415662bcd3242452ddc2504188.png)

[最大像素](https://www.maxpixel.net/photo-2759820)

## 帮助您选择最适合您的型号的简短指南

# 第 1 部分-简介

受深度学习在计算机视觉任务中成功的启发，许多人争论 NN 是否能为表格数据“赢得比赛”。一些人赞成 NN 几乎无限的潜力，而另一些人则提到 XGBoost 在 Kaggle 比赛中的成就。有些人甚至进行了两种模型的面对面比较(例如 [Firefly.ai](https://drive.google.com/file/d/13i9MVuXPFyEDTConGu57aDKblPJ1Eoe3/view?usp=sharing) 、 [MLJar](https://mljar.com/machine-learning/neural-network-vs-xgboost/) 、 [Ravid 等人](https://arxiv.org/pdf/2106.03253.pdf))。

> 不要选择最好的型号，而是选择最适合你的型号

幸运的是，“哪种 ML 模型最适合表格数据”这个问题与数据科学家的工作完全无关。这是因为数据科学家专注于自己的特定数据集/任务，尤其是在表格数据中，发现其他数据集/任务不太相关。此外，模型的准确性在选择正确的模型时仅起部分作用。因此，正确的问题应该是“哪种模式最适合我的需求”。

选择正确的模型并不总是微不足道的，因为有许多方面需要考虑。为了使这个过程更容易，下面的指南提供了 3 个考虑事项表和相应的模型建议。第三部分解释了这些建议背后的逻辑。

> 下面的表格和分析是为多层感知器架构创建的。然而，近年来，针对表格数据的 NN 模型的[许多其他架构](https://arxiv.org/pdf/2110.01889.pdf)被引入，例如 [LSTM](http://www.felixgers.de/papers/phd.pdf) 、 [TabNet](https://arxiv.org/pdf/1908.07442.pdf) 、[节点](https://arxiv.org/abs/1909.06312)。这些体系结构在提供卓越性能的同时，与基本的 MLP 体系结构有许多共同的特征。因此，下面的分析在某种程度上仍然适用于这些架构。

# 第 2 部分-指南

下表旨在帮助您识别哪种型号有可能满足您的需求。

> ***树木*** *→ XGBoost、随机森林、LightGBM、Catboost 等。* ***NN****→多层感知器以及某种程度上的其他架构*

## 绩效问题

没有办法预先知道哪种型号会提供更好的性能。最好尝试所有模型，包括超参数调整，并从训练的模型构建一个集合。换句话说，最好使用有足够学分的 AutoML 系统。不幸的是，使用这样的系统通常是不可能的，因此必须手动选择模型类型。在这种情况下，数据和任务的特征可能表明哪个模型将获得最佳性能。

性能表

## 训练和推理的各个方面

在高尔夫比赛中，表现就是一切。但在现实生活中，诸如易用性和培训时间/成本等实际考虑因素往往同样重要。

训练和推理表

## 其他考虑

很多时候，工作并不是以一个训练好的模型结束的，还需要其他的后续特性。这些特征可以指示选择次标准模型来实现更有用的模型。

其他注意事项表

# 第三部分——推理

## 树与神经网络—高级差异

让我们来看看基于神经网络的解决方案和基于树的解决方案之间的一些关键区别。

谈到**易用性，**毫无疑问，创建基于树的解决方案要容易得多。这几乎是一个即插即用的解决方案，只有 3 行代码，学习曲线可以忽略不计。相比之下，要想用神经网络得到好的结果，你需要知道你在做什么——包括理论和 TensorFlow/PyTorch 软件包。不仅如此，训练基于树的模型所需的时间也短得多。最重要的是，基于树的模型对它们拥有的少数超参数(HP)相对不敏感。另一方面，神经网络模型具有许多超参数，并且对它们的值也非常敏感。因此，神经网络模型需要彻底的 **HP 调整**才能工作。

所有这些点加起来使得基于树的模型对于一个模型来说具有显著更短的**时间。**

基于树的模型易于使用的原因之一是它们没有提供太多的操作空间。这是一把双刃剑。虽然它使新手能够获得高端结果，但它阻止了专家进一步前进并构建定制的解决方案。从这个意义上说，神经网络模型正好相反。有了足够的专业知识，就有可能针对问题和业务案例定制解决方案，从而实现一个**定制的最先进的解决方案。**

然而，这不是免费的。不仅需要专业知识，还需要增加 R&D、专用硬件的开发时间，以及更长的惠普调优模型培训。在这个行业中，所有这些都可以转化为很多钱。毫无疑问，创建一个神经网络解决方案要昂贵得多。

将“可定制的”、“最先进的”和“昂贵的”放在一起，会产生对技术(即深度学习)的更多公关和**兴趣，这反过来又会转化为筹款、产品营销和学术研究。**

## **树木 vs 神经网络——技术分析**

每种模型类型，无论是基于树还是基于神经网络，都有自己的特点，这些特点可以转化为优势和劣势。这反过来又使每个模型更适合特定的数据集。

**神经网络**

让我们检查多层感知器(MLP)架构。这种架构利用神经元和层的概念，方便地将 NN 模型表示为激活函数的 [**函数组合**](https://en.wikipedia.org/wiki/Function_composition) ，其中每个中间函数都是几个激活函数的加权和。因此，激活函数的大部分特征将被传递给组合函数，即神经网络模型。对于常见的激活功能，如线性、ReLu、Tanh 或逻辑，这意味着:

*   **参数函数空间:**NN 架构定义了一个函数空间，NN 模型 F(x)位于其中。F(x)的参数(权重和偏差)经过了优化，因此 F(x)能够最好地表示数据样本的基本函数。由于 F(x)受限于函数空间，因此更容易获得对属于同一函数空间且具有相似特征的基础函数的良好逼近。这意味着与其他方法相比，需要更少的数据来实现更高的精度。另一个优势是，如果需要的话，可以很容易地获得模型的衍生品。
*   [**lip schitz continu**](https://en.wikipedia.org/wiki/Lipschitz_continuity)**ity:**NN 模型的梯度是有界的。该特性将使得 NN 难以逼近具有强梯度的基础函数，例如不连续的(例如，分类值)、无界函数(例如，1/x，log(x))或无界梯度(例如，sqrt(x))。在这种情况下，需要更多的数据&模型复杂性来达到期望的精度。
*   **非周期性:**常见的激活函数都是非周期性的。这一特性可能使神经网络逼近周期函数具有挑战性。
*   **外推能力:**当 X 趋于无穷大时，F(X)要么变成常数(对于 Tanh，Logistic)，要么变成线性(对于 ReLu)。这允许一些推断的能力。此外，在回归任务中，函数的值可能低于/高于训练数据中目标的最小值/最大值。
*   **灵活:**可以通过改变建筑来使功能空间适应任务。例如，多标签模型。
*   **优化过程**:优化过程允许通过合并自定义度量、正则化和约束来收敛到更优的解决方案。此外，它还支持在线学习或转移学习等高级功能。
*   **网络架构**:几个隐藏层的使用，使得网络在训练时将数据嵌入到一个相对较小的 N 维空间中。这种嵌入通常对其他应用程序/模型很有用。它还提供了许多选项，如迁移学习(其中嵌入被重复使用)、使用图像/文本(通过嵌入的连接)，甚至用于生成目的(通过查询嵌入的潜在空间)。

**Tree** 底层函数用分段常数函数的加权和来近似，其中每一段都是一个正投影(超矩形)。因此，虽然每个模型(RandomForest、XGBoost 等。)收敛于不同的函数，它们都包含在同一个函数空间内。

*   **非参数化**:模型可以逼近任何底层函数。
*   **分段常数:**模型的准确性由分区的数量与底层函数的梯度决定。由于分区是由数据点的分布决定的，因此在高梯度或低样本密度的区域，模型的准确性会较低。当然，这主要与数字特征相关。
*   **决策制定:**基本的构建模块——决策树——很容易解释。因此，基于树的模型被认为更容易解释。此外，Shapley 值可以很容易地从这种模型中计算出来，而不需要昂贵的计算或替代模型。
*   **插值:**由于二元决策结构，基于树的模型不能在特征值的极值之外提供可靠的预测。同样，这主要与数字特征相关。这使得基于树的模型不适合诸如“来自纪元的时间”的特征，除非采取适当的对策。类似地，基于树的模型的预测限于训练集中的目标范围，因此应该避免诸如“客户数量”之类的目标标签。
*   **位置:**基于树的模型是非常局部的，因为每片叶子负责一个特定的区域。结果，输入空间的一个区域中的推广质量相对独立于其他子空间中的质量。

# 关键要点

> 表格数据集没有 SOTA ML 模型

表格数据包含所有可以放入表格的数据集。但仅此而已。与其他类型的数据集(如图像或文本)不同，没有其他共同特征。因此，不同的模型更适合不同的任务。

> 将任务的需求与模型的优缺点进行比较

外面有很多现成的模型。正确的模型不是为了获得最佳性能而优化的，而是为了在整体业务价值和解决方案的成本和工作量之间提供最佳平衡而优化的。

这种平衡对于一个人所面临的特定挑战来说是独特的。通过分析任务的需求与模型的优缺点，人们能够选择正确的道路。

> 选择最适合你的型号

我制作了这个指南来鼓励你问正确的问题，并帮助你做出正确的选择。剩下的就看你的了。