# 构建机器学习管道的各个步骤

> 原文：<https://towardsdatascience.com/various-steps-involved-in-building-machine-learning-pipeline-79c2cb13d69d>

## 理解机器学习中的基本步骤是有益的，这样人们可以组织和集中他们的精力和资源来完成整个 ML 工作流程中的每个步骤。

![](img/e8191c751c8d195576f3605b5c958599.png)

照片由[EJ·斯特拉特](https://unsplash.com/@xoforoct?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

在机器学习中，经常会出现关于如何构建可实时部署的**可扩展**和**健壮**模型的困惑。最复杂的事情是缺乏关于机器学习整体工作流程的知识。理解机器学习工作流程中的各个步骤对于数据科学家或机器学习工程师来说尤其方便，因为从长远来看，这可以节省大量的**时间**和**精力**。在本文中，我们将回顾构建机器学习系统通常涉及的步骤。

很好地理解构建人工智能系统的高级设计所需的原则是有用的，这样人们就可以分配他们的**时间**和**资源**来完成拼图的每个部分，然后提出一个投入生产的健壮的高性能模型。文章中强调的每个步骤对于**检查**和**监控**以获得实时部署的最佳模型非常有用。让我们回顾一下机器学习项目生命周期中的一系列步骤。

## 定义业务目标或目的

![](img/042b283c3631b65c51ff5fb8ff64384f.png)

马库斯·斯皮斯克在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

转向人工智能的行业正在增加，并有可能在未来增长，因为公司通过利用在各种任务中获得人类水平的表现所需的工具和技能，获得了巨大的利润和 T2 利润。因此，在各种项目中有许多目标和目的也涉及机器学习能力。在构建或提取数据之前，讨论和理解项目的目标是很重要的。通过定义问题和理解目标，就有可能知道在哪里**实际应用** ML，以及在哪里**减少**不需要自动化的应用。考虑这样一个例子，根据消费金额、卡的使用情况、购物时间和各种其他因素来预测客户是否会超过每天的交易限额。该数据暗示我们不需要自动化该过程，因为特征**“花费金额”**实际上是客户是否超过交易限额的粗略指标。在这种情况下，当预测几乎没有潜在的业务影响时，对于 ML 模型来说，这将是对**资源**和**计算能力**的相当大的浪费。定义业务目标的第一步可能是一个非常有力的步骤，应该在启动和分配 ML 系统所需的资源之前采取。

## 数据收集

![](img/15a372dcbca9ae888005bac33286f99c.png)

乔恩·泰森在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

好的，我们实际上已经定义了业务目标，并且有了构建最佳预测 ML 模型的具体想法。下一个重要步骤是收集**重要信息**，以便 ML 模型在**关键绩效指标(KPI)**上表现良好。这些指标因我们试图解决的问题是分类任务还是回归任务而异。当试图实时部署 ML 模型时，理解和优化 ML 模型以在这些指标上表现良好可能是一件需要考虑的重要事情。检查数据的质量总是一件好事，因为应该考虑到这样一个原则，即如果提供给模型的数据没有显示出与目标变量的任何关系，我们很可能最终会从我们定义的 KPI 模型中获得糟糕的性能。因此，尝试为我们正在尝试解决的问题收集最合适的数据可以对模型的性能产生重大的**积极影响**。

## 探索性数据分析

![](img/68e46ab52e852c609910c4b4629b3dc8.png)

卡洛斯·穆扎在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

获得对预测很重要的正确数据后，现在是时候探究数据中的要素和输出变量之间是否存在任何关系了。使用**有用的可视化工具**，如柱状图、散点图和计数图，在很大程度上有助于理解和分析数据，以便向利益相关者解释清楚。此外，也可能是我们的数据包含大量的**缺失值**或**异常值**。当数据中存在异常值时，它通常会认为这些异常值非常重要，从而扰乱模型；当我们的模型面对实际数据时，它通常会在实时部署时失败。因此，探索数据并了解是否存在异常值或缺失值被认为是一种有用的做法。处理缺失值也是至关重要的，因为有许多 ML 模型对缺失值**不鲁棒**。当我们试图给出包含缺失值的数据时，我们经常会出错。有多种策略可用于处理缺失值，如**均值**、**中值**或**模式插补**以及其他一些策略。

## 数据预处理

![](img/012baa9e3fcf04206f093dd45a5ef691.png)

克里斯·劳顿在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

现在，我们对 ML 项目的总体目标有了很好的理解，也对基于各种图生成的可视化数据有了直觉。正如在文章的上一部分中所讨论的，我们的数据经常包含许多缺失值或异常值。因此，现在是时候在将这些值输入 ML 模型进行预测之前处理它们了。完成这些步骤后，执行**数据标准化**也很重要，因为这对大多数模型都很有用。除此之外，必须考虑**分类特征**的存在。通过考虑各种特征编码技术，它们可以被转换成**数字特征**。在执行了这里提到的所有步骤之后，现在是时候训练这些模型了，我们将在本文的下一部分讨论这些模型。

如果您对了解可以对数据采取的各种预处理步骤更感兴趣，可以随意看看我以前的文章，在那里我详细地提到了它们。下面是链接。

[机器学习和数据科学中最重要的预处理步骤是什么？|作者 Suhas Maddali | 2022 年 5 月|迈向数据科学(medium.com)](https://medium.com/towards-data-science/what-are-the-most-important-preprocessing-steps-in-machine-learning-and-data-science-a7606d18f32a)

## 训练机器学习(ML)模型

![](img/47d274c2130c024dd30d9b8672b840cb.png)

尼克·莫里森在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

您已经准备好了用于 ML 模型的数据，以便它们做出有用的预测。现在是时候**训练**我们的模型，让它们从数据中学习一些重要的表示，然后才能对结果或目标变量做出猜测。我们训练各种模型，以根据我们在机器学习工作流程的第一部分中定义的**关键绩效指标(KPI)** 找出可以部署的高性能模型。在训练和执行超参数调整以获得最佳模型之后，我们最终决定**实时部署** it，这是工作流程的下一步。

## 部署模型

![](img/197b1ae0707d55df4c7d58fb4c354166.png)

Nguyen Dang Hoang Nhu 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

我们已经训练了各种模型，也执行了**超参数调整**(改变模型中的参数以获得最佳性能)，现在是时候实时部署它并了解它的性能了。虽然我们不知道我们的输出标签实时看起来会是什么样子，但我们应该使用我们的**领域知识、**和来自他人的**专业知识**来判断我们的模型是否真的在轨道上，以及它是否正在做出实际上是预期的预测。与预期性能的任何偏差都可能对模型在组织中实际创造的业务价值产生重大影响。这就是我们将在本文的下一部分讨论的应该对模型进行持续**监控**的地方。

## 监控性能

![](img/e6288667a3a781d99f15ace82a553b8e.png)

照片由 [Jorge Ramirez](https://unsplash.com/@jorgedevs?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

工作流程的最后一步是不断地**监控**模型的性能，看看它的表现如何，是否符合 KPI 的预期。有人可能会问，如果没有输出标签，我们实际上如何确定性能。这是个好问题。在这种情况下，我们使用自己的领域知识和来自他人的专业知识，来找出当人类分析师对特定结果做出猜测时，显示的结果是否与通常预期的结果相匹配。如果它与人类分析师的匹配，这意味着我们的模型表现得相当好。另一方面，可能存在模型在部署后表现不佳的情况。在这种情况下，一个解决方案是**重新训练**模型，并改变反映当前而不仅仅是过去模式的数据，以便它可以学习新的表示。然而，当我们不经常监控模型的性能时，可能会出现诸如概念漂移或数据漂移之类的情况，这些情况会导致模型在运行时的性能非常差。因此，在最后阶段持续监控和评估模型的性能可能是一件好事。

## 结论

阅读完这篇文章后，希望你对机器学习的整体工作流程有了一个良好的直觉，详细描述了各个步骤。通过学习整个工作流程中的步骤，人们可以投入时间和精力来改进项目中需要仔细关注的某些方面。有时可能更强调训练 ML 模型，而不是更关注数据预处理方面的事情。应该始终考虑到，所提供数据的质量在很大程度上决定了模型的结果和性能的质量。因此，在管道的每个部分花费适当的时间是开发 ML 解决方案并从中产生业务影响和价值的非常有效的方法。感谢您花时间阅读这篇文章。

以下是您联系我或查看我作品的方式。谢了。

**GitHub:** [苏哈斯马达利(Suhas Maddali)](https://github.com/suhasmaddali)

**LinkedIn:** [(1)苏哈斯·马达利，东北大学，数据科学| LinkedIn](https://www.linkedin.com/in/suhas-maddali/)

**培养基:** [苏哈斯·马达利—培养基](https://suhas-maddali007.medium.com/)

感谢本·胡伯尔曼(隐藏)