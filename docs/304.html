<html>
<head>
<title>Named Entity Recognition with Spacy and the Mighty roBERTa</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Spacy和强大的roBERTa进行命名实体识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/named-entity-recognition-with-spacy-and-the-mighty-roberta-97d879f981#2022-01-11">https://towardsdatascience.com/named-entity-recognition-with-spacy-and-the-mighty-roberta-97d879f981#2022-01-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="876d" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">用Spacy和强大的roBERTa进行命名实体识别</h1></div><div class=""><h2 id="463a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">命名实体识别(NER)，文本数据挖掘的一个重要方面</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a5a1051d6654dd981e0dbb194665795d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8FSmJfHcxwbx1A21jxpww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="f52d" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><p id="7250" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">当阅读文本时，人类可以自然地识别命名的实体，如日期、货币、位置、人名、医疗代码、品牌等。然后，该步骤可能与从大文本数据中进一步提取信息相关，以便更好地回答以下问题:</p><ul class=""><li id="b19b" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated">新闻中的covid19变体趋势名称是什么？</li><li id="4705" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated">在给定的工作描述中提到了哪些工具，熟练程度如何？</li><li id="534b" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated">等等。</li></ul><p id="502d" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">本文的目标是使用spaCy transformers中的spaCy和roBERTa来自动识别和提取前面介绍中定义的实体。</p><h1 id="7d3c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">命名实体识别与提取</h1><p id="1f74" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">如果你喜欢，可以在YouTube上观看完整视频:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><h2 id="6965" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">实验数据</h2><p id="74a3" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们将执行两个不同文本数据的实体提取，一个短文本和一个更长的文本(分别来自CNN 和<a class="ae nt" href="https://stocks.etoro.com/en/dynamic?symbol=aapl&amp;gc=stocks&amp;gclid=Cj0KCQiAieWOBhCYARIsANcOw0wukvjrvjE89sMrm8z17zXjVxPMhNQJ0l2_aJu3SS0yMrVOb53_EjMaAqLkEALw_wcB&amp;gclid=Cj0KCQiAieWOBhCYARIsANcOw0wukvjrvjE89sMrm8z17zXjVxPMhNQJ0l2_aJu3SS0yMrVOb53_EjMaAqLkEALw_wcB&amp;utm_medium=SEM&amp;utm_source=35552&amp;utm_content=0&amp;utm_serial=CAMP_13173467172%7CAG_126138830561%7CCP_ZeroStocks_%7CKW_Trading%20aapl%20stocks_MT_e&amp;utm_campaign=CAMP_13173467172%7CAG_126138830561%7CCP_ZeroStocks_%7CKW_Trading%20aapl%20stocks_MT_e&amp;utm_term=&amp;cq_src=google_ads&amp;cq_cmp=13173467172&amp;cq_term=trading%20aapl%20stocks&amp;cq_plac=&amp;cq_net=g&amp;cq_plt=gp" rel="noopener ugc nofollow" target="_blank"> Etoro </a>)最后，比较传统spaCy和roBERTa的性能。</p><ul class=""><li id="3227" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated"><strong class="ls iu"> <em class="nu">短文</em> </strong> : <em class="nu">艾米·施耐德，一位来自加州奥克兰的工程经理，成为《危险边缘》节目的第一位女性和第四位主持人。“在周五的比赛中赢得超过100万美元的奖金”。</em></li><li id="ccf3" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><strong class="ls iu"> <em class="nu">较长正文:</em></strong><em class="nu">对消费者来说无疑是好消息，对投资者来说也是好消息。苹果公司最近的业绩涵盖了截至2016年1 2月31日的三个月，该公司首席财务官卢卡·马埃斯特里宣布:“我们在本季度通过股票回购和股息向投资者返还了近150亿美元。”季度股息为每股57美分，与前三个季度的股息相同，高于此前四个季度的每股52美分。苹果公司生意兴隆。1月31日，苹果首席执行官蒂姆·库克(Tim Cook)在谈到2016年最后三个月时说:“我们很高兴地宣布，我们的假日季度业绩创造了苹果有史以来最高的季度收入，并打破了多项纪录。我们卖出了比以往更多的iPhone，并创造了iPhone、服务、Mac和Apple Watch的历史收入记录</em></li></ul><h2 id="c19e" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">先决条件</h2><p id="7c8c" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这是关于安装分析所需的所有库。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv ng l"/></div></figure><h2 id="d347" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">提取和可视化命名实体的步骤</h2><p id="909c" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">第一个函数<strong class="ls iu"><em class="nu">print _ entities</em></strong>用于从给定的文本和管道中提取命名实体(在我们的例子中是传统的spaCy或spaCy transformer)。它的工作原理如下:</p><ul class=""><li id="1b62" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated"><code class="fe nw nx ny nz b">pipeline</code>是我们从<code class="fe nw nx ny nz b">spacy.load</code>指令中得到的语言对象。它包含处理<code class="fe nw nx ny nz b">text</code>所需的所有组件和数据</li><li id="3e6e" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated"><code class="fe nw nx ny nz b">pipeline(text)</code>运行<code class="fe nw nx ny nz b">pipeline</code>并返回已处理的<code class="fe nw nx ny nz b">document</code></li><li id="df50" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated">命名实体是通过迭代<code class="fe nw nx ny nz b">document.ents</code>对象获得的。</li><li id="cb98" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated">然后在每次迭代中，我们可以从<code class="fe nw nx ny nz b">.text</code>访问实体文本，从<code class="fe nw nx ny nz b">.label_</code>访问实体标签</li></ul><p id="7345" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">第二个函数<strong class="ls iu"><em class="nu">visualize _ entities</em></strong>执行<code class="fe nw nx ny nz b">displacy.render</code>函数来产生所有实体的良好可视化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv ng l"/></div></figure><p id="3598" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">既然我们已经安装了所有的库并定义了命名实体提取函数，我们就可以继续进行分析了。</p><h2 id="e6ca" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">传统空间</h2><p id="4722" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这是一个面向工业级自然语言处理的开源库，已经在<a class="ae nt" href="https://catalog.ldc.upenn.edu/LDC2013T19" rel="noopener ugc nofollow" target="_blank"> OntoNotes 5.0 </a>语料库上进行了训练。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv ng l"/></div></figure><p id="4797" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><strong class="ls iu"> <em class="nu">分析短文</em> </strong></p><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="d43a" class="nh kz it nz b gy oe of l og oh">print_entities(nlp_sm, short_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/a3b5a241f91bce0d7e24e79c341ca986.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*r7j8JaFgI0tjETQFcRZPkQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:实体文本和短文本的相应标签(图片由作者提供)</p></figure><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="8acc" class="nh kz it nz b gy oe of l og oh">visualize_entities(nlp_sm, short_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/9cde2e9f9f85bfa1ceac9a04aebc91d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ee5HXHr-rxP-PZhbDvk3Vw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:实体文本的可视化和短文本的相应标签(图片由作者提供)</p></figure><p id="9abe" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">传统空间成功地将CNN识别为一个组织(ORG)，Amy Schneider识别为一个人，Oakland和California识别为地理政治实体(GEP)等。你可以在文件<a class="ae nt" href="https://catalog.ldc.upenn.edu/docs/LDC2013T19/OntoNotes-Release-5.0.pdf" rel="noopener ugc nofollow" target="_blank">的</a><a class="ae nt" href="https://catalog.ldc.upenn.edu/docs/LDC2013T19/OntoNotes-Release-5.0.pdf" rel="noopener ugc nofollow" target="_blank">实体名称注释</a>部分找到实体代码定义的详尽列表。</p><p id="e6d5" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><strong class="ls iu"> <em class="nu">分析长文</em> </strong></p><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="d000" class="nh kz it nz b gy oe of l og oh">print_entities(nlp_sm, long_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/6b607391436bfa486c776310bb7b7663.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*lMvjGpYsYClNmtO5SQr51w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3:实体文本和较长文本的相应标签(图片由作者提供)</p></figure><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="7810" class="nh kz it nz b gy oe of l og oh">visualize_entities(nlp_sm, short_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/3662596e37482c0f14ded9c0769a19f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*li67ZUQGiaI6O0rLV9DNow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4:实体文本的可视化和较长文本的相应标签(图片由作者提供)</p></figure><p id="e5f7" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><strong class="ls iu">观察</strong>:对于短文本，结果看起来很完美，因为所有的实体都被正确识别了。但是，对于第二个文本，模型犯了以下错误</p><ul class=""><li id="2009" class="mm mn it ls b lt mo lw mp lz mq md mr mh ms ml mt mu mv mw bi translated">将<strong class="ls iu"> Apple Watch </strong>误认为是<strong class="ls iu">Organization</strong>(组织)而不是产品。</li><li id="44d7" class="mm mn it ls b lt mx lw my lz mz md na mh nb ml mt mu mv mw bi translated">缺少识别<strong class="ls iu"> iPhone </strong>和<strong class="ls iu"> Mac。</strong></li></ul><p id="030e" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">让我们看看罗伯塔模型在同样的文本上是如何表现的。</p><h2 id="5b18" class="nh kz it bd la ni nj dn le nk nl dp li lz nm nn lk md no np lm mh nq nr lo ns bi translated">太空变形金刚—罗伯塔</h2><p id="3b71" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这是来自2019年spaCy推出的<code class="fe nw nx ny nz b">spacy-transformers</code>库。它旨在通过将spacy连接到HuggingFace的变压器模型来为spaCy管道供电。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv ng l"/></div></figure><p id="5333" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><strong class="ls iu"> <em class="nu">分析短文</em> </strong></p><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="cb9d" class="nh kz it nz b gy oe of l og oh">print_entities(roberta_nlp, short_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/c4a642ffcc5dd309f5d11c48fc710c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*1k4o-re-v8NybrWqhdpjVQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:实体文本和长文本的相应标签(图片由作者提供)</p></figure><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="885b" class="nh kz it nz b gy oe of l og oh">visualize_entities(roberta_nlp, short_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/08eadadcb20bb8beeedc1e2fd0b14f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2b0KeY1uJrMkQoxQ_Ix2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:实体文本的可视化和长文本的相应标签(图片由作者提供)</p></figure><p id="7302" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">到目前为止，一切都很好，与短文本上传统空间的结果相比没有什么变化。</p><p id="ebc9" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><strong class="ls iu"> <em class="nu">分析长文</em> </strong></p><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="e782" class="nh kz it nz b gy oe of l og oh">print_entities(roberta_nlp, long_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/ba9ddc8b006f28431930eb02b74f3b02.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*x3wwkxaNhVRHHVcDJx5QEA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:实体文本和较长文本的相应标签(图片由作者提供)</p></figure><pre class="kj kk kl km gt oa nz ob oc aw od bi"><span id="6927" class="nh kz it nz b gy oe of l og oh">visualize_entities(roberta_nlp, long_text)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/b6cb8c96232578e3974292d42eddb905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tvtq5rAXNHqO8djY4U6Zw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:实体文本的可视化和较长文本的相应标签(图片由作者提供)</p></figure><p id="ee57" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">下面的汇总表包含传统spacy和roBERTa对长文本的结果。我们可以清楚地看到，罗伯塔的表现优于传统空间。罗伯塔只失败过一次，就是没有认出麦克。另一方面，传统空间无法识别iPhone和Mac，但也错误地识别了Apple Watch。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/f6344526de0af8ab7b16d35519c5c472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*erPiEUawB0ucnziV6LFfRA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8:实体标识对照表。罗伯塔胜过传统空间(图片由作者提供)</p></figure><p id="3247" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">我希望这篇文章是有用的。通过从下面的链接运行我的GitHub中的代码，自己尝试一下。在YouTube<a class="ae nt" href="https://www.youtube.com/channel/UC9xKdy8cz6ZuJU5FTNtM_pQ" rel="noopener ugc nofollow" target="_blank">上关注我</a>以获得更多互动会话！</p><h1 id="2bcd" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">额外资源</h1><p id="a849" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated"><a class="ae nt" href="https://github.com/keitazoumana/Named-Entity-Recognition" rel="noopener ugc nofollow" target="_blank"> GitHub </a></p><p id="d273" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">英语空间<a class="ae nt" href="https://spacy.io/models/en#en_core_web_sm" rel="noopener ugc nofollow" target="_blank"/></p><p id="c2da" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated"><a class="ae nt" href="https://pythonrepo.com/repo/explosion-spacy-transformers-python-natural-language-processing" rel="noopener ugc nofollow" target="_blank">太空变形金刚</a></p><p id="8bbf" class="pw-post-body-paragraph lq lr it ls b lt mo ju lv lw mp jx ly lz nc mb mc md nd mf mg mh ne mj mk ml im bi translated">再见🏃🏾</p></div></div>    
</body>
</html>