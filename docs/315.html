<html>
<head>
<title>Another Steep Curve? Predicting India’s COVID-19 Third Wave with LSTM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">又一个陡峭的曲线？与LSTM一起预测印度的新冠肺炎第三次浪潮</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/another-steep-curve-predicting-indias-covid-19-third-wave-with-lstm-ec4fac848d70#2022-01-11">https://towardsdatascience.com/another-steep-curve-predicting-indias-covid-19-third-wave-with-lstm-ec4fac848d70#2022-01-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="2f1e" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">又一个陡峭的曲线？与LSTM一起预测印度的新冠肺炎第三次浪潮</h1></div><div class=""><h2 id="02cd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">完成项目，预测新的新冠肺炎病例在未来90天与LSTM(代码包括在内)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7b967eab2a0f1db814e31f232e698989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yG1ev-P5kYuIRER4X-fAeg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:作者。</p></figure><p id="89bb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">印度的新冠肺炎病例再次急剧上升！截至2021年12月27日，仅登记了6，358起新病例。但是仅仅在2022年1月10日的14天里，就有168063个新病例被登记。第三波的曲线非常陡峭，这就是为什么它现在是一个大问题。</p><p id="09da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我考虑使用人工递归神经网络(RNN)结构长期短期记忆(LSTM)来预测新冠肺炎图在不久的将来(接下来的90天)会是什么样子。</p><h1 id="6c96" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">数据集:</h1><p id="269a" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">数据集由DataMeet 从“<a class="ae mr" href="https://projects.datameet.org/covid19/" rel="noopener ugc nofollow" target="_blank">新冠肺炎印度数据集”下载。这些数据是社区从不同的政府网站收集、整理和组织的，所有印度人都可以免费使用。</a></p><p id="47f7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Github库:【https://github.com/datameet/covid19 T2】</p><p id="ecc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该数据集拥有知识共享署名4.0国际公共许可证。数据集于2022年1月10日下载，包含截至同一日期的数据。</p><p id="795f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们正在使用文件<em class="ms"> all_totals。JSON </em>文件在<em class="ms">数据</em>目录下。预处理步骤演示了我如何处理来自这个JSON文件的数据，以便将其用于LSTM架构。</p><h1 id="5efe" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">方法学</h1><p id="8097" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">让我们讨论一下我如何执行项目的方法。之后的结果部分将讨论我们从整个项目中得到的结果。</p><h2 id="afcc" class="mt lv it bd lw mu mv dn ma mw mx dp me lh my mz mg ll na nb mi lp nc nd mk ne bi translated">导入库:</h2><p id="f705" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">让我们为项目导入必要的库。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="9334" class="mt lv it ng b gy nk nl l nm nn">import json<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from sklearn.preprocessing import MinMaxScaler<br/>from tensorflow.keras.models import Sequential<br/>from tensorflow.keras.layers import LSTM,Activation,Dense,Dropout<br/>%matplotlib inline<br/>scaler = MinMaxScaler()<br/>from tensorflow.keras.callbacks import EarlyStopping</span></pre><h2 id="0b32" class="mt lv it bd lw mu mv dn ma mw mx dp me lh my mz mg ll na nb mi lp nc nd mk ne bi translated">数据预处理:</h2><p id="98c7" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">来自数据集all_totals。JSON，我创建了一个数据框架，包含每天登记的新案例。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="969a" class="mt lv it ng b gy nk nl l nm nn">f = open('all_totals.json')<br/># returns JSON object as a dictionary<br/>data = json.load(f)</span><span id="377c" class="mt lv it ng b gy no nl l nm nn">total_cases_list = []<br/>new_cases_list = []<br/>    <br/>pre_total_cases = 0<br/>for row in data["rows"]:<br/>    if "total_confirmed_cases" in row["key"]:<br/>        temp_list = []<br/>        temp_list.append(row["key"][0][0:10]) # Appending the date (the time part is trimmed)<br/>        temp_list.append(row["value"]) # Appending the value on that date<br/>        total_cases_list.append(temp_list)<br/>        <br/>        temp_list_2 = []<br/>        temp_list_2.append(row["key"][0][0:10])<br/>        temp_list_2.append((row["value"] - pre_total_cases)) # Appending the value on that date<br/>        new_cases_list.append(temp_list_2)<br/>        <br/>        pre_total_cases = row["value"]<br/>    <br/>df_total = pd.DataFrame(total_cases_list, columns = ["Date", "Total Cases"])<br/>df_new = pd.DataFrame(new_cases_list, columns = ["Date", "New Cases"])</span></pre><p id="ba2d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">名为<em class="ms"> df_new </em>的数据帧包含从<strong class="la iu">2020–01–30开始每天登记的新案例(某些日期缺失)。</strong></p><p id="7477" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们将“日期”字段作为索引。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="fa58" class="mt lv it ng b gy nk nl l nm nn">df_total = df_total.set_index("Date")<br/>df_new = df_new.set_index("Date")</span></pre><p id="a4db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们删除文件中的一些错误值:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="2a95" class="mt lv it ng b gy nk nl l nm nn">#deleting two faulty values</span><span id="234b" class="mt lv it ng b gy no nl l nm nn">df_total.drop('2021-09-16', inplace=True, axis=0)<br/>df_total.drop('2021-09-17', inplace=True, axis=0)<br/>df_total.drop('2021-07-21', inplace=True, axis=0)<br/>df_total.drop('2021-07-22', inplace=True, axis=0)</span><span id="4ade" class="mt lv it ng b gy no nl l nm nn">df_new.drop('2021-09-16', inplace=True, axis=0)<br/>df_new.drop('2021-09-17', inplace=True, axis=0)<br/>df_new.drop('2021-07-21', inplace=True, axis=0)<br/>df_new.drop('2021-07-22', inplace=True, axis=0)</span></pre><p id="e660" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是数据帧现在的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/1a6fbad376d726bb838a2c0fdd761162.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*vSNOhZ0OwCR2E-XP2AT1Sw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集摘要。图片来源:作者。</p></figure><p id="4f89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看在印度登记的新冠肺炎病例总数曲线:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/a64c92fff692b9c616f3f17e4e5cd2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPoqm0jXKARR8uzu62yC_g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">印度登记的病例总数。图片来源:作者。</p></figure><p id="d072" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是印度新增新冠肺炎病例的曲线图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/11827feee480c2b39ab41859828ddfe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNywrLUQTzbdE79jJjHTUw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">印度登记的新病例。图片来源:作者。</p></figure><p id="7345" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们将构建训练数据集和训练标签。训练数据集将是时间序列数据。我们选择90天作为时间序列数据的窗口大小。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="1033" class="mt lv it ng b gy nk nl l nm nn">day = 90 # Number of days (window size)</span></pre><p id="dba8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们创建训练数据集和训练标签。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="d00a" class="mt lv it ng b gy nk nl l nm nn">k = 0</span><span id="799e" class="mt lv it ng b gy no nl l nm nn">array = []<br/>array_temp = []<br/>train_data = []<br/>train_labels = []</span><span id="875f" class="mt lv it ng b gy no nl l nm nn">for i in range(len(df_new)):<br/>    array_temp.append(df_new.iloc[i]['New Cases'])</span><span id="ace4" class="mt lv it ng b gy no nl l nm nn">array_temp = np.array(array_temp).reshape(-1,1)<br/>array_temp = scaler.fit_transform(array_temp)<br/>array_temp = array_temp.tolist()</span><span id="4248" class="mt lv it ng b gy no nl l nm nn">for i in array_temp:<br/>    array.append(i[0])</span><span id="19dc" class="mt lv it ng b gy no nl l nm nn">for i in range(len(array)):<br/>    try:<br/>        train_data.append(array[k:day+k]) # Creating inner lists with 'day' days of data<br/>        train_labels.append([array[day+k]])<br/>        k+=1<br/>    except:<br/>        break</span><span id="76ec" class="mt lv it ng b gy no nl l nm nn">length = max(map(len, train_data))<br/>train_data=np.array([xi+[None]*(length-len(xi)) for xi in train_data]).astype('float32')</span><span id="4ed5" class="mt lv it ng b gy no nl l nm nn">length = max(map(len, train_labels))<br/>train_labels = np.array([xi+[None]*(length-len(xi)) for xi in train_labels]).astype('float32')</span></pre><p id="32df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们使用<a class="ae mr" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html" rel="noopener ugc nofollow" target="_blank">最小最大缩放器</a>将我们的数据带入0-1范围。然后我们对它进行了整形，使它只有一列和<em class="ms"> n </em>行数(<em class="ms"> n </em> =数组中的元素数)。之后，我们将数组转换为列表。</p><p id="b78e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们创建了训练数据。对于一个列表中的每90个点，第91个点将是它们的标签。然后我们创建了一个包含90分的列表列表。我们创建了另一个包含标签的列表。稍后，所有这些列表都被转换成NumPy数组和NumPy数组或数组。</p><p id="5f70" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练和标注数据集的形状如下所示:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="feb6" class="mt lv it ng b gy nk nl l nm nn">print(train_data.shape)<br/>print(train_labels.shape)</span></pre><p id="0ac7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">形状:</p><p id="ffd5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> (644，90) <br/> (643，1) </strong></p><p id="a976" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们扩展LSTM体系结构的训练数据集的维度。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="fa99" class="mt lv it ng b gy nk nl l nm nn">train_data = train_data[:len(train_labels)]<br/>train_data = np.expand_dims(train_data,1)<br/>train_data.shape</span></pre><p id="ce2a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">形状:<strong class="la iu"> (643，1，90) </strong></p><p id="cd65" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们看看一行训练数据是什么样子的。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="e4cf" class="mt lv it ng b gy nk nl l nm nn">train_data[1]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/1913365303b508df518300b7f63f0ec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sMsXONgr83_s_h7NUQjZUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练数据集的一行。图片来源:作者。</p></figure><p id="a469" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看标签数据集中的一行是如何:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="3945" class="mt lv it ng b gy nk nl l nm nn">train_labels[1]</span></pre><p id="151d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:<em class="ms">数组([0.0027741]，dtype=float32) </em></p><h2 id="48b2" class="mt lv it bd lw mu mv dn ma mw mx dp me lh my mz mg ll na nb mi lp nc nd mk ne bi translated">建筑:</h2><p id="099a" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">让我们现在就建造LSTM建筑</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="5a4e" class="mt lv it ng b gy nk nl l nm nn">model = Sequential()</span><span id="ba83" class="mt lv it ng b gy no nl l nm nn">model.add(LSTM(250,input_shape=(1,day)))<br/>model.add(Dropout(0.5))</span><span id="438c" class="mt lv it ng b gy no nl l nm nn">model.add(Dense(250,activation='relu'))<br/>model.add(Dropout(0.5))</span><span id="7e96" class="mt lv it ng b gy no nl l nm nn">model.add(Dense(day,activation='relu'))<br/>model.add(Dropout(0.5))</span><span id="7cf5" class="mt lv it ng b gy no nl l nm nn">model.add(Dense(1,activation='relu'))</span><span id="a987" class="mt lv it ng b gy no nl l nm nn">model.compile(loss='mean_squared_error',optimizer='adam')</span><span id="5695" class="mt lv it ng b gy no nl l nm nn">model.summary()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/8b85586ff56ecf84e4aa8d2953ef7742.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*wHwvkNKvYwJUNzpnugTFBg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">LSTM建筑概要。图片来源:作者。</p></figure><h2 id="fd6d" class="mt lv it bd lw mu mv dn ma mw mx dp me lh my mz mg ll na nb mi lp nc nd mk ne bi translated">培训:</h2><p id="5625" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">现在让数据适合模型。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="806b" class="mt lv it ng b gy nk nl l nm nn">E = 1000<br/>callback = EarlyStopping(monitor='loss', mode='min', patience=20)<br/>H = model.fit(train_data,train_labels,epochs=E, verbose=0, callbacks=[callback])</span></pre><p id="f025" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">训练步骤完成后，让我们绘制损失值。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="203a" class="mt lv it ng b gy nk nl l nm nn">loss = H.history['loss']<br/>epochs = range(0,len(loss))<br/>plt.figure(figsize=(15,5))<br/>plt.plot(epochs,loss)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/9d7827d4a60c8a9d20a7bedb3cf22807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBXYIs44KC5BKe7YV5JsWA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个时期的损失值图。图片来源:作者。</p></figure><p id="b248" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们把LSTM给出的预测和每天新登记的新冠肺炎病例的真实值一起画出来，看看这些预测有多准确。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="1f3b" class="mt lv it ng b gy nk nl l nm nn">preds = scaler.inverse_transform(model.predict(train_data))<br/>plt.figure(figsize=(30,10))<br/>plt.plot(preds,label='our predictions')<br/>plt.plot(scaler.inverse_transform(train_labels),label='real values')<br/>plt.legend()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/181a652f42dd506e50b38785b07a23de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DY1DAlnYGeRV-osAsHsMgw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预测值和实际值(每天新登记的新冠肺炎病例)。图片来源:作者。</p></figure><p id="fc59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这个图表中，我们可以看到预测值非常准确，模型非常有前途。</p><h2 id="b8a6" class="mt lv it bd lw mu mv dn ma mw mx dp me lh my mz mg ll na nb mi lp nc nd mk ne bi translated">未来预测:</h2><p id="09f5" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">让我们试着预测一下这条曲线在不久的将来。我们将尝试预测未来90天(从2022年1月10日开始)印度将有多少新增新冠肺炎病例。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="b8ec" class="mt lv it ng b gy nk nl l nm nn">days_to_predict = 90<br/>seed = array[-day:]<br/>#seed</span></pre><p id="8461" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在这里所做的是，我们正在创建一个<strong class="la iu">种子。</strong>种子就是<em class="ms">数组</em>中最近90天的数据。我们将使用这个种子来预测第二天的数据。当它将预测它时，我们将更新我们的种子，并使它包含将在下一次预测中使用的预测数据。</p><p id="3958" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们举个例子。种子首先包含截至2022年1月10日的最近90天的数据(每天登记多少个新covid病例的值)。使用它，我们将预测2021年1月11日的值。然后，我们将使用2022年1月11日的预测数据作为种子中的数据点，并预测2022年1月12日的值数据，依此类推。</p><p id="9740" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们使用这个模型来预测未来90天的病例数:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="0516" class="mt lv it ng b gy nk nl l nm nn">for _ in range(days_to_predict):<br/>    current_days = seed[-day:]<br/>    current_days = np.squeeze(current_days)<br/>    current_days = np.expand_dims(current_days,0)<br/>    current_days = np.expand_dims(current_days,0)<br/>    pred = model.predict(current_days)<br/>    seed = np.append(seed,pred)</span></pre><p id="cd9d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们绘制预测值:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="6987" class="mt lv it ng b gy nk nl l nm nn">upcoming_days_prediction = scaler.inverse_transform(seed[-days_to_predict:].reshape(-1,1))<br/>plt.figure(figsize=(30,10))<br/>plt.plot(range(0,days_to_predict),upcoming_days_prediction)</span></pre><p id="71e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们将预测值与数据集中的值相加，并绘制完整的图表。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="f61c" class="mt lv it ng b gy nk nl l nm nn"># Adding real values and predicted values together<br/>arr_without_pred = scaler.inverse_transform(train_labels)<br/>arr_pred = scaler.inverse_transform(seed[-days_to_predict:].reshape(-1,1))<br/>arr_with_pred = np.concatenate((arr_without_pred, arr_pred))</span><span id="7e2e" class="mt lv it ng b gy no nl l nm nn">plt.figure(figsize=(30,10))<br/>plt.plot(arr_with_pred)</span></pre><h1 id="d19e" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结果:</h1><p id="a6b1" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在我们看到结果之前，我希望你喜欢阅读这篇文章。如果你有，请成为灵媒的一员。只要每月5美元，你就可以阅读Medium上的任何文章(不仅仅是我的文章，任何文章)。单击下面的链接。</p><p id="0514" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae mr" href="https://samratduttaofficial.medium.com/membership" rel="noopener">https://samratduttaofficial.medium.com/membership</a></p><p id="a77b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将从5美元中获得一点佣金，这将激励我写更多！</p><p id="8efb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看对未来90天(从2022年1月11日开始)新登记的新冠肺炎病例的预测。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/59ce5c15202f42c91bdba1f713f72dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o6s1LKaRBfiTtXPop8cs6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对未来90天新登记的新冠肺炎病例的预测。图片来源:作者。</p></figure><p id="cf5d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看每天新登记的新冠肺炎病例的完整图表，以及未来90天(从2022年1月11日开始)的预测值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/10c3f4c91f5d01ec12c4756538780caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A3ydfWSHxm41UpldjSdhzw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每天新登记的新冠肺炎病例，以及未来90天的预测值。图片来源:作者。</p></figure><p id="9a59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么，在接下来的90天里，该模型总共预测了多少个案例呢？</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="0f8f" class="mt lv it ng b gy nk nl l nm nn">total_new_cases = 0<br/>for i in upcoming_days_prediction:<br/>    total_new_cases += i[0]<br/>    #print(i)<br/>print(total_new_cases)</span></pre><p id="669c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">答案是:<strong class="la iu">23417088</strong></p><p id="6dea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该模型预测，在未来90天内(从2022年1月11日开始)，印度将出现约2350万例新新冠肺炎病例。</p><h1 id="72ac" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><p id="1db3" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">这项研究/项目只是展示了LSTM体系结构在预测时间序列数据中的应用。在这种情况下，我们使用印度的新冠肺炎数据进行研究。该模型在进行预测时没有考虑传染性和其他因素。</p><p id="aefb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于奥米克隆变异体的传播率远高于新冠肺炎的三角洲变异体(三角洲变异体是第二波疫情期间的主导变异体)，我个人认为，我们将在不久的将来看到一条更陡、更高的曲线。</p><p id="f2bf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但我不是卫生工作者或医生。所以对我说的一切都要持保留态度。</p><p id="72c6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">【https://github.com/SamratDuttaOfficial/Covid_India_LSTM】储存库:<a class="ae mr" href="https://github.com/SamratDuttaOfficial/Covid_India_LSTM" rel="noopener ugc nofollow" target="_blank"/></p><p id="edb9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一定要给Github库打一颗星。</p><h1 id="7752" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">萨姆拉特·杜塔:</h1><p id="40f2" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated"><strong class="la iu">Github:</strong><a class="ae mr" href="https://github.com/SamratDuttaOfficial" rel="noopener ugc nofollow" target="_blank">https://github.com/SamratDuttaOfficial</a></p><p id="afc4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">Linkedin:</strong><a class="ae mr" href="https://www.linkedin.com/in/SamratDuttaOfficial" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/SamratDuttaOfficial</a>【雇佣我】</p><p id="c0e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">最聪明的朋友(机器学习)不和:</strong><a class="ae mr" href="https://discord.gg/7Bx6PGVy" rel="noopener ugc nofollow" target="_blank">https://discord.gg/7Bx6PGVy</a></p><p id="f262" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">给我买杯咖啡:【https://www.buymeacoffee.com/SamratDutta】T22</p></div></div>    
</body>
</html>