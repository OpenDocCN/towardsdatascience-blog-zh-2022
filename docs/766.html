<html>
<head>
<title>The Gromov–Wasserstein Distance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">格罗莫夫-沃瑟斯坦距离</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-gromov-wasserstein-distance-835c39d4751d#2022-01-27">https://towardsdatascience.com/the-gromov-wasserstein-distance-835c39d4751d#2022-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="8bfc" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">格罗莫夫-沃瑟斯坦距离</h1></div><div class=""><h2 id="ed08" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python中对象匹配的度量与实例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/8c7c9265f8e49d07123f56e4f2959718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*lffC_7zqRoapIXA_YHPCXw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">作者使用人工智能工具Dreamstudio生成的封面照片(授权为<a class="ae ku" href="https://creativecommons.org/publicdomain/zero/1.0/" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/publicdomain/zero/1.0/</a></p></figure><p id="0a6f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在过去的几十年里，我们看到在我们可能想到的每一个领域的数据收集都取得了突破，包括运输、零售、金融、生物信息学、蛋白质组学和基因组学、机器人学、机器视觉、模式匹配等。为了分析和组织这些数据，定义对象或数据集相似性的概念很重要。在本文中，我们将互换使用对象和数据集。在这方面，我们可以提出以下几点来界定:</p><ol class=""><li id="6e33" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">选择合适的数据集表示</li><li id="9907" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">定义两个数据集之间相等的概念</li><li id="d60d" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">定义一个度量空间，使所有对象的空间。度量必须使得到对象的距离为零，对象是相等的。其中一个距离是格罗莫夫-沃瑟斯坦距离。</li></ol><p id="2e48" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">对象匹配的概念不仅有助于建立两个数据集之间的相似性，也有助于其他类型的问题，如聚类。</p><p id="4d66" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了理解格罗莫夫-沃瑟斯坦距离，我们首先定义度量测度空间。但是在我们进入度量空间之前，让我们定义一些术语。</p><p id="d75a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">度量:</strong>集合<em class="mf"> X </em>上的一个度量<em class="mf"> d </em> <strong class="kx iu"> </strong>是一个函数使得<em class="mf"> d(x，y) = 0 </em> if <em class="mf"> x = y，x </em> ∈ <em class="mf"> X，</em>Y∈<em class="mf">Y，</em>并且满足<a class="ae ku" href="https://en.wikipedia.org/wiki/Symmetric_function" rel="noopener ugc nofollow" target="_blank">对称性</a>和<a class="ae ku" href="https://en.wikipedia.org/wiki/Triangle_inequality" rel="noopener ugc nofollow" target="_blank"> <em class="mf">三角形不等式</em>它也被称为<strong class="kx iu"> <em class="mf">距离功能</em> </strong>。</a></p><p id="d3a7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">度量空间:度量空间是一个非空集，其上定义了度量。它可以被认为是有序对(m，<em class="mf"> d </em>，使得<em class="mf">d</em>:m<strong class="kx iu">×</strong>m ℝ.我们用ℝ来表示实数集。</p><p id="a836" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在我们定义度量测度空间。</p><h1 id="c585" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">度量度量空间</h1><p id="e7f0" class="pw-post-body-paragraph kv kw it kx b ky my ju la lb mz jx ld le na lg lh li nb lk ll lm nc lo lp lq im bi translated">与度量空间相反，度量度量空间是一个三元组(M，<em class="mf"> d </em>，<em class="mf"> p </em>)，其中<em class="mf"> p </em>是一个概率度量。度量测度空间类似于度量空间，但是被赋予了概率的概念。我来解释一下。在许多应用中，我们喜欢将权重与每个点相关联，如图1所示。权重可能代表我们对这些数据点的信任程度。如图1所示，我们考虑两个度量度量空间(简称mm-space)，每个空间有两个点。这里我们定义<em class="mf">p₁</em>=[；]而<em class="mf"> p₂ </em> = [，]，总和必须是概率(或σ代数)规则定义的1。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/acc2529494b07e9c454f61844edefbc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*VKq81PXw5CbDMU4axYdGKw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图一。由作者创建</p></figure><div class="ne nf gp gr ng nh"><a rel="noopener follow" target="_blank" href="/manifold-alignment-c67fc3fc1a1c"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">歧管对齐</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">多个数据集的统一</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">towardsdatascience.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv ko nh"/></div></div></a></div><p id="c807" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">让我们再定义几个术语:</p><p id="a0fc" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">等距:</strong>假设为双射的度量空间之间的距离保持变换。<strong class="kx iu">等距变换</strong>将元素映射到相同或不同的度量空间，使得新空间中元素之间的距离与原始元素之间的距离相同。</p><p id="6405" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">同构:</strong>同构是保结构映射。在线性代数的意义上，正如大多数数据科学家所熟悉的，两个向量空间<em class="mf"> V </em>和<em class="mf"> W </em>被称为同构，如果存在从<em class="mf"> V </em>到<em class="mf"> W </em>的可逆线性变换(<strong class="kx iu">称为</strong>同构)，T。考虑图2。在图2中，我们有两套国际象棋。它们在国际象棋游戏中是同构的，尽管棋子看起来可能不同。</p><p id="edf7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">两个mm-空间是同构的，如果存在一个等距映射<em class="mf">ψ:X→y</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nw"><img src="../Images/e4f708498f33a2c7da30f0461a0586f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zj5l7NQzkJlVKQrzbiniiQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图二。来源。左:【https://unsplash.com/photos/WtdIwprWnB4】T2，右:<a class="ae ku" href="https://unsplash.com/photos/R0t2pAukP9E" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/R0t2pAukP9E</a></p></figure><p id="dc1c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">前推测度:</strong>考虑两个度量空间X和Y之间的可测映射<em class="mf"> f: X → Y </em>和<em class="mf"> p </em>的概率测度。前推测度是通过将一个测度(在我们的例子中，它是一个概率)从一个可测空间转移到另一个可测空间而获得的测度。它被表示为f# <em class="mf"> p(A) = p(f </em> ⁻ (A))其中A = 𝔅(Y)，𝔅是σ-代数(为了简单起见，就认为σ-代数定义了我们所知道的概率的概念。我参考了乔治·卡塞拉斯的统计推论以获得关于这个主题的更多细节)。我们可以把mm空间的前推度量写成<em class="mf"> ψ#(p₁) = p₂.</em></p><p id="a7f5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">考虑<em class="mf"> R ⊂ X × Y </em>是<em class="mf"> X </em>和<em class="mf"> Y </em>之间的对应关系。然后我们定义<em class="mf"> π₁(R) = X </em>和<em class="mf"> π₂(R) = Y </em>。一个概率度量<em class="mf"> p，</em>对<em class="mf"> X × Y </em>是<em class="mf"> p₁ </em>和<em class="mf"> p₂、</em>之间的耦合，如果<em class="mf"> π₁#(p₁) = p，π₂#(p₂)= p。</em>把𝓤 ( <em class="mf"> p₁，p₂ </em>)看作是<em class="mf"> p₁ </em>和<em class="mf">p 8832】</em>之间所有耦合的集合。</p><h1 id="632f" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">定义</strong>格罗莫夫-沃瑟斯坦距离</h1><p id="8234" class="pw-post-body-paragraph kv kw it kx b ky my ju la lb mz jx ld le na lg lh li nb lk ll lm nc lo lp lq im bi translated">考虑度量度量空间上的两点(x，y)和(x’，y’)。进一步，考虑点q ≥ 1。</p><p id="9dde" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">(x，y，x '，y' ) ↦ |dₓ(x，x ')—dᵧ(y，y' )|^q并挑选一个<em class="mf"> p </em> ∈ 𝓤 ( <em class="mf"> p₁，p₂ </em>)，那么我们定义q阶的格罗莫夫-瓦瑟斯坦距离为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi ob"><img src="../Images/0a5357363a9a99d7ad10e0cf62977a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_4sL4NXoCn2I8cCit2ePg.png"/></div></div></figure><h1 id="aa6d" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">格罗莫夫-瓦瑟斯坦距离的应用</h1><p id="4785" class="pw-post-body-paragraph kv kw it kx b ky my ju la lb mz jx ld le na lg lh li nb lk ll lm nc lo lp lq im bi translated">格罗莫夫-沃瑟斯坦距离可用于许多与数据科学、数据分析和机器学习相关的任务。下面列举了几个例子:</p><ul class=""><li id="d372" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq oc lx ly lz bi translated">统一多个数据集的流形对齐。</li><li id="8d19" class="lr ls it kx b ky ma lb mb le mc li md lm me lq oc lx ly lz bi translated">形状分析</li><li id="545b" class="lr ls it kx b ky ma lb mb le mc li md lm me lq oc lx ly lz bi translated"><a class="ae ku" href="https://doi.org/10.1016/j.commatsci.2020.110144" rel="noopener ugc nofollow" target="_blank">原子环境的分类</a></li><li id="c1dd" class="lr ls it kx b ky ma lb mb le mc li md lm me lq oc lx ly lz bi translated"><a class="ae ku" href="https://doi.org/10.1101/2020.04.28.066787" rel="noopener ugc nofollow" target="_blank">用于生物数据的多模态分析</a></li><li id="abcd" class="lr ls it kx b ky ma lb mb le mc li md lm me lq oc lx ly lz bi translated"><a class="ae ku" href="https://arxiv.org/pdf/2003.06048.pdf" rel="noopener ugc nofollow" target="_blank">图形对齐</a></li><li id="4152" class="lr ls it kx b ky ma lb mb le mc li md lm me lq oc lx ly lz bi translated"><a class="ae ku" href="https://doi.org/10.1109/3DV50981.2020.00057" rel="noopener ugc nofollow" target="_blank">点云分析</a></li></ul><h1 id="f737" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">Python中的格罗莫夫-瓦瑟斯坦距离</h1><p id="a450" class="pw-post-body-paragraph kv kw it kx b ky my ju la lb mz jx ld le na lg lh li nb lk ll lm nc lo lp lq im bi translated">我们将使用<code class="fe od oe of og b">POT</code> python包作为GW距离的数值示例。它可以通过以下方式安装:</p><pre class="kj kk kl km gt oh og oi oj aw ok bi"><span id="6985" class="ol mh it og b gy om on l oo op">pip install POT</span></pre><p id="24ab" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">使用GWdistance，我们可以计算不属于同一度量空间的样本的距离。我们在二维和三维空间中采样两个高斯分布。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi os"><img src="../Images/7b1257fb8110420dceb6f1fb8645eb52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdVBCSuZ5VD_9ISslvKtyQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图4。作者用Python代码画的图</p></figure><p id="f2e3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，让我们计算距离核，并将其归一化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi ot"><img src="../Images/5e0a6fa49ae0ae143dac90a71444888a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Om3FJiK9o8YXPRljgw2HYQ.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图5。作者用Python代码画的图</p></figure><p id="4cda" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">现在，我们计算GW距离:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="4db5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">上述代码的输出是:</p><pre class="kj kk kl km gt oh og oi oj aw ok bi"><span id="d06a" class="ol mh it og b gy om on l oo op">It.  |Loss        |Relative loss|Absolute loss<br/>------------------------------------------------<br/>    0|6.935296e-02|0.000000e+00|0.000000e+00<br/>    1|3.779906e-02|8.347803e-01|3.155391e-02<br/>    2|2.791583e-02|3.540367e-01|9.883228e-03<br/>    3|2.214951e-02|2.603359e-01|5.766313e-03<br/>    4|2.100683e-02|5.439603e-02|1.142688e-03<br/>    5|2.093137e-02|3.605042e-03|7.545845e-05<br/>    6|2.093137e-02|0.000000e+00|0.000000e+00<br/>Gromov-Wasserstein distances: 0.020931367451704774</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/911b3260f99e109d46f44b6ba1dbd09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*lsgY6sDwogHGtf9Qkhu8Vw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图6。作者用Python代码画的图</p></figure><p id="f508" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">执行上述GW模拟的完整脚本可以从<a class="ae ku" href="https://github.com/rahulbhadani/medium.com/blob/master/01_26_2022/GW_distance.py" rel="noopener ugc nofollow" target="_blank">https://github . com/rahulbhadani/medium . com/blob/master/01 _ 26 _ 2022/GW _ distance . py</a>获得。</p><p id="d6f0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">https://github.com/PythonOT/POT/blob/master/ot/gromov.py<a class="ae ku" href="https://github.com/PythonOT/POT/blob/master/ot/gromov.py" rel="noopener ugc nofollow" target="_blank">中提供了GW距离的详细实现。</a></p><p id="0ec9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">如果你觉得这篇文章有用，你可能也会喜欢我关于<a class="ae ku" rel="noopener" target="_blank" href="/manifold-alignment-c67fc3fc1a1c">歧管对齐</a>的文章。</p><blockquote class="ov ow ox"><p id="c09e" class="kv kw mf kx b ky kz ju la lb lc jx ld oy lf lg lh oz lj lk ll pa ln lo lp lq im bi translated"><em class="it">感谢您的阅读。如果你喜欢我的文章并想支持我的内容，我请求你通过</em><a class="ae ku" href="https://rahulbhadani.medium.com/membership" rel="noopener"><em class="it">【https://rahulbhadani.medium.com/membership</em></a><em class="it">订阅Medium。</em></p></blockquote><h1 id="c55e" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">参考</h1><ol class=""><li id="02d0" class="lr ls it kx b ky my lb mz le pb li pc lm pd lq lw lx ly lz bi translated">梅莫利，法孔多。"格罗莫夫-瓦瑟斯坦距离和物体匹配的度量方法."计算数学基础11.4(2011):417–487。</li><li id="262d" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">梅莫利，法孔多。"格罗莫夫-沃瑟斯坦距离:概述."<em class="mf">公理</em>3.3(2014):335–341。</li><li id="d16f" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">同构(抽象代数):<a class="ae ku" href="https://www.youtube.com/watch?v=BAmWgVjSosY" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=BAmWgVjSosY</a></li><li id="982b" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><a class="ae ku" href="https://optimaltransport.github.io/slides-peyre/GromovWasserstein.pdf" rel="noopener ugc nofollow" target="_blank">https://optimal transport . github . io/slides-peyre/gromovwasserstein . pdf</a></li></ol></div></div>    
</body>
</html>