<html>
<head>
<title>ARIMAX with Fourier Series</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">傅立叶级数ARIMAX</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/arimax-with-fourier-series-1d92a976f45f#2022-01-23">https://towardsdatascience.com/arimax-with-fourier-series-1d92a976f45f#2022-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="b5cb" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">傅立叶级数ARIMAX</h1></div><div class=""><h2 id="d8e1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">预测非整数季节性时间序列</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb10104a7e295a77eb09fdc7da57ea5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ppehqrCilmrAvcaZ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不是这种系列。科技日报在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae kv" href="https://unsplash.com/@techdailyca?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="9aae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可能已经使用SARIMAX对具有周期性的时间序列数据进行建模。例如，您可能有每小时一次的数据，其模式每12小时重复一次。但是你所拥有的，比如说，每周的数据，以及每年的季节性。你不能用<code class="fe ls lt lu lv b">n_periods=52</code>，因为一年的周数在52到53之间。那你是做什么的？</p><h1 id="fc9a" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">输入傅立叶级数</h1><p id="3f44" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">幸运的是，ARIMAX允许您轻松地指定额外的回归变量。那是我们传递傅立叶特征的地方。我们需要确定的是:</p><ul class=""><li id="71ba" class="mt mu iq ky b kz la lc ld lf mv lj mw ln mx lr my mz na nb bi translated">我们数据的频率是多少</li><li id="0dcd" class="mt mu iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated">什么时期了</li><li id="f799" class="mt mu iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated">我们要构造什么阶的傅立叶级数</li></ul><p id="f72d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们可以构建如下特征</p><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="3e96" class="nl lx iq lv b gy nm nn l no np">np.sin(2 * np.pi * order * t / period)</span></pre><p id="17c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和</p><pre class="kg kh ki kj gt nh lv ni nj aw nk bi"><span id="1234" class="nl lx iq lv b gy nm nn l no np">np.cos(2 * np.pi * order * t / period)</span></pre><h1 id="26a6" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">我们能举个例子吗？</h1><p id="4dd7" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">当然可以。经典的时间序列示例是<code class="fe ls lt lu lv b">flights</code>数据集，我们在其中获得每月数据。这里，周期正好是<code class="fe ls lt lu lv b">12</code>，但是即使周期是<code class="fe ls lt lu lv b">12.25</code>，这种技术也可以工作。</p><p id="1a63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在展示代码之前，请注意以下几点:</p><ul class=""><li id="de16" class="mt mu iq ky b kz la lc ld lf mv lj mw ln mx lr my mz na nb bi translated">该数据集的季节性是倍增的，因此我将对目标的日志建模，而不是对目标本身建模</li><li id="d5fc" class="mt mu iq ky b kz nc lc nd lf ne lj nf ln ng lr my mz na nb bi translated">为了选择傅立叶级数的阶数，我们只需尝试在<code class="fe ls lt lu lv b">1</code>和<code class="fe ls lt lu lv b">9</code>之间的所有阶数，然后选择具有最佳<code class="fe ls lt lu lv b">AICc</code>分数的阶数</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/8cb917ea6a2ca8f7caef2b4647724bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YbcGVRy5sUSCzNjEG63Kbw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">测试集结果，使用在训练集上选择的最佳傅立叶阶。作者图片</p></figure><p id="33b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果表明，该模型确实能够提取季节模式。</p><h1 id="308a" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">结论</h1><p id="ba7c" class="pw-post-body-paragraph kw kx iq ky b kz mo jr lb lc mp ju le lf mq lh li lj mr ll lm ln ms lp lq lr ij bi translated">我们学习了如何使用傅立叶级数和ARIMAX来模拟季节性。如果季节周期不是整数，这很有用。这种方法确实需要您为傅立叶级数选择一个阶数，我们已经看到了如何使用<code class="fe ls lt lu lv b">AICc</code>进行选择。现在出去建模一些季节性数据！</p></div></div>    
</body>
</html>