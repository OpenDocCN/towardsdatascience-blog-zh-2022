<html>
<head>
<title>Time Series Anomaly Detection with PyFBAD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于PyFBAD的时间序列异常检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-anomaly-detection-with-pyfbad-d37e5462c6c3#2022-01-14">https://towardsdatascience.com/time-series-anomaly-detection-with-pyfbad-d37e5462c6c3#2022-01-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="3a8b" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">基于PyFBAD的时间序列异常检测</h1></div><div class=""><h2 id="6071" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一种端到端的无监督离群点检测</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f7bc4998a21f92e7f873be338bd08515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Fb0HanPUwVeI09T3cRjyw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/photos/Fb6aY99lgF0" rel="noopener ugc nofollow" target="_blank">取自Unsplash </a></p></figure><p id="d8e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">机器学习项目的典型流程从读取数据开始，然后是一些预处理、训练、测试、可视化以及与通知系统共享结果。当然，所有的步骤都可以在各种开源库的帮助下轻松完成。然而，在一些特定于任务的情况下，比如时间序列数据中的异常检测，减少库和硬编码步骤的数量将更有利于可解释性。pyfbad库就是为此而开发的。</p><div class="ls lt gp gr lu lv"><a href="https://github.com/Teknasyon-Teknoloji/pyfbad" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">GitHub-Teknasyon-Teknoloji/pyfbad:一个由Getcontact Data开发的开源离群点检测包…</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">pyfbad库支持异常检测项目。可以编写一个端到端的异常检测应用程序…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="d481" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mk"> pyfbad </em> </strong>库是一个端到端的无监督异常检测包。这个包提供了前面提到的所有ml-flow步骤的源代码。例如，可以使用pyfbad通过特殊的过滤器从文件、MongoDB或MySQL中读取数据。这些读取的数据可以通过预处理方法为模型做好准备。该模型可以使用不同的机器学习模型进行训练，例如Prophet或Isolation Forest。异常检测结果可以通过电子邮件或slack报告。换句话说，项目的整个周期可以在pyfbad下提供的源代码的帮助下完成，而不需要使用任何其他库。</p><p id="6fb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">事实上，阅读<a class="ae kv" href="https://engineering.teknasyon.com/an-end-to-end-unsupervised-anomaly-detection-c402facffee2" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这篇内容丰富的文章</strong> </a>将有助于理解我们为什么需要开发这个包，以及如何从总体上设计一个无监督的异常检测项目。然而，我们仍然简单地将异常检测描述为一种识别技术，用于发现导致给定数据集中突然峰值或谷值的异常观察。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/8cfe6435210c95cb17783b1b540dbe73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmgJFsCB9BAtAs-wZ-an2A.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图一。基于pyfbad的时间序列数据无监督异常检测流水线。作者图片</p></figure><p id="2a7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如图1所示，pyfbad有4个主要模块:数据库、特性、模型和通知。在<a class="ae kv" href="https://cookiecutter.readthedocs.io/en/1.7.3/index.html" rel="noopener ugc nofollow" target="_blank"> Cookiecutter </a>的<a class="ae kv" href="https://drivendata.github.io/cookiecutter-data-science/" rel="noopener ugc nofollow" target="_blank"> Drivendata </a>的帮助下，这种结构在数据科学项目中几乎是标准化的。项目组织如图2所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="985a" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">数据库:</strong></h2><p id="f631" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">这个模块有从各种数据库或文件中读取数据的脚本。MySQL和MongoDB是目前为止添加的数据库支持。特别是在MongoDB中，通过Pyfbad使用过滤步骤变得更加用户友好。下面的代码片段可能会让您了解如何使用pyfbad进行数据库操作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="5495" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">功能:</strong></h2><p id="cb3a" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">变量时间序列异常检测的概念需要两类数据。其中一个是连续时间数据，另一个是我们想要检测异常的主数据。这两个数据应该从原始数据中提取出来作为模型数据。Pyfbad提供了从原始数据帧中检索模型数据的可选过滤功能。下面的代码片段显示了如何使用pyfbad来执行此操作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="0eca" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">型号:</strong></h2><p id="3118" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">该模块能够用各种算法训练模型数据。可以理解，Pyfbad旨在检测时间序列数据上的异常。从这个意义上来说，它提供了使用模型的机会，这些模型可以被快速而稳健地应用。脸书先知和隔离福里斯特是模型支持添加到目前为止。作为一个例子，从下面的代码片段可以看出Prophet是如何在pyfbad的帮助下实现的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="3809" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">通知:</strong></h2><p id="eb1d" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">我们使用的所有技术的成功程度与它们如何利用其产出有关。如果产品能很好地传达给用户，并能解释如何使用它，产品就会变得可见。pyfbad提供了各种通知系统来共享项目的结果，比如电子邮件和slack。电子邮件选项可以用作下面的代码片段。请注意，电子邮件帐户不应该有授权的高安全性设置。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h2 id="1359" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated"><strong class="ak">实现！</strong></h2><p id="994d" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">让我们快速实现一下，以便更好地理解如何使用Pyfbad。完整的笔记本可以在Kaggle上从<a class="ae kv" href="https://www.kaggle.com/muhammetfurkanankaya/pyfbad-anomaly-detection" rel="noopener ugc nofollow" target="_blank">这里</a>找到。这里我们只看每一步的结果。</p><p id="8541" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将数据集模块导入pyfbad库之后，可以从CSV格式的文件中读取原始数据。原始数据如图3所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/f4a3feb3a50eeba78c2e5d7157ec6ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Se3chwY1tXkq2hKMfj7Yw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图3。原始时间序列数据值。作者图片</p></figure><p id="d395" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个数据集中，实际上不需要预处理步骤来从原始数据集中提取准备训练的数据集。然而，在图4中，可以看出初始数据帧和最终数据帧之间的差异。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/d367907a170558d3ffe6a142006b66b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QdBx3ZeM7PiAKswuEs0sQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图4。原始数据集在左侧，准备好训练的数据集在右侧。作者图片</p></figure><p id="9686" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在此实现中，使用Prophet算法来训练模型。在训练步骤之后，检测到的异常可以显示在图5中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/3a39d71fe09115b1d1f4f9d992ccb625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2lWd7YUqDXkLaVOXLMV7FA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图5。异常检测结果。作者图片</p></figure><h2 id="ea87" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">结论</h2><p id="7d1f" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">Pyfbad可以很好地与大多数流行的数据库一起工作，比如MongoDB和MySQL，但是仍然可以添加不同种类的数据库支持。它目前使用最知名的模型，如FB Prophet和Isolation Forrest，但仍需要更多的机器学习算法。项目背后的团队渴望学习，对研发充满热情，对学习新技术非常有抱负。因此，我们可以有把握地说，这是Pyfbad的第一个版本。正在进行研究，以弥补上述不足，并使Pyfbad成为一个非常全面的无监督异常检测库。</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><h2 id="2a4a" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">包创建者</h2><ul class=""><li id="2395" class="nv nw iq ky b kz nh lc ni lf nx lj ny ln nz lr oa ob oc od bi translated"><a class="ae kv" href="https://medium.com/@akin.gunduz" rel="noopener">阿肯</a> <a class="ae kv" href="https://www.linkedin.com/in/akingunduz/" rel="noopener ugc nofollow" target="_blank">君度</a></li><li id="feda" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><a class="ae kv" href="https://medium.com/@muhammetfurkanankaya" rel="noopener">富尔坎</a> <a class="ae kv" href="https://www.linkedin.com/in/furkan-%C3%A7ankaya/" rel="noopener ugc nofollow" target="_blank">坎卡亚</a></li><li id="c663" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated">奥詹·叶迪尔</li></ul><h2 id="91a0" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lf mx my mz lj na nb nc ln nd ne nf ng bi translated">参考</h2><ul class=""><li id="c86d" class="nv nw iq ky b kz nh lc ni lf nx lj ny ln nz lr oa ob oc od bi translated"><a class="ae kv" href="https://engineering.teknasyon.com/an-end-to-end-unsupervised-anomaly-detection-c402facffee2" rel="noopener ugc nofollow" target="_blank">端到端无监督异常检测</a></li><li id="13d4" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><a class="ae kv" href="https://github.com/facebook/prophet" rel="noopener ugc nofollow" target="_blank"> FB先知</a></li><li id="b149" class="nv nw iq ky b kz oe lc of lf og lj oh ln oi lr oa ob oc od bi translated"><a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html" rel="noopener ugc nofollow" target="_blank">隔离林</a></li></ul></div></div>    
</body>
</html>