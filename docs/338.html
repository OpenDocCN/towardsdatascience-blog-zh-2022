<html>
<head>
<title>Where Should We Be Placing EV Charging Stations? (Using QGIS and PulP)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我们应该在哪里放置电动汽车充电站？(使用QGIS和纸浆)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/where-should-we-be-placing-ev-charging-stations-using-qgis-and-pulp-d2bb7b664a55#2022-01-12">https://towardsdatascience.com/where-should-we-be-placing-ev-charging-stations-using-qgis-and-pulp-d2bb7b664a55#2022-01-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b622" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""><h1 id="6de4" class="pw-post-title iy iz iq bd ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv bi translated">我们应该在哪里放置电动汽车充电站？(使用QGIS和纸浆)</h1></div><div class=""><h2 id="f2b5" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">曼彻斯特电动汽车充电站最佳位置模型开发之旅</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4738a7d148ff4a56b4ae3ea1fc140c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axSXLcv1swEiGah4nMRqjA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">曼彻斯特市的道路图——图片由作者提供</p></figure><p id="fffc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi ma translated"><span class="l mb mc md bm me mf mg mh mi di">到</span>说服潜在的电动汽车(EV)购买者，发展现有的充电站网络至关重要。术语“里程焦虑”描述了电动汽车车主担心在旅行中耗尽电动汽车电池的情况。目前，大多数电动汽车车主都可以使用家庭充电，而对于那些住在公寓或公寓的人来说，家庭充电几乎是不可能的，这在曼彻斯特市尤为明显。因此，为了满足所有潜在买家的需求，有必要明智地发展充电网络。</p><h1 id="ade2" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">使用GIS数据</h1><p id="91cf" class="pw-post-body-paragraph le lf iq lg b lh nb ka lj lk nc kd lm ln nd lp lq lr ne lt lu lv nf lx ly lz ij bi translated">本研究的方法是高度重视地理信息，如交通流量、现有电动汽车充电、充电器的潜在停车场位置和土地使用分类。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/15c79c8e1bb2b8426b8e9cc73ad69a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U0UdlTosHdj8vADGXKIe6g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">68公里网格中的GIS数据输入—作者提供的QGIS图像</p></figure><p id="4236" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">充电需求是根据39至140k范围内不同测量点的每日汽车交通流量计算的(图1)。因为交通流量的测量点不是均匀分布的，在某些区域可能会缺失，所以构建了一个68 km的格网，在其中计算每个格网单元的平均交通流量(图2)。对于那些不包括任何测量点的网格，交通流量将是周围网格的平均值。图3所示的土地使用分类也用于确定快速和慢速充电器的合适位置，因为它假设快速充电器将安装在商业或混合使用区域，而慢速充电器则分布在公寓和公寓周围。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nh"><img src="../Images/3cac4fce573f99a9bae57a9ebeb5c7f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mjSb1ncWRc86OgLcx8FpHQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">停车场(左)和现有的电动汽车充电器(右)——图片由QGIS作者提供</p></figure><p id="d4ca" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">图4显示了潜在的电动汽车充电地点，我们在这些地点使用了市政管理的停车场，主要是因为这些数据容易获得(您可以根据您的可行地点进行更改)。图5显示了现有的电动汽车充电地点，因此，这些地区的充电需求已经得到满足。反过来，我们的模型必须通过选择充电需求最高的最合适的停车场来考虑这些因素。</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><h1 id="6742" class="mj mk iq bd ml mm np mo mp mq nq ms mt kf nr kg mv ki ns kj mx kl nt km mz na bi translated">开发优化模型</h1><p id="193e" class="pw-post-body-paragraph le lf iq lg b lh nb ka lj lk nc kd lm ln nd lp lq lr ne lt lu lv nf lx ly lz ij bi ma translated"><span class="l mb mc md bm me mf mg mh mi di"> T </span>这一节讲述了Python代码的组成部分，完整的图片可以在<a class="ae nu" href="https://github.com/obedsims/Musk-Model.git" rel="noopener ugc nofollow" target="_blank"> github </a>找到。我们的第一步是创建一个函数，为需求位置(网格单元的质心)和潜在的电动汽车充电位置(停车场)生成集合。</p><pre class="kp kq kr ks gt nv nw nx ny aw nz bi"><span id="51f5" class="oa mk iq nw b gy ob oc l od oe">def gen_sets(df_demand, df_parking):<br/>    <em class="of">"""Generate sets to use in the optimization problem"""<br/>    </em># set of charging demand locations (i)<br/>    demand_lc = df_demand.index.tolist()</span><span id="c907" class="oa mk iq nw b gy og oc l od oe">    # set of candidates for charging station locations (currently    existing parking lots) (j)<br/>    chg_lc = df_parking.index.tolist()<br/><br/>    return demand_lc, chg_lc</span></pre></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="b2b6" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">其次，使用距离矩阵来生成服务区的概念，如果需求质心和停车场之间的距离大于500米(驾驶员愿意为汽车充电的步行距离被认为是500米),则二进制变量将被设置为0，否则其值将为1。这也可以在QGIS中使用距离矩阵函数来执行。</p><pre class="kp kq kr ks gt nv nw nx ny aw nz bi"><span id="35e1" class="oa mk iq nw b gy ob oc l od oe"># distance matrix of charging station location candidates and charging demand location<br/>coords_parking = [(x, y) for x, y in zip(df_parking['Easting'], df_parking['Northing'])]<br/><br/>coords_demand = [(x, y) for x, y in zip(df_demand['centroid_x'], df_demand['centroid_y'])]<br/><br/>distance_matrix = distance.cdist(coords_parking, coords_demand, 'euclidean')<br/>scaling_ratio = 1<br/>distance_matrix2 = scaling_ratio * distance_matrix<br/>distance_matrix3 = pd.DataFrame(distance_matrix2,index=df_parking.index.tolist(), columns=df_demand.index.tolist())</span></pre></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="4ebc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然后，我们需要创建一个包含所有参数<code class="fe oh oi oj nw b">gen_parameters</code>的函数，以及一个包含每个网格单元<em class="of"> i </em>中现有电动汽车充电站当前满足的需求的函数<code class="fe oh oi oj nw b">gen_demand</code>(这来自GIS建模)。然后，我们可以将混合整数线性问题公式化，该问题包括目标函数、变量和约束。我们的目标函数旨在通过从收费收入中减去总资本和运营成本，使加油站的利润最大化。除了保证网格单元<em class="of"> i </em>在站的服务区域中的需求之外，这些约束确保在站充电的汽车少于站的容量和充电需求。</p><pre class="kp kq kr ks gt nv nw nx ny aw nz bi"><span id="9ab0" class="oa mk iq nw b gy ob oc l od oe">def optimize(df_demand, df_parking):<br/><br/>    # Import i and j set function<br/>    demand_lc, chg_lc = gen_sets(df_demand, df_parking)<br/><br/>    # Import parameters function<br/>    di, m, p, t, ci_j, cr_j, ce_j, pe, alpha, lj, N, distance_matrix     = gen_parameters(df_demand, df_parking)<br/><br/>    # Import current demand of car park z in cell i<br/>    diz = gen_demand(df_demand)<br/><br/>    # set up the optimization problem<br/>    prob = LpProblem('FacilityLocation', LpMaximize)</span><span id="43fb" class="oa mk iq nw b gy og oc l od oe">    # Variables<br/>    n = LpVariable.dicts("no_of_chgrs_station_j",<br/>                         [j for j in chg_lc],<br/>                         lowBound=0)<br/>    q = LpVariable.dicts("Remaining_dem_station_j",<br/>                         [j for j in chg_lc],<br/>                         0)<br/>    c = LpVariable.dicts("Tot_costs_station_j",<br/>                         [j for j in chg_lc],<br/>                         0)<br/>    x = LpVariable.dicts("UseLocation", <br/>                         [j for j in chg_lc], <br/>                         0, 1, LpBinary)</span><span id="d2fe" class="oa mk iq nw b gy og oc l od oe">    # Equality Equations</span><span id="1f4d" class="oa mk iq nw b gy og oc l od oe">    r = np.full([len(demand_lc), len(chg_lc)], None)<br/><br/>    for i in demand_lc:<br/>        for j in chg_lc:<br/>            if distance_matrix[i][j] &lt;= 500:<br/>                r[i][j] = 1<br/>            else:<br/>                r[i][j] = 0</span><span id="44ea" class="oa mk iq nw b gy og oc l od oe">    # Create empty dictionary for the remaining demand in cell i</span><span id="283b" class="oa mk iq nw b gy og oc l od oe">    zip_iterator = zip(demand_lc, [None]*len(demand_lc))<br/>    dr = dict(zip_iterator)<br/><br/>    # For each cell i subtract the existing number of charging   stations from the charging demands in cell i</span><span id="e12a" class="oa mk iq nw b gy og oc l od oe">    for i in demand_lc:<br/>        for j in chg_lc:<br/>            dr[i] = di[i] - diz[i] * m[j]<br/>            if dr[i] &lt; 0:       # limit minimum demand to zero<br/>                dr[i] = 0</span><span id="25f4" class="oa mk iq nw b gy og oc l od oe">    # Objective function</span><span id="a854" class="oa mk iq nw b gy og oc l od oe">    prob += lpSum(p[j] * t[j] * x[j] - c[j] for j in chg_lc)<br/><br/><br/>    # Constraints</span><span id="079c" class="oa mk iq nw b gy og oc l od oe">    for j in chg_lc:<br/>        prob += c[j] == (cr_j[j] + ce_j[j] + ci_j[j] + 0.1 * ce_j[j] + 0.1 * ci_j[j]) * n[j]+ pe * alpha * q[j]<br/>    for j in chg_lc:<br/>        prob += q[j] - n[j] * m[j] &lt;= 0                            <br/>    for j in chg_lc:<br/>        prob += q[j] &lt;= lpSum(r[i][j] * dr[i] for i in demand_lc)<br/>    for i in chg_lc:<br/>        prob += lpSum(x[j] * r[i][j] for j in chg_lc) - 1 &lt;= 0<br/>    for j in chg_lc:<br/>        prob += n[j] - x[j] &gt;= 0<br/>    for j in chg_lc:<br/>        prob += n[j] - lj * x[j] &lt;= 0<br/>    prob += lpSum(x[j] for j in chg_lc) == N <br/><br/>    prob.solve()</span></pre></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/ba984d7cc0a473da9a642700fa8eac08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9k1m8171bi5dZbFd-EAphA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">红点表示电动汽车充电器的最佳停车场</p></figure><h2 id="edb1" class="oa mk iq bd ml ol om dn mp on oo dp mt ln op oq mv lr or os mx lv ot ou mz iw bi translated">结果</h2><p id="586a" class="pw-post-body-paragraph le lf iq lg b lh nb ka lj lk nc kd lm ln nd lp lq lr ne lt lu lv nf lx ly lz ij bi translated">如果我们只考虑实现10个快速充电器(40分钟充电到80%)，优化产生上述结果。停车场1-6都位于通往城市的交通要道沿线(较暗的区域)，表明充电需求较高。除此之外，所有确定的快速充电器位置都位于商业/混合使用区域(黄色区域)周围，如超市、商场和餐馆。您还会注意到，更大比例的充电器位于市中心之外(图中左)，因为所有现有电动汽车充电器中约有50%位于市中心，满足了现有需求。</p><h1 id="f401" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">结论</h1><p id="e880" class="pw-post-body-paragraph le lf iq lg b lh nb ka lj lk nc kd lm ln nd lp lq lr ne lt lu lv nf lx ly lz ij bi translated">如果你已经到达这一部分，我希望这个案例研究已经鼓励你在你自己的城市重现这一点，你所需要的是一些在英国容易获得的地理信息，如交通流量，你可能想要放置站的地方和现有的电动汽车充电位置。该模型中充电站的最优位置主要由交通流的地理分布和基于土地利用分类的不同充电可能性决定，因此地理信息在优化过程中起着重要作用。然而，这种模式有一些局限性。在未来的研究中，改变网格的大小对于找出它的灵敏度是必不可少的。此外，充电需求的建模方式没有考虑交通流的结构，特别是车辆的起点和终点。因此，在每个需求节点中，电动车辆电池的状态是未知的。</p><p id="1042" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">欢迎在评论中分享你的想法，或者在LinkedIn上给我发你的问题，我会试着发布关于能源和气候变化的数据科学内容。</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><h1 id="6ad1" class="mj mk iq bd ml mm np mo mp mq nq ms mt kf nr kg mv ki ns kj mx kl nt km mz na bi translated">参考</h1><p id="f18d" class="pw-post-body-paragraph le lf iq lg b lh nb ka lj lk nc kd lm ln nd lp lq lr ne lt lu lv nf lx ly lz ij bi translated">[1]:边，，弗雷德里克·沃林，安德斯·阿韦林，，于志新(2018年8月)寻找公共充电站的最佳位置——基于地理信息系统的MILP方法<a class="ae nu" href="https://www.sciencedirect.com/science/article/pii/S1876610219300803" rel="noopener ugc nofollow" target="_blank">https://www . science direct . com/science/article/pii/s 1876610219300803</a></p><p id="7ef1" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">[1]:葛，s，冯，刘，(2011年9月)。基于网格划分法的电动汽车充电站规划。在电气<br/>和控制工程(ICECE)，2011年国际会议上(第2726-2730页)。IEEE。</p><h1 id="b828" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">数据源</h1><p id="0fc8" class="pw-post-body-paragraph le lf iq lg b lh nb ka lj lk nc kd lm ln nd lp lq lr ne lt lu lv nf lx ly lz ij bi translated"><a class="ae nu" href="https://www.gov.uk/guidance/find-and-use-data-on-public-electric-vehicle-chargepoints" rel="noopener ugc nofollow" target="_blank">现有电动汽车充电器位置</a></p><p id="ca67" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><a class="ae nu" href="https://www.manchester.gov.uk/open/homepage/3/manchester_open_data_catalogue" rel="noopener ugc nofollow" target="_blank">市政会管理的停车场</a></p><p id="da74" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><a class="ae nu" href="https://www.ordnancesurvey.co.uk/business-government/products/open-map-roads" rel="noopener ugc nofollow" target="_blank">道路形状文件</a></p><p id="2393" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><a class="ae nu" href="https://data.gov.uk/dataset/8b8c5df3-d7e3-484c-89d8-c7b819205002/national-historic-landscape-characterisation-250m-grid-england/" rel="noopener ugc nofollow" target="_blank">土地利用分类</a></p><p id="b228" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated"><a class="ae nu" href="https://roadtraffic.dft.gov.uk/local-authorities/85" rel="noopener ugc nofollow" target="_blank">日交通流量</a></p></div></div>    
</body>
</html>