# 何时不使用神经网络

> 原文：<https://towardsdatascience.com/when-not-to-use-neural-networks-a97608dbd3f6>

## 模型选择指南和正确选择的不存在

![](img/dc24728d8728e3f1a6189558906aa330.png)

艾莉娜·格鲁布尼亚克在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

答前一阵子，一个朋友问我一些挑选 AI 模型的指导。当时，他的大部分人工智能教育都围绕着神经网络及其许多变体。对他来说，他从课程中得到的理解是，神经网络强大到足以解决任何问题；它们总是正确的选择——为什么要学习其他技术呢？

老实说，我能理解。早在我开始机器学习之旅的那一天，我也对“较弱的模型”抱有怀疑——如果我们可以直接跳到支持向量机和人工神经网络，为什么要学习僵化的技术？幸运的是，我现在知道得更多了——我希望我的朋友也知道！

在这种情况下，我认为这实际上可能是一个比我想象的更频繁的问题。因此，我希望能揭示一些简单的模型在宏观事物中所扮演的角色。

如果你是一个初学数据的科学家，这是你特别感兴趣的，因为为每项任务选择正确的模型是你可以发展的最重要的技能之一。此外，模型选择是这样的事情之一，如果做错了，可能会破坏整个企业。最后，知道什么时候使用每个模型也可以指出你接下来应该研究哪些模型。

所以让我们从基础开始。

# **所有模型都是错的，但有些是有用的**

乔治·博克斯的这句话立刻向我们指出了一个基本事实:*所有的模型都是近似值。*换句话说，没有*正确型号*或*正确选择*。因此，根据定义，我们总是使用错误的模型。然而，这并不是说它们不能有用。

> 一个有用的模型是一个能给用户带来价值的模型:更大的利润，更低的成本，对问题的洞察力，有用的建议，一系列的行动，等等。

初学者的错误是认为准确性等于价值。例如，每个亚马逊页面都有几十个我永远不会购买的产品建议。就精确度而言，该算法的精确度接近 0%。然而，它偶尔的点击率所带来的额外收入每年会增加数十亿美元。同样，Medium 每天给我发送大约 20 条阅读建议，我可能会从中阅读一到两条——足以让我每天都访问该网站。准确性只是有用性冰山的众多冰山之一。

更具体地说，模型的有用性可以归结为以下四个属性:

1.  **可解释性:**模型对它所解决的问题提供了多少信息
2.  **可解释性:**能够解释其输出背后的原因
3.  灵活性:描述复杂主题的能力有多强
4.  复杂性:运营和培训的成本有多高

例如，当我们检查一个决策树时，我们学习它是如何解决问题的(可解释性)，并且我们可以追踪哪些决策将一个输入带到了一个特定的输出(可解释性)。一棵树越深，它就越强大(灵活性)和昂贵(复杂性)。

另一方面，神经网络相当不透明。其权重很少或没有解释价值，也不能解释其推理。尽管如此，一个足够大的网络可以近似任何功能，尽管其成本很高。

**这些属性的价值取决于问题。有些问题很直观，但很难形式化，比如识别人脸。这些问题通常受益于灵活但复杂的解决方案，如神经网络。其他的在一开始是不直观的，但是通常可以通过逻辑步骤来解决，比如接受/拒绝贷款请求。对于这些问题，一个更简单但更容易解释的模型可能是你最好的选择。**

很明显，虽然神经网络很棒，但是它们缺乏一些关键的属性:可解释性和可解释性。因此，每当需要这两个属性时，神经网络可能不太适合这项任务。

剩下的就是理解这些属性何时是必不可少的。

# 经验法则

我的一个教授曾经漂亮地这样说:**在 AI 内部，我们用简单的模型解决挑战性的任务，用复杂的模型解决简单的任务。**因此，让我们一点一点地分解它:

*   **简单模型**是经典的机器学习方法，如线性分类器、决策树、k 近邻等。一般来说，你可以在一个下午实现模型，而不需要太多的谷歌搜索或数学。
*   难题是所有那些我们人类需要训练去解决的任务，在我们能想出一个好的答案之前需要一些时间去思考。例如，评估房子的价值、审查贷款提案、为病人决定行动方案等。
*   **复杂模型**是所有的大量数值方法，如支持向量机和神经网络，或者更广泛地说，几乎所有的核方法和基于梯度的方法。你不太可能把自己编码成任何有用的程度，尤其是在没有大量谷歌搜索的情况下。
*   **简单的问题**是我们每天都要解决的直觉任务。例如，当你看到一个你认识的人时，你不会停下来思考——你会立刻认出(1)这是一个人，(2)这个人是谁，以及(3)他的面部表情。事实上，你现在正在读这篇文章，而没有真正考虑字母的形状，或者每个音节如何与你内心听到的声音相对应。更有甚者，你甚至不知道你体内的数百万个神经元是如何连接的，所以你才能理解这一切。

改写我的教授的话，对人工智能来说容易的事情通常对我们来说很难。同样，对我们来说非常简单的事情，对机器来说却非常复杂。

根据这一推理，**在直觉问题上，我们可以通过观察算法的输出来验证它们。我们不需要解释或见解**。在大多数情况下，要求算法给出解释更像是一种调试工具，而不是你会用到的东西。

另一方面，**在人类难以解决的问题上，检查算法的*为什么*是检查其推理是否可靠的最有力的方法之一。此外，这种推理通常有助于解决问题本身，例如向用户展示其贷款申请被拒绝的原因。**

举个更复杂的例子，假设你训练了一个模型来预测房价。从理论上讲，这种模式应该以现实为基础。例如，在类似的社区里，大房子应该比小房子贵。同样的道理也适用于房间和楼层的数量——如果你不能解释模型的权重，你就永远无法真正确定它的行为总是恰当的。因此，选择一个更简单但可审计的模型是最安全的选择。

与此同时，当判断推文是积极的、中立的还是消极的时，更直接的技术，如从-1 到+1 的评分可能太简单了，无法评估讽刺、讽刺和打字错误等元素。此外，当生气时，人们可以创造一些有趣的新词，而没有词汇会有条目。在这种情况下，一个完全不透明的模型，比如单词嵌入或完全成熟的转换器，可能是最有效和可靠的方法。

最后，作为第二条经验法则，一个模型越强大，它就越不可解释。例如，虽然决策树是最容易审计的模型之一，但随机森林就不那么容易审计。同样，虽然 k-最近邻模型很容易理解，但高斯过程明显更加不透明。另一个例子是线性 SVM 模型与其所有内核变体相比，这是很难理解的。

在同一主题上，当构建模型时，这种效果通常不利于可解释性/可解释性方面。例如，在 PCA 特征上训练决策树比纯决策树方法可读性差得多。合奏也是如此。

# 复杂程度

为了方便起见，这里有一个(固执己见的)列表，列出了最常见的方法如何与可解释的*和*复杂规模的概念相关联。

**高度可解释/可解释的模型:**所有线性模型、逻辑回归、决策树、k 近邻等。这些模型更多的是“算法”而不是“数学”

**中间模型:** boosters 和森林模型(如 XGBoost)、朴素贝叶斯、高斯过程等。一般来说，这一类别的方法要么是更简单模型的更强大版本(例如，从决策树到决策树)，要么是更数学化的。

**高级模型:**核支持向量机、神经网络、贝叶斯模型等。这类方法通常是解决各种问题的唯一可行的方法，并且/或者被定制为拥有特定的特性(例如不确定性估计)。此外，它们的复杂程度也各不相同(例如，变压器*与* MLPs)。

# 边缘案例

就像生活中的所有事情一样，总有一些明显的方法不是你所需要的。这里有一个不完整的场景列表，在这些场景中，你可以用一个简单的模型代替一个复杂的模型，反之亦然。

**计算机视觉任务:**在处理图像和视频时，我们通常除了 CNN 和视觉变形器(vit)之外没有其他选择。但是，您使用的公式会显著影响模型的有用性。例如，分割/检测模型比图像分类器更容易解释(毕竟，它们告诉你*物体在哪里*)。探索混合方法也是值得的，例如使用 CNN 解析场景，使用更简单的模型推理结果。

**当准确性成为优先事项时:**回到房价预测器，对于一家公司来说，不惜一切代价获得最佳估计可能比强烈地意识到*为什么*更有吸引力。这同样适用于日内交易投资环境中的资产价值预测。在这种情况下，一个复杂的神经网络可能就是你所需要的多余的东西[(只是要确保你永远记住，总有一天它会适得其反)](https://edition.cnn.com/2021/11/09/tech/zillow-ibuying-home-zestimate/index.html)

**何时可解释性是优先考虑的:**在某些环境中，比如医疗管道，拥有一个可解释的模型可能是法律要求，而不是选项。在这种情况下，您的最佳选择是使用仍然符合所需需求的最复杂的方法。这里的一个好建议是一个[自动调谐 XGBoost 模型](https://github.com/hyperopt/hyperopt)。

**使用插件:**虽然我说过神经网络既不可解释也不可解释，但一些文献致力于解决这类问题。例如，人们可以使用 [SHAP 值](https://github.com/slundberg/shap)来获得对模型内部工作的一些有意义的见解。对于某些问题，这些混合方法可能已经足够了。然而，不要期望这能带来任何奇迹。

到目前为止，我们已经考虑了最近被称为“以模型为中心的方法”:给定一个问题，我们寻找解决它的最佳模型。虽然许多任务通常都是这样，但在现实世界中，问题也是可以改变的。例如，一个人经常可以在一个公司内重新构思问题，以更易于管理的方式解决它们。类似地，当试图提高模型的准确性时，人们可以只获取更多的数据点，而不是尝试所有最先进的技术(这是很多的)。

因此，在这篇文章的结尾，我想提醒你，现实世界提供了比你在大学学位里看到的更多的可能性。**现实世界是以数据为中心的。**尽管选择正确的模型非常重要，但也要确保你拥有优秀的数据。

他的一切都是为了现在。如果你对这篇文章或报纸有任何问题，请随时评论或与我联系。你也可以订阅每当我在这里发布[就会收到通知。你也可以直接给我买杯咖啡来支持我](https://ygorserpa.medium.com/subscribe)

如果你是媒体新手，我强烈推荐[订阅](https://ygorserpa.medium.com/membership)。对于数据和 IT 专业人员来说，中型文章是 StackOverflow 的完美组合，对于新手来说更是如此。注册时请考虑使用[我的会员链接。](https://ygorserpa.medium.com/membership)

感谢阅读:)