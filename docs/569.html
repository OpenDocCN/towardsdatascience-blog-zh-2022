<html>
<head>
<title>Creating Interactive Geospatial Visualisation with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python创建交互式地理空间可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-interactive-geospatial-visualisation-75a2dfaf7e59#2022-01-19">https://towardsdatascience.com/creating-interactive-geospatial-visualisation-75a2dfaf7e59#2022-01-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="26c0" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">使用Python创建交互式地理空间可视化</h1></div><div class=""><h2 id="dd8e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从提取几何数据到创建交互式图表—逐步指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5f823e03af143254f8113fbd7e9b55ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EXYVgQq1gIA_p159"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">德尔菲·德拉鲁阿在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="a70b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">背景</h1><p id="4efe" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最近，在澳大利亚的新南威尔士州，许多地理位置被政府宣布为新冠肺炎传播的关注区域，与其他区域相比，记录了相对更多的病例。</p><p id="92e8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当时(大约在2021年7月)，澳大利亚针对新冠肺炎采取了一种传播最小化策略。因此，对这些受关注地区的居民实施了更严格的公共卫生命令和限制(“封锁措施”)，这意味着更少的人被允许离开家园进行非必要的活动(如外出就餐)，提供非必要服务的当地企业(如咖啡馆和餐馆)被迫暂时关闭。这影响了消费，并对人们的收入产生了流动效应。请注意，这也可以推广到其他有严格封锁措施的地区，如2021年9月的整个维多利亚州，或2021年的一些欧洲国家。</p><p id="47b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从人寿保险公司(本文作者是该公司的精算师)的角度来看，锁定措施可能会间接导致人寿保险保单的投保人因家庭可支配收入减少而停止向人寿保险公司续保(“终止”)。</p><p id="6e7a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为此，我的公司委派我了解封锁措施是否对澳大利亚某些地理位置的中断率有影响。要做到这一点，没有比在地图上可视化地理区域的中断率更好的方法了，这是我意识到对一个人来说，实施提取几何数据的工作流程，用正确的软件包在Pyhon中应用可视化，并最终创建一个综合的同时显示所需信息的交互式图表是多么困难。</p><p id="4dd0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">鉴于上述动机，本文提供了一步一步的指南，以创建一个交互式图表，显示在悉尼按地理区域的中断率。虽然这个用例是用澳大利亚的几何数据呈现的，但它可以很容易地扩展到世界上的其他地理区域。</p><h1 id="9eb9" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">中止及其重要性</h1><p id="9fb2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在澳大利亚，零售市场上的寿险保单主要是由我们称之为金融顾问的中介机构销售的。金融顾问会因成功销售而获得初始佣金。</p><p id="d5f9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">大多数保单都是以高额初始佣金售出的。在2018年之前，这可能会远远超过首年保费的110%。这种佣金结构通常被称为“预付”结构，这意味着在保单有效期内支付的大部分佣金在保单生效时支付。</p><p id="f43e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果投保人在出售后不久(比如一两年内)终止保单，人寿保险公司将遭受损失，因为它无法收回支付给财务顾问的初始佣金。事实上，人寿保险公司通常需要5-7年的时间才能从保单中赚钱。这就是为什么终止保险很重要，而且大多数公司都投入大量资金来留住现有的投保人。</p><h1 id="2195" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">提取几何数据</h1><p id="2814" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">澳大利亚地图可以通过各种数字边界划分成地理区域。一个例子是将澳大利亚地图按州界分成九个州。同样，澳大利亚的地图可以用其他类型的边界划分成更多的自然区域。下图分别显示了以州界和地方政府区域(“<strong class="lt iu"> LGA </strong>”)为界划分的澳洲地图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/d1f153e01a6291af0482c4fa50f5f89d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jb8yf0VzccID64YF7gaaEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:澳大利亚的州界。图片作者。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/069102021923b7be73d0da5017cfe976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T8RXm98dvPjxszt-T4Ub3A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:LGA边界旁的澳洲。图片作者。</p></figure><p id="dc71" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">前面提到的宣布为关注区的地理位置是在LGA一级宣布的。对于悉尼的居民来说，你可能熟悉下面显示的一些地方政府。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/729c38184ef7053f17824c7cef713fd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*3V_OjcSEvsuaiUwT-wo7bg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表3: LGA的例子。按作者分类的表格</p></figure><p id="85b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">几何数据通常以json或shapefile格式提供。这些都是由澳大利亚政府机构发布的。出于本文的目的，我将提取新南威尔士的LGA的几何数据，这些数据可通过LGA数字边界<a class="ae ky" href="https://data.gov.au/data/dataset/nsw-local-government-areas" rel="noopener ugc nofollow" target="_blank">在这里</a>获得。</p><p id="ad38" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可以使用Python geopandas包读取几何数据，如下所示:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="b188" class="na la it mw b gy nb nc l nd ne">## path_LGA_geo refers to the path to the json file downloaded <br/>## from the link above</span><span id="5c26" class="na la it mw b gy nf nc l nd ne">df_LGA_geo = geopandas.read_file(path_LGA_geo)<br/></span><span id="c7d5" class="na la it mw b gy nf nc l nd ne">## In practice, we'll only need two fields from the dataframe,  <br/>## namely the locality name, denoted by 'nsw_lga__3', and the <br/>## geometry arrays, denoted by 'geometry'</span><span id="f26d" class="na la it mw b gy nf nc l nd ne">df_LGA_geo_final = df_LGA_geo[[</span><span id="dfb6" class="na la it mw b gy nf nc l nd ne">'nsw_lga__3',</span><span id="8a69" class="na la it mw b gy nf nc l nd ne">'geometry'</span><span id="34f8" class="na la it mw b gy nf nc l nd ne">]].drop_duplicates(subset ="nsw_lga__3",</span><span id="d08a" class="na la it mw b gy nf nc l nd ne">keep = False, inplace = False)</span></pre><p id="d5fe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你没有太多的计算资源，你可以按照这个<a class="ae ky" href="https://www.statsilk.com/maps/simplify-map-reducing-file-size-and-loading-time" rel="noopener ugc nofollow" target="_blank">链接</a>中的说明选择缩小json或shapefile。</p><h1 id="5b78" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">按地理区域提取中断率</h1><p id="0ba0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在高层次上，中止率可以被校准为中止的保单数量与有效保单总数之比。由于我们跟踪已中止和有效的投保人，中止率可以在邮政区域级别(即通过邮政编码)进行校准。</p><p id="df61" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，与LGA相比，邮政区域代表了不同类型的数字边界。幸运的是，澳大利亚统计局在这本<a class="ae ky" href="https://data.gov.au/data/dataset/asgs-geographic-correspondences-2016" rel="noopener ugc nofollow" target="_blank">出版物</a>中提供了邮政区域和LGA之间的地图。通过下载ASGS通信(2016)，可以在“<em class="ng">CA _ POSTCODE _ 2018 _ LGA _ 2018 . xlsx</em>”文件中找到该映射。</p><p id="9f65" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我顺便提一下，同一出版物中还提供了数字边界的其他映射，如统计区域到LGA、统计区域到地区(即郊区)等。这为用户提供了在不同粒度级别切割几何数据的选项。</p><p id="eec1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦邮政编码被映射到新南威尔士州的LGA，就可以通过地方政府机构汇总中止的保单数量和有效的保单数量，并通过地方政府机构校准中止率。然后，这些可以以表格格式存储，如下所示。请注意，出于本文的目的，显示的中断率是合成的(尽管受到实际范围的限制)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/cbe368e5b0386acb09b9efa8ced324f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*Ilr2evpwZiDxE8FKMIrp-A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">表4:示例数据帧。按作者分类的表格</p></figure><p id="2101" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，可以使用下面的Python代码将数据帧与几何数据帧连接起来:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="1e0b" class="na la it mw b gy nb nc l nd ne">## Joining geometry data with discontinuance rate data<br/>## df_LGA_lapse is a dataframe containing discontinuance rate by <br/>## LGAs</span><span id="3aa0" class="na la it mw b gy nf nc l nd ne">df_geo_disc_merge = df_LGA_geo_final.merge(df_LGA_lapse,</span><span id="7bd0" class="na la it mw b gy nf nc l nd ne">left_on = 'nsw_lga__3', right_on = 'LGA_Name')</span></pre><h1 id="3c15" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">创建可视化</h1><p id="fc07" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我将使用Python包来创建可视化。关于这个包的文档使用，请参考这个<a class="ae ky" href="https://python-visualization.github.io/folium/" rel="noopener ugc nofollow" target="_blank"> Github页面</a>。</p><p id="ca45" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">还有其他可视化工作所需的包。如果你正在使用Google Colab，你可以安装和导入如下的包。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/b99e5b2fde84397a314870d332be59b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*F0Bonern1JTX4m2HDSc8-A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:必需的包。作者图片</p></figure><p id="4679" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后可以通过以下四(4)个步骤创建交互式可视化。</p><p id="2485" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">第一步:获取中心坐标</strong></p><p id="0116" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是为了确保观想“打开”在被绘制的集体地理区域的中心，在这种情况下，是新南威尔士州的中心，也就是澳大利亚地图右下角附近的州。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="72a7" class="na la it mw b gy nb nc l nd ne"># Obtain center cordinates of the map</span><span id="d507" class="na la it mw b gy nf nc l nd ne">x_center = df_geo_disc_merge.centroid.x.mean()</span><span id="2597" class="na la it mw b gy nf nc l nd ne">y_center = df_geo_disc_merge.centroid.y.mean()</span></pre><p id="1daf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">第二步:创建地图的基础图层</strong></p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="e40f" class="na la it mw b gy nb nc l nd ne">## Create the base layer</span><span id="2cd4" class="na la it mw b gy nf nc l nd ne">nsw_disc_map = folium.Map(location = [y_center, x_center], zoom_start = 6, tiles = None)</span><span id="69b8" class="na la it mw b gy nf nc l nd ne">folium.TileLayer('OpenStreetMap', name = "Actl Map", control = True).add_to(nsw_disc_map)<br/></span><span id="3a75" class="na la it mw b gy nf nc l nd ne">nsw_disc_map</span></pre><p id="5594" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上面的Python代码创建了地图的基础图层，该图层在中心坐标处打开。这个基础图层有一个“OpenStreetMap”的图块样式，如下图所示。您可以根据Folium文档<a class="ae ky" href="https://python-visualization.github.io/folium/modules.html" rel="noopener ugc nofollow" target="_blank">在这里</a>使用样式选项定制图块集(并搜索图块图层类)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/2d75ce1a1f35ebcfbb0080dff936c1bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fLHzBjJ6AI5uQVrtHUpayA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:树叶地图的基础层。作者图片</p></figure><p id="b106" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">第三步:将LGA的中止率添加到基础层</strong></p><p id="fa9e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可以使用下面的Python代码将LGA的中断率图层添加到地图的基础图层上。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="2d01" class="na la it mw b gy nb nc l nd ne">set_quantile = (df_geo_disc_merge['Discontinuance_Rate'].quantile((0.0, 0.2, 0.4, 0.6, 0.8, 1.0))).tolist()</span><span id="b312" class="na la it mw b gy nf nc l nd ne">nsw_disc_map.choropleth(</span><span id="2ff0" class="na la it mw b gy nf nc l nd ne">geo_data = df_LGA_geo_final,</span><span id="483c" class="na la it mw b gy nf nc l nd ne">name = 'Choropleth',</span><span id="b7ed" class="na la it mw b gy nf nc l nd ne">data = df_geo_disc_merge,</span><span id="e68c" class="na la it mw b gy nf nc l nd ne">columns=['LGA_Name','Discontinuance_Rate'],</span><span id="17e4" class="na la it mw b gy nf nc l nd ne">key_on = 'feature.properties.nsw_lga__3',</span><span id="262b" class="na la it mw b gy nf nc l nd ne">fill_color = 'YlGn',</span><span id="404c" class="na la it mw b gy nf nc l nd ne">fill_opacity = 0.6,</span><span id="5c57" class="na la it mw b gy nf nc l nd ne">line_opacity = 0.3,</span><span id="5723" class="na la it mw b gy nf nc l nd ne">threshold_scale = set_quantile,</span><span id="3c00" class="na la it mw b gy nf nc l nd ne">legend_name = 'Discontinuance Rate by LGA',</span><span id="7390" class="na la it mw b gy nf nc l nd ne">smooth_factor = 0,</span><span id="bf24" class="na la it mw b gy nf nc l nd ne">highlight = True</span><span id="8eba" class="na la it mw b gy nf nc l nd ne">)<br/></span><span id="c813" class="na la it mw b gy nf nc l nd ne">nsw_disc_map</span></pre><p id="3a97" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如下图所示，在添加的图层中引入了一些不错的功能。即:</p><ul class=""><li id="9aba" class="nk nl it lt b lu mn lx mo ma nm me nn mi no mm np nq nr ns bi translated">LGA的数字边界已经在新南威尔士州绘制出来，每个LGA都由一块以绿色突出显示的土地表示。</li><li id="9c88" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">中断率以5个分位数的色标显示(代码中有set_quantile自定义)，由地图右上角显示的不同绿色色标表示。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/05371c8ff75639b9b8922ed1496b27bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nH6a3wWSDDiPPjCRrExsDA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:地图中LGA图层的中断率。作者图片</p></figure><p id="9d90" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">步骤4:创建工具提示交互</strong></p><p id="a004" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们通过添加工具提示层来使地图具有交互性。想法是，当您将鼠标光标悬停在地图上的特定LGA上时，将会出现一个工具提示，并显示有关LGA的某些信息，在本例中为中断率。</p><p id="3c08" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这可以通过以下Python代码来实现。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="7d64" class="na la it mw b gy nb nc l nd ne">## Add a tooltip layer<br/></span><span id="140c" class="na la it mw b gy nf nc l nd ne">add_tooltip = folium.features.GeoJson(</span><span id="87eb" class="na la it mw b gy nf nc l nd ne">df_geo_disc_merge,<br/></span><span id="83ad" class="na la it mw b gy nf nc l nd ne">tooltip = folium.features.GeoJsonTooltip(</span><span id="88e0" class="na la it mw b gy nf nc l nd ne">fields=['LGA_Name', 'Discontinuance_Rate'],</span><span id="277d" class="na la it mw b gy nf nc l nd ne">aliases = ['LGA_Name: ' ,'Disc_Rate: '],</span><span id="ef0c" class="na la it mw b gy nf nc l nd ne">)</span><span id="6354" class="na la it mw b gy nf nc l nd ne">)</span><span id="1402" class="na la it mw b gy nf nc l nd ne">nsw_disc_map.add_child(add_tooltip)</span><span id="3875" class="na la it mw b gy nf nc l nd ne">nsw_disc_map.keep_in_front(add_tooltip)</span><span id="55b0" class="na la it mw b gy nf nc l nd ne">nsw_disc_map</span></pre><p id="4100" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面的短片展示了本练习的最终结果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">视频8:交互式地图演示。作者提供的视频</p></figure><p id="de5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">您可以通过自定义样式和高亮功能来进一步设置地图的样式，这些功能可以嵌入到工具提示层中。互动Choropleth地图教程是一个学习的好地方。</p><p id="5e2c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">工具提示上有更多！</strong></p><p id="05db" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">实际上，您可以在工具提示上显示更多信息，只要您可以在与地图相同的位置级别上收集信息(在本例中为LGA)。例如，我在工具提示中添加了收入数据，如LGA的收入者的计数、中值年龄、平均值和平均收入，如下图所示。收入数据可以从<a class="ae ky" href="https://www.abs.gov.au/statistics/labour/earnings-and-work-hours/personal-income-australia/latest-release" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="93b3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">此外，我设置的不透明度让我可以看到地图顶层下面的郊区，这是另一个很好的功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/aef34b33c6a33cfa0dd58b3b5ae714a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i3XKNULbmubnPI4Gd-_HmA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9:带有输入数据工具提示。作者图片</p></figure><p id="bf49" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">作为一名精算师，可视化之后可以进行一些按地理区域划分的收入与中止率的分析，这可能证明是有见地的。</p><p id="2495" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我能想到的其他使用案例包括:</p><ul class=""><li id="7270" class="nk nl it lt b lu mn lx mo ma nm me nn mi no mm np nq nr ns bi translated">将此与自然风险数据(如干旱、森林火灾、地震或与洪水相关的地区)叠加，以确定公司的投资组合受影响的程度，并告知公司是否要向受影响的投保人提供保费减免。</li><li id="fcfe" class="nk nl it lt b lu nt lx nu ma nv me nw mi nx mm np nq nr ns bi translated">通过地理区域(可能还有财务顾问)可视化销售数据来发现机会。</li></ul><h1 id="3690" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="cae8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我将几何数据视为半非结构化数据的一种形式，与文本和图像等其他非结构化数据一样，对其进行导航并最终将其可视化在地图上可能很困难。</p><p id="3824" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文中，我提供了一个逐步指南，介绍如何使用Python follow包创建交互式地图。请注意，虽然本文中讨论的用例是在澳大利亚的环境中，但是您可以很容易地将其扩展到其他管辖区域，就像替换澳大利亚的几何数据一样简单。</p><p id="67cf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于对保险行业的其他数据科学应用感兴趣的读者，请关注我，并愉快地阅读我在<a class="ae ky" href="https://jin-cui.medium.com/" rel="noopener">媒体</a>上的文章。</p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><h1 id="87f5" class="kz la it bd lb lc oj le lf lg ok li lj jz ol ka ll kc om kd ln kf on kg lp lq bi translated">参考</h1><p id="a1f7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">[1]澳大利亚统计局(2021) <a class="ae ky" href="https://data.gov.au/data/dataset/nsw-local-government-areas" rel="noopener ugc nofollow" target="_blank"> <em class="ng">新南威尔士州地方政府区域—地理景观行政边界</em> </a> <em class="ng">，</em> ABS网站，2022年1月14日访问，(在<a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by/4.0/</a>获得许可)</p><p id="49ff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[2]澳大利亚统计局(2021)<a class="ae ky" href="https://data.gov.au/data/dataset/asgs-geographic-correspondences-2016" rel="noopener ugc nofollow" target="_blank"><em class="ng">【ASGS地理通讯(2016) </em> </a> <em class="ng">，</em> ABS网站，2022年1月14日访问，(<a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">在https://creativecommons.org/licenses/by/4.0/获得许可</a>)</p><p id="d970" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[3]澳大利亚统计局(2021) <a class="ae ky" href="https://www.abs.gov.au/statistics/labour/earnings-and-work-hours/personal-income-australia/latest-release" rel="noopener ugc nofollow" target="_blank"> <em class="ng">澳大利亚个人收入</em> </a> <em class="ng">，</em> ABS网站，2022年1月15日访问，(<a class="ae ky" href="https://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by/4.0/许可</a>)</p></div></div>    
</body>
</html>