<html>
<head>
<title>The Best Data is Free Data, Of Course</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当然，最好的数据是免费数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-best-data-is-free-data-of-course-b88230b5b47f#2022-01-10">https://towardsdatascience.com/the-best-data-is-free-data-of-course-b88230b5b47f#2022-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="57f5" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">当然，最好的数据是免费数据</h1></div><div class=""><h2 id="ba80" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Socrata开放数据API和sodapy包访问大量的开放数据</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a6cb9f6e3b53a2a41196f4f66f6dd3ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*skqocmcrlc_2T3BM"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@janicetea?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> j </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h2 id="012c" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">介绍</h2><p id="a541" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">数据科学项目常用的数据仓库是Kaggle和UCI机器学习仓库。然而，那里可用的许多数据集是合成的，并不代表真实世界。</p><p id="6013" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">联邦、州和地方政府提供了大量真实世界的开放数据，您可以也应该在您的项目中使用这些数据。在这篇文章中，我将分享获得访问权限的简单步骤。你所需要的只是Socrata开放数据API和sodapy包。</p><p id="f9e9" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">出于解释的目的，我们将使用来自旧金山开放数据仓库DataSF的<a class="ae kv" href="https://data.sfgov.org/Transportation/Air-Traffic-Passenger-Statistics/rkru-6vcg" rel="noopener ugc nofollow" target="_blank">空中交通乘客统计</a>数据集。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="b6ea" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">1.获取Socrata应用程序令牌</h2><p id="d1c2" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">你的第一步是在<a class="ae kv" href="https://data.sfgov.org/login" rel="noopener ugc nofollow" target="_blank">https://data.sfgov.org/login</a>注册一个免费账户，获得一个应用令牌。获得凭据后，单击创建新的应用程序令牌并完成必填字段。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/550f6261d5856733fb307cda434dc484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n3urNJv9bESOfLGDsI3aDg.png"/></div></div></figure><p id="89c0" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">您将被要求输入应用程序令牌的名称和描述，任何唯一的名称都可以。您的应用程序令牌会自动生成并显示在屏幕上。</p><p id="37cb" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">为其他开放数据仓库获取应用令牌的过程是相同的。例如，可以在以下地址找到NYC open data:<a class="ae kv" href="https://data.cityofnewyork.us/login" rel="noopener ugc nofollow" target="_blank">https://data.cityofnewyork.us/login</a></p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="22f7" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">2.安装sodapy</h2><p id="582f" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">下一步是用<code class="fe my mz na nb b">pip install sodapy</code>安装sodapy包</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="23f6" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">3.建立联系</h2><p id="dd1b" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">现在，我们将跳转到Python IDE来建立与Socrata开放数据API的连接。我用过Jupyter实验室:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="c44a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">第一步是导入sodapy包。接下来，我们必须定义我们的数据源并提供我们的应用程序令牌:</p><ul class=""><li id="3fd8" class="ne nf iq lu b lv ml ly mm lf ng lj nh ln ni mk nj nk nl nm bi translated"><strong class="lu ir"> DATA_LINK: </strong>这将根据您试图访问的开放数据存储库而有所不同，并且可以从URL获得。对于dataSF，它是data.sfgov.org，而对于纽约开放数据，它是data.cityofnewyork.us</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/4eeab931b185d6ee7d9e007b288be911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9pra4JscJUqrh82ovdluDA.png"/></div></div></figure><ul class=""><li id="e1e5" class="ne nf iq lu b lv ml ly mm lf ng lj nh ln ni mk nj nk nl nm bi translated"><strong class="lu ir"> DATA_ID: </strong>这是API端点，一个特定于您试图访问的数据集的指示符，也可以从URL:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/d04e43c0a37557566e5e653485dc1e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tdqnkn21BjWfqYB4q3ieSA.png"/></div></div></figure><ul class=""><li id="1b8a" class="ne nf iq lu b lv ml ly mm lf ng lj nh ln ni mk nj nk nl nm bi translated"><strong class="lu ir"> APP_TOKEN: </strong>这是您在前面的步骤中获得的令牌。在上面的代码中，我输入了“redacted ”,以保持我自己的应用程序令牌私有。</li></ul><p id="70ba" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">最后，我们通过实例化一个Socrata对象并将其命名为<em class="no"> client </em>来建立连接。我们传递数据源和应用程序令牌。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="8b3a" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">4.请求数据</h2><p id="e8ef" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">用Socrata开放数据API请求数据只需一行代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="2b6c" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们在Socrata对象上调用get()方法，<em class="no">客户端</em>。我们传递之前定义的DATA_ID。默认情况下，将请求数据集中的前1，000条记录。我们将很快了解如何在每个API调用中请求更多的记录。</p><p id="9af2" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">值得注意的是，当重复完全相同的请求时，Socrata API将<strong class="lu ir">而不是</strong>返回相同的记录。为了保证一致的响应，<strong class="lu ir"> order </strong>参数应该与值':id '一起使用，它对数据集进行排序。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="a36f" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">5.将数据放入数据帧</h2><p id="feda" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">默认情况下，请求的数据以JSON格式返回:</p><pre class="kg kh ki kj gt np nb nq nr aw ns bi"><span id="bdc5" class="kw kx iq nb b gy nt nu l nv nw">[{'activity_period': '200507',<br/>  'operating_airline': 'ATA Airlines',<br/>  'operating_airline_iata_code': 'TZ',<br/>  'published_airline': 'ATA Airlines',<br/>  'published_airline_iata_code': 'TZ',<br/>  'geo_summary': 'Domestic',<br/>  'geo_region': 'US',<br/>  'activity_type_code': 'Deplaned',<br/>  'price_category_code': 'Low Fare',<br/>  'terminal': 'Terminal 1',<br/>  'boarding_area': 'B',<br/>  'passenger_count': '27271'},<br/> {'activity_period': '200507',<br/>  'operating_airline': 'ATA Airlines',<br/>  'operating_airline_iata_code': 'TZ',<br/>  'published_airline': 'ATA Airlines',<br/>  'published_airline_iata_code': 'TZ',<br/>  'geo_summary': 'Domestic',<br/>  'geo_region': 'US',<br/>  'activity_type_code': 'Enplaned',<br/>  'price_category_code': 'Low Fare',<br/>  'terminal': 'Terminal 1',<br/>  'boarding_area': 'B',<br/>  'passenger_count': '29131'}]</span></pre><p id="6668" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">幸运的是，将JSON数据放入pandas数据框架非常容易:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/629eeb6f5365499e0ad633463cf01407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5dIiVUuVGyG9JX3tw889_A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据帧的前五条记录。</p></figure></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="2d5a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">至此，您已经能够使用sodapy将打开的数据导入到DataFrame中进行分析。然而，我们必须涵盖一些高级主题，以便您可以充分利用Socrata开放数据API——通过数据集分页和高级过滤。</p><h2 id="7924" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">6.浏览数据集</h2><p id="c765" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">开放数据数据集可能非常大，您可能需要在多个请求中翻阅数据集。下面的代码请求数据集的记录计数，并计算页面大小为1，000条记录时有多少页:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><pre class="kg kh ki kj gt np nb nq nr aw ns bi"><span id="5df8" class="kw kx iq nb b gy nt nu l nv nw">:: Number of Records Available: 46,670<br/>:: Number of Pages: 47</span></pre><p id="b4ea" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">下面的代码段根据选定的page_size和计算的num_pages在数据集中分页:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure><ul class=""><li id="e85d" class="ne nf iq lu b lv ml ly mm lf ng lj nh ln ni mk nj nk nl nm bi translated"><strong class="lu ir"> limit: </strong>指定请求的记录数(可选)。</li><li id="7b0a" class="ne nf iq lu b lv ny ly nz lf oa lj ob ln oc mk nj nk nl nm bi translated"><strong class="lu ir"> offset: </strong>指定我们应该在数据集中的什么地方开始我们的请求，在这个例子中是在第一个可用的记录处(可选)。</li><li id="744a" class="ne nf iq lu b lv ny ly nz lf oa lj ob ln oc mk nj nk nl nm bi translated"><strong class="lu ir"> order=':id': </strong>指定数据集应该排序</li></ul><p id="d1be" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">查询结果的顺序不是隐式排序的，所以如果您正在分页，请确保您提供了一个<code class="fe my mz na nb b">$order</code> <a class="ae kv" href="https://dev.socrata.com/docs/queries/" rel="noopener ugc nofollow" target="_blank">子句</a>，或者至少使用记录ID: <code class="fe my mz na nb b">$order=:id</code>。这将保证在浏览数据集时结果的顺序是稳定的。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="0373" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">7.高级过滤</h2><p id="e610" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">除了请求完整的数据集，还可以通过在get请求中添加where子句来请求过滤后的数据集。以下代码段请求2005年7月的所有记录:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nc nd l"/></div></figure></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="aa8a" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结束语</h2><p id="7b62" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">从本文中，您了解了如何使用Socrata开放数据API和sodapy包访问开放数据数据集。纽约和旧金山只是众多免费数据库中的两个——我鼓励您探索其他开放的数据库。</p><p id="c329" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，可以考虑<a class="ae kv" href="https://medium.com/@nickdcox/membership" rel="noopener">注册成为一名媒体会员</a>。每月5美元，你可以无限制地阅读媒体上的故事。如果你<a class="ae kv" href="https://medium.com/@nickdcox/membership" rel="noopener">用我的链接</a>注册，我会赚一小笔佣金。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="96b4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">也请查看我的系列文章<strong class="lu ir">通过示例学习Python数据分析</strong>:</p><ul class=""><li id="4a97" class="ne nf iq lu b lv ml ly mm lf ng lj nh ln ni mk nj nk nl nm bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/learn-python-data-analytics-by-example-ny-parking-violations-e1ce1847fa2">通过示例学习Python数据分析:纽约市违章停车</a></li><li id="3b73" class="ne nf iq lu b lv ny ly nz lf oa lj ob ln oc mk nj nk nl nm bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/learn-python-data-analytics-by-example-airline-arrival-delays-e26356e8ae6b">通过示例学习Python数据分析:航班到达延误</a>。</li><li id="b81f" class="ne nf iq lu b lv ny ly nz lf oa lj ob ln oc mk nj nk nl nm bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/learn-python-data-analytics-by-example-chicago-traffic-crashes-4840f6f15ed">通过例子学习Python数据分析:芝加哥交通事故</a></li></ul><p id="5a90" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">以及我最近发表的其他文章:</p><ul class=""><li id="4d70" class="ne nf iq lu b lv ml ly mm lf ng lj nh ln ni mk nj nk nl nm bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/causal-inference-using-bayesian-structural-time-series-models-ab1a3da45cd0">使用贝叶斯结构时间序列模型的因果推断</a></li><li id="bd10" class="ne nf iq lu b lv ny ly nz lf oa lj ob ln oc mk nj nk nl nm bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/elevate-your-data-science-abilities-learn-resourcefulness-5ae879a6b3b7">提升您的数据科学能力:学会随机应变</a></li><li id="ac5e" class="ne nf iq lu b lv ny ly nz lf oa lj ob ln oc mk nj nk nl nm bi translated"><a class="ae kv" href="https://medium.datadriveninvestor.com/did-you-have-coronavirus-and-not-even-know-it-i-know-who-did-77200e76149e" rel="noopener ugc nofollow" target="_blank">你是不是得了冠状病毒却连自己都不知道？我知道是谁干的！</a></li></ul></div></div>    
</body>
</html>