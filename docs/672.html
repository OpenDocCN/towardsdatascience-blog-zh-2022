<html>
<head>
<title>Create Artificial Data With SMOTE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用SMOTE创建人工数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-artificial-data-with-smote-2a31ee855904#2022-01-24">https://towardsdatascience.com/create-artificial-data-with-smote-2a31ee855904#2022-01-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="6629" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">用SMOTE创建人工数据</h1></div><div class=""><h2 id="d276" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何利用简单的算法来弥补数据的不足</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/67df7a9989d456766017a01e8be3fa86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HCkdEFmJFy9wMjp0"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">布雷特·乔丹在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="3755" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据不平衡在机器学习中普遍存在。真实数据很少平等地代表每个类。在疾病诊断、欺诈检测和垃圾邮件分类等应用程序中，一些类别将总是被低估。</p><p id="3fce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是许多机器学习相关工作的主要障碍。毕竟，如果您缺少特定结果的数据，您的模型将无法充分预测该结果。</p><p id="5b22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">值得庆幸的是，有办法绕过这个问题。如果你不能为少数民族阶层获取足够的数据，为什么不自己做一些呢？</p><p id="3905" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们介绍合成少数过采样技术(SMOTE)，这是一种用于生成人工数据的流行算法。</p><h2 id="2831" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">为什么击打？</h2><p id="e29c" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在介绍SMOTE的来龙去脉之前，让我们首先讨论一下对人工数据的需求。</p><p id="6399" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们可以利用欠采样和过采样等采样技术时，为什么我们需要经历创建我们自己的数据的麻烦？</p><p id="f3ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简而言之，这是因为这些方法存在重大缺陷。</p><p id="0048" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">欠采样</strong>需要通过从多数类中移除记录来均衡每个类的样本。这在理论上是明智的，但付诸实践就完全荒谬了。</p><p id="8ef6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据是宝贵的。</p><p id="105f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了进行后续的分析和建立依赖于这些数据的模型，企业需要付出相当大的努力来收集和存储数据。</p><p id="f706" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">试着告诉你的老板，为了“平衡”，你想丢弃你的数据工程师辛辛苦苦获得的80%的数据。不会有好结果的。</p><p id="20cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">过采样</strong>需要通过复制少数类样本来增加少数类大小，从而使每个类的样本均匀。这不是一个更好的选择，因为用这样的数据训练的模型容易过度拟合。</p><p id="899f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果丢弃或复制样本无效，剩下的唯一选择就是创建自己的数据。</p><p id="470f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SMOTE是用来实现这一点的最流行的算法之一。</p><h2 id="5272" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">SMOTE如何工作</h2><p id="20d5" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">SMOTE的内部工作看似抽象，但相当简单。</p><p id="65e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了理解SMOTE如何生成人工数据，最好认识到每个样本在特征空间中都有自己的表示。</p><p id="13a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们用一个例子来演示一下SMOTE。下面是一组由2D特征空间中的向量表示的虚构数据。红点代表少数阶级。</p><p id="57e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:大多数数据集通常有更高的维度。为了方便起见，我们使用了一个过于简化的2D特征空间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/145f9c68ceda6e8add7f4609d5c02a87.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*zjcl7etFKW9_LB6DQGMEsw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2D特征空间(由作者创建)</p></figure><p id="286e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，SMOTE识别来自少数类的数据点的k个最近邻(在这种情况下，k=3)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/7c4941121db6aa8d6139a64d1bc72ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*wh-hXfupEjC5psQyEsrG_w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2D特征空间(由作者创建)</p></figure><p id="0046" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，它在所有邻居之间的随机位置创建一个新点。这些新点表示属于少数类的人工数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/00cafbc6cb1f67c7ce3e568017c7ca38.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*HqmhKTh9kmQ8tyZ6yMec0A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2D特征空间(由作者创建)</p></figure><p id="137e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将继续生成新数据，直到数据不平衡得到解决。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/540e8fe64b85773e51cc31ab16aa3ef9.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*mv4eyug1QU0cCr5WolHwBg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2D特征空间(由作者创建)</p></figure><h2 id="4b89" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">缺点</h2><p id="9b97" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">SMOTE补救不平衡的数据集，而不会带来欠采样或过采样带来的风险。然而，这种方法有其自身的局限性。</p><p id="61e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，当搜索少数类的邻居时，SMOTE冒着包括其他类的风险。这将导致产生不能充分代表少数群体的数据。</p><p id="1559" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其次，SMOTE的算法用在高维数据上并不可靠。</p><p id="b3e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">自然，在大量的研究中已经解决了许多这些弱点，开发了SMOTE的不同变体。然而，这超出了本文的范围。</p><h2 id="747b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">警告</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/58e20be991f3b4fe83d313d16e69cfba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jNB9UopNt714B0CJ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@gohrhyyan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">吴礼仁</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b924" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SMOTE应仅用于增加<em class="mu">训练</em>数据。您的测试数据集应该保持不变。对整个数据集应用SMOTE将导致数据泄漏。</p><p id="cdc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也意味着用于评估模型的测试数据将由人工数据组成。这听起来可能是显而易见的，但是您希望评估您的模型的数据是真实的。否则，任何报告的评估指标都没有任何意义。</p><h2 id="b55d" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">个案研究</h2><p id="b0c7" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这一次，让我们看看在真实数据上使用SMOTE是如何工作的。在这个演示中，我们使用一个提供客户信息的数据集(无版权保护)来构建一个模型，以确定他们是否对车辆保险感兴趣。在这里可以访问<a class="ae kv" href="https://www.kaggle.com/arashnic/imbalanced-data-practice" rel="noopener ugc nofollow" target="_blank">的原始数据。</a></p><p id="9f70" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面，我们可以看到数据集中的变量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/2c673cf189ccadcbe08b684c32861f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*XMDZXzDrmatuowyueM_VBA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="2613" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目标标签是“响应”。</p><p id="fbe7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在任何模型建立之前，我们需要预处理原始数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="5d68" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">快速计数显示了每个类中的记录数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b482b8ff7227ed4de2feb27fa6b25887.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*1UnL2ZK3q7xy7dHvftJ9XQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="1016" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">多数群体与少数群体的人数比例约为5:1，这是数据不平衡的一个明显迹象。</p><p id="f1b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们建立一个随机森林模型，在没有SMOTE的情况下预测客户对车辆保险的兴趣。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="443a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用f-1评分标准评估该模型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/864af88b0f971543351293c5b8d0b24d.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*NKke36eRA10xBN59t0nQVA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="d075" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型的f-1分数为0.44，有改进的余地。</p><p id="1522" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们将重复相同的过程，但是在添加人工数据之后。我们可以用Python中的imblearn模块的<a class="ae kv" href="https://imbalanced-learn.org/stable/references/generated/imblearn.over_sampling.SMOTE.html" rel="noopener ugc nofollow" target="_blank"> SMOTE </a>来实现。</p><p id="0cde" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模块允许我们在创建合成数据时具有一定的灵活性。你可以控制这样的事情:</p><ul class=""><li id="13aa" class="na nb iq ky b kz la lc ld lf nc lj nd ln ne lr nf ng nh ni bi translated">多数类样本数与少数类样本数的比率</li><li id="98a5" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">SMOTE针对的类别</li><li id="e5b1" class="na nb iq ky b kz nj lc nk lf nl lj nm ln nn lr nf ng nh ni bi translated">构建样本时要考虑的最近邻的数量</li></ul><p id="35c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将坚持默认参数。这意味着该算法考虑5个最近的邻居，并将生成数据，直到少数样本的数量和多数样本的数量相同。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="36b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意SMOTE如何仅应用于<em class="mu">训练</em>组。如前所述，不要为测试集生成人工数据是非常重要的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/178e4673150a4a1173fdf07ff5a02654.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*nxoGhba3Y_L353981SEX1g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="cd5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在已经解决了训练数据中的数据不平衡问题。因此，让我们用这些数据构建一个随机森林分类器，看看它在测试集上的表现如何。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/7ad357264366fc28b4fad7714f863e58.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*Go7J82pijZvWt8wUJ9Op0Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">代码输出(由作者创建)</p></figure><p id="7a63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型的f-1得分为0.52，证明与未经人工数据训练的模型相比，该模型能更好地预测客户对车辆保险的兴趣。</p><h2 id="74e8" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/d8a8886a3f80db5ac2f8d54e205f0ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TTnVZnWa5H0gq8ii"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@prateekkatyal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="f0f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总而言之，SMOTE的这个简要概述应该可以帮助您熟悉人工数据生成背后的逻辑及其在机器学习应用程序中的使用。</p><p id="bcfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">SMOTE虽然非常适用，但也有其局限性和弊端。即使是现在，大量的研究和投资正被投入到探索新的变种中。</p><p id="1c9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你感兴趣，你可以看看<a class="ae kv" href="https://pypi.org/project/smote-variants/" rel="noopener ugc nofollow" target="_blank"> smote-variants </a>包，它允许你实现85种不同的算法变体！</p><p id="cc29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我祝你在数据科学的努力中好运！</p><h2 id="1ce9" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">参考</h2><ol class=""><li id="e530" class="na nb iq ky b kz ml lc mm lf nr lj ns ln nt lr nu ng nh ni bi translated">莫比乌斯。(2022).从不平衡的保险数据中学习，第4版。2022年1月22日从https://www.kaggle.com/arashnic/imbalanced-data-practice.取回</li></ol></div></div>    
</body>
</html>