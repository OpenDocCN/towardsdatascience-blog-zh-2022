<html>
<head>
<title>Pandas in Practice</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实践中的熊猫</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-in-practice-64be9228062a#2022-01-02">https://towardsdatascience.com/pandas-in-practice-64be9228062a#2022-01-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="ce62" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">实践中的熊猫</h1></div><div class=""><h2 id="d6ca" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这是一个实践教程，演示了如何利用Pandas包来清理、操作和分析数据。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9fd66b41f4ef2eff9d45b6935cb7160e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SABnYfT-DtAuwGOgkqs79g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图像取自<a class="ae kv" href="https://unsplash.com/photos/LqKhnDzSF-8" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="3edb" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak"> 1。简介</strong></h1><p id="ce71" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">您是否曾经在Excel中难以分析大数据集？那么，您应该考虑Pandas，它是一个强大的编程和数据分析工具箱，允许您在毫秒内处理百万行数据点，具有很高的处理能力和用户生产率。事实上，Pandas是一个开源的python库，由软件开发人员Wes McKinney在2008年推出，它包括高级数据结构和编程工具，可以对不同的数据类型(无论是数字、文本还是日期等)进行数据分析和操作。本教程为你开始在你的项目中应用熊猫提供了必要的知识。</p><h1 id="bd8c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">2.目标</h1><p id="ec01" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们假设你刚加入一家初创公司，担任数据分析师，你被分配到支持团队，推动对客户群的深入了解。您的经理共享了数据集，现在您有机会展示您的python技能并使用Pandas包来执行分析。</p><p id="fe62" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">本教程将帮助你发展和使用熊猫知识:</p><p id="507f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">1-导入和读取CSV文件</p><p id="2a7f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2-生成对给定数据的基本理解</p><p id="9e0c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">3-根据条件选择和过滤数据</p><p id="5232" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">4-应用各种数据操作工具，如创建新变量或更改数据类型</p><p id="05f4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">5-使用分组依据和数据透视表方法执行数据聚合</p><p id="ce7a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">6-将分析见解转化为商业建议。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="570e" class="mu kx iq mq b gy mv mw l mx my">#load the needed packages and modules <br/>import pandas as pd<br/>import numpy as np<br/>from datetime import date<br/>import datetime as dt</span></pre><h1 id="5aac" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">3.数据分析</h1><h2 id="51de" class="mu kx iq bd ky mz na dn lc nb nc dp lg lx nd ne li mb nf ng lk mf nh ni lm nj bi translated">3.1加载数据</h2><p id="56e4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">第一步是使用pd_read_csv加载数据，它读取csv文件的数据，加载并返回数据帧中的内容。您可能会问自己，什么是数据框？<strong class="lq ir">数据帧</strong>是pandas包中的主要数据结构，它以不同属性的表格显示数据，如下所示。有关pd.read_csv的更多信息，请访问<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="cae3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">本教程中使用的数据集是为本文创建的虚拟数据集。在此<a class="ae kv" href="https://github.com/sa312-art/MLmodel_AirlinesSatisfaction/files/7834047/project_data.csv" rel="noopener ugc nofollow" target="_blank">链接</a>中可以找到它，它包含了关于客户的有趣数据，可用于有针对性的营销活动。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="f202" class="mu kx iq mq b gy mv mw l mx my">#load the data and make sure to change the path for your local<br/>directory <br/>data = pd.read_csv('C:/Users/Smart PC/Desktop/project_data.csv')</span></pre><h2 id="3937" class="mu kx iq bd ky mz na dn lc nb nc dp lg lx nd ne li mb nf ng lk mf nh ni lm nj bi translated">3.2获得基本了解</h2><p id="23a7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">加载数据后，我们可以使用不同的方法来查看和理解变量。例如，data.head()使我们能够查看dataframe的前5行，而data.tail()返回最后5行。如果想获得前10行，需要在方法中将其指定为data.head(10)。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="b730" class="mu kx iq mq b gy mv mw l mx my">#first 5 rows<br/>data.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/dda08adda797993e5d4bd16a3d290273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLnNpWI7NOXMoOGRne9eEg.png"/></div></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="9f1b" class="mu kx iq mq b gy mv mw l mx my">#last 5 rows <br/>data.tail()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/7c71ff3129eff79d1446873e4b7c021e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*haG425ncDhNkFYrlxMFjSQ.png"/></div></div></figure><p id="2813" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">另一个有趣的方法是data.info()，它给出了数据集的数据点和变量的数量。它还显示数据类型。我们可以看到，我们的数据集有499个数据点和12个变量，从客户的个人信息到购买、通话、对讲机和投诉。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="63f2" class="mu kx iq mq b gy mv mw l mx my">#check the basic information of the data<br/>data.info()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/d83b06c3f9272b0b1298bf16583068d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*OZxT9589Sexg7WjzC0qwDA.png"/></div></figure><p id="62d4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以使用data.shape检查数据集的形状；它表明我们的数据集有449行和12列。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="7744" class="mu kx iq mq b gy mv mw l mx my">#extract the shape of the data<br/>data.shape</span></pre><p id="c0e0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">假设我们想知道婚姻状况字段的唯一值，那么我们应该选择列并应用唯一方法。如下所示，可变婚姻状况有5个独特的类别。但是，我们注意到寡妇和鳏夫是同一类别的两个不同的命名，因此我们可以通过对列值使用replace方法来使其保持一致，如下所示。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="006f" class="mu kx iq mq b gy mv mw l mx my">data['marital_status'].unique()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/fccd71df69aa403667256ed442b46c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*wKbu1eny0xRtfp8SU8vMiQ.png"/></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="8ecf" class="mu kx iq mq b gy mv mw l mx my">data[‘marital_status’] = data[‘marital_status’].replace(‘Widow’, ‘Widowed’)</span></pre><p id="2920" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">了解唯一值及其各自计数的另一个有趣方法是对列应用value_count方法。例如，教育属性有5个类别，其中毕业和博士构成了最大的比例。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="c6c9" class="mu kx iq mq b gy mv mw l mx my">round(data['educational_level'].value_counts(normalize=True),2)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/8a582bd0ad6cf22110234e0c32767659.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*rtvr2Si8pzlTMXt-oh1a0w.png"/></div></figure><p id="99a9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以使用。复制和。isnull方法。此外，我们可以在数据集中选择一个感兴趣的变量，以检测其缺失值或重复值，如下所示。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="09b3" class="mu kx iq mq b gy mv mw l mx my">data.isnull()<br/>data.duplicated().sum()<br/>data['educational_level'].isnull().sum() #specifying Education as a variable where we should look for the sum of missing values</span></pre><h2 id="61d2" class="mu kx iq bd ky mz na dn lc nb nc dp lg lx nd ne li mb nf ng lk mf nh ni lm nj bi translated">3.3选择和过滤数据:loc和iloc</h2><p id="4313" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们可以简单地从数据框中选择数据点的子集。让我们考虑我们想要选择每个客户的生日、教育和收入；这可以通过选择带有双括号的列名来实现，如下所示。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="b804" class="mu kx iq mq b gy mv mw l mx my">subset_data = data[['year_of_birth ', 'educational_level', 'annual_income']]<br/>subset_data</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/4ed579ebd7e1b8263ef9f518816183c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*IMfEND9bfa_l8nv9W2Ct6w.png"/></div></div></figure><p id="64cc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以通过指定只从数据框中返回“Master”来选择教育的唯一类别。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0a8b" class="mu kx iq mq b gy mv mw l mx my">data[data["educational_level"] == "Master"]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/720629405b5f722a2f02d7d106695128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGTDr4d5nMgzk8UOloMLOA.png"/></div></div></figure><p id="c201" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">从数据框中选择数据的另外两种流行方法是:loc和iloc。这两种方法的主要区别在于:loc是基于标签的，这意味着我们必须根据标题指定行和列。然而，iloc是基于整数位置的，因此我们必须按照整数位置值选择行和列，即:0，1，2。要了解更多关于使用这些方法选择数据的信息，请访问此<a class="ae kv" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="32c1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">正如我们在下面注意到的，我们使用loc方法选择前七个数据点，但是变量“educational_level”和“recency”。我们也可以使用iloc实现相同的结果，但是将行和列指定为整数值。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="6476" class="mu kx iq mq b gy mv mw l mx my">data.loc[:6, ['educational_level', 'recency']] #specify the rows and columns as labels</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/846725c53fca8e3776264512d970c94c.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*3Bxols6-jHaCzq0XicWZww.png"/></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="050d" class="mu kx iq mq b gy mv mw l mx my">data.iloc[:6, [2,6]] #speciy rows and columns as integer based values</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/75822db31b5aec868cef95c3f24622f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*2dnEXsMs6odsYU0j9-6Gcw.png"/></div></figure><p id="b014" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">另一个强大的工具是使用loc和isin()方法过滤数据，我们可以选择感兴趣的变量和我们想要的类别。例如，下面我们选择婚姻状况描述为单身或离婚的所有客户。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d1b1" class="mu kx iq mq b gy mv mw l mx my">data.loc[data[‘marital_status’].isin([‘Single’, ‘Divorced’])]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/a6a1a0ad370d0aeaf75e3daa98c7456d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luxQBZMIioFb-tFo0Z-bkQ.png"/></div></div></figure><p id="c598" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以将iloc与python操作符结合使用，以选择满足两个条件的数据，例如选择收入高于75，000英镑且拥有硕士学位的客户。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="cd02" class="mu kx iq mq b gy mv mw l mx my">data.iloc[list((data.annual_income &gt; 75000) &amp; (data.educational_level == 'Master')),  :,]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/971bbc8e2ef2a6c6a028d83984b20588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*xI9rBUdo5FqS7tvLFxDb_Q.png"/></div></figure><h2 id="3216" class="mu kx iq bd ky mz na dn lc nb nc dp lg lx nd ne li mb nf ng lk mf nh ni lm nj bi translated">3.4应用数据操作:索引、新变量、数据类型等等！</h2><p id="8456" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们可以使用Pandas对数据集应用不同的操作，例如但不限于:<br/> -使用。set_index()方法<br/> -使用变量之一对数据帧进行排序。sort_values()按升序或降序排列；有关sort_values()的更多信息，请访问<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html" rel="noopener ugc nofollow" target="_blank">链接</a> <br/> -创建一个新变量，该变量可能是数学运算的结果，例如其他变量的和<br/> -使用pd.cut()方法构建变量的类别；有关pd.cut()的更多信息，请访问<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.cut.html" rel="noopener ugc nofollow" target="_blank">链接</a> <br/> -将变量的数据类型更改为日期时间或整数类型<br/> -根据出生年份确定年龄<br/> -根据购买日期创建星期日期(日历周和年)<br/>等等；这只是我们用熊猫所能达到的成就的一瞥！</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0f0f" class="mu kx iq mq b gy mv mw l mx my">#set the index as customer_id<br/>data.set_index(‘customer_id’)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/927018fbc27b8fe116ea1b45681db7b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*r1ocfSuU7GWQvxRUj4VNXQ.png"/></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d46b" class="mu kx iq mq b gy mv mw l mx my">#sort the data by year_of_birth, ascending is default;<br/>data.sort_values(by = ['year_of_birth '], ascending = True) # if we want it in descending we should set ascending = False</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a548d45c962bf42b8a368049b3407d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*4jkCGQlc8gos9ZqBrjNj8w.png"/></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="27ad" class="mu kx iq mq b gy mv mw l mx my">#create a new variable which is the sum of all purchases performed by customers<br/>data['sum_purchases'] = data.online_purchases + data.store_purchases <br/>data['sum_purchases']</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/b74cabc7b75f6655fda2b9a16b33adbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*mYna21MOkQvcq6rfb5cR-Q.png"/></div></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="c7c4" class="mu kx iq mq b gy mv mw l mx my">#create an income category (low, meduim, high) based on the income variable<br/>income_categories = ['Low', 'Meduim', 'High'] #set the categories<br/>bins = [0,75000,120000,600000] #set the income boundaries <br/>cats= pd.cut(data['annual_income'],bins, labels=income_categories) #apply the pd.cut method<br/>data['Income_Category'] = cats #assign the categories based on income<br/>data[['annual_income', 'Income_Category']]</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ed1e4594d50d9e722cc60d4b33152d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*jAfksN9G7rU5c42d9I6C0g.png"/></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0733" class="mu kx iq mq b gy mv mw l mx my">#we can change the datatype of purchase_date to datetime and year_birth to integer<br/>data['purhcase_date'] = pd.to_datetime(data['purhcase_date'])<br/>data['year_of_birth '] = data['year_of_birth '].astype(int)</span><span id="c85f" class="mu kx iq mq b gy nz mw l mx my">#find out the age of customers based on the current year<br/>today = date.today()<br/>year = int(today.year)<br/>data['Age'] = year - data['year_of_birth ']<br/>data['Age']</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/aa42bdb4d0d43057bfe1c89b5f962174.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*4TZ95bZ0xBGhXRvy2gZayQ.png"/></div></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="0992" class="mu kx iq mq b gy mv mw l mx my">#extract the week_date from the purchase_date which shows the year of purchase and the calendar week<br/>#make sure to change the purhcase_date varibale to datetime as shown above before applying the .isocalendar() method<br/>data["week_date"] = [int(f'{i.isocalendar()[0]}{i.isocalendar()[1]}') for i in data.purhcase_date]<br/>data["week_date</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/13723230bfaac8b33e4ef41d9a1f0bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*sM76xmdokUd-UVgEe4x-Dw.png"/></div></div></figure><h2 id="519d" class="mu kx iq bd ky mz na dn lc nb nc dp lg lx nd ne li mb nf ng lk mf nh ni lm nj bi translated">3.5执行数据聚合:groupby和pivot_table</h2><p id="7248" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在我们创建了新的变量之后，我们可以进一步聚合，从类别中生成有趣的见解。每位数据科学家都使用两种主要方法来分组分析数据:</p><ol class=""><li id="f3d6" class="oc od iq lq b lr mk lu ml lx oe mb of mf og mj oh oi oj ok bi translated"><strong class="lq ir"> groupby() </strong>:一种方法，包括拆分类别、应用函数和组合结果，从而可用于数学运算，如均值、求和或计数以及按组的聚合视图。有关此操作的更多信息，请访问此<a class="ae kv" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html" rel="noopener ugc nofollow" target="_blank">链接</a></li></ol><p id="6c7d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">2.<strong class="lq ir"> pivot_table() </strong>:这是一种非常有用的技术，可以创建电子表格风格的数据透视表作为数据框架，它还允许分析师对每组中选定的变量应用数学运算。有关此pivot_table的更多信息，请访问此<a class="ae kv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html" rel="noopener ugc nofollow" target="_blank">链接</a></p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="6f8d" class="mu kx iq mq b gy mv mw l mx my">#apply groupby to find the mean of income, recency, number of web and store purchases by educational group<br/>aggregate_view = pd.DataFrame(data.groupby(by='educational_level')[['annual_income', 'recency', 'store_purchases',  'online_purchases']].mean()).reset_index()<br/>aggregate_view</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/bd0716d4fedbaef32946028eb88caa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*AHHID0DX7BQbLPpn9AyFvw.png"/></div></figure><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="cc4b" class="mu kx iq mq b gy mv mw l mx my">#apply pivot table to find the aggregated sum of purchases and mean of recency per education and marital status group<br/>pivot_table = pd.DataFrame(pd.pivot_table(data, values=['sum_purchases', 'recency'], index=['marital_status'],<br/>                        columns=['educational_level'], aggfunc={'recency': np.mean, 'sum_purchases': np.sum}, fill_value=0)).reset_index()<br/>pivot_table</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/5d2f7608de091f7b09f163a0a5761765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vZBYRf08MqMtbrOrBo8hmQ.png"/></div></div></figure><h1 id="df3a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak"> 4。建议</strong></h1><p id="faee" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在，在我们完成了数据清理和对数据集执行操作和聚合的过程之后，我们可以总结出一些关于我们客户群的有趣见解:</p><ul class=""><li id="ad74" class="oc od iq lq b lr mk lu ml lx oe mb of mf og mj on oi oj ok bi translated">博士人群收入最高，线上和店铺购买次数最多；然而，高中毕业生拥有最高的最近购买次数或最近购买天数</li><li id="3b16" class="oc od iq lq b lr oo lu op lx oq mb or mf os mj on oi oj ok bi translated">普通人在网上和商店购买的数量最少</li><li id="299c" class="oc od iq lq b lr oo lu op lx oq mb or mf os mj on oi oj ok bi translated">毕业水平的已婚人士购买总额最高</li></ul><p id="c0c2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">因此，对任何潜在营销活动的商业建议都应侧重于吸引和留住博士和具有毕业水平的已婚夫妇，并应提供更多产品来满足其他类别的需求和兴趣，如购买量最低的基本人群以及不经常购买的高中生。</p><p id="4975" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">此外，应开展进一步的工作来了解客户的行为和兴趣，例如，执行RFM分析或回归建模将有利于研究变量对教育或婚姻状况组购买数量的影响。</p><h1 id="60c0" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">5.结论</h1><p id="a4f0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最后，我希望这篇文章对您在即将到来的数据分析练习中使用pandas有所启发、实用和有用。下面是总结性的总结:<br/> - Pandas是一个建立在Python编程语言之上的数据分析库，<br/> - Pandas擅长对包含多个变量的大型数据集执行复杂操作，<br/> - Data frame是Pandas中的主要数据结构，<br/> - loc和iloc用于选择和过滤数据，<br/> - group_by和pivot_table是两个最知名的聚合方法。</p><p id="2770" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">敬请关注更多精彩的机器学习和数据分析分享知识内容。</p></div></div>    
</body>
</html>