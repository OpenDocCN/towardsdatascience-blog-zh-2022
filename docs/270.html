<html>
<head>
<title>Hybrid tables in Power BI — The ultimate guide!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Power BI中的混合表——终极指南！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hybrid-tables-in-power-bi-the-ultimate-guide-bfe07d480275#2022-01-10">https://towardsdatascience.com/hybrid-tables-in-power-bi-the-ultimate-guide-bfe07d480275#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="f708" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">Power BI中的混合表——终极指南！</h1></div><div class=""><h2 id="dc57" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">导入模式和DirectQuery在同一个表中？？？是的，借助Power BI中的最新混合表功能，可以从两个世界中获得最佳效果！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8c0cf38dda29f6cf4e02a9085c88b62f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fS3w9mwojAl4g1jc4d91kQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/HjV_hEECgcM" rel="noopener ugc nofollow" target="_blank">图片由迈克尔·马莱在Unsplash上拍摄</a></p></figure><p id="1062" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你知道这些漂亮的新车吗？它们将使用电力带你穿过城市拥堵，而在高速公路上，它们通过利用传统的汽油系统，帮助你释放发动机的全部功率。有时电动马达做所有的工作，有时是汽油发动机，有时它们一起工作。结果是燃烧的汽油更少，因此燃油经济性更好(当然，环境也更清洁)。在某些情况下，增加电力甚至可以提高性能。</p><p id="6333" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有混合动力汽车的想法，你是对的…</p><p id="4a04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，混合动力汽车与Power BI有什么共同之处？！嗯，最近以来，他们做到了——不是“汽车”本身，而是这种混合逻辑。</p><h2 id="dfaf" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">混合表—简短回顾</h2><p id="95a4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">微软在5月的商业应用峰会上宣布了混合桌的概念。而且，我必须承认，这是我从那时起就热切期待的功能之一。不要误解我，所有那些很酷的迷你图，新的格式选项，人工智能内置功能都很好…但是，我只是一个更关心性能而不是<a class="ae ky" rel="noopener" target="_blank" href="/building-an-end-to-end-analytic-solution-in-power-bi-part-4-from-chart-to-insight-56a543861477">好看的仪表盘</a>和视觉效果的人:)</p><p id="93b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="mt">免责声明:</em> </strong>在撰写本文时，混合表仍是预览功能，因此一旦它普遍可用，可能会发生一些功能不同的情况。</p><h2 id="a495" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">那么，最初的混合表是什么呢？</h2><p id="0f2b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">好了，在回答这个简单的问题之前，我们需要回过头来重申一下Power BI中的一个基本概念——<strong class="lb iu"><em class="mt">存储模式</em> </strong>。一旦开始构建您的解决方案，您就可以为您的表选择三种不同的存储模式:<strong class="lb iu"> Import </strong>模式(这是默认的，也是最常用的)，<a class="ae ky" href="https://data-mozart.com/direct-query-in-power-bi-what-when-why/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> DirectQuery </strong> </a>(在查询执行之前、期间和之后，数据驻留在Power BI表格模型之外)，或者<strong class="lb iu"> Dual </strong>(数据被导入到缓存中，但也可以在查询时直接从数据源提供)。</p><p id="2fc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个具体考虑:“我应该使用导入模式还是DirectQuery？”总是在性能和报告中实时数据的要求之间进行权衡。</p><p id="950f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并且，现在让我们来回答原来的问题:<strong class="lb iu"> <em class="mt">混合表在单个表</em> </strong>中结合了Import和DirectQuery模式！在我们深入研究并试图理解混合表在多种不同场景中的行为之前，让我们解释一下混合表如何帮助您在性能和实时数据需求之间实现最佳平衡。</p><h1 id="f020" class="mu lw it bd lx mv mw mx ma my mz na md jz nb ka mg kc nc kd mj kf nd kg mm ne bi translated">场景#1 —导入模式中的“冷”数据，DirectQuery中的“热”数据</h1><p id="e0db" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">使用这种方法，您基本上是在优先考虑实时需求，但是混合表应该可以帮助您获得比“纯”DirectQuery场景更好的性能比。这是怎么回事？好吧，假设你有一个有5亿行的巨型事实表。而且，业务要求数据的最大延迟为1分钟——显然，即使<a class="ae ky" rel="noopener" target="_blank" href="/power-bi-how-to-fit-200-million-rows-in-less-than-1gb-63ab5a4eb1c0">能够将5亿行数据加载到内存</a>中，也无法如此频繁地设置计划刷新！</p><p id="3309" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，唯一可行的选择是将表保持在DirectQuery模式，忍受用户抱怨报告非常慢。不再是了！以下是混合桌可以帮您节省时间的方法:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/76897c039b94afd55df33e897758411a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2VV0ZN1NhOqjSf2eHHm_GQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4974" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们简单地检查一下上图背后的逻辑。想象一下，您的大多数分析查询都是针对过去7天的数据，但是还额外要求实时获得最新数据！历史数据不是特别感兴趣，只是偶尔需要。</p><p id="9255" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，混合表有什么好处？首先，不是在DirectQuery模式下保留整个“5亿行”表，而是只有“最热”的数据保留在将使用DirectQuery模式提供服务的分区中。而且，我猜您可以假设需要扫描10.000行而不是5亿行的查询的性能会有什么不同…</p><p id="e73f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，您可以获得查询“最近”数据(本月最后X天的数据)的额外性能提升，因为您可以为该数据配置增量刷新，并从缓存中提供查询…我们稍后将了解如何配置混合表以用于该场景，但我有一个好消息:除了选中几个复选框之外，您基本上不需要做任何特别的事情！</p><h1 id="5622" class="mu lw it bd lx mv mw mx ma my mz na md jz nb ka mg kc nc kd mj kf nd kg mm ne bi translated">场景#2 —导入模式中的“热”数据，DirectQuery中的“冷”数据</h1><p id="a8ed" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">第二个场景和上一个是180度！而且，这个场景让人想起我们现在正在用聚合和复合模型来获得两个世界的最佳效果。本质上，我们在原始的DirectQuery事实表<a class="ae ky" rel="noopener" target="_blank" href="/power-bi-how-to-fit-200-million-rows-in-less-than-1gb-63ab5a4eb1c0">中保留历史的、低级别的数据，同时聚合“热”数据并将其导入Power BI </a>中，以获得VertiPaq引擎提供的最佳性能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e6da714adc6817c4015c7d619fe278a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0RUeik6SQZXcxQuGou15A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c586" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这种设置，我们优先考虑性能和<a class="ae ky" rel="noopener" target="_blank" href="/how-to-reduce-your-power-bi-model-size-by-90-76d7c4377f2d">减少数据模型大小</a>而不是实时需求。这个场景适合于大多数分析查询针对最近的数据，但是<em class="mt">没有具体要求实时数据</em>的情况！这样做是为了减少表的内存占用，因为大部分数据不会导入到Power BI中，而是继续“存在”在SQL数据库中。</p><p id="9aee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个需求，没有现成的解决方案可以为您处理混合场景，并且需要一些额外的工作来配置表。请继续关注，稍后我将向您展示这是如何做到的…</p><h1 id="f70b" class="mu lw it bd lx mv mw mx ma my mz na md jz nb ka mg kc nc kd mj kf nd kg mm ne bi translated">为场景#1做好准备</h1><p id="2907" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">好了，理论到此为止，是时候动手实践一下混合表在现实中是如何工作的了。让我们首先检查场景#1。但是，在我们配置混合表之前，我将首先在“常规”表上运行一些测试查询，这样我们可以稍后比较性能。</p><p id="0284" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将使用示例Contoso数据库中的FactOnlineSales SQL Server表，该表包含1260万行。假设我们的报表用户想要实时查看最新的数据，那么我们将让我们的表处于纯DirectQuery模式。</p><p id="1dd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将创建一个简单的DAX度量来计算总行数:</p><p id="25dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总行数= COUNTROWS(FactOnlineSales)</p><p id="5435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还将打开性能分析器工具来<a class="ae ky" rel="noopener" target="_blank" href="/how-to-capture-sql-queries-generated-by-power-bi-fc20a94d4b08">捕获Power BI生成的时间</a>，因为我们的表使用“纯”DirectQuery存储模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4d6a4544b199645caae858c4b42852b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QHFHpP0i55rGAk0bM69NlA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="fa6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，表中有1260万行，Power BI需要大约0.5秒返回结果。由于我的用户需要看到实时数据，我将打开<a class="ae ky" rel="noopener" target="_blank" href="/auto-page-refresh-in-power-bi-everything-you-need-to-know-a6e7bd9d0444">自动页面刷新功能</a>，并设置我的页面每30秒刷新一次。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/143ca47a61714659343215d9aaab3b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgh3szLkpYZTpZ05bS5b2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="154b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同时，我将对FactOnlineSales表运行以下SQL查询:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="8e4d" class="lv lw it ng b gy nk nl l nm nn">WHILE 1=1<br/>BEGIN<br/>   WAITFOR DELAY '00:00:05' -- Wait 5 seconds<br/><br/>  INSERT INTO dbo.FactOnlineSales<br/>  (<br/>      DateKey,<br/>      StoreKey,<br/>      ProductKey,<br/>      PromotionKey,<br/>      CurrencyKey,<br/>      CustomerKey,<br/>      SalesOrderNumber,<br/>      SalesOrderLineNumber,<br/>      SalesQuantity,<br/>      SalesAmount,<br/>      ReturnQuantity,<br/>      ReturnAmount,<br/>      DiscountQuantity,<br/>      DiscountAmount,<br/>      TotalCost,<br/>      UnitCost,<br/>      UnitPrice,<br/>      ETLLoadID,<br/>      LoadDate,<br/>      UpdateDate<br/>  )<br/>  VALUES<br/>  (   GETDATE(), -- DateKey - datetime<br/>      1,         -- StoreKey - int<br/>      1,         -- ProductKey - int<br/>      1,         -- PromotionKey - int<br/>      1,         -- CurrencyKey - int<br/>      1,         -- CustomerKey - int<br/>      N'',       -- SalesOrderNumber - nvarchar(20)<br/>      NULL,      -- SalesOrderLineNumber - int<br/>      0,         -- SalesQuantity - int<br/>      10,      -- SalesAmount - money<br/>      0,         -- ReturnQuantity - int<br/>      NULL,      -- ReturnAmount - money<br/>      NULL,      -- DiscountQuantity - int<br/>      NULL,      -- DiscountAmount - money<br/>      5,      -- TotalCost - money<br/>      NULL,      -- UnitCost - money<br/>      NULL,      -- UnitPrice - money<br/>      NULL,      -- ETLLoadID - int<br/>      NULL,      -- LoadDate - datetime<br/>      NULL       -- UpdateDate - datetime<br/>      )<br/><br/>END</span></pre><p id="4ed8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个语句基本上模拟了一个真实的事务数据库，每5秒钟插入一个新行。请不要注意语句中提供的所有值，因为这只是一个虚拟表。一旦我执行了这条语句，并将自动页面刷新设置为每30秒一次，在三次运行中的每一次中，一个查询花费大约0.5秒来返回总行数。您可能会注意到行数在可视化中是如何变化的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/00916f92c8db17cdc369aaba17da8791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ij59OBVYF8P9kFWFuTklLw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0215" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候配置我们的混合表了，看看会发生什么。第一步是将表从DirectQuery切换到Import模式，因为混合表只适用于Import模式——本质上是通过使用DirectQuery为最新数据在其上添加“实时”分区。然后，我将数据集发布到高级工作空间(在本演示中我使用PPU)。完成后，我将返回并为我的表选择增量刷新:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/85317029e5340498399de2097dbce9f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQegeHc8hZswjUej7OVL_w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="028b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将我的数据集发布到Power BI服务，并等待第一次刷新完成(这可能需要一段时间，因为需要创建表分区并加载“冷”历史数据)。一旦完成，这是我们的报告:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9e09e5b6861144d51bca9f07f0be365d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RjU9Wedx5JInaFLyWCj74A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d3a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能会发现，数据是实时变化的，因为我们将自动页面刷新设置为30秒，DirectQuery分区只扫描最新的数据来满足这个查询请求。</p><p id="df2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的关键要点是:通过利用混合表，我们设法从两个世界中获得最佳效果——保持VertiPaq引擎的超快性能，同时使报告消费者能够实时更新数据！</p><h1 id="99c3" class="mu lw it bd lx mv mw mx ma my mz na md jz nb ka mg kc nc kd mj kf nd kg mm ne bi translated">配置场景#2</h1><p id="7155" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在第二个场景中，我们不能依赖Power BI在导入数据的分区上自动应用DirectQuery分区。正如已经提到的，在这种情况下，我们需要一些额外的工作来设置东西。总体思路是翻转需求，将“热”数据保留在导入模式中，而将“冷”数据保留在DirectQuery中。</p><p id="bc52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的第一个警告是，您不能在这种情况下使用Power BI Desktop，因为Power BI Desktop不允许您创建自定义分区。但是，这里的好消息是，我们可以使用外部工具通过XMLA端点操纵TOM(表格对象模型)。为此，最流行的工具是<a class="ae ky" rel="noopener" target="_blank" href="/top-features-in-tabular-editor-3-to-boost-your-power-bi-development-6140d90d2cac">表格编辑器</a>。</p><p id="9680" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，我们希望将“热”和“冷”数据分割到不同的分区中:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="6d0f" class="lv lw it ng b gy nk nl l nm nn">SELECT *<br/>FROM FactOnlineSales<br/>WHERE DateKey &gt;= DATEADD(MONTH, -3, CONVERT(DATE,GETDATE()))</span></pre><p id="5756" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是将包含前3个月的“热”数据的分区。你可以根据需要调整这个门槛。</p><p id="6a5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我的分区定义在表格编辑器中的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/25ba007f60db2c38d2773201ea39a6bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2O4eraxpEnyucG2GS6c6iA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1d15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经将现有分区重命名为热数据。下一步是复制这个分区，并将源查询调整为只针对“冷”数据(在我的例子中，是超过3个月的数据):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8043fbfc60877e47fdce3e6acc8aaf11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nzH9Rsiu19MJ26lrUFU1hw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3fad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我现在将这个查询的模式属性从Import切换到DirectQuery:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/af5aa04ebb4bf5593149f49eeea2ebfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bUlVVPXsDwpHFzjxFmcavw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="10c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将保存包含所有更改的数据集，并打开SQL Server Profiler来检查它在不同的日期分片要求下的表现:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7201372c83153804c721ba37102efb85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_woiQEkenOM8zp6RvrVuw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9159" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使我们对过去3个月的数据进行切片(“热”数据)，仍有DirectQuery在后台运行！感谢微软的王南钧·萨考斯基的提醒，他警告说这种事情还在发生！T3】</p><p id="1ff2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我真的希望不要编写复杂的DAX来获得最高性能，就像我在这里解释的<a class="ae ky" rel="noopener" target="_blank" href="/how-to-reduce-your-power-bi-model-size-by-90-76d7c4377f2d">一样，通过利用混合概念，我们将能够在数据模型的性能和内存占用之间获得最佳平衡。但是，如果对“热”或“冷”数据进行切片，DirectQuery查询似乎仍然会运行。</a></p><h1 id="3ae4" class="mu lw it bd lx mv mw mx ma my mz na md jz nb ka mg kc nc kd mj kf nd kg mm ne bi translated">考虑和限制</h1><p id="4996" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">无论看起来多么酷和强大(它们确实很酷和强大)，实现混合表都有一些限制。</p><p id="69ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，这是(至少目前是)仅<strong class="lb iu"> <em class="mt">高级特性</em> </strong>，这意味着您需要一个P/EM/A SKU，或PPU(每用户高级)来利用混合表。</p><p id="6655" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，由于所有场景中都涉及到DirectQuery，您应该知道适用于DirectQuery模式的所有一般<a class="ae ky" href="https://docs.microsoft.com/en-us/power-bi/connect-data/desktop-use-directquery#considerations-and-limitations" rel="noopener ugc nofollow" target="_blank">限制</a>。这意味着，没有复杂的幂查询转换，没有复杂的DAX计算——或者简单地说——忘记任何不能转换成SQL的东西<a class="ae ky" rel="noopener" target="_blank" href="/what-is-a-query-folding-in-power-bi-and-why-should-i-care-5b89f42f38d7">！</a></p><p id="9730" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，无论您是否仅筛选来自导入分区的数据，DirectQuery分区仍将包括在扫描中。我真诚地希望微软的工程师们能够提出一个解决方案，在查询不需要的时候消除DirectQuery分区。</p><p id="1003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，在您选择“混合动力”之前，还有一些事情需要记住:</p><ul class=""><li id="f978" class="no np it lb b lc ld lf lg li nq lm nr lq ns lu nt nu nv nw bi translated">一旦您将数据集发布到Power BI服务，您就不能再次从Power BI Desktop重新发布相同的数据集，因为这将删除数据集中已经存在的任何现有分区和数据</li><li id="63bf" class="no np it lb b lc nx lf ny li nz lm oa lq ob lu nt nu nv nw bi translated">将数据集发布到Power BI服务时，不能将带有数据集的PBIX下载回Power BI Desktop</li></ul><p id="85e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p><p id="a0bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://datamozart.medium.com/membership" rel="noopener">成为会员，阅读Medium上的每一个故事！</a></p></div></div>    
</body>
</html>