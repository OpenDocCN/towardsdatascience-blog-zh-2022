<html>
<head>
<title>N-BEATS Unleashed: Deep Forecasting Using Neural Basis Expansion Analysis in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">N-BEATS Unleashed:使用Python中的神经基础扩展分析进行深度预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/n-beats-unleashed-deep-forecasting-using-neural-basis-expansion-analysis-in-python-343dd6307010#2022-01-10">https://towardsdatascience.com/n-beats-unleashed-deep-forecasting-using-neural-basis-expansion-analysis-in-python-343dd6307010#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4240" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">深度预测</h2><div class=""><h1 id="3043" class="pw-post-title jb jc it bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">N-BEATS Unleashed:使用Python中的神经基础扩展分析进行深度预测</h1></div><div class=""><h2 id="adee" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">端到端示例:具有复杂季节性的多变量时间序列的神经预测</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi kr"><img src="../Images/4a078f30346774717a34e61cd765ccff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*p6sz7Jm4lFkp3iTKBUToLQ.jpeg"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><a class="ae ld" href="https://pixabay.com/illustrations/fractal-math-geometry-rendering-1943505/" rel="noopener ugc nofollow" target="_blank">分形数学几何——数码艺术家在像素上的自由图像</a></p></figure><p id="4c6e" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">上周，我开始撰写一系列关于深度预测的文章。我们讨论的第一种方法是变压器。</p><div class="ma mb gp gr mc md"><a rel="noopener follow" target="_blank" href="/transformer-unleashed-deep-forecasting-of-multivariate-time-series-in-python-9ca729dac019"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">变形金刚释放:Python中多元时间序列的深度预测</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">端到端示例:具有复杂季节性的多变量时间序列的概率预测</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr kx md"/></div></div></a></div><p id="1e8e" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">今天，让我们为我们的武器库中添加另一个神经网络预测器:<strong class="lg jd"> N-BEATS，</strong>时间序列的<strong class="lg jd">神经基础扩展分析</strong>。</p><p id="691d" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N-BEATS是<a class="ae ld" href="https://arxiv.org/abs/1905.10437" rel="noopener ugc nofollow" target="_blank">Oreshkin等人在2019年的一篇文章中首次描述的一种神经网络类型</a>作者报告称，N-BEATS的表现超过了M4预测竞赛获胜者3%。M4获奖者是递归神经网络和Holt-Winters指数平滑的混合体——而N-BEATS实现了一种“纯粹的”深度神经架构。</p><p id="e31b" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们将使用N-BEATS的PyTorch实现，通过<strong class="lg jd"> Darts </strong>多预测库，我在上周的Transformer示例中使用了相同的包。Darts将PyTorch的预测相关类与其他几个包的预测相关类结合在一起。通过在一个全面的时间序列库中包装多种方法，Darts便于在预测方法、预处理和评估任务之间切换。</p><p id="2e60" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">为了与变压器进行比较，我们将再次预测西班牙的每小时电价。时间序列展示了三种季节性模式:小时、工作日和月份。30多个外生变量影响着价格水平。这两个方面将价格转化为一个时间序列问题，这个问题非常复杂，以至于深度预测要优于经典方法。</p><h1 id="bfcb" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">1.N拍的概念</h1><p id="40e7" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">关于N-BEATS的开创性论文将其重点“<a class="ae ld" href="https://arxiv.org/pdf/1905.10437.pdf" rel="noopener ugc nofollow" target="_blank">放在使用深度学习解决单变量时间序列点预测问题上。“我们将超越最初的范围:整合协变量，生成概率预测而不是点估计。Darts通过将源数据展平为一维序列，使原始N-BEATS架构适应多元时间序列。</a></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi np"><img src="../Images/19aa6cfc0c5281b46057506fdfe15ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T9XlNOhCqwqVzWMXwkspOA.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">【1905.10437.pdf(arxiv.org)<a class="ae ld" href="https://arxiv.org/pdf/1905.10437.pdf" rel="noopener ugc nofollow" target="_blank"/>【N-BEATS】，奥列什金等人(2020)</p></figure><p id="5889" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">该模型由一系列堆栈组成，每个堆栈组合多个块。这些模块通过预测和反向预测链接连接前馈网络。块“<a class="ae ld" href="https://arxiv.org/pdf/1905.10437.pdf" rel="noopener ugc nofollow" target="_blank">移除信号的一部分…它可以很好地近似</a>。然后，该模块将注意力集中在剩余误差上，这是前面的模块无法解决的。每个块生成一个局部预测，其重点是时间序列的局部特征。堆栈汇总其包含的块的部分预测，然后将结果移交给下一个堆栈。堆栈的目的是通过“回顾”来识别整个时间轴上的非局部模式最后，将部分预测拼凑成模型级别的全局预测。</p><p id="e4f1" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N-BEATS的超参数为:</p><ul class=""><li id="fdd7" class="nu nv it lg b lh li lk ll ln nw lr nx lv ny lz nz oa ob oc bi translated"><strong class="lg jd">输入层</strong>和<strong class="lg jd">输出层</strong>(常量INLEN和N_FC)的大小应足以为源数据中的每个特征分配一个节点。输入语块的长度不能小于季节性的顺序，否则学习过程会发现更难组合这些语块。为了有效使用内存，请将它们设置为2的幂。</li><li id="4a5f" class="nu nv it lg b lh od lk oe ln of lr og lv oh lz nz oa ob oc bi translated">堆栈中的<strong class="lg jd">块数</strong>(块数)。</li><li id="bf16" class="nu nv it lg b lh od lk oe ln of lr og lv oh lz nz oa ob oc bi translated">栈的每个块中每个全连接<strong class="lg jd">层</strong>的<strong class="lg jd">宽度</strong>:其节点计数(LWIDTH)。</li><li id="40ad" class="nu nv it lg b lh od lk oe ln of lr og lv oh lz nz oa ob oc bi translated"><strong class="lg jd">批量大小</strong>定义了模型在更新其矩阵权重之前将处理的观察数量。为了有效地将它与系统的内存结构对齐，将其设置为2的幂。非常大的批量可能会误导单方向的梯度下降——模型可能会陷入次优最小值。较小的批量将导致梯度下降在不同方向反弹，并可能导致较低的精度，但它们也有助于防止模型<a class="ae ld" href="https://arxiv.org/abs/1609.04836" rel="noopener ugc nofollow" target="_blank">过度拟合</a>。最常见的建议是选择初始批量为32。因为我们的数据集有每天24小时的频率，所以我将批处理大小设置为可以处理24个时间步长的下一个二进制上限:32。</li><li id="0cf1" class="nu nv it lg b lh od lk oe ln of lr og lv oh lz nz oa ob oc bi translated"><strong class="lg jd">时期</strong>告诉模型它应该运行多少个训练周期。在每个时期，模型将处理整个训练集，进行一次向前和一次向后传递。</li></ul><p id="7224" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">考虑到一些过度简化，这些超参数的乘积定义了模型的张量大小。较大的参数值会使它与系统的内存限制相冲突，并导致处理时间成倍增长。而小参数值可能不足以反映源数据中的复杂模式。</p><p id="7b28" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">正如我们在Transformer示例中所做的那样，我们将使用分位数回归得出一个<strong class="lg jd">概率</strong>预测。这是我们可以在所有深度预测模型中使用的一个选项。神经网络的损失函数可以公式化为<em class="oi">分位数损失函数。</em>然后，分位数回归不仅会计算每个时间步的中心预测值(也称为点估计值)，还会绘制不确定性带。像1%/99%或10%/90%这样的分位数对表示预测值可以变化的范围，高于或低于中心值。</p><p id="38e7" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">关于概率性预测而非确定性预测的更多背景信息，请参考本文:</p><div class="ma mb gp gr mc md"><a rel="noopener follow" target="_blank" href="/temporal-fusion-transformer-a-primer-on-deep-forecasting-in-python-4eb37f3f3594"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">时态融合转换器:Python深度预测入门</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">端到端的例子:概率时间序列预测使用TFT，一个基于注意力的神经网络</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="oj l mo mp mq mm mr kx md"/></div></div></a></div><h1 id="e69e" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">2.属国</h1><p id="59a8" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">除了用于数据争论和探索的经典包，如pandas、numpy和matplotlib，我们还引入了seaborn的绘图功能。</p><p id="cfc9" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">小的<em class="oi"> missingno </em>包是可选的:missingno有助于可视化空值是如何分布在行和列上的。但是，您可以选择不安装它，并删除它的代码行，而不会影响预测脚本的其余部分。</p><p id="9e83" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">最后，我们需要conda-install或pip-install Darts包及其PyTorch选项，它涵盖了我们可以通过Darts实例化的所有神经网络变体:<a class="ae ld" href="https://github.com/unit8co/darts/blob/master/README.md#installation-guide" rel="noopener ugc nofollow" target="_blank">Darts/readme . MD at master unit 8co/Darts GitHub</a>。</p><p id="b430" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">最好为飞镖创造一个新的虚拟环境。这是我们在安装大的软件包之前应该一直遵循的实践，特别是那些具有非Python依赖性的软件包。PyTorch和Prophet依靠C++。</p><p id="2a29" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">Darts至少需要Python 3.7，目前还不支持3.10。我在3.9中也看到过由Prophet选项导致的安装hickups，所以我选择了Python 3.7 conda环境(2021年12月)。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h1 id="2ebe" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">3.设置</h1><p id="45cb" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">Jupyter笔记本的设置单元列出了将控制N-BEATS模型的超参数。它为脚本的其他方面添加了许多额外的控制设置。</p><p id="02ea" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在最顶端，我们可以看到负载参数。如果用户设置为True，脚本将不会(重新)训练模型，但是会将以前保存的tar文件从当前工作目录加载到内存中。该脚本将根据这个加载的模型创建预测值，并跳过耗时的培训课程。LOAD选项对于将预训练的模型转移到不同的机器上也很有用，例如生产服务器。</p><p id="b315" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">RAND参数接受随机种子，这将使结果可重复。</p><p id="12d8" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N_SAMPLES建议模型在一个时间步长内绘制N个随机预测值，而不是只计算一个点估计值。对于概率预测，N_SAMPLES必须设置为大于1。样本数量不会显著增加处理时间。分位数损失函数以低计算成本生成样本。</p><p id="6b27" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N-JOBS限制了脚本可以并行请求的处理器内核数量。如果设置为-1，所有核心都将可用于模型。</p><p id="18ee" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">列表分位数通知模型应该计算预测分位数的百分比。</p><p id="b875" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">分割设置应该为培训保留的实际观察的百分比份额。</p><p id="74b7" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">FIGSIZE建议使用默认的绘图尺寸。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h1 id="7672" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">4.时间序列</h1><p id="fefd" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">该数据集可从Kaggle下载，获得CC0公共域名许可:<a class="ae ld" href="https://www.kaggle.com/nicholasjhana/energy-consumption-generation-prices-and-weather" rel="noopener ugc nofollow" target="_blank">每小时能源需求生成和天气| Kaggle </a></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi om"><img src="../Images/ae317a7b2a3d5644e2d16944ee8bab61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2K92NV8PD8ZqJQPFvCTZiQ.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><a class="ae ld" href="https://www.kaggle.com/nicholasjhana/energy-consumption-generation-prices-and-weather" rel="noopener ugc nofollow" target="_blank">每小时能源需求生成和天气| Kaggle </a>，作者截图</p></figure><p id="84b5" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">源文件由两个csv文件组成:</p><ul class=""><li id="38cd" class="nu nv it lg b lh li lk ll ln nw lr nx lv ny lz nz oa ob oc bi translated">能源文件记录了西班牙每小时的电价，单位为欧元/百万瓦时(€/兆瓦时)；按来源分类的发电量(煤、天然气、风力等。)在MWh和以MWh为单位的能量需求(“负载”)。</li><li id="11b0" class="nu nv it lg b lh od lk oe ln of lr og lv oh lz nz oa ob oc bi translated">天气文件提供了西班牙五个主要城市的每小时记录。</li></ul><p id="b297" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们将我们的分析限制在观测数据的最后一年，即2018年，并预测接近年底时约870个时间步长的每小时电价。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="a677" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">能源数据集中的大部分栏目都按能源类型(如风力、煤炭或太阳能发电厂)报告发电量，单位为兆瓦时。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi on"><img src="../Images/a5e757ad3e77040a26aba98743758c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2u1dJq8dy25QOC67RMmTTA.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="ded4" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N-BEATS笔记本包含了数据处理和预处理的完整代码。你可以在上周的教程中找到这些步骤的详细解释和它们的笔记本单元:“<a class="ae ld" rel="noopener" target="_blank" href="/transformer-unleashed-deep-forecasting-of-multivariate-time-series-in-python-9ca729dac019">变形金刚释放</a>”</p><p id="167a" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">价格图显示了一条具有垂直波峰和波谷的曲线。它们的幅度各不相同，这意味着我们面临不止一种季节性。价格水平没有呈现强劲的上升或下降趋势。它趋于回到€ 60/MWh左右的水平。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi oo"><img src="../Images/f64c566752f538f71ff5b6e0dac0888e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EkHuxc8ZhSFNQ8Igj0Ueuw.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="1e24" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">天气数据集包括五个西班牙大城市及其每小时的天气记录。</p><p id="743c" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们将把能源数据和天气数据结合在一个数据帧中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi op"><img src="../Images/d1840cd94b2d30987ea74e6dc63f1ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*Ad3f1AgQsCHNSkpf-nlJ-g.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="a6ee" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">相关矩阵将使我们能够辨别众多因素对电价的影响。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi oq"><img src="../Images/6ce6b8b84f0e9545213b3ac98fc896c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9j-6rnd-zDachIBx9Wq7yg.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="038c" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">该热图强调了许多特征彼此高度相关，尤其是城市温度。我们将把那些至少对价格水平有适度影响的因素分离出来。这种功能集的减少是我在第一篇文章中描述的一个练习:<a class="ae ld" rel="noopener" target="_blank" href="/transformer-unleashed-deep-forecasting-of-multivariate-time-series-in-python-9ca729dac019"> Transformer Unleashed </a>。</p><p id="bd5e" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">接下来，我们应该调查时间序列的季节性。</p><p id="fd79" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">当我们按月份和工作日对价格进行分组时，得到的数据透视表与热图相结合，可视化了两种季节性模式:月与月之间；还有工作日和周末的区别。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi or"><img src="../Images/bf64136b982e0f9dc03f60a288e3ecbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*z1KZ1KHXS9XJVbz0zZ_bPg.png"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="49e5" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">第二个数据透视表及其热图揭示了某一天电价的每小时季节性模式。白天和夜间的时间变化，以及工作日和周末的时间变化，显示了和每月季节性一样的对比。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/b4525d8e5a83f49482a2a4b189096aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*pyWnMy8Dk-RVKFRfvY3WtQ.png"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="74f6" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们得出结论，N-BEATS模型必须学习三种季节模式:</p><ul class=""><li id="78aa" class="nu nv it lg b lh li lk ll ln nw lr nx lv ny lz nz oa ob oc bi translated">每小时的价格波动</li><li id="6558" class="nu nv it lg b lh od lk oe ln of lr og lv oh lz nz oa ob oc bi translated">工作日与周末</li><li id="e81c" class="nu nv it lg b lh od lk oe ln of lr og lv oh lz nz oa ob oc bi translated">寒冷和温暖的月份</li></ul><h1 id="5006" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">5.飞镖中的时间序列对象</h1><p id="2584" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">Darts对时间序列对象进行操作，我们需要将包含源数据的pandas序列(或numpy数组)转换成时间序列对象。</p><p id="a5af" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">首先，我们从数据框架的价格列创建一个单变量目标时间序列ts_P。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/dcc65046fa8dee6d07559e25ca3538fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*-ylAFOBdsmzWXw-NybRhxA.png"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="1073" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">然后，我们将数据帧的特征列分组到协变量的多元时间序列中:ts_covF。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="19e4" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">接下来，我们在训练集和测试集之间拆分价格时间序列。</p><p id="72bb" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">如果数据集包含不同量值的值，神经网络的梯度下降可能被误导。我们实例化Darts的scaler类，并在将Scaler应用于训练集和测试集之前，使其适合price时间序列的训练集。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="b0f8" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">然后，我们采取类似的步骤来准备特征协变量。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi ou"><img src="../Images/7d3e1c51840f05237f2858255ca389d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rT5Oi-Uq2XOIeBcYd5r6MQ.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="0e84" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">Darts的函数<em class="oi">datetime _ attribute _ time series()</em>使我们能够将小时、工作日和月分离为协变量。</p><p id="929a" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">请注意，第2行将我们在实际观测中发现的时间步长增加了48小时。这样，我们已经为实际观测结束后的样本外预测准备了时间序列。</p><p id="5a36" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">第3行到第5行将日期时间协变量“堆叠”在一起，放在一个多变量时间序列对象中。</p><p id="c39e" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">第7行包含一个标记西班牙公共假日的函数，因此增加了一个有用的第四个协变量。</p><p id="d7d6" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">第12行在训练集和测试集之间划分日期时间协变量，然后第16到20行调整它们的值。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="58dd" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated"><em class="oi"> concatenate() </em>函数合并多变量时间序列对象中的特征协变量和日期时间协变量。<em class="oi"> slice_intersect() </em>函数确保组件在时间轴的同一段上延伸，否则如果我们试图组合长度不等的时间序列，就会看到一条错误消息。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><h1 id="dce6" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">6.训练N-BEATS模型</h1><p id="3e17" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">我们使用笔记本顶部的设置单元中定义的超参数来配置N拍模型。</p><p id="0a43" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">参数<em class="oi">似然=分位数回归(分位数)</em>建议模型在每个时间步从分位数损失函数中抽取样本。这将产生分位数的概率预测，而不仅仅是点估计。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="d88b" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">下面的训练单元评估我们在笔记本顶部设置的<em class="oi">负载</em>常数。如果LOAD设置为True，脚本将不会(重新)训练N-BEATS模型，而是会加载一个以前保存在tar文件中的模型，该模型现在应该位于当前工作目录中。这个保存并重新加载的模型保留了它的训练状态——我们可以从中提取预测值，而无需进行另一个耗时的训练练习。</p><p id="5dda" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">如果LOAD设置为False，N-BEATS会忠实地开始训练。完成后，它的状态会自动保存在一个tar文件中，以使其可重用——或者使其可传输给同事、客户或生产服务器。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi ov"><img src="../Images/2f116f1c87a51ee17f910c5c3d30c087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eFOObRdmkpOTy1l4xAj8pQ.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><h1 id="8a00" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">7.测试</h1><p id="aad2" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated"><em class="oi"> predict() </em>函数将测试集的长度作为其预测范围。我们提供协变量的时间序列(基于时间和特征)作为第二个参数。</p><p id="2278" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">第13到18行初始化了我们将收集预测结果的变量。</p><p id="60ce" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">第37行的list comprehension为列表分位数中的每个百分比调用辅助函数<em class="oi"> predQ() </em>。</p><p id="4ec4" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">该函数通过分位数回归在第23行获得分位数。每个预测分位数代表其自身的单变量时间序列。第24行逆变换这些分位数值，使它们与原始电价兼容。然后，第25到27行在结果数据帧dfY的新列中收集这一系列分位数值。</p><p id="5ada" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们将50%分位数——中位数或中心预测序列——映射到专用变量ts_q50。然后，我们将这个预测中值与实际序列进行比较，以获得准确性指标MAPE和RMSE。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi ow"><img src="../Images/5bae6008fc9f23f47fcbe4cbf9dbacc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mlk--KONYs51IHlyJKtn8A.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="77c6" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">以6.57的MAPE衡量，预测质量并不算糟糕。但是这比我们从变形金刚实验中得到的要差。转换器生成了一个MAPE为4.57的预测。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi ox"><img src="../Images/e2f724480fcc15e592a352c3a711bc4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D72x7RieoYp28jNJrUC6WA.png"/></div></div></figure><p id="0b41" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N-BEATS模型似乎在12月下旬受到向下偏差的困扰，此时蓝色预测曲线的倾角始终比实际观测值更深。N-BEATS是否对“假日”协变量赋予了过多的权重，而12月假日的价格与其他假日的价格有所不同？</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi oy"><img src="../Images/d6fe25da118645aaacc6694c6b36bbf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZTVfB4EJqsJ3hh0lBgJlVQ.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="baba" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">训练集不包括12月的前一个月，这可能为N-BEATS识别特定于12月的模式提供了更全面的基础。</p><p id="d827" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们也可以开始一个调整过程。Darts为N-BEATS和其他深度预测器提供了网格搜索—穷举或随机采样—请参见本文中的Python示例:</p><div class="ma mb gp gr mc md"><a rel="noopener follow" target="_blank" href="/temporal-fusion-transformer-a-primer-on-deep-forecasting-in-python-4eb37f3f3594"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">时态融合转换器:Python深度预测入门</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">端到端的例子:概率时间序列预测使用TFT，一个基于注意力的神经网络</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="oj l mo mp mq mm mr kx md"/></div></div></a></div><p id="e636" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">但是N-BEATS的处理时间有点令人沮丧。它在时间序列上咬了1个多小时。超参数搜索会增加计算量。因此，我经受住了诱惑，试图通过隔夜网格搜索将MAPE降低1%或2%。</p><h1 id="de30" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">8.样本外预测</h1><h2 id="ed3e" class="oz mt it bd mu pa pb dn my pc pd dp nc ln pe pf ne lr pg ph ng lv pi pj ni iz bi translated">8.1一步到位的模型和多个样本步骤</h2><p id="6714" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">假设我们想要预测测试集之后12个小时的每小时价格。要生成样本外预测，我们需要提供覆盖扩大预测范围的协变量。</p><p id="df07" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">日期时间协变量—小时、工作日、月和假日—已经扩展到1月1日。请记住，当我们创建它们时，在模型训练之前，我们在实际观察结束后增加了48小时。</p><p id="8564" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">但是我们还需要为特征协变量得出未来值。天气预报可以很容易地为我们提供未来12小时的温度和风速。对于电力需求和发电量，我们必须推导出单变量预测——要么使用SARIMA等经典模型；或者我们也可以对这些时间序列应用N拍(没有协变量)。</p><p id="f97a" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在本练习中，我们假设已经获得了特征协变量的预测值。我们简单地复制12月31日之前24小时内记录的值，并假设1月1日的天气、需求和发电将遵循与12月31日相同的每小时模式。</p><p id="560b" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">然后我们将这些扩展的协变量输入到第18行的predict()函数中。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="5677" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在我们提供了协变量之后，样本外预测的脚本几乎与测试阶段的脚本相同。我们得到一个结果数据帧dfY，它包含了测试集的预测，但是现在扩展了12行到1月1日10:00。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/9fe2ed37dd9c831b067b8edbc75af00f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*HXWoMJk-E_seN9nRSq7AJw.png"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="gh gi pl"><img src="../Images/ec64ff59c15713f3052adb0333c45e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-W1YYu3JgHQlsTBfXJxMYQ.png"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><h2 id="612b" class="oz mt it bd mu pa pb dn my pc pd dp nc ln pe pf ne lr pg ph ng lv pi pj ni iz bi translated">8.2样本外预测限于输出长度</h2><p id="00d4" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">模型设置采用一个可选参数<em class="oi"> output_chunk_length </em>，默认设置为1，我们在参数N_FC中保持不变。因此，我们训练了一个提前一步的预测模型。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><p id="a725" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">如果我们将output_chunk_length提高到12，样本外预测可能会覆盖12个小时，而不需要我们提供未来的协变量作为输入。</p><p id="3755" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">让我们通过预测测试集结束后一个小时的电价来尝试一下，而不是预测样本外的12个小时。因为我们已经在output_chunk_length为1的基础上训练了模型，所以我们可以预测下一个小时的<em class="oi">，而无需进行另一次训练练习。</em></p><p id="e33d" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们现在将协变量限制在可用的实际源数据:cov_t。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ok ol l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/384e70c079441636a46b696037e48e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*iMpdGT86sH0qYy37adcUow.png"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated">作者图片</p></figure><p id="4b45" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">正如预期的那样，我们收到了实际观测结束后第一个小时的预报。</p><p id="3cf0" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">自然，我们不能将output_chunk_length提高到任意的水平。更高的级别将乘以(取幂)张量的大小、内存使用量和处理时间。输出大小也不能超过input_chunk_length。因此，不提供未来协变量的样本外预测只适用于相对较短的时间窗，受输入图层大小的限制。</p><h1 id="6aee" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">9.结论</h1><p id="4838" class="pw-post-body-paragraph le lf it lg b lh nk kd lj lk nl kg lm ln nm lp lq lr nn lt lu lv no lx ly lz im bi translated">深度预测器可以处理受外生变量影响的时间序列，这些时间序列表现出多阶季节性，这种组合超出了大多数经典预测方法的能力。</p><p id="deb8" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N-BEATS实现了6.5%的MAPE(在任何调整工作之前)。它花费的训练时间是上周Transformer示例的两倍多。它选定了一个比变压器高2%点的MAPE。如果我没有看到更高的变压器精度，我仍然认为6.5%的MAPE是一个可接受的初始结果，我不会放弃。我认为这是一个中间结果，我们可能可以提高一两个等级。测试集的图显示了12月下旬的一些偏差，这是调整模型的起点。</p><p id="532e" class="pw-post-body-paragraph le lf it lg b lh li kd lj lk ll kg lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">N-BEATS Jupyter笔记本可以在GitHub上下载，与Transformer笔记本在同一个存储库中:<a class="ae ld" href="https://github.com/h3ik0th/ES_energy_Transformer" rel="noopener ugc nofollow" target="_blank">h3ik 0th/ES _ energy _ Transformer:Transformer deep forecast(github.com)</a></p><div class="ma mb gp gr mc md"><a href="https://medium.com/@h3ik0.th/membership" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">通过我的推荐链接加入媒体</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">medium.com</p></div></div><div class="mm l"><div class="pn l mo mp mq mm mr kx md"/></div></div></a></div><div class="ma mb gp gr mc md"><a href="https://medium.com/@h3ik0.th/temporal-fusion-transformer-unleashed-deep-forecasting-of-multivariate-time-series-in-python-674fa393821b" rel="noopener follow" target="_blank"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd jd gy z fp mi fr fs mj fu fw jc bi translated">释放时间融合变压器:Python中多元时间序列的深度预测</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">端到端示例:具有外生变量和复杂季节性的时间序列的概率预测</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">medium.com</p></div></div><div class="mm l"><div class="po l mo mp mq mm mr kx md"/></div></div></a></div></div></div>    
</body>
</html>