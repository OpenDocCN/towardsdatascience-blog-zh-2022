<html>
<head>
<title>In-Depth Understanding of NeuralProphet through a Complete Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过一个完整的例子深入理解NeuralProphet</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/in-depth-understanding-of-neuralprophet-through-a-complete-example-2474f675bc96#2022-01-06">https://towardsdatascience.com/in-depth-understanding-of-neuralprophet-through-a-complete-example-2474f675bc96#2022-01-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="173f" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">通过一个完整的例子深入理解NeuralProphet</h1></div><div class=""><h2 id="46ee" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用气象数据探索脸书算法</h2></div><p id="3114" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NeuralProphet是由脸书创造的Prophet算法的一种进化，是一种<strong class="kh ir">时间序列预测算法</strong>。在这篇文章中，我将基于我在研究过程中遇到的一个<strong class="kh ir">具体而完整的问题</strong>来详述这个算法。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/e7e881f7d58c433878c453943af1c619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m8bUT1Lnbp6TMaHR"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">照片由</em> <a class="ae ls" href="https://unsplash.com/@chrisliverani?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="lr">克里斯利维拉尼</em> </a> <em class="lr">上</em> <a class="ae ls" href="https://unsplash.com/s/photos/statistic?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <em class="lr">下</em> </a></p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="dd4f" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">语境</h1><p id="e7c9" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">大多数时间序列问题需要<strong class="kh ir">容易理解的</strong>预测。同时，需要一个有效的预测。这两个愿望导致了一个权衡:<strong class="kh ir">可解释性与性能</strong>。</p><p id="42b4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于更复杂的模型，效率的显著提高通常是<strong class="kh ir"/>。然而，复杂性很少等同于可解释性。</p><p id="ad2b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，<strong class="kh ir">存在两类</strong>模型:</p><ul class=""><li id="2cf5" class="mx my iq kh b ki kj kl km ko mz ks na kw nb la nc nd ne nf bi translated"><strong class="kh ir">统计</strong>算法(ARIMA，GARCH …)，这些算法在理论上是可以用数学方法解释的</li><li id="1cbd" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated"><strong class="kh ir">神经网络</strong>模型，这些模型非常复杂，但已经证明了它们的性能</li></ul><p id="47b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最初，脸书和Prophet的意愿是<strong class="kh ir">提供一个简单可行、可调整和可解释的工具来预测时间序列</strong>。然而，一个问题依然存在:<strong class="kh ir">性能不佳</strong>。为了解决这个问题，NeuralProphet应运而生。</p><p id="445a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，<strong class="kh ir"> NeuralProphet =神经网络+预言家</strong></p><p id="ddb7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，其目的是通过在Prophet(一种统计算法)中包含神经网络来结合前面两个类别。<strong class="kh ir">目的:提高效率，同时限制可解释性的损失。</strong></p><p id="3f74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个介绍部分可以通过下图<strong class="kh ir">大致</strong>描绘出来:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nl"><img src="../Images/d4c0eabcb26c7ddb7326495202d97bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sv1Cg3vOgXG1e0w-ql6UyA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">关于时间序列算法复杂性和性能的简化示例。为普及和解释目的而制作，并可能进行调整。(作者自制)</em></p></figure><h1 id="1b45" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">问题</h1><p id="146c" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">作为解释的基础，我将概述我在学习期间与12个人一起贡献了18个月的一个项目。这个问题是我感兴趣的枝节问题，不是项目的主要焦点。</p><p id="5bbc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">法国电网必须稳定地输送大量电能以满足各种需求。这种供需平衡至关重要，因为:</p><ul class=""><li id="cdda" class="mx my iq kh b ki kj kl km ko mz ks na kw nb la nc nd ne nf bi translated">如果产量<strong class="kh ir">低于</strong>需求水平，那么电网<strong class="kh ir">可能会出现不正常情况</strong>，例如电力故障或电压下降。</li><li id="7f14" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated">如果产量高于需求水平，那么未售出的能源就被浪费了，因为电能的储存是具有挑战性的(低效且繁重)</li></ul><p id="b7a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">幸运的是，这种平衡一直得到保持，这主要归功于<strong class="kh ir">发电厂</strong>有资格作为可调度的发电，因为<strong class="kh ir">的电力是按需微调的</strong>。风力涡轮机等所谓的“T4”间歇性能源就不是这样了，它依赖于一个随机因素:风。</p><p id="e9c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">目标是<strong class="kh ir">在风能生产更多的时候优化风能生产</strong>，反之，当风能生产下降的时候<strong class="kh ir">补偿其间歇性</strong>。</p><p id="5d27" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">专家们目前正在通过接收大量数据(<a class="ae ls" href="https://www.rte-france.com/en/uninterrupted-flow-current/balancing-supply-and-demand" rel="noopener ugc nofollow" target="_blank">每秒40 000比特</a>)并相应地采取行动来完成这项任务。超越自己的控制来运行它不是很吸引人吗？</p><p id="0230" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">智能电网旨在智能管理电力网络。在能源领域，人工智能显然是一个<strong class="kh ir">有前途的解决方案</strong>,这篇文章提供了在这种背景下使用神经营养体的选择。</p><p id="d338" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了监控风电场，我们选择了<strong class="kh ir">负载系数</strong>，它是发电量除以装机容量的比率(在给定的时间段内)。因此，监控这一负载系数大体上相当于调节有效风力涡轮机的数量，从而调节它们向电网提供的能量。</p><p id="a325" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在学校环境中，已经在互联网上挖掘了300多个业余气象站的温度和风速(用于其他目的)。<strong class="kh ir">假设负载系数的预测将受益于这些数据。</strong></p><p id="29ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如RTE所强调的，天气会显著影响功耗。考虑到温度<strong class="kh ir">是值得的</strong>，负载系数与功耗相关。此外，由于可用的风能主要取决于风速，这也可能是有益的。</p><h1 id="7d78" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">数据洞察</h1><p id="2888" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在2019年3月1日至2019年9月30日(约7个月)期间，对于300个气象站<strong class="kh ir">中的每一个气象站，以每小时的时间步长提取温度和风速。这两个特征将在后面作为<strong class="kh ir">观察变量</strong>提及。</strong></p><p id="ef3b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与此同时，通过从<strong class="kh ir"> RTE网站</strong>获取风力和装机容量，可以获得现有的负载系数。负载系数将被称为“<strong class="kh ir">目标</strong>”。</p><p id="d253" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">培训将在<strong class="kh ir">前6个月(训练组)</strong>进行，测试组是上个月的<strong class="kh ir">。数据已经标准化。</strong></p><p id="5203" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后，<strong class="kh ir">只保留了57个气象站</strong>，以保证模型的运行速度，并去除其中的等效站(附近的)。</p><p id="105d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下图可能总结了问题和可用的数据:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nr"><img src="../Images/23628c043d5668c33a8e76a3217f348c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAuHWE0rBOfXOrIu95NdWg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">50个气象站目标图(作者制作)</em></p></figure><p id="023d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://plotly.com/~ValouC/1/" rel="noopener ugc nofollow" target="_blank">目标的互动剧情在这里可以看到。</a></p><p id="1c91" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选择的评估指标是RMSE。我们的基线模型是一个简单的算法，它在测试集上的<strong class="kh ir"> RMSE为0.109 </strong>。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="3dc5" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">模型:神经原植物</h1><p id="f931" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">NeuralProphet模型预测未来若干时间步<strong class="kh ir"> <em class="ns"> h </em> </strong>。<strong class="kh ir"> <em class="ns"> h </em> </strong>称为“<strong class="kh ir">视界</strong>”。</p><blockquote class="nt nu nv"><p id="925a" class="kf kg ns kh b ki kj jr kk kl km ju kn nw kp kq kr nx kt ku kv ny kx ky kz la ij bi translated">“神经营养模型的一个核心概念是它的模块化可组合性”。</p></blockquote><p id="dbf6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">设定h的目标值后，根据以下关系预测到<strong class="kh ir"> h </strong>的每个时间步长:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nz"><img src="../Images/f898324d0a68046f4b28211fdf6a7ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZsoE3EcwYeJrRvxyiuHCuw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">神经营养模型(作者制作)</em></p></figure><p id="0343" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，例如，提前一步的预测相当于用h = 1写出过去的关系，即:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oa"><img src="../Images/01ed1e4175f538f65f45c5a6f8adee74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGIHfCiagfldSF2QMooxdA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">一个只有1个地平线的例子，即向未来迈进一步(作者制作)</em></p></figure><p id="ae66" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 6个特定模块</strong>放在一起构成了神经营养体。训练要求每个模块修改其正确的预测，以最小化整体损失。</p><p id="8ae6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">文章的其余部分基于上面提出的问题，集中在每个模块的解释和动机上。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="daf5" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">1.1趋势</h1><p id="95c2" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">概括地说，趋势与信号的<strong class="kh ir">总体变化有关(而不是信号内的小波动)。</strong></p><p id="b866" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NeuralProphet学会检测趋势发生明显变化的日期。这些点叫做<strong class="kh ir">变点</strong>。在这两者之间，趋势应该是线性的。</p><p id="6937" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该问题类似于线性多元回归，其中<strong class="kh ir">线性回归在2个变化点之间进行估计。</strong></p><p id="d781" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些点沿时间轴统一初始化<strong class="kh ir"/>。然后，每个线性回归的成本<strong class="kh ir">被添加到模型的总损失</strong>中。梯度下降使损失最小化，并随后改善回归。特别地，线性回归优化的参数是<strong class="kh ir">斜率</strong>，称为生长值。</p><p id="da05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，执行<strong class="kh ir"> L1调整</strong>以删除不必要的变化点。额外的变化点也可以手动添加。</p><p id="8044" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在测试阶段，趋势是最后一次线性回归的<strong class="kh ir">外推。</strong> 10%的数据(可参数化)留在最后，以确保一致的最终趋势。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ob"><img src="../Images/2cd18f8f784297b7a50eca24d2701429.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TXPQoeIo2ef0UzgO7zEuLQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">通过梯度下降法估计参数的趋势计算公式(作者制作)</em></p></figure><p id="d431" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">截距不是一个可训练的参数，而是取决于增长率以<strong class="kh ir">确保连续性</strong>。</p><p id="e029" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从视觉上看，这相当于:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oc"><img src="../Images/c7ccf379be9e7b889976eca2322796b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9-JUcMvu-Z9JcMFNr2o9UQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">每条红色竖线是一个变化点，每一步定义了算法的改进(作者做)</em></p></figure><p id="0e87" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关于我们的负载系数示例，我们有以下结果:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi od"><img src="../Images/e15563a5089099757ef9dc534ae9bf8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dxiL6l3hTiHYe32IlbruIA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">默认参数趋势结果— 11个变点(作者制作)</em></p></figure><p id="a78f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在解释了下一个模块:季节性之后，将绘制预测图。</p><h1 id="827e" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">1.2季节性</h1><p id="6b38" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">时间序列的季节性是由它的性质决定的信号的<strong class="kh ir">周期性运动</strong>。</p><p id="00a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，很明显<strong class="kh ir">的温度</strong>遵循<strong class="kh ir">的每日季节性</strong>，因为一种模式每天都在重复:晚上比白天冷。气温也遵循年度季节性:冬天比夏天冷，等等。</p><p id="ef24" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了对这种季节性进行建模，NeuralProphet假设目标是一个<strong class="kh ir">周期性的连续函数。因此，它可以表示为傅立叶级数。</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/54266486429c629ceb1abb26f4b9c907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OMeBmssbUmR0BP_47NuU2A.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">假设某些假设(作者做出的)写成傅立叶级数的p周期函数</em></p></figure><p id="5889" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">此公式的两个备注</strong>:</p><ul class=""><li id="5c61" class="mx my iq kh b ki kj kl km ko mz ks na kw nb la nc nd ne nf bi translated">总和前面的常数项(即<strong class="kh ir">偏移量</strong>)对于神经原素来说可能是<strong class="kh ir">不必要的</strong>，因为趋势隐含地考虑了它。</li><li id="7154" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated">无穷多个a项和b项的计算<strong class="kh ir">不可行</strong>。因此，<strong class="kh ir">仅估算前k项</strong>(带有k个参数)。</li></ul><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi of"><img src="../Images/9af87aa1d0f586163d1b5ec36bda2b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YWfh2RU4TzpytZKLskL2OA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">论文关系(作者自制)</em></p></figure><p id="2be8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型的目标是找到最适合目标的<strong class="kh ir"> 2*k参数。默认情况下，<strong class="kh ir">有3个周期被激活</strong>:p = 1的日周期、p = 7的周周期和p = 365，25的年周期。对于每个周期，我们分别有:k = 6，k = 3和k = 6。(<strong class="kh ir">如果目标覆盖至少2倍于</strong>周期，则激活一个周期)。</strong></p><p id="f5ec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与趋势相同，通过添加<strong class="kh ir">与建模的季节性和实际目标之间的差异相关的成本</strong>来计算参数。</p><p id="7108" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果指定了参数“乘法”,则季节性与趋势是可相乘的。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi og"><img src="../Images/22d1149e99514fda3c7315e3d541c278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4MlYb514D4SR6XQNqqMB5w.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">(作者制作)</em></p></figure><p id="76c8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于只有6个月的数据可用，年度期间未激活(强制激活的选项)。但是，<strong class="kh ir">其他时段可以根据数据类型手动添加</strong>(如果是每月，p = 30)。</p><p id="4df5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我们的问题，我们让两个默认季节性。事实上，我们假设<strong class="kh ir">日季节性</strong>存在(与昼夜节律相关的负荷因子的相关性？).还假设了<strong class="kh ir">周季节性</strong>(与工作相关的负荷系数相关性？).</p><p id="7277" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">取p = 1 &amp; 7，并考虑附加季节性(相对于乘法)，我们有:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/75ef50462b14d46b565f874dc5238611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKgdjbXqMh3xKU-vF8Ftaw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">在我们的例子中与p = 1和p = 7的关系(由作者提出)</em></p></figure><p id="2e16" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">拟合数据后，我们得到这些图。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oi"><img src="../Images/ad2dd07b326b5d79f94d6bde42c231eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HRyFMPp90oL8OPrgem6wKQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">负荷系数的周、日季节性(作者自制)</em></p></figure><p id="06dd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过结合趋势和季节性，执行以下预测。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oj"><img src="../Images/7e87416a3b1ec13882a1b1cc8b8a4798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lpLZVuzhXAd_W3i57dzpdw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">由NeuralProphet作出的仅激活趋势和季节性的预测(由作者作出)</em></p></figure><p id="2698" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">毫无疑问，预测<strong class="kh ir">表现不佳</strong>，RMSE为1.32。即使是天真的算法也能获得<strong class="kh ir">更好的结果</strong>(RMSE为0.109)。</p><p id="cdad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后，其他模块将包含在整体模型中，希望有更好的预测<strong class="kh ir">(剧透:是)</strong>。</p><h1 id="9351" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">1.3自动回归</h1><p id="0501" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated"><strong class="kh ir">自回归(AR)过程</strong>可能是最常用的时间序列过程，用于捕捉序列中随机变量随时间的相关性。</p><p id="be7f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将p(先前值的数量)包括在内，AR过程定义为:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ok"><img src="../Images/dafddd214a71e0d6632a758b68b64693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GehpAfSDEO6qrkGB5HrPUw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr"> AR过程与c截距的关系以及最后一项a白噪声过程(作者提出)</em></p></figure><p id="25c0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种白噪声是一种<strong class="kh ir">随机过程</strong>，必须符合三个标准，即:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ol"><img src="../Images/ef57677dbaf9b1ac03aac03fa9b82181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Bxy2h4oy8Fim6ASMReQDg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">白噪声过程必须验证这三个标准</em></p></figure><p id="07cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">白噪声的分布没有规定，但是例如，具有零均值和恒定标准偏差的独立同分布正态分布是可行的。这种白噪声是世界分解的<strong class="kh ir">核心概念，是时间序列理论的一个关键定理。</strong></p><p id="5aa8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，AR过程仅预测<strong class="kh ir"> 1次进入未来</strong>。给定目标的p个过去值，预测时间t。因此，如果我们有h &gt; 1，我们需要<strong class="kh ir"> h个不同的模型</strong>。有了NeuralProphet选择的AR-Net模型，这个问题就迎刃而解了。</p><p id="9bb9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用时间t作为预测原点(即预测的第一步)，<strong class="kh ir">前一个p值预测下一个h值</strong>。</p><p id="87d4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">预测起点</strong>是有意义的，因为对于给定的预测时间步长，存在不同的预测起点。</p><p id="3942" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，如果h = 3(即，我们希望预测未来的3个时间步长)，在t = 5000的预测将来自3个不同的起点:在t = 4998、4999和5000。该研究论文在一封新的信A中包含了这一概念:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi om"><img src="../Images/9ec1476064d1e81c3f81409c07348244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aF5JdamFDJ11QarHcZ9yLQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">预测原点示例(由作者制作)</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi on"><img src="../Images/f47fb253fa8c86ab402e787e3cc92f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FurxMdnas_oGSO3oaZai6Q.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr"> AR-Net关系(作者自制)</em></p></figure><p id="5255" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这一阶段，仍然存在几个问题。</p><p id="814f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">如何权衡p？</strong></p><p id="a361" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据研究论文:</p><blockquote class="nt nu nv"><p id="3530" class="kf kg ns kh b ki kj jr kk kl km ju kn nw kp kq kr nx kt ku kv ny kx ky kz la ij bi translated">应该根据过去观测中相关背景的大致长度来选择该参数。实际上，很难准确确定，通常设定为最内部周期的两倍或预测范围的两倍”。</p></blockquote><p id="36a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">AR-Net应该使用哪种神经网络架构？</strong></p><p id="a474" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，神经网络利用<strong class="kh ir">最简单的现有架构</strong> e:没有中间层，没有激活函数，只有p个输入连接到h个输出，例如:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oo"><img src="../Images/8d4036fba69f5ece0d2163697a94c1fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*djmS-Ekxi_aey66WRZkZdg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">具有p个输入和h个输出的最简单神经网络架构的图示(由作者制作)</em></p></figure><p id="2a33" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">提醒一下，NeuralProphet是简单的<strong class="kh ir"/>，以上面定义的方式，可以通过<strong class="kh ir">分析权重的值来解释这个架构。</strong></p><p id="35d4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为可解释性损失的回报，有可能<strong class="kh ir">添加隐藏层</strong>以使模型复杂化。隐藏层的数量，以及神经元的数量，是<strong class="kh ir">可参数化的</strong>。为了减少这种损失，AR-Net使用了L1正则化，这导致了权重的稀疏性。然而，我觉得深入探讨这一点并不有趣，因为除了使用的正则化函数的形式之外，它主要涉及深度学习的<strong class="kh ir">基础。<a class="ae ls" href="https://arxiv.org/abs/1911.12436" rel="noopener ugc nofollow" target="_blank">我让读者在这里查看原始的AR-Net研究论文。</a></strong></p><p id="b505" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是在不同中间层数目和p值的测试集上，h = 1的NeuralProphet的结果。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi op"><img src="../Images/b001ad029cf732c3cb355860ccc5d763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AtTAW9AHYHEmINCEUr7v2g.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">不同超参数的结果(默认隐藏层的维度为p + h)。结果可能会有所不同，仅供讨论之用(由作者制作)</em></p></figure><p id="2b94" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的问题中，隐藏层数<strong class="kh ir">似乎不影响RMSE </strong>。在训练时间较短的情况下,“密集”架构无法反映输入信号的复杂性。如果超参数以适当的方式和更多的训练时间进行调整，<strong class="kh ir">情况应该不是这样。</strong></p><p id="962a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用<strong class="kh ir"> p = 2天</strong> (2*24 = 48分)，并且隐藏层数= 0，我们有如下预测:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oq"><img src="../Images/eeeee474be6ece71138c9e915d5debea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MiXfMU-uS7GOLZmYjiPElQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">趋势、季节性和AR过程的结果(作者制作)</em></p></figure><p id="2a53" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">结果:</strong>测试集上的RMSE为0.0844，比0.109的原数据集好21%。</p><p id="4a36" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以通过绘制模型的组件来测量主要影响预测的滞后<strong class="kh ir">。</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oa"><img src="../Images/7a637c93fbc6b6c70cf21cff9f5c546b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0PEo6ew_jvNNGp-yDVbrlA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><em class="lr">不同滞后的AR相关性</em></p></figure><p id="a26f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">滞后1 &amp; 2负责约60%的预测</strong>。奇怪的是，在预报起点前24小时的<strong class="kh ir">负荷系数的值似乎是一个影响因素。</strong></p><p id="c37a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们继续详细介绍剩余的模块。</p><h1 id="530f" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">1.4滞后回归变量</h1><p id="ef55" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在这个阶段，<strong class="kh ir">介绍了神经营养体的主要概念:趋势、季节性和AR-Net。</strong></p><p id="21b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">滞后回归变量就是我们之前定义的“观察变量”:温度和风速。在我们的整体模型<strong class="kh ir">中包含这样的信息可能也是相关的，希望得到更好的结果。</strong></p><p id="698a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">观察变量通过…一个<strong class="kh ir"> AR-Net被附加到NeuralProphet模型中！！</strong></p><p id="13da" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了输入是观察变量的<strong class="kh ir"> p个先前值(而不是目标的p个先前值)。</strong></p><p id="aa48" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">提醒一下，观察到的变量是温度和风速。具体来说，我们有多达114个变量(57个站点x每个站点2个变量)。因此，神经营养细胞产生了114个不同的阵列。</p><p id="d1e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，历元数自动设置为125，批处理大小设置为32。之前用“lr范围测试”来估计学习率。</p><p id="3ccb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">理论上，<strong class="kh ir">如果RMSE低于0.0844 </strong>(没有滞后回归的值)，我们观察到的变量<strong class="kh ir">会积极影响</strong>预测。</p><p id="3b7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不幸的是，在用不同的配置(滞后回归量的数量、调整超参数……)进行多次尝试后，RMSE仍然在0.0844以上，最低为0.095</p><p id="0d2c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">结论:</strong>这些观察到的变量(风速和温度)<strong class="kh ir">似乎</strong>没有隐含的相关信息来帮助负荷系数的预测。几个原因可能是:</p><ul class=""><li id="1808" class="mx my iq kh b ki kj kl km ko mz ks na kw nb la nc nd ne nf bi translated">一个更现实的解决方案<strong class="kh ir">是着眼于地区或部门层面，而不是预测整个国家的单一负载系数值</strong></li><li id="2047" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated">底层模型<strong class="kh ir">不够复杂</strong>无法捕捉观察变量和目标之间的关系</li><li id="cd63" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated">每个滞后回归变量都与一个唯一的AR-Net相关联。<strong class="kh ir">参数不共享</strong>。因此，没有充分考虑观察变量之间的相关性。</li><li id="1836" class="mx my iq kh b ki ng kl nh ko ni ks nj kw nk la nc nd ne nf bi translated"><strong class="kh ir">以此类推……</strong></li></ul><h1 id="24bd" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">1.5未来回归变量</h1><p id="e46d" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated"><strong class="kh ir">未来变量</strong>是未来已知的变量。在每个时间步t，<strong class="kh ir">这些变量的值是已知的。</strong></p><p id="1d47" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，未来可能有用的回归变量是法国风力发电厂的<strong class="kh ir">装机容量。实际上，负载系数取决于该安装容量，并且该变量是可以通过跟踪例如<strong class="kh ir">正在进行的建筑工地</strong>而预先知道的数据。</strong></p><p id="b27d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从技术上来说，如果我们想要预测t = 5000时的目标，则t时的未来回归量的值由可训练系数“d”加权。</p><p id="6f1b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后和季节性一样，模F(t)可以是<strong class="kh ir">“乘法”</strong>。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi or"><img src="../Images/09ed57ef01e61f0783364e4823e74518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jP_bk0FfY7N3rK1bByKQ5g.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">(作者自制)</p></figure><p id="b2f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，<strong class="kh ir">我手头没有未来的回归变量</strong>，因此它的影响在我们的问题中无法衡量。</p><h1 id="aacd" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">1.6活动和假期</h1><p id="5ff4" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">这最后一个模块处理可能影响目标的<strong class="kh ir">偶然事件。如果事件发生，则事件是在时间t等于1的二进制时间序列。(否则为0)。除此之外，它遵循与前一模块F(t) </strong>相同的<strong class="kh ir">流程。</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi os"><img src="../Images/0ade572123bb60131e6f1cc2881d2f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CTfPeEXlOYR-LCx-7yaQ8Q.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">(作者自制)</p></figure><p id="9276" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NeuralProphet提供了一个内置命令<strong class="kh ir">自动添加国家的节假日。</strong></p><p id="9306" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于每个事件，可以添加一个上下窗口<strong class="kh ir">，也就是说，例如，如果我们将圣诞节视为下窗口为-2，上窗口为+ 1的事件，则除了12月23日、24日、25日和26日之外，该事件每次都等于0，值为1(圣诞节前为-2，圣诞节后为+1)。</strong></p><p id="1f5c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，如前所述，可训练系数<strong class="kh ir">允许量化最终预测中每个事件的重要性。</strong></p><p id="0da1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最近，在2021年12月，法国可能会发生电力短缺的风险，这种事件在预测负载系数时可能是有用的。</p><p id="8e9a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看看法国假期对目标预测的影响。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ot"><img src="../Images/1d9f14575243b137c0ee7c6fc4d0f4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OsGnGDAfw7V_HNZ7e1EdmA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">AR砝码(作者自制)</p></figure><p id="7ab6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于每个事件，我们都有它的参数值。NeuralProphet在一行代码中毫不费力地提供了这些视觉效果<strong class="kh ir">。因此，结果是<strong class="kh ir">方便解释</strong>。</strong></p><p id="267f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，在我们的例子中，与没有这个事件相比，使用相同的RMSE，多次尝试仍然<strong class="kh ir">不成功</strong>。</p><h1 id="f8a0" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">结论</h1><p id="19e9" class="pw-post-body-paragraph kf kg iq kh b ki ms jr kk kl mt ju kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">模块化的可组合性已经被证明与可解释性的目的非常相关。的确，用NeuralProphet向非科学观众解释这个结果变得非常简单明了。</p><p id="1d6e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是<strong class="kh ir">获得更多业务洞察</strong>以潜在地添加相关滞后回归量、未来回归量、事件或调整AR-Net的超参数(p、隐藏层等)。</p><p id="dd5d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NeuralProphet有一个活跃的社区，即将推出令人兴奋的扩展。</p><p id="93d4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢这篇文章的技术方面和提出的问题。</p><p id="11c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">如果你喜欢它，不要犹豫，请鼓掌并关注我的未来文章:)</strong></p><h1 id="7d49" class="ma mb iq bd mc md nm mf mg mh nn mj mk jw no jx mm jz np ka mo kc nq kd mq mr bi translated">来源</h1><ul class=""><li id="8a22" class="mx my iq kh b ki ms kl mt ko ou ks ov kw ow la nc nd ne nf bi translated"><a class="ae ls" href="https://arxiv.org/abs/1911.12436" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1911.12436</a></li></ul></div></div>    
</body>
</html>