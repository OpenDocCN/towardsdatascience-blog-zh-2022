<html>
<head>
<title>Molecular Visualization in Streamlit Using RDKit and Py3DMol (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RDKit和Py3DMol在Streamlit中进行分子可视化(第2部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/molecular-visualization-in-streamlit-using-rdkit-and-py3dmol-part-2-657d28152753#2022-01-10">https://towardsdatascience.com/molecular-visualization-in-streamlit-using-rdkit-and-py3dmol-part-2-657d28152753#2022-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="a661" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">使用RDKit和Py3DMol在Streamlit中进行分子可视化(第2部分)</h1></div><div class=""><h2 id="a7cd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Py3DMol和stmol组分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/da976866fced9b1b87ca2423524136bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Bm0lDQ0mEwvBxNOFIXY-A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">艺术品。图片由作者提供。</p></figure><blockquote class="ky kz la"><p id="2b6d" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">第一部分请点击此链接:<a class="ae ly" rel="noopener" target="_blank" href="/molecular-visualization-in-streamlit-using-rdkit-and-py3dmol-4e8e63488eb8">https://towards data science . com/molecular-visualization-in-streamlit-using-rd kit-and-py 3d mol-4e8e 63488 EB 8</a></p></blockquote><h1 id="5580" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">1.介绍</h1><p id="5812" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi mz translated"><span class="l na nb nc bm nd ne nf ng nh di"> W </span>当我问<a class="ni nj ep" href="https://medium.com/u/39dfc90d7a34?source=post_page-----657d28152753--------------------------------" rel="noopener" target="_blank"> Adrien Treuille </a> <a class="ae ly" href="https://jnapoles.medium.com/is-it-possible-to-use-streamlit-to-visualize-molecules-b4e29700f61c" rel="noopener">如何在Streamlit </a>上部署3D结构时，<a class="ni nj ep" href="https://medium.com/u/a3d0cc1d5338?source=post_page-----657d28152753--------------------------------" rel="noopener" target="_blank"> TC Ricks </a>很快联系了我，他建议我开发一个<a class="ae ly" href="https://streamlit.io/components" rel="noopener ugc nofollow" target="_blank"> Streamlit组件</a>，当时组件还没有向公众发布。我致力于此，最终开发出了<a class="ae ly" href="https://github.com/napoles-uach/streamlit_3dmol" rel="noopener ugc nofollow" target="_blank"><strong class="le iu">stmol</strong></a><em class="ld"/>组件。这对我来说很紧张，但我确实学到了很多。</p><p id="42cf" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">在这篇文章中，我想和你分享三个简单的例子，如何使用<em class="ld"> stmol </em>、<em class="ld"> py3Dmol、</em>和<em class="ld"> RDKit </em>轻松制作分子查看器。我真的希望这能对其他人做化学相关领域的优秀web应用有所帮助。</p><p id="4acd" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">你可以在这里找到这篇博文<a class="ae ly" href="https://github.com/napoles-uach/Medium_Mol" rel="noopener ugc nofollow" target="_blank">的回购。</a></p><h1 id="5fba" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">2.安装必备库。</h1><p id="70f7" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi translated">由于我们将使用<em class="ld"> py3Dmol </em>和<em class="ld"> stmol </em>(版本0.0.7)，我们必须从安装这些库开始:</p><pre class="kj kk kl km gt nk nl nm nn aw no bi"><span id="53fe" class="np ma it nl b gy nq nr l ns nt">pip install py3Dmol<br/>pip install stmol==0.0.7</span></pre><p id="e2ac" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">(我们也需要RDKit，所以去看看<a class="ae ly" rel="noopener" target="_blank" href="/molecular-visualization-in-streamlit-using-rdkit-and-py3dmol-4e8e63488eb8">之前的相关帖子</a>！)</p><p id="7e68" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">现在我们准备开始举例了！</p><h1 id="c27e" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated"><strong class="ak"> 3。第一个例子:展示蛋白质！</strong></h1><p id="5c88" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi translated">下面的代码应该是简单的，同时也是简洁的。生成的web应用程序允许选择一些用于呈现3D蛋白质结构的蛋白质标识符:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b9f1" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">现在，让我解释一下代码，</p><ul class=""><li id="ef34" class="nw nx it le b lf lg li lj mt ny mv nz mx oa lx ob oc od oe bi translated">第1–3行。调用图书馆。除了<em class="ld"> streamlit </em>之外，显然我们还要调用<em class="ld"> Py3Dmol </em>，但是我们也会从<em class="ld"> stmol </em>中调用一个名为<code class="fe of og oh nl b">showmol</code>的函数。如果你熟悉<em class="ld"> py3Dmol </em>，函数<code class="fe of og oh nl b">showmol</code>是渲染3D模型的<code class="fe of og oh nl b">show</code>方法的替代。</li><li id="23ca" class="nw nx it le b lf oi li oj mt ok mv ol mx om lx ob oc od oe bi translated">四号线。我们在侧边栏中添加一个标题。</li><li id="7670" class="nw nx it le b lf oi li oj mt ok mv ol mx om lx ob oc od oe bi translated">第[5，6]行。我们使用标准化的标签来识别py3Dmol稍后可以查询的一些蛋白质。</li><li id="a7d3" class="nw nx it le b lf oi li oj mt ok mv ol mx om lx ob oc od oe bi translated">第7–10行。这里，我们在侧边栏中有三个小部件，一个用于设置背景颜色，另外两个选择框用于选择第4行给出的蛋白质标签，另一个用于选择分子渲染的样式。对于分子来说，更常见的是<code class="fe of og oh nl b">stick</code>和<code class="fe of og oh nl b">sphere</code>，而对于蛋白质来说，首选的是<code class="fe of og oh nl b">cartoon</code>。第10行定义了一个复选框，如果我们想让分子旋转(感谢<a class="ni nj ep" href="https://medium.com/u/bf79cad6afa1?source=post_page-----657d28152753--------------------------------" rel="noopener" target="_blank"> Avra </a>！).</li><li id="090a" class="nw nx it le b lf oi li oj mt ok mv ol mx om lx ob oc od oe bi translated">第11-18行。在这几行中，我们制作了<em class="ld"> py3Dmol </em>对象<code class="fe of og oh nl b">xyzview</code>。在第11行，我们对第8行选择的蛋白质进行查询，在第13行，我们设置第7行选择的背景颜色。从第14行到第17行，自旋被激活，这取决于复选框中的值。第18行放大到整个分子。</li><li id="4034" class="nw nx it le b lf oi li oj mt ok mv ol mx om lx ob oc od oe bi translated">第19行。最后，在第19行，我们调用<code class="fe of og oh nl b">showmol</code>来呈现最终的分子视图。这是这段代码中更重要的一步，因为没有这一步就不可能查看对象。我不得不说<code class="fe of og oh nl b">showmol</code>接受py3Dmol对象作为参数，并且可选地接受窗口的宽度和高度，默认情况下窗口有<code class="fe of og oh nl b">width=500</code>和<code class="fe of og oh nl b">height=500</code>。</li></ul><p id="b548" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">下面的gif展示了应用程序的运行情况:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/fd4585f6ad4df18e188780f49f861a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VywQtindSnOoSIuO50uTxg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">运行中的app2的屏幕截图。作者Gif。</p></figure><blockquote class="ky kz la"><p id="0634" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">链接:<a class="ae ly" href="https://share.streamlit.io/napoles-uach/medium_mol/main/app2.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/napoles-uach/medium _ mol/main/app 2 . py</a></p></blockquote><h1 id="c049" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated"><strong class="ak"> 4。第二个例子:上传本地文件。</strong></h1><p id="ca4f" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi translated">如果你有自己的某种已知格式的分子文件，比如'<em class="ld"> xyz </em>'并且你想在你的应用程序中渲染这些分子，那该怎么办？这里，我们可以利用<code class="fe of og oh nl b">file_uploader</code>小部件上传一些本地文件。因此，我们可以对前面的代码稍加修改来实现这一点。也许在这里建立一个函数是很方便的，它可以让分子在任何我们需要的时候使用它。因此，在下面的代码中，我们定义了执行此类任务的函数<code class="fe of og oh nl b">render_mol</code>(第5–12行)。我们将通过在第14行设置<code class="fe of og oh nl b">accept_multiple_files=True</code>让<code class="fe of og oh nl b">file_uploader</code>接受多个文件。最后，我们将迭代所有这些，并每次都应用<code class="fe of og oh nl b">render_mol</code>(第15–17行):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="5bb3" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">就是这样。同样，在不到20行代码的情况下，我们在Streamlit中有一个非常不错的分子查看器，正如您在下面的gif中看到的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/ac7b8a5f27a961286a9408c735dd7492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mr3H9zf2YQLEw_QWNqehxw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">app3运行中的屏幕截图。作者Gif。</p></figure><blockquote class="ky kz la"><p id="e52a" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">链接:<a class="ae ly" href="https://share.streamlit.io/napoles-uach/medium_mol/main/app3.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/napoles-uach/medium _ mol/main/app 3 . py</a></p></blockquote><p id="0c33" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">在这种情况下，分子是来自“纳米管位置”的一些美丽的富勒烯。如果你有兴趣探索一些其他的，这里有链接:</p><div class="oo op gp gr oq or"><a href="https://nanotube.msu.edu/fullerene/fullerene-isomers.html" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">碳富勒烯</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">看看世界上谁喜欢富勒烯:富勒烯的几何结构是基于富勒烯库中的结构…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">nanotube.msu.edu</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ks or"/></div></div></a></div><p id="70e2" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">我邀请你下载一些富勒烯文件，然后尝试用这个应用程序将它们可视化。</p><h1 id="2537" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated"><strong class="ak"> 5。第三个例子:RDKit + Py3Dmol。</strong></h1><p id="1b6e" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi translated">在最后一个例子中，我将结合我们所学的知识制作一个应用程序，将微笑字符串转换为3D分子结构。请看一下代码，我相信您会认出一些部分:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="9b4e" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">注意，函数<code class="fe of og oh nl b">makeblock</code>返回一个mol对象，该对象包含从SMILES字符串生成的3D结构。第14行是我们用<code class="fe of og oh nl b">MoltoMolBlock</code>方法从2D表示转换到3D的地方。还要注意的是，<code class="fe of og oh nl b">render_mol</code>函数与之前使用的是一样的，唯一不同的是在第19行，我改变了给予<code class="fe of og oh nl b">addModel</code>方法的格式。这次我需要的是<em class="ld"> mol </em>格式(其他还有<em class="ld"> pdb </em>、<em class="ld"> sdf </em>、<em class="ld"> xyz </em>等。).因此，您可以根据所使用的格式进行更改。你可以看到下面的应用程序工作:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/1b7dc60b9a0de06122337e4ea396a27c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3JXiEUfO1iAfNh7gw7h3aQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">app4运行中的屏幕截图。作者Gif。</p></figure><blockquote class="ky kz la"><p id="ffd1" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">链接:<a class="ae ly" href="https://share.streamlit.io/napoles-uach/medium_mol/main/app4.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/napoles-uach/medium _ mol/main/app 4 . py</a></p></blockquote><p id="86a6" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">如果您想深入了解将RDKit对象转换成3D结构的更多细节，您可以遵循RDKit <a class="ae ly" href="https://www.rdkit.org/docs/GettingStartedInPython.html" rel="noopener ugc nofollow" target="_blank">文档</a>，因为我在这里做的是最简单的例子。</p><h1 id="6378" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated"><strong class="ak"> 6。结论</strong></h1><p id="19a5" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi translated"><strong class="le iu"> Py3Dmol </strong>允许在streamlit网络应用程序中漂亮地渲染3D分子模型。为此，来自<strong class="le iu"> stmol </strong>组件的<em class="ld"> showmol </em>函数很有帮助。当然，可能有一些解决方法可以达到同样的效果，但是我相信直接调用库并在py3Dmol代码中使用<em class="ld"> showmol </em>会更容易。如果这个组件对你有用，请告诉我！</p><h1 id="e026" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">7.感谢</h1><p id="4689" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi translated">我想再次感谢<a class="ni nj ep" href="https://medium.com/u/f94b47c3cfca?source=post_page-----657d28152753--------------------------------" rel="noopener" target="_blank"> Chanin Nantasenamat </a>和<a class="ni nj ep" href="https://medium.com/u/bf79cad6afa1?source=post_page-----657d28152753--------------------------------" rel="noopener" target="_blank"> Avra </a>对这篇文章的善意评论。他们是生物化学专家和流线型忍者，我非常自豪能与他们合作。谢谢各位！</p><h1 id="3364" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">帮助我通过使用下面的链接成为媒体成员来继续创建这样的内容。只需5美元/月，你就可以在媒体上看到所有的故事，还可以用2.27美元支持我，谢谢！</h1><h1 id="74b1" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated"><a class="ae ly" href="https://medium.com/@jnapoles/membership" rel="noopener">https://medium.com/@jnapoles/membership</a></h1></div><div class="ab cl pg ph hx pi" role="separator"><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl"/></div><div class="im in io ip iq"><h2 id="a158" class="np ma it bd mb pn po dn mf pp pq dp mj mt pr ps ml mv pt pu mn mx pv pw mp px bi translated">链接:</h2><p id="b36e" class="pw-post-body-paragraph lb lc it le b lf mr ju lh li ms jx lk mt mu ln lo mv mw lr ls mx my lv lw lx im bi translated"><a class="ae ly" href="https://github.com/napoles-uach/Medium_Mol" rel="noopener ugc nofollow" target="_blank">https://github.com/napoles-uach/Medium_Mol</a></p><p id="2e3f" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated"><a class="ae ly" href="https://share.streamlit.io/napoles-uach/medium_mol/main/app2.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/napoles-uach/medium _ mol/main/app 2 . py</a></p><p id="02d9" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated"><a class="ae ly" href="https://share.streamlit.io/napoles-uach/medium_mol/main/app2.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/napoles-uach/medium _ mol/main/app 3 . py</a></p><p id="f56d" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated"><a class="ae ly" href="https://share.streamlit.io/napoles-uach/medium_mol/main/app2.py" rel="noopener ugc nofollow" target="_blank">https://share . streamlit . io/napoles-uach/medium _ mol/main/app 4 . py</a></p><p id="fb4b" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated"><a class="ae ly" href="https://github.com/napoles-uach/streamlit_3dmol" rel="noopener ugc nofollow" target="_blank">https://github.com/napoles-uach/streamlit_3dmol</a></p><p id="3002" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated"><a class="ae ly" href="https://pypi.org/project/py3Dmol/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/py3Dmol/</a></p><p id="28cb" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated"><a class="ae ly" href="https://www.rdkit.org/docs/GettingStartedInPython.html" rel="noopener ugc nofollow" target="_blank">https://www.rdkit.org/docs/GettingStartedInPython.html</a></p><p id="c984" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated"><a class="ae ly" href="https://nanotube.msu.edu/fullerene/fullerene-isomers.html" rel="noopener ugc nofollow" target="_blank">https://nanotube.msu.edu/fullerene/fullerene-isomers.html</a></p><p id="d2a0" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk mt lm ln lo mv lq lr ls mx lu lv lw lx im bi translated">https://streamlit.io/components<a class="ae ly" href="https://streamlit.io/components" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>