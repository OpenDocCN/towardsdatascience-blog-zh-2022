# 深度学习 vs 线性回归

> 原文：<https://towardsdatascience.com/deep-learning-vs-linear-regression-ea74aca115ea>

![](img/a17ececd479a7296fcadfbf791d9477c.png)

[通产省](https://unsplash.com/@mitifotos?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/line?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

## 机器学习问题中关于 MLP 和线性回归的理论差异和实例。

让我们从一个简单的考虑开始:**我们都喜欢神经网络**。

我们喜欢它们，因为它们是**直观的**，大多数时候**它们不需要领域知识**，它们**易于编码**并且非常**简单易懂。即使现在它们如此时髦和常用，它们也有相当长的历史了。**

如今，由于硬件的改进，神经网络比以前快得多，也更容易开发。但是我们真的需要它们吗？

在这本笔记本中，我们将使用一种**深度学习**算法(多层感知器)，并将它与最简单、最直接的机器学习方法进行比较，即**线性回归**。在这篇文章的最后，我们将会更清楚什么时候我们真的需要深度学习，什么时候我们可以只使用一个非常简单的算法并侥幸成功。

让我们从有趣的部分开始:

# 0.图书馆

在我们的例子中，我们将使用 Python 和一些非常著名的库(numpy，pandas，sklearn，…)。在开始复制粘贴代码之前，请**将**全部导入。

> 对于可视化部分，我使用了 **plotly** ，因为它允许对我们正在做的事情进行 3d 可视化，并且是交互式的。对于机器学习部分来说，它真的不是必需的，所以你可以安全地避免安装它，跳过结果的可视化

# 1.第一个例子

在第一个例子中，我编造了一些**二次**相关数据。我为什么这么做？说明**线性回归**也可用于模拟**多项式函数！但是我们会到达那里的。**

让我们构建这个数据集:

因为可以看到目标是以下函数:

```
t = c_0 +c_1*x+c_2*y+c_3*x*y
```

我知道你在想什么:这个模型不完全是线性的。但是再想想:x 和 y 基本上是同一个变量，所以可以认为是这样的东西:

```
t = c_0 +(c_1+c_2)*x+c_3*x*x
```

所以我们还是好的。:)

让我们绘制表面:

## 1.1 线性回归

现在让我们定义我们的预测函数:

我们编造了我们的数据，所以我们确切地知道参数，我们可以测试预测功能是否有效:

我们可以看到，它的工作非常完美！我们继续吧。
线性回归任务中使用的**损失** **函数**为均方误差，其表达式如下:

这是我们的损失函数**梯度**，我们希望将其设置为 0:

对于我们的“完美”解决方案，损失函数和梯度正确地为 0:

**线性回归**任务的最优解如下:

实现如下:

这个方法非常有效！我说的完美是指**我们唯一的不确定性是计算机在计算矩阵的逆矩阵和矩阵乘法时可能产生的数值误差**，如果与机器学习算法的误差相比，这个误差低得离谱。

> **注意**:我们使用了整个数据集，但在这种情况下我们真的需要 4 个数据点，我们会得到同样精确的结果。

## 1.2 深度学习

在深度学习算法中，我们正在做一些不同的事情。我们有数据，我们有多个处理输入数据的隐藏层，以及一个提供预测的输出节点。我们定义了一个介于 0 和 1 之间的得分函数，我们希望将它最大化。在我们的例子中，我们使用 **R2** :

让我们将此方法应用于我们正在考虑的数据集:

1.  **让我们进行列车试运行:**

2.**我们来看看比分:**

3.**我们来策划一下吧**:

得分 99.2%。这当然真的很好，但是与我们在之前的方法中看到的确切结果相比太糟糕了！

## 1.3 考虑因素

如果你有一个线性或多项式问题，使用线性回归模型很容易解决。你不仅不需要神经网络，而且如果你使用神经网络而不是线性回归，你实际上会有更低的性能。

# 2.第二个例子

让我们通过添加一个具有随机幅度的正弦函数来复杂化我们之前的情况:

现在我们有:

```
t = c_0 +c_1*x+c_2*y+c_3*x*y + Rsin(x)
```

其中 R 是-5 和 5 之间的随机振幅。

## **2.1 线性回归:**

如果你使用线性回归模型，你会得到和以前一样的结果。这意味着线性模型尽了最大努力，但损失仍然很可怕:(

## 2.2 深度学习:

如果你使用深度学习，结果真的很低:

同样，R2=99.20%，与前一种方法的巨大损失相比，这是很大的损失。

## 2.3 考虑因素

在这种情况下，模型不是多项式，而是受到随机正弦函数的干扰，我们得到的结果是**线性模型**工作很糟糕，而**深度学习**模型工作得很好。

# 3.计算时间

在处理高维数据时，你真的想使用机器学习，甚至是回归问题。事实上，对一台计算机来说，对一个庞大的矩阵求逆是一件大事。

让我们对一个不同维数的随机矩阵求逆:

让我们画出你做这个反转需要的时间:

在深度学习环境中，你可以尝试使用一些卷积网络，找到一个数值解，这可能与解析解略有距离，但需要的时间更少。

# 4.结论

结论永远是这样:**先看看你的数据。**
如果你能注意到有一些“线性”或“多项式”的行为，不用担心深度学习。只需使用一些**线性回归模型**，你就会以非常低的(如果不是空的)误差完成你的工作。

如果行为很奇怪，很难被认为是线性或多项式的，如果你有足够的数据，使用深度学习可能是有意义的。

如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:

A.在 [**Linkedin**](https://www.linkedin.com/in/pieropaialunga/) 上关注我，我在那里发布我所有的故事
B .订阅我的 [**简讯**](https://piero-paialunga.medium.com/subscribe) 。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。
C .成为 [**推荐会员**](https://piero-paialunga.medium.com/membership) ，这样你就不会有任何“本月最大数量的故事”，你可以阅读我(以及成千上万其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。