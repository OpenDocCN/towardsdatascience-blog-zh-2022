<html>
<head>
<title>How to read images, video, webcam and screen in OpenCV — image analysis for beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在OpenCV中读取图像、视频、网络摄像头和屏幕——初学者图像分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-analysis-for-beginners-how-to-read-images-video-webcam-and-screen-3778e26760e2#2022-01-14">https://towardsdatascience.com/image-analysis-for-beginners-how-to-read-images-video-webcam-and-screen-3778e26760e2#2022-01-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="7ce2" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">如何在OpenCV中读取图像、视频、网络摄像头和屏幕——初学者图像分析</h1></div><div class=""><h2 id="ec0c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何读取OpenCV要处理的图像的分步指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3961fb933683c409b9797d066b1266b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-U4v-4oHsmjAEhwy"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">计算机视觉！(图片由<a class="ae ky" href="https://unsplash.com/@wolfgang_hasselmann" rel="noopener ugc nofollow" target="_blank"> Wolfgang Hasselmann </a>在<a class="ae ky" href="https://unsplash.com/photos/JAmijzPKF20" rel="noopener ugc nofollow" target="_blank"> unsplash </a>上拍摄)</p></figure><p id="9d32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">OpenCV是从图像中获取信息的一个很好的工具。在这个系列中，我们将学习如何处理和分析图像，以便我们可以检测运动、模式、模板甚至阅读文本。然而，在这之前，我们需要图像来分析，这也是本文的主题。</p><p id="63e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将为OpenCV检查4种获取图像的方法，并一步一步地研究它们。最终，您将能够:</p><ul class=""><li id="8f7a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">加载图像</li><li id="8b9c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">加载视频文件</li><li id="1df4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">阅读您的网络摄像头</li><li id="47ad" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">阅读你的屏幕</li><li id="8712" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">调整颜色</li></ul><p id="8544" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在本系列的下一部分中使用这些知识来创建一些漂亮的分析。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="ebc2" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">系列</h2><p id="bc56" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">本文是关于OpenCV图像处理系列的一部分。查看其他文章:</p><ul class=""><li id="0b12" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><em class="no">阅读图像、视频、您的屏幕和网络摄像头(📍你在这里！)</em></li><li id="7f23" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/image-analysis-for-beginners-detect-and-blur-faces-with-a-simple-function-60ba60753487" rel="noopener"> <em class="no">检测和模糊人脸</em> </a></li><li id="b39a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/image-analysis-for-beginners-destroying-duck-hunt-with-opencv-e19a27fd8b6" rel="noopener"> <em class="no">用模板匹配破坏猎鸭:在图像中寻找图像</em> </a></li><li id="c404" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/image-analysis-for-beginners-creating-a-motion-detector-with-opencv-4ca6faba4b42" rel="noopener"> <em class="no">创建运动检测器</em> </a></li><li id="aa83" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><em class="no">检测没有AI的形状(在建；即将推出)</em></li><li id="511a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><em class="no">从图像中检测和读取文本</em>(正在建设中；即将推出)</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3c75" class="np mr it bd ms nq nr ns mv nt nu nv my jz nw ka nb kc nx kd ne kf ny kg nh nz bi translated">设置</h1><p id="f20a" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在这一部分中，我们将安装我们的依赖项，并启动和运行OpenCV。目标是有一个我们可以使用的图像。我们只需要安装两个依赖项:OpenCV和PIL (Python图像库)。将它们安装在:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="6fc2" class="mq mr it ob b gy of og l oh oi">pip install opencv-python pillow</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ed5f15d9f55d70f02358dbf995a1e508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M03_bDHG0HxKJr8d"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阅读时间(图片由<a class="ae ky" href="https://unsplash.com/@sigmund" rel="noopener ugc nofollow" target="_blank">西格蒙德</a>在<a class="ae ky" href="https://unsplash.com/photos/t-da_md1qMc" rel="noopener ugc nofollow" target="_blank"> unsplash </a>拍摄)</p></figure><h1 id="af3b" class="np mr it bd ms nq oj ns mv nt ok nv my jz ol ka nb kc om kd ne kf on kg nh nz bi translated">读取图像</h1><p id="97f2" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">我们将从简单地从文件中读取图像开始。接下来我们开始“拍摄”我们的屏幕。我们可以用它来分析我们在屏幕上看到的图像(我们稍后会谈到这一点)。最后，我们将开始从网络摄像头和视频文件中读取图像。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="50c9" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">1.加载文件</h2><p id="ce53" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">首先，我们在第1行导入OpenCV(cv2是OpenCV在Python实现中的模块名)。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="7f15" class="mq mr it ob b gy of og l oh oi">import cv2</span><span id="68b7" class="mq mr it ob b gy oo og l oh oi">img = cv2.imread(filename="c:/path/to/image.png")<br/>cv2.imshow('image', img)<br/>cv2.waitKey(0)<br/>cv2.destroyAllWindows()</span></pre><p id="eb07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第3行中，我们加载了一个图像，在下一行中，我们告诉cv2向我们显示它。第5行告诉cv2等待按钮按下(任何按钮)。如果没有这一行，图像将在cv2显示后立即关闭。最后一行用于清理所有打开的窗口。这是结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/0fdb1ba9244d583fa2e49fcb6b6026f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQQt1yPLo7G6BDBZLVCcXA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这幅美丽的风景图片的BGR版本(图片由<a class="ae ky" href="https://unsplash.com/@the_bracketeer" rel="noopener ugc nofollow" target="_blank"> Hendrik Conrlissen </a>在<a class="ae ky" href="https://unsplash.com/photos/-qrcOR33ErA" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄)</p></figure><p id="4dde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">颜色有点不对，不是吗？那条河和天空不应该是美好的蓝色吗？原因是OpenCV使用BGR而不是RGB(这在当时的相机制造商和软件中很流行)。这将我们带到我们的第一个图像操作:<strong class="lb iu">从BGR转换到RGB: </strong></p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="30b1" class="mq mr it ob b gy of og l oh oi">img = cv2.imread(filename="c:/path/to/image.png")<br/>img = cv2.cvtColor(src=img, code=cv2.COLOR_BGR2RGB)<br/>cv2.imshow('image', img)<br/>cv2.waitKey(0)</span></pre><p id="f0be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过添加一行，我们转换了图像，这样我们就得到它应该有的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/0a70b2c60c2854a9b4d3ee5b86bbbc5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oh3MdyeZRFV_vJSjasSTTg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">好多了(图片由<a class="ae ky" href="https://unsplash.com/@the_bracketeer" rel="noopener ugc nofollow" target="_blank"> Hendrik Conrlissen </a>在<a class="ae ky" href="https://unsplash.com/photos/-qrcOR33ErA" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄)</p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="a5b4" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">2.拍摄您的屏幕</h2><p id="a73e" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">想为一个游戏创建一个AI或者分析视频数据？然后，你可能想阅读你的屏幕，以分析图像。这非常类似于加载文件:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="4db1" class="mq mr it ob b gy of og l oh oi">import cv2<br/>import numpy as np<br/>from PIL import ImageGrab</span><span id="7670" class="mq mr it ob b gy oo og l oh oi">while (True):<br/>    screen = np.array(ImageGrab.grab())<br/>    screen = cv2.cvtColor(src=screen, code=cv2.COLOR_BGR2RGB)<br/>    cv2.imshow('my_screen', screen)<br/>    <br/>    # press escape to exit<br/>    if (cv2.waitKey(30) == 27):<br/>       break<br/>cv2.destroyAllWindows()</span></pre><p id="1d7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第6行我们使用了PIL的ImageGrab.grab()方法；这将返回我们的屏幕。我们必须将它转换成一个Numpy数组，这样OpenCV才能使用它。然后，在接下来的几行中，我们做和以前一样的事情:转换成RGB并告诉OpenCV向我们显示图像。然而，在第9行和第10行，当我们按下escape键时，我们告诉OpenCV中断循环；这就是<code class="fe or os ot ob b">waitKey(30) == 27</code>的意思。最后一行又是大扫除。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="ba11" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">3.读取网络摄像头</h2><p id="fd86" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">让我们加快速度；代码与上一部分非常相似。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="c4cd" class="mq mr it ob b gy of og l oh oi">cap = cv2.VideoCapture(0)<br/>while True:<br/>    ret, frame = cap.read()<br/>    frame = cv2.cvtColor(src=frame, code=cv2.COLOR_BGR2RGB)<br/>    cv2.imshow('webcam', frame)</span><span id="ebe4" class="mq mr it ob b gy oo og l oh oi"># press escape to exit<br/>    if (cv2.waitKey(30) == 27):<br/>       break<br/>cap.release()<br/>cv2.destroyAllWindows()</span></pre><p id="73db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第1行中，我们使用OpenCV方法来捕获我们的网络摄像头。然后，我们使用第3行中的<code class="fe or os ot ob b">read()</code>方法来接收两个变量:<code class="fe or os ot ob b">ret</code>，如果我们可以读取帧，则为真；以及<code class="fe or os ot ob b">frame</code>。接下来，我们再次转换我们的颜色(这一次是灰色)，显示帧并等待我们的退出键进行清理。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="99a3" class="mq mr it bd ms mt mu dn mv mw mx dp my li mz na nb lm nc nd ne lq nf ng nh ni bi translated">4.读取视频文件</h2><p id="b5c5" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">读取一个视频文件与读取你的网络摄像头是一样的，唯一的区别是我们必须传递文件的位置:</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="d449" class="mq mr it ob b gy of og l oh oi">cap = vc2.VideoCapture('c:/path/to/my/file.mp4</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="26b3" class="np mr it bd ms nq nr ns mv nt nu nv my jz nw ka nb kc nx kd ne kf ny kg nh nz bi translated">结论</h1><p id="2f6c" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">在本系列的第一部分中，我们已经处理了将图像导入OpenCV的绝对基础。在接下来的部分，我们将做一些漂亮的预处理和分析。</p><blockquote class="ou ov ow"><p id="af1a" class="kz la no lb b lc ld ju le lf lg jx lh ox lj lk ll oy ln lo lp oz lr ls lt lu im bi translated">不要忘记查看本系列的其他文章！</p></blockquote><p id="fdb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有建议/澄清，请评论，以便我可以改进这篇文章。同时，看看我的其他关于各种编程相关主题的文章，比如:</p><ul class=""><li id="d816" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/why-is-python-so-slow-and-how-to-speed-it-up-485b5a84154e" rel="noopener">Python为什么慢，如何加速</a></li><li id="ddb0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/advanced-multi-tasking-in-python-applying-and-benchmarking-threadpools-and-processpools-90452e0f7d40" rel="noopener">Python中的高级多任务处理:应用线程池和进程池并进行基准测试</a></li><li id="5579" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/write-your-own-c-extension-to-speed-up-python-x100-626bb9d166e7" rel="noopener">编写自己的C扩展来加速Python x100 </a></li><li id="ae28" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">【Cython入门:如何在Python中执行&gt;每秒17亿次计算</li><li id="dc80" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/create-a-fast-auto-documented-maintainable-and-easy-to-use-python-api-in-5-lines-of-code-with-4e574c00f70e" rel="noopener">用FastAPI用5行代码创建一个快速自动归档、可维护且易于使用的Python API</a></li><li id="755c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/create-and-publish-your-own-python-package-ea45bee41cdc" rel="noopener">创建并发布你自己的Python包</a></li><li id="23ae" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/create-your-custom-python-package-that-you-can-pip-install-from-your-git-repository-f90465867893" rel="noopener">创建您的定制私有Python包，您可以从您的Git库PIP安装该包</a></li><li id="5487" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/virtual-environments-for-absolute-beginners-what-is-it-and-how-to-create-one-examples-a48da8982d4b" rel="noopener">面向绝对初学者的虚拟环境——什么是虚拟环境以及如何创建虚拟环境(+示例)</a></li><li id="f910" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://mikehuls.medium.com/dramatically-improve-your-database-inserts-with-a-simple-upgrade-6dfa672f1424" rel="noopener">通过简单升级，显著提高数据库插入速度</a></li></ul><p id="5399" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编码快乐！</p><p id="2280" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">—迈克</p><p id="6009" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">页（page的缩写）学生:比如我正在做的事情？<a class="ae ky" href="https://mikehuls.medium.com/membership" rel="noopener">跟着我！</a></p><div class="pa pb gp gr pc pd"><a href="https://mikehuls.medium.com/membership" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd iu gy z fp pi fr fs pj fu fw is bi translated">通过我的推荐链接加入Medium—Mike Huls</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">mikehuls.medium.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr ks pd"/></div></div></a></div></div></div>    
</body>
</html>