<html>
<head>
<title>Detect the Defects in Steel with Convolutional Neural Networks (CNNs) and Transfer Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用卷积神经网络和迁移学习检测钢中的缺陷</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/detect-the-defects-in-steel-with-convoluted-neural-networks-cnns-and-transfer-learning-f761ca6c0d1f#2022-01-08">https://towardsdatascience.com/detect-the-defects-in-steel-with-convoluted-neural-networks-cnns-and-transfer-learning-f761ca6c0d1f#2022-01-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/f26ff389b4a4b9729cea9c25c0c96afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*edJXh3LPR9st-XRz"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">照片由<a class="ae jd" href="https://unsplash.com/@theblowup?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上放大</a></p></figure><div class=""><h1 id="3599" class="pw-post-title je jf jg bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">用卷积神经网络和迁移学习检测钢中的缺陷</h1></div><div class=""><h2 id="f77f" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">在机器学习和数据科学的帮助下检测钢铁中的缺陷，以便为钢铁工程师和制造商提供见解。</h2></div><p id="da84" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">钢</strong>用途广泛，如<strong class="kx jh">修建铁路</strong>、<strong class="kx jh">建筑</strong>、<strong class="kx jh">道路</strong>、<strong class="kx jh">家电</strong>、<strong class="kx jh">其他基础设施。</strong>像<strong class="kx jh">体育场</strong>和<strong class="kx jh">桥梁</strong>这样的东西，大多是借助钢铁打造出来的。通过观察钢的各种使用方式，我们发现钢在自然界中无处不在。</p><figure class="ls lt lu lv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lr"><img src="../Images/9edc0d8db3a9a2036895397d36f1193a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y67kk367-zYFDcQU"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">照片由<a class="ae jd" href="https://unsplash.com/@lucaupper?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Luca Upper </a>在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="2b13" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">注:</strong>数据集的所有者是PAO Severstal(<a class="ae jd" href="https://www.severstal.com/" rel="noopener ugc nofollow" target="_blank">https://www.severstal.com/</a>)</p><p id="dce1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，在钢的制造过程中，经常有缺陷被忽视的可能性。结果，最终的钢铁产品质量大打折扣。换句话说，我们得到的钢有缺陷，不能为我们建造桥梁和铁路的应用提供很多功能。除此之外，人类识别缺陷也相当困难，因为这通常是耗时且困难的过程。</p><p id="5220" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尽管如此，在<strong class="kx jh">卷积神经网络</strong>的帮助下，随着<strong class="kx jh">定位</strong>检测并准确识别钢中的缺陷是可能的，因此对于<strong class="kx jh">工程师</strong>和<strong class="kx jh">制造商</strong>来说将会非常方便。这将大大减少生产优质钢的时间。当<strong class="kx jh">定位</strong>也被提供时，它将帮助<strong class="kx jh">工程师</strong>发现导致钢中这种缺陷的设计错误和材料问题。本文主要考虑钢的缺陷识别，不包括<strong class="kx jh">定位</strong>。</p><p id="80ab" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇文章中，我重点介绍了我的<a class="ae jd" href="https://github.com/suhasmaddali/Steel-Defect-Detection-Challenge" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> GitHub项目的钢材缺陷检测</strong> </a>并详细说明了预测缺陷所采取的步骤。因此，这减少了工程师和制造商在钢铁生产中的时间和精力。</p><h2 id="1d4c" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">阅读图书馆</h2><p id="5f9a" class="pw-post-body-paragraph kv kw jg kx b ky mp kh la lb mq kk ld le mr lg lh li ms lk ll lm mt lo lp lq ij bi translated">现在是时候看看<strong class="kx jh">卷积神经网络</strong>如何工作，以及<strong class="kx jh">转移学习</strong>如何显著提高我们的准确性。下面是我们将在这个项目中使用的库。</p><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="8475" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这些是执行卷积神经网络计算必须导入的一些基本库。</p><p id="4b09" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> Numpy </strong>用于将列表转换为数组，计算等等。</p><p id="4332" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Seaborn 用于帮助我们交互绘图。</p><p id="a7ed" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> Pandas </strong>用于读写<strong class="kx jh">中的数据。csv" </strong>文件在我们的案例中。</p><p id="f7b6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> cv2 </strong>是一个高效的库，用于读取图像并将其转换为像素值或数学值进行卷积。</p><p id="893a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> Matplotlib </strong>用于绘制可视化图形，以便用户能够分别理解工作。</p><p id="1ad6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> Tensorflow </strong>库用于训练和计算我们将在项目中使用的图像。</p><h2 id="7f3d" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">指定训练和测试路径</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="49ab" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还将为训练集和测试集指定文件的路径。也就是说，我们需要寻找包含我们钢铁图像的<strong class="kx jh">目录</strong>。在指定了这个路径之后，我们将以<strong class="kx jh">数组</strong>的形式读取图像，以便用它来执行计算。</p><h2 id="8ab3" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated"><strong class="ak">迁移学习</strong></h2><p id="7558" class="pw-post-body-paragraph kv kw jg kx b ky mp kh la lb mq kk ld le mr lg lh li ms lk ll lm mt lo lp lq ij bi translated">迁移学习大大减少了我们的训练时间，也提高了模型的准确性。在迁移学习中，已经为特定数据集训练的模型正在用于我们的应用程序。我们使用<strong class="kx jh">预训练模型</strong>和之前数据集中学习到的所有权重，而不是从零开始训练我们的模型，这需要很多时间，因此它为我们的钢分类任务产生了良好的结果。要了解更多关于迁移学习的知识，我建议查看这个博客。</p><p id="c3d3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae jd" href="https://machinelearningmastery.com/transfer-learning-for-deep-learning/" rel="noopener ugc nofollow" target="_blank">深度学习迁移学习温和介绍(machinelearningmastery.com)</a></p><h2 id="b846" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">VGG19网络</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="df5c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的编码单元格中，我们看到headmodel变量考虑到了<strong class="kx jh"> VGG19 </strong>模型。预训练的权重取自<a class="ae jd" href="https://www.image-net.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> imagenet </strong> </a>数据集。我们使用<strong class="kx jh"> VGG19 </strong>作为我们的头模型或起始模型。添加此架构后，我们从各层获取输出，并在二维空间中执行平均池化。后来，有一个层的展平，以便最后，它被转换成一个1D数组，分别用于我们的训练。我们使头模型(VGG19) <strong class="kx jh">的所有层不可训练</strong>，这意味着当我们使用steel数据集训练时，这些权重不会被修改。</p><h2 id="7c84" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">编译模型</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="ecdf" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在是时候编译模型，并为我们的最终模型选择正确的<strong class="kx jh">损失</strong>、<strong class="kx jh">优化器</strong>和<strong class="kx jh">指标</strong>。我们选择了<strong class="kx jh">分类交叉熵</strong>，因为它是一个多类分类问题。选择Adam  optimizer是因为它在很大程度上减少了损失，并且没有太多噪声。将要显示的度量是<strong class="kx jh">精度</strong>。</p><h2 id="b341" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">定义检查点</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="85ee" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">模型回调</strong>当模型在训练模型的任务中达到特定结果时，在深度学习中使用。我们使用<strong class="kx jh">检查点</strong>变量来存储基于交叉验证准确性的最佳模型，如上所示。在拟合模型时，会给出checkout变量，以便启动回调。</p><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="e96b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">拟合最终模型并采用<strong class="kx jh"> fitted_model </strong>变量中的参数，使其可用于绘图和评估机器学习模型的性能。我们用更少的时期数(10)进行训练，同时打印交叉验证准确度。</p><h2 id="735d" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">评估模型</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="ca36" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">评估深度学习和卷积网络(CNN)模型性能的最佳方式之一是包括其训练误差和交叉验证误差的<strong class="kx jh">图</strong>。为了了解模型是<strong class="kx jh">过拟合</strong>还是<strong class="kx jh">欠拟合</strong>，最好看看误差值是如何随着时期数的增加而减小还是增加的。要了解更多关于过度拟合和欠拟合的信息，请随意参考我写在下面的文章。</p><p id="0b01" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae jd" href="https://medium.com/mlearning-ai/what-is-overfitting-and-underfitting-in-machine-learning-6817ba47e37a" rel="noopener">什么是机器学习中的过拟合和欠拟合？|作者Suhas Maddali | mlearning . ai | Medium</a></p><p id="9d1d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们也探索其他网络，为我们预测钢中缺陷的任务选择最佳网络。</p><h2 id="bb9a" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">高效网络</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="2c09" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在是时候使用<strong class="kx jh">有效网络</strong>来查看模型的表现如何，以及<strong class="kx jh">最佳模型</strong>是否会随着准确性的增加而减少交叉验证误差。值得注意的是，有效网络有多种变体，但我们使用<strong class="kx jh"> EfficientNetB0 </strong>作为起点。我们通常不改变网络的最后几层。我们再次将<strong class="kx jh">预训练的</strong> EfficientNet模型用于imagenet数据。但是我们将训练我们网络的最后几层来完成检测钢中缺陷的任务。再次应用对<strong class="kx jh"> VGG19 </strong>型号采取的上述步骤。也就是说，我们将拟合模型并将最佳模型存储在<strong class="kx jh">.【H5】</strong>文件中，并且<strong class="kx jh">评估</strong>模型。让我们也来看看其他提高<strong class="kx jh">交叉验证数据</strong>准确性的网络。</p><h2 id="d51c" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">例外网络</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="7593" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，借助于<strong class="kx jh">例外</strong>网络和<strong class="kx jh"> imagenet </strong>上的预训练权重，我们将了解如何减少交叉验证误差或提高准确度。为了获得最佳性能，输入必须分别为<strong class="kx jh"> (299，299，3) </strong>的形状。因此，输入的形状和尺寸是在启动网络时指定的。</p><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="56d5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为例外网络指定相同的优化器和损失，对于多类分类问题，度量为<strong class="kx jh">准确度</strong>。</p><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="03da" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们拟合模型并将结果再次存储在<strong class="kx jh"> fitted_model </strong>变量中，该变量稍后分别用于绘图。在执行训练后查看这些图有助于理解模型是否分别具有高方差或偏差。基于这些图，采取行动是增加时期的数量还是增加训练样本的数量。</p><h2 id="865a" class="lw lx jg bd ly lz ma dn mb mc md dp me le mf mg mh li mi mj mk lm ml mm mn mo bi translated">InceptionV3网络</h2><figure class="ls lt lu lv gt is"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="7eaf" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在是时候为我们预测钢中缺陷的任务初始化网络了。<strong class="kx jh"> InceptionV3 </strong>是由<strong class="kx jh">谷歌</strong>开发的网络。它最初从较少数量的通道开始。当我们向前传播到网络深处时，很明显，信道的数量增加了，而卷积运算减少了激活单元的宽度和高度。我知道这听起来很过分。你可以看看下面的网站来更好地了解InceptionV3网络。</p><p id="db0d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae jd" href="https://cloud.google.com/tpu/docs/inception-v3-advanced" rel="noopener ugc nofollow" target="_blank">盗梦空间高级指南v3 |云TPU |谷歌云</a></p><h1 id="7b8f" class="mw lx jg bd ly mx my mz mb na nb nc me km nd kn mh kp ne kq mk ks nf kt mn ng bi translated">结论</h1><p id="07ee" class="pw-post-body-paragraph kv kw jg kx b ky mp kh la lb mq kk ld le mr lg lh li ms lk ll lm mt lo lp lq ij bi translated">在对模型进行训练和测试后，我发现<strong class="kx jh"> InceptionV3 </strong>网络与其他网络相比表现最佳。然而，这取决于我们所考虑的问题或任务。对于imagenet等其他任务，<strong class="kx jh">高效网</strong>表现最佳，同时也显著减少了训练时间。因此，可能有许多模型在特定的任务集上表现良好。在<strong class="kx jh">部署</strong>生产中的最佳型号之前，考虑所有型号是很重要的。希望这篇文章对你有所帮助。以下是您可以联系我或查看我的作品的详细信息。</p><p id="acc1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> GitHub: </strong> <a class="ae jd" href="https://github.com/suhasmaddali" rel="noopener ugc nofollow" target="_blank">苏哈斯马达利(Suhas Maddali)(github.com)</a></p><p id="9b7b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh"> LinkedIn: </strong> <a class="ae jd" href="https://www.linkedin.com/in/suhas-maddali/" rel="noopener ugc nofollow" target="_blank"> (1)苏哈斯·马达利，东北大学，数据科学| LinkedIn </a></p><p id="9389" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">中等:</strong> <a class="ae jd" href="https://suhas-maddali007.medium.com/" rel="noopener">苏哈斯·马达利—中等</a></p></div></div>    
</body>
</html>