# RStudio 工作坊回顾——打造整洁的工具

> 原文：<https://towardsdatascience.com/review-of-the-rstudio-workshop-building-tidy-tools-434c606029e2>

![](img/0a893c407dc4ece65981c0af6f64d168.png)

由 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的 [Kvalifik](https://unsplash.com/es/@kvalifik?utm_source=medium&utm_medium=referral) 拍摄的照片

*打造整洁的工具*是 RStudio 每年在其 RStudio 会议上提供的众多研讨会之一。我参加了 2022 年 7 月 25 日至 7 月 26 日在 DC 举行的上一次会议的研讨会。在这篇博客文章中，你将会看到一份研讨会内容的总结，以及我对整个研讨会的看法。如果你正在考虑参加这个研讨会，希望这篇文章能给你一些帮助。

在进入更多细节之前，这里有一些关于研讨会的快速事实，以帮助您确定这是否是适合您的内容:

## 这是什么？

该研讨会是一个为期两天的实践培训，教授如何使用*【tidy】*设计或编码原则在 R 中构建包，这些原则在包含在包 universe—[*tidy verse*](https://cran.r-project.org/web/packages/tidyverse/vignettes/paper.html)中的包中进行了演示。

## 谁是主要受众？

该研讨会的官方网站称，任何有编写 R 函数经验并准备好发布其作品的人都应该是合适的候选人。我认为这是一个相当准确的要求，但为了使它更具体，我想说如果他/她以前已经尝试过构建 R 包，那么他/她将从这个研讨会中获得最大的收益。但这只是我的看法:)

所以现在让我们深入了解细节。

# 用两天时间将功能打包

如前所述，这是两天的事情。我认为这两天的内容针对包开发旅程的两个不同方面:创建包的过程和编写 R 编程的最佳实践。最终目标是带领培训生实时地构建和改进一个包。事实上，你可以在这里检查你将在研讨会后生产的最终产品，R 包。

为了使我的总体回顾更有条理，我将把总结和评论分成几个部分来分享。

## 第 1 天:构建概念验证包

如果你参加这个研讨会的目的是想知道如何扔掉一堆包装在 R 包中的脚本并开始使用它，那么第一天的材料就足够了！你将在一天之内从理解什么是 R 包到构建你的第一个 R 包，甚至为你的包创建一个站点！所有这一切，在我看来，可能是最无痛的方式。

这一天的内容分为四个部分:

**第一场:整场比赛**

在建立了一些基本规则并讨论了研讨会的议程后，你将会对“什么是 R 包”有一个温和的介绍。本课程将让您开始 R 项目，并为开始构建 R 包做好基础工作。

您将开始您的 R 包开发项目，设置版本控制，将您的第一个函数添加到包中，了解基本的包开发工作流和许可。除非您遇到一些技术异常，否则这个会议应该会非常顺利，并让您对构建 R 包有很好的体验。

**第二场会议:文件-最少**

顾名思义，这一节是关于文档的,“最少”部分意味着这一节的讨论将只解释最少的文档:填写描述文件和函数的最少描述——如果在 r。

您将了解描述文件——R 包的定义文件之一，了解包含什么和不包含什么。

> 请特别注意关于包依赖关系的部分。没有恰当地包含依赖关系会导致很多令人头疼的问题。

对于函数文档，您将学习如何使用 *Roxygen、*和 *devtool* 包来自动转换函数脚本中的注释以生成文档。

**会议 03:单元测试**

可能是一天中最具挑战性的部分 01。您将了解如何使用包 *testthat* 来设置测试过程，以便在每次迭代或修改函数后自动运行测试。从不同的用例中建立测试用例，将会在一个包的整个生命周期中减少很多不必要的东西。这一节将向您介绍`*expect_*()*` 系列函数，它将使设置不同的测试场景变得更加容易。

**第四场会议:文件共享**

这一节详细介绍了使您的包对其他人有用所需的文档——比如在 GitHub 页面中建立一个 *readme* 文件，创建一个*小插图*来详细描述包及其内容。

除了这些文档之外，您还将使用 *GitHub Actions* 建立一个 [CI-CD 管道](https://en.wikipedia.org/wiki/CI/CD),以确保代码中的任何更改一旦被推送到 GitHub，所有的测试都会运行，文档都会更新。

> 最激动人心的部分——一天下来，你将拥有一个实用的软件包和一个很酷的网站！

总的来说，第一天进行得很顺利，让大家对拥有一个真正的包裹感到兴奋。它展示了使用像 *usethat* 和 *devtool* 这样的包来打包代码是多么容易。

## 第 2 天:为你的长期成功做准备——至少我是这么认为的。

如果第 01 天是让您对构建 R 包感到兴奋，那么第 02 天是为您的长期成功做准备，这意味着它超越了严格的包构建，深入研究了 R 的一些内部工作，讨论了最佳实践等等。与第一天相似，第二天也是四节课。

**第一场会议:设计**

本节首先简要讨论 tiyeval 如何工作，然后讨论编写函数的一些最佳实践，例如:命名、大小写、参数序列，以及将纯函数与有副作用的函数分开。第二节课将更详细地讨论带有副作用的纯 vs 函数。

**会议 02:控制副作用**

本节讨论了测试和管理函数产生的副作用的方法。您将练习使用方法来验证输入和中止函数(如果需要的话),以及如何编写用户友好的错误消息。此外，如何在不改变全球环境的情况下发挥作用。

**会议 03:整洁评估**

如果您已经用 R 编写了一段时间的代码，并且也涉猎了 Python 等其他语言，那么您可能已经注意到，与 Python 不同的是，您可以将 R 函数中的列名作为非字符串值传递。Tidy eval 使 R 有可能将裸名理解为列名。这是一个方便的特性，但不是我最喜欢的，本节将详细介绍这个功能。

涵盖的具体主题有:利用三个点(…)作为 tidy 函数的输入，使用拼接(！！！)功能，使用双花({{}})，实用一些非常具体的整理功能，如 any_of()、all_of()、跨和比较代码快照。

总的来说，本节介绍了一些非常具体的工具和功能，这些工具和功能将使功能更加*整洁*和易于维护。

**会议 04:函数式和面向对象编程(OOP)**

第 2 天的课程涵盖了许多需要更多关注和注意才能正确理解的内容。作为最后一次会议，由于时间限制，这部分有点仓促。这个会议是关于如何在 r 中实现函数式编程的。

> 使用函数作为参数是函数式编程的基础。—引自会议幻灯片。

在这次会议中，我没有发现太多关于 OOP 的内容，老实说，我也不认为 R 是实践 OOP 的正确语言。如果你喜欢 OOP，那么 Python 会更适合你。

对利用 *purrr* 包在 r 语言中进行函数式编程进行了快速讨论和动手练习。

总的来说，除了确定的任务列表之外，第 02 天充满了来自 Ian 的有用的建议，他是一名教师，有着丰富的编程经验。此外，这些幻灯片还加载了额外的资源，以便浏览和了解更多有关 R 内部工作方式和一般编码最佳实践的信息。

总的来说，我对这个研讨会非常满意——它设计得很好，经过深思熟虑，我觉得它对不同专业水平的人都有帮助。对于对构建 R 包感兴趣的人来说，第 01 天是一个很好的激励。对于一个充满热情的 R 程序员来说，第 02 天充满了让他们的 R 之旅更加顺利的建议和技巧。

此外，课程材料是开源的。这里是课程[网站](https://rstudio-conf-2022.github.io/build-tidy-tools/)，这里是工作坊 [GitHub repo](https://github.com/rstudio-conf-2022/build-tidy-tools) 。