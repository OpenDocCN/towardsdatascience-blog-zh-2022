<html>
<head>
<title>4-Step Routine to Assess Your Model Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">评估模型性能的4步程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-step-routine-to-assess-your-model-performance-ed5b3eb6ccd2#2022-01-31">https://towardsdatascience.com/4-step-routine-to-assess-your-model-performance-ed5b3eb6ccd2#2022-01-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""><h1 id="c781" class="pw-post-title ir is it bd iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp bi translated">评估模型性能的4步程序</h1></div><div class=""><h2 id="eff7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">回到基础</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2881ce92100d9b61fa29698cca03ab8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XBcPwmFbst7x_eyd"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Kolleen Gladden 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="50d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们怎么能说“这个模型概括得很好”，“那个算法执行得很好”，或者简单地说“那个很好”？</p><p id="8858" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们正在研究机器学习中广泛使用的方法和指标，以分析分类模型的性能。</p><p id="aa54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能会问:只为了分类？</p><p id="27c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在回归的情况下，评估更简单，因为它通常只涉及计算平均损失函数，如均方误差(MSE)。该指标表明曲线与数据的拟合程度，并让我们比较不同回归模型之间的性能。</p><p id="4e06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相比之下，分类模型的情况要复杂一些，但是下面的例程可以帮助我们系统地评估和比较模型的性能:</p><ol class=""><li id="28f4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">计算<strong class="lb iu">混淆矩阵</strong></li><li id="c9c1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">计算<strong class="lb iu">精度并召回</strong></li><li id="b886" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">看<strong class="lb iu">精度</strong>或<strong class="lb iu">成本敏感精度</strong></li><li id="d502" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">评估ROC曲线下的<strong class="lb iu">面积</strong></li></ol><h1 id="fba9" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">混淆矩阵</strong></h1><p id="a329" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">混淆矩阵是一个表格，显示了每个类别的正确和错误预测的数量。假设我们有一个计算机视觉算法，它将体育图片作为输入，并预测正在播放的内容。例如，我们可以有篮球、棒球和足球类，混淆矩阵如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/8c2e64360af848754f23d109c003f0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L7lW2KmVj5E1kV11uZVswQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">体育类别混淆矩阵示例(<em class="nh">作者图片)</em></p></figure><p id="6e80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在多类别分类的情况下，可以单独分析每个类别，但让我们将所有篮球示例视为<strong class="lb iu">正面</strong>而其他类别视为<strong class="lb iu">负面</strong>(我可能会有偏见，因为这是我最喜欢的运动)。我们可以观察到，在14个篮球示例中，该模型只正确分类了2个。换句话说，我们只有2个<strong class="lb iu">真阳性(TP = 2) </strong>和12个<strong class="lb iu">假阴性(FN = 12) </strong>。该模型给出了4个<strong class="lb iu">假阳性(FP = 4) </strong> : 3个实际上是棒球，1个例子是足球而不是篮球。并且该模型给出了21个(5 + 2 + 4 + 10) <strong class="lb iu">真阴性(TN = 21)。</strong></p><p id="c1ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个练习可以针对每个类别进行，并且对于快速可视化我们的算法的性能特别有用。在我们的例子中，我们可以注意到该算法非常擅长识别足球，但很难区分篮球和棒球。</p><p id="1983" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该模型倾向于错误地预测棒球而不是篮球。太可惜了！在这种情况下，我们可以决定向我们的数据集中添加更多篮球图片的示例，并重新训练该模型。</p><h1 id="cd26" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">精确&amp;召回</strong></h1><p id="6b98" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">精确度和召回率可能是评估一个模型最常用的两个比率。精度是所有肯定预测中正确的肯定预测的比例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/467d67e2eab0cb23d1c12e1240b04336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ZAr7KlGYBdlSZFPyHsmqQ.png"/></div></div></figure><p id="3379" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的篮球例子，我们有2个正确的预测(TP = 2)和4个不正确的肯定预测(FP = 4)。因此精度是1/3。</p><p id="5d4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">召回率是算法能够从数据集中的所有正例中检测到的正例的比例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/c0416420a08559c1c3fee5d669b4f16d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nyiSWZBSKqT5UtWtsMkoLA.png"/></div></div></figure><p id="45fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于篮球的例子，我们有12个错误的否定，这给了我们只有1/7的召回率。</p><p id="89b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在实践中，你通常会得到很好的精确度或很好的回忆，但不可能同时得到两者。我们通常可以调整超参数，以召回为代价最大化精确度，或者以精确度为代价最大化召回。</p><h1 id="8cbc" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak">精度&amp;对成本敏感的精度</strong></h1><p id="8145" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">准确度给出了正确分类的例子在所有分类的例子中的比例:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/67d1e1759d7bea22ac6b2926e3698b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KkWDNDvGuYrw8zng3k1Sg.png"/></div></div></figure><p id="067d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">准确度是算法能够做出正确预测的程度的指示。使用这种度量的一个缺点是所有的错误都被认为是一样的。</p><p id="4da4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有时，我们有比其他课程更重要的课程，我们需要不同地惩罚错误。例如，如果我们有一个算法将电子邮件分类为<em class="nl">垃圾邮件</em>和<em class="nl">非垃圾邮件</em>。误报是指当你的收件箱收到垃圾邮件时，误报是指你朋友的邮件进入了垃圾邮件文件夹。在这种情况下，我会认为假阳性比假阴性更令人讨厌。</p><p id="1da8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理这个问题的一种方法是通过用两种不同的权重(C1和C2)对两种类型的误差(FP和FN)进行加权来计算成本敏感的精度。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/7c1aa196fc198c6385ad0cc873eededb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAdT9yVOk_0mUDAQjK59TQ.png"/></div></div></figure><p id="9a4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的电子邮件示例，如果我们想认为一个错误较少的模型比另一个错误相同但错误较多的模型更准确，我们可以设置C1 &gt; C2。</p><h1 id="226d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">ROC曲线下的面积</h1><p id="fca3" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">受试者工作特性(ROC)曲线是一种评估分类技术性能的直观方法。此方法仅适用于输出置信度的分类算法。例如，我们可以计算神经网络、逻辑回归或决策树的ROC曲线。</p><p id="128a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要绘制ROC曲线，我们需要两个指标:</p><ul class=""><li id="eeb1" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nn mb mc md bi translated">真阳性率(TPR)被定义为(与回忆完全一样)正确预测的阳性样本的比例:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/87c229f3f72776c0d52a93958043cc79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*odyhaEufM7XsULhbrzp8hQ.png"/></div></div></figure><ul class=""><li id="3cbb" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu nn mb mc md bi translated">假阳性率(FPR)被定义为错误预测的阴性样本的比例:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/fb9abeea0c43530a35a31089a3cb8dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8MzY1rDqqpoAHVZ29RJ2gg.png"/></div></div></figure><p id="d6e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们以输出介于0和1之间的置信水平的逻辑回归分类器为例。我们可以选择阈值，在该阈值以上，我们认为预测是肯定的，例如0.5。</p><p id="3ee7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了绘制ROC曲线，我们将离散化所有可能阈值的区间(例如:[0，0.1，0.2，0.3，0.4，0.5，0.6，0.7，0.8，0.9，1])，并计算每个水平的TPR和FPR。然后，我们可以计算曲线下面积(AUC ),如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/82864574da36458720e06680d1c35018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3i8DZbKY9WXzw3EV4Cjv8A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="nh">作者图片</em></p></figure><p id="25c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">阈值“1”不会给出任何肯定的预测(FPR=0和TPR=0)，阈值“0”只会带来肯定的预测(FPR=1和TPR=1)。中间的一切都取决于型号。</p><p id="8de2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完美的分类器将给出1曲线下的面积，而随机分类器将给出0.5的面积(如右侧的图)。AUC越大，性能越好，并且通常可以通过选择给出接近1的TPR和接近0的FPR的阈值来找到好的分类器。</p><h1 id="6dee" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">最后的话</h1><p id="f42f" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">混淆矩阵是分析和比较分类算法性能的良好起点。该矩阵有助于了解我们的分类器是否有一些模式或明显的错误。但是这种方法也有它的局限性，重要的是要考虑其他关键指标，如精确度、召回率和准确度。</p><p id="c00c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在我们讨论的四种方法中，ROC曲线下面积可能是最有效的技术。ROC曲线捕获分类的不止一个方面(真阳性率和假阳性率)，并且该曲线相对容易理解和直观快速分析。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><p id="05e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好奇想了解更多关于Anthony的工作和项目吗？在<a class="ae ky" href="https://medium.com/@anthonycvn" rel="noopener">媒体</a>、<a class="ae ky" href="https://www.linkedin.com/in/anthonycavin/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://twitter.com/Anthony66333223" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注他。</p><p id="45b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nl">需要技术写手？将您的请求发送到</em><a class="ae ky" href="https://amigocci.io/blog/mlops-at-medium-scale/" rel="noopener ugc nofollow" target="_blank"><em class="nl">https://amigo CCI . io</em></a><em class="nl">。</em></p></div></div>    
</body>
</html>