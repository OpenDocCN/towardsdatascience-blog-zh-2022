<html>
<head>
<title>Camera Extrinsic Matrix with Example in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中带示例的相机外部矩阵</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/camera-extrinsic-matrix-with-example-in-python-cfe80acab8dd#2022-01-26">https://towardsdatascience.com/camera-extrinsic-matrix-with-example-in-python-cfe80acab8dd#2022-01-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="ff41" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">Python中带示例的相机外部矩阵</h1></div><div class=""><h2 id="b5d8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python中图像形成和相机校准综合教程系列的第2部分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/46614a57a2a8aed6b697ffd7c571ccd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*245_9gmG_gUCPciYbKw5wA.jpeg"/></div></div></figure><h1 id="9c71" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="64b0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在<a class="ae mf" rel="noopener" target="_blank" href="/image-formation-and-pinhole-model-of-the-camera-53872ee4ee92">之前的文章</a>中，我已经介绍了相机成像的概念，并简要讨论了相机的外在和内在。</p><p id="8b0e" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在这篇文章中，我们将深入探讨相机外部性，也称为相机姿态，并通过Python中的一个实际例子来加强我们的理解。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="b13d" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">相机外部</h1><p id="3cb9" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">摄像机可以位于世界上的任何地方，它可以指向任何方向。我们希望从摄像机的角度来观察世界上的物体，这种从世界坐标系到摄像机坐标系的转换称为摄像机外部或摄像机姿态。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/46614a57a2a8aed6b697ffd7c571ccd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*245_9gmG_gUCPciYbKw5wA.jpeg"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">文字坐标系vs相机坐标系</p></figure><p id="d2ab" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">那么，怎样才能找到相机的姿势呢？一旦我们弄清楚相机是如何变换的，我们就能找到从世界坐标系到相机坐标系的变换。我们将详细探讨这个想法。</p><p id="a762" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">具体来说，我们需要知道相机是如何定向的，以及它在世界空间中的位置，有两个变换可以帮助我们:</p><ul class=""><li id="c302" class="nb nc iq ll b lm mg lp mh ls nd lw ne ma nf me ng nh ni nj bi translated">帮助定向相机的旋转变换。</li><li id="18e1" class="nb nc iq ll b lm nk lp nl ls nm lw nn ma no me ng nh ni nj bi translated">帮助移动相机的平移变换。</li></ul><p id="8b4f" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">让我们详细看一下每一个。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="bc3f" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">旋转</h1><h2 id="b762" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">通过旋转改变坐标</h2><p id="34aa" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们看看将一个点旋转一个角度的变换。让我们在ℝ举一个简单的例子，我们将点𝑃在XY平面上绕原点旋转一个角度𝜃，得到点𝑃′，如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/5d6b7f32c7a3810375f8092a8d3e7367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkaT6sY7OHDworLvSiWv4w.jpeg"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">旋转变换。</p></figure><p id="50c5" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">𝑃的坐标是(𝑥,𝑦)，𝑃′的坐标是(𝑥′,𝑦′).我们需要找到(𝑥′,𝑦′).</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="c513" class="np ks iq od b gy oh oi l oj ok">From the figure,<br/>      sinα = y/r , cosα = x/r − [1]<br/>⟹    xsinα = ycosα − [2]<br/>also, x′ = rcos(θ+α)<br/>⟹    x′ = (x/cosα) ∗ cos(θ+α) (from [1])<br/>but,  cos(θ+α) = cosθcosα − sinθsinα<br/>⟹    x′ = (x/cosα) ∗ (cosθcosα − sinθsinα)<br/>⟹    x′ = xcosθ − xsinα ∗ (sinθ / cosα)<br/>⟹    x′ = xcosθ − ycosα ∗ (sinθ / cosα) (from [2])<br/>⟹    x′ = xcosθ − ysinθ</span><span id="0cb4" class="np ks iq od b gy ol oi l oj ok">Similarly,<br/>      y′ = rsin(θ+α)<br/>⟹    y′ = (y/sinα) ∗ sin(θ+α) (from [1])<br/>but,  sin(θ+α) = sinθcosα + cosθsinα<br/>⟹    y′ = (y/sinα) ∗ (sinθcosα + cosθsinα)<br/>⟹    y′ = ycosθ + ycosα ∗ (sinθ / sinα)<br/>⟹    y′ = ycosθ + xsinα ∗ (sinθ / sinα) (from [2])<br/>⟹    y′ = ycosθ + xsinθ<br/>⟹    y′ = xsinθ + ycosθ</span><span id="26f9" class="np ks iq od b gy ol oi l oj ok">Hence we have,<br/>      x′ = xcosθ − ysinθ<br/>      y′ = xsinθ + ycosθ</span></pre><p id="3a3d" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">旋转是线性运算，上面的等式可以表示为矩阵乘法:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/1c6e5cb96021aa9f1ecc349e7bbc289c.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*co_bRD8ynU_iRfU5UaUayQ.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">旋转点𝑃′的坐标</p></figure><p id="e685" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">这个操作是线性变换。这里，我们变换点，保持轴或基础固定。</p><h2 id="4ff7" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">延伸至R3</h2><p id="086e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们可以很容易地将旋转变换推广到𝐑。𝐑绕标准x轴、y轴和z轴旋转的变换矩阵如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/d9cd1e8427d0c5fc813a013d65f3b888.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*2-cQP835KKyCeRqROlvBuA.png"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">绕Z轴旋转</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/4f8c5f06a1aa8bf32596215204ef1bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*RsZ3zxeapuJnTeguwgZg9A.png"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">绕X轴旋转</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/2496dd0d07ebf40369f03e57a0dc9a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*9OrjNWgnD0FCH6OTJrhguA.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">绕Y轴旋转</p></figure><h2 id="5e77" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">内在旋转与外在旋转</h2><p id="75e3" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">上述变换执行围绕标准轴的旋转。轴会随时固定。这叫做外旋。还有另一种称为固有旋转的旋转类型，我们在每一步都围绕其相对轴旋转对象，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/2440b2c5ed35d9b0afef1d0ff0298a00.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/1*eNZY7HJ_PUUBZ20Dy5EqfA.gif"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">内在旋转。Euler 2 . gif:juansempere衍生作品:Xavax，CC BY-SA 3.0&lt;<a class="ae mf" href="https://creativecommons.org/licenses/by-sa/3.0" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by-sa/3.0</a>&gt;，通过维基共享</p></figure><p id="2cc3" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">内旋很难用欧几里得代数来执行，我们将坚持外旋。</p><h2 id="5336" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">通过旋转改变基底</h2><p id="b5ab" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在基变换中，目标是找到一个点在新基下的坐标。该点将被固定。</p><p id="df4b" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在下面的例子中，𝑋𝑌轴已经旋转了一个角度𝜃得到𝑋′𝑌′.给定旧基点𝑋𝑌上𝑃点的坐标，我们的目标是找到新基点𝑋′𝑌′.上𝑃点的坐标</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/4bdfb22d97eb153a84e9612e1914f00c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LbiToUqUPm8UhAeluVQyMQ.jpeg"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">旋转XY轴</p></figure><p id="cc99" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">𝑃至𝑋𝑌的坐标为(𝑦𝑥)，至𝑋′𝑌′的坐标为(𝑦′).𝑥′)我们的目标是找到(𝑥′，𝑦′).</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="8ce2" class="np ks iq od b gy oh oi l oj ok">From the figure,<br/>      sinα = y′/r , cosα = x′/r − [1]<br/>⟹    x′sinα = y′cosα − [2]<br/>also, x = rcos(θ+α)<br/>⟹    x = (x′/cosα) ∗ cos(θ+α) (from [1])<br/>but,  cos(θ+α) = cosθcosα − sinθsinα<br/>⟹    x = (x′ / cosα) ∗ (cosθcosα − sinθsinα)<br/>⟹    x = x′cosθ − xsinα ∗ (sinθ / cosα)<br/>⟹    x = x′cosθ − y′cosα ∗ (sinθ / cosα) (from [2])<br/>⟹    x = x′cosθ − y′sinθ</span><span id="c421" class="np ks iq od b gy ol oi l oj ok">Similarly,<br/>      y = rsin(θ+α)<br/>⟹    y = (y′/sinα) ∗ sin(θ+α) (from [1])<br/>but,  sin(θ+α) = sinθcosα + cosθsinα<br/>⟹    y = (y′/sinα) ∗ (sinθcosα + cosθsinα)<br/>⟹    y = y′cosθ + y′cosα ∗ (sinθ / sinα)<br/>⟹    y = y′cosθ + x′sinα ∗ (sinθ / sinα) (from [2])<br/>⟹    y = y′cosθ + x′sinθ<br/>⟹    y = x′sinθ + y′cosθ</span><span id="11c1" class="np ks iq od b gy ol oi l oj ok">Hence we have,<br/>      x = x′cosθ − y′sinθ<br/>      y = x′sinθ + y′cosθ</span></pre><p id="6cf3" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">上述等式可以矩阵形式表示为:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/355497e52f8ab0c2def6f25f5aff1082.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*4JHUvAldihOR4XVVLy6JhA.png"/></div></figure><p id="4143" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们的目标是找到(𝑥′,𝑦′).所以，我们把矩阵移到另一边，取它的逆:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/0abd4fa0d6ff8a1ddc76cc66c5771e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*XDrCZv33FyHaDtBaCZh_TA.png"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">基数变化变换</p></figure><p id="6e34" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">理解线性变换和基变换之间的区别是非常重要的。</p><p id="52a4" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">接下来我们将看到这两种转换是如何关联的。</p><h2 id="6aa3" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">线性变换与基变换的关系</h2><p id="2b6d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果你观察，基变换矩阵是线性变换矩阵的逆矩阵。这意味着，如果我们知道相机变换矩阵——负责在世界上旋转和移动相机的矩阵，我们可以对其求逆来获得基矩阵的变化，这可以帮助我们找到相机周围点的坐标。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="7307" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">翻译</h1><h2 id="0398" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">通过平移改变坐标</h2><p id="c3e2" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">平移的想法很简单-给定一个点𝑃，我们将它移动一个偏移量以获得点𝑃′，如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/1f9098500cb637c84c8bd40b8e063ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xf2mCbESBON8riaw5f3VNg.jpeg"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">翻译转换</p></figure><p id="5c63" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">这里，我们将坐标为(𝑦𝑥)的点𝑃移动一个偏移量(𝑏−𝑎)，得到坐标为(𝑦′).𝑥′)的点𝑃′我们的目标是找到(𝑥′，𝑦′).</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="473e" class="np ks iq od b gy oh oi l oj ok">from the figure,<br/>      x′ = x - a<br/>      y′ = y + b</span></pre><p id="f005" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们不能用矩阵乘法来表达上面的方程——至少不能用目前的表达方式。诀窍是增加一个额外的维度，然后我们可以将平移表示为线性变换，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2407e95469c87dc4097c72fd1defb524.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*rI_Mmn-cNZe3KPGztO5xyA.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">作为线性变换的翻译</p></figure><p id="5c27" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">用额外维度表示的坐标称为齐次坐标。</p><p id="ee6c" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">为了从齐次坐标中恢复欧几里得坐标，我们简单地除以最后一个元素，如下所示:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="5d32" class="np ks iq od b gy oh oi l oj ok">[x, y, 1] ≅ [x/1, y/1] = [x, y]</span></pre><p id="3901" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">一般来说，我们在齐次空间中执行所有操作，因为这很容易操作，最后，当我们完成时，我们转换回欧几里得空间。稍后我们将更详细地了解这一点。</p><h2 id="d627" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">通过翻译改变基础</h2><p id="1a8f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">就像我们之前看到的，在基变换中，我们变换的是轴，而不是点。在下面的例子中，我们将𝑋𝑌轴移动一个偏移量来得到𝑋′𝑌′.我们的目标是找到𝑃点在𝑋′𝑌′.新坐标轴上的坐标</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/b430d5d7131492f7c6f4f7e965d8bbab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBSS1gYL0MI8XSORXAtrTw.jpeg"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">平移XY轴</p></figure><p id="3a91" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">𝑃相对于旧轴的坐标是𝑋𝑌(𝑥，𝑦)，相对于新轴的坐标是𝑋′𝑌′(𝑥′,𝑦′).)这里的偏移量是(𝑎，𝑏).</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="6eef" class="np ks iq od b gy oh oi l oj ok">from the figure,<br/>      x′ = x - a<br/>      y′ = y - b</span></pre><p id="d784" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">同样，为了将上述方程表示为矩阵乘法，我们使用齐次坐标:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/4c1b9ea1d6ba2c7919b9846e4062379a.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*tIdfIb7n9OyK3N2YqHtCUQ.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">通过翻译改变基础</p></figure><p id="5d61" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">即使在翻译中，线性变换和基变换的变化也是相反的。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="fcb0" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">外部摄像机矩阵</h1><p id="e8a5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们已经分别研究了旋转和平移；但是，我们可以使用如下所示的矩阵组合一次执行这两个操作:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/f6cb37bc390514f4319db624c4998516.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*BH8dQfC0CIFaYI0f778Zgg.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">旋转+平移变换</p></figure><p id="d102" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">这里，𝑅是形状(3，3)的旋转矩阵，𝑂是形状(3，1)的平移偏移量。我们可以通过对最终的变换矩阵求逆来得到基矩阵的变化。这种形状基矩阵(4，4)的变化被称为外部摄像机矩阵，由𝐸.表示</p><p id="4986" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">使用𝐸，我们可以找到相机上任何一点的坐标。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/4e9c78110733288a3a94d10a18dcdaa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*8YGsBKbxYlKvW8dVHgT_Iw.png"/></div></figure><h2 id="d4a3" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">自由度</h2><p id="9743" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">摄像机外部矩阵有6个自由度。沿X、Y、Z轴的三个旋转角度和三个平移偏移。</p><h2 id="bafa" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">简化矩阵</h2><p id="6c6f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们可以看到相机外部矩阵的最后一行只有0和1。它不会给转换增加任何价值，它的唯一目的是增加一个额外的维度——这意味着，正如我们将在下面的示例中看到的，我们可以很好地删除最后一行。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="2413" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">例子</h1><p id="208f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">结尾的动手例子就像饭后甜点——没有甜点的饭是不完整的！</p><h2 id="da8d" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">安装</h2><p id="6438" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">包含所有代码的GitHub库可以在<a class="ae mf" href="https://github.com/wingedrasengan927/Image-formation-and-camera-calibration" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="d2d4" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">您可以通过运行以下命令来设置环境:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="486f" class="np ks iq od b gy oh oi l oj ok"># create a virtual environment in anaconda<br/>conda create -n camera-calibration-python python=3.6 anaconda<br/>conda activate camera-calibration-python</span><span id="1931" class="np ks iq od b gy ol oi l oj ok"># clone the repository and install dependencies<br/>git clone https://github.com/wingedrasengan927/Image-formation-and-camera-calibration.git<br/>cd Image-formation-and-camera-calibration<br/>pip install -r requirements.txt</span></pre><p id="3283" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">注意:</strong>这里假设你已经安装了anaconda。</p><p id="2a8e" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们将使用两个主要的库:</p><ul class=""><li id="806a" class="nb nc iq ll b lm mg lp mh ls nd lw ne ma nf me ng nh ni nj bi translated"><a class="ae mf" href="https://github.com/rock-learning/pytransform3d" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> pytransform3d: </strong> </a>该库具有强大的3d空间可视化和变换功能。</li><li id="ef04" class="nb nc iq ll b lm nk lp nl ls nm lw nn ma no me ng nh ni nj bi translated"><a class="ae mf" href="https://github.com/matplotlib/ipympl" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir">ipympl:</strong></a><strong class="ll ir"/>这是一个游戏规则改变者。<strong class="ll ir"> </strong>它使matplotlib绘图具有交互性，允许我们在笔记本中实时执行平移、缩放和旋转，这在处理3D绘图时非常有用。</li></ul></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h2 id="840d" class="np ks iq bd kt nq nr dn kx ns nt dp lb ls nu nv ld lw nw nx lf ma ny nz lh oa bi translated">直觉例子</h2><p id="f1cd" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在这个例子中，我们将首先为旋转和平移创建变换矩阵，将它们合并成一个矩阵，并使用它来变换摄像机。然后，我们将通过对这个变换矩阵求逆来创建基变换矩阵，并将其应用于一个点，然后将其坐标从世界坐标系更改为摄像机坐标系。</p><p id="be86" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">下面是示例的笔记本，也可以在<a class="ae mf" href="https://github.com/wingedrasengan927/Image-formation-and-camera-calibration" rel="noopener ugc nofollow" target="_blank">存储库</a>中找到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pa pb l"/></div></figure><p id="bb26" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">让我们一步一步地分解它:</p><ul class=""><li id="dcc7" class="nb nc iq ll b lm mg lp mh ls nd lw ne ma nf me ng nh ni nj bi translated">首先，我们导入必要的库。<code class="fe pc pd pe od b">utils.py</code>文件包含所有必要的助手函数。神奇的命令<code class="fe pc pd pe od b">%matplotlib widget</code>启用ipympl后端，这使我们能够玩的阴谋。</li><li id="e0de" class="nb nc iq ll b lm nk lp nl ls nm lw nn ma no me ng nh ni nj bi translated">接下来，我们定义必要的参数，如角度，旋转顺序，平移偏移，焦距和图像平面的大小。焦距和图像平面只是为了演示，我们将在下一篇文章中详细讨论它们。</li><li id="5798" class="nb nc iq ll b lm nk lp nl ls nm lw nn ma no me ng nh ni nj bi translated">这里我们保持简单，围绕标准的y轴旋转𝜋/4角。然而，我们可以绕任意轴旋转任意次。只是要注意旋转的顺序。我们的平移偏移量是<code class="fe pc pd pe od b">[0, -8, 0]</code>，它是沿Y轴的8个单位。</li><li id="a4b5" class="nb nc iq ll b lm nk lp nl ls nm lw nn ma no me ng nh ni nj bi translated">使用这些参数，我们为旋转和平移创建变换矩阵。</li><li id="8dd8" class="nb nc iq ll b lm nk lp nl ls nm lw nn ma no me ng nh ni nj bi translated">接下来，我们使用变换矩阵变换最初位于原点的相机，并绘制它。由于ipympl，剧情是交互式的。尽量摆弄剧情，玩不同的视角。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/04efedb7d5a4b2787d5abe114f80922d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FKP9KjstS6QqhcpAZ1EmDw.png"/></div></div></figure><ul class=""><li id="db29" class="nb nc iq ll b lm mg lp mh ls nd lw ne ma nf me ng nh ni nj bi translated">接下来，我们通过对变换矩阵求逆来创建基矩阵的变化，这是摄像机的外部矩阵。</li><li id="905f" class="nb nc iq ll b lm nk lp nl ls nm lw nn ma no me ng nh ni nj bi translated">最后，我们取一个世界坐标为<code class="fe pc pd pe od b">[-1/√2, -8, 1/√2]</code>的点，应用基变换的变换，得到摄像机的坐标为<code class="fe pc pd pe od b">[0, 0, 1]</code>。这是有意义的，因为该点就在相机Z轴的正上方。</li></ul></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="a6fc" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">结论</h1><p id="a3b6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我希望你喜欢这篇文章。在下一篇文章中，也就是系列的第3部分<a class="ae mf" rel="noopener" target="_blank" href="/camera-intrinsic-matrix-with-example-in-python-d79bf2478c12">，我们将讨论相机的内在特性，看看这些点是如何投射到相机的图像平面上的。如果你有任何疑问或问题，请在下面的评论中告诉我。</a></p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="4503" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">参考</h1><ol class=""><li id="e27e" class="nb nc iq ll b lm ln lp lq ls pg lw ph ma pi me pj nh ni nj bi translated"><a class="ae mf" href="https://classroom.udacity.com/courses/ud810" rel="noopener ugc nofollow" target="_blank">计算机视觉简介— Udacity </a></li></ol></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="c73b" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">图像制作者名单</h1><p id="3803" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">本文中的所有图片和数字，除非在标题中明确提及其来源，否则均由作者提供。</p></div></div>    
</body>
</html>