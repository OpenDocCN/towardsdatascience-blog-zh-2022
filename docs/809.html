<html>
<head>
<title>WordleBot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">单词机器人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/wordlebot-386395472639#2022-01-29">https://towardsdatascience.com/wordlebot-386395472639#2022-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="b9ad" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">单词机器人</h1></div><div class=""><h2 id="13b8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用谱聚类和强化学习在Wordle中取胜</h2></div><p id="bef0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://www.powerlanguage.co.uk/wordle/" rel="noopener ugc nofollow" target="_blank"> Wordle </a>是一款简单的文字游戏，由Josh Wardle开发。在<a class="ae lb" href="https://www.powerlanguage.co.uk/wordle/" rel="noopener ugc nofollow" target="_blank">纽约时报</a>上读到这个消息后，我试了一下，立刻就被吸引住了。我的妻子和我已经形成了一种竞争，每天都在比较我们的猜测计数，我认为制作一个机器人加入竞争会很有趣。在这篇文章中，我将回顾Wordle的规则，并通过1000多个模拟游戏介绍我的机器人的设计和性能。使用的主要ML/AI技术有<a class="ae lb" href="https://en.wikipedia.org/wiki/Spectral_clustering" rel="noopener ugc nofollow" target="_blank">谱聚类</a>和<a class="ae lb" href="https://en.wikipedia.org/wiki/Q-learning" rel="noopener ugc nofollow" target="_blank"> Q学习</a>。</p><p id="a802" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">TLDR；</p><ul class=""><li id="401f" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">我用机器学习建立了一个机器人，在硬模式下玩Wordle。</li><li id="0545" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">在1000多个模拟游戏中，机器人平均猜了3.767次<strong class="kh ir">才找到正确的单词。</strong></li><li id="21b6" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">该机器人在1000场模拟游戏中输掉了8场，总体胜率为99.2%。</li></ul><h2 id="5426" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">单词入门/规则复习</h2><p id="3e00" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">对于外行人来说，Wordle是一个类似于Hangman的猜谜游戏。每天，你有多达6次的机会来猜测一个隐藏的单词。对于每个猜测的每个字母，您都会收到反馈(绿色表示字母在隐藏单词中且位置正确，黄色表示字母在单词中但位置错误，灰色表示字母不在隐藏单词中)。</p><p id="3464" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你在<strong class="kh ir">硬模式</strong>下玩游戏，你<strong class="kh ir">需要</strong>使用来自每个猜测的反馈来通知你随后的猜测(防止你纯粹为了获得信息而提交猜测，并减少可能的单词池)。我的机器人在硬模式下玩。</p><h2 id="479d" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">相关著作</h2><p id="38ae" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">快速浏览博客圈发现，我不是唯一一个对使用数据科学解决Wordle挑战感兴趣的人。</p><ul class=""><li id="e19f" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">Matt Rickard <a class="ae lb" href="https://matt-rickard.com/wordle-whats-the-best-starting-word/" rel="noopener ugc nofollow" target="_blank">描述了一种贪婪的方法</a>来确定Wordle的“最佳”开始猜测，这是基于尽可能多地排除答案选项(他选择了“SOARE”，我甚至不知道这是一个单词)。</li><li id="eff9" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">Mark Scherschel II <a class="ae lb" href="https://medium.com/@schersch/an-informed-first-wordle-d2b3f001cd1a" rel="noopener">提出使用成对距离来衡量单词中心性</a>，选择“TARES”作为最佳起始单词选择，因为它与其他单词相对接近。</li></ul><p id="c094" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想在我的机器人设计中融入并扩展这些想法，以构建一个自主代理，更少地关注<strong class="kh ir">最佳首词</strong>，而更多地关注管理<strong class="kh ir">最佳下一个猜测</strong>的<strong class="kh ir">政策</strong>，以从一个游戏状态导航到下一个游戏状态。理想情况下，这个代理会从它的经验中学习，并随着它玩越来越多的游戏而提高它的性能。</p><h2 id="c878" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">源数据</h2><p id="146f" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">虽然英语中有超过12，000个五个字母的单词，但其中许多都是古老的或深奥的。Wordle的创建者将答案库限制在约2300个日常语言中的常用词。我从Wordle源代码手动复制了2300字的库来训练我的bot。</p><h2 id="94e8" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">单词相似度图</h2><p id="e61f" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">可行单词的集合被组织在无向图数据结构中。每个“节点”或“顶点”都是一个单词，单词之间的每个“边”或“链接”都通过一个简单的相似性得分进行加权。得分由两个单词之间的每个普通字母加1分组成，如果普通字母也在单词中的相同位置，则加1分。</p><p id="b7f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为较小答案库中的所有单词计算成对相似性得分，并存储在对称邻接矩阵中。</p><h2 id="446a" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">谱聚类</h2><p id="9376" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">谱聚类用于将图划分成k个“社区”(相似节点的组)。我使用的k值为5。在这篇文章中，我不会深入研究这个算法，但是如果你没有遇到过这个算法，你可以把它看作是相似图的K-Means。对于那些有兴趣进一步阅读的人来说，<a class="ae lb" href="https://en.wikipedia.org/wiki/Spectral_clustering" rel="noopener ugc nofollow" target="_blank">看看这个维基百科帖子</a>(很好的起点)。</p><h2 id="273d" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">q学习</h2><p id="7295" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">q学习是一种强化学习的形式，它寻求学习一种基于经验的政策π(以状态、行动和结果奖励之间的转换的形式)。Q学习中的一个挑战是定义一个离散的状态空间，使得代理可以通过实验获得足够的经验来学习给定情况下的“最佳”行动，以最大化期望的回报。另一个挑战是建立一个有效平衡短期和长期回报的奖励系统(例如，训练一个机器人吃一块糖比为上大学存钱更容易)。</p><p id="40d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本练习中，我通过离散化k个社区中的节点分布来定义状态。当k=5时，这导致了126种可能的状态。</p><p id="c3f1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">动作被定义为机器人应该从哪个社区选择下一个单词猜测。</p><p id="59e9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">奖励被定义为以下三个部分的总和:缩减系数、正确系数和获胜奖金。</p><p id="7027" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">收缩因子被定义为猜测前的可行单词数与猜测后的可行单词数的比率。猜测排除的单词越多，收缩系数越大。</p><p id="2462" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正确系数定义为每个绿色字母2分(正确位置的正确字母)，每个黄色字母1分(正确字母，错误位置)，每个灰色字母0分(字母不在正确单词中)。</p><p id="16b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个机器人每猜对一次就能获得1000分的高额奖金。</p><h2 id="cf52" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">总体战略</h2><p id="d052" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">对于每个游戏，一个年级的班级从2315个常见的5个字母的单词库中随机选择一个单词。然后，机器人使用迭代方法进行猜测。在每次迭代中，机器人执行以下操作:</p><ul class=""><li id="a248" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">对剩余的可行单词集使用谱聚类来划分图</li><li id="5021" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">离散化词在聚类中的分布</li><li id="e89b" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">使用Q学习器选择一个聚类，从中得出下一个猜测</li><li id="7fd9" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">选择猜测作为所选聚类的“质心”(该聚类中具有最高总相似性得分的单词)</li><li id="8fae" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">将猜测传递给Grader类，该类评估猜测并以每个字母的分数向量的形式返回反馈(2代表绿色，1代表黄色，0代表灰色)</li><li id="2e82" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">基于来自分类器的反馈过滤图形以排除不可行的单词</li><li id="5384" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">计算奖励，并在下一次迭代中传递给Q学习者</li></ul><p id="34b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当机器人猜出正确的单词时，它会终止迭代。</p><p id="d18b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据这个策略，我让机器人玩1000场游戏，并记录每场游戏的猜测次数。</p><h2 id="6e21" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">表演</h2><p id="6bb8" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">在1000场游戏中，机器人平均猜对次数为<strong class="kh ir"> 3.767次</strong>。它“输”了8次(需要猜6次以上来识别正确的单词)，总胜率为99.2%。下面的图表显示了该机器人在1，000场游戏中的表现:</p><figure class="mp mq mr ms gt mt gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/98d3d932197a05eba59babcd6399d416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*pfjlF63KnyZMaUKvIoZQxA.png"/></div><p class="mw mx gj gh gi my mz bd b be z dk translated">WordleBot guess统计了超过1000个模拟游戏。</p></figure><h2 id="0f83" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ko lz ma mb ks mc md me kw mf mg mh mi bi translated">结论</h2><p id="7ab0" class="pw-post-body-paragraph kf kg iq kh b ki mj jr kk kl mk ju kn ko ml kq kr ks mm ku kv kw mn ky kz la ij bi translated">我对我的机器人的总体表现感到惊喜。我自己的单词平均水平徘徊在3到4之间，所以这个机器人绝对可以和人类抗衡！</p><p id="917e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也就是说，还有很大的改进空间。计算和存储相似性得分是我的机器人当前设计中计算效率最低的部分，因为它需要为2315个单词计算5359225个成对的相似性得分。由于该图是对称的，从技术上讲，大约500万次相似性计算可以减半为大约250万次。因为分数永远不会改变，所以它们实际上只需要计算一次(而我当前的设计出于权宜之计，不必要地重新计算分数)。整个模拟在Google Colab环境中运行大约需要45分钟，我相信通过一些重构，这个运行时间可以大大减少。</p><p id="c46a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，还有许多可以调整的参数。例如，在这个练习中，我任意地将社区的数量设置为5，并取得了对我来说足够好的结果，但是可能还有其他一些最佳的社区数量。</p><p id="91d1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我怀疑机器人的Q学习部分可能是矫枉过正。随着机器人获得经验，我没有观察到我预期的每场比赛猜测次数的减少，这表明没有太多的“收敛”发生。对于一个有趣的短项目来说，我真的很满意它的结果。</p><p id="2c11" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章的扩展版本包括代码可以在我的GitHub页面的<a class="ae lb" href="https://github.com/danschauder/wordlebot/blob/main/Wordle_Bot.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本中找到。你怎么接近这样的机器人？请在评论中告诉我！</a></p></div></div>    
</body>
</html>