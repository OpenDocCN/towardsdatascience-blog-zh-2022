<html>
<head>
<title>This Tiny Python Package Creates Huge Augmented Datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这个微小的Python包创建了巨大的扩充数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-data-augmentation-pipeline-9841bc7bb56d#2022-01-17">https://towardsdatascience.com/image-data-augmentation-pipeline-9841bc7bb56d#2022-01-17</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""><h1 id="1846" class="pw-post-title is it iu bd iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq bi translated">这个微小的Python包创建了巨大的扩充数据集</h1></div><div class=""><h2 id="c9e2" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">如何创建图像数据扩充管道来生成大量合成数据点</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/23087ac597608c7a6c2fc802f659bf19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g6DC_OCJY-MHm4frrBXd5w.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图片来自<a class="ae kz" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>的<a class="ae kz" href="https://www.pexels.com/@pixabay" rel="noopener ugc nofollow" target="_blank">像素</a>。</p></figure><p id="a195" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">经过几个月的努力，你和你的团队已经为你的机器学习项目收集了大量的数据。</p><p id="71a4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">项目预算快结束了，剩下的只够训练模型。</p><p id="9723" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但是一旦你训练了这个模型，你就会发现这个模型不能很好地概括问题。你收集的数据还不够。训练精度是如此之好，但在验证集上，它急剧下降。</p><p id="9515" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">从技术上讲，这就是我们著名的所谓<a class="ae kz" href="https://www.ibm.com/cloud/learn/overfitting" rel="noopener ugc nofollow" target="_blank">过度拟合</a>。</p><p id="5f1e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">处理过度拟合有不同的方法。但是你的团队认为它们都不起作用。</p><p id="c096" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">剩下的是两个选项之一:</p><ul class=""><li id="ee67" class="lw lx iu lc b ld le lg lh lj ly ln lz lr ma lv mb mc md me bi translated">收集更多数据</li><li id="eab3" class="lw lx iu lc b ld mf lg mg lj mh ln mi lr mj lv mb mc md me bi translated">通过轻微调整创建现有数据点的副本(数据扩充)</li></ul><p id="f64e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">数据扩充被证明<a class="ae kz" href="https://www.sciencedirect.com/science/article/abs/pii/S0957417420305200" rel="noopener ugc nofollow" target="_blank">在不收集进一步数据的情况下提高机器学习模型的准确性</a>。这是许多从业者经常使用的普遍技术。</p><p id="f653" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在许多情况下，收集数据是一项昂贵的任务。你可能需要为设备、权限付费，更不用说在收集后给它们贴标签了。</p><div class="mk ml gq gs mm mn"><a rel="noopener follow" target="_blank" href="/is-deep-learning-right-for-you-b59a2219c457"><div class="mo ab fp"><div class="mp ab mq cl cj mr"><h2 class="bd iv gz z fq ms fs ft mt fv fx it bi translated">如何评价深度学习是否适合自己？</h2><div class="mu l"><h3 class="bd b gz z fq ms fs ft mt fv fx dk translated">可能不会！在浪费时间之前，这里是你需要知道的</h3></div><div class="mv l"><p class="bd b dl z fq ms fs ft mt fv fx dk translated">towardsdatascience.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb kt mn"/></div></div></a></div><p id="5f73" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">以医学图像分类问题为例。对于如何收集医疗保健数据，T4有法律限制。而在收集之后，要给它们贴上标签，就需要医生等熟练专业人士的专业知识。</p><p id="806d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这篇文章将通过例子讨论一个叫做<a class="ae kz" href="https://albumentations.ai/" rel="noopener ugc nofollow" target="_blank">albuminations</a>的图像数据增强工具。这是一个在MIT许可下发布的开源Python库。</p><p id="6fe4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您可以从PyPI存储库中用下面的命令安装它。如果您正在寻找高级说明，请查阅官方<a class="ae kz" href="https://albumentations.ai/docs/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><pre class="kk kl km kn gu nc nd ne nf aw ng bi"><span id="fdad" class="nh ni iu nd b gz nj nk l nl nm">pip install -U albumentations</span></pre><h1 id="6d3c" class="nn ni iu bd no np nq nr ns nt nu nv nw ka nx kb ny kd nz ke oa kg ob kh oc od bi translated">数据增强能做什么？</h1><p id="1171" class="pw-post-body-paragraph la lb iu lc b ld oe jv lf lg of jy li lj og ll lm ln oh lp lq lr oi lt lu lv in bi translated">数据扩充通过一些转换创建现有数据点的副本。例如，我们可以裁剪和旋转图像，使其看起来像新的一样。通过这种集成方法，我们可以将数据集进行多重化，并训练模型以提高其准确性。</p><p id="65cf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里有一个说明它的意思的例子。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/04f1b7c4bf52029ac06917ee3403fa3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZbqXsJSpH6k9ydjsUkc5Rg.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图像数据增强如何工作的图解——作者使用来自<a class="ae kz" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kz" href="https://www.pexels.com/@domenicobertazzo" rel="noopener ugc nofollow" target="_blank"> Domenico Bertazzo </a>拍摄的<a class="ae kz" href="https://www.worldwildlife.org/species/sri-lankan-elephant" rel="noopener ugc nofollow" target="_blank">斯里兰卡大象</a>的照片</p></figure><p id="7d3d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们用不同的技术转换了基础图像。在许多照片中，我们结合使用了不止一种技术。通过继续这个过程，我们可以生成大量的数据点。</p><div class="mk ml gq gs mm mn"><a rel="noopener follow" target="_blank" href="/transfer-learning-in-deep-learning-641089950f5d"><div class="mo ab fp"><div class="mp ab mq cl cj mr"><h2 class="bd iv gz z fq ms fs ft mt fv fx it bi translated">迁移学习:你能学到的最有效的深度学习技能。</h2><div class="mu l"><h3 class="bd b gz z fq ms fs ft mt fv fx dk translated">迁移学习是一种加速深度学习训练的惊人方法。它有助于解决复杂的问题…</h3></div><div class="mv l"><p class="bd b dl z fq ms fs ft mt fv fx dk translated">towardsdatascience.com</p></div></div><div class="mw l"><div class="ok l my mz na mw nb kt mn"/></div></div></a></div><h1 id="18c6" class="nn ni iu bd no np nq nr ns nt nu nv nw ka nx kb ny kd nz ke oa kg ob kh oc od bi translated">使用白蛋白创建图像增强管道。</h1><p id="73d5" class="pw-post-body-paragraph la lb iu lc b ld oe jv lf lg of jy li lj og ll lm ln oh lp lq lr oi lt lu lv in bi translated">使用白蛋白创建扩增管道非常简单。</p><p id="2d01" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最初，我们需要通过配置一系列转换来构建一个增强管道。然后我们可以使用任何图像处理库，如<a class="ae kz" href="https://pillow.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> Pillow </a>或<a class="ae kz" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>从文件系统中读取图像。每次我们通过我们配置的转换列表传递一个图像，它都会给我们一个改变的图像。</p><p id="2671" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这里有一个例子，你可以复制开始使用。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ol om l"/></div></figure><p id="6b8c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在上面的例子中，我们使用了四种类型的转换。</p><p id="250c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">1.我们从随机位置开始裁剪图像。我们配置了RandomCrop API来生成一张256x256大小的图片。</p><p id="cb1d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">2.我们用了水平翻转。请注意，此操作并不总是适用。我们已经为它配置了0.5的概率值。这意味着通过这条管道的每个图像都有50%的机会被水平翻转。</p><p id="5ad5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">3.对于0.5和0.3的限制，随机亮度和对比度API将改变各自的图像特征。我们没有像水平翻转那样明确提到概率值。但是API的默认值是0.5。因此，每张图像都有50%的机会轻微改变亮度和对比度。当它适用时，亮度不会改变超过50%，对比度最大值为30%。</p><p id="b526" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">4.最后，我们随机旋转图像。我们在这里没有覆盖任何默认值。</p><p id="d94e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后，我们使用Pillow从文件系统中读取一个图像，Pillow是一个广泛使用的用于图像处理的Python库。我们还把它转换成了一个NumPy数组。</p><p id="f13f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，我们通过配置好的管道发送图像并显示结果。</p><p id="6ddf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">蛋白沉积有几十个这样的转变。你可以从他们的<a class="ae kz" href="https://albumentations.ai/docs/getting_started/transforms_and_targets/" rel="noopener ugc nofollow" target="_blank"> API文档</a>中了解更多细节。</p><div class="mk ml gq gs mm mn"><a rel="noopener follow" target="_blank" href="/the-prefect-way-to-automate-orchestrate-data-pipelines-d4465638bac2"><div class="mo ab fp"><div class="mp ab mq cl cj mr"><h2 class="bd iv gz z fq ms fs ft mt fv fx it bi translated">自动化和编排数据管道的完美方式</h2><div class="mu l"><h3 class="bd b gz z fq ms fs ft mt fv fx dk translated">我正在将我所有的ETL工作从Airflow迁移到这个超级酷的框架中</h3></div><div class="mv l"><p class="bd b dl z fq ms fs ft mt fv fx dk translated">towardsdatascience.com</p></div></div><div class="mw l"><div class="on l my mz na mw nb kt mn"/></div></div></a></div><h1 id="d855" class="nn ni iu bd no np nq nr ns nt nu nv nw ka nx kb ny kd nz ke oa kg ob kh oc od bi translated">如何创建带注释的扩充数据？</h1><p id="fe97" class="pw-post-body-paragraph la lb iu lc b ld oe jv lf lg of jy li lj og ll lm ln oh lp lq lr oi lt lu lv in bi translated">大多数计算机视觉应用必须处理带注释的图像。这些是在照片中标记和标注的对象，用于训练ML模型。</p><p id="c964" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当扩充这样的数据集时，我们还需要知道那些被注释对象的新位置。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oj"><img src="../Images/98651286eff041247770d284a53a08a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kn97Kn64-7ql4sIMPoPUIQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">在增强过程中改变注释图像位置的图示。由作者使用来自<a class="ae kz" href="https://www.pexels.com/photo/dog-and-cat-on-the-floor-4214919/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae kz" href="https://www.pexels.com/@mariansicko?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">marián sicko</a>的照片创建</p></figure><p id="0e23" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们的增强技术应该相应地重新计算坐标。这项任务在蛋白沉积方面毫不费力。我们需要向管道提供初始坐标和类别id的注释对象。结果会有它的新位置。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ol om l"/></div></figure><p id="9c04" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们已经修改了上面创建增强管道的例子中的Compose方法。我们添加了另一个输入bbox_params及其配置。</p><p id="f114" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这样，我们告诉Albumentation使用coco格式来扩充带注释的图像，并使用category_label来查找它的标签。Coco是该库中可用的四种重记方法之一。</p><p id="5423" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，我们在运行时为每个图像传递两个额外的参数。第一个通过它的起始坐标、宽度和高度来定义盒子。然后我们定义的每个容器的标签。</p><p id="4833" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">结果是这样的。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oo"><img src="../Images/1b85bf252c6c011b26871be8b475bc28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UparnjobqHLgvla6drS6mA.jpeg"/></div></div></figure><p id="b23e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">变换后，对象的位置发生了变化。然而，管道已经正确地找到了它的新位置。</p><div class="mk ml gq gs mm mn"><a rel="noopener follow" target="_blank" href="/how-to-speed-up-python-data-pipelines-up-to-91x-80d7accfe7ec"><div class="mo ab fp"><div class="mp ab mq cl cj mr"><h2 class="bd iv gz z fq ms fs ft mt fv fx it bi translated">如何将Python数据管道加速到91X？</h2><div class="mu l"><h3 class="bd b gz z fq ms fs ft mt fv fx dk translated">一个5分钟的教程可以为您的大数据项目节省数月时间。</h3></div><div class="mv l"><p class="bd b dl z fq ms fs ft mt fv fx dk translated">towardsdatascience.com</p></div></div><div class="mw l"><div class="op l my mz na mw nb kt mn"/></div></div></a></div></div><div class="ab cl oq or hy os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="in io ip iq ir"><h1 id="962c" class="nn ni iu bd no np ox nr ns nt oy nv nw ka oz kb ny kd pa ke oa kg pb kh oc od bi translated">最终想法</h1><p id="08e1" class="pw-post-body-paragraph la lb iu lc b ld oe jv lf lg of jy li lj og ll lm ln oh lp lq lr oi lt lu lv in bi translated">通过重用现有图像，数据扩充节省了大量的时间、精力和预算。我们可以用任何图像处理库做到这一点。但是一些特定的任务可能需要额外的努力才能正确完成。</p><p id="6735" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">例如，带注释的图像需要重新注释增强图像上的对象。在这些情况下，像Albumentations这样的工具就派上用场了。</p><p id="8d76" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这篇文章简要介绍了我们可以用这个Python库做什么。我希望下次你训练机器学习模型时，你会用它来提高准确性，而不用考虑进一步的数据收集。</p><div class="mk ml gq gs mm mn"><a rel="noopener follow" target="_blank" href="/3-ways-to-deploy-machine-learning-models-in-production-cdba15b00e"><div class="mo ab fp"><div class="mp ab mq cl cj mr"><h2 class="bd iv gz z fq ms fs ft mt fv fx it bi translated">在生产中部署机器学习模型的3种方式</h2><div class="mu l"><h3 class="bd b gz z fq ms fs ft mt fv fx dk translated">部署ML模型，并使它们对用户或项目的其他组件可用。</h3></div><div class="mv l"><p class="bd b dl z fq ms fs ft mt fv fx dk translated">towardsdatascience.com</p></div></div><div class="mw l"><div class="pc l my mz na mw nb kt mn"/></div></div></a></div><div class="mk ml gq gs mm mn"><a rel="noopener follow" target="_blank" href="/5-python-gui-frameworks-to-create-desktop-web-and-even-mobile-apps-c25f1bcfb561"><div class="mo ab fp"><div class="mp ab mq cl cj mr"><h2 class="bd iv gz z fq ms fs ft mt fv fx it bi translated">5 Python GUI框架来创建桌面、Web甚至移动应用程序。</h2><div class="mu l"><h3 class="bd b gz z fq ms fs ft mt fv fx dk translated">你可以纯粹用Python来构建漂亮的应用程序。</h3></div><div class="mv l"><p class="bd b dl z fq ms fs ft mt fv fx dk translated">towardsdatascience.com</p></div></div><div class="mw l"><div class="pd l my mz na mw nb kt mn"/></div></div></a></div></div><div class="ab cl oq or hy os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="in io ip iq ir"><blockquote class="pe pf pg"><p id="108d" class="la lb ph lc b ld le jv lf lg lh jy li pi lk ll lm pj lo lp lq pk ls lt lu lv in bi translated">感谢阅读，朋友！在<a class="ae kz" href="https://www.linkedin.com/in/thuwarakesh/" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv">LinkedIn</strong></a><a class="ae kz" href="https://twitter.com/Thuwarakesh" rel="noopener ugc nofollow" target="_blank"><strong class="lc iv">Twitter</strong></a><a class="ae kz" href="https://thuwarakesh.medium.com/" rel="noopener"><strong class="lc iv">Medium</strong></a>上跟我打招呼。</p><p id="db02" class="la lb ph lc b ld le jv lf lg lh jy li pi lk ll lm pj lo lp lq pk ls lt lu lv in bi translated">还不是中等会员？请使用此链接<a class="ae kz" href="https://thuwarakesh.medium.com/membership" rel="noopener"> <strong class="lc iv">成为会员</strong> </a>因为，不需要你额外付费，我为你引荐赚取一小笔佣金。</p></blockquote></div></div>    
</body>
</html>