# DALL-E 2.0，已解释

> 原文：<https://towardsdatascience.com/dall-e-2-0-explained-7b928f3adce7>

## 人工智能的毕加索是如何工作的？

![](img/37766b21b63e5a6388d89246d4a7e75f.png)

[davisuko](https://unsplash.com/@davisuko?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

几天前，OpenAI 发布了我认为最引人注目的人工智能创造力展示: [DALL-E 2](https://openai.com/dall-e-2/) 。在最基本的层面上，DALLE-2 是一种以非凡的准确性将文本映射到图像的功能，产生高质量和生动的输出图像。但是这项技术到底是如何工作的呢？在这篇文章中，我将尽可能深入地解释，同时让尽可能多的人了解情况。

如上所述，DALL-E 2 将文本作为输入，并将图像作为输出。但这并不是一蹴而就的；更确切地说，DALL-E 2 代表了过去几年来一点一点建立和改进的各种技术的顶峰。这些技术像乐高积木一样相互堆叠，以组成完整的模型。要了解 DALL-E 2，我们首先要了解这些部件是什么，它们做什么。只有这样，我们才能深入了解内部工作和训练过程，以理解底层组件。

## 夹子

在 DALL-E 2 架构中最重要的构建模块之一是 CLIP。CLIP 代表对比语言-图像预训练，它对 DALL-E 2 是必不可少的，因为它是文本和图像之间的主要桥梁。从广义上讲，CLIP 代表了这样一种观点，即语言可以作为一种工具，用来教会计算机不同的图像如何相互联系。形式上，它规定了一个简单的方法来进行这种教学。

理解 CLIP 的最好方法是首先看到以前的计算机视觉系统的缺点。在 CLIP 之前，计算机视觉的神经方法包括聚集大型图像数据集，然后将它们手动标记为一组类别。虽然今天的模型在这项任务上表现出色，但它固有地受到预先选择的类别的需要的限制。比如，想象一下拍一张街道的照片，让这样的系统去描述；它可以告诉你有多少辆车和标志，但它不能给你一个整体的感觉。更重要的是，没有足够的图像来产生一个类别的任何东西都不会被模型分类。

让 CLIP 如此强大的洞察力是一个聪明的想法，训练模型不仅识别图像属于哪个类别(预定义的选项列表)，还从随机标题列表中识别每个图像的标题。这使得模型可以使用语言来更精确地理解“柴犬”和“戴贝雷帽的柴犬”之间的区别，而不是让人类标签员提前指定它们是否属于同一类别。

在完成上述“预训练任务”的过程中，CLIP 能够创建一个向量空间，该向量空间的维度代表图像的特征*和语言的特征*。这个共享的向量空间在功能上为模型提供了各种各样的图像-文本字典，允许它们在两者之间进行翻译(至少在语义上)。

尽管如此，这种共同的理解并不能代表 DALL-E 2 的全部。即使有把英语单词翻译成西班牙语单词的方法，人们也需要在说话前学习西班牙语的发音和语法。在我们的模型中，CLIP 使我们能够获取文本短语，并理解它们如何映射到图像上。但是，我们仍然需要一种方法来生成这些图像，以一种真实的方式来理解文本。进入我们的第二个乐高积木:扩散模型。

## 扩散模型

想象你有一个完美解决的魔方，每一面都只有单一颜色的方块。现在，你随机选择一边并扭转它。然后是另一面，另一面，另一面，等等，直到你认为魔方被“搅乱了”你将如何着手解决它？假设你忘记了你所做的所有扭转，有没有一个通用的方法来解决没有这些信息的立方体？好吧，你可以一步一步来:继续扭曲任何一张脸，让你更接近同一侧的颜色，直到解决为止。更实际的是，你可以训练一个神经网络从一种无序状态进入一种不那么 T4 无序的状态。

这是如何创建扩散模型的关键。你拍摄一张图像，随机打乱它的像素，直到你得到一张纯噪声的图像，然后训练一个模型，通过逐步改变它的像素来减少噪声，直到你回到原始图像(或类似的图像)。这留下了一个模型，它可以有效地从随机性中生成信息——一幅图像！通过向模型展示新的随机样本，我们甚至可以得到新的图像。

为了给这些创作注入输入文本的语义，我们对剪辑嵌入的扩散模型进行了“调节”。这仅仅意味着我们将来自上述联合剪辑空间的向量传递到扩散模型中，该模型计算在生成过程的每个“步骤”中改变哪些像素。这允许模型根据该信息进行更改。

当然，数学和实现的技术细节比我在这里介绍的要复杂得多。但在其核心，DALL-E 2 是这两种技术的优化和细化。

有人说“艺术是人类灵魂的窗户”出于这个原因，一些人认为生成性图像是无聊或无趣的。然而对我来说，生成艺术更有趣:它是计算机灵魂的窗口。在艺术创作中，模特展示了自己的理解、误解，最重要的是，展示了自己的创造力。