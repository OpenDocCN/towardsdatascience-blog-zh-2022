<html>
<head>
<title>Teach an AI Model to Write like Shakespeare — For Free</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">免费教一个人工智能模型像莎士比亚一样写作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/teach-an-ai-model-to-write-like-shakespeare-for-free-a9e6a307139#2022-01-31">https://towardsdatascience.com/teach-an-ai-model-to-write-like-shakespeare-for-free-a9e6a307139#2022-01-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="ed10" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">免费教一个人工智能模型像莎士比亚一样写作</h1></div><div class=""><h2 id="ba63" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用SageMaker Studio Lab训练您自己的NLP模型</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f0cab7682e7a1707d2a2c74e97edf1b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ce61FR3iERKSZsm7"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@voodoojava?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马特·里奇</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="29e1" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">这是怎么回事？</h1><p id="2258" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">训练机器学习模型已经变得越来越资源密集。例如，今天最先进的自然语言处理(NLP)模型几乎完全是神经网络，需要GPU的能力来训练它们。</p><p id="579f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">幸运的是，具有GPU能力的可自由访问的开发环境的数量也在增长。2021年12月，AWS宣布S <a class="ae kv" href="https://studiolab.sagemaker.aws/" rel="noopener ugc nofollow" target="_blank"> ageMaker Studio Lab </a>。Studio Lab是一个基于web的IDE，基于流行的Jupyter Lab环境。最棒的是，它还配有免费的GPU功能。</p><p id="799a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本教程中，我们将利用这个GPU来教一个NLP模型像莎士比亚一样写作。由于开发了拥抱脸的示例脚本，这样做变得非常容易。事实上，我们只需要一个命令和不到五分钟的时间来训练这个NLP模型。</p><p id="924c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">本教程的所有代码都可以在这个<a class="ae kv" href="https://github.com/marshmellow77/nlp-model-shakespeare" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到。</p><h1 id="51e7" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">Studio Lab入门</h1><p id="a77f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">首先，我们需要注册一个账户。我们可以在<a class="ae kv" href="https://studiolab.sagemaker.aws/" rel="noopener ugc nofollow" target="_blank">网站</a>上这样做，这是一个简单的过程:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/17effa57c748548b8319a89261844e3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1me8UFEO4_IQOnBrs8NhNw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="c714" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">填写表格后，可能需要几个小时到几天的时间，直到我创建您的帐户。一旦您收到电子邮件，告知您的帐户已准备就绪，您就可以登录并开始使用:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/bc28db06f8eeb68947af501248fee5a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hl329kB28JkyisULij3RJQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="f898" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这个菜单中，我们可以选择是用CPU还是GPU来启动一个项目。因为现代NLP模型是基于深度学习的(也就是说，它们是基于神经网络的)，所以我们应该在我们的项目中使用GPU。选择GPU后，我们可以通过单击带有播放符号的按钮来启动运行时。这应该只需要几秒钟。然后，最后，我们可以通过按“打开项目”按钮来打开Studio Lab环境。</p><h1 id="2691" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">如何教授一个人工智能模型</h1><p id="5b2a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如前所述，Studio Lab基于Jupyter Lab，如果你熟悉Jupyter Lab，那么这个环境应该看起来很熟悉。左侧是文件浏览器，右侧是启动器，我们可以在其中启动将用于训练NLP模型的笔记本:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/b227565dffc2e0a8de2cd63a72a91848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X0oFbAf56fC0GUl6r4NUgA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="f50a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">教导人工智能模型以某种风格生成文本需要几件事情:(1)已经知道如何生成文本的预训练模型(2)训练集，在我们的情况下是莎士比亚文本(3)训练脚本。</p><h2 id="502a" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">模型</h2><p id="f6a4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在撰写本文时，Hugging Face在其模型中心提供了超过3，800个可用于文本生成的模型:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/488f394ccfe9bcfc106765f6eac109d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVmxyqxcB5RvkQoMhoQkmg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="f8c8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本教程中，我们将使用<a class="ae kv" href="https://huggingface.co/distilgpt2" rel="noopener ugc nofollow" target="_blank"> <em class="nf"> distilgpt2 </em> </a>，它是较小的型号之一，但考虑到它的大小，它的性能还不错。</p><h2 id="b743" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">数据集</h2><p id="7916" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们再次回到拥抱脸网站，因为他们提供了一个非常适合我们目的的数据集，<a class="ae kv" href="https://huggingface.co/datasets/tiny_shakespeare" rel="noopener ugc nofollow" target="_blank"> <em class="nf"> tiny_shakespeare </em> </a>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/9f0498691cfb92dc6993cbe3e026c033.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SaScHk5Zt8WKKXfB_Gq8LA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="5712" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这个数据集包含40，000行莎士比亚文本，可以在麻省理工学院许可下使用。</p><h2 id="cec3" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">培训脚本</h2><p id="1bc8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最后，我们需要一个培训脚本。这是我们准备文本的地方，因此它可以用来教授一个人工智能模型&amp;我们在这里进行实际的训练。通常这将占用我们大部分的时间，但是我们又一次幸运了:拥抱脸提供了一个我们可以使用的<a class="ae kv" href="https://github.com/huggingface/transformers/blob/master/examples/pytorch/language-modeling/run_clm.py" rel="noopener ugc nofollow" target="_blank">全功能训练脚本</a>。我们需要做的就是将脚本指向我们想要使用的模型和数据集。</p><p id="d31d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">要了解更多关于这些现成的培训脚本，我们可以查看<a class="ae kv" href="https://huggingface.co/docs/transformers/examples" rel="noopener ugc nofollow" target="_blank">文档</a>。这里我们了解到，为了使用这个脚本，我们需要从源代码安装transformers库。如何做到这一点在文档中有详细的解释，并且非常简单:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/9dace659e2516695396ab78470658354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A99zND9PjuOyRRakQCUn3Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="a426" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">开始培训</h1><p id="b70f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">既然我们已经有了训练模型的所有要素，我们可以只使用一个命令来启动它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="bcf8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在Studio Lab中，训练我们的模型大约需要3-4分钟完成:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/4d909f3df79aa8ab72448b91bf81e7fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITmFzdASWyZ9oJRfXOVwUw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="72d1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">该模型将保存在我们在训练命令中指定的文件夹中(在我的例子中，它被称为<em class="nf"> shakespeare-clm </em>，但您可以随意命名)。</p><h1 id="5220" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">测试我们的模型</h1><p id="5458" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">此时，我们可以下载模型，并在任何我们喜欢的地方使用它。但是当我们在工作室的时候，我们应该做一个快速测试来看看训练是否有效。</p><p id="d52c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">为此，在我们教它像莎士比亚一样写作之前，我们将首先使用NLP模型，并将其输出与我们的莎士比亚模型进行比较。</p><h2 id="51d9" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">未训练文本生成模型</h2><p id="efd0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">由于有了<a class="ae kv" href="https://huggingface.co/docs/transformers/main_classes/pipelines" rel="noopener ugc nofollow" target="_blank">拥抱脸管道API </a>，使用这些NLP模型生成文本变得非常简单。使用这个API，我们可以用原始模型生成一些文本，即在我们训练它之前:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/15f6525c884423f429aaf88bd94547da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gVjJ075HqbMkrlDNZUfcEQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="da13" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这段文字看起来像“正常”的文字，而不是真正的莎士比亚风格。让我们试试我们训练过的莎士比亚模型。</p><h2 id="9726" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">莎士比亚文本生成模型</h2><p id="1818" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">与上面类似，我们可以使用管道API来为我们的模型生成文本。我们只需要明确地告诉API在哪里可以找到我们的模型:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/0c0f52ee06a0e7fad1ac1c857a55d285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciA5Rxq5kz2-riYmC3PM9Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="e46f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">用我们的模型生成的文本与第一个模型明显不同。这看起来更像莎士比亚的文本。</p><h1 id="f4c6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="1211" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">只用一个命令，几分钟之内，我们就教会了一个人工智能模型像莎士比亚一样写作。由此产生的模型可以下载并在我们喜欢的任何地方使用。</p><p id="2b0f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我希望这个教程对你有用——如果你有任何问题，请在评论中联系我们。此外，请继续在其他文本上训练AI模型——我很想听听你正在构建的文本生成模型。</p></div></div>    
</body>
</html>