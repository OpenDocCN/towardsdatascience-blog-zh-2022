<html>
<head>
<title>How to Create A Map from Geospatial Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python从地理空间数据创建地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-a-map-from-geospatial-data-in-python-f4bb7d11ddad#2022-01-19">https://towardsdatascience.com/how-to-create-a-map-from-geospatial-data-in-python-f4bb7d11ddad#2022-01-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""><h1 id="5190" class="pw-post-title io ip iq bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">如何使用Python从地理空间数据创建地图</h1></div><div class=""><h2 id="0c1e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Folium将印度尼西亚火山的位置数据绘制成地图</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/536c2db0c5042e34c346581d9f248298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wAp7NlPqmwjrqtz_h6lOLw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">印度尼西亚爪哇岛的火山地图，用蟒蛇皮和树叶制成。图片作者。</p></figure><p id="8b8d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi lr translated"><span class="l ls lt lu bm lv lw lx ly lz di">我</span>最近才学会如何用<strong class="kx ir"> Python </strong>使用<strong class="kx ir">叶子</strong>实际创建一个地图来显示地理位置数据。我想我最好写下来，这样我就不会忘记怎么做了。在我接触到leav之前，我已经尝试过使用Matplotlib或Plotly等常用的可视化库。它们仍然工作，但不是我想象的那样。一旦我使用了叶，它就开始有意义了。所以我们开始吧。</p><p id="9ef0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为一个例子，我将使用在印度尼西亚发现的火山的地理数据。请注意，全国至少有<strong class="kx ir"> 127座火山</strong>，从几个月前有喷发历史的活火山到没有已知喷发历史的火山。基本上，印度尼西亚是世界上活火山数量最多的国家。这听起来是可怕还是迷人，取决于你。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/7b3dd1c1e4da82d59949d790c97a3ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HCOBnTzmpH7BZV55"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">印度尼西亚博约拉里的默巴布山令人惊叹的景色。丹·吉尔摩在<a class="ae mb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片。</p></figure><h1 id="e981" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">收集数据</h1><p id="6cc0" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">我从一个名为<a class="ae mb" href="https://magma.esdm.go.id/v1/edukasi/tipe-gunung-api-di-indonesia-a-b-dan-c" rel="noopener ugc nofollow" target="_blank"> MAGMA Indonesia </a>的政府网站上收集了火山数据，并将它们存储到一个CSV文件中。您可以将以上页面中的数据复制并粘贴到您选择的任何电子表格应用程序的表格中。或者你可以在这个<a class="ae mb" href="https://github.com/catris25/Indonesian-Volcanoes-in-Folium/blob/main/Indonesian_volcanoes.csv" rel="noopener ugc nofollow" target="_blank"> GitHub库页面</a>下载我准备好并格式化的文件。</p><p id="65d5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我不是火山方面的专家，我只是碰巧一辈子都住在火山附近，所以我就按照数据和官方网站上说的去做。根据网站介绍，印度尼西亚有3种火山。</p><ul class=""><li id="0558" class="mz na iq kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated"><strong class="kx ir">A型</strong>共有76座，是自16世纪以来就有喷发历史的火山。</li><li id="f8cd" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated"><strong class="kx ir">B型</strong>，共30座，为1600年前有喷发史的火山。</li><li id="474c" class="mz na iq kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated"><strong class="kx ir">C型</strong>，共21座，是没有已知喷发历史，但仍有火山活动痕迹的火山，如索尔法塔拉或喷气孔。</li></ul><h1 id="35a0" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">加载和准备数据</h1><p id="efbe" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">因为我将数据保存为CSV格式，所以我可以使用Pandas加载它。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="7e77" class="ns md iq no b gy nt nu l nv nw">import pandas as pd</span><span id="f340" class="ns md iq no b gy nx nu l nv nw">df = pd.read_csv("Indonesian_volcanoes.csv")<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/bee6af7acd9e99ba4c99d9b5fc4096c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*gczuW0OqdflzoiITtlmeqw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">本文中使用的数据摘录。作者图片</p></figure><p id="ec09" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，作为开始，我导入了leav库。</p><p id="0296" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这里找到我们地图的<strong class="kx ir">位置中心</strong>也很重要，它是数据中所有位置的平均经纬度。由于有火山横跨全国，这些经度和纬度基本上是在印度尼西亚的中心。我们将使用这个位置中心作为地图的中心。</p><p id="0cf5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">手动输入定位中心也可以，但我更喜欢下面这种方式。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="e8eb" class="ns md iq no b gy nt nu l nv nw">import folium</span><span id="906c" class="ns md iq no b gy nx nu l nv nw">loc_center = [df['Latitude'].mean(), df['Longitude'].mean()]</span></pre><h1 id="78f7" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">蓝点中的火山</h1><p id="35de" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">我们将把这张地图保存到一个名为<strong class="kx ir"> map1 </strong>的变量中。然后，我们可以开始使用叶创建地图。我使用<strong class="kx ir"> loc_center </strong>中的位置作为地图的中心，并为<strong class="kx ir"> zoom_start </strong>设置5(完成后可以放大或缩小地图)。</p><p id="335e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">地图图块有许多选项可用，<strong class="kx ir"> Openstreetmap </strong>、<strong class="kx ir"> Mapbox </strong>、<strong class="kx ir"> Stamen </strong>和<strong class="kx ir"> CartoDB </strong>等等。我将使用最常见的一个，所以我使用Openstreetmap中的图块。</p><p id="f4c9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后，我遍历了数据中的每座山，并为每座山的位置画了一个圈。弹出的是火山名称，所以当你在地图上点击它，它会显示山的名称。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="f983" class="ns md iq no b gy nt nu l nv nw">map1 = folium.Map(location = loc_center, tiles='Openstreetmap', zoom_start = 5, control_scale=True)</span><span id="602c" class="ns md iq no b gy nx nu l nv nw">for index, loc in df.iterrows():<br/>    folium.CircleMarker([loc['Latitude'], loc['Longitude']],     radius=2, weight=5, popup=loc['Volcano']).add_to(map1)</span><span id="5c86" class="ns md iq no b gy nx nu l nv nw">folium.LayerControl().add_to(map1)</span><span id="f97e" class="ns md iq no b gy nx nu l nv nw">map1</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/3a71a613d64e181efb99374f9d4ecb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMrLocAuv58K2J4cmBPzvw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">印度尼西亚的火山用蓝点表示。图片作者。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/4089a1d78e476d29e79dba2182220708.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IV-R-b40fzLDjrz6V5F-6A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">地图放大了。它展示了默拉皮火山，世界上最活跃的火山之一。图片作者。</p></figure><p id="0778" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以放大地图，点击每一个蓝点，就会显示出这座山的名字。总的来说，我已经对这张地图感到满意了。在这里你可以看到整个印度尼西亚和每个地区的山脉。</p><p id="f9f2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">婆罗洲(加里曼丹)和巴布亚是印度尼西亚仅有的两个没有火山的大岛。那里有山，但是没有探测到火山活动。</p><p id="e9fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，我想做更多的实验，比如我们把它们做成三角形，而不是圆点，怎么样？毕竟，山看起来确实像三角形，对吗？或者，如果我们根据火山活动的类型给山脉上色，就像我前面解释的那样，会怎么样呢？</p><h1 id="65f1" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">根据火山的类型给它们上色</h1><p id="b10f" class="pw-post-body-paragraph kv kw iq kx b ky mu jr la lb mv ju ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">对于第二张地图，我将使用<strong class="kx ir">雄蕊地形</strong>作为地图的图块。我也用有三条边的正多边形标记器来做一个三角形来标记每座山。</p><p id="f1e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于A型火山(最活跃的火山)，我把它们涂成红色。对于B型，我把它们涂成黄色，对于C型，它们是绿色。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="0e60" class="ns md iq no b gy nt nu l nv nw">map2 = folium.Map(location = loc_center, tiles='Stamen Terrain', zoom_start = 5, control_scale=True)</span><span id="4e59" class="ns md iq no b gy nx nu l nv nw">for index, loc in df.iterrows():</span><span id="cb37" class="ns md iq no b gy nx nu l nv nw">    if loc['Type']=='A':<br/>        color = 'red'<br/>    elif loc['Type']=='B':<br/>        color = "yellow"<br/>    elif loc['Type']=='C':<br/>        color = 'green'<br/>    else:<br/>        color = 'black'</span><span id="db83" class="ns md iq no b gy nx nu l nv nw">    folium.RegularPolygonMarker([loc['Latitude'],    loc['Longitude']], popup = loc['Volcano'], fill_color=color, number_of_sides=3, radius=6, rotation=30).add_to(map2)</span><span id="0c19" class="ns md iq no b gy nx nu l nv nw">folium.LayerControl().add_to(map2)</span><span id="206a" class="ns md iq no b gy nx nu l nv nw">map2</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/4d6fc54a1e0a0e8de8e83e5a1fe8dfac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqRVIXH0ZzlZqlDnztau0Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">根据火山活动用不同的颜色来表示火山。图片作者。</p></figure><p id="4d63" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用上一张地图中的不同贴图，你会得到一个稍微不同的外观。用不同的颜色表示每座山的火山活动，你可以很容易地分辨出哪些火山更活跃(红色)，哪些火山不太活跃(黄色和绿色)。</p><p id="f522" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以通过查看我将在参考资料部分链接的Folium文档来尝试不同的图块或不同的对象形状。</p><p id="bf71" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我希望你觉得这篇文章有用而且有趣。感谢阅读！</p><p id="9d9b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我在本文中使用的整个笔记本和数据都在下面我的Github存储库中。</p><div class="oc od gp gr oe of"><a href="https://github.com/catris25/Indonesian-Volcanoes-in-Folium" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">GitHub-catris 25/Indonesian-Volcanoes-in-folio:使用…创建印度尼西亚火山地图</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">使用Python和Folium创建印度尼西亚火山地图。这是我提交的一篇文章的储存库…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot kp of"/></div></div></a></div><h1 id="0942" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated"><strong class="ak">参考文献</strong>:</h1><div class="oc od gp gr oe of"><a href="https://magma.esdm.go.id/v1/edukasi/tipe-gunung-api-di-indonesia-a-b-dan-c" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">印度尼西亚的Tipe Gunung Api、B和C)</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">印度尼西亚WIB，2021年9月20日12:01:09</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">magma.esdm.go.id</p></div></div><div class="oo l"><div class="ou l oq or os oo ot kp of"/></div></div></a></div><div class="oc od gp gr oe of"><a href="https://python-visualization.github.io/folium/modules.html" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">0.12.1文件</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">使用用于绘制地图的Python和fleed . js类制作漂亮的交互式地图。基地…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">python-visualization.github.io</p></div></div></div></a></div></div></div>    
</body>
</html>